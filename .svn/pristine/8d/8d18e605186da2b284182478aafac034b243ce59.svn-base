<?xml version="1.0" encoding="utf-8" ?>
<!--============================================================================
//	CAUTION: This file is generated by IBatisNetGen.3.SQLMap.cst at 11/11/2015 9:30:18 AM
//				Any manual editing will be lost in re-generation.
//===========================================================================-->
<sqlMap namespace="eHospital" xmlns="http://ibatis.apache.org/mapping" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <statements>
    <statement id="DAO00226_GetList" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      select   ndv.MANHOMDICHVU, ndv.TENNHOMDICHVU as TENNHOMDICHVU,DV.TENDICHVU,DV.MADICHVU,DV.DICHVU_ID
      from TM_DICHVU dv
      left join TM_NHOMDICHVU ndv on dv.NHOMDICHVU_ID = ndv.NHOMDICHVU_ID
      where ndv.TAMNGUNG = '0' and dv.TAMNGUNG = '0' and dv.BENHVIEN_ID = '$BENHVIEN_ID$'
    </statement>
    <statement id="DAO00226_LayThongTinPhieu" resultClass="DataObject" parameterClass="System.Collections.IDictionary">
      select YC.DVYEUCAU_ID ,NGAYGIOYEUCAU NGAYCHIDINH,YC.CHANDOAN LAMSANG,YC.NGUOIGIOITHIEU_ID,YC.BACSICHIDINH_ID
      , ISNULL(TM.KHAMGAYME_ID,0) KHAMGAYME_ID,YC.NOIYEUCAU_ID,yc.DICHVU_ID
      from TT_DVYEUCAU yc
      LEFT JOIN TT_KHAMGAYME TM ON YC.DVYEUCAU_ID=TM.DVYEUCAU_ID
      where yc.DVYEUCAU_ID='$DVYEUCAU_ID$'
    </statement>
    <statement id="DAO00226_LoadDanhMucPhieu" resultClass="DataObject" parameterClass="System.Collections.IDictionary">
      SELECT YC.SOPHIEUYEUCAU , YC.DVYEUCAU_ID,DM.TENDICHVU
      FROM TT_DVYEUCAU YC
      LEFT JOIN  TM_DICHVU DM ON YC.DICHVU_ID= DM.DICHVU_ID
      LEFT JOIN TM_NHOMDICHVU NHOM ON DM.NHOMDICHVU_ID=NHOM.NHOMDICHVU_ID
      where yc.TIEPNHAN_ID='$TIEPNHAN_ID$' AND YC.NOITHUCHIEN_ID='$NOITHUCHIEN_ID$'  and (left(NHOM.MANHOMDICHVU,2) ='05' OR left(NHOM.MANHOMDICHVU,2) ='06')
    </statement>
    <statement id="DAO00226_LayThongTinKhamGayMe" resultClass="DataObject" parameterClass="System.Collections.IDictionary">
     SELECT [KHAMGAYME_ID]
      ,[SOPHIEUGAYME]
      ,[BENHNHAN_ID]
      ,[TIEPNHAN_ID]
      ,[BENHAN_ID]
      ,[DVYEUCAU_ID]
      ,[NGAYCHIDINH]
      ,[NOICHIDINH_ID]
      ,[BACSICHIDINH_ID]
      ,[LAMSANG]
      ,[NGAYTHUCHIEN]
      ,[THOIGIANTHUCHIEN]
      ,[NOITHUCHIEN_ID]
      ,[BACSIGAYME_ID]
      ,[KTV1_ID]
      ,[KTV2_ID]
      ,[BENHVIEN_ID]
      ,[NGAYTAO]
      ,[NGUOITAO_ID]
      ,[NGAYCAPNHAT]
      ,[NGUOICAPNHAT_ID]
      ,[PHUONGPHAPVOCAM_ID]
      ,[GIOGAYME]
      ,[PHUTGAYME]
      ,[ASA1]
      ,[ASA2]
      ,[ASA3]
      ,[ASA4]
      ,[ASA5]
      ,[TIENME]
      ,[DIUNG]
      ,[TAIBIEN]
      ,[DATNKQ]
      ,[MUI]
      ,[MIENG]
      ,[MALLAMPATI1]
      ,[MALLAMPATI2]
      ,[MALLAMPATI3]
      ,[MALLAMPATI4]
      ,[THUOCNGU]
      ,[ANTHAN]
      ,[GIAMDAU]
      ,[GIANCO]
      ,[KHANGSINH]
      ,[THUOCKHAC]
      ,[HCLANG]
      ,[MAUTOANPHAN]
      ,[PFC]
      ,[TC]
      ,[GRADE1]
      ,[GRADE2]
      ,[GRADE3]
      ,[GRADE4]
      FROM [TT_KHAMGAYME] 
      WHERE KHAMGAYME_ID='$KHAMGAYME_ID$'
    </statement>
    <insert id="DAO00226_Add" parameterClass="System.Collections.IDictionary" resultClass="System.Int64">
      INSERT INTO [TT_KHAMGAYME]
      (
      [BENHNHAN_ID]
           ,[TIEPNHAN_ID]
           ,[BENHAN_ID]
           ,[DVYEUCAU_ID]
           ,[NGAYCHIDINH]
           ,[NOICHIDINH_ID]
           ,[BACSICHIDINH_ID]
           ,[LAMSANG]
           ,[NGAYTHUCHIEN]
           ,[THOIGIANTHUCHIEN]
           ,[NOITHUCHIEN_ID]
           ,[BACSIGAYME_ID]
           ,[KTV1_ID]
           ,[KTV2_ID]
           ,[BENHVIEN_ID]
           ,[NGAYTAO]
           ,[NGUOITAO_ID]
           ,[NGAYCAPNHAT]
           ,[NGUOICAPNHAT_ID]
           ,[PHUONGPHAPVOCAM_ID]
           ,[GIOGAYME]
           ,[PHUTGAYME]
           ,[ASA1]
           ,[ASA2]
           ,[ASA3]
           ,[ASA4]
           ,[ASA5]
           ,[TIENME]
           ,[DIUNG]
           ,[TAIBIEN]
           ,[DATNKQ]
           ,[MUI]
           ,[MIENG]
           ,[MALLAMPATI1]
           ,[MALLAMPATI2]
           ,[MALLAMPATI3]
           ,[MALLAMPATI4]
           ,[THUOCNGU]
           ,[ANTHAN]
           ,[GIAMDAU]
           ,[GIANCO]
           ,[KHANGSINH]
           ,[THUOCKHAC]
           ,[HCLANG]
           ,[MAUTOANPHAN]
           ,[PFC]
           ,[TC]
           ,[GRADE1]
           ,[GRADE2]
           ,[GRADE3]
           ,[GRADE4]
      )
      VALUES
      (
      #BENHNHAN_ID#
           ,#TIEPNHAN_ID#
           ,#BENHAN_ID#
           ,#DVYEUCAU_ID#
           ,#NGAYCHIDINH#
           ,#NOICHIDINH_ID#
           ,#BACSICHIDINH_ID#
           ,#LAMSANG#
           ,#NGAYTHUCHIEN#
           ,#NGAYTHUCHIEN#
           ,#NOITHUCHIEN_ID#
           ,#BACSIGAYME_ID#
           ,#KTV1_ID#
           ,#KTV2_ID#
           ,#BENHVIEN_ID#
           ,#NGAYTAO#
           ,#NGUOITAO_ID#
           ,#NGAYCAPNHAT#
           ,#NGUOICAPNHAT_ID#
           ,#PHUONGPHAPVOCAM_ID#
           ,#GIOGAYME#
           ,#PHUTGAYME#
           ,#ASA1#
           ,#ASA2#
           ,#ASA3#
           ,#ASA4#
           ,#ASA5#
           ,#TIENME#
           ,#DIUNG#
           ,#TAIBIEN#
           ,#DATNKQ#
           ,#MUI#
           ,#MIENG#
           ,#MALLAMPATI1#
           ,#MALLAMPATI2#
           ,#MALLAMPATI3#
           ,#MALLAMPATI4#
           ,#THUOCNGU#
           ,#ANTHAN#
           ,#GIAMDAU#
           ,#GIANCO#
           ,#KHANGSINH#
           ,#THUOCKHAC#
           ,#HCLANG#
           ,#MAUTOANPHAN#
           ,#PFC#
           ,#TC#
           ,#GRADE1#
           ,#GRADE2#
           ,#GRADE3#
           ,#GRADE4#
      )

      <selectKey resultClass="System.Int64" type="post" >
        SELECT @@IDENTITY as value
      </selectKey>
    </insert>
    <update id="DAO00226_Update" parameterClass="System.Collections.IDictionary">
 
      UPDATE [TT_KHAMGAYME]
      SET
       [DVYEUCAU_ID] = #DVYEUCAU_ID#
      ,[LAMSANG] = #LAMSANG#
      ,[NGAYTHUCHIEN] = #NGAYTHUCHIEN#
      ,[THOIGIANTHUCHIEN] = #NGAYTHUCHIEN#
      ,[NOITHUCHIEN_ID] = #NOITHUCHIEN_ID#
      ,[BACSIGAYME_ID] = #BACSIGAYME_ID#
      ,[KTV1_ID] = #KTV1_ID#
      ,[KTV2_ID] = #KTV2_ID#
      ,[NGAYCAPNHAT] = #NGAYCAPNHAT#
      ,[NGUOICAPNHAT_ID] = #NGUOICAPNHAT_ID#
      ,[PHUONGPHAPVOCAM_ID] = #PHUONGPHAPVOCAM_ID#
      ,[GIOGAYME] = #GIOGAYME#
      ,[PHUTGAYME] = #PHUTGAYME#
      ,[ASA1] = #ASA1#
      ,[ASA2] = #ASA2#
      ,[ASA3] = #ASA3#
      ,[ASA4] = #ASA4#
      ,[ASA5] = #ASA5#
      ,[TIENME] = #TIENME#
      ,[DIUNG] = #DIUNG#
      ,[TAIBIEN] = #TAIBIEN#
      ,[DATNKQ] = #DATNKQ#
      ,[MUI] = #MUI#
      ,[MIENG] = #MIENG#
      ,[MALLAMPATI1] = #MALLAMPATI1#
      ,[MALLAMPATI2] = #MALLAMPATI2#
      ,[MALLAMPATI3] = #MALLAMPATI3#
      ,[MALLAMPATI4] = #MALLAMPATI4#
      ,[THUOCNGU] = #THUOCNGU#
      ,[ANTHAN] = #ANTHAN#
      ,[GIAMDAU] = #GIAMDAU#
      ,[GIANCO] = #GIANCO#
      ,[KHANGSINH] = #KHANGSINH#
      ,[THUOCKHAC] = #THUOCKHAC#
      ,[HCLANG] = #HCLANG#
      ,[MAUTOANPHAN] = #MAUTOANPHAN#
      ,[PFC] = #PFC#
      ,[TC] = #TC#
      ,[GRADE1] = #GRADE1#
      ,[GRADE2] = #GRADE2#
      ,[GRADE3] = #GRADE3#
      ,[GRADE4] = #GRADE4#
      WHERE KHAMGAYME_ID=#KHAMGAYME_ID#
      select 1 as value
   
    </update>
    <statement id="DAO00226_Delete" parameterClass="System.Collections.IDictionary" resultClass="System.Int32">
      DELETE FROM [TT_KHAMGAYME]   WHERE KHAMGAYME_ID='$KHAMGAYME_ID$'
      <!--UPDATE TT_DVYEUCAU SET TRANGTHAI ='CHUAKETQUA' WHERE DVYEUCAU_ID='$DVYEUCAU_ID$'-->
    </statement>
    <statement id="DAO00226_CheckStatus_HoanThanh" resultClass="DataObject" parameterClass="System.Collections.IDictionary">
      SELECT TIEPNHAN_ID  FROM TT_TIEPNHAN WHERE TIEPNHAN_ID='$TIEPNHAN_ID$' AND TRANGTHAI='HOANTHANH' AND TT_TIEPNHAN.BENHVIEN_ID='$BENHVIEN_ID$'
    </statement>
    <statement id="DAO00226_CheckStatus_DaXuatVien" resultClass="DataObject" parameterClass="System.Collections.IDictionary">
      SELECT BA.BENHAN_ID FROM TT_TIEPNHAN TN INNER JOIN TT_NOITRU_BENHAN BA ON TN.TIEPNHAN_ID=BA.TIEPNHAN_ID
      WHERE TN.TIEPNHAN_ID='$TIEPNHAN_ID$' AND TN.BENHVIEN_ID='$BENHVIEN_ID$' AND BA.TRANGTHAI='DAXUATVIEN'
    </statement>
  </statements>
</sqlMap>

