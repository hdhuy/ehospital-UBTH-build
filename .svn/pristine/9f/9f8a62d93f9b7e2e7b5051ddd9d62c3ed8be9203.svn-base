<?xml version="1.0" encoding="utf-8" ?>
<!--============================================================================
//	CAUTION: This file is generated by IBatisNetGen.3.SQLMap.cst at 12/21/2015 2:22:43 PM
//				Any manual editing will be lost in re-generation.
//===========================================================================-->
<sqlMap namespace="eHospital" xmlns="http://ibatis.apache.org/mapping" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">

  <statements>
    <statement id="DAO00080_GetColumnsOfTable" resultClass="DataObject">
      SELECT COLUMN_NAME
      FROM INFORMATION_SCHEMA.COLUMNS
      WHERE TABLE_NAME = '$TABLE_NAME$'
    </statement>
    <statement id="DAO00080_GetTrangThaiBenhAnThanhToan" resultClass="DataObject">
      select * from
      TT_NOITRU_BENHAN
      where
      BENHAN_ID ='$BENHAN_ID$' and
      TRANGTHAI in ('DATHANHTOAN', 'DAKHOA') and
      BENHVIEN_ID = '%BENHVIEN_ID%'

    </statement>
    <statement id="DAO00080_GetTTSinhHIeuHSBANT" resultClass="DataObject">
      select top 1 MACH, NHIPTHO, NHIETDO, CANNANG, HUYETAPTHAP, HUYETAPCAO, CHIEUCAO
      from TT_NGOAITRU_KHAMBENH_SINHHIEU where
      TIEPNHAN_ID = '$TIEPNHAN_ID$'
      and BENHVIEN_ID = '$BENHVIEN_ID$'
      Order By NGAYCAPNHAT DESC
    </statement>
    <statement id="DAO00080_GetNoiTruLuuTruBenhAn" resultClass="DataObject">
      select *
      from TT_NOITRU_LUUTRU where
      BENHAN_ID = '$BENHAN_ID$'
      and BENHVIEN_ID = '$BENHVIEN_ID$'
      Order By LUUTRU_ID ASC
    </statement>
    <statement id="DAO00080_GetCapCuuDaCapHoSoNoiTru" resultClass="DataObject">
      select *
      from TT_NOITRU_XACNHAN where
      BENHAN_ID = '$BENHAN_ID$'
      and BENHVIEN_ID = '$BENHVIEN_ID$'
    </statement>
    <statement id="DAO00080_GetCapCuuDaVaoNoiTru" resultClass="DataObject">
      select *
      from TT_NOITRU_BENHAN where
      TIEPNHAN_ID = '$TIEPNHAN_ID$'
      and BENHVIEN_ID = '$BENHVIEN_ID$'
      and LOAIBENHAN = '3' and TRANGTHAI != 'DAKHOA'
    </statement>
    <statement id="DAO00080_GetNoiTruLuuTruChiTietBenhAn" resultClass="DataObject">
      select *
      from TT_NOITRU_LUUTRUCHITIET where
      LUUTRU_ID = '$LUUTRU_ID$' and LUUTRUCHITIET_CURRENT = 1
      and BENHVIEN_ID = '$BENHVIEN_ID$'
      Order By LUUTRUCHITIET_ID DESC
    </statement>
    <statement id="DAO00080_GetGiuongBenhCuaBenhAn" resultClass="DataObject">
      select *
      from TT_NOITRU_GIUONGBENH where
      BENHAN_ID = #BENHAN_ID#
    </statement>
    <statement id="DAO00080_UpdateTragiuongTuDong" resultClass="DataObject">
      declare @luutruID int;
      select top 1 @luutruID = LUUTRU_ID from TT_NOITRU_LUUTRU where BENHAN_ID = #BENHAN_ID# order by LUUTRU_ID desc
      update TT_NOITRU_LUUTRUCHITIET set NGAYRA = #NGAYRAVIEN#, THOIGIANRA = #THOIGIANRAVIEN#, LUUTRUCHITIET_CURRENT = 0
      where
      LUUTRU_ID = @luutruID
      and LUUTRUCHITIET_ID = (select top 1 LUUTRUCHITIET_ID from TT_NOITRU_LUUTRUCHITIET
      where LUUTRU_ID = @luutruID order by LUUTRUCHITIET_ID desc)

      delete from TT_NOITRU_GIUONGBENH where BENHAN_ID = #BENHAN_ID#
    </statement>
    <statement id="DAO00080_GetNoiTruBenhAnChiTiet" resultClass="DataObject">
      select *
      from TT_NOITRU_BENHAN_CHITIET where
      BENHAN_ID = '$BENHAN_ID$'
      and BENHVIEN_ID = '$BENHVIEN_ID$'
      Order By BENHANCHITIET_ID DESC
    </statement>
    <statement id="DAO00080_GetThongTinCapCuu" resultClass="DataObject">
      select *
      from TT_KHAMBENH_VAOVIEN where
      TIEPNHAN_ID = '$TIEPNHAN_ID$'
      and BENHVIEN_ID = '$BENHVIEN_ID$'
      Order By KHAMBENHVAOVIEN_ID DESC
    </statement>
    <statement id="DAO00080_GetThongTinNgoaiTruKhamBenh" resultClass="DataObject">
      select * from TT_NGOAITRU_KHAMBENH where
      TIEPNHAN_ID = '$TIEPNHAN_ID$'
      and BENHVIEN_ID = '$BENHVIEN_ID$'
      <!--select *
      from TT_NGOAITRU_KHAMBENH_BENHAN where
      TIEPNHAN_ID = '$TIEPNHAN_ID$'
      and BENHVIEN_ID = '$BENHVIEN_ID$'-->
    </statement>
    <statement id="DAO00080_GetThongTinNgoaiTruKhamBenh_TheoBenhAn" resultClass="DataObject">
      select *
      from TT_KHAMBENH_VAOVIEN where
      TIEPNHAN_ID = '$TIEPNHAN_ID$'
      and BENHVIEN_ID = '$BENHVIEN_ID$'
    </statement>
    <statement id="DAO00080_GetThongTinNgoaiTruKhambenhBenhan" resultClass="DataObject">
      select *
      from TT_NGOAITRU_KHAMBENH_BENHAN where
      TIEPNHAN_ID = '$TIEPNHAN_ID$'
      and DVYEUCAU_ID = '$DVYEUCAU_ID$'
      and BENHVIEN_ID = '$BENHVIEN_ID$'
    </statement>
    <statement id="DAO00080_KiemTraThongTinNgoaiTruKhambenh" resultClass="DataObject">
      select A.*, dv.TENDICHVU
      from TT_NGOAITRU_KHAMBENH_BENHAN A
      left join TT_DVYEUCAU dvyc on dvyc.DVYEUCAU_ID = A.DVYEUCAU_ID
      left join TM_DICHVU dv on dv.DICHVU_ID = dvyc.DICHVU_ID
      where
      A.TIEPNHAN_ID = '$TIEPNHAN_ID$'
      and A.BENHVIEN_ID = '$BENHVIEN_ID$'
    </statement>
    <statement id="DAO00080_DeleteThongTinNgoaiTruKhambenh" resultClass="DataObject">
      delete from TT_NGOAITRU_KHAMBENH_BENHAN
      where
      TIEPNHAN_ID = $TIEPNHAN_ID$ and DVYEUCAU_ID= $DVYEUCAU_ID$
    </statement>
    <statement id="DAO00080_GetThongTinPhieuKhamBenhNhapVien" resultClass="DataObject">
      SELECT PH.*
      , SH.NGAYDO, SH.THOIGIANDO, SH.MACH, SH.HUYETAPTHAP, HUYETAPCAO
      , NHIPTHO, SH.NHIETDO, SH.CHIEUCAO, SH.CANNANG, SH.CHISOBMI, SH.VONGBUNG
      , SH.VONGDAU, SH.SPO2, SH.GHICHU
      FROM TT_PHIEU_KHAMBENH_VAOVIEN PH
      LEFT JOIN TT_NGOAITRU_KHAMBENH_SINHHIEU SH ON SH.KHAMBENH_SINHHIEU_ID = PH.KHAMBENH_SINHHIEU_ID
      WHERE PH.KHAMBENH_ID = #KHAMBENH_ID#
      AND PH.BENHVIEN_ID = '$BENHVIEN_ID$'
    </statement>
    <statement id="DAO00080_KiemtraBenhAnDaThanhToan" resultClass="DataObject">
      select DAXACNHANDOANHTHU
      from TT_NOITRU_BENHAN where
      BENHAN_ID = '$BENHAN_ID$'
      and BENHVIEN_ID = '$BENHVIEN_ID$'
      Order By BENHAN_ID Desc
    </statement>
    <statement id="DAO00080_KiemtraBenhAnRaVien" resultClass="DataObject">
      select *
      from TT_NOITRU_BENHAN where
      BENHAN_ID = '$BENHAN_ID$'
      and (TRANGTHAI='DATHANHTOAN' OR TRANGTHAI='DAXUATVIEN')
      and BENHVIEN_ID = '$BENHVIEN_ID$'
      Order By BENHAN_ID Desc
    </statement>
    <statement id="DAO00080_KiemtraBenhAnNoiTruDangDieuTri" resultClass="DataObject">
      select *
      from TT_NOITRU_BENHAN where
      TIEPNHAN_ID = '$TIEPNHAN_ID$' <!--and LOAIBENHAN = 3-->
      and TRANGTHAI='DANGDIEUTRI'
      <isNotEmpty prepend="and" property="BENHAN_ID">
        BENHAN_ID = '$BENHAN_ID$'
      </isNotEmpty>
      and BENHVIEN_ID = '$BENHVIEN_ID$'
      Order By BENHAN_ID Desc
    </statement>
    <insert id="DAO00080_Add_KhamBenh_CapCuu" parameterClass="System.Collections.IDictionary" resultClass="System.Int64">
      insert into TT_KHAMBENH_VAOVIEN (
      SOPHIEU
      , TIEPNHAN_ID
      , KHAMBENH_ID
      , BENHNHAN_ID
      , NGUOILIENHE
      , DIENTHOAILIENHE
      , NOILAMVIEC
      , CHANDOANNOIGIOITHIEU
      , NGAYKHAM
      , THOIGIANKHAM
      , LYDOVAOVIEN
      , QUATRINHBENHLY
      , TIENSUBANTHAN
      , TIENSUGIADINH
      , KHAMXETTOANTHAN
      , KHAMXETCACBOPHAN
      , KHAMXETKQLS
      , CHANDOANVAO
      , ICDKHAMXET_ID
      , DAXULY
      , NGAYRA
      , THOIGIANRA
      , NHAPKHOA_ID
      , CHUYENVIEN_ID
      , CHUY
      , MACH
      , NHIETDO
      , HUYETAPCAO
      , HUYETAPTHAP
      , NHIPTHO
      , CANNANG
      , CHIEUCAO
      , BACSI_ID
      , XUTRUKHAMBENH_ID
      , CAPCUU
      , NGAYTAINAN
      , THOIGIANTAINAN
      , NOITAINAN_TINHTHANH_ID
      , NOITAINAN_QUANHUYEN_ID
      , NOITAINAN_PHUONGXA_ID
      , NOITAINAN_DIACHI
      , DIADIEMTAINAN_ID
      , BOPHANBITHUONG_ID
      , MUCDO_ID
      , DIENBIENSAUTN_ID
      , XUTRISAUTN_ID
      , NGUYENNHAN_ID
      , NGUYENNHANCHITIET_ID
      , ICD_NGUYENNHAN
      , NGAYTAO
      , NGUOITAO_ID
      , NGAYCAPNHAT
      , NGUOICAPNHAT_ID
      , BENHANCHUYENKHOA
      , CHANDOANVAOVIEN
      , CHANDOANRAVIEN
      , DIEUTRITUNGAY
      , DIEUTRIDENNGAY
      , DIENBIENLS
      , KQXETNGHIEM
      , PHAUTHUAT
      , THUTHUAT
      , TINHTRANGNGUOIBENH
      , HUONGDIEUTRI
      , NGUOIGIAO_ID
      , NGUOINHAN_ID
      , XQUANG
      , CTSCANNER
      , SIEUAM
      , XETNGHIEM
      , KHAC
      , TOANBOHS
      , LOAICHUYENKHOA
      , CONGANCANTHIEP
      , CDRR_BENHCHINH
      , CDRR_BENHKEM
      , ICD_BENHCHINH
      , ICD_BENHKEMTHEO
      , PHUONGPHAPDIEUTRI
      , FIELD_1
      , FIELD_2
      , FIELD_3
      , FIELD_4
      , FIELD_5
      , FIELD_6
      , FIELD_7
      , FIELD_8
      , FIELD_9
      , FIELD_10
      , FIELD_11
      , FIELD_12
      , FIELD_13
      , FIELD_14
      , FIELD_15
      , FIELD_27
      , FIELD_28
      , FIELD_29
      , FIELD_30
      , FIELD_31
      , FIELD_32
      , FIELD_33
      , FIELD_34
      , FIELD_35
      , FIELD_36
      , FIELD_37
      , FIELD_38
      , FIELD_39
      , FIELD_40
      , FIELD_41
      , FIELD_42
      , FIELD_43
      , FIELD_44
      , FIELD_45
      , FIELD_46
      , FIELD_47
      , FIELD_48
      , FIELD_49
      , FIELD_50
      , FIELD_51
      , FIELD_52
      , FIELD_53
      , FIELD_54
      , FIELD_55
      , FIELD_56
      , BENHVIEN_ID
      ) values (
      #SOPHIEU#
      , #TIEPNHAN_ID#
      , #KHAMBENH_ID#
      , #BENHNHAN_ID#
      , #NGUOILIENHE#
      , #DIENTHOAILIENHE#
      , #NOILAMVIEC#
      , #CHANDOANNOIGIOITHIEU#
      , #NGAYKHAM#
      , #THOIGIANKHAM#
      , #LYDOVAOVIEN#
      , #QUATRINHBENHLY#
      , #TIENSUBANTHAN#
      , #TIENSUGIADINH#
      , #KHAMXETTOANTHAN#
      , #KHAMXETCACBOPHAN#
      , #KHAMXETKQLS#
      , #CHANDOANVAO#
      , #ICDKHAMXET_ID#
      , #DAXULY#
      , #NGAYRA#
      , #THOIGIANRA#
      , #NHAPKHOA_ID#
      , #CHUYENVIEN_ID#
      , #CHUY#
      , #MACH#
      , #NHIETDO#
      , #HUYETAPCAO#
      , #HUYETAPTHAP#
      , #NHIPTHO#
      , #CANNANG#
      , #CHIEUCAO#
      , #BACSI_ID#
      , #XUTRUKHAMBENH_ID#
      , #CAPCUU#
      , #NGAYTAINAN#
      , #THOIGIANTAINAN#
      , #NOITAINAN_TINHTHANH_ID#
      , #NOITAINAN_QUANHUYEN_ID#
      , #NOITAINAN_PHUONGXA_ID#
      , #NOITAINAN_DIACHI#
      , #DIADIEMTAINAN_ID#
      , #BOPHANBITHUONG_ID#
      , #MUCDO_ID#
      , #DIENBIENSAUTN_ID#
      , #XUTRISAUTN_ID#
      , #NGUYENNHAN_ID#
      , #NGUYENNHANCHITIET_ID#
      , #ICD_NGUYENNHAN#
      , #NGAYTAO#
      , #NGUOITAO_ID#
      , #NGAYCAPNHAT#
      , #NGUOICAPNHAT_ID#
      , #BENHANCHUYENKHOA#
      , #CHANDOANVAOVIEN#
      , #CHANDOANRAVIEN#
      , #DIEUTRITUNGAY#
      , #DIEUTRIDENNGAY#
      , #DIENBIENLS#
      , #KQXETNGHIEM#
      , #PHAUTHUAT#
      , #THUTHUAT#
      , #TINHTRANGNGUOIBENH#
      , #HUONGDIEUTRI#
      , #NGUOIGIAO_ID#
      , #NGUOINHAN_ID#
      , #XQUANG#
      , #CTSCANNER#
      , #SIEUAM#
      , #XETNGHIEM#
      , #KHAC#
      , #TOANBOHS#
      , #LOAICHUYENKHOA#
      , #CONGANCANTHIEP#
      , #CDRR_BENHCHINH#
      , #CDRR_BENHKEM#
      , #ICD_BENHCHINH#
      , #ICD_BENHKEMTHEO#
      , #PHUONGPHAPDIEUTRI#
      , #FIELD_1#
      , #FIELD_2#
      , #FIELD_3#
      , #FIELD_4#
      , #FIELD_5#
      , #FIELD_6#
      , #FIELD_7#
      , #FIELD_8#
      , #FIELD_9#
      , #FIELD_10#
      , #FIELD_11#
      , #FIELD_12#
      , #FIELD_13#
      , #FIELD_14#
      , #FIELD_15#
      , #FIELD_27#
      , #FIELD_28#
      , #FIELD_29#
      , #FIELD_30#
      , #FIELD_31#
      , #FIELD_32#
      , #FIELD_33#
      , #FIELD_34#
      , #FIELD_35#
      , #FIELD_36#
      , #FIELD_37#
      , #FIELD_38#
      , #FIELD_39#
      , #FIELD_40#
      , #FIELD_41#
      , #FIELD_42#
      , #FIELD_43#
      , #FIELD_44#
      , #FIELD_45#
      , #FIELD_46#
      , #FIELD_47#
      , #FIELD_48#
      , #FIELD_49#
      , #FIELD_50#
      , #FIELD_51#
      , #FIELD_52#
      , #FIELD_53#
      , #FIELD_54#
      , #FIELD_55#
      , #FIELD_56#
      , #BENHVIEN_ID#
      )
    </insert>
    <update id="DAO00080_Update_KhamBenh_CapCuu" parameterClass="System.Collections.IDictionary">
      update TT_KHAMBENH_VAOVIEN set
      TIEPNHAN_ID = #TIEPNHAN_ID#
      <isPropertyAvailable prepend="," property="NGUOILIENHE">
        NGUOILIENHE = #NGUOILIENHE#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="DIENTHOAILIENHE">
        DIENTHOAILIENHE = #DIENTHOAILIENHE#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NOILAMVIEC">
        NOILAMVIEC = #NOILAMVIEC#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="CHANDOANNOIGIOITHIEU">
        CHANDOANNOIGIOITHIEU = #CHANDOANNOIGIOITHIEU#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGAYKHAM">
        NGAYKHAM = #NGAYKHAM#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="THOIGIANKHAM">
        THOIGIANKHAM = #THOIGIANKHAM#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="LYDOVAOVIEN">
        LYDOVAOVIEN = #LYDOVAOVIEN#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="QUATRINHBENHLY">
        QUATRINHBENHLY = #QUATRINHBENHLY#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="TIENSUBANTHAN">
        TIENSUBANTHAN = #TIENSUBANTHAN#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="TIENSUGIADINH">
        TIENSUGIADINH = #TIENSUGIADINH#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="KHAMXETTOANTHAN">
        KHAMXETTOANTHAN = #KHAMXETTOANTHAN#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="KHAMXETCACBOPHAN">
        KHAMXETCACBOPHAN = #KHAMXETCACBOPHAN#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="KHAMXETKQLS">
        KHAMXETKQLS = #KHAMXETKQLS#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="CHANDOANVAO">
        CHANDOANVAO = #CHANDOANVAO#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="ICDKHAMXET_ID">
        ICDKHAMXET_ID = #ICDKHAMXET_ID#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="DAXULY">
        DAXULY = #DAXULY#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGAYRA">
        NGAYRA = #NGAYRA#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="THOIGIANRA">
        THOIGIANRA = #THOIGIANRA#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NHAPKHOA_ID">
        NHAPKHOA_ID = #NHAPKHOA_ID#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="CHUYENVIEN_ID">
        CHUYENVIEN_ID = #CHUYENVIEN_ID#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="CHUY">
        CHUY = #CHUY#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="MACH">
        MACH = #MACH#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NHIETDO">
        NHIETDO = #NHIETDO#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="HUYETAPCAO">
        HUYETAPCAO = #HUYETAPCAO#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="HUYETAPTHAP">
        HUYETAPTHAP = #HUYETAPTHAP#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NHIPTHO">
        NHIPTHO = #NHIPTHO#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="CANNANG">
        CANNANG = #CANNANG#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="CHIEUCAO">
        CHIEUCAO = #CHIEUCAO#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="SPO2">
        SPO2 = #SPO2#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="BACSI_ID">
        BACSI_ID = #BACSI_ID#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="XUTRUKHAMBENH_ID">
        XUTRUKHAMBENH_ID = #XUTRUKHAMBENH_ID#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="CAPCUU">
        CAPCUU = #CAPCUU#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGAYTAINAN">
        NGAYTAINAN = #NGAYTAINAN#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="THOIGIANTAINAN">
        THOIGIANTAINAN = #THOIGIANTAINAN#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NOITAINAN_TINHTHANH_ID">
        NOITAINAN_TINHTHANH_ID = #NOITAINAN_TINHTHANH_ID#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NOITAINAN_QUANHUYEN_ID">
        NOITAINAN_QUANHUYEN_ID = #NOITAINAN_QUANHUYEN_ID#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NOITAINAN_PHUONGXA_ID">
        NOITAINAN_PHUONGXA_ID = #NOITAINAN_PHUONGXA_ID#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NOITAINAN_DIACHI">
        NOITAINAN_DIACHI = #NOITAINAN_DIACHI#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="DIADIEMTAINAN_ID">
        DIADIEMTAINAN_ID = #DIADIEMTAINAN_ID#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="BOPHANBITHUONG_ID">
        BOPHANBITHUONG_ID = #BOPHANBITHUONG_ID#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="MUCDO_ID">
        MUCDO_ID = #MUCDO_ID#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="DIENBIENSAUTN_ID">
        DIENBIENSAUTN_ID = #DIENBIENSAUTN_ID#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="XUTRISAUTN_ID">
        XUTRISAUTN_ID = #XUTRISAUTN_ID#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGUYENNHAN_ID">
        NGUYENNHAN_ID = #NGUYENNHAN_ID#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGUYENNHANCHITIET_ID">
        NGUYENNHANCHITIET_ID = #NGUYENNHANCHITIET_ID#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="ICD_NGUYENNHAN">
        ICD_NGUYENNHAN = #ICD_NGUYENNHAN#
      </isPropertyAvailable>
      <!--<isPropertyAvailable prepend="," property="NGAYTAO">
        NGAYTAO = #NGAYTAO#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGUOITAO_ID">
        NGUOITAO_ID = #NGUOITAO_ID#
      </isPropertyAvailable>-->
      <isPropertyAvailable prepend="," property="NGAYCAPNHAT">
        NGAYCAPNHAT = #NGAYCAPNHAT#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGUOICAPNHAT_ID">
        NGUOICAPNHAT_ID = #NGUOICAPNHAT_ID#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="BENHANCHUYENKHOA">
        BENHANCHUYENKHOA = #BENHANCHUYENKHOA#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="CHANDOANVAOVIEN">
        CHANDOANVAOVIEN = #CHANDOANVAOVIEN#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="CHANDOANRAVIEN">
        CHANDOANRAVIEN = #CHANDOANRAVIEN#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="DIEUTRITUNGAY">
        DIEUTRITUNGAY = #DIEUTRITUNGAY#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="DIEUTRIDENNGAY">
        DIEUTRIDENNGAY = #DIEUTRIDENNGAY#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="DIENBIENLS">
        DIENBIENLS = #DIENBIENLS#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="KQXETNGHIEM">
        KQXETNGHIEM = #KQXETNGHIEM#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="PHAUTHUAT">
        PHAUTHUAT = #PHAUTHUAT#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="THUTHUAT">
        THUTHUAT = #THUTHUAT#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="TINHTRANGNGUOIBENH">
        TINHTRANGNGUOIBENH = #TINHTRANGNGUOIBENH#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="HUONGDIEUTRI">
        HUONGDIEUTRI = #HUONGDIEUTRI#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGUOIGIAO_ID">
        NGUOIGIAO_ID = #NGUOIGIAO_ID#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGUOINHAN_ID">
        NGUOINHAN_ID = #NGUOINHAN_ID#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="XQUANG">
        XQUANG = #XQUANG#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="CTSCANNER">
        CTSCANNER = #CTSCANNER#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="SIEUAM">
        SIEUAM = #SIEUAM#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="XETNGHIEM">
        XETNGHIEM = #XETNGHIEM#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="KHAC">
        KHAC = #KHAC#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="TOANBOHS">
        TOANBOHS = #TOANBOHS#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="LOAICHUYENKHOA">
        LOAICHUYENKHOA = #LOAICHUYENKHOA#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="CONGANCANTHIEP">
        CONGANCANTHIEP = #CONGANCANTHIEP#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="CDRR_BENHCHINH">
        CDRR_BENHCHINH = #CDRR_BENHCHINH#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="CDRR_BENHKEM">
        CDRR_BENHKEM = #CDRR_BENHKEM#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="ICD_BENHCHINH">
        ICD_BENHCHINH = #ICD_BENHCHINH#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="ICD_BENHKEMTHEO">
        ICD_BENHKEMTHEO = #ICD_BENHKEMTHEO#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="PHUONGPHAPDIEUTRI">
        PHUONGPHAPDIEUTRI = #PHUONGPHAPDIEUTRI#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="CHUYENKHOA_ID">
        CHUYENKHOA_ID = #CHUYENKHOA_ID#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="FIELD_1">
        FIELD_1 = #FIELD_1#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="FIELD_2">
        FIELD_2 = #FIELD_2#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="FIELD_3">
        FIELD_3 = #FIELD_3#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="FIELD_4">
        FIELD_4 = #FIELD_4#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="FIELD_5">
        FIELD_5 = #FIELD_5#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="FIELD_6">
        FIELD_6 = #FIELD_6#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="FIELD_7">
        FIELD_7 = #FIELD_7#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="FIELD_8">
        FIELD_8 = #FIELD_8#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="FIELD_9">
        FIELD_9 = #FIELD_9#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="FIELD_10">
        FIELD_10 = #FIELD_10#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="FIELD_11">
        FIELD_11 = #FIELD_11#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="FIELD_12">
        FIELD_12 = #FIELD_12#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="FIELD_13">
        FIELD_13 = #FIELD_13#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="FIELD_14">
        FIELD_14 = #FIELD_14#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="FIELD_15">
        FIELD_15 = #FIELD_15#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="FIELD_27">
        FIELD_27 = #FIELD_27#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="FIELD_28">
        FIELD_28 = #FIELD_28#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="FIELD_29">
        FIELD_29 = #FIELD_29#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="FIELD_30">
        FIELD_30 = #FIELD_30#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="FIELD_31">
        FIELD_31 = #FIELD_31#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="FIELD_32">
        FIELD_32 = #FIELD_32#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="FIELD_33">
        FIELD_33 = #FIELD_33#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="FIELD_34">
        FIELD_34 = #FIELD_34#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="FIELD_35">
        FIELD_35 = #FIELD_35#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="FIELD_36">
        FIELD_36 = #FIELD_36#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="FIELD_37">
        FIELD_37 = #FIELD_37#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="FIELD_38">
        FIELD_38 = #FIELD_38#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="FIELD_39">
        FIELD_39 = #FIELD_39#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="FIELD_40">
        FIELD_40 = #FIELD_40#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="FIELD_41">
        FIELD_41 = #FIELD_41#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="FIELD_42">
        FIELD_42 = #FIELD_42#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="FIELD_43">
        FIELD_43 = #FIELD_43#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="FIELD_44">
        FIELD_44 = #FIELD_44#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="FIELD_45">
        FIELD_45 = #FIELD_45#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="FIELD_46">
        FIELD_46 = #FIELD_46#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="FIELD_47">
        FIELD_47 = #FIELD_47#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="FIELD_48">
        FIELD_48 = #FIELD_48#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="FIELD_49">
        FIELD_49 = #FIELD_49#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="FIELD_50">
        FIELD_50 = #FIELD_50#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="FIELD_51">
        FIELD_51 = #FIELD_51#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="FIELD_52">
        FIELD_52 = #FIELD_52#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="FIELD_53">
        FIELD_53 = #FIELD_53#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="FIELD_54">
        FIELD_54 = #FIELD_54#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="FIELD_55">
        FIELD_55 = #FIELD_55#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="FIELD_56">
        FIELD_56 = #FIELD_56#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="BENHVIEN_ID">
        BENHVIEN_ID = #BENHVIEN_ID#
      </isPropertyAvailable>
      where
      TIEPNHAN_ID = '$TIEPNHAN_ID$'
    </update>
    <statement id="DAO00080_UpdateNgoaiTruKhambenhBenhan" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      IF EXISTS (
      SELECT NTKHAMBENH_BENHAN_ID
      FROM TT_NGOAITRU_KHAMBENH_BENHAN
      WHERE DVYEUCAU_ID='$DVYEUCAU_ID$' and TIEPNHAN_ID = '$TIEPNHAN_ID$')
      BEGIN
      update TT_NGOAITRU_KHAMBENH_BENHAN set
      TIEPNHAN_ID = #TIEPNHAN_ID#
      <isPropertyAvailable prepend="," property="NGUOILIENHE">
        NGUOILIENHE = #NGUOILIENHE#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="DIENTHOAILIENHE">
        DIENTHOAILIENHE = #DIENTHOAILIENHE#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NOILAMVIEC">
        NOILAMVIEC = #NOILAMVIEC#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="CHANDOANNOIGIOITHIEU">
        CHANDOANNOIGIOITHIEU = #CHANDOANNOIGIOITHIEU#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGAYKHAM">
        NGAYKHAM = #NGAYKHAM#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="THOIGIANKHAM">
        THOIGIANKHAM = #THOIGIANKHAM#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="LYDOVAOVIEN">
        LYDOVAOVIEN = #LYDOVAOVIEN#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="QUATRINHBENHLY">
        QUATRINHBENHLY = #QUATRINHBENHLY#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="TIENSUBANTHAN">
        TIENSUBANTHAN = #TIENSUBANTHAN#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="TIENSUGIADINH">
        TIENSUGIADINH = #TIENSUGIADINH#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="KHAMXETTOANTHAN">
        KHAMXETTOANTHAN = #KHAMXETTOANTHAN#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="KHAMXETCACBOPHAN">
        KHAMXETCACBOPHAN = #KHAMXETCACBOPHAN#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="KHAMXETKQLS">
        KHAMXETKQLS = #KHAMXETKQLS#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="CHANDOANVAO">
        CHANDOANVAO = #CHANDOANVAO#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="ICDKHAMXET_ID">
        ICDKHAMXET_ID = #ICDKHAMXET_ID#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="DAXULY">
        DAXULY = #DAXULY#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGAYRA">
        NGAYRA = #NGAYRA#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="THOIGIANRA">
        THOIGIANRA = #THOIGIANRA#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NHAPKHOA_ID">
        NHAPKHOA_ID = #NHAPKHOA_ID#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="CHUYENVIEN_ID">
        CHUYENVIEN_ID = #CHUYENVIEN_ID#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="CHUY">
        CHUY = #CHUY#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="MACH">
        MACH = #MACH#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NHIETDO">
        NHIETDO = #NHIETDO#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="HUYETAPCAO">
        HUYETAPCAO = #HUYETAPCAO#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="HUYETAPTHAP">
        HUYETAPTHAP = #HUYETAPTHAP#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NHIPTHO">
        NHIPTHO = #NHIPTHO#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="CANNANG">
        CANNANG = #CANNANG#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="CHIEUCAO">
        CHIEUCAO = #CHIEUCAO#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="BACSI_ID">
        BACSI_ID = #BACSI_ID#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="XUTRUKHAMBENH_ID">
        XUTRUKHAMBENH_ID = #XUTRUKHAMBENH_ID#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="CAPCUU">
        CAPCUU = #CAPCUU#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGAYTAINAN">
        NGAYTAINAN = #NGAYTAINAN#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="THOIGIANTAINAN">
        THOIGIANTAINAN = #THOIGIANTAINAN#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NOITAINAN_TINHTHANH_ID">
        NOITAINAN_TINHTHANH_ID = #NOITAINAN_TINHTHANH_ID#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NOITAINAN_QUANHUYEN_ID">
        NOITAINAN_QUANHUYEN_ID = #NOITAINAN_QUANHUYEN_ID#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NOITAINAN_PHUONGXA_ID">
        NOITAINAN_PHUONGXA_ID = #NOITAINAN_PHUONGXA_ID#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NOITAINAN_DIACHI">
        NOITAINAN_DIACHI = #NOITAINAN_DIACHI#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="DIADIEMTAINAN_ID">
        DIADIEMTAINAN_ID = #DIADIEMTAINAN_ID#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="BOPHANBITHUONG_ID">
        BOPHANBITHUONG_ID = #BOPHANBITHUONG_ID#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="MUCDO_ID">
        MUCDO_ID = #MUCDO_ID#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="DIENBIENSAUTN_ID">
        DIENBIENSAUTN_ID = #DIENBIENSAUTN_ID#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="XUTRISAUTN_ID">
        XUTRISAUTN_ID = #XUTRISAUTN_ID#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGUYENNHAN_ID">
        NGUYENNHAN_ID = #NGUYENNHAN_ID#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGUYENNHANCHITIET_ID">
        NGUYENNHANCHITIET_ID = #NGUYENNHANCHITIET_ID#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="ICD_NGUYENNHAN">
        ICD_NGUYENNHAN = #ICD_NGUYENNHAN#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGAYCAPNHAT">
        NGAYCAPNHAT = #NGAYCAPNHAT#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGUOICAPNHAT_ID">
        NGUOICAPNHAT_ID = #NGUOICAPNHAT_ID#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="BENHANCHUYENKHOA">
        BENHANCHUYENKHOA = #BENHANCHUYENKHOA#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="CHANDOANVAOVIEN">
        CHANDOANVAOVIEN = #CHANDOANVAOVIEN#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="CHANDOANRAVIEN">
        CHANDOANRAVIEN = #CHANDOANRAVIEN#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="DIEUTRITUNGAY">
        DIEUTRITUNGAY = #DIEUTRITUNGAY#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="DIEUTRIDENNGAY">
        DIEUTRIDENNGAY = #DIEUTRIDENNGAY#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="DIENBIENLS">
        DIENBIENLS = #DIENBIENLS#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="KQXETNGHIEM">
        KQXETNGHIEM = #KQXETNGHIEM#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="PHAUTHUAT">
        PHAUTHUAT = #PHAUTHUAT#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="THUTHUAT">
        THUTHUAT = #THUTHUAT#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="TINHTRANGNGUOIBENH">
        TINHTRANGNGUOIBENH = #TINHTRANGNGUOIBENH#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="HUONGDIEUTRI">
        HUONGDIEUTRI = #HUONGDIEUTRI#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGUOIGIAO_ID">
        NGUOIGIAO_ID = #NGUOIGIAO_ID#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGUOINHAN_ID">
        NGUOINHAN_ID = #NGUOINHAN_ID#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="XQUANG">
        XQUANG = #XQUANG#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="CTSCANNER">
        CTSCANNER = #CTSCANNER#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="SIEUAM">
        SIEUAM = #SIEUAM#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="XETNGHIEM">
        XETNGHIEM = #XETNGHIEM#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="KHAC">
        KHAC = #KHAC#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="TOANBOHS">
        TOANBOHS = #TOANBOHS#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="LOAICHUYENKHOA">
        LOAICHUYENKHOA = #LOAICHUYENKHOA#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="CONGANCANTHIEP">
        CONGANCANTHIEP = #CONGANCANTHIEP#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="CDRR_BENHCHINH">
        CDRR_BENHCHINH = #CDRR_BENHCHINH#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="CDRR_BENHKEM">
        CDRR_BENHKEM = #CDRR_BENHKEM#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="ICD_BENHCHINH">
        ICD_BENHCHINH = #ICD_BENHCHINH#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="ICD_BENHKEMTHEO">
        ICD_BENHKEMTHEO = #ICD_BENHKEMTHEO#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="PHUONGPHAPDIEUTRI">
        PHUONGPHAPDIEUTRI = #PHUONGPHAPDIEUTRI#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="CHUYENKHOA_ID">
        CHUYENKHOA_ID = #CHUYENKHOA_ID#
      </isPropertyAvailable>
      where
      DVYEUCAU_ID='$DVYEUCAU_ID$' and TIEPNHAN_ID = '$TIEPNHAN_ID$'
      END
      ELSE
      BEGIN
      insert into TT_NGOAITRU_KHAMBENH_BENHAN (
      TIEPNHAN_ID
      , DVYEUCAU_ID
      , DICHVU_ID
      , KHAMBENH_ID
      , BENHNHAN_ID
      , NGUOILIENHE
      , DIENTHOAILIENHE
      , NOILAMVIEC
      , CHANDOANNOIGIOITHIEU
      , NGAYKHAM
      , THOIGIANKHAM
      , LYDOVAOVIEN
      , QUATRINHBENHLY
      , TIENSUBANTHAN
      , TIENSUGIADINH
      , KHAMXETTOANTHAN
      , KHAMXETCACBOPHAN
      , KHAMXETKQLS
      , CHANDOANVAO
      , ICDKHAMXET_ID
      , DAXULY
      , NGAYRA
      , THOIGIANRA
      , NHAPKHOA_ID
      , CHUYENVIEN_ID
      , CHUY
      , MACH
      , NHIETDO
      , HUYETAPCAO
      , HUYETAPTHAP
      , NHIPTHO
      , CANNANG
      , CHIEUCAO
      , BACSI_ID
      , XUTRUKHAMBENH_ID
      , CAPCUU
      , NGAYTAINAN
      , THOIGIANTAINAN
      , NOITAINAN_TINHTHANH_ID
      , NOITAINAN_QUANHUYEN_ID
      , NOITAINAN_PHUONGXA_ID
      , NOITAINAN_DIACHI
      , DIADIEMTAINAN_ID
      , BOPHANBITHUONG_ID
      , MUCDO_ID
      , DIENBIENSAUTN_ID
      , XUTRISAUTN_ID
      , NGUYENNHAN_ID
      , NGUYENNHANCHITIET_ID
      , ICD_NGUYENNHAN
      , NGAYTAO
      , NGUOITAO_ID
      , NGAYCAPNHAT
      , NGUOICAPNHAT_ID
      , BENHANCHUYENKHOA
      , CHANDOANVAOVIEN
      , CHANDOANRAVIEN
      , DIEUTRITUNGAY
      , DIEUTRIDENNGAY
      , DIENBIENLS
      , KQXETNGHIEM
      , PHAUTHUAT
      , THUTHUAT
      , TINHTRANGNGUOIBENH
      , HUONGDIEUTRI
      , NGUOIGIAO_ID
      , NGUOINHAN_ID
      , XQUANG
      , CTSCANNER
      , SIEUAM
      , XETNGHIEM
      , KHAC
      , TOANBOHS
      , LOAICHUYENKHOA
      , CONGANCANTHIEP
      , CDRR_BENHCHINH
      , CDRR_BENHKEM
      , ICD_BENHCHINH
      , ICD_BENHKEMTHEO
      , PHUONGPHAPDIEUTRI
      , BENHVIEN_ID
      ) values (
      #TIEPNHAN_ID#
      , #DVYEUCAU_ID#
      , #DICHVU_ID#
      , #KHAMBENH_ID#
      , #BENHNHAN_ID#
      , #NGUOILIENHE#
      , #DIENTHOAILIENHE#
      , #NOILAMVIEC#
      , #CHANDOANNOIGIOITHIEU#
      , #NGAYKHAM#
      , #THOIGIANKHAM#
      , #LYDOVAOVIEN#
      , #QUATRINHBENHLY#
      , #TIENSUBANTHAN#
      , #TIENSUGIADINH#
      , #KHAMXETTOANTHAN#
      , #KHAMXETCACBOPHAN#
      , #KHAMXETKQLS#
      , #CHANDOANVAO#
      , #ICDKHAMXET_ID#
      , #DAXULY#
      , #NGAYRA#
      , #THOIGIANRA#
      , #NHAPKHOA_ID#
      , #CHUYENVIEN_ID#
      , #CHUY#
      , #MACH#
      , #NHIETDO#
      , #HUYETAPCAO#
      , #HUYETAPTHAP#
      , #NHIPTHO#
      , #CANNANG#
      , #CHIEUCAO#
      , #BACSI_ID#
      , #XUTRUKHAMBENH_ID#
      , #CAPCUU#
      , #NGAYTAINAN#
      , #THOIGIANTAINAN#
      , #NOITAINAN_TINHTHANH_ID#
      , #NOITAINAN_QUANHUYEN_ID#
      , #NOITAINAN_PHUONGXA_ID#
      , #NOITAINAN_DIACHI#
      , #DIADIEMTAINAN_ID#
      , #BOPHANBITHUONG_ID#
      , #MUCDO_ID#
      , #DIENBIENSAUTN_ID#
      , #XUTRISAUTN_ID#
      , #NGUYENNHAN_ID#
      , #NGUYENNHANCHITIET_ID#
      , #ICD_NGUYENNHAN#
      , #NGAYTAO#
      , #NGUOITAO_ID#
      , #NGAYCAPNHAT#
      , #NGUOICAPNHAT_ID#
      , #BENHANCHUYENKHOA#
      , #CHANDOANVAOVIEN#
      , #CHANDOANRAVIEN#
      , #DIEUTRITUNGAY#
      , #DIEUTRIDENNGAY#
      , #DIENBIENLS#
      , #KQXETNGHIEM#
      , #PHAUTHUAT#
      , #THUTHUAT#
      , #TINHTRANGNGUOIBENH#
      , #HUONGDIEUTRI#
      , #NGUOIGIAO_ID#
      , #NGUOINHAN_ID#
      , #XQUANG#
      , #CTSCANNER#
      , #SIEUAM#
      , #XETNGHIEM#
      , #KHAC#
      , #TOANBOHS#
      , #LOAICHUYENKHOA#
      , #CONGANCANTHIEP#
      , #CDRR_BENHCHINH#
      , #CDRR_BENHKEM#
      , #ICD_BENHCHINH#
      , #ICD_BENHKEMTHEO#
      , #PHUONGPHAPDIEUTRI#
      , #BENHVIEN_ID#
      )
      END
    </statement>


    <statement id="DAO00080_UpdatePhieuKhamBenhNhapVien" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      IF EXISTS (
      SELECT PHIEU_KHAMBENH_VAOVIEN_ID
      FROM TT_PHIEU_KHAMBENH_VAOVIEN
      WHERE KHAMBENH_ID = #KHAMBENH_ID#)
      BEGIN
      update TT_PHIEU_KHAMBENH_VAOVIEN set
      TIEPNHAN_ID = #TIEPNHAN_ID#
      <isPropertyAvailable prepend="," property="BENHNHAN_ID">
        BENHNHAN_ID = #BENHNHAN_ID#
      </isPropertyAvailable>

      <isPropertyAvailable prepend="," property="KHAMBENH_ID">
        KHAMBENH_ID = #KHAMBENH_ID#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NHAPKHOA_ID">
        NHAPKHOA_ID = #NHAPKHOA_ID#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="KHAMBENH_SINHHIEU_ID">
        KHAMBENH_SINHHIEU_ID = #KHAMBENH_SINHHIEU_ID#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="CHANDOANNOIGIOITHIEU">
        CHANDOANNOIGIOITHIEU = #CHANDOANNOIGIOITHIEU#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="LYDOVAOVIEN">
        LYDOVAOVIEN = #LYDOVAOVIEN#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="ICDKHAMXET_ID">
        ICDKHAMXET_ID = #ICDKHAMXET_ID#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="QUATRINHBENHLY">
        QUATRINHBENHLY = #QUATRINHBENHLY#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="TIENSUBANTHAN">
        TIENSUBANTHAN = #TIENSUBANTHAN#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="TIENSUGIADINH">
        TIENSUGIADINH = #TIENSUGIADINH#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="KHAMXETTOANTHAN">
        KHAMXETTOANTHAN = #KHAMXETTOANTHAN#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="KHAMXETCACBOPHAN">
        KHAMXETCACBOPHAN = #KHAMXETCACBOPHAN#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="KHAMXETKQLS">
        KHAMXETKQLS = #KHAMXETKQLS#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="CHUY">
        CHUY = #CHUY#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="BENHANCHUYENKHOA">
        BENHANCHUYENKHOA = #BENHANCHUYENKHOA#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="CHANDOANVAOVIEN">
        CHANDOANVAOVIEN = #CHANDOANVAOVIEN#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="CHANDOANRAVIEN">
        CHANDOANRAVIEN = #CHANDOANRAVIEN#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGUOILIENHE">
        NGUOILIENHE = #NGUOILIENHE#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="DIENTHOAILIENHE">
        DIENTHOAILIENHE = #DIENTHOAILIENHE#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="BENHVIEN_ID">
        BENHVIEN_ID = #BENHVIEN_ID#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGAYTAO">
        NGAYTAO = #NGAYTAO#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGUOITAO_ID">
        NGUOITAO_ID = #NGUOITAO_ID#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGAYCAPNHAT">
        NGAYCAPNHAT = #NGAYCAPNHAT#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGUOICAPNHAT_ID">
        NGUOICAPNHAT_ID = #NGUOICAPNHAT_ID#
      </isPropertyAvailable>

      <isPropertyAvailable prepend="," property="NOILAMVIEC">
        NOILAMVIEC = #NOILAMVIEC#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="DAXULY">
        DAXULY = #DAXULY#
      </isPropertyAvailable>

      WHERE KHAMBENH_ID = #KHAMBENH_ID#
      SELECT @@ROWCOUNT AS ROWAFFECTED
      END

      ELSE
      BEGIN
      insert into [TT_PHIEU_KHAMBENH_VAOVIEN] (
      BENHNHAN_ID
      , TIEPNHAN_ID
      , KHAMBENH_ID
      , NHAPKHOA_ID
      , KHAMBENH_SINHHIEU_ID
      , CHANDOANNOIGIOITHIEU
      , LYDOVAOVIEN
      , ICDKHAMXET_ID
      , QUATRINHBENHLY
      , TIENSUBANTHAN
      , TIENSUGIADINH
      , KHAMXETTOANTHAN
      , KHAMXETCACBOPHAN
      , KHAMXETKQLS
      , CHUY
      , BENHANCHUYENKHOA
      , CHANDOANVAOVIEN
      , CHANDOANRAVIEN
      , NGUOILIENHE
      , DIENTHOAILIENHE
      , BENHVIEN_ID
      , NGAYTAO
      , NGUOITAO_ID
      , NOILAMVIEC
      , DAXULY

      ) values (
      #BENHNHAN_ID#
      , #TIEPNHAN_ID#
      , #KHAMBENH_ID#
      , #NHAPKHOA_ID#
      , #KHAMBENH_SINHHIEU_ID#
      , #CHANDOANNOIGIOITHIEU#
      , #LYDOVAOVIEN#
      , #ICDKHAMXET_ID#
      , #QUATRINHBENHLY#
      , #TIENSUBANTHAN#
      , #TIENSUGIADINH#
      , #KHAMXETTOANTHAN#
      , #KHAMXETCACBOPHAN#
      , #KHAMXETKQLS#
      , #CHUY#
      , #BENHANCHUYENKHOA#
      , #CHANDOANVAOVIEN#
      , #CHANDOANRAVIEN#
      , #NGUOILIENHE#
      , #DIENTHOAILIENHE#
      , #BENHVIEN_ID#
      , #NGAYTAO#
      , #NGUOITAO_ID#
      , #NOILAMVIEC#
      , #DAXULY#
      )
      SELECT @@ROWCOUNT AS ROWAFFECTED
      END
    </statement>

    <statement id="DAO00080_DeletePhieuKhamBenhNhapVien" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      IF EXISTS (
      SELECT PHIEU_KHAMBENH_VAOVIEN_ID
      FROM TT_PHIEU_KHAMBENH_VAOVIEN
      WHERE KHAMBENH_ID = #KHAMBENH_ID# AND BENHVIEN_ID = '$BENHVIEN_ID$')
      BEGIN
      DELETE FROM TT_PHIEU_KHAMBENH_VAOVIEN
      WHERE KHAMBENH_ID = #KHAMBENH_ID# AND BENHVIEN_ID = '$BENHVIEN_ID$'
      SELECT @@ROWCOUNT AS ROWAFFECTED
      END
      ELSE
      BEGIN
      SELECT 0  AS ROWAFFECTED
      END
    </statement>
    <insert id="DAO00080_Add_TT_NGOAITRU_KHAMBENH_BENHAN" parameterClass="System.Collections.IDictionary" resultClass="System.Int64">
      insert into TT_NGOAITRU_KHAMBENH_BENHAN (
      TIEPNHAN_ID
      , DVYEUCAU_ID
      , DICHVU_ID
      , KHAMBENH_ID
      , BENHNHAN_ID
      , NGUOILIENHE
      , DIENTHOAILIENHE
      , NOILAMVIEC
      , CHANDOANNOIGIOITHIEU
      , NGAYKHAM
      , THOIGIANKHAM
      , LYDOVAOVIEN
      , QUATRINHBENHLY
      , TIENSUBANTHAN
      , TIENSUGIADINH
      , KHAMXETTOANTHAN
      , KHAMXETCACBOPHAN
      , KHAMXETKQLS
      , CHANDOANVAO
      , ICDKHAMXET_ID
      , DAXULY
      , NGAYRA
      , THOIGIANRA
      , NHAPKHOA_ID
      , CHUYENVIEN_ID
      , CHUY
      , MACH
      , NHIETDO
      , HUYETAPCAO
      , HUYETAPTHAP
      , NHIPTHO
      , CANNANG
      , CHIEUCAO
      , BACSI_ID
      , XUTRUKHAMBENH_ID
      , CAPCUU
      , NGAYTAINAN
      , THOIGIANTAINAN
      , NOITAINAN_TINHTHANH_ID
      , NOITAINAN_QUANHUYEN_ID
      , NOITAINAN_PHUONGXA_ID
      , NOITAINAN_DIACHI
      , DIADIEMTAINAN_ID
      , BOPHANBITHUONG_ID
      , MUCDO_ID
      , DIENBIENSAUTN_ID
      , XUTRISAUTN_ID
      , NGUYENNHAN_ID
      , NGUYENNHANCHITIET_ID
      , ICD_NGUYENNHAN
      , NGAYTAO
      , NGUOITAO_ID
      , NGAYCAPNHAT
      , NGUOICAPNHAT_ID
      , BENHANCHUYENKHOA
      , CHANDOANVAOVIEN
      , CHANDOANRAVIEN
      , DIEUTRITUNGAY
      , DIEUTRIDENNGAY
      , DIENBIENLS
      , KQXETNGHIEM
      , PHAUTHUAT
      , THUTHUAT
      , TINHTRANGNGUOIBENH
      , HUONGDIEUTRI
      , NGUOIGIAO_ID
      , NGUOINHAN_ID
      , XQUANG
      , CTSCANNER
      , SIEUAM
      , XETNGHIEM
      , KHAC
      , TOANBOHS
      , LOAICHUYENKHOA
      , CONGANCANTHIEP
      , CDRR_BENHCHINH
      , CDRR_BENHKEM
      , ICD_BENHCHINH
      , ICD_BENHKEMTHEO
      , PHUONGPHAPDIEUTRI
      , BENHVIEN_ID
      ) values (
      #TIEPNHAN_ID#
      , #DVYEUCAU_ID#
      , #DICHVU_ID#
      , #KHAMBENH_ID#
      , #BENHNHAN_ID#
      , #NGUOILIENHE#
      , #DIENTHOAILIENHE#
      , #NOILAMVIEC#
      , #CHANDOANNOIGIOITHIEU#
      , #NGAYKHAM#
      , #THOIGIANKHAM#
      , #LYDOVAOVIEN#
      , #QUATRINHBENHLY#
      , #TIENSUBANTHAN#
      , #TIENSUGIADINH#
      , #KHAMXETTOANTHAN#
      , #KHAMXETCACBOPHAN#
      , #KHAMXETKQLS#
      , #CHANDOANVAO#
      , #ICDKHAMXET_ID#
      , #DAXULY#
      , #NGAYRA#
      , #THOIGIANRA#
      , #NHAPKHOA_ID#
      , #CHUYENVIEN_ID#
      , #CHUY#
      , #MACH#
      , #NHIETDO#
      , #HUYETAPCAO#
      , #HUYETAPTHAP#
      , #NHIPTHO#
      , #CANNANG#
      , #CHIEUCAO#
      , #BACSI_ID#
      , #XUTRUKHAMBENH_ID#
      , #CAPCUU#
      , #NGAYTAINAN#
      , #THOIGIANTAINAN#
      , #NOITAINAN_TINHTHANH_ID#
      , #NOITAINAN_QUANHUYEN_ID#
      , #NOITAINAN_PHUONGXA_ID#
      , #NOITAINAN_DIACHI#
      , #DIADIEMTAINAN_ID#
      , #BOPHANBITHUONG_ID#
      , #MUCDO_ID#
      , #DIENBIENSAUTN_ID#
      , #XUTRISAUTN_ID#
      , #NGUYENNHAN_ID#
      , #NGUYENNHANCHITIET_ID#
      , #ICD_NGUYENNHAN#
      , #NGAYTAO#
      , #NGUOITAO_ID#
      , #NGAYCAPNHAT#
      , #NGUOICAPNHAT_ID#
      , #BENHANCHUYENKHOA#
      , #CHANDOANVAOVIEN#
      , #CHANDOANRAVIEN#
      , #DIEUTRITUNGAY#
      , #DIEUTRIDENNGAY#
      , #DIENBIENLS#
      , #KQXETNGHIEM#
      , #PHAUTHUAT#
      , #THUTHUAT#
      , #TINHTRANGNGUOIBENH#
      , #HUONGDIEUTRI#
      , #NGUOIGIAO_ID#
      , #NGUOINHAN_ID#
      , #XQUANG#
      , #CTSCANNER#
      , #SIEUAM#
      , #XETNGHIEM#
      , #KHAC#
      , #TOANBOHS#
      , #LOAICHUYENKHOA#
      , #CONGANCANTHIEP#
      , #CDRR_BENHCHINH#
      , #CDRR_BENHKEM#
      , #ICD_BENHCHINH#
      , #ICD_BENHKEMTHEO#
      , #PHUONGPHAPDIEUTRI#
      , #BENHVIEN_ID#
      )
    </insert>
    <update id="DAO00080_Update_TT_NGOAITRU_KHAMBENH_BENHAN" parameterClass="System.Collections.IDictionary">
      update TT_NGOAITRU_KHAMBENH_BENHAN set
      TIEPNHAN_ID = #TIEPNHAN_ID#
      <isPropertyAvailable prepend="," property="NGUOILIENHE">
        NGUOILIENHE = #NGUOILIENHE#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="DIENTHOAILIENHE">
        DIENTHOAILIENHE = #DIENTHOAILIENHE#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NOILAMVIEC">
        NOILAMVIEC = #NOILAMVIEC#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="CHANDOANNOIGIOITHIEU">
        CHANDOANNOIGIOITHIEU = #CHANDOANNOIGIOITHIEU#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGAYKHAM">
        NGAYKHAM = #NGAYKHAM#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="THOIGIANKHAM">
        THOIGIANKHAM = #THOIGIANKHAM#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="LYDOVAOVIEN">
        LYDOVAOVIEN = #LYDOVAOVIEN#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="QUATRINHBENHLY">
        QUATRINHBENHLY = #QUATRINHBENHLY#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="TIENSUBANTHAN">
        TIENSUBANTHAN = #TIENSUBANTHAN#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="TIENSUGIADINH">
        TIENSUGIADINH = #TIENSUGIADINH#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="KHAMXETTOANTHAN">
        KHAMXETTOANTHAN = #KHAMXETTOANTHAN#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="KHAMXETCACBOPHAN">
        KHAMXETCACBOPHAN = #KHAMXETCACBOPHAN#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="KHAMXETKQLS">
        KHAMXETKQLS = #KHAMXETKQLS#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="CHANDOANVAO">
        CHANDOANVAO = #CHANDOANVAO#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="ICDKHAMXET_ID">
        ICDKHAMXET_ID = #ICDKHAMXET_ID#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="DAXULY">
        DAXULY = #DAXULY#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGAYRA">
        NGAYRA = #NGAYRA#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="THOIGIANRA">
        THOIGIANRA = #THOIGIANRA#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NHAPKHOA_ID">
        NHAPKHOA_ID = #NHAPKHOA_ID#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="CHUYENVIEN_ID">
        CHUYENVIEN_ID = #CHUYENVIEN_ID#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="CHUY">
        CHUY = #CHUY#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="MACH">
        MACH = #MACH#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NHIETDO">
        NHIETDO = #NHIETDO#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="HUYETAPCAO">
        HUYETAPCAO = #HUYETAPCAO#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="HUYETAPTHAP">
        HUYETAPTHAP = #HUYETAPTHAP#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NHIPTHO">
        NHIPTHO = #NHIPTHO#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="CANNANG">
        CANNANG = #CANNANG#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="CHIEUCAO">
        CHIEUCAO = #CHIEUCAO#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="BACSI_ID">
        BACSI_ID = #BACSI_ID#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="XUTRUKHAMBENH_ID">
        XUTRUKHAMBENH_ID = #XUTRUKHAMBENH_ID#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="CAPCUU">
        CAPCUU = #CAPCUU#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGAYTAINAN">
        NGAYTAINAN = #NGAYTAINAN#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="THOIGIANTAINAN">
        THOIGIANTAINAN = #THOIGIANTAINAN#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NOITAINAN_TINHTHANH_ID">
        NOITAINAN_TINHTHANH_ID = #NOITAINAN_TINHTHANH_ID#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NOITAINAN_QUANHUYEN_ID">
        NOITAINAN_QUANHUYEN_ID = #NOITAINAN_QUANHUYEN_ID#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NOITAINAN_PHUONGXA_ID">
        NOITAINAN_PHUONGXA_ID = #NOITAINAN_PHUONGXA_ID#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NOITAINAN_DIACHI">
        NOITAINAN_DIACHI = #NOITAINAN_DIACHI#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="DIADIEMTAINAN_ID">
        DIADIEMTAINAN_ID = #DIADIEMTAINAN_ID#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="BOPHANBITHUONG_ID">
        BOPHANBITHUONG_ID = #BOPHANBITHUONG_ID#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="MUCDO_ID">
        MUCDO_ID = #MUCDO_ID#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="DIENBIENSAUTN_ID">
        DIENBIENSAUTN_ID = #DIENBIENSAUTN_ID#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="XUTRISAUTN_ID">
        XUTRISAUTN_ID = #XUTRISAUTN_ID#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGUYENNHAN_ID">
        NGUYENNHAN_ID = #NGUYENNHAN_ID#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGUYENNHANCHITIET_ID">
        NGUYENNHANCHITIET_ID = #NGUYENNHANCHITIET_ID#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="ICD_NGUYENNHAN">
        ICD_NGUYENNHAN = #ICD_NGUYENNHAN#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGAYCAPNHAT">
        NGAYCAPNHAT = #NGAYCAPNHAT#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGUOICAPNHAT_ID">
        NGUOICAPNHAT_ID = #NGUOICAPNHAT_ID#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="BENHANCHUYENKHOA">
        BENHANCHUYENKHOA = #BENHANCHUYENKHOA#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="CHANDOANVAOVIEN">
        CHANDOANVAOVIEN = #CHANDOANVAOVIEN#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="CHANDOANRAVIEN">
        CHANDOANRAVIEN = #CHANDOANRAVIEN#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="DIEUTRITUNGAY">
        DIEUTRITUNGAY = #DIEUTRITUNGAY#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="DIEUTRIDENNGAY">
        DIEUTRIDENNGAY = #DIEUTRIDENNGAY#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="DIENBIENLS">
        DIENBIENLS = #DIENBIENLS#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="KQXETNGHIEM">
        KQXETNGHIEM = #KQXETNGHIEM#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="PHAUTHUAT">
        PHAUTHUAT = #PHAUTHUAT#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="THUTHUAT">
        THUTHUAT = #THUTHUAT#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="TINHTRANGNGUOIBENH">
        TINHTRANGNGUOIBENH = #TINHTRANGNGUOIBENH#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="HUONGDIEUTRI">
        HUONGDIEUTRI = #HUONGDIEUTRI#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGUOIGIAO_ID">
        NGUOIGIAO_ID = #NGUOIGIAO_ID#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGUOINHAN_ID">
        NGUOINHAN_ID = #NGUOINHAN_ID#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="XQUANG">
        XQUANG = #XQUANG#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="CTSCANNER">
        CTSCANNER = #CTSCANNER#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="SIEUAM">
        SIEUAM = #SIEUAM#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="XETNGHIEM">
        XETNGHIEM = #XETNGHIEM#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="KHAC">
        KHAC = #KHAC#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="TOANBOHS">
        TOANBOHS = #TOANBOHS#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="LOAICHUYENKHOA">
        LOAICHUYENKHOA = #LOAICHUYENKHOA#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="CONGANCANTHIEP">
        CONGANCANTHIEP = #CONGANCANTHIEP#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="CDRR_BENHCHINH">
        CDRR_BENHCHINH = #CDRR_BENHCHINH#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="CDRR_BENHKEM">
        CDRR_BENHKEM = #CDRR_BENHKEM#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="ICD_BENHCHINH">
        ICD_BENHCHINH = #ICD_BENHCHINH#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="ICD_BENHKEMTHEO">
        ICD_BENHKEMTHEO = #ICD_BENHKEMTHEO#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="PHUONGPHAPDIEUTRI">
        PHUONGPHAPDIEUTRI = #PHUONGPHAPDIEUTRI#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="CHUYENKHOA_ID">
        CHUYENKHOA_ID = #CHUYENKHOA_ID#
      </isPropertyAvailable>
      where
      NTKHAMBENH_BENHAN_ID = '$NTKHAMBENH_BENHAN_ID$'
    </update>
    <statement id="DAO00080_Add_BenhAn_NgoaiKhoa" parameterClass="System.Collections.IDictionary" resultClass="System.Int64">
      IF EXISTS
      (
      SELECT BENHAN_ID
      FROM TT_NOITRU_BENHAN_NGOAIKHOA
      WHERE
      BENHAN_ID = '$BENHAN_ID$'
      )
      BEGIN
      update TT_NOITRU_BENHAN_NGOAIKHOA set
      BENHAN_ID = #BENHAN_ID#
      <isPropertyAvailable prepend="," property="BENHNGOAIKHOA">
        BENHNGOAIKHOA = #BENHNGOAIKHOA#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="KHIVAOKHOA_BENHCHINH">
        KHIVAOKHOA_BENHCHINH = #KHIVAOKHOA_BENHCHINH#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="KHIVAOKHOA_BENHPHU">
        KHIVAOKHOA_BENHPHU = #KHIVAOKHOA_BENHPHU#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="KHIVAOKHOA_PHANBIET">
        KHIVAOKHOA_PHANBIET = #KHIVAOKHOA_PHANBIET#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="BENHVIEN_ID">
        BENHVIEN_ID = '$BENHVIEN_ID$'
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGAYCAPNHAT">
        NGAYCAPNHAT = '$NGAYCAPNHAT$'
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGUOICAPNHAT_ID">
        NGUOICAPNHAT_ID = '$NGUOICAPNHAT_ID$'
      </isPropertyAvailable>
      where
      BENHAN_ID = '$BENHAN_ID$'
      END
      ELSE
      BEGIN
      insert into TT_NOITRU_BENHAN_NGOAIKHOA (
      BENHAN_ID
      , BENHNGOAIKHOA
      , KHIVAOKHOA_BENHCHINH
      , KHIVAOKHOA_BENHPHU
      , KHIVAOKHOA_PHANBIET
      , BENHVIEN_ID
      , NGAYTAO
      , NGUOITAO_ID
      , NGAYCAPNHAT
      , NGUOICAPNHAT_ID
      ) values (
      #BENHAN_ID#
      , #BENHNGOAIKHOA#
      , #KHIVAOKHOA_BENHCHINH#
      , #KHIVAOKHOA_BENHPHU#
      , #KHIVAOKHOA_PHANBIET#
      , #BENHVIEN_ID#
      , #NGAYTAO#
      , #NGUOITAO_ID#
      , #NGAYCAPNHAT#
      , #NGUOICAPNHAT_ID#
      )

      END
    </statement>
    <update id="DAO00080_Update_BenhAn_NgoaiKhoa" parameterClass="System.Collections.IDictionary">
      update TT_NOITRU_BENHAN_NGOAIKHOA set
      BENHAN_ID = #BENHAN_ID#
      <isPropertyAvailable prepend="," property="BENHNGOAIKHOA">
        BENHNGOAIKHOA = #BENHNGOAIKHOA#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="KHIVAOKHOA_BENHCHINH">
        KHIVAOKHOA_BENHCHINH = #KHIVAOKHOA_BENHCHINH#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="KHIVAOKHOA_BENHPHU">
        KHIVAOKHOA_BENHPHU = #KHIVAOKHOA_BENHPHU#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="KHIVAOKHOA_PHANBIET">
        KHIVAOKHOA_PHANBIET = #KHIVAOKHOA_PHANBIET#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="BENHVIEN_ID">
        BENHVIEN_ID = '$BENHVIEN_ID$'
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGAYCAPNHAT">
        NGAYCAPNHAT = '$NGAYCAPNHAT$'
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGUOICAPNHAT_ID">
        NGUOICAPNHAT_ID = '$NGUOICAPNHAT_ID$'
      </isPropertyAvailable>
      where
      BENHAN_ID = '$BENHAN_ID$'
    </update>
    <statement id="DAO00080_Add_BenhAn_NoiKhoa" parameterClass="System.Collections.IDictionary" resultClass="System.Int64">
      IF EXISTS
      (
      SELECT BENHAN_ID
      FROM TT_NOITRU_BENHAN_NOIKHOA
      WHERE
      BENHAN_ID = '$BENHAN_ID$'
      )
      BEGIN
      update TT_NOITRU_BENHAN_NOIKHOA set
      BENHAN_ID = #BENHAN_ID#
      <isPropertyAvailable prepend="," property="BENHNOIKHOA">
        BENHNOIKHOA = #BENHNOIKHOA#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="KHIVAOKHOA_BENHCHINH">
        KHIVAOKHOA_BENHCHINH = #KHIVAOKHOA_BENHCHINH#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="KHIVAOKHOA_BENHPHU">
        KHIVAOKHOA_BENHPHU = #KHIVAOKHOA_BENHPHU#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="KHIVAOKHOA_PHANBIET">
        KHIVAOKHOA_PHANBIET = #KHIVAOKHOA_PHANBIET#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="BENHVIEN_ID">
        BENHVIEN_ID = '$BENHVIEN_ID$'
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGAYCAPNHAT">
        NGAYCAPNHAT = '$NGAYCAPNHAT$'
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGUOICAPNHAT_ID">
        NGUOICAPNHAT_ID = '$NGUOICAPNHAT_ID$'
      </isPropertyAvailable>
      where
      BENHAN_ID = '$BENHAN_ID$'
      END
      ELSE
      BEGIN
      insert into TT_NOITRU_BENHAN_NOIKHOA (
      BENHAN_ID
      , BENHNOIKHOA
      , KHIVAOKHOA_BENHCHINH
      , KHIVAOKHOA_BENHPHU
      , KHIVAOKHOA_PHANBIET
      , BENHVIEN_ID
      , NGAYTAO
      , NGUOITAO_ID
      , NGAYCAPNHAT
      , NGUOICAPNHAT_ID
      ) values (
      #BENHAN_ID#
      , #BENHNOIKHOA#
      , #KHIVAOKHOA_BENHCHINH#
      , #KHIVAOKHOA_BENHPHU#
      , #KHIVAOKHOA_PHANBIET#
      , #BENHVIEN_ID#
      , #NGAYTAO#
      , #NGUOITAO_ID#
      , #NGAYCAPNHAT#
      , #NGUOICAPNHAT_ID#
      )

      END
    </statement>
    <update id="DAO00080_Update_BenhAn_NoiKhoa" parameterClass="System.Collections.IDictionary">
      update TT_NOITRU_BENHAN_NOIKHOA set
      BENHAN_ID = #BENHAN_ID#
      <isPropertyAvailable prepend="," property="BENHNOIKHOA">
        BENHNOIKHOA = #BENHNOIKHOA#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="KHIVAOKHOA_BENHCHINH">
        KHIVAOKHOA_BENHCHINH = #KHIVAOKHOA_BENHCHINH#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="KHIVAOKHOA_BENHPHU">
        KHIVAOKHOA_BENHPHU = #KHIVAOKHOA_BENHPHU#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="KHIVAOKHOA_PHANBIET">
        KHIVAOKHOA_PHANBIET = #KHIVAOKHOA_PHANBIET#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="BENHVIEN_ID">
        BENHVIEN_ID = '$BENHVIEN_ID$'
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGAYCAPNHAT">
        NGAYCAPNHAT = '$NGAYCAPNHAT$'
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGUOICAPNHAT_ID">
        NGUOICAPNHAT_ID = '$NGUOICAPNHAT_ID$'
      </isPropertyAvailable>
      where
      BENHAN_ID = '$BENHAN_ID$'
    </update>
    <statement id="DAO00080_Add_BenhAn_Bong" parameterClass="System.Collections.IDictionary" resultClass="System.Int64">
      IF EXISTS
      (
      SELECT BENHAN_ID
      FROM TT_NOITRU_BENHAN_BONG
      WHERE
      BENHAN_ID = '$BENHAN_ID$'
      )
      BEGIN
      update TT_NOITRU_BENHAN_BONG set
      BENHAN_ID = #BENHAN_ID#
      <isPropertyAvailable prepend="," property="SONGAYBENH">
        SONGAYBENH = #SONGAYBENH#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="TONTHUONGBONG">
        TONTHUONGBONG = #TONTHUONGBONG#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="KHIVAOKHOA_BENHCHINH">
        KHIVAOKHOA_BENHCHINH = #KHIVAOKHOA_BENHCHINH#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="KHIVAOKHOA_BENHPHU">
        KHIVAOKHOA_BENHPHU = #KHIVAOKHOA_BENHPHU#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="KHIVAOKHOA_PHANBIET">
        KHIVAOKHOA_PHANBIET = #KHIVAOKHOA_PHANBIET#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="BENHVIEN_ID">
        BENHVIEN_ID = '$BENHVIEN_ID$'
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGAYCAPNHAT">
        NGAYCAPNHAT = '$NGAYCAPNHAT$'
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGUOICAPNHAT_ID">
        NGUOICAPNHAT_ID = '$NGUOICAPNHAT_ID$'
      </isPropertyAvailable>
      where
      BENHAN_ID = '$BENHAN_ID$'
      END
      ELSE
      BEGIN
      insert into TT_NOITRU_BENHAN_BONG (
      BENHAN_ID
      , SONGAYBENH
      , TONTHUONGBONG
      , KHIVAOKHOA_BENHCHINH
      , KHIVAOKHOA_BENHPHU
      , KHIVAOKHOA_PHANBIET
      , BENHVIEN_ID
      , NGAYTAO
      , NGUOITAO_ID
      , NGAYCAPNHAT
      , NGUOICAPNHAT_ID
      ) values (
      #BENHAN_ID#
      , #SONGAYBENH#
      , #TONTHUONGBONG#
      , #KHIVAOKHOA_BENHCHINH#
      , #KHIVAOKHOA_BENHPHU#
      , #KHIVAOKHOA_PHANBIET#
      , #BENHVIEN_ID#
      , #NGAYTAO#
      , #NGUOITAO_ID#
      , #NGAYCAPNHAT#
      , #NGUOICAPNHAT_ID#
      )

      END
    </statement>
    <update id="DAO00080_Update_BenhAn_Bong" parameterClass="System.Collections.IDictionary">
      update TT_NOITRU_BENHAN_BONG set
      BENHAN_ID = #BENHAN_ID#
      <isPropertyAvailable prepend="," property="SONGAYBENH">
        SONGAYBENH = #SONGAYBENH#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="TONTHUONGBONG">
        TONTHUONGBONG = #TONTHUONGBONG#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="KHIVAOKHOA_BENHCHINH">
        KHIVAOKHOA_BENHCHINH = #KHIVAOKHOA_BENHCHINH#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="KHIVAOKHOA_BENHPHU">
        KHIVAOKHOA_BENHPHU = #KHIVAOKHOA_BENHPHU#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="KHIVAOKHOA_PHANBIET">
        KHIVAOKHOA_PHANBIET = #KHIVAOKHOA_PHANBIET#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="BENHVIEN_ID">
        BENHVIEN_ID = '$BENHVIEN_ID$'
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGAYCAPNHAT">
        NGAYCAPNHAT = '$NGAYCAPNHAT$'
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGUOICAPNHAT_ID">
        NGUOICAPNHAT_ID = '$NGUOICAPNHAT_ID$'
      </isPropertyAvailable>
      where
      BENHAN_ID = '$BENHAN_ID$'
    </update>
    <statement id="DAO00080_GetDetail_BenhAn_NgoaiKhoa" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      select *, NGUOICAPNHAT_ID as NGUOITAOBA_ID
      from TT_NOITRU_BENHAN_NGOAIKHOA
      where BENHAN_ID = '$BENHAN_ID$'
    </statement>
    <statement id="DAO00080_GetDetail_BenhAn_NoiKhoa" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      select *, NGUOICAPNHAT_ID as NGUOITAOBA_ID
      from TT_NOITRU_BENHAN_NOIKHOA
      where BENHAN_ID = '$BENHAN_ID$'
    </statement>
    <statement id="DAO00080_GetDetail_BenhAn_Bong" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      select *, NGUOICAPNHAT_ID as NGUOITAOBA_ID
      from TT_NOITRU_BENHAN_BONG
      where BENHAN_ID = '$BENHAN_ID$'
    </statement>
    <statement id="DAO00080_GetFirstPhauThuatID" parameterClass="System.Collections.IDictionary" resultClass="System.Int32">
      select PHAUTHUAT_ID
      from TT_PHAUTHUAT
      where TIEPNHAN_ID = '$TIEPNHAN_ID$'
    </statement>

    <statement id="DAO00080_TT_NOITRU_BENHAN_Update_TrangThai" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      update TT_NOITRU_BENHAN set TRANGTHAI = '$TRANGTHAI$'
      where BENHAN_ID = '$BENHAN_ID$'
    </statement>
    <statement id="DAO00080_PhatSinhDataNoiTru" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      select count(*) as BIENBAN, 0 as CHAMSOC, 0 as HOADON, 0 as GIUONGBENH from TT_BIENBANHOICHAN where BENHAN_ID = '$BENHAN_ID$'
      union
      select 0 as BIENBAN, count(*) as CHAMSOC, 0 as HOADON, 0 as GIUONGBENH from TT_NOITRU_CHAMSOC where BENHAN_ID = '$BENHAN_ID$'
      union
      select 0 as BIENBAN, 0 as CHAMSOC, count(*) as HOADON, 0 as GIUONGBENH  from TT_HOADON where BENHAN_ID = '$BENHAN_ID$' and ((HUYHOADON != '1' and HOANTRA != '1'))
      union
      select 0 as BIENBAN, 0 as CHAMSOC, 0 as HOADON, count(*) as GIUONGBENH  from TT_NOITRU_GIUONGBENH where BENHAN_ID = '$BENHAN_ID$'
    </statement>
    <statement id="DAO00080_PhatSinhDataNoiTru_All" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      select count(*) as BIENBAN, 0 as CHAMSOC, 0 as HOADON, 0 as GIUONGBENH, 0 as KHAMBENH, 0 as DICHVU, 0 as TRUYENDICH from TT_BIENBANHOICHAN where BENHAN_ID = '$BENHAN_ID$'
      union
      select 0 as BIENBAN, count(*) as CHAMSOC, 0 as HOADON, 0 as GIUONGBENH, 0 as KHAMBENH, 0 as DICHVU, 0 as TRUYENDICH from TT_NOITRU_CHAMSOC where BENHAN_ID = '$BENHAN_ID$'
      union
      select 0 as BIENBAN, 0 as CHAMSOC, count(*) as HOADON, 0 as GIUONGBENH, 0 as KHAMBENH, 0 as DICHVU, 0 as TRUYENDICH  from TT_HOADON where BENHAN_ID = '$BENHAN_ID$' and TRANGTHAIBENHAN is not null
      union
      select 0 as BIENBAN, 0 as CHAMSOC, 0 as HOADON, count(*) as GIUONGBENH, 0 as KHAMBENH, 0 as DICHVU, 0 as TRUYENDICH  from TT_NOITRU_GIUONGBENH where BENHAN_ID = '$BENHAN_ID$'
      union
      select 0 as BIENBAN, 0 as CHAMSOC, 0 as HOADON, 0 as GIUONGBENH, count(*) as KHAMBENH, 0 as DICHVU, 0 as TRUYENDICH from TT_NOITRU_KHAMBENH where BENHAN_ID = '$BENHAN_ID$'
      union
      select 0 as BIENBAN, 0 as CHAMSOC, 0 as HOADON, 0 as GIUONGBENH, 0 as KHAMBENH, count(*) as DICHVU, 0 as TRUYENDICH from TT_DVYEUCAU where BENHAN_ID = '$BENHAN_ID$'
      union
      select 0 as BIENBAN, 0 as CHAMSOC, 0 as HOADON, 0 as GIUONGBENH, 0 as KHAMBENH, 0 as DICHVU, count(*) as TRUYENDICH from TT_NOITRU_CHAMSOCDICHTRUYEN where BENHAN_ID = '$BENHAN_ID$'
    </statement>
    <statement id="DAO00080_Add_BenhAn_Dalieu" parameterClass="System.Collections.IDictionary" resultClass="System.Int64">
      IF EXISTS
      (
      SELECT BENHAN_ID
      FROM TT_NOITRU_BENHAN_DALIEU
      WHERE
      BENHAN_ID = '$BENHAN_ID$'
      )
      BEGIN
      update TT_NOITRU_BENHAN_DALIEU set
      BENHAN_ID = #BENHAN_ID#
      <isPropertyAvailable prepend="," property="TRIEUCHUNGCONANG">
        TRIEUCHUNGCONANG = #TRIEUCHUNGCONANG#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="THUONGTONCANBAN">
        THUONGTONCANBAN = #THUONGTONCANBAN#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="KHIVAOKHOA_BENHCHINH">
        KHIVAOKHOA_BENHCHINH = #KHIVAOKHOA_BENHCHINH#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="KHIVAOKHOA_BENHPHU">
        KHIVAOKHOA_BENHPHU = #KHIVAOKHOA_BENHPHU#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="KHIVAOKHOA_PHANBIET">
        KHIVAOKHOA_PHANBIET = #KHIVAOKHOA_PHANBIET#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="BENHVIEN_ID">
        BENHVIEN_ID = '$BENHVIEN_ID$'
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGAYCAPNHAT">
        NGAYCAPNHAT = '$NGAYCAPNHAT$'
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGUOICAPNHAT_ID">
        NGUOICAPNHAT_ID = '$NGUOICAPNHAT_ID$'
      </isPropertyAvailable>
      where
      BENHAN_ID = '$BENHAN_ID$'
      END
      ELSE
      BEGIN
      insert into TT_NOITRU_BENHAN_DALIEU (
      BENHAN_ID
      , TRIEUCHUNGCONANG
      , THUONGTONCANBAN
      , KHIVAOKHOA_BENHCHINH
      , KHIVAOKHOA_BENHPHU
      , KHIVAOKHOA_PHANBIET
      , BENHVIEN_ID
      , NGAYTAO
      , NGUOITAO_ID
      , NGAYCAPNHAT
      , NGUOICAPNHAT_ID
      ) values (
      #BENHAN_ID#
      , #TRIEUCHUNGCONANG#
      , #THUONGTONCANBAN#
      , #KHIVAOKHOA_BENHCHINH#
      , #KHIVAOKHOA_BENHPHU#
      , #KHIVAOKHOA_PHANBIET#
      , #BENHVIEN_ID#
      , #NGAYTAO#
      , #NGUOITAO_ID#
      , #NGAYCAPNHAT#
      , #NGUOICAPNHAT_ID#
      )

      END
    </statement>
    <update id="DAO00080_Update_BenhAn_Dalieu" parameterClass="System.Collections.IDictionary">
      update TT_NOITRU_BENHAN_DALIEU set
      BENHAN_ID = #BENHAN_ID#
      <isPropertyAvailable prepend="," property="TRIEUCHUNGCONANG">
        TRIEUCHUNGCONANG = #TRIEUCHUNGCONANG#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="THUONGTONCANBAN">
        THUONGTONCANBAN = #THUONGTONCANBAN#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="KHIVAOKHOA_BENHCHINH">
        KHIVAOKHOA_BENHCHINH = #KHIVAOKHOA_BENHCHINH#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="KHIVAOKHOA_BENHPHU">
        KHIVAOKHOA_BENHPHU = #KHIVAOKHOA_BENHPHU#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="KHIVAOKHOA_PHANBIET">
        KHIVAOKHOA_PHANBIET = #KHIVAOKHOA_PHANBIET#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="BENHVIEN_ID">
        BENHVIEN_ID = '$BENHVIEN_ID$'
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGAYCAPNHAT">
        NGAYCAPNHAT = '$NGAYCAPNHAT$'
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGUOICAPNHAT_ID">
        NGUOICAPNHAT_ID = '$NGUOICAPNHAT_ID$'
      </isPropertyAvailable>
      where
      BENHAN_ID = '$BENHAN_ID$'
    </update>
    <statement id="DAO00080_GetDetail_BenhAn_Dalieu" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      select *, NGUOICAPNHAT_ID as NGUOITAOBA_ID
      from TT_NOITRU_BENHAN_DALIEU
      where BENHAN_ID = '$BENHAN_ID$'
    </statement>
    <statement id="DAO00080_Add_BenhAn_Ungbuou" parameterClass="System.Collections.IDictionary" resultClass="System.Int64">
      IF EXISTS
      (
      SELECT BENHAN_ID
      FROM TT_NOITRU_BENHAN_UNGBUOU
      WHERE
      BENHAN_ID = '$BENHAN_ID$'
      )
      BEGIN
      update TT_NOITRU_BENHAN_UNGBUOU set
      BENHAN_ID = #BENHAN_ID#
      <isPropertyAvailable prepend="," property="BOPHANTONTHUONG">
        BOPHANTONTHUONG = #BOPHANTONTHUONG#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="HINHVEANH">
        HINHVEANH = #HINHVEANH#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="T">
        T = #T#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="N">
        N = #N#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="M">
        M = #M#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="GIAIDOAN">
        GIAIDOAN = #GIAIDOAN#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="KHIVAOKHOA_BENHCHINH">
        KHIVAOKHOA_BENHCHINH = #KHIVAOKHOA_BENHCHINH#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="KHIVAOKHOA_BENHPHU">
        KHIVAOKHOA_BENHPHU = #KHIVAOKHOA_BENHPHU#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="KHIVAOKHOA_PHANBIET">
        KHIVAOKHOA_PHANBIET = #KHIVAOKHOA_PHANBIET#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="BENHVIEN_ID">
        BENHVIEN_ID = '$BENHVIEN_ID$'
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGAYCAPNHAT">
        NGAYCAPNHAT = '$NGAYCAPNHAT$'
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGUOICAPNHAT_ID">
        NGUOICAPNHAT_ID = '$NGUOICAPNHAT_ID$'
      </isPropertyAvailable>
      where
      BENHAN_ID = '$BENHAN_ID$'
      END
      ELSE
      BEGIN
      insert into TT_NOITRU_BENHAN_UNGBUOU (
      BENHAN_ID
      , BOPHANTONTHUONG
      , HINHVEANH
      , T
      , N
      , M
      , GIAIDOAN
      , KHIVAOKHOA_BENHCHINH
      , KHIVAOKHOA_BENHPHU
      , KHIVAOKHOA_PHANBIET
      , BENHVIEN_ID
      , NGAYTAO
      , NGUOITAO_ID
      , NGAYCAPNHAT
      , NGUOICAPNHAT_ID
      ) values (
      #BENHAN_ID#
      , #BOPHANTONTHUONG#
      , #HINHVEANH#
      , #T#
      , #N#
      , #M#
      , #GIAIDOAN#
      , #KHIVAOKHOA_BENHCHINH#
      , #KHIVAOKHOA_BENHPHU#
      , #KHIVAOKHOA_PHANBIET#
      , #BENHVIEN_ID#
      , #NGAYTAO#
      , #NGUOITAO_ID#
      , #NGAYCAPNHAT#
      , #NGUOICAPNHAT_ID#
      )

      END
    </statement>
    <update id="DAO00080_Update_BenhAn_Ungbuou" parameterClass="System.Collections.IDictionary">
      update TT_NOITRU_BENHAN_UNGBUOU set
      BENHAN_ID = #BENHAN_ID#
      <isPropertyAvailable prepend="," property="BOPHANTONTHUONG">
        BOPHANTONTHUONG = #BOPHANTONTHUONG#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="HINHVEANH">
        HINHVEANH = #HINHVEANH#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="T">
        T = #T#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="N">
        N = #N#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="M">
        M = #M#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="GIAIDOAN">
        GIAIDOAN = #GIAIDOAN#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="KHIVAOKHOA_BENHCHINH">
        KHIVAOKHOA_BENHCHINH = #KHIVAOKHOA_BENHCHINH#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="KHIVAOKHOA_BENHPHU">
        KHIVAOKHOA_BENHPHU = #KHIVAOKHOA_BENHPHU#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="KHIVAOKHOA_PHANBIET">
        KHIVAOKHOA_PHANBIET = #KHIVAOKHOA_PHANBIET#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="BENHVIEN_ID">
        BENHVIEN_ID = '$BENHVIEN_ID$'
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGAYCAPNHAT">
        NGAYCAPNHAT = '$NGAYCAPNHAT$'
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGUOICAPNHAT_ID">
        NGUOICAPNHAT_ID = '$NGUOICAPNHAT_ID$'
      </isPropertyAvailable>
      where
      BENHAN_ID = '$BENHAN_ID$'
    </update>
    <statement id="DAO00080_GetDetail_BenhAn_Ungbuou" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      select *, NGUOICAPNHAT_ID as NGUOITAOBA_ID
      from TT_NOITRU_BENHAN_UNGBUOU
      where BENHAN_ID = '$BENHAN_ID$'
    </statement>
    <statement id="DAO00080_Add_BenhAn_DD_PHCN" parameterClass="System.Collections.IDictionary" resultClass="System.Int64">
      IF EXISTS
      (
      SELECT BENHAN_ID
      FROM TT_NOITRU_BENHAN_DD_PHCN
      WHERE
      BENHAN_ID = '$BENHAN_ID$'
      )
      BEGIN
      update TT_NOITRU_BENHAN_DD_PHCN set
      BENHAN_ID = #BENHAN_ID#
      <isPropertyAvailable prepend="," property="LUONGIAANUONG">LUONGIAANUONG=#LUONGIAANUONG# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="LUONGIAMACQUANAO">LUONGIAMACQUANAO=#LUONGIAMACQUANAO# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="LUONGIADUNGNGOI">LUONGIADUNGNGOI=#LUONGIADUNGNGOI# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="LUONGIACHAITOC">LUONGIACHAITOC=#LUONGIACHAITOC# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="LUONGIADIVESINH">LUONGIADIVESINH=#LUONGIADIVESINH# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="LUONGIATUSANDUNGLEN">LUONGIATUSANDUNGLEN=#LUONGIATUSANDUNGLEN# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="LUONGIADANHRANG">LUONGIADANHRANG=#LUONGIADANHRANG# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="LUONGIANAMNGUASAP">LUONGIANAMNGUASAP=#LUONGIANAMNGUASAP# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="LUONGIAKHANANGDICHUYEN">LUONGIAKHANANGDICHUYEN=#LUONGIAKHANANGDICHUYEN# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="LUONGIATAM">LUONGIATAM=#LUONGIATAM# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="LUONGIANAMNGUANGOI">LUONGIANAMNGUANGOI=#LUONGIANAMNGUANGOI# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="LUONGIADUNGCUTROGIUP">LUONGIADUNGCUTROGIUP=#LUONGIADUNGCUTROGIUP# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="BATTHUCO">BATTHUCO=#BATTHUCO# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="CANDOICACBOPHAN">CANDOICACBOPHAN=#CANDOICACBOPHAN# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="CACKHUYETTAT">CACKHUYETTAT=#CACKHUYETTAT# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="THANKINHVANDONG">THANKINHVANDONG=#THANKINHVANDONG# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="THANKINHCAMGIAC">THANKINHCAMGIAC=#THANKINHCAMGIAC# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="THANKINHPHANXA">THANKINHPHANXA=#THANKINHPHANXA# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="THANKINHCOTRON">THANKINHCOTRON=#THANKINHCOTRON# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="THANKINHSONAO">THANKINHSONAO=#THANKINHSONAO# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="THANKINHCHUCNANG">THANKINHCHUCNANG=#THANKINHCHUCNANG# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="TUANHOANNHIPTIM">TUANHOANNHIPTIM=#TUANHOANNHIPTIM# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="TUANHOANTIENGTIM">TUANHOANTIENGTIM=#TUANHOANTIENGTIM# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="TUANHOANTIMMACH">TUANHOANTIMMACH=#TUANHOANTIMMACH# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="HOHAPLONGNGUC">HOHAPLONGNGUC=#HOHAPLONGNGUC# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="HOHAPTHETICHKHI">HOHAPTHETICHKHI=#HOHAPTHETICHKHI# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="HOHAPBENHLY">HOHAPBENHLY=#HOHAPBENHLY# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="HOHAPCHUCNANGHOHAP">HOHAPCHUCNANGHOHAP=#HOHAPCHUCNANGHOHAP# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="TIEUHOABENHLY">TIEUHOABENHLY=#TIEUHOABENHLY# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="TIEUHOACHUCNANG">TIEUHOACHUCNANG=#TIEUHOACHUCNANG# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="DAVAMODUOIDA">DAVAMODUOIDA=#DAVAMODUOIDA# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="HINHTHEKHOP">HINHTHEKHOP=#HINHTHEKHOP# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="KHOPVAOVIEN">KHOPVAOVIEN=#KHOPVAOVIEN# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="KHOPRAVIEN">KHOPRAVIEN=#KHOPRAVIEN# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="COBENHLY">COBENHLY=#COBENHLY# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="COCHUCNANG">COCHUCNANG=#COCHUCNANG# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="CODUOCTHU">CODUOCTHU=#CODUOCTHU# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="COTSONGBENHLY">COTSONGBENHLY=#COTSONGBENHLY# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="COTSONGSCHOBER">COTSONGSCHOBER=#COTSONGSCHOBER# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="COTSONGSTIBOR">COTSONGSTIBOR=#COTSONGSTIBOR# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="COTSONGROILOANCN">COTSONGROILOANCN=#COTSONGROILOANCN# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="HINHVEANH">HINHVEANH=#HINHVEANH# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="VANDEKHIEMKHUYET">VANDEKHIEMKHUYET=#VANDEKHIEMKHUYET# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="MUCDICHDIEUTRI">MUCDICHDIEUTRI=#MUCDICHDIEUTRI# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="KHIVAOKHOA_BENHCHINH">KHIVAOKHOA_BENHCHINH = #KHIVAOKHOA_BENHCHINH#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="KHIVAOKHOA_BENHPHU">KHIVAOKHOA_BENHPHU = #KHIVAOKHOA_BENHPHU#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="KHIVAOKHOA_PHANBIET">KHIVAOKHOA_PHANBIET = #KHIVAOKHOA_PHANBIET#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="BENHVIEN_ID">BENHVIEN_ID = '$BENHVIEN_ID$'</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGAYCAPNHAT">NGAYCAPNHAT = '$NGAYCAPNHAT$'</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGUOICAPNHAT_ID">NGUOICAPNHAT_ID = '$NGUOICAPNHAT_ID$'</isPropertyAvailable>
      where
      BENHAN_ID = '$BENHAN_ID$'
      END ELSE BEGIN
      insert into TT_NOITRU_BENHAN_DD_PHCN (
      BENHAN_ID
      , LUONGIAANUONG
      , LUONGIAMACQUANAO
      , LUONGIADUNGNGOI
      , LUONGIACHAITOC
      , LUONGIADIVESINH
      , LUONGIATUSANDUNGLEN
      , LUONGIADANHRANG
      , LUONGIANAMNGUASAP
      , LUONGIAKHANANGDICHUYEN
      , LUONGIATAM
      , LUONGIANAMNGUANGOI
      , LUONGIADUNGCUTROGIUP
      , BATTHUCO
      , CANDOICACBOPHAN
      , CACKHUYETTAT
      , THANKINHVANDONG
      , THANKINHCAMGIAC
      , THANKINHPHANXA
      , THANKINHCOTRON
      , THANKINHSONAO
      , THANKINHCHUCNANG
      , TUANHOANNHIPTIM
      , TUANHOANTIENGTIM
      , TUANHOANTIMMACH
      , HOHAPLONGNGUC
      , HOHAPTHETICHKHI
      , HOHAPBENHLY
      , HOHAPCHUCNANGHOHAP
      , TIEUHOABENHLY
      , TIEUHOACHUCNANG
      , DAVAMODUOIDA
      , HINHTHEKHOP
      , KHOPVAOVIEN
      , KHOPRAVIEN
      , COBENHLY
      , COCHUCNANG
      , CODUOCTHU
      , COTSONGBENHLY
      , COTSONGSCHOBER
      , COTSONGSTIBOR
      , COTSONGROILOANCN
      , HINHVEANH
      , VANDEKHIEMKHUYET
      , MUCDICHDIEUTRI
      , KHIVAOKHOA_BENHCHINH
      , KHIVAOKHOA_BENHPHU
      , KHIVAOKHOA_PHANBIET
      , BENHVIEN_ID
      , NGAYTAO
      , NGUOITAO_ID
      , NGAYCAPNHAT
      , NGUOICAPNHAT_ID
      ) values (
      #BENHAN_ID#
      , #LUONGIAANUONG#
      , #LUONGIAMACQUANAO#
      , #LUONGIADUNGNGOI#
      , #LUONGIACHAITOC#
      , #LUONGIADIVESINH#
      , #LUONGIATUSANDUNGLEN#
      , #LUONGIADANHRANG#
      , #LUONGIANAMNGUASAP#
      , #LUONGIAKHANANGDICHUYEN#
      , #LUONGIATAM#
      , #LUONGIANAMNGUANGOI#
      , #LUONGIADUNGCUTROGIUP#
      , #BATTHUCO#
      , #CANDOICACBOPHAN#
      , #CACKHUYETTAT#
      , #THANKINHVANDONG#
      , #THANKINHCAMGIAC#
      , #THANKINHPHANXA#
      , #THANKINHCOTRON#
      , #THANKINHSONAO#
      , #THANKINHCHUCNANG#
      , #TUANHOANNHIPTIM#
      , #TUANHOANTIENGTIM#
      , #TUANHOANTIMMACH#
      , #HOHAPLONGNGUC#
      , #HOHAPTHETICHKHI#
      , #HOHAPBENHLY#
      , #HOHAPCHUCNANGHOHAP#
      , #TIEUHOABENHLY#
      , #TIEUHOACHUCNANG#
      , #DAVAMODUOIDA#
      , #HINHTHEKHOP#
      , #KHOPVAOVIEN#
      , #KHOPRAVIEN#
      , #COBENHLY#
      , #COCHUCNANG#
      , #CODUOCTHU#
      , #COTSONGBENHLY#
      , #COTSONGSCHOBER#
      , #COTSONGSTIBOR#
      , #COTSONGROILOANCN#
      , #HINHVEANH#
      , #VANDEKHIEMKHUYET#
      , #MUCDICHDIEUTRI#
      , #KHIVAOKHOA_BENHCHINH#
      , #KHIVAOKHOA_BENHPHU#
      , #KHIVAOKHOA_PHANBIET#
      , #BENHVIEN_ID#
      , #NGAYTAO#
      , #NGUOITAO_ID#
      , #NGAYCAPNHAT#
      , #NGUOICAPNHAT_ID#
      )

      END
    </statement>
    <update id="DAO00080_Update_BenhAn_DD_PHCN" parameterClass="System.Collections.IDictionary">
      update TT_NOITRU_BENHAN_DD_PHCN set
      BENHAN_ID = #BENHAN_ID#
      <isPropertyAvailable prepend="," property="LUONGIAANUONG">LUONGIAANUONG=#LUONGIAANUONG# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="LUONGIAMACQUANAO">LUONGIAMACQUANAO=#LUONGIAMACQUANAO# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="LUONGIADUNGNGOI">LUONGIADUNGNGOI=#LUONGIADUNGNGOI# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="LUONGIACHAITOC">LUONGIACHAITOC=#LUONGIACHAITOC# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="LUONGIADIVESINH">LUONGIADIVESINH=#LUONGIADIVESINH# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="LUONGIATUSANDUNGLEN">LUONGIATUSANDUNGLEN=#LUONGIATUSANDUNGLEN# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="LUONGIADANHRANG">LUONGIADANHRANG=#LUONGIADANHRANG# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="LUONGIANAMNGUASAP">LUONGIANAMNGUASAP=#LUONGIANAMNGUASAP# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="LUONGIAKHANANGDICHUYEN">LUONGIAKHANANGDICHUYEN=#LUONGIAKHANANGDICHUYEN# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="LUONGIATAM">LUONGIATAM=#LUONGIATAM# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="LUONGIANAMNGUANGOI">LUONGIANAMNGUANGOI=#LUONGIANAMNGUANGOI# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="LUONGIADUNGCUTROGIUP">LUONGIADUNGCUTROGIUP=#LUONGIADUNGCUTROGIUP# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="BATTHUCO">BATTHUCO=#BATTHUCO# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="CANDOICACBOPHAN">CANDOICACBOPHAN=#CANDOICACBOPHAN# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="CACKHUYETTAT">CACKHUYETTAT=#CACKHUYETTAT# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="THANKINHVANDONG">THANKINHVANDONG=#THANKINHVANDONG# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="THANKINHCAMGIAC">THANKINHCAMGIAC=#THANKINHCAMGIAC# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="THANKINHPHANXA">THANKINHPHANXA=#THANKINHPHANXA# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="THANKINHCOTRON">THANKINHCOTRON=#THANKINHCOTRON# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="THANKINHSONAO">THANKINHSONAO=#THANKINHSONAO# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="THANKINHCHUCNANG">THANKINHCHUCNANG=#THANKINHCHUCNANG# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="TUANHOANNHIPTIM">TUANHOANNHIPTIM=#TUANHOANNHIPTIM# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="TUANHOANTIENGTIM">TUANHOANTIENGTIM=#TUANHOANTIENGTIM# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="TUANHOANTIMMACH">TUANHOANTIMMACH=#TUANHOANTIMMACH# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="HOHAPLONGNGUC">HOHAPLONGNGUC=#HOHAPLONGNGUC# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="HOHAPTHETICHKHI">HOHAPTHETICHKHI=#HOHAPTHETICHKHI# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="HOHAPBENHLY">HOHAPBENHLY=#HOHAPBENHLY# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="HOHAPCHUCNANGHOHAP">HOHAPCHUCNANGHOHAP=#HOHAPCHUCNANGHOHAP# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="TIEUHOABENHLY">TIEUHOABENHLY=#TIEUHOABENHLY# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="TIEUHOACHUCNANG">TIEUHOACHUCNANG=#TIEUHOACHUCNANG# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="DAVAMODUOIDA">DAVAMODUOIDA=#DAVAMODUOIDA# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="HINHTHEKHOP">HINHTHEKHOP=#HINHTHEKHOP# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="KHOPVAOVIEN">KHOPVAOVIEN=#KHOPVAOVIEN# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="KHOPRAVIEN">KHOPRAVIEN=#KHOPRAVIEN# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="COBENHLY">COBENHLY=#COBENHLY# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="COCHUCNANG">COCHUCNANG=#COCHUCNANG# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="CODUOCTHU">CODUOCTHU=#CODUOCTHU# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="COTSONGBENHLY">COTSONGBENHLY=#COTSONGBENHLY# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="COTSONGSCHOBER">COTSONGSCHOBER=#COTSONGSCHOBER# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="COTSONGSTIBOR">COTSONGSTIBOR=#COTSONGSTIBOR# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="COTSONGROILOANCN">COTSONGROILOANCN=#COTSONGROILOANCN# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="HINHVEANH">HINHVEANH=#HINHVEANH# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="VANDEKHIEMKHUYET">VANDEKHIEMKHUYET=#VANDEKHIEMKHUYET# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="MUCDICHDIEUTRI">MUCDICHDIEUTRI=#MUCDICHDIEUTRI# </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="KHIVAOKHOA_BENHCHINH">KHIVAOKHOA_BENHCHINH = #KHIVAOKHOA_BENHCHINH#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="KHIVAOKHOA_BENHPHU">KHIVAOKHOA_BENHPHU = #KHIVAOKHOA_BENHPHU#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="KHIVAOKHOA_PHANBIET">KHIVAOKHOA_PHANBIET = #KHIVAOKHOA_PHANBIET#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="BENHVIEN_ID">BENHVIEN_ID = '$BENHVIEN_ID$'</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGAYCAPNHAT">NGAYCAPNHAT = '$NGAYCAPNHAT$'</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGUOICAPNHAT_ID">NGUOICAPNHAT_ID = '$NGUOICAPNHAT_ID$'</isPropertyAvailable>
      where
      BENHAN_ID = '$BENHAN_ID$'
    </update>
    <statement id="DAO00080_GetDetail_BenhAn_DD_PHCN" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      select *, NGUOICAPNHAT_ID as NGUOITAOBA_ID
      from TT_NOITRU_BENHAN_DD_PHCN
      where BENHAN_ID = '$BENHAN_ID$'
    </statement>
    <statement id="DAO00080_Add_BenhAn_HHTM" parameterClass="System.Collections.IDictionary" resultClass="System.Int64">
      IF EXISTS
      (
      SELECT BENHAN_ID
      FROM TT_NOITRU_BENHAN_HHTM
      WHERE
      BENHAN_ID = '$BENHAN_ID$'
      )
      BEGIN
      update TT_NOITRU_BENHAN_HHTM set
      BENHAN_ID = #BENHAN_ID#
      <isPropertyAvailable prepend="," property="TMKHOIHONGCAU">TMKHOIHONGCAU = #TMKHOIHONGCAU#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="TMHUYETTUONG">TMHUYETTUONG = #TMHUYETTUONG#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="TMHONGCAURUA">TMHONGCAURUA = #TMHONGCAURUA#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="TMHUYETTUONGTUOI">TMHUYETTUONGTUOI = #TMHUYETTUONGTUOI#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="TMKHOITIEUCAU">TMKHOITIEUCAU = #TMKHOITIEUCAU#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="TMTUAVIII">TMTUAVIII = #TMTUAVIII#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="TMKHOIBACHCAUHAT">TMKHOIBACHCAUHAT = #TMKHOIBACHCAUHAT#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="TMTOANPHAN">TMTOANPHAN = #TMTOANPHAN#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="TINHTHANNGUOIBENH">TINHTHANNGUOIBENH = #TINHTHANNGUOIBENH#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="HINHDANGTUTHE">HINHDANGTUTHE = #HINHDANGTUTHE#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="DANIEMMAC">DANIEMMAC = #DANIEMMAC#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="TRIEUCHUNGXUATHUYET">TRIEUCHUNGXUATHUYET = #TRIEUCHUNGXUATHUYET#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="HETHONGLONGTOCMONG">HETHONGLONGTOCMONG = #HETHONGLONGTOCMONG#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="TRIEUCHUNGPHU">TRIEUCHUNGPHU = #TRIEUCHUNGPHU#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="TUYETGIAP">TUYETGIAP = #TUYETGIAP#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="GANKICHTHUOC">GANKICHTHUOC = #GANKICHTHUOC#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="GANMATDO">GANMATDO = #GANMATDO#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="GANBO">GANBO = #GANBO#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="GANMATGAN">GANMATGAN = #GANMATGAN#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="GANDAU">GANDAU = #GANDAU#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="LACHKICHTHUOC">LACHKICHTHUOC = #LACHKICHTHUOC#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="LACHMATDO">LACHMATDO = #LACHMATDO#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="LACHBO">LACHBO = #LACHBO#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="LACHMATGAN">LACHMATGAN = #LACHMATGAN#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="LACHDAU">LACHDAU = #LACHDAU#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="HACHVITRI">HACHVITRI = #HACHVITRI#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="HACHKICHTHUOC">HACHKICHTHUOC = #HACHKICHTHUOC#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="HACHSOLUONG">HACHSOLUONG = #HACHSOLUONG#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="HACHDODIDONG">HACHDODIDONG = #HACHDODIDONG#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="HACHDAU">HACHDAU = #HACHDAU#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="XNHUYETDO">XNHUYETDO = #XNHUYETDO#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="XNNHOMMAU">XNNHOMMAU = #XNNHOMMAU#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="XNTUYDO">XNTUYDO = #XNTUYDO#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="XNCOOMBSTEST">XNCOOMBSTEST = #XNCOOMBSTEST#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="XNSINHTHIETTUY">XNSINHTHIETTUY = #XNSINHTHIETTUY#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="XNKHANGTHE">XNKHANGTHE = #XNKHANGTHE#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="XNSINHTHIETHACH">XNSINHTHIETHACH = #XNSINHTHIETHACH#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="XNDONGMAUTOANBO">XNDONGMAUTOANBO = #XNDONGMAUTOANBO#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="XNSINHHOA">XNSINHHOA = #XNSINHHOA#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="XNYEUTODONGMAU">XNYEUTODONGMAU = #XNYEUTODONGMAU#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="XNGPB">XNGPB = #XNGPB#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="XNDIENDIHST">XNDIENDIHST = #XNDIENDIHST#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="XNVISINH">XNVISINH = #XNVISINH#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="XNNHIEMSACTHE">XNNHIEMSACTHE = #XNNHIEMSACTHE#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="XNXXQUANG">XNXXQUANG = #XNXXQUANG#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="PUMANNGUA">PUMANNGUA = #PUMANNGUA#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="PUSOTRET">PUSOTRET = #PUSOTRET#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="PUCHOANGPHANVE">PUCHOANGPHANVE = #PUCHOANGPHANVE#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="PUKHAC">PUKHAC = #PUKHAC#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="TIMMACH">TIMMACH = #TIMMACH#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="KHIVAOKHOA_BENHCHINH">KHIVAOKHOA_BENHCHINH = #KHIVAOKHOA_BENHCHINH#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="KHIVAOKHOA_BENHPHU">KHIVAOKHOA_BENHPHU = #KHIVAOKHOA_BENHPHU#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="KHIVAOKHOA_PHANBIET">KHIVAOKHOA_PHANBIET = #KHIVAOKHOA_PHANBIET#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="BENHVIEN_ID">BENHVIEN_ID = '$BENHVIEN_ID$'</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGAYCAPNHAT">NGAYCAPNHAT = '$NGAYCAPNHAT$'</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGUOICAPNHAT_ID">NGUOICAPNHAT_ID = '$NGUOICAPNHAT_ID$'</isPropertyAvailable>
      where
      BENHAN_ID = '$BENHAN_ID$'
      END
      ELSE
      BEGIN
      insert into TT_NOITRU_BENHAN_HHTM (
      BENHAN_ID
      , TMKHOIHONGCAU
      , TMHUYETTUONG
      , TMHONGCAURUA
      , TMHUYETTUONGTUOI
      , TMKHOITIEUCAU
      , TMTUAVIII
      , TMKHOIBACHCAUHAT
      , TMTOANPHAN
      , TINHTHANNGUOIBENH
      , HINHDANGTUTHE
      , DANIEMMAC
      , TRIEUCHUNGXUATHUYET
      , HETHONGLONGTOCMONG
      , TRIEUCHUNGPHU
      , TUYETGIAP
      , GANKICHTHUOC
      , GANMATDO
      , GANBO
      , GANMATGAN
      , GANDAU
      , LACHKICHTHUOC
      , LACHMATDO
      , LACHBO
      , LACHMATGAN
      , LACHDAU
      , HACHVITRI
      , HACHKICHTHUOC
      , HACHSOLUONG
      , HACHDODIDONG
      , HACHDAU
      , XNHUYETDO
      , XNNHOMMAU
      , XNTUYDO
      , XNCOOMBSTEST
      , XNSINHTHIETTUY
      , XNKHANGTHE
      , XNSINHTHIETHACH
      , XNDONGMAUTOANBO
      , XNSINHHOA
      , XNYEUTODONGMAU
      , XNGPB
      , XNDIENDIHST
      , XNVISINH
      , XNNHIEMSACTHE
      , XNXXQUANG
      , PUMANNGUA
      , PUSOTRET
      , PUCHOANGPHANVE
      , PUKHAC
      , TIMMACH
      , KHIVAOKHOA_BENHCHINH
      , KHIVAOKHOA_BENHPHU
      , KHIVAOKHOA_PHANBIET
      , BENHVIEN_ID
      , NGAYTAO
      , NGUOITAO_ID
      , NGAYCAPNHAT
      , NGUOICAPNHAT_ID
      ) values (
      #BENHAN_ID#
      , #TMKHOIHONGCAU#
      , #TMHUYETTUONG#
      , #TMHONGCAURUA#
      , #TMHUYETTUONGTUOI#
      , #TMKHOITIEUCAU#
      , #TMTUAVIII#
      , #TMKHOIBACHCAUHAT#
      , #TMTOANPHAN#
      , #TINHTHANNGUOIBENH#
      , #HINHDANGTUTHE#
      , #DANIEMMAC#
      , #TRIEUCHUNGXUATHUYET#
      , #HETHONGLONGTOCMONG#
      , #TRIEUCHUNGPHU#
      , #TUYETGIAP#
      , #GANKICHTHUOC#
      , #GANMATDO#
      , #GANBO#
      , #GANMATGAN#
      , #GANDAU#
      , #LACHKICHTHUOC#
      , #LACHMATDO#
      , #LACHBO#
      , #LACHMATGAN#
      , #LACHDAU#
      , #HACHVITRI#
      , #HACHKICHTHUOC#
      , #HACHSOLUONG#
      , #HACHDODIDONG#
      , #HACHDAU#
      , #XNHUYETDO#
      , #XNNHOMMAU#
      , #XNTUYDO#
      , #XNCOOMBSTEST#
      , #XNSINHTHIETTUY#
      , #XNKHANGTHE#
      , #XNSINHTHIETHACH#
      , #XNDONGMAUTOANBO#
      , #XNSINHHOA#
      , #XNYEUTODONGMAU#
      , #XNGPB#
      , #XNDIENDIHST#
      , #XNVISINH#
      , #XNNHIEMSACTHE#
      , #XNXXQUANG#
      , #PUMANNGUA#
      , #PUSOTRET#
      , #PUCHOANGPHANVE#
      , #PUKHAC#
      , #TIMMACH#
      , #KHIVAOKHOA_BENHCHINH#
      , #KHIVAOKHOA_BENHPHU#
      , #KHIVAOKHOA_PHANBIET#
      , #BENHVIEN_ID#
      , #NGAYTAO#
      , #NGUOITAO_ID#
      , #NGAYCAPNHAT#
      , #NGUOICAPNHAT_ID#
      )

      END
    </statement>
    <update id="DAO00080_Update_BenhAn_HHTM" parameterClass="System.Collections.IDictionary">
      update TT_NOITRU_BENHAN_HHTM set
      BENHAN_ID = #BENHAN_ID#
      <isPropertyAvailable prepend="," property="TMKHOIHONGCAU">TMKHOIHONGCAU = #TMKHOIHONGCAU#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="TMHUYETTUONG">TMHUYETTUONG = #TMHUYETTUONG#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="TMHONGCAURUA">TMHONGCAURUA = #TMHONGCAURUA#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="TMHUYETTUONGTUOI">TMHUYETTUONGTUOI = #TMHUYETTUONGTUOI#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="TMKHOITIEUCAU">TMKHOITIEUCAU = #TMKHOITIEUCAU#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="TMTUAVIII">TMTUAVIII = #TMTUAVIII#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="TMKHOIBACHCAUHAT">TMKHOIBACHCAUHAT = #TMKHOIBACHCAUHAT#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="TMTOANPHAN">TMTOANPHAN = #TMTOANPHAN#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="TINHTHANNGUOIBENH">TINHTHANNGUOIBENH = #TINHTHANNGUOIBENH#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="HINHDANGTUTHE">HINHDANGTUTHE = #HINHDANGTUTHE#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="DANIEMMAC">DANIEMMAC = #DANIEMMAC#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="TRIEUCHUNGXUATHUYET">TRIEUCHUNGXUATHUYET = #TRIEUCHUNGXUATHUYET#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="HETHONGLONGTOCMONG">HETHONGLONGTOCMONG = #HETHONGLONGTOCMONG#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="TRIEUCHUNGPHU">TRIEUCHUNGPHU = #TRIEUCHUNGPHU#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="TUYETGIAP">TUYETGIAP = #TUYETGIAP#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="GANKICHTHUOC">GANKICHTHUOC = #GANKICHTHUOC#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="GANMATDO">GANMATDO = #GANMATDO#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="GANBO">GANBO = #GANBO#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="GANMATGAN">GANMATGAN = #GANMATGAN#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="GANDAU">GANDAU = #GANDAU#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="LACHKICHTHUOC">LACHKICHTHUOC = #LACHKICHTHUOC#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="LACHMATDO">LACHMATDO = #LACHMATDO#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="LACHBO">LACHBO = #LACHBO#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="LACHMATGAN">LACHMATGAN = #LACHMATGAN#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="LACHDAU">LACHDAU = #LACHDAU#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="HACHVITRI">HACHVITRI = #HACHVITRI#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="HACHKICHTHUOC">HACHKICHTHUOC = #HACHKICHTHUOC#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="HACHSOLUONG">HACHSOLUONG = #HACHSOLUONG#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="HACHDODIDONG">HACHDODIDONG = #HACHDODIDONG#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="HACHDAU">HACHDAU = #HACHDAU#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="XNHUYETDO">XNHUYETDO = #XNHUYETDO#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="XNNHOMMAU">XNNHOMMAU = #XNNHOMMAU#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="XNTUYDO">XNTUYDO = #XNTUYDO#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="XNCOOMBSTEST">XNCOOMBSTEST = #XNCOOMBSTEST#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="XNSINHTHIETTUY">XNSINHTHIETTUY = #XNSINHTHIETTUY#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="XNKHANGTHE">XNKHANGTHE = #XNKHANGTHE#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="XNSINHTHIETHACH">XNSINHTHIETHACH = #XNSINHTHIETHACH#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="XNDONGMAUTOANBO">XNDONGMAUTOANBO = #XNDONGMAUTOANBO#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="XNSINHHOA">XNSINHHOA = #XNSINHHOA#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="XNYEUTODONGMAU">XNYEUTODONGMAU = #XNYEUTODONGMAU#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="XNGPB">XNGPB = #XNGPB#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="XNDIENDIHST">XNDIENDIHST = #XNDIENDIHST#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="XNVISINH">XNVISINH = #XNVISINH#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="XNNHIEMSACTHE">XNNHIEMSACTHE = #XNNHIEMSACTHE#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="XNXXQUANG">XNXXQUANG = #XNXXQUANG#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="PUMANNGUA">PUMANNGUA = #PUMANNGUA#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="PUSOTRET">PUSOTRET = #PUSOTRET#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="PUCHOANGPHANVE">PUCHOANGPHANVE = #PUCHOANGPHANVE#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="PUKHAC">PUKHAC = #PUKHAC#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="TIMMACH">TIMMACH = #TIMMACH#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="KHIVAOKHOA_BENHCHINH">KHIVAOKHOA_BENHCHINH = #KHIVAOKHOA_BENHCHINH#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="KHIVAOKHOA_BENHPHU">KHIVAOKHOA_BENHPHU = #KHIVAOKHOA_BENHPHU#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="KHIVAOKHOA_PHANBIET">KHIVAOKHOA_PHANBIET = #KHIVAOKHOA_PHANBIET#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="BENHVIEN_ID">BENHVIEN_ID = '$BENHVIEN_ID$'</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGAYCAPNHAT">NGAYCAPNHAT = '$NGAYCAPNHAT$'</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGUOICAPNHAT_ID">NGUOICAPNHAT_ID = '$NGUOICAPNHAT_ID$'</isPropertyAvailable>
      where
      BENHAN_ID = '$BENHAN_ID$'
    </update>
    <statement id="DAO00080_GetDetail_BenhAn_HHTM" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      select *, NGUOICAPNHAT_ID as NGUOITAOBA_ID
      from TT_NOITRU_BENHAN_HHTM
      where BENHAN_ID = '$BENHAN_ID$'
    </statement>
    <statement id="DAO00080_GetTTSinhHieu_CapCuu" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      select top 1 MACH, NHIPTHO, NHIETDO, CANNANG, HUYETAPDUOI HUYETAPTHAP, HUYETAPTREN HUYETAPCAO, CHIEUCAO, SPO2  from TT_PHANLOAICAPCUU_TRIAGE
      where PHANLOAICAPCUU_ID = (select top 1 PHANLOAICAPCUU_ID from TT_PHANLOAICAPCUU where BENHAN_ID = '$BENHAN_ID$')
      order by NGAYTAO desc
    </statement>
    <statement id="DAO00080_GetDetail_BenhAn_YHCT" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      SELECT
      BENHAN_ID,
      LOAIBENHAN,
      NGUOITAOBA_ID,
      NGAYTAO,
      YHHD_CDVAOKHOA, YHHD_ICDIDCHINH, YHHD_ICDCHINH, YHHD_ICDCHINH_TEXT, YHHD_ICDIDPHU, YHHD_ICDPHU, YHHD_ICDPHU_TEXT, BENHDANH, BATCUONG, BATCUONG_BIEU, BATCUONG_LY, BATCUONG_HU, BATCUONG_THUC
      , BATCUONG_HAN, BATCUONG_NHIET, BATCUONG_AM, BATCUONG_DUONG, TANGPHU_TAM, TANGPHU_CAN, TANGPHU_TY, TANGPHU_PHE, TANGPHU_TAMBAO, TANGPHU_THAN, TANGPHU_VI
      , TANGPHU_DOM, TANGPHU_TIEUTRUONG, TANGPHU_DAITRANG, TANGPHU_BANGQUANG, TANGPHU_TAMTIEU, TANGPHU_PHUKY, KINHMACH_TAM, KINHMACH_CAN, KINHMACH_TY, KINHMACH_PHE
      , KINHMACH_THAN, KINHMACH_VI, KINHMACH_DAITRUONG, KINHMACH_TIEUTRUONG, KINHMACH_TAMBAOLAC, KINHMACH_TAMTIEU, KINHMACH_DOM, KINHMACH_BANG, KINHMACH_MACH
      , KINHMACH_MACHNHAM, DINHVI_DINH, DINHVI_VE, DINHVI_KHI, DINHVI_HUYET, NN_NOI, NN_NGOAI, NN_BATNOINGOAI, YHCT_CDRAVIEN, KQDT_KHOI, KQDT_DO, KQDT_NANGHON, KQDT_CHUYENVIEN
      , KQDT_TUVONG, KQDT_XINVE, NOITIET_DINHDUONG, MOTACOQUANBENHLY, HINHTHAI_GAY, HINHTHAI_BEO, HINHTHAI_CANDOI, HINHTHAI_NAMCO, HINHTHAI_UATINH, HINHTHAI_NAMDUOI
      , HINHTHAI_HIEUDONG, HINHTHAI_KHAC, THAN_CONTHAN, THAN_KHONGTHAN, THAN_KHAC, SAC_TRANG, SAC_DO, SAC_VANG, SAC_XANH, SAC_DEN, SAC_BINH, SAC_KHAC, TRACH_TUOI, TRACH_KHO
      , TRACH_KHAC, CHATLUOI_BT, CHATLUOI_BEU, CHATLUOI_MONG, CHATLUOI_NUT, CHATLUOI_CUNG, CHATLUOI_LOET, CHATLUOI_LECH, CHATLUOI_RUT, CHATLUOI_KHAC, SACLUOI_HONG
      , SACLUOI_NHOT, SACLUOI_DO, SACLUOI_DOSAM, SACLUOI_XANHTIM, SACLUOI_DAMU, SACLUOI_KHO, SACLUOI_NHUAN, SACLUOI_KHAC, REULUOI_CO, REULUOI_KHONG, REULUOI_BONG, REULUOI_DAY
      , REULUOI_MONG, REULUOI_UOT, REULUOI_KHO, REULUOI_DINH, REULUOI_TRANG, REULUOI_VANG, REULUOI_DEN, REULUOI_KHAC, MOTAVONGCHAN, TIENGNOI_BT, TIENGNOI_TO
      , TIENGNOI_NHO, TIENGNOI_DUTQUANG, TIENGNOI_KHAN, TIENGNOI_NGONG, TIENGNOI_MAT, TIENGNOI_KHAC, HOITHO_BT, HOITHO_DUTQUANG, HOITHO_NGAN, HOITHO_MANH
      , HOITHO_YEU, HOITHO_THO, HOITHO_RIT, HOITHO_KHOKHE, HOITHO_CHAM, HOITHO_GAP, HOITHO_KHAC, HO_TEXT, HO_CO, HO_CO_TEXT, HO_KHONG, HO_KHONG_TEXT, HO_LIENTUC
      , HO_CON, HO_IT, HO_NHIEU, HO_KHAN, HO_CODOM, HO_KHAC, O_CO, O_KHONG, NAC_CO, NAC_KHONG, MUI_CO, MUI_KHONG, MUI_CHUA, MUI_KHAM, MUI_TANH, MUI_THOI, MUI_HOI
      , MUI_KHAC, CHATTHAIBL_CO, CHATTHAIBL_KHONG, CHATTHAIBL_DOM, CHATTHAIBL_CHATNON, CHATTHAIBL_PHAN, CHATTHAIBL_NUOCTIEU, CHATTHAIBL_KHIHU, CHATTHAIBL_KINH
      , CHATTHAIBL_KHAC, MOTAVANCHAN, HANNHIET_BT, HANNHIET_HAN, HANNHIET_NHIET, HANNHIET_KHAC, HANNHIET_THICHNONG, HANNHIET_SONONG, HANNHIET_THICHMAT
      , HANNHIET_SOLANH, HANNHIET_TRONGNONG, HANNHIET_TRONGLANH, HANNHIET_RETRUN, HANNHIET_VANGLAI, HANNHIET_BHKHAC, MOHOI_BT, MOHOI_KHONG, MOHOI_TUHAN
      , MOHOI_DAOHAN, MOHOI_NHIEU, MOHOI_IT, MOHOI_KHAC, DAUMAT_CO, DAUMAT_KHONG, DAUDAU_1CHO, DAUDAU_NUADAU, DAUDAU_CADAU, DAUDAU_DICHUYEN, DAUDAU_EAM
      , DAUDAU_NHOI, DAUDAU_CANG, DAUDAU_NANG, MAT_HOAMAT, MAT_NHINKHONGRO, TAI_U, TAI_DIEC, TAI_NANG, TAI_DAU, MUI_NGAT, MUI_CHAYNUOC, MUI_CHAYMAUCAM
      , MUI_DAU, HONG_DAU, HONG_KHO, COVAI_MOI, COVAI_DAU, COVAI_KHOVANDONG, COVAI_KHAC, LUNGBL_CO, LUNGBL_KHONG, LUNGBL_DAU, LUNGBL_KHOVANDONG
      , LUNGBL_COCUNG, LUNGBL_KHAC, BUNGBL_CO, BUNGBL_KHONG, BUNGBL_TUC, BUNGBL_DAU, BUNGBL_SOI, BUNGBL_NONGRUOT, BUNGBL_DAY, NGUC_KHOTHO, NGUC_TUC
      , NGUC_BONCHON, NGUC_DANHTRONG, NGUC_KHAC, CHANTAY_CO, CHANTAY_KHONG, AN_CO, AN_KHONG, AN_THICHNONG, AN_THICHMAT, AN_NHIEU, AN_IT, AN_DANGMIENG
      , AN_NHATMIENG, AN_THEMAN, AN_CHANAN, AN_BUNGCHUONG, AN_KHAC, UONG_CO, UONG_KHONG, UONG_MAT, UONG_AMNONG, UONG_NHIEU, UONG_IT, UONG_KHAC
      , DAITIEUTIEN_CO, DAITIEUTIEN_KHONG, TIEUTIEN_VANG, TIEUTIEN_DO, TIEUTIEN_DUC, TIEUTIEN_BUOT, TIEUTIEN_DAT, TIEUTIEN_KHONGTUCHU, TIEUTIEN_BI
      , TIEUTIEN_KHAC, DAITIEN_TAO, DAITIEN_NHAO, DAITIEN_SONG, DAITIEN_TOANNUOC, DAITIEN_NHAY, DAITIEN_BI, DAITIEN_KHAC, NGU_CO, NGU_KHONG, NGU_KHO
      , NGU_HAYTINH, NGU_DAYSOM, NGU_HAYMO, NGU_KHAC, KINH_CO, KINH_KHONG, KINH_TRUOCKY, KINH_SAUKY, KINH_LUCTRUOCLUCSAU, KINH_TAC, KINH_KHAC
      , KINH_DAUTRUOCKY, KINH_DAUSAUKY, KINH_DAUTRONGKY, THONGKINH_KHAC, DOIHA_VANG, DOIHA_TRANG, DOIHA_HOI, DOIHA_HONG, DOIHA_KHAC, ROILOANSD_CO
      , ROILOANSD_KHONG, ROILOANSDNAM_YEU, ROILOANSDNAM_LIETDUONG, ROILOANSDNAM_DITINH, ROILOANSDNAM_HOATTINH, ROILOANSDNAM_MONGTINH, ROILOANSDNAM_LANHTINH
      , ROILOANSDNU_KHONGTHUTHAI, ROILOANSDNU_SAYDONGTHAI, ROILOANSDNU_SAYTHAILIENTIEP, ROILOANSDNU_KHAC, DKXUATHIENBENH_CO, DKXUATHIENBENH_KHONG
      , MOTAVAANCHAN, DA_BINHTHUONG, DA_KHO, DA_NONG, DA_LANH, DA_UOT, DA_CHANTAYNONG, DA_CHANTAYLANH, DA_ANLOM, DA_ANDAU, DA_CUCCUNG
      , DA_KHAC, MOHOI_TOANTHAN, MOHOI_TRAN, MOHOI_TAYCHAN, MOHOIXUCCHAN_KHAC, CXK_SANCHAC, CXK_MEM, CXK_CANGCUNG, CXK_COCOANDAU
      , CXK_GANDAU, CXK_XUONGKHOPDAU, CXK_KHAC, BUNG_MEM, BUNG_CHUONG, BUNG_COCHUONG, BUNG_COHONCUC, BUNG_DAUTHIENAN, BUNG_DAUCUAN
      , BUNG_KHAC, MACHCHAN_PHU, MACHCHAN_TRAM, MACHCHAN_TRI, MACHCHAN_SAC, MACHCHAN_TE, MACHCHAN_HUYEN, MACHCHAN_HOAT, MACHCHAN_VOLUC
      , MACHCHAN_COLUC, MACHCHAN_KHAC, TONGKHAN_PHAI, TONGKHAN_TRAI, VIKHAN_TAYTRAI_THON, VIKHAN_TAYTRAI_QUAN, VIKHAN_TAYTRAI_XICH
      , VIKHAN_TAYPHAI_THON, VIKHAN_TAYPHAI_QUAN, VIKHAN_TAYPHAI_XICH, MOTATHIETCHAN, TOMTATTUCHAN, BIENCHUNGLUANTRI, YHCT_CD_BENHDANH
      , YHCT_CD_BATCUONG, YHCT_CD_KINHLAC, YHCT_CD_NGUYENNHAN, DT_DONTHUAN_YHCT, DT_PHUONGPHAP, DT_PHUONGTHUOC, DT_PHUONGHUYET, DT_XOABOPBAMHUYET
      , DT_KHAC, DT_KETHOP_YHHD, DT_KETHOP_YHHD_TEXT, DD_LONG, DD_DAC, DD_KIENG, DD_KHAC, CS_CAP1, CS_CAP2, CS_CAP3, TIENLUONG
      , QUATRINHBENHLY, TIENSUBANTHAN, TIENSUGIADINH, MACH, NHIETDO, NHIPTHO, CANNANG, HUYETAPCAO, HUYETAPTHAP, KHAMBENHTOANTHAN
      , XETNGHIEMCLSCANLAM, DIUNG, NGAYDIUNG, MATUY, NGAYMATUY, RUOUBIA, NGAYRUOUBIA, THUOCLA, NGAYTHUOCLA, THUOCLAO, NGAYTHUOCLAO
      , TIENSUKHAC, NGAYTIENSUKHAC, TOMTATBENHAN, THANKINH, TUANHOAN, HOHAP, TIEUHOA, COXUONGKHOP, TAIMUIHONG, RANGHAMMAT, TIETNIEU
      , KHIVAOKHOA_BENHCHINH, KHIVAOKHOA_BENHPHU, KHIVAOKHOA_PHANBIET

      FROM
      (
      select BACT.BENHAN_ID, BACT.LOAIBENHAN, BACT.DATAFIELD, BACT.VALUE, BACT.NGUOITAO_ID as NGUOITAOBA_ID, CAST(BACT.NGAYTAO as DATE) AS NGAYTAO
      from TT_NOITRU_BENHANCHUYENKHOA_CHITIET BACT
      where BACT.BENHAN_ID = $BENHAN_ID$
      and BACT.BENHVIEN_ID = '$BENHVIEN_ID$'
      and BACT.LOAIBENHAN = '$LOAIBENHAN_CK$'
      ) AS derived
      PIVOT
      (
      MAX(VALUE)
      FOR DATAFIELD IN (
      YHHD_CDVAOKHOA, YHHD_ICDIDCHINH, YHHD_ICDCHINH, YHHD_ICDCHINH_TEXT, YHHD_ICDIDPHU, YHHD_ICDPHU, YHHD_ICDPHU_TEXT, BENHDANH, BATCUONG, BATCUONG_BIEU, BATCUONG_LY, BATCUONG_HU, BATCUONG_THUC
      , BATCUONG_HAN, BATCUONG_NHIET, BATCUONG_AM, BATCUONG_DUONG, TANGPHU_TAM, TANGPHU_CAN, TANGPHU_TY, TANGPHU_PHE, TANGPHU_TAMBAO, TANGPHU_THAN, TANGPHU_VI
      , TANGPHU_DOM, TANGPHU_TIEUTRUONG, TANGPHU_DAITRANG, TANGPHU_BANGQUANG, TANGPHU_TAMTIEU, TANGPHU_PHUKY, KINHMACH_TAM, KINHMACH_CAN, KINHMACH_TY, KINHMACH_PHE
      , KINHMACH_THAN, KINHMACH_VI, KINHMACH_DAITRUONG, KINHMACH_TIEUTRUONG, KINHMACH_TAMBAOLAC, KINHMACH_TAMTIEU, KINHMACH_DOM, KINHMACH_BANG, KINHMACH_MACH
      , KINHMACH_MACHNHAM, DINHVI_DINH, DINHVI_VE, DINHVI_KHI, DINHVI_HUYET, NN_NOI, NN_NGOAI, NN_BATNOINGOAI, YHCT_CDRAVIEN, KQDT_KHOI, KQDT_DO, KQDT_NANGHON, KQDT_CHUYENVIEN
      , KQDT_TUVONG, KQDT_XINVE, NOITIET_DINHDUONG, MOTACOQUANBENHLY, HINHTHAI_GAY, HINHTHAI_BEO, HINHTHAI_CANDOI, HINHTHAI_NAMCO, HINHTHAI_UATINH, HINHTHAI_NAMDUOI
      , HINHTHAI_HIEUDONG, HINHTHAI_KHAC, THAN_CONTHAN, THAN_KHONGTHAN, THAN_KHAC, SAC_TRANG, SAC_DO, SAC_VANG, SAC_XANH, SAC_DEN, SAC_BINH, SAC_KHAC, TRACH_TUOI, TRACH_KHO
      , TRACH_KHAC, CHATLUOI_BT, CHATLUOI_BEU, CHATLUOI_MONG, CHATLUOI_NUT, CHATLUOI_CUNG, CHATLUOI_LOET, CHATLUOI_LECH, CHATLUOI_RUT, CHATLUOI_KHAC, SACLUOI_HONG
      , SACLUOI_NHOT, SACLUOI_DO, SACLUOI_DOSAM, SACLUOI_XANHTIM, SACLUOI_DAMU, SACLUOI_KHO, SACLUOI_NHUAN, SACLUOI_KHAC, REULUOI_CO, REULUOI_KHONG, REULUOI_BONG, REULUOI_DAY
      , REULUOI_MONG, REULUOI_UOT, REULUOI_KHO, REULUOI_DINH, REULUOI_TRANG, REULUOI_VANG, REULUOI_DEN, REULUOI_KHAC, MOTAVONGCHAN, TIENGNOI_BT, TIENGNOI_TO
      , TIENGNOI_NHO, TIENGNOI_DUTQUANG, TIENGNOI_KHAN, TIENGNOI_NGONG, TIENGNOI_MAT, TIENGNOI_KHAC, HOITHO_BT, HOITHO_DUTQUANG, HOITHO_NGAN, HOITHO_MANH
      , HOITHO_YEU, HOITHO_THO, HOITHO_RIT, HOITHO_KHOKHE, HOITHO_CHAM, HOITHO_GAP, HOITHO_KHAC, HO_TEXT, HO_CO, HO_CO_TEXT, HO_KHONG, HO_KHONG_TEXT, HO_LIENTUC
      , HO_CON, HO_IT, HO_NHIEU, HO_KHAN, HO_CODOM, HO_KHAC, O_CO, O_KHONG, NAC_CO, NAC_KHONG, MUI_CO, MUI_KHONG, MUI_CHUA, MUI_KHAM, MUI_TANH, MUI_THOI, MUI_HOI
      , MUI_KHAC, CHATTHAIBL_CO, CHATTHAIBL_KHONG, CHATTHAIBL_DOM, CHATTHAIBL_CHATNON, CHATTHAIBL_PHAN, CHATTHAIBL_NUOCTIEU, CHATTHAIBL_KHIHU, CHATTHAIBL_KINH
      , CHATTHAIBL_KHAC, MOTAVANCHAN, HANNHIET_BT, HANNHIET_HAN, HANNHIET_NHIET, HANNHIET_KHAC, HANNHIET_THICHNONG, HANNHIET_SONONG, HANNHIET_THICHMAT
      , HANNHIET_SOLANH, HANNHIET_TRONGNONG, HANNHIET_TRONGLANH, HANNHIET_RETRUN, HANNHIET_VANGLAI, HANNHIET_BHKHAC, MOHOI_BT, MOHOI_KHONG, MOHOI_TUHAN
      , MOHOI_DAOHAN, MOHOI_NHIEU, MOHOI_IT, MOHOI_KHAC, DAUMAT_CO, DAUMAT_KHONG, DAUDAU_1CHO, DAUDAU_NUADAU, DAUDAU_CADAU, DAUDAU_DICHUYEN, DAUDAU_EAM
      , DAUDAU_NHOI, DAUDAU_CANG, DAUDAU_NANG, MAT_HOAMAT, MAT_NHINKHONGRO, TAI_U, TAI_DIEC, TAI_NANG, TAI_DAU, MUI_NGAT, MUI_CHAYNUOC, MUI_CHAYMAUCAM
      , MUI_DAU, HONG_DAU, HONG_KHO, COVAI_MOI, COVAI_DAU, COVAI_KHOVANDONG, COVAI_KHAC, LUNGBL_CO, LUNGBL_KHONG, LUNGBL_DAU, LUNGBL_KHOVANDONG
      , LUNGBL_COCUNG, LUNGBL_KHAC, BUNGBL_CO, BUNGBL_KHONG, BUNGBL_TUC, BUNGBL_DAU, BUNGBL_SOI, BUNGBL_NONGRUOT, BUNGBL_DAY, NGUC_KHOTHO, NGUC_TUC
      , NGUC_BONCHON, NGUC_DANHTRONG, NGUC_KHAC, CHANTAY_CO, CHANTAY_KHONG, AN_CO, AN_KHONG, AN_THICHNONG, AN_THICHMAT, AN_NHIEU, AN_IT, AN_DANGMIENG
      , AN_NHATMIENG, AN_THEMAN, AN_CHANAN, AN_BUNGCHUONG, AN_KHAC, UONG_CO, UONG_KHONG, UONG_MAT, UONG_AMNONG, UONG_NHIEU, UONG_IT, UONG_KHAC
      , DAITIEUTIEN_CO, DAITIEUTIEN_KHONG, TIEUTIEN_VANG, TIEUTIEN_DO, TIEUTIEN_DUC, TIEUTIEN_BUOT, TIEUTIEN_DAT, TIEUTIEN_KHONGTUCHU, TIEUTIEN_BI
      , TIEUTIEN_KHAC, DAITIEN_TAO, DAITIEN_NHAO, DAITIEN_SONG, DAITIEN_TOANNUOC, DAITIEN_NHAY, DAITIEN_BI, DAITIEN_KHAC, NGU_CO, NGU_KHONG, NGU_KHO
      , NGU_HAYTINH, NGU_DAYSOM, NGU_HAYMO, NGU_KHAC, KINH_CO, KINH_KHONG, KINH_TRUOCKY, KINH_SAUKY, KINH_LUCTRUOCLUCSAU, KINH_TAC, KINH_KHAC
      , KINH_DAUTRUOCKY, KINH_DAUSAUKY, KINH_DAUTRONGKY, THONGKINH_KHAC, DOIHA_VANG, DOIHA_TRANG, DOIHA_HOI, DOIHA_HONG, DOIHA_KHAC, ROILOANSD_CO
      , ROILOANSD_KHONG, ROILOANSDNAM_YEU, ROILOANSDNAM_LIETDUONG, ROILOANSDNAM_DITINH, ROILOANSDNAM_HOATTINH, ROILOANSDNAM_MONGTINH, ROILOANSDNAM_LANHTINH
      , ROILOANSDNU_KHONGTHUTHAI, ROILOANSDNU_SAYDONGTHAI, ROILOANSDNU_SAYTHAILIENTIEP, ROILOANSDNU_KHAC, DKXUATHIENBENH_CO, DKXUATHIENBENH_KHONG
      , MOTAVAANCHAN, DA_BINHTHUONG, DA_KHO, DA_NONG, DA_LANH, DA_UOT, DA_CHANTAYNONG, DA_CHANTAYLANH, DA_ANLOM, DA_ANDAU, DA_CUCCUNG
      , DA_KHAC, MOHOI_TOANTHAN, MOHOI_TRAN, MOHOI_TAYCHAN, MOHOIXUCCHAN_KHAC, CXK_SANCHAC, CXK_MEM, CXK_CANGCUNG, CXK_COCOANDAU
      , CXK_GANDAU, CXK_XUONGKHOPDAU, CXK_KHAC, BUNG_MEM, BUNG_CHUONG, BUNG_COCHUONG, BUNG_COHONCUC, BUNG_DAUTHIENAN, BUNG_DAUCUAN
      , BUNG_KHAC, MACHCHAN_PHU, MACHCHAN_TRAM, MACHCHAN_TRI, MACHCHAN_SAC, MACHCHAN_TE, MACHCHAN_HUYEN, MACHCHAN_HOAT, MACHCHAN_VOLUC
      , MACHCHAN_COLUC, MACHCHAN_KHAC, TONGKHAN_PHAI, TONGKHAN_TRAI, VIKHAN_TAYTRAI_THON, VIKHAN_TAYTRAI_QUAN, VIKHAN_TAYTRAI_XICH
      , VIKHAN_TAYPHAI_THON, VIKHAN_TAYPHAI_QUAN, VIKHAN_TAYPHAI_XICH, MOTATHIETCHAN, TOMTATTUCHAN, BIENCHUNGLUANTRI, YHCT_CD_BENHDANH
      , YHCT_CD_BATCUONG, YHCT_CD_KINHLAC, YHCT_CD_NGUYENNHAN, DT_DONTHUAN_YHCT, DT_PHUONGPHAP, DT_PHUONGTHUOC, DT_PHUONGHUYET, DT_XOABOPBAMHUYET
      , DT_KHAC, DT_KETHOP_YHHD, DT_KETHOP_YHHD_TEXT, DD_LONG, DD_DAC, DD_KIENG, DD_KHAC, CS_CAP1, CS_CAP2, CS_CAP3, TIENLUONG
      , QUATRINHBENHLY, TIENSUBANTHAN, TIENSUGIADINH, MACH, NHIETDO, NHIPTHO, CANNANG, HUYETAPCAO, HUYETAPTHAP, KHAMBENHTOANTHAN
      , XETNGHIEMCLSCANLAM, DIUNG, NGAYDIUNG, MATUY, NGAYMATUY, RUOUBIA, NGAYRUOUBIA, THUOCLA, NGAYTHUOCLA, THUOCLAO, NGAYTHUOCLAO
      , TIENSUKHAC, NGAYTIENSUKHAC, TOMTATBENHAN, THANKINH, TUANHOAN, HOHAP, TIEUHOA, COXUONGKHOP, TAIMUIHONG, RANGHAMMAT, TIETNIEU
      , KHIVAOKHOA_BENHCHINH, KHIVAOKHOA_BENHPHU, KHIVAOKHOA_PHANBIET

      )
      ) AS p
    </statement>
    <statement id="DAO00080_Delete_BenhAnChuyenKhoa_YHCT" parameterClass="System.Collections.IDictionary" resultClass="System.Int32">
      IF EXISTS (SELECT 1 FROM TT_NOITRU_BENHANCHUYENKHOA_CHITIET WHERE BENHAN_ID = $BENHAN_ID$ AND BENHVIEN_ID = '$BENHVIEN_ID$' AND LOAIBENHAN = '$LOAIBENHAN_CK$')
      BEGIN

      DELETE FROM TT_NOITRU_BENHANCHUYENKHOA_CHITIET
      WHERE BENHAN_ID = $BENHAN_ID$
      AND BENHVIEN_ID = '$BENHVIEN_ID$'
      AND LOAIBENHAN = '$LOAIBENHAN_CK$'

      END

      SELECT 1
    </statement>
    <statement id="DAO00080_Add_BenhAnChuyenKhoa_YHCT" parameterClass="System.Collections.IDictionary" resultClass="System.Int64">
      INSERT INTO TT_NOITRU_BENHANCHUYENKHOA_CHITIET (
      BENHAN_ID
      , LOAIBENHAN
      , DATAFIELD
      , VALUE
      , NGUOITAO_ID
      , NGAYTAO
      , BENHVIEN_ID
      ) values (
      #BENHAN_ID#
      , #LOAIBENHAN#
      , #DATAFIELD#
      , #VALUE#
      , #NGUOITAO_ID#
      , #NGAYTAO#
      , #BENHVIEN_ID#
      )
    </statement>
    <statement id="DAO00080_InitData_BenhAn_YHCT" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      select BA.CHANDOANVAOKHOA AS YHHD_CDVAOKHOA, BA.ICD_BENHCHINH AS YHHD_ICDIDCHINH, BA.ICD_BENHPHU AS YHHD_ICDIDPHU
      , BA.QUATRINHBENHLY, BA.TIENSUBANTHAN, BA.TIENSUGIADINH, BA.MACH, BA.NHIETDO, BA.NHIPTHO, BA.CANNANG, BA.HUYETAPCAO
      , BA.HUYETAPTHAP, BA.TIENLUONG, BACT.LYDOVAOVIEN,  BACT.KHAMBENHTOANTHAN, BACT.XETNGHIEMCLSCANLAM
      , BACT.DIUNG, BACT.NGAYDIUNG, BACT.MATUY, BACT.NGAYMATUY, BACT.RUOUBIA, BACT.NGAYRUOUBIA, BACT.THUOCLA
      , BACT.NGAYTHUOCLA, BACT.THUOCLAO, BACT.NGAYTHUOCLAO, BACT.TIENSUKHAC, BACT.NGAYTIENSUKHAC, BACT.TOMTATBENHAN
      , BACT.THANKINH, BACT.TUANHOAN, BACT.HOHAP, BACT.TIEUHOA, BACT.COXUONGKHOP, BACT.TIETNIEU + ' - ' + BACT.SINHDUC AS TIETNIEU
      , BACT.TAIMUIHONG, BACT.RANGHAMMAT
      from TT_NOITRU_BENHAN BA
      left join TT_NOITRU_BENHAN_CHITIET BACT on BACT.BENHAN_ID = BA.BENHAN_ID and BACT.BENHVIEN_ID = BA.BENHVIEN_ID
      where BA.BENHAN_ID = $BENHAN_ID$ and BA.BENHVIEN_ID = '$BENHVIEN_ID$'
    </statement>
    <update id="DAO00080_Update_BenhAn_YHCT" parameterClass="System.Collections.IDictionary">
      update TT_NOITRU_BENHAN set
      CHANDOANVAOKHOA = #YHHD_CDVAOKHOA#
      <isPropertyAvailable prepend="," property="ICD_BENHCHINH">ICD_BENHCHINH = #YHHD_ICDIDCHINH#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="ICD_BENHPHU">ICD_BENHPHU = #YHHD_ICDIDPHU#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="QUATRINHBENHLY">QUATRINHBENHLY = #QUATRINHBENHLY#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="TIENSUBANTHAN">TIENSUBANTHAN = #TIENSUBANTHAN#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="TIENSUGIADINH">TIENSUGIADINH = #TIENSUGIADINH#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="MACH">MACH = #MACH#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NHIETDO">NHIETDO = #NHIETDO#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NHIPTHO">NHIPTHO = #NHIPTHO#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="CANNANG">CANNANG = #CANNANG#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="HUYETAPCAO">HUYETAPCAO = #HUYETAPCAO#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="HUYETAPTHAP">HUYETAPTHAP = #HUYETAPTHAP#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="TIENLUONG">TIENLUONG = #TIENLUONG#</isPropertyAvailable>
      where  BENHAN_ID = $BENHAN_ID$
    </update>
    <update id="DAO00080_Update_BenhAn_YHCT_ChiTiet" parameterClass="System.Collections.IDictionary">
      update TT_NOITRU_BENHAN_CHITIET set
      LYDOVAOVIEN = #LYDOVAOVIEN#
      <isPropertyAvailable prepend="," property="KHAMBENHTOANTHAN">KHAMBENHTOANTHAN = #KHAMBENHTOANTHAN#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="XETNGHIEMCLSCANLAM">XETNGHIEMCLSCANLAM = #XETNGHIEMCLSCANLAM#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="DIUNG">DIUNG = #DIUNG#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGAYDIUNG">NGAYDIUNG = #NGAYDIUNG#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="MATUY">MATUY = #MATUY#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGAYMATUY">NGAYMATUY = #NGAYMATUY#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="RUOUBIA">RUOUBIA = #RUOUBIA#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGAYRUOUBIA">NGAYRUOUBIA = #NGAYRUOUBIA#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="THUOCLA">THUOCLA = #THUOCLA#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGAYTHUOCLA">NGAYTHUOCLA = #NGAYTHUOCLA#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="THUOCLAO">THUOCLAO = #THUOCLAO#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGAYTHUOCLAO">NGAYTHUOCLAO = #NGAYTHUOCLAO#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="TIENSUKHAC">TIENSUKHAC = #TIENSUKHAC#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGAYTIENSUKHAC">NGAYTIENSUKHAC = #NGAYTIENSUKHAC#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="TOMTATBENHAN">TOMTATBENHAN = #TOMTATBENHAN#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="THANKINH">THANKINH = #THANKINH#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="TUANHOAN">TUANHOAN = #TUANHOAN#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="HOHAP">HOHAP = #HOHAP#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="TIEUHOA">TIEUHOA = #TIEUHOA#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="COXUONGKHOP">COXUONGKHOP = #COXUONGKHOP#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="TAIMUIHONG">TAIMUIHONG = #TAIMUIHONG#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="RANGHAMMAT">RANGHAMMAT = #RANGHAMMAT#</isPropertyAvailable>
      where      BENHAN_ID = $BENHAN_ID$
    </update>
    <statement id="DAO00080_XoaPhieuSoKetByID" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      IF EXISTS (
      SELECT BENHAN_SOKET_ID
      FROM TT_NOITRU_SOKET
      WHERE BENHAN_SOKET_ID = #BENHAN_SOKET_ID# AND BENHVIEN_ID = '$BENHVIEN_ID$')
      BEGIN
      DELETE FROM TT_NOITRU_SOKET
      WHERE BENHAN_SOKET_ID = #BENHAN_SOKET_ID# AND BENHVIEN_ID = '$BENHVIEN_ID$'
      SELECT @@ROWCOUNT AS ROWAFFECTED
      END
      ELSE
      BEGIN
      SELECT 0  AS ROWAFFECTED
      END
    </statement>
    <statement id="DAO00080_LayLoaiBenhanCuNoitru" parameterClass="System.Collections.IDictionary" resultClass="System.Int64">
      select LOAIBENHAN from TT_NOITRU_BENHAN where TIEPNHAN_ID = #TIEPNHAN_ID#
    </statement>
    <statement id="DAO00080_GetDSYLenhTruyenDich" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      select DT.THOIGIANYLENH, PB.PHONGBAN_ID, PB.TENPHONGBAN AS KHOACHIDINH
      , DT.LUUTRU_ID, DT.CHAMSOCDICHTRUYEN_ID, CAST(0 AS bit) AS CHON, DT.THOIGIANBATDAU
      from TT_NOITRU_CHAMSOCDICHTRUYEN DT
      left join TT_NOITRU_LUUTRU LT on LT.LUUTRU_ID = DT.LUUTRU_ID and LT.BENHVIEN_ID = DT.BENHVIEN_ID
      left join TM_PHONGBAN PB on PB.PHONGBAN_ID = LT.PHONGBAN_ID and PB.BENHVIEN_ID = LT.BENHVIEN_ID
      where DT.BENHAN_ID = '$BENHAN_ID$' and DT.BENHVIEN_ID = '$BENHVIEN_ID$'
      order by DT.THOIGIANBATDAU desc
    </statement>
    <statement id="DAO00080_GetChiTietTruyenDich" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      select DT.DUOC_ID, DT.SOLUONG, DT.SOLOSX, DT.TOCDOTRUYEN, DT.THOIGIANBATDAU, DT.THOIGIANKETTHUC, BS.TENNHANVIEN AS BACSICHIDINH,
      DD.TENNHANVIEN AS DIEUDUONG, D.TENDUOCDAYDU, ROW_NUMBER () OVER(ORDER BY D.AUTOCOMPLETEFIELD)  AS STT, DT.CHAMSOCDICHTRUYEN_ID,
      DT.BACSICHIDINH_ID, DT.DIEUDUONGTHUCHIEN_ID, DT.SOMLCHAYNGUOC, DT.SOMLGIAOLAI, DT.GHICHU, DT.SOGIOTTRENPHUT
      from TT_NOITRU_CHAMSOCDICHTRUYEN DT
      left join TM_NHANVIEN BS on BS.NHANVIEN_ID = DT.BACSICHIDINH_ID and BS.BENHVIEN_ID = DT.BENHVIEN_ID
      left join TM_NHANVIEN DD on DD.NHANVIEN_ID = DT.DIEUDUONGTHUCHIEN_ID and DD.BENHVIEN_ID = DT.BENHVIEN_ID
      left join TM_DUOC D on D.DUOC_ID = DT.DUOC_ID and D.BENHVIEN_ID = DT.BENHVIEN_ID
      where DT.BENHAN_ID = '$BENHAN_ID$' and DT.LUUTRU_ID = '$LUUTRU_ID$'
      <!--and cast(DT.THOIGIANYLENH as date) = CAST('$NGAYYLENH$' as date)-->
      AND DT.CHAMSOCDICHTRUYEN_ID = '$CHAMSOCDICHTRUYEN_ID$'
      and DT.BENHVIEN_ID = '$BENHVIEN_ID$'
      order by D.AUTOCOMPLETEFIELD
    </statement>
    <update id="DAO00080_Update_ThongTinDichTruyen" parameterClass="System.Collections.IDictionary">
      update TT_NOITRU_CHAMSOCDICHTRUYEN set
      DUOC_ID = #DUOC_ID#
      <isPropertyAvailable prepend="," property="SOLUONG">SOLUONG = #SOLUONG#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="SOMLCHAYNGUOC">SOMLCHAYNGUOC = #SOMLCHAYNGUOC#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="SOMLGIAOLAI">SOMLGIAOLAI = #SOMLGIAOLAI#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="TOCDOTRUYEN">TOCDOTRUYEN = #TOCDOTRUYEN#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="THOIGIANBATDAU">THOIGIANBATDAU = #THOIGIANBATDAU#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="THOIGIANKETTHUC">THOIGIANKETTHUC = #THOIGIANKETTHUC#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="SOLOSX">SOLOSX = #SOLOSX#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="THOIGIANYLENH">THOIGIANYLENH = #THOIGIANYLENH#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="BENHVIEN_ID">BENHVIEN_ID = #BENHVIEN_ID#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGAYCAPNHAT">NGAYCAPNHAT = #NGAYCAPNHAT#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGUOICAPNHAT_ID">NGUOICAPNHAT_ID = #NGUOICAPNHAT_ID#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="BACSICHIDINH_ID">BACSICHIDINH_ID = #BACSICHIDINH_ID#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="DIEUDUONGTHUCHIEN_ID">DIEUDUONGTHUCHIEN_ID = #DIEUDUONGTHUCHIEN_ID#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="GHICHU">GHICHU = #GHICHU#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="SOGIOTTRENPHUT">SOGIOTTRENPHUT = #SOGIOTTRENPHUT#</isPropertyAvailable>
      where      CHAMSOCDICHTRUYEN_ID = '$CHAMSOCDICHTRUYEN_ID$'
    </update>
    <insert id="DAO00080_Add_ThongTinDichTruyen" parameterClass="System.Collections.IDictionary" resultClass="System.Int64">
      insert into TT_NOITRU_CHAMSOCDICHTRUYEN (
      DUOC_ID
      , SOLUONG
      , BENHVIEN_ID
      , NGAYTAO
      , NGUOITAO_ID
      , TOCDOTRUYEN
      , BENHAN_ID
      , LUUTRU_ID
      , BACSICHIDINH_ID
      , DIEUDUONGTHUCHIEN_ID
      , THOIGIANBATDAU
      , THOIGIANKETTHUC
      , SOLOSX
      , THOIGIANYLENH
      , SOMLCHAYNGUOC
      , SOMLGIAOLAI
      , GHICHU
      , SOGIOTTRENPHUT
      ) values (
      #DUOC_ID#
      , #SOLUONG#
      , #BENHVIEN_ID#
      , #NGAYTAO#
      , #NGUOITAO_ID#
      , #TOCDOTRUYEN#
      , #BENHAN_ID#
      , #LUUTRU_ID#
      , #BACSICHIDINH_ID#
      , #DIEUDUONGTHUCHIEN_ID#
      , #THOIGIANBATDAU#
      , #THOIGIANKETTHUC#
      , #SOLOSX#
      , #THOIGIANYLENH#
      , #SOMLCHAYNGUOC#
      , #SOMLGIAOLAI#
      , #GHICHU#
      , #SOGIOTTRENPHUT#
      )
    </insert>
    <statement id="DAO00080_Delete_PhieuTruyenDich" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      IF EXISTS (SELECT 1 FROM TT_NOITRU_CHAMSOCDICHTRUYEN
      WHERE BENHAN_ID = '$BENHAN_ID$'
      AND BENHVIEN_ID = '$BENHVIEN_ID$'
      AND LUUTRU_ID = '$LUUTRU_ID$'
      <!--AND CAST(THOIGIANYLENH AS DATE) = CAST('$THOIGIANYLENH$' AS DATE)-->
      AND CHAMSOCDICHTRUYEN_ID = '$CHAMSOCDICHTRUYEN_ID$'
      )
      BEGIN

      DELETE FROM TT_NOITRU_CHAMSOCDICHTRUYEN
      WHERE BENHAN_ID = '$BENHAN_ID$'
      AND BENHVIEN_ID = '$BENHVIEN_ID$'
      AND LUUTRU_ID = '$LUUTRU_ID$'
      <!--AND CAST(THOIGIANYLENH AS DATE) = CAST('$THOIGIANYLENH$' AS DATE)-->
      AND CHAMSOCDICHTRUYEN_ID = '$CHAMSOCDICHTRUYEN_ID$'

      END

      SELECT 1
    </statement>
    <statement id="DAO00080_CheckTrangThaiDaXacNhanBHYT" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      IF EXISTS (
      select XACNHANCHIPHI_ID
      from TT_XACNHANCHIPHI
      where BENHAN_ID = '$BENHAN_ID$'
      and BENHNHAN_ID = '$BENHNHAN_ID$'
      and BENHVIEN_ID = '$BENHVIEN_ID$'
      )
      BEGIN
      SELECT -1 AS RESULT
      END
      ELSE
      BEGIN
      SELECT 1 AS RESULT
      END
    </statement>
    <statement id="DAO00080_GetLastLuutru_idCuaBenhan" parameterClass="System.Collections.IDictionary" resultClass="System.Int64">
      select MAX(LUUTRU_ID) LUUTRU_ID from TT_NOITRU_LUUTRU where BENHAN_ID = #BENHAN_ID#
    </statement>
    <statement id="DAO00080_CheckConThuocVTYTChuaXuat" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      IF EXISTS (
      select VTYT.KHAMBENH_VTYT_ID
      from TT_NGOAITRU_KHAMBENH_VTYT VTYT
      inner join TT_NGOAITRU_KHAMBENH KB on KB.KHAMBENH_ID = VTYT.KHAMBENH_ID and KB.BENHVIEN_ID = VTYT.BENHVIEN_ID
      where KB.TIEPNHAN_ID = $TIEPNHAN_ID$
      and KB.BENHVIEN_ID = '$BENHVIEN_ID$'
      and VTYT.CHUNGTU_ID IS NULL

      union all

      select VTYT.PHAUTHUAT_VTYT_ID
      from TT_PHAUTHUAT_VTYT VTYT
      inner join TT_PHAUTHUAT PT on PT.PHAUTHUAT_ID = VTYT.PHAUTHUAT_ID and PT.BENHVIEN_ID = VTYT.BENHVIEN_ID
      where PT.TIEPNHAN_ID = $TIEPNHAN_ID$
      and PT.BENHVIEN_ID = '$BENHVIEN_ID$'
      and VTYT.CHUNGTU_ID IS NULL

      union all

      select VTYT.CLSKETQUA_VTYT_ID
      from TT_CLSKETQUA_VTYT VTYT
      inner join TT_DVYEUCAU YC on YC.DVYEUCAU_ID = VTYT.DVYEUCAU_ID and YC.BENHVIEN_ID = VTYT.BENHVIEN_ID
      where YC.TIEPNHAN_ID = $TIEPNHAN_ID$
      and YC.BENHVIEN_ID = '$BENHVIEN_ID$'
      and VTYT.CHUNGTU_ID IS NULL
      )
      BEGIN
      SELECT -1 AS RESULT
      END
      ELSE
      BEGIN
      SELECT 1 AS RESULT
      END
    </statement>
    <statement id="DAO00080_LaysodichvuChidinhGiuong" parameterClass="System.Collections.IDictionary" resultClass="System.Int64">
      <!--select sum(SODICHVUYEUCAU)
      from TT_DVYEUCAU dvyc
      left join TM_DICHVU dv on dv.DICHVU_ID = dvyc.DICHVU_ID
      left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID
      where left(ndv.MANHOMDICHVU, 2) = '08' and dvyc.BENHAN_ID = '$BENHAN_ID$'-->
      
      <!--Lấy số lượng trong viện phí-->
      select sum(SOLUONG) AS SOLUONG
      from TT_DVYEUCAU dvyc
      inner join TT_VIENPHI VP on VP.REF_ID = dvyc.DVYEUCAU_ID and REF_TABLE = 'TT_DVYEUCAU'
      left join TM_DICHVU dv on dv.DICHVU_ID = dvyc.DICHVU_ID
      left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID
      where left(ndv.MANHOMDICHVU, 2) = '08' and dvyc.BENHAN_ID = $BENHAN_ID$ and dvyc.HUYYEUCAU = '0'
    </statement>
    <statement id="DAO00080_XoaBenhAnChuyenNgoaitru" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      begin
      delete from TT_NOITRU_BENHAN where BENHAN_ID = #BENHAN_ID#
      delete from TT_NOITRU_XACNHAN where  BENHAN_ID = #BENHAN_ID#
      Update TT_VIENPHI set BENHAN_ID = null where BENHAN_ID = #BENHAN_ID#
      Update TT_HOADON set BENHAN_ID = null where BENHAN_ID = #BENHAN_ID#
      
      Update TT_TIEPNHAN set TRANGTHAI = 'DATIEPNHAN' where TIEPNHAN_ID = #TIEPNHAN_ID#
      Update TT_NOITRU_NHAPVIEN set TRANGTHAI = 'CHOXACNHAN' where TIEPNHAN_ID = #TIEPNHAN_ID#
      end
    </statement>
    <statement id="DAO00080_KiemTraThoiGianThucHienDVYC" parameterClass="System.Collections.IDictionary" resultClass="System.Int64">
      select COUNT(1)
      from TT_DVYEUCAU YC
      inner join TT_CLSKETQUA KQ ON KQ.DVYEUCAU_ID = YC.DVYEUCAU_ID
      where YC.BENHAN_ID = $BENHAN_ID$
      and KQ.THOIGIANTHUCHIEN > '$THOIGIANRAVIEN$'
    </statement>
    <statement id="DAO00080_KiemTraThoiGianThucHienPTTT" parameterClass="System.Collections.IDictionary" resultClass="System.Int64">
      select COUNT(1)
      from TT_PHAUTHUAT PT
      where PT.BENHAN_ID = $BENHAN_ID$
      and PT.THOIGIANKETTHUC > '$THOIGIANRAVIEN$'
    </statement>
    <statement id="DAO00080_LuuNoitruChandoanICD" parameterClass="System.Collections.IDictionary" resultClass="System.Int64">
      update TT_NOITRU_BENHAN
      set 
      ICD_BENHCHINH = #ICD_BENHCHINH#
      <isPropertyAvailable prepend="," property="ICD_BENHPHU">
        ICD_BENHPHU = #ICD_BENHPHU#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="CHANDOANRAVIEN">
        CHANDOANRAVIEN = #CHANDOANRAVIEN#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="ICD_KHAMBENH">
        ICD_KHAMBENH = #ICD_KHAMBENH#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="CHANDOANKHAMBENH">
        CHANDOANKHAMBENH = #CHANDOANKHAMBENH#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="ICD_VAOKHOA">
        ICD_VAOKHOA = #ICD_VAOKHOA#
      </isPropertyAvailable>
      <isNotEmpty prepend="," property="ICD_PHU_VAOKHOA">
        ICD_PHU_VAOKHOA = #ICD_PHU_VAOKHOA#
      </isNotEmpty>
      <isPropertyAvailable prepend="," property="CHANDOANVAOKHOA">
        CHANDOANVAOKHOA = #CHANDOANVAOKHOA#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="ICDRAVIEN_CHINH">
        ICDRAVIEN_CHINH = #ICDRAVIEN_CHINH#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="ICDRAVIEN_PHU">
        ICDRAVIEN_PHU = #ICDRAVIEN_PHU#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="CDRAVIEN_CHINH">
        CDRAVIEN_CHINH = #CDRAVIEN_CHINH#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="CDRAVIEN_PHU">
        CDRAVIEN_PHU = #CDRAVIEN_PHU#
      </isPropertyAvailable>
      <isPropertyAvailable prepend="," property="CHANDOANKHAC">
        CHANDOANKHAC = #CHANDOANKHAC#
      </isPropertyAvailable>
      where BENHAN_ID = $BENHAN_ID$
    </statement>
  </statements>
</sqlMap>
