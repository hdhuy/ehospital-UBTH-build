<?xml version="1.0" encoding="utf-8" ?>
<!--============================================================================
//	CAUTION: This file is generated by IBatisNetGen.3.SQLMap.cst at 12/21/2015 2:22:43 PM
//				Any manual editing will be lost in re-generation.
//===========================================================================-->
<sqlMap namespace="eHospital" xmlns="http://ibatis.apache.org/mapping" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">

  <statements>
    <statement id="DAO00090_GetAll" resultClass="DataObject">
      select *
      from TT_NOITRU_TRATHUOC_CHITIET
      order by TRATHUOCCHITIET_ID
    </statement>
    <statement id="DAO00090_GetList" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      select ttct.*, tt.SOLUONG as SLYLENH
      from TT_NOITRU_TRATHUOC_CHITIET ttct
      left join TT_NOITRU_TOATHUOC tt
      on ttct.TOATHUOC_ID = tt.TOATHUOC_ID
      <dynamic prepend="where">
        <isParameterPresent>
          <isNotEmpty prepend="and" property="TRATHUOC_ID">
            ttct.TRATHUOC_ID = '$TRATHUOC_ID$'
          </isNotEmpty>          
        </isParameterPresent>
      </dynamic>
      order by ttct.TRATHUOCCHITIET_ID
    </statement>
    <statement id="DAO00090_GetDetail" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      select *
      from TT_NOITRU_TRATHUOC_CHITIET
      where TRATHUOCCHITIET_ID  = '$value$'
      order by TRATHUOCCHITIET_ID
    </statement>
    <statement id="DAO00090_GetDetailP" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      select *
      from TT_NOITRU_TRATHUOC_CHITIET
      where TRATHUOCCHITIET_ID  = '$TRATHUOCCHITIET_ID$'
      order by TRATHUOCCHITIET_ID
    </statement>
    <insert id="DAO00090_Add" parameterClass="System.Collections.IDictionary" resultClass="System.Int64">
      <selectKey property="ID" type="pre" resultClass="System.Int64">
        select TT_NOITRU_TRATHUOC_CHITIET_S.nextval as value from dual
      </selectKey>
      insert into TT_NOITRU_TRATHUOC_CHITIET (
      TRATHUOCCHITIET_ID
      , TRATHUOC_ID
      , TOATHUOC_ID
      , DUOC_ID
      , SOLUONG
      , DAHOANTRA
      , CHUNGTUTRA_ID
      , CHUNGTUCHITIET_ID
      , NGUOITAO_ID
      , NGAYTAO
      , NGUOICAPNHAT_ID
      , NGAYCAPNHAT
      , BENHVIEN_ID
      ) values (
      #ID#
      , #TRATHUOC_ID#
      , #TOATHUOC_ID#
      , #DUOC_ID#
      , #SOLUONG#
      , #DAHOANTRA#
      , #CHUNGTUTRA_ID#
      , #CHUNGTUCHITIET_ID#
      , #NGUOITAO_ID#
      , #NGAYTAO#
      , #NGUOICAPNHAT_ID#
      , #NGAYCAPNHAT#
      , #BENHVIEN_ID#
      )     
    </insert>

    <update id="DAO00090_Update" parameterClass="System.Collections.IDictionary">
      update TT_NOITRU_TRATHUOC_CHITIET set
      TRATHUOC_ID = #TRATHUOC_ID#
      , TOATHUOC_ID = #TOATHUOC_ID#
      , DUOC_ID = #DUOC_ID#
      , SOLUONG = #SOLUONG#
      , DAHOANTRA = #DAHOANTRA#
      , CHUNGTUTRA_ID = #CHUNGTUTRA_ID#
      , CHUNGTUCHITIET_ID = #CHUNGTUCHITIET_ID#
      , NGUOICAPNHAT_ID = #NGUOICAPNHAT_ID#
      , NGAYCAPNHAT = #NGAYCAPNHAT#
      , BENHVIEN_ID = #BENHVIEN_ID#
      where
      TRATHUOCCHITIET_ID = '$TRATHUOCCHITIET_ID$'
    </update>

    <statement id="DAO00090_Delete" parameterClass="System.Collections.IDictionary" resultClass="System.Int32">
      delete from TT_NOITRU_TRATHUOC_CHITIET
      where
      TRATHUOCCHITIET_ID = '$TRATHUOCCHITIET_ID$'
    </statement>

    <statement id="DAO00090_DeleteP" parameterClass="System.Collections.IDictionary" resultClass="System.Int32">
      delete from TT_NOITRU_TRATHUOC_CHITIET
      <dynamic prepend="where">
        <isParameterPresent>
          <isNotEmpty prepend="and" property="TRATHUOCCHITIET_ID">
            TRATHUOCCHITIET_ID = '$TRATHUOCCHITIET_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="TRATHUOC_ID">
            TRATHUOC_ID = '$TRATHUOC_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="TOATHUOC_ID">
            TOATHUOC_ID = '$TOATHUOC_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="DUOC_ID">
            DUOC_ID = '$DUOC_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="SOLUONG">
            SOLUONG = '$SOLUONG$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="DAHOANTRA">
            DAHOANTRA = '$DAHOANTRA$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="CHUNGTUTRA_ID">
            CHUNGTUTRA_ID = '$CHUNGTUTRA_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="CHUNGTUCHITIET_ID">
            CHUNGTUCHITIET_ID = '$CHUNGTUCHITIET_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="BENHVIEN_ID">
            BENHVIEN_ID = '$BENHVIEN_ID$'
          </isNotEmpty>
        </isParameterPresent>
      </dynamic>
    </statement>
    <statement id="DAO00090_GetSLDaXuat" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      SELECT SUM(SOLUONGDAXUAT) SOLUONGDAXUAT FROM TT_DUOC_CHUNGTU_CHITIET
      WHERE CHUNGTU_ID IN
      (SELECT CHUNGTU_ID FROM TT_DUOC_CHUNGTU WHERE BENHAN_ID = '$BENHAN_ID$' and DUOC_ID = '$DUOC_ID$')
    </statement>
    
    <statement id="DAO00090_GetSLTamNgung" parameterClass="System.Collections.IDictionary" resultClass="DataObject">      
      SELECT SOLUONG as SOLUONGDANGUNG FROM TT_NOITRU_TRATHUOC_CHITIET
      <!--WHERE TRATHUOC_ID IN
      (SELECT TRATHUOC_ID FROM TT_NOITRU_TRATHUOC WHERE BENHAN_ID = '$BENHAN_ID$' and DUOC_ID = '$DUOC_ID$')-->
      where TRATHUOCCHITIET_ID = '$TRATHUOCCHITIET_ID$'
      and BENHVIEN_ID = '$BENHVIEN_ID$'
    </statement>
  
    <statement id="DAO00090_CapNhatTThaiThuocTamNgung" parameterClass="System.Collections.IDictionary" resultClass="DataObject">      
      select *
      from TT_NOITRU_TRATHUOC_CHITIET
      where TRATHUOCCHITIET_ID  = '$TRATHUOCCHITIET_ID$'
    </statement>
  
    <statement id="DAO00090_DeleteThuocInList" parameterClass="HashTable" resultClass="DataObject">
      select TOATHUOC_ID, SOLUONG from TT_NOITRU_TRATHUOC_CHITIET
      where TRATHUOC_ID = #TRATHUOC_ID#
      <dynamic prepend=" and TRATHUOCCHITIET_ID in ">
        <iterate open="(" close=")" conjunction=",  " property="LSTTRATHUOC_ID">#LSTTRATHUOC_ID[]#</iterate>
      </dynamic>

      delete from TT_NOITRU_TRATHUOC_CHITIET
      where TRATHUOC_ID = #TRATHUOC_ID#
      <dynamic prepend=" and TRATHUOCCHITIET_ID in ">
        <iterate open="(" close=")" conjunction=",  " property="LSTTRATHUOC_ID">#LSTTRATHUOC_ID[]#</iterate>
      </dynamic>
    </statement>

    <statement id="DAO00090_XoaTraThuocChiTietByTraThuocID" parameterClass="HashTable" resultClass="DataObject">
      select TOATHUOC_ID, SOLUONG from TT_NOITRU_TRATHUOC_CHITIET
      where TRATHUOC_ID = #TRATHUOC_ID#
      and BENHVIEN_ID = #BENHVIEN_ID#

      delete from TT_NOITRU_TRATHUOC_CHITIET
      where TRATHUOC_ID = #TRATHUOC_ID#
      and BENHVIEN_ID = #BENHVIEN_ID#
    </statement>
        
  </statements>

</sqlMap>
