<?xml version="1.0" encoding="utf-8" ?>
<!--============================================================================
//	CAUTION: This file is generated by IBatisNetGen.3.SQLMap.cst at 11/20/2015 4:06:44 PM
//				Any manual editing will be lost in re-generation.
//===========================================================================-->
<sqlMap namespace="eHospital" xmlns="http://ibatis.apache.org/mapping" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">

  <statements>
    <insert id="DAO00112_Add" parameterClass="System.Collections.IDictionary" resultClass="System.Int64">
      <selectKey property="ID" type="pre" resultClass="System.Int64">
        select TT_DUOC_KYGUI_CHUNGTU_S.nextval as value from dual
      </selectKey>
      insert into TT_DUOC_KYGUI_CHUNGTU (
      CHUNGTU_ID
      , MACHUNGTU
      , SOCHUNGTU
      , NGAYCHUNGTU
      , LOAICHUNGTU
      , MUCDICHCHUNGTU_ID
      , MUCDICHCHUNGTU_CODE
      , KHOXUAT_ID
      , NGUOIGIAO_ID
      , NGUOIGIAO
      , KHONHAP_ID
      , NGUOINHAN_ID
      , NGUOINHAN
      , NGUOIKIEMTRA_ID
      , NGUOIKIEMTRA
      , NGUOIDUYET_ID
      , NGUOIDUYET
      , KETOANTRUONG_ID
      , KETOANTRUONG
      , THUKHO_ID
      , THUKHO
      , MAUHOADON
      , SOHOADON
      , SOSERI
      , NGAYHOADON
      , DIENGIAI
      , GIATRI
      , GIATRITHANHTOAN
      , TYLEVAT
      , GIATRIVAT
      , THUESUAT
      , GIATRITHUE
      , TYLECHIETKHAU
      , GIATRICHIETKHAU
      , TIENTE_ID
      , TYGIA
      , SOCHUNGTUGOC
      , NGAYCHUNGTUGOC
      , NHACUNGCAP_ID
      , HINHTHUCTHANHTOAN_ID
      , NGUONDUOC_ID
      , CHUNGTULIENQUAN_ID
      , KHAMBENH_ID
      , TOATHUOCNOITRU_ID
      , BENHAN_ID
      , DANHANTHUOC
      , NGUOINHAP_ID
      , NGAYNHAP
      , TRANGTHAI
      , PHIEULINH_ID
      , DIENGIAINGHIEPVUPHATSINH
      , DONVIGIAO_ID
      , KHOSUDUNG_ID
      , LOAIVATTU_ID
      , BENHNHAN_ID
      , TENBENHNHAN
      , BACSIGIOITHIEU_ID
      , DOITUONG_ID
      , IDCHUYEN
      , CHUNGTUKETOAN
      , STATUS
      , TRANSFER_VIENPHI_ID
      , PHONGBAN_ID
      , BACSI_ID
      , TKNO
      , TKCO
      , MACHUNGTUREF
      , LOAICHUNGTUREF
      , PHIEULINHCANTRU_ID
      , KHOTHUCHIEN_ID
      , KHODOIUNG_ID
      , MENU_LOAIDUOC_ID
      , NGUOISUDUNGMAY_ID
      , GOITHAU_ID
      , XUATTHUOCBANGOAITRU
      , NGAYGIOCHUNGTU
      , NOIDAKHAM
      , HOIDONGKIEMNHAP_ID
      , HOIDONGTHANHLY_ID
      , CHUYENCHUNGTUID
      , CHUYENDOANHTHUID
      , LYDOXUATSUDUNG_ID
      , BENHVIEN_ID
      , NGAYTAO
      , NGUOITAO_ID
      , NGAYCAPNHAT
      , NGUOICAPNHAT_ID
      ) values (
      #ID#
      , #MACHUNGTU#
      , #SOCHUNGTU#
      , #NGAYCHUNGTU#
      , #LOAICHUNGTU#
      , #MUCDICHCHUNGTU_ID#
      , #MUCDICHCHUNGTU_CODE#
      , #KHOXUAT_ID#
      , #NGUOIGIAO_ID#
      , #NGUOIGIAO#
      , #KHONHAP_ID#
      , #NGUOINHAN_ID#
      , #NGUOINHAN#
      , #NGUOIKIEMTRA_ID#
      , #NGUOIKIEMTRA#
      , #NGUOIDUYET_ID#
      , #NGUOIDUYET#
      , #KETOANTRUONG_ID#
      , #KETOANTRUONG#
      , #THUKHO_ID#
      , #THUKHO#
      , #MAUHOADON#
      , #SOHOADON#
      , #SOSERI#
      , #NGAYHOADON#
      , #DIENGIAI#
      , #GIATRI#
      , #GIATRITHANHTOAN#
      , #TYLEVAT#
      , #GIATRIVAT#
      , #THUESUAT#
      , #GIATRITHUE#
      , #TYLECHIETKHAU#
      , #GIATRICHIETKHAU#
      , #TIENTE_ID#
      , #TYGIA#
      , #SOCHUNGTUGOC#
      , #NGAYCHUNGTUGOC#
      , #NHACUNGCAP_ID#
      , #HINHTHUCTHANHTOAN_ID#
      , #NGUONDUOC_ID#
      , #CHUNGTULIENQUAN_ID#
      , #KHAMBENH_ID#
      , #TOATHUOCNOITRU_ID#
      , #BENHAN_ID#
      , #DANHANTHUOC#
      , #NGUOINHAP_ID#
      , #NGAYNHAP#
      , #TRANGTHAI#
      , #PHIEULINH_ID#
      , #DIENGIAINGHIEPVUPHATSINH#
      , #DONVIGIAO_ID#
      , #KHOSUDUNG_ID#
      , #LOAIVATTU_ID#
      , #BENHNHAN_ID#
      , #TENBENHNHAN#
      , #BACSIGIOITHIEU_ID#
      , #DOITUONG_ID#
      , #IDCHUYEN#
      , #CHUNGTUKETOAN#
      , #STATUS#
      , #TRANSFER_VIENPHI_ID#
      , #PHONGBAN_ID#
      , #BACSI_ID#
      , #TKNO#
      , #TKCO#
      , #MACHUNGTUREF#
      , #LOAICHUNGTUREF#
      , #PHIEULINHCANTRU_ID#
      , #KHOTHUCHIEN_ID#
      , #KHODOIUNG_ID#
      , #MENU_LOAIDUOC_ID#
      , #NGUOISUDUNGMAY_ID#
      , #GOITHAU_ID#
      , #XUATTHUOCBANGOAITRU#
      , #NGAYGIOCHUNGTU#
      , #NOIDAKHAM#
      , #HOIDONGKIEMNHAP_ID#
      , #HOIDONGTHANHLY_ID#
      , #CHUYENCHUNGTUID#
      , #CHUYENDOANHTHUID#
      , #LYDOXUATSUDUNG_ID#
      , #BENHVIEN_ID#
      , #NGAYCHUNGTU#
      , #NGUOITAO_ID#
      , #NGAYCAPNHAT#
      , #NGUOICAPNHAT_ID#
      )      
    </insert>

    <update id="DAO00112_Update" parameterClass="System.Collections.IDictionary">
      update TT_DUOC_KYGUI_CHUNGTU set
      NGAYCHUNGTU = #NGAYCHUNGTU#
      , LOAICHUNGTU = #LOAICHUNGTU#
      , MUCDICHCHUNGTU_ID = #MUCDICHCHUNGTU_ID#
      , MUCDICHCHUNGTU_CODE = #MUCDICHCHUNGTU_CODE#
      , KHOXUAT_ID = #KHOXUAT_ID#
      , NGUOIGIAO_ID = #NGUOIGIAO_ID#
      , NGUOIGIAO = #NGUOIGIAO#
      , KHONHAP_ID = #KHONHAP_ID#
      , NGUOINHAN_ID = #NGUOINHAN_ID#
      , NGUOINHAN = #NGUOINHAN#
      , NGUOIKIEMTRA_ID = #NGUOIKIEMTRA_ID#
      , NGUOIKIEMTRA = #NGUOIKIEMTRA#
      , NGUOIDUYET_ID = #NGUOIDUYET_ID#
      , NGUOIDUYET = #NGUOIDUYET#
      , KETOANTRUONG_ID = #KETOANTRUONG_ID#
      , KETOANTRUONG = #KETOANTRUONG#
      , THUKHO_ID = #THUKHO_ID#
      , THUKHO = #THUKHO#
      , MAUHOADON = #MAUHOADON#
      , SOHOADON = #SOHOADON#
      , SOSERI = #SOSERI#
      , NGAYHOADON = #NGAYHOADON#
      , DIENGIAI = #DIENGIAI#
      , GIATRI = #GIATRI#
      , GIATRITHANHTOAN = #GIATRITHANHTOAN#
      , TYLEVAT = #TYLEVAT#
      , GIATRIVAT = #GIATRIVAT#
      , THUESUAT = #THUESUAT#
      , GIATRITHUE = #GIATRITHUE#
      , TYLECHIETKHAU = #TYLECHIETKHAU#
      , GIATRICHIETKHAU = #GIATRICHIETKHAU#
      , TIENTE_ID = #TIENTE_ID#
      , TYGIA = #TYGIA#
      , SOCHUNGTUGOC = #SOCHUNGTUGOC#
      , NGAYCHUNGTUGOC = #NGAYCHUNGTUGOC#
      , NHACUNGCAP_ID = #NHACUNGCAP_ID#
      , HINHTHUCTHANHTOAN_ID = #HINHTHUCTHANHTOAN_ID#
      , NGUONDUOC_ID = #NGUONDUOC_ID#
      , CHUNGTULIENQUAN_ID = #CHUNGTULIENQUAN_ID#
      , KHAMBENH_ID = #KHAMBENH_ID#
      , TOATHUOCNOITRU_ID = #TOATHUOCNOITRU_ID#
      , BENHAN_ID = #BENHAN_ID#
      , DANHANTHUOC = #DANHANTHUOC#
      , NGUOINHAP_ID = #NGUOINHAP_ID#
      , NGAYNHAP = #NGAYNHAP#
      , TRANGTHAI = #TRANGTHAI#
      , PHIEULINH_ID = #PHIEULINH_ID#
      , DIENGIAINGHIEPVUPHATSINH = #DIENGIAINGHIEPVUPHATSINH#
      , DONVIGIAO_ID = #DONVIGIAO_ID#
      , KHOSUDUNG_ID = #KHOSUDUNG_ID#
      , LOAIVATTU_ID = #LOAIVATTU_ID#
      , BENHNHAN_ID = #BENHNHAN_ID#
      , TENBENHNHAN = #TENBENHNHAN#
      , BACSIGIOITHIEU_ID = #BACSIGIOITHIEU_ID#
      , DOITUONG_ID = #DOITUONG_ID#
      , IDCHUYEN = #IDCHUYEN#
      , CHUNGTUKETOAN = #CHUNGTUKETOAN#
      , STATUS = #STATUS#
      , TRANSFER_VIENPHI_ID = #TRANSFER_VIENPHI_ID#
      , PHONGBAN_ID = #PHONGBAN_ID#
      , BACSI_ID = #BACSI_ID#
      , TKNO = #TKNO#
      , TKCO = #TKCO#
      , MACHUNGTUREF = #MACHUNGTUREF#
      , LOAICHUNGTUREF = #LOAICHUNGTUREF#
      , PHIEULINHCANTRU_ID = #PHIEULINHCANTRU_ID#
      , KHOTHUCHIEN_ID = #KHOTHUCHIEN_ID#
      , KHODOIUNG_ID = #KHODOIUNG_ID#
      , MENU_LOAIDUOC_ID = #MENU_LOAIDUOC_ID#
      , NGUOISUDUNGMAY_ID = #NGUOISUDUNGMAY_ID#
      , GOITHAU_ID = #GOITHAU_ID#
      , XUATTHUOCBANGOAITRU = #XUATTHUOCBANGOAITRU#
      , NGAYGIOCHUNGTU = #NGAYGIOCHUNGTU#
      , NOIDAKHAM = #NOIDAKHAM#
      , HOIDONGKIEMNHAP_ID = #HOIDONGKIEMNHAP_ID#
      , HOIDONGTHANHLY_ID = #HOIDONGTHANHLY_ID#
      , CHUYENCHUNGTUID = #CHUYENCHUNGTUID#
      , CHUYENDOANHTHUID = #CHUYENDOANHTHUID#
      , LYDOXUATSUDUNG_ID = #LYDOXUATSUDUNG_ID#   
      , NGAYCAPNHAT = #NGAYCAPNHAT#
      , NGUOICAPNHAT_ID = #NGUOICAPNHAT_ID#
      where
      CHUNGTU_ID = '$CHUNGTU_ID$'
    </update>

    <statement id="DAO00112_GetList" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      select *
      from TT_DUOC_KYGUI_CHUNGTU
      where BENHVIEN_ID = '$BENHVIEN_ID$'
      <isParameterPresent>
        <isNotEmpty prepend="and" property="CHUNGTU_ID">
          TT_DUOC_KYGUI_CHUNGTU.CHUNGTU_ID = '$CHUNGTU_ID$'
        </isNotEmpty>
        <isNotEmpty prepend="and" property="MACHUNGTU">
          TT_DUOC_KYGUI_CHUNGTU.MACHUNGTU = '$MACHUNGTU$'
        </isNotEmpty>
        <isNotEmpty prepend="and" property="SOCHUNGTU">
          TT_DUOC_KYGUI_CHUNGTU.SOCHUNGTU = '$SOCHUNGTU$'
        </isNotEmpty>
        <isNotEmpty prepend="and" property="LOAICHUNGTU">
          TT_DUOC_KYGUI_CHUNGTU.LOAICHUNGTU = '$LOAICHUNGTU$'
        </isNotEmpty>
        <isNotEmpty prepend="and" property="MUCDICHCHUNGTU_ID">
          TT_DUOC_KYGUI_CHUNGTU.MUCDICHCHUNGTU_ID = '$MUCDICHCHUNGTU_ID$'
        </isNotEmpty>
        <isNotEmpty prepend="and" property="MUCDICHCHUNGTU_CODE">
          TT_DUOC_KYGUI_CHUNGTU.MUCDICHCHUNGTU_CODE = '$MUCDICHCHUNGTU_CODE$'
        </isNotEmpty>
        <isNotEmpty prepend="and" property="KHOXUAT_ID">
          TT_DUOC_KYGUI_CHUNGTU.KHOXUAT_ID = '$KHOXUAT_ID$'
        </isNotEmpty>
        
        <isNotEmpty prepend="and" property="LOAIVATTU_ID">
          TT_DUOC_KYGUI_CHUNGTU.LOAIVATTU_ID = '$LOAIVATTU_ID$'
        </isNotEmpty>
        <isNotEmpty prepend="and" property="BENHNHAN_ID">
          TT_DUOC_KYGUI_CHUNGTU.BENHNHAN_ID = '$BENHNHAN_ID$'
        </isNotEmpty>
        <isNotEmpty prepend="and" property="TENBENHNHAN">
          TT_DUOC_KYGUI_CHUNGTU.TENBENHNHAN = '$TENBENHNHAN$'
        </isNotEmpty>
        <isNotEmpty prepend="and" property="GIOITINH">
          TT_DUOC_KYGUI_CHUNGTU.GIOITINH = '$GIOITINH$'
        </isNotEmpty>
        <isNotEmpty prepend="and" property="NAMSINH">
          TT_DUOC_KYGUI_CHUNGTU.NAMSINH = '$NAMSINH$'
        </isNotEmpty>
        <isNotEmpty prepend="and" property="DIACHI">
          TT_DUOC_KYGUI_CHUNGTU.DIACHI = '$DIACHI$'
        </isNotEmpty>
        <isNotEmpty prepend="and" property="SODIENTHOAI">
          TT_DUOC_KYGUI_CHUNGTU.SODIENTHOAI = '$SODIENTHOAI$'
        </isNotEmpty>
        <isNotEmpty prepend="and" property="BACSIGIOITHIEU_ID">
          TT_DUOC_KYGUI_CHUNGTU.BACSIGIOITHIEU_ID = '$BACSIGIOITHIEU_ID$'
        </isNotEmpty>
        <isNotEmpty prepend="and" property="DOITUONG_ID">
          TT_DUOC_KYGUI_CHUNGTU.DOITUONG_ID = '$DOITUONG_ID$'
        </isNotEmpty>
        <isNotEmpty prepend="and" property="IDCHUYEN">
          TT_DUOC_KYGUI_CHUNGTU.IDCHUYEN = '$IDCHUYEN$'
        </isNotEmpty>
        <isNotEmpty prepend="and" property="CHUNGTUKETOAN">
          TT_DUOC_KYGUI_CHUNGTU.CHUNGTUKETOAN = '$CHUNGTUKETOAN$'
        </isNotEmpty>
        <isNotEmpty prepend="and" property="STATUS">
          TT_DUOC_KYGUI_CHUNGTU.STATUS = '$STATUS$'
        </isNotEmpty>
        <isNotEmpty prepend="and" property="TRANSFER_VIENPHI_ID">
          TT_DUOC_KYGUI_CHUNGTU.TRANSFER_VIENPHI_ID = '$TRANSFER_VIENPHI_ID$'
        </isNotEmpty>
        <isNotEmpty prepend="and" property="PHONGBAN_ID">
          TT_DUOC_KYGUI_CHUNGTU.PHONGBAN_ID = '$PHONGBAN_ID$'
        </isNotEmpty>
        <isNotEmpty prepend="and" property="BACSI_ID">
          TT_DUOC_KYGUI_CHUNGTU.BACSI_ID = '$BACSI_ID$'
        </isNotEmpty>
        <isNotEmpty prepend="and" property="TKNO">
          TT_DUOC_KYGUI_CHUNGTU.TKNO = '$TKNO$'
        </isNotEmpty>
        <isNotEmpty prepend="and" property="TKCO">
          TT_DUOC_KYGUI_CHUNGTU.TKCO = '$TKCO$'
        </isNotEmpty>
        <isNotEmpty prepend="and" property="MACHUNGTUREF">
          TT_DUOC_KYGUI_CHUNGTU.MACHUNGTUREF = '$MACHUNGTUREF$'
        </isNotEmpty>
        <isNotEmpty prepend="and" property="LOAICHUNGTUREF">
          TT_DUOC_KYGUI_CHUNGTU.LOAICHUNGTUREF = '$LOAICHUNGTUREF$'
        </isNotEmpty>
        <isNotEmpty prepend="and" property="PHIEULINHCANTRU_ID">
          TT_DUOC_KYGUI_CHUNGTU.PHIEULINHCANTRU_ID = '$PHIEULINHCANTRU_ID$'
        </isNotEmpty>
        <isNotEmpty prepend="and" property="KHOTHUCHIEN_ID">
          TT_DUOC_KYGUI_CHUNGTU.KHOTHUCHIEN_ID = '$KHOTHUCHIEN_ID$'
        </isNotEmpty>
        <isNotEmpty prepend="and" property="KHODOIUNG_ID">
          TT_DUOC_KYGUI_CHUNGTU.KHODOIUNG_ID = '$KHODOIUNG_ID$'
        </isNotEmpty>
        <isNotEmpty prepend="and" property="MENU_LOAIDUOC_ID">
          TT_DUOC_KYGUI_CHUNGTU.MENU_LOAIDUOC_ID = '$MENU_LOAIDUOC_ID$'
        </isNotEmpty>
        <isNotEmpty prepend="and" property="NGUOISUDUNGMAY_ID">
          TT_DUOC_KYGUI_CHUNGTU.NGUOISUDUNGMAY_ID = '$NGUOISUDUNGMAY_ID$'
        </isNotEmpty>
        <isNotEmpty prepend="and" property="GOITHAU_ID">
          TT_DUOC_KYGUI_CHUNGTU.GOITHAU_ID = '$GOITHAU_ID$'
        </isNotEmpty>
        <isNotEmpty prepend="and" property="XUATTHUOCBANGOAITRU">
          TT_DUOC_KYGUI_CHUNGTU.XUATTHUOCBANGOAITRU = '$XUATTHUOCBANGOAITRU$'
        </isNotEmpty>
        <isNotEmpty prepend="and" property="NGAYGIOCHUNGTU">
          TT_DUOC_KYGUI_CHUNGTU.NGAYGIOCHUNGTU = '$NGAYGIOCHUNGTU$'
        </isNotEmpty>
        <isNotEmpty prepend="and" property="NOIDAKHAM">
          TT_DUOC_KYGUI_CHUNGTU.NOIDAKHAM = '$NOIDAKHAM$'
        </isNotEmpty>
        <isNotEmpty prepend="and" property="CHUYENCHUNGTUID">
          TT_DUOC_KYGUI_CHUNGTU.CHUYENCHUNGTUID = '$CHUYENCHUNGTUID$'
        </isNotEmpty>
        <isNotEmpty prepend="and" property="CHUYENDOANHTHUID">
          TT_DUOC_KYGUI_CHUNGTU.CHUYENDOANHTHUID = '$CHUYENDOANHTHUID$'
        </isNotEmpty>
        <isNotEmpty prepend="and" property="NGUOITAO_ID">
          TT_DUOC_KYGUI_CHUNGTU.NGUOITAO_ID = '$NGUOITAO_ID$'
        </isNotEmpty>
        <isNotEmpty prepend="and" property="NGAYCAPNHAT">
          TT_DUOC_KYGUI_CHUNGTU.NGAYCAPNHAT = '$NGAYCAPNHAT$'
        </isNotEmpty>
        <isNotEmpty prepend="and" property="NGUOICAPNHAT_ID">
          TT_DUOC_KYGUI_CHUNGTU.NGUOICAPNHAT_ID = '$NGUOICAPNHAT_ID$'
        </isNotEmpty>
      </isParameterPresent>
      order by CHUNGTU_ID
    </statement>
    
    <statement id="DAO00112_Delete" parameterClass="System.Collections.IDictionary" resultClass="System.Int32">
      delete from TT_DUOC_KYGUI_CHUNGTU
      where
      CHUNGTU_ID = '$CHUNGTU_ID$'
    </statement>

    <insert id="DAO00112_CTSOLONHAP_Add" parameterClass="HashTable" resultClass="System.Int64">
      <selectKey property="ID" type="pre" resultClass="System.Int64">
        select TT_DUOC_KG_CHUNGTU_SOLONHAP_S.nextval as value from dual
      </selectKey>
      insert into TT_DUOC_KYGUI_CHUNGTU_SOLONHAP (
      SOLONHAP_ID
      , SOLONHAP
      , SOLOSANPHAM
      , DUOC_ID
      , NGAYNHAP
      , HANDUNG
      , NGUONDUOC_ID
      , DONGIAMUA
      , DONGIAVON
      , TIENTE_ID
      , TYGIA
      , THANG
      , NAM
      , SOKIEMSOAT
      , SOVISA
      , NGUONHANG_ID
      , DONGIATHAU
      , BENHVIEN_ID
      , NGAYTAO
      , NGUOITAO_ID
      , NGAYCAPNHAT
      , NGUOICAPNHAT_ID
      ) values (
      #ID#
      , #SOLONHAP#
      , #SOLOSANPHAM#
      , #DUOC_ID#
      , #NGAYNHAP#
      , #HANDUNG#
      , #NGUONDUOC_ID#
      , #DONGIAMUA#
      , #DONGIAVON#
      , #TIENTE_ID#
      , #TYGIA#
      , #THANG#
      , #NAM#
      , #SOKIEMSOAT#
      , #SOVISA#
      , #NGUONHANG_ID#
      , #DONGIATHAU#
      , #BENHVIEN_ID#
      , #NGAYTAO#
      , #NGUOITAO_ID#
      , #NGAYCAPNHAT#
      , #NGUOICAPNHAT_ID#
      )      
    </insert>

    <insert id="DAO00112_DUOC_SOLONHAP_GIABAN_Add" parameterClass="System.Collections.IDictionary" resultClass="System.Int64">   
      insert into TT_DUOC_KYGUI_SOLONHAP_GIABAN (      
        SOLONHAP_ID
      , DUOC_ID
      , DONGIAMUA
      , DONGIAVON
      , TYLEVAT_DAUVAO
      , DONGIAVONVAT
      , DONGIABAN
      , DONGIABANVAT_DAUVAO
      , BENHVIEN_ID
      ) values (      
        #SOLONHAP_ID#
      , #DUOC_ID#
      , #DONGIAMUA#
      , #DONGIAVON#
      , #TYLEVAT_DAUVAO#
      , #DONGIAVONVAT#
      , #DONGIABAN#
      , #DONGIABANVAT_DAUVAO#
      , #BENHVIEN_ID#
      )
    </insert>

    <insert id="DAO00112_CHUNGTUCT_Add" parameterClass="System.Collections.IDictionary" resultClass="System.Int64">
      <selectKey property="ID" type="pre" resultClass="System.Int64">
        select TT_DUOC_KG_CHUNGTU_CHITIET_S.nextval as value from dual
      </selectKey>
      insert into TT_DUOC_KYGUI_CHUNGTU_CHITIET (
      CHUNGTUCHITIET_ID
      , CHUNGTU_ID
      , DUOC_ID
      , SOLONHAP_ID
      , SOKIEMSOAT
      , SOVISA
      , HANDUNG
      , DONVITINH_ID
      , SOLUONGYEUCAU
      , SOLUONGTHUCTE
      , SOLUONGDAXUAT
      , TIENTE_ID
      , TYGIA
      , DONGIAMUA
      , DONGIABAN
      , DONGIAVON
      , DONGIATHANHTOAN
      , SOQUYEN
      , SOHOADONVAT
      , TYLEVAT
      , GIATRIVAT
      , TYLECHIETKHAU
      , GIATRICHIETKHAU
      , MIENPHI
      , LYDOMIENPHI_ID
      , SOCHUNGTUKETOAN
      , SOCHUNGTUTIENMAT
      , TRANGTHAI
      , DAPHATSINHPHIEUXUAT
      , DAPHATSINHPHIEUHOANTRA
      , KHUYENMAI
      , DONDATHANG_ID
      , GHICHUCHITIET
      , NGUONHANG_ID
      , DONGIAVONVAT
      , THANHTIENMUA
      , THANHTIENVON
      , ISTACHLO
      , DONVITINHBANDAU_ID
      , SOLUONGBANDAU
      , GOITHAU_ID
      , DONGIATHAU
      , TYLEQUIDOI
      , TOATHUOCNOITRU_ID
      , KHAMBENH_VTYT_ID
      , PHAUTHUAT_VTYT_ID
      , BENHVIEN_ID
      , NGAYTAO
      , NGUOITAO_ID
      , NGAYCAPNHAT
      , NGUOICAPNHAT_ID
      ) values (
      #ID#
      , #CHUNGTU_ID#
      , #DUOC_ID#
      , #SOLONHAP_ID#
      , #SOKIEMSOAT#
      , #SOVISA#
      , #HANDUNG#
      , #DONVITINH_ID#
      , #SOLUONGYEUCAU#
      , #SOLUONGTHUCTE#
      , #SOLUONGDAXUAT#
      , #TIENTE_ID#
      , #TYGIA#
      , #DONGIAMUA#
      , #DONGIABAN#
      , #DONGIAVON#
      , #DONGIATHANHTOAN#
      , #SOQUYEN#
      , #SOHOADONVAT#
      , #TYLEVAT#
      , #GIATRIVAT#
      , #TYLECHIETKHAU#
      , #GIATRICHIETKHAU#
      , #MIENPHI#
      , #LYDOMIENPHI_ID#
      , #SOCHUNGTUKETOAN#
      , #SOCHUNGTUTIENMAT#
      , #TRANGTHAI#
      , #DAPHATSINHPHIEUXUAT#
      , #DAPHATSINHPHIEUHOANTRA#
      , #KHUYENMAI#
      , #DONDATHANG_ID#
      , #GHICHUCHITIET#
      , #NGUONHANG_ID#
      , #DONGIAVONVAT#
      , #THANHTIENMUA#
      , #THANHTIENVON#
      , #ISTACHLO#
      , #DONVITINHBANDAU_ID#
      , #SOLUONGBANDAU#
      , #GOITHAU_ID#
      , #DONGIATHAU#
      , #TYLEQUIDOI#
      , #TOATHUOCNOITRU_ID#
      , #KHAMBENH_VTYT_ID#
      , #PHAUTHUAT_VTYT_ID#
      , #BENHVIEN_ID#
      , #NGAYTAO#
      , #NGUOITAO_ID#
      , #NGAYCAPNHAT#
      , #NGUOICAPNHAT_ID#
      )      
    </insert>

    <update id="DAO00112_CHUNGTUCT_Update" parameterClass="System.Collections.IDictionary">
      update TT_DUOC_KYGUI_CHUNGTU_CHITIET set
      CHUNGTU_ID = #CHUNGTU_ID#
      , DUOC_ID = #DUOC_ID#
      , SOLONHAP_ID = #SOLONHAP_ID#
      , SOKIEMSOAT = #SOKIEMSOAT#
      , SOVISA = #SOVISA#
      , HANDUNG = #HANDUNG#
      , DONVITINH_ID = #DONVITINH_ID#
      , SOLUONGYEUCAU = #SOLUONGYEUCAU#
      , SOLUONGTHUCTE = #SOLUONGTHUCTE#
      , SOLUONGDAXUAT = #SOLUONGDAXUAT#
      , TIENTE_ID = #TIENTE_ID#
      , TYGIA = #TYGIA#
      , DONGIAMUA = #DONGIAMUA#
      , DONGIABAN = #DONGIABAN#
      , DONGIAVON = #DONGIAVON#
      , DONGIATHANHTOAN = #DONGIATHANHTOAN#
      , SOQUYEN = #SOQUYEN#
      , SOHOADONVAT = #SOHOADONVAT#
      , TYLEVAT = #TYLEVAT#
      , GIATRIVAT = #GIATRIVAT#
      , MIENPHI = #MIENPHI#
      , LYDOMIENPHI_ID = #LYDOMIENPHI_ID#
      , SOCHUNGTUKETOAN = #SOCHUNGTUKETOAN#
      , SOCHUNGTUTIENMAT = #SOCHUNGTUTIENMAT#
      , TRANGTHAI = #TRANGTHAI#
      , DAPHATSINHPHIEUXUAT = #DAPHATSINHPHIEUXUAT#
      , DAPHATSINHPHIEUHOANTRA = #DAPHATSINHPHIEUHOANTRA#
      , KHUYENMAI = #KHUYENMAI#
      , DONDATHANG_ID = #DONDATHANG_ID#
      , GHICHUCHITIET = #GHICHUCHITIET#
      , NGUONHANG_ID = #NGUONHANG_ID#
      , DONGIAVONVAT = #DONGIAVONVAT#
      , THANHTIENMUA = #THANHTIENMUA#
      , THANHTIENVON = #THANHTIENVON#
      , ISTACHLO = #ISTACHLO#
      , DONVITINHBANDAU_ID = #DONVITINHBANDAU_ID#
      , SOLUONGBANDAU = #SOLUONGBANDAU#
      , GOITHAU_ID = #GOITHAU_ID#
      , DONGIATHAU = #DONGIATHAU#
      , TYLEQUIDOI = #TYLEQUIDOI#
      , TOATHUOCNOITRU_ID = #TOATHUOCNOITRU_ID#
      , KHAMBENH_VTYT_ID = #KHAMBENH_VTYT_ID#
      , PHAUTHUAT_VTYT_ID = #PHAUTHUAT_VTYT_ID#
      <!--, BENHVIEN_ID = #BENHVIEN_ID#
      , NGAYTAO = #NGAYTAO#
      , NGUOITAO_ID = #NGUOITAO_ID#-->
      , NGAYCAPNHAT = #NGAYCAPNHAT#
      , NGUOICAPNHAT_ID = #NGUOICAPNHAT_ID#
      where
      CHUNGTUCHITIET_ID = '$CHUNGTUCHITIET_ID$'
    </update>
  
    <statement id="DAO00112_CHUNGTUCT_Delete" parameterClass="System.Collections.IDictionary" resultClass="System.Int32">
      delete from TT_DUOC_KYGUI_CHUNGTU_CHITIET
      where
      CHUNGTUCHITIET_ID = '$CHUNGTUCHITIET_ID$'
    </statement>
  
    <statement id="DAO00112_CHUNGTUCT_DeleteP" parameterClass="System.Collections.IDictionary" resultClass="System.Int32">
      delete from TT_DUOC_KYGUI_CHUNGTU_CHITIET
      <dynamic prepend="where">
        <isParameterPresent>
          <isNotEmpty prepend="and" property="CHUNGTUCHITIET_ID">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.CHUNGTUCHITIET_ID = '$CHUNGTUCHITIET_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="CHUNGTU_ID">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.CHUNGTU_ID = '$CHUNGTU_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="DUOC_ID">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.DUOC_ID = '$DUOC_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="SOLONHAP_ID">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.SOLONHAP_ID = '$SOLONHAP_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="SOKIEMSOAT">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.SOKIEMSOAT = '$SOKIEMSOAT$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="SOVISA">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.SOVISA = '$SOVISA$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="HANDUNG">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.HANDUNG = '$HANDUNG$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="DONVITINH_ID">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.DONVITINH_ID = '$DONVITINH_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="SOLUONGYEUCAU">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.SOLUONGYEUCAU = '$SOLUONGYEUCAU$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="SOLUONGTHUCTE">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.SOLUONGTHUCTE = '$SOLUONGTHUCTE$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="SOLUONGDAXUAT">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.SOLUONGDAXUAT = '$SOLUONGDAXUAT$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="TIENTE_ID">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.TIENTE_ID = '$TIENTE_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="TYGIA">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.TYGIA = '$TYGIA$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="DONGIAMUA">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.DONGIAMUA = '$DONGIAMUA$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="DONGIABAN">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.DONGIABAN = '$DONGIABAN$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="DONGIAVON">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.DONGIAVON = '$DONGIAVON$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="DONGIATHANHTOAN">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.DONGIATHANHTOAN = '$DONGIATHANHTOAN$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="SOQUYEN">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.SOQUYEN = '$SOQUYEN$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="SOHOADONVAT">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.SOHOADONVAT = '$SOHOADONVAT$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="TYLEVAT">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.TYLEVAT = '$TYLEVAT$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="GIATRIVAT">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.GIATRIVAT = '$GIATRIVAT$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="MIENPHI">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.MIENPHI = '$MIENPHI$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="LYDOMIENPHI_ID">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.LYDOMIENPHI_ID = '$LYDOMIENPHI_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="SOCHUNGTUKETOAN">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.SOCHUNGTUKETOAN = '$SOCHUNGTUKETOAN$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="SOCHUNGTUTIENMAT">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.SOCHUNGTUTIENMAT = '$SOCHUNGTUTIENMAT$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="TRANGTHAI">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.TRANGTHAI = '$TRANGTHAI$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="DAPHATSINHPHIEUXUAT">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.DAPHATSINHPHIEUXUAT = '$DAPHATSINHPHIEUXUAT$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="DAPHATSINHPHIEUHOANTRA">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.DAPHATSINHPHIEUHOANTRA = '$DAPHATSINHPHIEUHOANTRA$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="KHUYENMAI">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.KHUYENMAI = '$KHUYENMAI$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="DONDATHANG_ID">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.DONDATHANG_ID = '$DONDATHANG_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="GHICHUCHITIET">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.GHICHUCHITIET = '$GHICHUCHITIET$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="NGUONHANG_ID">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.NGUONHANG_ID = '$NGUONHANG_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="DONGIAVONVAT">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.DONGIAVONVAT = '$DONGIAVONVAT$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="THANHTIENMUA">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.THANHTIENMUA = '$THANHTIENMUA$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="THANHTIENVON">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.THANHTIENVON = '$THANHTIENVON$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="ISTACHLO">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.ISTACHLO = '$ISTACHLO$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="DONVITINHBANDAU_ID">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.DONVITINHBANDAU_ID = '$DONVITINHBANDAU_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="SOLUONGBANDAU">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.SOLUONGBANDAU = '$SOLUONGBANDAU$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="GOITHAU_ID">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.GOITHAU_ID = '$GOITHAU_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="DONGIATHAU">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.DONGIATHAU = '$DONGIATHAU$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="TYLEQUIDOI">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.TYLEQUIDOI = '$TYLEQUIDOI$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="BENHVIEN_ID">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.BENHVIEN_ID = '$BENHVIEN_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="NGAYTAO">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.NGAYTAO = '$NGAYTAO$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="NGUOITAO_ID">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.NGUOITAO_ID = '$NGUOITAO_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="NGAYCAPNHAT">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.NGAYCAPNHAT = '$NGAYCAPNHAT$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="NGUOICAPNHAT_ID">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.NGUOICAPNHAT_ID = '$NGUOICAPNHAT_ID$'
          </isNotEmpty>
        </isParameterPresent>
      </dynamic>
    </statement>

    <statement id="DAO00112_CHUNGTUCT_GetList" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      select TT_DUOC_KYGUI_CHUNGTU_CHITIET.*, SLN.SOLONHAP as SOLONHAP,SLN.SOLOSANPHAM
      from TT_DUOC_KYGUI_CHUNGTU_CHITIET
      left join TT_DUOC_KYGUI_CHUNGTU_SOLONHAP SLN on SLN.SOLONHAP_ID = TT_DUOC_KYGUI_CHUNGTU_CHITIET.SOLONHAP_ID
      <dynamic prepend="where">
        <isParameterPresent>
          <isNotEmpty prepend="and" property="CHUNGTUCHITIET_ID">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.CHUNGTUCHITIET_ID = '$CHUNGTUCHITIET_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="CHUNGTU_ID">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.CHUNGTU_ID = '$CHUNGTU_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="DUOC_ID">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.DUOC_ID = '$DUOC_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="SOLONHAP_ID">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.SOLONHAP_ID = '$SOLONHAP_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="SOKIEMSOAT">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.SOKIEMSOAT = '$SOKIEMSOAT$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="SOVISA">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.SOVISA = '$SOVISA$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="HANDUNG">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.HANDUNG = '$HANDUNG$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="DONVITINH_ID">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.DONVITINH_ID = '$DONVITINH_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="SOLUONGYEUCAU">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.SOLUONGYEUCAU = '$SOLUONGYEUCAU$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="SOLUONGTHUCTE">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.SOLUONGTHUCTE = '$SOLUONGTHUCTE$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="SOLUONGDAXUAT">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.SOLUONGDAXUAT = '$SOLUONGDAXUAT$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="TIENTE_ID">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.TIENTE_ID = '$TIENTE_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="TYGIA">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.TYGIA = '$TYGIA$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="DONGIAMUA">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.DONGIAMUA = '$DONGIAMUA$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="DONGIABAN">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.DONGIABAN = '$DONGIABAN$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="DONGIAVON">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.DONGIAVON = '$DONGIAVON$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="DONGIATHANHTOAN">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.DONGIATHANHTOAN = '$DONGIATHANHTOAN$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="SOQUYEN">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.SOQUYEN = '$SOQUYEN$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="SOHOADONVAT">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.SOHOADONVAT = '$SOHOADONVAT$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="TYLEVAT">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.TYLEVAT = '$TYLEVAT$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="GIATRIVAT">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.GIATRIVAT = '$GIATRIVAT$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="MIENPHI">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.MIENPHI = '$MIENPHI$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="LYDOMIENPHI_ID">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.LYDOMIENPHI_ID = '$LYDOMIENPHI_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="SOCHUNGTUKETOAN">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.SOCHUNGTUKETOAN = '$SOCHUNGTUKETOAN$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="SOCHUNGTUTIENMAT">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.SOCHUNGTUTIENMAT = '$SOCHUNGTUTIENMAT$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="TRANGTHAI">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.TRANGTHAI = '$TRANGTHAI$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="DAPHATSINHPHIEUXUAT">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.DAPHATSINHPHIEUXUAT = '$DAPHATSINHPHIEUXUAT$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="DAPHATSINHPHIEUHOANTRA">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.DAPHATSINHPHIEUHOANTRA = '$DAPHATSINHPHIEUHOANTRA$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="KHUYENMAI">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.KHUYENMAI = '$KHUYENMAI$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="DONDATHANG_ID">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.DONDATHANG_ID = '$DONDATHANG_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="GHICHUCHITIET">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.GHICHUCHITIET = '$GHICHUCHITIET$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="NGUONHANG_ID">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.NGUONHANG_ID = '$NGUONHANG_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="DONGIAVONVAT">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.DONGIAVONVAT = '$DONGIAVONVAT$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="THANHTIENMUA">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.THANHTIENMUA = '$THANHTIENMUA$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="THANHTIENVON">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.THANHTIENVON = '$THANHTIENVON$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="ISTACHLO">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.ISTACHLO = '$ISTACHLO$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="DONVITINHBANDAU_ID">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.DONVITINHBANDAU_ID = '$DONVITINHBANDAU_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="SOLUONGBANDAU">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.SOLUONGBANDAU = '$SOLUONGBANDAU$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="GOITHAU_ID">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.GOITHAU_ID = '$GOITHAU_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="DONGIATHAU">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.DONGIATHAU = '$DONGIATHAU$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="TYLEQUIDOI">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.TYLEQUIDOI = '$TYLEQUIDOI$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="BENHVIEN_ID">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.BENHVIEN_ID = '$BENHVIEN_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="NGAYTAO">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.NGAYTAO = '$NGAYTAO$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="NGUOITAO_ID">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.NGUOITAO_ID = '$NGUOITAO_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="NGAYCAPNHAT">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.NGAYCAPNHAT = '$NGAYCAPNHAT$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="NGUOICAPNHAT_ID">
            TT_DUOC_KYGUI_CHUNGTU_CHITIET.NGUOICAPNHAT_ID = '$NGUOICAPNHAT_ID$'
          </isNotEmpty>
        </isParameterPresent>
      </dynamic>
      order by CHUNGTUCHITIET_ID
    </statement>

    <statement id="DAO00112_CHUNGTUXUAT_CHITIET_GetList" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      SELECT
      ctct.*,
      d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,
      n.TENNGUONDUOC as NGUONHANG,
      sln.SOLONHAP, sln.SOLOSANPHAM, sln.NGAYNHAP, sln.HANDUNG as HANSUDUNG,
      tk.SOLUONG as SOLUONGTON
      FROM
      TT_DUOC_KYGUI_CHUNGTU_CHITIET ctct
      INNER JOIN TT_DUOC_KYGUI_CHUNGTU ct ON (ct.CHUNGTU_ID = ctct.CHUNGTU_ID)
      INNER JOIN TT_DUOC_KYGUI_CHUNGTU_SOLONHAP sln ON (sln.SOLONHAP_ID = ctct.SOLONHAP_ID)
      INNER JOIN TT_DUOC_KYGUI_TONKHO tk ON (tk.SOLONHAP_ID = sln.SOLONHAP_ID AND tk.DUOC_ID = sln.DUOC_ID and tk.KHODUOC_ID = ct.KHOXUAT_ID)
      INNER JOIN TM_DUOC d ON (d.DUOC_ID = ctct.DUOC_ID)
      INNER JOIN TM_NGUONHANG n ON (n.NGUONDUOC_ID = ctct.NGUONHANG_ID)
      LEFT JOIN TM_DONVITINH dvt ON (dvt.DONVITINH_ID = ctct.DONVITINH_ID)
      <dynamic prepend="where">
        <isParameterPresent>
          <isNotEmpty prepend="and" property="CHUNGTU_ID">
            ct.CHUNGTU_ID = '$CHUNGTU_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="BENHVIEN_ID">
            ct.BENHVIEN_ID = '$BENHVIEN_ID$'
          </isNotEmpty>
        </isParameterPresent>
      </dynamic>
      order by CHUNGTUCHITIET_ID
    </statement>
  
    <statement id="DAO00112_CHUNGTUNHAP_CHITIET_GetList" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      SELECT
      ctct.*,
      d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,
      n.TENNGUONDUOC as NGUONHANG,
      sln.SOLONHAP, sln.SOLOSANPHAM, sln.NGAYNHAP, sln.HANDUNG as HANSUDUNG,
      tk.SOLUONG as SOLUONGTON
      FROM
      TT_DUOC_KYGUI_CHUNGTU_CHITIET ctct
      INNER JOIN TT_DUOC_KYGUI_CHUNGTU ct ON (ct.CHUNGTU_ID = ctct.CHUNGTU_ID)
      INNER JOIN TT_DUOC_KYGUI_CHUNGTU_SOLONHAP sln ON (sln.SOLONHAP_ID = ctct.SOLONHAP_ID)
      INNER JOIN TT_DUOC_KYGUI_TONKHO tk ON (tk.SOLONHAP_ID = sln.SOLONHAP_ID AND tk.DUOC_ID = sln.DUOC_ID and tk.KHODUOC_ID = ct.KHONHAP_ID)
      INNER JOIN TM_DUOC d ON (d.DUOC_ID = ctct.DUOC_ID)
      INNER JOIN TM_NGUONHANG n ON (n.NGUONDUOC_ID = ctct.NGUONHANG_ID)
      INNER JOIN TM_DONVITINH dvt ON (dvt.DONVITINH_ID = ctct.DONVITINH_ID)
      <dynamic prepend="where">
        <isParameterPresent>
          <isNotEmpty prepend="and" property="CHUNGTU_ID">
            ct.CHUNGTU_ID = '$CHUNGTU_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="BENHVIEN_ID">
            ct.BENHVIEN_ID = '$BENHVIEN_ID$'
          </isNotEmpty>
        </isParameterPresent>
      </dynamic>
      order by CHUNGTUCHITIET_ID
    </statement>

    <statement id="DAO00112_DUOCTONKHO_GetSoTonTheoDuoc" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      SELECT
      DUOC_ID,
      SUM(SOLUONG) AS TONGTON
      FROM
      TT_DUOC_KYGUI_TONKHO
      WHERE
      KHODUOC_ID = '$KHODUOC_ID$'
      and BENHVIEN_ID = '$BENHVIEN_ID$'
      and DUOC_ID IN ($LIST_DUOC_ID$)
      GROUP BY DUOC_ID
    </statement>
    
    <statement id="DAO00112_DUOCTONKHO_GetSoTonTheoDuocTheoLo" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      SELECT
      DUOC_ID, SOLONHAP_ID,
      SUM(SOLUONG) AS SOLUONGTONLO
      FROM
      TT_DUOC_KYGUI_TONKHO
      WHERE
      KHODUOC_ID = '$KHODUOC_ID$'
      and BENHVIEN_ID = '$BENHVIEN_ID$'
      and DUOC_ID IN ($LIST_DUOC_ID$)
      and SOLONHAP_ID IN ($LIST_SOLONHAP_ID$)
      GROUP BY DUOC_ID, SOLONHAP_ID
    </statement>

    <statement id="DAO00112_GetGiaMarkup_LaySoLamTron" resultClass="DataObject">
      SELECT LAMTRON
      FROM  TM_DONGIA_DEFINITIONS_LAMTRON
      WHERE DONGIA &gt;=  $GIAVAO$
      AND ROWNUM = 1
      ORDER BY DONGIA ASC
    </statement>
    
    <statement id="DAO00112_GetGiaMarkup_LayTyLe" resultClass="DataObject">
      SELECT TYLE
      FROM TM_DUOC_DONGIA_DEFINITIONS
      WHERE DONGIA &gt;=  $GIAVAO$ AND LOAIVATTU_ID IN (SELECT LOAIVATTU_ID FROM TM_DUOC D
      JOIN TM_LOAIDUOC LD ON D.LOAIDUOC_ID = LD.LOAIDUOC_ID
      WHERE D.DUOC_ID= $DUOC_ID$ )
      AND ROWNUM = 1
      ORDER BY DONGIA ASC
    </statement>

    <statement id="DAO00112_GetGoiThau" resultClass="DataObject">
      SELECT DISTINCT DIC.*, HD.NHACUNGCAP_ID, HD.NGAYHETHAN, HD.GIAHOPDONG_ID
      FROM
      LST_DICTIONARY DIC inner join TM_GIAHOPDONG HD on DIC.DICTIONARY_ID = HD.GOITHAU_ID
      WHERE
      DICTIONARY_TYPE_CODE = 'DM_goithau'
      and HD.NHACUNGCAP_ID = '$NHACUNGCAP_ID$'
      and TO_DATE(HD.NGAYHETHAN,'MM/DD/YYYY') &gt;= SYSDATE
      <!--and DIC.BENHVIEN_ID = '$BENHVIEN_ID$'-->
      ORDER BY HD.NGAYHETHAN DESC
    </statement>
    
    <update id="DAO00112_DUOC_SOVISA_Upd" parameterClass="System.Collections.IDictionary">
      update TM_DUOC set
      SOVISA = '$SOVISA$',
      NGAYCAPNHAT = SYSDATE,
      NGUOICAPNHAT_ID = #NGUOICAPNHAT_ID#
      where
      DUOC_ID = '$DUOC_ID$'
      and BENHVIEN_ID = '$BENHVIEN_ID$'
    </update>         

    <statement id="DAO00112_Search_NhapKyGui_NCC" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      select
      CHUNGTU_ID,
      SOCHUNGTU,
      MACHUNGTU,
      NGAYCHUNGTU,
      CT.NGAYTAO,
      SOCHUNGTUGOC,
      NGAYCHUNGTUGOC,
      KHONHAP_ID,
      KHOXUAT_ID,
      NGUOIGIAO_ID,
      CASE
      WHEN TRANGTHAI = 'PNCNK' THEN N'Chờ xác nhận'
      WHEN TRANGTHAI = 'PNDNK' THEN N'Đã nhập kho'
      WHEN TRANGTHAI = 'HUY' THEN N'Đã hủy'
      END  AS TRANGTHAI,

      CASE
      WHEN TRANGTHAI = 'PNCNK' THEN null
      WHEN TRANGTHAI = 'PNDNK' THEN null
      WHEN TRANGTHAI = 'HUY' THEN CT.NGUOICAPNHAT_ID
      END  AS NGUOICAPNHAT_ID,

      CASE
      WHEN TRANGTHAI = 'PNCNK' THEN null
      WHEN TRANGTHAI = 'PNDNK' THEN null
      WHEN TRANGTHAI = 'HUY' THEN CT.NGAYCAPNHAT
      END  AS NGAYCAPNHAT,

      CASE
      WHEN TRANGTHAI = 'PNCNK' THEN null
      WHEN TRANGTHAI = 'PNDNK' THEN null
      WHEN TRANGTHAI = 'HUY' THEN NV.TENNHANVIEN
      END  AS TENNHANVIEN

      from TT_DUOC_KYGUI_CHUNGTU CT
      left join TM_NHANVIEN NV on CT.NGUOICAPNHAT_ID = NV.NHANVIEN_ID
      <dynamic prepend="where">
        <isParameterPresent>
          <isNotEmpty prepend="and" property="TUKHOA">
            CT.MACHUNGTU LIKE '%$TUKHOA$%' 
          </isNotEmpty>
          <isNotEmpty prepend="and" property="MUCDICHCHUNGTU_ID">
            CT.MUCDICHCHUNGTU_ID = '$MUCDICHCHUNGTU_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="BENHVIEN_ID">
            CT.BENHVIEN_ID = '$BENHVIEN_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="KHONHAP_ID">
            CT.KHONHAP_ID = '$KHONHAP_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="TUNGAY">            
            TO_DATE(TO_CHAR(CT.NGAYCHUNGTU,'MM/DD/YYYY'), 'MM/DD/YYYY') BETWEEN TO_DATE('$TUNGAY$', 'MM/DD/YYYY')  and  TO_DATE('$DENNGAY$', 'MM/DD/YYYY')
          </isNotEmpty>
        </isParameterPresent>
      </dynamic>
      order by CT.CHUNGTU_ID DESC
    </statement>
    <statement id="DAO00112_LayPhieuKyGui_NCC" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      select
      CHUNGTU_ID,
      SOCHUNGTU,
      MACHUNGTU,
      NGAYCHUNGTU,
      CT.NGAYTAO,
      SOCHUNGTUGOC,
      NGAYCHUNGTUGOC,
      KHONHAP_ID,
      KHOXUAT_ID,
      NGUOIGIAO_ID,
      CASE
      WHEN TRANGTHAI = 'PNCNK' THEN N'Chờ xác nhận'
      WHEN TRANGTHAI = 'PNDNK' THEN N'Đã nhập kho'
      WHEN TRANGTHAI = 'HUY' THEN N'Đã hủy'
      END  AS TRANGTHAI,

      CASE
      WHEN TRANGTHAI = 'PNCNK' THEN null
      WHEN TRANGTHAI = 'PNDNK' THEN null
      WHEN TRANGTHAI = 'HUY' THEN CT.NGUOICAPNHAT_ID
      END  AS NGUOICAPNHAT_ID,

      CASE
      WHEN TRANGTHAI = 'PNCNK' THEN null
      WHEN TRANGTHAI = 'PNDNK' THEN null
      WHEN TRANGTHAI = 'HUY' THEN CT.NGAYCAPNHAT
      END  AS NGAYCAPNHAT,

      CASE
      WHEN TRANGTHAI = 'PNCNK' THEN null
      WHEN TRANGTHAI = 'PNDNK' THEN null
      WHEN TRANGTHAI = 'HUY' THEN NV.TENNHANVIEN
      END  AS TENNHANVIEN

      from TT_DUOC_KYGUI_CHUNGTU CT
      left join TM_NHANVIEN NV on CT.NGUOICAPNHAT_ID = NV.NHANVIEN_ID
      WHERE MACHUNGTU NOT IN (SELECT SOCHUNGTUGOC FROM TT_DUOC_KYGUI_CHUNGTU WHERE SOCHUNGTUGOC IS NOT NULL)
      AND CT.TRANGTHAI = 'PNDNK'
      <isParameterPresent>
          <isNotEmpty prepend="and" property="TUKHOA">
            CT.MACHUNGTU LIKE '%$TUKHOA$%'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="MUCDICHCHUNGTU_ID">
            CT.MUCDICHCHUNGTU_ID = '$MUCDICHCHUNGTU_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="BENHVIEN_ID">
            CT.BENHVIEN_ID = '$BENHVIEN_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="KHONHAP_ID">
            CT.KHONHAP_ID = '$KHONHAP_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="TUNGAY">            
            TO_DATE(TO_CHAR(CT.NGAYCHUNGTU,'MM/DD/YYYY'), 'MM/DD/YYYY') BETWEEN TO_DATE('$TUNGAY$', 'MM/DD/YYYY')  and  TO_DATE('$DENNGAY$', 'MM/DD/YYYY')
          </isNotEmpty>
        </isParameterPresent>      
      order by CT.CHUNGTU_ID DESC
    </statement>
    <statement id="DAO00112_Search_TraKyGui_NCC" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      select
      CHUNGTU_ID,
      SOCHUNGTU,
      MACHUNGTU,
      NGAYCHUNGTU,
      CT.NGAYTAO,
      SOCHUNGTUGOC,
      NGAYCHUNGTUGOC,
      KHONHAP_ID,
      KHOXUAT_ID,
      NGUOIGIAO_ID,

      CASE
      WHEN TRANGTHAI = 'PNCNK' THEN N'Chờ nhập kho'
      WHEN TRANGTHAI = 'PNDNK' THEN N'Đã nhập kho'
      WHEN TRANGTHAI = 'HUY' THEN N'Hủy'
      WHEN TRANGTHAI = 'DXN' THEN N'Đã xác nhận'
      END  AS TRANGTHAI,

      CASE
      WHEN TRANGTHAI = 'PNCNK' THEN null
      WHEN TRANGTHAI = 'PNDNK' THEN null
      WHEN TRANGTHAI = 'HUY' THEN CT.NGUOICAPNHAT_ID
      END  AS NGUOICAPNHAT_ID,

      CASE
      WHEN TRANGTHAI = 'PNCNK' THEN null
      WHEN TRANGTHAI = 'PNDNK' THEN null
      WHEN TRANGTHAI = 'HUY' THEN CT.NGAYCAPNHAT
      END  AS NGAYCAPNHAT,

      CASE
      WHEN TRANGTHAI = 'PNCNK' THEN null
      WHEN TRANGTHAI = 'PNDNK' THEN null
      WHEN TRANGTHAI = 'HUY' THEN NV.TENNHANVIEN
      END  AS TENNHANVIEN

      from TT_DUOC_KYGUI_CHUNGTU CT
      left join TM_NHANVIEN NV on CT.NGUOICAPNHAT_ID = NV.NHANVIEN_ID
      <dynamic prepend="where">
      <isParameterPresent>
        <isNotEmpty prepend="and" property="TUKHOA">
          CT.MACHUNGTU LIKE '%$TUKHOA$%' 
        </isNotEmpty>
        <isNotEmpty prepend="and" property="MUCDICHCHUNGTU_ID">
          CT.MUCDICHCHUNGTU_ID = '$MUCDICHCHUNGTU_ID$'
        </isNotEmpty>
        <isNotEmpty prepend="and" property="BENHVIEN_ID">
          CT.BENHVIEN_ID = '$BENHVIEN_ID$'
        </isNotEmpty>
        <isNotEmpty prepend="and" property="KHOXUAT_ID">
          CT.KHOXUAT_ID = '$KHOXUAT_ID$'
        </isNotEmpty>
        <isNotEmpty prepend="and" property="TUNGAY">          
          TO_DATE(TO_CHAR(CT.NGAYCHUNGTU,'MM/DD/YYYY'), 'MM/DD/YYYY') BETWEEN TO_DATE('$TUNGAY$', 'MM/DD/YYYY')  and  TO_DATE('$DENNGAY$', 'MM/DD/YYYY')
        </isNotEmpty>
      </isParameterPresent>
     </dynamic>
      order by CT.CHUNGTU_ID DESC      
    </statement>
    
    <statement id="DAO00112_Search_XuatKyGui" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      select
      CHUNGTU_ID,
      SOCHUNGTU,
      MACHUNGTU,
      NGAYCHUNGTU,
      CT.NGAYTAO,
      SOCHUNGTUGOC,
      NGAYCHUNGTUGOC,
      TRANGTHAI,
      KHONHAP_ID,
      KHOXUAT_ID,
      NGUOIGIAO_ID,

      CASE
      WHEN TRANGTHAI = 'PNCNK' THEN null
      WHEN TRANGTHAI = 'PNDNK' THEN null
      WHEN TRANGTHAI = 'HUY' THEN CT.NGUOICAPNHAT_ID
      END  AS NGUOICAPNHAT_ID,

      CASE
      WHEN TRANGTHAI = 'PNCNK' THEN null
      WHEN TRANGTHAI = 'PNDNK' THEN null
      WHEN TRANGTHAI = 'HUY' THEN CT.NGAYCAPNHAT
      END  AS NGAYCAPNHAT,

      CASE
      WHEN TRANGTHAI = 'PNCNK' THEN null
      WHEN TRANGTHAI = 'PNDNK' THEN null
      WHEN TRANGTHAI = 'HUY' THEN NV.TENNHANVIEN
      END  AS TENNHANVIEN

      from TT_DUOC_KYGUI_CHUNGTU CT
      left join TM_NHANVIEN NV on CT.NGUOICAPNHAT_ID = NV.NHANVIEN_ID

      <dynamic prepend="where">
        <isParameterPresent>
          <isNotEmpty prepend="and" property="TUKHOA">
            CT.MACHUNGTU LIKE '%$TUKHOA$%'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="MUCDICHCHUNGTU_ID">
            CT.MUCDICHCHUNGTU_ID = '$MUCDICHCHUNGTU_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="BENHVIEN_ID">
            CT.BENHVIEN_ID = '$BENHVIEN_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="KHOXUAT_ID">
            CT.KHOXUAT_ID = '$KHOXUAT_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="TUNGAY">            
            TO_DATE(TO_CHAR(CT.NGAYCHUNGTU,'MM/DD/YYYY'), 'MM/DD/YYYY') BETWEEN TO_DATE('$TUNGAY$', 'MM/DD/YYYY')  and  TO_DATE('$DENNGAY$', 'MM/DD/YYYY')
          </isNotEmpty>
        </isParameterPresent>
      </dynamic>
      order by CT.CHUNGTU_ID DESC
    </statement>
    
    <statement id="DAO00112_CHUNGTUCT_GetListForTraHangNCC" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      SELECT
      SLN.SOLONHAP, SLN.SOLOSANPHAM, CT.KHONHAP_ID, TK.SOLUONG AS SOLUONGTON,
      CTCT.*
      FROM
      TT_DUOC_KYGUI_CHUNGTU CT,
      TT_DUOC_KYGUI_CHUNGTU_CHITIET CTCT,
      TT_DUOC_KYGUI_CHUNGTU_SOLONHAP SLN,
      TT_DUOC_KYGUI_TONKHO TK
      WHERE
      CT.CHUNGTU_ID =  '$CHUNGTU_ID$'
      AND CT.CHUNGTU_ID = CTCT.CHUNGTU_ID
      AND CT.KHONHAP_ID = TK.KHODUOC_ID
      AND CTCT.DUOC_ID = TK.DUOC_ID
      AND TK.SOLONHAP_ID = SLN.SOLONHAP_ID
      AND CTCT.SOLONHAP_ID = SLN.SOLONHAP_ID
      ORDER BY CHUNGTUCHITIET_ID
    </statement>

    <statement id="DAO00112_CHUNGTUCT_GetChiTietTraHangNCC" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      SELECT
      SLN.SOLONHAP, CT.KHONHAP_ID,
      TK.SOLUONG AS SOLUONGTON,
      CTCT.*
      FROM
      TT_DUOC_KYGUI_CHUNGTU CT,
      TT_DUOC_KYGUI_CHUNGTU_CHITIET CTCT,
      TT_DUOC_KYGUI_CHUNGTU_SOLONHAP SLN,
      TT_DUOC_KYGUI_TONKHO TK
      WHERE
      CT.CHUNGTU_ID =  '$CHUNGTU_ID$'
      AND CT.CHUNGTU_ID = CTCT.CHUNGTU_ID
      AND CT.KHOXUAT_ID = TK.KHODUOC_ID
      AND CTCT.DUOC_ID = TK.DUOC_ID
      AND TK.SOLONHAP_ID = SLN.SOLONHAP_ID
      AND CTCT.SOLONHAP_ID = SLN.SOLONHAP_ID
      ORDER BY CHUNGTUCHITIET_ID
    </statement>

    <update id="DAO00112_UpdateChungTuLienQuan" parameterClass="System.Collections.IDictionary">
      update
      TT_DUOC_KYGUI_CHUNGTU
      set
      CHUNGTULIENQUAN_ID = #CHUNGTULIENQUAN_ID#
      where
      MACHUNGTU = '$MACHUNGTU$'
    </update>

    <update id="DAO00112_UpdateHoaDon" parameterClass="System.Collections.IDictionary">
      update
      TT_DUOC_KYGUI_CHUNGTU
      set
      MAUHOADON = #MAUHOADON#
      ,SOHOADON = #SOHOADON#
      ,SOSERI = #SOSERI#
      ,NGAYHOADON = #NGAYHOADON#
      ,NGAYCAPNHAT = #NGAYCAPNHAT#
      ,NGUOICAPNHAT_ID = #NGUOICAPNHAT_ID#
      where
      CHUNGTU_ID = '$CHUNGTU_ID$'
    </update>
    <!--============================================================================
//DUOC TON KHO
//===========================================================================-->
    <statement id="DAO00112_DUOCTONKHO_GetAll" resultClass="DataObject">
      select *
      from TT_DUOC_KYGUI_TONKHO
      order by DUOCTONKHO_ID
    </statement>
    <statement id="DAO00112_DUOCTONKHO_GetList" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      select *
      from TT_DUOC_KYGUI_TONKHO
      <dynamic prepend="where">
        <isParameterPresent>
          <isNotEmpty prepend="and" property="DUOCTONKHO_ID">
            DUOCTONKHO_ID = '$DUOCTONKHO_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="KHODUOC_ID">
            KHODUOC_ID = '$KHODUOC_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="DUOC_ID">
            DUOC_ID = '$DUOC_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="NGUONDUOC_ID">
            NGUONDUOC_ID = '$NGUONDUOC_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="SOLONHAP_ID">
            SOLONHAP_ID = '$SOLONHAP_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="DONGIAMUA">
            DONGIAMUA = '$DONGIAMUA$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="SOLUONG">
            SOLUONG = '$SOLUONG$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="BENHVIEN_ID">
            BENHVIEN_ID = '$BENHVIEN_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="NGAYTAO">
            NGAYTAO = '$NGAYTAO$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="NGUOITAO_ID">
            NGUOITAO_ID = '$NGUOITAO_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="NGAYCAPNHAT">
            NGAYCAPNHAT = '$NGAYCAPNHAT$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="NGUOICAPNHAT_ID">
            NGUOICAPNHAT_ID = '$NGUOICAPNHAT_ID$'
          </isNotEmpty>
        </isParameterPresent>
      </dynamic>
      order by DUOCTONKHO_ID
    </statement>
    <statement id="DAO00112_DUOCTONKHO_GetDetail" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      select *
      from TT_DUOC_KYGUI_TONKHO
      where DUOCTONKHO_ID  = '$value$'
      order by DUOCTONKHO_ID
    </statement>
    <statement id="DAO00112_DUOCTONKHO_GetDetailP" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      select *
      from TT_DUOC_KYGUI_TONKHO
      where DUOCTONKHO_ID  = '$DUOCTONKHO_ID$'
      order by DUOCTONKHO_ID
    </statement>
    <statement id="DAO00112_DUOCTONKHO_Add" parameterClass="HashTable" resultClass="System.Int64">      
      insert into TT_DUOC_KYGUI_TONKHO (      
        KHODUOC_ID
      , DUOC_ID
      , NGUONDUOC_ID
      , SOLONHAP_ID
      , DONGIAMUA
      , SOLUONG
      , BENHVIEN_ID
      , NGAYTAO
      , NGUOITAO_ID
      , NGAYCAPNHAT
      , NGUOICAPNHAT_ID
      ) values (      
        #KHODUOC_ID#
      , #DUOC_ID#
      , #NGUONDUOC_ID#
      , #SOLONHAP_ID#
      , #DONGIAMUA#
      , #SOLUONG#
      , #BENHVIEN_ID#
      , #NGAYTAO#
      , #NGUOITAO_ID#
      , #NGAYCAPNHAT#
      , #NGUOICAPNHAT_ID#
      )
    </statement>

    <update id="DAO00112_DUOCTONKHO_Update" parameterClass="System.Collections.IDictionary">
      update TT_DUOC_KYGUI_TONKHO set
      KHODUOC_ID = #KHODUOC_ID#
      , DUOC_ID = #DUOC_ID#
      , NGUONDUOC_ID = #NGUONDUOC_ID#
      , SOLONHAP_ID = #SOLONHAP_ID#
      , DONGIAMUA = #DONGIAMUA#
      , SOLUONG = #SOLUONG#
      , NGAYCAPNHAT = #NGAYCAPNHAT#
      , NGUOICAPNHAT_ID = #NGUOICAPNHAT_ID#
      where
      DUOCTONKHO_ID = '$DUOCTONKHO_ID$'
    </update>

    <update id="DAO00112_DUOCTONKHO_Tang" parameterClass="System.Collections.IDictionary">
      DECLARE vCOUNT NUMBER:= 0;

      BEGIN

      SELECT COUNT(*) INTO vCOUNT
      FROM TT_DUOC_KYGUI_TONKHO
      WHERE
      KHODUOC_ID = #KHODUOC_ID#
      AND DUOC_ID = #DUOC_ID#
      AND  SOLONHAP_ID = #SOLONHAP_ID#;


      IF vCOUNT > 0 THEN
      
      update TT_DUOC_KYGUI_TONKHO set
      SOLUONG = SOLUONG +  #SOLUONGTHAYDOI#
      , NGAYCAPNHAT = #NGAYCAPNHAT#
      , NGUOICAPNHAT_ID = #NGUOICAPNHAT_ID#
      where
      KHODUOC_ID = #KHODUOC_ID#
      AND DUOC_ID = #DUOC_ID#
      AND  SOLONHAP_ID = #SOLONHAP_ID#;

      ELSE

      insert into TT_DUOC_KYGUI_TONKHO (
      KHODUOC_ID
      , DUOC_ID
      , NGUONDUOC_ID
      , SOLONHAP_ID
      , DONGIAMUA
      , SOLUONG
      , BENHVIEN_ID
      , NGAYTAO
      , NGUOITAO_ID
      , NGAYCAPNHAT
      , NGUOICAPNHAT_ID
      ) values (
      #KHODUOC_ID#
      , #DUOC_ID#
      , #NGUONDUOC_ID#
      , #SOLONHAP_ID#
      , #DONGIAMUA#
      , #SOLUONG#
      , #BENHVIEN_ID#
      , #NGAYTAO#
      , #NGUOITAO_ID#
      , #NGAYCAPNHAT#
      , #NGUOICAPNHAT_ID#
      );

      END IF;
      END;
    </update>

    <update id="DAO00112_DUOCTONKHO_Giam" parameterClass="System.Collections.IDictionary">
      update TT_DUOC_KYGUI_TONKHO set
      SOLUONG = SOLUONG - #SOLUONGTHAYDOI#
      , NGAYCAPNHAT = #NGAYCAPNHAT#
      , NGUOICAPNHAT_ID = #NGUOICAPNHAT_ID#
      where
      KHODUOC_ID = #KHODUOC_ID#
      AND DUOC_ID = #DUOC_ID#
      AND  SOLONHAP_ID = #SOLONHAP_ID#
    </update>   

    <statement id="DAO00112_DUOCTONKHO_Delete" parameterClass="System.Collections.IDictionary" resultClass="System.Int32">
      delete from TT_DUOC_KYGUI_TONKHO
      where
      DUOCTONKHO_ID = '$DUOCTONKHO_ID$'
    </statement>
    <statement id="DAO00112_DUOCTONKHO_DeleteP" parameterClass="System.Collections.IDictionary" resultClass="System.Int32">
      delete from TT_DUOC_KYGUI_TONKHO
      <dynamic prepend="where">
        <isParameterPresent>
          <isNotEmpty prepend="and" property="DUOCTONKHO_ID">
            DUOCTONKHO_ID = '$DUOCTONKHO_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="KHODUOC_ID">
            KHODUOC_ID = '$KHODUOC_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="DUOC_ID">
            DUOC_ID = '$DUOC_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="NGUONDUOC_ID">
            NGUONDUOC_ID = '$NGUONDUOC_IDD$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="SOLONHAP_ID">
            SOLONHAP_ID = '$SOLONHAP_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="DONGIAMUA">
            DONGIAMUA = '$DONGIAMUA$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="SOLUONG">
            SOLUONG = '$SOLUONG$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="BENHVIEN_ID">
            BENHVIEN_ID = '$BENHVIEN_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="NGAYTAO">
            NGAYTAO = '$NGAYTAO$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="NGUOITAO_ID">
            NGUOITAO_ID = '$NGUOITAO_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="NGAYCAPNHAT">
            NGAYCAPNHAT = '$NGAYCAPNHAT$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="NGUOICAPNHAT_ID">
            NGUOICAPNHAT_ID = '$NGUOICAPNHAT_ID$'
          </isNotEmpty>
        </isParameterPresent>
      </dynamic>
    </statement>
    
   <statement id="DAO00112_DUOCTONKHO_GetTonThucTeTheoLo" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      SELECT
      SUM(SOLUONG) AS SOLUONG
      FROM
      TT_DUOC_KYGUI_TONKHO
      WHERE
      DUOC_ID = '$DUOC_ID$'
      AND KHODUOC_ID = '$KHODUOC_ID$'
      <isNotEmpty prepend="and" property="NGUONDUOC_ID">
        NGUONDUOC_ID = '$NGUONDUOC_ID$'
      </isNotEmpty>
      <isNotEmpty prepend="and" property="SOLONHAP_ID">
        SOLONHAP_ID = '$SOLONHAP_ID$'
      </isNotEmpty>
    </statement>
    
    <statement id="DAO00112_DUOCTONKHO_GetTonThucTe" parameterClass="System.Collections.IDictionary" resultClass="DataObject">     
      SELECT
        SUM(SOLUONG) AS SOLUONG 
      FROM 
        TT_DUOC_KYGUI_TONKHO
      WHERE
        DUOC_ID = '$DUOC_ID$'
        AND KHODUOC_ID = '$KHODUOC_ID$'
        <isNotEmpty prepend="and" property="NGUONDUOC_ID">
          NGUONDUOC_ID = '$NGUONDUOC_ID$'
        </isNotEmpty>      
    </statement>

    <statement id="DAO00112_DUOCTONKHO_GetListSoLoSoTon" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      SELECT
      SLN.SOLONHAP_ID, SLN.SOLONHAP, TO_CHAR(SLN.SOLONHAP) + '/' + TO_CHAR(TK.SOLUONG) AS SOLOSOTON,
      SLN.NGAYNHAP, SLN.HANDUNG AS HANSUDUNG, SLN.DONGIAMUA, SLN.DONGIAVON,
      SLN.SOKIEMSOAT, SLN.SOVISA, TK.KHODUOC_ID, TK.DUOCTONKHO_ID, TK.DUOC_ID, TK.SOLUONG
      FROM TT_DUOC_KYGUI_CHUNGTU_SOLONHAP SLN, TT_DUOC_KYGUI_TONKHO TK
      WHERE
      SLN.SOLONHAP_ID = TK.SOLONHAP_ID
      AND SLN.DUOC_ID = '$DUOC_ID$'
      AND SLN.NGUONDUOC_ID = '$NGUONDUOC_ID$'
      AND TK.KHODUOC_ID = '$KHODUOC_ID$'
      AND TK.SOLUONG > 0
      <isEqual prepend="" property="PHUONGPHAPXUAT" compareValue="0">
        ORDER BY NGAYNHAP
      </isEqual>
      <isEqual prepend="" property="PHUONGPHAPXUAT" compareValue="1">
        ORDER BY HANSUDUNG
      </isEqual>
    </statement>
   
    <statement id="DAO00112_GET_SOLONHAP" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      SELECT
      SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOLOSANPHAM, SLN.SOKIEMSOAT, SLN.SOVISA, SLN.SOLOSANPHAM || '/' || TO_CHAR(TK.SOLUONG) AS SOLOSOTON,
      SLN.NGAYNHAP AS NGAYNHAPLO, SLN.HANDUNG AS HANSUDUNG,  SLN.HANDUNG, SLN.NGUONDUOC_ID, SLN.NGUONDUOC_ID as NGUONHANG_ID,
      SLNGB.DONGIAMUA, SLNGB.DONGIAVON, SLNGB.TYLEVAT_DAUVAO as TYLEVAT, d.TYLE_VAT, SLNGB.DONGIAVONVAT, SLNGB.DONGIABAN,
      ROUND(SLNGB.DONGIABAN + SLNGB.DONGIABAN*d.TYLE_VAT/100, 0) as DONGIABAN_VAT,
      TK.DUOCTONKHO_ID, TK.KHODUOC_ID, TK.DUOC_ID, TK.SOLUONG, TK.SOLUONG AS SOLUONGTON,
      TO_CHAR(D.TENDUOCDAYDU) TENDUOCDAYDU ,D.DONVITINH_ID, D.DONVITINH, D.BHYT, NH.TENNGUONDUOC AS NGUONHANG
      FROM
      TT_DUOC_KYGUI_CHUNGTU_SOLONHAP SLN,
      TT_DUOC_KYGUI_TONKHO TK,
      TT_DUOC_KYGUI_SOLONHAP_GIABAN SLNGB,
      TM_DUOC D,
      TM_NGUONHANG NH
      WHERE
      SLN.SOLONHAP_ID = TK.SOLONHAP_ID
      AND SLN.SOLONHAP_ID = SLNGB.SOLONHAP_ID
      AND SLN.NGUONDUOC_ID = NH.NGUONDUOC_ID
      AND SLN.DUOC_ID = D.DUOC_ID
      AND TK.DUOC_ID = '$DUOC_ID$'
      AND TK.KHODUOC_ID = '$KHODUOC_ID$'
      AND SLN.BENHVIEN_ID = '$BENHVIEN_ID$'
      AND TK.SOLUONG &gt; 0
      <isEqual prepend="" property="PHUONGPHAPXUAT" compareValue="0">
        ORDER BY NGAYNHAP
      </isEqual>
      <isEqual prepend="" property="PHUONGPHAPXUAT" compareValue="1">
        ORDER BY HANSUDUNG
      </isEqual>
    </statement>    
    <statement id="DAO00112_GET_SOLONHAP_ZERO" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      SELECT
      SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOLOSANPHAM, SLN.SOKIEMSOAT, SLN.SOVISA, SLN.SOLOSANPHAM || '/' || TO_CHAR(TK.SOLUONG) AS SOLOSOTON,
      SLN.NGAYNHAP AS NGAYNHAPLO, SLN.HANDUNG AS HANSUDUNG,  SLN.HANDUNG, SLN.NGUONDUOC_ID, SLN.NGUONDUOC_ID as NGUONHANG_ID,
      SLNGB.DONGIAMUA, SLNGB.DONGIAVON, SLNGB.TYLEVAT_DAUVAO as TYLEVAT, d.TYLE_VAT, SLNGB.DONGIAVONVAT, SLNGB.DONGIABAN,
      ROUND(SLNGB.DONGIABAN + SLNGB.DONGIABAN*d.TYLE_VAT/100, 0) as DONGIABAN_VAT,
      TK.DUOCTONKHO_ID, TK.KHODUOC_ID, TK.DUOC_ID, TK.SOLUONG, TK.SOLUONG AS SOLUONGTON,
      TO_CHAR(D.TENDUOCDAYDU) TENDUOCDAYDU ,D.DONVITINH_ID, D.DONVITINH, D.BHYT, NH.TENNGUONDUOC AS NGUONHANG
      FROM
      TT_DUOC_KYGUI_CHUNGTU_SOLONHAP SLN,
      TT_DUOC_KYGUI_TONKHO TK,
      TT_DUOC_KYGUI_SOLONHAP_GIABAN SLNGB,
      TM_DUOC D,
      TM_NGUONHANG NH
      WHERE
      SLN.SOLONHAP_ID = TK.SOLONHAP_ID
      AND SLN.SOLONHAP_ID = SLNGB.SOLONHAP_ID
      AND SLN.NGUONDUOC_ID = NH.NGUONDUOC_ID
      AND SLN.DUOC_ID = D.DUOC_ID
      AND TK.KHODUOC_ID = '$KHODUOC_ID$'
      AND TK.DUOC_ID = '$DUOC_ID$'
      AND SLN.BENHVIEN_ID = '$BENHVIEN_ID$'
      AND TK.SOLUONG &gt;= 0
      <isEqual prepend="" property="PHUONGPHAPXUAT" compareValue="0">
        ORDER BY NGAYNHAP
      </isEqual>
      <isEqual prepend="" property="PHUONGPHAPXUAT" compareValue="1">
        ORDER BY HANSUDUNG
      </isEqual>
    </statement>
     <!--============================================================================
//KIEM KE
//===========================================================================-->
    <statement id="DAO00112_TT_DUOC_TONKHO_GetListKiemKe" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      select TK.DUOC_ID, D.TENDUOCDAYDU, D.DONVITINH, D.DONVITINH_ID, sum(TK.SOLUONG) as SOLUONG
      from TT_DUOC_KYGUI_TONKHO TK
      inner join TM_DUOC D on D.DUOC_ID =  TK.DUOC_ID
      WHERE
      TK.KHODUOC_ID =  '$KHODUOC_ID$'
      AND TK.BENHVIEN_ID = '$BENHVIEN_ID$'      
      AND TO_DATE(TO_CHAR(TK.NGAYTAO,'MM/DD/YYYY'), 'MM/DD/YYYY') BETWEEN TO_DATE('$TUNGAY$', 'MM/DD/YYYY')  and  TO_DATE('$DENNGAY$', 'MM/DD/YYYY')
      GROUP BY TK.DUOC_ID, D.TENDUOCDAYDU, D.DONVITINH, D.DONVITINH_ID
      ORDER BY D.TENDUOCDAYDU
    </statement>

    <statement id="DAO00112_TT_DUOC_KIEMKE_CheckExist" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      SELECT KK.*, D.TENDUOCDAYDU, D.DONVITINH
      FROM TT_DUOC_KIEMKE KK
      INNER JOIN TT_DUOC_KYTONKHO KTK ON KK.DUOCKYKIEMKE_ID = KTK.DUOCKYTONKHO_ID
      INNER JOIN TM_DUOC D on D.DUOC_ID =  KK.DUOC_ID
      WHERE
      KTK.MAKYTONKHO = '$MAKYTONKHO$'
      AND KK.KHODUOC_ID = '$KHODUOC_ID$'
      AND KK.BENHVIEN_ID = '$BENHVIEN_ID$'
      order by
      D.TENDUOCDAYDU
    </statement>

    <statement id="DAO00112_TT_DUOC_KIEMKE_GetAll" resultClass="DataObject">
      select *
      from TT_DUOC_KIEMKE
      where BENHVIEN_ID = '$BENHVIEN_ID$'
      order by DUOCKIEMKE_ID
    </statement>
    <statement id="DAO00112_TT_DUOC_KIEMKE_GetList" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      select *
      from TT_DUOC_KIEMKE
      <dynamic prepend="where">
        <isParameterPresent>
          <isNotEmpty prepend="and" property="DUOCKIEMKE_ID">
            DUOCKIEMKE_ID = '$DUOCKIEMKE_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="DUOCKYKIEMKE_ID">
            DUOCKYKIEMKE_ID = '$DUOCKYKIEMKE_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="KHODUOC_ID">
            KHODUOC_ID = '$KHODUOC_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="DUOC_ID">
            DUOC_ID = '$DUOC_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="SOLONHAP_ID">
            SOLONHAP_ID = '$SOLONHAP_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="DONGIAMUA">
            DONGIAMUA = '$DONGIAMUA$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="DONGIAVON">
            DONGIAVON = '$DONGIAVON$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="SOLUONG">
            SOLUONG = '$SOLUONG$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="TENDUOC">
            TENDUOC = '$TENDUOC$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="DONVITINH_ID">
            DONVITINH_ID = '$DONVITINH_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="SOKIEMSOAT">
            SOKIEMSOAT = '$SOKIEMSOAT$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="NUOCSX">
            NUOCSX = '$NUOCSX$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="THANHTIEN">
            THANHTIEN = '$THANHTIEN$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="SOTHUCTE">
            SOTHUCTE = '$SOTHUCTE$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="THUA">
            THUA = '$THUA$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="THIEU">
            THIEU = '$THIEU$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="HONG">
            HONG = '$HONG$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="GHICHU">
            GHICHU = '$GHICHU$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="NGAYTAO">
            NGAYTAO = '$NGAYTAO$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="NGUOITAO_ID">
            NGUOITAO_ID = '$NGUOITAO_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="NGAYCAPNHAT">
            NGAYCAPNHAT = '$NGAYCAPNHAT$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="NGUOICAPNHAT_ID">
            NGUOICAPNHAT_ID = '$NGUOICAPNHAT_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="BENHVIEN_ID">
            BENHVIEN_ID = '$BENHVIEN_ID$'
          </isNotEmpty>
        </isParameterPresent>
      </dynamic>
      order by DUOCKIEMKE_ID
    </statement>
    <statement id="DAO00112_TT_DUOC_KIEMKE_GetDetail" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      select *
      from TT_DUOC_KIEMKE
      where DUOCKIEMKE_ID  = '$value$'
      and BENHVIEN_ID = '$BENHVIEN_ID$'
      order by DUOCKIEMKE_ID
    </statement>
    <statement id="DAO00112_TT_DUOC_KIEMKE_GetDetailP" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      select *
      from TT_DUOC_KIEMKE
      where DUOCKIEMKE_ID  = '$DUOCKIEMKE_ID$'
      and BENHVIEN_ID = '$BENHVIEN_ID$'
      order by DUOCKIEMKE_ID
    </statement>
    <statement id="DAO00112_TT_DUOC_KIEMKE_Add" parameterClass="System.Collections.IDictionary" resultClass="System.Int64">
      insert into TT_DUOC_KIEMKE (
      DUOCKYKIEMKE_ID
      , HOIDONGKIEMKE_ID
      , KHODUOC_ID
      , DUOC_ID
      , SOLONHAP_ID
      , DONGIAMUA
      , DONGIAVON
      , SOLUONG
      , TENDUOC
      , DONVITINH_ID
      , SOKIEMSOAT
      , NUOCSX
      , THANHTIEN
      , SOTHUCTE
      , THUA
      , THIEU
      , HONG
      , GHICHU
      , NGAYTAO
      , NGUOITAO_ID
      , NGAYCAPNHAT
      , NGUOICAPNHAT_ID
      , BENHVIEN_ID
      ) values (
      #DUOCKYKIEMKE_ID#
      , #HOIDONGKIEMKE_ID#
      , #KHODUOC_ID#
      , #DUOC_ID#
      , #SOLONHAP_ID#
      , #DONGIAMUA#
      , #DONGIAVON#
      , #SOLUONG#
      , #TENDUOC#
      , #DONVITINH_ID#
      , #SOKIEMSOAT#
      , #NUOCSX#
      , #THANHTIEN#
      , #SOTHUCTE#
      , #THUA#
      , #THIEU#
      , #HONG#
      , #GHICHU#
      , #NGAYTAO#
      , #NGUOITAO_ID#
      , #NGAYCAPNHAT#
      , #NGUOICAPNHAT_ID#
      , #BENHVIEN_ID#
      )
    </statement>

    <update id="DAO00112_TT_DUOC_KIEMKE_Update" parameterClass="System.Collections.IDictionary">
      update TT_DUOC_KIEMKE set
      DUOCKYKIEMKE_ID = #DUOCKYKIEMKE_ID#
      , HOIDONGKIEMKE_ID = #HOIDONGKIEMKE_ID#
      , KHODUOC_ID = #KHODUOC_ID#
      , DUOC_ID = #DUOC_ID#
      , SOLONHAP_ID = #SOLONHAP_ID#
      , DONGIAMUA = #DONGIAMUA#
      , DONGIAVON = #DONGIAVON#
      , SOLUONG = #SOLUONG#
      , TENDUOC = #TENDUOC#
      , DONVITINH_ID = #DONVITINH_ID#
      , SOKIEMSOAT = #SOKIEMSOAT#
      , NUOCSX = #NUOCSX#
      , THANHTIEN = #THANHTIEN#
      , SOTHUCTE = #SOTHUCTE#
      , THUA = #THUA#
      , THIEU = #THIEU#
      , HONG = #HONG#
      , GHICHU = #GHICHU#
      <!--, NGAYTAO = #NGAYTAO#
      , NGUOITAO_ID = #NGUOITAO_ID#-->
      , NGAYCAPNHAT = #NGAYCAPNHAT#
      , NGUOICAPNHAT_ID = #NGUOICAPNHAT_ID#
      , BENHVIEN_ID = #BENHVIEN_ID#
      where
      DUOCKIEMKE_ID = '$DUOCKIEMKE_ID$'
    </update>

    <statement id="DAO00112_TT_DUOC_KIEMKE_Delete" parameterClass="System.Collections.IDictionary" resultClass="System.Int32">
      delete from TT_DUOC_KIEMKE
      where
      DUOCKIEMKE_ID = '$DUOCKIEMKE_ID$'
    </statement>

    <statement id="DAO00112_TT_DUOC_KIEMKE_DeleteP" parameterClass="System.Collections.IDictionary" resultClass="System.Int32">
      delete from TT_DUOC_KIEMKE
      <dynamic prepend="where">
        <isParameterPresent>
          <isNotEmpty prepend="and" property="DUOCKIEMKE_ID">
            DUOCKIEMKE_ID = '$DUOCKIEMKE_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="DUOCKYKIEMKE_ID">
            DUOCKYKIEMKE_ID = '$DUOCKYKIEMKE_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="KHODUOC_ID">
            KHODUOC_ID = '$KHODUOC_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="DUOC_ID">
            DUOC_ID = '$DUOC_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="SOLONHAP_ID">
            SOLONHAP_ID = '$SOLONHAP_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="DONGIAMUA">
            DONGIAMUA = '$DONGIAMUA$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="DONGIAVON">
            DONGIAVON = '$DONGIAVON$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="SOLUONG">
            SOLUONG = '$SOLUONG$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="TENDUOC">
            TENDUOC = '$TENDUOC$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="DONVITINH_ID">
            DONVITINH_ID = '$DONVITINH_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="SOKIEMSOAT">
            SOKIEMSOAT = '$SOKIEMSOAT$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="NUOCSX">
            NUOCSX = '$NUOCSX$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="THANHTIEN">
            THANHTIEN = '$THANHTIEN$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="SOTHUCTE">
            SOTHUCTE = '$SOTHUCTE$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="THUA">
            THUA = '$THUA$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="THIEU">
            THIEU = '$THIEU$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="HONG">
            HONG = '$HONG$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="GHICHU">
            GHICHU = '$GHICHU$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="NGAYTAO">
            NGAYTAO = '$NGAYTAO$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="NGUOITAO_ID">
            NGUOITAO_ID = '$NGUOITAO_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="NGAYCAPNHAT">
            NGAYCAPNHAT = '$NGAYCAPNHAT$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="NGUOICAPNHAT_ID">
            NGUOICAPNHAT_ID = '$NGUOICAPNHAT_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="BENHVIEN_ID">
            BENHVIEN_ID = '$BENHVIEN_ID$'
          </isNotEmpty>
        </isParameterPresent>
      </dynamic>
    </statement>

    <statement id="DAO00112_KiemTraChungTuKhoaSo" resultClass="DataObject">    
      SELECT ct.CHUNGTU_ID
      FROM TT_DUOC_KYGUI_CHUNGTU ct,
      (
      SELECT
      TO_DATE(TO_CHAR(KHOADENNGAY,'MM/DD/YYYY'), 'MM/DD/YYYY')  NGAYKHOASO
      FROM TT_DUOC_KHOASOCHUNGTU
      WHERE
      KHODUOC_ID = '$KHODUOC_ID$'
      AND BENHVIEN_ID = '$BENHVIEN_ID$'
      AND KHOASO = '1'
      AND ROWNUM = 1
      ORDER BY KHOADENNGAY DESC
      ) ks
      WHERE
      ct.MACHUNGTU = '$MACHUNGTU$'
      and ct.BENHVIEN_ID = '$BENHVIEN_ID$'
      and TO_DATE(TO_CHAR(ct.NGAYCHUNGTU,'MM/DD/YYYY'), 'MM/DD/YYYY') &lt;= ks.NGAYKHOASO
    </statement>
    <statement id="DAO00112_LayNgayKhoaSoCuoi" resultClass="DataObject">
      SELECT KHOADENNGAY
      FROM TT_DUOC_KHOASOCHUNGTU
      WHERE
      KHODUOC_ID = '$KHODUOC_ID$'
      and BENHVIEN_ID = '$BENHVIEN_ID$'
      and KHOASO = '1'
      and ROWNUM = 1
      ORDER BY KHOADENNGAY DESC
    </statement>
    <statement id="DAO00112_KiemTraPhatSinhChungTuLienQuan" resultClass="DataObject">
      SELECT CHUNGTU_ID
      FROM TT_DUOC_KYGUI_CHUNGTU
      WHERE
      CHUNGTULIENQUAN_ID = '$CHUNGTU_ID$'
      and BENHVIEN_ID = '$BENHVIEN_ID$'
    </statement>
    <statement id="DAO00112_KiemTraSoLoNhapDaPhatSinhLienQuan" resultClass="DataObject">
      SELECT row_count from
      (
      SELECT count(*) AS row_count
      FROM TT_DUOC_KYGUI_CHUNGTU_CHITIET
      WHERE SOLONHAP_ID IN ($LIST_SOLONHAP_ID$)
      and CHUNGTU_ID > '$CHUNGTU_ID$'
      and BENHVIEN_ID = '$BENHVIEN_ID$'
      group by SOLONHAP_ID
      ) a
      WHERE row_count >= 1
    </statement>
  </statements>    
</sqlMap>
