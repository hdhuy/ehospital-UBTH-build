<?xml version="1.0" encoding="utf-8" ?>
<!--============================================================================
//	CAUTION: This file is generated by IBatisNetGen.3.SQLMap.cst at 11/11/2015 9:30:18 AM
//				Any manual editing will be lost in re-generation.
//===========================================================================-->
<sqlMap namespace="eHospital" xmlns="http://ibatis.apache.org/mapping" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <statements>

    <statement id="DAO00083_GetCLSKetQua_ID" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      select CLSKETQUA_ID
      from TT_CLSKETQUA
      where DVYEUCAU_ID  = '$DVYEUCAU_ID$'
    </statement>

    <statement id="DAO00083_GetCLSKQIDInCLSKQChiTiet" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      select CLSKETQUA_ID
      from TT_CLSKETQUACHITIET
      where DVYEUCAU_ID  = '$DVYEUCAU_ID$'
    </statement>

    <statement id="DAO00083_GetAll" resultClass="DataObject">
      select *
      from $REF_TABLE$
      order by $COL_VTYT_ID$
    </statement>

    <statement id="DAO00083_GetDSVTYTGhiNhan" resultClass="DataObject">
      select A.*, dc.TENDUOCDAYDU, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, dc.DONVITINH
      from $REF_TABLE$ A
      left join TM_DUOC dc on A.DUOC_ID = dc.DUOC_ID
      left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID
      where A.DVYEUCAU_ID = #DVYEUCAU_ID#
      <isNotEmpty prepend="and" property="DICHVU_GHINHANVTYT_ID">
        A.DICHVU_GHINHANVTYT_ID = '$DICHVU_GHINHANVTYT_ID$'
      </isNotEmpty>
      order by A.$COL_VTYT_ID$

      <!--select VTYT.*,   PL.MACHUNGTU AS SOPHIEULINH, CT.MACHUNGTU AS SOPHIEUXUAT
      from $REF_TABLE$  VTYT
      left join TT_DUOC_PHIEULINH PL  on VTYT.CHUNGTUTONGHOP_ID = PL.CHUNGTU_ID
      left join TT_DUOC_CHUNGTU CT  on VTYT.CHUNGTU_ID = CT.CHUNGTU_ID
      where VTYT.DVYEUCAU_ID = #DVYEUCAU_ID#
      order by $COL_VTYT_ID$-->
    </statement>
    <statement id="DAO00083_GetTrangThaiTruocKhiXoa_Update_CLSKetQua_VTYT" resultClass="DataObject">
      IF EXISTS (
      SELECT CLSKETQUA_VTYT_ID
      FROM TT_CLSKETQUA_VTYT
      WHERE DVYEUCAU_ID ='$DVYEUCAU_ID$'
      AND BENHVIEN_ID ='$BENHVIEN_ID$'
      AND (CHUNGTU_ID IS NOT NULL OR CHUNGTUTONGHOP_ID IS NOT NULL)
      <isNotEmpty prepend="and" property="DICHVU_GHINHANVTYT_ID">
        DICHVU_GHINHANVTYT_ID = '$DICHVU_GHINHANVTYT_ID$'
      </isNotEmpty>
      )
      BEGIN
      SELECT -1 AS RESULT
      END
      ELSE
      BEGIN
      SELECT 1 AS RESULT
      END
    </statement>
    <statement id="DAO00083_GetTrangThaiTruocKhiXoa_Update_KhamBenh_VTYT" resultClass="DataObject">
      IF EXISTS (
      SELECT KHAMBENH_VTYT_ID
      FROM TT_NGOAITRU_KHAMBENH_VTYT
      WHERE DVYEUCAU_ID ='$DVYEUCAU_ID$'
      AND BENHVIEN_ID ='$BENHVIEN_ID$'
      AND (CHUNGTU_ID IS NOT NULL OR CHUNGTUTONGHOP_ID IS NOT NULL OR PHIEULINH_ID IS NOT NULL)
      <isNotEmpty prepend="and" property="DICHVU_GHINHANVTYT_ID">
        DICHVU_GHINHANVTYT_ID = '$DICHVU_GHINHANVTYT_ID$'
      </isNotEmpty>
      )
      BEGIN
      SELECT -1 AS RESULT
      END
      ELSE
      BEGIN
      SELECT 1 AS RESULT
      END
    </statement>

    <statement id="DAO00083_GetList" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      select *
      from $REF_TABLE$
      <dynamic prepend="where">
        <isParameterPresent>
          <isNotEmpty prepend="and" property="$COL_VTYT_ID$">
            $COL_VTYT_ID$ = '$VTYT_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="REF_ID">
            $REF_ID_COL$ = '$REF_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="DVYEUCAU_ID">
            $DVYEUCAU_ID$ = '$DVYEUCAU_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="DUOC_ID">
            DUOC_ID = '$DUOC_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="SOLUONG">
            SOLUONG = '$SOLUONG$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="LOAIGIA_ID">
            LOAIGIA_ID = '$LOAIGIA_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="DONGIAPHAITHU">
            DONGIAPHAITHU = '$DONGIAPHAITHU$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="DONGIA">
            DONGIA = '$DONGIA$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="TYLEVAT">
            TYLEVAT = '$TYLEVAT$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="GIATRIVAT">
            GIATRIVAT = '$GIATRIVAT$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="TIENTE_ID">
            TIENTE_ID = '$TIENTE_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="TYGIA">
            TYGIA = '$TYGIA$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="CHUNGTU_ID">
            CHUNGTU_ID = '$CHUNGTU_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="GHICHU">
            GHICHU = '$GHICHU$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="CHUNGTUTONGHOP_ID">
            CHUNGTUTONGHOP_ID = '$CHUNGTUTONGHOP_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="KHOSUDUNG_ID">
            KHOSUDUNG_ID = '$KHOSUDUNG_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="TINHTIEN">
            TINHTIEN = '$TINHTIEN$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="BHYTDONGTIEN">
            BHYTDONGTIEN = '$BHYTDONGTIEN$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="TRANGTHAI">
            TRANGTHAI = '$TRANGTHAI$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="NGAYSUDUNG">
            NGAYSUDUNG = '$NGAYSUDUNG$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="THOIGIANSUDUNG">
            THOIGIANSUDUNG = '$THOIGIANSUDUNG$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="NGUONHANG_ID">
            NGUONHANG_ID = '$NGUONHANG_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="PHIEULINH_ID">
            PHIEULINH_ID = '$PHIEULINH_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="BENHVIEN_ID">
            BENHVIEN_ID = '$BENHVIEN_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="NGAYTAO">
            NGAYTAO = '$NGAYTAO$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="NGUOITAO_ID">
            NGUOITAO_ID = '$NGUOITAO_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="NGAYCAPNHAT">
            NGAYCAPNHAT = '$NGAYCAPNHAT$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="NGUOICAPNHAT_ID">
            NGUOICAPNHAT_ID = '$NGUOICAPNHAT_ID$'
          </isNotEmpty>
        </isParameterPresent>
      </dynamic>
      order by $COL_VTYT_ID$
    </statement>

    <statement id="DAO00083_GetDetail" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      select *
      from $REF_TABLE$
      where $COL_VTYT_ID$  = '$value$'
      order by $COL_VTYT_ID$
    </statement>

    <statement id="DAO00083_GetDetailP" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      select *
      from $REF_TABLE$
      where $COL_VTYT_ID$  = '$VTYT_ID$'
      order by $COL_VTYT_ID$
    </statement>

    <statement id="DAO00083_Add" parameterClass="System.Collections.IDictionary" resultClass="System.Int64">
      insert into $REF_TABLE$ (
      $REF_ID_COL$
      ,COSO
      , DVYEUCAU_ID
      , DUOC_ID
      , SOLUONG
      , CHUNGTU_ID
      , GHICHU
      , CHUNGTUTONGHOP_ID
      , KHOSUDUNG_ID
      , KHOTAO_ID
      , TINHTIEN
      , BHYTDONGTIEN
      , TRANGTHAI
      , NGAYSUDUNG
      , THOIGIANSUDUNG
      , NGUONHANG_ID
      <isPropertyAvailable prepend="," property="PHONGBAN_ID">
        PHONGBAN_ID
      </isPropertyAvailable>
      , PHIEULINH_ID
      , BENHVIEN_ID
      , NGAYTAO
      , NGUOITAO_ID
      , NGAYCAPNHAT
      , NGUOICAPNHAT_ID
      <isNotEmpty prepend="," property="PHAMVI_ID">
        PHAMVI_ID
      </isNotEmpty>
      <isNotEmpty prepend="," property="KHOPHAT_ID">
        KHOPHAT_ID
      </isNotEmpty>
      <isNotEmpty prepend="," property="DICHVU_GHINHANVTYT_ID">
        DICHVU_GHINHANVTYT_ID
      </isNotEmpty>
      ) values (
      #REF_ID#
      ,#COSO#
      , #DVYEUCAU_ID#
      , #DUOC_ID#
      , #SOLUONG#
      , #CHUNGTU_ID#
      , #GHICHU#
      , #CHUNGTUTONGHOP_ID#
      , #KHOSUDUNG_ID#
      , #KHOTAO_ID#
      , #TINHTIEN#
      , #BHYTDONGTIEN#
      , #TRANGTHAI#
      , #NGAYSUDUNG#
      , #THOIGIANSUDUNG#
      , #NGUONHANG_ID#
      <isPropertyAvailable prepend="," property="PHONGBAN_ID">
        #PHONGBAN_ID#
      </isPropertyAvailable>
      , #PHIEULINH_ID#
      , #BENHVIEN_ID#
      , #NGAYTAO#
      , #NGUOITAO_ID#
      , #NGAYCAPNHAT#
      , #NGUOICAPNHAT_ID#
      <isNotEmpty prepend="," property="PHAMVI_ID">
        #PHAMVI_ID#
      </isNotEmpty>
      <isNotEmpty prepend="," property="KHOPHAT_ID">
        #KHOPHAT_ID#
      </isNotEmpty>
      <isNotEmpty prepend="," property="DICHVU_GHINHANVTYT_ID">
        #DICHVU_GHINHANVTYT_ID#
      </isNotEmpty>
      )
      SELECT SCOPE_IDENTITY()
      <!--<selectKey resultClass="System.Int64" type="post" >
        SELECT @@IDENTITY as value
      </selectKey>-->
    </statement>

    <update id="DAO00083_Update" parameterClass="System.Collections.IDictionary">
      update $REF_TABLE$ set
      <!--$REF_ID_COL$ = #REF_ID#-->
      DUOC_ID = #DUOC_ID#
      , SOLUONG = #SOLUONG#
      <!--, LOAIGIA_ID = #LOAIGIA_ID#
      , DONGIAPHAITHU = #DONGIAPHAITHU#
      , DONGIA = #DONGIA#
      , TYLEVAT = #TYLEVAT#
      , GIATRIVAT = #GIATRIVAT#
      , TIENTE_ID = #TIENTE_ID#
      , TYGIA = #TYGIA#-->
      , CHUNGTU_ID = #CHUNGTU_ID#
      , GHICHU = #GHICHU#
      , CHUNGTUTONGHOP_ID = #CHUNGTUTONGHOP_ID#
      , KHOSUDUNG_ID = #KHOSUDUNG_ID#
      , TINHTIEN = #TINHTIEN#
      , BHYTDONGTIEN = #BHYTDONGTIEN#
      , TRANGTHAI = #TRANGTHAI#
      , NGAYSUDUNG = #NGAYSUDUNG#
      , THOIGIANSUDUNG = #THOIGIANSUDUNG#
      , NGUONHANG_ID = #NGUONHANG_ID#
      <isPropertyAvailable prepend="," property="PHONGBAN_ID">
        PHONGBAN_ID = #PHONGBAN_ID#
      </isPropertyAvailable>
      , PHIEULINH_ID = #PHIEULINH_ID#
      <!--, BENHVIEN_ID = #BENHVIEN_ID#
      , NGAYTAO = #NGAYTAO#
      , NGUOITAO_ID = #NGUOITAO_ID#-->
      , NGAYCAPNHAT = #NGAYCAPNHAT#
      , NGUOICAPNHAT_ID = #NGUOICAPNHAT_ID#
      <isNotEmpty prepend="," property="PHAMVI_ID">
        PHAMVI_ID = #PHAMVI_ID#
      </isNotEmpty>
      <isNotEmpty prepend="," property="KHOPHAT_ID">
        KHOPHAT_ID = #KHOPHAT_ID#
      </isNotEmpty>
      <isNotEmpty prepend="," property="DICHVU_GHINHANVTYT_ID">
        DICHVU_GHINHANVTYT_ID = #DICHVU_GHINHANVTYT_ID#
      </isNotEmpty>
      where
      $COL_VTYT_ID$ = '$VTYT_ID$'
    </update>

    <statement id="DAO00083_Delete" parameterClass="System.Collections.IDictionary" resultClass="System.Int32">
      delete from $REF_TABLE$
      where
      $COL_VTYT_ID$ = '$VTYT_ID$'
    </statement>

    <statement id="DAO00083_DeleteVienPhiVTYT" parameterClass="System.Collections.IDictionary" resultClass="System.Int32">
      delete from TT_VIENPHI
      where
      REF_TABLE = '$REF_TABLE$'
      and REF_ID = '$REF_ID$'

    </statement>

    <statement id="DAO00083_DeleteBookingVTYT" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      delete from TT_DUOC_TONKHO_BOOK_NGOAITRU
      where
      REF_TABLE = '$REF_TABLE$'
      and REF_ID = '$REF_ID$'
    </statement>
    <statement id="DAO00083_GetListDeleteBookingVTYT" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      select * from TT_DUOC_TONKHO_BOOK_NGOAITRU
      where
      REF_TABLE = '$REF_TABLE$'
      and REF_ID = '$REF_ID$'
    </statement>

    <statement id="DAO00083_XoaPhieuGhiNhan" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      delete from $REF_TABLE$
      where
      DVYEUCAU_ID = '$DVYEUCAU_ID$'
      <isNotEmpty prepend="and" property="DICHVU_GHINHANVTYT_ID">
        DICHVU_GHINHANVTYT_ID = '$DICHVU_GHINHANVTYT_ID$'

        IF EXISTS (SELECT 1 FROM TT_DICHVU_GHINHANVTYT WHERE DICHVU_GHINHANVTYT_ID = $DICHVU_GHINHANVTYT_ID$)
        BEGIN
        delete from TT_DICHVU_GHINHANVTYT where DICHVU_GHINHANVTYT_ID = $DICHVU_GHINHANVTYT_ID$
        END
      </isNotEmpty>
    </statement>
    <statement id="DAO00083_GetListXoaPhieuGhiNhan" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      select * from $REF_TABLE$
      where
      DVYEUCAU_ID = '$DVYEUCAU_ID$'
      <isNotEmpty prepend="and" property="DICHVU_GHINHANVTYT_ID">
        DICHVU_GHINHANVTYT_ID = '$DICHVU_GHINHANVTYT_ID$'
      </isNotEmpty>
    </statement>

    <statement id="DAO00083_DeleteP" parameterClass="System.Collections.IDictionary" resultClass="System.Int32">
      delete from $REF_TABLE$
      <dynamic prepend="where">
        <isParameterPresent>
          <isNotEmpty prepend="and" property="$COL_VTYT_ID$">
            $COL_VTYT_ID$ = '$VTYT_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="CLSKETQUA_ID">
            CLSKETQUA_ID = '$CLSKETQUA_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="DUOC_ID">
            DUOC_ID = '$DUOC_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="SOLUONG">
            SOLUONG = '$SOLUONG$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="LOAIGIA_ID">
            LOAIGIA_ID = '$LOAIGIA_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="DONGIAPHAITHU">
            DONGIAPHAITHU = '$DONGIAPHAITHU$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="DONGIA">
            DONGIA = '$DONGIA$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="TYLEVAT">
            TYLEVAT = '$TYLEVAT$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="GIATRIVAT">
            GIATRIVAT = '$GIATRIVAT$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="TIENTE_ID">
            TIENTE_ID = '$TIENTE_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="TYGIA">
            TYGIA = '$TYGIA$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="CHUNGTU_ID">
            CHUNGTU_ID = '$CHUNGTU_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="GHICHU">
            GHICHU = '$GHICHU$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="CHUNGTUTONGHOP_ID">
            CHUNGTUTONGHOP_ID = '$CHUNGTUTONGHOP_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="KHOSUDUNG_ID">
            KHOSUDUNG_ID = '$KHOSUDUNG_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="TINHTIEN">
            TINHTIEN = '$TINHTIEN$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="BHYTDONGTIEN">
            BHYTDONGTIEN = '$BHYTDONGTIEN$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="TRANGTHAI">
            TRANGTHAI = '$TRANGTHAI$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="NGAYSUDUNG">
            NGAYSUDUNG = '$NGAYSUDUNG$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="THOIGIANSUDUNG">
            THOIGIANSUDUNG = '$THOIGIANSUDUNG$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="NGUONHANG_ID">
            NGUONHANG_ID = '$NGUONHANG_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="PHIEULINH_ID">
            PHIEULINH_ID = '$PHIEULINH_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="BENHVIEN_ID">
            BENHVIEN_ID = '$BENHVIEN_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="NGAYTAO">
            NGAYTAO = '$NGAYTAO$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="NGUOITAO_ID">
            NGUOITAO_ID = '$NGUOITAO_ID$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="NGAYCAPNHAT">
            NGAYCAPNHAT = '$NGAYCAPNHAT$'
          </isNotEmpty>
          <isNotEmpty prepend="and" property="NGUOICAPNHAT_ID">
            NGUOICAPNHAT_ID = '$NGUOICAPNHAT_ID$'
          </isNotEmpty>
        </isParameterPresent>
      </dynamic>
    </statement>

    <statement id="DAO00083_GetSLDuocDaLuu" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      select sum(SOLUONG) as SOLUONG
      from $REF_TABLE$
      where $REF_ID_COL$  = '$REF_ID$'
      and DUOC_ID  = '$DUOC_ID$'
    </statement>

    <update id="DAO00083_UpdateTTGhiNhanVTYT" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      update TT_DVYEUCAU
      set GHINHANVTYT = '$GHINHANVTYT$',
      NGUOICAPNHAT_ID = '$NGUOICAPNHAT_ID$',
      NGAYCAPNHAT = '$NGAYCAPNHAT$'
      where DVYEUCAU_ID  = '$DVYEUCAU_ID$'
    </update>

    <statement id="DAO00083_DeleteThuocInList" parameterClass="HashTable" resultClass="DataObject">
      select *
      from $REF_TABLE$
      where <!--$REF_ID_COL$ = #REF_ID#-->
      <dynamic prepend=" $COL_VTYT_ID$ in ">
        <iterate open="(" close=")" conjunction=",  " property="LSTTOATHUOC_ID">#LSTTOATHUOC_ID[]#</iterate>
      </dynamic>

      delete from $REF_TABLE$
      where <!--$REF_ID_COL$ = #REF_ID#-->
      <dynamic prepend=" $COL_VTYT_ID$ in ">
        <iterate open="(" close=")" conjunction=",  " property="LSTTOATHUOC_ID">#LSTTOATHUOC_ID[]#</iterate>
      </dynamic>
    </statement>

    <statement id="DAO00083_GetThongTinVTYT" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      select vtyt.CHUNGTU_ID, vtyt.PHIEULINH_ID, vtyt.NGUOITAO_ID, vp.DATHANHTOAN
      from $REF_TABLE$ vtyt
      left join TT_VIENPHI vp
      on vtyt.$COL_VTYT_ID$ = vp.REF_ID
      where vtyt.$REF_ID_COL$ = '$REF_ID$'
      and vtyt.$COL_VTYT_ID$ = '$VTYT_ID$'
      and vp.REF_TABLE = '$REF_TABLE$'
    </statement>

    <statement id="DAO00083_GetBookingInfo" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      select *
      from TT_DUOC_TONKHO_BOOK_NGOAITRU
      where
      <!--KHODUOC_ID  = '$KHODUOC_ID$'
      and-->
      DUOC_ID = '$DUOC_ID$'
      and NGUONHANG_ID = '$NGUONHANG_ID$'
      and REF_ID = '$VTYT_ID$'
      and REF_TABLE = '$REF_TABLE$'
      <isNotEmpty prepend="and" property="KHODUOC_ID">
        KHODUOC_ID = #KHODUOC_ID#
      </isNotEmpty>
      <isNotEmpty prepend="and" property="PHAMVI_ID">
        PHAMVI_ID = #PHAMVI_ID#
      </isNotEmpty>
    </statement>

    <update id="DAO00083_Update_Booking" parameterClass="HashTable" resultClass="System.Int64">
      update TT_DUOC_TONKHO_BOOK_NGOAITRU set
      KHODUOC_ID = #KHODUOC_ID#,
      NGUONHANG_ID = #NGUONHANG_ID#,
      DUOC_ID = #DUOC_ID#,
      SOLUONG = #SOLUONG#,
      NGAYHIEULUC = #NGAYHIEULUC#,
      NGUOICAPNHAT_ID = #NGUOICAPNHAT_ID#,
      NGAYCAPNHAT = #NGAYCAPNHAT#
      <isNotEmpty prepend="," property="PHAMVI_ID">
        PHAMVI_ID = #PHAMVI_ID#
      </isNotEmpty>
      where
      BOOKING_ID = '$BOOKING_ID$'
    </update>

    <insert id="DAO00083_Add_Booking" parameterClass="HashTable" resultClass="System.Int64">
      insert into TT_DUOC_TONKHO_BOOK_NGOAITRU (
      REF_TABLE
      , REF_ID
      , KHODUOC_ID
      , NGUONHANG_ID
      , DUOC_ID
      , BENHVIEN_ID
      , SOLUONG
      , NGAYHIEULUC
      , NGUOITAO_ID
      , NGAYTAO
      , NGUOICAPNHAT_ID
      , NGAYCAPNHAT
      <isNotEmpty prepend="," property="PHAMVI_ID">
        PHAMVI_ID
      </isNotEmpty>
      ) values (
      #REF_TABLE#
      , #VTYT_ID#
      , #KHODUOC_ID#
      , #NGUONHANG_ID#
      , #DUOC_ID#
      , #BENHVIEN_ID#
      , #SOLUONG#
      , #NGAYHIEULUC#
      , #NGUOITAO_ID#
      , #NGAYTAO#
      , #NGUOICAPNHAT_ID#
      , #NGAYCAPNHAT#
      <isNotEmpty prepend="," property="PHAMVI_ID">
        #PHAMVI_ID#
      </isNotEmpty>
      )
    </insert>
    <statement id="DAO00083_GetListKhamBenhNgoaiTru_ID_ByTiepNhanID" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      select KB.*
      from TT_TIEPNHAN TN
      left join TT_NGOAITRU_KHAMBENH KB on KB.TIEPNHAN_ID = TN.TIEPNHAN_ID and KB.BENHVIEN_ID = TN.BENHVIEN_ID
      where TN.TIEPNHAN_ID = '$TIEPNHAN_ID$'
      and KB.KHAMBENH_ID is not null
      and TN.BENHVIEN_ID = '$BENHVIEN_ID$'
      <isNotEmpty prepend="and" property="DICHVU_ID">
        KB.DICHVU_ID = '$DICHVU_ID$'
      </isNotEmpty>
    </statement>
    <statement id="DAO00083_GetList_PhieuGhiNhanVTYT" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      select DICHVU_GHINHANVTYT_ID, SOPHIEU, KHAMBENH_ID, TIEPNHAN_ID, DVYEUCAU_ID, CLSKETQUA_ID, DIENBIEN
      from TT_DICHVU_GHINHANVTYT
      where TIEPNHAN_ID = '$TIEPNHAN_ID$'
      and BENHVIEN_ID = '$BENHVIEN_ID$'
      <isNotEmpty prepend="and" property="KHAMBENH_ID">
        KHAMBENH_ID = '$KHAMBENH_ID$'
      </isNotEmpty>
      <isNotEmpty prepend="and" property="DVYEUCAU_ID">
        DVYEUCAU_ID = '$DVYEUCAU_ID$'
      </isNotEmpty>
      order by THOIGIANGHINHAN desc
    </statement>
    <statement id="DAO00083_Add_PhieuGhiNhanVTYT" parameterClass="HashTable" resultClass="System.Int64">
      insert into TT_DICHVU_GHINHANVTYT (
      SOPHIEU
      , KHAMBENH_ID
      , TIEPNHAN_ID
      , DVYEUCAU_ID
      , NGAYGHINHAN
      , THOIGIANGHINHAN
      , KHOXUAT_ID
      , BENHVIEN_ID
      , THOIGIANTAO
      , NGUOITAO_ID
      , CLSKETQUA_ID
      , DIENBIEN
      ) values (
      #SOPHIEU#
      , #KHAMBENH_ID#
      , #TIEPNHAN_ID#
      , #DVYEUCAU_ID#
      , #NGAYGHINHAN#
      , #THOIGIANGHINHAN#
      , #KHOXUAT_ID#
      , #BENHVIEN_ID#
      , #THOIGIANTAO#
      , #NGUOITAO_ID#
      , #CLSKETQUA_ID#
      , #DIENBIEN#
      )
      SELECT SCOPE_IDENTITY()
    </statement>
    <update id="DAO00083_Update_PhieuGhiNhanVTYT" parameterClass="HashTable" resultClass="System.Int64">
      update TT_DICHVU_GHINHANVTYT set
      KHOXUAT_ID = #KHOXUAT_ID#,
      THOIGIANCAPNHAT = #THOIGIANCAPNHAT#,
      NGUOICAPNHAT_ID = #NGUOICAPNHAT_ID#,
      DIENBIEN = #DIENBIEN#
      where
      DICHVU_GHINHANVTYT_ID = '$DICHVU_GHINHANVTYT_ID$'
    </update>
    <statement id="DAO00083_CheckTrangThaiDaGhiNhanVTYT" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      IF EXISTS (
      SELECT KHAMBENH_VTYT_ID
      FROM TT_NGOAITRU_KHAMBENH_VTYT
      WHERE DVYEUCAU_ID ='$DVYEUCAU_ID$' AND BENHVIEN_ID ='$BENHVIEN_ID$'
      UNION ALL
      SELECT CLSKETQUA_VTYT_ID
      FROM TT_CLSKETQUA_VTYT
      WHERE DVYEUCAU_ID = '$DVYEUCAU_ID$' AND BENHVIEN_ID = '$BENHVIEN_ID$'
      UNION ALL
      SELECT PHAUTHUAT_VTYT_ID
      FROM TT_PHAUTHUAT_YEUCAU a
      join TT_PHAUTHUAT_VTYT b on a.PHAUTHUAT_ID = b.PHAUTHUAT_ID
      WHERE a.DVYEUCAU_ID = '$DVYEUCAU_ID$' AND a.BENHVIEN_ID = '$BENHVIEN_ID$'
      )
      BEGIN
      SELECT -1 AS RESULT
      END
      ELSE
      BEGIN
      SELECT 1 AS RESULT
      END
    </statement>
    <statement id="DAO00083_GetDataGiayChungNhanNghiViecHuongBHXH" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      declare @HoTenMe nvarchar(200), @HoTenCha nvarchar(200), @ChanDoan nvarchar(2000)
      select @HoTenMe = LH.TENNGUOILIENHE
      from TT_BENHNHAN_NGUOILIENHE LH
      left join LST_DICTIONARY QH on QH.DICTIONARY_ID = LH.QUANHE_ID and QH.BENHVIEN_ID = LH.BENHVIEN_ID
      where LH.BENHNHAN_ID = $BENHNHAN_ID$ and QH.DICTIONARY_CODE = '2' and LH.BENHVIEN_ID = '$BENHVIEN_ID$'

      select @HoTenCha = LH.TENNGUOILIENHE
      from TT_BENHNHAN_NGUOILIENHE LH
      left join LST_DICTIONARY QH on QH.DICTIONARY_ID = LH.QUANHE_ID and QH.BENHVIEN_ID = LH.BENHVIEN_ID
      where LH.BENHNHAN_ID = $BENHNHAN_ID$ and QH.DICTIONARY_CODE = '1' and LH.BENHVIEN_ID = '$BENHVIEN_ID$'

      SELECT @ChanDoan = COALESCE(@ChanDoan + ', ', '') + CHANDOANKHOAKHAM
      FROM TT_NGOAITRU_KHAMBENH
      WHERE TIEPNHAN_ID = $TIEPNHAN_ID$ and BENHVIEN_ID = '$BENHVIEN_ID$'

      select BN.BENHNHAN_ID, BN.MAYTE, BN.TENBENHNHAN, BN.GIOITINH, BN.NGAYSINH, TN.TIEPNHAN_ID, TN.SOBHYT,
      GCN.GIAYCHUNGNHAN_ID, GCN.SOSERI, GCN.DONVILAMVIEC, GCN.PHUONGPHAPDIEUTRI, GCN.NGHITUNGAY,
      GCN.NGHIDENNGAY, GCN.BACSI_ID, GCN.THUTRUONGDONVI_ID,
      case when GCN.CHANDOAN is null then @ChanDoan else GCN.CHANDOAN end AS CHANDOAN,
      case when GCN.HOTENCHA is null then @HoTenCha else GCN.HOTENCHA end AS HOTENCHA,
      case when GCN.HOTENME is null then @HoTenMe else GCN.HOTENME end AS HOTENME
      from TT_TIEPNHAN TN
      inner join TT_BENHNHAN BN on BN.BENHNHAN_ID = TN.BENHNHAN_ID and BN.BENHVIEN_ID = TN.BENHVIEN_ID
      left join TT_GIAYCHUNGNHAN_NGHIVIEC GCN on GCN.TIEPNHAN_ID = TN.TIEPNHAN_ID and GCN.BENHVIEN_ID = TN.BENHVIEN_ID
      where
      TN.TIEPNHAN_ID = $TIEPNHAN_ID$
      and TN.BENHVIEN_ID = '$BENHVIEN_ID$'

    </statement>
    <statement id="DAO00083_AddGiayChungNhanNghiHuongBHXH" parameterClass="HashTable" resultClass="System.Int64">
      insert into TT_GIAYCHUNGNHAN_NGHIVIEC (
      SOSERI
      , BENHNHAN_ID
      , TIEPNHAN_ID
      , MAYTE
      , DONVILAMVIEC
      , HOTENCHA
      , HOTENME
      , CHANDOAN
      , PHUONGPHAPDIEUTRI
      , NGHITUNGAY
      , NGHIDENNGAY
      , BACSI_ID
      , NGUOITAO_ID
      , NGAYTAO
      , BENHVIEN_ID
      <isNotEmpty prepend="" property="THUTRUONGDONVI_ID">
        , THUTRUONGDONVI_ID
      </isNotEmpty>
      ) values (
      #SOSERI#
      , #BENHNHAN_ID#
      , #TIEPNHAN_ID#
      , #MAYTE#
      , #DONVILAMVIEC#
      , #HOTENCHA#
      , #HOTENME#
      , #CHANDOAN#
      , #PHUONGPHAPDIEUTRI#
      , #NGHITUNGAY#
      , #NGHIDENNGAY#
      , #BACSI_ID#
      , #NGUOITAO_ID#
      , #NGAYTAO#
      , #BENHVIEN_ID#
      <isNotEmpty prepend="" property="THUTRUONGDONVI_ID">
        , #THUTRUONGDONVI_ID#
      </isNotEmpty>
      )
      SELECT SCOPE_IDENTITY()
    </statement>
    <update id="DAO00083_UpdateGiayChungNhanNghiHuongBHXH" parameterClass="HashTable" resultClass="System.Int64">
      update TT_GIAYCHUNGNHAN_NGHIVIEC set
      DONVILAMVIEC = #DONVILAMVIEC#,
      HOTENCHA = #HOTENCHA#,
      HOTENME = #HOTENME#,
      CHANDOAN = #CHANDOAN#,
      PHUONGPHAPDIEUTRI = #PHUONGPHAPDIEUTRI#,
      NGHITUNGAY = #NGHITUNGAY#,
      NGHIDENNGAY = #NGHIDENNGAY#,
      BACSI_ID = #BACSI_ID#,
      NGUOICAPNHAT_ID = #NGUOICAPNHAT_ID#,
      NGAYCAPNHAT = #NGAYCAPNHAT#
      <isNotEmpty prepend="" property="THUTRUONGDONVI_ID">
        , THUTRUONGDONVI_ID = #THUTRUONGDONVI_ID#
      </isNotEmpty>
      where
      GIAYCHUNGNHAN_ID = $GIAYCHUNGNHAN_ID$
    </update>
    <statement id="DAO00083_XoaThongTinGiayChungNhanNghiHuongBHXH" parameterClass="HashTable" resultClass="DataObject">

      delete from TT_GIAYCHUNGNHAN_NGHIVIEC
      where GIAYCHUNGNHAN_ID = $GIAYCHUNGNHAN_ID$

    </statement>
    <statement id="DAO00083_GetVTYTDaGhiNhan" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      select *
      from TT_CLSKETQUA_VTYT
      where DVYEUCAU_ID = $DVYEUCAU_ID$
    </statement>
    <statement id="DAO00083_GetDSYLenhTruyenDich" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      select CAST(0 AS bit) AS CHON, DT.THOIGIANYLENH, PB.PHONGBAN_ID, PB.TENPHONGBAN AS NOICHIDINH
      , DT.TIEPNHAN_ID, DT.KHAMBENH_ID, DT.CHAMSOCDICHTRUYEN_ID, DT.THOIGIANBATDAU, DT.THOIGIANKETTHUC
      from TT_NGOAITRU_CHAMSOCDICHTRUYEN DT
      inner join TT_NGOAITRU_KHAMBENH KB on KB.KHAMBENH_ID = DT.KHAMBENH_ID and KB.BENHVIEN_ID = DT.BENHVIEN_ID
      inner join TT_TIEPNHAN TN on TN.TIEPNHAN_ID = DT.TIEPNHAN_ID and TN.BENHVIEN_ID = DT.BENHVIEN_ID
      left join TM_PHONGBAN PB on PB.PHONGBAN_ID = KB.PHONGBAN_ID and PB.BENHVIEN_ID = KB.BENHVIEN_ID
      where DT.TIEPNHAN_ID = $TIEPNHAN_ID$ and DT.BENHVIEN_ID = '$BENHVIEN_ID$'
      order by DT.THOIGIANKETTHUC desc
    </statement>
    <statement id="DAO00083_GetChiTietTruyenDich" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      select DT.DUOC_ID, DT.SOLUONG, DT.SOLOSX, DT.TOCDOTRUYEN, DT.THOIGIANBATDAU, DT.THOIGIANKETTHUC, BS.TENNHANVIEN AS BACSICHIDINH,
      DD.TENNHANVIEN AS DIEUDUONG, D.TENDUOCDAYDU, ROW_NUMBER () OVER(ORDER BY D.AUTOCOMPLETEFIELD)  AS STT, DT.CHAMSOCDICHTRUYEN_ID,
      DT.BACSICHIDINH_ID, DT.DIEUDUONGTHUCHIEN_ID, DT.SOMLCHAYNGUOC, DT.SOMLGIAOLAI, DT.GHICHU, DT.SOGIOTTRENPHUT
      from TT_NGOAITRU_CHAMSOCDICHTRUYEN DT
      left join TM_NHANVIEN BS on BS.NHANVIEN_ID = DT.BACSICHIDINH_ID and BS.BENHVIEN_ID = DT.BENHVIEN_ID
      left join TM_NHANVIEN DD on DD.NHANVIEN_ID = DT.DIEUDUONGTHUCHIEN_ID and DD.BENHVIEN_ID = DT.BENHVIEN_ID
      left join TM_DUOC D on D.DUOC_ID = DT.DUOC_ID and D.BENHVIEN_ID = DT.BENHVIEN_ID
      where DT.TIEPNHAN_ID = $TIEPNHAN_ID$
      AND DT.CHAMSOCDICHTRUYEN_ID = $CHAMSOCDICHTRUYEN_ID$
      and DT.BENHVIEN_ID = '$BENHVIEN_ID$'
      order by D.AUTOCOMPLETEFIELD
    </statement>
    <update id="DAO00083_Update_ThongTinDichTruyen" parameterClass="System.Collections.IDictionary">
      update TT_NGOAITRU_CHAMSOCDICHTRUYEN set
      DUOC_ID = #DUOC_ID#
      <isPropertyAvailable prepend="," property="SOLUONG">SOLUONG = #SOLUONG#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="SOMLCHAYNGUOC">SOMLCHAYNGUOC = #SOMLCHAYNGUOC#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="SOMLGIAOLAI">SOMLGIAOLAI = #SOMLGIAOLAI#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="TOCDOTRUYEN">TOCDOTRUYEN = #TOCDOTRUYEN#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="THOIGIANBATDAU">THOIGIANBATDAU = #THOIGIANBATDAU#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="THOIGIANKETTHUC">THOIGIANKETTHUC = #THOIGIANKETTHUC#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="SOLOSX">SOLOSX = #SOLOSX#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="THOIGIANYLENH">THOIGIANYLENH = #THOIGIANYLENH#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="BENHVIEN_ID">BENHVIEN_ID = #BENHVIEN_ID#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGAYCAPNHAT">NGAYCAPNHAT = #NGAYCAPNHAT#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="NGUOICAPNHAT_ID">NGUOICAPNHAT_ID = #NGUOICAPNHAT_ID#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="BACSICHIDINH_ID">BACSICHIDINH_ID = #BACSICHIDINH_ID#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="DIEUDUONGTHUCHIEN_ID">DIEUDUONGTHUCHIEN_ID = #DIEUDUONGTHUCHIEN_ID#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="GHICHU">GHICHU = #GHICHU#</isPropertyAvailable>
      <isPropertyAvailable prepend="," property="SOGIOTTRENPHUT">SOGIOTTRENPHUT = #SOGIOTTRENPHUT#</isPropertyAvailable>
      where      CHAMSOCDICHTRUYEN_ID = '$CHAMSOCDICHTRUYEN_ID$'
    </update>
    <insert id="DAO00083_Add_ThongTinDichTruyen" parameterClass="System.Collections.IDictionary" resultClass="System.Int64">
      insert into TT_NGOAITRU_CHAMSOCDICHTRUYEN (
      DUOC_ID
      , SOLUONG
      , BENHVIEN_ID
      , NGAYTAO
      , NGUOITAO_ID
      , TOCDOTRUYEN
      , TIEPNHAN_ID
      , KHAMBENH_ID
      , BACSICHIDINH_ID
      , DIEUDUONGTHUCHIEN_ID
      , THOIGIANBATDAU
      , THOIGIANKETTHUC
      , SOLOSX
      , THOIGIANYLENH
      , SOMLCHAYNGUOC
      , SOMLGIAOLAI
      , GHICHU
      , SOGIOTTRENPHUT
      ) values (
      #DUOC_ID#
      , #SOLUONG#
      , #BENHVIEN_ID#
      , #NGAYTAO#
      , #NGUOITAO_ID#
      , #TOCDOTRUYEN#
      , #TIEPNHAN_ID#
      , #KHAMBENH_ID#
      , #BACSICHIDINH_ID#
      , #DIEUDUONGTHUCHIEN_ID#
      , #THOIGIANBATDAU#
      , #THOIGIANKETTHUC#
      , #SOLOSX#
      , #THOIGIANYLENH#
      , #SOMLCHAYNGUOC#
      , #SOMLGIAOLAI#
      , #GHICHU#
      , #SOGIOTTRENPHUT#
      )
    </insert>
    <statement id="DAO00083_Delete_PhieuTruyenDich" parameterClass="System.Collections.IDictionary" resultClass="System.Int64">
      DELETE FROM TT_NGOAITRU_CHAMSOCDICHTRUYEN
      WHERE TIEPNHAN_ID = $TIEPNHAN_ID$
      AND BENHVIEN_ID = '$BENHVIEN_ID$'
      AND CHAMSOCDICHTRUYEN_ID = $CHAMSOCDICHTRUYEN_ID$

      SELECT $CHAMSOCDICHTRUYEN_ID$
    </statement>
    <statement id="DAO00083_KiemTraMaNhomDSA" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      select b.MANHOMDICHVU, b.TENNHOMDICHVU
      from TM_DICHVU a
      join TM_NHOMDICHVU b on a.NHOMDICHVU_ID = b.NHOMDICHVU_ID
      where a.DICHVU_ID = '$DICHVU_ID$'
    </statement>
    <statement id="DAO00083_GetNgoaiTruChamSoc" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      select * from TT_NGOAITRU_CHAMSOC
      where TIEPNHAN_ID = '$TIEPNHAN_ID$'
      order by CHAMSOC_ID desc
    </statement>
    <statement id="DAO00083_AddNgoaiTruChamSoc" parameterClass="System.Collections.IDictionary">
      insert into TT_NGOAITRU_CHAMSOC (
      TIEPNHAN_ID
      , THOIGIANTHUCHIEN
      , NGUOITHUCHIEN_ID
      , MACH
      , NHIETDO
      , HUYETAPTHAP
      , HUYETAPCAO
      , CANNANG
      , NHIPTHO
      , MUCDODAU
      , CHIEUCAO
      , SPO2
      , NUOCTIEU
      , PHAN
      , DIENBENH
      , YLENHCHAMSOC
      , CHANDOANDIEUDUONG
      , LUONGGIA
      , UONG
      , AN
      , TIEMTRUYEN
      , TRUYENMAU
      , NON
      , DANLUU
      , DICHDANLUU1
      , DICHDANLUU2
      , GHICHU
      , BENHVIEN_ID
      , NGAYTAO
      , NGUOITAO_ID
      , NGAYCAPNHAT
      , NGUOICAPNHAT_ID
      , PHANCAPCHAMSOC_ID
      , CHEDODINHDUONG
      , MACHAMSOC
      , TENCHAMSOC
      ) values (
      #TIEPNHAN_ID#
      , #THOIGIANTHUCHIEN#
      , #NGUOITHUCHIEN_ID#
      , #MACH#
      , #NHIETDO#
      , #HUYETAPTHAP#
      , #HUYETAPCAO#
      , #CANNANG#
      , #NHIPTHO#
      , #MUCDODAU#
      , #CHIEUCAO#
      , #SPO2#
      , #NUOCTIEU#
      , #PHAN#
      , #DIENBENH#
      , #YLENHCHAMSOC#
      , #CHANDOANDIEUDUONG#
      , #LUONGGIA#
      , #UONG#
      , #AN#
      , #TIEMTRUYEN#
      , #TRUYENMAU#
      , #NON#
      , #DANLUU#
      , #DICHDANLUU1#
      , #DICHDANLUU2#
      , #GHICHU#
      , #BENHVIEN_ID#
      , #NGAYTAO#
      , #NGUOITAO_ID#
      , #NGAYCAPNHAT#
      , #NGUOICAPNHAT_ID#
      , #PHANCAPCHAMSOC_ID#
      , #CHEDODINHDUONG#
      , #MACHAMSOC#
      , #TENCHAMSOC#
      )
    </statement>
    <statement id="DAO00083_UpdateNgoaiTruChamSoc" parameterClass="System.Collections.IDictionary">
      update TT_NGOAITRU_CHAMSOC set
      TIEPNHAN_ID = #TIEPNHAN_ID#
      , THOIGIANTHUCHIEN = #THOIGIANTHUCHIEN#
      , NGUOITHUCHIEN_ID = #NGUOITHUCHIEN_ID#
      , MACH = #MACH#
      , NHIETDO = #NHIETDO#
      , HUYETAPTHAP = #HUYETAPTHAP#
      , HUYETAPCAO = #HUYETAPCAO#
      , CANNANG = #CANNANG#
      , NHIPTHO = #NHIPTHO#
      , MUCDODAU = #MUCDODAU#
      , CHIEUCAO = #CHIEUCAO#
      , SPO2 = #SPO2#
      , NUOCTIEU = #NUOCTIEU#
      , PHAN = #PHAN#
      , DIENBENH = #DIENBENH#
      , YLENHCHAMSOC = #YLENHCHAMSOC#
      , CHANDOANDIEUDUONG = #CHANDOANDIEUDUONG#
      , LUONGGIA = #LUONGGIA#
      , UONG = #UONG#
      , AN = #AN#
      , TIEMTRUYEN = #TIEMTRUYEN#
      , TRUYENMAU = #TRUYENMAU#
      , NON = #NON#
      , DANLUU = #DANLUU#
      , DICHDANLUU1 = #DICHDANLUU1#
      , DICHDANLUU2 = #DICHDANLUU2#
      , GHICHU = #GHICHU#
      , NGAYCAPNHAT = #NGAYCAPNHAT#
      , NGUOICAPNHAT_ID = #NGUOICAPNHAT_ID#
      , PHANCAPCHAMSOC_ID = #PHANCAPCHAMSOC_ID#
      , CHEDODINHDUONG = #CHEDODINHDUONG#
      , MACHAMSOC = #MACHAMSOC#
      , TENCHAMSOC = #TENCHAMSOC#
      where
      CHAMSOC_ID = '$CHAMSOC_ID$'
    </statement>
    <statement id="DAO00083_DeleteNgoaiTruChamSoc" parameterClass="System.Collections.IDictionary" resultClass="System.Int32">
      delete from TT_NGOAITRU_CHAMSOC
      where
      CHAMSOC_ID = '$CHAMSOC_ID$'
    </statement>
    <statement id="DAO00083_GetListChamSoc" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      select * from TM_CHAMSOCNGUOIBENH where TAMNGUNG != '1'
    </statement>
    <statement id="DAO00083_GetDanhSachCLS_DaThucHien" parameterClass="System.Collections.IDictionary" resultClass="DataObject">
      select * from(
      select ROW_NUMBER() OVER(order by NGAYGIOYEUCAU) as ROWNUMBER, *
      from
      (SELECT distinct
      COUNT(*) OVER() as TOTALROWS,
      N'Mã người bệnh: ' + bn.MAYTE + ' - ' + N'Tên người bệnh: ' + bn.TENBENHNHAN + ' - ' + N'Số bệnh án: ' + ISNULL(BA.SOBENHAN,'') + ' - ' + N'Sinh ngày: ' + isnull(Convert(varchar(10),bn.NGAYSINH,103),bn.NAMSINH) + ' - ' + N'Giới tính: ' + GD.DESCRIPTION as GROUPNAME
      , tn.THOIGIANTIEPNHAN, tn.BENHNHAN_ID, tn.TIEPNHAN_ID, ba.BENHAN_ID
      , dv.DICHVU_ID
      , dv.KHAN, dv.NGAYGIOYEUCAU, dv.BACSICHIDINH_ID
      , B.TENNHOMDICHVU, dv.SOPHIEUYEUCAU
      , dv.CHANDOAN
      , a.MADICHVU
      , a.TENDICHVU, nyc.TENPHONGBAN as NOIYEUCAU
      , nth.TENPHONGBAN as NOITHUCHIEN
      , cls.CLSKETQUA_ID, cls.NGAYGIOTHUCHIEN , cls.THOIGIANKHOADULIEU
      , dv.TENNGUOIKHOA
      , dv.DVYEUCAU_ID
      , bscd.TENNHANVIEN as TENBACSICHIDINH
      FROM TT_DVYEUCAU (NOLOCK) dv
      inner join TT_TIEPNHAN (NOLOCK) tn on dv.TIEPNHAN_ID = tn.TIEPNHAN_ID
      inner join TT_BENHNHAN (NOLOCK) bn on tn.BENHNHAN_ID = bn.BENHNHAN_ID
      inner join TM_DICHVU A on A.DICHVU_ID = dv.DICHVU_ID
      inner join TM_PHONGBAN nyc on nyc.PHONGBAN_ID = dv.NOIYEUCAU_ID
      inner join TM_NHANVIEN bscd on bscd.NHANVIEN_ID = dv.BACSICHIDINH_ID
      inner join TM_NHOMDICHVU B on B.NHOMDICHVU_ID = A.NHOMDICHVU_ID
      left join TT_NOITRU_BENHAN (NOLOCK) BA on BA.TIEPNHAN_ID = tn.TIEPNHAN_ID AND dv.BENHAN_ID = BA.BENHAN_ID
      inner join TM_GENDER GD on GD.ID = bn.GIOITINH
      inner join TT_CLSKETQUA (NOLOCK) cls on dv.DVYEUCAU_ID = cls.DVYEUCAU_ID
      inner join TM_PHONGBAN nth on nth.PHONGBAN_ID = cls.NOITHUCHIEN_ID
      where
      dv.DICHVU_ID IS NOT NULL
      and tn.BENHVIEN_ID = '$BENHVIEN_ID$'
      and HUYYEUCAU = 0
      and dv.NGAYHENCLS is NULL
      and Left(B.MANHOMDICHVU,2) in ('02','03')
      <isNotEmpty prepend="" property="STATUS">
        <isEqual prepend="" property="STATUS" compareValue="False">
          and dv.TRANGTHAI = 'CHOXACNHAN' and cls.KHOADULIEU = '0'
        </isEqual>
        <isEqual prepend="" property="STATUS" compareValue="True">
          and (dv.TRANGTHAI = 'HOANTAT' or cls.KHOADULIEU = '1')
        </isEqual>
      </isNotEmpty>
      <isNotEmpty prepend="and" property="TUNGAY">
        convert(date,cls.NGAYTHUCHIEN) &gt;= convert(date,'$TUNGAY$')
      </isNotEmpty>
      <isNotEmpty prepend="and" property="DENNGAY">
        convert(date,cls.NGAYTHUCHIEN) &lt;= convert(date,'$DENNGAY$')
      </isNotEmpty>
      <isNotEmpty prepend="and" property="NOITHUCHIEN_ID">
        cls.NOITHUCHIEN_ID = $NOITHUCHIEN_ID$
      </isNotEmpty>
      <isNotEmpty prepend="and" property="TENBENHNHAN">
        (bn.TENBENHNHAN like '%' + #KEY_SEARCH# + '%' or bn.MAYTE like '%' + #KEY_SEARCH# + '%')
      </isNotEmpty>
      ) data1) lst
      <isNotEmpty prepend="" property="FROMROW">
        where
        lst.ROWNUMBER between $FROMROW$ and $TOROW$
      </isNotEmpty>
      order by NGAYGIOTHUCHIEN asc
    </statement>
  </statements>
</sqlMap>
