--------------------------------------------------------------------------------
2019-12-17 11:11:01,488 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2019-12-17 11:11:01,759 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-12-17 11:11:01,798 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-12-17 11:11:02,640 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-17 11:11:03,034 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-12-17 11:11:10,174 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2019-12-17 11:11:10,203 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-12-17 11:11:16,662 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-12-17 11:11:16,741 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-12-17 11:11:18,060 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2019-12-17 11:11:19,580 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2019-12-17 11:11:19,727 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2019-12-17 11:11:19,810 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2019-12-17 11:11:19,908 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2019-12-17 11:11:20,002 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2019-12-17 11:11:20,090 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2019-12-17 11:11:20,252 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2019-12-17 11:11:20,333 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2019-12-17 11:11:20,881 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2019-12-17 11:11:20,942 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2019-12-17 11:11:21,032 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2019-12-17 11:11:21,063 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2019-12-17 11:11:24,186 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2019-12-17 11:11:24,232 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @NGUONDUOC_MACDINH varchar(5) = '0';        declare @TOAMUANGOAI int = 0;        select @NGUONDUOC_MACDINH = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'PHA_NGUONDUOC'        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + @NGUONDUOC_MACDINH as DUOC_KEY, 0 as PHAMVI_ID, @NGUONDUOC_MACDINH as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end        else        begin                  select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2019-12-17 11:11:26,706 [5] DEBUG - Statement Id: [DAO00320_GetList] PreparedStatement : [select M.*            from TM_MAU M            LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID            where            M.TAMNGUNG = '0'            and M.BENHVIEN_ID = 'HLU01'            order by M.TENMAU]
2019-12-17 11:11:26,790 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2019-12-17 11:11:26,826 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,        SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH        FROM TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID        WHERE TK.SOLUONG > 0        GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2019-12-17 11:11:26,952 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2019-12-17 11:11:26,983 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,        TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,        TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH        from TM_MAU M        JOIN        (        select        A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO        from        (        select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO        from TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'        where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0        ) A        )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2019-12-17 11:11:27,056 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2019-12-17 11:11:27,993 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-17 11:11:30,588 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2019-12-17 11:11:39,344 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2019-12-17 11:11:39,375 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2019-12-17 11:11:39,455 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-17 11:11:39,597 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-17 11:11:39,891 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2019-12-17 11:11:39,893 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-12-17 11:11:39,893 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-12-17 11:11:39,926 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2019-12-17 11:11:39,926 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-12-17 11:11:39,926 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-12-17 11:11:40,108 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-17 11:11:40,280 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-17 11:12:00,297 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-17 11:12:00,468 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2019-12-17 11:12:00,841 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2019-12-17 11:15:18,093 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'ADM15'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-17 11:15:23,797 [1] DEBUG - Statement Id: [DAO00008_GetFormMenuList] PreparedStatement : [select            F.HOSPITAL_ID,            F.NAME,            F.CLASS,            F.ASSEMBLY,            F.TITLE_VI as TITLE_FORM,            ISNULL(M.ACTIVE,0) AS ACTIVE,            M.TITLE_VI as TITLE            from TM_SYS_FORM AS F            left join TM_SYS_MENU AS M ON M.SCREEN = F.NAME AND M.HOSPITAL_ID = F.HOSPITAL_ID            where F.HOSPITAL_ID = 'HLU01'            ORDER BY ISNULL(M.ACTIVE,0) DESC]
2019-12-17 11:16:22,972 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'ADM18'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-17 11:16:23,761 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM98'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-17 11:16:44,077 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2019-12-17 11:16:44,105 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-12-17 11:16:44,132 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-12-17 11:16:44,245 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-17 11:16:44,324 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-12-17 11:16:49,926 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2019-12-17 11:16:50,551 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-12-17 11:16:53,729 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-12-17 11:16:53,809 [18] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-12-17 11:16:54,257 [18] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2019-12-17 11:16:54,344 [18] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2019-12-17 11:16:54,423 [18] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2019-12-17 11:16:54,496 [18] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2019-12-17 11:16:54,587 [18] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2019-12-17 11:16:54,674 [18] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2019-12-17 11:16:54,754 [18] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2019-12-17 11:16:54,829 [18] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2019-12-17 11:16:54,903 [18] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2019-12-17 11:16:55,402 [18] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2019-12-17 11:16:55,434 [18] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2019-12-17 11:16:55,504 [18] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2019-12-17 11:16:55,541 [18] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2019-12-17 11:16:56,692 [18] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2019-12-17 11:16:56,727 [18] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @NGUONDUOC_MACDINH varchar(5) = '0';        declare @TOAMUANGOAI int = 0;        select @NGUONDUOC_MACDINH = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'PHA_NGUONDUOC'        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + @NGUONDUOC_MACDINH as DUOC_KEY, 0 as PHAMVI_ID, @NGUONDUOC_MACDINH as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end        else        begin                  select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2019-12-17 11:16:58,816 [18] DEBUG - Statement Id: [DAO00320_GetList] PreparedStatement : [select M.*            from TM_MAU M            LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID            where            M.TAMNGUNG = '0'            and M.BENHVIEN_ID = 'HLU01'            order by M.TENMAU]
2019-12-17 11:16:58,885 [18] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2019-12-17 11:16:58,918 [18] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,        SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH        FROM TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID        WHERE TK.SOLUONG > 0        GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2019-12-17 11:16:58,990 [18] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2019-12-17 11:16:59,034 [18] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,        TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,        TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH        from TM_MAU M        JOIN        (        select        A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO        from        (        select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO        from TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'        where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0        ) A        )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2019-12-17 11:16:59,167 [18] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2019-12-17 11:17:00,081 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-17 11:17:01,203 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2019-12-17 11:17:01,590 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2019-12-17 11:17:01,615 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2019-12-17 11:17:01,692 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-17 11:17:01,826 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-17 11:17:01,893 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2019-12-17 11:17:01,893 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-12-17 11:17:01,893 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-12-17 11:17:01,919 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2019-12-17 11:17:01,919 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-12-17 11:17:01,919 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-12-17 11:17:02,019 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-17 11:17:02,129 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-17 11:17:03,724 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-17 11:17:03,795 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2019-12-17 11:17:04,041 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
--------------------------------------------------------------------------------
2019-12-17 11:19:37,586 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2019-12-17 11:19:37,875 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-12-17 11:19:37,919 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-12-17 11:19:38,602 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-17 11:19:38,970 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-12-17 11:19:44,398 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2019-12-17 11:19:44,425 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-12-17 11:19:46,138 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-12-17 11:19:46,652 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-12-17 11:19:47,719 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2019-12-17 11:19:47,965 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2019-12-17 11:19:48,044 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2019-12-17 11:19:48,124 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2019-12-17 11:19:48,202 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2019-12-17 11:19:48,277 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2019-12-17 11:19:48,422 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2019-12-17 11:19:48,498 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2019-12-17 11:19:48,575 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2019-12-17 11:19:49,081 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2019-12-17 11:19:49,112 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2019-12-17 11:19:49,247 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2019-12-17 11:19:49,287 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2019-12-17 11:19:50,915 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2019-12-17 11:19:50,961 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @NGUONDUOC_MACDINH varchar(5) = '0';        declare @TOAMUANGOAI int = 0;        select @NGUONDUOC_MACDINH = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'PHA_NGUONDUOC'        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + @NGUONDUOC_MACDINH as DUOC_KEY, 0 as PHAMVI_ID, @NGUONDUOC_MACDINH as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end        else        begin                  select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2019-12-17 11:19:52,601 [5] DEBUG - Statement Id: [DAO00320_GetList] PreparedStatement : [select M.*            from TM_MAU M            LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID            where            M.TAMNGUNG = '0'            and M.BENHVIEN_ID = 'HLU01'            order by M.TENMAU]
2019-12-17 11:19:52,662 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2019-12-17 11:19:52,698 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,        SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH        FROM TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID        WHERE TK.SOLUONG > 0        GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2019-12-17 11:19:52,768 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2019-12-17 11:19:52,799 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,        TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,        TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH        from TM_MAU M        JOIN        (        select        A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO        from        (        select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO        from TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'        where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0        ) A        )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2019-12-17 11:19:52,867 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2019-12-17 11:19:53,795 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-17 11:19:55,824 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2019-12-17 11:20:03,069 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2019-12-17 11:20:03,108 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2019-12-17 11:20:03,189 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-17 11:20:03,307 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-17 11:20:03,552 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2019-12-17 11:20:03,555 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-12-17 11:20:03,555 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-12-17 11:20:03,585 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2019-12-17 11:20:03,585 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-12-17 11:20:03,585 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-12-17 11:20:03,720 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-17 11:20:03,897 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-17 11:20:16,332 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-17 11:20:16,448 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2019-12-17 11:20:16,855 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2019-12-17 11:27:05,113 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'ADM15'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-17 11:27:12,749 [1] DEBUG - Statement Id: [DAO00008_GetFormMenuList] PreparedStatement : [select            F.HOSPITAL_ID,            F.NAME,            F.CLASS,            F.ASSEMBLY,            F.TITLE_VI as TITLE_FORM,            ISNULL(M.ACTIVE,0) AS ACTIVE,            M.TITLE_VI as TITLE            from TM_SYS_FORM AS F            left join TM_SYS_MENU AS M ON M.SCREEN = F.NAME AND M.HOSPITAL_ID = F.HOSPITAL_ID            where F.HOSPITAL_ID = 'HLU01'            ORDER BY ISNULL(M.ACTIVE,0) DESC]
2019-12-17 11:28:06,781 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'ADM18'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-17 11:28:07,713 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM98'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-17 11:28:27,685 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2019-12-17 11:28:27,862 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-12-17 11:28:27,905 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-12-17 11:28:28,018 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-17 11:28:28,096 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-12-17 11:28:33,916 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2019-12-17 11:28:34,017 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-12-17 11:28:35,321 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-12-17 11:28:35,395 [17] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-12-17 11:28:35,829 [17] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2019-12-17 11:28:35,945 [17] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2019-12-17 11:28:36,017 [17] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2019-12-17 11:28:36,089 [17] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2019-12-17 11:28:36,172 [17] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2019-12-17 11:28:36,244 [17] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2019-12-17 11:28:36,349 [17] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2019-12-17 11:28:36,425 [17] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2019-12-17 11:28:36,499 [17] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2019-12-17 11:28:36,997 [17] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2019-12-17 11:28:37,030 [17] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2019-12-17 11:28:37,100 [17] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2019-12-17 11:28:37,168 [17] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2019-12-17 11:28:37,881 [17] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2019-12-17 11:28:37,912 [17] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @NGUONDUOC_MACDINH varchar(5) = '0';        declare @TOAMUANGOAI int = 0;        select @NGUONDUOC_MACDINH = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'PHA_NGUONDUOC'        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + @NGUONDUOC_MACDINH as DUOC_KEY, 0 as PHAMVI_ID, @NGUONDUOC_MACDINH as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end        else        begin                  select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2019-12-17 11:28:39,929 [17] DEBUG - Statement Id: [DAO00320_GetList] PreparedStatement : [select M.*            from TM_MAU M            LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID            where            M.TAMNGUNG = '0'            and M.BENHVIEN_ID = 'HLU01'            order by M.TENMAU]
2019-12-17 11:28:40,248 [17] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2019-12-17 11:28:40,351 [17] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,        SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH        FROM TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID        WHERE TK.SOLUONG > 0        GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2019-12-17 11:28:40,472 [17] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2019-12-17 11:28:40,511 [17] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,        TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,        TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH        from TM_MAU M        JOIN        (        select        A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO        from        (        select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO        from TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'        where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0        ) A        )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2019-12-17 11:28:40,600 [17] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2019-12-17 11:28:41,512 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-17 11:28:41,583 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2019-12-17 11:28:41,636 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2019-12-17 11:28:41,662 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2019-12-17 11:28:41,733 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-17 11:28:41,821 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-17 11:28:41,905 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2019-12-17 11:28:41,905 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-12-17 11:28:41,905 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-12-17 11:28:41,931 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2019-12-17 11:28:41,931 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-12-17 11:28:41,931 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-12-17 11:28:42,005 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-17 11:28:42,112 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-17 11:28:43,679 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-17 11:28:43,741 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2019-12-17 11:28:43,909 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2019-12-17 11:29:14,874 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM31'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-17 11:29:15,046 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM68'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-17 11:29:51,158 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'ORM28'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
--------------------------------------------------------------------------------
2019-12-17 11:31:19,201 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2019-12-17 11:31:20,760 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-12-17 11:31:20,798 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-12-17 11:31:21,153 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-17 11:31:21,509 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-12-17 11:31:29,086 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2019-12-17 11:31:29,115 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-12-17 11:31:30,783 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-12-17 11:31:30,916 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-12-17 11:31:31,771 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2019-12-17 11:31:31,961 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2019-12-17 11:31:32,071 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2019-12-17 11:31:32,147 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2019-12-17 11:31:32,217 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2019-12-17 11:31:32,291 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2019-12-17 11:31:32,403 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2019-12-17 11:31:32,474 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2019-12-17 11:31:32,547 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2019-12-17 11:31:33,054 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2019-12-17 11:31:33,093 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2019-12-17 11:31:33,171 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2019-12-17 11:31:33,204 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2019-12-17 11:31:33,915 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2019-12-17 11:31:33,948 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @NGUONDUOC_MACDINH varchar(5) = '0';        declare @TOAMUANGOAI int = 0;        select @NGUONDUOC_MACDINH = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'PHA_NGUONDUOC'        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + @NGUONDUOC_MACDINH as DUOC_KEY, 0 as PHAMVI_ID, @NGUONDUOC_MACDINH as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end        else        begin                  select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2019-12-17 11:31:36,438 [5] DEBUG - Statement Id: [DAO00320_GetList] PreparedStatement : [select M.*            from TM_MAU M            LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID            where            M.TAMNGUNG = '0'            and M.BENHVIEN_ID = 'HLU01'            order by M.TENMAU]
2019-12-17 11:31:36,504 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2019-12-17 11:31:36,539 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,        SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH        FROM TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID        WHERE TK.SOLUONG > 0        GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2019-12-17 11:31:36,665 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2019-12-17 11:31:36,695 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,        TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,        TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH        from TM_MAU M        JOIN        (        select        A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO        from        (        select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO        from TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'        where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0        ) A        )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2019-12-17 11:31:36,812 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2019-12-17 11:31:37,733 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-17 11:31:38,595 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2019-12-17 11:31:44,476 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2019-12-17 11:31:44,506 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2019-12-17 11:31:44,624 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-17 11:31:44,967 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-17 11:31:45,237 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2019-12-17 11:31:45,240 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-12-17 11:31:45,240 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-12-17 11:31:45,270 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2019-12-17 11:31:45,270 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-12-17 11:31:45,270 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-12-17 11:31:45,427 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-17 11:31:45,634 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-17 11:31:54,533 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-17 11:31:54,633 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2019-12-17 11:31:54,896 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2019-12-17 11:32:01,869 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM31'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-17 11:32:02,046 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'IPD80'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-17 11:33:38,698 [1] DEBUG - Statement Id: [DAO00068_GetTTBenhAnByBenhNhanID] PreparedStatement : [select TOP (1) tn.TIEPNHAN_ID, BENHAN_ID, ba.TRANGTHAI              from TT_TIEPNHAN tn              left join TT_NOITRU_BENHAN ba              on tn.TIEPNHAN_ID = ba.TIEPNHAN_ID              where tn.BENHNHAN_ID = '23317'              order by tn.NGAYTAO desc]
2019-12-17 11:33:48,098 [1] DEBUG - Statement Id: [DAO00068_GetTTBenhAnByBenhNhanID] PreparedStatement : [select TOP (1) tn.TIEPNHAN_ID, BENHAN_ID, ba.TRANGTHAI              from TT_TIEPNHAN tn              left join TT_NOITRU_BENHAN ba              on tn.TIEPNHAN_ID = ba.TIEPNHAN_ID              where tn.BENHNHAN_ID = '21637'              order by tn.NGAYTAO desc]
2019-12-17 11:33:53,217 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'IPD02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-17 11:33:53,648 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'IPD40'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-17 11:33:53,965 [1] DEBUG - Statement Id: [DAO00069_GetCountDanhSachNoiTru] PreparedStatement : [select count(A.SOBENHAN) as TOTALROWS        from TT_NOITRU_BENHAN A        inner join TT_TIEPNHAN B on B.TIEPNHAN_ID = A.TIEPNHAN_ID and (B.TRANGTHAI = 'NOITRU' or B.TRANGTHAI = 'HOANTHANH')        inner join TT_BENHNHAN C on C.BENHNHAN_ID = B.BENHNHAN_ID        left join TT_NOITRU_LUUTRU D on D.BENHAN_ID = A.BENHAN_ID        and D.LUUTRU_ID = ( select top 1 LUUTRU_ID from TT_NOITRU_LUUTRU where BENHAN_ID = A.BENHAN_ID order by BENHAN_ID desc)        left join TT_NOITRU_XACNHAN E on E.BENHAN_ID = A.BENHAN_ID        left join TT_NOITRU_LUUTRUCHITIET F on D.LUUTRU_ID = F.LUUTRU_ID and F.LUUTRUCHITIET_CURRENT = '1'        and F.LUUTRUCHITIET_ID in (select top 1 LUUTRUCHITIET_ID from TT_NOITRU_LUUTRUCHITIET where LUUTRU_ID = D.LUUTRU_ID order by LUUTRUCHITIET_ID desc)        where        A.KHOACHUYENDEN_ID is not null  and        (E.TRANGTHAI = 'DAXACNHAN' OR E.TRANGTHAI = 'HUYXACNHAN')         and           cast(A.NGAYVAOKHOA as date) <= cast('12/17/2019 12:00:00 AM' as date)                 and B.BENHVIEN_ID = 'HLU01' and A.KHOACHUYENDEN_ID = '32'          AND             A.TRANGTHAI in ('DANGDIEUTRI')]
2019-12-17 11:33:54,168 [1] DEBUG - Statement Id: [DAO00069_GetDanhSachNoiTru] PreparedStatement : [select * from        (        SELECT ROW_NUMBER() OVER(order by B.SOTIEPNHAN) as ROWNUMBER,          A.SOBENHAN, A.BENHAN_ID, A.SOLUUTRU                 , E.NOILAP_ID as KHOAVAO_ID        , A.TRANGTHAI, IsNull(A.BACSIDIEUTRI_ID, E.BACSICHIDINH_ID) as BACSIDIEUTRI_ID,        B.TIEPNHAN_ID, B.SOTIEPNHAN, B.SOBHYT as SOTHE, B.DOITUONG_ID, A.NGAYVAOKHOA as NGAYCAPCUU, A.THOIGIANVAOKHOA as THOIGIANCAPCUU,        C.TENBENHNHAN, C.NGAYSINH, C.NAMSINH, C.BENHNHAN_ID, C.MAYTE, F.GIUONGBENH_ID, A.THOIGIANRAVIEN    , DIACHITHUONGTRU, DANTOC_ID        ,BENHVIEN_STT_ID                from TT_NOITRU_BENHAN A        inner join TT_TIEPNHAN B on B.TIEPNHAN_ID = A.TIEPNHAN_ID and (B.TRANGTHAI = 'NOITRU' or B.TRANGTHAI = 'HOANTHANH')        inner join TT_BENHNHAN C on C.BENHNHAN_ID = B.BENHNHAN_ID        left join TT_NOITRU_LUUTRU D on D.BENHAN_ID = A.BENHAN_ID        and D.LUUTRU_ID = ( select top 1 LUUTRU_ID from TT_NOITRU_LUUTRU where BENHAN_ID = A.BENHAN_ID order by LUUTRU_ID desc)        left join TT_NOITRU_XACNHAN E on E.BENHAN_ID = A.BENHAN_ID        left join TT_NOITRU_LUUTRUCHITIET F on D.LUUTRU_ID = F.LUUTRU_ID and F.LUUTRUCHITIET_CURRENT = '1'        and F.LUUTRUCHITIET_ID in (select top 1 LUUTRUCHITIET_ID from TT_NOITRU_LUUTRUCHITIET where LUUTRU_ID = D.LUUTRU_ID order by LUUTRUCHITIET_ID desc)        left join (select MABENHVIEN, BENHVIEN_STT_ID from TM_BENHVIEN) H on SUBSTRING(B.SOBHYT, 16, 5)=H.MABENHVIEN        where        A.KHOACHUYENDEN_ID is not null  and        (E.TRANGTHAI = 'DAXACNHAN' OR E.TRANGTHAI = 'HUYXACNHAN')         and           cast(A.NGAYVAOKHOA as date) <= cast('12/17/2019 12:00:00 AM' as date)                 and B.BENHVIEN_ID = 'HLU01' and A.KHOACHUYENDEN_ID = '32'          AND             A.TRANGTHAI in ('DANGDIEUTRI')                   ) lst        where        lst.ROWNUMBER between 1 and 5        order by lst.SOTIEPNHAN]
2019-12-17 11:33:55,453 [1] DEBUG - Statement Id: [DAO00069_GetCountDanhSachNoiTru] PreparedStatement : [select count(A.SOBENHAN) as TOTALROWS        from TT_NOITRU_BENHAN A        inner join TT_TIEPNHAN B on B.TIEPNHAN_ID = A.TIEPNHAN_ID and (B.TRANGTHAI = 'NOITRU' or B.TRANGTHAI = 'HOANTHANH')        inner join TT_BENHNHAN C on C.BENHNHAN_ID = B.BENHNHAN_ID        left join TT_NOITRU_LUUTRU D on D.BENHAN_ID = A.BENHAN_ID        and D.LUUTRU_ID = ( select top 1 LUUTRU_ID from TT_NOITRU_LUUTRU where BENHAN_ID = A.BENHAN_ID order by BENHAN_ID desc)        left join TT_NOITRU_XACNHAN E on E.BENHAN_ID = A.BENHAN_ID        left join TT_NOITRU_LUUTRUCHITIET F on D.LUUTRU_ID = F.LUUTRU_ID and F.LUUTRUCHITIET_CURRENT = '1'        and F.LUUTRUCHITIET_ID in (select top 1 LUUTRUCHITIET_ID from TT_NOITRU_LUUTRUCHITIET where LUUTRU_ID = D.LUUTRU_ID order by LUUTRUCHITIET_ID desc)        where        A.KHOACHUYENDEN_ID is not null  and        (E.TRANGTHAI = 'DAXACNHAN' OR E.TRANGTHAI = 'HUYXACNHAN')         and           cast(A.NGAYVAOKHOA as date) <= cast('12/17/2019 12:00:00 AM' as date)                 and B.BENHVIEN_ID = 'HLU01' and A.KHOACHUYENDEN_ID = '32'          AND             A.TRANGTHAI in ('DANGDIEUTRI')]
2019-12-17 11:33:55,626 [1] DEBUG - Statement Id: [DAO00069_GetDanhSachNoiTru] PreparedStatement : [select * from        (        SELECT ROW_NUMBER() OVER(order by B.SOTIEPNHAN) as ROWNUMBER,          A.SOBENHAN, A.BENHAN_ID, A.SOLUUTRU                 , E.NOILAP_ID as KHOAVAO_ID        , A.TRANGTHAI, IsNull(A.BACSIDIEUTRI_ID, E.BACSICHIDINH_ID) as BACSIDIEUTRI_ID,        B.TIEPNHAN_ID, B.SOTIEPNHAN, B.SOBHYT as SOTHE, B.DOITUONG_ID, A.NGAYVAOKHOA as NGAYCAPCUU, A.THOIGIANVAOKHOA as THOIGIANCAPCUU,        C.TENBENHNHAN, C.NGAYSINH, C.NAMSINH, C.BENHNHAN_ID, C.MAYTE, F.GIUONGBENH_ID, A.THOIGIANRAVIEN    , DIACHITHUONGTRU, DANTOC_ID        ,BENHVIEN_STT_ID                from TT_NOITRU_BENHAN A        inner join TT_TIEPNHAN B on B.TIEPNHAN_ID = A.TIEPNHAN_ID and (B.TRANGTHAI = 'NOITRU' or B.TRANGTHAI = 'HOANTHANH')        inner join TT_BENHNHAN C on C.BENHNHAN_ID = B.BENHNHAN_ID        left join TT_NOITRU_LUUTRU D on D.BENHAN_ID = A.BENHAN_ID        and D.LUUTRU_ID = ( select top 1 LUUTRU_ID from TT_NOITRU_LUUTRU where BENHAN_ID = A.BENHAN_ID order by LUUTRU_ID desc)        left join TT_NOITRU_XACNHAN E on E.BENHAN_ID = A.BENHAN_ID        left join TT_NOITRU_LUUTRUCHITIET F on D.LUUTRU_ID = F.LUUTRU_ID and F.LUUTRUCHITIET_CURRENT = '1'        and F.LUUTRUCHITIET_ID in (select top 1 LUUTRUCHITIET_ID from TT_NOITRU_LUUTRUCHITIET where LUUTRU_ID = D.LUUTRU_ID order by LUUTRUCHITIET_ID desc)        left join (select MABENHVIEN, BENHVIEN_STT_ID from TM_BENHVIEN) H on SUBSTRING(B.SOBHYT, 16, 5)=H.MABENHVIEN        where        A.KHOACHUYENDEN_ID is not null  and        (E.TRANGTHAI = 'DAXACNHAN' OR E.TRANGTHAI = 'HUYXACNHAN')         and           cast(A.NGAYVAOKHOA as date) <= cast('12/17/2019 12:00:00 AM' as date)                 and B.BENHVIEN_ID = 'HLU01' and A.KHOACHUYENDEN_ID = '32'          AND             A.TRANGTHAI in ('DANGDIEUTRI')                   ) lst        where        lst.ROWNUMBER between 1 and 5        order by lst.SOTIEPNHAN]
2019-12-17 11:33:58,011 [1] DEBUG - Statement Id: [DAO00069_GetCountDanhSachNoiTru] PreparedStatement : [select count(A.SOBENHAN) as TOTALROWS        from TT_NOITRU_BENHAN A        inner join TT_TIEPNHAN B on B.TIEPNHAN_ID = A.TIEPNHAN_ID and (B.TRANGTHAI = 'NOITRU' or B.TRANGTHAI = 'HOANTHANH')        inner join TT_BENHNHAN C on C.BENHNHAN_ID = B.BENHNHAN_ID        left join TT_NOITRU_LUUTRU D on D.BENHAN_ID = A.BENHAN_ID        and D.LUUTRU_ID = ( select top 1 LUUTRU_ID from TT_NOITRU_LUUTRU where BENHAN_ID = A.BENHAN_ID order by BENHAN_ID desc)        left join TT_NOITRU_XACNHAN E on E.BENHAN_ID = A.BENHAN_ID        left join TT_NOITRU_LUUTRUCHITIET F on D.LUUTRU_ID = F.LUUTRU_ID and F.LUUTRUCHITIET_CURRENT = '1'        and F.LUUTRUCHITIET_ID in (select top 1 LUUTRUCHITIET_ID from TT_NOITRU_LUUTRUCHITIET where LUUTRU_ID = D.LUUTRU_ID order by LUUTRUCHITIET_ID desc)        where        A.KHOACHUYENDEN_ID is not null  and        (E.TRANGTHAI = 'DAXACNHAN' OR E.TRANGTHAI = 'HUYXACNHAN')         and           cast(A.NGAYVAOKHOA as date) <= cast('12/17/2019 12:00:00 AM' as date)                 and B.BENHVIEN_ID = 'HLU01' and A.KHOACHUYENDEN_ID = '32'          AND             A.TRANGTHAI in ('DANGDIEUTRI')]
2019-12-17 11:33:58,185 [1] DEBUG - Statement Id: [DAO00069_GetDanhSachNoiTru] PreparedStatement : [select * from        (        SELECT ROW_NUMBER() OVER(order by B.SOTIEPNHAN) as ROWNUMBER,          A.SOBENHAN, A.BENHAN_ID, A.SOLUUTRU                 , E.NOILAP_ID as KHOAVAO_ID        , A.TRANGTHAI, IsNull(A.BACSIDIEUTRI_ID, E.BACSICHIDINH_ID) as BACSIDIEUTRI_ID,        B.TIEPNHAN_ID, B.SOTIEPNHAN, B.SOBHYT as SOTHE, B.DOITUONG_ID, A.NGAYVAOKHOA as NGAYCAPCUU, A.THOIGIANVAOKHOA as THOIGIANCAPCUU,        C.TENBENHNHAN, C.NGAYSINH, C.NAMSINH, C.BENHNHAN_ID, C.MAYTE, F.GIUONGBENH_ID, A.THOIGIANRAVIEN    , DIACHITHUONGTRU, DANTOC_ID        ,BENHVIEN_STT_ID                from TT_NOITRU_BENHAN A        inner join TT_TIEPNHAN B on B.TIEPNHAN_ID = A.TIEPNHAN_ID and (B.TRANGTHAI = 'NOITRU' or B.TRANGTHAI = 'HOANTHANH')        inner join TT_BENHNHAN C on C.BENHNHAN_ID = B.BENHNHAN_ID        left join TT_NOITRU_LUUTRU D on D.BENHAN_ID = A.BENHAN_ID        and D.LUUTRU_ID = ( select top 1 LUUTRU_ID from TT_NOITRU_LUUTRU where BENHAN_ID = A.BENHAN_ID order by LUUTRU_ID desc)        left join TT_NOITRU_XACNHAN E on E.BENHAN_ID = A.BENHAN_ID        left join TT_NOITRU_LUUTRUCHITIET F on D.LUUTRU_ID = F.LUUTRU_ID and F.LUUTRUCHITIET_CURRENT = '1'        and F.LUUTRUCHITIET_ID in (select top 1 LUUTRUCHITIET_ID from TT_NOITRU_LUUTRUCHITIET where LUUTRU_ID = D.LUUTRU_ID order by LUUTRUCHITIET_ID desc)        left join (select MABENHVIEN, BENHVIEN_STT_ID from TM_BENHVIEN) H on SUBSTRING(B.SOBHYT, 16, 5)=H.MABENHVIEN        where        A.KHOACHUYENDEN_ID is not null  and        (E.TRANGTHAI = 'DAXACNHAN' OR E.TRANGTHAI = 'HUYXACNHAN')         and           cast(A.NGAYVAOKHOA as date) <= cast('12/17/2019 12:00:00 AM' as date)                 and B.BENHVIEN_ID = 'HLU01' and A.KHOACHUYENDEN_ID = '32'          AND             A.TRANGTHAI in ('DANGDIEUTRI')                   ) lst        where        lst.ROWNUMBER between 41 and 45        order by lst.SOTIEPNHAN]
2019-12-17 11:33:59,467 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'IPD03'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-17 11:34:02,648 [1] DEBUG - Statement Id: [DAO00080_KiemtraBenhAnDaThanhToan] PreparedStatement : [select DAXACNHANDOANHTHU        from TT_NOITRU_BENHAN where        BENHAN_ID = '5855'        and BENHVIEN_ID = 'HLU01'        Order By BENHAN_ID Desc]
2019-12-17 11:34:02,792 [1] DEBUG - Statement Id: [DAO00061_GetBenhAnDetailByID] PreparedStatement : [select A.*, B.NOIGIOITHIEU_ID, C.KHOADIEUTRI_ID, A.ICD_BENHCHINH AS ICD_BENHCHINH_BAK, A.CDRAVIEN_CHINH AS CHANDOANRAVIEN1, B.THOIGIANTIEPNHAN        , A.CDRAVIEN_CHINH AS CHANDOANRAVIEN_BAK        from TT_NOITRU_BENHAN A        left join TT_TIEPNHAN B on B.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TT_NOITRU_NHAPVIEN C on C.TIEPNHAN_ID = B.TIEPNHAN_ID        where A.BENHAN_ID = '5855']
2019-12-17 11:34:02,893 [1] DEBUG - Statement Id: [DAO00080_GetNoiTruLuuTruBenhAn] PreparedStatement : [select *        from TT_NOITRU_LUUTRU where        BENHAN_ID = '5855'        and BENHVIEN_ID = 'HLU01'        Order By LUUTRU_ID ASC]
2019-12-17 11:34:02,990 [1] DEBUG - Statement Id: [DAO00080_GetGiuongBenhCuaBenhAn] PreparedStatement : [select *        from TT_NOITRU_GIUONGBENH where        BENHAN_ID =  @param0]
2019-12-17 11:34:02,990 [1] DEBUG - Statement Id: [DAO00080_GetGiuongBenhCuaBenhAn] Parameters: [@param0=[BENHAN_ID,5855]]
2019-12-17 11:34:02,990 [1] DEBUG - Statement Id: [DAO00080_GetGiuongBenhCuaBenhAn] Types: [@param0=[Int64, System.Int64]]
2019-12-17 11:34:03,308 [1] DEBUG - Statement Id: [DAO00064_TT_VIENPHI_GetList_NoiTRu] PreparedStatement : [select count(*) as TOTALROWS from TT_VIENPHI A        where        A.BENHAN_ID = '5855' and ACTIVE = '1']
2019-12-17 11:34:03,477 [1] DEBUG - Statement Id: [DAO00013_GetDetailP] PreparedStatement : [select *        from TT_BENHNHAN         WHERE              TT_BENHNHAN.MAYTE  = '190029157']
2019-12-17 11:34:03,664 [1] DEBUG - Statement Id: [DAO00061_GetBenhAnDetailByID] PreparedStatement : [select A.*, B.NOIGIOITHIEU_ID, C.KHOADIEUTRI_ID, A.ICD_BENHCHINH AS ICD_BENHCHINH_BAK, A.CDRAVIEN_CHINH AS CHANDOANRAVIEN1, B.THOIGIANTIEPNHAN        , A.CDRAVIEN_CHINH AS CHANDOANRAVIEN_BAK        from TT_NOITRU_BENHAN A        left join TT_TIEPNHAN B on B.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TT_NOITRU_NHAPVIEN C on C.TIEPNHAN_ID = B.TIEPNHAN_ID        where A.BENHAN_ID = '5855']
2019-12-17 11:34:03,849 [1] DEBUG - Statement Id: [DAO00080_GetNoiTruBenhAnChiTiet] PreparedStatement : [select *        from TT_NOITRU_BENHAN_CHITIET where        BENHAN_ID = '5855'        and BENHVIEN_ID = 'HLU01'        Order By BENHANCHITIET_ID DESC]
2019-12-17 11:34:04,022 [1] DEBUG - Statement Id: [DAO00080_GetNoiTruLuuTruBenhAn] PreparedStatement : [select *        from TT_NOITRU_LUUTRU where        BENHAN_ID = '5855'        and BENHVIEN_ID = 'HLU01'        Order By LUUTRU_ID ASC]
2019-12-17 11:34:06,277 [1] DEBUG - Statement Id: [DAO00080_GetGiuongBenhCuaBenhAn] PreparedStatement : [select *        from TT_NOITRU_GIUONGBENH where        BENHAN_ID =  @param0]
2019-12-17 11:34:06,277 [1] DEBUG - Statement Id: [DAO00080_GetGiuongBenhCuaBenhAn] Parameters: [@param0=[BENHAN_ID,5855]]
2019-12-17 11:34:06,277 [1] DEBUG - Statement Id: [DAO00080_GetGiuongBenhCuaBenhAn] Types: [@param0=[Int64, System.Int64]]
2019-12-17 11:34:06,383 [1] DEBUG - Statement Id: [DAO00087_GetServiceParams] PreparedStatement : [select CODE, VALUE              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01']
2019-12-17 11:34:06,498 [1] DEBUG - Statement Id: [DAO00067_laytrangthaibenhannoitru] PreparedStatement : [select isnull(TRANGTHAI, '') TRANGTHAI from TT_NOITRU_BENHAN where BENHAN_ID =  @param0]
2019-12-17 11:34:06,498 [1] DEBUG - Statement Id: [DAO00067_laytrangthaibenhannoitru] Parameters: [@param0=[BENHAN_ID,5855]]
2019-12-17 11:34:06,498 [1] DEBUG - Statement Id: [DAO00067_laytrangthaibenhannoitru] Types: [@param0=[Int64, System.Int64]]
2019-12-17 11:34:06,525 [1] DEBUG - Statement Id: [DAO00067_ClearDataVienPhi] PreparedStatement : [delete from TT_VIENPHI where TIEPNHAN_ID = 27372 and REF_ID = 0           and             BENHAN_ID = '5855'                     update TT_VIENPHI set SOLUONG = 0          where REF_TABLE = 'TT_DVYEUCAU' and TIEPNHAN_ID =  @param0           and not exists (select DVYEUCAU_ID from TT_DVYEUCAU where TT_VIENPHI.REF_ID = DVYEUCAU_ID and TIEPNHAN_ID =  @param0 )                       update TT_VIENPHI set SOLUONG = 0          where REF_TABLE = 'TT_NGOAITRU_TOATHUOC'          and TIEPNHAN_ID =  @param0           and HOADON_ID is null and TIEPNHAN_ID =  @param0           and not exists (select TOATHUOC_ID from TT_NGOAITRU_TOATHUOC where TT_VIENPHI.REF_ID = TOATHUOC_ID and TIEPNHAN_ID =  @param0 )                          update TT_VIENPHI            set SOLUONG = (TraThuoc.SOLUONG - TraThuoc.SOLUONG_NGUNG)            from (select distinct nttt.SOLUONG, ttct.TOATHUOC_ID, ttct.DUOC_ID , ttct.SOLUONG SOLUONG_NGUNG            from TT_NOITRU_TRATHUOC_CHITIET ttct            left join TT_NOITRU_TRATHUOC tt on tt.TRATHUOC_ID = ttct.TRATHUOC_ID            left join TT_NOITRU_TOATHUOC nttt on nttt.TOATHUOC_ID = ttct.TOATHUOC_ID            where tt.BENHAN_ID =  @param1 ) TraThuoc            where TT_VIENPHI.REF_ID = TraThuoc.TOATHUOC_ID and TT_VIENPHI.DUOC_ID = TraThuoc.DUOC_ID            and TT_VIENPHI.REF_TABLE = 'TT_NOITRU_TOATHUOC' and TT_VIENPHI.BENHAN_ID =  @param1             and TT_VIENPHI.SOLUONG > (TraThuoc.SOLUONG - TraThuoc.SOLUONG_NGUNG)                         update TT_VIENPHI set SOLUONG = 0            where REF_TABLE = 'TT_NOITRU_TOATHUOC'            and TIEPNHAN_ID =  @param0             and KHAMBENH_ID not in (select KHAMBENH_ID from TT_NOITRU_TOATHUOC where TIEPNHAN_ID =  @param0 )            and HOADON_ID is null and BENHAN_ID =  @param1                    delete TT_DUOC_TONKHO_BOOK_NOITRU where REF_TABLE = 'TT_NOITRU_TOATHUOC' and (REF_ID is null or REF_ID = 0)        delete TT_DUOC_TONKHO_BOOK_NGOAITRU where REF_ID is null or REF_ID = 0                      update TT_VIENPHI          set BENHAN_ID =  @param1           from (select TOATHUOC_ID from TT_NOITRU_TOATHUOC where TIEPNHAN_ID =  @param0 ) nttt          where REF_TABLE = 'TT_NOITRU_TOATHUOC' and REF_ID = nttt.TOATHUOC_ID and isnull(BENHAN_ID, 0) = 0          and TIEPNHAN_ID =  @param0             update TT_VIENPHI          set TT_VIENPHI.BENHAN_ID =  @param1           from (select DVYEUCAU_ID, BENHAN_ID from TT_DVYEUCAU where TIEPNHAN_ID =  @param0 ) nttt          where TT_VIENPHI.REF_TABLE = 'TT_DVYEUCAU' and TT_VIENPHI.REF_ID = nttt.DVYEUCAU_ID          and isnull(TT_VIENPHI.BENHAN_ID, 0) = 0 and isnull(nttt.BENHAN_ID, 0) > 0          and TT_VIENPHI.TIEPNHAN_ID =  @param0                     update TT_VIENPHI set          THANHTIEN_DOANHTHU = 0, BHYT_THANHTIEN = 0, BHYT_THANHTIEN_CHITRA = 0          , GIATRI_BENHNHAN_DATHANHTOAN = 0, BENHNHAN_PHAITHANHTOAN = 0          where TIEPNHAN_ID = 27372 and SOLUONG = 0           and             BENHAN_ID = 5855                       update TT_VIENPHI set          GIATRI_BENHNHAN_DATHANHTOAN = 0          where TIEPNHAN_ID = '27372' and GIATRI_BENHNHAN_DATHANHTOAN is null            update TT_VIENPHI set          BENHNHAN_PHAITHANHTOAN = 0          where TIEPNHAN_ID = '27372' and BENHNHAN_PHAITHANHTOAN is null]
2019-12-17 11:34:06,525 [1] DEBUG - Statement Id: [DAO00067_ClearDataVienPhi] Parameters: [@param0=[TIEPNHAN_ID,27372], @param1=[BENHAN_ID,5855]]
2019-12-17 11:34:06,525 [1] DEBUG - Statement Id: [DAO00067_ClearDataVienPhi] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64]]
2019-12-17 11:34:07,162 [1] DEBUG - Statement Id: [DAO00064_GetlistTT_TIEPNHAN_SOTHEBHYT] PreparedStatement : [select stbhyt.*, ba.SOBENHAN,        tn.SOTIEPNHAN, tn.LOAITHANHVIEN_ID, tn.THE_ID, tn.THANHVIEN_ID,        tn.SUDUNG_BHTN, tn.BAOLANH_VIENPHI, tn.VIP, tn.NGUOINUOCNGOAI        from TT_TIEPNHAN_SOTHEBHYT stbhyt        left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = stbhyt.TIEPNHAN_ID        left join TT_NOITRU_BENHAN ba on ba.TIEPNHAN_ID = stbhyt.TIEPNHAN_ID        where        stbhyt.TIEPNHAN_ID = '27372' and isnull(stbhyt.KHONGSUDUNG, '0') = '0'         and           ba.BENHAN_ID = '5855']
2019-12-17 11:34:07,208 [1] DEBUG - Statement Id: [DAO00064_GetListVienPhiByTiepNnan] PreparedStatement : [select distinct        B.DOITUONG_ID, B.NGAYMIENDONGCHITRA, B.BENHNHAN_ID as TIEPNHAN_BENHNHAN_ID, B.TRAITUYEN,        B.BHYTTREN3NAM as TREN3NAM, B.BHYTTREN5NAM as TREN5NAM, B.SOTIEPNHAN, B.SOBENHAN,        B.LOAITHANHVIEN_ID, B.SUDUNG_BHTN, B.THE_ID, B.THANHVIEN_ID, B.BAOLANH_VIENPHI, B.VIP, B.NGUOINUOCNGOAI,        C.GIATRIMIENGIAM as GIATRIMIENGIAM, D.GIATRIMIENGIAM as GIATRIMIENGIAM_BHTN, E.GIATRIMIENGIAM as GIATRIMIENGIAM_THANHVIEN,        F.GIATRIMIENGIAM as GIATRIMIENGIAM_CONGTY, DVYC.THE_ID as DVDUNGTHE, DVYC.TRANGTHAI as TRANGTHAIDICHVU, ndv.MANHOMDICHVU,        A.* from TT_VIENPHI A        left join        (select B.*, C.SOBENHAN, C.BENHAN_ID        from TT_TIEPNHAN B        left join TT_NOITRU_BENHAN C on B.TIEPNHAN_ID = C.TIEPNHAN_ID         and           C.BENHAN_ID = '5855'                 where B.TIEPNHAN_ID = '27372') B on B.TIEPNHAN_ID = A.TIEPNHAN_ID        left join (select sum(GIATRIMIENGIAM) as GIATRIMIENGIAM, VIENPHI_ID, REF_TABLE        from TT_MIENGIAM_CHITIET        where REF_TABLE = 'TT_MIENGIAM'        and exists (select MIENGIAM_ID from TT_MIENGIAM where TT_MIENGIAM_CHITIET.MIENGIAM_ID = MIENGIAM_ID and TINHTRANG = 1 and TIEPNHAN_ID = '27372')        group by VIENPHI_ID, REF_TABLE) C on C.REF_TABLE = 'TT_MIENGIAM' and C.VIENPHI_ID = A.VIENPHI_ID        left join (select sum(GIATRIMIENGIAM) as GIATRIMIENGIAM, VIENPHI_ID, REF_TABLE        from TT_MIENGIAM_CHITIET        where REF_TABLE = 'TT_MIENGIAM_BHTN'        and exists (select MIENGIAM_BHTN_ID from TT_MIENGIAM_BHTN where TT_MIENGIAM_CHITIET.MIENGIAM_ID = MIENGIAM_BHTN_ID and  TINHTRANG = 1 and TIEPNHAN_ID = '27372')        group by VIENPHI_ID, REF_TABLE) D on D.REF_TABLE = 'TT_MIENGIAM_BHTN' and D.VIENPHI_ID = A.VIENPHI_ID        left join (select sum(GIATRIMIENGIAM) as GIATRIMIENGIAM, VIENPHI_ID, REF_TABLE        from TT_MIENGIAM_CHITIET        where REF_TABLE = 'TT_MIENGIAM_THANHVIEN'        and exists (select MIENGIAM_THANHVIEN_ID from TT_MIENGIAM_THANHVIEN where TT_MIENGIAM_CHITIET.MIENGIAM_ID = MIENGIAM_THANHVIEN_ID and TINHTRANG = 1 and TIEPNHAN_ID = '27372')        group by VIENPHI_ID, REF_TABLE) E on E.REF_TABLE = 'TT_MIENGIAM_THANHVIEN' and E.VIENPHI_ID = A.VIENPHI_ID        left join (select sum(GIATRIMIENGIAM) as GIATRIMIENGIAM, VIENPHI_ID, REF_TABLE        from TT_MIENGIAM_CHITIET        where REF_TABLE = 'TT_MIENGIAM_CONGTY'        and exists (select MIENGIAM_CONGTY_ID from TT_MIENGIAM_CONGTY where TT_MIENGIAM_CHITIET.MIENGIAM_ID = MIENGIAM_CONGTY_ID and TINHTRANG = 1 and TIEPNHAN_ID = '27372')        group by VIENPHI_ID, REF_TABLE) F on F.REF_TABLE = 'TT_MIENGIAM_CONGTY' and F.VIENPHI_ID = A.VIENPHI_ID        left join TT_DVYEUCAU DVYC on DVYC.DVYEUCAU_ID = A.REF_ID and A.REF_TABLE = 'TT_DVYEUCAU'        left join TM_DICHVU DV on DVYC.DICHVU_ID = DV.DICHVU_ID and A.REF_TABLE = 'TT_DVYEUCAU'        left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = DV.NHOMDICHVU_ID and A.REF_TABLE = 'TT_DVYEUCAU'        where        A.TIEPNHAN_ID = '27372' and ((DVYC.HUYYEUCAU = '0' and A.DICHVU_ID is not null)        or A.DUOC_ID is not null or A.REF_TABLE = 'TT_NUT_XACNHANSUATAN_CHITIET')        and A.ACTIVE = '1'         and           A.BENHAN_ID = '5855'                 and A.BENHVIEN_ID = 'HLU01'        order by A.VIENPHI_ID]
2019-12-17 11:34:07,510 [1] DEBUG - Statement Id: [DAO00080_LayLoaiBenhanCuNoitru] PreparedStatement : [select LOAIBENHAN from TT_NOITRU_BENHAN where TIEPNHAN_ID =  @param0]
2019-12-17 11:34:07,510 [1] DEBUG - Statement Id: [DAO00080_LayLoaiBenhanCuNoitru] Parameters: [@param0=[TIEPNHAN_ID,27372]]
2019-12-17 11:34:07,510 [1] DEBUG - Statement Id: [DAO00080_LayLoaiBenhanCuNoitru] Types: [@param0=[Int32, System.Int32]]
2019-12-17 11:34:07,543 [1] DEBUG - Statement Id: [DAO00006_GetListDuocTyle] PreparedStatement : [select DUOC_ID, DOITUONG_ID, (TYLE/100) as TYLE, DONGIA MUCTRAN_THANHTOAN from TM_DOITUONG_GIADUOC_TYLE            where            BENHVIEN_ID = 'HLU01'            and DOITUONG_ID = '4']
2019-12-17 11:34:07,574 [1] DEBUG - Statement Id: [DAO00027_GetListTuongTrinhDichVuPhauThuatCuaTiepNhan] PreparedStatement : [declare @ManhomDSA varchar(10);        declare @PhanLoaiNhomDV varchar(20) = '05';        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        if (@ManhomDSA is not null) set @PhanLoaiNhomDV += ',' + @ManhomDSA        select distinct ptyc.*        from TT_PHAUTHUAT_YEUCAU ptyc        inner join TM_DICHVU dv on dv.DICHVU_ID = ptyc.DICHVU_ID        inner join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID        inner join TT_PHAUTHUAT pt on pt.PHAUTHUAT_ID = ptyc.PHAUTHUAT_ID        where        pt.TIEPNHAN_ID = 27372        and (left(ndv.MANHOMDICHVU, 2) in (select * from STRING_SPLIT(@PhanLoaiNhomDV,',')) or ndv.MANHOMDICHVU in (select * from STRING_SPLIT(@PhanLoaiNhomDV,',')))]
2019-12-17 11:34:07,656 [1] DEBUG - Statement Id: [DAO00006_GetList] PreparedStatement : [select dv.*, loaiDV.MALOAIDICHVU, captren.NHOMDICHVU_ID as NHOMDICHVU_CAPTREN_ID, captren.TENNHOMDICHVU as NHOMDICHVU_CAPTREN,              nhom_dv.TENNHOMDICHVU as TENNHOMDICHVU, nhom_dv.MANHOMDICHVU,              case when dv.ATTRIBUTE5 is null then 'TT' else 'KTC' end as LOAI_CHIPHI              from TM_DICHVU as dv              left join TM_NHOMDICHVU as nhom_dv on nhom_dv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID and nhom_dv.BENHVIEN_ID = 'HLU01'              left join TM_NHOMDICHVU as captren on nhom_dv.CAPTREN_ID = captren.NHOMDICHVU_ID and captren.BENHVIEN_ID = 'HLU01'              left join TM_LOAIDICHVU loaiDV on nhom_dv.LOAIDICHVU_ID = loaiDV.LOAIDICHVU_ID and loaiDV.BENHVIEN_ID = 'HLU01'              where nhom_dv.TAMNGUNG = '0' and dv.BENHVIEN_ID = 'HLU01'              and dv.TAMNGUNG = '0'               AND                   loaiDV.MALOAIDICHVU = 'KhamBenh']
2019-12-17 11:34:07,723 [1] DEBUG - Statement Id: [DAO00027_GetDichvuYCBHYTTyle] PreparedStatement : [select DVYEUCAU_ID from TT_DVYEUCAU        where TIEPNHAN_ID = 27372 and isnull(BHYT_TYLETHANHTOAN_ID, 0) > 0]
2019-12-17 11:34:07,836 [1] DEBUG - Statement Id: [DAO00023_UpdateNhieuVP] PreparedStatement : [declare @jsonVienPhi nvarchar(max) = N'[{"VIENPHI_ID":672253,"TIEPNHAN_ID":27372,"DICHVU_ID":5445,"BENHAN_ID":5855,"SOLUONG":1.0000,"DONGIA_DOANHTHU":33000.0000,"THANHTIEN_DOANHTHU":33000.00,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":0.0,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":33000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"GB438382336470038664","SOBHYT_HUONG_ID":28400,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false},{"VIENPHI_ID":673404,"TIEPNHAN_ID":27372,"DICHVU_ID":4523,"BENHAN_ID":5855,"SOLUONG":1.0000,"DONGIA_DOANHTHU":40000.0000,"THANHTIEN_DOANHTHU":40000.00,"BHYT_TL":1.0,"BHYT_DONGIA":40000.0000,"BHYT_THANHTIEN":40000.00,"BHYT_DONGIA_CONGKHAM_DAU":0.0,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":40000.0,"BHYT_THANHTIEN_CHITRA":40000.00,"BENHNHAN_PHAITHANHTOAN":0.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"GB438382336470038664","SOBHYT_HUONG_ID":28400,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false},{"VIENPHI_ID":673405,"TIEPNHAN_ID":27372,"DICHVU_ID":4641,"BENHAN_ID":5855,"SOLUONG":1.0000,"DONGIA_DOANHTHU":21400.0000,"THANHTIEN_DOANHTHU":21400.00,"BHYT_TL":1.0,"BHYT_DONGIA":21400.0000,"BHYT_THANHTIEN":21400.00,"BHYT_DONGIA_CONGKHAM_DAU":0.0,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":21400.0,"BHYT_THANHTIEN_CHITRA":21400.00,"BENHNHAN_PHAITHANHTOAN":0.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"GB438382336470038664","SOBHYT_HUONG_ID":28400,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false},{"VIENPHI_ID":673406,"TIEPNHAN_ID":27372,"DICHVU_ID":4642,"BENHAN_ID":5855,"SOLUONG":1.0000,"DONGIA_DOANHTHU":21400.0000,"THANHTIEN_DOANHTHU":21400.00,"BHYT_TL":1.0,"BHYT_DONGIA":21400.0000,"BHYT_THANHTIEN":21400.00,"BHYT_DONGIA_CONGKHAM_DAU":0.0,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":21400.0,"BHYT_THANHTIEN_CHITRA":21400.00,"BENHNHAN_PHAITHANHTOAN":0.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"GB438382336470038664","SOBHYT_HUONG_ID":28400,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false},{"VIENPHI_ID":673407,"TIEPNHAN_ID":27372,"DICHVU_ID":4668,"BENHAN_ID":5855,"SOLUONG":1.0000,"DONGIA_DOANHTHU":21400.0000,"THANHTIEN_DOANHTHU":21400.00,"BHYT_TL":1.0,"BHYT_DONGIA":21400.0000,"BHYT_THANHTIEN":21400.00,"BHYT_DONGIA_CONGKHAM_DAU":0.0,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":21400.0,"BHYT_THANHTIEN_CHITRA":21400.00,"BENHNHAN_PHAITHANHTOAN":0.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"GB438382336470038664","SOBHYT_HUONG_ID":28400,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false},{"VIENPHI_ID":673409,"TIEPNHAN_ID":27372,"DICHVU_ID":4681,"BENHAN_ID":5855,"SOLUONG":1.0000,"DONGIA_DOANHTHU":21400.0000,"THANHTIEN_DOANHTHU":21400.00,"BHYT_TL":1.0,"BHYT_DONGIA":21400.0000,"BHYT_THANHTIEN":21400.00,"BHYT_DONGIA_CONGKHAM_DAU":0.0,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":21400.0,"BHYT_THANHTIEN_CHITRA":21400.00,"BENHNHAN_PHAITHANHTOAN":0.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"GB438382336470038664","SOBHYT_HUONG_ID":28400,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false},{"VIENPHI_ID":673410,"TIEPNHAN_ID":27372,"DICHVU_ID":4722,"BENHAN_ID":5855,"SOLUONG":1.0000,"DONGIA_DOANHTHU":21400.0000,"THANHTIEN_DOANHTHU":21400.00,"BHYT_TL":1.0,"BHYT_DONGIA":21400.0000,"BHYT_THANHTIEN":21400.00,"BHYT_DONGIA_CONGKHAM_DAU":0.0,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":21400.0,"BHYT_THANHTIEN_CHITRA":21400.00,"BENHNHAN_PHAITHANHTOAN":0.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"GB438382336470038664","SOBHYT_HUONG_ID":28400,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false},{"VIENPHI_ID":673413,"TIEPNHAN_ID":27372,"DICHVU_ID":4129,"BENHAN_ID":5855,"SOLUONG":1.0000,"DONGIA_DOANHTHU":64200.0000,"THANHTIEN_DOANHTHU":64200.00,"BHYT_TL":1.0,"BHYT_DONGIA":64200.0000,"BHYT_THANHTIEN":64200.00,"BHYT_DONGIA_CONGKHAM_DAU":0.0,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":64200.0,"BHYT_THANHTIEN_CHITRA":64200.00,"BENHNHAN_PHAITHANHTOAN":0.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"GB438382336470038664","SOBHYT_HUONG_ID":28400,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false},{"VIENPHI_ID":673414,"TIEPNHAN_ID":27372,"DICHVU_ID":4422,"BENHAN_ID":5855,"SOLUONG":1.0000,"DONGIA_DOANHTHU":32000.0000,"THANHTIEN_DOANHTHU":32000.00,"BHYT_TL":1.0,"BHYT_DONGIA":32000.0000,"BHYT_THANHTIEN":32000.00,"BHYT_DONGIA_CONGKHAM_DAU":0.0,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":32000.0,"BHYT_THANHTIEN_CHITRA":32000.00,"BENHNHAN_PHAITHANHTOAN":0.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"GB438382336470038664","SOBHYT_HUONG_ID":28400,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false},{"VIENPHI_ID":673451,"TIEPNHAN_ID":27372,"DICHVU_ID":4017,"BENHAN_ID":5855,"SOLUONG":1.0000,"DONGIA_DOANHTHU":42100.0000,"THANHTIEN_DOANHTHU":42100.00,"BHYT_TL":1.0,"BHYT_DONGIA":42100.0000,"BHYT_THANHTIEN":42100.00,"BHYT_DONGIA_CONGKHAM_DAU":0.0,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":42100.0,"BHYT_THANHTIEN_CHITRA":42100.00,"BENHNHAN_PHAITHANHTOAN":0.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"GB438382336470038664","SOBHYT_HUONG_ID":28400,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false},{"VIENPHI_ID":673452,"TIEPNHAN_ID":27372,"DICHVU_ID":4008,"BENHAN_ID":5855,"SOLUONG":1.0000,"DONGIA_DOANHTHU":42100.0000,"THANHTIEN_DOANHTHU":42100.00,"BHYT_TL":1.0,"BHYT_DONGIA":42100.0000,"BHYT_THANHTIEN":42100.00,"BHYT_DONGIA_CONGKHAM_DAU":0.0,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":42100.0,"BHYT_THANHTIEN_CHITRA":42100.00,"BENHNHAN_PHAITHANHTOAN":0.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"GB438382336470038664","SOBHYT_HUONG_ID":28400,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false},{"VIENPHI_ID":674008,"TIEPNHAN_ID":27372,"DICHVU_ID":null,"BENHAN_ID":5855,"SOLUONG":1.0000,"DONGIA_DOANHTHU":80000.0000,"THANHTIEN_DOANHTHU":80000.00,"BHYT_TL":1.0,"BHYT_DONGIA":80000.0000,"BHYT_THANHTIEN":80000.00,"BHYT_DONGIA_CONGKHAM_DAU":0.0,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":80000.0,"BHYT_THANHTIEN_CHITRA":80000.00,"BENHNHAN_PHAITHANHTOAN":0.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"GB438382336470038664","SOBHYT_HUONG_ID":28400,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false},{"VIENPHI_ID":674131,"TIEPNHAN_ID":27372,"DICHVU_ID":null,"BENHAN_ID":5855,"SOLUONG":1.0000,"DONGIA_DOANHTHU":7000.0000,"THANHTIEN_DOANHTHU":7000.00,"BHYT_TL":1.0,"BHYT_DONGIA":4410.0000,"BHYT_THANHTIEN":4410.00,"BHYT_DONGIA_CONGKHAM_DAU":0.0,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":4410.0,"BHYT_THANHTIEN_CHITRA":4410.00,"BENHNHAN_PHAITHANHTOAN":2590.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"GB438382336470038664","SOBHYT_HUONG_ID":28400,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false},{"VIENPHI_ID":674132,"TIEPNHAN_ID":27372,"DICHVU_ID":null,"BENHAN_ID":5855,"SOLUONG":1.0000,"DONGIA_DOANHTHU":630.0000,"THANHTIEN_DOANHTHU":630.00,"BHYT_TL":1.0,"BHYT_DONGIA":630.0000,"BHYT_THANHTIEN":630.00,"BHYT_DONGIA_CONGKHAM_DAU":0.0,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":630.0,"BHYT_THANHTIEN_CHITRA":630.00,"BENHNHAN_PHAITHANHTOAN":0.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"GB438382336470038664","SOBHYT_HUONG_ID":28400,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false},{"VIENPHI_ID":674133,"TIEPNHAN_ID":27372,"DICHVU_ID":null,"BENHAN_ID":5855,"SOLUONG":2.0000,"DONGIA_DOANHTHU":4000.0000,"THANHTIEN_DOANHTHU":8000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":0.0,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":8000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"GB438382336470038664","SOBHYT_HUONG_ID":28400,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false}]';        begin        UPDATE TT_VIENPHI        SET        SOLUONG = json.SOLUONG,        DONGIA_DOANHTHU = json.DONGIA_DOANHTHU,        THANHTIEN_DOANHTHU = json.THANHTIEN_DOANHTHU,        BHYT_TL = json.BHYT_TL,        BHYT_DONGIA = json.BHYT_DONGIA,        BHYT_THANHTIEN = json.BHYT_THANHTIEN,        BHYT_DONGIA_CONGKHAM_DAU = json.BHYT_DONGIA_CONGKHAM_DAU,        BHYT_CONGKHAM_DAU_TYLE = json.BHYT_CONGKHAM_DAU_TYLE,        BHYT_DONGIA_CHITRA = json.BHYT_DONGIA_CHITRA,        BHYT_THANHTIEN_CHITRA = json.BHYT_THANHTIEN_CHITRA,        BENHNHAN_PHAITHANHTOAN = json.BENHNHAN_PHAITHANHTOAN,        GIATRI_HOADON = json.GIATRI_HOADON,                GIATRI_BIENLAI = json.GIATRI_BIENLAI,                DATHUCHIEN = json.DATHUCHIEN,                DICHVU_TL = json.DICHVU_TL,        BHYT_DONGIA_DONGCT_DAU = json.BHYT_DONGIA_DONGCT_DAU,        NGAYCAPNHAT = GETDATE()        FROM OPENJSON (@jsonVienPhi)        WITH (        VIENPHI_ID int,        SOLUONG numeric(25, 4),        DONGIA_DOANHTHU numeric(25, 4),        THANHTIEN_DOANHTHU numeric(25, 4),        BHYT_TL numeric(25, 4),        BHYT_DONGIA numeric(25, 4),        BHYT_THANHTIEN numeric(25, 4),        BHYT_DONGIA_CONGKHAM_DAU numeric(25, 4),        BHYT_CONGKHAM_DAU_TYLE numeric(25, 4),        BHYT_DONGIA_CHITRA numeric(25, 4),        BHYT_THANHTIEN_CHITRA numeric(25, 4),        BENHNHAN_PHAITHANHTOAN numeric(25, 4),        GIATRI_HOADON numeric(25, 4),                GIATRI_BIENLAI numeric(25, 4),                DATHUCHIEN char(1),        KHONGTHUTIEN char(1),        BHYTDONGTIEN char(1),        DICHVU_TL numeric(25, 4),        BHYT_DONGIA_DONGCT_DAU numeric(25, 4))  json        WHERE TT_VIENPHI.VIENPHI_ID = json.VIENPHI_ID and json.DONGIA_DOANHTHU > 0                  insert into TT_TINH_VIENPHI_LOG        SELECT json.VIENPHI_ID, json.TIEPNHAN_ID, json.BENHAN_ID, json.SOLUONG, json.BHYT_TL, json.DONGIA_DOANHTHU,        json.THANHTIEN_DOANHTHU, json.BHYT_DONGIA, json.BHYT_THANHTIEN, json.BHYT_DONGIA_CHITRA, json.BHYT_THANHTIEN_CHITRA, json.BENHNHAN_PHAITHANHTOAN,        json.SOBHYT_HUONG_ID, json.SOBHYT, GETDATE(), -1, 'HLU01'        FROM OPENJSON(@jsonVienPhi)        WITH (        VIENPHI_ID int,        TIEPNHAN_ID int,        BENHAN_ID int,        SOLUONG numeric(25, 4),        DONGIA_DOANHTHU numeric(25, 4),        THANHTIEN_DOANHTHU numeric(25, 4),        BHYT_TL numeric(25, 4),        BHYT_DONGIA numeric(25, 4),        BHYT_THANHTIEN numeric(25, 4),        BHYT_DONGIA_CHITRA numeric(25, 4),        BHYT_THANHTIEN_CHITRA numeric(25, 4),        BENHNHAN_PHAITHANHTOAN numeric(25, 4),        SOBHYT_HUONG_ID int,        SOBHYT nvarchar(30)) json        end]
2019-12-17 11:34:07,944 [1] DEBUG - Statement Id: [DAO00067_UpdateDataVienPhiDongiaBHYT] PreparedStatement : [update TT_VIENPHI          set BHYT_DONGIA_CHITRA = 0, BHYT_THANHTIEN = 0, BHYT_THANHTIEN_CHITRA = 0          where          TIEPNHAN_ID = 27372 and BHYT_DONGIA = 0          and (BHYT_DONGIA_CHITRA > 0 or BHYT_THANHTIEN > 0 or BHYT_THANHTIEN_CHITRA > 0)]
2019-12-17 11:34:07,984 [1] DEBUG - Statement Id: [DAO00067_CapnhatDataVienphiKhiHuyThanhtoanHoadon] PreparedStatement : [update TT_VIENPHI        set TT_VIENPHI.HOADON_ID = hdct.HOADON_ID, TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN = TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN + hdct.GIATRI_BENHNHAN_DATHANHTOAN        from (select CT.HOADON_ID, CT.VIENPHI_ID, CT.GIATRI_BENHNHAN_DATHANHTOAN        from TT_HOADON_CHITIET_NGOAITRU CT        join TT_HOADON HD on HD.HOADON_ID = CT.HOADON_ID        join TT_VIENPHI vp on vp.VIENPHI_ID = ct.VIENPHI_ID        where HD.DATHANHTOAN = 1 and HD.HUYHOADON = 0 and HD.HOANTRA = 0 and vp.TIEPNHAN_ID =  @param0 ) hdct        where        TT_VIENPHI.VIENPHI_ID = hdct.VIENPHI_ID and TT_VIENPHI.HOADON_ID is null and isnull(TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN,0) = 0        and TT_VIENPHI.TIEPNHAN_ID =  @param0           update TT_VIENPHI        set TT_VIENPHI.HOADON_ID = null, TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN = TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN - hdct.GIATRI_BENHNHAN_DATHANHTOAN,        TT_VIENPHI.DATHANHTOAN = '0'        from (select CT.HOADON_ID, CT.VIENPHI_ID, CT.GIATRI_BENHNHAN_DATHANHTOAN        from TT_HOADON_CHITIET_NGOAITRU CT        join TT_HOADON HD on HD.HOADON_ID = CT.HOADON_ID        join TT_VIENPHI vp on vp.VIENPHI_ID = ct.VIENPHI_ID and vp.HOADON_ID = ct.HOADON_ID        where HD.DATHANHTOAN = 0 and (HD.HUYHOADON = 1 or HD.HOANTRA = 1) and vp.TIEPNHAN_ID =  @param0 ) hdct        where        TT_VIENPHI.VIENPHI_ID = hdct.VIENPHI_ID and TT_VIENPHI.HOADON_ID = hdct.HOADON_ID        and TT_VIENPHI.TIEPNHAN_ID =  @param0]
2019-12-17 11:34:07,985 [1] DEBUG - Statement Id: [DAO00067_CapnhatDataVienphiKhiHuyThanhtoanHoadon] Parameters: [@param0=[TIEPNHAN_ID,27372]]
2019-12-17 11:34:07,985 [1] DEBUG - Statement Id: [DAO00067_CapnhatDataVienphiKhiHuyThanhtoanHoadon] Types: [@param0=[Int64, System.Int64]]
2019-12-17 11:34:16,018 [1] DEBUG - Statement Id: [DAO00068_GetTTBenhAnByBenhNhanID] PreparedStatement : [select TOP (1) tn.TIEPNHAN_ID, BENHAN_ID, ba.TRANGTHAI              from TT_TIEPNHAN tn              left join TT_NOITRU_BENHAN ba              on tn.TIEPNHAN_ID = ba.TIEPNHAN_ID              where tn.BENHNHAN_ID = '9212'              order by tn.NGAYTAO desc]
2019-12-17 11:34:21,462 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM98'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-17 11:35:15,562 [1] DEBUG - Statement Id: [DAO00068_GetTTBenhAnByBenhNhanID] PreparedStatement : [select TOP (1) tn.TIEPNHAN_ID, BENHAN_ID, ba.TRANGTHAI              from TT_TIEPNHAN tn              left join TT_NOITRU_BENHAN ba              on tn.TIEPNHAN_ID = ba.TIEPNHAN_ID              where tn.BENHNHAN_ID = '9212'              order by tn.NGAYTAO desc]
2019-12-17 11:35:35,468 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'IPD42'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-17 11:35:35,563 [1] DEBUG - Statement Id: [DAO00069_GetCountDanhSachNoiTru] PreparedStatement : [select count(A.SOBENHAN) as TOTALROWS        from TT_NOITRU_BENHAN A        inner join TT_TIEPNHAN B on B.TIEPNHAN_ID = A.TIEPNHAN_ID and (B.TRANGTHAI = 'NOITRU' or B.TRANGTHAI = 'HOANTHANH')        inner join TT_BENHNHAN C on C.BENHNHAN_ID = B.BENHNHAN_ID        left join TT_NOITRU_LUUTRU D on D.BENHAN_ID = A.BENHAN_ID        and D.LUUTRU_ID = ( select top 1 LUUTRU_ID from TT_NOITRU_LUUTRU where BENHAN_ID = A.BENHAN_ID order by BENHAN_ID desc)        left join TT_NOITRU_XACNHAN E on E.BENHAN_ID = A.BENHAN_ID        left join TT_NOITRU_LUUTRUCHITIET F on D.LUUTRU_ID = F.LUUTRU_ID and F.LUUTRUCHITIET_CURRENT = '1'        and F.LUUTRUCHITIET_ID in (select top 1 LUUTRUCHITIET_ID from TT_NOITRU_LUUTRUCHITIET where LUUTRU_ID = D.LUUTRU_ID order by LUUTRUCHITIET_ID desc)        where        A.KHOACHUYENDEN_ID is not null  and        (E.TRANGTHAI = 'DAXACNHAN' OR E.TRANGTHAI = 'HUYXACNHAN')         and           cast(A.NGAYVAOKHOA as date) <= cast('12/17/2019 12:00:00 AM' as date)                 and B.BENHVIEN_ID = 'HLU01' and A.KHOACHUYENDEN_ID = '32'          AND             A.TRANGTHAI in ('DAXUATVIEN','DATHANHTOAN')]
2019-12-17 11:35:35,704 [1] DEBUG - Statement Id: [DAO00069_GetDanhSachNoiTru] PreparedStatement : [select * from        (        SELECT ROW_NUMBER() OVER(order by B.SOTIEPNHAN) as ROWNUMBER,          A.SOBENHAN, A.BENHAN_ID, A.SOLUUTRU                 , E.NOILAP_ID as KHOAVAO_ID        , A.TRANGTHAI, IsNull(A.BACSIDIEUTRI_ID, E.BACSICHIDINH_ID) as BACSIDIEUTRI_ID,        B.TIEPNHAN_ID, B.SOTIEPNHAN, B.SOBHYT as SOTHE, B.DOITUONG_ID, A.NGAYVAOKHOA as NGAYCAPCUU, A.THOIGIANVAOKHOA as THOIGIANCAPCUU,        C.TENBENHNHAN, C.NGAYSINH, C.NAMSINH, C.BENHNHAN_ID, C.MAYTE, F.GIUONGBENH_ID, A.THOIGIANRAVIEN    , DIACHITHUONGTRU, DANTOC_ID        ,BENHVIEN_STT_ID                from TT_NOITRU_BENHAN A        inner join TT_TIEPNHAN B on B.TIEPNHAN_ID = A.TIEPNHAN_ID and (B.TRANGTHAI = 'NOITRU' or B.TRANGTHAI = 'HOANTHANH')        inner join TT_BENHNHAN C on C.BENHNHAN_ID = B.BENHNHAN_ID        left join TT_NOITRU_LUUTRU D on D.BENHAN_ID = A.BENHAN_ID        and D.LUUTRU_ID = ( select top 1 LUUTRU_ID from TT_NOITRU_LUUTRU where BENHAN_ID = A.BENHAN_ID order by LUUTRU_ID desc)        left join TT_NOITRU_XACNHAN E on E.BENHAN_ID = A.BENHAN_ID        left join TT_NOITRU_LUUTRUCHITIET F on D.LUUTRU_ID = F.LUUTRU_ID and F.LUUTRUCHITIET_CURRENT = '1'        and F.LUUTRUCHITIET_ID in (select top 1 LUUTRUCHITIET_ID from TT_NOITRU_LUUTRUCHITIET where LUUTRU_ID = D.LUUTRU_ID order by LUUTRUCHITIET_ID desc)        left join (select MABENHVIEN, BENHVIEN_STT_ID from TM_BENHVIEN) H on SUBSTRING(B.SOBHYT, 16, 5)=H.MABENHVIEN        where        A.KHOACHUYENDEN_ID is not null  and        (E.TRANGTHAI = 'DAXACNHAN' OR E.TRANGTHAI = 'HUYXACNHAN')         and           cast(A.NGAYVAOKHOA as date) <= cast('12/17/2019 12:00:00 AM' as date)                 and B.BENHVIEN_ID = 'HLU01' and A.KHOACHUYENDEN_ID = '32'          AND             A.TRANGTHAI in ('DAXUATVIEN','DATHANHTOAN')                   ) lst        where        lst.ROWNUMBER between 1 and 5        order by lst.SOTIEPNHAN]
2019-12-17 11:35:37,927 [1] DEBUG - Statement Id: [DAO00080_KiemtraBenhAnDaThanhToan] PreparedStatement : [select DAXACNHANDOANHTHU        from TT_NOITRU_BENHAN where        BENHAN_ID = '10'        and BENHVIEN_ID = 'HLU01'        Order By BENHAN_ID Desc]
2019-12-17 11:35:38,015 [1] DEBUG - Statement Id: [DAO00061_GetBenhAnDetailByID] PreparedStatement : [select A.*, B.NOIGIOITHIEU_ID, C.KHOADIEUTRI_ID, A.ICD_BENHCHINH AS ICD_BENHCHINH_BAK, A.CDRAVIEN_CHINH AS CHANDOANRAVIEN1, B.THOIGIANTIEPNHAN        , A.CDRAVIEN_CHINH AS CHANDOANRAVIEN_BAK        from TT_NOITRU_BENHAN A        left join TT_TIEPNHAN B on B.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TT_NOITRU_NHAPVIEN C on C.TIEPNHAN_ID = B.TIEPNHAN_ID        where A.BENHAN_ID = '10']
2019-12-17 11:35:38,217 [1] DEBUG - Statement Id: [DAO00080_GetNoiTruLuuTruBenhAn] PreparedStatement : [select *        from TT_NOITRU_LUUTRU where        BENHAN_ID = '10'        and BENHVIEN_ID = 'HLU01'        Order By LUUTRU_ID ASC]
2019-12-17 11:35:38,284 [1] DEBUG - Statement Id: [DAO00080_GetGiuongBenhCuaBenhAn] PreparedStatement : [select *        from TT_NOITRU_GIUONGBENH where        BENHAN_ID =  @param0]
2019-12-17 11:35:38,284 [1] DEBUG - Statement Id: [DAO00080_GetGiuongBenhCuaBenhAn] Parameters: [@param0=[BENHAN_ID,10]]
2019-12-17 11:35:38,284 [1] DEBUG - Statement Id: [DAO00080_GetGiuongBenhCuaBenhAn] Types: [@param0=[Int64, System.Int64]]
2019-12-17 11:35:38,363 [1] DEBUG - Statement Id: [DAO00013_GetDetailP] PreparedStatement : [select *        from TT_BENHNHAN         WHERE              TT_BENHNHAN.MAYTE  = '190020184']
2019-12-17 11:35:38,451 [1] DEBUG - Statement Id: [DAO00061_GetBenhAnDetailByID] PreparedStatement : [select A.*, B.NOIGIOITHIEU_ID, C.KHOADIEUTRI_ID, A.ICD_BENHCHINH AS ICD_BENHCHINH_BAK, A.CDRAVIEN_CHINH AS CHANDOANRAVIEN1, B.THOIGIANTIEPNHAN        , A.CDRAVIEN_CHINH AS CHANDOANRAVIEN_BAK        from TT_NOITRU_BENHAN A        left join TT_TIEPNHAN B on B.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TT_NOITRU_NHAPVIEN C on C.TIEPNHAN_ID = B.TIEPNHAN_ID        where A.BENHAN_ID = '10']
2019-12-17 11:35:38,685 [1] DEBUG - Statement Id: [DAO00080_GetNoiTruBenhAnChiTiet] PreparedStatement : [select *        from TT_NOITRU_BENHAN_CHITIET where        BENHAN_ID = '10'        and BENHVIEN_ID = 'HLU01'        Order By BENHANCHITIET_ID DESC]
2019-12-17 11:35:38,785 [1] DEBUG - Statement Id: [DAO00080_GetNoiTruLuuTruBenhAn] PreparedStatement : [select *        from TT_NOITRU_LUUTRU where        BENHAN_ID = '10'        and BENHVIEN_ID = 'HLU01'        Order By LUUTRU_ID ASC]
2019-12-17 11:35:38,814 [1] DEBUG - Statement Id: [DAO00080_GetGiuongBenhCuaBenhAn] PreparedStatement : [select *        from TT_NOITRU_GIUONGBENH where        BENHAN_ID =  @param0]
2019-12-17 11:35:38,814 [1] DEBUG - Statement Id: [DAO00080_GetGiuongBenhCuaBenhAn] Parameters: [@param0=[BENHAN_ID,10]]
2019-12-17 11:35:38,814 [1] DEBUG - Statement Id: [DAO00080_GetGiuongBenhCuaBenhAn] Types: [@param0=[Int64, System.Int64]]
2019-12-17 11:35:38,908 [1] DEBUG - Statement Id: [DAO00067_laytrangthaibenhannoitru] PreparedStatement : [select isnull(TRANGTHAI, '') TRANGTHAI from TT_NOITRU_BENHAN where BENHAN_ID =  @param0]
2019-12-17 11:35:38,908 [1] DEBUG - Statement Id: [DAO00067_laytrangthaibenhannoitru] Parameters: [@param0=[BENHAN_ID,10]]
2019-12-17 11:35:38,908 [1] DEBUG - Statement Id: [DAO00067_laytrangthaibenhannoitru] Types: [@param0=[Int64, System.Int64]]
2019-12-17 11:35:38,934 [1] DEBUG - Statement Id: [DAO00067_ClearDataVienPhi] PreparedStatement : [delete from TT_VIENPHI where TIEPNHAN_ID = 208 and REF_ID = 0           and             BENHAN_ID = '10'                     update TT_VIENPHI set SOLUONG = 0          where REF_TABLE = 'TT_DVYEUCAU' and TIEPNHAN_ID =  @param0           and not exists (select DVYEUCAU_ID from TT_DVYEUCAU where TT_VIENPHI.REF_ID = DVYEUCAU_ID and TIEPNHAN_ID =  @param0 )                       update TT_VIENPHI set SOLUONG = 0          where REF_TABLE = 'TT_NGOAITRU_TOATHUOC'          and TIEPNHAN_ID =  @param0           and HOADON_ID is null and TIEPNHAN_ID =  @param0           and not exists (select TOATHUOC_ID from TT_NGOAITRU_TOATHUOC where TT_VIENPHI.REF_ID = TOATHUOC_ID and TIEPNHAN_ID =  @param0 )                          update TT_VIENPHI            set SOLUONG = (TraThuoc.SOLUONG - TraThuoc.SOLUONG_NGUNG)            from (select distinct nttt.SOLUONG, ttct.TOATHUOC_ID, ttct.DUOC_ID , ttct.SOLUONG SOLUONG_NGUNG            from TT_NOITRU_TRATHUOC_CHITIET ttct            left join TT_NOITRU_TRATHUOC tt on tt.TRATHUOC_ID = ttct.TRATHUOC_ID            left join TT_NOITRU_TOATHUOC nttt on nttt.TOATHUOC_ID = ttct.TOATHUOC_ID            where tt.BENHAN_ID =  @param1 ) TraThuoc            where TT_VIENPHI.REF_ID = TraThuoc.TOATHUOC_ID and TT_VIENPHI.DUOC_ID = TraThuoc.DUOC_ID            and TT_VIENPHI.REF_TABLE = 'TT_NOITRU_TOATHUOC' and TT_VIENPHI.BENHAN_ID =  @param1             and TT_VIENPHI.SOLUONG > (TraThuoc.SOLUONG - TraThuoc.SOLUONG_NGUNG)                         update TT_VIENPHI set SOLUONG = 0            where REF_TABLE = 'TT_NOITRU_TOATHUOC'            and TIEPNHAN_ID =  @param0             and KHAMBENH_ID not in (select KHAMBENH_ID from TT_NOITRU_TOATHUOC where TIEPNHAN_ID =  @param0 )            and HOADON_ID is null and BENHAN_ID =  @param1                    delete TT_DUOC_TONKHO_BOOK_NOITRU where REF_TABLE = 'TT_NOITRU_TOATHUOC' and (REF_ID is null or REF_ID = 0)        delete TT_DUOC_TONKHO_BOOK_NGOAITRU where REF_ID is null or REF_ID = 0                      update TT_VIENPHI          set BENHAN_ID =  @param1           from (select TOATHUOC_ID from TT_NOITRU_TOATHUOC where TIEPNHAN_ID =  @param0 ) nttt          where REF_TABLE = 'TT_NOITRU_TOATHUOC' and REF_ID = nttt.TOATHUOC_ID and isnull(BENHAN_ID, 0) = 0          and TIEPNHAN_ID =  @param0             update TT_VIENPHI          set TT_VIENPHI.BENHAN_ID =  @param1           from (select DVYEUCAU_ID, BENHAN_ID from TT_DVYEUCAU where TIEPNHAN_ID =  @param0 ) nttt          where TT_VIENPHI.REF_TABLE = 'TT_DVYEUCAU' and TT_VIENPHI.REF_ID = nttt.DVYEUCAU_ID          and isnull(TT_VIENPHI.BENHAN_ID, 0) = 0 and isnull(nttt.BENHAN_ID, 0) > 0          and TT_VIENPHI.TIEPNHAN_ID =  @param0                     update TT_VIENPHI set          THANHTIEN_DOANHTHU = 0, BHYT_THANHTIEN = 0, BHYT_THANHTIEN_CHITRA = 0          , GIATRI_BENHNHAN_DATHANHTOAN = 0, BENHNHAN_PHAITHANHTOAN = 0          where TIEPNHAN_ID = 208 and SOLUONG = 0           and             BENHAN_ID = 10                       update TT_VIENPHI set          GIATRI_BENHNHAN_DATHANHTOAN = 0          where TIEPNHAN_ID = '208' and GIATRI_BENHNHAN_DATHANHTOAN is null            update TT_VIENPHI set          BENHNHAN_PHAITHANHTOAN = 0          where TIEPNHAN_ID = '208' and BENHNHAN_PHAITHANHTOAN is null]
2019-12-17 11:35:38,934 [1] DEBUG - Statement Id: [DAO00067_ClearDataVienPhi] Parameters: [@param0=[TIEPNHAN_ID,208], @param1=[BENHAN_ID,10]]
2019-12-17 11:35:38,934 [1] DEBUG - Statement Id: [DAO00067_ClearDataVienPhi] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64]]
2019-12-17 11:35:41,791 [1] DEBUG - Statement Id: [DAO00064_GetlistTT_TIEPNHAN_SOTHEBHYT] PreparedStatement : [select stbhyt.*, ba.SOBENHAN,        tn.SOTIEPNHAN, tn.LOAITHANHVIEN_ID, tn.THE_ID, tn.THANHVIEN_ID,        tn.SUDUNG_BHTN, tn.BAOLANH_VIENPHI, tn.VIP, tn.NGUOINUOCNGOAI        from TT_TIEPNHAN_SOTHEBHYT stbhyt        left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = stbhyt.TIEPNHAN_ID        left join TT_NOITRU_BENHAN ba on ba.TIEPNHAN_ID = stbhyt.TIEPNHAN_ID        where        stbhyt.TIEPNHAN_ID = '208' and isnull(stbhyt.KHONGSUDUNG, '0') = '0'         and           ba.BENHAN_ID = '10']
2019-12-17 11:35:41,844 [1] DEBUG - Statement Id: [DAO00064_GetListVienPhiByTiepNnan] PreparedStatement : [select distinct        B.DOITUONG_ID, B.NGAYMIENDONGCHITRA, B.BENHNHAN_ID as TIEPNHAN_BENHNHAN_ID, B.TRAITUYEN,        B.BHYTTREN3NAM as TREN3NAM, B.BHYTTREN5NAM as TREN5NAM, B.SOTIEPNHAN, B.SOBENHAN,        B.LOAITHANHVIEN_ID, B.SUDUNG_BHTN, B.THE_ID, B.THANHVIEN_ID, B.BAOLANH_VIENPHI, B.VIP, B.NGUOINUOCNGOAI,        C.GIATRIMIENGIAM as GIATRIMIENGIAM, D.GIATRIMIENGIAM as GIATRIMIENGIAM_BHTN, E.GIATRIMIENGIAM as GIATRIMIENGIAM_THANHVIEN,        F.GIATRIMIENGIAM as GIATRIMIENGIAM_CONGTY, DVYC.THE_ID as DVDUNGTHE, DVYC.TRANGTHAI as TRANGTHAIDICHVU, ndv.MANHOMDICHVU,        A.* from TT_VIENPHI A        left join        (select B.*, C.SOBENHAN, C.BENHAN_ID        from TT_TIEPNHAN B        left join TT_NOITRU_BENHAN C on B.TIEPNHAN_ID = C.TIEPNHAN_ID         and           C.BENHAN_ID = '10'                 where B.TIEPNHAN_ID = '208') B on B.TIEPNHAN_ID = A.TIEPNHAN_ID        left join (select sum(GIATRIMIENGIAM) as GIATRIMIENGIAM, VIENPHI_ID, REF_TABLE        from TT_MIENGIAM_CHITIET        where REF_TABLE = 'TT_MIENGIAM'        and exists (select MIENGIAM_ID from TT_MIENGIAM where TT_MIENGIAM_CHITIET.MIENGIAM_ID = MIENGIAM_ID and TINHTRANG = 1 and TIEPNHAN_ID = '208')        group by VIENPHI_ID, REF_TABLE) C on C.REF_TABLE = 'TT_MIENGIAM' and C.VIENPHI_ID = A.VIENPHI_ID        left join (select sum(GIATRIMIENGIAM) as GIATRIMIENGIAM, VIENPHI_ID, REF_TABLE        from TT_MIENGIAM_CHITIET        where REF_TABLE = 'TT_MIENGIAM_BHTN'        and exists (select MIENGIAM_BHTN_ID from TT_MIENGIAM_BHTN where TT_MIENGIAM_CHITIET.MIENGIAM_ID = MIENGIAM_BHTN_ID and  TINHTRANG = 1 and TIEPNHAN_ID = '208')        group by VIENPHI_ID, REF_TABLE) D on D.REF_TABLE = 'TT_MIENGIAM_BHTN' and D.VIENPHI_ID = A.VIENPHI_ID        left join (select sum(GIATRIMIENGIAM) as GIATRIMIENGIAM, VIENPHI_ID, REF_TABLE        from TT_MIENGIAM_CHITIET        where REF_TABLE = 'TT_MIENGIAM_THANHVIEN'        and exists (select MIENGIAM_THANHVIEN_ID from TT_MIENGIAM_THANHVIEN where TT_MIENGIAM_CHITIET.MIENGIAM_ID = MIENGIAM_THANHVIEN_ID and TINHTRANG = 1 and TIEPNHAN_ID = '208')        group by VIENPHI_ID, REF_TABLE) E on E.REF_TABLE = 'TT_MIENGIAM_THANHVIEN' and E.VIENPHI_ID = A.VIENPHI_ID        left join (select sum(GIATRIMIENGIAM) as GIATRIMIENGIAM, VIENPHI_ID, REF_TABLE        from TT_MIENGIAM_CHITIET        where REF_TABLE = 'TT_MIENGIAM_CONGTY'        and exists (select MIENGIAM_CONGTY_ID from TT_MIENGIAM_CONGTY where TT_MIENGIAM_CHITIET.MIENGIAM_ID = MIENGIAM_CONGTY_ID and TINHTRANG = 1 and TIEPNHAN_ID = '208')        group by VIENPHI_ID, REF_TABLE) F on F.REF_TABLE = 'TT_MIENGIAM_CONGTY' and F.VIENPHI_ID = A.VIENPHI_ID        left join TT_DVYEUCAU DVYC on DVYC.DVYEUCAU_ID = A.REF_ID and A.REF_TABLE = 'TT_DVYEUCAU'        left join TM_DICHVU DV on DVYC.DICHVU_ID = DV.DICHVU_ID and A.REF_TABLE = 'TT_DVYEUCAU'        left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = DV.NHOMDICHVU_ID and A.REF_TABLE = 'TT_DVYEUCAU'        where        A.TIEPNHAN_ID = '208' and ((DVYC.HUYYEUCAU = '0' and A.DICHVU_ID is not null)        or A.DUOC_ID is not null or A.REF_TABLE = 'TT_NUT_XACNHANSUATAN_CHITIET')        and A.ACTIVE = '1'         and           A.BENHAN_ID = '10'                 and A.BENHVIEN_ID = 'HLU01'        order by A.VIENPHI_ID]
2019-12-17 11:35:42,136 [1] DEBUG - Statement Id: [DAO00080_LayLoaiBenhanCuNoitru] PreparedStatement : [select LOAIBENHAN from TT_NOITRU_BENHAN where TIEPNHAN_ID =  @param0]
2019-12-17 11:35:42,136 [1] DEBUG - Statement Id: [DAO00080_LayLoaiBenhanCuNoitru] Parameters: [@param0=[TIEPNHAN_ID,208]]
2019-12-17 11:35:42,136 [1] DEBUG - Statement Id: [DAO00080_LayLoaiBenhanCuNoitru] Types: [@param0=[Int32, System.Int32]]
2019-12-17 11:35:42,165 [1] DEBUG - Statement Id: [DAO00006_GetListDuocTyle] PreparedStatement : [select DUOC_ID, DOITUONG_ID, (TYLE/100) as TYLE, DONGIA MUCTRAN_THANHTOAN from TM_DOITUONG_GIADUOC_TYLE            where            BENHVIEN_ID = 'HLU01'            and DOITUONG_ID = '4']
2019-12-17 11:35:42,190 [1] DEBUG - Statement Id: [DAO00027_GetListTuongTrinhDichVuPhauThuatCuaTiepNhan] PreparedStatement : [declare @ManhomDSA varchar(10);        declare @PhanLoaiNhomDV varchar(20) = '05';        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        if (@ManhomDSA is not null) set @PhanLoaiNhomDV += ',' + @ManhomDSA        select distinct ptyc.*        from TT_PHAUTHUAT_YEUCAU ptyc        inner join TM_DICHVU dv on dv.DICHVU_ID = ptyc.DICHVU_ID        inner join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID        inner join TT_PHAUTHUAT pt on pt.PHAUTHUAT_ID = ptyc.PHAUTHUAT_ID        where        pt.TIEPNHAN_ID = 208        and (left(ndv.MANHOMDICHVU, 2) in (select * from STRING_SPLIT(@PhanLoaiNhomDV,',')) or ndv.MANHOMDICHVU in (select * from STRING_SPLIT(@PhanLoaiNhomDV,',')))]
2019-12-17 11:35:42,268 [1] DEBUG - Statement Id: [DAO00006_GetList] PreparedStatement : [select dv.*, loaiDV.MALOAIDICHVU, captren.NHOMDICHVU_ID as NHOMDICHVU_CAPTREN_ID, captren.TENNHOMDICHVU as NHOMDICHVU_CAPTREN,              nhom_dv.TENNHOMDICHVU as TENNHOMDICHVU, nhom_dv.MANHOMDICHVU,              case when dv.ATTRIBUTE5 is null then 'TT' else 'KTC' end as LOAI_CHIPHI              from TM_DICHVU as dv              left join TM_NHOMDICHVU as nhom_dv on nhom_dv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID and nhom_dv.BENHVIEN_ID = 'HLU01'              left join TM_NHOMDICHVU as captren on nhom_dv.CAPTREN_ID = captren.NHOMDICHVU_ID and captren.BENHVIEN_ID = 'HLU01'              left join TM_LOAIDICHVU loaiDV on nhom_dv.LOAIDICHVU_ID = loaiDV.LOAIDICHVU_ID and loaiDV.BENHVIEN_ID = 'HLU01'              where nhom_dv.TAMNGUNG = '0' and dv.BENHVIEN_ID = 'HLU01'              and dv.TAMNGUNG = '0'               AND                   loaiDV.MALOAIDICHVU = 'KhamBenh']
2019-12-17 11:35:42,408 [1] DEBUG - Statement Id: [DAO00027_GetDichvuYCBHYTTyle] PreparedStatement : [select DVYEUCAU_ID from TT_DVYEUCAU        where TIEPNHAN_ID = 208 and isnull(BHYT_TYLETHANHTOAN_ID, 0) > 0]
2019-12-17 11:35:42,483 [1] DEBUG - Statement Id: [DAO00023_UpdateNhieuVP] PreparedStatement : [declare @jsonVienPhi nvarchar(max) = N'[{"VIENPHI_ID":1374,"TIEPNHAN_ID":208,"DICHVU_ID":4523,"BENHAN_ID":10,"SOLUONG":1.0000,"DONGIA_DOANHTHU":40000.0000,"THANHTIEN_DOANHTHU":40000.00,"BHYT_TL":0.0,"BHYT_DONGIA":40000.0000,"BHYT_THANHTIEN":40000.00,"BHYT_DONGIA_CONGKHAM_DAU":0.0,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":40000.00,"GIATRI_HOADON":40000.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"GB438382336470038664","SOBHYT_HUONG_ID":207,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false},{"VIENPHI_ID":1375,"TIEPNHAN_ID":208,"DICHVU_ID":4641,"BENHAN_ID":10,"SOLUONG":1.0000,"DONGIA_DOANHTHU":21400.0000,"THANHTIEN_DOANHTHU":21400.00,"BHYT_TL":0.0,"BHYT_DONGIA":21400.0000,"BHYT_THANHTIEN":21400.00,"BHYT_DONGIA_CONGKHAM_DAU":0.0,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":21400.00,"GIATRI_HOADON":21400.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"GB438382336470038664","SOBHYT_HUONG_ID":207,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false},{"VIENPHI_ID":1376,"TIEPNHAN_ID":208,"DICHVU_ID":4642,"BENHAN_ID":10,"SOLUONG":1.0000,"DONGIA_DOANHTHU":21400.0000,"THANHTIEN_DOANHTHU":21400.00,"BHYT_TL":0.0,"BHYT_DONGIA":21400.0000,"BHYT_THANHTIEN":21400.00,"BHYT_DONGIA_CONGKHAM_DAU":0.0,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":21400.00,"GIATRI_HOADON":21400.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"GB438382336470038664","SOBHYT_HUONG_ID":207,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false},{"VIENPHI_ID":1377,"TIEPNHAN_ID":208,"DICHVU_ID":4722,"BENHAN_ID":10,"SOLUONG":1.0000,"DONGIA_DOANHTHU":21400.0000,"THANHTIEN_DOANHTHU":21400.00,"BHYT_TL":0.0,"BHYT_DONGIA":21400.0000,"BHYT_THANHTIEN":21400.00,"BHYT_DONGIA_CONGKHAM_DAU":0.0,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":21400.00,"GIATRI_HOADON":21400.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"GB438382336470038664","SOBHYT_HUONG_ID":207,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false},{"VIENPHI_ID":1378,"TIEPNHAN_ID":208,"DICHVU_ID":4668,"BENHAN_ID":10,"SOLUONG":1.0000,"DONGIA_DOANHTHU":21400.0000,"THANHTIEN_DOANHTHU":21400.00,"BHYT_TL":0.0,"BHYT_DONGIA":21400.0000,"BHYT_THANHTIEN":21400.00,"BHYT_DONGIA_CONGKHAM_DAU":0.0,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":21400.00,"GIATRI_HOADON":21400.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"GB438382336470038664","SOBHYT_HUONG_ID":207,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false},{"VIENPHI_ID":1379,"TIEPNHAN_ID":208,"DICHVU_ID":4681,"BENHAN_ID":10,"SOLUONG":1.0000,"DONGIA_DOANHTHU":21400.0000,"THANHTIEN_DOANHTHU":21400.00,"BHYT_TL":0.0,"BHYT_DONGIA":21400.0000,"BHYT_THANHTIEN":21400.00,"BHYT_DONGIA_CONGKHAM_DAU":0.0,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":21400.00,"GIATRI_HOADON":21400.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"GB438382336470038664","SOBHYT_HUONG_ID":207,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false},{"VIENPHI_ID":1380,"TIEPNHAN_ID":208,"DICHVU_ID":4671,"BENHAN_ID":10,"SOLUONG":1.0000,"DONGIA_DOANHTHU":28900.0000,"THANHTIEN_DOANHTHU":28900.00,"BHYT_TL":0.0,"BHYT_DONGIA":28900.0000,"BHYT_THANHTIEN":28900.00,"BHYT_DONGIA_CONGKHAM_DAU":0.0,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":28900.00,"GIATRI_HOADON":28900.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"GB438382336470038664","SOBHYT_HUONG_ID":207,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false},{"VIENPHI_ID":1382,"TIEPNHAN_ID":208,"DICHVU_ID":4017,"BENHAN_ID":10,"SOLUONG":1.0000,"DONGIA_DOANHTHU":42100.0000,"THANHTIEN_DOANHTHU":42100.00,"BHYT_TL":0.0,"BHYT_DONGIA":42100.0000,"BHYT_THANHTIEN":42100.00,"BHYT_DONGIA_CONGKHAM_DAU":0.0,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":42100.00,"GIATRI_HOADON":42100.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"GB438382336470038664","SOBHYT_HUONG_ID":207,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false},{"VIENPHI_ID":1383,"TIEPNHAN_ID":208,"DICHVU_ID":4129,"BENHAN_ID":10,"SOLUONG":1.0000,"DONGIA_DOANHTHU":64200.0000,"THANHTIEN_DOANHTHU":64200.00,"BHYT_TL":0.0,"BHYT_DONGIA":64200.0000,"BHYT_THANHTIEN":64200.00,"BHYT_DONGIA_CONGKHAM_DAU":0.0,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":64200.00,"GIATRI_HOADON":64200.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"GB438382336470038664","SOBHYT_HUONG_ID":207,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false},{"VIENPHI_ID":1393,"TIEPNHAN_ID":208,"DICHVU_ID":4008,"BENHAN_ID":10,"SOLUONG":1.0000,"DONGIA_DOANHTHU":42100.0000,"THANHTIEN_DOANHTHU":42100.00,"BHYT_TL":0.0,"BHYT_DONGIA":42100.0000,"BHYT_THANHTIEN":42100.00,"BHYT_DONGIA_CONGKHAM_DAU":0.0,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":42100.00,"GIATRI_HOADON":42100.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"GB438382336470038664","SOBHYT_HUONG_ID":207,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false},{"VIENPHI_ID":2516,"TIEPNHAN_ID":208,"DICHVU_ID":null,"BENHAN_ID":10,"SOLUONG":2.0000,"DONGIA_DOANHTHU":9999.0000,"THANHTIEN_DOANHTHU":19998.00,"BHYT_TL":0.0,"BHYT_DONGIA":7999.0000,"BHYT_THANHTIEN":15998.00,"BHYT_DONGIA_CONGKHAM_DAU":0.0,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":19998.00,"GIATRI_HOADON":15998.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"GB438382336470038664","SOBHYT_HUONG_ID":207,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false},{"VIENPHI_ID":2524,"TIEPNHAN_ID":208,"DICHVU_ID":null,"BENHAN_ID":10,"SOLUONG":2.0000,"DONGIA_DOANHTHU":9999.0000,"THANHTIEN_DOANHTHU":19998.00,"BHYT_TL":0.0,"BHYT_DONGIA":7999.0000,"BHYT_THANHTIEN":15998.00,"BHYT_DONGIA_CONGKHAM_DAU":0.0,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":19998.00,"GIATRI_HOADON":15998.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"GB438382336470038664","SOBHYT_HUONG_ID":207,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false},{"VIENPHI_ID":2525,"TIEPNHAN_ID":208,"DICHVU_ID":null,"BENHAN_ID":10,"SOLUONG":1.0000,"DONGIA_DOANHTHU":11030.0000,"THANHTIEN_DOANHTHU":11030.00,"BHYT_TL":0.0,"BHYT_DONGIA":9030.0000,"BHYT_THANHTIEN":9030.00,"BHYT_DONGIA_CONGKHAM_DAU":0.0,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":11030.00,"GIATRI_HOADON":9030.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"GB438382336470038664","SOBHYT_HUONG_ID":207,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false},{"VIENPHI_ID":2526,"TIEPNHAN_ID":208,"DICHVU_ID":null,"BENHAN_ID":10,"SOLUONG":1.0000,"DONGIA_DOANHTHU":10925.0000,"THANHTIEN_DOANHTHU":10925.00,"BHYT_TL":0.0,"BHYT_DONGIA":8925.0000,"BHYT_THANHTIEN":8925.00,"BHYT_DONGIA_CONGKHAM_DAU":0.0,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":10925.00,"GIATRI_HOADON":8925.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"GB438382336470038664","SOBHYT_HUONG_ID":207,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false},{"VIENPHI_ID":2956,"TIEPNHAN_ID":208,"DICHVU_ID":null,"BENHAN_ID":10,"SOLUONG":1.0000,"DONGIA_DOANHTHU":630.0000,"THANHTIEN_DOANHTHU":630.00,"BHYT_TL":0.0,"BHYT_DONGIA":630.0000,"BHYT_THANHTIEN":630.00,"BHYT_DONGIA_CONGKHAM_DAU":0.0,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":630.00,"GIATRI_HOADON":630.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"GB438382336470038664","SOBHYT_HUONG_ID":207,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false},{"VIENPHI_ID":2957,"TIEPNHAN_ID":208,"DICHVU_ID":null,"BENHAN_ID":10,"SOLUONG":2.0000,"DONGIA_DOANHTHU":4000.0000,"THANHTIEN_DOANHTHU":8000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":0.0,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":8000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"GB438382336470038664","SOBHYT_HUONG_ID":207,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false},{"VIENPHI_ID":2958,"TIEPNHAN_ID":208,"DICHVU_ID":null,"BENHAN_ID":10,"SOLUONG":1.0000,"DONGIA_DOANHTHU":6410.0000,"THANHTIEN_DOANHTHU":6410.00,"BHYT_TL":0.0,"BHYT_DONGIA":4410.0000,"BHYT_THANHTIEN":4410.00,"BHYT_DONGIA_CONGKHAM_DAU":0.0,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":6410.00,"GIATRI_HOADON":4410.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"GB438382336470038664","SOBHYT_HUONG_ID":207,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false},{"VIENPHI_ID":2959,"TIEPNHAN_ID":208,"DICHVU_ID":null,"BENHAN_ID":10,"SOLUONG":2.0000,"DONGIA_DOANHTHU":4000.0000,"THANHTIEN_DOANHTHU":8000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":0.0,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":8000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"GB438382336470038664","SOBHYT_HUONG_ID":207,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false},{"VIENPHI_ID":5092,"TIEPNHAN_ID":208,"DICHVU_ID":null,"BENHAN_ID":10,"SOLUONG":0.0,"DONGIA_DOANHTHU":11030.0000,"THANHTIEN_DOANHTHU":0.0,"BHYT_TL":0.0,"BHYT_DONGIA":9030.0000,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":0.0,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"GB438382336470038664","SOBHYT_HUONG_ID":207,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false},{"VIENPHI_ID":5093,"TIEPNHAN_ID":208,"DICHVU_ID":null,"BENHAN_ID":10,"SOLUONG":0.0,"DONGIA_DOANHTHU":10925.0000,"THANHTIEN_DOANHTHU":0.0,"BHYT_TL":0.0,"BHYT_DONGIA":8925.0000,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":0.0,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"GB438382336470038664","SOBHYT_HUONG_ID":207,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false},{"VIENPHI_ID":5095,"TIEPNHAN_ID":208,"DICHVU_ID":null,"BENHAN_ID":10,"SOLUONG":0.0,"DONGIA_DOANHTHU":6410.0000,"THANHTIEN_DOANHTHU":0.0,"BHYT_TL":0.0,"BHYT_DONGIA":4410.0000,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":0.0,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"GB438382336470038664","SOBHYT_HUONG_ID":207,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false},{"VIENPHI_ID":5096,"TIEPNHAN_ID":208,"DICHVU_ID":null,"BENHAN_ID":10,"SOLUONG":0.0,"DONGIA_DOANHTHU":4000.0000,"THANHTIEN_DOANHTHU":0.0,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":0.0,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"GB438382336470038664","SOBHYT_HUONG_ID":207,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false},{"VIENPHI_ID":6131,"TIEPNHAN_ID":208,"DICHVU_ID":5482,"BENHAN_ID":10,"SOLUONG":1.0000,"DONGIA_DOANHTHU":178000.0000,"THANHTIEN_DOANHTHU":178000.00,"BHYT_TL":0.0,"BHYT_DONGIA":178000.0000,"BHYT_THANHTIEN":178000.00,"BHYT_DONGIA_CONGKHAM_DAU":0.0,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":178000.00,"GIATRI_HOADON":178000.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"GB438382336470038664","SOBHYT_HUONG_ID":207,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false},{"VIENPHI_ID":6132,"TIEPNHAN_ID":208,"DICHVU_ID":5365,"BENHAN_ID":10,"SOLUONG":1.0000,"DONGIA_DOANHTHU":20000.0000,"THANHTIEN_DOANHTHU":20000.00,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":0.0,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":20000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"GB438382336470038664","SOBHYT_HUONG_ID":207,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false}]';        begin        UPDATE TT_VIENPHI        SET        SOLUONG = json.SOLUONG,        DONGIA_DOANHTHU = json.DONGIA_DOANHTHU,        THANHTIEN_DOANHTHU = json.THANHTIEN_DOANHTHU,        BHYT_TL = json.BHYT_TL,        BHYT_DONGIA = json.BHYT_DONGIA,        BHYT_THANHTIEN = json.BHYT_THANHTIEN,        BHYT_DONGIA_CONGKHAM_DAU = json.BHYT_DONGIA_CONGKHAM_DAU,        BHYT_CONGKHAM_DAU_TYLE = json.BHYT_CONGKHAM_DAU_TYLE,        BHYT_DONGIA_CHITRA = json.BHYT_DONGIA_CHITRA,        BHYT_THANHTIEN_CHITRA = json.BHYT_THANHTIEN_CHITRA,        BENHNHAN_PHAITHANHTOAN = json.BENHNHAN_PHAITHANHTOAN,        GIATRI_HOADON = json.GIATRI_HOADON,                GIATRI_BIENLAI = json.GIATRI_BIENLAI,                DATHUCHIEN = json.DATHUCHIEN,                DICHVU_TL = json.DICHVU_TL,        BHYT_DONGIA_DONGCT_DAU = json.BHYT_DONGIA_DONGCT_DAU,        NGAYCAPNHAT = GETDATE()        FROM OPENJSON (@jsonVienPhi)        WITH (        VIENPHI_ID int,        SOLUONG numeric(25, 4),        DONGIA_DOANHTHU numeric(25, 4),        THANHTIEN_DOANHTHU numeric(25, 4),        BHYT_TL numeric(25, 4),        BHYT_DONGIA numeric(25, 4),        BHYT_THANHTIEN numeric(25, 4),        BHYT_DONGIA_CONGKHAM_DAU numeric(25, 4),        BHYT_CONGKHAM_DAU_TYLE numeric(25, 4),        BHYT_DONGIA_CHITRA numeric(25, 4),        BHYT_THANHTIEN_CHITRA numeric(25, 4),        BENHNHAN_PHAITHANHTOAN numeric(25, 4),        GIATRI_HOADON numeric(25, 4),                GIATRI_BIENLAI numeric(25, 4),                DATHUCHIEN char(1),        KHONGTHUTIEN char(1),        BHYTDONGTIEN char(1),        DICHVU_TL numeric(25, 4),        BHYT_DONGIA_DONGCT_DAU numeric(25, 4))  json        WHERE TT_VIENPHI.VIENPHI_ID = json.VIENPHI_ID and json.DONGIA_DOANHTHU > 0                  insert into TT_TINH_VIENPHI_LOG        SELECT json.VIENPHI_ID, json.TIEPNHAN_ID, json.BENHAN_ID, json.SOLUONG, json.BHYT_TL, json.DONGIA_DOANHTHU,        json.THANHTIEN_DOANHTHU, json.BHYT_DONGIA, json.BHYT_THANHTIEN, json.BHYT_DONGIA_CHITRA, json.BHYT_THANHTIEN_CHITRA, json.BENHNHAN_PHAITHANHTOAN,        json.SOBHYT_HUONG_ID, json.SOBHYT, GETDATE(), -1, 'HLU01'        FROM OPENJSON(@jsonVienPhi)        WITH (        VIENPHI_ID int,        TIEPNHAN_ID int,        BENHAN_ID int,        SOLUONG numeric(25, 4),        DONGIA_DOANHTHU numeric(25, 4),        THANHTIEN_DOANHTHU numeric(25, 4),        BHYT_TL numeric(25, 4),        BHYT_DONGIA numeric(25, 4),        BHYT_THANHTIEN numeric(25, 4),        BHYT_DONGIA_CHITRA numeric(25, 4),        BHYT_THANHTIEN_CHITRA numeric(25, 4),        BENHNHAN_PHAITHANHTOAN numeric(25, 4),        SOBHYT_HUONG_ID int,        SOBHYT nvarchar(30)) json        end]
2019-12-17 11:35:42,595 [1] DEBUG - Statement Id: [DAO00067_UpdateDataVienPhiDongiaBHYT] PreparedStatement : [update TT_VIENPHI          set BHYT_DONGIA_CHITRA = 0, BHYT_THANHTIEN = 0, BHYT_THANHTIEN_CHITRA = 0          where          TIEPNHAN_ID = 208 and BHYT_DONGIA = 0          and (BHYT_DONGIA_CHITRA > 0 or BHYT_THANHTIEN > 0 or BHYT_THANHTIEN_CHITRA > 0)]
2019-12-17 11:35:42,638 [1] DEBUG - Statement Id: [DAO00067_CapnhatDataVienphiKhiHuyThanhtoanHoadon] PreparedStatement : [update TT_VIENPHI        set TT_VIENPHI.HOADON_ID = hdct.HOADON_ID, TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN = TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN + hdct.GIATRI_BENHNHAN_DATHANHTOAN        from (select CT.HOADON_ID, CT.VIENPHI_ID, CT.GIATRI_BENHNHAN_DATHANHTOAN        from TT_HOADON_CHITIET_NGOAITRU CT        join TT_HOADON HD on HD.HOADON_ID = CT.HOADON_ID        join TT_VIENPHI vp on vp.VIENPHI_ID = ct.VIENPHI_ID        where HD.DATHANHTOAN = 1 and HD.HUYHOADON = 0 and HD.HOANTRA = 0 and vp.TIEPNHAN_ID =  @param0 ) hdct        where        TT_VIENPHI.VIENPHI_ID = hdct.VIENPHI_ID and TT_VIENPHI.HOADON_ID is null and isnull(TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN,0) = 0        and TT_VIENPHI.TIEPNHAN_ID =  @param0           update TT_VIENPHI        set TT_VIENPHI.HOADON_ID = null, TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN = TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN - hdct.GIATRI_BENHNHAN_DATHANHTOAN,        TT_VIENPHI.DATHANHTOAN = '0'        from (select CT.HOADON_ID, CT.VIENPHI_ID, CT.GIATRI_BENHNHAN_DATHANHTOAN        from TT_HOADON_CHITIET_NGOAITRU CT        join TT_HOADON HD on HD.HOADON_ID = CT.HOADON_ID        join TT_VIENPHI vp on vp.VIENPHI_ID = ct.VIENPHI_ID and vp.HOADON_ID = ct.HOADON_ID        where HD.DATHANHTOAN = 0 and (HD.HUYHOADON = 1 or HD.HOANTRA = 1) and vp.TIEPNHAN_ID =  @param0 ) hdct        where        TT_VIENPHI.VIENPHI_ID = hdct.VIENPHI_ID and TT_VIENPHI.HOADON_ID = hdct.HOADON_ID        and TT_VIENPHI.TIEPNHAN_ID =  @param0]
2019-12-17 11:35:42,638 [1] DEBUG - Statement Id: [DAO00067_CapnhatDataVienphiKhiHuyThanhtoanHoadon] Parameters: [@param0=[TIEPNHAN_ID,208]]
2019-12-17 11:35:42,638 [1] DEBUG - Statement Id: [DAO00067_CapnhatDataVienphiKhiHuyThanhtoanHoadon] Types: [@param0=[Int64, System.Int64]]
2019-12-17 11:35:57,896 [1] DEBUG - Statement Id: [DAO00068_GetTTBenhAnByBenhNhanID] PreparedStatement : [select TOP (1) tn.TIEPNHAN_ID, BENHAN_ID, ba.TRANGTHAI              from TT_TIEPNHAN tn              left join TT_NOITRU_BENHAN ba              on tn.TIEPNHAN_ID = ba.TIEPNHAN_ID              where tn.BENHNHAN_ID = '204'              order by tn.NGAYTAO desc]
2019-12-17 11:35:58,003 [1] DEBUG - Statement Id: [DAO00079_GetTT_GiayRaVien_KUB] PreparedStatement : [declare @PhauThuat nvarchar(2000) = ''        select @PhauThuat = @PhauThuat + DV.TENDICHVU + '; '        from TT_DVYEUCAU YC        inner join TM_DICHVU DV on DV.DICHVU_ID = YC.DICHVU_ID and DV.BENHVIEN_ID = YC.BENHVIEN_ID        inner join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID and NDV.BENHVIEN_ID = DV.BENHVIEN_ID        where YC.BENHAN_ID = 10        and SUBSTRING(NDV.MANHOMDICHVU, 1, 2) = '05'        and YC.BENHVIEN_ID = 'HLU01'        and YC.HUYYEUCAU = '0'          declare @HoaChat nvarchar(2000) = ''        select @HoaChat = @HoaChat + D.TENDUOCDAYDU + '; '        from TT_NOITRU_KHAMBENH KB        inner join TT_NOITRU_TOATHUOC TT on TT.KHAMBENH_ID = KB.KHAMBENH_ID and TT.BENHVIEN_ID = KB.BENHVIEN_ID        inner join TM_DUOC D on D.DUOC_ID = TT.DUOC_ID and D.BENHVIEN_ID = TT.BENHVIEN_ID        inner join TM_LOAIDUOC LD on LD.LOAIDUOC_ID = D.LOAIDUOC_ID and LD.BENHVIEN_ID = D.BENHVIEN_ID        where KB.BENHAN_ID = 10        and LD.MALOAIDUOC in ('L006', 'L007')        and KB.BENHVIEN_ID = 'HLU01'        and TT.HUYTOATHUOC = '0'          select BA.BENHAN_ID, BA.TIEPNHAN_ID, BA.BENHNHAN_ID, GRV.CHANDOANMOBENHHOC, ISNULL(GRV.PPDT_PHAUTHUAT, @PhauThuat) AS PPDT_PHAUTHUAT, GRV.PPDT_TIAXA,        ISNULL(GRV.PPDT_HOACHAT, @HoaChat) AS PPDT_HOACHAT, GRV.PPDT_KHAC, ISNULL(GRV.KQDT_MOTA, KQ.DICTIONARY_NAME) AS KQDT_MOTA, BA.KETQUADIEUTRI_ID,        GRV.CHEDOSAURAVIEN, ISNULL(GRV.BACSIDIEUTRI_ID, BA.BACSIDIEUTRI_ID) AS BACSIDIEUTRI_ID, GRV.THUTRUONGDONVI_ID, GRV.GHICHU, GRV.GIAYRAVIEN_ID        from TT_NOITRU_BENHAN BA        left join TT_NOITRU_GIAYRAVIEN_KUB GRV on GRV.BENHAN_ID = BA.BENHAN_ID and GRV.BENHVIEN_ID = BA.BENHVIEN_ID        left join LST_DICTIONARY KQ on KQ.DICTIONARY_ID = BA.KETQUADIEUTRI_ID        where BA.BENHAN_ID = 10        and BA.BENHVIEN_ID = 'HLU01']
2019-12-17 11:37:41,168 [1] DEBUG - Statement Id: [DAO00079_TT_NOITRU_GIAYRAVIEN_KUB_Add] PreparedStatement : [INSERT INTO TT_NOITRU_GIAYRAVIEN_KUB        (BENHNHAN_ID        ,TIEPNHAN_ID        ,BENHAN_ID        ,CHANDOANMOBENHHOC        ,PPDT_PHAUTHUAT        ,PPDT_TIAXA        ,PPDT_HOACHAT        ,PPDT_KHAC        ,KQDT_MOTA        ,CHEDOSAURAVIEN        ,BACSIDIEUTRI_ID        ,THUTRUONGDONVI_ID        ,GHICHU        ,BENHVIEN_ID        ,NGAYTAO        ,NGUOITAO_ID        ) VALUES (         @param0         , @param1         , @param2         , @param3         , @param4         , @param5         , @param6         , @param7         , @param8         , @param9         , @param10         , @param11         , @param12         , @param13         , @param14         , @param15         )        SELECT SCOPE_IDENTITY()]
2019-12-17 11:37:41,168 [1] DEBUG - Statement Id: [DAO00079_TT_NOITRU_GIAYRAVIEN_KUB_Add] Parameters: [@param0=[BENHNHAN_ID,204], @param1=[TIEPNHAN_ID,208], @param2=[BENHAN_ID,10], @param3=[CHANDOANMOBENHHOC,test], @param4=[PPDT_PHAUTHUAT,test], @param5=[PPDT_TIAXA,test], @param6=[PPDT_HOACHAT,test], @param7=[PPDT_KHAC,test], @param8=[KQDT_MOTA,null], @param9=[CHEDOSAURAVIEN,test], @param10=[BACSIDIEUTRI_ID,716], @param11=[THUTRUONGDONVI_ID,42], @param12=[GHICHU,test], @param13=[BENHVIEN_ID,HLU01], @param14=[NGAYTAO,12/17/2019 11:37:41 AM], @param15=[NGUOITAO_ID,1]]
2019-12-17 11:37:41,168 [1] DEBUG - Statement Id: [DAO00079_TT_NOITRU_GIAYRAVIEN_KUB_Add] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64], @param2=[Int64, System.Int64], @param3=[String, System.String], @param4=[String, System.String], @param5=[String, System.String], @param6=[String, System.String], @param7=[String, System.String], @param8=[System.DBNull, null], @param9=[String, System.String], @param10=[Int64, System.Int64], @param11=[Int64, System.Int64], @param12=[String, System.String], @param13=[String, System.String], @param14=[DateTime, System.DateTime], @param15=[Int64, System.Int64]]
2019-12-17 11:37:41,291 [1] DEBUG - Statement Id: [DAO00079_GetTT_GiayRaVien_KUB] PreparedStatement : [declare @PhauThuat nvarchar(2000) = ''        select @PhauThuat = @PhauThuat + DV.TENDICHVU + '; '        from TT_DVYEUCAU YC        inner join TM_DICHVU DV on DV.DICHVU_ID = YC.DICHVU_ID and DV.BENHVIEN_ID = YC.BENHVIEN_ID        inner join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID and NDV.BENHVIEN_ID = DV.BENHVIEN_ID        where YC.BENHAN_ID = 10        and SUBSTRING(NDV.MANHOMDICHVU, 1, 2) = '05'        and YC.BENHVIEN_ID = 'HLU01'        and YC.HUYYEUCAU = '0'          declare @HoaChat nvarchar(2000) = ''        select @HoaChat = @HoaChat + D.TENDUOCDAYDU + '; '        from TT_NOITRU_KHAMBENH KB        inner join TT_NOITRU_TOATHUOC TT on TT.KHAMBENH_ID = KB.KHAMBENH_ID and TT.BENHVIEN_ID = KB.BENHVIEN_ID        inner join TM_DUOC D on D.DUOC_ID = TT.DUOC_ID and D.BENHVIEN_ID = TT.BENHVIEN_ID        inner join TM_LOAIDUOC LD on LD.LOAIDUOC_ID = D.LOAIDUOC_ID and LD.BENHVIEN_ID = D.BENHVIEN_ID        where KB.BENHAN_ID = 10        and LD.MALOAIDUOC in ('L006', 'L007')        and KB.BENHVIEN_ID = 'HLU01'        and TT.HUYTOATHUOC = '0'          select BA.BENHAN_ID, BA.TIEPNHAN_ID, BA.BENHNHAN_ID, GRV.CHANDOANMOBENHHOC, ISNULL(GRV.PPDT_PHAUTHUAT, @PhauThuat) AS PPDT_PHAUTHUAT, GRV.PPDT_TIAXA,        ISNULL(GRV.PPDT_HOACHAT, @HoaChat) AS PPDT_HOACHAT, GRV.PPDT_KHAC, ISNULL(GRV.KQDT_MOTA, KQ.DICTIONARY_NAME) AS KQDT_MOTA, BA.KETQUADIEUTRI_ID,        GRV.CHEDOSAURAVIEN, ISNULL(GRV.BACSIDIEUTRI_ID, BA.BACSIDIEUTRI_ID) AS BACSIDIEUTRI_ID, GRV.THUTRUONGDONVI_ID, GRV.GHICHU, GRV.GIAYRAVIEN_ID        from TT_NOITRU_BENHAN BA        left join TT_NOITRU_GIAYRAVIEN_KUB GRV on GRV.BENHAN_ID = BA.BENHAN_ID and GRV.BENHVIEN_ID = BA.BENHVIEN_ID        left join LST_DICTIONARY KQ on KQ.DICTIONARY_ID = BA.KETQUADIEUTRI_ID        where BA.BENHAN_ID = 10        and BA.BENHVIEN_ID = 'HLU01']
2019-12-17 11:37:57,302 [1] DEBUG - Statement Id: [DAO00068_GetTTBenhAnByBenhNhanID] PreparedStatement : [select TOP (1) tn.TIEPNHAN_ID, BENHAN_ID, ba.TRANGTHAI              from TT_TIEPNHAN tn              left join TT_NOITRU_BENHAN ba              on tn.TIEPNHAN_ID = ba.TIEPNHAN_ID              where tn.BENHNHAN_ID = '204'              order by tn.NGAYTAO desc]
2019-12-17 11:37:57,401 [1] DEBUG - Statement Id: [DAO00079_GetTT_GiayRaVien_KUB] PreparedStatement : [declare @PhauThuat nvarchar(2000) = ''        select @PhauThuat = @PhauThuat + DV.TENDICHVU + '; '        from TT_DVYEUCAU YC        inner join TM_DICHVU DV on DV.DICHVU_ID = YC.DICHVU_ID and DV.BENHVIEN_ID = YC.BENHVIEN_ID        inner join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID and NDV.BENHVIEN_ID = DV.BENHVIEN_ID        where YC.BENHAN_ID = 10        and SUBSTRING(NDV.MANHOMDICHVU, 1, 2) = '05'        and YC.BENHVIEN_ID = 'HLU01'        and YC.HUYYEUCAU = '0'          declare @HoaChat nvarchar(2000) = ''        select @HoaChat = @HoaChat + D.TENDUOCDAYDU + '; '        from TT_NOITRU_KHAMBENH KB        inner join TT_NOITRU_TOATHUOC TT on TT.KHAMBENH_ID = KB.KHAMBENH_ID and TT.BENHVIEN_ID = KB.BENHVIEN_ID        inner join TM_DUOC D on D.DUOC_ID = TT.DUOC_ID and D.BENHVIEN_ID = TT.BENHVIEN_ID        inner join TM_LOAIDUOC LD on LD.LOAIDUOC_ID = D.LOAIDUOC_ID and LD.BENHVIEN_ID = D.BENHVIEN_ID        where KB.BENHAN_ID = 10        and LD.MALOAIDUOC in ('L006', 'L007')        and KB.BENHVIEN_ID = 'HLU01'        and TT.HUYTOATHUOC = '0'          select BA.BENHAN_ID, BA.TIEPNHAN_ID, BA.BENHNHAN_ID, GRV.CHANDOANMOBENHHOC, ISNULL(GRV.PPDT_PHAUTHUAT, @PhauThuat) AS PPDT_PHAUTHUAT, GRV.PPDT_TIAXA,        ISNULL(GRV.PPDT_HOACHAT, @HoaChat) AS PPDT_HOACHAT, GRV.PPDT_KHAC, ISNULL(GRV.KQDT_MOTA, KQ.DICTIONARY_NAME) AS KQDT_MOTA, BA.KETQUADIEUTRI_ID,        GRV.CHEDOSAURAVIEN, ISNULL(GRV.BACSIDIEUTRI_ID, BA.BACSIDIEUTRI_ID) AS BACSIDIEUTRI_ID, GRV.THUTRUONGDONVI_ID, GRV.GHICHU, GRV.GIAYRAVIEN_ID        from TT_NOITRU_BENHAN BA        left join TT_NOITRU_GIAYRAVIEN_KUB GRV on GRV.BENHAN_ID = BA.BENHAN_ID and GRV.BENHVIEN_ID = BA.BENHVIEN_ID        left join LST_DICTIONARY KQ on KQ.DICTIONARY_ID = BA.KETQUADIEUTRI_ID        where BA.BENHAN_ID = 10        and BA.BENHVIEN_ID = 'HLU01']
--------------------------------------------------------------------------------
2019-12-17 11:41:46,793 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2019-12-17 11:41:47,152 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-12-17 11:41:47,253 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-12-17 11:41:47,653 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-17 11:41:47,884 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-12-17 11:42:04,261 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2019-12-17 11:42:04,288 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-12-17 11:42:07,144 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-12-17 11:42:07,233 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-12-17 11:42:08,510 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2019-12-17 11:42:09,044 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2019-12-17 11:42:09,226 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2019-12-17 11:42:09,313 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2019-12-17 11:42:09,484 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2019-12-17 11:42:09,574 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2019-12-17 11:42:09,690 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2019-12-17 11:42:09,768 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2019-12-17 11:42:09,854 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2019-12-17 11:42:10,625 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2019-12-17 11:42:10,721 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2019-12-17 11:42:10,814 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2019-12-17 11:42:10,856 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2019-12-17 11:42:12,089 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2019-12-17 11:42:12,127 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @NGUONDUOC_MACDINH varchar(5) = '0';        declare @TOAMUANGOAI int = 0;        select @NGUONDUOC_MACDINH = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'PHA_NGUONDUOC'        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + @NGUONDUOC_MACDINH as DUOC_KEY, 0 as PHAMVI_ID, @NGUONDUOC_MACDINH as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end        else        begin                  select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2019-12-17 11:42:15,635 [5] DEBUG - Statement Id: [DAO00320_GetList] PreparedStatement : [select M.*            from TM_MAU M            LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID            where            M.TAMNGUNG = '0'            and M.BENHVIEN_ID = 'HLU01'            order by M.TENMAU]
2019-12-17 11:42:15,726 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2019-12-17 11:42:15,783 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,        SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH        FROM TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID        WHERE TK.SOLUONG > 0        GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2019-12-17 11:42:15,940 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2019-12-17 11:42:15,998 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,        TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,        TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH        from TM_MAU M        JOIN        (        select        A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO        from        (        select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO        from TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'        where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0        ) A        )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2019-12-17 11:42:16,136 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2019-12-17 11:42:17,142 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-17 11:42:18,205 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2019-12-17 11:42:24,215 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2019-12-17 11:42:25,344 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2019-12-17 11:42:25,589 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-17 11:42:25,764 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-17 11:42:25,924 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2019-12-17 11:42:25,926 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-12-17 11:42:25,926 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-12-17 11:42:25,958 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2019-12-17 11:42:25,958 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-12-17 11:42:25,958 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-12-17 11:42:26,109 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-17 11:42:26,303 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-17 11:42:36,149 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-17 11:42:36,244 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2019-12-17 11:42:36,555 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2019-12-17 12:51:34,738 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM31'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-17 12:51:35,170 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'IPD80'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-17 12:51:49,842 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'IPD02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-17 12:51:50,192 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'IPD40'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-17 12:51:50,388 [1] DEBUG - Statement Id: [DAO00069_GetCountDanhSachNoiTru] PreparedStatement : [select count(A.SOBENHAN) as TOTALROWS        from TT_NOITRU_BENHAN A        inner join TT_TIEPNHAN B on B.TIEPNHAN_ID = A.TIEPNHAN_ID and (B.TRANGTHAI = 'NOITRU' or B.TRANGTHAI = 'HOANTHANH')        inner join TT_BENHNHAN C on C.BENHNHAN_ID = B.BENHNHAN_ID        left join TT_NOITRU_LUUTRU D on D.BENHAN_ID = A.BENHAN_ID        and D.LUUTRU_ID = ( select top 1 LUUTRU_ID from TT_NOITRU_LUUTRU where BENHAN_ID = A.BENHAN_ID order by BENHAN_ID desc)        left join TT_NOITRU_XACNHAN E on E.BENHAN_ID = A.BENHAN_ID        left join TT_NOITRU_LUUTRUCHITIET F on D.LUUTRU_ID = F.LUUTRU_ID and F.LUUTRUCHITIET_CURRENT = '1'        and F.LUUTRUCHITIET_ID in (select top 1 LUUTRUCHITIET_ID from TT_NOITRU_LUUTRUCHITIET where LUUTRU_ID = D.LUUTRU_ID order by LUUTRUCHITIET_ID desc)        where        A.KHOACHUYENDEN_ID is not null  and        (E.TRANGTHAI = 'DAXACNHAN' OR E.TRANGTHAI = 'HUYXACNHAN')         and           cast(A.NGAYVAOKHOA as date) <= cast('12/17/2019 12:00:00 AM' as date)                 and B.BENHVIEN_ID = 'HLU01' and A.KHOACHUYENDEN_ID = '32'          AND             A.TRANGTHAI in ('DANGDIEUTRI')]
2019-12-17 12:51:50,520 [1] DEBUG - Statement Id: [DAO00069_GetDanhSachNoiTru] PreparedStatement : [select * from        (        SELECT ROW_NUMBER() OVER(order by B.SOTIEPNHAN) as ROWNUMBER,          A.SOBENHAN, A.BENHAN_ID, A.SOLUUTRU                 , E.NOILAP_ID as KHOAVAO_ID        , A.TRANGTHAI, IsNull(A.BACSIDIEUTRI_ID, E.BACSICHIDINH_ID) as BACSIDIEUTRI_ID,        B.TIEPNHAN_ID, B.SOTIEPNHAN, B.SOBHYT as SOTHE, B.DOITUONG_ID, A.NGAYVAOKHOA as NGAYCAPCUU, A.THOIGIANVAOKHOA as THOIGIANCAPCUU,        C.TENBENHNHAN, C.NGAYSINH, C.NAMSINH, C.BENHNHAN_ID, C.MAYTE, F.GIUONGBENH_ID, A.THOIGIANRAVIEN    , DIACHITHUONGTRU, DANTOC_ID        ,BENHVIEN_STT_ID                from TT_NOITRU_BENHAN A        inner join TT_TIEPNHAN B on B.TIEPNHAN_ID = A.TIEPNHAN_ID and (B.TRANGTHAI = 'NOITRU' or B.TRANGTHAI = 'HOANTHANH')        inner join TT_BENHNHAN C on C.BENHNHAN_ID = B.BENHNHAN_ID        left join TT_NOITRU_LUUTRU D on D.BENHAN_ID = A.BENHAN_ID        and D.LUUTRU_ID = ( select top 1 LUUTRU_ID from TT_NOITRU_LUUTRU where BENHAN_ID = A.BENHAN_ID order by LUUTRU_ID desc)        left join TT_NOITRU_XACNHAN E on E.BENHAN_ID = A.BENHAN_ID        left join TT_NOITRU_LUUTRUCHITIET F on D.LUUTRU_ID = F.LUUTRU_ID and F.LUUTRUCHITIET_CURRENT = '1'        and F.LUUTRUCHITIET_ID in (select top 1 LUUTRUCHITIET_ID from TT_NOITRU_LUUTRUCHITIET where LUUTRU_ID = D.LUUTRU_ID order by LUUTRUCHITIET_ID desc)        left join (select MABENHVIEN, BENHVIEN_STT_ID from TM_BENHVIEN) H on SUBSTRING(B.SOBHYT, 16, 5)=H.MABENHVIEN        where        A.KHOACHUYENDEN_ID is not null  and        (E.TRANGTHAI = 'DAXACNHAN' OR E.TRANGTHAI = 'HUYXACNHAN')         and           cast(A.NGAYVAOKHOA as date) <= cast('12/17/2019 12:00:00 AM' as date)                 and B.BENHVIEN_ID = 'HLU01' and A.KHOACHUYENDEN_ID = '32'          AND             A.TRANGTHAI in ('DANGDIEUTRI')                   ) lst        where        lst.ROWNUMBER between 1 and 5        order by lst.SOTIEPNHAN]
2019-12-17 12:51:51,671 [1] DEBUG - Statement Id: [DAO00069_GetCountDanhSachNoiTru] PreparedStatement : [select count(A.SOBENHAN) as TOTALROWS        from TT_NOITRU_BENHAN A        inner join TT_TIEPNHAN B on B.TIEPNHAN_ID = A.TIEPNHAN_ID and (B.TRANGTHAI = 'NOITRU' or B.TRANGTHAI = 'HOANTHANH')        inner join TT_BENHNHAN C on C.BENHNHAN_ID = B.BENHNHAN_ID        left join TT_NOITRU_LUUTRU D on D.BENHAN_ID = A.BENHAN_ID        and D.LUUTRU_ID = ( select top 1 LUUTRU_ID from TT_NOITRU_LUUTRU where BENHAN_ID = A.BENHAN_ID order by BENHAN_ID desc)        left join TT_NOITRU_XACNHAN E on E.BENHAN_ID = A.BENHAN_ID        left join TT_NOITRU_LUUTRUCHITIET F on D.LUUTRU_ID = F.LUUTRU_ID and F.LUUTRUCHITIET_CURRENT = '1'        and F.LUUTRUCHITIET_ID in (select top 1 LUUTRUCHITIET_ID from TT_NOITRU_LUUTRUCHITIET where LUUTRU_ID = D.LUUTRU_ID order by LUUTRUCHITIET_ID desc)        where        A.KHOACHUYENDEN_ID is not null  and        (E.TRANGTHAI = 'DAXACNHAN' OR E.TRANGTHAI = 'HUYXACNHAN')         and           cast(A.NGAYVAOKHOA as date) <= cast('12/17/2019 12:00:00 AM' as date)                 and B.BENHVIEN_ID = 'HLU01' and A.KHOACHUYENDEN_ID = '32'          AND             A.TRANGTHAI in ('DANGDIEUTRI')]
2019-12-17 12:51:51,862 [1] DEBUG - Statement Id: [DAO00069_GetDanhSachNoiTru] PreparedStatement : [select * from        (        SELECT ROW_NUMBER() OVER(order by B.SOTIEPNHAN) as ROWNUMBER,          A.SOBENHAN, A.BENHAN_ID, A.SOLUUTRU                 , E.NOILAP_ID as KHOAVAO_ID        , A.TRANGTHAI, IsNull(A.BACSIDIEUTRI_ID, E.BACSICHIDINH_ID) as BACSIDIEUTRI_ID,        B.TIEPNHAN_ID, B.SOTIEPNHAN, B.SOBHYT as SOTHE, B.DOITUONG_ID, A.NGAYVAOKHOA as NGAYCAPCUU, A.THOIGIANVAOKHOA as THOIGIANCAPCUU,        C.TENBENHNHAN, C.NGAYSINH, C.NAMSINH, C.BENHNHAN_ID, C.MAYTE, F.GIUONGBENH_ID, A.THOIGIANRAVIEN    , DIACHITHUONGTRU, DANTOC_ID        ,BENHVIEN_STT_ID                from TT_NOITRU_BENHAN A        inner join TT_TIEPNHAN B on B.TIEPNHAN_ID = A.TIEPNHAN_ID and (B.TRANGTHAI = 'NOITRU' or B.TRANGTHAI = 'HOANTHANH')        inner join TT_BENHNHAN C on C.BENHNHAN_ID = B.BENHNHAN_ID        left join TT_NOITRU_LUUTRU D on D.BENHAN_ID = A.BENHAN_ID        and D.LUUTRU_ID = ( select top 1 LUUTRU_ID from TT_NOITRU_LUUTRU where BENHAN_ID = A.BENHAN_ID order by LUUTRU_ID desc)        left join TT_NOITRU_XACNHAN E on E.BENHAN_ID = A.BENHAN_ID        left join TT_NOITRU_LUUTRUCHITIET F on D.LUUTRU_ID = F.LUUTRU_ID and F.LUUTRUCHITIET_CURRENT = '1'        and F.LUUTRUCHITIET_ID in (select top 1 LUUTRUCHITIET_ID from TT_NOITRU_LUUTRUCHITIET where LUUTRU_ID = D.LUUTRU_ID order by LUUTRUCHITIET_ID desc)        left join (select MABENHVIEN, BENHVIEN_STT_ID from TM_BENHVIEN) H on SUBSTRING(B.SOBHYT, 16, 5)=H.MABENHVIEN        where        A.KHOACHUYENDEN_ID is not null  and        (E.TRANGTHAI = 'DAXACNHAN' OR E.TRANGTHAI = 'HUYXACNHAN')         and           cast(A.NGAYVAOKHOA as date) <= cast('12/17/2019 12:00:00 AM' as date)                 and B.BENHVIEN_ID = 'HLU01' and A.KHOACHUYENDEN_ID = '32'          AND             A.TRANGTHAI in ('DANGDIEUTRI')                   ) lst        where        lst.ROWNUMBER between 1 and 5        order by lst.SOTIEPNHAN]
2019-12-17 12:51:54,885 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'IPD42'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-17 12:51:55,042 [1] DEBUG - Statement Id: [DAO00069_GetCountDanhSachNoiTru] PreparedStatement : [select count(A.SOBENHAN) as TOTALROWS        from TT_NOITRU_BENHAN A        inner join TT_TIEPNHAN B on B.TIEPNHAN_ID = A.TIEPNHAN_ID and (B.TRANGTHAI = 'NOITRU' or B.TRANGTHAI = 'HOANTHANH')        inner join TT_BENHNHAN C on C.BENHNHAN_ID = B.BENHNHAN_ID        left join TT_NOITRU_LUUTRU D on D.BENHAN_ID = A.BENHAN_ID        and D.LUUTRU_ID = ( select top 1 LUUTRU_ID from TT_NOITRU_LUUTRU where BENHAN_ID = A.BENHAN_ID order by BENHAN_ID desc)        left join TT_NOITRU_XACNHAN E on E.BENHAN_ID = A.BENHAN_ID        left join TT_NOITRU_LUUTRUCHITIET F on D.LUUTRU_ID = F.LUUTRU_ID and F.LUUTRUCHITIET_CURRENT = '1'        and F.LUUTRUCHITIET_ID in (select top 1 LUUTRUCHITIET_ID from TT_NOITRU_LUUTRUCHITIET where LUUTRU_ID = D.LUUTRU_ID order by LUUTRUCHITIET_ID desc)        where        A.KHOACHUYENDEN_ID is not null  and        (E.TRANGTHAI = 'DAXACNHAN' OR E.TRANGTHAI = 'HUYXACNHAN')         and           cast(A.NGAYVAOKHOA as date) <= cast('12/17/2019 12:00:00 AM' as date)                 and B.BENHVIEN_ID = 'HLU01' and A.KHOACHUYENDEN_ID = '32'          AND             A.TRANGTHAI in ('DAXUATVIEN','DATHANHTOAN')]
2019-12-17 12:51:55,217 [1] DEBUG - Statement Id: [DAO00069_GetDanhSachNoiTru] PreparedStatement : [select * from        (        SELECT ROW_NUMBER() OVER(order by B.SOTIEPNHAN) as ROWNUMBER,          A.SOBENHAN, A.BENHAN_ID, A.SOLUUTRU                 , E.NOILAP_ID as KHOAVAO_ID        , A.TRANGTHAI, IsNull(A.BACSIDIEUTRI_ID, E.BACSICHIDINH_ID) as BACSIDIEUTRI_ID,        B.TIEPNHAN_ID, B.SOTIEPNHAN, B.SOBHYT as SOTHE, B.DOITUONG_ID, A.NGAYVAOKHOA as NGAYCAPCUU, A.THOIGIANVAOKHOA as THOIGIANCAPCUU,        C.TENBENHNHAN, C.NGAYSINH, C.NAMSINH, C.BENHNHAN_ID, C.MAYTE, F.GIUONGBENH_ID, A.THOIGIANRAVIEN    , DIACHITHUONGTRU, DANTOC_ID        ,BENHVIEN_STT_ID                from TT_NOITRU_BENHAN A        inner join TT_TIEPNHAN B on B.TIEPNHAN_ID = A.TIEPNHAN_ID and (B.TRANGTHAI = 'NOITRU' or B.TRANGTHAI = 'HOANTHANH')        inner join TT_BENHNHAN C on C.BENHNHAN_ID = B.BENHNHAN_ID        left join TT_NOITRU_LUUTRU D on D.BENHAN_ID = A.BENHAN_ID        and D.LUUTRU_ID = ( select top 1 LUUTRU_ID from TT_NOITRU_LUUTRU where BENHAN_ID = A.BENHAN_ID order by LUUTRU_ID desc)        left join TT_NOITRU_XACNHAN E on E.BENHAN_ID = A.BENHAN_ID        left join TT_NOITRU_LUUTRUCHITIET F on D.LUUTRU_ID = F.LUUTRU_ID and F.LUUTRUCHITIET_CURRENT = '1'        and F.LUUTRUCHITIET_ID in (select top 1 LUUTRUCHITIET_ID from TT_NOITRU_LUUTRUCHITIET where LUUTRU_ID = D.LUUTRU_ID order by LUUTRUCHITIET_ID desc)        left join (select MABENHVIEN, BENHVIEN_STT_ID from TM_BENHVIEN) H on SUBSTRING(B.SOBHYT, 16, 5)=H.MABENHVIEN        where        A.KHOACHUYENDEN_ID is not null  and        (E.TRANGTHAI = 'DAXACNHAN' OR E.TRANGTHAI = 'HUYXACNHAN')         and           cast(A.NGAYVAOKHOA as date) <= cast('12/17/2019 12:00:00 AM' as date)                 and B.BENHVIEN_ID = 'HLU01' and A.KHOACHUYENDEN_ID = '32'          AND             A.TRANGTHAI in ('DAXUATVIEN','DATHANHTOAN')                   ) lst        where        lst.ROWNUMBER between 1 and 5        order by lst.SOTIEPNHAN]
2019-12-17 12:52:45,155 [1] DEBUG - Statement Id: [DAO00069_GetCountDanhSachNoiTru] PreparedStatement : [select count(A.SOBENHAN) as TOTALROWS        from TT_NOITRU_BENHAN A        inner join TT_TIEPNHAN B on B.TIEPNHAN_ID = A.TIEPNHAN_ID and (B.TRANGTHAI = 'NOITRU' or B.TRANGTHAI = 'HOANTHANH')        inner join TT_BENHNHAN C on C.BENHNHAN_ID = B.BENHNHAN_ID        left join TT_NOITRU_LUUTRU D on D.BENHAN_ID = A.BENHAN_ID        and D.LUUTRU_ID = ( select top 1 LUUTRU_ID from TT_NOITRU_LUUTRU where BENHAN_ID = A.BENHAN_ID order by BENHAN_ID desc)        left join TT_NOITRU_XACNHAN E on E.BENHAN_ID = A.BENHAN_ID        left join TT_NOITRU_LUUTRUCHITIET F on D.LUUTRU_ID = F.LUUTRU_ID and F.LUUTRUCHITIET_CURRENT = '1'        and F.LUUTRUCHITIET_ID in (select top 1 LUUTRUCHITIET_ID from TT_NOITRU_LUUTRUCHITIET where LUUTRU_ID = D.LUUTRU_ID order by LUUTRUCHITIET_ID desc)        where        A.KHOACHUYENDEN_ID is not null  and        (E.TRANGTHAI = 'DAXACNHAN' OR E.TRANGTHAI = 'HUYXACNHAN')         and           cast(A.NGAYVAOKHOA as date) <= cast('12/17/2019 12:00:00 AM' as date)                 and B.BENHVIEN_ID = 'HLU01' and A.KHOACHUYENDEN_ID = '32'          AND             A.TRANGTHAI in ('DAXUATVIEN','DATHANHTOAN')]
2019-12-17 12:52:45,259 [1] DEBUG - Statement Id: [DAO00069_GetDanhSachNoiTru] PreparedStatement : [select * from        (        SELECT ROW_NUMBER() OVER(order by B.SOTIEPNHAN) as ROWNUMBER,          A.SOBENHAN, A.BENHAN_ID, A.SOLUUTRU                 , E.NOILAP_ID as KHOAVAO_ID        , A.TRANGTHAI, IsNull(A.BACSIDIEUTRI_ID, E.BACSICHIDINH_ID) as BACSIDIEUTRI_ID,        B.TIEPNHAN_ID, B.SOTIEPNHAN, B.SOBHYT as SOTHE, B.DOITUONG_ID, A.NGAYVAOKHOA as NGAYCAPCUU, A.THOIGIANVAOKHOA as THOIGIANCAPCUU,        C.TENBENHNHAN, C.NGAYSINH, C.NAMSINH, C.BENHNHAN_ID, C.MAYTE, F.GIUONGBENH_ID, A.THOIGIANRAVIEN    , DIACHITHUONGTRU, DANTOC_ID        ,BENHVIEN_STT_ID                from TT_NOITRU_BENHAN A        inner join TT_TIEPNHAN B on B.TIEPNHAN_ID = A.TIEPNHAN_ID and (B.TRANGTHAI = 'NOITRU' or B.TRANGTHAI = 'HOANTHANH')        inner join TT_BENHNHAN C on C.BENHNHAN_ID = B.BENHNHAN_ID        left join TT_NOITRU_LUUTRU D on D.BENHAN_ID = A.BENHAN_ID        and D.LUUTRU_ID = ( select top 1 LUUTRU_ID from TT_NOITRU_LUUTRU where BENHAN_ID = A.BENHAN_ID order by LUUTRU_ID desc)        left join TT_NOITRU_XACNHAN E on E.BENHAN_ID = A.BENHAN_ID        left join TT_NOITRU_LUUTRUCHITIET F on D.LUUTRU_ID = F.LUUTRU_ID and F.LUUTRUCHITIET_CURRENT = '1'        and F.LUUTRUCHITIET_ID in (select top 1 LUUTRUCHITIET_ID from TT_NOITRU_LUUTRUCHITIET where LUUTRU_ID = D.LUUTRU_ID order by LUUTRUCHITIET_ID desc)        left join (select MABENHVIEN, BENHVIEN_STT_ID from TM_BENHVIEN) H on SUBSTRING(B.SOBHYT, 16, 5)=H.MABENHVIEN        where        A.KHOACHUYENDEN_ID is not null  and        (E.TRANGTHAI = 'DAXACNHAN' OR E.TRANGTHAI = 'HUYXACNHAN')         and           cast(A.NGAYVAOKHOA as date) <= cast('12/17/2019 12:00:00 AM' as date)                 and B.BENHVIEN_ID = 'HLU01' and A.KHOACHUYENDEN_ID = '32'          AND             A.TRANGTHAI in ('DAXUATVIEN','DATHANHTOAN')                   ) lst        where        lst.ROWNUMBER between 21 and 25        order by lst.SOTIEPNHAN]
2019-12-17 12:52:57,302 [1] DEBUG - Statement Id: [DAO00068_GetTTBenhAnByBenhNhanID] PreparedStatement : [select TOP (1) tn.TIEPNHAN_ID, BENHAN_ID, ba.TRANGTHAI              from TT_TIEPNHAN tn              left join TT_NOITRU_BENHAN ba              on tn.TIEPNHAN_ID = ba.TIEPNHAN_ID              where tn.BENHNHAN_ID = '8167'              order by tn.NGAYTAO desc]
2019-12-17 12:52:57,452 [1] DEBUG - Statement Id: [DAO00079_GetTT_GiayRaVien_KUB] PreparedStatement : [declare @PhauThuat nvarchar(2000) = ''        select @PhauThuat = @PhauThuat + DV.TENDICHVU + '; '        from TT_DVYEUCAU YC        inner join TM_DICHVU DV on DV.DICHVU_ID = YC.DICHVU_ID and DV.BENHVIEN_ID = YC.BENHVIEN_ID        inner join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID and NDV.BENHVIEN_ID = DV.BENHVIEN_ID        where YC.BENHAN_ID = 5646        and SUBSTRING(NDV.MANHOMDICHVU, 1, 2) = '05'        and YC.BENHVIEN_ID = 'HLU01'        and YC.HUYYEUCAU = '0'          declare @HoaChat nvarchar(2000) = ''        select @HoaChat = @HoaChat + D.TENDUOCDAYDU + '; '        from TT_NOITRU_KHAMBENH KB        inner join TT_NOITRU_TOATHUOC TT on TT.KHAMBENH_ID = KB.KHAMBENH_ID and TT.BENHVIEN_ID = KB.BENHVIEN_ID        inner join TM_DUOC D on D.DUOC_ID = TT.DUOC_ID and D.BENHVIEN_ID = TT.BENHVIEN_ID        inner join TM_LOAIDUOC LD on LD.LOAIDUOC_ID = D.LOAIDUOC_ID and LD.BENHVIEN_ID = D.BENHVIEN_ID        where KB.BENHAN_ID = 5646        and LD.MALOAIDUOC in ('L006', 'L007')        and KB.BENHVIEN_ID = 'HLU01'        and TT.HUYTOATHUOC = '0'          select BA.BENHAN_ID, BA.TIEPNHAN_ID, BA.BENHNHAN_ID, GRV.CHANDOANMOBENHHOC, ISNULL(GRV.PPDT_PHAUTHUAT, @PhauThuat) AS PPDT_PHAUTHUAT, GRV.PPDT_TIAXA,        ISNULL(GRV.PPDT_HOACHAT, @HoaChat) AS PPDT_HOACHAT, GRV.PPDT_KHAC, ISNULL(GRV.KETQUADIEUTRI_MOTA, KQ.DICTIONARY_NAME) AS KETQUADIEUTRI_MOTA, BA.KETQUADIEUTRI_ID,        GRV.CHEDOSAURAVIEN, ISNULL(GRV.BACSIDIEUTRI_ID, BA.BACSIDIEUTRI_ID) AS BACSIDIEUTRI_ID, GRV.THUTRUONGDONVI_ID, GRV.GHICHU, GRV.GIAYRAVIEN_ID        from TT_NOITRU_BENHAN BA        left join TT_NOITRU_GIAYRAVIEN_KUB GRV on GRV.BENHAN_ID = BA.BENHAN_ID and GRV.BENHVIEN_ID = BA.BENHVIEN_ID        left join LST_DICTIONARY KQ on KQ.DICTIONARY_ID = BA.KETQUADIEUTRI_ID        where BA.BENHAN_ID = 5646        and BA.BENHVIEN_ID = 'HLU01']
2019-12-17 12:53:29,965 [1] DEBUG - Statement Id: [DAO00079_TT_NOITRU_GIAYRAVIEN_KUB_Add] PreparedStatement : [INSERT INTO TT_NOITRU_GIAYRAVIEN_KUB        (BENHNHAN_ID        ,TIEPNHAN_ID        ,BENHAN_ID        ,CHANDOANMOBENHHOC        ,PPDT_PHAUTHUAT        ,PPDT_TIAXA        ,PPDT_HOACHAT        ,PPDT_KHAC        ,KETQUADIEUTRI_MOTA        ,CHEDOSAURAVIEN        ,BACSIDIEUTRI_ID        ,THUTRUONGDONVI_ID        ,GHICHU        ,BENHVIEN_ID        ,NGAYTAO        ,NGUOITAO_ID        ) VALUES (         @param0         , @param1         , @param2         , @param3         , @param4         , @param5         , @param6         , @param7         , @param8         , @param9         , @param10         , @param11         , @param12         , @param13         , @param14         , @param15         )        SELECT SCOPE_IDENTITY()]
2019-12-17 12:53:29,966 [1] DEBUG - Statement Id: [DAO00079_TT_NOITRU_GIAYRAVIEN_KUB_Add] Parameters: [@param0=[BENHNHAN_ID,8167], @param1=[TIEPNHAN_ID,26424], @param2=[BENHAN_ID,5646], @param3=[CHANDOANMOBENHHOC,test 1], @param4=[PPDT_PHAUTHUAT,test 2], @param5=[PPDT_TIAXA,test 3], @param6=[PPDT_HOACHAT,Paclitaxel( Canpaxel 30) 30mg/5ml; test 4], @param7=[PPDT_KHAC,test 5], @param8=[KETQUADIEUTRI_MOTA,Đỡ; test 6], @param9=[CHEDOSAURAVIEN,test 7], @param10=[BACSIDIEUTRI_ID,36], @param11=[THUTRUONGDONVI_ID,43], @param12=[GHICHU,test 8], @param13=[BENHVIEN_ID,HLU01], @param14=[NGAYTAO,12/17/2019 12:53:29 PM], @param15=[NGUOITAO_ID,1]]
2019-12-17 12:53:29,966 [1] DEBUG - Statement Id: [DAO00079_TT_NOITRU_GIAYRAVIEN_KUB_Add] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64], @param2=[Int64, System.Int64], @param3=[String, System.String], @param4=[String, System.String], @param5=[String, System.String], @param6=[String, System.String], @param7=[String, System.String], @param8=[String, System.String], @param9=[String, System.String], @param10=[Int64, System.Int64], @param11=[Int64, System.Int64], @param12=[String, System.String], @param13=[String, System.String], @param14=[DateTime, System.DateTime], @param15=[Int64, System.Int64]]
2019-12-17 12:53:30,118 [1] DEBUG - Statement Id: [DAO00079_GetTT_GiayRaVien_KUB] PreparedStatement : [declare @PhauThuat nvarchar(2000) = ''        select @PhauThuat = @PhauThuat + DV.TENDICHVU + '; '        from TT_DVYEUCAU YC        inner join TM_DICHVU DV on DV.DICHVU_ID = YC.DICHVU_ID and DV.BENHVIEN_ID = YC.BENHVIEN_ID        inner join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID and NDV.BENHVIEN_ID = DV.BENHVIEN_ID        where YC.BENHAN_ID = 5646        and SUBSTRING(NDV.MANHOMDICHVU, 1, 2) = '05'        and YC.BENHVIEN_ID = 'HLU01'        and YC.HUYYEUCAU = '0'          declare @HoaChat nvarchar(2000) = ''        select @HoaChat = @HoaChat + D.TENDUOCDAYDU + '; '        from TT_NOITRU_KHAMBENH KB        inner join TT_NOITRU_TOATHUOC TT on TT.KHAMBENH_ID = KB.KHAMBENH_ID and TT.BENHVIEN_ID = KB.BENHVIEN_ID        inner join TM_DUOC D on D.DUOC_ID = TT.DUOC_ID and D.BENHVIEN_ID = TT.BENHVIEN_ID        inner join TM_LOAIDUOC LD on LD.LOAIDUOC_ID = D.LOAIDUOC_ID and LD.BENHVIEN_ID = D.BENHVIEN_ID        where KB.BENHAN_ID = 5646        and LD.MALOAIDUOC in ('L006', 'L007')        and KB.BENHVIEN_ID = 'HLU01'        and TT.HUYTOATHUOC = '0'          select BA.BENHAN_ID, BA.TIEPNHAN_ID, BA.BENHNHAN_ID, GRV.CHANDOANMOBENHHOC, ISNULL(GRV.PPDT_PHAUTHUAT, @PhauThuat) AS PPDT_PHAUTHUAT, GRV.PPDT_TIAXA,        ISNULL(GRV.PPDT_HOACHAT, @HoaChat) AS PPDT_HOACHAT, GRV.PPDT_KHAC, ISNULL(GRV.KETQUADIEUTRI_MOTA, KQ.DICTIONARY_NAME) AS KETQUADIEUTRI_MOTA, BA.KETQUADIEUTRI_ID,        GRV.CHEDOSAURAVIEN, ISNULL(GRV.BACSIDIEUTRI_ID, BA.BACSIDIEUTRI_ID) AS BACSIDIEUTRI_ID, GRV.THUTRUONGDONVI_ID, GRV.GHICHU, GRV.GIAYRAVIEN_ID        from TT_NOITRU_BENHAN BA        left join TT_NOITRU_GIAYRAVIEN_KUB GRV on GRV.BENHAN_ID = BA.BENHAN_ID and GRV.BENHVIEN_ID = BA.BENHVIEN_ID        left join LST_DICTIONARY KQ on KQ.DICTIONARY_ID = BA.KETQUADIEUTRI_ID        where BA.BENHAN_ID = 5646        and BA.BENHVIEN_ID = 'HLU01']
2019-12-17 12:53:44,072 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM98'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-17 12:53:59,696 [1] DEBUG - Statement Id: [DAO00068_GetTTBenhAnByBenhNhanID] PreparedStatement : [select TOP (1) tn.TIEPNHAN_ID, BENHAN_ID, ba.TRANGTHAI              from TT_TIEPNHAN tn              left join TT_NOITRU_BENHAN ba              on tn.TIEPNHAN_ID = ba.TIEPNHAN_ID              where tn.BENHNHAN_ID = '8167'              order by tn.NGAYTAO desc]
2019-12-17 12:54:02,259 [1] DEBUG - Statement Id: [DAO00079_GetTT_GiayRaVien_KUB] PreparedStatement : [declare @PhauThuat nvarchar(2000) = ''        select @PhauThuat = @PhauThuat + DV.TENDICHVU + '; '        from TT_DVYEUCAU YC        inner join TM_DICHVU DV on DV.DICHVU_ID = YC.DICHVU_ID and DV.BENHVIEN_ID = YC.BENHVIEN_ID        inner join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID and NDV.BENHVIEN_ID = DV.BENHVIEN_ID        where YC.BENHAN_ID = 5646        and SUBSTRING(NDV.MANHOMDICHVU, 1, 2) = '05'        and YC.BENHVIEN_ID = 'HLU01'        and YC.HUYYEUCAU = '0'          declare @HoaChat nvarchar(2000) = ''        select @HoaChat = @HoaChat + D.TENDUOCDAYDU + '; '        from TT_NOITRU_KHAMBENH KB        inner join TT_NOITRU_TOATHUOC TT on TT.KHAMBENH_ID = KB.KHAMBENH_ID and TT.BENHVIEN_ID = KB.BENHVIEN_ID        inner join TM_DUOC D on D.DUOC_ID = TT.DUOC_ID and D.BENHVIEN_ID = TT.BENHVIEN_ID        inner join TM_LOAIDUOC LD on LD.LOAIDUOC_ID = D.LOAIDUOC_ID and LD.BENHVIEN_ID = D.BENHVIEN_ID        where KB.BENHAN_ID = 5646        and LD.MALOAIDUOC in ('L006', 'L007')        and KB.BENHVIEN_ID = 'HLU01'        and TT.HUYTOATHUOC = '0'          select BA.BENHAN_ID, BA.TIEPNHAN_ID, BA.BENHNHAN_ID, GRV.CHANDOANMOBENHHOC, ISNULL(GRV.PPDT_PHAUTHUAT, @PhauThuat) AS PPDT_PHAUTHUAT, GRV.PPDT_TIAXA,        ISNULL(GRV.PPDT_HOACHAT, @HoaChat) AS PPDT_HOACHAT, GRV.PPDT_KHAC, ISNULL(GRV.KETQUADIEUTRI_MOTA, KQ.DICTIONARY_NAME) AS KETQUADIEUTRI_MOTA, BA.KETQUADIEUTRI_ID,        GRV.CHEDOSAURAVIEN, ISNULL(GRV.BACSIDIEUTRI_ID, BA.BACSIDIEUTRI_ID) AS BACSIDIEUTRI_ID, GRV.THUTRUONGDONVI_ID, GRV.GHICHU, GRV.GIAYRAVIEN_ID        from TT_NOITRU_BENHAN BA        left join TT_NOITRU_GIAYRAVIEN_KUB GRV on GRV.BENHAN_ID = BA.BENHAN_ID and GRV.BENHVIEN_ID = BA.BENHVIEN_ID        left join LST_DICTIONARY KQ on KQ.DICTIONARY_ID = BA.KETQUADIEUTRI_ID        where BA.BENHAN_ID = 5646        and BA.BENHVIEN_ID = 'HLU01']
2019-12-17 12:54:15,406 [1] DEBUG - Statement Id: [DAO00079_TT_NOITRU_GIAYRAVIEN_KUB_Delete] PreparedStatement : [delete from TT_NOITRU_GIAYRAVIEN_KUB        where GIAYRAVIEN_ID = 2]
2019-12-17 12:54:15,493 [1] DEBUG - Statement Id: [DAO00079_GetTT_GiayRaVien_KUB] PreparedStatement : [declare @PhauThuat nvarchar(2000) = ''        select @PhauThuat = @PhauThuat + DV.TENDICHVU + '; '        from TT_DVYEUCAU YC        inner join TM_DICHVU DV on DV.DICHVU_ID = YC.DICHVU_ID and DV.BENHVIEN_ID = YC.BENHVIEN_ID        inner join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID and NDV.BENHVIEN_ID = DV.BENHVIEN_ID        where YC.BENHAN_ID = 5646        and SUBSTRING(NDV.MANHOMDICHVU, 1, 2) = '05'        and YC.BENHVIEN_ID = 'HLU01'        and YC.HUYYEUCAU = '0'          declare @HoaChat nvarchar(2000) = ''        select @HoaChat = @HoaChat + D.TENDUOCDAYDU + '; '        from TT_NOITRU_KHAMBENH KB        inner join TT_NOITRU_TOATHUOC TT on TT.KHAMBENH_ID = KB.KHAMBENH_ID and TT.BENHVIEN_ID = KB.BENHVIEN_ID        inner join TM_DUOC D on D.DUOC_ID = TT.DUOC_ID and D.BENHVIEN_ID = TT.BENHVIEN_ID        inner join TM_LOAIDUOC LD on LD.LOAIDUOC_ID = D.LOAIDUOC_ID and LD.BENHVIEN_ID = D.BENHVIEN_ID        where KB.BENHAN_ID = 5646        and LD.MALOAIDUOC in ('L006', 'L007')        and KB.BENHVIEN_ID = 'HLU01'        and TT.HUYTOATHUOC = '0'          select BA.BENHAN_ID, BA.TIEPNHAN_ID, BA.BENHNHAN_ID, GRV.CHANDOANMOBENHHOC, ISNULL(GRV.PPDT_PHAUTHUAT, @PhauThuat) AS PPDT_PHAUTHUAT, GRV.PPDT_TIAXA,        ISNULL(GRV.PPDT_HOACHAT, @HoaChat) AS PPDT_HOACHAT, GRV.PPDT_KHAC, ISNULL(GRV.KETQUADIEUTRI_MOTA, KQ.DICTIONARY_NAME) AS KETQUADIEUTRI_MOTA, BA.KETQUADIEUTRI_ID,        GRV.CHEDOSAURAVIEN, ISNULL(GRV.BACSIDIEUTRI_ID, BA.BACSIDIEUTRI_ID) AS BACSIDIEUTRI_ID, GRV.THUTRUONGDONVI_ID, GRV.GHICHU, GRV.GIAYRAVIEN_ID        from TT_NOITRU_BENHAN BA        left join TT_NOITRU_GIAYRAVIEN_KUB GRV on GRV.BENHAN_ID = BA.BENHAN_ID and GRV.BENHVIEN_ID = BA.BENHVIEN_ID        left join LST_DICTIONARY KQ on KQ.DICTIONARY_ID = BA.KETQUADIEUTRI_ID        where BA.BENHAN_ID = 5646        and BA.BENHVIEN_ID = 'HLU01']
