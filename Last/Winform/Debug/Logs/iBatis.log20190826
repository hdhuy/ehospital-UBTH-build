--------------------------------------------------------------------------------
2019-08-26 13:07:02,914 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2019-08-26 13:07:03,619 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-08-26 13:07:03,661 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-08-26 13:07:04,958 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 13:07:05,779 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-08-26 13:08:14,896 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2019-08-26 13:08:14,926 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-08-26 13:08:19,502 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-08-26 13:08:19,646 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-08-26 13:08:21,102 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2019-08-26 13:08:21,655 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2019-08-26 13:08:21,775 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2019-08-26 13:08:21,846 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2019-08-26 13:08:21,948 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2019-08-26 13:08:22,020 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2019-08-26 13:08:22,100 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2019-08-26 13:08:22,178 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2019-08-26 13:08:22,253 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2019-08-26 13:08:22,999 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2019-08-26 13:08:23,040 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2019-08-26 13:08:23,117 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2019-08-26 13:08:23,158 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2019-08-26 13:08:24,388 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2019-08-26 13:08:24,441 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 0 as PHAMVI_ID, 0 as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0         end                else        begin        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2019-08-26 13:08:27,027 [5] DEBUG - Statement Id: [DAO00320_GetList] PreparedStatement : [select M.*            from TM_MAU M            LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID            where            M.TAMNGUNG = '0'            and M.BENHVIEN_ID = 'HLU01'            order by M.TENMAU]
2019-08-26 13:08:27,122 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2019-08-26 13:08:27,158 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT          TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,          TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,          SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH          FROM TT_MAU_TONKHO TK          JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID          JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID          JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'          LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID          LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID          WHERE TK.SOLUONG > 0          GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,          TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2019-08-26 13:08:27,231 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2019-08-26 13:08:27,275 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct          TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,          TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,          TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH          from TM_MAU M          JOIN          (          select          A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO          from          (          select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO          from TT_MAU_TONKHO TK          JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID          inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID          left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'          where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0          ) A          )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'          LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID          LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2019-08-26 13:08:27,345 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2019-08-26 13:08:28,266 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 13:08:31,049 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2019-08-26 13:08:38,137 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2019-08-26 13:08:38,184 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2019-08-26 13:08:38,267 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 13:08:38,536 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 13:08:38,871 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2019-08-26 13:08:38,899 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-08-26 13:08:38,899 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-08-26 13:08:38,947 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2019-08-26 13:08:38,947 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-08-26 13:08:38,947 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-08-26 13:08:39,264 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 13:08:39,712 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 13:09:00,568 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 13:09:00,870 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2019-08-26 13:09:01,516 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2019-08-26 13:22:47,991 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM31'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 13:22:48,371 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'IPD78'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 13:22:55,855 [1] DEBUG - Statement Id: [DAO00014_GetInPatientStatus] PreparedStatement : [select TRANGTHAI, isnull(KHOACHUYENDEN_ID, KHOAVAO_ID) as KHOAHIENTAI from TT_NOITRU_BENHAN        where        TIEPNHAN_ID = '27366'        and BENHVIEN_ID = 'HLU01'         and           BENHAN_ID = '5857']
2019-08-26 13:22:56,302 [1] DEBUG - Statement Id: [DAO00061_GetLuuTruIDByBenhAnID] PreparedStatement : [select lt.LUUTRU_ID, ba.BACSIDIEUTRI_ID as BACSIDIEUTRICHINH_ID        from TT_NOITRU_LUUTRU lt        left join TT_NOITRU_BENHAN ba on lt.BENHAN_ID = ba.BENHAN_ID        where lt.BENHAN_ID = '5857']
2019-08-26 13:22:56,342 [1] DEBUG - Statement Id: [DAO00061_GetChanDoanBenhAnID] PreparedStatement : [DECLARE @ICDPHU NVARCHAR(2000)=''        DECLARE @LISTICDPHU NVARCHAR(200)        DECLARE @CHANDOANRAVIEN NVARCHAR(500)        DECLARE @ICDKHAMBENH NVARCHAR(500) = (SELECT ICD.TENICD + '('+ISNULL(ICD.MAICD,'')+')'        FROM TT_NOITRU_BENHAN BA INNER JOIN TM_ICD ICD        ON BA.ICD_KHAMBENH = ICD.ICD_ID WHERE BA.BENHAN_ID =  @param0 )        DECLARE @ICDCHINH NVARCHAR(500) = (SELECT ICD.TENICD + '('+ISNULL(ICD.MAICD,'')+')'        FROM TT_NOITRU_BENHAN BA INNER JOIN TM_ICD ICD        ON BA.ICD_BENHCHINH = ICD.ICD_ID WHERE BA.BENHAN_ID =  @param0 )        SELECT @CHANDOANRAVIEN = BA.CHANDOANRAVIEN, @LISTICDPHU = BA.ICD_BENHPHU        FROM TT_NOITRU_BENHAN BA WHERE BA.BENHAN_ID =  @param0         SELECT @ICDPHU = @ICDPHU + ISNULL(TENICD, '') +'(' +ISNULL(MAICD,'')+ '); ' FROM TM_ICD WHERE MAICD IN (SELECT S FROM SplitString(@LISTICDPHU,';'))        SELECT ICD_KHAMBENH, CHANDOANKHAMBENH, CHANDOANVAOKHOA, CHANDOANRAVIEN, CHANDOANKHAC        ,ISNULL(@ICDCHINH, '') + '; ' + ISNULL(@CHANDOANRAVIEN, '') + '; ' + ISNULL(@ICDPHU,'') AS CHANDOANNOITRU        ,CASE WHEN @ICDKHAMBENH IS NULL AND (@CHANDOANRAVIEN IS NULL OR @CHANDOANRAVIEN = '') THEN ''        ELSE ISNULL(@ICDKHAMBENH, '') + '; ' + ISNULL(@CHANDOANRAVIEN, '') END        AS CHANDOANCAPCUU        FROM TT_NOITRU_BENHAN BA LEFT JOIN TM_ICD ICD ON BA.ICD_KHAMBENH = ICD.ICD_ID        WHERE BENHAN_ID =  @param0]
2019-08-26 13:22:56,342 [1] DEBUG - Statement Id: [DAO00061_GetChanDoanBenhAnID] Parameters: [@param0=[BENHAN_ID,5857]]
2019-08-26 13:22:56,342 [1] DEBUG - Statement Id: [DAO00061_GetChanDoanBenhAnID] Types: [@param0=[Int64, System.Int64]]
2019-08-26 13:22:56,580 [1] DEBUG - Statement Id: [DAO00080_GetDSYLenhTruyenDich] PreparedStatement : [select DT.THOIGIANYLENH, PB.PHONGBAN_ID, PB.TENPHONGBAN AS KHOACHIDINH        , DT.LUUTRU_ID, DT.CHAMSOCDICHTRUYEN_ID, CAST(0 AS bit) AS CHON, DT.THOIGIANBATDAU        from TT_NOITRU_CHAMSOCDICHTRUYEN DT        left join TT_NOITRU_LUUTRU LT on LT.LUUTRU_ID = DT.LUUTRU_ID and LT.BENHVIEN_ID = DT.BENHVIEN_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = LT.PHONGBAN_ID and PB.BENHVIEN_ID = LT.BENHVIEN_ID        where DT.BENHAN_ID = '5857' and DT.BENHVIEN_ID = 'HLU01'        order by DT.THOIGIANBATDAU desc]
2019-08-26 13:23:25,368 [1] DEBUG - Statement Id: [DAO00080_GetLastLuutru_idCuaBenhan] PreparedStatement : [select MAX(LUUTRU_ID) LUUTRU_ID from TT_NOITRU_LUUTRU where BENHAN_ID =  @param0]
2019-08-26 13:23:25,369 [1] DEBUG - Statement Id: [DAO00080_GetLastLuutru_idCuaBenhan] Parameters: [@param0=[BENHAN_ID,5857]]
2019-08-26 13:23:25,369 [1] DEBUG - Statement Id: [DAO00080_GetLastLuutru_idCuaBenhan] Types: [@param0=[Int64, System.Int64]]
2019-08-26 13:23:25,464 [1] DEBUG - Statement Id: [DAO00080_Add_ThongTinDichTruyen] PreparedStatement : [insert into TT_NOITRU_CHAMSOCDICHTRUYEN (        DUOC_ID        , SOLUONG        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , TOCDOTRUYEN        , BENHAN_ID        , LUUTRU_ID        , BACSICHIDINH_ID        , DIEUDUONGTHUCHIEN_ID        , THOIGIANBATDAU        , THOIGIANKETTHUC        , SOLOSX        , THOIGIANYLENH        , SOMLCHAYNGUOC        , SOMLGIAOLAI        , GHICHU        , SOGIOTTRENPHUT        ) values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         )]
2019-08-26 13:23:25,464 [1] DEBUG - Statement Id: [DAO00080_Add_ThongTinDichTruyen] Parameters: [@param0=[DUOC_ID,882], @param1=[SOLUONG,500], @param2=[BENHVIEN_ID,HLU01], @param3=[NGAYTAO,8/26/2019 1:23:25 PM], @param4=[NGUOITAO_ID,0], @param5=[TOCDOTRUYEN,], @param6=[BENHAN_ID,5857], @param7=[LUUTRU_ID,9562], @param8=[BACSICHIDINH_ID,0], @param9=[DIEUDUONGTHUCHIEN_ID,0], @param10=[THOIGIANBATDAU,8/26/2019 1:23:20 PM], @param11=[THOIGIANKETTHUC,8/26/2019 4:43:20 PM], @param12=[SOLOSX,323], @param13=[THOIGIANYLENH,8/26/2019 1:23:25 PM], @param14=[SOMLCHAYNGUOC,0], @param15=[SOMLGIAOLAI,0], @param16=[GHICHU,], @param17=[SOGIOTTRENPHUT,50]]
2019-08-26 13:23:25,464 [1] DEBUG - Statement Id: [DAO00080_Add_ThongTinDichTruyen] Types: [@param0=[Int32, System.Int32], @param1=[Decimal, System.Decimal], @param2=[String, System.String], @param3=[DateTime, System.DateTime], @param4=[Int64, System.Int64], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[Int32, System.Int32], @param8=[Int32, System.Int32], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[DateTime, System.DateTime], @param12=[String, System.String], @param13=[DateTime, System.DateTime], @param14=[Int32, System.Int32], @param15=[Int32, System.Int32], @param16=[String, System.String], @param17=[Int32, System.Int32]]
2019-08-26 13:23:25,744 [1] DEBUG - Statement Id: [DAO00080_GetDSYLenhTruyenDich] PreparedStatement : [select DT.THOIGIANYLENH, PB.PHONGBAN_ID, PB.TENPHONGBAN AS KHOACHIDINH        , DT.LUUTRU_ID, DT.CHAMSOCDICHTRUYEN_ID, CAST(0 AS bit) AS CHON, DT.THOIGIANBATDAU        from TT_NOITRU_CHAMSOCDICHTRUYEN DT        left join TT_NOITRU_LUUTRU LT on LT.LUUTRU_ID = DT.LUUTRU_ID and LT.BENHVIEN_ID = DT.BENHVIEN_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = LT.PHONGBAN_ID and PB.BENHVIEN_ID = LT.BENHVIEN_ID        where DT.BENHAN_ID = '5857' and DT.BENHVIEN_ID = 'HLU01'        order by DT.THOIGIANBATDAU desc]
--------------------------------------------------------------------------------
2019-08-26 13:25:54,635 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2019-08-26 13:25:54,944 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-08-26 13:25:54,988 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-08-26 13:25:55,956 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 13:25:56,358 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-08-26 13:26:01,793 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2019-08-26 13:26:01,825 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-08-26 13:26:04,937 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-08-26 13:26:05,027 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-08-26 13:26:05,957 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2019-08-26 13:26:06,172 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2019-08-26 13:26:06,248 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2019-08-26 13:26:06,343 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2019-08-26 13:26:06,418 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2019-08-26 13:26:06,499 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2019-08-26 13:26:06,587 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2019-08-26 13:26:06,662 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2019-08-26 13:26:06,767 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2019-08-26 13:26:07,279 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2019-08-26 13:26:07,316 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2019-08-26 13:26:07,393 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2019-08-26 13:26:07,436 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2019-08-26 13:26:08,275 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2019-08-26 13:26:08,315 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 0 as PHAMVI_ID, 0 as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0         end                else        begin        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2019-08-26 13:26:13,158 [5] DEBUG - Statement Id: [DAO00320_GetList] PreparedStatement : [select M.*            from TM_MAU M            LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID            where            M.TAMNGUNG = '0'            and M.BENHVIEN_ID = 'HLU01'            order by M.TENMAU]
2019-08-26 13:26:13,225 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2019-08-26 13:26:13,270 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT          TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,          TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,          SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH          FROM TT_MAU_TONKHO TK          JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID          JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID          JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'          LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID          LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID          WHERE TK.SOLUONG > 0          GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,          TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2019-08-26 13:26:13,349 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2019-08-26 13:26:13,384 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct          TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,          TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,          TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH          from TM_MAU M          JOIN          (          select          A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO          from          (          select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO          from TT_MAU_TONKHO TK          JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID          inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID          left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'          where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0          ) A          )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'          LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID          LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2019-08-26 13:26:13,453 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2019-08-26 13:26:14,363 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 13:26:15,913 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2019-08-26 13:26:22,560 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2019-08-26 13:26:22,596 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2019-08-26 13:26:22,707 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 13:26:22,828 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 13:26:23,123 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2019-08-26 13:26:23,126 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-08-26 13:26:23,126 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-08-26 13:26:23,172 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2019-08-26 13:26:23,172 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-08-26 13:26:23,172 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-08-26 13:26:23,337 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 13:26:23,506 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 13:26:36,187 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 13:26:36,283 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2019-08-26 13:26:36,668 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2019-08-26 13:26:53,778 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM31'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 13:26:53,993 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'IPD78'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 13:26:58,013 [1] DEBUG - Statement Id: [DAO00014_GetInPatientStatus] PreparedStatement : [select TRANGTHAI, isnull(KHOACHUYENDEN_ID, KHOAVAO_ID) as KHOAHIENTAI from TT_NOITRU_BENHAN        where        TIEPNHAN_ID = '27366'        and BENHVIEN_ID = 'HLU01'         and           BENHAN_ID = '5857']
2019-08-26 13:26:58,180 [1] DEBUG - Statement Id: [DAO00061_GetLuuTruIDByBenhAnID] PreparedStatement : [select lt.LUUTRU_ID, ba.BACSIDIEUTRI_ID as BACSIDIEUTRICHINH_ID        from TT_NOITRU_LUUTRU lt        left join TT_NOITRU_BENHAN ba on lt.BENHAN_ID = ba.BENHAN_ID        where lt.BENHAN_ID = '5857']
2019-08-26 13:26:58,223 [1] DEBUG - Statement Id: [DAO00061_GetChanDoanBenhAnID] PreparedStatement : [DECLARE @ICDPHU NVARCHAR(2000)=''        DECLARE @LISTICDPHU NVARCHAR(200)        DECLARE @CHANDOANRAVIEN NVARCHAR(500)        DECLARE @ICDKHAMBENH NVARCHAR(500) = (SELECT ICD.TENICD + '('+ISNULL(ICD.MAICD,'')+')'        FROM TT_NOITRU_BENHAN BA INNER JOIN TM_ICD ICD        ON BA.ICD_KHAMBENH = ICD.ICD_ID WHERE BA.BENHAN_ID =  @param0 )        DECLARE @ICDCHINH NVARCHAR(500) = (SELECT ICD.TENICD + '('+ISNULL(ICD.MAICD,'')+')'        FROM TT_NOITRU_BENHAN BA INNER JOIN TM_ICD ICD        ON BA.ICD_BENHCHINH = ICD.ICD_ID WHERE BA.BENHAN_ID =  @param0 )        SELECT @CHANDOANRAVIEN = BA.CHANDOANRAVIEN, @LISTICDPHU = BA.ICD_BENHPHU        FROM TT_NOITRU_BENHAN BA WHERE BA.BENHAN_ID =  @param0         SELECT @ICDPHU = @ICDPHU + ISNULL(TENICD, '') +'(' +ISNULL(MAICD,'')+ '); ' FROM TM_ICD WHERE MAICD IN (SELECT S FROM SplitString(@LISTICDPHU,';'))        SELECT ICD_KHAMBENH, CHANDOANKHAMBENH, CHANDOANVAOKHOA, CHANDOANRAVIEN, CHANDOANKHAC        ,ISNULL(@ICDCHINH, '') + '; ' + ISNULL(@CHANDOANRAVIEN, '') + '; ' + ISNULL(@ICDPHU,'') AS CHANDOANNOITRU        ,CASE WHEN @ICDKHAMBENH IS NULL AND (@CHANDOANRAVIEN IS NULL OR @CHANDOANRAVIEN = '') THEN ''        ELSE ISNULL(@ICDKHAMBENH, '') + '; ' + ISNULL(@CHANDOANRAVIEN, '') END        AS CHANDOANCAPCUU        FROM TT_NOITRU_BENHAN BA LEFT JOIN TM_ICD ICD ON BA.ICD_KHAMBENH = ICD.ICD_ID        WHERE BENHAN_ID =  @param0]
2019-08-26 13:26:58,223 [1] DEBUG - Statement Id: [DAO00061_GetChanDoanBenhAnID] Parameters: [@param0=[BENHAN_ID,5857]]
2019-08-26 13:26:58,223 [1] DEBUG - Statement Id: [DAO00061_GetChanDoanBenhAnID] Types: [@param0=[Int64, System.Int64]]
2019-08-26 13:26:58,362 [1] DEBUG - Statement Id: [DAO00080_GetDSYLenhTruyenDich] PreparedStatement : [select DT.THOIGIANYLENH, PB.PHONGBAN_ID, PB.TENPHONGBAN AS KHOACHIDINH        , DT.LUUTRU_ID, DT.CHAMSOCDICHTRUYEN_ID, CAST(0 AS bit) AS CHON, DT.THOIGIANBATDAU        from TT_NOITRU_CHAMSOCDICHTRUYEN DT        left join TT_NOITRU_LUUTRU LT on LT.LUUTRU_ID = DT.LUUTRU_ID and LT.BENHVIEN_ID = DT.BENHVIEN_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = LT.PHONGBAN_ID and PB.BENHVIEN_ID = LT.BENHVIEN_ID        where DT.BENHAN_ID = '5857' and DT.BENHVIEN_ID = 'HLU01'        order by DT.THOIGIANBATDAU desc]
2019-08-26 13:27:13,445 [1] DEBUG - Statement Id: [DAO00080_GetLastLuutru_idCuaBenhan] PreparedStatement : [select MAX(LUUTRU_ID) LUUTRU_ID from TT_NOITRU_LUUTRU where BENHAN_ID =  @param0]
2019-08-26 13:27:13,445 [1] DEBUG - Statement Id: [DAO00080_GetLastLuutru_idCuaBenhan] Parameters: [@param0=[BENHAN_ID,5857]]
2019-08-26 13:27:13,445 [1] DEBUG - Statement Id: [DAO00080_GetLastLuutru_idCuaBenhan] Types: [@param0=[Int64, System.Int64]]
2019-08-26 13:27:13,513 [1] DEBUG - Statement Id: [DAO00080_Add_ThongTinDichTruyen] PreparedStatement : [insert into TT_NOITRU_CHAMSOCDICHTRUYEN (        DUOC_ID        , SOLUONG        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , TOCDOTRUYEN        , BENHAN_ID        , LUUTRU_ID        , BACSICHIDINH_ID        , DIEUDUONGTHUCHIEN_ID        , THOIGIANBATDAU        , THOIGIANKETTHUC        , SOLOSX        , THOIGIANYLENH        , SOMLCHAYNGUOC        , SOMLGIAOLAI        , GHICHU        , SOGIOTTRENPHUT        ) values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         )]
2019-08-26 13:27:13,513 [1] DEBUG - Statement Id: [DAO00080_Add_ThongTinDichTruyen] Parameters: [@param0=[DUOC_ID,882], @param1=[SOLUONG,50], @param2=[BENHVIEN_ID,HLU01], @param3=[NGAYTAO,8/26/2019 1:27:13 PM], @param4=[NGUOITAO_ID,0], @param5=[TOCDOTRUYEN,], @param6=[BENHAN_ID,5857], @param7=[LUUTRU_ID,9562], @param8=[BACSICHIDINH_ID,0], @param9=[DIEUDUONGTHUCHIEN_ID,0], @param10=[THOIGIANBATDAU,8/26/2019 1:27:11 PM], @param11=[THOIGIANKETTHUC,8/26/2019 1:47:11 PM], @param12=[SOLOSX,dd], @param13=[THOIGIANYLENH,8/26/2019 1:27:13 PM], @param14=[SOMLCHAYNGUOC,0], @param15=[SOMLGIAOLAI,0], @param16=[GHICHU,], @param17=[SOGIOTTRENPHUT,50]]
2019-08-26 13:27:13,513 [1] DEBUG - Statement Id: [DAO00080_Add_ThongTinDichTruyen] Types: [@param0=[Int32, System.Int32], @param1=[Decimal, System.Decimal], @param2=[String, System.String], @param3=[DateTime, System.DateTime], @param4=[Int64, System.Int64], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[Int32, System.Int32], @param8=[Int32, System.Int32], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[DateTime, System.DateTime], @param12=[String, System.String], @param13=[DateTime, System.DateTime], @param14=[Int32, System.Int32], @param15=[Int32, System.Int32], @param16=[String, System.String], @param17=[Int32, System.Int32]]
2019-08-26 13:27:13,646 [1] DEBUG - Statement Id: [DAO00080_GetDSYLenhTruyenDich] PreparedStatement : [select DT.THOIGIANYLENH, PB.PHONGBAN_ID, PB.TENPHONGBAN AS KHOACHIDINH        , DT.LUUTRU_ID, DT.CHAMSOCDICHTRUYEN_ID, CAST(0 AS bit) AS CHON, DT.THOIGIANBATDAU        from TT_NOITRU_CHAMSOCDICHTRUYEN DT        left join TT_NOITRU_LUUTRU LT on LT.LUUTRU_ID = DT.LUUTRU_ID and LT.BENHVIEN_ID = DT.BENHVIEN_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = LT.PHONGBAN_ID and PB.BENHVIEN_ID = LT.BENHVIEN_ID        where DT.BENHAN_ID = '5857' and DT.BENHVIEN_ID = 'HLU01'        order by DT.THOIGIANBATDAU desc]
2019-08-26 13:27:49,052 [1] DEBUG - Statement Id: [DAO00080_GetLastLuutru_idCuaBenhan] PreparedStatement : [select MAX(LUUTRU_ID) LUUTRU_ID from TT_NOITRU_LUUTRU where BENHAN_ID =  @param0]
2019-08-26 13:27:49,053 [1] DEBUG - Statement Id: [DAO00080_GetLastLuutru_idCuaBenhan] Parameters: [@param0=[BENHAN_ID,5857]]
2019-08-26 13:27:49,053 [1] DEBUG - Statement Id: [DAO00080_GetLastLuutru_idCuaBenhan] Types: [@param0=[Int64, System.Int64]]
2019-08-26 13:27:49,111 [1] DEBUG - Statement Id: [DAO00080_Add_ThongTinDichTruyen] PreparedStatement : [insert into TT_NOITRU_CHAMSOCDICHTRUYEN (        DUOC_ID        , SOLUONG        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , TOCDOTRUYEN        , BENHAN_ID        , LUUTRU_ID        , BACSICHIDINH_ID        , DIEUDUONGTHUCHIEN_ID        , THOIGIANBATDAU        , THOIGIANKETTHUC        , SOLOSX        , THOIGIANYLENH        , SOMLCHAYNGUOC        , SOMLGIAOLAI        , GHICHU        , SOGIOTTRENPHUT        ) values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         )]
2019-08-26 13:27:49,111 [1] DEBUG - Statement Id: [DAO00080_Add_ThongTinDichTruyen] Parameters: [@param0=[DUOC_ID,882], @param1=[SOLUONG,500], @param2=[BENHVIEN_ID,HLU01], @param3=[NGAYTAO,8/26/2019 1:27:49 PM], @param4=[NGUOITAO_ID,0], @param5=[TOCDOTRUYEN,], @param6=[BENHAN_ID,5857], @param7=[LUUTRU_ID,9562], @param8=[BACSICHIDINH_ID,0], @param9=[DIEUDUONGTHUCHIEN_ID,0], @param10=[THOIGIANBATDAU,8/26/2019 1:27:46 PM], @param11=[THOIGIANKETTHUC,8/26/2019 4:47:46 PM], @param12=[SOLOSX,f], @param13=[THOIGIANYLENH,8/26/2019 1:27:49 PM], @param14=[SOMLCHAYNGUOC,0], @param15=[SOMLGIAOLAI,0], @param16=[GHICHU,], @param17=[SOGIOTTRENPHUT,50]]
2019-08-26 13:27:49,111 [1] DEBUG - Statement Id: [DAO00080_Add_ThongTinDichTruyen] Types: [@param0=[Int32, System.Int32], @param1=[Decimal, System.Decimal], @param2=[String, System.String], @param3=[DateTime, System.DateTime], @param4=[Int64, System.Int64], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[Int32, System.Int32], @param8=[Int32, System.Int32], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[DateTime, System.DateTime], @param12=[String, System.String], @param13=[DateTime, System.DateTime], @param14=[Int32, System.Int32], @param15=[Int32, System.Int32], @param16=[String, System.String], @param17=[Int32, System.Int32]]
2019-08-26 13:27:49,206 [1] DEBUG - Statement Id: [DAO00080_GetDSYLenhTruyenDich] PreparedStatement : [select DT.THOIGIANYLENH, PB.PHONGBAN_ID, PB.TENPHONGBAN AS KHOACHIDINH        , DT.LUUTRU_ID, DT.CHAMSOCDICHTRUYEN_ID, CAST(0 AS bit) AS CHON, DT.THOIGIANBATDAU        from TT_NOITRU_CHAMSOCDICHTRUYEN DT        left join TT_NOITRU_LUUTRU LT on LT.LUUTRU_ID = DT.LUUTRU_ID and LT.BENHVIEN_ID = DT.BENHVIEN_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = LT.PHONGBAN_ID and PB.BENHVIEN_ID = LT.BENHVIEN_ID        where DT.BENHAN_ID = '5857' and DT.BENHVIEN_ID = 'HLU01'        order by DT.THOIGIANBATDAU desc]
2019-08-26 13:35:05,727 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MKT15'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 13:35:09,613 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_GetList] PreparedStatement : [select * from TM_CSKH_GOI A         where               A.TRANGTHAI = 'GOIDUOCPHEPBAN'           and             convert(date,A.NGAYTAO) between convert(date, '8/26/2019 1:35:09 PM') and convert(date, '8/26/2019 1:35:09 PM')           and             A.BENHVIEN_ID = 'HLU01']
2019-08-26 13:35:15,391 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_GetList] PreparedStatement : [select * from TM_CSKH_GOI A         where               A.TRANGTHAI = 'GOIDUOCPHEPBAN'           and             convert(date,A.NGAYTAO) between convert(date, '6/1/2019 12:00:00 AM') and convert(date, '8/26/2019 1:35:09 PM')           and             A.BENHVIEN_ID = 'HLU01']
2019-08-26 13:35:25,375 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MKT03'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 13:35:25,489 [1] DEBUG - Statement Id: [DAO00041_GetList] PreparedStatement : [declare @ManhomDSA varchar(10);            declare @PhanLoaiNhomDV varchar(20) = '01,02,03,04,06,20';            select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'            if (@ManhomDSA is not null and '05' in (select * from STRING_SPLIT('01,02,03,04,06,20', ',')))             set @PhanLoaiNhomDV += ',' + @ManhomDSA              select * from            (select dv.*, ndv.LOAIDICHVU_ID, ndv.MANHOMDICHVU, ndv.TENNHOMDICHVU as TENNHOMDICHVU,            ndv.TENKHONGDAU as TENNDVKHONGDAU, ndv.TENNHOMDICHVU_EN, ndv.TENNHOMDICHVU_RU,            CASE            WHEN @ManhomDSA is not null and ndv.MANHOMDICHVU in (@ManhomDSA) THEN ndv.MANHOMDICHVU            WHEN Left(ndv.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(ndv.MANHOMDICHVU,2)            END AS PHANLOAI_MANHOMDICHVU            from TM_DICHVU dv            left join TM_NHOMDICHVU ndv on dv.NHOMDICHVU_ID = ndv.NHOMDICHVU_ID                           where ndv.TAMNGUNG = '0' and dv.TAMNGUNG = '0' and dv.BENHVIEN_ID = 'HLU01') as tbl                 where                         PHANLOAI_MANHOMDICHVU in (select * from STRING_SPLIT(@PhanLoaiNhomDV,','))]
2019-08-26 13:35:28,724 [1] DEBUG - Statement Id: [DAO00099_GetListLoaiGoiDV] PreparedStatement : [select * from LST_DICTIONARY        where        DICTIONARY_TYPE_CODE = 'LoaiGoiDV']
2019-08-26 13:36:46,263 [1] DEBUG - Statement Id: [DAO00099_GetLoaiGiaDichVu] PreparedStatement : [select A.LOAIGIA_ID,B.TENLOAIGIA, B.MALOAIGIA        from TM_DICHVU_DONGIA A        inner join TM_LOAIGIA B on A.LOAIGIA_ID = B.LOAIGIA_ID        inner join LST_DICTIONARY AS DIC ON DIC.DICTIONARY_ID = B.NHOMGIA_ID AND DIC.DICTIONARY_TYPE_CODE = 'NhomGia'        where A.DICHVU_ID = '5435' and A.BENHVIEN_ID = 'HLU01' and DIC.DICTIONARY_CODE != 'BHYT']
2019-08-26 13:36:48,771 [1] DEBUG - Statement Id: [DAO00000_GetDONGIA_BY_DICHVU_LOAIGIA] PreparedStatement : [SELECT DD.*              FROM TM_DICHVU_DONGIA DD              WHERE DD.DICHVU_ID = '5435' AND DD.LOAIGIA_ID = '3' AND DD.BENHVIEN_ID = 'HLU01' AND DD.TAMNGUNG = '0']
2019-08-26 13:36:52,329 [1] DEBUG - Statement Id: [DAO00000_GetDONGIA_BY_DICHVU_LOAIGIA] PreparedStatement : [SELECT DD.*              FROM TM_DICHVU_DONGIA DD              WHERE DD.DICHVU_ID = '5435' AND DD.LOAIGIA_ID = '3' AND DD.BENHVIEN_ID = 'HLU01' AND DD.TAMNGUNG = '0']
2019-08-26 13:37:03,457 [1] DEBUG - Statement Id: [DAO00099_GetLoaiGiaDichVu] PreparedStatement : [select A.LOAIGIA_ID,B.TENLOAIGIA, B.MALOAIGIA        from TM_DICHVU_DONGIA A        inner join TM_LOAIGIA B on A.LOAIGIA_ID = B.LOAIGIA_ID        inner join LST_DICTIONARY AS DIC ON DIC.DICTIONARY_ID = B.NHOMGIA_ID AND DIC.DICTIONARY_TYPE_CODE = 'NhomGia'        where A.DICHVU_ID = '5443' and A.BENHVIEN_ID = 'HLU01' and DIC.DICTIONARY_CODE != 'BHYT']
2019-08-26 13:37:06,781 [1] DEBUG - Statement Id: [DAO00000_GetDONGIA_BY_DICHVU_LOAIGIA] PreparedStatement : [SELECT DD.*              FROM TM_DICHVU_DONGIA DD              WHERE DD.DICHVU_ID = '5443' AND DD.LOAIGIA_ID = '3' AND DD.BENHVIEN_ID = 'HLU01' AND DD.TAMNGUNG = '0']
2019-08-26 13:37:06,821 [1] DEBUG - Statement Id: [DAO00000_GetDONGIA_BY_DICHVU_LOAIGIA] PreparedStatement : [SELECT DD.*              FROM TM_DICHVU_DONGIA DD              WHERE DD.DICHVU_ID = '5443' AND DD.LOAIGIA_ID = '3' AND DD.BENHVIEN_ID = 'HLU01' AND DD.TAMNGUNG = '0']
2019-08-26 13:37:18,894 [1] DEBUG - Statement Id: [DAO00099_GetLoaiGiaDichVu] PreparedStatement : [select A.LOAIGIA_ID,B.TENLOAIGIA, B.MALOAIGIA        from TM_DICHVU_DONGIA A        inner join TM_LOAIGIA B on A.LOAIGIA_ID = B.LOAIGIA_ID        inner join LST_DICTIONARY AS DIC ON DIC.DICTIONARY_ID = B.NHOMGIA_ID AND DIC.DICTIONARY_TYPE_CODE = 'NhomGia'        where A.DICHVU_ID = '5433' and A.BENHVIEN_ID = 'HLU01' and DIC.DICTIONARY_CODE != 'BHYT']
2019-08-26 13:37:20,812 [1] DEBUG - Statement Id: [DAO00000_GetDONGIA_BY_DICHVU_LOAIGIA] PreparedStatement : [SELECT DD.*              FROM TM_DICHVU_DONGIA DD              WHERE DD.DICHVU_ID = '5433' AND DD.LOAIGIA_ID = '3' AND DD.BENHVIEN_ID = 'HLU01' AND DD.TAMNGUNG = '0']
2019-08-26 13:37:21,179 [1] DEBUG - Statement Id: [DAO00000_GetDONGIA_BY_DICHVU_LOAIGIA] PreparedStatement : [SELECT DD.*              FROM TM_DICHVU_DONGIA DD              WHERE DD.DICHVU_ID = '5433' AND DD.LOAIGIA_ID = '3' AND DD.BENHVIEN_ID = 'HLU01' AND DD.TAMNGUNG = '0']
2019-08-26 13:37:38,993 [1] DEBUG - Statement Id: [DAO00099_GetLoaiGiaDichVu] PreparedStatement : [select A.LOAIGIA_ID,B.TENLOAIGIA, B.MALOAIGIA        from TM_DICHVU_DONGIA A        inner join TM_LOAIGIA B on A.LOAIGIA_ID = B.LOAIGIA_ID        inner join LST_DICTIONARY AS DIC ON DIC.DICTIONARY_ID = B.NHOMGIA_ID AND DIC.DICTIONARY_TYPE_CODE = 'NhomGia'        where A.DICHVU_ID = '5438' and A.BENHVIEN_ID = 'HLU01' and DIC.DICTIONARY_CODE != 'BHYT']
2019-08-26 13:37:40,502 [1] DEBUG - Statement Id: [DAO00000_GetDONGIA_BY_DICHVU_LOAIGIA] PreparedStatement : [SELECT DD.*              FROM TM_DICHVU_DONGIA DD              WHERE DD.DICHVU_ID = '5438' AND DD.LOAIGIA_ID = '3' AND DD.BENHVIEN_ID = 'HLU01' AND DD.TAMNGUNG = '0']
2019-08-26 13:37:40,758 [1] DEBUG - Statement Id: [DAO00000_GetDONGIA_BY_DICHVU_LOAIGIA] PreparedStatement : [SELECT DD.*              FROM TM_DICHVU_DONGIA DD              WHERE DD.DICHVU_ID = '5438' AND DD.LOAIGIA_ID = '3' AND DD.BENHVIEN_ID = 'HLU01' AND DD.TAMNGUNG = '0']
2019-08-26 13:38:30,053 [1] DEBUG - Statement Id: [DAO00099_GetLoaiGiaDichVu] PreparedStatement : [select A.LOAIGIA_ID,B.TENLOAIGIA, B.MALOAIGIA        from TM_DICHVU_DONGIA A        inner join TM_LOAIGIA B on A.LOAIGIA_ID = B.LOAIGIA_ID        inner join LST_DICTIONARY AS DIC ON DIC.DICTIONARY_ID = B.NHOMGIA_ID AND DIC.DICTIONARY_TYPE_CODE = 'NhomGia'        where A.DICHVU_ID = '4135' and A.BENHVIEN_ID = 'HLU01' and DIC.DICTIONARY_CODE != 'BHYT']
2019-08-26 13:38:31,479 [1] DEBUG - Statement Id: [DAO00000_GetDONGIA_BY_DICHVU_LOAIGIA] PreparedStatement : [SELECT DD.*              FROM TM_DICHVU_DONGIA DD              WHERE DD.DICHVU_ID = '4135' AND DD.LOAIGIA_ID = '9' AND DD.BENHVIEN_ID = 'HLU01' AND DD.TAMNGUNG = '0']
2019-08-26 13:38:32,250 [1] DEBUG - Statement Id: [DAO00000_GetDONGIA_BY_DICHVU_LOAIGIA] PreparedStatement : [SELECT DD.*              FROM TM_DICHVU_DONGIA DD              WHERE DD.DICHVU_ID = '4135' AND DD.LOAIGIA_ID = '9' AND DD.BENHVIEN_ID = 'HLU01' AND DD.TAMNGUNG = '0']
2019-08-26 13:38:44,306 [1] DEBUG - Statement Id: [DAO00099_GetLoaiGiaDichVu] PreparedStatement : [select A.LOAIGIA_ID,B.TENLOAIGIA, B.MALOAIGIA        from TM_DICHVU_DONGIA A        inner join TM_LOAIGIA B on A.LOAIGIA_ID = B.LOAIGIA_ID        inner join LST_DICTIONARY AS DIC ON DIC.DICTIONARY_ID = B.NHOMGIA_ID AND DIC.DICTIONARY_TYPE_CODE = 'NhomGia'        where A.DICHVU_ID = '4005' and A.BENHVIEN_ID = 'HLU01' and DIC.DICTIONARY_CODE != 'BHYT']
2019-08-26 13:38:45,757 [1] DEBUG - Statement Id: [DAO00000_GetDONGIA_BY_DICHVU_LOAIGIA] PreparedStatement : [SELECT DD.*              FROM TM_DICHVU_DONGIA DD              WHERE DD.DICHVU_ID = '4005' AND DD.LOAIGIA_ID = '9' AND DD.BENHVIEN_ID = 'HLU01' AND DD.TAMNGUNG = '0']
2019-08-26 13:38:46,051 [1] DEBUG - Statement Id: [DAO00000_GetDONGIA_BY_DICHVU_LOAIGIA] PreparedStatement : [SELECT DD.*              FROM TM_DICHVU_DONGIA DD              WHERE DD.DICHVU_ID = '4005' AND DD.LOAIGIA_ID = '9' AND DD.BENHVIEN_ID = 'HLU01' AND DD.TAMNGUNG = '0']
2019-08-26 13:39:00,636 [1] DEBUG - Statement Id: [DAO00099_GetLoaiGiaDichVu] PreparedStatement : [select A.LOAIGIA_ID,B.TENLOAIGIA, B.MALOAIGIA        from TM_DICHVU_DONGIA A        inner join TM_LOAIGIA B on A.LOAIGIA_ID = B.LOAIGIA_ID        inner join LST_DICTIONARY AS DIC ON DIC.DICTIONARY_ID = B.NHOMGIA_ID AND DIC.DICTIONARY_TYPE_CODE = 'NhomGia'        where A.DICHVU_ID = '4017' and A.BENHVIEN_ID = 'HLU01' and DIC.DICTIONARY_CODE != 'BHYT']
2019-08-26 13:39:02,293 [1] DEBUG - Statement Id: [DAO00000_GetDONGIA_BY_DICHVU_LOAIGIA] PreparedStatement : [SELECT DD.*              FROM TM_DICHVU_DONGIA DD              WHERE DD.DICHVU_ID = '4017' AND DD.LOAIGIA_ID = '9' AND DD.BENHVIEN_ID = 'HLU01' AND DD.TAMNGUNG = '0']
2019-08-26 13:39:02,991 [1] DEBUG - Statement Id: [DAO00000_GetDONGIA_BY_DICHVU_LOAIGIA] PreparedStatement : [SELECT DD.*              FROM TM_DICHVU_DONGIA DD              WHERE DD.DICHVU_ID = '4017' AND DD.LOAIGIA_ID = '3' AND DD.BENHVIEN_ID = 'HLU01' AND DD.TAMNGUNG = '0']
2019-08-26 13:39:03,595 [1] DEBUG - Statement Id: [DAO00000_GetDONGIA_BY_DICHVU_LOAIGIA] PreparedStatement : [SELECT DD.*              FROM TM_DICHVU_DONGIA DD              WHERE DD.DICHVU_ID = '4017' AND DD.LOAIGIA_ID = '3' AND DD.BENHVIEN_ID = 'HLU01' AND DD.TAMNGUNG = '0']
2019-08-26 13:39:27,604 [1] DEBUG - Statement Id: [DAO00099_GetLoaiGiaDichVu] PreparedStatement : [select A.LOAIGIA_ID,B.TENLOAIGIA, B.MALOAIGIA        from TM_DICHVU_DONGIA A        inner join TM_LOAIGIA B on A.LOAIGIA_ID = B.LOAIGIA_ID        inner join LST_DICTIONARY AS DIC ON DIC.DICTIONARY_ID = B.NHOMGIA_ID AND DIC.DICTIONARY_TYPE_CODE = 'NhomGia'        where A.DICHVU_ID = '4524' and A.BENHVIEN_ID = 'HLU01' and DIC.DICTIONARY_CODE != 'BHYT']
2019-08-26 13:39:29,719 [1] DEBUG - Statement Id: [DAO00000_GetDONGIA_BY_DICHVU_LOAIGIA] PreparedStatement : [SELECT DD.*              FROM TM_DICHVU_DONGIA DD              WHERE DD.DICHVU_ID = '4524' AND DD.LOAIGIA_ID = '9' AND DD.BENHVIEN_ID = 'HLU01' AND DD.TAMNGUNG = '0']
2019-08-26 13:39:30,234 [1] DEBUG - Statement Id: [DAO00000_GetDONGIA_BY_DICHVU_LOAIGIA] PreparedStatement : [SELECT DD.*              FROM TM_DICHVU_DONGIA DD              WHERE DD.DICHVU_ID = '4524' AND DD.LOAIGIA_ID = '3' AND DD.BENHVIEN_ID = 'HLU01' AND DD.TAMNGUNG = '0']
2019-08-26 13:39:30,972 [1] DEBUG - Statement Id: [DAO00000_GetDONGIA_BY_DICHVU_LOAIGIA] PreparedStatement : [SELECT DD.*              FROM TM_DICHVU_DONGIA DD              WHERE DD.DICHVU_ID = '4524' AND DD.LOAIGIA_ID = '3' AND DD.BENHVIEN_ID = 'HLU01' AND DD.TAMNGUNG = '0']
2019-08-26 13:39:40,228 [1] DEBUG - Statement Id: [DAO00099_GetLoaiGiaDichVu] PreparedStatement : [select A.LOAIGIA_ID,B.TENLOAIGIA, B.MALOAIGIA        from TM_DICHVU_DONGIA A        inner join TM_LOAIGIA B on A.LOAIGIA_ID = B.LOAIGIA_ID        inner join LST_DICTIONARY AS DIC ON DIC.DICTIONARY_ID = B.NHOMGIA_ID AND DIC.DICTIONARY_TYPE_CODE = 'NhomGia'        where A.DICHVU_ID = '4747' and A.BENHVIEN_ID = 'HLU01' and DIC.DICTIONARY_CODE != 'BHYT']
2019-08-26 13:39:41,748 [1] DEBUG - Statement Id: [DAO00000_GetDONGIA_BY_DICHVU_LOAIGIA] PreparedStatement : [SELECT DD.*              FROM TM_DICHVU_DONGIA DD              WHERE DD.DICHVU_ID = '4747' AND DD.LOAIGIA_ID = '9' AND DD.BENHVIEN_ID = 'HLU01' AND DD.TAMNGUNG = '0']
2019-08-26 13:39:42,193 [1] DEBUG - Statement Id: [DAO00000_GetDONGIA_BY_DICHVU_LOAIGIA] PreparedStatement : [SELECT DD.*              FROM TM_DICHVU_DONGIA DD              WHERE DD.DICHVU_ID = '4747' AND DD.LOAIGIA_ID = '3' AND DD.BENHVIEN_ID = 'HLU01' AND DD.TAMNGUNG = '0']
2019-08-26 13:39:42,499 [1] DEBUG - Statement Id: [DAO00000_GetDONGIA_BY_DICHVU_LOAIGIA] PreparedStatement : [SELECT DD.*              FROM TM_DICHVU_DONGIA DD              WHERE DD.DICHVU_ID = '4747' AND DD.LOAIGIA_ID = '3' AND DD.BENHVIEN_ID = 'HLU01' AND DD.TAMNGUNG = '0']
2019-08-26 13:40:23,469 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_Add] PreparedStatement : [INSERT INTO TM_CSKH_GOI             (MAGOI             ,TENGOI             ,LOAIGOI_ID             ,GIATRIGOI             ,GIATRICHUAGIAM             ,TYLEMIENGIAM             ,GIATRIMIENGIAM             ,NGAYBATDAUBAN             ,NGAYKETTHUCBAN             ,THOIGIANSUDUNG             ,NGAYHETHANTUYETDOI             ,MOTAGOI             ,LYDOHUY             ,LAGOIMAU             ,TRANGTHAI             ,NGAYDUYET             ,NGUOIDUYET_ID             ,BENHVIEN_ID             ,NGAYTAO             ,NGUOITAO_ID             ,NGAYCAPNHAT             ,NGUOICAPNHAT_ID)       VALUES             ( @param0              , @param1              , @param2              , @param3              , @param4              , @param5              , @param6              , @param7              , @param8              , @param9              , @param10              , @param11              , @param12              , @param13              , @param14              , @param15              , @param16              , @param17              , @param18              , @param19              , @param20              , @param21              )        select SCOPE_identity() as value]
2019-08-26 13:40:23,469 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_Add] Parameters: [@param0=[MAGOI,FPT01], @param1=[TENGOI,Gói FPT 01], @param2=[LOAIGOI_ID,11675], @param3=[GIATRIGOI,500000], @param4=[GIATRICHUAGIAM,500000], @param5=[TYLEMIENGIAM,100], @param6=[GIATRIMIENGIAM,0], @param7=[NGAYBATDAUBAN,8/26/2019 12:00:00 AM], @param8=[NGAYKETTHUCBAN,12/31/2019 12:00:00 AM], @param9=[THOIGIANSUDUNG,30], @param10=[NGAYHETHANTUYETDOI,null], @param11=[MOTAGOI,null], @param12=[LYDOHUY,null], @param13=[LAGOIMAU,null], @param14=[TRANGTHAI,GOIDUOCPHEPBAN], @param15=[NGAYDUYET,null], @param16=[NGUOIDUYET_ID,null], @param17=[BENHVIEN_ID,HLU01], @param18=[NGAYTAO,8/26/2019 1:40:23 PM], @param19=[NGUOITAO_ID,1], @param20=[NGAYCAPNHAT,8/26/2019 1:40:23 PM], @param21=[NGUOICAPNHAT_ID,1]]
2019-08-26 13:40:23,469 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_Add] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[Int64, System.Int64], @param3=[Double, System.Double], @param4=[Double, System.Double], @param5=[Double, System.Double], @param6=[Decimal, System.Decimal], @param7=[DateTime, System.DateTime], @param8=[DateTime, System.DateTime], @param9=[Int64, System.Int64], @param10=[System.DBNull, null], @param11=[System.DBNull, null], @param12=[System.DBNull, null], @param13=[System.DBNull, null], @param14=[String, System.String], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[String, System.String], @param18=[DateTime, System.DateTime], @param19=[Int64, System.Int64], @param20=[DateTime, System.DateTime], @param21=[Int64, System.Int64]]
2019-08-26 13:40:23,585 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_Add] PreparedStatement : [INSERT INTO TM_CSKH_GOI_CHITIET             (GOI_ID             ,DICHVU_ID             ,SOLAN             ,DONGIATRONGGOI             ,THANHTIENTRONGGOI             ,LOAIGIA_ID             ,GIAVON_DICHVU             ,GIAVAT_DICHVU             ,MOTA             ,TINHTRANG             ,BENHVIEN_ID             ,NGAYTAO             ,NGUOITAO_ID             ,NGAYCAPNHAT             ,NGUOICAPNHAT_ID)       VALUES             ( @param0              , @param1              , @param2              , @param3              , @param4              , @param5              , @param6              , @param7              , @param8              , @param9              , @param10              , @param11              , @param12              , @param13              , @param14              )]
2019-08-26 13:40:23,585 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_Add] Parameters: [@param0=[GOI_ID,3], @param1=[DICHVU_ID,5435], @param2=[SOLAN,1], @param3=[DONGIATRONGGOI,50000], @param4=[THANHTIENTRONGGOI,50000], @param5=[LOAIGIA_ID,3], @param6=[GIAVON_DICHVU,null], @param7=[GIAVAT_DICHVU,null], @param8=[MOTA,null], @param9=[TINHTRANG,null], @param10=[BENHVIEN_ID,HLU01], @param11=[NGAYTAO,8/26/2019 1:40:23 PM], @param12=[NGUOITAO_ID,1], @param13=[NGAYCAPNHAT,8/26/2019 1:40:23 PM], @param14=[NGUOICAPNHAT_ID,1]]
2019-08-26 13:40:23,585 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_Add] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64], @param2=[Int64, System.Int64], @param3=[Double, System.Double], @param4=[Double, System.Double], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[System.DBNull, null], @param8=[System.DBNull, null], @param9=[System.DBNull, null], @param10=[String, System.String], @param11=[DateTime, System.DateTime], @param12=[Int64, System.Int64], @param13=[DateTime, System.DateTime], @param14=[Int64, System.Int64]]
2019-08-26 13:40:23,649 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_Add] PreparedStatement : [INSERT INTO TM_CSKH_GOI_CHITIET             (GOI_ID             ,DICHVU_ID             ,SOLAN             ,DONGIATRONGGOI             ,THANHTIENTRONGGOI             ,LOAIGIA_ID             ,GIAVON_DICHVU             ,GIAVAT_DICHVU             ,MOTA             ,TINHTRANG             ,BENHVIEN_ID             ,NGAYTAO             ,NGUOITAO_ID             ,NGAYCAPNHAT             ,NGUOICAPNHAT_ID)       VALUES             ( @param0              , @param1              , @param2              , @param3              , @param4              , @param5              , @param6              , @param7              , @param8              , @param9              , @param10              , @param11              , @param12              , @param13              , @param14              )]
2019-08-26 13:40:23,650 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_Add] Parameters: [@param0=[GOI_ID,3], @param1=[DICHVU_ID,5443], @param2=[SOLAN,1], @param3=[DONGIATRONGGOI,50000], @param4=[THANHTIENTRONGGOI,50000], @param5=[LOAIGIA_ID,3], @param6=[GIAVON_DICHVU,null], @param7=[GIAVAT_DICHVU,null], @param8=[MOTA,null], @param9=[TINHTRANG,null], @param10=[BENHVIEN_ID,HLU01], @param11=[NGAYTAO,8/26/2019 1:40:23 PM], @param12=[NGUOITAO_ID,1], @param13=[NGAYCAPNHAT,8/26/2019 1:40:23 PM], @param14=[NGUOICAPNHAT_ID,1]]
2019-08-26 13:40:23,650 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_Add] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64], @param2=[Int64, System.Int64], @param3=[Double, System.Double], @param4=[Double, System.Double], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[System.DBNull, null], @param8=[System.DBNull, null], @param9=[System.DBNull, null], @param10=[String, System.String], @param11=[DateTime, System.DateTime], @param12=[Int64, System.Int64], @param13=[DateTime, System.DateTime], @param14=[Int64, System.Int64]]
2019-08-26 13:40:23,680 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_Add] PreparedStatement : [INSERT INTO TM_CSKH_GOI_CHITIET             (GOI_ID             ,DICHVU_ID             ,SOLAN             ,DONGIATRONGGOI             ,THANHTIENTRONGGOI             ,LOAIGIA_ID             ,GIAVON_DICHVU             ,GIAVAT_DICHVU             ,MOTA             ,TINHTRANG             ,BENHVIEN_ID             ,NGAYTAO             ,NGUOITAO_ID             ,NGAYCAPNHAT             ,NGUOICAPNHAT_ID)       VALUES             ( @param0              , @param1              , @param2              , @param3              , @param4              , @param5              , @param6              , @param7              , @param8              , @param9              , @param10              , @param11              , @param12              , @param13              , @param14              )]
2019-08-26 13:40:23,680 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_Add] Parameters: [@param0=[GOI_ID,3], @param1=[DICHVU_ID,5433], @param2=[SOLAN,1], @param3=[DONGIATRONGGOI,50000], @param4=[THANHTIENTRONGGOI,50000], @param5=[LOAIGIA_ID,3], @param6=[GIAVON_DICHVU,null], @param7=[GIAVAT_DICHVU,null], @param8=[MOTA,null], @param9=[TINHTRANG,null], @param10=[BENHVIEN_ID,HLU01], @param11=[NGAYTAO,8/26/2019 1:40:23 PM], @param12=[NGUOITAO_ID,1], @param13=[NGAYCAPNHAT,8/26/2019 1:40:23 PM], @param14=[NGUOICAPNHAT_ID,1]]
2019-08-26 13:40:23,680 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_Add] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64], @param2=[Int64, System.Int64], @param3=[Double, System.Double], @param4=[Double, System.Double], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[System.DBNull, null], @param8=[System.DBNull, null], @param9=[System.DBNull, null], @param10=[String, System.String], @param11=[DateTime, System.DateTime], @param12=[Int64, System.Int64], @param13=[DateTime, System.DateTime], @param14=[Int64, System.Int64]]
2019-08-26 13:40:23,712 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_Add] PreparedStatement : [INSERT INTO TM_CSKH_GOI_CHITIET             (GOI_ID             ,DICHVU_ID             ,SOLAN             ,DONGIATRONGGOI             ,THANHTIENTRONGGOI             ,LOAIGIA_ID             ,GIAVON_DICHVU             ,GIAVAT_DICHVU             ,MOTA             ,TINHTRANG             ,BENHVIEN_ID             ,NGAYTAO             ,NGUOITAO_ID             ,NGAYCAPNHAT             ,NGUOICAPNHAT_ID)       VALUES             ( @param0              , @param1              , @param2              , @param3              , @param4              , @param5              , @param6              , @param7              , @param8              , @param9              , @param10              , @param11              , @param12              , @param13              , @param14              )]
2019-08-26 13:40:23,713 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_Add] Parameters: [@param0=[GOI_ID,3], @param1=[DICHVU_ID,5438], @param2=[SOLAN,1], @param3=[DONGIATRONGGOI,50000], @param4=[THANHTIENTRONGGOI,50000], @param5=[LOAIGIA_ID,3], @param6=[GIAVON_DICHVU,null], @param7=[GIAVAT_DICHVU,null], @param8=[MOTA,null], @param9=[TINHTRANG,null], @param10=[BENHVIEN_ID,HLU01], @param11=[NGAYTAO,8/26/2019 1:40:23 PM], @param12=[NGUOITAO_ID,1], @param13=[NGAYCAPNHAT,8/26/2019 1:40:23 PM], @param14=[NGUOICAPNHAT_ID,1]]
2019-08-26 13:40:23,713 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_Add] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64], @param2=[Int64, System.Int64], @param3=[Double, System.Double], @param4=[Double, System.Double], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[System.DBNull, null], @param8=[System.DBNull, null], @param9=[System.DBNull, null], @param10=[String, System.String], @param11=[DateTime, System.DateTime], @param12=[Int64, System.Int64], @param13=[DateTime, System.DateTime], @param14=[Int64, System.Int64]]
2019-08-26 13:40:23,744 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_Add] PreparedStatement : [INSERT INTO TM_CSKH_GOI_CHITIET             (GOI_ID             ,DICHVU_ID             ,SOLAN             ,DONGIATRONGGOI             ,THANHTIENTRONGGOI             ,LOAIGIA_ID             ,GIAVON_DICHVU             ,GIAVAT_DICHVU             ,MOTA             ,TINHTRANG             ,BENHVIEN_ID             ,NGAYTAO             ,NGUOITAO_ID             ,NGAYCAPNHAT             ,NGUOICAPNHAT_ID)       VALUES             ( @param0              , @param1              , @param2              , @param3              , @param4              , @param5              , @param6              , @param7              , @param8              , @param9              , @param10              , @param11              , @param12              , @param13              , @param14              )]
2019-08-26 13:40:23,744 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_Add] Parameters: [@param0=[GOI_ID,3], @param1=[DICHVU_ID,4135], @param2=[SOLAN,1], @param3=[DONGIATRONGGOI,90000], @param4=[THANHTIENTRONGGOI,90000], @param5=[LOAIGIA_ID,9], @param6=[GIAVON_DICHVU,null], @param7=[GIAVAT_DICHVU,null], @param8=[MOTA,null], @param9=[TINHTRANG,null], @param10=[BENHVIEN_ID,HLU01], @param11=[NGAYTAO,8/26/2019 1:40:23 PM], @param12=[NGUOITAO_ID,1], @param13=[NGAYCAPNHAT,8/26/2019 1:40:23 PM], @param14=[NGUOICAPNHAT_ID,1]]
2019-08-26 13:40:23,744 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_Add] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64], @param2=[Int64, System.Int64], @param3=[Double, System.Double], @param4=[Double, System.Double], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[System.DBNull, null], @param8=[System.DBNull, null], @param9=[System.DBNull, null], @param10=[String, System.String], @param11=[DateTime, System.DateTime], @param12=[Int64, System.Int64], @param13=[DateTime, System.DateTime], @param14=[Int64, System.Int64]]
2019-08-26 13:40:23,777 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_Add] PreparedStatement : [INSERT INTO TM_CSKH_GOI_CHITIET             (GOI_ID             ,DICHVU_ID             ,SOLAN             ,DONGIATRONGGOI             ,THANHTIENTRONGGOI             ,LOAIGIA_ID             ,GIAVON_DICHVU             ,GIAVAT_DICHVU             ,MOTA             ,TINHTRANG             ,BENHVIEN_ID             ,NGAYTAO             ,NGUOITAO_ID             ,NGAYCAPNHAT             ,NGUOICAPNHAT_ID)       VALUES             ( @param0              , @param1              , @param2              , @param3              , @param4              , @param5              , @param6              , @param7              , @param8              , @param9              , @param10              , @param11              , @param12              , @param13              , @param14              )]
2019-08-26 13:40:23,777 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_Add] Parameters: [@param0=[GOI_ID,3], @param1=[DICHVU_ID,4005], @param2=[SOLAN,1], @param3=[DONGIATRONGGOI,70000], @param4=[THANHTIENTRONGGOI,70000], @param5=[LOAIGIA_ID,9], @param6=[GIAVON_DICHVU,null], @param7=[GIAVAT_DICHVU,null], @param8=[MOTA,null], @param9=[TINHTRANG,null], @param10=[BENHVIEN_ID,HLU01], @param11=[NGAYTAO,8/26/2019 1:40:23 PM], @param12=[NGUOITAO_ID,1], @param13=[NGAYCAPNHAT,8/26/2019 1:40:23 PM], @param14=[NGUOICAPNHAT_ID,1]]
2019-08-26 13:40:23,777 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_Add] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64], @param2=[Int64, System.Int64], @param3=[Double, System.Double], @param4=[Double, System.Double], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[System.DBNull, null], @param8=[System.DBNull, null], @param9=[System.DBNull, null], @param10=[String, System.String], @param11=[DateTime, System.DateTime], @param12=[Int64, System.Int64], @param13=[DateTime, System.DateTime], @param14=[Int64, System.Int64]]
2019-08-26 13:40:23,806 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_Add] PreparedStatement : [INSERT INTO TM_CSKH_GOI_CHITIET             (GOI_ID             ,DICHVU_ID             ,SOLAN             ,DONGIATRONGGOI             ,THANHTIENTRONGGOI             ,LOAIGIA_ID             ,GIAVON_DICHVU             ,GIAVAT_DICHVU             ,MOTA             ,TINHTRANG             ,BENHVIEN_ID             ,NGAYTAO             ,NGUOITAO_ID             ,NGAYCAPNHAT             ,NGUOICAPNHAT_ID)       VALUES             ( @param0              , @param1              , @param2              , @param3              , @param4              , @param5              , @param6              , @param7              , @param8              , @param9              , @param10              , @param11              , @param12              , @param13              , @param14              )]
2019-08-26 13:40:23,806 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_Add] Parameters: [@param0=[GOI_ID,3], @param1=[DICHVU_ID,4017], @param2=[SOLAN,1], @param3=[DONGIATRONGGOI,50000], @param4=[THANHTIENTRONGGOI,50000], @param5=[LOAIGIA_ID,3], @param6=[GIAVON_DICHVU,null], @param7=[GIAVAT_DICHVU,null], @param8=[MOTA,null], @param9=[TINHTRANG,null], @param10=[BENHVIEN_ID,HLU01], @param11=[NGAYTAO,8/26/2019 1:40:23 PM], @param12=[NGUOITAO_ID,1], @param13=[NGAYCAPNHAT,8/26/2019 1:40:23 PM], @param14=[NGUOICAPNHAT_ID,1]]
2019-08-26 13:40:23,806 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_Add] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64], @param2=[Int64, System.Int64], @param3=[Double, System.Double], @param4=[Double, System.Double], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[System.DBNull, null], @param8=[System.DBNull, null], @param9=[System.DBNull, null], @param10=[String, System.String], @param11=[DateTime, System.DateTime], @param12=[Int64, System.Int64], @param13=[DateTime, System.DateTime], @param14=[Int64, System.Int64]]
2019-08-26 13:40:23,833 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_Add] PreparedStatement : [INSERT INTO TM_CSKH_GOI_CHITIET             (GOI_ID             ,DICHVU_ID             ,SOLAN             ,DONGIATRONGGOI             ,THANHTIENTRONGGOI             ,LOAIGIA_ID             ,GIAVON_DICHVU             ,GIAVAT_DICHVU             ,MOTA             ,TINHTRANG             ,BENHVIEN_ID             ,NGAYTAO             ,NGUOITAO_ID             ,NGAYCAPNHAT             ,NGUOICAPNHAT_ID)       VALUES             ( @param0              , @param1              , @param2              , @param3              , @param4              , @param5              , @param6              , @param7              , @param8              , @param9              , @param10              , @param11              , @param12              , @param13              , @param14              )]
2019-08-26 13:40:23,833 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_Add] Parameters: [@param0=[GOI_ID,3], @param1=[DICHVU_ID,4524], @param2=[SOLAN,1], @param3=[DONGIATRONGGOI,50000], @param4=[THANHTIENTRONGGOI,50000], @param5=[LOAIGIA_ID,3], @param6=[GIAVON_DICHVU,null], @param7=[GIAVAT_DICHVU,null], @param8=[MOTA,null], @param9=[TINHTRANG,null], @param10=[BENHVIEN_ID,HLU01], @param11=[NGAYTAO,8/26/2019 1:40:23 PM], @param12=[NGUOITAO_ID,1], @param13=[NGAYCAPNHAT,8/26/2019 1:40:23 PM], @param14=[NGUOICAPNHAT_ID,1]]
2019-08-26 13:40:23,833 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_Add] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64], @param2=[Int64, System.Int64], @param3=[Double, System.Double], @param4=[Double, System.Double], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[System.DBNull, null], @param8=[System.DBNull, null], @param9=[System.DBNull, null], @param10=[String, System.String], @param11=[DateTime, System.DateTime], @param12=[Int64, System.Int64], @param13=[DateTime, System.DateTime], @param14=[Int64, System.Int64]]
2019-08-26 13:40:23,862 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_Add] PreparedStatement : [INSERT INTO TM_CSKH_GOI_CHITIET             (GOI_ID             ,DICHVU_ID             ,SOLAN             ,DONGIATRONGGOI             ,THANHTIENTRONGGOI             ,LOAIGIA_ID             ,GIAVON_DICHVU             ,GIAVAT_DICHVU             ,MOTA             ,TINHTRANG             ,BENHVIEN_ID             ,NGAYTAO             ,NGUOITAO_ID             ,NGAYCAPNHAT             ,NGUOICAPNHAT_ID)       VALUES             ( @param0              , @param1              , @param2              , @param3              , @param4              , @param5              , @param6              , @param7              , @param8              , @param9              , @param10              , @param11              , @param12              , @param13              , @param14              )]
2019-08-26 13:40:23,863 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_Add] Parameters: [@param0=[GOI_ID,3], @param1=[DICHVU_ID,4747], @param2=[SOLAN,1], @param3=[DONGIATRONGGOI,40000], @param4=[THANHTIENTRONGGOI,40000], @param5=[LOAIGIA_ID,3], @param6=[GIAVON_DICHVU,null], @param7=[GIAVAT_DICHVU,null], @param8=[MOTA,null], @param9=[TINHTRANG,null], @param10=[BENHVIEN_ID,HLU01], @param11=[NGAYTAO,8/26/2019 1:40:23 PM], @param12=[NGUOITAO_ID,1], @param13=[NGAYCAPNHAT,8/26/2019 1:40:23 PM], @param14=[NGUOICAPNHAT_ID,1]]
2019-08-26 13:40:23,863 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_Add] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64], @param2=[Int64, System.Int64], @param3=[Double, System.Double], @param4=[Double, System.Double], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[System.DBNull, null], @param8=[System.DBNull, null], @param9=[System.DBNull, null], @param10=[String, System.String], @param11=[DateTime, System.DateTime], @param12=[Int64, System.Int64], @param13=[DateTime, System.DateTime], @param14=[Int64, System.Int64]]
2019-08-26 13:40:35,113 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'HSM01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 13:40:35,499 [1] DEBUG - Statement Id: [DAO00325_GetList] PreparedStatement : [select DICTIONARY_ID, DICTIONARY_CODE, DICTIONARY_NAME        from LST_DICTIONARY        where DICTIONARY_TYPE_CODE = 'TrangThaiCongTy'         and           BENHVIEN_ID = 'HLU01'                 order by DICTIONARY_ID DESC]
2019-08-26 13:40:36,307 [1] DEBUG - Statement Id: [DAO00309_GetLoaiCongTy] PreparedStatement : [select *        from LST_DICTIONARY where DICTIONARY_TYPE_CODE = 'LoaiCongTy'         and           BENHVIEN_ID = 'HLU01']
2019-08-26 13:40:36,443 [1] DEBUG - Statement Id: [DAO00306_GetList] PreparedStatement : [SELECT *        FROM TT_KSK_CONGTY         where                 BENHVIEN_ID = 'HLU01'                     ORDER BY CONGTY_ID]
2019-08-26 13:40:37,000 [1] DEBUG - Statement Id: [DAO00309_GetAllCongTy] PreparedStatement : [select * from(        select COUNT(*) OVER() as TOTALROWS,ROW_NUMBER() OVER (ORDER BY a.CONGTY_ID) as ROWNUMBER, * from        (select ct.*, lst.DICTIONARY_NAME as LOAICONGTY, CASE WHEN CT.XAPHUONG_ID IS NOT NULL THEN ISNULL(ct.SONHA,'') + ',' + ISNULL(XP.TENDONVI,'') + ',' + ISNULL(QH.TENDONVI,'') + ',' + ISNULL(TP.TENDONVI,'') ELSE '' END as DIACHILIENLAC        , ct.TAMNGUNG as TRANGTHAI        from TT_KSK_CONGTY ct        left join LST_DICTIONARY lst on lst.DICTIONARY_ID = ct.LOAICONGTY_ID        left join TM_DONVIHANHCHINH XP on XP.MADONVI = ct.XAPHUONG_ID                 left join TM_DONVIHANHCHINH QH on QH.DONVIHANHCHINH_ID = XP.CAPTREN_ID        left join TM_DONVIHANHCHINH TP on TP.DONVIHANHCHINH_ID = QH.CAPTREN_ID         where                 ct.BENHVIEN_ID = 'HLU01'                     )a        )b        where b.ROWNUMBER between '1' AND '20'        order by b.CONGTY_ID]
2019-08-26 13:40:43,471 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'HSM06'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 13:40:44,281 [1] DEBUG - Statement Id: [DAO00306_LOAIHOPDONG] PreparedStatement : [SELECT * FROM LST_DICTIONARY        WHERE DICTIONARY_TYPE_CODE = 'LoaiHopDong'                 ORDER BY LST_DICTIONARY.DICTIONARY_ID]
2019-08-26 13:40:44,380 [1] DEBUG - Statement Id: [DAO00306_TRANGTHAIHD] PreparedStatement : [SELECT * FROM LST_DICTIONARY        WHERE DICTIONARY_TYPE_CODE = 'TrangThaiHopDong'                 ORDER BY LST_DICTIONARY.DICTIONARY_ID]
2019-08-26 13:40:44,420 [1] DEBUG - Statement Id: [DAO00306_CONGTYHOPDONG] PreparedStatement : [SELECT * FROM TT_KSK_CONGTY        where TAMNGUNG = '0']
2019-08-26 13:40:44,588 [1] DEBUG - Statement Id: [DAO00306_HINHTHUCTHANHTOANPHATSINH] PreparedStatement : [SELECT * FROM LST_DICTIONARY        WHERE DICTIONARY_TYPE_CODE = 'HinhThucThanhToanPhatSinh'                 ORDER BY LST_DICTIONARY.DICTIONARY_ID]
2019-08-26 13:40:44,914 [1] DEBUG - Statement Id: [DAO00307_GetGoiDichVu] PreparedStatement : [SELECT G.*, G.GOI_ID as GOIDICHVU_ID        , case when G.GOI_ID in (select GOIDICHVU_ID from TT_KSK_HOPDONG_GOIDICHVU where HOPDONG_ID = 0) then 1 else 0 end as GOIEXIST        FROM TM_CSKH_GOI G INNER JOIN LST_DICTIONARY L ON L.DICTIONARY_ID = G.LOAIGOI_ID        WHERE G.BENHVIEN_ID = 'HLU01' AND L.DICTIONARY_TYPE_CODE = 'LoaiGoiDV'         AND L.DICTIONARY_CODE = 'KhamSucKhoe' AND G.TRANGTHAI = 'GOIDUOCPHEPBAN']
2019-08-26 13:40:55,203 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'HSM03'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 13:40:55,582 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM98'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 13:40:56,326 [1] DEBUG - Statement Id: [DAO00306_TRANGTHAIHD] PreparedStatement : [SELECT * FROM LST_DICTIONARY        WHERE DICTIONARY_TYPE_CODE = 'TrangThaiHopDong'                 ORDER BY LST_DICTIONARY.DICTIONARY_ID]
2019-08-26 13:40:56,362 [1] DEBUG - Statement Id: [DAO00307_GetHopDong] PreparedStatement : [SELECT HD.*, CT.TENCONGTY, LHD.DICTIONARY_NAME AS LOAIHD, TT.DICTIONARY_NAME AS TRANGTHAI_HOPDONG, HTTT.DICTIONARY_NAME AS HINHTHUCPHATSINH        FROM TT_KSK_HOPDONG HD        JOIN TT_KSK_CONGTY CT ON CT.CONGTY_ID = HD.CONGTY_ID        LEFT JOIN LST_DICTIONARY LHD ON LHD.DICTIONARY_ID = HD.LOAI_HD        LEFT JOIN LST_DICTIONARY TT ON TT.DICTIONARY_ID = HD.TRANGTHAI_HD        LEFT JOIN LST_DICTIONARY HTTT ON HTTT.DICTIONARY_ID = HD.HINHTHUCTHANHTOAN_PHATSINH        WHERE HD.BENHVIEN_ID = 'HLU01'           and               HD.NGAY_HD >= '8/26/2019 12:00:00 AM'             and               HD.NGAY_HD <= '8/26/2019 12:00:00 AM'                     ORDER BY HD.SO_HD]
2019-08-26 13:41:43,747 [1] DEBUG - Statement Id: [DAO00306_GetGoiDichVuDetail] PreparedStatement : [SELECT DISTINCT PB.TENPHONGBAN AS NOITHUCHIEN, CT.*, ISNULL(CT.SOLAN,0) AS SOLUONG, DV.TENDICHVU, ISNULL(CT.DONGIATRONGGOI,0) AS DONGIA, isnull(CT.THANHTIENTRONGGOI,0) AS THANHTIEN        , NDV.TENNHOMDICHVU        FROM TM_CSKH_GOI_CHITIET CT        INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = CT.DICHVU_ID        INNER JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        LEFT JOIN TM_PHONGBAN_DICHVU PB_DV ON DV.DICHVU_ID = PB_DV.DICHVU_ID        LEFT JOIN TM_PHONGBAN PB ON PB.PHONGBAN_ID = PB_DV.PHONGBAN_ID        WHERE CT.GOI_ID IN (SELECT * FROM DBO.SPLIT('3',', '))        and PB_DV.PHONGBAN_ID =(select top 1 PHONGBAN_ID from TM_PHONGBAN_DICHVU where DICHVU_ID = DV.DICHVU_ID)         and           CT.BENHVIEN_ID = 'HLU01']
2019-08-26 13:41:46,077 [1] DEBUG - Statement Id: [DAO00307_GetHopDongCallBack] PreparedStatement : [SELECT HD.*        FROM TT_KSK_HOPDONG HD        WHERE HD.BENHVIEN_ID = 'HLU01'           and             HD.SO_HD = 'HD005'           and             HD.KHOA = '0']
2019-08-26 13:41:46,190 [1] DEBUG - Statement Id: [DAO00306_Add] PreparedStatement : [insert into TT_KSK_HOPDONG (        CONGTY_ID        , SO_HD        , NGAY_HD        , GIATRI_HD        , LOAI_HD        , NGAYHIEULUC_HD        , NGAYHETHIEULUC_HD        , TRANGTHAI_HD        , SOLUONG_BN        , CHIETKHAU        , GIATIEN_TUNGBN        , HINHTHUCTHANHTOAN_PHATSINH        , GIATRI_TAMUNG        , GIATRI_PHATSINH        , DIENGIAI        , THOIGIANKHAM        , THOIGIANLAYMAU        , MAUCHECKLIST_ID        , KHOA        , THOIGIANKHOA        , NGUOIKHOA_ID        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYCAPNHAT        , NGUOICAPNHAT_ID        ) values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         )        select SCOPE_identity() as value]
2019-08-26 13:41:46,190 [1] DEBUG - Statement Id: [DAO00306_Add] Parameters: [@param0=[CONGTY_ID,1], @param1=[SO_HD,HD005], @param2=[NGAY_HD,8/26/2019 12:00:00 AM], @param3=[GIATRI_HD,500000000], @param4=[LOAI_HD,null], @param5=[NGAYHIEULUC_HD,8/26/2019 12:00:00 AM], @param6=[NGAYHETHIEULUC_HD,9/26/2019 12:00:00 AM], @param7=[TRANGTHAI_HD,11687], @param8=[SOLUONG_BN,1000], @param9=[CHIETKHAU,0], @param10=[GIATIEN_TUNGBN,500000], @param11=[HINHTHUCTHANHTOAN_PHATSINH,null], @param12=[GIATRI_TAMUNG,0], @param13=[GIATRI_PHATSINH,0], @param14=[DIENGIAI,null], @param15=[THOIGIANKHAM,null], @param16=[THOIGIANLAYMAU,null], @param17=[MAUCHECKLIST_ID,null], @param18=[KHOA,False], @param19=[THOIGIANKHOA,null], @param20=[NGUOIKHOA_ID,null], @param21=[BENHVIEN_ID,HLU01], @param22=[NGAYTAO,8/26/2019 1:41:46 PM], @param23=[NGUOITAO_ID,1], @param24=[NGAYCAPNHAT,8/26/2019 1:41:46 PM], @param25=[NGUOICAPNHAT_ID,1]]
2019-08-26 13:41:46,190 [1] DEBUG - Statement Id: [DAO00306_Add] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String], @param2=[DateTime, System.DateTime], @param3=[Double, System.Double], @param4=[System.DBNull, null], @param5=[DateTime, System.DateTime], @param6=[DateTime, System.DateTime], @param7=[Int64, System.Int64], @param8=[Double, System.Double], @param9=[Double, System.Double], @param10=[Double, System.Double], @param11=[System.DBNull, null], @param12=[Double, System.Double], @param13=[Double, System.Double], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Boolean, System.Boolean], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[String, System.String], @param22=[DateTime, System.DateTime], @param23=[Int64, System.Int64], @param24=[DateTime, System.DateTime], @param25=[Int64, System.Int64]]
2019-08-26 13:41:46,252 [1] DEBUG - Statement Id: [DAO00308_AddGoiDichVuByJson] PreparedStatement : [declare @jsonData nvarchar(max) = N'[{"GOI_ID":3,"MAGOI":"FPT01","TENGOI":"Gói FPT 01","LOAIGOI_ID":11675,"GIATRIGOI":500000.0,"GIATRICHUAGIAM":500000.0,"TYLEMIENGIAM":100.0,"GIATRIMIENGIAM":0.0,"NGAYBATDAUBAN":"2019-08-26T00:00:00","NGAYKETTHUCBAN":"2019-12-31T00:00:00","THOIGIANSUDUNG":30,"NGAYHETHANTUYETDOI":null,"MOTAGOI":null,"LYDOHUY":null,"LAGOIMAU":null,"TRANGTHAI":"GOIDUOCPHEPBAN","NGAYDUYET":null,"NGUOIDUYET_ID":null,"BENHVIEN_ID":"HLU01","NGAYTAO":"8/26/2019 1:41:46 PM","NGUOITAO_ID":1,"NGAYCAPNHAT":"8/26/2019 1:41:46 PM","NGUOICAPNHAT_ID":1,"GOIDICHVU_ID":3,"GOIEXIST":0,"BTNCHECK":true,"HOPDONG_ID":3}]';          delete from TT_KSK_HOPDONG_GOIDICHVU        where        HOPDONG_ID = 3 and GOIDICHVU_ID IN (SELECT * FROM DBO.SPLIT('2',', '))          delete from TT_KSK_HOPDONG_GOIDICHVU        where concat(GOIDICHVU_ID, HOPDONG_ID) IN (select concat(GOIDICHVU_ID, HOPDONG_ID) from OPENJSON(@jsonData) with (GOIDICHVU_ID int,HOPDONG_ID int))          INSERT INTO TT_KSK_HOPDONG_GOIDICHVU        SELECT *        FROM OPENJSON(@jsonData)        WITH        (        HOPDONG_ID int        , GOIDICHVU_ID int        , BENHVIEN_ID varchar(10)        , NGAYTAO datetime        , NGUOITAO_ID int        , NGAYCAPNHAT datetime        , NGUOICAPNHAT_ID int)]
2019-08-26 13:41:46,368 [1] DEBUG - Statement Id: [DAO00307_GetGoiDichVu] PreparedStatement : [SELECT G.*, G.GOI_ID as GOIDICHVU_ID        , case when G.GOI_ID in (select GOIDICHVU_ID from TT_KSK_HOPDONG_GOIDICHVU where HOPDONG_ID = 3) then 1 else 0 end as GOIEXIST        FROM TM_CSKH_GOI G INNER JOIN LST_DICTIONARY L ON L.DICTIONARY_ID = G.LOAIGOI_ID        WHERE G.BENHVIEN_ID = 'HLU01' AND L.DICTIONARY_TYPE_CODE = 'LoaiGoiDV'         AND L.DICTIONARY_CODE = 'KhamSucKhoe' AND G.TRANGTHAI = 'GOIDUOCPHEPBAN']
2019-08-26 13:41:50,805 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'HSM04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 13:41:56,198 [1] DEBUG - Statement Id: [DAO00326_GetList] PreparedStatement : [select DICTIONARY_ID, DICTIONARY_CODE, DICTIONARY_NAME        from LST_DICTIONARY        where DICTIONARY_TYPE_CODE = 'DoiTuongKhamSucKhoe'         and           BENHVIEN_ID = 'HLU01'                 order by DICTIONARY_ID DESC]
2019-08-26 13:41:56,553 [1] DEBUG - Statement Id: [DAO00327_GetList] PreparedStatement : [select *        from TM_DONVIHANHCHINH        where CAPDONVI = '2'        order by MADONVI]
2019-08-26 13:41:57,036 [1] DEBUG - Statement Id: [DAO00328_GetList] PreparedStatement : [SELECT DISTINCT GOI.*, HD_G.HOPDONG_ID        FROM TM_CSKH_GOI GOI        INNER JOIN LST_DICTIONARY L ON L.DICTIONARY_ID = GOI.LOAIGOI_ID        INNER JOIN TT_KSK_HOPDONG_GOIDICHVU HD_G ON HD_G.GOIDICHVU_ID = GOI.GOI_ID        WHERE GOI.TRANGTHAI='GOIDUOCPHEPBAN' AND L.DICTIONARY_TYPE_CODE = 'LoaiGoiDV' AND L.DICTIONARY_CODE = 'KhamSucKhoe']
2019-08-26 13:41:57,079 [1] DEBUG - Statement Id: [DAO00306_GetTinhTrangHonNhan] PreparedStatement : [SELECT *        FROM LST_DICTIONARY        WHERE DICTIONARY_TYPE_CODE = 'TinhTrangGiaDinh' and ENABLED = '1']
2019-08-26 13:41:57,168 [1] DEBUG - Statement Id: [DAO00307_GetContractWithDate] PreparedStatement : [SELECT HD.*, HD.SO_HD + ' - ' + CT.TENCONGTY AS HOPDONG, CT.TENCONGTY        FROM TT_KSK_HOPDONG HD JOIN TT_KSK_CONGTY CT ON CT.CONGTY_ID = HD.CONGTY_ID         where               HD.BENHVIEN_ID = 'HLU01']
2019-08-26 13:41:57,447 [1] DEBUG - Statement Id: [DAO00306_GetStatus] PreparedStatement : [select DICTIONARY_ID, DICTIONARY_CODE, DICTIONARY_NAME        from LST_DICTIONARY        where DICTIONARY_TYPE_CODE = 'TrangThaiCapMa']
2019-08-26 13:42:15,517 [1] DEBUG - Statement Id: [DAO00087_GetServiceParams] PreparedStatement : [select CODE, VALUE              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01']
2019-08-26 13:42:35,022 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhan] PreparedStatement : [SELECT HD_BN.*, LST.DICTIONARY_NAME AS HONNHAN        , CASE WHEN HD_BN.GIOITINH = '1' THEN N'Nam' ELSE N'Nữ' END AS GENDER        , NV.TENNHANVIEN, GOI.TENGOI        , DT.DICTIONARY_NAME as DOITUONG        , HC.TENDONVI as NOICAP        , ISNULL(HD_BN.DIACHI,'') + ',' + ISNULL(XP.TENDONVI,'') + ',' + ISNULL(QH.TENDONVI,'') + ',' + ISNULL(TP.TENDONVI,'') as DIACHILIENLAC        , CASE WHEN HD_BN.NGAYSINH IS NULL THEN CAST(HD_BN.NAMSINH AS VARCHAR(4)) ELSE CONVERT(VARCHAR(10), HD_BN.NGAYSINH,103) END AS NGAYTHANGNAMSINH        FROM TT_KSK_HOPDONG_BENHNHAN HD_BN        LEFT JOIN TT_KSK_HOPDONG HD ON HD.HOPDONG_ID = HD_BN.HOPDONG_ID        LEFT JOIN LST_DICTIONARY LST ON LST.DICTIONARY_ID = HD_BN.TINHTRANGHONNHAN_ID AND LST.DICTIONARY_TYPE_CODE = 'TinhTrangGiaDinh'        LEFT JOIN TM_NHANVIEN NV ON NV.NHANVIEN_ID = HD_BN.NHANVIEN_ID        LEFT JOIN TM_CSKH_GOI GOI ON GOI.GOI_ID = HD_BN.GOI_ID        LEFT JOIN LST_DICTIONARY DT ON DT.DICTIONARY_ID = HD_BN.DOITUONG_ID AND DT.DICTIONARY_TYPE_CODE = 'DoiTuongKhamSucKhoe'        LEFT JOIN TM_DONVIHANHCHINH HC ON HC.DONVIHANHCHINH_ID = HD_BN.NOICAP_ID        LEFT JOIN TM_DONVIHANHCHINH XP on XP.MADONVI = HD_BN.XAPHUONGTT_ID        LEFT JOIN TM_DONVIHANHCHINH QH on QH.DONVIHANHCHINH_ID = XP.CAPTREN_ID        LEFT JOIN TM_DONVIHANHCHINH TP on TP.DONVIHANHCHINH_ID = QH.CAPTREN_ID         where               HD_BN.HOPDONG_ID = 3           and             HD_BN.BENHVIEN_ID = 'HLU01'                   ORDER BY HD_BN.STT]
2019-08-26 13:42:38,672 [1] DEBUG - Statement Id: [DAO00308_StatusContract] PreparedStatement : [SELECT * FROM TT_KSK_HOPDONG        WHERE HOPDONG_ID = 3]
2019-08-26 13:42:43,958 [1] DEBUG - Statement Id: [DAO00308_StatusContract] PreparedStatement : [SELECT * FROM TT_KSK_HOPDONG        WHERE HOPDONG_ID = 3]
2019-08-26 13:42:46,893 [1] DEBUG - Statement Id: [DAO00307_Add] PreparedStatement : [insert into TT_KSK_HOPDONG_BENHNHAN (        HOPDONG_ID        , BENHNHAN_ID        , MAYTE        , TENBENHNHAN        , GIOITINH        , NGAYSINH        , NAMSINH        , DIACHI        , QUOCTICH_ID        , TINHTHANH_ID        , QUANHUYEN_ID        , XAPHUONG_ID        , DIACHITHUONGTRU        , XAPHUONGTT_ID        , DANTOC_ID        , LOAITHE        , SODIENTHOAI        , EMAIL        , NGHENGHIEP_ID        , TINHTRANGHONNHAN_ID        , DOITUONG_ID        , CMND        , NGAYCAPTHE        , NAMCAPTHE        , NOICAP_ID        , NHANVIEN_ID        , NHOMMAU_ID        , YEUTORH_ID        , NHOMBENH_ID        , TIENSUDIUNG        , TIENSUBENH        , GHICHU        , KETQUA        , XEPLOAI_ID        , BSKETLUAN_ID        , GOI_ID        , IDCHUYEN        , DACOPHIEUYEUCAU        , DACOKETQUA        , NGAYHEN        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYCAPNHAT        , NGUOICAPNHAT_ID        ) values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44         )        select SCOPE_identity() as value]
2019-08-26 13:42:46,894 [1] DEBUG - Statement Id: [DAO00307_Add] Parameters: [@param0=[HOPDONG_ID,3], @param1=[BENHNHAN_ID,null], @param2=[MAYTE,null], @param3=[TENBENHNHAN,Test Fpt01], @param4=[GIOITINH,1], @param5=[NGAYSINH,3/1/1995 12:00:00 AM], @param6=[NAMSINH,1995], @param7=[DIACHI,null], @param8=[QUOCTICH_ID,null], @param9=[TINHTHANH_ID,null], @param10=[QUANHUYEN_ID,null], @param11=[XAPHUONG_ID,null], @param12=[DIACHITHUONGTRU,null], @param13=[XAPHUONGTT_ID,null], @param14=[DANTOC_ID,null], @param15=[LOAITHE,null], @param16=[SODIENTHOAI,null], @param17=[EMAIL,null], @param18=[NGHENGHIEP_ID,null], @param19=[TINHTRANGHONNHAN_ID,1578], @param20=[DOITUONG_ID,null], @param21=[CMND,null], @param22=[NGAYCAPTHE,null], @param23=[NAMCAPTHE,null], @param24=[NOICAP_ID,null], @param25=[NHANVIEN_ID,null], @param26=[NHOMMAU_ID,null], @param27=[YEUTORH_ID,null], @param28=[NHOMBENH_ID,null], @param29=[TIENSUDIUNG,null], @param30=[TIENSUBENH,null], @param31=[GHICHU,null], @param32=[KETQUA,null], @param33=[XEPLOAI_ID,null], @param34=[BSKETLUAN_ID,null], @param35=[GOI_ID,3], @param36=[IDCHUYEN,null], @param37=[DACOPHIEUYEUCAU,null], @param38=[DACOKETQUA,null], @param39=[NGAYHEN,null], @param40=[BENHVIEN_ID,HLU01], @param41=[NGAYTAO,8/26/2019 1:42:46 PM], @param42=[NGUOITAO_ID,1], @param43=[NGAYCAPNHAT,8/26/2019 1:42:46 PM], @param44=[NGUOICAPNHAT_ID,1]]
2019-08-26 13:42:46,894 [1] DEBUG - Statement Id: [DAO00307_Add] Types: [@param0=[Int64, System.Int64], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[Int64, System.Int64], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[System.DBNull, null], @param9=[System.DBNull, null], @param10=[System.DBNull, null], @param11=[System.DBNull, null], @param12=[System.DBNull, null], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[Int64, System.Int64], @param20=[System.DBNull, null], @param21=[System.DBNull, null], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[Int64, System.Int64], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[System.DBNull, null], @param39=[System.DBNull, null], @param40=[String, System.String], @param41=[DateTime, System.DateTime], @param42=[Int64, System.Int64], @param43=[DateTime, System.DateTime], @param44=[Int64, System.Int64]]
2019-08-26 13:42:47,474 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhan] PreparedStatement : [SELECT HD_BN.*, LST.DICTIONARY_NAME AS HONNHAN        , CASE WHEN HD_BN.GIOITINH = '1' THEN N'Nam' ELSE N'Nữ' END AS GENDER        , NV.TENNHANVIEN, GOI.TENGOI        , DT.DICTIONARY_NAME as DOITUONG        , HC.TENDONVI as NOICAP        , ISNULL(HD_BN.DIACHI,'') + ',' + ISNULL(XP.TENDONVI,'') + ',' + ISNULL(QH.TENDONVI,'') + ',' + ISNULL(TP.TENDONVI,'') as DIACHILIENLAC        , CASE WHEN HD_BN.NGAYSINH IS NULL THEN CAST(HD_BN.NAMSINH AS VARCHAR(4)) ELSE CONVERT(VARCHAR(10), HD_BN.NGAYSINH,103) END AS NGAYTHANGNAMSINH        FROM TT_KSK_HOPDONG_BENHNHAN HD_BN        LEFT JOIN TT_KSK_HOPDONG HD ON HD.HOPDONG_ID = HD_BN.HOPDONG_ID        LEFT JOIN LST_DICTIONARY LST ON LST.DICTIONARY_ID = HD_BN.TINHTRANGHONNHAN_ID AND LST.DICTIONARY_TYPE_CODE = 'TinhTrangGiaDinh'        LEFT JOIN TM_NHANVIEN NV ON NV.NHANVIEN_ID = HD_BN.NHANVIEN_ID        LEFT JOIN TM_CSKH_GOI GOI ON GOI.GOI_ID = HD_BN.GOI_ID        LEFT JOIN LST_DICTIONARY DT ON DT.DICTIONARY_ID = HD_BN.DOITUONG_ID AND DT.DICTIONARY_TYPE_CODE = 'DoiTuongKhamSucKhoe'        LEFT JOIN TM_DONVIHANHCHINH HC ON HC.DONVIHANHCHINH_ID = HD_BN.NOICAP_ID        LEFT JOIN TM_DONVIHANHCHINH XP on XP.MADONVI = HD_BN.XAPHUONGTT_ID        LEFT JOIN TM_DONVIHANHCHINH QH on QH.DONVIHANHCHINH_ID = XP.CAPTREN_ID        LEFT JOIN TM_DONVIHANHCHINH TP on TP.DONVIHANHCHINH_ID = QH.CAPTREN_ID         where               HD_BN.HOPDONG_ID = 3           and             HD_BN.BENHVIEN_ID = 'HLU01'                   ORDER BY HD_BN.STT]
2019-08-26 13:43:10,016 [1] DEBUG - Statement Id: [DAO00308_StatusContract] PreparedStatement : [SELECT * FROM TT_KSK_HOPDONG        WHERE HOPDONG_ID = 3]
2019-08-26 13:43:10,499 [1] DEBUG - Statement Id: [DAO00307_Add] PreparedStatement : [insert into TT_KSK_HOPDONG_BENHNHAN (        HOPDONG_ID        , BENHNHAN_ID        , MAYTE        , TENBENHNHAN        , GIOITINH        , NGAYSINH        , NAMSINH        , DIACHI        , QUOCTICH_ID        , TINHTHANH_ID        , QUANHUYEN_ID        , XAPHUONG_ID        , DIACHITHUONGTRU        , XAPHUONGTT_ID        , DANTOC_ID        , LOAITHE        , SODIENTHOAI        , EMAIL        , NGHENGHIEP_ID        , TINHTRANGHONNHAN_ID        , DOITUONG_ID        , CMND        , NGAYCAPTHE        , NAMCAPTHE        , NOICAP_ID        , NHANVIEN_ID        , NHOMMAU_ID        , YEUTORH_ID        , NHOMBENH_ID        , TIENSUDIUNG        , TIENSUBENH        , GHICHU        , KETQUA        , XEPLOAI_ID        , BSKETLUAN_ID        , GOI_ID        , IDCHUYEN        , DACOPHIEUYEUCAU        , DACOKETQUA        , NGAYHEN        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYCAPNHAT        , NGUOICAPNHAT_ID        ) values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44         )        select SCOPE_identity() as value]
2019-08-26 13:43:10,500 [1] DEBUG - Statement Id: [DAO00307_Add] Parameters: [@param0=[HOPDONG_ID,3], @param1=[BENHNHAN_ID,null], @param2=[MAYTE,null], @param3=[TENBENHNHAN,Test Fpt02], @param4=[GIOITINH,2], @param5=[NGAYSINH,9/12/2000 12:00:00 AM], @param6=[NAMSINH,2000], @param7=[DIACHI,null], @param8=[QUOCTICH_ID,null], @param9=[TINHTHANH_ID,null], @param10=[QUANHUYEN_ID,null], @param11=[XAPHUONG_ID,null], @param12=[DIACHITHUONGTRU,null], @param13=[XAPHUONGTT_ID,null], @param14=[DANTOC_ID,null], @param15=[LOAITHE,null], @param16=[SODIENTHOAI,null], @param17=[EMAIL,null], @param18=[NGHENGHIEP_ID,null], @param19=[TINHTRANGHONNHAN_ID,1578], @param20=[DOITUONG_ID,null], @param21=[CMND,null], @param22=[NGAYCAPTHE,null], @param23=[NAMCAPTHE,null], @param24=[NOICAP_ID,null], @param25=[NHANVIEN_ID,null], @param26=[NHOMMAU_ID,null], @param27=[YEUTORH_ID,null], @param28=[NHOMBENH_ID,null], @param29=[TIENSUDIUNG,null], @param30=[TIENSUBENH,null], @param31=[GHICHU,null], @param32=[KETQUA,null], @param33=[XEPLOAI_ID,null], @param34=[BSKETLUAN_ID,null], @param35=[GOI_ID,3], @param36=[IDCHUYEN,null], @param37=[DACOPHIEUYEUCAU,null], @param38=[DACOKETQUA,null], @param39=[NGAYHEN,null], @param40=[BENHVIEN_ID,HLU01], @param41=[NGAYTAO,8/26/2019 1:43:10 PM], @param42=[NGUOITAO_ID,1], @param43=[NGAYCAPNHAT,8/26/2019 1:43:10 PM], @param44=[NGUOICAPNHAT_ID,1]]
2019-08-26 13:43:10,500 [1] DEBUG - Statement Id: [DAO00307_Add] Types: [@param0=[Int64, System.Int64], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[Int64, System.Int64], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[System.DBNull, null], @param9=[System.DBNull, null], @param10=[System.DBNull, null], @param11=[System.DBNull, null], @param12=[System.DBNull, null], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[Int64, System.Int64], @param20=[System.DBNull, null], @param21=[System.DBNull, null], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[Int64, System.Int64], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[System.DBNull, null], @param39=[System.DBNull, null], @param40=[String, System.String], @param41=[DateTime, System.DateTime], @param42=[Int64, System.Int64], @param43=[DateTime, System.DateTime], @param44=[Int64, System.Int64]]
2019-08-26 13:43:10,673 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhan] PreparedStatement : [SELECT HD_BN.*, LST.DICTIONARY_NAME AS HONNHAN        , CASE WHEN HD_BN.GIOITINH = '1' THEN N'Nam' ELSE N'Nữ' END AS GENDER        , NV.TENNHANVIEN, GOI.TENGOI        , DT.DICTIONARY_NAME as DOITUONG        , HC.TENDONVI as NOICAP        , ISNULL(HD_BN.DIACHI,'') + ',' + ISNULL(XP.TENDONVI,'') + ',' + ISNULL(QH.TENDONVI,'') + ',' + ISNULL(TP.TENDONVI,'') as DIACHILIENLAC        , CASE WHEN HD_BN.NGAYSINH IS NULL THEN CAST(HD_BN.NAMSINH AS VARCHAR(4)) ELSE CONVERT(VARCHAR(10), HD_BN.NGAYSINH,103) END AS NGAYTHANGNAMSINH        FROM TT_KSK_HOPDONG_BENHNHAN HD_BN        LEFT JOIN TT_KSK_HOPDONG HD ON HD.HOPDONG_ID = HD_BN.HOPDONG_ID        LEFT JOIN LST_DICTIONARY LST ON LST.DICTIONARY_ID = HD_BN.TINHTRANGHONNHAN_ID AND LST.DICTIONARY_TYPE_CODE = 'TinhTrangGiaDinh'        LEFT JOIN TM_NHANVIEN NV ON NV.NHANVIEN_ID = HD_BN.NHANVIEN_ID        LEFT JOIN TM_CSKH_GOI GOI ON GOI.GOI_ID = HD_BN.GOI_ID        LEFT JOIN LST_DICTIONARY DT ON DT.DICTIONARY_ID = HD_BN.DOITUONG_ID AND DT.DICTIONARY_TYPE_CODE = 'DoiTuongKhamSucKhoe'        LEFT JOIN TM_DONVIHANHCHINH HC ON HC.DONVIHANHCHINH_ID = HD_BN.NOICAP_ID        LEFT JOIN TM_DONVIHANHCHINH XP on XP.MADONVI = HD_BN.XAPHUONGTT_ID        LEFT JOIN TM_DONVIHANHCHINH QH on QH.DONVIHANHCHINH_ID = XP.CAPTREN_ID        LEFT JOIN TM_DONVIHANHCHINH TP on TP.DONVIHANHCHINH_ID = QH.CAPTREN_ID         where               HD_BN.HOPDONG_ID = 3           and             HD_BN.BENHVIEN_ID = 'HLU01'                   ORDER BY HD_BN.STT]
2019-08-26 13:43:21,571 [1] DEBUG - Statement Id: [DAO00308_GetAllPatient] PreparedStatement : [select * from TT_BENHNHAN]
2019-08-26 13:43:23,434 [1] DEBUG - Statement Id: [DAO00013_Add_BenhNhan] PreparedStatement : [declare @keyValue int, @BenhVienId varchar(10), @yearNow int, @Mayte varchar(20), @SoVaoVien varchar(20), @fid varchar(20),        @Bnid int, @Manoisinh varchar(10), @Namsinh int, @Ngaysinh smalldatetime, @Gioitinh int, @Thangsinh int, @Daysinh int, @beginpatient int        declare @InsertedRows TABLE (BENHNHAN_ID INT, MAYTE varchar(20), MANOISINH varchar(10), NAMSINH int, NGAYSINH smalldatetime, GIOITINH int )        set @keyValue = 0;        set @Thangsinh = 0;        set @Daysinh = 0;        set @beginpatient = 0;        set @fid = 'F';        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())                select @beginpatient = isnull(VALUE, 0) from TM_SYS_APPSETTINGS where CODE = 'COM_FIRST_NUMBER_PATIENTCODE_INTHEYEAR'          select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'MAYTE' and KEYYEAR = @yearNow                if @keyValue = 0        Insert into LST_KEYDATA values ('MAYTE', @yearNow, '0', '0', '0', '0', '0', @beginpatient, @BenhVienId);        Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'MAYTE' and KEYYEAR = @yearNow                set @SoVaoVien = right('0000000'+convert(varchar(7), @keyValue), 7)        set @Mayte = RIGHT(@yearNow, 2) + @SoVaoVien                insert into TT_BENHNHAN (        MAYTE        , SOVAOVIEN        , TENBENHNHAN        , HO        , TEN        , GIOITINH        , NGAYSINH        , NAMSINH        , MANOISINH        , SONHA        , DIACHI        , SODIENTHOAI        , XAPHUONG_ID        , QUANHUYEN_ID        , TINHTHANH_ID        , DANTOC_ID        , QUOCTICH_ID        , SOLUUTRUNOITRU        , SOLUUTRUNGOAITRU        , NGHENGHIEP_ID        , CMND        , HOCHIEU        , VIETKIEU        , NGUOINUOCNGOAI        , DIACHITHUONGTRU        , DIACHILIENLAC        , DIACHICOQUAN        , EMAIL        , NHOMMAU_ID        , YEUTORH_ID        , TIENSUDIUNG        , TIENSUBENH        , TIENSUHUTTHUOCLA        , TUVONG        , NGAYTUVONG        , THOIGIANTUVONG        , NGUYENNHANTUVONG_ID        , NGUOIGHINHANTUVONG_ID        , THOIGIANGHINHANTUVONG        , NHANVIEN_ID        , DONVICONGTAC_ID        , DIENTHOAIBAN        , TINHTRANGHONNHAN_ID        , NGUOILIENHE_ID        , MOIQUANHE_ID        , NGUOILIENHE        , THONGTIN_NLH        , GHICHU        , HINHANH_DAIDIEN        , SITE_ID        , PID        , ACTIVE        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYGIOSINH        )                values (        @Mayte        , @SoVaoVien        ,  @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         , '1'        ,  @param49         ,  @param50         ,  @param51         ,  @param52         );        set @Bnid = SCOPE_IDENTITY()                select @Manoisinh = MANOISINH, @Namsinh = NAMSINH, @Ngaysinh = NGAYSINH, @Gioitinh = GIOITINH from @InsertedRows;        IF (@Ngaysinh is not Null)        BEGIN        set @Thangsinh = MONTH(@Ngaysinh);        set @Daysinh = DAY(@Ngaysinh);        END        IF (@Manoisinh is Null) set @Manoisinh = '0'        set @fid = right('000'+convert(varchar(3), @Manoisinh), 3) + convert(varchar(1), @Gioitinh) + RIGHT(@Namsinh, 2) + right('00'+convert(varchar(2), @Thangsinh), 2) + right('00'+convert(varchar(2), @Daysinh), 2) + right('000000000'+convert(varchar(9), @Bnid), 9) + convert(varchar(1), 'F');                update TT_BENHNHAN set FID = @fid where BENHNHAN_ID = @Bnid;                select @Bnid]
2019-08-26 13:43:23,434 [1] DEBUG - Statement Id: [DAO00013_Add_BenhNhan] Parameters: [@param0=[TENBENHNHAN,Test Fpt01], @param1=[HO,null], @param2=[TEN,null], @param3=[GIOITINH,1], @param4=[NGAYSINH,3/1/1995 12:00:00 AM], @param5=[NAMSINH,1995], @param6=[MANOISINH,null], @param7=[SONHA,null], @param8=[DIACHI,null], @param9=[SODIENTHOAI,null], @param10=[XAPHUONG_ID,null], @param11=[QUANHUYEN_ID,null], @param12=[TINHTHANH_ID,null], @param13=[DANTOC_ID,null], @param14=[QUOCTICH_ID,null], @param15=[SOLUUTRUNOITRU,null], @param16=[SOLUUTRUNGOAITRU,null], @param17=[NGHENGHIEP_ID,null], @param18=[CMND,null], @param19=[HOCHIEU,null], @param20=[VIETKIEU,null], @param21=[NGUOINUOCNGOAI,null], @param22=[DIACHITHUONGTRU,null], @param23=[DIACHILIENLAC,,,,], @param24=[DIACHICOQUAN,null], @param25=[EMAIL,null], @param26=[NHOMMAU_ID,null], @param27=[YEUTORH_ID,null], @param28=[TIENSUDIUNG,null], @param29=[TIENSUBENH,null], @param30=[TIENSUHUTTHUOCLA,null], @param31=[TUVONG,null], @param32=[NGAYTUVONG,null], @param33=[THOIGIANTUVONG,null], @param34=[NGUYENNHANTUVONG_ID,null], @param35=[NGUOIGHINHANTUVONG_ID,null], @param36=[THOIGIANGHINHANTUVONG,null], @param37=[NHANVIEN_ID,null], @param38=[DONVICONGTAC_ID,null], @param39=[DIENTHOAIBAN,null], @param40=[TINHTRANGHONNHAN_ID,1578], @param41=[NGUOILIENHE_ID,null], @param42=[MOIQUANHE_ID,null], @param43=[NGUOILIENHE,null], @param44=[THONGTIN_NLH,null], @param45=[GHICHU,null], @param46=[HINHANH_DAIDIEN,null], @param47=[SITE_ID,HLU01], @param48=[PID,null], @param49=[BENHVIEN_ID,HLU01], @param50=[NGAYTAO,8/26/2019 1:43:23 PM], @param51=[NGUOITAO_ID,1], @param52=[NGAYGIOSINH,null]]
2019-08-26 13:43:23,434 [1] DEBUG - Statement Id: [DAO00013_Add_BenhNhan] Types: [@param0=[String, System.String], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[Int64, System.Int64], @param4=[DateTime, System.DateTime], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[System.DBNull, null], @param8=[System.DBNull, null], @param9=[System.DBNull, null], @param10=[System.DBNull, null], @param11=[System.DBNull, null], @param12=[System.DBNull, null], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[System.DBNull, null], @param22=[System.DBNull, null], @param23=[String, System.String], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[System.DBNull, null], @param39=[System.DBNull, null], @param40=[Int64, System.Int64], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[String, System.String], @param48=[System.DBNull, null], @param49=[String, System.String], @param50=[DateTime, System.DateTime], @param51=[Int64, System.Int64], @param52=[System.DBNull, null]]
2019-08-26 13:43:23,622 [1] DEBUG - Statement Id: [DAO00013_GetTTBenhNhan_byBenhNhanId] PreparedStatement : [select *        from TT_BENHNHAN        where BENHNHAN_ID = '23420'        order by BENHNHAN_ID]
2019-08-26 13:43:23,989 [1] DEBUG - Statement Id: [DAO00013_GetBenhNhanToDB] PreparedStatement : [select ROW_NUMBER() OVER(order by a.MAYTE) as ROWNUMBER, *,        CASE        WHEN A.GIOITINH = 1 THEN 'Nam'        WHEN A.GIOITINH = 2 THEN N'Nữ'        END as TENGIOITINH        from TT_BENHNHAN A        where  ACTIVE = '1' and MAYTE = '190043301']
2019-08-26 13:43:25,104 [1] DEBUG - Statement Id: [DAO00118_Add_BenhNhan] PreparedStatement : [if not exists (select 1 from TT_BENHNHAN where BENHNHAN_ID = '23420')              insert into TT_BENHNHAN (              BENHNHAN_ID              , MAYTE              , SOVAOVIEN              , TENBENHNHAN              , HO              , TEN              , GIOITINH              , NGAYSINH              , NAMSINH              , SONHA              , DIACHI              , SODIENTHOAI              , XAPHUONG_ID              , QUANHUYEN_ID              , TINHTHANH_ID              , DANTOC_ID              , QUOCTICH_ID              , SOLUUTRUNOITRU              , SOLUUTRUNGOAITRU              , NGHENGHIEP_ID              , CMND              , HOCHIEU              , VIETKIEU              , NGUOINUOCNGOAI              , DIACHITHUONGTRU              , DIACHILIENLAC              , DIACHICOQUAN              , EMAIL              , NHOMMAU_ID              , YEUTORH_ID              , TIENSUDIUNG              , TIENSUBENH              , TIENSUHUTTHUOCLA              , TUVONG              , NGAYTUVONG              , THOIGIANTUVONG              , NGUYENNHANTUVONG_ID              , NGUOIGHINHANTUVONG_ID              , THOIGIANGHINHANTUVONG              , NHANVIEN_ID              , DONVICONGTAC_ID              , DIENTHOAIBAN              , TINHTRANGHONNHAN_ID              , NGUOILIENHE_ID              , MOIQUANHE_ID              , NGUOILIENHE              , THONGTIN_NLH              , GHICHU              , HINHANH_DAIDIEN              , BENHVIEN_ID              , NGAYTAO              , NGUOITAO_ID              , NGAYGIOSINH              ) values (               @param0               ,  @param1               ,  @param2               ,  @param3               ,  @param4               ,  @param5               ,  @param6               ,  @param7               ,  @param8               ,  @param9               ,  @param10               ,  @param11               ,  @param12               ,  @param13               ,  @param14               ,  @param15               ,  @param16               ,  @param17               ,  @param18               ,  @param19               ,  @param20               ,  @param21               ,  @param22               ,  @param23               ,  @param24               ,  @param25               ,  @param26               ,  @param27               ,  @param28               ,  @param29               ,  @param30               ,  @param31               ,  @param32               ,  @param33               ,  @param34               ,  @param35               ,  @param36               ,  @param37               ,  @param38               ,  @param39               ,  @param40               ,  @param41               ,  @param42               ,  @param43               ,  @param44               ,  @param45               ,  @param46               ,  @param47               ,  @param48               ,  @param49               ,  @param50               ,  @param51               ,  @param52               )              else              update TT_BENHNHAN set              MAYTE =  @param1                ,                   SOVAOVIEN =  @param2                ,                   TENBENHNHAN =  @param3                ,                   GIOITINH =  @param6                ,                   NGAYSINH =  @param7                ,                   NAMSINH =  @param8                ,                   DIACHI =  @param10                ,                   SODIENTHOAI =  @param11                ,                   XAPHUONG_ID =  @param12                ,                   QUANHUYEN_ID =  @param13                ,                   TINHTHANH_ID =  @param14                ,                   DANTOC_ID =  @param15                ,                   QUOCTICH_ID =  @param16                ,                   NGHENGHIEP_ID =  @param19                ,                   CMND =  @param20                ,                   HOCHIEU =  @param21                ,                   DIACHITHUONGTRU =  @param24                ,                   DIACHILIENLAC =  @param25                ,                   EMAIL =  @param27                ,                   NHOMMAU_ID =  @param28                ,                   YEUTORH_ID =  @param29                ,                   TIENSUDIUNG =  @param30                ,                   TIENSUBENH =  @param31                ,                   NHANVIEN_ID =  @param39                ,                   TINHTRANGHONNHAN_ID =  @param42                ,                   GHICHU =  @param47                ,                   BENHVIEN_ID =  @param49                ,                   NGAYCAPNHAT =  @param53                ,                   NGUOICAPNHAT_ID =  @param54                              where              BENHNHAN_ID = '23420']
2019-08-26 13:43:25,104 [1] DEBUG - Statement Id: [DAO00118_Add_BenhNhan] Parameters: [@param0=[BENHNHAN_ID,23420], @param1=[MAYTE,190043301], @param2=[SOVAOVIEN,0043301], @param3=[TENBENHNHAN,Test Fpt01], @param4=[HO,null], @param5=[TEN,null], @param6=[GIOITINH,1], @param7=[NGAYSINH,3/1/1995 12:00:00 AM], @param8=[NAMSINH,1995], @param9=[SONHA,null], @param10=[DIACHI,null], @param11=[SODIENTHOAI,null], @param12=[XAPHUONG_ID,null], @param13=[QUANHUYEN_ID,null], @param14=[TINHTHANH_ID,null], @param15=[DANTOC_ID,null], @param16=[QUOCTICH_ID,null], @param17=[SOLUUTRUNOITRU,null], @param18=[SOLUUTRUNGOAITRU,null], @param19=[NGHENGHIEP_ID,null], @param20=[CMND,null], @param21=[HOCHIEU,null], @param22=[VIETKIEU,null], @param23=[NGUOINUOCNGOAI,null], @param24=[DIACHITHUONGTRU,null], @param25=[DIACHILIENLAC,,,,], @param26=[DIACHICOQUAN,null], @param27=[EMAIL,null], @param28=[NHOMMAU_ID,null], @param29=[YEUTORH_ID,null], @param30=[TIENSUDIUNG,null], @param31=[TIENSUBENH,null], @param32=[TIENSUHUTTHUOCLA,null], @param33=[TUVONG,null], @param34=[NGAYTUVONG,null], @param35=[THOIGIANTUVONG,null], @param36=[NGUYENNHANTUVONG_ID,null], @param37=[NGUOIGHINHANTUVONG_ID,null], @param38=[THOIGIANGHINHANTUVONG,null], @param39=[NHANVIEN_ID,null], @param40=[DONVICONGTAC_ID,null], @param41=[DIENTHOAIBAN,null], @param42=[TINHTRANGHONNHAN_ID,1578], @param43=[NGUOILIENHE_ID,null], @param44=[MOIQUANHE_ID,null], @param45=[NGUOILIENHE,null], @param46=[THONGTIN_NLH,null], @param47=[GHICHU,null], @param48=[HINHANH_DAIDIEN,null], @param49=[BENHVIEN_ID,HLU01], @param50=[NGAYTAO,8/26/2019 1:42:46 PM], @param51=[NGUOITAO_ID,1], @param52=[NGAYGIOSINH,null], @param53=[NGAYCAPNHAT,8/26/2019 1:42:46 PM], @param54=[NGUOICAPNHAT_ID,1]]
2019-08-26 13:43:25,104 [1] DEBUG - Statement Id: [DAO00118_Add_BenhNhan] Types: [@param0=[Int32, System.Int32], @param1=[String, System.String], @param2=[String, System.String], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[System.DBNull, null], @param6=[Int64, System.Int64], @param7=[DateTime, System.DateTime], @param8=[Int64, System.Int64], @param9=[System.DBNull, null], @param10=[System.DBNull, null], @param11=[System.DBNull, null], @param12=[System.DBNull, null], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[System.DBNull, null], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[String, System.String], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[System.DBNull, null], @param39=[System.DBNull, null], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[Int64, System.Int64], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[String, System.String], @param50=[DateTime, System.DateTime], @param51=[Int64, System.Int64], @param52=[System.DBNull, null], @param53=[DateTime, System.DateTime], @param54=[Int64, System.Int64]]
2019-08-26 13:43:25,158 [1] DEBUG - Statement Id: [DAO00307_MedicalCode] PreparedStatement : [UPDATE TT_KSK_HOPDONG_BENHNHAN SET        MAYTE =  @param0         , BENHNHAN_ID =  @param1         , TONTAI = '0'        , NGAYCAPNHAT = GETDATE()        WHERE HOPDONG_BENHNHAN_ID = 203]
2019-08-26 13:43:25,158 [1] DEBUG - Statement Id: [DAO00307_MedicalCode] Parameters: [@param0=[MAYTE,190043301], @param1=[BENHNHAN_ID,23420]]
2019-08-26 13:43:25,158 [1] DEBUG - Statement Id: [DAO00307_MedicalCode] Types: [@param0=[String, System.String], @param1=[Int32, System.Int32]]
2019-08-26 13:43:25,202 [1] DEBUG - Statement Id: [DAO00013_Add_BenhNhan] PreparedStatement : [declare @keyValue int, @BenhVienId varchar(10), @yearNow int, @Mayte varchar(20), @SoVaoVien varchar(20), @fid varchar(20),        @Bnid int, @Manoisinh varchar(10), @Namsinh int, @Ngaysinh smalldatetime, @Gioitinh int, @Thangsinh int, @Daysinh int, @beginpatient int        declare @InsertedRows TABLE (BENHNHAN_ID INT, MAYTE varchar(20), MANOISINH varchar(10), NAMSINH int, NGAYSINH smalldatetime, GIOITINH int )        set @keyValue = 0;        set @Thangsinh = 0;        set @Daysinh = 0;        set @beginpatient = 0;        set @fid = 'F';        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())                select @beginpatient = isnull(VALUE, 0) from TM_SYS_APPSETTINGS where CODE = 'COM_FIRST_NUMBER_PATIENTCODE_INTHEYEAR'          select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'MAYTE' and KEYYEAR = @yearNow                if @keyValue = 0        Insert into LST_KEYDATA values ('MAYTE', @yearNow, '0', '0', '0', '0', '0', @beginpatient, @BenhVienId);        Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'MAYTE' and KEYYEAR = @yearNow                set @SoVaoVien = right('0000000'+convert(varchar(7), @keyValue), 7)        set @Mayte = RIGHT(@yearNow, 2) + @SoVaoVien                insert into TT_BENHNHAN (        MAYTE        , SOVAOVIEN        , TENBENHNHAN        , HO        , TEN        , GIOITINH        , NGAYSINH        , NAMSINH        , MANOISINH        , SONHA        , DIACHI        , SODIENTHOAI        , XAPHUONG_ID        , QUANHUYEN_ID        , TINHTHANH_ID        , DANTOC_ID        , QUOCTICH_ID        , SOLUUTRUNOITRU        , SOLUUTRUNGOAITRU        , NGHENGHIEP_ID        , CMND        , HOCHIEU        , VIETKIEU        , NGUOINUOCNGOAI        , DIACHITHUONGTRU        , DIACHILIENLAC        , DIACHICOQUAN        , EMAIL        , NHOMMAU_ID        , YEUTORH_ID        , TIENSUDIUNG        , TIENSUBENH        , TIENSUHUTTHUOCLA        , TUVONG        , NGAYTUVONG        , THOIGIANTUVONG        , NGUYENNHANTUVONG_ID        , NGUOIGHINHANTUVONG_ID        , THOIGIANGHINHANTUVONG        , NHANVIEN_ID        , DONVICONGTAC_ID        , DIENTHOAIBAN        , TINHTRANGHONNHAN_ID        , NGUOILIENHE_ID        , MOIQUANHE_ID        , NGUOILIENHE        , THONGTIN_NLH        , GHICHU        , HINHANH_DAIDIEN        , SITE_ID        , PID        , ACTIVE        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYGIOSINH        )                values (        @Mayte        , @SoVaoVien        ,  @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         , '1'        ,  @param49         ,  @param50         ,  @param51         ,  @param52         );        set @Bnid = SCOPE_IDENTITY()                select @Manoisinh = MANOISINH, @Namsinh = NAMSINH, @Ngaysinh = NGAYSINH, @Gioitinh = GIOITINH from @InsertedRows;        IF (@Ngaysinh is not Null)        BEGIN        set @Thangsinh = MONTH(@Ngaysinh);        set @Daysinh = DAY(@Ngaysinh);        END        IF (@Manoisinh is Null) set @Manoisinh = '0'        set @fid = right('000'+convert(varchar(3), @Manoisinh), 3) + convert(varchar(1), @Gioitinh) + RIGHT(@Namsinh, 2) + right('00'+convert(varchar(2), @Thangsinh), 2) + right('00'+convert(varchar(2), @Daysinh), 2) + right('000000000'+convert(varchar(9), @Bnid), 9) + convert(varchar(1), 'F');                update TT_BENHNHAN set FID = @fid where BENHNHAN_ID = @Bnid;                select @Bnid]
2019-08-26 13:43:25,203 [1] DEBUG - Statement Id: [DAO00013_Add_BenhNhan] Parameters: [@param0=[TENBENHNHAN,Test Fpt02], @param1=[HO,null], @param2=[TEN,null], @param3=[GIOITINH,2], @param4=[NGAYSINH,9/12/2000 12:00:00 AM], @param5=[NAMSINH,2000], @param6=[MANOISINH,null], @param7=[SONHA,null], @param8=[DIACHI,null], @param9=[SODIENTHOAI,null], @param10=[XAPHUONG_ID,null], @param11=[QUANHUYEN_ID,null], @param12=[TINHTHANH_ID,null], @param13=[DANTOC_ID,null], @param14=[QUOCTICH_ID,null], @param15=[SOLUUTRUNOITRU,null], @param16=[SOLUUTRUNGOAITRU,null], @param17=[NGHENGHIEP_ID,null], @param18=[CMND,null], @param19=[HOCHIEU,null], @param20=[VIETKIEU,null], @param21=[NGUOINUOCNGOAI,null], @param22=[DIACHITHUONGTRU,null], @param23=[DIACHILIENLAC,,,,], @param24=[DIACHICOQUAN,null], @param25=[EMAIL,null], @param26=[NHOMMAU_ID,null], @param27=[YEUTORH_ID,null], @param28=[TIENSUDIUNG,null], @param29=[TIENSUBENH,null], @param30=[TIENSUHUTTHUOCLA,null], @param31=[TUVONG,null], @param32=[NGAYTUVONG,null], @param33=[THOIGIANTUVONG,null], @param34=[NGUYENNHANTUVONG_ID,null], @param35=[NGUOIGHINHANTUVONG_ID,null], @param36=[THOIGIANGHINHANTUVONG,null], @param37=[NHANVIEN_ID,null], @param38=[DONVICONGTAC_ID,null], @param39=[DIENTHOAIBAN,null], @param40=[TINHTRANGHONNHAN_ID,1578], @param41=[NGUOILIENHE_ID,null], @param42=[MOIQUANHE_ID,null], @param43=[NGUOILIENHE,null], @param44=[THONGTIN_NLH,null], @param45=[GHICHU,null], @param46=[HINHANH_DAIDIEN,null], @param47=[SITE_ID,HLU01], @param48=[PID,null], @param49=[BENHVIEN_ID,HLU01], @param50=[NGAYTAO,8/26/2019 1:43:25 PM], @param51=[NGUOITAO_ID,1], @param52=[NGAYGIOSINH,null]]
2019-08-26 13:43:25,203 [1] DEBUG - Statement Id: [DAO00013_Add_BenhNhan] Types: [@param0=[String, System.String], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[Int64, System.Int64], @param4=[DateTime, System.DateTime], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[System.DBNull, null], @param8=[System.DBNull, null], @param9=[System.DBNull, null], @param10=[System.DBNull, null], @param11=[System.DBNull, null], @param12=[System.DBNull, null], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[System.DBNull, null], @param22=[System.DBNull, null], @param23=[String, System.String], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[System.DBNull, null], @param39=[System.DBNull, null], @param40=[Int64, System.Int64], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[String, System.String], @param48=[System.DBNull, null], @param49=[String, System.String], @param50=[DateTime, System.DateTime], @param51=[Int64, System.Int64], @param52=[System.DBNull, null]]
2019-08-26 13:43:25,253 [1] DEBUG - Statement Id: [DAO00013_GetTTBenhNhan_byBenhNhanId] PreparedStatement : [select *        from TT_BENHNHAN        where BENHNHAN_ID = '23421'        order by BENHNHAN_ID]
2019-08-26 13:43:25,292 [1] DEBUG - Statement Id: [DAO00013_GetBenhNhanToDB] PreparedStatement : [select ROW_NUMBER() OVER(order by a.MAYTE) as ROWNUMBER, *,        CASE        WHEN A.GIOITINH = 1 THEN 'Nam'        WHEN A.GIOITINH = 2 THEN N'Nữ'        END as TENGIOITINH        from TT_BENHNHAN A        where  ACTIVE = '1' and MAYTE = '190043302']
2019-08-26 13:43:26,014 [1] DEBUG - Statement Id: [DAO00118_Add_BenhNhan] PreparedStatement : [if not exists (select 1 from TT_BENHNHAN where BENHNHAN_ID = '23421')              insert into TT_BENHNHAN (              BENHNHAN_ID              , MAYTE              , SOVAOVIEN              , TENBENHNHAN              , HO              , TEN              , GIOITINH              , NGAYSINH              , NAMSINH              , SONHA              , DIACHI              , SODIENTHOAI              , XAPHUONG_ID              , QUANHUYEN_ID              , TINHTHANH_ID              , DANTOC_ID              , QUOCTICH_ID              , SOLUUTRUNOITRU              , SOLUUTRUNGOAITRU              , NGHENGHIEP_ID              , CMND              , HOCHIEU              , VIETKIEU              , NGUOINUOCNGOAI              , DIACHITHUONGTRU              , DIACHILIENLAC              , DIACHICOQUAN              , EMAIL              , NHOMMAU_ID              , YEUTORH_ID              , TIENSUDIUNG              , TIENSUBENH              , TIENSUHUTTHUOCLA              , TUVONG              , NGAYTUVONG              , THOIGIANTUVONG              , NGUYENNHANTUVONG_ID              , NGUOIGHINHANTUVONG_ID              , THOIGIANGHINHANTUVONG              , NHANVIEN_ID              , DONVICONGTAC_ID              , DIENTHOAIBAN              , TINHTRANGHONNHAN_ID              , NGUOILIENHE_ID              , MOIQUANHE_ID              , NGUOILIENHE              , THONGTIN_NLH              , GHICHU              , HINHANH_DAIDIEN              , BENHVIEN_ID              , NGAYTAO              , NGUOITAO_ID              , NGAYGIOSINH              ) values (               @param0               ,  @param1               ,  @param2               ,  @param3               ,  @param4               ,  @param5               ,  @param6               ,  @param7               ,  @param8               ,  @param9               ,  @param10               ,  @param11               ,  @param12               ,  @param13               ,  @param14               ,  @param15               ,  @param16               ,  @param17               ,  @param18               ,  @param19               ,  @param20               ,  @param21               ,  @param22               ,  @param23               ,  @param24               ,  @param25               ,  @param26               ,  @param27               ,  @param28               ,  @param29               ,  @param30               ,  @param31               ,  @param32               ,  @param33               ,  @param34               ,  @param35               ,  @param36               ,  @param37               ,  @param38               ,  @param39               ,  @param40               ,  @param41               ,  @param42               ,  @param43               ,  @param44               ,  @param45               ,  @param46               ,  @param47               ,  @param48               ,  @param49               ,  @param50               ,  @param51               ,  @param52               )              else              update TT_BENHNHAN set              MAYTE =  @param1                ,                   SOVAOVIEN =  @param2                ,                   TENBENHNHAN =  @param3                ,                   GIOITINH =  @param6                ,                   NGAYSINH =  @param7                ,                   NAMSINH =  @param8                ,                   DIACHI =  @param10                ,                   SODIENTHOAI =  @param11                ,                   XAPHUONG_ID =  @param12                ,                   QUANHUYEN_ID =  @param13                ,                   TINHTHANH_ID =  @param14                ,                   DANTOC_ID =  @param15                ,                   QUOCTICH_ID =  @param16                ,                   NGHENGHIEP_ID =  @param19                ,                   CMND =  @param20                ,                   HOCHIEU =  @param21                ,                   DIACHITHUONGTRU =  @param24                ,                   DIACHILIENLAC =  @param25                ,                   EMAIL =  @param27                ,                   NHOMMAU_ID =  @param28                ,                   YEUTORH_ID =  @param29                ,                   TIENSUDIUNG =  @param30                ,                   TIENSUBENH =  @param31                ,                   NHANVIEN_ID =  @param39                ,                   TINHTRANGHONNHAN_ID =  @param42                ,                   GHICHU =  @param47                ,                   BENHVIEN_ID =  @param49                ,                   NGAYCAPNHAT =  @param53                ,                   NGUOICAPNHAT_ID =  @param54                              where              BENHNHAN_ID = '23421']
2019-08-26 13:43:26,014 [1] DEBUG - Statement Id: [DAO00118_Add_BenhNhan] Parameters: [@param0=[BENHNHAN_ID,23421], @param1=[MAYTE,190043302], @param2=[SOVAOVIEN,0043302], @param3=[TENBENHNHAN,Test Fpt02], @param4=[HO,null], @param5=[TEN,null], @param6=[GIOITINH,2], @param7=[NGAYSINH,9/12/2000 12:00:00 AM], @param8=[NAMSINH,2000], @param9=[SONHA,null], @param10=[DIACHI,null], @param11=[SODIENTHOAI,null], @param12=[XAPHUONG_ID,null], @param13=[QUANHUYEN_ID,null], @param14=[TINHTHANH_ID,null], @param15=[DANTOC_ID,null], @param16=[QUOCTICH_ID,null], @param17=[SOLUUTRUNOITRU,null], @param18=[SOLUUTRUNGOAITRU,null], @param19=[NGHENGHIEP_ID,null], @param20=[CMND,null], @param21=[HOCHIEU,null], @param22=[VIETKIEU,null], @param23=[NGUOINUOCNGOAI,null], @param24=[DIACHITHUONGTRU,null], @param25=[DIACHILIENLAC,,,,], @param26=[DIACHICOQUAN,null], @param27=[EMAIL,null], @param28=[NHOMMAU_ID,null], @param29=[YEUTORH_ID,null], @param30=[TIENSUDIUNG,null], @param31=[TIENSUBENH,null], @param32=[TIENSUHUTTHUOCLA,null], @param33=[TUVONG,null], @param34=[NGAYTUVONG,null], @param35=[THOIGIANTUVONG,null], @param36=[NGUYENNHANTUVONG_ID,null], @param37=[NGUOIGHINHANTUVONG_ID,null], @param38=[THOIGIANGHINHANTUVONG,null], @param39=[NHANVIEN_ID,null], @param40=[DONVICONGTAC_ID,null], @param41=[DIENTHOAIBAN,null], @param42=[TINHTRANGHONNHAN_ID,1578], @param43=[NGUOILIENHE_ID,null], @param44=[MOIQUANHE_ID,null], @param45=[NGUOILIENHE,null], @param46=[THONGTIN_NLH,null], @param47=[GHICHU,null], @param48=[HINHANH_DAIDIEN,null], @param49=[BENHVIEN_ID,HLU01], @param50=[NGAYTAO,8/26/2019 1:43:10 PM], @param51=[NGUOITAO_ID,1], @param52=[NGAYGIOSINH,null], @param53=[NGAYCAPNHAT,8/26/2019 1:43:10 PM], @param54=[NGUOICAPNHAT_ID,1]]
2019-08-26 13:43:26,014 [1] DEBUG - Statement Id: [DAO00118_Add_BenhNhan] Types: [@param0=[Int32, System.Int32], @param1=[String, System.String], @param2=[String, System.String], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[System.DBNull, null], @param6=[Int64, System.Int64], @param7=[DateTime, System.DateTime], @param8=[Int64, System.Int64], @param9=[System.DBNull, null], @param10=[System.DBNull, null], @param11=[System.DBNull, null], @param12=[System.DBNull, null], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[System.DBNull, null], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[String, System.String], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[System.DBNull, null], @param39=[System.DBNull, null], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[Int64, System.Int64], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[String, System.String], @param50=[DateTime, System.DateTime], @param51=[Int64, System.Int64], @param52=[System.DBNull, null], @param53=[DateTime, System.DateTime], @param54=[Int64, System.Int64]]
2019-08-26 13:43:26,067 [1] DEBUG - Statement Id: [DAO00307_MedicalCode] PreparedStatement : [UPDATE TT_KSK_HOPDONG_BENHNHAN SET        MAYTE =  @param0         , BENHNHAN_ID =  @param1         , TONTAI = '0'        , NGAYCAPNHAT = GETDATE()        WHERE HOPDONG_BENHNHAN_ID = 204]
2019-08-26 13:43:26,067 [1] DEBUG - Statement Id: [DAO00307_MedicalCode] Parameters: [@param0=[MAYTE,190043302], @param1=[BENHNHAN_ID,23421]]
2019-08-26 13:43:26,067 [1] DEBUG - Statement Id: [DAO00307_MedicalCode] Types: [@param0=[String, System.String], @param1=[Int32, System.Int32]]
2019-08-26 13:43:26,178 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhan] PreparedStatement : [SELECT HD_BN.*, LST.DICTIONARY_NAME AS HONNHAN        , CASE WHEN HD_BN.GIOITINH = '1' THEN N'Nam' ELSE N'Nữ' END AS GENDER        , NV.TENNHANVIEN, GOI.TENGOI        , DT.DICTIONARY_NAME as DOITUONG        , HC.TENDONVI as NOICAP        , ISNULL(HD_BN.DIACHI,'') + ',' + ISNULL(XP.TENDONVI,'') + ',' + ISNULL(QH.TENDONVI,'') + ',' + ISNULL(TP.TENDONVI,'') as DIACHILIENLAC        , CASE WHEN HD_BN.NGAYSINH IS NULL THEN CAST(HD_BN.NAMSINH AS VARCHAR(4)) ELSE CONVERT(VARCHAR(10), HD_BN.NGAYSINH,103) END AS NGAYTHANGNAMSINH        FROM TT_KSK_HOPDONG_BENHNHAN HD_BN        LEFT JOIN TT_KSK_HOPDONG HD ON HD.HOPDONG_ID = HD_BN.HOPDONG_ID        LEFT JOIN LST_DICTIONARY LST ON LST.DICTIONARY_ID = HD_BN.TINHTRANGHONNHAN_ID AND LST.DICTIONARY_TYPE_CODE = 'TinhTrangGiaDinh'        LEFT JOIN TM_NHANVIEN NV ON NV.NHANVIEN_ID = HD_BN.NHANVIEN_ID        LEFT JOIN TM_CSKH_GOI GOI ON GOI.GOI_ID = HD_BN.GOI_ID        LEFT JOIN LST_DICTIONARY DT ON DT.DICTIONARY_ID = HD_BN.DOITUONG_ID AND DT.DICTIONARY_TYPE_CODE = 'DoiTuongKhamSucKhoe'        LEFT JOIN TM_DONVIHANHCHINH HC ON HC.DONVIHANHCHINH_ID = HD_BN.NOICAP_ID        LEFT JOIN TM_DONVIHANHCHINH XP on XP.MADONVI = HD_BN.XAPHUONGTT_ID        LEFT JOIN TM_DONVIHANHCHINH QH on QH.DONVIHANHCHINH_ID = XP.CAPTREN_ID        LEFT JOIN TM_DONVIHANHCHINH TP on TP.DONVIHANHCHINH_ID = QH.CAPTREN_ID         where               HD_BN.HOPDONG_ID = 3           and             HD_BN.BENHVIEN_ID = 'HLU01'                   ORDER BY HD_BN.STT]
2019-08-26 13:43:41,608 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'HSM05'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 13:43:41,940 [1] DEBUG - Statement Id: [DAO00307_GetContractWithDate] PreparedStatement : [SELECT HD.*, HD.SO_HD + ' - ' + CT.TENCONGTY AS HOPDONG, CT.TENCONGTY        FROM TT_KSK_HOPDONG HD JOIN TT_KSK_CONGTY CT ON CT.CONGTY_ID = HD.CONGTY_ID         where               HD.BENHVIEN_ID = 'HLU01']
2019-08-26 13:43:42,153 [1] DEBUG - Statement Id: [DAO00307_GetContractWithDate] PreparedStatement : [SELECT HD.*, HD.SO_HD + ' - ' + CT.TENCONGTY AS HOPDONG, CT.TENCONGTY        FROM TT_KSK_HOPDONG HD JOIN TT_KSK_CONGTY CT ON CT.CONGTY_ID = HD.CONGTY_ID         where               HD.BENHVIEN_ID = 'HLU01']
2019-08-26 13:43:46,090 [1] DEBUG - Statement Id: [DAO00307_GetContractPatient] PreparedStatement : [SELECT HD_BN.*, LST.DICTIONARY_NAME AS HONNHAN        , CASE WHEN HD_BN.GIOITINH = '1' THEN N'Nam' ELSE N'Nữ' END AS GENDER        , CASE WHEN HD_BN.HOPDONG_BENHNHAN_ID IN (SELECT HOPDONG_BENHNHAN_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU) THEN 1 ELSE 0 END BENHNHAN_DANGKYKSK_DICHVU        , GOI.TENGOI        FROM TT_KSK_HOPDONG_BENHNHAN HD_BN        INNER JOIN TT_KSK_HOPDONG HD ON HD.HOPDONG_ID = HD_BN.HOPDONG_ID        LEFT JOIN LST_DICTIONARY LST ON LST.DICTIONARY_ID = HD_BN.TINHTRANGHONNHAN_ID AND LST.DICTIONARY_TYPE_CODE = 'TinhTrangGiaDinh'        LEFT JOIN TM_CSKH_GOI GOI ON GOI.GOI_ID = HD_BN.GOI_ID        WHERE HD.HOPDONG_ID = 3           AND             HD_BN.BENHVIEN_ID = 'HLU01']
2019-08-26 13:43:46,376 [1] DEBUG - Statement Id: [DAO00308_StatusContract] PreparedStatement : [SELECT * FROM TT_KSK_HOPDONG        WHERE HOPDONG_ID = 3]
2019-08-26 13:43:47,901 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhanDichVu] PreparedStatement : [SELECT distinct HD_BN.HOPDONG_ID, DV.TENDICHVU, PB.TENPHONGBAN AS NOITHUCHIEN, NDV.TENNHOMDICHVU, PB.PHONGBAN_ID, DV.DICHVU_ID        , ISNULL(GOI_CT.DONGIATRONGGOI,0) AS DONGIA, ISNULL(GOI_CT.SOLAN,0) AS SOLUONG, GOI_CT.THANHTIENTRONGGOI AS THANHTIEN        , CASE WHEN DV.DICHVU_ID IN (SELECT DICHVU_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU WHERE HOPDONG_ID = '3' AND HOPDONG_BENHNHAN_ID = '203') THEN 1 ELSE 0 END AS DANGKY        FROM TT_KSK_HOPDONG HD                inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        INNER JOIN TM_CSKH_GOI_CHITIET GOI_CT ON GOI_CT.GOI_ID = HD_BN.GOI_ID        INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = GOI_CT.DICHVU_ID        LEFT JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        INNER JOIN TM_PHONGBAN_DICHVU PB_DV ON PB_DV.DICHVU_ID = DV.DICHVU_ID        LEFT JOIN TM_PHONGBAN PB ON PB.PHONGBAN_ID = PB_DV.PHONGBAN_ID        WHERE GOI_CT.GOI_ID = 3 and HD_BN.HOPDONG_BENHNHAN_ID = 203        and PB_DV.PHONGBAN_ID =(select top 1 PHONGBAN_ID from TM_PHONGBAN_DICHVU where DICHVU_ID = DV.DICHVU_ID)]
2019-08-26 13:43:56,050 [1] DEBUG - Statement Id: [DAO00308_AddByJson] PreparedStatement : [declare @jsonData nvarchar(max) = N'[{"HOPDONG_ID":3,"TENDICHVU":"Chụp Xquang đỉnh phổi ưỡn - số hóa 1 phim","NOITHUCHIEN":"Phòng chụp XQ-KTS (D.208)","TENNHOMDICHVU":"Chụp Xquang số hóa","PHONGBAN_ID":35,"DICHVU_ID":4135,"DONGIA":90000.0,"SOLUONG":1,"THANHTIEN":90000.0,"DANGKY":0,"STT":"1","CHECKSERVICE":true,"HOPDONG_BENHNHAN_ID":203,"NGAYCAPNHAT":"8/26/2019 1:43:56 PM","NGAYTAO":"8/26/2019 1:43:56 PM","NGUOITAO_ID":1,"NGUOICAPNHAT_ID":1,"BENHVIEN_ID":"HLU01"},{"HOPDONG_ID":3,"TENDICHVU":"Tổng phân tích tế bào máu ngoại vi (bằng máy đếm laser)","NOITHUCHIEN":"Phòng XN Huyết học- Sinh hóa-Miễn dịch(D.230)","TENNHOMDICHVU":"Huyết học","PHONGBAN_ID":104,"DICHVU_ID":4524,"DONGIA":50000.0,"SOLUONG":1,"THANHTIEN":50000.0,"DANGKY":0,"STT":"2","CHECKSERVICE":true,"HOPDONG_BENHNHAN_ID":203,"NGAYCAPNHAT":"8/26/2019 1:43:56 PM","NGAYTAO":"8/26/2019 1:43:56 PM","NGUOITAO_ID":1,"NGUOICAPNHAT_ID":1,"BENHVIEN_ID":"HLU01"},{"HOPDONG_ID":3,"TENDICHVU":"Khám Da liễu","NOITHUCHIEN":"P. khám nội TH- Khám SK (D.232)","TENNHOMDICHVU":"Khám bệnh","PHONGBAN_ID":64,"DICHVU_ID":5433,"DONGIA":50000.0,"SOLUONG":1,"THANHTIEN":50000.0,"DANGKY":0,"STT":"3","CHECKSERVICE":true,"HOPDONG_BENHNHAN_ID":203,"NGAYCAPNHAT":"8/26/2019 1:43:56 PM","NGAYTAO":"8/26/2019 1:43:56 PM","NGUOITAO_ID":1,"NGUOICAPNHAT_ID":1,"BENHVIEN_ID":"HLU01"},{"HOPDONG_ID":3,"TENDICHVU":"Khám Nội tổng hợp (D232)","NOITHUCHIEN":"P. khám nội TH- Khám SK (D.232)","TENNHOMDICHVU":"Khám bệnh","PHONGBAN_ID":64,"DICHVU_ID":5438,"DONGIA":50000.0,"SOLUONG":1,"THANHTIEN":50000.0,"DANGKY":0,"STT":"4","CHECKSERVICE":true,"HOPDONG_BENHNHAN_ID":203,"NGAYCAPNHAT":"8/26/2019 1:43:56 PM","NGAYTAO":"8/26/2019 1:43:56 PM","NGUOITAO_ID":1,"NGUOICAPNHAT_ID":1,"BENHVIEN_ID":"HLU01"},{"HOPDONG_ID":3,"TENDICHVU":"Khám Tai mũi họng (B107)","NOITHUCHIEN":"Phòng Khám TMH (B.107)","TENNHOMDICHVU":"Khám bệnh","PHONGBAN_ID":68,"DICHVU_ID":5443,"DONGIA":50000.0,"SOLUONG":1,"THANHTIEN":50000.0,"DANGKY":0,"STT":"5","CHECKSERVICE":true,"HOPDONG_BENHNHAN_ID":203,"NGAYCAPNHAT":"8/26/2019 1:43:56 PM","NGAYTAO":"8/26/2019 1:43:56 PM","NGUOITAO_ID":1,"NGUOICAPNHAT_ID":1,"BENHVIEN_ID":"HLU01"},{"HOPDONG_ID":3,"TENDICHVU":"Khám Mắt (E102)","NOITHUCHIEN":"Phòng khám mắt (E.102)","TENNHOMDICHVU":"Khám bệnh","PHONGBAN_ID":177,"DICHVU_ID":5435,"DONGIA":50000.0,"SOLUONG":1,"THANHTIEN":50000.0,"DANGKY":0,"STT":"6","CHECKSERVICE":true,"HOPDONG_BENHNHAN_ID":203,"NGAYCAPNHAT":"8/26/2019 1:43:56 PM","NGAYTAO":"8/26/2019 1:43:56 PM","NGUOITAO_ID":1,"NGUOICAPNHAT_ID":1,"BENHVIEN_ID":"HLU01"},{"HOPDONG_ID":3,"TENDICHVU":"Tổng phân tích nước tiểu (Bằng máy tự động)","NOITHUCHIEN":"Phòng XN Huyết học- Sinh hóa-Miễn dịch(D.230)","TENNHOMDICHVU":"Nước tiểu","PHONGBAN_ID":104,"DICHVU_ID":4747,"DONGIA":40000.0,"SOLUONG":1,"THANHTIEN":40000.0,"DANGKY":0,"STT":"7","CHECKSERVICE":true,"HOPDONG_BENHNHAN_ID":203,"NGAYCAPNHAT":"8/26/2019 1:43:56 PM","NGAYTAO":"8/26/2019 1:43:56 PM","NGUOITAO_ID":1,"NGUOICAPNHAT_ID":1,"BENHVIEN_ID":"HLU01"},{"HOPDONG_ID":3,"TENDICHVU":"Siêu âm tuyến giáp","NOITHUCHIEN":"Phòng siêu âm D.215","TENNHOMDICHVU":"Siêu âm","PHONGBAN_ID":92,"DICHVU_ID":4005,"DONGIA":70000.0,"SOLUONG":1,"THANHTIEN":70000.0,"DANGKY":0,"STT":"8","CHECKSERVICE":true,"HOPDONG_BENHNHAN_ID":203,"NGAYCAPNHAT":"8/26/2019 1:43:56 PM","NGAYTAO":"8/26/2019 1:43:56 PM","NGUOITAO_ID":1,"NGUOICAPNHAT_ID":1,"BENHVIEN_ID":"HLU01"},{"HOPDONG_ID":3,"TENDICHVU":"Siêu âm ổ bụng (gan mật, tụy, lách, thận, bàng quang)","NOITHUCHIEN":"Phòng siêu âm D.215","TENNHOMDICHVU":"Siêu âm","PHONGBAN_ID":92,"DICHVU_ID":4017,"DONGIA":50000.0,"SOLUONG":1,"THANHTIEN":50000.0,"DANGKY":0,"STT":"9","CHECKSERVICE":true,"HOPDONG_BENHNHAN_ID":203,"NGAYCAPNHAT":"8/26/2019 1:43:56 PM","NGAYTAO":"8/26/2019 1:43:56 PM","NGUOITAO_ID":1,"NGUOICAPNHAT_ID":1,"BENHVIEN_ID":"HLU01"}]';        INSERT INTO TT_KSK_HOPDONG_BENHNHAN_DICHVU        (        HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , DICHVU_ID        , PHONGBAN_ID        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYCAPNHAT        , NGUOICAPNHAT_ID)        SELECT        HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , DICHVU_ID        , PHONGBAN_ID        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYCAPNHAT        , NGUOICAPNHAT_ID        FROM OPENJSON(@jsonData)        WITH        (        HOPDONG_ID int        , HOPDONG_BENHNHAN_ID int        , DICHVU_ID int        , PHONGBAN_ID int        , BENHVIEN_ID varchar(10)        , NGAYTAO datetime        , NGUOITAO_ID int        , NGAYCAPNHAT datetime        , NGUOICAPNHAT_ID int)]
2019-08-26 13:43:56,326 [1] DEBUG - Statement Id: [DAO00307_GetContractPatient] PreparedStatement : [SELECT HD_BN.*, LST.DICTIONARY_NAME AS HONNHAN        , CASE WHEN HD_BN.GIOITINH = '1' THEN N'Nam' ELSE N'Nữ' END AS GENDER        , CASE WHEN HD_BN.HOPDONG_BENHNHAN_ID IN (SELECT HOPDONG_BENHNHAN_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU) THEN 1 ELSE 0 END BENHNHAN_DANGKYKSK_DICHVU        , GOI.TENGOI        FROM TT_KSK_HOPDONG_BENHNHAN HD_BN        INNER JOIN TT_KSK_HOPDONG HD ON HD.HOPDONG_ID = HD_BN.HOPDONG_ID        LEFT JOIN LST_DICTIONARY LST ON LST.DICTIONARY_ID = HD_BN.TINHTRANGHONNHAN_ID AND LST.DICTIONARY_TYPE_CODE = 'TinhTrangGiaDinh'        LEFT JOIN TM_CSKH_GOI GOI ON GOI.GOI_ID = HD_BN.GOI_ID        WHERE HD.HOPDONG_ID = 3           AND             HD_BN.BENHVIEN_ID = 'HLU01']
2019-08-26 13:43:56,360 [1] DEBUG - Statement Id: [DAO00308_StatusContract] PreparedStatement : [SELECT * FROM TT_KSK_HOPDONG        WHERE HOPDONG_ID = 3]
2019-08-26 13:43:56,465 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhanDichVu] PreparedStatement : [SELECT distinct HD_BN.HOPDONG_ID, DV.TENDICHVU, PB.TENPHONGBAN AS NOITHUCHIEN, NDV.TENNHOMDICHVU, PB.PHONGBAN_ID, DV.DICHVU_ID        , ISNULL(GOI_CT.DONGIATRONGGOI,0) AS DONGIA, ISNULL(GOI_CT.SOLAN,0) AS SOLUONG, GOI_CT.THANHTIENTRONGGOI AS THANHTIEN        , CASE WHEN DV.DICHVU_ID IN (SELECT DICHVU_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU WHERE HOPDONG_ID = '3' AND HOPDONG_BENHNHAN_ID = '203') THEN 1 ELSE 0 END AS DANGKY        FROM TT_KSK_HOPDONG HD                inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        INNER JOIN TM_CSKH_GOI_CHITIET GOI_CT ON GOI_CT.GOI_ID = HD_BN.GOI_ID        INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = GOI_CT.DICHVU_ID        LEFT JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        INNER JOIN TM_PHONGBAN_DICHVU PB_DV ON PB_DV.DICHVU_ID = DV.DICHVU_ID        LEFT JOIN TM_PHONGBAN PB ON PB.PHONGBAN_ID = PB_DV.PHONGBAN_ID        WHERE GOI_CT.GOI_ID = 3 and HD_BN.HOPDONG_BENHNHAN_ID = 203        and PB_DV.PHONGBAN_ID =(select top 1 PHONGBAN_ID from TM_PHONGBAN_DICHVU where DICHVU_ID = DV.DICHVU_ID)]
2019-08-26 13:43:59,735 [1] DEBUG - Statement Id: [DAO00308_UpdateTrangThai] PreparedStatement : [UPDATE TT_KSK_HOPDONG        SET TRANGTHAI =  @param0         WHERE HOPDONG_ID = 3]
2019-08-26 13:43:59,735 [1] DEBUG - Statement Id: [DAO00308_UpdateTrangThai] Parameters: [@param0=[TRANGTHAI,XACNHAN]]
2019-08-26 13:43:59,735 [1] DEBUG - Statement Id: [DAO00308_UpdateTrangThai] Types: [@param0=[String, System.String]]
2019-08-26 13:44:03,543 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhanDichVu] PreparedStatement : [SELECT distinct HD_BN.HOPDONG_ID, DV.TENDICHVU, PB.TENPHONGBAN AS NOITHUCHIEN, NDV.TENNHOMDICHVU, PB.PHONGBAN_ID, DV.DICHVU_ID        , ISNULL(GOI_CT.DONGIATRONGGOI,0) AS DONGIA, ISNULL(GOI_CT.SOLAN,0) AS SOLUONG, GOI_CT.THANHTIENTRONGGOI AS THANHTIEN        , CASE WHEN DV.DICHVU_ID IN (SELECT DICHVU_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU WHERE HOPDONG_ID = '3' AND HOPDONG_BENHNHAN_ID = '204') THEN 1 ELSE 0 END AS DANGKY        FROM TT_KSK_HOPDONG HD                inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        INNER JOIN TM_CSKH_GOI_CHITIET GOI_CT ON GOI_CT.GOI_ID = HD_BN.GOI_ID        INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = GOI_CT.DICHVU_ID        LEFT JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        INNER JOIN TM_PHONGBAN_DICHVU PB_DV ON PB_DV.DICHVU_ID = DV.DICHVU_ID        LEFT JOIN TM_PHONGBAN PB ON PB.PHONGBAN_ID = PB_DV.PHONGBAN_ID        WHERE GOI_CT.GOI_ID = 3 and HD_BN.HOPDONG_BENHNHAN_ID = 204        and PB_DV.PHONGBAN_ID =(select top 1 PHONGBAN_ID from TM_PHONGBAN_DICHVU where DICHVU_ID = DV.DICHVU_ID)]
2019-08-26 13:44:06,143 [1] DEBUG - Statement Id: [DAO00308_AddByJson] PreparedStatement : [declare @jsonData nvarchar(max) = N'[{"HOPDONG_ID":3,"TENDICHVU":"Chụp Xquang đỉnh phổi ưỡn - số hóa 1 phim","NOITHUCHIEN":"Phòng chụp XQ-KTS (D.208)","TENNHOMDICHVU":"Chụp Xquang số hóa","PHONGBAN_ID":35,"DICHVU_ID":4135,"DONGIA":90000.0,"SOLUONG":1,"THANHTIEN":90000.0,"DANGKY":0,"STT":"1","CHECKSERVICE":true,"HOPDONG_BENHNHAN_ID":204,"NGAYCAPNHAT":"8/26/2019 1:44:06 PM","NGAYTAO":"8/26/2019 1:44:06 PM","NGUOITAO_ID":1,"NGUOICAPNHAT_ID":1,"BENHVIEN_ID":"HLU01"},{"HOPDONG_ID":3,"TENDICHVU":"Tổng phân tích tế bào máu ngoại vi (bằng máy đếm laser)","NOITHUCHIEN":"Phòng XN Huyết học- Sinh hóa-Miễn dịch(D.230)","TENNHOMDICHVU":"Huyết học","PHONGBAN_ID":104,"DICHVU_ID":4524,"DONGIA":50000.0,"SOLUONG":1,"THANHTIEN":50000.0,"DANGKY":0,"STT":"2","CHECKSERVICE":true,"HOPDONG_BENHNHAN_ID":204,"NGAYCAPNHAT":"8/26/2019 1:44:06 PM","NGAYTAO":"8/26/2019 1:44:06 PM","NGUOITAO_ID":1,"NGUOICAPNHAT_ID":1,"BENHVIEN_ID":"HLU01"},{"HOPDONG_ID":3,"TENDICHVU":"Khám Da liễu","NOITHUCHIEN":"P. khám nội TH- Khám SK (D.232)","TENNHOMDICHVU":"Khám bệnh","PHONGBAN_ID":64,"DICHVU_ID":5433,"DONGIA":50000.0,"SOLUONG":1,"THANHTIEN":50000.0,"DANGKY":0,"STT":"3","CHECKSERVICE":true,"HOPDONG_BENHNHAN_ID":204,"NGAYCAPNHAT":"8/26/2019 1:44:06 PM","NGAYTAO":"8/26/2019 1:44:06 PM","NGUOITAO_ID":1,"NGUOICAPNHAT_ID":1,"BENHVIEN_ID":"HLU01"},{"HOPDONG_ID":3,"TENDICHVU":"Khám Nội tổng hợp (D232)","NOITHUCHIEN":"P. khám nội TH- Khám SK (D.232)","TENNHOMDICHVU":"Khám bệnh","PHONGBAN_ID":64,"DICHVU_ID":5438,"DONGIA":50000.0,"SOLUONG":1,"THANHTIEN":50000.0,"DANGKY":0,"STT":"4","CHECKSERVICE":true,"HOPDONG_BENHNHAN_ID":204,"NGAYCAPNHAT":"8/26/2019 1:44:06 PM","NGAYTAO":"8/26/2019 1:44:06 PM","NGUOITAO_ID":1,"NGUOICAPNHAT_ID":1,"BENHVIEN_ID":"HLU01"},{"HOPDONG_ID":3,"TENDICHVU":"Khám Tai mũi họng (B107)","NOITHUCHIEN":"Phòng Khám TMH (B.107)","TENNHOMDICHVU":"Khám bệnh","PHONGBAN_ID":68,"DICHVU_ID":5443,"DONGIA":50000.0,"SOLUONG":1,"THANHTIEN":50000.0,"DANGKY":0,"STT":"5","CHECKSERVICE":true,"HOPDONG_BENHNHAN_ID":204,"NGAYCAPNHAT":"8/26/2019 1:44:06 PM","NGAYTAO":"8/26/2019 1:44:06 PM","NGUOITAO_ID":1,"NGUOICAPNHAT_ID":1,"BENHVIEN_ID":"HLU01"},{"HOPDONG_ID":3,"TENDICHVU":"Khám Mắt (E102)","NOITHUCHIEN":"Phòng khám mắt (E.102)","TENNHOMDICHVU":"Khám bệnh","PHONGBAN_ID":177,"DICHVU_ID":5435,"DONGIA":50000.0,"SOLUONG":1,"THANHTIEN":50000.0,"DANGKY":0,"STT":"6","CHECKSERVICE":true,"HOPDONG_BENHNHAN_ID":204,"NGAYCAPNHAT":"8/26/2019 1:44:06 PM","NGAYTAO":"8/26/2019 1:44:06 PM","NGUOITAO_ID":1,"NGUOICAPNHAT_ID":1,"BENHVIEN_ID":"HLU01"},{"HOPDONG_ID":3,"TENDICHVU":"Tổng phân tích nước tiểu (Bằng máy tự động)","NOITHUCHIEN":"Phòng XN Huyết học- Sinh hóa-Miễn dịch(D.230)","TENNHOMDICHVU":"Nước tiểu","PHONGBAN_ID":104,"DICHVU_ID":4747,"DONGIA":40000.0,"SOLUONG":1,"THANHTIEN":40000.0,"DANGKY":0,"STT":"7","CHECKSERVICE":true,"HOPDONG_BENHNHAN_ID":204,"NGAYCAPNHAT":"8/26/2019 1:44:06 PM","NGAYTAO":"8/26/2019 1:44:06 PM","NGUOITAO_ID":1,"NGUOICAPNHAT_ID":1,"BENHVIEN_ID":"HLU01"},{"HOPDONG_ID":3,"TENDICHVU":"Siêu âm tuyến giáp","NOITHUCHIEN":"Phòng siêu âm D.215","TENNHOMDICHVU":"Siêu âm","PHONGBAN_ID":92,"DICHVU_ID":4005,"DONGIA":70000.0,"SOLUONG":1,"THANHTIEN":70000.0,"DANGKY":0,"STT":"8","CHECKSERVICE":true,"HOPDONG_BENHNHAN_ID":204,"NGAYCAPNHAT":"8/26/2019 1:44:06 PM","NGAYTAO":"8/26/2019 1:44:06 PM","NGUOITAO_ID":1,"NGUOICAPNHAT_ID":1,"BENHVIEN_ID":"HLU01"},{"HOPDONG_ID":3,"TENDICHVU":"Siêu âm ổ bụng (gan mật, tụy, lách, thận, bàng quang)","NOITHUCHIEN":"Phòng siêu âm D.215","TENNHOMDICHVU":"Siêu âm","PHONGBAN_ID":92,"DICHVU_ID":4017,"DONGIA":50000.0,"SOLUONG":1,"THANHTIEN":50000.0,"DANGKY":0,"STT":"9","CHECKSERVICE":true,"HOPDONG_BENHNHAN_ID":204,"NGAYCAPNHAT":"8/26/2019 1:44:06 PM","NGAYTAO":"8/26/2019 1:44:06 PM","NGUOITAO_ID":1,"NGUOICAPNHAT_ID":1,"BENHVIEN_ID":"HLU01"}]';        INSERT INTO TT_KSK_HOPDONG_BENHNHAN_DICHVU        (        HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , DICHVU_ID        , PHONGBAN_ID        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYCAPNHAT        , NGUOICAPNHAT_ID)        SELECT        HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , DICHVU_ID        , PHONGBAN_ID        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYCAPNHAT        , NGUOICAPNHAT_ID        FROM OPENJSON(@jsonData)        WITH        (        HOPDONG_ID int        , HOPDONG_BENHNHAN_ID int        , DICHVU_ID int        , PHONGBAN_ID int        , BENHVIEN_ID varchar(10)        , NGAYTAO datetime        , NGUOITAO_ID int        , NGAYCAPNHAT datetime        , NGUOICAPNHAT_ID int)]
2019-08-26 13:44:06,294 [1] DEBUG - Statement Id: [DAO00307_GetContractPatient] PreparedStatement : [SELECT HD_BN.*, LST.DICTIONARY_NAME AS HONNHAN        , CASE WHEN HD_BN.GIOITINH = '1' THEN N'Nam' ELSE N'Nữ' END AS GENDER        , CASE WHEN HD_BN.HOPDONG_BENHNHAN_ID IN (SELECT HOPDONG_BENHNHAN_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU) THEN 1 ELSE 0 END BENHNHAN_DANGKYKSK_DICHVU        , GOI.TENGOI        FROM TT_KSK_HOPDONG_BENHNHAN HD_BN        INNER JOIN TT_KSK_HOPDONG HD ON HD.HOPDONG_ID = HD_BN.HOPDONG_ID        LEFT JOIN LST_DICTIONARY LST ON LST.DICTIONARY_ID = HD_BN.TINHTRANGHONNHAN_ID AND LST.DICTIONARY_TYPE_CODE = 'TinhTrangGiaDinh'        LEFT JOIN TM_CSKH_GOI GOI ON GOI.GOI_ID = HD_BN.GOI_ID        WHERE HD.HOPDONG_ID = 3           AND             HD_BN.BENHVIEN_ID = 'HLU01']
2019-08-26 13:44:06,326 [1] DEBUG - Statement Id: [DAO00308_StatusContract] PreparedStatement : [SELECT * FROM TT_KSK_HOPDONG        WHERE HOPDONG_ID = 3]
2019-08-26 13:44:06,436 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhanDichVu] PreparedStatement : [SELECT distinct HD_BN.HOPDONG_ID, DV.TENDICHVU, PB.TENPHONGBAN AS NOITHUCHIEN, NDV.TENNHOMDICHVU, PB.PHONGBAN_ID, DV.DICHVU_ID        , ISNULL(GOI_CT.DONGIATRONGGOI,0) AS DONGIA, ISNULL(GOI_CT.SOLAN,0) AS SOLUONG, GOI_CT.THANHTIENTRONGGOI AS THANHTIEN        , CASE WHEN DV.DICHVU_ID IN (SELECT DICHVU_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU WHERE HOPDONG_ID = '3' AND HOPDONG_BENHNHAN_ID = '204') THEN 1 ELSE 0 END AS DANGKY        FROM TT_KSK_HOPDONG HD                inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        INNER JOIN TM_CSKH_GOI_CHITIET GOI_CT ON GOI_CT.GOI_ID = HD_BN.GOI_ID        INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = GOI_CT.DICHVU_ID        LEFT JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        INNER JOIN TM_PHONGBAN_DICHVU PB_DV ON PB_DV.DICHVU_ID = DV.DICHVU_ID        LEFT JOIN TM_PHONGBAN PB ON PB.PHONGBAN_ID = PB_DV.PHONGBAN_ID        WHERE GOI_CT.GOI_ID = 3 and HD_BN.HOPDONG_BENHNHAN_ID = 204        and PB_DV.PHONGBAN_ID =(select top 1 PHONGBAN_ID from TM_PHONGBAN_DICHVU where DICHVU_ID = DV.DICHVU_ID)]
2019-08-26 13:44:15,182 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'HSM08'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 13:44:15,664 [1] DEBUG - Statement Id: [DAO00307_GetContractWithDate] PreparedStatement : [SELECT HD.*, HD.SO_HD + ' - ' + CT.TENCONGTY AS HOPDONG, CT.TENCONGTY        FROM TT_KSK_HOPDONG HD JOIN TT_KSK_CONGTY CT ON CT.CONGTY_ID = HD.CONGTY_ID         where               HD.BENHVIEN_ID = 'HLU01']
2019-08-26 13:44:15,960 [1] DEBUG - Statement Id: [DAO00307_GetContractWithDate] PreparedStatement : [SELECT HD.*, HD.SO_HD + ' - ' + CT.TENCONGTY AS HOPDONG, CT.TENCONGTY        FROM TT_KSK_HOPDONG HD JOIN TT_KSK_CONGTY CT ON CT.CONGTY_ID = HD.CONGTY_ID         where               HD.BENHVIEN_ID = 'HLU01']
2019-08-26 13:44:19,691 [1] DEBUG - Statement Id: [DAO00307_GetPatientConfirms] PreparedStatement : [select distinct HD_BN.*        , CASE WHEN HD_BN.GIOITINH = '1' THEN N'Nam' ELSE N'Nữ' END AS GENDER        , CASE WHEN HD_DV.ACTIVE IS NULL THEN 0 ELSE 1 END BENHNHAN_DANGKYKSK_DICHVU        , case when HD_BN.GOI_ID is null then N'Hợp đồng:' + ' ' + HD.SO_HD else N'Gói khám:' + ' ' + G.TENGOI end as DOITUONG        , LST.DICTIONARY_NAME as HONNHAN        from TT_KSK_HOPDONG HD        inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        left join LST_DICTIONARY LST ON LST.DICTIONARY_ID = HD_BN.TINHTRANGHONNHAN_ID AND LST.DICTIONARY_TYPE_CODE = 'TinhTrangGiaDinh'        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        left join TT_TIEPNHAN TN on TN.TIEPNHAN_ID = HD_DV.TIEPNHAN_ID        left join TM_CSKH_GOI G ON G.GOI_ID = HD_BN.GOI_ID        where HD.HOPDONG_ID = 3         AND           HD.BENHVIEN_ID = 'HLU01'                 order by HD_BN.STT]
2019-08-26 13:44:21,064 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '203'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-08-26 13:44:21,209 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '203'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-08-26 13:44:22,081 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '204'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-08-26 13:44:22,200 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '203'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-08-26 13:44:22,294 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '203'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-08-26 13:44:22,396 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '204'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-08-26 13:44:22,481 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '204'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-08-26 13:44:25,032 [1] DEBUG - Statement Id: [DAO00307_CheckSingin] PreparedStatement : [select *        from TT_KSK_HOPDONG_BENHNHAN_DICHVU         where                 HOPDONG_ID = 3             and               HOPDONG_BENHNHAN_ID = 204             and               BENHVIEN_ID = 'HLU01']
2019-08-26 13:44:25,117 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '203'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-08-26 13:44:25,249 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '203'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-08-26 13:44:25,609 [1] DEBUG - Statement Id: [DAOLOG01_LockBegin] PreparedStatement : [INSERT into TT_LOG_UPDATE ( REF_TABLE , REF_ID , BENHVIEN_ID )         values ( @param0 ,  @param1 ,  @param2 );]
2019-08-26 13:44:25,609 [1] DEBUG - Statement Id: [DAOLOG01_LockBegin] Parameters: [@param0=[REF_TABLE,TT_TIEPNHAN_BENHAN], @param1=[REF_ID,23420], @param2=[BENHVIEN_ID,HLU01]]
2019-08-26 13:44:25,609 [1] DEBUG - Statement Id: [DAOLOG01_LockBegin] Types: [@param0=[String, System.String], @param1=[Int64, System.Int64], @param2=[String, System.String]]
2019-08-26 13:44:25,687 [1] DEBUG - Statement Id: [DAO00013_GetPatientInfo] PreparedStatement : [select *        from TT_BENHNHAN        where MAYTE  = '190043301']
2019-08-26 13:44:25,742 [1] DEBUG - Statement Id: [DAO00095_GetListNguoiLienHe] PreparedStatement : [SELECT BNN.*, D.DICTIONARY_NAME AS TENQUANHE          FROM TT_BENHNHAN AS BN          INNER JOIN TT_BENHNHAN_NGUOILIENHE AS BNN ON BNN.BENHNHAN_ID = BN.BENHNHAN_ID          LEFT JOIN LST_DICTIONARY AS D ON D.DICTIONARY_ID = BNN.QUANHE_ID AND D.DICTIONARY_TYPE_CODE = 'QuanHeGiaDinh'          WHERE BN.MAYTE = '190043301' AND BN.ACTIVE = '1' AND BN.BENHVIEN_ID = 'HLU01']
2019-08-26 13:44:25,945 [1] DEBUG - Statement Id: [DAO00013_GetBenhNhanToDB] PreparedStatement : [select ROW_NUMBER() OVER(order by a.MAYTE) as ROWNUMBER, *,        CASE        WHEN A.GIOITINH = 1 THEN 'Nam'        WHEN A.GIOITINH = 2 THEN N'Nữ'        END as TENGIOITINH        from TT_BENHNHAN A        where  ACTIVE = '1' and MAYTE = '190043301']
2019-08-26 13:44:27,944 [1] DEBUG - Statement Id: [DAO00095_GetListTiepNhanWithBenhNhanId] PreparedStatement : [SELECT A.SOTIEPNHAN, A.TIEPNHAN_ID, B.BENHAN_ID, B.SOBENHAN, bn.MAYTE          from TT_TIEPNHAN A          left join TT_NOITRU_BENHAN B on A.TIEPNHAN_ID = B.TIEPNHAN_ID          left join (select MAYTE, BENHNHAN_ID from TT_BENHNHAN where BENHNHAN_ID = '23420') bn on bn.BENHNHAN_ID = A.BENHNHAN_ID          WHERE A.BENHVIEN_ID = 'HLU01' and A.BENHNHAN_ID = '23420'          and A.TRANGTHAI in ('DATIEPNHAN','CAPCUU','NOITRU')]
2019-08-26 13:44:27,998 [1] DEBUG - Statement Id: [DAO00095_GetListDVYeucauWithBenhNhanId] PreparedStatement : [SELECT A.SOTIEPNHAN, A.TIEPNHAN_ID, C.DICHVU_ID, C.DVYEUCAU_ID          from TT_TIEPNHAN A          left join (select * from TT_DVYEUCAU where BENHNHAN_ID = '23420') C on C.TIEPNHAN_ID = A.TIEPNHAN_ID          WHERE A.BENHVIEN_ID = 'HLU01' and A.BENHNHAN_ID = '23420'          and A.TRANGTHAI in ('DATIEPNHAN','CAPCUU','NOITRU')]
2019-08-26 13:44:28,049 [1] DEBUG - Statement Id: [DAO00095_GetListToaThuocNoiTruWithBenhNhanId] PreparedStatement : [SELECT B.KHAMBENH_ID as KHAMBENH_TOATHUOC_ID, 'NOITRU' as LOAITOA          from TT_TIEPNHAN A          left join TT_NOITRU_TOATHUOC B on A.TIEPNHAN_ID = B.TIEPNHAN_ID          WHERE A.BENHVIEN_ID = 'HLU01' and A.BENHNHAN_ID = '23420'          and A.TRANGTHAI in ('DATIEPNHAN','CAPCUU','NOITRU')]
2019-08-26 13:44:28,091 [1] DEBUG - Statement Id: [DAO00095_GetLisToaThuocNgoaiWithBenhNhanId] PreparedStatement : [SELECT B.KHAMBENH_TOATHUOC_ID, B.LOAITOATHUOC as LOAITOA          from TT_TIEPNHAN A          left join TT_NGOAITRU_KHAMBENH C on C.TIEPNHAN_ID = A.TIEPNHAN_ID          left join TT_NGOAITRU_KHAMBENH_TOATHUOC B on C.KHAMBENH_ID = B.KHAMBENH_ID          WHERE A.BENHVIEN_ID = 'HLU01' and A.BENHNHAN_ID = '23420'          and A.TRANGTHAI in ('DATIEPNHAN','CAPCUU','NOITRU')]
2019-08-26 13:44:28,141 [1] DEBUG - Statement Id: [DAO00118_Add_BenhNhan] PreparedStatement : [if not exists (select 1 from TT_BENHNHAN where BENHNHAN_ID = '23420')              insert into TT_BENHNHAN (              BENHNHAN_ID              , MAYTE              , SOVAOVIEN              , TENBENHNHAN              , HO              , TEN              , GIOITINH              , NGAYSINH              , NAMSINH              , SONHA              , DIACHI              , SODIENTHOAI              , XAPHUONG_ID              , QUANHUYEN_ID              , TINHTHANH_ID              , DANTOC_ID              , QUOCTICH_ID              , SOLUUTRUNOITRU              , SOLUUTRUNGOAITRU              , NGHENGHIEP_ID              , CMND              , HOCHIEU              , VIETKIEU              , NGUOINUOCNGOAI              , DIACHITHUONGTRU              , DIACHILIENLAC              , DIACHICOQUAN              , EMAIL              , NHOMMAU_ID              , YEUTORH_ID              , TIENSUDIUNG              , TIENSUBENH              , TIENSUHUTTHUOCLA              , TUVONG              , NGAYTUVONG              , THOIGIANTUVONG              , NGUYENNHANTUVONG_ID              , NGUOIGHINHANTUVONG_ID              , THOIGIANGHINHANTUVONG              , NHANVIEN_ID              , DONVICONGTAC_ID              , DIENTHOAIBAN              , TINHTRANGHONNHAN_ID              , NGUOILIENHE_ID              , MOIQUANHE_ID              , NGUOILIENHE              , THONGTIN_NLH              , GHICHU              , HINHANH_DAIDIEN              , BENHVIEN_ID              , NGAYTAO              , NGUOITAO_ID              , NGAYGIOSINH              ) values (               @param0               ,  @param1               ,  @param2               ,  @param3               ,  @param4               ,  @param5               ,  @param6               ,  @param7               ,  @param8               ,  @param9               ,  @param10               ,  @param11               ,  @param12               ,  @param13               ,  @param14               ,  @param15               ,  @param16               ,  @param17               ,  @param18               ,  @param19               ,  @param20               ,  @param21               ,  @param22               ,  @param23               ,  @param24               ,  @param25               ,  @param26               ,  @param27               ,  @param28               ,  @param29               ,  @param30               ,  @param31               ,  @param32               ,  @param33               ,  @param34               ,  @param35               ,  @param36               ,  @param37               ,  @param38               ,  @param39               ,  @param40               ,  @param41               ,  @param42               ,  @param43               ,  @param44               ,  @param45               ,  @param46               ,  @param47               ,  @param48               ,  @param49               ,  @param50               ,  @param51               ,  @param52               )              else              update TT_BENHNHAN set              MAYTE =  @param1                ,                   SOVAOVIEN =  @param2                ,                   TENBENHNHAN =  @param3                ,                   HO =  @param4                ,                   TEN =  @param5                ,                   GIOITINH =  @param6                ,                   NGAYSINH =  @param7                ,                   NAMSINH =  @param8                ,                   SONHA =  @param9                ,                   SODIENTHOAI =  @param11                ,                   XAPHUONG_ID =  @param12                ,                   DANTOC_ID =  @param15                ,                   QUOCTICH_ID =  @param16                ,                   NGHENGHIEP_ID =  @param19                ,                   CMND =  @param20                ,                   HOCHIEU =  @param21                ,                   DIACHITHUONGTRU =  @param24                ,                   DIACHILIENLAC =  @param25                ,                   NGUOILIENHE_ID =  @param43                ,                   MOIQUANHE_ID =  @param44                ,                   NGUOILIENHE =  @param45                ,                   THONGTIN_NLH =  @param46                ,                   GHICHU =  @param47                ,                   BENHVIEN_ID =  @param49                ,                   NGAYCAPNHAT =  @param53                ,                   NGUOICAPNHAT_ID =  @param54                              where              BENHNHAN_ID = '23420']
2019-08-26 13:44:28,142 [1] DEBUG - Statement Id: [DAO00118_Add_BenhNhan] Parameters: [@param0=[BENHNHAN_ID,23420], @param1=[MAYTE,190043301], @param2=[SOVAOVIEN,0043301], @param3=[TENBENHNHAN,Test Fpt01], @param4=[HO,Test], @param5=[TEN,Fpt01], @param6=[GIOITINH,1], @param7=[NGAYSINH,3/1/1995 12:00:00 AM], @param8=[NAMSINH,1995], @param9=[SONHA,null], @param10=[DIACHI,null], @param11=[SODIENTHOAI,null], @param12=[XAPHUONG_ID,null], @param13=[QUANHUYEN_ID,null], @param14=[TINHTHANH_ID,null], @param15=[DANTOC_ID,null], @param16=[QUOCTICH_ID,null], @param17=[SOLUUTRUNOITRU,null], @param18=[SOLUUTRUNGOAITRU,null], @param19=[NGHENGHIEP_ID,null], @param20=[CMND,null], @param21=[HOCHIEU,null], @param22=[VIETKIEU,null], @param23=[NGUOINUOCNGOAI,null], @param24=[DIACHITHUONGTRU,null], @param25=[DIACHILIENLAC,null], @param26=[DIACHICOQUAN,null], @param27=[EMAIL,null], @param28=[NHOMMAU_ID,null], @param29=[YEUTORH_ID,null], @param30=[TIENSUDIUNG,null], @param31=[TIENSUBENH,null], @param32=[TIENSUHUTTHUOCLA,null], @param33=[TUVONG,null], @param34=[NGAYTUVONG,null], @param35=[THOIGIANTUVONG,null], @param36=[NGUYENNHANTUVONG_ID,null], @param37=[NGUOIGHINHANTUVONG_ID,null], @param38=[THOIGIANGHINHANTUVONG,null], @param39=[NHANVIEN_ID,null], @param40=[DONVICONGTAC_ID,null], @param41=[DIENTHOAIBAN,null], @param42=[TINHTRANGHONNHAN_ID,null], @param43=[NGUOILIENHE_ID,null], @param44=[MOIQUANHE_ID,null], @param45=[NGUOILIENHE,null], @param46=[THONGTIN_NLH,null], @param47=[GHICHU,null], @param48=[HINHANH_DAIDIEN,null], @param49=[BENHVIEN_ID,HLU01], @param50=[NGAYTAO,8/26/2019 1:42:46 PM], @param51=[NGUOITAO_ID,1], @param52=[NGAYGIOSINH,null], @param53=[NGAYCAPNHAT,8/26/2019 12:00:00 AM], @param54=[NGUOICAPNHAT_ID,1]]
2019-08-26 13:44:28,142 [1] DEBUG - Statement Id: [DAO00118_Add_BenhNhan] Types: [@param0=[Int32, System.Int32], @param1=[String, System.String], @param2=[String, System.String], @param3=[String, System.String], @param4=[String, System.String], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[DateTime, System.DateTime], @param8=[Int64, System.Int64], @param9=[System.DBNull, null], @param10=[System.DBNull, null], @param11=[System.DBNull, null], @param12=[System.DBNull, null], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[System.DBNull, null], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[System.DBNull, null], @param39=[System.DBNull, null], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[String, System.String], @param50=[DateTime, System.DateTime], @param51=[Int64, System.Int64], @param52=[System.DBNull, null], @param53=[DateTime, System.DateTime], @param54=[Int64, System.Int64]]
2019-08-26 13:44:28,427 [1] DEBUG - Statement Id: [DAOWF001_Laythongtingateways] PreparedStatement : [select * from TM_PROCESS_GATEWAYS]
2019-08-26 13:44:28,770 [1] DEBUG - Statement Id: [DAO00019_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10),        @yearNow int, @monthNow varchar(2), @dayNow varchar(2),        @Sotiepnhan varchar(20), @SoThuTu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @monthNow = RIGHT('00' + convert(varchar(2), MONTH(getdate())),2)        set @dayNow = RIGHT('00' + convert(varchar(2), DAY(getdate())),2)        BEGIN        select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOTIEPNHAN' and KEYYEAR = @yearNow and KEYMONTH = @monthNow and KEYDAY = @dayNow        and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOTIEPNHAN', @yearNow, @monthNow, @dayNow, '0', '0', '0', 0, @BenhVienId);        Update LST_KEYDATA set KEYVALUE = (KEYVALUE + 1), @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOTIEPNHAN' and KEYYEAR = @yearNow and KEYMONTH = @monthNow and KEYDAY = @dayNow and BENHVIEN_ID = @BenhVienId        set @SoThuTu = right('0000000'+convert(varchar(7), @keyValue), 7)        set @Sotiepnhan = 'TN' + RIGHT(@yearNow, 2) + @monthNow  + @dayNow + '.' + @SoThuTu                         insert into TT_TIEPNHAN (        SOTIEPNHAN        , UUTIEN        , BENHNHAN_ID        , BENHVIEN_ID        , TUYENKHAMBENH_ID        , NOITIEPNHAN_ID        , NGAYTIEPNHAN        , THOIGIANTIEPNHAN        , NAMTIEPNHAN        , THANGTIEPNHAN        , DOITUONG_ID        , LYDOTIEPNHAN_ID        , HINHTHUCDENKHAM_ID        , TINHTRANGHEN        , XACNHANCHIPHI_ID        , THUTIENTRUOC        , TAIKHAM        , SOBHYT        , BHYTTUNGAY        , BHYTDENNGAY        , BHYTNGAYCAP        , BHYTTREN3NAM        , BHYTTREN5NAM        , NGAYMIENDONGCHITRA        , LOAIBHYT        , NGAYBHYT2        , SOCHUYENVIEN        , HINHTHUCCHUYENVIEN_ID        , NOIGIOITHIEU_ID        , NGUOIGIOITHIEU_ID        , THOIGIANCHUYENTUYEN        , LYDOCHUYENVIEN_ID        , ICDNOIGIOITHIEU_ID        , CHANDOANNGT        , TRAITUYEN        , DIACHILIENHE        , XAPHUONG_ID        , QUANHUYEN_ID        , TINHTHANH_ID        , PROCESS_ID        , TRANGTHAI        , KHUVUCSONG_ID        , THANHVIEN_ID        , THE_ID        , LOAITHANHVIEN_ID        , SUDUNG_BHTN        , VIP        , GHICHU_TIEPNHAN        , BAOLANH_VIENPHI        , CONGTY_CHITRA_ID        , NGUON_BENHNHAN_ID        , LOAITIEPNHAN_ID        , THONGTIN_KCB_BHYT        , NGAYTAO        , NGUOITAO_ID        , LYDODENKHAM         ,           ISTHONGTUYEN                 )        OUTPUT INSERTED.TIEPNHAN_ID, INSERTED.SOTIEPNHAN        values (        @Sotiepnhan        ,  @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54          ,            @param55                  )        end]
2019-08-26 13:44:28,770 [1] DEBUG - Statement Id: [DAO00019_Add] Parameters: [@param0=[UUTIEN,0], @param1=[BENHNHAN_ID,23420], @param2=[BENHVIEN_ID,HLU01], @param3=[TUYENKHAMBENH_ID,null], @param4=[NOITIEPNHAN_ID,5], @param5=[NGAYTIEPNHAN,8/26/2019 12:00:00 AM], @param6=[THOIGIANTIEPNHAN,8/26/2019 12:00:00 AM], @param7=[NAMTIEPNHAN,2019], @param8=[THANGTIEPNHAN,8], @param9=[DOITUONG_ID,1], @param10=[LYDOTIEPNHAN_ID,null], @param11=[HINHTHUCDENKHAM_ID,461], @param12=[TINHTRANGHEN,null], @param13=[XACNHANCHIPHI_ID,null], @param14=[THUTIENTRUOC,null], @param15=[TAIKHAM,0], @param16=[SOBHYT,null], @param17=[BHYTTUNGAY,null], @param18=[BHYTDENNGAY,null], @param19=[BHYTNGAYCAP,null], @param20=[BHYTTREN3NAM,0], @param21=[BHYTTREN5NAM,0], @param22=[NGAYMIENDONGCHITRA,null], @param23=[LOAIBHYT,null], @param24=[NGAYBHYT2,null], @param25=[SOCHUYENVIEN,null], @param26=[HINHTHUCCHUYENVIEN_ID,null], @param27=[NOIGIOITHIEU_ID,null], @param28=[NGUOIGIOITHIEU_ID,null], @param29=[THOIGIANCHUYENTUYEN,null], @param30=[LYDOCHUYENVIEN_ID,null], @param31=[ICDNOIGIOITHIEU_ID,null], @param32=[CHANDOANNGT,null], @param33=[TRAITUYEN,0], @param34=[DIACHILIENHE,null], @param35=[XAPHUONG_ID,null], @param36=[QUANHUYEN_ID,null], @param37=[TINHTHANH_ID,null], @param38=[PROCESS_ID,P01], @param39=[TRANGTHAI,DATIEPNHAN], @param40=[KHUVUCSONG_ID,null], @param41=[THANHVIEN_ID,null], @param42=[THE_ID,null], @param43=[LOAITHANHVIEN_ID,null], @param44=[SUDUNG_BHTN,0], @param45=[VIP,0], @param46=[GHICHU_TIEPNHAN,null], @param47=[BAOLANH_VIENPHI,0], @param48=[CONGTY_CHITRA_ID,null], @param49=[NGUON_BENHNHAN_ID,null], @param50=[LOAITIEPNHAN_ID,null], @param51=[THONGTIN_KCB_BHYT,null], @param52=[NGAYTAO,8/26/2019 1:44:28 PM], @param53=[NGUOITAO_ID,1], @param54=[LYDODENKHAM,null], @param55=[ISTHONGTUYEN,0]]
2019-08-26 13:44:28,771 [1] DEBUG - Statement Id: [DAO00019_Add] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[String, System.String], @param3=[System.DBNull, null], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[DateTime, System.DateTime], @param7=[Int32, System.Int32], @param8=[Int32, System.Int32], @param9=[Int64, System.Int64], @param10=[System.DBNull, null], @param11=[Int64, System.Int64], @param12=[System.DBNull, null], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[String, System.String], @param21=[String, System.String], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[String, System.String], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[String, System.String], @param45=[String, System.String], @param46=[System.DBNull, null], @param47=[String, System.String], @param48=[System.DBNull, null], @param49=[System.DBNull, null], @param50=[System.DBNull, null], @param51=[System.DBNull, null], @param52=[DateTime, System.DateTime], @param53=[Int64, System.Int64], @param54=[System.DBNull, null], @param55=[String, System.String]]
2019-08-26 13:44:28,836 [1] DEBUG - Statement Id: [DAO00019_GetTTTiepNhan_byTiepNhanId] PreparedStatement : [select *        from TT_TIEPNHAN        where TIEPNHAN_ID = '27475'        order by TIEPNHAN_ID]
2019-08-26 13:44:28,879 [1] DEBUG - Statement Id: [DAO00080_Add_KhamBenh_CapCuu] PreparedStatement : [insert into TT_KHAMBENH_VAOVIEN (        SOPHIEU        , TIEPNHAN_ID        , KHAMBENH_ID        , BENHNHAN_ID        , NGUOILIENHE        , DIENTHOAILIENHE        , NOILAMVIEC        , CHANDOANNOIGIOITHIEU        , NGAYKHAM        , THOIGIANKHAM        , LYDOVAOVIEN        , QUATRINHBENHLY        , TIENSUBANTHAN        , TIENSUGIADINH        , KHAMXETTOANTHAN        , KHAMXETCACBOPHAN        , KHAMXETKQLS        , CHANDOANVAO        , ICDKHAMXET_ID        , DAXULY        , NGAYRA        , THOIGIANRA        , NHAPKHOA_ID        , CHUYENVIEN_ID        , CHUY        , MACH        , NHIETDO        , HUYETAPCAO        , HUYETAPTHAP        , NHIPTHO        , CANNANG        , CHIEUCAO        , BACSI_ID        , XUTRUKHAMBENH_ID        , CAPCUU        , NGAYTAINAN        , THOIGIANTAINAN        , NOITAINAN_TINHTHANH_ID        , NOITAINAN_QUANHUYEN_ID        , NOITAINAN_PHUONGXA_ID        , NOITAINAN_DIACHI        , DIADIEMTAINAN_ID        , BOPHANBITHUONG_ID        , MUCDO_ID        , DIENBIENSAUTN_ID        , XUTRISAUTN_ID        , NGUYENNHAN_ID        , NGUYENNHANCHITIET_ID        , ICD_NGUYENNHAN        , NGAYTAO        , NGUOITAO_ID        , NGAYCAPNHAT        , NGUOICAPNHAT_ID        , BENHANCHUYENKHOA        , CHANDOANVAOVIEN        , CHANDOANRAVIEN        , DIEUTRITUNGAY        , DIEUTRIDENNGAY        , DIENBIENLS        , KQXETNGHIEM        , PHAUTHUAT        , THUTHUAT        , TINHTRANGNGUOIBENH        , HUONGDIEUTRI        , NGUOIGIAO_ID        , NGUOINHAN_ID        , XQUANG        , CTSCANNER        , SIEUAM        , XETNGHIEM        , KHAC        , TOANBOHS        , LOAICHUYENKHOA        , CONGANCANTHIEP        , CDRR_BENHCHINH        , CDRR_BENHKEM        , ICD_BENHCHINH        , ICD_BENHKEMTHEO        , PHUONGPHAPDIEUTRI        , FIELD_1        , FIELD_2        , FIELD_3        , FIELD_4        , FIELD_5        , FIELD_6        , FIELD_7        , FIELD_8        , FIELD_9        , FIELD_10        , FIELD_11        , FIELD_12        , FIELD_13        , FIELD_14        , FIELD_15        , FIELD_27        , FIELD_28        , FIELD_29        , FIELD_30        , FIELD_31        , FIELD_32        , FIELD_33        , FIELD_34        , FIELD_35        , FIELD_36        , FIELD_37        , FIELD_38        , FIELD_39        , FIELD_40        , FIELD_41        , FIELD_42        , FIELD_43        , FIELD_44        , FIELD_45        , FIELD_46        , FIELD_47        , FIELD_48        , FIELD_49        , FIELD_50        , FIELD_51        , FIELD_52        , FIELD_53        , FIELD_54        , FIELD_55        , FIELD_56        , BENHVIEN_ID        ) values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77         ,  @param78         ,  @param79         ,  @param80         ,  @param81         ,  @param82         ,  @param83         ,  @param84         ,  @param85         ,  @param86         ,  @param87         ,  @param88         ,  @param89         ,  @param90         ,  @param91         ,  @param92         ,  @param93         ,  @param94         ,  @param95         ,  @param96         ,  @param97         ,  @param98         ,  @param99         ,  @param100         ,  @param101         ,  @param102         ,  @param103         ,  @param104         ,  @param105         ,  @param106         ,  @param107         ,  @param108         ,  @param109         ,  @param110         ,  @param111         ,  @param112         ,  @param113         ,  @param114         ,  @param115         ,  @param116         ,  @param117         ,  @param118         ,  @param119         ,  @param120         ,  @param121         ,  @param122         ,  @param123         ,  @param124         )]
2019-08-26 13:44:28,880 [1] DEBUG - Statement Id: [DAO00080_Add_KhamBenh_CapCuu] Parameters: [@param0=[SOPHIEU,null], @param1=[TIEPNHAN_ID,27475], @param2=[KHAMBENH_ID,null], @param3=[BENHNHAN_ID,23420], @param4=[NGUOILIENHE,null], @param5=[DIENTHOAILIENHE,null], @param6=[NOILAMVIEC,null], @param7=[CHANDOANNOIGIOITHIEU,null], @param8=[NGAYKHAM,8/26/2019 12:00:00 AM], @param9=[THOIGIANKHAM,8/26/2019 12:00:00 AM], @param10=[LYDOVAOVIEN,null], @param11=[QUATRINHBENHLY,null], @param12=[TIENSUBANTHAN,null], @param13=[TIENSUGIADINH,null], @param14=[KHAMXETTOANTHAN,null], @param15=[KHAMXETCACBOPHAN,null], @param16=[KHAMXETKQLS,null], @param17=[CHANDOANVAO,null], @param18=[ICDKHAMXET_ID,null], @param19=[DAXULY,null], @param20=[NGAYRA,null], @param21=[THOIGIANRA,null], @param22=[NHAPKHOA_ID,5], @param23=[CHUYENVIEN_ID,null], @param24=[CHUY,null], @param25=[MACH,null], @param26=[NHIETDO,null], @param27=[HUYETAPCAO,null], @param28=[HUYETAPTHAP,null], @param29=[NHIPTHO,null], @param30=[CANNANG,null], @param31=[CHIEUCAO,null], @param32=[BACSI_ID,null], @param33=[XUTRUKHAMBENH_ID,null], @param34=[CAPCUU,null], @param35=[NGAYTAINAN,null], @param36=[THOIGIANTAINAN,null], @param37=[NOITAINAN_TINHTHANH_ID,null], @param38=[NOITAINAN_QUANHUYEN_ID,null], @param39=[NOITAINAN_PHUONGXA_ID,null], @param40=[NOITAINAN_DIACHI,null], @param41=[DIADIEMTAINAN_ID,null], @param42=[BOPHANBITHUONG_ID,null], @param43=[MUCDO_ID,null], @param44=[DIENBIENSAUTN_ID,null], @param45=[XUTRISAUTN_ID,null], @param46=[NGUYENNHAN_ID,null], @param47=[NGUYENNHANCHITIET_ID,null], @param48=[ICD_NGUYENNHAN,null], @param49=[NGAYTAO,8/26/2019 1:44:28 PM], @param50=[NGUOITAO_ID,1], @param51=[NGAYCAPNHAT,8/26/2019 1:44:28 PM], @param52=[NGUOICAPNHAT_ID,1], @param53=[BENHANCHUYENKHOA,null], @param54=[CHANDOANVAOVIEN,null], @param55=[CHANDOANRAVIEN,null], @param56=[DIEUTRITUNGAY,null], @param57=[DIEUTRIDENNGAY,null], @param58=[DIENBIENLS,null], @param59=[KQXETNGHIEM,null], @param60=[PHAUTHUAT,null], @param61=[THUTHUAT,null], @param62=[TINHTRANGNGUOIBENH,null], @param63=[HUONGDIEUTRI,null], @param64=[NGUOIGIAO_ID,null], @param65=[NGUOINHAN_ID,null], @param66=[XQUANG,null], @param67=[CTSCANNER,null], @param68=[SIEUAM,null], @param69=[XETNGHIEM,null], @param70=[KHAC,null], @param71=[TOANBOHS,null], @param72=[LOAICHUYENKHOA,null], @param73=[CONGANCANTHIEP,null], @param74=[CDRR_BENHCHINH,null], @param75=[CDRR_BENHKEM,null], @param76=[ICD_BENHCHINH,null], @param77=[ICD_BENHKEMTHEO,null], @param78=[PHUONGPHAPDIEUTRI,null], @param79=[FIELD_1,null], @param80=[FIELD_2,null], @param81=[FIELD_3,null], @param82=[FIELD_4,null], @param83=[FIELD_5,null], @param84=[FIELD_6,null], @param85=[FIELD_7,null], @param86=[FIELD_8,null], @param87=[FIELD_9,null], @param88=[FIELD_10,null], @param89=[FIELD_11,null], @param90=[FIELD_12,null], @param91=[FIELD_13,null], @param92=[FIELD_14,null], @param93=[FIELD_15,null], @param94=[FIELD_27,null], @param95=[FIELD_28,null], @param96=[FIELD_29,null], @param97=[FIELD_30,null], @param98=[FIELD_31,null], @param99=[FIELD_32,null], @param100=[FIELD_33,null], @param101=[FIELD_34,null], @param102=[FIELD_35,null], @param103=[FIELD_36,null], @param104=[FIELD_37,null], @param105=[FIELD_38,null], @param106=[FIELD_39,null], @param107=[FIELD_40,null], @param108=[FIELD_41,null], @param109=[FIELD_42,null], @param110=[FIELD_43,null], @param111=[FIELD_44,null], @param112=[FIELD_45,null], @param113=[FIELD_46,null], @param114=[FIELD_47,null], @param115=[FIELD_48,null], @param116=[FIELD_49,null], @param117=[FIELD_50,null], @param118=[FIELD_51,null], @param119=[FIELD_52,null], @param120=[FIELD_53,null], @param121=[FIELD_54,null], @param122=[FIELD_55,null], @param123=[FIELD_56,null], @param124=[BENHVIEN_ID,HLU01]]
2019-08-26 13:44:28,880 [1] DEBUG - Statement Id: [DAO00080_Add_KhamBenh_CapCuu] Types: [@param0=[System.DBNull, null], @param1=[Int32, System.Int32], @param2=[System.DBNull, null], @param3=[Int32, System.Int32], @param4=[System.DBNull, null], @param5=[System.DBNull, null], @param6=[System.DBNull, null], @param7=[System.DBNull, null], @param8=[DateTime, System.DateTime], @param9=[DateTime, System.DateTime], @param10=[System.DBNull, null], @param11=[System.DBNull, null], @param12=[System.DBNull, null], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[System.DBNull, null], @param22=[String, System.String], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[System.DBNull, null], @param39=[System.DBNull, null], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[DateTime, System.DateTime], @param50=[Int64, System.Int64], @param51=[DateTime, System.DateTime], @param52=[Int64, System.Int64], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[System.DBNull, null], @param59=[System.DBNull, null], @param60=[System.DBNull, null], @param61=[System.DBNull, null], @param62=[System.DBNull, null], @param63=[System.DBNull, null], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[System.DBNull, null], @param71=[System.DBNull, null], @param72=[System.DBNull, null], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null], @param81=[System.DBNull, null], @param82=[System.DBNull, null], @param83=[System.DBNull, null], @param84=[System.DBNull, null], @param85=[System.DBNull, null], @param86=[System.DBNull, null], @param87=[System.DBNull, null], @param88=[System.DBNull, null], @param89=[System.DBNull, null], @param90=[System.DBNull, null], @param91=[System.DBNull, null], @param92=[System.DBNull, null], @param93=[System.DBNull, null], @param94=[System.DBNull, null], @param95=[System.DBNull, null], @param96=[System.DBNull, null], @param97=[System.DBNull, null], @param98=[System.DBNull, null], @param99=[System.DBNull, null], @param100=[System.DBNull, null], @param101=[System.DBNull, null], @param102=[System.DBNull, null], @param103=[System.DBNull, null], @param104=[System.DBNull, null], @param105=[System.DBNull, null], @param106=[System.DBNull, null], @param107=[System.DBNull, null], @param108=[System.DBNull, null], @param109=[System.DBNull, null], @param110=[System.DBNull, null], @param111=[System.DBNull, null], @param112=[System.DBNull, null], @param113=[System.DBNull, null], @param114=[System.DBNull, null], @param115=[System.DBNull, null], @param116=[System.DBNull, null], @param117=[System.DBNull, null], @param118=[System.DBNull, null], @param119=[System.DBNull, null], @param120=[System.DBNull, null], @param121=[System.DBNull, null], @param122=[System.DBNull, null], @param123=[System.DBNull, null], @param124=[String, System.String]]
2019-08-26 13:44:28,939 [1] DEBUG - Statement Id: [DAO00019_Add_TT_TIEPNHAN_SOTHEBHYT] PreparedStatement : [INSERT INTO TT_TIEPNHAN_SOTHEBHYT        (TIEPNHAN_ID        ,BENHNHAN_ID        ,BENHAN_ID        ,DOITUONG_ID        ,SOBHYT        ,BHYTTUNGAY        ,BHYTDENNGAY        ,BHYTNGAYCAP        ,BHYTTREN3NAM        ,BHYTTREN5NAM        ,NGAYMIENDONGCHITRA        ,TRAITUYEN        ,BENHVIEN_ID        ,NOITAO_ID        ,NGAYTAO        ,NGUOITAO_ID        ,NGAYCAPNHAT        ,NGUOICAPNHAT_ID        ,TYLE_VUOT_LCB        ,TYLE_TRAITUYEN        ,GIOIHAN_VUOT_LCB        ,LUONG_COSO        ,TYLE_THUOC_UT        ,MADOITUONG)        VALUES        ( @param0         , @param1         , @param2         , @param3         , @param4         , @param5         , @param6         , @param7         , @param8         , @param9         , @param10         , @param11         , @param12         , @param13         , @param14         , @param15         , @param16         , @param17         , @param18         , @param19         , @param20         , @param21         , @param22         , @param23 )]
2019-08-26 13:44:28,939 [1] DEBUG - Statement Id: [DAO00019_Add_TT_TIEPNHAN_SOTHEBHYT] Parameters: [@param0=[TIEPNHAN_ID,27475], @param1=[BENHNHAN_ID,23420], @param2=[BENHAN_ID,null], @param3=[DOITUONG_ID,1], @param4=[SOBHYT,null], @param5=[BHYTTUNGAY,null], @param6=[BHYTDENNGAY,null], @param7=[BHYTNGAYCAP,null], @param8=[BHYTTREN3NAM,0], @param9=[BHYTTREN5NAM,0], @param10=[NGAYMIENDONGCHITRA,null], @param11=[TRAITUYEN,0], @param12=[BENHVIEN_ID,HLU01], @param13=[NOITAO_ID,5], @param14=[NGAYTAO,8/26/2019 1:44:28 PM], @param15=[NGUOITAO_ID,1], @param16=[NGAYCAPNHAT,8/26/2019 1:44:28 PM], @param17=[NGUOICAPNHAT_ID,1], @param18=[TYLE_VUOT_LCB,null], @param19=[TYLE_TRAITUYEN,null], @param20=[GIOIHAN_VUOT_LCB,null], @param21=[LUONG_COSO,null], @param22=[TYLE_THUOC_UT,null], @param23=[MADOITUONG,null]]
2019-08-26 13:44:28,939 [1] DEBUG - Statement Id: [DAO00019_Add_TT_TIEPNHAN_SOTHEBHYT] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[System.DBNull, null], @param3=[Int64, System.Int64], @param4=[System.DBNull, null], @param5=[System.DBNull, null], @param6=[System.DBNull, null], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[String, System.String], @param10=[System.DBNull, null], @param11=[String, System.String], @param12=[String, System.String], @param13=[String, System.String], @param14=[DateTime, System.DateTime], @param15=[Int64, System.Int64], @param16=[DateTime, System.DateTime], @param17=[Int64, System.Int64], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[System.DBNull, null], @param22=[System.DBNull, null], @param23=[System.DBNull, null]]
2019-08-26 13:44:29,111 [1] DEBUG - Statement Id: [DAO00027_GetListTiepNhanAllCOM30] PreparedStatement : [select distinct A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, isnull(C.SOBENHAN,NULL) as SOBENHAN,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI, A.SOBHYT, CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYTIEPNHAN,        B.*        , A.UUTIEN        from TT_TIEPNHAN A        inner join (select * from TT_BENHNHAN where MAYTE = '190043301' and ACTIVE = '1') B on B.BENHNHAN_ID = A.BENHNHAN_ID  and B.ACTIVE = '1'        left join TT_NOITRU_BENHAN C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        where A.TIEPNHAN_ID = '27475' and A.BENHVIEN_ID = 'HLU01' and (A.TRANGTHAI not in ('HUY','CAPCUU', 'NOITRU', 'NGOAITRU'))]
2019-08-26 13:44:29,578 [1] DEBUG - Statement Id: [DAOWF001_LaythongtinProcess] PreparedStatement : [select * from TM_PROCESS        where        PROCESS_CODE = 'P01']
2019-08-26 13:44:29,613 [1] DEBUG - Statement Id: [DAOWF001_Kiemtrathongtindayeucau] PreparedStatement : [select * from TT_REQUEST        where        PROCESS_CODE = 'P01'        AND PARA = '{"HOSPITAL_ID":"HLU01","SOTIEPNHAN":"TN190826.0000001"}'        AND CURR_STATE_CODE = '6'        AND ISACTIVE = '1']
2019-08-26 13:44:30,989 [1] DEBUG - Statement Id: [DAOWF002_Add] PreparedStatement : [DECLARE @IDRequestOld int        DECLARE @IDRequestNew int        select top 1 @IDRequestOld = ID from TT_REQUEST where PARA =  @param0  order by ID desc          insert into TT_REQUEST (        PROCESS_CODE        , PARA        , CURR_STATE_CODE        ) values (         @param1         ,  @param0         ,  @param2         )        SELECT @IDRequestNew = SCOPE_IDENTITY()        if (@IDRequestOld is not null)        begin        update TT_REQUEST_SERVICE set REQUEST_ID = @IDRequestNew, PROCESS_CODE =  @param1  where REQUEST_ID = @IDRequestOld        update TT_REQUEST set ISACTIVE = '0' where ID = @IDRequestOld        update TT_REQUEST_SERVICE_DETAIL set REQUEST_ID = @IDRequestNew where REQUEST_ID = @IDRequestOld        end          select @IDRequestNew]
2019-08-26 13:44:30,989 [1] DEBUG - Statement Id: [DAOWF002_Add] Parameters: [@param0=[PARA,{"HOSPITAL_ID":"HLU01","SOTIEPNHAN":"TN190826.0000001"}], @param1=[PROCESS_CODE,P01], @param2=[CURR_STATE_CODE,6]]
2019-08-26 13:44:30,989 [1] DEBUG - Statement Id: [DAOWF002_Add] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[String, System.String]]
2019-08-26 13:44:31,309 [1] DEBUG - Statement Id: [DAO00064_GetREGListVienphiTiepNhan] PreparedStatement : [select A.*, B.THUTIENSAU        from TT_VIENPHI A        left join TT_DVYEUCAU B on A.REF_ID =  B.DVYEUCAU_ID and A.REF_TABLE = 'TT_DVYEUCAU' and B.HUYYEUCAU = '0'        where        A.TIEPNHAN_ID = '27475' and A.BENHVIEN_ID = 'HLU01' and (A.BENHAN_ID is NULL or A.BENHAN_ID = '')        and A.HUY = '0'        ORDER BY A.VIENPHI_ID]
2019-08-26 13:44:31,607 [1] DEBUG - Statement Id: [DAOLOG01_LockEnd] PreparedStatement : [DELETE TT_LOG_UPDATE        where REF_TABLE = 'TT_TIEPNHAN_BENHAN' and REF_ID = '23420' and BENHVIEN_ID = 'HLU01']
2019-08-26 13:44:31,651 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-08-26 13:44:31,651 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,27475], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,23420], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,4135], @param8=[BACSICHIDINH_ID,null], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,8/26/2019 12:00:00 AM], @param11=[THANGYEUCAU,8], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,8/26/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,5], @param16=[NOITHUCHIEN_ID,35], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,3], @param50=[HOPDONG_BENHNHAN_ID,203], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,8/26/2019 1:43:56 PM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-08-26 13:44:31,651 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-08-26 13:44:31,938 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '27475' and C.DICHVU_ID = '4135' and A.BENHVIEN_ID = 'HLU01']
2019-08-26 13:44:32,501 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '27475' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-08-26 13:44:33,309 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '27475']
2019-08-26 13:44:34,001 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-08-26 13:44:34,001 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,27475], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,23420], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,205418], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,4135], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,9], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,90000], @param12=[THANHTIEN_DOANHTHU,90000], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,90000], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,90000], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,8/26/2019 1:43:56 PM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,8/26/2019 1:43:56 PM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-08-26 13:44:34,001 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-08-26 13:44:34,140 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 37          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 203]
2019-08-26 13:44:34,140 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,27475], @param1=[DVYEUCAU_ID,205418], @param2=[VIENPHI_ID,674702], @param3=[SOPHIEUYEUCAU,19..045176], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,8/26/2019 1:44:34 PM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-08-26 13:44:34,141 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-08-26 13:44:34,190 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-08-26 13:44:34,191 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,27475], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,23420], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,4524], @param8=[BACSICHIDINH_ID,null], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,8/26/2019 12:00:00 AM], @param11=[THANGYEUCAU,8], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,8/26/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,5], @param16=[NOITHUCHIEN_ID,104], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,3], @param50=[HOPDONG_BENHNHAN_ID,203], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,8/26/2019 1:43:56 PM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-08-26 13:44:34,191 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-08-26 13:44:34,233 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '27475' and C.DICHVU_ID = '4524' and A.BENHVIEN_ID = 'HLU01']
2019-08-26 13:44:34,660 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '27475' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-08-26 13:44:35,510 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '27475']
2019-08-26 13:44:47,669 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-08-26 13:44:47,670 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,27475], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,23420], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,205419], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,4524], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,3], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,50000], @param12=[THANHTIEN_DOANHTHU,50000], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,50000], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,50000], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,8/26/2019 1:43:56 PM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,8/26/2019 1:43:56 PM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-08-26 13:44:47,670 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-08-26 13:44:47,869 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 38          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 203]
2019-08-26 13:44:47,870 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,27475], @param1=[DVYEUCAU_ID,205419], @param2=[VIENPHI_ID,674703], @param3=[SOPHIEUYEUCAU,19..045177], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,8/26/2019 1:44:47 PM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-08-26 13:44:47,870 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-08-26 13:44:47,926 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-08-26 13:44:47,926 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,27475], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,23420], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,5433], @param8=[BACSICHIDINH_ID,null], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,8/26/2019 12:00:00 AM], @param11=[THANGYEUCAU,8], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,8/26/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,5], @param16=[NOITHUCHIEN_ID,64], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,3], @param50=[HOPDONG_BENHNHAN_ID,203], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,8/26/2019 1:43:56 PM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-08-26 13:44:47,926 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-08-26 13:44:48,100 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '27475' and C.DICHVU_ID = '5433' and A.BENHVIEN_ID = 'HLU01']
2019-08-26 13:44:48,668 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '27475' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-08-26 13:44:49,929 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '27475']
2019-08-26 13:44:50,562 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-08-26 13:44:50,562 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,27475], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,23420], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,205420], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,5433], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,3], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,50000], @param12=[THANHTIEN_DOANHTHU,50000], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,50000], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,50000], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,8/26/2019 1:43:56 PM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,8/26/2019 1:43:56 PM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-08-26 13:44:50,562 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-08-26 13:44:50,607 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 39          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 203]
2019-08-26 13:44:50,607 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,27475], @param1=[DVYEUCAU_ID,205420], @param2=[VIENPHI_ID,674704], @param3=[SOPHIEUYEUCAU,19..045178], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,8/26/2019 1:44:50 PM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-08-26 13:44:50,607 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-08-26 13:44:50,659 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-08-26 13:44:50,659 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,27475], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,23420], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,5438], @param8=[BACSICHIDINH_ID,null], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,8/26/2019 12:00:00 AM], @param11=[THANGYEUCAU,8], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,8/26/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,5], @param16=[NOITHUCHIEN_ID,64], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,3], @param50=[HOPDONG_BENHNHAN_ID,203], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,8/26/2019 1:43:56 PM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-08-26 13:44:50,659 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-08-26 13:44:50,714 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '27475' and C.DICHVU_ID = '5438' and A.BENHVIEN_ID = 'HLU01']
2019-08-26 13:44:51,064 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '27475' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-08-26 13:44:52,137 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '27475']
2019-08-26 13:44:53,093 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-08-26 13:44:53,094 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,27475], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,23420], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,205421], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,5438], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,3], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,50000], @param12=[THANHTIEN_DOANHTHU,50000], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,50000], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,50000], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,8/26/2019 1:43:56 PM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,8/26/2019 1:43:56 PM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-08-26 13:44:53,094 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-08-26 13:44:53,151 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 40          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 203]
2019-08-26 13:44:53,151 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,27475], @param1=[DVYEUCAU_ID,205421], @param2=[VIENPHI_ID,674705], @param3=[SOPHIEUYEUCAU,19..045179], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,8/26/2019 1:44:53 PM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-08-26 13:44:53,151 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-08-26 13:44:53,198 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-08-26 13:44:53,198 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,27475], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,23420], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,5443], @param8=[BACSICHIDINH_ID,null], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,8/26/2019 12:00:00 AM], @param11=[THANGYEUCAU,8], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,8/26/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,5], @param16=[NOITHUCHIEN_ID,68], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,3], @param50=[HOPDONG_BENHNHAN_ID,203], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,8/26/2019 1:43:56 PM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-08-26 13:44:53,198 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-08-26 13:44:53,246 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '27475' and C.DICHVU_ID = '5443' and A.BENHVIEN_ID = 'HLU01']
2019-08-26 13:44:53,646 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '27475' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-08-26 13:44:54,874 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '27475']
2019-08-26 13:44:56,511 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-08-26 13:44:56,512 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,27475], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,23420], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,205422], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,5443], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,3], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,50000], @param12=[THANHTIEN_DOANHTHU,50000], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,50000], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,50000], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,8/26/2019 1:43:56 PM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,8/26/2019 1:43:56 PM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-08-26 13:44:56,512 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-08-26 13:44:56,577 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 41          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 203]
2019-08-26 13:44:56,577 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,27475], @param1=[DVYEUCAU_ID,205422], @param2=[VIENPHI_ID,674706], @param3=[SOPHIEUYEUCAU,19..045180], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,8/26/2019 1:44:56 PM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-08-26 13:44:56,577 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-08-26 13:44:56,619 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-08-26 13:44:56,620 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,27475], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,23420], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,5435], @param8=[BACSICHIDINH_ID,null], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,8/26/2019 12:00:00 AM], @param11=[THANGYEUCAU,8], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,8/26/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,5], @param16=[NOITHUCHIEN_ID,177], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,3], @param50=[HOPDONG_BENHNHAN_ID,203], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,8/26/2019 1:43:56 PM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-08-26 13:44:56,620 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-08-26 13:44:56,687 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '27475' and C.DICHVU_ID = '5435' and A.BENHVIEN_ID = 'HLU01']
2019-08-26 13:44:57,308 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '27475' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-08-26 13:44:59,170 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '27475']
2019-08-26 13:45:00,612 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-08-26 13:45:00,612 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,27475], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,23420], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,205423], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,5435], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,3], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,50000], @param12=[THANHTIEN_DOANHTHU,50000], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,50000], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,50000], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,8/26/2019 1:43:56 PM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,8/26/2019 1:43:56 PM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-08-26 13:45:00,612 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-08-26 13:45:00,641 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 42          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 203]
2019-08-26 13:45:00,641 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,27475], @param1=[DVYEUCAU_ID,205423], @param2=[VIENPHI_ID,674707], @param3=[SOPHIEUYEUCAU,19..045181], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,8/26/2019 1:45:00 PM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-08-26 13:45:00,641 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-08-26 13:45:00,686 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-08-26 13:45:00,687 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,27475], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,23420], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,4747], @param8=[BACSICHIDINH_ID,null], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,8/26/2019 12:00:00 AM], @param11=[THANGYEUCAU,8], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,8/26/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,5], @param16=[NOITHUCHIEN_ID,104], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,3], @param50=[HOPDONG_BENHNHAN_ID,203], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,8/26/2019 1:43:56 PM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-08-26 13:45:00,687 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-08-26 13:45:00,748 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '27475' and C.DICHVU_ID = '4747' and A.BENHVIEN_ID = 'HLU01']
2019-08-26 13:45:01,058 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '27475' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-08-26 13:45:02,609 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '27475']
2019-08-26 13:45:04,415 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-08-26 13:45:04,416 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,27475], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,23420], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,205424], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,4747], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,3], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,40000], @param12=[THANHTIEN_DOANHTHU,40000], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,40000], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,40000], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,8/26/2019 1:43:56 PM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,8/26/2019 1:43:56 PM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-08-26 13:45:04,416 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-08-26 13:45:04,462 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 43          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 203]
2019-08-26 13:45:04,462 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,27475], @param1=[DVYEUCAU_ID,205424], @param2=[VIENPHI_ID,674708], @param3=[SOPHIEUYEUCAU,19..045182], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,8/26/2019 1:45:04 PM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-08-26 13:45:04,462 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-08-26 13:45:04,531 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-08-26 13:45:04,531 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,27475], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,23420], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,4005], @param8=[BACSICHIDINH_ID,null], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,8/26/2019 12:00:00 AM], @param11=[THANGYEUCAU,8], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,8/26/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,5], @param16=[NOITHUCHIEN_ID,92], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,3], @param50=[HOPDONG_BENHNHAN_ID,203], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,8/26/2019 1:43:56 PM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-08-26 13:45:04,531 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-08-26 13:45:04,643 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '27475' and C.DICHVU_ID = '4005' and A.BENHVIEN_ID = 'HLU01']
2019-08-26 13:45:05,071 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '27475' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-08-26 13:45:07,206 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '27475']
2019-08-26 13:45:09,458 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-08-26 13:45:09,458 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,27475], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,23420], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,205425], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,4005], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,9], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,70000], @param12=[THANHTIEN_DOANHTHU,70000], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,70000], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,70000], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,8/26/2019 1:43:56 PM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,8/26/2019 1:43:56 PM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-08-26 13:45:09,458 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-08-26 13:45:09,485 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 44          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 203]
2019-08-26 13:45:09,485 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,27475], @param1=[DVYEUCAU_ID,205425], @param2=[VIENPHI_ID,674709], @param3=[SOPHIEUYEUCAU,19..045183], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,8/26/2019 1:45:09 PM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-08-26 13:45:09,486 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-08-26 13:45:09,520 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-08-26 13:45:09,521 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,27475], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,23420], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,4017], @param8=[BACSICHIDINH_ID,null], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,8/26/2019 12:00:00 AM], @param11=[THANGYEUCAU,8], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,8/26/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,5], @param16=[NOITHUCHIEN_ID,92], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,3], @param50=[HOPDONG_BENHNHAN_ID,203], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,8/26/2019 1:43:56 PM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-08-26 13:45:09,521 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-08-26 13:45:09,566 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '27475' and C.DICHVU_ID = '4017' and A.BENHVIEN_ID = 'HLU01']
2019-08-26 13:45:10,067 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '27475' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-08-26 13:45:12,677 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '27475']
2019-08-26 13:45:15,112 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-08-26 13:45:15,113 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,27475], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,23420], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,205426], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,4017], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,3], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,50000], @param12=[THANHTIEN_DOANHTHU,50000], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,50000], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,50000], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,8/26/2019 1:43:56 PM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,8/26/2019 1:43:56 PM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-08-26 13:45:15,113 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-08-26 13:45:15,143 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 45          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 203]
2019-08-26 13:45:15,143 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,27475], @param1=[DVYEUCAU_ID,205426], @param2=[VIENPHI_ID,674710], @param3=[SOPHIEUYEUCAU,19..045184], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,8/26/2019 1:45:15 PM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-08-26 13:45:15,143 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-08-26 13:45:15,536 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '204'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-08-26 13:45:15,678 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '204'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-08-26 13:45:15,713 [1] DEBUG - Statement Id: [DAOLOG01_LockBegin] PreparedStatement : [INSERT into TT_LOG_UPDATE ( REF_TABLE , REF_ID , BENHVIEN_ID )         values ( @param0 ,  @param1 ,  @param2 );]
2019-08-26 13:45:15,713 [1] DEBUG - Statement Id: [DAOLOG01_LockBegin] Parameters: [@param0=[REF_TABLE,TT_TIEPNHAN_BENHAN], @param1=[REF_ID,23421], @param2=[BENHVIEN_ID,HLU01]]
2019-08-26 13:45:15,713 [1] DEBUG - Statement Id: [DAOLOG01_LockBegin] Types: [@param0=[String, System.String], @param1=[Int64, System.Int64], @param2=[String, System.String]]
2019-08-26 13:45:15,771 [1] DEBUG - Statement Id: [DAO00013_GetPatientInfo] PreparedStatement : [select *        from TT_BENHNHAN        where MAYTE  = '190043302']
2019-08-26 13:45:15,805 [1] DEBUG - Statement Id: [DAO00095_GetListNguoiLienHe] PreparedStatement : [SELECT BNN.*, D.DICTIONARY_NAME AS TENQUANHE          FROM TT_BENHNHAN AS BN          INNER JOIN TT_BENHNHAN_NGUOILIENHE AS BNN ON BNN.BENHNHAN_ID = BN.BENHNHAN_ID          LEFT JOIN LST_DICTIONARY AS D ON D.DICTIONARY_ID = BNN.QUANHE_ID AND D.DICTIONARY_TYPE_CODE = 'QuanHeGiaDinh'          WHERE BN.MAYTE = '190043302' AND BN.ACTIVE = '1' AND BN.BENHVIEN_ID = 'HLU01']
2019-08-26 13:45:15,845 [1] DEBUG - Statement Id: [DAO00013_GetBenhNhanToDB] PreparedStatement : [select ROW_NUMBER() OVER(order by a.MAYTE) as ROWNUMBER, *,        CASE        WHEN A.GIOITINH = 1 THEN 'Nam'        WHEN A.GIOITINH = 2 THEN N'Nữ'        END as TENGIOITINH        from TT_BENHNHAN A        where  ACTIVE = '1' and MAYTE = '190043302']
2019-08-26 13:45:16,117 [1] DEBUG - Statement Id: [DAO00095_GetListTiepNhanWithBenhNhanId] PreparedStatement : [SELECT A.SOTIEPNHAN, A.TIEPNHAN_ID, B.BENHAN_ID, B.SOBENHAN, bn.MAYTE          from TT_TIEPNHAN A          left join TT_NOITRU_BENHAN B on A.TIEPNHAN_ID = B.TIEPNHAN_ID          left join (select MAYTE, BENHNHAN_ID from TT_BENHNHAN where BENHNHAN_ID = '23421') bn on bn.BENHNHAN_ID = A.BENHNHAN_ID          WHERE A.BENHVIEN_ID = 'HLU01' and A.BENHNHAN_ID = '23421'          and A.TRANGTHAI in ('DATIEPNHAN','CAPCUU','NOITRU')]
2019-08-26 13:45:16,168 [1] DEBUG - Statement Id: [DAO00095_GetListDVYeucauWithBenhNhanId] PreparedStatement : [SELECT A.SOTIEPNHAN, A.TIEPNHAN_ID, C.DICHVU_ID, C.DVYEUCAU_ID          from TT_TIEPNHAN A          left join (select * from TT_DVYEUCAU where BENHNHAN_ID = '23421') C on C.TIEPNHAN_ID = A.TIEPNHAN_ID          WHERE A.BENHVIEN_ID = 'HLU01' and A.BENHNHAN_ID = '23421'          and A.TRANGTHAI in ('DATIEPNHAN','CAPCUU','NOITRU')]
2019-08-26 13:45:16,214 [1] DEBUG - Statement Id: [DAO00095_GetListToaThuocNoiTruWithBenhNhanId] PreparedStatement : [SELECT B.KHAMBENH_ID as KHAMBENH_TOATHUOC_ID, 'NOITRU' as LOAITOA          from TT_TIEPNHAN A          left join TT_NOITRU_TOATHUOC B on A.TIEPNHAN_ID = B.TIEPNHAN_ID          WHERE A.BENHVIEN_ID = 'HLU01' and A.BENHNHAN_ID = '23421'          and A.TRANGTHAI in ('DATIEPNHAN','CAPCUU','NOITRU')]
2019-08-26 13:45:16,254 [1] DEBUG - Statement Id: [DAO00095_GetLisToaThuocNgoaiWithBenhNhanId] PreparedStatement : [SELECT B.KHAMBENH_TOATHUOC_ID, B.LOAITOATHUOC as LOAITOA          from TT_TIEPNHAN A          left join TT_NGOAITRU_KHAMBENH C on C.TIEPNHAN_ID = A.TIEPNHAN_ID          left join TT_NGOAITRU_KHAMBENH_TOATHUOC B on C.KHAMBENH_ID = B.KHAMBENH_ID          WHERE A.BENHVIEN_ID = 'HLU01' and A.BENHNHAN_ID = '23421'          and A.TRANGTHAI in ('DATIEPNHAN','CAPCUU','NOITRU')]
2019-08-26 13:45:16,292 [1] DEBUG - Statement Id: [DAO00118_Add_BenhNhan] PreparedStatement : [if not exists (select 1 from TT_BENHNHAN where BENHNHAN_ID = '23421')              insert into TT_BENHNHAN (              BENHNHAN_ID              , MAYTE              , SOVAOVIEN              , TENBENHNHAN              , HO              , TEN              , GIOITINH              , NGAYSINH              , NAMSINH              , SONHA              , DIACHI              , SODIENTHOAI              , XAPHUONG_ID              , QUANHUYEN_ID              , TINHTHANH_ID              , DANTOC_ID              , QUOCTICH_ID              , SOLUUTRUNOITRU              , SOLUUTRUNGOAITRU              , NGHENGHIEP_ID              , CMND              , HOCHIEU              , VIETKIEU              , NGUOINUOCNGOAI              , DIACHITHUONGTRU              , DIACHILIENLAC              , DIACHICOQUAN              , EMAIL              , NHOMMAU_ID              , YEUTORH_ID              , TIENSUDIUNG              , TIENSUBENH              , TIENSUHUTTHUOCLA              , TUVONG              , NGAYTUVONG              , THOIGIANTUVONG              , NGUYENNHANTUVONG_ID              , NGUOIGHINHANTUVONG_ID              , THOIGIANGHINHANTUVONG              , NHANVIEN_ID              , DONVICONGTAC_ID              , DIENTHOAIBAN              , TINHTRANGHONNHAN_ID              , NGUOILIENHE_ID              , MOIQUANHE_ID              , NGUOILIENHE              , THONGTIN_NLH              , GHICHU              , HINHANH_DAIDIEN              , BENHVIEN_ID              , NGAYTAO              , NGUOITAO_ID              , NGAYGIOSINH              ) values (               @param0               ,  @param1               ,  @param2               ,  @param3               ,  @param4               ,  @param5               ,  @param6               ,  @param7               ,  @param8               ,  @param9               ,  @param10               ,  @param11               ,  @param12               ,  @param13               ,  @param14               ,  @param15               ,  @param16               ,  @param17               ,  @param18               ,  @param19               ,  @param20               ,  @param21               ,  @param22               ,  @param23               ,  @param24               ,  @param25               ,  @param26               ,  @param27               ,  @param28               ,  @param29               ,  @param30               ,  @param31               ,  @param32               ,  @param33               ,  @param34               ,  @param35               ,  @param36               ,  @param37               ,  @param38               ,  @param39               ,  @param40               ,  @param41               ,  @param42               ,  @param43               ,  @param44               ,  @param45               ,  @param46               ,  @param47               ,  @param48               ,  @param49               ,  @param50               ,  @param51               ,  @param52               )              else              update TT_BENHNHAN set              MAYTE =  @param1                ,                   SOVAOVIEN =  @param2                ,                   TENBENHNHAN =  @param3                ,                   HO =  @param4                ,                   TEN =  @param5                ,                   GIOITINH =  @param6                ,                   NGAYSINH =  @param7                ,                   NAMSINH =  @param8                ,                   SONHA =  @param9                ,                   SODIENTHOAI =  @param11                ,                   XAPHUONG_ID =  @param12                ,                   DANTOC_ID =  @param15                ,                   QUOCTICH_ID =  @param16                ,                   NGHENGHIEP_ID =  @param19                ,                   CMND =  @param20                ,                   HOCHIEU =  @param21                ,                   DIACHITHUONGTRU =  @param24                ,                   DIACHILIENLAC =  @param25                ,                   NGUOILIENHE_ID =  @param43                ,                   MOIQUANHE_ID =  @param44                ,                   NGUOILIENHE =  @param45                ,                   THONGTIN_NLH =  @param46                ,                   GHICHU =  @param47                ,                   BENHVIEN_ID =  @param49                ,                   NGAYCAPNHAT =  @param53                ,                   NGUOICAPNHAT_ID =  @param54                              where              BENHNHAN_ID = '23421']
2019-08-26 13:45:16,293 [1] DEBUG - Statement Id: [DAO00118_Add_BenhNhan] Parameters: [@param0=[BENHNHAN_ID,23421], @param1=[MAYTE,190043302], @param2=[SOVAOVIEN,0043302], @param3=[TENBENHNHAN,Test Fpt02], @param4=[HO,Test], @param5=[TEN,Fpt02], @param6=[GIOITINH,2], @param7=[NGAYSINH,9/12/2000 12:00:00 AM], @param8=[NAMSINH,2000], @param9=[SONHA,null], @param10=[DIACHI,null], @param11=[SODIENTHOAI,null], @param12=[XAPHUONG_ID,null], @param13=[QUANHUYEN_ID,null], @param14=[TINHTHANH_ID,null], @param15=[DANTOC_ID,null], @param16=[QUOCTICH_ID,null], @param17=[SOLUUTRUNOITRU,null], @param18=[SOLUUTRUNGOAITRU,null], @param19=[NGHENGHIEP_ID,null], @param20=[CMND,null], @param21=[HOCHIEU,null], @param22=[VIETKIEU,null], @param23=[NGUOINUOCNGOAI,null], @param24=[DIACHITHUONGTRU,null], @param25=[DIACHILIENLAC,null], @param26=[DIACHICOQUAN,null], @param27=[EMAIL,null], @param28=[NHOMMAU_ID,null], @param29=[YEUTORH_ID,null], @param30=[TIENSUDIUNG,null], @param31=[TIENSUBENH,null], @param32=[TIENSUHUTTHUOCLA,null], @param33=[TUVONG,null], @param34=[NGAYTUVONG,null], @param35=[THOIGIANTUVONG,null], @param36=[NGUYENNHANTUVONG_ID,null], @param37=[NGUOIGHINHANTUVONG_ID,null], @param38=[THOIGIANGHINHANTUVONG,null], @param39=[NHANVIEN_ID,null], @param40=[DONVICONGTAC_ID,null], @param41=[DIENTHOAIBAN,null], @param42=[TINHTRANGHONNHAN_ID,null], @param43=[NGUOILIENHE_ID,null], @param44=[MOIQUANHE_ID,null], @param45=[NGUOILIENHE,null], @param46=[THONGTIN_NLH,null], @param47=[GHICHU,null], @param48=[HINHANH_DAIDIEN,null], @param49=[BENHVIEN_ID,HLU01], @param50=[NGAYTAO,8/26/2019 1:43:10 PM], @param51=[NGUOITAO_ID,1], @param52=[NGAYGIOSINH,null], @param53=[NGAYCAPNHAT,8/26/2019 12:00:00 AM], @param54=[NGUOICAPNHAT_ID,1]]
2019-08-26 13:45:16,293 [1] DEBUG - Statement Id: [DAO00118_Add_BenhNhan] Types: [@param0=[Int32, System.Int32], @param1=[String, System.String], @param2=[String, System.String], @param3=[String, System.String], @param4=[String, System.String], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[DateTime, System.DateTime], @param8=[Int64, System.Int64], @param9=[System.DBNull, null], @param10=[System.DBNull, null], @param11=[System.DBNull, null], @param12=[System.DBNull, null], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[System.DBNull, null], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[System.DBNull, null], @param39=[System.DBNull, null], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[String, System.String], @param50=[DateTime, System.DateTime], @param51=[Int64, System.Int64], @param52=[System.DBNull, null], @param53=[DateTime, System.DateTime], @param54=[Int64, System.Int64]]
2019-08-26 13:45:16,349 [1] DEBUG - Statement Id: [DAOWF001_Laythongtingateways] PreparedStatement : [select * from TM_PROCESS_GATEWAYS]
2019-08-26 13:45:16,376 [1] DEBUG - Statement Id: [DAO00019_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10),        @yearNow int, @monthNow varchar(2), @dayNow varchar(2),        @Sotiepnhan varchar(20), @SoThuTu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @monthNow = RIGHT('00' + convert(varchar(2), MONTH(getdate())),2)        set @dayNow = RIGHT('00' + convert(varchar(2), DAY(getdate())),2)        BEGIN        select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOTIEPNHAN' and KEYYEAR = @yearNow and KEYMONTH = @monthNow and KEYDAY = @dayNow        and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOTIEPNHAN', @yearNow, @monthNow, @dayNow, '0', '0', '0', 0, @BenhVienId);        Update LST_KEYDATA set KEYVALUE = (KEYVALUE + 1), @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOTIEPNHAN' and KEYYEAR = @yearNow and KEYMONTH = @monthNow and KEYDAY = @dayNow and BENHVIEN_ID = @BenhVienId        set @SoThuTu = right('0000000'+convert(varchar(7), @keyValue), 7)        set @Sotiepnhan = 'TN' + RIGHT(@yearNow, 2) + @monthNow  + @dayNow + '.' + @SoThuTu                         insert into TT_TIEPNHAN (        SOTIEPNHAN        , UUTIEN        , BENHNHAN_ID        , BENHVIEN_ID        , TUYENKHAMBENH_ID        , NOITIEPNHAN_ID        , NGAYTIEPNHAN        , THOIGIANTIEPNHAN        , NAMTIEPNHAN        , THANGTIEPNHAN        , DOITUONG_ID        , LYDOTIEPNHAN_ID        , HINHTHUCDENKHAM_ID        , TINHTRANGHEN        , XACNHANCHIPHI_ID        , THUTIENTRUOC        , TAIKHAM        , SOBHYT        , BHYTTUNGAY        , BHYTDENNGAY        , BHYTNGAYCAP        , BHYTTREN3NAM        , BHYTTREN5NAM        , NGAYMIENDONGCHITRA        , LOAIBHYT        , NGAYBHYT2        , SOCHUYENVIEN        , HINHTHUCCHUYENVIEN_ID        , NOIGIOITHIEU_ID        , NGUOIGIOITHIEU_ID        , THOIGIANCHUYENTUYEN        , LYDOCHUYENVIEN_ID        , ICDNOIGIOITHIEU_ID        , CHANDOANNGT        , TRAITUYEN        , DIACHILIENHE        , XAPHUONG_ID        , QUANHUYEN_ID        , TINHTHANH_ID        , PROCESS_ID        , TRANGTHAI        , KHUVUCSONG_ID        , THANHVIEN_ID        , THE_ID        , LOAITHANHVIEN_ID        , SUDUNG_BHTN        , VIP        , GHICHU_TIEPNHAN        , BAOLANH_VIENPHI        , CONGTY_CHITRA_ID        , NGUON_BENHNHAN_ID        , LOAITIEPNHAN_ID        , THONGTIN_KCB_BHYT        , NGAYTAO        , NGUOITAO_ID        , LYDODENKHAM         ,           ISTHONGTUYEN                 )        OUTPUT INSERTED.TIEPNHAN_ID, INSERTED.SOTIEPNHAN        values (        @Sotiepnhan        ,  @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54          ,            @param55                  )        end]
2019-08-26 13:45:16,376 [1] DEBUG - Statement Id: [DAO00019_Add] Parameters: [@param0=[UUTIEN,0], @param1=[BENHNHAN_ID,23421], @param2=[BENHVIEN_ID,HLU01], @param3=[TUYENKHAMBENH_ID,null], @param4=[NOITIEPNHAN_ID,5], @param5=[NGAYTIEPNHAN,8/26/2019 12:00:00 AM], @param6=[THOIGIANTIEPNHAN,8/26/2019 12:00:00 AM], @param7=[NAMTIEPNHAN,2019], @param8=[THANGTIEPNHAN,8], @param9=[DOITUONG_ID,1], @param10=[LYDOTIEPNHAN_ID,null], @param11=[HINHTHUCDENKHAM_ID,461], @param12=[TINHTRANGHEN,null], @param13=[XACNHANCHIPHI_ID,null], @param14=[THUTIENTRUOC,null], @param15=[TAIKHAM,0], @param16=[SOBHYT,null], @param17=[BHYTTUNGAY,null], @param18=[BHYTDENNGAY,null], @param19=[BHYTNGAYCAP,null], @param20=[BHYTTREN3NAM,0], @param21=[BHYTTREN5NAM,0], @param22=[NGAYMIENDONGCHITRA,null], @param23=[LOAIBHYT,null], @param24=[NGAYBHYT2,null], @param25=[SOCHUYENVIEN,null], @param26=[HINHTHUCCHUYENVIEN_ID,null], @param27=[NOIGIOITHIEU_ID,null], @param28=[NGUOIGIOITHIEU_ID,null], @param29=[THOIGIANCHUYENTUYEN,null], @param30=[LYDOCHUYENVIEN_ID,null], @param31=[ICDNOIGIOITHIEU_ID,null], @param32=[CHANDOANNGT,null], @param33=[TRAITUYEN,0], @param34=[DIACHILIENHE,null], @param35=[XAPHUONG_ID,null], @param36=[QUANHUYEN_ID,null], @param37=[TINHTHANH_ID,null], @param38=[PROCESS_ID,P01], @param39=[TRANGTHAI,DATIEPNHAN], @param40=[KHUVUCSONG_ID,null], @param41=[THANHVIEN_ID,null], @param42=[THE_ID,null], @param43=[LOAITHANHVIEN_ID,null], @param44=[SUDUNG_BHTN,0], @param45=[VIP,0], @param46=[GHICHU_TIEPNHAN,null], @param47=[BAOLANH_VIENPHI,0], @param48=[CONGTY_CHITRA_ID,null], @param49=[NGUON_BENHNHAN_ID,null], @param50=[LOAITIEPNHAN_ID,null], @param51=[THONGTIN_KCB_BHYT,null], @param52=[NGAYTAO,8/26/2019 1:45:16 PM], @param53=[NGUOITAO_ID,1], @param54=[LYDODENKHAM,null], @param55=[ISTHONGTUYEN,0]]
2019-08-26 13:45:16,376 [1] DEBUG - Statement Id: [DAO00019_Add] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[String, System.String], @param3=[System.DBNull, null], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[DateTime, System.DateTime], @param7=[Int32, System.Int32], @param8=[Int32, System.Int32], @param9=[Int64, System.Int64], @param10=[System.DBNull, null], @param11=[Int64, System.Int64], @param12=[System.DBNull, null], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[String, System.String], @param21=[String, System.String], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[String, System.String], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[String, System.String], @param45=[String, System.String], @param46=[System.DBNull, null], @param47=[String, System.String], @param48=[System.DBNull, null], @param49=[System.DBNull, null], @param50=[System.DBNull, null], @param51=[System.DBNull, null], @param52=[DateTime, System.DateTime], @param53=[Int64, System.Int64], @param54=[System.DBNull, null], @param55=[String, System.String]]
2019-08-26 13:45:16,406 [1] DEBUG - Statement Id: [DAO00019_GetTTTiepNhan_byTiepNhanId] PreparedStatement : [select *        from TT_TIEPNHAN        where TIEPNHAN_ID = '27476'        order by TIEPNHAN_ID]
2019-08-26 13:45:16,434 [1] DEBUG - Statement Id: [DAO00080_Add_KhamBenh_CapCuu] PreparedStatement : [insert into TT_KHAMBENH_VAOVIEN (        SOPHIEU        , TIEPNHAN_ID        , KHAMBENH_ID        , BENHNHAN_ID        , NGUOILIENHE        , DIENTHOAILIENHE        , NOILAMVIEC        , CHANDOANNOIGIOITHIEU        , NGAYKHAM        , THOIGIANKHAM        , LYDOVAOVIEN        , QUATRINHBENHLY        , TIENSUBANTHAN        , TIENSUGIADINH        , KHAMXETTOANTHAN        , KHAMXETCACBOPHAN        , KHAMXETKQLS        , CHANDOANVAO        , ICDKHAMXET_ID        , DAXULY        , NGAYRA        , THOIGIANRA        , NHAPKHOA_ID        , CHUYENVIEN_ID        , CHUY        , MACH        , NHIETDO        , HUYETAPCAO        , HUYETAPTHAP        , NHIPTHO        , CANNANG        , CHIEUCAO        , BACSI_ID        , XUTRUKHAMBENH_ID        , CAPCUU        , NGAYTAINAN        , THOIGIANTAINAN        , NOITAINAN_TINHTHANH_ID        , NOITAINAN_QUANHUYEN_ID        , NOITAINAN_PHUONGXA_ID        , NOITAINAN_DIACHI        , DIADIEMTAINAN_ID        , BOPHANBITHUONG_ID        , MUCDO_ID        , DIENBIENSAUTN_ID        , XUTRISAUTN_ID        , NGUYENNHAN_ID        , NGUYENNHANCHITIET_ID        , ICD_NGUYENNHAN        , NGAYTAO        , NGUOITAO_ID        , NGAYCAPNHAT        , NGUOICAPNHAT_ID        , BENHANCHUYENKHOA        , CHANDOANVAOVIEN        , CHANDOANRAVIEN        , DIEUTRITUNGAY        , DIEUTRIDENNGAY        , DIENBIENLS        , KQXETNGHIEM        , PHAUTHUAT        , THUTHUAT        , TINHTRANGNGUOIBENH        , HUONGDIEUTRI        , NGUOIGIAO_ID        , NGUOINHAN_ID        , XQUANG        , CTSCANNER        , SIEUAM        , XETNGHIEM        , KHAC        , TOANBOHS        , LOAICHUYENKHOA        , CONGANCANTHIEP        , CDRR_BENHCHINH        , CDRR_BENHKEM        , ICD_BENHCHINH        , ICD_BENHKEMTHEO        , PHUONGPHAPDIEUTRI        , FIELD_1        , FIELD_2        , FIELD_3        , FIELD_4        , FIELD_5        , FIELD_6        , FIELD_7        , FIELD_8        , FIELD_9        , FIELD_10        , FIELD_11        , FIELD_12        , FIELD_13        , FIELD_14        , FIELD_15        , FIELD_27        , FIELD_28        , FIELD_29        , FIELD_30        , FIELD_31        , FIELD_32        , FIELD_33        , FIELD_34        , FIELD_35        , FIELD_36        , FIELD_37        , FIELD_38        , FIELD_39        , FIELD_40        , FIELD_41        , FIELD_42        , FIELD_43        , FIELD_44        , FIELD_45        , FIELD_46        , FIELD_47        , FIELD_48        , FIELD_49        , FIELD_50        , FIELD_51        , FIELD_52        , FIELD_53        , FIELD_54        , FIELD_55        , FIELD_56        , BENHVIEN_ID        ) values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77         ,  @param78         ,  @param79         ,  @param80         ,  @param81         ,  @param82         ,  @param83         ,  @param84         ,  @param85         ,  @param86         ,  @param87         ,  @param88         ,  @param89         ,  @param90         ,  @param91         ,  @param92         ,  @param93         ,  @param94         ,  @param95         ,  @param96         ,  @param97         ,  @param98         ,  @param99         ,  @param100         ,  @param101         ,  @param102         ,  @param103         ,  @param104         ,  @param105         ,  @param106         ,  @param107         ,  @param108         ,  @param109         ,  @param110         ,  @param111         ,  @param112         ,  @param113         ,  @param114         ,  @param115         ,  @param116         ,  @param117         ,  @param118         ,  @param119         ,  @param120         ,  @param121         ,  @param122         ,  @param123         ,  @param124         )]
2019-08-26 13:45:16,434 [1] DEBUG - Statement Id: [DAO00080_Add_KhamBenh_CapCuu] Parameters: [@param0=[SOPHIEU,null], @param1=[TIEPNHAN_ID,27476], @param2=[KHAMBENH_ID,null], @param3=[BENHNHAN_ID,23421], @param4=[NGUOILIENHE,null], @param5=[DIENTHOAILIENHE,null], @param6=[NOILAMVIEC,null], @param7=[CHANDOANNOIGIOITHIEU,null], @param8=[NGAYKHAM,8/26/2019 12:00:00 AM], @param9=[THOIGIANKHAM,8/26/2019 12:00:00 AM], @param10=[LYDOVAOVIEN,null], @param11=[QUATRINHBENHLY,null], @param12=[TIENSUBANTHAN,null], @param13=[TIENSUGIADINH,null], @param14=[KHAMXETTOANTHAN,null], @param15=[KHAMXETCACBOPHAN,null], @param16=[KHAMXETKQLS,null], @param17=[CHANDOANVAO,null], @param18=[ICDKHAMXET_ID,null], @param19=[DAXULY,null], @param20=[NGAYRA,null], @param21=[THOIGIANRA,null], @param22=[NHAPKHOA_ID,5], @param23=[CHUYENVIEN_ID,null], @param24=[CHUY,null], @param25=[MACH,null], @param26=[NHIETDO,null], @param27=[HUYETAPCAO,null], @param28=[HUYETAPTHAP,null], @param29=[NHIPTHO,null], @param30=[CANNANG,null], @param31=[CHIEUCAO,null], @param32=[BACSI_ID,null], @param33=[XUTRUKHAMBENH_ID,null], @param34=[CAPCUU,null], @param35=[NGAYTAINAN,null], @param36=[THOIGIANTAINAN,null], @param37=[NOITAINAN_TINHTHANH_ID,null], @param38=[NOITAINAN_QUANHUYEN_ID,null], @param39=[NOITAINAN_PHUONGXA_ID,null], @param40=[NOITAINAN_DIACHI,null], @param41=[DIADIEMTAINAN_ID,null], @param42=[BOPHANBITHUONG_ID,null], @param43=[MUCDO_ID,null], @param44=[DIENBIENSAUTN_ID,null], @param45=[XUTRISAUTN_ID,null], @param46=[NGUYENNHAN_ID,null], @param47=[NGUYENNHANCHITIET_ID,null], @param48=[ICD_NGUYENNHAN,null], @param49=[NGAYTAO,8/26/2019 1:45:16 PM], @param50=[NGUOITAO_ID,1], @param51=[NGAYCAPNHAT,8/26/2019 1:45:16 PM], @param52=[NGUOICAPNHAT_ID,1], @param53=[BENHANCHUYENKHOA,null], @param54=[CHANDOANVAOVIEN,null], @param55=[CHANDOANRAVIEN,null], @param56=[DIEUTRITUNGAY,null], @param57=[DIEUTRIDENNGAY,null], @param58=[DIENBIENLS,null], @param59=[KQXETNGHIEM,null], @param60=[PHAUTHUAT,null], @param61=[THUTHUAT,null], @param62=[TINHTRANGNGUOIBENH,null], @param63=[HUONGDIEUTRI,null], @param64=[NGUOIGIAO_ID,null], @param65=[NGUOINHAN_ID,null], @param66=[XQUANG,null], @param67=[CTSCANNER,null], @param68=[SIEUAM,null], @param69=[XETNGHIEM,null], @param70=[KHAC,null], @param71=[TOANBOHS,null], @param72=[LOAICHUYENKHOA,null], @param73=[CONGANCANTHIEP,null], @param74=[CDRR_BENHCHINH,null], @param75=[CDRR_BENHKEM,null], @param76=[ICD_BENHCHINH,null], @param77=[ICD_BENHKEMTHEO,null], @param78=[PHUONGPHAPDIEUTRI,null], @param79=[FIELD_1,null], @param80=[FIELD_2,null], @param81=[FIELD_3,null], @param82=[FIELD_4,null], @param83=[FIELD_5,null], @param84=[FIELD_6,null], @param85=[FIELD_7,null], @param86=[FIELD_8,null], @param87=[FIELD_9,null], @param88=[FIELD_10,null], @param89=[FIELD_11,null], @param90=[FIELD_12,null], @param91=[FIELD_13,null], @param92=[FIELD_14,null], @param93=[FIELD_15,null], @param94=[FIELD_27,null], @param95=[FIELD_28,null], @param96=[FIELD_29,null], @param97=[FIELD_30,null], @param98=[FIELD_31,null], @param99=[FIELD_32,null], @param100=[FIELD_33,null], @param101=[FIELD_34,null], @param102=[FIELD_35,null], @param103=[FIELD_36,null], @param104=[FIELD_37,null], @param105=[FIELD_38,null], @param106=[FIELD_39,null], @param107=[FIELD_40,null], @param108=[FIELD_41,null], @param109=[FIELD_42,null], @param110=[FIELD_43,null], @param111=[FIELD_44,null], @param112=[FIELD_45,null], @param113=[FIELD_46,null], @param114=[FIELD_47,null], @param115=[FIELD_48,null], @param116=[FIELD_49,null], @param117=[FIELD_50,null], @param118=[FIELD_51,null], @param119=[FIELD_52,null], @param120=[FIELD_53,null], @param121=[FIELD_54,null], @param122=[FIELD_55,null], @param123=[FIELD_56,null], @param124=[BENHVIEN_ID,HLU01]]
2019-08-26 13:45:16,434 [1] DEBUG - Statement Id: [DAO00080_Add_KhamBenh_CapCuu] Types: [@param0=[System.DBNull, null], @param1=[Int32, System.Int32], @param2=[System.DBNull, null], @param3=[Int32, System.Int32], @param4=[System.DBNull, null], @param5=[System.DBNull, null], @param6=[System.DBNull, null], @param7=[System.DBNull, null], @param8=[DateTime, System.DateTime], @param9=[DateTime, System.DateTime], @param10=[System.DBNull, null], @param11=[System.DBNull, null], @param12=[System.DBNull, null], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[System.DBNull, null], @param22=[String, System.String], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[System.DBNull, null], @param39=[System.DBNull, null], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[DateTime, System.DateTime], @param50=[Int64, System.Int64], @param51=[DateTime, System.DateTime], @param52=[Int64, System.Int64], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[System.DBNull, null], @param59=[System.DBNull, null], @param60=[System.DBNull, null], @param61=[System.DBNull, null], @param62=[System.DBNull, null], @param63=[System.DBNull, null], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[System.DBNull, null], @param71=[System.DBNull, null], @param72=[System.DBNull, null], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null], @param81=[System.DBNull, null], @param82=[System.DBNull, null], @param83=[System.DBNull, null], @param84=[System.DBNull, null], @param85=[System.DBNull, null], @param86=[System.DBNull, null], @param87=[System.DBNull, null], @param88=[System.DBNull, null], @param89=[System.DBNull, null], @param90=[System.DBNull, null], @param91=[System.DBNull, null], @param92=[System.DBNull, null], @param93=[System.DBNull, null], @param94=[System.DBNull, null], @param95=[System.DBNull, null], @param96=[System.DBNull, null], @param97=[System.DBNull, null], @param98=[System.DBNull, null], @param99=[System.DBNull, null], @param100=[System.DBNull, null], @param101=[System.DBNull, null], @param102=[System.DBNull, null], @param103=[System.DBNull, null], @param104=[System.DBNull, null], @param105=[System.DBNull, null], @param106=[System.DBNull, null], @param107=[System.DBNull, null], @param108=[System.DBNull, null], @param109=[System.DBNull, null], @param110=[System.DBNull, null], @param111=[System.DBNull, null], @param112=[System.DBNull, null], @param113=[System.DBNull, null], @param114=[System.DBNull, null], @param115=[System.DBNull, null], @param116=[System.DBNull, null], @param117=[System.DBNull, null], @param118=[System.DBNull, null], @param119=[System.DBNull, null], @param120=[System.DBNull, null], @param121=[System.DBNull, null], @param122=[System.DBNull, null], @param123=[System.DBNull, null], @param124=[String, System.String]]
2019-08-26 13:45:16,466 [1] DEBUG - Statement Id: [DAO00019_Add_TT_TIEPNHAN_SOTHEBHYT] PreparedStatement : [INSERT INTO TT_TIEPNHAN_SOTHEBHYT        (TIEPNHAN_ID        ,BENHNHAN_ID        ,BENHAN_ID        ,DOITUONG_ID        ,SOBHYT        ,BHYTTUNGAY        ,BHYTDENNGAY        ,BHYTNGAYCAP        ,BHYTTREN3NAM        ,BHYTTREN5NAM        ,NGAYMIENDONGCHITRA        ,TRAITUYEN        ,BENHVIEN_ID        ,NOITAO_ID        ,NGAYTAO        ,NGUOITAO_ID        ,NGAYCAPNHAT        ,NGUOICAPNHAT_ID        ,TYLE_VUOT_LCB        ,TYLE_TRAITUYEN        ,GIOIHAN_VUOT_LCB        ,LUONG_COSO        ,TYLE_THUOC_UT        ,MADOITUONG)        VALUES        ( @param0         , @param1         , @param2         , @param3         , @param4         , @param5         , @param6         , @param7         , @param8         , @param9         , @param10         , @param11         , @param12         , @param13         , @param14         , @param15         , @param16         , @param17         , @param18         , @param19         , @param20         , @param21         , @param22         , @param23 )]
2019-08-26 13:45:16,466 [1] DEBUG - Statement Id: [DAO00019_Add_TT_TIEPNHAN_SOTHEBHYT] Parameters: [@param0=[TIEPNHAN_ID,27476], @param1=[BENHNHAN_ID,23421], @param2=[BENHAN_ID,null], @param3=[DOITUONG_ID,1], @param4=[SOBHYT,null], @param5=[BHYTTUNGAY,null], @param6=[BHYTDENNGAY,null], @param7=[BHYTNGAYCAP,null], @param8=[BHYTTREN3NAM,0], @param9=[BHYTTREN5NAM,0], @param10=[NGAYMIENDONGCHITRA,null], @param11=[TRAITUYEN,0], @param12=[BENHVIEN_ID,HLU01], @param13=[NOITAO_ID,5], @param14=[NGAYTAO,8/26/2019 1:45:16 PM], @param15=[NGUOITAO_ID,1], @param16=[NGAYCAPNHAT,8/26/2019 1:45:16 PM], @param17=[NGUOICAPNHAT_ID,1], @param18=[TYLE_VUOT_LCB,null], @param19=[TYLE_TRAITUYEN,null], @param20=[GIOIHAN_VUOT_LCB,null], @param21=[LUONG_COSO,null], @param22=[TYLE_THUOC_UT,null], @param23=[MADOITUONG,null]]
2019-08-26 13:45:16,466 [1] DEBUG - Statement Id: [DAO00019_Add_TT_TIEPNHAN_SOTHEBHYT] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[System.DBNull, null], @param3=[Int64, System.Int64], @param4=[System.DBNull, null], @param5=[System.DBNull, null], @param6=[System.DBNull, null], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[String, System.String], @param10=[System.DBNull, null], @param11=[String, System.String], @param12=[String, System.String], @param13=[String, System.String], @param14=[DateTime, System.DateTime], @param15=[Int64, System.Int64], @param16=[DateTime, System.DateTime], @param17=[Int64, System.Int64], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[System.DBNull, null], @param22=[System.DBNull, null], @param23=[System.DBNull, null]]
2019-08-26 13:45:16,499 [1] DEBUG - Statement Id: [DAO00027_GetListTiepNhanAllCOM30] PreparedStatement : [select distinct A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, isnull(C.SOBENHAN,NULL) as SOBENHAN,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI, A.SOBHYT, CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYTIEPNHAN,        B.*        , A.UUTIEN        from TT_TIEPNHAN A        inner join (select * from TT_BENHNHAN where MAYTE = '190043302' and ACTIVE = '1') B on B.BENHNHAN_ID = A.BENHNHAN_ID  and B.ACTIVE = '1'        left join TT_NOITRU_BENHAN C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        where A.TIEPNHAN_ID = '27476' and A.BENHVIEN_ID = 'HLU01' and (A.TRANGTHAI not in ('HUY','CAPCUU', 'NOITRU', 'NGOAITRU'))]
2019-08-26 13:45:16,892 [1] DEBUG - Statement Id: [DAOWF001_LaythongtinProcess] PreparedStatement : [select * from TM_PROCESS        where        PROCESS_CODE = 'P01']
2019-08-26 13:45:16,920 [1] DEBUG - Statement Id: [DAOWF001_Kiemtrathongtindayeucau] PreparedStatement : [select * from TT_REQUEST        where        PROCESS_CODE = 'P01'        AND PARA = '{"HOSPITAL_ID":"HLU01","SOTIEPNHAN":"TN190826.0000002"}'        AND CURR_STATE_CODE = '6'        AND ISACTIVE = '1']
2019-08-26 13:45:16,961 [1] DEBUG - Statement Id: [DAOWF002_Add] PreparedStatement : [DECLARE @IDRequestOld int        DECLARE @IDRequestNew int        select top 1 @IDRequestOld = ID from TT_REQUEST where PARA =  @param0  order by ID desc          insert into TT_REQUEST (        PROCESS_CODE        , PARA        , CURR_STATE_CODE        ) values (         @param1         ,  @param0         ,  @param2         )        SELECT @IDRequestNew = SCOPE_IDENTITY()        if (@IDRequestOld is not null)        begin        update TT_REQUEST_SERVICE set REQUEST_ID = @IDRequestNew, PROCESS_CODE =  @param1  where REQUEST_ID = @IDRequestOld        update TT_REQUEST set ISACTIVE = '0' where ID = @IDRequestOld        update TT_REQUEST_SERVICE_DETAIL set REQUEST_ID = @IDRequestNew where REQUEST_ID = @IDRequestOld        end          select @IDRequestNew]
2019-08-26 13:45:16,961 [1] DEBUG - Statement Id: [DAOWF002_Add] Parameters: [@param0=[PARA,{"HOSPITAL_ID":"HLU01","SOTIEPNHAN":"TN190826.0000002"}], @param1=[PROCESS_CODE,P01], @param2=[CURR_STATE_CODE,6]]
2019-08-26 13:45:16,961 [1] DEBUG - Statement Id: [DAOWF002_Add] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[String, System.String]]
2019-08-26 13:45:17,017 [1] DEBUG - Statement Id: [DAO00064_GetREGListVienphiTiepNhan] PreparedStatement : [select A.*, B.THUTIENSAU        from TT_VIENPHI A        left join TT_DVYEUCAU B on A.REF_ID =  B.DVYEUCAU_ID and A.REF_TABLE = 'TT_DVYEUCAU' and B.HUYYEUCAU = '0'        where        A.TIEPNHAN_ID = '27476' and A.BENHVIEN_ID = 'HLU01' and (A.BENHAN_ID is NULL or A.BENHAN_ID = '')        and A.HUY = '0'        ORDER BY A.VIENPHI_ID]
2019-08-26 13:45:17,070 [1] DEBUG - Statement Id: [DAOLOG01_LockEnd] PreparedStatement : [DELETE TT_LOG_UPDATE        where REF_TABLE = 'TT_TIEPNHAN_BENHAN' and REF_ID = '23421' and BENHVIEN_ID = 'HLU01']
2019-08-26 13:45:17,111 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-08-26 13:45:17,111 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,27476], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,23421], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,4135], @param8=[BACSICHIDINH_ID,null], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,8/26/2019 12:00:00 AM], @param11=[THANGYEUCAU,8], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,8/26/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,5], @param16=[NOITHUCHIEN_ID,35], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,3], @param50=[HOPDONG_BENHNHAN_ID,204], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,8/26/2019 1:44:06 PM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-08-26 13:45:17,111 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-08-26 13:45:17,152 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '27476' and C.DICHVU_ID = '4135' and A.BENHVIEN_ID = 'HLU01']
2019-08-26 13:45:17,545 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '27476' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-08-26 13:45:17,989 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '27476']
2019-08-26 13:45:18,393 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-08-26 13:45:18,394 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,27476], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,23421], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,205427], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,4135], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,9], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,90000], @param12=[THANHTIEN_DOANHTHU,90000], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,90000], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,90000], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,8/26/2019 1:44:06 PM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,8/26/2019 1:44:06 PM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-08-26 13:45:18,394 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-08-26 13:45:18,423 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 46          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 204]
2019-08-26 13:45:18,423 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,27476], @param1=[DVYEUCAU_ID,205427], @param2=[VIENPHI_ID,674711], @param3=[SOPHIEUYEUCAU,19..045185], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,8/26/2019 1:45:18 PM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-08-26 13:45:18,423 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-08-26 13:45:18,459 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-08-26 13:45:18,481 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,27476], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,23421], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,4524], @param8=[BACSICHIDINH_ID,null], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,8/26/2019 12:00:00 AM], @param11=[THANGYEUCAU,8], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,8/26/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,5], @param16=[NOITHUCHIEN_ID,104], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,3], @param50=[HOPDONG_BENHNHAN_ID,204], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,8/26/2019 1:44:06 PM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-08-26 13:45:18,481 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-08-26 13:45:18,515 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '27476' and C.DICHVU_ID = '4524' and A.BENHVIEN_ID = 'HLU01']
2019-08-26 13:45:18,824 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '27476' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-08-26 13:45:19,449 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '27476']
2019-08-26 13:45:20,141 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-08-26 13:45:20,142 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,27476], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,23421], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,205428], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,4524], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,3], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,50000], @param12=[THANHTIEN_DOANHTHU,50000], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,50000], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,50000], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,8/26/2019 1:44:06 PM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,8/26/2019 1:44:06 PM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-08-26 13:45:20,142 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-08-26 13:45:20,171 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 47          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 204]
2019-08-26 13:45:20,171 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,27476], @param1=[DVYEUCAU_ID,205428], @param2=[VIENPHI_ID,674712], @param3=[SOPHIEUYEUCAU,19..045186], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,8/26/2019 1:45:20 PM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-08-26 13:45:20,171 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-08-26 13:45:20,207 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-08-26 13:45:20,207 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,27476], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,23421], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,5433], @param8=[BACSICHIDINH_ID,null], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,8/26/2019 12:00:00 AM], @param11=[THANGYEUCAU,8], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,8/26/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,5], @param16=[NOITHUCHIEN_ID,64], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,3], @param50=[HOPDONG_BENHNHAN_ID,204], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,8/26/2019 1:44:06 PM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-08-26 13:45:20,207 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-08-26 13:45:20,243 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '27476' and C.DICHVU_ID = '5433' and A.BENHVIEN_ID = 'HLU01']
2019-08-26 13:45:20,902 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '27476' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-08-26 13:45:21,924 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '27476']
2019-08-26 13:45:22,574 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-08-26 13:45:22,575 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,27476], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,23421], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,205429], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,5433], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,3], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,50000], @param12=[THANHTIEN_DOANHTHU,50000], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,50000], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,50000], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,8/26/2019 1:44:06 PM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,8/26/2019 1:44:06 PM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-08-26 13:45:22,575 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-08-26 13:45:22,606 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 48          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 204]
2019-08-26 13:45:22,606 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,27476], @param1=[DVYEUCAU_ID,205429], @param2=[VIENPHI_ID,674713], @param3=[SOPHIEUYEUCAU,19..045187], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,8/26/2019 1:45:22 PM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-08-26 13:45:22,606 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-08-26 13:45:22,641 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-08-26 13:45:22,641 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,27476], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,23421], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,5438], @param8=[BACSICHIDINH_ID,null], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,8/26/2019 12:00:00 AM], @param11=[THANGYEUCAU,8], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,8/26/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,5], @param16=[NOITHUCHIEN_ID,64], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,3], @param50=[HOPDONG_BENHNHAN_ID,204], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,8/26/2019 1:44:06 PM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-08-26 13:45:22,641 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-08-26 13:45:22,680 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '27476' and C.DICHVU_ID = '5438' and A.BENHVIEN_ID = 'HLU01']
2019-08-26 13:45:23,003 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '27476' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-08-26 13:45:24,149 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '27476']
2019-08-26 13:45:25,246 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-08-26 13:45:25,247 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,27476], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,23421], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,205430], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,5438], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,3], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,50000], @param12=[THANHTIEN_DOANHTHU,50000], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,50000], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,50000], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,8/26/2019 1:44:06 PM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,8/26/2019 1:44:06 PM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-08-26 13:45:25,247 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-08-26 13:45:25,287 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 49          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 204]
2019-08-26 13:45:25,287 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,27476], @param1=[DVYEUCAU_ID,205430], @param2=[VIENPHI_ID,674714], @param3=[SOPHIEUYEUCAU,19..045188], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,8/26/2019 1:45:25 PM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-08-26 13:45:25,287 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-08-26 13:45:25,331 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-08-26 13:45:25,331 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,27476], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,23421], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,5443], @param8=[BACSICHIDINH_ID,null], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,8/26/2019 12:00:00 AM], @param11=[THANGYEUCAU,8], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,8/26/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,5], @param16=[NOITHUCHIEN_ID,68], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,3], @param50=[HOPDONG_BENHNHAN_ID,204], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,8/26/2019 1:44:06 PM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-08-26 13:45:25,331 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-08-26 13:45:25,370 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '27476' and C.DICHVU_ID = '5443' and A.BENHVIEN_ID = 'HLU01']
2019-08-26 13:45:25,689 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '27476' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-08-26 13:45:27,083 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '27476']
2019-08-26 13:45:28,344 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-08-26 13:45:28,344 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,27476], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,23421], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,205431], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,5443], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,3], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,50000], @param12=[THANHTIEN_DOANHTHU,50000], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,50000], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,50000], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,8/26/2019 1:44:06 PM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,8/26/2019 1:44:06 PM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-08-26 13:45:28,344 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-08-26 13:45:28,373 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 50          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 204]
2019-08-26 13:45:28,373 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,27476], @param1=[DVYEUCAU_ID,205431], @param2=[VIENPHI_ID,674715], @param3=[SOPHIEUYEUCAU,19..045189], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,8/26/2019 1:45:28 PM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-08-26 13:45:28,373 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-08-26 13:45:28,409 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-08-26 13:45:28,410 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,27476], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,23421], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,5435], @param8=[BACSICHIDINH_ID,null], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,8/26/2019 12:00:00 AM], @param11=[THANGYEUCAU,8], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,8/26/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,5], @param16=[NOITHUCHIEN_ID,177], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,3], @param50=[HOPDONG_BENHNHAN_ID,204], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,8/26/2019 1:44:06 PM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-08-26 13:45:28,410 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-08-26 13:45:28,445 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '27476' and C.DICHVU_ID = '5435' and A.BENHVIEN_ID = 'HLU01']
2019-08-26 13:45:29,037 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '27476' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-08-26 13:45:30,537 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '27476']
2019-08-26 13:45:32,797 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-08-26 13:45:32,797 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,27476], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,23421], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,205432], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,5435], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,3], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,50000], @param12=[THANHTIEN_DOANHTHU,50000], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,50000], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,50000], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,8/26/2019 1:44:06 PM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,8/26/2019 1:44:06 PM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-08-26 13:45:32,797 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-08-26 13:45:32,852 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 51          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 204]
2019-08-26 13:45:32,852 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,27476], @param1=[DVYEUCAU_ID,205432], @param2=[VIENPHI_ID,674716], @param3=[SOPHIEUYEUCAU,19..045190], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,8/26/2019 1:45:32 PM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-08-26 13:45:32,852 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-08-26 13:45:32,887 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-08-26 13:45:32,887 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,27476], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,23421], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,4747], @param8=[BACSICHIDINH_ID,null], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,8/26/2019 12:00:00 AM], @param11=[THANGYEUCAU,8], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,8/26/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,5], @param16=[NOITHUCHIEN_ID,104], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,3], @param50=[HOPDONG_BENHNHAN_ID,204], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,8/26/2019 1:44:06 PM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-08-26 13:45:32,887 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-08-26 13:45:32,945 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '27476' and C.DICHVU_ID = '4747' and A.BENHVIEN_ID = 'HLU01']
2019-08-26 13:45:33,323 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '27476' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-08-26 13:45:34,751 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '27476']
2019-08-26 13:45:36,028 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-08-26 13:45:36,028 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,27476], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,23421], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,205433], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,4747], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,3], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,40000], @param12=[THANHTIEN_DOANHTHU,40000], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,40000], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,40000], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,8/26/2019 1:44:06 PM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,8/26/2019 1:44:06 PM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-08-26 13:45:36,028 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-08-26 13:45:36,055 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 52          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 204]
2019-08-26 13:45:36,056 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,27476], @param1=[DVYEUCAU_ID,205433], @param2=[VIENPHI_ID,674717], @param3=[SOPHIEUYEUCAU,19..045191], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,8/26/2019 1:45:36 PM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-08-26 13:45:36,056 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-08-26 13:45:36,093 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-08-26 13:45:36,094 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,27476], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,23421], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,4005], @param8=[BACSICHIDINH_ID,null], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,8/26/2019 12:00:00 AM], @param11=[THANGYEUCAU,8], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,8/26/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,5], @param16=[NOITHUCHIEN_ID,92], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,3], @param50=[HOPDONG_BENHNHAN_ID,204], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,8/26/2019 1:44:06 PM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-08-26 13:45:36,094 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-08-26 13:45:36,130 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '27476' and C.DICHVU_ID = '4005' and A.BENHVIEN_ID = 'HLU01']
2019-08-26 13:45:36,474 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '27476' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-08-26 13:45:38,327 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '27476']
2019-08-26 13:45:39,829 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-08-26 13:45:39,829 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,27476], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,23421], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,205434], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,4005], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,9], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,70000], @param12=[THANHTIEN_DOANHTHU,70000], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,70000], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,70000], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,8/26/2019 1:44:06 PM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,8/26/2019 1:44:06 PM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-08-26 13:45:39,829 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-08-26 13:45:39,859 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 53          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 204]
2019-08-26 13:45:39,859 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,27476], @param1=[DVYEUCAU_ID,205434], @param2=[VIENPHI_ID,674718], @param3=[SOPHIEUYEUCAU,19..045192], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,8/26/2019 1:45:39 PM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-08-26 13:45:39,859 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-08-26 13:45:39,899 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-08-26 13:45:39,900 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,27476], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,23421], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,4017], @param8=[BACSICHIDINH_ID,null], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,8/26/2019 12:00:00 AM], @param11=[THANGYEUCAU,8], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,8/26/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,5], @param16=[NOITHUCHIEN_ID,92], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,3], @param50=[HOPDONG_BENHNHAN_ID,204], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,8/26/2019 1:44:06 PM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-08-26 13:45:39,900 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-08-26 13:45:39,948 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '27476' and C.DICHVU_ID = '4017' and A.BENHVIEN_ID = 'HLU01']
2019-08-26 13:45:40,281 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '27476' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-08-26 13:45:41,963 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '27476']
2019-08-26 13:45:44,060 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-08-26 13:45:44,061 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,27476], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,23421], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,205435], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,4017], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,3], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,50000], @param12=[THANHTIEN_DOANHTHU,50000], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,50000], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,50000], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,8/26/2019 1:44:06 PM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,8/26/2019 1:44:06 PM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-08-26 13:45:44,061 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-08-26 13:45:44,090 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 54          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 204]
2019-08-26 13:45:44,090 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,27476], @param1=[DVYEUCAU_ID,205435], @param2=[VIENPHI_ID,674719], @param3=[SOPHIEUYEUCAU,19..045193], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,8/26/2019 1:45:44 PM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-08-26 13:45:44,090 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-08-26 13:45:44,226 [1] DEBUG - Statement Id: [DAO00307_GetPatientConfirms] PreparedStatement : [select distinct HD_BN.*        , CASE WHEN HD_BN.GIOITINH = '1' THEN N'Nam' ELSE N'Nữ' END AS GENDER        , CASE WHEN HD_DV.ACTIVE IS NULL THEN 0 ELSE 1 END BENHNHAN_DANGKYKSK_DICHVU        , case when HD_BN.GOI_ID is null then N'Hợp đồng:' + ' ' + HD.SO_HD else N'Gói khám:' + ' ' + G.TENGOI end as DOITUONG        , LST.DICTIONARY_NAME as HONNHAN        from TT_KSK_HOPDONG HD        inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        left join LST_DICTIONARY LST ON LST.DICTIONARY_ID = HD_BN.TINHTRANGHONNHAN_ID AND LST.DICTIONARY_TYPE_CODE = 'TinhTrangGiaDinh'        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        left join TT_TIEPNHAN TN on TN.TIEPNHAN_ID = HD_DV.TIEPNHAN_ID        left join TM_CSKH_GOI G ON G.GOI_ID = HD_BN.GOI_ID        where HD.HOPDONG_ID = 3         AND           HD.BENHVIEN_ID = 'HLU01'                 order by HD_BN.STT]
2019-08-26 13:45:44,416 [1] DEBUG - Statement Id: [DAO00308_GetTiepNhanID] PreparedStatement : [select top 1 TN.TIEPNHAN_ID, TN.SOTIEPNHAN        from TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV        inner join TT_TIEPNHAN TN on TN.TIEPNHAN_ID = HD_DV.TIEPNHAN_ID        where HD_DV.HOPDONG_BENHNHAN_ID = 204 and HD_DV.HOPDONG_ID = 3]
2019-08-26 13:45:44,520 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '204'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-08-26 13:46:04,223 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MTR01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 13:46:04,939 [1] DEBUG - Statement Id: [DAO00209_ADM17] PreparedStatement : [SELECT *              FROM TM_SYS_APPSETTINGS              WHERE BENHVIEN_ID = 'HLU01' AND LOCKED = '0' AND TYPE = '0']
2019-08-26 13:46:21,491 [1] DEBUG - Statement Id: [DAO00209_ADM17] PreparedStatement : [SELECT *              FROM TM_SYS_APPSETTINGS              WHERE BENHVIEN_ID = 'HLU01' AND LOCKED = '0' AND TYPE = '2']
2019-08-26 13:46:21,671 [1] DEBUG - Statement Id: [DAO00209_ADM17] PreparedStatement : [SELECT *              FROM TM_SYS_APPSETTINGS              WHERE BENHVIEN_ID = 'HLU01' AND LOCKED = '0' AND TYPE = '2']
2019-08-26 13:48:58,424 [1] DEBUG - Statement Id: [DAO00209_ADM17_Update] PreparedStatement : [update TM_SYS_APPSETTINGS set              CODE =  @param0               , LANGUAGE_ID =  @param1               , VALUE =  @param2               , DESCRIPTION =  @param3               , LOCKED =  @param4               , TYPE =  @param5               , LASTUPDATEDATE =  @param6               , LASTUPDATEDBY =  @param7               , BENHVIEN_ID =  @param8               where              SETTING_ID = '5431']
2019-08-26 13:48:58,424 [1] DEBUG - Statement Id: [DAO00209_ADM17_Update] Parameters: [@param0=[CODE,HSM_MapDichVu], @param1=[LANGUAGE_ID,VI], @param2=[VALUE,{"5435":"KM","5436":"NGOAITQ","5438":"NOITQ","5443":"TMH","5442":"RHM","5433":"DL","5440":"PHUKHOA"}], @param3=[DESCRIPTION,Map dịch vụ với chuyên khoa], @param4=[LOCKED,0], @param5=[TYPE,2], @param6=[LASTUPDATEDATE,3/1/2019 12:00:00 AM], @param7=[LASTUPDATEDBY,1], @param8=[BENHVIEN_ID,HLU01]]
2019-08-26 13:48:58,424 [1] DEBUG - Statement Id: [DAO00209_ADM17_Update] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[String, System.String], @param3=[String, System.String], @param4=[String, System.String], @param5=[Int64, System.Int64], @param6=[DateTime, System.DateTime], @param7=[Int32, System.Int32], @param8=[String, System.String]]
2019-08-26 13:48:58,487 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01']
2019-08-26 13:48:58,679 [1] DEBUG - Statement Id: [DAO00209_ADM17] PreparedStatement : [SELECT *              FROM TM_SYS_APPSETTINGS              WHERE BENHVIEN_ID = 'HLU01' AND LOCKED = '0' AND TYPE = '2']
2019-08-26 13:49:01,776 [1] DEBUG - Statement Id: [DAO00307_GetGoiDichVu] PreparedStatement : [SELECT G.*, G.GOI_ID as GOIDICHVU_ID        , case when G.GOI_ID in (select GOIDICHVU_ID from TT_KSK_HOPDONG_GOIDICHVU where HOPDONG_ID = 0) then 1 else 0 end as GOIEXIST        FROM TM_CSKH_GOI G INNER JOIN LST_DICTIONARY L ON L.DICTIONARY_ID = G.LOAIGOI_ID        WHERE G.BENHVIEN_ID = 'HLU01' AND L.DICTIONARY_TYPE_CODE = 'LoaiGoiDV'         AND L.DICTIONARY_CODE = 'KhamSucKhoe' AND G.TRANGTHAI = 'GOIDUOCPHEPBAN']
2019-08-26 13:49:12,086 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2019-08-26 13:49:12,428 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-08-26 13:49:12,457 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-08-26 13:49:12,574 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 13:49:13,123 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-08-26 13:49:19,326 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2019-08-26 13:49:19,433 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-08-26 13:49:21,172 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-08-26 13:49:21,308 [14] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-08-26 13:49:21,805 [14] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2019-08-26 13:49:21,880 [14] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2019-08-26 13:49:21,967 [14] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2019-08-26 13:49:22,046 [14] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2019-08-26 13:49:22,152 [14] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2019-08-26 13:49:22,265 [14] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2019-08-26 13:49:22,380 [14] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2019-08-26 13:49:22,476 [14] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2019-08-26 13:49:22,565 [14] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2019-08-26 13:49:23,062 [14] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2019-08-26 13:49:23,094 [14] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2019-08-26 13:49:23,165 [14] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2019-08-26 13:49:23,200 [14] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2019-08-26 13:49:24,696 [14] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2019-08-26 13:49:24,730 [14] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 0 as PHAMVI_ID, 0 as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0         end                else        begin        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2019-08-26 13:49:26,909 [14] DEBUG - Statement Id: [DAO00320_GetList] PreparedStatement : [select M.*            from TM_MAU M            LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID            where            M.TAMNGUNG = '0'            and M.BENHVIEN_ID = 'HLU01'            order by M.TENMAU]
2019-08-26 13:49:26,982 [14] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2019-08-26 13:49:27,047 [14] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT          TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,          TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,          SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH          FROM TT_MAU_TONKHO TK          JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID          JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID          JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'          LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID          LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID          WHERE TK.SOLUONG > 0          GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,          TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2019-08-26 13:49:27,172 [14] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2019-08-26 13:49:27,368 [14] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct          TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,          TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,          TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH          from TM_MAU M          JOIN          (          select          A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO          from          (          select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO          from TT_MAU_TONKHO TK          JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID          inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID          left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'          where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0          ) A          )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'          LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID          LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2019-08-26 13:49:27,440 [14] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2019-08-26 13:49:28,358 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 13:49:28,453 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2019-08-26 13:49:28,505 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2019-08-26 13:49:28,530 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2019-08-26 13:49:28,610 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 13:49:28,800 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 13:49:28,899 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2019-08-26 13:49:28,899 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-08-26 13:49:28,900 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-08-26 13:49:28,941 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2019-08-26 13:49:28,941 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-08-26 13:49:28,941 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-08-26 13:49:29,038 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 13:49:29,192 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 13:49:30,081 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 13:49:30,179 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2019-08-26 13:49:30,377 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2019-08-26 13:51:15,514 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'HSM27'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 13:51:16,175 [1] DEBUG - Statement Id: [DAO00307_GetContractWithDate] PreparedStatement : [SELECT HD.*, HD.SO_HD + ' - ' + CT.TENCONGTY AS HOPDONG, CT.TENCONGTY        FROM TT_KSK_HOPDONG HD JOIN TT_KSK_CONGTY CT ON CT.CONGTY_ID = HD.CONGTY_ID         where               HD.BENHVIEN_ID = 'HLU01']
2019-08-26 13:51:19,694 [1] DEBUG - Statement Id: [DAO00329_GetList_BenhNhan_KSK] PreparedStatement : [select * from(select COUNT(*) OVER() as TOTALROWS,ROW_NUMBER() OVER (ORDER BY a.MAYTE) as ROWNUMBER, * from        (SELECT distinct BN.MAYTE,BN.TENBENHNHAN,BN.BENHNHAN_ID,BNDV.TIEPNHAN_ID,DV.MADICHVU        ,Case when BN.GIOITINH =1 then N'Nam' else N'Nữ' end as GIOITINH,BNDV.DVYEUCAU_ID,BNDV.PHONGBAN_ID as NOITHUCHIEN_ID        ,CONVERT(varchar(20), BN.NGAYSINH, 103) AS NGAYSINH,DV.TENDICHVU,PB.TENPHONGBAN as TENPHONGKHAM,CT.TENCONGTY,BNDV.SOPHIEUYEUCAU        ,HD.SO_HD,TN.SOTIEPNHAN,TN.NGUOITAO_ID,BNDV.DICHVU_ID        FROM TT_KSK_CONGTY CT        left join TT_KSK_HOPDONG HD ON HD.CONGTY_ID=CT.CONGTY_ID        left join TT_KSK_HOPDONG_BENHNHAN BN ON BN.HOPDONG_ID=HD.HOPDONG_ID        left join TT_KSK_HOPDONG_BENHNHAN_DICHVU BNDV ON BNDV.HOPDONG_BENHNHAN_ID=BN.HOPDONG_BENHNHAN_ID        left join TT_KSK_HOPDONG_GOIDICHVU GDV ON GDV.HOPDONG_ID= BN.HOPDONG_ID        left join TM_DICHVU DV ON DV.DICHVU_ID=BNDV.DICHVU_ID        left join TM_PHONGBAN PB ON PB.PHONGBAN_ID=BNDV.PHONGBAN_ID        join TT_TIEPNHAN TN ON TN.TIEPNHAN_ID=BNDV.TIEPNHAN_ID        where BNDV.TRANGTHAI='DAXACNHAN' AND HD.BENHVIEN_ID = 'HLU01' AND BNDV.PHONGBAN_ID='5'        AND BNDV.DATHUCHIEN IS NULL)a )b        where b.ROWNUMBER between '1' AND '20']
2019-08-26 13:51:33,809 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM98'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 13:51:34,704 [1] DEBUG - Statement Id: [DAO00020_ListKhoDuocOfPhongBan] PreparedStatement : [select B.* from TM_PHONGBAN_KHODUOC A        inner join TM_KHODUOC B on B.KHODUOC_ID = A.KHODUOC_ID        where        A.PHONGBAN_ID = '5'        and A.BENHVIEN_ID = 'HLU01']
2019-08-26 13:51:39,975 [1] DEBUG - Statement Id: [DAO00020_ListKhoDuocOfPhongBan] PreparedStatement : [select B.* from TM_PHONGBAN_KHODUOC A        inner join TM_KHODUOC B on B.KHODUOC_ID = A.KHODUOC_ID        where        A.PHONGBAN_ID = '177'        and A.BENHVIEN_ID = 'HLU01']
2019-08-26 13:51:40,124 [1] DEBUG - Statement Id: [DAO00008_UpdateUserIdPhongBanKhoDuoc] PreparedStatement : [IF EXISTS            (SELECT ACCOUNT_ID FROM TM_SYS_USERS WHERE ACCOUNT_ID =  @param0  and HOSPITAL_ID =  @param1 )            BEGIN            update TM_SYS_USERS set INVENTORY_ID =  @param2 , WORKING_DEPT_ID =  @param3             WHERE ACCOUNT_ID =  @param0  and HOSPITAL_ID =  @param1             END            ELSE            BEGIN            insert into TM_SYS_USERS ([ACCOUNT_ID], [ACCOUNT_NAME], [INVENTORY_ID], [WORKING_DEPT_ID], [HOSPITAL_ID])            values ( @param0 ,  @param4 ,  @param2 ,  @param3 ,  @param1 )            END]
2019-08-26 13:51:40,124 [1] DEBUG - Statement Id: [DAO00008_UpdateUserIdPhongBanKhoDuoc] Parameters: [@param0=[ACCOUNT_ID,113], @param1=[HOSPITAL_ID,HLU01], @param2=[INVENTORY_ID,null], @param3=[WORKING_DEPT_ID,177], @param4=[ACCOUNT_NAME,admin]]
2019-08-26 13:51:40,124 [1] DEBUG - Statement Id: [DAO00008_UpdateUserIdPhongBanKhoDuoc] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[String, System.String]]
2019-08-26 13:51:46,343 [1] DEBUG - Statement Id: [DAO00307_GetContractWithDate] PreparedStatement : [SELECT HD.*, HD.SO_HD + ' - ' + CT.TENCONGTY AS HOPDONG, CT.TENCONGTY        FROM TT_KSK_HOPDONG HD JOIN TT_KSK_CONGTY CT ON CT.CONGTY_ID = HD.CONGTY_ID         where               HD.BENHVIEN_ID = 'HLU01']
2019-08-26 13:51:51,085 [1] DEBUG - Statement Id: [DAO00329_GetList_BenhNhan_KSK] PreparedStatement : [select * from(select COUNT(*) OVER() as TOTALROWS,ROW_NUMBER() OVER (ORDER BY a.MAYTE) as ROWNUMBER, * from        (SELECT distinct BN.MAYTE,BN.TENBENHNHAN,BN.BENHNHAN_ID,BNDV.TIEPNHAN_ID,DV.MADICHVU        ,Case when BN.GIOITINH =1 then N'Nam' else N'Nữ' end as GIOITINH,BNDV.DVYEUCAU_ID,BNDV.PHONGBAN_ID as NOITHUCHIEN_ID        ,CONVERT(varchar(20), BN.NGAYSINH, 103) AS NGAYSINH,DV.TENDICHVU,PB.TENPHONGBAN as TENPHONGKHAM,CT.TENCONGTY,BNDV.SOPHIEUYEUCAU        ,HD.SO_HD,TN.SOTIEPNHAN,TN.NGUOITAO_ID,BNDV.DICHVU_ID        FROM TT_KSK_CONGTY CT        left join TT_KSK_HOPDONG HD ON HD.CONGTY_ID=CT.CONGTY_ID        left join TT_KSK_HOPDONG_BENHNHAN BN ON BN.HOPDONG_ID=HD.HOPDONG_ID        left join TT_KSK_HOPDONG_BENHNHAN_DICHVU BNDV ON BNDV.HOPDONG_BENHNHAN_ID=BN.HOPDONG_BENHNHAN_ID        left join TT_KSK_HOPDONG_GOIDICHVU GDV ON GDV.HOPDONG_ID= BN.HOPDONG_ID        left join TM_DICHVU DV ON DV.DICHVU_ID=BNDV.DICHVU_ID        left join TM_PHONGBAN PB ON PB.PHONGBAN_ID=BNDV.PHONGBAN_ID        join TT_TIEPNHAN TN ON TN.TIEPNHAN_ID=BNDV.TIEPNHAN_ID        where BNDV.TRANGTHAI='DAXACNHAN' AND HD.BENHVIEN_ID = 'HLU01' AND BNDV.PHONGBAN_ID='177'        AND BNDV.DATHUCHIEN IS NULL)a )b        where b.ROWNUMBER between '1' AND '20']
2019-08-26 13:51:55,962 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'HSM20'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 13:51:56,261 [1] DEBUG - Statement Id: [DAO00308_GetList] PreparedStatement : [select DICTIONARY_ID, DICTIONARY_CODE, DICTIONARY_NAME        from LST_DICTIONARY        where DICTIONARY_TYPE_CODE = 'PhanLoaiKSK'         and           BENHVIEN_ID = 'HLU01']
2019-08-26 13:51:56,843 [1] DEBUG - Statement Id: [DAO00309_GetList] PreparedStatement : [select DICTIONARY_ID, DICTIONARY_CODE, DICTIONARY_NAME        from LST_DICTIONARY        where DICTIONARY_TYPE_CODE = 'XepLoaiKSK'         and           BENHVIEN_ID = 'HLU01']
2019-08-26 13:51:57,599 [1] DEBUG - Statement Id: [DAO00328_GetListTiepNhanAll] PreparedStatement : [select distinct A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        B.*, HD.SO_HD + ' - ' + CT.TENCONGTY as TENHOPDONG, G.DESCRIPTION as GENDER, DT.TENDOITUONG, N.DICTIONARY_NAME as NGHENGHIEP        , case when B.NGAYSINH is null then convert(varchar(4),B.NAMSINH) else convert(varchar(10),B.NGAYSINH,103) end as NGAYTHANGNAMSINH        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN') and B.ACTIVE = '1'        inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.BENHNHAN_ID = B.BENHNHAN_ID        inner join TT_KSK_HOPDONG HD on HD.HOPDONG_ID = HD_BN.HOPDONG_ID        inner join TT_KSK_CONGTY CT on CT.CONGTY_ID = HD.CONGTY_ID        inner join TM_GENDER G on G.ID = B.GIOITINH        inner join TM_DOITUONG DT on DT.DOITUONG_ID = A.DOITUONG_ID        left join LST_DICTIONARY N on N.DICTIONARY_ID = HD_BN.NGHENGHIEP_ID and N.DICTIONARY_TYPE_CODE = 'NgheNghiep'        where A.BENHVIEN_ID = 'HLU01' and HD.KHOA = '0' and CT.TAMNGUNG = '0']
2019-08-26 13:51:57,857 [1] DEBUG - Statement Id: [DAO00328_GetPatientId] PreparedStatement : [select BN.*, KQ.KETQUA_ID        from TT_KSK_HOPDONG_BENHNHAN BN        left join TT_KSK_KETQUA KQ on KQ.HOPDONG_BENHNHAN_ID = BN.HOPDONG_BENHNHAN_ID         where                 BN.BENHNHAN_ID = 23420             and               BN.BENHVIEN_ID = 'HLU01']
2019-08-26 13:51:57,946 [1] DEBUG - Statement Id: [DAO00329_Insert_Data] PreparedStatement : [DECLARE @CHECK int        IF (SELECT COUNT(*) FROM TT_KSK_KETQUA WHERE HOPDONG_ID=3 AND HOPDONG_BENHNHAN_ID=203) = 0        BEGIN        INSERT INTO TT_KSK_KETQUA (TIEPNHAN_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values( @param0 , @param1 , @param2 , @param3 );        SET @CHECK = (SELECT SCOPE_IDENTITY())        INSERT INTO TT_KSK_KETQUA_NOI(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_NGOAI(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_DALIEU(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_PHUKHOA(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_RHM(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_TMH(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_MAT(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        END        ELSE        BEGIN        RETURN        END;]
2019-08-26 13:51:57,946 [1] DEBUG - Statement Id: [DAO00329_Insert_Data] Parameters: [@param0=[TIEPNHAN_ID,27475], @param1=[HOPDONG_ID,3], @param2=[HOPDONG_BENHNHAN_ID,203], @param3=[BENHVIEN_ID,HLU01]]
2019-08-26 13:51:57,946 [1] DEBUG - Statement Id: [DAO00329_Insert_Data] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64], @param2=[Int64, System.Int64], @param3=[String, System.String]]
2019-08-26 13:51:58,333 [1] DEBUG - Statement Id: [DAO00309_GhiChu] PreparedStatement : [select GHICHU from TT_KSK_HOPDONG_BENHNHAN where HOPDONG_BENHNHAN_ID = 203]
2019-08-26 13:51:58,388 [1] DEBUG - Statement Id: [DAO00328_GetKetQuaKSK] PreparedStatement : [SELECT KQ.KETQUA_ID,KQ.TIEPNHAN_ID,KQ.HOPDONG_ID,KQ.HOPDONG_BENHNHAN_ID,SH.MACH,SH.CANNANG,SH.CHIEUCAO,SH.HUYETAPCAO,SH.HUYETAPTHAP,SH.NHIPTHO,SH.NHIETDO,SH.CHISOBMI AS BMI        ,N.TUANHOAN,N.PLTUANHOAN_ID,N.HOHAP,n.PLHOHAP_ID,N.TIEUHOA,N.PLTIEUHOA_ID,N.THAN,N.PLTHAN_ID,N.NOITIET,N.PLNOITIET_ID        ,N.COXUONGKHOP,N.PLCOXUONGKHOP_ID,N.THANKINH,N.PLTHANKINH_ID,N.TAMTHAN,N.PLTAMTHAN_ID,N.BACSIKHAMNOI_ID,NG.NGOAIKHOA        ,NG.PLNGOAIKHOA_ID,NG.BACSINGOAIKHOA_ID,PK.SANPHUKHOA,PK.PLSANPHUKHOA_ID,PK.BACSISANPHUKHOA_ID,MAT.COKINHMATTRAI        ,MAT.COKINHMATPHAI,MAT.KHONGKINHMATTRAI,MAT.KHONGKINHMATPHAI,MAT.CACBENHVEMAT,MAT.PLMAT_ID,MAT.BACSIMAT_ID        ,TMH.TAITRAINOITHUONG,TMH.TAITRAINOITHAM,TMH.TAIPHAINOITHUONG,TMH.TAIPHAINOITHAM,TMH.CACBENHVETAI,TMH.PLTAIMH_ID,TMH.BACSITMH_ID        ,RHM.HAMTREN,RHM.HAMDUOI,RHM.CACBENHVERHM,RHM.PLRHM_ID,RHM.BACSIRHM_ID,DL.DALIEU,DL.PLDALIEU_ID,DL.BACSIDALIEU_ID        ,KQ.BACSIKETLUAN_ID,KQ.NHANXET,KQ.XEPLOAI_ID,KQ.TENICD        FROM TT_KSK_KETQUA KQ        LEFT JOIN TT_KSK_KETQUA_NOI N ON KQ.KETQUA_ID = N.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_NGOAI NG ON N.KETQUA_ID=NG.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_MAT MAT ON NG.KETQUA_ID=MAT.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_PHUKHOA PK ON MAT.KETQUA_ID=PK.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_RHM RHM ON PK.HOPDONG_BENHNHAN_ID=RHM.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_TMH TMH ON RHM.KETQUA_ID=TMH.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_DALIEU DL ON TMH.KETQUA_ID=DL.KETQUA_ID        LEFT JOIN TT_NGOAITRU_KHAMBENH_SINHHIEU SH ON KQ.TIEPNHAN_ID = SH.TIEPNHAN_ID        where (DL.HOPDONG_BENHNHAN_ID  = 203 and DL.BENHVIEN_ID = 'HLU01')        OR (KQ.HOPDONG_BENHNHAN_ID  = 203 and KQ.BENHVIEN_ID = 'HLU01')        OR (N.HOPDONG_BENHNHAN_ID  = 203 and N.BENHVIEN_ID = 'HLU01')        OR (NG.HOPDONG_BENHNHAN_ID  = 203 and NG.BENHVIEN_ID = 'HLU01')        OR (RHM.HOPDONG_BENHNHAN_ID  = 203 and RHM.BENHVIEN_ID = 'HLU01')        OR (MAT.HOPDONG_BENHNHAN_ID  = 203 and MAT.BENHVIEN_ID = 'HLU01')        OR (PK.HOPDONG_BENHNHAN_ID  = 203 and PK.BENHVIEN_ID = 'HLU01')        OR (TMH.HOPDONG_BENHNHAN_ID  = 203 and TMH.BENHVIEN_ID = 'HLU01')]
2019-08-26 13:51:58,689 [1] DEBUG - Statement Id: [DAO00328_GetPatientId] PreparedStatement : [select BN.*, KQ.KETQUA_ID        from TT_KSK_HOPDONG_BENHNHAN BN        left join TT_KSK_KETQUA KQ on KQ.HOPDONG_BENHNHAN_ID = BN.HOPDONG_BENHNHAN_ID         where                 BN.BENHNHAN_ID = 23420             and               BN.BENHVIEN_ID = 'HLU01']
2019-08-26 13:51:59,150 [1] DEBUG - Statement Id: [DAO00329_Insert_Data] PreparedStatement : [DECLARE @CHECK int        IF (SELECT COUNT(*) FROM TT_KSK_KETQUA WHERE HOPDONG_ID=3 AND HOPDONG_BENHNHAN_ID=203) = 0        BEGIN        INSERT INTO TT_KSK_KETQUA (TIEPNHAN_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values( @param0 , @param1 , @param2 , @param3 );        SET @CHECK = (SELECT SCOPE_IDENTITY())        INSERT INTO TT_KSK_KETQUA_NOI(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_NGOAI(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_DALIEU(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_PHUKHOA(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_RHM(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_TMH(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_MAT(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        END        ELSE        BEGIN        RETURN        END;]
2019-08-26 13:51:59,150 [1] DEBUG - Statement Id: [DAO00329_Insert_Data] Parameters: [@param0=[TIEPNHAN_ID,27475], @param1=[HOPDONG_ID,3], @param2=[HOPDONG_BENHNHAN_ID,203], @param3=[BENHVIEN_ID,HLU01]]
2019-08-26 13:51:59,150 [1] DEBUG - Statement Id: [DAO00329_Insert_Data] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64], @param2=[Int64, System.Int64], @param3=[String, System.String]]
2019-08-26 13:51:59,192 [1] DEBUG - Statement Id: [DAO00309_GhiChu] PreparedStatement : [select GHICHU from TT_KSK_HOPDONG_BENHNHAN where HOPDONG_BENHNHAN_ID = 203]
2019-08-26 13:51:59,243 [1] DEBUG - Statement Id: [DAO00328_GetKetQuaKSK] PreparedStatement : [SELECT KQ.KETQUA_ID,KQ.TIEPNHAN_ID,KQ.HOPDONG_ID,KQ.HOPDONG_BENHNHAN_ID,SH.MACH,SH.CANNANG,SH.CHIEUCAO,SH.HUYETAPCAO,SH.HUYETAPTHAP,SH.NHIPTHO,SH.NHIETDO,SH.CHISOBMI AS BMI        ,N.TUANHOAN,N.PLTUANHOAN_ID,N.HOHAP,n.PLHOHAP_ID,N.TIEUHOA,N.PLTIEUHOA_ID,N.THAN,N.PLTHAN_ID,N.NOITIET,N.PLNOITIET_ID        ,N.COXUONGKHOP,N.PLCOXUONGKHOP_ID,N.THANKINH,N.PLTHANKINH_ID,N.TAMTHAN,N.PLTAMTHAN_ID,N.BACSIKHAMNOI_ID,NG.NGOAIKHOA        ,NG.PLNGOAIKHOA_ID,NG.BACSINGOAIKHOA_ID,PK.SANPHUKHOA,PK.PLSANPHUKHOA_ID,PK.BACSISANPHUKHOA_ID,MAT.COKINHMATTRAI        ,MAT.COKINHMATPHAI,MAT.KHONGKINHMATTRAI,MAT.KHONGKINHMATPHAI,MAT.CACBENHVEMAT,MAT.PLMAT_ID,MAT.BACSIMAT_ID        ,TMH.TAITRAINOITHUONG,TMH.TAITRAINOITHAM,TMH.TAIPHAINOITHUONG,TMH.TAIPHAINOITHAM,TMH.CACBENHVETAI,TMH.PLTAIMH_ID,TMH.BACSITMH_ID        ,RHM.HAMTREN,RHM.HAMDUOI,RHM.CACBENHVERHM,RHM.PLRHM_ID,RHM.BACSIRHM_ID,DL.DALIEU,DL.PLDALIEU_ID,DL.BACSIDALIEU_ID        ,KQ.BACSIKETLUAN_ID,KQ.NHANXET,KQ.XEPLOAI_ID,KQ.TENICD        FROM TT_KSK_KETQUA KQ        LEFT JOIN TT_KSK_KETQUA_NOI N ON KQ.KETQUA_ID = N.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_NGOAI NG ON N.KETQUA_ID=NG.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_MAT MAT ON NG.KETQUA_ID=MAT.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_PHUKHOA PK ON MAT.KETQUA_ID=PK.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_RHM RHM ON PK.HOPDONG_BENHNHAN_ID=RHM.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_TMH TMH ON RHM.KETQUA_ID=TMH.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_DALIEU DL ON TMH.KETQUA_ID=DL.KETQUA_ID        LEFT JOIN TT_NGOAITRU_KHAMBENH_SINHHIEU SH ON KQ.TIEPNHAN_ID = SH.TIEPNHAN_ID        where (DL.HOPDONG_BENHNHAN_ID  = 203 and DL.BENHVIEN_ID = 'HLU01')        OR (KQ.HOPDONG_BENHNHAN_ID  = 203 and KQ.BENHVIEN_ID = 'HLU01')        OR (N.HOPDONG_BENHNHAN_ID  = 203 and N.BENHVIEN_ID = 'HLU01')        OR (NG.HOPDONG_BENHNHAN_ID  = 203 and NG.BENHVIEN_ID = 'HLU01')        OR (RHM.HOPDONG_BENHNHAN_ID  = 203 and RHM.BENHVIEN_ID = 'HLU01')        OR (MAT.HOPDONG_BENHNHAN_ID  = 203 and MAT.BENHVIEN_ID = 'HLU01')        OR (PK.HOPDONG_BENHNHAN_ID  = 203 and PK.BENHVIEN_ID = 'HLU01')        OR (TMH.HOPDONG_BENHNHAN_ID  = 203 and TMH.BENHVIEN_ID = 'HLU01')]
2019-08-26 13:52:22,702 [1] DEBUG - Statement Id: [DAO00329_GETKETQUA_MAT] PreparedStatement : [SELECT * FROM TT_KSK_KETQUA_MAT        where HOPDONG_ID=3 AND HOPDONG_BENHNHAN_ID=203 AND BENHVIEN_ID='HLU01']
2019-08-26 13:52:22,953 [1] DEBUG - Statement Id: [DAO00329_Update_KETQUA_MAT] PreparedStatement : [UPDATE TT_KSK_KETQUA_MAT        SET HOPDONG_ID =  @param0 ,HOPDONG_BENHNHAN_ID =  @param1 ,COKINHMATTRAI =  @param2         ,COKINHMATPHAI =  @param3 ,KHONGKINHMATTRAI =  @param4 ,KHONGKINHMATPHAI =  @param5         ,CACBENHVEMAT =  @param6 ,PLMAT_ID =  @param7 ,BACSIMAT_ID =  @param8 ,BENHVIEN_ID =  @param9         ,NGAYTAO =  @param10 ,NGUOITAO_ID =  @param11 ,NGAYCAPNHAT =  @param12 ,NGUOICAPNHAT_ID =  @param13         WHERE HOPDONG_ID = 3 AND HOPDONG_BENHNHAN_ID = 203 AND BENHVIEN_ID='HLU01']
2019-08-26 13:52:22,953 [1] DEBUG - Statement Id: [DAO00329_Update_KETQUA_MAT] Parameters: [@param0=[HOPDONG_ID,3], @param1=[HOPDONG_BENHNHAN_ID,203], @param2=[COKINHMATTRAI,10], @param3=[COKINHMATPHAI,10], @param4=[KHONGKINHMATTRAI,10], @param5=[KHONGKINHMATPHAI,10], @param6=[CACBENHVEMAT,test], @param7=[PLMAT_ID,11694], @param8=[BACSIMAT_ID,398], @param9=[BENHVIEN_ID,HLU01], @param10=[NGAYTAO,null], @param11=[NGUOITAO_ID,null], @param12=[NGAYCAPNHAT,8/26/2019 1:52:22 PM], @param13=[NGUOICAPNHAT_ID,1]]
2019-08-26 13:52:22,953 [1] DEBUG - Statement Id: [DAO00329_Update_KETQUA_MAT] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64], @param2=[Int64, System.Int64], @param3=[Int64, System.Int64], @param4=[Int64, System.Int64], @param5=[Int64, System.Int64], @param6=[String, System.String], @param7=[Int64, System.Int64], @param8=[Int64, System.Int64], @param9=[String, System.String], @param10=[System.DBNull, null], @param11=[System.DBNull, null], @param12=[DateTime, System.DateTime], @param13=[Int64, System.Int64]]
2019-08-26 13:52:22,991 [1] DEBUG - Statement Id: [DAO00329_Update_KB] PreparedStatement : [UPDATE TT_KSK_HOPDONG_BENHNHAN_DICHVU SET DATHUCHIEN='DATHUCHIEN' where HOPDONG_BENHNHAN_ID= 203 AND DICHVU_ID=5435 AND TRANGTHAI= 'DAXACNHAN']
2019-08-26 13:52:34,520 [1] DEBUG - Statement Id: [DAO00020_ListKhoDuocOfPhongBan] PreparedStatement : [select B.* from TM_PHONGBAN_KHODUOC A        inner join TM_KHODUOC B on B.KHODUOC_ID = A.KHODUOC_ID        where        A.PHONGBAN_ID = ''        and A.BENHVIEN_ID = 'HLU01']
2019-08-26 13:52:34,859 [1] DEBUG - Statement Id: [DAO00020_ListKhoDuocOfPhongBan] PreparedStatement : [select B.* from TM_PHONGBAN_KHODUOC A        inner join TM_KHODUOC B on B.KHODUOC_ID = A.KHODUOC_ID        where        A.PHONGBAN_ID = '177'        and A.BENHVIEN_ID = 'HLU01']
2019-08-26 13:52:38,178 [1] DEBUG - Statement Id: [DAO00020_ListKhoDuocOfPhongBan] PreparedStatement : [select B.* from TM_PHONGBAN_KHODUOC A        inner join TM_KHODUOC B on B.KHODUOC_ID = A.KHODUOC_ID        where        A.PHONGBAN_ID = '27'        and A.BENHVIEN_ID = 'HLU01']
2019-08-26 13:52:38,318 [1] DEBUG - Statement Id: [DAO00008_UpdateUserIdPhongBanKhoDuoc] PreparedStatement : [IF EXISTS            (SELECT ACCOUNT_ID FROM TM_SYS_USERS WHERE ACCOUNT_ID =  @param0  and HOSPITAL_ID =  @param1 )            BEGIN            update TM_SYS_USERS set INVENTORY_ID =  @param2 , WORKING_DEPT_ID =  @param3             WHERE ACCOUNT_ID =  @param0  and HOSPITAL_ID =  @param1             END            ELSE            BEGIN            insert into TM_SYS_USERS ([ACCOUNT_ID], [ACCOUNT_NAME], [INVENTORY_ID], [WORKING_DEPT_ID], [HOSPITAL_ID])            values ( @param0 ,  @param4 ,  @param2 ,  @param3 ,  @param1 )            END]
2019-08-26 13:52:38,318 [1] DEBUG - Statement Id: [DAO00008_UpdateUserIdPhongBanKhoDuoc] Parameters: [@param0=[ACCOUNT_ID,113], @param1=[HOSPITAL_ID,HLU01], @param2=[INVENTORY_ID,27], @param3=[WORKING_DEPT_ID,27], @param4=[ACCOUNT_NAME,admin]]
2019-08-26 13:52:38,318 [1] DEBUG - Statement Id: [DAO00008_UpdateUserIdPhongBanKhoDuoc] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[String, System.String], @param3=[String, System.String], @param4=[String, System.String]]
2019-08-26 13:52:41,434 [1] DEBUG - Statement Id: [DAO00020_ListKhoDuocOfPhongBan] PreparedStatement : [select B.* from TM_PHONGBAN_KHODUOC A        inner join TM_KHODUOC B on B.KHODUOC_ID = A.KHODUOC_ID        where        A.PHONGBAN_ID = ''        and A.BENHVIEN_ID = 'HLU01']
2019-08-26 13:52:41,763 [1] DEBUG - Statement Id: [DAO00020_ListKhoDuocOfPhongBan] PreparedStatement : [select B.* from TM_PHONGBAN_KHODUOC A        inner join TM_KHODUOC B on B.KHODUOC_ID = A.KHODUOC_ID        where        A.PHONGBAN_ID = '27'        and A.BENHVIEN_ID = 'HLU01']
2019-08-26 13:52:47,215 [1] DEBUG - Statement Id: [DAO00008_UpdateUserIdPhongBanKhoDuoc] PreparedStatement : [IF EXISTS            (SELECT ACCOUNT_ID FROM TM_SYS_USERS WHERE ACCOUNT_ID =  @param0  and HOSPITAL_ID =  @param1 )            BEGIN            update TM_SYS_USERS set INVENTORY_ID =  @param2 , WORKING_DEPT_ID =  @param3             WHERE ACCOUNT_ID =  @param0  and HOSPITAL_ID =  @param1             END            ELSE            BEGIN            insert into TM_SYS_USERS ([ACCOUNT_ID], [ACCOUNT_NAME], [INVENTORY_ID], [WORKING_DEPT_ID], [HOSPITAL_ID])            values ( @param0 ,  @param4 ,  @param2 ,  @param3 ,  @param1 )            END]
2019-08-26 13:52:47,215 [1] DEBUG - Statement Id: [DAO00008_UpdateUserIdPhongBanKhoDuoc] Parameters: [@param0=[ACCOUNT_ID,113], @param1=[HOSPITAL_ID,HLU01], @param2=[INVENTORY_ID,27], @param3=[WORKING_DEPT_ID,27], @param4=[ACCOUNT_NAME,admin]]
2019-08-26 13:52:47,215 [1] DEBUG - Statement Id: [DAO00008_UpdateUserIdPhongBanKhoDuoc] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[String, System.String], @param3=[String, System.String], @param4=[String, System.String]]
2019-08-26 13:53:01,786 [1] DEBUG - Statement Id: [DAO00307_GetContractWithDate] PreparedStatement : [SELECT HD.*, HD.SO_HD + ' - ' + CT.TENCONGTY AS HOPDONG, CT.TENCONGTY        FROM TT_KSK_HOPDONG HD JOIN TT_KSK_CONGTY CT ON CT.CONGTY_ID = HD.CONGTY_ID         where               HD.BENHVIEN_ID = 'HLU01']
2019-08-26 13:53:01,893 [1] DEBUG - Statement Id: [DAO00329_GetList_BenhNhan_KSK] PreparedStatement : [select * from(select COUNT(*) OVER() as TOTALROWS,ROW_NUMBER() OVER (ORDER BY a.MAYTE) as ROWNUMBER, * from        (SELECT distinct BN.MAYTE,BN.TENBENHNHAN,BN.BENHNHAN_ID,BNDV.TIEPNHAN_ID,DV.MADICHVU        ,Case when BN.GIOITINH =1 then N'Nam' else N'Nữ' end as GIOITINH,BNDV.DVYEUCAU_ID,BNDV.PHONGBAN_ID as NOITHUCHIEN_ID        ,CONVERT(varchar(20), BN.NGAYSINH, 103) AS NGAYSINH,DV.TENDICHVU,PB.TENPHONGBAN as TENPHONGKHAM,CT.TENCONGTY,BNDV.SOPHIEUYEUCAU        ,HD.SO_HD,TN.SOTIEPNHAN,TN.NGUOITAO_ID,BNDV.DICHVU_ID        FROM TT_KSK_CONGTY CT        left join TT_KSK_HOPDONG HD ON HD.CONGTY_ID=CT.CONGTY_ID        left join TT_KSK_HOPDONG_BENHNHAN BN ON BN.HOPDONG_ID=HD.HOPDONG_ID        left join TT_KSK_HOPDONG_BENHNHAN_DICHVU BNDV ON BNDV.HOPDONG_BENHNHAN_ID=BN.HOPDONG_BENHNHAN_ID        left join TT_KSK_HOPDONG_GOIDICHVU GDV ON GDV.HOPDONG_ID= BN.HOPDONG_ID        left join TM_DICHVU DV ON DV.DICHVU_ID=BNDV.DICHVU_ID        left join TM_PHONGBAN PB ON PB.PHONGBAN_ID=BNDV.PHONGBAN_ID        join TT_TIEPNHAN TN ON TN.TIEPNHAN_ID=BNDV.TIEPNHAN_ID        where BNDV.TRANGTHAI='DAXACNHAN' AND HD.BENHVIEN_ID = 'HLU01' AND BNDV.PHONGBAN_ID='27'        AND BNDV.DATHUCHIEN IS NULL)a )b        where b.ROWNUMBER between '1' AND '20']
2019-08-26 13:53:06,077 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'REG14'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 13:53:07,684 [1] DEBUG - Statement Id: [DAO00012_GetList] PreparedStatement : [select        DICTIONARY_ID,        DICTIONARY_CODE,        DICTIONARY_NAME,        ATTRIBUTE1,        ATTRIBUTE2,        DICTIONARY_NAME_EN        from LST_DICTIONARY        where LST_DICTIONARY.Enabled = '1'         AND           LST_DICTIONARY.DICTIONARY_TYPE_CODE = 'PhanLoaiTiepNhan'                 order by LST_DICTIONARY.IDX]
2019-08-26 13:53:07,748 [1] DEBUG - Statement Id: [DAO00012_GetList] PreparedStatement : [select        DICTIONARY_ID,        DICTIONARY_CODE,        DICTIONARY_NAME,        ATTRIBUTE1,        ATTRIBUTE2,        DICTIONARY_NAME_EN        from LST_DICTIONARY        where LST_DICTIONARY.Enabled = '1'         AND           LST_DICTIONARY.DICTIONARY_TYPE_CODE = 'NguonBN'                 order by LST_DICTIONARY.IDX]
2019-08-26 13:53:07,778 [1] DEBUG - Statement Id: [DAO00019_GetListCongTyChiTra] PreparedStatement : [select *        from TM_CONGTYCHITRA        where        BENHVIEN_ID = 'HLU01' AND TAMNGUNG = '0']
2019-08-26 13:53:07,955 [1] DEBUG - Statement Id: [DAO00017_GetListPhongKham] PreparedStatement : [select pb.PHONGBAN_ID, pb.TENPHONGBAN, case when dv.ATTRIBUTE5 is null then 'TT' else 'KTC' end as LOAI_CHIPHI              from [TM_PHONGBAN_DICHVU] as pb_dv              inner join [TM_PHONGBAN] as pb on pb.PHONGBAN_ID = pb_dv.PHONGBAN_ID and pb.BENHVIEN_ID = 'HLU01'              inner join [TM_DICHVU] dv on dv.DICHVU_ID = pb_dv.DICHVU_ID and dv.MADICHVU = '' and dv.BENHVIEN_ID = 'HLU01'              where pb_dv.BENHVIEN_ID = 'HLU01']
2019-08-26 13:53:07,995 [1] DEBUG - Statement Id: [DAO00019_GetListPhongKham_REG13] PreparedStatement : [select pb.PHONGBAN_ID, pb.TENPHONGBAN, case when dv.ATTRIBUTE5 is null then 'TT' else 'KTC' end as LOAI_CHIPHI        from TM_PHONGBAN pb        left join TM_PHONGBAN_DICHVU pb_dv on pb_dv.PHONGBAN_ID = pb.PHONGBAN_ID and pb_dv.BENHVIEN_ID = pb.BENHVIEN_ID        left join TM_DICHVU dv on dv.DICHVU_ID = pb_dv.DICHVU_ID and dv.BENHVIEN_ID = pb_dv.BENHVIEN_ID        left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID and ndv.BENHVIEN_ID = dv.BENHVIEN_ID        where pb.BENHVIEN_ID = 'HLU01' and ndv.MANHOMDICHVU = '04' and dv.DICHVU_ID IS NOT NULL]
2019-08-26 13:53:08,090 [1] DEBUG - Statement Id: [DAO00019_LayThongTinSoluongDichVuPhongKham_REG13] PreparedStatement : [select PHONGBAN_ID, TENPHONGBAN, NOITHUCHIEN_ID, SUM(CHUAKETQUA) AS CHUAKETQUA, SUM(HOANTAT) AS HOANTAT, SUM(DANGTHUCHIEN) AS DANGTHUCHIEN        from (        select B.PHONGBAN_ID, B.TENPHONGBAN, A.NOITHUCHIEN_ID,        case when A.TRANGTHAI = 'CHUAKETQUA' then 1 else 0 end AS CHUAKETQUA,        case when A.TRANGTHAI = 'HOANTAT' then 1 else 0 end AS HOANTAT,        case when A.TRANGTHAI = 'DANGTHUCHIEN' then 1 else 0 end AS DANGTHUCHIEN        from TM_PHONGBAN B        left join TT_DVYEUCAU A on A.NOITHUCHIEN_ID = B.PHONGBAN_ID and A.BENHVIEN_ID = B.BENHVIEN_ID and A.NGAYYEUCAU = CONVERT(date, getdate())        left join TM_DICHVU dv on A.DICHVU_ID = dv.DICHVU_ID        left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID        where B.BENHVIEN_ID ='HLU01' and Left(ndv.MANHOMDICHVU,2) = '04'        and B.PHONGBAN_ID in (65,71,72,41,68,62,177,67,55,81,57,57,58,59,60,63,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,61,69,69,70,70)        ) tmp        group by tmp.NOITHUCHIEN_ID, tmp.TENPHONGBAN, tmp.PHONGBAN_ID]
2019-08-26 13:53:13,719 [1] DEBUG - Statement Id: [DAO00019_GetLoaiGiaLoaiKhachHang] PreparedStatement : [select A.*, B.DICTIONARY_CODE MAKHACHHANG, C.TENLOAIGIA        from TM_NGUONKHACHHANG_LOAIGIA A        left join LST_DICTIONARY B on A.NGUONKHACHHANG_BENHNHAN_ID = B.DICTIONARY_ID        inner join TM_LOAIGIA C on C.LOAIGIA_ID = A.LOAIGIA_ID and CAPTREN_ID  = (select LOAIGIA_ID from TM_LOAIGIA where MALOAIGIA = 'GiaDichVu')        left join TM_DICHVU_DONGIA dvdg on dvdg.LOAIGIA_ID = A.LOAIGIA_ID        where B.DICTIONARY_TYPE_CODE = 'NguonKhachHang' and dvdg.DICHVU_ID  =  @param0]
2019-08-26 13:53:13,719 [1] DEBUG - Statement Id: [DAO00019_GetLoaiGiaLoaiKhachHang] Parameters: [@param0=[DICHVU_ID,5443]]
2019-08-26 13:53:13,719 [1] DEBUG - Statement Id: [DAO00019_GetLoaiGiaLoaiKhachHang] Types: [@param0=[Int64, System.Int64]]
2019-08-26 13:53:13,769 [1] DEBUG - Statement Id: [DAO00017_GetLoaiGiaDoiTuongDichVu] PreparedStatement : [select a.LOAIGIA_ID, a.TENLOAIGIA, a.MALOAIGIA, a.CAPTREN_ID, MIN(a.UUTIEN_NGUON) AS UUTIEN_NGUON          , MAX(a.DOUUTIEN) AS DOUUTIEN, MIN(ISNULL(a.GIAHOTRO,0)) AS GIAHOTRO          from(                        select distinct A.LOAIGIA_ID, C.TENLOAIGIA, C.MALOAIGIA, 0 as UUTIEN_NGUON, isnull(B.DOUUTIEN,0) as DOUUTIEN, B.GIAHOTRO, C.CAPTREN_ID            from TM_DOITUONG_GIADICHVU A            left join TM_DOITUONG_LOAIGIA B on A.LOAIGIA_ID = B.LOAIGIA_ID and A.DOITUONG_ID = B.DOITUONG_ID and B.BENHVIEN_ID = 'HLU01'            inner join TM_LOAIGIA C on A.LOAIGIA_ID = C.LOAIGIA_ID and C.BENHVIEN_ID = 'HLU01'            where A.DOITUONG_ID = '1'                            and A.DICHVU_ID = '5443'                         and A.BENHVIEN_ID = 'HLU01'                     ) a          where a.DOUUTIEN != 0 and a.DOUUTIEN is not null          group by a.LOAIGIA_ID, a.TENLOAIGIA, a.MALOAIGIA, a.CAPTREN_ID          order by MAX(a.UUTIEN_NGUON) desc ,MAX(a.DOUUTIEN) asc]
2019-08-26 13:53:13,894 [1] DEBUG - Statement Id: [DAO00017_GetListPhongKham] PreparedStatement : [select pb.PHONGBAN_ID, pb.TENPHONGBAN, case when dv.ATTRIBUTE5 is null then 'TT' else 'KTC' end as LOAI_CHIPHI              from [TM_PHONGBAN_DICHVU] as pb_dv              inner join [TM_PHONGBAN] as pb on pb.PHONGBAN_ID = pb_dv.PHONGBAN_ID and pb.BENHVIEN_ID = 'HLU01'              inner join [TM_DICHVU] dv on dv.DICHVU_ID = pb_dv.DICHVU_ID and dv.MADICHVU = '5443' and dv.BENHVIEN_ID = 'HLU01'              where pb_dv.BENHVIEN_ID = 'HLU01']
2019-08-26 13:53:13,968 [1] DEBUG - Statement Id: [DAO00019_GetListPhongKham_REG13] PreparedStatement : [select pb.PHONGBAN_ID, pb.TENPHONGBAN, case when dv.ATTRIBUTE5 is null then 'TT' else 'KTC' end as LOAI_CHIPHI        from TM_PHONGBAN pb        left join TM_PHONGBAN_DICHVU pb_dv on pb_dv.PHONGBAN_ID = pb.PHONGBAN_ID and pb_dv.BENHVIEN_ID = pb.BENHVIEN_ID        left join TM_DICHVU dv on dv.DICHVU_ID = pb_dv.DICHVU_ID and dv.BENHVIEN_ID = pb_dv.BENHVIEN_ID        left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID and ndv.BENHVIEN_ID = dv.BENHVIEN_ID        where pb.BENHVIEN_ID = 'HLU01' and ndv.MANHOMDICHVU = '04' and dv.DICHVU_ID IS NOT NULL]
2019-08-26 13:53:14,063 [1] DEBUG - Statement Id: [DAO00019_LayThongTinSoluongDichVuPhongKham_REG13] PreparedStatement : [select PHONGBAN_ID, TENPHONGBAN, NOITHUCHIEN_ID, SUM(CHUAKETQUA) AS CHUAKETQUA, SUM(HOANTAT) AS HOANTAT, SUM(DANGTHUCHIEN) AS DANGTHUCHIEN        from (        select B.PHONGBAN_ID, B.TENPHONGBAN, A.NOITHUCHIEN_ID,        case when A.TRANGTHAI = 'CHUAKETQUA' then 1 else 0 end AS CHUAKETQUA,        case when A.TRANGTHAI = 'HOANTAT' then 1 else 0 end AS HOANTAT,        case when A.TRANGTHAI = 'DANGTHUCHIEN' then 1 else 0 end AS DANGTHUCHIEN        from TM_PHONGBAN B        left join TT_DVYEUCAU A on A.NOITHUCHIEN_ID = B.PHONGBAN_ID and A.BENHVIEN_ID = B.BENHVIEN_ID and A.NGAYYEUCAU = CONVERT(date, getdate())        left join TM_DICHVU dv on A.DICHVU_ID = dv.DICHVU_ID        left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID        where B.BENHVIEN_ID ='HLU01' and Left(ndv.MANHOMDICHVU,2) = '04'        and B.PHONGBAN_ID in (65,71,72,41,68,62,177,67,55,81,57,57,58,59,60,63,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,61,69,69,70,70)        ) tmp        group by tmp.NOITHUCHIEN_ID, tmp.TENPHONGBAN, tmp.PHONGBAN_ID]
2019-08-26 13:53:14,339 [1] DEBUG - Statement Id: [DAO00000_GetDICHVU_DONGIA_LOAIGIA] PreparedStatement : [select A.LOAIGIA_ID, A.BANGGIA_ID, A.GIAVON, A.TYLEVAT  as TYLE_VAT, A.TYLE_LOINHUAN,            A.DONGIA as DONGIA_DOANHTHU, NULL as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DICHVU_DONGIA A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '5443' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.LOAIGIA_ID = '3' and A.DICHVU_ID = '5443'            union            select A.LOAIGIA_ID, null as BANGGIA_ID, null as GIAVON, null as TYLE_VAT, null as TYLE_LOINHUAN,            null as DONGIA_DOANHTHU, C.DONGIA as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DOITUONG_GIADICHVU A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join TM_DICHVU_DONGIA C on C.LOAIGIA_ID = A.LOAIGIA_ID AND C.BENHVIEN_ID = 'HLU01'            and C.BANGGIA_ID = B.BANGGIA_ID and C.DICHVU_ID = A.DICHVU_ID            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '5443' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.DOITUONG_ID = '1'  and A.DICHVU_ID = '5443' and A.LOAIGIA_ID            in (select top 1 LOAIGIA_ID from TM_DOITUONG_LOAIGIA            where DOITUONG_ID = '1' and GIAHOTRO = '1'  AND BENHVIEN_ID = 'HLU01'            and LOAIGIA_ID            in (select LOAIGIA_ID from TM_BANGGIA            where LOAIBANGGIA in            (select LOAIBANGGIA from TM_BANGGIA where LOAIGIA_ID = '3'  AND BENHVIEN_ID = 'HLU01')            and TAMNGUNG = '0')  AND BENHVIEN_ID = 'HLU01'            )]
2019-08-26 13:53:14,447 [1] DEBUG - Statement Id: [DAO00024_TM_TIEPNHAN_BANGGIA_DICHVU_getlist] PreparedStatement : [select * from TM_TIEPNHAN_BANGGIA_DICHVU where TAMNGUNG != '1' and BENHVIEN_ID = 'HLU01']
2019-08-26 13:53:18,567 [1] DEBUG - Statement Id: [DAO00020_ListKhoDuocOfPhongBan] PreparedStatement : [select B.* from TM_PHONGBAN_KHODUOC A        inner join TM_KHODUOC B on B.KHODUOC_ID = A.KHODUOC_ID        where        A.PHONGBAN_ID = ''        and A.BENHVIEN_ID = 'HLU01']
2019-08-26 13:53:18,662 [1] DEBUG - Statement Id: [DAO00020_ListKhoDuocOfPhongBan] PreparedStatement : [select B.* from TM_PHONGBAN_KHODUOC A        inner join TM_KHODUOC B on B.KHODUOC_ID = A.KHODUOC_ID        where        A.PHONGBAN_ID = '27'        and A.BENHVIEN_ID = 'HLU01']
2019-08-26 13:53:24,290 [1] DEBUG - Statement Id: [DAO00020_ListKhoDuocOfPhongBan] PreparedStatement : [select B.* from TM_PHONGBAN_KHODUOC A        inner join TM_KHODUOC B on B.KHODUOC_ID = A.KHODUOC_ID        where        A.PHONGBAN_ID = '68'        and A.BENHVIEN_ID = 'HLU01']
2019-08-26 13:53:24,409 [1] DEBUG - Statement Id: [DAO00008_UpdateUserIdPhongBanKhoDuoc] PreparedStatement : [IF EXISTS            (SELECT ACCOUNT_ID FROM TM_SYS_USERS WHERE ACCOUNT_ID =  @param0  and HOSPITAL_ID =  @param1 )            BEGIN            update TM_SYS_USERS set INVENTORY_ID =  @param2 , WORKING_DEPT_ID =  @param3             WHERE ACCOUNT_ID =  @param0  and HOSPITAL_ID =  @param1             END            ELSE            BEGIN            insert into TM_SYS_USERS ([ACCOUNT_ID], [ACCOUNT_NAME], [INVENTORY_ID], [WORKING_DEPT_ID], [HOSPITAL_ID])            values ( @param0 ,  @param4 ,  @param2 ,  @param3 ,  @param1 )            END]
2019-08-26 13:53:24,409 [1] DEBUG - Statement Id: [DAO00008_UpdateUserIdPhongBanKhoDuoc] Parameters: [@param0=[ACCOUNT_ID,113], @param1=[HOSPITAL_ID,HLU01], @param2=[INVENTORY_ID,35], @param3=[WORKING_DEPT_ID,68], @param4=[ACCOUNT_NAME,admin]]
2019-08-26 13:53:24,409 [1] DEBUG - Statement Id: [DAO00008_UpdateUserIdPhongBanKhoDuoc] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[String, System.String], @param3=[String, System.String], @param4=[String, System.String]]
2019-08-26 13:53:28,217 [1] DEBUG - Statement Id: [DAO00307_GetContractWithDate] PreparedStatement : [SELECT HD.*, HD.SO_HD + ' - ' + CT.TENCONGTY AS HOPDONG, CT.TENCONGTY        FROM TT_KSK_HOPDONG HD JOIN TT_KSK_CONGTY CT ON CT.CONGTY_ID = HD.CONGTY_ID         where               HD.BENHVIEN_ID = 'HLU01']
2019-08-26 13:53:28,309 [1] DEBUG - Statement Id: [DAO00329_GetList_BenhNhan_KSK] PreparedStatement : [select * from(select COUNT(*) OVER() as TOTALROWS,ROW_NUMBER() OVER (ORDER BY a.MAYTE) as ROWNUMBER, * from        (SELECT distinct BN.MAYTE,BN.TENBENHNHAN,BN.BENHNHAN_ID,BNDV.TIEPNHAN_ID,DV.MADICHVU        ,Case when BN.GIOITINH =1 then N'Nam' else N'Nữ' end as GIOITINH,BNDV.DVYEUCAU_ID,BNDV.PHONGBAN_ID as NOITHUCHIEN_ID        ,CONVERT(varchar(20), BN.NGAYSINH, 103) AS NGAYSINH,DV.TENDICHVU,PB.TENPHONGBAN as TENPHONGKHAM,CT.TENCONGTY,BNDV.SOPHIEUYEUCAU        ,HD.SO_HD,TN.SOTIEPNHAN,TN.NGUOITAO_ID,BNDV.DICHVU_ID        FROM TT_KSK_CONGTY CT        left join TT_KSK_HOPDONG HD ON HD.CONGTY_ID=CT.CONGTY_ID        left join TT_KSK_HOPDONG_BENHNHAN BN ON BN.HOPDONG_ID=HD.HOPDONG_ID        left join TT_KSK_HOPDONG_BENHNHAN_DICHVU BNDV ON BNDV.HOPDONG_BENHNHAN_ID=BN.HOPDONG_BENHNHAN_ID        left join TT_KSK_HOPDONG_GOIDICHVU GDV ON GDV.HOPDONG_ID= BN.HOPDONG_ID        left join TM_DICHVU DV ON DV.DICHVU_ID=BNDV.DICHVU_ID        left join TM_PHONGBAN PB ON PB.PHONGBAN_ID=BNDV.PHONGBAN_ID        join TT_TIEPNHAN TN ON TN.TIEPNHAN_ID=BNDV.TIEPNHAN_ID        where BNDV.TRANGTHAI='DAXACNHAN' AND HD.BENHVIEN_ID = 'HLU01' AND BNDV.PHONGBAN_ID='68'        AND BNDV.DATHUCHIEN IS NULL)a )b        where b.ROWNUMBER between '1' AND '20']
2019-08-26 13:53:29,719 [1] DEBUG - Statement Id: [DAO00328_GetListTiepNhanAll] PreparedStatement : [select distinct A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        B.*, HD.SO_HD + ' - ' + CT.TENCONGTY as TENHOPDONG, G.DESCRIPTION as GENDER, DT.TENDOITUONG, N.DICTIONARY_NAME as NGHENGHIEP        , case when B.NGAYSINH is null then convert(varchar(4),B.NAMSINH) else convert(varchar(10),B.NGAYSINH,103) end as NGAYTHANGNAMSINH        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN') and B.ACTIVE = '1'        inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.BENHNHAN_ID = B.BENHNHAN_ID        inner join TT_KSK_HOPDONG HD on HD.HOPDONG_ID = HD_BN.HOPDONG_ID        inner join TT_KSK_CONGTY CT on CT.CONGTY_ID = HD.CONGTY_ID        inner join TM_GENDER G on G.ID = B.GIOITINH        inner join TM_DOITUONG DT on DT.DOITUONG_ID = A.DOITUONG_ID        left join LST_DICTIONARY N on N.DICTIONARY_ID = HD_BN.NGHENGHIEP_ID and N.DICTIONARY_TYPE_CODE = 'NgheNghiep'        where A.BENHVIEN_ID = 'HLU01' and HD.KHOA = '0' and CT.TAMNGUNG = '0']
2019-08-26 13:53:29,820 [1] DEBUG - Statement Id: [DAO00328_GetPatientId] PreparedStatement : [select BN.*, KQ.KETQUA_ID        from TT_KSK_HOPDONG_BENHNHAN BN        left join TT_KSK_KETQUA KQ on KQ.HOPDONG_BENHNHAN_ID = BN.HOPDONG_BENHNHAN_ID         where                 BN.BENHNHAN_ID = 23420             and               BN.BENHVIEN_ID = 'HLU01']
2019-08-26 13:53:29,903 [1] DEBUG - Statement Id: [DAO00329_Insert_Data] PreparedStatement : [DECLARE @CHECK int        IF (SELECT COUNT(*) FROM TT_KSK_KETQUA WHERE HOPDONG_ID=3 AND HOPDONG_BENHNHAN_ID=203) = 0        BEGIN        INSERT INTO TT_KSK_KETQUA (TIEPNHAN_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values( @param0 , @param1 , @param2 , @param3 );        SET @CHECK = (SELECT SCOPE_IDENTITY())        INSERT INTO TT_KSK_KETQUA_NOI(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_NGOAI(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_DALIEU(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_PHUKHOA(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_RHM(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_TMH(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_MAT(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        END        ELSE        BEGIN        RETURN        END;]
2019-08-26 13:53:29,903 [1] DEBUG - Statement Id: [DAO00329_Insert_Data] Parameters: [@param0=[TIEPNHAN_ID,27475], @param1=[HOPDONG_ID,3], @param2=[HOPDONG_BENHNHAN_ID,203], @param3=[BENHVIEN_ID,HLU01]]
2019-08-26 13:53:29,904 [1] DEBUG - Statement Id: [DAO00329_Insert_Data] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64], @param2=[Int64, System.Int64], @param3=[String, System.String]]
2019-08-26 13:53:29,932 [1] DEBUG - Statement Id: [DAO00309_GhiChu] PreparedStatement : [select GHICHU from TT_KSK_HOPDONG_BENHNHAN where HOPDONG_BENHNHAN_ID = 203]
2019-08-26 13:53:29,987 [1] DEBUG - Statement Id: [DAO00328_GetKetQuaKSK] PreparedStatement : [SELECT KQ.KETQUA_ID,KQ.TIEPNHAN_ID,KQ.HOPDONG_ID,KQ.HOPDONG_BENHNHAN_ID,SH.MACH,SH.CANNANG,SH.CHIEUCAO,SH.HUYETAPCAO,SH.HUYETAPTHAP,SH.NHIPTHO,SH.NHIETDO,SH.CHISOBMI AS BMI        ,N.TUANHOAN,N.PLTUANHOAN_ID,N.HOHAP,n.PLHOHAP_ID,N.TIEUHOA,N.PLTIEUHOA_ID,N.THAN,N.PLTHAN_ID,N.NOITIET,N.PLNOITIET_ID        ,N.COXUONGKHOP,N.PLCOXUONGKHOP_ID,N.THANKINH,N.PLTHANKINH_ID,N.TAMTHAN,N.PLTAMTHAN_ID,N.BACSIKHAMNOI_ID,NG.NGOAIKHOA        ,NG.PLNGOAIKHOA_ID,NG.BACSINGOAIKHOA_ID,PK.SANPHUKHOA,PK.PLSANPHUKHOA_ID,PK.BACSISANPHUKHOA_ID,MAT.COKINHMATTRAI        ,MAT.COKINHMATPHAI,MAT.KHONGKINHMATTRAI,MAT.KHONGKINHMATPHAI,MAT.CACBENHVEMAT,MAT.PLMAT_ID,MAT.BACSIMAT_ID        ,TMH.TAITRAINOITHUONG,TMH.TAITRAINOITHAM,TMH.TAIPHAINOITHUONG,TMH.TAIPHAINOITHAM,TMH.CACBENHVETAI,TMH.PLTAIMH_ID,TMH.BACSITMH_ID        ,RHM.HAMTREN,RHM.HAMDUOI,RHM.CACBENHVERHM,RHM.PLRHM_ID,RHM.BACSIRHM_ID,DL.DALIEU,DL.PLDALIEU_ID,DL.BACSIDALIEU_ID        ,KQ.BACSIKETLUAN_ID,KQ.NHANXET,KQ.XEPLOAI_ID,KQ.TENICD        FROM TT_KSK_KETQUA KQ        LEFT JOIN TT_KSK_KETQUA_NOI N ON KQ.KETQUA_ID = N.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_NGOAI NG ON N.KETQUA_ID=NG.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_MAT MAT ON NG.KETQUA_ID=MAT.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_PHUKHOA PK ON MAT.KETQUA_ID=PK.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_RHM RHM ON PK.HOPDONG_BENHNHAN_ID=RHM.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_TMH TMH ON RHM.KETQUA_ID=TMH.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_DALIEU DL ON TMH.KETQUA_ID=DL.KETQUA_ID        LEFT JOIN TT_NGOAITRU_KHAMBENH_SINHHIEU SH ON KQ.TIEPNHAN_ID = SH.TIEPNHAN_ID        where (DL.HOPDONG_BENHNHAN_ID  = 203 and DL.BENHVIEN_ID = 'HLU01')        OR (KQ.HOPDONG_BENHNHAN_ID  = 203 and KQ.BENHVIEN_ID = 'HLU01')        OR (N.HOPDONG_BENHNHAN_ID  = 203 and N.BENHVIEN_ID = 'HLU01')        OR (NG.HOPDONG_BENHNHAN_ID  = 203 and NG.BENHVIEN_ID = 'HLU01')        OR (RHM.HOPDONG_BENHNHAN_ID  = 203 and RHM.BENHVIEN_ID = 'HLU01')        OR (MAT.HOPDONG_BENHNHAN_ID  = 203 and MAT.BENHVIEN_ID = 'HLU01')        OR (PK.HOPDONG_BENHNHAN_ID  = 203 and PK.BENHVIEN_ID = 'HLU01')        OR (TMH.HOPDONG_BENHNHAN_ID  = 203 and TMH.BENHVIEN_ID = 'HLU01')]
2019-08-26 13:53:30,086 [1] DEBUG - Statement Id: [DAO00328_GetPatientId] PreparedStatement : [select BN.*, KQ.KETQUA_ID        from TT_KSK_HOPDONG_BENHNHAN BN        left join TT_KSK_KETQUA KQ on KQ.HOPDONG_BENHNHAN_ID = BN.HOPDONG_BENHNHAN_ID         where                 BN.BENHNHAN_ID = 23420             and               BN.BENHVIEN_ID = 'HLU01']
2019-08-26 13:53:30,238 [1] DEBUG - Statement Id: [DAO00329_Insert_Data] PreparedStatement : [DECLARE @CHECK int        IF (SELECT COUNT(*) FROM TT_KSK_KETQUA WHERE HOPDONG_ID=3 AND HOPDONG_BENHNHAN_ID=203) = 0        BEGIN        INSERT INTO TT_KSK_KETQUA (TIEPNHAN_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values( @param0 , @param1 , @param2 , @param3 );        SET @CHECK = (SELECT SCOPE_IDENTITY())        INSERT INTO TT_KSK_KETQUA_NOI(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_NGOAI(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_DALIEU(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_PHUKHOA(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_RHM(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_TMH(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_MAT(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        END        ELSE        BEGIN        RETURN        END;]
2019-08-26 13:53:30,238 [1] DEBUG - Statement Id: [DAO00329_Insert_Data] Parameters: [@param0=[TIEPNHAN_ID,27475], @param1=[HOPDONG_ID,3], @param2=[HOPDONG_BENHNHAN_ID,203], @param3=[BENHVIEN_ID,HLU01]]
2019-08-26 13:53:30,238 [1] DEBUG - Statement Id: [DAO00329_Insert_Data] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64], @param2=[Int64, System.Int64], @param3=[String, System.String]]
2019-08-26 13:53:30,267 [1] DEBUG - Statement Id: [DAO00309_GhiChu] PreparedStatement : [select GHICHU from TT_KSK_HOPDONG_BENHNHAN where HOPDONG_BENHNHAN_ID = 203]
2019-08-26 13:53:30,318 [1] DEBUG - Statement Id: [DAO00328_GetKetQuaKSK] PreparedStatement : [SELECT KQ.KETQUA_ID,KQ.TIEPNHAN_ID,KQ.HOPDONG_ID,KQ.HOPDONG_BENHNHAN_ID,SH.MACH,SH.CANNANG,SH.CHIEUCAO,SH.HUYETAPCAO,SH.HUYETAPTHAP,SH.NHIPTHO,SH.NHIETDO,SH.CHISOBMI AS BMI        ,N.TUANHOAN,N.PLTUANHOAN_ID,N.HOHAP,n.PLHOHAP_ID,N.TIEUHOA,N.PLTIEUHOA_ID,N.THAN,N.PLTHAN_ID,N.NOITIET,N.PLNOITIET_ID        ,N.COXUONGKHOP,N.PLCOXUONGKHOP_ID,N.THANKINH,N.PLTHANKINH_ID,N.TAMTHAN,N.PLTAMTHAN_ID,N.BACSIKHAMNOI_ID,NG.NGOAIKHOA        ,NG.PLNGOAIKHOA_ID,NG.BACSINGOAIKHOA_ID,PK.SANPHUKHOA,PK.PLSANPHUKHOA_ID,PK.BACSISANPHUKHOA_ID,MAT.COKINHMATTRAI        ,MAT.COKINHMATPHAI,MAT.KHONGKINHMATTRAI,MAT.KHONGKINHMATPHAI,MAT.CACBENHVEMAT,MAT.PLMAT_ID,MAT.BACSIMAT_ID        ,TMH.TAITRAINOITHUONG,TMH.TAITRAINOITHAM,TMH.TAIPHAINOITHUONG,TMH.TAIPHAINOITHAM,TMH.CACBENHVETAI,TMH.PLTAIMH_ID,TMH.BACSITMH_ID        ,RHM.HAMTREN,RHM.HAMDUOI,RHM.CACBENHVERHM,RHM.PLRHM_ID,RHM.BACSIRHM_ID,DL.DALIEU,DL.PLDALIEU_ID,DL.BACSIDALIEU_ID        ,KQ.BACSIKETLUAN_ID,KQ.NHANXET,KQ.XEPLOAI_ID,KQ.TENICD        FROM TT_KSK_KETQUA KQ        LEFT JOIN TT_KSK_KETQUA_NOI N ON KQ.KETQUA_ID = N.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_NGOAI NG ON N.KETQUA_ID=NG.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_MAT MAT ON NG.KETQUA_ID=MAT.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_PHUKHOA PK ON MAT.KETQUA_ID=PK.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_RHM RHM ON PK.HOPDONG_BENHNHAN_ID=RHM.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_TMH TMH ON RHM.KETQUA_ID=TMH.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_DALIEU DL ON TMH.KETQUA_ID=DL.KETQUA_ID        LEFT JOIN TT_NGOAITRU_KHAMBENH_SINHHIEU SH ON KQ.TIEPNHAN_ID = SH.TIEPNHAN_ID        where (DL.HOPDONG_BENHNHAN_ID  = 203 and DL.BENHVIEN_ID = 'HLU01')        OR (KQ.HOPDONG_BENHNHAN_ID  = 203 and KQ.BENHVIEN_ID = 'HLU01')        OR (N.HOPDONG_BENHNHAN_ID  = 203 and N.BENHVIEN_ID = 'HLU01')        OR (NG.HOPDONG_BENHNHAN_ID  = 203 and NG.BENHVIEN_ID = 'HLU01')        OR (RHM.HOPDONG_BENHNHAN_ID  = 203 and RHM.BENHVIEN_ID = 'HLU01')        OR (MAT.HOPDONG_BENHNHAN_ID  = 203 and MAT.BENHVIEN_ID = 'HLU01')        OR (PK.HOPDONG_BENHNHAN_ID  = 203 and PK.BENHVIEN_ID = 'HLU01')        OR (TMH.HOPDONG_BENHNHAN_ID  = 203 and TMH.BENHVIEN_ID = 'HLU01')]
2019-08-26 13:53:46,566 [1] DEBUG - Statement Id: [DAO00329_GETKETQUA_TMH] PreparedStatement : [SELECT * FROM TT_KSK_KETQUA_TMH        where HOPDONG_ID=3 AND HOPDONG_BENHNHAN_ID=203 AND BENHVIEN_ID='HLU01']
2019-08-26 13:53:46,606 [1] DEBUG - Statement Id: [DAO00329_Update_KETQUA_TMH] PreparedStatement : [UPDATE TT_KSK_KETQUA_TMH        SET HOPDONG_ID =  @param0 ,HOPDONG_BENHNHAN_ID =  @param1 ,TAITRAINOITHUONG =  @param2 ,TAITRAINOITHAM =  @param3         ,TAIPHAINOITHUONG =  @param4 ,TAIPHAINOITHAM =  @param5 ,CACBENHVETAI =  @param6 ,PLTAIMH_ID =  @param7         ,BACSITMH_ID =  @param8 ,BENHVIEN_ID =  @param9 ,NGAYTAO =  @param10 ,NGUOITAO_ID =  @param11 ,NGAYCAPNHAT =  @param12 ,NGUOICAPNHAT_ID =  @param13         WHERE HOPDONG_ID = 3 AND HOPDONG_BENHNHAN_ID = 203 AND BENHVIEN_ID='HLU01']
2019-08-26 13:53:46,606 [1] DEBUG - Statement Id: [DAO00329_Update_KETQUA_TMH] Parameters: [@param0=[HOPDONG_ID,3], @param1=[HOPDONG_BENHNHAN_ID,203], @param2=[TAITRAINOITHUONG,10], @param3=[TAITRAINOITHAM,10], @param4=[TAIPHAINOITHUONG,10], @param5=[TAIPHAINOITHAM,10], @param6=[CACBENHVETAI,tets 3], @param7=[PLTAIMH_ID,11694], @param8=[BACSITMH_ID,40], @param9=[BENHVIEN_ID,HLU01], @param10=[NGAYTAO,null], @param11=[NGUOITAO_ID,null], @param12=[NGAYCAPNHAT,8/26/2019 1:53:46 PM], @param13=[NGUOICAPNHAT_ID,1]]
2019-08-26 13:53:46,606 [1] DEBUG - Statement Id: [DAO00329_Update_KETQUA_TMH] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64], @param2=[Int64, System.Int64], @param3=[Int64, System.Int64], @param4=[Int64, System.Int64], @param5=[Int64, System.Int64], @param6=[String, System.String], @param7=[Int64, System.Int64], @param8=[Int64, System.Int64], @param9=[String, System.String], @param10=[System.DBNull, null], @param11=[System.DBNull, null], @param12=[DateTime, System.DateTime], @param13=[Int64, System.Int64]]
2019-08-26 13:53:46,713 [1] DEBUG - Statement Id: [DAO00329_Update_KB] PreparedStatement : [UPDATE TT_KSK_HOPDONG_BENHNHAN_DICHVU SET DATHUCHIEN='DATHUCHIEN' where HOPDONG_BENHNHAN_ID= 203 AND DICHVU_ID=5443 AND TRANGTHAI= 'DAXACNHAN']
2019-08-26 13:53:54,444 [1] DEBUG - Statement Id: [DAO00328_GetListTiepNhanAll] PreparedStatement : [select distinct A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        B.*, HD.SO_HD + ' - ' + CT.TENCONGTY as TENHOPDONG, G.DESCRIPTION as GENDER, DT.TENDOITUONG, N.DICTIONARY_NAME as NGHENGHIEP        , case when B.NGAYSINH is null then convert(varchar(4),B.NAMSINH) else convert(varchar(10),B.NGAYSINH,103) end as NGAYTHANGNAMSINH        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN') and B.ACTIVE = '1'        inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.BENHNHAN_ID = B.BENHNHAN_ID        inner join TT_KSK_HOPDONG HD on HD.HOPDONG_ID = HD_BN.HOPDONG_ID        inner join TT_KSK_CONGTY CT on CT.CONGTY_ID = HD.CONGTY_ID        inner join TM_GENDER G on G.ID = B.GIOITINH        inner join TM_DOITUONG DT on DT.DOITUONG_ID = A.DOITUONG_ID        left join LST_DICTIONARY N on N.DICTIONARY_ID = HD_BN.NGHENGHIEP_ID and N.DICTIONARY_TYPE_CODE = 'NgheNghiep'        where A.BENHVIEN_ID = 'HLU01' and HD.KHOA = '0' and CT.TAMNGUNG = '0']
2019-08-26 13:53:54,545 [1] DEBUG - Statement Id: [DAO00328_GetPatientId] PreparedStatement : [select BN.*, KQ.KETQUA_ID        from TT_KSK_HOPDONG_BENHNHAN BN        left join TT_KSK_KETQUA KQ on KQ.HOPDONG_BENHNHAN_ID = BN.HOPDONG_BENHNHAN_ID         where                 BN.BENHNHAN_ID = 23420             and               BN.BENHVIEN_ID = 'HLU01']
2019-08-26 13:53:54,633 [1] DEBUG - Statement Id: [DAO00329_Insert_Data] PreparedStatement : [DECLARE @CHECK int        IF (SELECT COUNT(*) FROM TT_KSK_KETQUA WHERE HOPDONG_ID=3 AND HOPDONG_BENHNHAN_ID=203) = 0        BEGIN        INSERT INTO TT_KSK_KETQUA (TIEPNHAN_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values( @param0 , @param1 , @param2 , @param3 );        SET @CHECK = (SELECT SCOPE_IDENTITY())        INSERT INTO TT_KSK_KETQUA_NOI(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_NGOAI(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_DALIEU(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_PHUKHOA(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_RHM(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_TMH(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_MAT(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        END        ELSE        BEGIN        RETURN        END;]
2019-08-26 13:53:54,633 [1] DEBUG - Statement Id: [DAO00329_Insert_Data] Parameters: [@param0=[TIEPNHAN_ID,27475], @param1=[HOPDONG_ID,3], @param2=[HOPDONG_BENHNHAN_ID,203], @param3=[BENHVIEN_ID,HLU01]]
2019-08-26 13:53:54,633 [1] DEBUG - Statement Id: [DAO00329_Insert_Data] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64], @param2=[Int64, System.Int64], @param3=[String, System.String]]
2019-08-26 13:53:54,660 [1] DEBUG - Statement Id: [DAO00309_GhiChu] PreparedStatement : [select GHICHU from TT_KSK_HOPDONG_BENHNHAN where HOPDONG_BENHNHAN_ID = 203]
2019-08-26 13:53:54,711 [1] DEBUG - Statement Id: [DAO00328_GetKetQuaKSK] PreparedStatement : [SELECT KQ.KETQUA_ID,KQ.TIEPNHAN_ID,KQ.HOPDONG_ID,KQ.HOPDONG_BENHNHAN_ID,SH.MACH,SH.CANNANG,SH.CHIEUCAO,SH.HUYETAPCAO,SH.HUYETAPTHAP,SH.NHIPTHO,SH.NHIETDO,SH.CHISOBMI AS BMI        ,N.TUANHOAN,N.PLTUANHOAN_ID,N.HOHAP,n.PLHOHAP_ID,N.TIEUHOA,N.PLTIEUHOA_ID,N.THAN,N.PLTHAN_ID,N.NOITIET,N.PLNOITIET_ID        ,N.COXUONGKHOP,N.PLCOXUONGKHOP_ID,N.THANKINH,N.PLTHANKINH_ID,N.TAMTHAN,N.PLTAMTHAN_ID,N.BACSIKHAMNOI_ID,NG.NGOAIKHOA        ,NG.PLNGOAIKHOA_ID,NG.BACSINGOAIKHOA_ID,PK.SANPHUKHOA,PK.PLSANPHUKHOA_ID,PK.BACSISANPHUKHOA_ID,MAT.COKINHMATTRAI        ,MAT.COKINHMATPHAI,MAT.KHONGKINHMATTRAI,MAT.KHONGKINHMATPHAI,MAT.CACBENHVEMAT,MAT.PLMAT_ID,MAT.BACSIMAT_ID        ,TMH.TAITRAINOITHUONG,TMH.TAITRAINOITHAM,TMH.TAIPHAINOITHUONG,TMH.TAIPHAINOITHAM,TMH.CACBENHVETAI,TMH.PLTAIMH_ID,TMH.BACSITMH_ID        ,RHM.HAMTREN,RHM.HAMDUOI,RHM.CACBENHVERHM,RHM.PLRHM_ID,RHM.BACSIRHM_ID,DL.DALIEU,DL.PLDALIEU_ID,DL.BACSIDALIEU_ID        ,KQ.BACSIKETLUAN_ID,KQ.NHANXET,KQ.XEPLOAI_ID,KQ.TENICD        FROM TT_KSK_KETQUA KQ        LEFT JOIN TT_KSK_KETQUA_NOI N ON KQ.KETQUA_ID = N.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_NGOAI NG ON N.KETQUA_ID=NG.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_MAT MAT ON NG.KETQUA_ID=MAT.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_PHUKHOA PK ON MAT.KETQUA_ID=PK.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_RHM RHM ON PK.HOPDONG_BENHNHAN_ID=RHM.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_TMH TMH ON RHM.KETQUA_ID=TMH.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_DALIEU DL ON TMH.KETQUA_ID=DL.KETQUA_ID        LEFT JOIN TT_NGOAITRU_KHAMBENH_SINHHIEU SH ON KQ.TIEPNHAN_ID = SH.TIEPNHAN_ID        where (DL.HOPDONG_BENHNHAN_ID  = 203 and DL.BENHVIEN_ID = 'HLU01')        OR (KQ.HOPDONG_BENHNHAN_ID  = 203 and KQ.BENHVIEN_ID = 'HLU01')        OR (N.HOPDONG_BENHNHAN_ID  = 203 and N.BENHVIEN_ID = 'HLU01')        OR (NG.HOPDONG_BENHNHAN_ID  = 203 and NG.BENHVIEN_ID = 'HLU01')        OR (RHM.HOPDONG_BENHNHAN_ID  = 203 and RHM.BENHVIEN_ID = 'HLU01')        OR (MAT.HOPDONG_BENHNHAN_ID  = 203 and MAT.BENHVIEN_ID = 'HLU01')        OR (PK.HOPDONG_BENHNHAN_ID  = 203 and PK.BENHVIEN_ID = 'HLU01')        OR (TMH.HOPDONG_BENHNHAN_ID  = 203 and TMH.BENHVIEN_ID = 'HLU01')]
2019-08-26 13:53:54,826 [1] DEBUG - Statement Id: [DAO00328_GetPatientId] PreparedStatement : [select BN.*, KQ.KETQUA_ID        from TT_KSK_HOPDONG_BENHNHAN BN        left join TT_KSK_KETQUA KQ on KQ.HOPDONG_BENHNHAN_ID = BN.HOPDONG_BENHNHAN_ID         where                 BN.BENHNHAN_ID = 23420             and               BN.BENHVIEN_ID = 'HLU01']
2019-08-26 13:53:54,906 [1] DEBUG - Statement Id: [DAO00329_Insert_Data] PreparedStatement : [DECLARE @CHECK int        IF (SELECT COUNT(*) FROM TT_KSK_KETQUA WHERE HOPDONG_ID=3 AND HOPDONG_BENHNHAN_ID=203) = 0        BEGIN        INSERT INTO TT_KSK_KETQUA (TIEPNHAN_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values( @param0 , @param1 , @param2 , @param3 );        SET @CHECK = (SELECT SCOPE_IDENTITY())        INSERT INTO TT_KSK_KETQUA_NOI(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_NGOAI(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_DALIEU(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_PHUKHOA(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_RHM(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_TMH(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_MAT(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        END        ELSE        BEGIN        RETURN        END;]
2019-08-26 13:53:54,906 [1] DEBUG - Statement Id: [DAO00329_Insert_Data] Parameters: [@param0=[TIEPNHAN_ID,27475], @param1=[HOPDONG_ID,3], @param2=[HOPDONG_BENHNHAN_ID,203], @param3=[BENHVIEN_ID,HLU01]]
2019-08-26 13:53:54,906 [1] DEBUG - Statement Id: [DAO00329_Insert_Data] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64], @param2=[Int64, System.Int64], @param3=[String, System.String]]
2019-08-26 13:53:54,934 [1] DEBUG - Statement Id: [DAO00309_GhiChu] PreparedStatement : [select GHICHU from TT_KSK_HOPDONG_BENHNHAN where HOPDONG_BENHNHAN_ID = 203]
2019-08-26 13:53:54,985 [1] DEBUG - Statement Id: [DAO00328_GetKetQuaKSK] PreparedStatement : [SELECT KQ.KETQUA_ID,KQ.TIEPNHAN_ID,KQ.HOPDONG_ID,KQ.HOPDONG_BENHNHAN_ID,SH.MACH,SH.CANNANG,SH.CHIEUCAO,SH.HUYETAPCAO,SH.HUYETAPTHAP,SH.NHIPTHO,SH.NHIETDO,SH.CHISOBMI AS BMI        ,N.TUANHOAN,N.PLTUANHOAN_ID,N.HOHAP,n.PLHOHAP_ID,N.TIEUHOA,N.PLTIEUHOA_ID,N.THAN,N.PLTHAN_ID,N.NOITIET,N.PLNOITIET_ID        ,N.COXUONGKHOP,N.PLCOXUONGKHOP_ID,N.THANKINH,N.PLTHANKINH_ID,N.TAMTHAN,N.PLTAMTHAN_ID,N.BACSIKHAMNOI_ID,NG.NGOAIKHOA        ,NG.PLNGOAIKHOA_ID,NG.BACSINGOAIKHOA_ID,PK.SANPHUKHOA,PK.PLSANPHUKHOA_ID,PK.BACSISANPHUKHOA_ID,MAT.COKINHMATTRAI        ,MAT.COKINHMATPHAI,MAT.KHONGKINHMATTRAI,MAT.KHONGKINHMATPHAI,MAT.CACBENHVEMAT,MAT.PLMAT_ID,MAT.BACSIMAT_ID        ,TMH.TAITRAINOITHUONG,TMH.TAITRAINOITHAM,TMH.TAIPHAINOITHUONG,TMH.TAIPHAINOITHAM,TMH.CACBENHVETAI,TMH.PLTAIMH_ID,TMH.BACSITMH_ID        ,RHM.HAMTREN,RHM.HAMDUOI,RHM.CACBENHVERHM,RHM.PLRHM_ID,RHM.BACSIRHM_ID,DL.DALIEU,DL.PLDALIEU_ID,DL.BACSIDALIEU_ID        ,KQ.BACSIKETLUAN_ID,KQ.NHANXET,KQ.XEPLOAI_ID,KQ.TENICD        FROM TT_KSK_KETQUA KQ        LEFT JOIN TT_KSK_KETQUA_NOI N ON KQ.KETQUA_ID = N.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_NGOAI NG ON N.KETQUA_ID=NG.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_MAT MAT ON NG.KETQUA_ID=MAT.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_PHUKHOA PK ON MAT.KETQUA_ID=PK.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_RHM RHM ON PK.HOPDONG_BENHNHAN_ID=RHM.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_TMH TMH ON RHM.KETQUA_ID=TMH.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_DALIEU DL ON TMH.KETQUA_ID=DL.KETQUA_ID        LEFT JOIN TT_NGOAITRU_KHAMBENH_SINHHIEU SH ON KQ.TIEPNHAN_ID = SH.TIEPNHAN_ID        where (DL.HOPDONG_BENHNHAN_ID  = 203 and DL.BENHVIEN_ID = 'HLU01')        OR (KQ.HOPDONG_BENHNHAN_ID  = 203 and KQ.BENHVIEN_ID = 'HLU01')        OR (N.HOPDONG_BENHNHAN_ID  = 203 and N.BENHVIEN_ID = 'HLU01')        OR (NG.HOPDONG_BENHNHAN_ID  = 203 and NG.BENHVIEN_ID = 'HLU01')        OR (RHM.HOPDONG_BENHNHAN_ID  = 203 and RHM.BENHVIEN_ID = 'HLU01')        OR (MAT.HOPDONG_BENHNHAN_ID  = 203 and MAT.BENHVIEN_ID = 'HLU01')        OR (PK.HOPDONG_BENHNHAN_ID  = 203 and PK.BENHVIEN_ID = 'HLU01')        OR (TMH.HOPDONG_BENHNHAN_ID  = 203 and TMH.BENHVIEN_ID = 'HLU01')]
2019-08-26 13:54:42,758 [1] DEBUG - Statement Id: [DAO00328_GetListTiepNhanAll] PreparedStatement : [select distinct A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        B.*, HD.SO_HD + ' - ' + CT.TENCONGTY as TENHOPDONG, G.DESCRIPTION as GENDER, DT.TENDOITUONG, N.DICTIONARY_NAME as NGHENGHIEP        , case when B.NGAYSINH is null then convert(varchar(4),B.NAMSINH) else convert(varchar(10),B.NGAYSINH,103) end as NGAYTHANGNAMSINH        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN') and B.ACTIVE = '1'        inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.BENHNHAN_ID = B.BENHNHAN_ID        inner join TT_KSK_HOPDONG HD on HD.HOPDONG_ID = HD_BN.HOPDONG_ID        inner join TT_KSK_CONGTY CT on CT.CONGTY_ID = HD.CONGTY_ID        inner join TM_GENDER G on G.ID = B.GIOITINH        inner join TM_DOITUONG DT on DT.DOITUONG_ID = A.DOITUONG_ID        left join LST_DICTIONARY N on N.DICTIONARY_ID = HD_BN.NGHENGHIEP_ID and N.DICTIONARY_TYPE_CODE = 'NgheNghiep'        where A.BENHVIEN_ID = 'HLU01' and HD.KHOA = '0' and CT.TAMNGUNG = '0']
2019-08-26 13:54:59,148 [1] DEBUG - Statement Id: [DAO00328_GetPatientId] PreparedStatement : [select BN.*, KQ.KETQUA_ID        from TT_KSK_HOPDONG_BENHNHAN BN        left join TT_KSK_KETQUA KQ on KQ.HOPDONG_BENHNHAN_ID = BN.HOPDONG_BENHNHAN_ID         where                 BN.BENHNHAN_ID = 23420             and               BN.BENHVIEN_ID = 'HLU01']
2019-08-26 13:55:24,155 [1] DEBUG - Statement Id: [DAO00329_Insert_Data] PreparedStatement : [DECLARE @CHECK int        IF (SELECT COUNT(*) FROM TT_KSK_KETQUA WHERE HOPDONG_ID=3 AND HOPDONG_BENHNHAN_ID=203) = 0        BEGIN        INSERT INTO TT_KSK_KETQUA (TIEPNHAN_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values( @param0 , @param1 , @param2 , @param3 );        SET @CHECK = (SELECT SCOPE_IDENTITY())        INSERT INTO TT_KSK_KETQUA_NOI(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_NGOAI(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_DALIEU(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_PHUKHOA(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_RHM(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_TMH(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_MAT(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        END        ELSE        BEGIN        RETURN        END;]
2019-08-26 13:55:24,155 [1] DEBUG - Statement Id: [DAO00329_Insert_Data] Parameters: [@param0=[TIEPNHAN_ID,27475], @param1=[HOPDONG_ID,3], @param2=[HOPDONG_BENHNHAN_ID,203], @param3=[BENHVIEN_ID,HLU01]]
2019-08-26 13:55:24,155 [1] DEBUG - Statement Id: [DAO00329_Insert_Data] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64], @param2=[Int64, System.Int64], @param3=[String, System.String]]
2019-08-26 13:55:30,996 [1] DEBUG - Statement Id: [DAO00309_GhiChu] PreparedStatement : [select GHICHU from TT_KSK_HOPDONG_BENHNHAN where HOPDONG_BENHNHAN_ID = 203]
2019-08-26 13:55:31,044 [1] DEBUG - Statement Id: [DAO00328_GetKetQuaKSK] PreparedStatement : [SELECT KQ.KETQUA_ID,KQ.TIEPNHAN_ID,KQ.HOPDONG_ID,KQ.HOPDONG_BENHNHAN_ID,SH.MACH,SH.CANNANG,SH.CHIEUCAO,SH.HUYETAPCAO,SH.HUYETAPTHAP,SH.NHIPTHO,SH.NHIETDO,SH.CHISOBMI AS BMI        ,N.TUANHOAN,N.PLTUANHOAN_ID,N.HOHAP,n.PLHOHAP_ID,N.TIEUHOA,N.PLTIEUHOA_ID,N.THAN,N.PLTHAN_ID,N.NOITIET,N.PLNOITIET_ID        ,N.COXUONGKHOP,N.PLCOXUONGKHOP_ID,N.THANKINH,N.PLTHANKINH_ID,N.TAMTHAN,N.PLTAMTHAN_ID,N.BACSIKHAMNOI_ID,NG.NGOAIKHOA        ,NG.PLNGOAIKHOA_ID,NG.BACSINGOAIKHOA_ID,PK.SANPHUKHOA,PK.PLSANPHUKHOA_ID,PK.BACSISANPHUKHOA_ID,MAT.COKINHMATTRAI        ,MAT.COKINHMATPHAI,MAT.KHONGKINHMATTRAI,MAT.KHONGKINHMATPHAI,MAT.CACBENHVEMAT,MAT.PLMAT_ID,MAT.BACSIMAT_ID        ,TMH.TAITRAINOITHUONG,TMH.TAITRAINOITHAM,TMH.TAIPHAINOITHUONG,TMH.TAIPHAINOITHAM,TMH.CACBENHVETAI,TMH.PLTAIMH_ID,TMH.BACSITMH_ID        ,RHM.HAMTREN,RHM.HAMDUOI,RHM.CACBENHVERHM,RHM.PLRHM_ID,RHM.BACSIRHM_ID,DL.DALIEU,DL.PLDALIEU_ID,DL.BACSIDALIEU_ID        ,KQ.BACSIKETLUAN_ID,KQ.NHANXET,KQ.XEPLOAI_ID,KQ.TENICD        FROM TT_KSK_KETQUA KQ        LEFT JOIN TT_KSK_KETQUA_NOI N ON KQ.KETQUA_ID = N.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_NGOAI NG ON N.KETQUA_ID=NG.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_MAT MAT ON NG.KETQUA_ID=MAT.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_PHUKHOA PK ON MAT.KETQUA_ID=PK.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_RHM RHM ON PK.HOPDONG_BENHNHAN_ID=RHM.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_TMH TMH ON RHM.KETQUA_ID=TMH.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_DALIEU DL ON TMH.KETQUA_ID=DL.KETQUA_ID        LEFT JOIN TT_NGOAITRU_KHAMBENH_SINHHIEU SH ON KQ.TIEPNHAN_ID = SH.TIEPNHAN_ID        where (DL.HOPDONG_BENHNHAN_ID  = 203 and DL.BENHVIEN_ID = 'HLU01')        OR (KQ.HOPDONG_BENHNHAN_ID  = 203 and KQ.BENHVIEN_ID = 'HLU01')        OR (N.HOPDONG_BENHNHAN_ID  = 203 and N.BENHVIEN_ID = 'HLU01')        OR (NG.HOPDONG_BENHNHAN_ID  = 203 and NG.BENHVIEN_ID = 'HLU01')        OR (RHM.HOPDONG_BENHNHAN_ID  = 203 and RHM.BENHVIEN_ID = 'HLU01')        OR (MAT.HOPDONG_BENHNHAN_ID  = 203 and MAT.BENHVIEN_ID = 'HLU01')        OR (PK.HOPDONG_BENHNHAN_ID  = 203 and PK.BENHVIEN_ID = 'HLU01')        OR (TMH.HOPDONG_BENHNHAN_ID  = 203 and TMH.BENHVIEN_ID = 'HLU01')]
--------------------------------------------------------------------------------
2019-08-26 14:01:50,751 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2019-08-26 14:01:51,065 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-08-26 14:01:51,102 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-08-26 14:01:51,614 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 14:01:51,866 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-08-26 14:01:58,346 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2019-08-26 14:01:58,392 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-08-26 14:02:00,817 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-08-26 14:02:00,901 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-08-26 14:02:01,735 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2019-08-26 14:02:01,890 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2019-08-26 14:02:01,984 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2019-08-26 14:02:02,066 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2019-08-26 14:02:02,146 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2019-08-26 14:02:02,224 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2019-08-26 14:02:02,323 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2019-08-26 14:02:02,434 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2019-08-26 14:02:02,540 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2019-08-26 14:02:03,091 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2019-08-26 14:02:03,125 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2019-08-26 14:02:03,209 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2019-08-26 14:02:03,240 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2019-08-26 14:02:04,162 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2019-08-26 14:02:04,219 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 0 as PHAMVI_ID, 0 as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0         end                else        begin        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2019-08-26 14:02:06,227 [5] DEBUG - Statement Id: [DAO00320_GetList] PreparedStatement : [select M.*            from TM_MAU M            LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID            where            M.TAMNGUNG = '0'            and M.BENHVIEN_ID = 'HLU01'            order by M.TENMAU]
2019-08-26 14:02:06,290 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2019-08-26 14:02:06,322 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT          TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,          TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,          SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH          FROM TT_MAU_TONKHO TK          JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID          JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID          JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'          LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID          LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID          WHERE TK.SOLUONG > 0          GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,          TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2019-08-26 14:02:06,389 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2019-08-26 14:02:06,420 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct          TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,          TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,          TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH          from TM_MAU M          JOIN          (          select          A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO          from          (          select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO          from TT_MAU_TONKHO TK          JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID          inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID          left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'          where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0          ) A          )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'          LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID          LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2019-08-26 14:02:06,490 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2019-08-26 14:02:07,441 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 14:02:08,734 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2019-08-26 14:02:14,375 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2019-08-26 14:02:14,420 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2019-08-26 14:02:14,506 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 14:02:14,639 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 14:02:14,792 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2019-08-26 14:02:14,794 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-08-26 14:02:14,794 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-08-26 14:02:14,903 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2019-08-26 14:02:14,903 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-08-26 14:02:14,903 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-08-26 14:02:15,036 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 14:02:15,204 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 14:02:26,225 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 14:02:26,321 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2019-08-26 14:02:26,611 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2019-08-26 14:04:22,393 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'HSM27'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 14:04:23,202 [1] DEBUG - Statement Id: [DAO00307_GetContractWithDate] PreparedStatement : [SELECT HD.*, HD.SO_HD + ' - ' + CT.TENCONGTY AS HOPDONG, CT.TENCONGTY        FROM TT_KSK_HOPDONG HD JOIN TT_KSK_CONGTY CT ON CT.CONGTY_ID = HD.CONGTY_ID         where               HD.BENHVIEN_ID = 'HLU01']
2019-08-26 14:04:23,698 [1] DEBUG - Statement Id: [DAO00329_GetList_BenhNhan_KSK] PreparedStatement : [select * from(select COUNT(*) OVER() as TOTALROWS,ROW_NUMBER() OVER (ORDER BY a.MAYTE) as ROWNUMBER, * from        (SELECT distinct BN.MAYTE,BN.TENBENHNHAN,BN.BENHNHAN_ID,BNDV.TIEPNHAN_ID,DV.MADICHVU        ,Case when BN.GIOITINH =1 then N'Nam' else N'Nữ' end as GIOITINH,BNDV.DVYEUCAU_ID,BNDV.PHONGBAN_ID as NOITHUCHIEN_ID        ,CONVERT(varchar(20), BN.NGAYSINH, 103) AS NGAYSINH,DV.TENDICHVU,PB.TENPHONGBAN as TENPHONGKHAM,CT.TENCONGTY,BNDV.SOPHIEUYEUCAU        ,HD.SO_HD,TN.SOTIEPNHAN,TN.NGUOITAO_ID,BNDV.DICHVU_ID        FROM TT_KSK_CONGTY CT        left join TT_KSK_HOPDONG HD ON HD.CONGTY_ID=CT.CONGTY_ID        left join TT_KSK_HOPDONG_BENHNHAN BN ON BN.HOPDONG_ID=HD.HOPDONG_ID        left join TT_KSK_HOPDONG_BENHNHAN_DICHVU BNDV ON BNDV.HOPDONG_BENHNHAN_ID=BN.HOPDONG_BENHNHAN_ID        left join TT_KSK_HOPDONG_GOIDICHVU GDV ON GDV.HOPDONG_ID= BN.HOPDONG_ID        left join TM_DICHVU DV ON DV.DICHVU_ID=BNDV.DICHVU_ID        left join TM_PHONGBAN PB ON PB.PHONGBAN_ID=BNDV.PHONGBAN_ID        join TT_TIEPNHAN TN ON TN.TIEPNHAN_ID=BNDV.TIEPNHAN_ID        where BNDV.TRANGTHAI='DAXACNHAN' AND HD.BENHVIEN_ID = 'HLU01' AND BNDV.PHONGBAN_ID='68'        AND BNDV.DATHUCHIEN IS NULL)a )b        where b.ROWNUMBER between '1' AND '20']
2019-08-26 14:04:30,018 [1] DEBUG - Statement Id: [DAO00329_Search_BenhNhan_KSK] PreparedStatement : [select * from(select COUNT(*) OVER() as TOTALROWS,ROW_NUMBER() OVER (ORDER BY a.MAYTE) as ROWNUMBER, * from        (SELECT distinct BN.MAYTE,BN.TENBENHNHAN,BN.BENHNHAN_ID,BNDV.TIEPNHAN_ID,DV.MADICHVU,DV.DICHVU_ID,TN.SOTIEPNHAN        ,BNDV.DVYEUCAU_ID,BNDV.PHONGBAN_ID AS NOITHUCHIEN_ID,BNDV.SOPHIEUYEUCAU        ,Case when BN.GIOITINH =1 then N'Nam' else N'Nữ' end as GIOITINH        ,CONVERT(varchar(20), BN.NGAYSINH, 103) AS NGAYSINH,DV.TENDICHVU,PB.TENPHONGBAN as TENPHONGKHAM,CT.TENCONGTY,HD.SO_HD        FROM TT_KSK_CONGTY CT        left join TT_KSK_HOPDONG HD ON HD.CONGTY_ID=CT.CONGTY_ID        left join TT_KSK_HOPDONG_BENHNHAN BN ON BN.HOPDONG_ID=HD.HOPDONG_ID        left join TT_KSK_HOPDONG_BENHNHAN_DICHVU BNDV ON BNDV.HOPDONG_BENHNHAN_ID=BN.HOPDONG_BENHNHAN_ID        left join TT_KSK_HOPDONG_GOIDICHVU GDV ON GDV.HOPDONG_ID= BN.HOPDONG_ID        left join TM_DICHVU DV ON DV.DICHVU_ID=BNDV.DICHVU_ID        left join TM_PHONGBAN PB ON PB.PHONGBAN_ID=BNDV.PHONGBAN_ID        join TT_TIEPNHAN TN ON TN.TIEPNHAN_ID= BNDV.TIEPNHAN_ID         where           CONVERT(DATE,TN.NGAYTIEPNHAN) BETWEEN CONVERT(DATE,'8/1/2019 12:00:00 AM')          AND CONVERT(DATE,'8/26/2019 12:00:00 AM')          AND BNDV.PHONGBAN_ID='68' AND                           BNDV.DATHUCHIEN IS NOT NULL                       )a )b  where b.ROWNUMBER between '1' AND '20']
2019-08-26 14:04:31,997 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'HSM20'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 14:04:35,028 [1] DEBUG - Statement Id: [DAO00328_GetListTiepNhanAll] PreparedStatement : [select distinct A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        B.*, HD.SO_HD + ' - ' + CT.TENCONGTY as TENHOPDONG, G.DESCRIPTION as GENDER, DT.TENDOITUONG, N.DICTIONARY_NAME as NGHENGHIEP        , case when B.NGAYSINH is null then convert(varchar(4),B.NAMSINH) else convert(varchar(10),B.NGAYSINH,103) end as NGAYTHANGNAMSINH        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN') and B.ACTIVE = '1'        inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.BENHNHAN_ID = B.BENHNHAN_ID        inner join TT_KSK_HOPDONG HD on HD.HOPDONG_ID = HD_BN.HOPDONG_ID        inner join TT_KSK_CONGTY CT on CT.CONGTY_ID = HD.CONGTY_ID        inner join TM_GENDER G on G.ID = B.GIOITINH        inner join TM_DOITUONG DT on DT.DOITUONG_ID = A.DOITUONG_ID        left join LST_DICTIONARY N on N.DICTIONARY_ID = HD_BN.NGHENGHIEP_ID and N.DICTIONARY_TYPE_CODE = 'NgheNghiep'        where A.BENHVIEN_ID = 'HLU01' and HD.KHOA = '0' and CT.TAMNGUNG = '0']
2019-08-26 14:04:38,656 [1] DEBUG - Statement Id: [DAO00328_GetPatientId] PreparedStatement : [select BN.*, KQ.KETQUA_ID        from TT_KSK_HOPDONG_BENHNHAN BN        left join TT_KSK_KETQUA KQ on KQ.HOPDONG_BENHNHAN_ID = BN.HOPDONG_BENHNHAN_ID         where                 BN.BENHNHAN_ID = 23420             and               BN.BENHVIEN_ID = 'HLU01']
2019-08-26 14:04:38,741 [1] DEBUG - Statement Id: [DAO00329_Insert_Data] PreparedStatement : [DECLARE @CHECK int        IF (SELECT COUNT(*) FROM TT_KSK_KETQUA WHERE HOPDONG_ID=3 AND HOPDONG_BENHNHAN_ID=203) = 0        BEGIN        INSERT INTO TT_KSK_KETQUA (TIEPNHAN_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values( @param0 , @param1 , @param2 , @param3 );        SET @CHECK = (SELECT SCOPE_IDENTITY())        INSERT INTO TT_KSK_KETQUA_NOI(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_NGOAI(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_DALIEU(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_PHUKHOA(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_RHM(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_TMH(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_MAT(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        END        ELSE        BEGIN        RETURN        END;]
2019-08-26 14:04:38,741 [1] DEBUG - Statement Id: [DAO00329_Insert_Data] Parameters: [@param0=[TIEPNHAN_ID,27475], @param1=[HOPDONG_ID,3], @param2=[HOPDONG_BENHNHAN_ID,203], @param3=[BENHVIEN_ID,HLU01]]
2019-08-26 14:04:38,741 [1] DEBUG - Statement Id: [DAO00329_Insert_Data] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64], @param2=[Int64, System.Int64], @param3=[String, System.String]]
2019-08-26 14:04:38,770 [1] DEBUG - Statement Id: [DAO00309_GhiChu] PreparedStatement : [select GHICHU from TT_KSK_HOPDONG_BENHNHAN where HOPDONG_BENHNHAN_ID = 203]
2019-08-26 14:04:38,869 [1] DEBUG - Statement Id: [DAO00328_GetKetQuaKSK] PreparedStatement : [SELECT KQ.KETQUA_ID,KQ.TIEPNHAN_ID,KQ.HOPDONG_ID,KQ.HOPDONG_BENHNHAN_ID,SH.MACH,SH.CANNANG,SH.CHIEUCAO,SH.HUYETAPCAO,SH.HUYETAPTHAP,SH.NHIPTHO,SH.NHIETDO,SH.CHISOBMI AS BMI        ,N.TUANHOAN,N.PLTUANHOAN_ID,N.HOHAP,n.PLHOHAP_ID,N.TIEUHOA,N.PLTIEUHOA_ID,N.THAN,N.PLTHAN_ID,N.NOITIET,N.PLNOITIET_ID        ,N.COXUONGKHOP,N.PLCOXUONGKHOP_ID,N.THANKINH,N.PLTHANKINH_ID,N.TAMTHAN,N.PLTAMTHAN_ID,N.BACSIKHAMNOI_ID,NG.NGOAIKHOA        ,NG.PLNGOAIKHOA_ID,NG.BACSINGOAIKHOA_ID,PK.SANPHUKHOA,PK.PLSANPHUKHOA_ID,PK.BACSISANPHUKHOA_ID,MAT.COKINHMATTRAI        ,MAT.COKINHMATPHAI,MAT.KHONGKINHMATTRAI,MAT.KHONGKINHMATPHAI,MAT.CACBENHVEMAT,MAT.PLMAT_ID,MAT.BACSIMAT_ID        ,TMH.TAITRAINOITHUONG,TMH.TAITRAINOITHAM,TMH.TAIPHAINOITHUONG,TMH.TAIPHAINOITHAM,TMH.CACBENHVETAI,TMH.PLTAIMH_ID,TMH.BACSITMH_ID        ,RHM.HAMTREN,RHM.HAMDUOI,RHM.CACBENHVERHM,RHM.PLRHM_ID,RHM.BACSIRHM_ID,DL.DALIEU,DL.PLDALIEU_ID,DL.BACSIDALIEU_ID        ,KQ.BACSIKETLUAN_ID,KQ.NHANXET,KQ.XEPLOAI_ID,KQ.TENICD        FROM TT_KSK_KETQUA KQ        LEFT JOIN TT_KSK_KETQUA_NOI N ON KQ.KETQUA_ID = N.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_NGOAI NG ON KQ.KETQUA_ID=NG.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_MAT MAT ON KQ.KETQUA_ID=MAT.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_PHUKHOA PK ON KQ.KETQUA_ID=PK.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_RHM RHM ON KQ.KETQUA_ID=RHM.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_TMH TMH ON KQ.KETQUA_ID=TMH.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_DALIEU DL ON KQ.KETQUA_ID=DL.KETQUA_ID        LEFT JOIN TT_NGOAITRU_KHAMBENH_SINHHIEU SH ON KQ.TIEPNHAN_ID = SH.TIEPNHAN_ID        where (DL.HOPDONG_BENHNHAN_ID  = 203 and DL.BENHVIEN_ID = 'HLU01')        OR (KQ.HOPDONG_BENHNHAN_ID  = 203 and KQ.BENHVIEN_ID = 'HLU01')        OR (N.HOPDONG_BENHNHAN_ID  = 203 and N.BENHVIEN_ID = 'HLU01')        OR (NG.HOPDONG_BENHNHAN_ID  = 203 and NG.BENHVIEN_ID = 'HLU01')        OR (RHM.HOPDONG_BENHNHAN_ID  = 203 and RHM.BENHVIEN_ID = 'HLU01')        OR (MAT.HOPDONG_BENHNHAN_ID  = 203 and MAT.BENHVIEN_ID = 'HLU01')        OR (PK.HOPDONG_BENHNHAN_ID  = 203 and PK.BENHVIEN_ID = 'HLU01')        OR (TMH.HOPDONG_BENHNHAN_ID  = 203 and TMH.BENHVIEN_ID = 'HLU01')]
2019-08-26 14:04:39,026 [1] DEBUG - Statement Id: [DAO00328_GetPatientId] PreparedStatement : [select BN.*, KQ.KETQUA_ID        from TT_KSK_HOPDONG_BENHNHAN BN        left join TT_KSK_KETQUA KQ on KQ.HOPDONG_BENHNHAN_ID = BN.HOPDONG_BENHNHAN_ID         where                 BN.BENHNHAN_ID = 23420             and               BN.BENHVIEN_ID = 'HLU01']
2019-08-26 14:04:39,104 [1] DEBUG - Statement Id: [DAO00329_Insert_Data] PreparedStatement : [DECLARE @CHECK int        IF (SELECT COUNT(*) FROM TT_KSK_KETQUA WHERE HOPDONG_ID=3 AND HOPDONG_BENHNHAN_ID=203) = 0        BEGIN        INSERT INTO TT_KSK_KETQUA (TIEPNHAN_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values( @param0 , @param1 , @param2 , @param3 );        SET @CHECK = (SELECT SCOPE_IDENTITY())        INSERT INTO TT_KSK_KETQUA_NOI(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_NGOAI(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_DALIEU(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_PHUKHOA(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_RHM(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_TMH(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_MAT(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        END        ELSE        BEGIN        RETURN        END;]
2019-08-26 14:04:39,105 [1] DEBUG - Statement Id: [DAO00329_Insert_Data] Parameters: [@param0=[TIEPNHAN_ID,27475], @param1=[HOPDONG_ID,3], @param2=[HOPDONG_BENHNHAN_ID,203], @param3=[BENHVIEN_ID,HLU01]]
2019-08-26 14:04:39,105 [1] DEBUG - Statement Id: [DAO00329_Insert_Data] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64], @param2=[Int64, System.Int64], @param3=[String, System.String]]
2019-08-26 14:04:39,132 [1] DEBUG - Statement Id: [DAO00309_GhiChu] PreparedStatement : [select GHICHU from TT_KSK_HOPDONG_BENHNHAN where HOPDONG_BENHNHAN_ID = 203]
2019-08-26 14:04:39,187 [1] DEBUG - Statement Id: [DAO00328_GetKetQuaKSK] PreparedStatement : [SELECT KQ.KETQUA_ID,KQ.TIEPNHAN_ID,KQ.HOPDONG_ID,KQ.HOPDONG_BENHNHAN_ID,SH.MACH,SH.CANNANG,SH.CHIEUCAO,SH.HUYETAPCAO,SH.HUYETAPTHAP,SH.NHIPTHO,SH.NHIETDO,SH.CHISOBMI AS BMI        ,N.TUANHOAN,N.PLTUANHOAN_ID,N.HOHAP,n.PLHOHAP_ID,N.TIEUHOA,N.PLTIEUHOA_ID,N.THAN,N.PLTHAN_ID,N.NOITIET,N.PLNOITIET_ID        ,N.COXUONGKHOP,N.PLCOXUONGKHOP_ID,N.THANKINH,N.PLTHANKINH_ID,N.TAMTHAN,N.PLTAMTHAN_ID,N.BACSIKHAMNOI_ID,NG.NGOAIKHOA        ,NG.PLNGOAIKHOA_ID,NG.BACSINGOAIKHOA_ID,PK.SANPHUKHOA,PK.PLSANPHUKHOA_ID,PK.BACSISANPHUKHOA_ID,MAT.COKINHMATTRAI        ,MAT.COKINHMATPHAI,MAT.KHONGKINHMATTRAI,MAT.KHONGKINHMATPHAI,MAT.CACBENHVEMAT,MAT.PLMAT_ID,MAT.BACSIMAT_ID        ,TMH.TAITRAINOITHUONG,TMH.TAITRAINOITHAM,TMH.TAIPHAINOITHUONG,TMH.TAIPHAINOITHAM,TMH.CACBENHVETAI,TMH.PLTAIMH_ID,TMH.BACSITMH_ID        ,RHM.HAMTREN,RHM.HAMDUOI,RHM.CACBENHVERHM,RHM.PLRHM_ID,RHM.BACSIRHM_ID,DL.DALIEU,DL.PLDALIEU_ID,DL.BACSIDALIEU_ID        ,KQ.BACSIKETLUAN_ID,KQ.NHANXET,KQ.XEPLOAI_ID,KQ.TENICD        FROM TT_KSK_KETQUA KQ        LEFT JOIN TT_KSK_KETQUA_NOI N ON KQ.KETQUA_ID = N.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_NGOAI NG ON KQ.KETQUA_ID=NG.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_MAT MAT ON KQ.KETQUA_ID=MAT.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_PHUKHOA PK ON KQ.KETQUA_ID=PK.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_RHM RHM ON KQ.KETQUA_ID=RHM.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_TMH TMH ON KQ.KETQUA_ID=TMH.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_DALIEU DL ON KQ.KETQUA_ID=DL.KETQUA_ID        LEFT JOIN TT_NGOAITRU_KHAMBENH_SINHHIEU SH ON KQ.TIEPNHAN_ID = SH.TIEPNHAN_ID        where (DL.HOPDONG_BENHNHAN_ID  = 203 and DL.BENHVIEN_ID = 'HLU01')        OR (KQ.HOPDONG_BENHNHAN_ID  = 203 and KQ.BENHVIEN_ID = 'HLU01')        OR (N.HOPDONG_BENHNHAN_ID  = 203 and N.BENHVIEN_ID = 'HLU01')        OR (NG.HOPDONG_BENHNHAN_ID  = 203 and NG.BENHVIEN_ID = 'HLU01')        OR (RHM.HOPDONG_BENHNHAN_ID  = 203 and RHM.BENHVIEN_ID = 'HLU01')        OR (MAT.HOPDONG_BENHNHAN_ID  = 203 and MAT.BENHVIEN_ID = 'HLU01')        OR (PK.HOPDONG_BENHNHAN_ID  = 203 and PK.BENHVIEN_ID = 'HLU01')        OR (TMH.HOPDONG_BENHNHAN_ID  = 203 and TMH.BENHVIEN_ID = 'HLU01')]
--------------------------------------------------------------------------------
2019-08-26 14:59:36,361 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2019-08-26 14:59:36,693 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-08-26 14:59:36,735 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-08-26 14:59:37,216 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 14:59:37,623 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-08-26 15:01:46,190 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2019-08-26 15:01:46,216 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-08-26 15:01:47,590 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-08-26 15:01:47,668 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-08-26 15:01:48,435 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2019-08-26 15:01:48,616 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2019-08-26 15:01:48,720 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2019-08-26 15:01:48,804 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2019-08-26 15:01:48,876 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2019-08-26 15:01:48,954 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2019-08-26 15:01:49,099 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2019-08-26 15:01:49,172 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2019-08-26 15:01:49,261 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2019-08-26 15:01:49,792 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2019-08-26 15:01:49,829 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2019-08-26 15:01:49,903 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2019-08-26 15:01:49,935 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2019-08-26 15:01:50,736 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2019-08-26 15:01:50,768 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 0 as PHAMVI_ID, 0 as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0         end                else        begin        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2019-08-26 15:01:52,670 [5] DEBUG - Statement Id: [DAO00320_GetList] PreparedStatement : [select M.*            from TM_MAU M            LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID            where            M.TAMNGUNG = '0'            and M.BENHVIEN_ID = 'HLU01'            order by M.TENMAU]
2019-08-26 15:01:52,735 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2019-08-26 15:01:52,768 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT          TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,          TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,          SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH          FROM TT_MAU_TONKHO TK          JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID          JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID          JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'          LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID          LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID          WHERE TK.SOLUONG > 0          GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,          TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2019-08-26 15:01:52,845 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2019-08-26 15:01:52,876 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct          TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,          TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,          TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH          from TM_MAU M          JOIN          (          select          A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO          from          (          select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO          from TT_MAU_TONKHO TK          JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID          inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID          left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'          where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0          ) A          )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'          LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID          LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2019-08-26 15:01:52,941 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2019-08-26 15:01:53,842 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 15:01:55,824 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2019-08-26 15:02:00,097 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2019-08-26 15:02:00,271 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2019-08-26 15:02:00,351 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 15:02:00,476 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 15:02:00,642 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2019-08-26 15:02:00,644 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-08-26 15:02:00,644 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-08-26 15:02:00,676 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2019-08-26 15:02:00,676 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-08-26 15:02:00,676 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-08-26 15:02:00,800 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 15:02:00,972 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 15:02:08,097 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 15:02:08,185 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2019-08-26 15:02:08,453 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2019-08-26 15:02:58,299 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'BIL27'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 15:02:59,215 [1] DEBUG - Statement Id: [DAO00012_GetList] PreparedStatement : [select        DICTIONARY_ID,        DICTIONARY_CODE,        DICTIONARY_NAME,        ATTRIBUTE1,        ATTRIBUTE2,        DICTIONARY_NAME_EN        from LST_DICTIONARY        where LST_DICTIONARY.Enabled = '1'         AND           LST_DICTIONARY.DICTIONARY_TYPE_CODE = 'LoaiHoaDon'                 order by LST_DICTIONARY.IDX]
2019-08-26 15:02:59,928 [1] DEBUG - Statement Id: [DAO00119_GetDanhsachHTTT] PreparedStatement : [select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE = 'HinhThucThanhToan' and ENABLED = '1' and BENHVIEN_ID = 'HLU01']
2019-08-26 15:03:13,091 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM57'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 15:03:13,654 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM98'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 15:03:14,171 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_GetList_TamUng] PreparedStatement : [select A.*, B.HUYHOADON as HUYHOANUNG              from TT_HOADON A LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID              where              A.DATHANHTOAN = '1'              and A.TRANGTHAI = 'DATHUTIEN'                and                       A.LOAIHOADON = 'TU'                   and                       A.HUYHOADON = '0'                   and                   A.HOANTRA = '0'                               order by HOADON_ID]
2019-08-26 15:06:02,859 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2019-08-26 15:06:02,859 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,HLU01]]
2019-08-26 15:06:02,859 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2019-08-26 15:06:03,409 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1              and               BLCT.BIENLAICHITIET_ID = '2'                         order by BLCT.THOIGIANSUDUNG DESC]
2019-08-26 15:06:03,409 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,HLU01]]
2019-08-26 15:06:03,409 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2019-08-26 15:06:03,503 [1] DEBUG - Statement Id: [DAO00064_GetlistTT_TIEPNHAN_SOTHEBHYT] PreparedStatement : [select stbhyt.*, ba.SOBENHAN,         tn.SOTIEPNHAN, tn.LOAITHANHVIEN_ID, tn.THE_ID, tn.THANHVIEN_ID,        tn.SUDUNG_BHTN, tn.BAOLANH_VIENPHI, tn.VIP, tn.NGUOINUOCNGOAI        from TT_TIEPNHAN_SOTHEBHYT stbhyt        left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = stbhyt.TIEPNHAN_ID        left join TT_NOITRU_BENHAN ba on ba.TIEPNHAN_ID = stbhyt.TIEPNHAN_ID        where         stbhyt.TIEPNHAN_ID = '27468' and isnull(stbhyt.KHONGSUDUNG, '0') = '0']
2019-08-26 15:06:03,548 [1] DEBUG - Statement Id: [DAO00064_GetListVienPhiByTiepNnan] PreparedStatement : [select distinct        B.DOITUONG_ID, B.NGAYMIENDONGCHITRA, B.BENHNHAN_ID as TIEPNHAN_BENHNHAN_ID, B.TRAITUYEN,        B.BHYTTREN3NAM as TREN3NAM, B.BHYTTREN5NAM as TREN5NAM, B.SOTIEPNHAN, B.SOBENHAN,        B.LOAITHANHVIEN_ID, B.SUDUNG_BHTN, B.THE_ID, B.THANHVIEN_ID, B.BAOLANH_VIENPHI, B.VIP, B.NGUOINUOCNGOAI,        C.GIATRIMIENGIAM as GIATRIMIENGIAM, D.GIATRIMIENGIAM as GIATRIMIENGIAM_BHTN, E.GIATRIMIENGIAM as GIATRIMIENGIAM_THANHVIEN,        F.GIATRIMIENGIAM as GIATRIMIENGIAM_CONGTY, DVYC.THE_ID as DVDUNGTHE, DVYC.TRANGTHAI as TRANGTHAIDICHVU, ndv.MANHOMDICHVU,        A.* from TT_VIENPHI A        left join        (select B.*, C.SOBENHAN, C.BENHAN_ID        from TT_TIEPNHAN B        left join TT_NOITRU_BENHAN C on B.TIEPNHAN_ID = C.TIEPNHAN_ID                 where B.TIEPNHAN_ID = '27468') B on B.TIEPNHAN_ID = A.TIEPNHAN_ID        left join (select sum(GIATRIMIENGIAM) as GIATRIMIENGIAM, VIENPHI_ID, REF_TABLE        from TT_MIENGIAM_CHITIET        where REF_TABLE = 'TT_MIENGIAM'        and exists (select MIENGIAM_ID from TT_MIENGIAM where TT_MIENGIAM_CHITIET.MIENGIAM_ID = MIENGIAM_ID and TINHTRANG = 1 and TIEPNHAN_ID = '27468')        group by VIENPHI_ID, REF_TABLE) C on C.REF_TABLE = 'TT_MIENGIAM' and C.VIENPHI_ID = A.VIENPHI_ID        left join (select sum(GIATRIMIENGIAM) as GIATRIMIENGIAM, VIENPHI_ID, REF_TABLE        from TT_MIENGIAM_CHITIET        where REF_TABLE = 'TT_MIENGIAM_BHTN'        and exists (select MIENGIAM_BHTN_ID from TT_MIENGIAM_BHTN where TT_MIENGIAM_CHITIET.MIENGIAM_ID = MIENGIAM_BHTN_ID and  TINHTRANG = 1 and TIEPNHAN_ID = '27468')        group by VIENPHI_ID, REF_TABLE) D on D.REF_TABLE = 'TT_MIENGIAM_BHTN' and D.VIENPHI_ID = A.VIENPHI_ID        left join (select sum(GIATRIMIENGIAM) as GIATRIMIENGIAM, VIENPHI_ID, REF_TABLE        from TT_MIENGIAM_CHITIET        where REF_TABLE = 'TT_MIENGIAM_THANHVIEN'        and exists (select MIENGIAM_THANHVIEN_ID from TT_MIENGIAM_THANHVIEN where TT_MIENGIAM_CHITIET.MIENGIAM_ID = MIENGIAM_THANHVIEN_ID and TINHTRANG = 1 and TIEPNHAN_ID = '27468')        group by VIENPHI_ID, REF_TABLE) E on E.REF_TABLE = 'TT_MIENGIAM_THANHVIEN' and E.VIENPHI_ID = A.VIENPHI_ID        left join (select sum(GIATRIMIENGIAM) as GIATRIMIENGIAM, VIENPHI_ID, REF_TABLE        from TT_MIENGIAM_CHITIET        where REF_TABLE = 'TT_MIENGIAM_CONGTY'        and exists (select MIENGIAM_CONGTY_ID from TT_MIENGIAM_CONGTY where TT_MIENGIAM_CHITIET.MIENGIAM_ID = MIENGIAM_CONGTY_ID and TINHTRANG = 1 and TIEPNHAN_ID = '27468')        group by VIENPHI_ID, REF_TABLE) F on F.REF_TABLE = 'TT_MIENGIAM_CONGTY' and F.VIENPHI_ID = A.VIENPHI_ID        left join TT_DVYEUCAU DVYC on DVYC.DVYEUCAU_ID = A.REF_ID and A.REF_TABLE = 'TT_DVYEUCAU'        left join TM_DICHVU DV on DVYC.DICHVU_ID = DV.DICHVU_ID and A.REF_TABLE = 'TT_DVYEUCAU'        left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = DV.NHOMDICHVU_ID and A.REF_TABLE = 'TT_DVYEUCAU'        where        A.TIEPNHAN_ID = '27468' and ((DVYC.HUYYEUCAU = '0' and A.DICHVU_ID is not null)        or A.DUOC_ID is not null or A.REF_TABLE = 'TT_NUT_XACNHANSUATAN_CHITIET')        and A.ACTIVE = '1'                 and A.BENHVIEN_ID = 'HLU01'        order by A.VIENPHI_ID]
2019-08-26 15:06:03,960 [1] DEBUG - Statement Id: [DAO00087_GetServiceParams] PreparedStatement : [select CODE, VALUE              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01']
2019-08-26 15:06:04,054 [1] DEBUG - Statement Id: [DAO00006_GetListDuocTyle] PreparedStatement : [select DUOC_ID, DOITUONG_ID, (TYLE/100) as TYLE, DONGIA MUCTRAN_THANHTOAN from TM_DOITUONG_GIADUOC_TYLE            where            BENHVIEN_ID = 'HLU01'            and DOITUONG_ID = '0']
2019-08-26 15:06:04,079 [1] DEBUG - Statement Id: [DAO00027_GetListTuongTrinhDichVuPhauThuatCuaTiepNhan] PreparedStatement : [declare @ManhomDSA varchar(10);        declare @PhanLoaiNhomDV varchar(20) = '05';        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        if (@ManhomDSA is not null) set @PhanLoaiNhomDV += ',' + @ManhomDSA        select distinct ptyc.*        from TT_PHAUTHUAT_YEUCAU ptyc        inner join TM_DICHVU dv on dv.DICHVU_ID = ptyc.DICHVU_ID        inner join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID        inner join TT_PHAUTHUAT pt on pt.PHAUTHUAT_ID = ptyc.PHAUTHUAT_ID        where        pt.TIEPNHAN_ID = 27468        and (left(ndv.MANHOMDICHVU, 2) in (select * from STRING_SPLIT(@PhanLoaiNhomDV,',')) or ndv.MANHOMDICHVU in (select * from STRING_SPLIT(@PhanLoaiNhomDV,',')))]
2019-08-26 15:06:04,164 [1] DEBUG - Statement Id: [DAO00006_GetList] PreparedStatement : [select dv.*, loaiDV.MALOAIDICHVU, captren.NHOMDICHVU_ID as NHOMDICHVU_CAPTREN_ID, captren.TENNHOMDICHVU as NHOMDICHVU_CAPTREN,              nhom_dv.TENNHOMDICHVU as TENNHOMDICHVU, nhom_dv.MANHOMDICHVU,              case when dv.ATTRIBUTE5 is null then 'TT' else 'KTC' end as LOAI_CHIPHI              from TM_DICHVU as dv              left join TM_NHOMDICHVU as nhom_dv on nhom_dv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID and nhom_dv.BENHVIEN_ID = 'HLU01'              left join TM_NHOMDICHVU as captren on nhom_dv.CAPTREN_ID = captren.NHOMDICHVU_ID and captren.BENHVIEN_ID = 'HLU01'              left join TM_LOAIDICHVU loaiDV on nhom_dv.LOAIDICHVU_ID = loaiDV.LOAIDICHVU_ID and loaiDV.BENHVIEN_ID = 'HLU01'              where nhom_dv.TAMNGUNG = '0' and dv.BENHVIEN_ID = 'HLU01'              and dv.TAMNGUNG = '0'               AND                   loaiDV.MALOAIDICHVU = 'KhamBenh']
2019-08-26 15:06:04,256 [1] DEBUG - Statement Id: [DAO00023_UpdateNhieuVP] PreparedStatement : [declare @jsonVienPhi nvarchar(max) = N'[{"VIENPHI_ID":674678,"TIEPNHAN_ID":27468,"BENHAN_ID":0,"SOLUONG":1.0000,"DONGIA_DOANHTHU":70000.0000,"THANHTIEN_DOANHTHU":70000.00,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":0.0,"BHYT_CONGKHAM_DAU_TYLE":0.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":null,"SOBHYT_HUONG_ID":28491},{"VIENPHI_ID":674679,"TIEPNHAN_ID":27468,"BENHAN_ID":0,"SOLUONG":1.0000,"DONGIA_DOANHTHU":50000.0000,"THANHTIEN_DOANHTHU":50000.00,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":0.0,"BHYT_CONGKHAM_DAU_TYLE":0.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":null,"SOBHYT_HUONG_ID":28491},{"VIENPHI_ID":674680,"TIEPNHAN_ID":27468,"BENHAN_ID":0,"SOLUONG":1.0000,"DONGIA_DOANHTHU":260000.0000,"THANHTIEN_DOANHTHU":260000.00,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":0.0,"BHYT_CONGKHAM_DAU_TYLE":0.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":null,"SOBHYT_HUONG_ID":28491}]';        begin        UPDATE TT_VIENPHI        SET        SOLUONG = json.SOLUONG,        DONGIA_DOANHTHU = json.DONGIA_DOANHTHU,        THANHTIEN_DOANHTHU = json.THANHTIEN_DOANHTHU,        BHYT_TL = json.BHYT_TL,        BHYT_DONGIA = json.BHYT_DONGIA,        BHYT_THANHTIEN = json.BHYT_THANHTIEN,        BHYT_DONGIA_CONGKHAM_DAU = json.BHYT_DONGIA_CONGKHAM_DAU,        BHYT_CONGKHAM_DAU_TYLE = json.BHYT_CONGKHAM_DAU_TYLE,        BHYT_DONGIA_CHITRA = json.BHYT_DONGIA_CHITRA,        BHYT_THANHTIEN_CHITRA = json.BHYT_THANHTIEN_CHITRA,        BENHNHAN_PHAITHANHTOAN = json.BENHNHAN_PHAITHANHTOAN,        GIATRI_HOADON = json.GIATRI_HOADON,                GIATRI_BIENLAI = json.GIATRI_BIENLAI,                DATHUCHIEN = json.DATHUCHIEN,                DICHVU_TL = json.DICHVU_TL,        BHYT_DONGIA_DONGCT_DAU = json.BHYT_DONGIA_DONGCT_DAU,        NGAYCAPNHAT = GETDATE()        FROM OPENJSON (@jsonVienPhi)        WITH (        VIENPHI_ID int,        SOLUONG numeric(25, 4),        DONGIA_DOANHTHU numeric(25, 4),        THANHTIEN_DOANHTHU numeric(25, 4),        BHYT_TL numeric(25, 4),        BHYT_DONGIA numeric(25, 4),        BHYT_THANHTIEN numeric(25, 4),        BHYT_DONGIA_CONGKHAM_DAU numeric(25, 4),        BHYT_CONGKHAM_DAU_TYLE numeric(25, 4),        BHYT_DONGIA_CHITRA numeric(25, 4),        BHYT_THANHTIEN_CHITRA numeric(25, 4),        BENHNHAN_PHAITHANHTOAN numeric(25, 4),        GIATRI_HOADON numeric(25, 4),                GIATRI_BIENLAI numeric(25, 4),                DATHUCHIEN char(1),        KHONGTHUTIEN char(1),        BHYTDONGTIEN char(1),        DICHVU_TL numeric(25, 4),        BHYT_DONGIA_DONGCT_DAU numeric(25, 4))  json        WHERE TT_VIENPHI.VIENPHI_ID = json.VIENPHI_ID                        insert into TT_TINH_VIENPHI_LOG        SELECT json.VIENPHI_ID, json.TIEPNHAN_ID, json.BENHAN_ID, json.SOLUONG, json.BHYT_TL, json.DONGIA_DOANHTHU,        json.THANHTIEN_DOANHTHU, json.BHYT_DONGIA, json.BHYT_THANHTIEN, json.BHYT_DONGIA_CHITRA, json.BHYT_THANHTIEN_CHITRA, json.BENHNHAN_PHAITHANHTOAN,        json.SOBHYT_HUONG_ID, json.SOBHYT, GETDATE(), -1, 'HLU01'        FROM OPENJSON(@jsonVienPhi)        WITH (        VIENPHI_ID int,        TIEPNHAN_ID int,        BENHAN_ID int,        SOLUONG numeric(25, 4),        DONGIA_DOANHTHU numeric(25, 4),        THANHTIEN_DOANHTHU numeric(25, 4),        BHYT_TL numeric(25, 4),        BHYT_DONGIA numeric(25, 4),        BHYT_THANHTIEN numeric(25, 4),        BHYT_DONGIA_CHITRA numeric(25, 4),        BHYT_THANHTIEN_CHITRA numeric(25, 4),        BENHNHAN_PHAITHANHTOAN numeric(25, 4),        SOBHYT_HUONG_ID int,        SOBHYT nvarchar(30)) json        end]
2019-08-26 15:06:04,366 [1] DEBUG - Statement Id: [DAO00067_CapnhatDataVienphiKhiHuyThanhtoanHoadon] PreparedStatement : [update TT_VIENPHI        set TT_VIENPHI.HOADON_ID = hdct.HOADON_ID, TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN = TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN + hdct.GIATRI_BENHNHAN_DATHANHTOAN        from (select CT.HOADON_ID, CT.VIENPHI_ID, CT.GIATRI_BENHNHAN_DATHANHTOAN        from TT_HOADON_CHITIET_NGOAITRU CT        join TT_HOADON HD on HD.HOADON_ID = CT.HOADON_ID        join TT_VIENPHI vp on vp.VIENPHI_ID = ct.VIENPHI_ID        where HD.DATHANHTOAN = 1 and HD.HUYHOADON = 0 and HD.HOANTRA = 0 and vp.TIEPNHAN_ID =  @param0 ) hdct        where        TT_VIENPHI.VIENPHI_ID = hdct.VIENPHI_ID and TT_VIENPHI.HOADON_ID is null and isnull(TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN,0) = 0        and TT_VIENPHI.TIEPNHAN_ID =  @param0           update TT_VIENPHI        set TT_VIENPHI.HOADON_ID = null, TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN = TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN - hdct.GIATRI_BENHNHAN_DATHANHTOAN,        TT_VIENPHI.DATHANHTOAN = '0'        from (select CT.HOADON_ID, CT.VIENPHI_ID, CT.GIATRI_BENHNHAN_DATHANHTOAN        from TT_HOADON_CHITIET_NGOAITRU CT        join TT_HOADON HD on HD.HOADON_ID = CT.HOADON_ID        join TT_VIENPHI vp on vp.VIENPHI_ID = ct.VIENPHI_ID and vp.HOADON_ID = ct.HOADON_ID        where HD.DATHANHTOAN = 0 and (HD.HUYHOADON = 1 or HD.HOANTRA = 1) and vp.TIEPNHAN_ID =  @param0 ) hdct        where        TT_VIENPHI.VIENPHI_ID = hdct.VIENPHI_ID and TT_VIENPHI.HOADON_ID = hdct.HOADON_ID        and TT_VIENPHI.TIEPNHAN_ID =  @param0]
2019-08-26 15:06:04,366 [1] DEBUG - Statement Id: [DAO00067_CapnhatDataVienphiKhiHuyThanhtoanHoadon] Parameters: [@param0=[TIEPNHAN_ID,27468]]
2019-08-26 15:06:04,366 [1] DEBUG - Statement Id: [DAO00067_CapnhatDataVienphiKhiHuyThanhtoanHoadon] Types: [@param0=[Int64, System.Int64]]
2019-08-26 15:06:04,563 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_GetList_TamUng] PreparedStatement : [select A.*, B.HUYHOADON as HUYHOANUNG              from TT_HOADON A LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID              where              A.DATHANHTOAN = '1'              and A.TRANGTHAI = 'DATHUTIEN'                and                       A.LOAIHOADON = 'TU'                   and                       A.TIEPNHAN_ID = '27468'                   and                       A.HUYHOADON = '0'                   and                   A.HOANTRA = '0'                               order by HOADON_ID]
2019-08-26 15:06:06,496 [1] DEBUG - Statement Id: [DAO00119_TT_VIENPHI_GetList_TiepNhanPhaiThanhToan] PreparedStatement : [select distinct  a.*, b.GIATRIMIENGIAM_BH, c.GIATRIMIENGIAM_BHTN, f.GIATRIMIENGIAM_THANHVIEN, g.GIATRIMIENGIAM_CTCT,        isnull(dv.TENDICHVU, dc.TENDUOCDAYDU) NOIDUNG, isnull(dv.MADICHVU, dc.MADUOC) MADICHVU, dv.NORESULT, dc.DONVITINH, ld.MALOAIDUOC, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ndv.MANHOMDICHVU        from        (select VP.*, c.NOITHUCHIEN_ID, c.NOIYEUCAU_ID, c.THUTIENSAU, isnull(c.TRANGTHAI, '') TRANGTHAI        from TT_VIENPHI VP        left join TT_DVYEUCAU c on c.DVYEUCAU_ID = VP.REF_ID  and vp.REF_TABLE = 'TT_DVYEUCAU'        where Vp.TIEPNHAN_ID = '27468' and Vp.ACTIVE = '1' and ((c.HUYYEUCAU != '1' and vp.DICHVU_ID is not null) or (vp.DUOC_ID is not null)) and        ((vp.DATHANHTOAN = '0') or (vp.BENHNHAN_PHAITHANHTOAN > vp.GIATRI_BENHNHAN_DATHANHTOAN and vp.DATHANHTOAN = '1')) and c.DANGKY_CHITIET_ID is null          AND             VP.KHONGTHUTIEN != '1'                   ) a        left join TM_DUOC dc on a.DUOC_ID = dc.DUOC_ID        left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID        left join TM_DICHVU dv on a.DICHVU_ID = dv.DICHVU_ID and a.REF_TABLE = 'TT_DVYEUCAU'        left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID        left join (select VIENPHI_ID,        sum(MGCT.GIATRIMIENGIAM) AS GIATRIMIENGIAM_BH from TT_MIENGIAM MG        INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_ID = MGCT.MIENGIAM_ID        where MG.TIEPNHAN_ID= '27468' and MGCT.REF_TABLE = 'TT_MIENGIAM' and MG.TINHTRANG = 1 group by VIENPHI_ID        ) b on a.VIENPHI_ID = b.VIENPHI_ID          left join (select VIENPHI_ID, sum(MGCT.GIATRIMIENGIAM) AS GIATRIMIENGIAM_BHTN        from TT_MIENGIAM_BHTN MG        INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_BHTN_ID = MGCT.MIENGIAM_ID        where  MG.TIEPNHAN_ID= '27468' and MGCT.REF_TABLE = 'TT_MIENGIAM_BHTN' and MG.TINHTRANG = 1 group by VIENPHI_ID        )c on a.VIENPHI_ID = c.VIENPHI_ID          left join (select VIENPHI_ID, sum(MGCT.GIATRIMIENGIAM) AS GIATRIMIENGIAM_THANHVIEN        from TT_MIENGIAM_THANHVIEN MG        INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_THANHVIEN_ID = MGCT.MIENGIAM_ID        where MG.TIEPNHAN_ID= '27468' and MGCT.REF_TABLE = 'TT_MIENGIAM_THANHVIEN' and MG.TINHTRANG = 1 group by VIENPHI_ID        )f on a.VIENPHI_ID = f.VIENPHI_ID          left join(select VIENPHI_ID, sum(MGCT.GIATRIMIENGIAM) AS GIATRIMIENGIAM_CTCT        from TT_MIENGIAM_CONGTY MG        INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_CONGTY_ID = MGCT.MIENGIAM_ID        where MG.TIEPNHAN_ID= '27468' and MGCT.REF_TABLE = 'TT_MIENGIAM_CONGTY' and MG.TINHTRANG = 1 group by VIENPHI_ID        )g on a.VIENPHI_ID = g.VIENPHI_ID]
2019-08-26 15:06:50,412 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2019-08-26 15:06:50,412 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,HLU01]]
2019-08-26 15:06:50,412 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2019-08-26 15:06:52,385 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2019-08-26 15:06:52,385 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,HLU01]]
2019-08-26 15:06:52,385 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2019-08-26 15:06:52,427 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1              and               BLCT.BIENLAICHITIET_ID = '2'                         order by BLCT.THOIGIANSUDUNG DESC]
2019-08-26 15:06:52,427 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,HLU01]]
2019-08-26 15:06:52,427 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2019-08-26 15:06:52,493 [1] DEBUG - Statement Id: [DAO00064_GetlistTT_TIEPNHAN_SOTHEBHYT] PreparedStatement : [select stbhyt.*, ba.SOBENHAN,         tn.SOTIEPNHAN, tn.LOAITHANHVIEN_ID, tn.THE_ID, tn.THANHVIEN_ID,        tn.SUDUNG_BHTN, tn.BAOLANH_VIENPHI, tn.VIP, tn.NGUOINUOCNGOAI        from TT_TIEPNHAN_SOTHEBHYT stbhyt        left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = stbhyt.TIEPNHAN_ID        left join TT_NOITRU_BENHAN ba on ba.TIEPNHAN_ID = stbhyt.TIEPNHAN_ID        where         stbhyt.TIEPNHAN_ID = '27245' and isnull(stbhyt.KHONGSUDUNG, '0') = '0']
2019-08-26 15:06:52,539 [1] DEBUG - Statement Id: [DAO00064_GetListVienPhiByTiepNnan] PreparedStatement : [select distinct        B.DOITUONG_ID, B.NGAYMIENDONGCHITRA, B.BENHNHAN_ID as TIEPNHAN_BENHNHAN_ID, B.TRAITUYEN,        B.BHYTTREN3NAM as TREN3NAM, B.BHYTTREN5NAM as TREN5NAM, B.SOTIEPNHAN, B.SOBENHAN,        B.LOAITHANHVIEN_ID, B.SUDUNG_BHTN, B.THE_ID, B.THANHVIEN_ID, B.BAOLANH_VIENPHI, B.VIP, B.NGUOINUOCNGOAI,        C.GIATRIMIENGIAM as GIATRIMIENGIAM, D.GIATRIMIENGIAM as GIATRIMIENGIAM_BHTN, E.GIATRIMIENGIAM as GIATRIMIENGIAM_THANHVIEN,        F.GIATRIMIENGIAM as GIATRIMIENGIAM_CONGTY, DVYC.THE_ID as DVDUNGTHE, DVYC.TRANGTHAI as TRANGTHAIDICHVU, ndv.MANHOMDICHVU,        A.* from TT_VIENPHI A        left join        (select B.*, C.SOBENHAN, C.BENHAN_ID        from TT_TIEPNHAN B        left join TT_NOITRU_BENHAN C on B.TIEPNHAN_ID = C.TIEPNHAN_ID                 where B.TIEPNHAN_ID = '27245') B on B.TIEPNHAN_ID = A.TIEPNHAN_ID        left join (select sum(GIATRIMIENGIAM) as GIATRIMIENGIAM, VIENPHI_ID, REF_TABLE        from TT_MIENGIAM_CHITIET        where REF_TABLE = 'TT_MIENGIAM'        and exists (select MIENGIAM_ID from TT_MIENGIAM where TT_MIENGIAM_CHITIET.MIENGIAM_ID = MIENGIAM_ID and TINHTRANG = 1 and TIEPNHAN_ID = '27245')        group by VIENPHI_ID, REF_TABLE) C on C.REF_TABLE = 'TT_MIENGIAM' and C.VIENPHI_ID = A.VIENPHI_ID        left join (select sum(GIATRIMIENGIAM) as GIATRIMIENGIAM, VIENPHI_ID, REF_TABLE        from TT_MIENGIAM_CHITIET        where REF_TABLE = 'TT_MIENGIAM_BHTN'        and exists (select MIENGIAM_BHTN_ID from TT_MIENGIAM_BHTN where TT_MIENGIAM_CHITIET.MIENGIAM_ID = MIENGIAM_BHTN_ID and  TINHTRANG = 1 and TIEPNHAN_ID = '27245')        group by VIENPHI_ID, REF_TABLE) D on D.REF_TABLE = 'TT_MIENGIAM_BHTN' and D.VIENPHI_ID = A.VIENPHI_ID        left join (select sum(GIATRIMIENGIAM) as GIATRIMIENGIAM, VIENPHI_ID, REF_TABLE        from TT_MIENGIAM_CHITIET        where REF_TABLE = 'TT_MIENGIAM_THANHVIEN'        and exists (select MIENGIAM_THANHVIEN_ID from TT_MIENGIAM_THANHVIEN where TT_MIENGIAM_CHITIET.MIENGIAM_ID = MIENGIAM_THANHVIEN_ID and TINHTRANG = 1 and TIEPNHAN_ID = '27245')        group by VIENPHI_ID, REF_TABLE) E on E.REF_TABLE = 'TT_MIENGIAM_THANHVIEN' and E.VIENPHI_ID = A.VIENPHI_ID        left join (select sum(GIATRIMIENGIAM) as GIATRIMIENGIAM, VIENPHI_ID, REF_TABLE        from TT_MIENGIAM_CHITIET        where REF_TABLE = 'TT_MIENGIAM_CONGTY'        and exists (select MIENGIAM_CONGTY_ID from TT_MIENGIAM_CONGTY where TT_MIENGIAM_CHITIET.MIENGIAM_ID = MIENGIAM_CONGTY_ID and TINHTRANG = 1 and TIEPNHAN_ID = '27245')        group by VIENPHI_ID, REF_TABLE) F on F.REF_TABLE = 'TT_MIENGIAM_CONGTY' and F.VIENPHI_ID = A.VIENPHI_ID        left join TT_DVYEUCAU DVYC on DVYC.DVYEUCAU_ID = A.REF_ID and A.REF_TABLE = 'TT_DVYEUCAU'        left join TM_DICHVU DV on DVYC.DICHVU_ID = DV.DICHVU_ID and A.REF_TABLE = 'TT_DVYEUCAU'        left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = DV.NHOMDICHVU_ID and A.REF_TABLE = 'TT_DVYEUCAU'        where        A.TIEPNHAN_ID = '27245' and ((DVYC.HUYYEUCAU = '0' and A.DICHVU_ID is not null)        or A.DUOC_ID is not null or A.REF_TABLE = 'TT_NUT_XACNHANSUATAN_CHITIET')        and A.ACTIVE = '1'                 and A.BENHVIEN_ID = 'HLU01'        order by A.VIENPHI_ID]
2019-08-26 15:06:54,612 [1] DEBUG - Statement Id: [DAO00006_GetListDuocTyle] PreparedStatement : [select DUOC_ID, DOITUONG_ID, (TYLE/100) as TYLE, DONGIA MUCTRAN_THANHTOAN from TM_DOITUONG_GIADUOC_TYLE            where            BENHVIEN_ID = 'HLU01'            and DOITUONG_ID = '0']
2019-08-26 15:06:54,656 [1] DEBUG - Statement Id: [DAO00027_GetListTuongTrinhDichVuPhauThuatCuaTiepNhan] PreparedStatement : [declare @ManhomDSA varchar(10);        declare @PhanLoaiNhomDV varchar(20) = '05';        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        if (@ManhomDSA is not null) set @PhanLoaiNhomDV += ',' + @ManhomDSA        select distinct ptyc.*        from TT_PHAUTHUAT_YEUCAU ptyc        inner join TM_DICHVU dv on dv.DICHVU_ID = ptyc.DICHVU_ID        inner join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID        inner join TT_PHAUTHUAT pt on pt.PHAUTHUAT_ID = ptyc.PHAUTHUAT_ID        where        pt.TIEPNHAN_ID = 27245        and (left(ndv.MANHOMDICHVU, 2) in (select * from STRING_SPLIT(@PhanLoaiNhomDV,',')) or ndv.MANHOMDICHVU in (select * from STRING_SPLIT(@PhanLoaiNhomDV,',')))]
2019-08-26 15:06:54,740 [1] DEBUG - Statement Id: [DAO00006_GetList] PreparedStatement : [select dv.*, loaiDV.MALOAIDICHVU, captren.NHOMDICHVU_ID as NHOMDICHVU_CAPTREN_ID, captren.TENNHOMDICHVU as NHOMDICHVU_CAPTREN,              nhom_dv.TENNHOMDICHVU as TENNHOMDICHVU, nhom_dv.MANHOMDICHVU,              case when dv.ATTRIBUTE5 is null then 'TT' else 'KTC' end as LOAI_CHIPHI              from TM_DICHVU as dv              left join TM_NHOMDICHVU as nhom_dv on nhom_dv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID and nhom_dv.BENHVIEN_ID = 'HLU01'              left join TM_NHOMDICHVU as captren on nhom_dv.CAPTREN_ID = captren.NHOMDICHVU_ID and captren.BENHVIEN_ID = 'HLU01'              left join TM_LOAIDICHVU loaiDV on nhom_dv.LOAIDICHVU_ID = loaiDV.LOAIDICHVU_ID and loaiDV.BENHVIEN_ID = 'HLU01'              where nhom_dv.TAMNGUNG = '0' and dv.BENHVIEN_ID = 'HLU01'              and dv.TAMNGUNG = '0'               AND                   loaiDV.MALOAIDICHVU = 'KhamBenh']
2019-08-26 15:06:54,781 [1] DEBUG - Statement Id: [DAO00023_UpdateNhieuVP] PreparedStatement : [declare @jsonVienPhi nvarchar(max) = N'[{"VIENPHI_ID":669834,"TIEPNHAN_ID":27245,"BENHAN_ID":0,"SOLUONG":1.0000,"DONGIA_DOANHTHU":50000.0000,"THANHTIEN_DOANHTHU":50000.00,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":0.0,"BHYT_CONGKHAM_DAU_TYLE":0.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":50000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":50000.0000,"GIATRI_BIENLAI":50000.00,"GIATRI_BIENLAI_DATHANHTOAN":50000.0000,"GIATRI_BENHNHAN_DATHANHTOAN":50000.0000,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"","SOBHYT_HUONG_ID":28272},{"VIENPHI_ID":669835,"TIEPNHAN_ID":27245,"BENHAN_ID":0,"SOLUONG":1.0000,"DONGIA_DOANHTHU":5000.0000,"THANHTIEN_DOANHTHU":5000.00,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":0.0,"BHYT_CONGKHAM_DAU_TYLE":0.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":5000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":5000.0000,"GIATRI_BIENLAI":5000.00,"GIATRI_BIENLAI_DATHANHTOAN":5000.0000,"GIATRI_BENHNHAN_DATHANHTOAN":5000.0000,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"","SOBHYT_HUONG_ID":28272},{"VIENPHI_ID":670194,"TIEPNHAN_ID":27245,"BENHAN_ID":0,"SOLUONG":1.0000,"DONGIA_DOANHTHU":50000.0000,"THANHTIEN_DOANHTHU":50000.00,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":0.0,"BHYT_CONGKHAM_DAU_TYLE":0.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":50000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":50000.0000,"GIATRI_BIENLAI":50000.00,"GIATRI_BIENLAI_DATHANHTOAN":50000.0000,"GIATRI_BENHNHAN_DATHANHTOAN":50000.0000,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"","SOBHYT_HUONG_ID":28272},{"VIENPHI_ID":670195,"TIEPNHAN_ID":27245,"BENHAN_ID":0,"SOLUONG":1.0000,"DONGIA_DOANHTHU":70000.0000,"THANHTIEN_DOANHTHU":70000.00,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":0.0,"BHYT_CONGKHAM_DAU_TYLE":0.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":70000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":70000.0000,"GIATRI_BIENLAI":70000.00,"GIATRI_BIENLAI_DATHANHTOAN":70000.0000,"GIATRI_BENHNHAN_DATHANHTOAN":70000.0000,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"","SOBHYT_HUONG_ID":28272},{"VIENPHI_ID":672890,"TIEPNHAN_ID":27245,"BENHAN_ID":0,"SOLUONG":1.0000,"DONGIA_DOANHTHU":45000.0000,"THANHTIEN_DOANHTHU":45000.00,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":0.0,"BHYT_CONGKHAM_DAU_TYLE":0.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":45000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":45000.0000,"GIATRI_BIENLAI":45000.00,"GIATRI_BIENLAI_DATHANHTOAN":45000.0000,"GIATRI_BENHNHAN_DATHANHTOAN":45000.0000,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"","SOBHYT_HUONG_ID":28272}]';        begin        UPDATE TT_VIENPHI        SET        SOLUONG = json.SOLUONG,        DONGIA_DOANHTHU = json.DONGIA_DOANHTHU,        THANHTIEN_DOANHTHU = json.THANHTIEN_DOANHTHU,        BHYT_TL = json.BHYT_TL,        BHYT_DONGIA = json.BHYT_DONGIA,        BHYT_THANHTIEN = json.BHYT_THANHTIEN,        BHYT_DONGIA_CONGKHAM_DAU = json.BHYT_DONGIA_CONGKHAM_DAU,        BHYT_CONGKHAM_DAU_TYLE = json.BHYT_CONGKHAM_DAU_TYLE,        BHYT_DONGIA_CHITRA = json.BHYT_DONGIA_CHITRA,        BHYT_THANHTIEN_CHITRA = json.BHYT_THANHTIEN_CHITRA,        BENHNHAN_PHAITHANHTOAN = json.BENHNHAN_PHAITHANHTOAN,        GIATRI_HOADON = json.GIATRI_HOADON,                GIATRI_BIENLAI = json.GIATRI_BIENLAI,                DATHUCHIEN = json.DATHUCHIEN,                DICHVU_TL = json.DICHVU_TL,        BHYT_DONGIA_DONGCT_DAU = json.BHYT_DONGIA_DONGCT_DAU,        NGAYCAPNHAT = GETDATE()        FROM OPENJSON (@jsonVienPhi)        WITH (        VIENPHI_ID int,        SOLUONG numeric(25, 4),        DONGIA_DOANHTHU numeric(25, 4),        THANHTIEN_DOANHTHU numeric(25, 4),        BHYT_TL numeric(25, 4),        BHYT_DONGIA numeric(25, 4),        BHYT_THANHTIEN numeric(25, 4),        BHYT_DONGIA_CONGKHAM_DAU numeric(25, 4),        BHYT_CONGKHAM_DAU_TYLE numeric(25, 4),        BHYT_DONGIA_CHITRA numeric(25, 4),        BHYT_THANHTIEN_CHITRA numeric(25, 4),        BENHNHAN_PHAITHANHTOAN numeric(25, 4),        GIATRI_HOADON numeric(25, 4),                GIATRI_BIENLAI numeric(25, 4),                DATHUCHIEN char(1),        KHONGTHUTIEN char(1),        BHYTDONGTIEN char(1),        DICHVU_TL numeric(25, 4),        BHYT_DONGIA_DONGCT_DAU numeric(25, 4))  json        WHERE TT_VIENPHI.VIENPHI_ID = json.VIENPHI_ID                        insert into TT_TINH_VIENPHI_LOG        SELECT json.VIENPHI_ID, json.TIEPNHAN_ID, json.BENHAN_ID, json.SOLUONG, json.BHYT_TL, json.DONGIA_DOANHTHU,        json.THANHTIEN_DOANHTHU, json.BHYT_DONGIA, json.BHYT_THANHTIEN, json.BHYT_DONGIA_CHITRA, json.BHYT_THANHTIEN_CHITRA, json.BENHNHAN_PHAITHANHTOAN,        json.SOBHYT_HUONG_ID, json.SOBHYT, GETDATE(), -1, 'HLU01'        FROM OPENJSON(@jsonVienPhi)        WITH (        VIENPHI_ID int,        TIEPNHAN_ID int,        BENHAN_ID int,        SOLUONG numeric(25, 4),        DONGIA_DOANHTHU numeric(25, 4),        THANHTIEN_DOANHTHU numeric(25, 4),        BHYT_TL numeric(25, 4),        BHYT_DONGIA numeric(25, 4),        BHYT_THANHTIEN numeric(25, 4),        BHYT_DONGIA_CHITRA numeric(25, 4),        BHYT_THANHTIEN_CHITRA numeric(25, 4),        BENHNHAN_PHAITHANHTOAN numeric(25, 4),        SOBHYT_HUONG_ID int,        SOBHYT nvarchar(30)) json        end]
2019-08-26 15:06:55,086 [1] DEBUG - Statement Id: [DAO00067_CapnhatDataVienphiKhiHuyThanhtoanHoadon] PreparedStatement : [update TT_VIENPHI        set TT_VIENPHI.HOADON_ID = hdct.HOADON_ID, TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN = TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN + hdct.GIATRI_BENHNHAN_DATHANHTOAN        from (select CT.HOADON_ID, CT.VIENPHI_ID, CT.GIATRI_BENHNHAN_DATHANHTOAN        from TT_HOADON_CHITIET_NGOAITRU CT        join TT_HOADON HD on HD.HOADON_ID = CT.HOADON_ID        join TT_VIENPHI vp on vp.VIENPHI_ID = ct.VIENPHI_ID        where HD.DATHANHTOAN = 1 and HD.HUYHOADON = 0 and HD.HOANTRA = 0 and vp.TIEPNHAN_ID =  @param0 ) hdct        where        TT_VIENPHI.VIENPHI_ID = hdct.VIENPHI_ID and TT_VIENPHI.HOADON_ID is null and isnull(TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN,0) = 0        and TT_VIENPHI.TIEPNHAN_ID =  @param0           update TT_VIENPHI        set TT_VIENPHI.HOADON_ID = null, TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN = TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN - hdct.GIATRI_BENHNHAN_DATHANHTOAN,        TT_VIENPHI.DATHANHTOAN = '0'        from (select CT.HOADON_ID, CT.VIENPHI_ID, CT.GIATRI_BENHNHAN_DATHANHTOAN        from TT_HOADON_CHITIET_NGOAITRU CT        join TT_HOADON HD on HD.HOADON_ID = CT.HOADON_ID        join TT_VIENPHI vp on vp.VIENPHI_ID = ct.VIENPHI_ID and vp.HOADON_ID = ct.HOADON_ID        where HD.DATHANHTOAN = 0 and (HD.HUYHOADON = 1 or HD.HOANTRA = 1) and vp.TIEPNHAN_ID =  @param0 ) hdct        where        TT_VIENPHI.VIENPHI_ID = hdct.VIENPHI_ID and TT_VIENPHI.HOADON_ID = hdct.HOADON_ID        and TT_VIENPHI.TIEPNHAN_ID =  @param0]
2019-08-26 15:06:55,086 [1] DEBUG - Statement Id: [DAO00067_CapnhatDataVienphiKhiHuyThanhtoanHoadon] Parameters: [@param0=[TIEPNHAN_ID,27245]]
2019-08-26 15:06:55,087 [1] DEBUG - Statement Id: [DAO00067_CapnhatDataVienphiKhiHuyThanhtoanHoadon] Types: [@param0=[Int64, System.Int64]]
2019-08-26 15:06:55,261 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_GetList_TamUng] PreparedStatement : [select A.*, B.HUYHOADON as HUYHOANUNG              from TT_HOADON A LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID              where              A.DATHANHTOAN = '1'              and A.TRANGTHAI = 'DATHUTIEN'                and                       A.LOAIHOADON = 'TU'                   and                       A.TIEPNHAN_ID = '27245'                   and                       A.HUYHOADON = '0'                   and                   A.HOANTRA = '0'                               order by HOADON_ID]
2019-08-26 15:06:57,823 [1] DEBUG - Statement Id: [DAO00119_TT_VIENPHI_GetList_TiepNhanPhaiThanhToan] PreparedStatement : [select distinct  a.*, b.GIATRIMIENGIAM_BH, c.GIATRIMIENGIAM_BHTN, f.GIATRIMIENGIAM_THANHVIEN, g.GIATRIMIENGIAM_CTCT,        isnull(dv.TENDICHVU, dc.TENDUOCDAYDU) NOIDUNG, isnull(dv.MADICHVU, dc.MADUOC) MADICHVU, dv.NORESULT, dc.DONVITINH, ld.MALOAIDUOC, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ndv.MANHOMDICHVU        from        (select VP.*, c.NOITHUCHIEN_ID, c.NOIYEUCAU_ID, c.THUTIENSAU, isnull(c.TRANGTHAI, '') TRANGTHAI        from TT_VIENPHI VP        left join TT_DVYEUCAU c on c.DVYEUCAU_ID = VP.REF_ID  and vp.REF_TABLE = 'TT_DVYEUCAU'        where Vp.TIEPNHAN_ID = '27245' and Vp.ACTIVE = '1' and ((c.HUYYEUCAU != '1' and vp.DICHVU_ID is not null) or (vp.DUOC_ID is not null)) and        ((vp.DATHANHTOAN = '0') or (vp.BENHNHAN_PHAITHANHTOAN > vp.GIATRI_BENHNHAN_DATHANHTOAN and vp.DATHANHTOAN = '1')) and c.DANGKY_CHITIET_ID is null          AND             VP.KHONGTHUTIEN != '1'                   ) a        left join TM_DUOC dc on a.DUOC_ID = dc.DUOC_ID        left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID        left join TM_DICHVU dv on a.DICHVU_ID = dv.DICHVU_ID and a.REF_TABLE = 'TT_DVYEUCAU'        left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID        left join (select VIENPHI_ID,        sum(MGCT.GIATRIMIENGIAM) AS GIATRIMIENGIAM_BH from TT_MIENGIAM MG        INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_ID = MGCT.MIENGIAM_ID        where MG.TIEPNHAN_ID= '27245' and MGCT.REF_TABLE = 'TT_MIENGIAM' and MG.TINHTRANG = 1 group by VIENPHI_ID        ) b on a.VIENPHI_ID = b.VIENPHI_ID          left join (select VIENPHI_ID, sum(MGCT.GIATRIMIENGIAM) AS GIATRIMIENGIAM_BHTN        from TT_MIENGIAM_BHTN MG        INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_BHTN_ID = MGCT.MIENGIAM_ID        where  MG.TIEPNHAN_ID= '27245' and MGCT.REF_TABLE = 'TT_MIENGIAM_BHTN' and MG.TINHTRANG = 1 group by VIENPHI_ID        )c on a.VIENPHI_ID = c.VIENPHI_ID          left join (select VIENPHI_ID, sum(MGCT.GIATRIMIENGIAM) AS GIATRIMIENGIAM_THANHVIEN        from TT_MIENGIAM_THANHVIEN MG        INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_THANHVIEN_ID = MGCT.MIENGIAM_ID        where MG.TIEPNHAN_ID= '27245' and MGCT.REF_TABLE = 'TT_MIENGIAM_THANHVIEN' and MG.TINHTRANG = 1 group by VIENPHI_ID        )f on a.VIENPHI_ID = f.VIENPHI_ID          left join(select VIENPHI_ID, sum(MGCT.GIATRIMIENGIAM) AS GIATRIMIENGIAM_CTCT        from TT_MIENGIAM_CONGTY MG        INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_CONGTY_ID = MGCT.MIENGIAM_ID        where MG.TIEPNHAN_ID= '27245' and MGCT.REF_TABLE = 'TT_MIENGIAM_CONGTY' and MG.TINHTRANG = 1 group by VIENPHI_ID        )g on a.VIENPHI_ID = g.VIENPHI_ID]
2019-08-26 15:07:05,709 [1] DEBUG - Statement Id: [DAO00119_GetDanhsachHTTT] PreparedStatement : [select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE = 'HinhThucThanhToan' and ENABLED = '1' and BENHVIEN_ID = 'HLU01']
2019-08-26 15:07:08,628 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_GetList_TamUng] PreparedStatement : [select A.*, B.HUYHOADON as HUYHOANUNG              from TT_HOADON A LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID              where              A.DATHANHTOAN = '1'              and A.TRANGTHAI = 'DATHUTIEN'                and                       A.LOAIHOADON = 'TU'                   and                       A.TIEPNHAN_ID = '27245'                   and                       A.HUYHOADON = '0'                   and                   A.HOANTRA = '0'                               order by HOADON_ID]
2019-08-26 15:07:31,282 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1              and               BLCT.BIENLAICHITIET_ID = '2'                         order by BLCT.THOIGIANSUDUNG DESC]
2019-08-26 15:07:31,282 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,HLU01]]
2019-08-26 15:07:31,282 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2019-08-26 15:07:31,329 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1              and               BLCT.BIENLAICHITIET_ID = '2'                         order by BLCT.THOIGIANSUDUNG DESC]
2019-08-26 15:07:31,329 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,HLU01]]
2019-08-26 15:07:31,329 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2019-08-26 15:07:35,196 [1] DEBUG - Statement Id: [DAO00014_GetPatientStatus] PreparedStatement : [select        CASE        when tn.TRANGTHAI = 'HOANTHANH' Then tn.TRANGTHAI        WHEN xncp.XACNHANCHIPHI_ID is not null THEN 'XACNHANCHIPHI'        WHEN (tn.KHOADULIEU = '1') THEN 'KHOADULIEU'        ELSE tn.TRANGTHAI        END        as TRANGTHAI        from TT_TIEPNHAN tn        left join TT_XACNHANCHIPHI xncp on tn.TIEPNHAN_ID = xncp.TIEPNHAN_ID        where tn.TIEPNHAN_ID = '27245'        and tn.BENHVIEN_ID = 'HLU01']
2019-08-26 15:07:35,537 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2019-08-26 15:07:35,537 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,HLU01]]
2019-08-26 15:07:35,537 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2019-08-26 15:07:35,575 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2019-08-26 15:07:35,575 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,HLU01]]
2019-08-26 15:07:35,575 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2019-08-26 15:07:35,608 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1              and               BLCT.BIENLAICHITIET_ID = '2'                         order by BLCT.THOIGIANSUDUNG DESC]
2019-08-26 15:07:35,608 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,HLU01]]
2019-08-26 15:07:35,608 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2019-08-26 15:07:35,684 [1] DEBUG - Statement Id: [DAOLOG01_LockBegin] PreparedStatement : [INSERT into TT_LOG_UPDATE ( REF_TABLE , REF_ID , BENHVIEN_ID )         values ( @param0 ,  @param1 ,  @param2 );]
2019-08-26 15:07:35,684 [1] DEBUG - Statement Id: [DAOLOG01_LockBegin] Parameters: [@param0=[REF_TABLE,TT_VIENPHI], @param1=[REF_ID,27245], @param2=[BENHVIEN_ID,HLU01]]
2019-08-26 15:07:35,684 [1] DEBUG - Statement Id: [DAOLOG01_LockBegin] Types: [@param0=[String, System.String], @param1=[Int64, System.Int64], @param2=[String, System.String]]
2019-08-26 15:07:35,722 [1] DEBUG - Statement Id: [DAO00119_TT_VIENPHI_XoaBienLaiTamNgoaiTru] PreparedStatement : [delete from TT_HOADON_HINHTHUCTHANHTOAN        where HOADON_ID = ''          delete from TT_HOADON_CHITIET_NGOAITRU        where HOADON_ID = ''          delete from TT_HOADON        where HOADON_ID = '' and TRANGTHAI in ('CHUATHUTIEN', 'CHODUYETCONGNO')          update TT_VIENPHI set HOADON_ID = null where HOADON_ID = '']
2019-08-26 15:07:37,952 [1] DEBUG - Statement Id: [DAO00055_GetDetail] PreparedStatement : [select *              from LST_KEYDATA_VIENPHI               where                             LST_KEYDATA_VIENPHI.KEYTYPE = 'HU'                       and                           LST_KEYDATA_VIENPHI.KEYYEAR = '2019'                       and                           LST_KEYDATA_VIENPHI.KEYMONTH = '8'                       and                           LST_KEYDATA_VIENPHI.KEYDAY = '0'                       and                           LST_KEYDATA_VIENPHI.SEGMENT_1 = '0'                       and                           LST_KEYDATA_VIENPHI.SEGMENT_2 = '0'                       and                           LST_KEYDATA_VIENPHI.SEGMENT_3 = '0'                                     order by KEYTYPE]
2019-08-26 15:07:38,163 [1] DEBUG - Statement Id: [DAO00055_Add] PreparedStatement : [insert into LST_KEYDATA_VIENPHI (            KEYTYPE            , KEYYEAR            , KEYMONTH            , KEYDAY            , SEGMENT_1            , SEGMENT_2            , SEGMENT_3            , KEYVALUE            , BENHVIEN_ID            ) values (             @param0             ,  @param1             ,  @param2             ,  @param3             ,  @param4             ,  @param5             ,  @param6             ,  @param7             ,  @param8             )]
2019-08-26 15:07:38,164 [1] DEBUG - Statement Id: [DAO00055_Add] Parameters: [@param0=[KEYTYPE,HU], @param1=[KEYYEAR,2019], @param2=[KEYMONTH,8], @param3=[KEYDAY,0], @param4=[SEGMENT_1,0], @param5=[SEGMENT_2,0], @param6=[SEGMENT_3,0], @param7=[KEYVALUE,000001], @param8=[BENHVIEN_ID,HLU01]]
2019-08-26 15:07:38,164 [1] DEBUG - Statement Id: [DAO00055_Add] Types: [@param0=[String, System.String], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[Int32, System.Int32], @param4=[String, System.String], @param5=[String, System.String], @param6=[String, System.String], @param7=[String, System.String], @param8=[String, System.String]]
2019-08-26 15:07:38,194 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Add] PreparedStatement : [insert into TT_HOADON (              SOHOADON              , LOAIHOADON              , TIEPNHAN_ID              , BENHNHAN_ID              , BENHAN_ID              , DOITUONG_ID              , BENHAN_NGOAITRU_ID              , NGAYPHATSINH              , NGAYHOADON              , NOIPHATSINH_ID              , NGUOILAP_ID              , NOITHUTIEN_ID              , NGUOITHUTIEN_ID              , NOITRA_ID              , NGUOITRA_ID              , NGAYTRA              , GIATRIHOADON              , GIATRITHUCTHU              , TIENTE_ID              , TYGIA              , GIATRIVND              , DANGKYHOADON_ID              , SOSERIEVAT              , SOHOADONVAT              , GIATRIVAT              , NGOAIGIO              , THUHD_BL              , GHICHU              , TRANGTHAI              , DATHANHTOAN              , HUYHOADON              , LYDOHUY_ID              , HOANTRA              , IDCHUYEN              , IDCHUYENHUY              , IDCHUYENHOAN              , HOADONLIENQUAN_ID              , TRANSFER_VIENPHI_ID              , NGAYKHOAGOI              , NHOMTHANHTOAN_ID              , HOADONDOIUNG              , CHUYENCHUNGTUID              , CHUYENCHUNGTUHOANID              , CHUYENCHUNGTUHUYID              , CHUYENDOANHTHUID              , CHUYENDOANHTHUHOANID              , CHUYENDOANHTHUHUYID              , KH_TENCONGTY              , KH_MASOTHUE              , KH_DIACHI              , KH_NGUOIDAIDIEN              , INLAI              , INLAI_USER_ID                           , BENHVIEN_ID            , NGAYTAO            , NGUOITAO_ID            , NGAYCAPNHAT            , NGUOICAPNHAT_ID                            , YEUCAUVP                            , MACHINENAME                           ) values (               @param0               ,  @param1               ,  @param2               ,  @param3               ,  @param4               ,  @param5               ,  @param6               ,  @param7               ,  @param8               ,  @param9               ,  @param10               ,  @param11               ,  @param12               ,  @param13               ,  @param14               ,  @param15               ,  @param16               ,  @param17               ,  @param18               ,  @param19               ,  @param20               ,  @param21               ,  @param22               ,  @param23               ,  @param24               ,  @param25               ,  @param26               ,  @param27               ,  @param28               ,  @param29               ,  @param30               ,  @param31               ,  @param32               ,  @param33               ,  @param34               ,  @param35               ,  @param36               ,  @param37               ,  @param38               ,  @param39               ,  @param40               ,  @param41               ,  @param42               ,  @param43               ,  @param44               ,  @param45               ,  @param46               ,  @param47               ,  @param48               ,  @param49               ,  @param50               ,  @param51               ,  @param52                            ,  @param53             ,  @param54             ,  @param55             ,  @param56             ,  @param57                             , @param58                             ,  @param59                            )              SELECT SCOPE_IDENTITY()]
2019-08-26 15:07:38,194 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Add] Parameters: [@param0=[SOHOADON,HU.1908000001], @param1=[LOAIHOADON,HU], @param2=[TIEPNHAN_ID,27245], @param3=[BENHNHAN_ID,23238], @param4=[BENHAN_ID,null], @param5=[DOITUONG_ID,1], @param6=[BENHAN_NGOAITRU_ID,null], @param7=[NGAYPHATSINH,8/26/2019 3:07:38 PM], @param8=[NGAYHOADON,8/26/2019 3:07:38 PM], @param9=[NOIPHATSINH_ID,68], @param10=[NGUOILAP_ID,1], @param11=[NOITHUTIEN_ID,68], @param12=[NGUOITHUTIEN_ID,1], @param13=[NOITRA_ID,null], @param14=[NGUOITRA_ID,null], @param15=[NGAYTRA,null], @param16=[GIATRIHOADON,500000], @param17=[GIATRITHUCTHU,500000], @param18=[TIENTE_ID,VND], @param19=[TYGIA,1], @param20=[GIATRIVND,500000], @param21=[DANGKYHOADON_ID,null], @param22=[SOSERIEVAT,null], @param23=[SOHOADONVAT,null], @param24=[GIATRIVAT,null], @param25=[NGOAIGIO,null], @param26=[THUHD_BL,HD], @param27=[GHICHU,null], @param28=[TRANGTHAI,CHUATHUTIEN], @param29=[DATHANHTOAN,0], @param30=[HUYHOADON,0], @param31=[LYDOHUY_ID,null], @param32=[HOANTRA,0], @param33=[IDCHUYEN,null], @param34=[IDCHUYENHUY,null], @param35=[IDCHUYENHOAN,null], @param36=[HOADONLIENQUAN_ID,null], @param37=[TRANSFER_VIENPHI_ID,null], @param38=[NGAYKHOAGOI,null], @param39=[NHOMTHANHTOAN_ID,null], @param40=[HOADONDOIUNG,null], @param41=[CHUYENCHUNGTUID,null], @param42=[CHUYENCHUNGTUHOANID,null], @param43=[CHUYENCHUNGTUHUYID,null], @param44=[CHUYENDOANHTHUID,null], @param45=[CHUYENDOANHTHUHOANID,null], @param46=[CHUYENDOANHTHUHUYID,null], @param47=[KH_TENCONGTY,null], @param48=[KH_MASOTHUE,null], @param49=[KH_DIACHI,null], @param50=[KH_NGUOIDAIDIEN,null], @param51=[INLAI,null], @param52=[INLAI_USER_ID,null], @param53=[BENHVIEN_ID,HLU01], @param54=[NGAYTAO,8/26/2019 3:07:38 PM], @param55=[NGUOITAO_ID,1], @param56=[NGAYCAPNHAT,8/26/2019 3:07:38 PM], @param57=[NGUOICAPNHAT_ID,1], @param58=[YEUCAUVP,False], @param59=[MACHINENAME,GMC-HAIPN6]]
2019-08-26 15:07:38,194 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Add] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[Int64, System.Int64], @param3=[Int64, System.Int64], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[DateTime, System.DateTime], @param8=[DateTime, System.DateTime], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Int64, System.Int64], @param12=[Int64, System.Int64], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[Double, System.Double], @param17=[Double, System.Double], @param18=[String, System.String], @param19=[Double, System.Double], @param20=[Double, System.Double], @param21=[System.DBNull, null], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[String, System.String], @param29=[String, System.String], @param30=[String, System.String], @param31=[System.DBNull, null], @param32=[String, System.String], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[System.DBNull, null], @param39=[System.DBNull, null], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[System.DBNull, null], @param50=[System.DBNull, null], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[String, System.String], @param54=[DateTime, System.DateTime], @param55=[Int64, System.Int64], @param56=[DateTime, System.DateTime], @param57=[Int64, System.Int64], @param58=[Boolean, System.Boolean], @param59=[String, System.String]]
2019-08-26 15:07:38,492 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_HINHTHUCTHANHTOAN_Add] PreparedStatement : [insert into TT_HOADON_HINHTHUCTHANHTOAN (              HOADON_ID              , HINHTHUCTHANHTOAN_ID              , TENHINHTHUCTHANHTOAN              , GIATRITHUCTHU              , TIENTE              , TIENTE_ID              , TYGIA              , GIATRIVND              , BENHVIEN_ID              ) values (               @param0               ,  @param1               ,  @param2               ,  @param3               ,  @param4               ,  @param5               ,  @param6               ,  @param7               ,  @param8               )]
2019-08-26 15:07:38,492 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_HINHTHUCTHANHTOAN_Add] Parameters: [@param0=[HOADON_ID,43921], @param1=[HINHTHUCTHANHTOAN_ID,443], @param2=[TENHINHTHUCTHANHTOAN,Tiền mặt], @param3=[GIATRITHUCTHU,500000], @param4=[TIENTE,VND], @param5=[TIENTE_ID,8047], @param6=[TYGIA,1], @param7=[GIATRIVND,500000], @param8=[BENHVIEN_ID,HLU01]]
2019-08-26 15:07:38,492 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_HINHTHUCTHANHTOAN_Add] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64], @param2=[String, System.String], @param3=[Double, System.Double], @param4=[String, System.String], @param5=[String, System.String], @param6=[Double, System.Double], @param7=[Double, System.Double], @param8=[String, System.String]]
2019-08-26 15:07:38,575 [1] DEBUG - Statement Id: [DAOLOG01_LockEnd] PreparedStatement : [DELETE TT_LOG_UPDATE        where REF_TABLE = 'TT_VIENPHI' and REF_ID = '27245' and BENHVIEN_ID = 'HLU01']
2019-08-26 15:07:45,326 [1] DEBUG - Statement Id: [DAO00119_CanhBaoSoBienLai_Conlai] PreparedStatement : [declare @intSohdConlai int = null;        declare @intCanhbanSohdConlai int = null;          begin        select @intCanhbanSohdConlai = VALUE from TM_SYS_APPSETTINGS where CODE = 'BIL_SOLUONG_CANHBAO_SAPHET_HOADON'        if @intCanhbanSohdConlai is null set @intCanhbanSohdConlai = 0          select top 1        BLCT.CURRENT_NUMBER, BLCT.START_NUMBER        , BL.MAX_NUMBER, (BL.KYHIEU + '/' + SERIES) KYHIEU_SOQUYEN, (BL.MAX_NUMBER - BLCT.CURRENT_NUMBER) SOCONLAI        from        TT_BIENLAI BL,TT_BIENLAICHITIET BLCT        where        BL.BIENLAI_ID = BLCT.BIENLAI_ID        and BLCT.HIEULUC = 1        and exists (select BIENLAI_ID from TT_BIENLAICHITIET where BIENLAICHITIET_ID = '2' and BLCT.BIENLAI_ID = BIENLAI_ID)        and @intCanhbanSohdConlai >= (BL.MAX_NUMBER - BLCT.CURRENT_NUMBER)        order by CURRENT_NUMBER DESC        end]
2019-08-26 15:07:45,380 [1] DEBUG - Statement Id: [DAO00014_GetPatientStatus] PreparedStatement : [select        CASE        when tn.TRANGTHAI = 'HOANTHANH' Then tn.TRANGTHAI        WHEN xncp.XACNHANCHIPHI_ID is not null THEN 'XACNHANCHIPHI'        WHEN (tn.KHOADULIEU = '1') THEN 'KHOADULIEU'        ELSE tn.TRANGTHAI        END        as TRANGTHAI        from TT_TIEPNHAN tn        left join TT_XACNHANCHIPHI xncp on tn.TIEPNHAN_ID = xncp.TIEPNHAN_ID        where tn.TIEPNHAN_ID = '27245'        and tn.BENHVIEN_ID = 'HLU01']
2019-08-26 15:07:45,458 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2019-08-26 15:07:45,458 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,HLU01]]
2019-08-26 15:07:45,458 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2019-08-26 15:07:45,500 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2019-08-26 15:07:45,500 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,HLU01]]
2019-08-26 15:07:45,500 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2019-08-26 15:07:45,533 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1              and               BLCT.BIENLAICHITIET_ID = '2'                         order by BLCT.THOIGIANSUDUNG DESC]
2019-08-26 15:07:45,533 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,HLU01]]
2019-08-26 15:07:45,533 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2019-08-26 15:07:45,562 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1              and               BLCT.BIENLAICHITIET_ID = '2'                         order by BLCT.THOIGIANSUDUNG DESC]
2019-08-26 15:07:45,562 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,HLU01]]
2019-08-26 15:07:45,562 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2019-08-26 15:07:45,595 [1] DEBUG - Statement Id: [DAOLOG01_LockBegin] PreparedStatement : [INSERT into TT_LOG_UPDATE ( REF_TABLE , REF_ID , BENHVIEN_ID )         values ( @param0 ,  @param1 ,  @param2 );]
2019-08-26 15:07:45,595 [1] DEBUG - Statement Id: [DAOLOG01_LockBegin] Parameters: [@param0=[REF_TABLE,TT_VIENPHI], @param1=[REF_ID,27245], @param2=[BENHVIEN_ID,HLU01]]
2019-08-26 15:07:45,595 [1] DEBUG - Statement Id: [DAOLOG01_LockBegin] Types: [@param0=[String, System.String], @param1=[Int64, System.Int64], @param2=[String, System.String]]
2019-08-26 15:07:45,627 [1] DEBUG - Statement Id: [DAO00119_KiemtraHoaDonTamDaDuyetCongNo] PreparedStatement : [select count(*) TOTAL_ROW from TT_HOADON where HOADON_ID =  @param0  and TRANGTHAI = 'DADUYETCONGNO' and (HUYHOADON = '0' and  HOANTRA = '0')]
2019-08-26 15:07:45,627 [1] DEBUG - Statement Id: [DAO00119_KiemtraHoaDonTamDaDuyetCongNo] Parameters: [@param0=[HOADON_ID,43921]]
2019-08-26 15:07:45,627 [1] DEBUG - Statement Id: [DAO00119_KiemtraHoaDonTamDaDuyetCongNo] Types: [@param0=[Int64, System.Int64]]
2019-08-26 15:07:45,681 [1] DEBUG - Statement Id: [DAO00119_TT_VIENPHI_XoaBienLaiTamNgoaiTru] PreparedStatement : [delete from TT_HOADON_HINHTHUCTHANHTOAN        where HOADON_ID = '43921'          delete from TT_HOADON_CHITIET_NGOAITRU        where HOADON_ID = '43921'          delete from TT_HOADON        where HOADON_ID = '43921' and TRANGTHAI in ('CHUATHUTIEN', 'CHODUYETCONGNO')          update TT_VIENPHI set HOADON_ID = null where HOADON_ID = '43921']
2019-08-26 15:07:46,050 [1] DEBUG - Statement Id: [DAO00021_GetAndInsertSoBienLaiKhiThanhToan] PreparedStatement : [declare @currentHD int = 1          declare @BienlaiId int = 0          declare @Sohoadon varchar(100)          begin          BEGIN TRANSACTION          select top 1          @currentHD = isnull(BLCT.CURRENT_NUMBER, BLCT.START_NUMBER)          ,@BienlaiId = BL.BIENLAI_ID          , @Sohoadon = (BL.KYHIEU + '/' + SERIES + '-' + convert(varchar(50),isnull(BLCT.CURRENT_NUMBER, BLCT.START_NUMBER)))          from          TT_BIENLAICHITIET BLCT          left join TT_BIENLAI BL on BLCT.BIENLAI_ID = BL.BIENLAI_ID          where                    exists (select BIENLAI_ID from TT_BIENLAICHITIET where BLCT.BIENLAI_ID = BIENLAI_ID and BIENLAICHITIET_ID = '2')          order by BLCT.CURRENT_NUMBER desc            update TT_BIENLAICHITIET set CURRENT_NUMBER = @currentHD + 1, MACHINENAME = 'GMC-HAIPN6', THOIGIANSUDUNG = getdate()  where BIENLAICHITIET_ID = '2'            COMMIT TRANSACTION          select @Sohoadon as SOHOADON          end]
2019-08-26 15:07:46,094 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Add] PreparedStatement : [insert into TT_HOADON (              SOHOADON              , LOAIHOADON              , TIEPNHAN_ID              , BENHNHAN_ID              , BENHAN_ID              , DOITUONG_ID              , BENHAN_NGOAITRU_ID              , NGAYPHATSINH              , NGAYHOADON              , NOIPHATSINH_ID              , NGUOILAP_ID              , NOITHUTIEN_ID              , NGUOITHUTIEN_ID              , NOITRA_ID              , NGUOITRA_ID              , NGAYTRA              , GIATRIHOADON              , GIATRITHUCTHU              , TIENTE_ID              , TYGIA              , GIATRIVND              , DANGKYHOADON_ID              , SOSERIEVAT              , SOHOADONVAT              , GIATRIVAT              , NGOAIGIO              , THUHD_BL              , GHICHU              , TRANGTHAI              , DATHANHTOAN              , HUYHOADON              , LYDOHUY_ID              , HOANTRA              , IDCHUYEN              , IDCHUYENHUY              , IDCHUYENHOAN              , HOADONLIENQUAN_ID              , TRANSFER_VIENPHI_ID              , NGAYKHOAGOI              , NHOMTHANHTOAN_ID              , HOADONDOIUNG              , CHUYENCHUNGTUID              , CHUYENCHUNGTUHOANID              , CHUYENCHUNGTUHUYID              , CHUYENDOANHTHUID              , CHUYENDOANHTHUHOANID              , CHUYENDOANHTHUHUYID              , KH_TENCONGTY              , KH_MASOTHUE              , KH_DIACHI              , KH_NGUOIDAIDIEN              , INLAI              , INLAI_USER_ID                              , NGUOITHANHTOAN_ID              , THOIGIANTHANHTOAN                         , BENHVIEN_ID            , NGAYTAO            , NGUOITAO_ID            , NGAYCAPNHAT            , NGUOICAPNHAT_ID                            , YEUCAUVP                            , MACHINENAME                           ) values (               @param0               ,  @param1               ,  @param2               ,  @param3               ,  @param4               ,  @param5               ,  @param6               ,  @param7               ,  @param8               ,  @param9               ,  @param10               ,  @param11               ,  @param12               ,  @param13               ,  @param14               ,  @param15               ,  @param16               ,  @param17               ,  @param18               ,  @param19               ,  @param20               ,  @param21               ,  @param22               ,  @param23               ,  @param24               ,  @param25               ,  @param26               ,  @param27               ,  @param28               ,  @param29               ,  @param30               ,  @param31               ,  @param32               ,  @param33               ,  @param34               ,  @param35               ,  @param36               ,  @param37               ,  @param38               ,  @param39               ,  @param40               ,  @param41               ,  @param42               ,  @param43               ,  @param44               ,  @param45               ,  @param46               ,  @param47               ,  @param48               ,  @param49               ,  @param50               ,  @param51               ,  @param52                               ,  @param53               ,  @param54                          ,  @param55             ,  @param56             ,  @param57             ,  @param58             ,  @param59                             , @param60                             ,  @param61                            )              SELECT SCOPE_IDENTITY()]
2019-08-26 15:07:46,094 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Add] Parameters: [@param0=[SOHOADON,FPT/01-14813], @param1=[LOAIHOADON,HU], @param2=[TIEPNHAN_ID,27245], @param3=[BENHNHAN_ID,23238], @param4=[BENHAN_ID,null], @param5=[DOITUONG_ID,1], @param6=[BENHAN_NGOAITRU_ID,null], @param7=[NGAYPHATSINH,8/26/2019 3:07:46 PM], @param8=[NGAYHOADON,8/26/2019 3:07:46 PM], @param9=[NOIPHATSINH_ID,68], @param10=[NGUOILAP_ID,1], @param11=[NOITHUTIEN_ID,68], @param12=[NGUOITHUTIEN_ID,1], @param13=[NOITRA_ID,null], @param14=[NGUOITRA_ID,null], @param15=[NGAYTRA,null], @param16=[GIATRIHOADON,500000], @param17=[GIATRITHUCTHU,500000], @param18=[TIENTE_ID,VND], @param19=[TYGIA,1], @param20=[GIATRIVND,500000], @param21=[DANGKYHOADON_ID,null], @param22=[SOSERIEVAT,null], @param23=[SOHOADONVAT,null], @param24=[GIATRIVAT,null], @param25=[NGOAIGIO,null], @param26=[THUHD_BL,HD], @param27=[GHICHU,null], @param28=[TRANGTHAI,DATHUTIEN], @param29=[DATHANHTOAN,1], @param30=[HUYHOADON,0], @param31=[LYDOHUY_ID,null], @param32=[HOANTRA,0], @param33=[IDCHUYEN,null], @param34=[IDCHUYENHUY,null], @param35=[IDCHUYENHOAN,null], @param36=[HOADONLIENQUAN_ID,null], @param37=[TRANSFER_VIENPHI_ID,null], @param38=[NGAYKHOAGOI,null], @param39=[NHOMTHANHTOAN_ID,null], @param40=[HOADONDOIUNG,null], @param41=[CHUYENCHUNGTUID,null], @param42=[CHUYENCHUNGTUHOANID,null], @param43=[CHUYENCHUNGTUHUYID,null], @param44=[CHUYENDOANHTHUID,null], @param45=[CHUYENDOANHTHUHOANID,null], @param46=[CHUYENDOANHTHUHUYID,null], @param47=[KH_TENCONGTY,null], @param48=[KH_MASOTHUE,null], @param49=[KH_DIACHI,null], @param50=[KH_NGUOIDAIDIEN,null], @param51=[INLAI,null], @param52=[INLAI_USER_ID,null], @param53=[NGUOITHANHTOAN_ID,1], @param54=[THOIGIANTHANHTOAN,8/26/2019 3:07:46 PM], @param55=[BENHVIEN_ID,HLU01], @param56=[NGAYTAO,8/26/2019 3:07:46 PM], @param57=[NGUOITAO_ID,1], @param58=[NGAYCAPNHAT,8/26/2019 3:07:46 PM], @param59=[NGUOICAPNHAT_ID,1], @param60=[YEUCAUVP,0], @param61=[MACHINENAME,GMC-HAIPN6]]
2019-08-26 15:07:46,094 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Add] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[Int64, System.Int64], @param3=[Int64, System.Int64], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[DateTime, System.DateTime], @param8=[DateTime, System.DateTime], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Int64, System.Int64], @param12=[Int64, System.Int64], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[Double, System.Double], @param17=[Double, System.Double], @param18=[String, System.String], @param19=[Double, System.Double], @param20=[Double, System.Double], @param21=[System.DBNull, null], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[String, System.String], @param29=[String, System.String], @param30=[String, System.String], @param31=[System.DBNull, null], @param32=[String, System.String], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[System.DBNull, null], @param39=[System.DBNull, null], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[System.DBNull, null], @param50=[System.DBNull, null], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[Int64, System.Int64], @param54=[DateTime, System.DateTime], @param55=[String, System.String], @param56=[DateTime, System.DateTime], @param57=[Int64, System.Int64], @param58=[DateTime, System.DateTime], @param59=[Int64, System.Int64], @param60=[String, System.String], @param61=[String, System.String]]
2019-08-26 15:07:46,137 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_HINHTHUCTHANHTOAN_Add] PreparedStatement : [insert into TT_HOADON_HINHTHUCTHANHTOAN (              HOADON_ID              , HINHTHUCTHANHTOAN_ID              , TENHINHTHUCTHANHTOAN              , GIATRITHUCTHU              , TIENTE              , TIENTE_ID              , TYGIA              , GIATRIVND              , BENHVIEN_ID              ) values (               @param0               ,  @param1               ,  @param2               ,  @param3               ,  @param4               ,  @param5               ,  @param6               ,  @param7               ,  @param8               )]
2019-08-26 15:07:46,137 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_HINHTHUCTHANHTOAN_Add] Parameters: [@param0=[HOADON_ID,43922], @param1=[HINHTHUCTHANHTOAN_ID,443], @param2=[TENHINHTHUCTHANHTOAN,Tiền mặt], @param3=[GIATRITHUCTHU,500000], @param4=[TIENTE,VND], @param5=[TIENTE_ID,8047], @param6=[TYGIA,1], @param7=[GIATRIVND,500000], @param8=[BENHVIEN_ID,HLU01]]
2019-08-26 15:07:46,137 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_HINHTHUCTHANHTOAN_Add] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64], @param2=[String, System.String], @param3=[Double, System.Double], @param4=[String, System.String], @param5=[String, System.String], @param6=[Double, System.Double], @param7=[Double, System.Double], @param8=[String, System.String]]
2019-08-26 15:07:46,189 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Huy_TamUng] PreparedStatement : [UPDATE TT_HOADON              SET TRANGTHAI = 'DAHOANUNG'              WHERE HOADON_ID IN (43891)]
2019-08-26 15:07:46,220 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_KiemTraBienLai_TamUng] PreparedStatement : [select A.*              from TT_HOADON A LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID              where              A.DATHANHTOAN = '1'              and A.TRANGTHAI = 'DATHUTIEN'              and A.HUYHOADON = '0'                and                       A.LOAIHOADON = 'TU'                   and                       A.TIEPNHAN_ID = '27245'                                 order by HOADON_ID]
2019-08-26 15:07:46,263 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_UpdateHoaDonLienQuan] PreparedStatement : [update TT_HOADON              set              HOADONLIENQUAN_ID =  @param0               , NGAYCAPNHAT =  @param1               , NGUOICAPNHAT_ID =  @param2               where              HOADON_ID IN (43891)]
2019-08-26 15:07:46,263 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_UpdateHoaDonLienQuan] Parameters: [@param0=[HOADON_ID,43922], @param1=[NGAYCAPNHAT,8/26/2019 3:07:46 PM], @param2=[NGUOICAPNHAT_ID,1]]
2019-08-26 15:07:46,263 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_UpdateHoaDonLienQuan] Types: [@param0=[Int64, System.Int64], @param1=[DateTime, System.DateTime], @param2=[Int64, System.Int64]]
2019-08-26 15:07:46,293 [1] DEBUG - Statement Id: [DAO00064_TT_NGOAITRU_KHAMBENH_TOATHUOC_GetListToaThuocBHYT] PreparedStatement : [select * from TT_NGOAITRU_KHAMBENH_TOATHUOC        where (exists (select KHAMBENH_NGOAITRU_ID from TT_DVYEUCAU where TT_NGOAITRU_KHAMBENH_TOATHUOC.KHAMBENH_ID = KHAMBENH_NGOAITRU_ID and TIEPNHAN_ID = '27245')) and TIEPNHAN_ID = '27245' and LOAITOATHUOC = 'BV']
2019-08-26 15:07:46,400 [1] DEBUG - Statement Id: [DAO00064_KiemtraBHYTNgoaitruDaThanhtoan] PreparedStatement : [select COUNT(*)        from TT_VIENPHI A        left join (select * from TT_DVYEUCAU where TIEPNHAN_ID = '27245') C on C.TIEPNHAN_ID = A.TIEPNHAN_ID and C.DICHVU_ID = A.DICHVU_ID  and C.DVYEUCAU_ID = A.REF_ID        left join (select * from TT_NGOAITRU_KHAMBENH where TIEPNHAN_ID = '27245') D on D.TIEPNHAN_ID = A.TIEPNHAN_ID and D.DICHVU_ID = A.DICHVU_ID and C.KHAMBENH_NGOAITRU_ID = D.KHAMBENH_ID        left join (select * from TT_NGOAITRU_TOATHUOC where TIEPNHAN_ID = '27245') E on E.DUOC_ID = A.DUOC_ID and E.TOATHUOC_ID = A.REF_ID and A.REF_TABLE = 'TT_NGOAITRU_TOATHUOC'        left join TT_NGOAITRU_KHAMBENH_TOATHUOC tk on tk.KHAMBENH_TOATHUOC_ID = e.KHAMBENH_TOATHUOC_ID        left join TT_PHAUTHUAT_VTYT vtyt on vtyt.PHAUTHUAT_VTYT_ID = a.REF_ID and a.REF_TABLE = 'TT_PHAUTHUAT_VTYT'        where        A.TIEPNHAN_ID = '27245' and (A.BENHAN_ID is NULL or A.BENHAN_ID = '')        and A.REF_TABLE != 'TT_DUOC_CHUNGTU_CHITIET' and A.KHONGTHUTIEN != '1'        and (exists (select KHAMBENH_ID from TT_NGOAITRU_KHAMBENH where A.KHAMBENH_ID = KHAMBENH_ID and TIEPNHAN_ID = '27245') or A.KHAMBENH_ID is null)        and (C.HUYYEUCAU = '0' or C.HUYYEUCAU is null)         and        (        (A.DICHVU_ID is not null and C.HUYYEUCAU != '1') or (A.DICHVU_ID is null and A.DUOC_ID is not null and A.REF_TABLE != 'TT_DUOC_CHUNGTU_CHITIET')        )        and A.BENHNHAN_PHAITHANHTOAN > A.GIATRI_BENHNHAN_DATHANHTOAN]
2019-08-26 15:07:46,503 [1] DEBUG - Statement Id: [DAO00064_GetDanhsachXacnhanChiphiChitiet] PreparedStatement : [select A.*        from TT_XACNHANCHIPHICHITIET A        left join TT_XACNHANCHIPHI B on A.XACNHANCHIPHI_ID = B.XACNHANCHIPHI_ID        where B.TIEPNHAN_ID = '27245']
2019-08-26 15:07:46,617 [1] DEBUG - Statement Id: [DAO00067_CapnhatDataVienphiKhiHuyThanhtoanHoadon] PreparedStatement : [update TT_VIENPHI        set TT_VIENPHI.HOADON_ID = hdct.HOADON_ID, TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN = TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN + hdct.GIATRI_BENHNHAN_DATHANHTOAN        from (select CT.HOADON_ID, CT.VIENPHI_ID, CT.GIATRI_BENHNHAN_DATHANHTOAN        from TT_HOADON_CHITIET_NGOAITRU CT        join TT_HOADON HD on HD.HOADON_ID = CT.HOADON_ID        join TT_VIENPHI vp on vp.VIENPHI_ID = ct.VIENPHI_ID        where HD.DATHANHTOAN = 1 and HD.HUYHOADON = 0 and HD.HOANTRA = 0 and vp.TIEPNHAN_ID =  @param0 ) hdct        where        TT_VIENPHI.VIENPHI_ID = hdct.VIENPHI_ID and TT_VIENPHI.HOADON_ID is null and isnull(TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN,0) = 0        and TT_VIENPHI.TIEPNHAN_ID =  @param0           update TT_VIENPHI        set TT_VIENPHI.HOADON_ID = null, TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN = TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN - hdct.GIATRI_BENHNHAN_DATHANHTOAN,        TT_VIENPHI.DATHANHTOAN = '0'        from (select CT.HOADON_ID, CT.VIENPHI_ID, CT.GIATRI_BENHNHAN_DATHANHTOAN        from TT_HOADON_CHITIET_NGOAITRU CT        join TT_HOADON HD on HD.HOADON_ID = CT.HOADON_ID        join TT_VIENPHI vp on vp.VIENPHI_ID = ct.VIENPHI_ID and vp.HOADON_ID = ct.HOADON_ID        where HD.DATHANHTOAN = 0 and (HD.HUYHOADON = 1 or HD.HOANTRA = 1) and vp.TIEPNHAN_ID =  @param0 ) hdct        where        TT_VIENPHI.VIENPHI_ID = hdct.VIENPHI_ID and TT_VIENPHI.HOADON_ID = hdct.HOADON_ID        and TT_VIENPHI.TIEPNHAN_ID =  @param0]
2019-08-26 15:07:46,617 [1] DEBUG - Statement Id: [DAO00067_CapnhatDataVienphiKhiHuyThanhtoanHoadon] Parameters: [@param0=[TIEPNHAN_ID,27245]]
2019-08-26 15:07:46,617 [1] DEBUG - Statement Id: [DAO00067_CapnhatDataVienphiKhiHuyThanhtoanHoadon] Types: [@param0=[Int64, System.Int64]]
2019-08-26 15:07:46,749 [1] DEBUG - Statement Id: [DAOLOG01_LockEnd] PreparedStatement : [DELETE TT_LOG_UPDATE        where REF_TABLE = 'TT_VIENPHI' and REF_ID = '27245' and BENHVIEN_ID = 'HLU01']
2019-08-26 15:07:46,841 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2019-08-26 15:07:46,842 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,HLU01]]
2019-08-26 15:07:46,842 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2019-08-26 15:07:46,875 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2019-08-26 15:07:46,876 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,HLU01]]
2019-08-26 15:07:46,876 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2019-08-26 15:07:46,909 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1              and               BLCT.BIENLAICHITIET_ID = '2'                         order by BLCT.THOIGIANSUDUNG DESC]
2019-08-26 15:07:46,909 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,HLU01]]
2019-08-26 15:07:46,909 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2019-08-26 15:07:46,944 [1] DEBUG - Statement Id: [DAO00119_TT_VIENPHI_GetList_TiepNhanByHoadon] PreparedStatement : [select  a.*, a.MIENGIAM_GIATRI as GIATRIMIENGIAM_BH, a.BHTN_GIATRI as GIATRIMIENGIAM_BHTN, a.HOIVIEN_GIATRI as GIATRIMIENGIAM_THANHVIEN, a.CONGTYCHITRA_GIATRI as GIATRIMIENGIAM_CTCT,        isnull(dv.TENDICHVU, dc.TENDUOCDAYDU) NOIDUNG, isnull(dv.MADICHVU, dc.MADUOC) MADICHVU, dv.NORESULT, dc.DONVITINH, ld.MALOAIDUOC, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ndv.MANHOMDICHVU        from        (select        vp.HOADONCHITIET_ID, vp.HOADON_ID, vp.VIENPHI_ID, vp.REF_ID, vp.REF_TABLE, vp.DICHVU_ID, vp.DUOC_ID        , vp.LOAI_CHIPHI, vp.LOAIGIA_ID, vp.SOLUONG, vp.DONGIA_DOANHTHU, vp.THANHTIEN_DOANHTHU, vp.BHYT_TL, vpp.BHYT_DONGIA, vpp.BHYT_THANHTIEN, vpp.BHYT_DONGIA_CHITRA        , vp.BHYT_THANHTIEN_CHITRA, vp.BENHNHAN_PHAITHANHTOAN, vp.GIATRI_HOADON, vp.GIATRI_HOADON_DATHANHTOAN, vp.GIATRI_BIENLAI        , vp.GIATRI_BIENLAI_DATHANHTOAN, vp.GIATRI_BENHNHAN_DATHANHTOAN, vp.TYLE_THATTHU, vp.GIATRI_THATTHU, vp.MIENGIAM_TL, vp.MIENGIAM_GIATRI, vp.NGANSACH_TL, vp.NGANSACH_GIATRI        , vp.TAITRO_TL, vp.TAITRO_GIATRI, vp.BHTN_GIATRI, vp.NOIDUNGTHU, vp.CHUNGTUXUATBN_ID, vp.TYLEVAT, vp.GIATRIVAT, vp.MASOTHUE, vp.SOCHUNGTUKETOAN, vp.DAHOANTRA, vp.TRANGTHAI        , vp.PHONGBAN_ID, vp.PHONGBAN_THAYDOI_ID, vp.CONGTYCHITRA_GIATRI, vp.HOIVIEN_GIATRI, vp.BENHVIEN_ID, isnull(c.NGAYGIOYEUCAU, vp.NGAYTAO) NGAYTAO, vp.NGUOITAO_ID, vp.NGAYCAPNHAT, vp.NGUOICAPNHAT_ID        , c.NOITHUCHIEN_ID, c.NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NGOAITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        left join TT_DVYEUCAU c on c.DVYEUCAU_ID = VP.REF_ID        where        vp.HOADON_ID = '43922'        ) a        left join TM_DUOC dc on a.DUOC_ID = dc.DUOC_ID        left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID        left join TM_DICHVU dv on a.DICHVU_ID = dv.DICHVU_ID and a.REF_TABLE = 'TT_DVYEUCAU'        left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID]
2019-08-26 15:10:59,004 [1] DEBUG - Statement Id: [DAO00020_ListKhoDuocOfPhongBan] PreparedStatement : [select B.* from TM_PHONGBAN_KHODUOC A        inner join TM_KHODUOC B on B.KHODUOC_ID = A.KHODUOC_ID        where        A.PHONGBAN_ID = '68'        and A.BENHVIEN_ID = 'HLU01']
2019-08-26 15:11:00,769 [1] DEBUG - Statement Id: [DAO00020_ListKhoDuocOfPhongBan] PreparedStatement : [select B.* from TM_PHONGBAN_KHODUOC A        inner join TM_KHODUOC B on B.KHODUOC_ID = A.KHODUOC_ID        where        A.PHONGBAN_ID = '5'        and A.BENHVIEN_ID = 'HLU01']
2019-08-26 15:11:00,911 [1] DEBUG - Statement Id: [DAO00008_UpdateUserIdPhongBanKhoDuoc] PreparedStatement : [IF EXISTS            (SELECT ACCOUNT_ID FROM TM_SYS_USERS WHERE ACCOUNT_ID =  @param0  and HOSPITAL_ID =  @param1 )            BEGIN            update TM_SYS_USERS set INVENTORY_ID =  @param2 , WORKING_DEPT_ID =  @param3             WHERE ACCOUNT_ID =  @param0  and HOSPITAL_ID =  @param1             END            ELSE            BEGIN            insert into TM_SYS_USERS ([ACCOUNT_ID], [ACCOUNT_NAME], [INVENTORY_ID], [WORKING_DEPT_ID], [HOSPITAL_ID])            values ( @param0 ,  @param4 ,  @param2 ,  @param3 ,  @param1 )            END]
2019-08-26 15:11:00,911 [1] DEBUG - Statement Id: [DAO00008_UpdateUserIdPhongBanKhoDuoc] Parameters: [@param0=[ACCOUNT_ID,113], @param1=[HOSPITAL_ID,HLU01], @param2=[INVENTORY_ID,19], @param3=[WORKING_DEPT_ID,5], @param4=[ACCOUNT_NAME,admin]]
2019-08-26 15:11:00,911 [1] DEBUG - Statement Id: [DAO00008_UpdateUserIdPhongBanKhoDuoc] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[String, System.String], @param3=[String, System.String], @param4=[String, System.String]]
2019-08-26 15:11:25,278 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM31'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 15:11:25,459 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'IPD78'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 15:11:29,635 [1] DEBUG - Statement Id: [DAO00014_GetInPatientStatus] PreparedStatement : [select TRANGTHAI, isnull(KHOACHUYENDEN_ID, KHOAVAO_ID) as KHOAHIENTAI from TT_NOITRU_BENHAN        where        TIEPNHAN_ID = '27366'        and BENHVIEN_ID = 'HLU01'         and           BENHAN_ID = '5857']
2019-08-26 15:11:29,787 [1] DEBUG - Statement Id: [DAO00061_GetLuuTruIDByBenhAnID] PreparedStatement : [select lt.LUUTRU_ID, ba.BACSIDIEUTRI_ID as BACSIDIEUTRICHINH_ID        from TT_NOITRU_LUUTRU lt        left join TT_NOITRU_BENHAN ba on lt.BENHAN_ID = ba.BENHAN_ID        where lt.BENHAN_ID = '5857']
2019-08-26 15:11:29,822 [1] DEBUG - Statement Id: [DAO00061_GetChanDoanBenhAnID] PreparedStatement : [DECLARE @ICDPHU NVARCHAR(2000)=''        DECLARE @LISTICDPHU NVARCHAR(200)        DECLARE @CHANDOANRAVIEN NVARCHAR(500)        DECLARE @ICDKHAMBENH NVARCHAR(500) = (SELECT ICD.TENICD + '('+ISNULL(ICD.MAICD,'')+')'        FROM TT_NOITRU_BENHAN BA INNER JOIN TM_ICD ICD        ON BA.ICD_KHAMBENH = ICD.ICD_ID WHERE BA.BENHAN_ID =  @param0 )        DECLARE @ICDCHINH NVARCHAR(500) = (SELECT ICD.TENICD + '('+ISNULL(ICD.MAICD,'')+')'        FROM TT_NOITRU_BENHAN BA INNER JOIN TM_ICD ICD        ON BA.ICD_BENHCHINH = ICD.ICD_ID WHERE BA.BENHAN_ID =  @param0 )        SELECT @CHANDOANRAVIEN = BA.CHANDOANRAVIEN, @LISTICDPHU = BA.ICD_BENHPHU        FROM TT_NOITRU_BENHAN BA WHERE BA.BENHAN_ID =  @param0         SELECT @ICDPHU = @ICDPHU + ISNULL(TENICD, '') +'(' +ISNULL(MAICD,'')+ '); ' FROM TM_ICD WHERE MAICD IN (SELECT S FROM SplitString(@LISTICDPHU,';'))        SELECT ICD_KHAMBENH, CHANDOANKHAMBENH, CHANDOANVAOKHOA, CHANDOANRAVIEN, CHANDOANKHAC        ,ISNULL(@ICDCHINH, '') + '; ' + ISNULL(@CHANDOANRAVIEN, '') + '; ' + ISNULL(@ICDPHU,'') AS CHANDOANNOITRU        ,CASE WHEN @ICDKHAMBENH IS NULL AND (@CHANDOANRAVIEN IS NULL OR @CHANDOANRAVIEN = '') THEN ''        ELSE ISNULL(@ICDKHAMBENH, '') + '; ' + ISNULL(@CHANDOANRAVIEN, '') END        AS CHANDOANCAPCUU        FROM TT_NOITRU_BENHAN BA LEFT JOIN TM_ICD ICD ON BA.ICD_KHAMBENH = ICD.ICD_ID        WHERE BENHAN_ID =  @param0]
2019-08-26 15:11:29,822 [1] DEBUG - Statement Id: [DAO00061_GetChanDoanBenhAnID] Parameters: [@param0=[BENHAN_ID,5857]]
2019-08-26 15:11:29,823 [1] DEBUG - Statement Id: [DAO00061_GetChanDoanBenhAnID] Types: [@param0=[Int64, System.Int64]]
2019-08-26 15:11:29,936 [1] DEBUG - Statement Id: [DAO00080_GetDSYLenhTruyenDich] PreparedStatement : [select DT.THOIGIANYLENH, PB.PHONGBAN_ID, PB.TENPHONGBAN AS KHOACHIDINH        , DT.LUUTRU_ID, DT.CHAMSOCDICHTRUYEN_ID, CAST(0 AS bit) AS CHON, DT.THOIGIANBATDAU        from TT_NOITRU_CHAMSOCDICHTRUYEN DT        left join TT_NOITRU_LUUTRU LT on LT.LUUTRU_ID = DT.LUUTRU_ID and LT.BENHVIEN_ID = DT.BENHVIEN_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = LT.PHONGBAN_ID and PB.BENHVIEN_ID = LT.BENHVIEN_ID        where DT.BENHAN_ID = '5857' and DT.BENHVIEN_ID = 'HLU01'        order by DT.THOIGIANBATDAU desc]
2019-08-26 15:11:31,013 [1] DEBUG - Statement Id: [DAO00080_GetChiTietTruyenDich] PreparedStatement : [select DT.DUOC_ID, DT.SOLUONG, DT.SOLOSX, DT.TOCDOTRUYEN, DT.THOIGIANBATDAU, DT.THOIGIANKETTHUC, BS.TENNHANVIEN AS BACSICHIDINH,        DD.TENNHANVIEN AS DIEUDUONG, D.TENDUOCDAYDU, ROW_NUMBER () OVER(ORDER BY D.AUTOCOMPLETEFIELD)  AS STT, DT.CHAMSOCDICHTRUYEN_ID,        DT.BACSICHIDINH_ID, DT.DIEUDUONGTHUCHIEN_ID, DT.SOMLCHAYNGUOC, DT.SOMLGIAOLAI, DT.GHICHU, DT.SOGIOTTRENPHUT        from TT_NOITRU_CHAMSOCDICHTRUYEN DT        left join TM_NHANVIEN BS on BS.NHANVIEN_ID = DT.BACSICHIDINH_ID and BS.BENHVIEN_ID = DT.BENHVIEN_ID        left join TM_NHANVIEN DD on DD.NHANVIEN_ID = DT.DIEUDUONGTHUCHIEN_ID and DD.BENHVIEN_ID = DT.BENHVIEN_ID        left join TM_DUOC D on D.DUOC_ID = DT.DUOC_ID and D.BENHVIEN_ID = DT.BENHVIEN_ID        where DT.BENHAN_ID = '5857' and DT.LUUTRU_ID = '9562'                AND DT.CHAMSOCDICHTRUYEN_ID = '6703'        and DT.BENHVIEN_ID = 'HLU01'        order by D.AUTOCOMPLETEFIELD]
2019-08-26 15:11:40,661 [1] DEBUG - Statement Id: [DAO00080_GetChiTietTruyenDich] PreparedStatement : [select DT.DUOC_ID, DT.SOLUONG, DT.SOLOSX, DT.TOCDOTRUYEN, DT.THOIGIANBATDAU, DT.THOIGIANKETTHUC, BS.TENNHANVIEN AS BACSICHIDINH,        DD.TENNHANVIEN AS DIEUDUONG, D.TENDUOCDAYDU, ROW_NUMBER () OVER(ORDER BY D.AUTOCOMPLETEFIELD)  AS STT, DT.CHAMSOCDICHTRUYEN_ID,        DT.BACSICHIDINH_ID, DT.DIEUDUONGTHUCHIEN_ID, DT.SOMLCHAYNGUOC, DT.SOMLGIAOLAI, DT.GHICHU, DT.SOGIOTTRENPHUT        from TT_NOITRU_CHAMSOCDICHTRUYEN DT        left join TM_NHANVIEN BS on BS.NHANVIEN_ID = DT.BACSICHIDINH_ID and BS.BENHVIEN_ID = DT.BENHVIEN_ID        left join TM_NHANVIEN DD on DD.NHANVIEN_ID = DT.DIEUDUONGTHUCHIEN_ID and DD.BENHVIEN_ID = DT.BENHVIEN_ID        left join TM_DUOC D on D.DUOC_ID = DT.DUOC_ID and D.BENHVIEN_ID = DT.BENHVIEN_ID        where DT.BENHAN_ID = '5857' and DT.LUUTRU_ID = '9562'                AND DT.CHAMSOCDICHTRUYEN_ID = '6704'        and DT.BENHVIEN_ID = 'HLU01'        order by D.AUTOCOMPLETEFIELD]
2019-08-26 15:12:06,366 [1] DEBUG - Statement Id: [DAO00080_GetLastLuutru_idCuaBenhan] PreparedStatement : [select MAX(LUUTRU_ID) LUUTRU_ID from TT_NOITRU_LUUTRU where BENHAN_ID =  @param0]
2019-08-26 15:12:06,366 [1] DEBUG - Statement Id: [DAO00080_GetLastLuutru_idCuaBenhan] Parameters: [@param0=[BENHAN_ID,5857]]
2019-08-26 15:12:06,367 [1] DEBUG - Statement Id: [DAO00080_GetLastLuutru_idCuaBenhan] Types: [@param0=[Int64, System.Int64]]
2019-08-26 15:12:06,437 [1] DEBUG - Statement Id: [DAO00080_Update_ThongTinDichTruyen] PreparedStatement : [update TT_NOITRU_CHAMSOCDICHTRUYEN set        DUOC_ID =  @param0          , SOLUONG =  @param1  , SOMLCHAYNGUOC =  @param2  , SOMLGIAOLAI =  @param3  , TOCDOTRUYEN =  @param4  , THOIGIANBATDAU =  @param5  , THOIGIANKETTHUC =  @param6  , SOLOSX =  @param7  , THOIGIANYLENH =  @param8  , BENHVIEN_ID =  @param9  , NGAYCAPNHAT =  @param10  , NGUOICAPNHAT_ID =  @param11  , BACSICHIDINH_ID =  @param12  , DIEUDUONGTHUCHIEN_ID =  @param13  , GHICHU =  @param14  , SOGIOTTRENPHUT =  @param15          where      CHAMSOCDICHTRUYEN_ID = '6704']
2019-08-26 15:12:06,437 [1] DEBUG - Statement Id: [DAO00080_Update_ThongTinDichTruyen] Parameters: [@param0=[DUOC_ID,882], @param1=[SOLUONG,500], @param2=[SOMLCHAYNGUOC,0], @param3=[SOMLGIAOLAI,0], @param4=[TOCDOTRUYEN,], @param5=[THOIGIANBATDAU,8/26/2019 1:23:20 PM], @param6=[THOIGIANKETTHUC,8/26/2019 4:43:20 PM], @param7=[SOLOSX,323], @param8=[THOIGIANYLENH,8/26/2019 3:12:06 PM], @param9=[BENHVIEN_ID,HLU01], @param10=[NGAYCAPNHAT,8/26/2019 3:12:06 PM], @param11=[NGUOICAPNHAT_ID,0], @param12=[BACSICHIDINH_ID,0], @param13=[DIEUDUONGTHUCHIEN_ID,0], @param14=[GHICHU,], @param15=[SOGIOTTRENPHUT,50]]
2019-08-26 15:12:06,437 [1] DEBUG - Statement Id: [DAO00080_Update_ThongTinDichTruyen] Types: [@param0=[Int32, System.Int32], @param1=[Decimal, System.Decimal], @param2=[Int32, System.Int32], @param3=[Int32, System.Int32], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[DateTime, System.DateTime], @param7=[String, System.String], @param8=[DateTime, System.DateTime], @param9=[String, System.String], @param10=[DateTime, System.DateTime], @param11=[Int64, System.Int64], @param12=[Int32, System.Int32], @param13=[Int32, System.Int32], @param14=[String, System.String], @param15=[Int32, System.Int32]]
2019-08-26 15:12:06,584 [1] DEBUG - Statement Id: [DAO00080_GetDSYLenhTruyenDich] PreparedStatement : [select DT.THOIGIANYLENH, PB.PHONGBAN_ID, PB.TENPHONGBAN AS KHOACHIDINH        , DT.LUUTRU_ID, DT.CHAMSOCDICHTRUYEN_ID, CAST(0 AS bit) AS CHON, DT.THOIGIANBATDAU        from TT_NOITRU_CHAMSOCDICHTRUYEN DT        left join TT_NOITRU_LUUTRU LT on LT.LUUTRU_ID = DT.LUUTRU_ID and LT.BENHVIEN_ID = DT.BENHVIEN_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = LT.PHONGBAN_ID and PB.BENHVIEN_ID = LT.BENHVIEN_ID        where DT.BENHAN_ID = '5857' and DT.BENHVIEN_ID = 'HLU01'        order by DT.THOIGIANBATDAU desc]
2019-08-26 15:12:12,910 [1] DEBUG - Statement Id: [DAO00080_GetChiTietTruyenDich] PreparedStatement : [select DT.DUOC_ID, DT.SOLUONG, DT.SOLOSX, DT.TOCDOTRUYEN, DT.THOIGIANBATDAU, DT.THOIGIANKETTHUC, BS.TENNHANVIEN AS BACSICHIDINH,        DD.TENNHANVIEN AS DIEUDUONG, D.TENDUOCDAYDU, ROW_NUMBER () OVER(ORDER BY D.AUTOCOMPLETEFIELD)  AS STT, DT.CHAMSOCDICHTRUYEN_ID,        DT.BACSICHIDINH_ID, DT.DIEUDUONGTHUCHIEN_ID, DT.SOMLCHAYNGUOC, DT.SOMLGIAOLAI, DT.GHICHU, DT.SOGIOTTRENPHUT        from TT_NOITRU_CHAMSOCDICHTRUYEN DT        left join TM_NHANVIEN BS on BS.NHANVIEN_ID = DT.BACSICHIDINH_ID and BS.BENHVIEN_ID = DT.BENHVIEN_ID        left join TM_NHANVIEN DD on DD.NHANVIEN_ID = DT.DIEUDUONGTHUCHIEN_ID and DD.BENHVIEN_ID = DT.BENHVIEN_ID        left join TM_DUOC D on D.DUOC_ID = DT.DUOC_ID and D.BENHVIEN_ID = DT.BENHVIEN_ID        where DT.BENHAN_ID = '5857' and DT.LUUTRU_ID = '9562'                AND DT.CHAMSOCDICHTRUYEN_ID = '6703'        and DT.BENHVIEN_ID = 'HLU01'        order by D.AUTOCOMPLETEFIELD]
2019-08-26 15:12:15,626 [1] DEBUG - Statement Id: [DAO00080_GetChiTietTruyenDich] PreparedStatement : [select DT.DUOC_ID, DT.SOLUONG, DT.SOLOSX, DT.TOCDOTRUYEN, DT.THOIGIANBATDAU, DT.THOIGIANKETTHUC, BS.TENNHANVIEN AS BACSICHIDINH,        DD.TENNHANVIEN AS DIEUDUONG, D.TENDUOCDAYDU, ROW_NUMBER () OVER(ORDER BY D.AUTOCOMPLETEFIELD)  AS STT, DT.CHAMSOCDICHTRUYEN_ID,        DT.BACSICHIDINH_ID, DT.DIEUDUONGTHUCHIEN_ID, DT.SOMLCHAYNGUOC, DT.SOMLGIAOLAI, DT.GHICHU, DT.SOGIOTTRENPHUT        from TT_NOITRU_CHAMSOCDICHTRUYEN DT        left join TM_NHANVIEN BS on BS.NHANVIEN_ID = DT.BACSICHIDINH_ID and BS.BENHVIEN_ID = DT.BENHVIEN_ID        left join TM_NHANVIEN DD on DD.NHANVIEN_ID = DT.DIEUDUONGTHUCHIEN_ID and DD.BENHVIEN_ID = DT.BENHVIEN_ID        left join TM_DUOC D on D.DUOC_ID = DT.DUOC_ID and D.BENHVIEN_ID = DT.BENHVIEN_ID        where DT.BENHAN_ID = '5857' and DT.LUUTRU_ID = '9562'                AND DT.CHAMSOCDICHTRUYEN_ID = '6705'        and DT.BENHVIEN_ID = 'HLU01'        order by D.AUTOCOMPLETEFIELD]
2019-08-26 15:12:16,739 [1] DEBUG - Statement Id: [DAO00080_GetChiTietTruyenDich] PreparedStatement : [select DT.DUOC_ID, DT.SOLUONG, DT.SOLOSX, DT.TOCDOTRUYEN, DT.THOIGIANBATDAU, DT.THOIGIANKETTHUC, BS.TENNHANVIEN AS BACSICHIDINH,        DD.TENNHANVIEN AS DIEUDUONG, D.TENDUOCDAYDU, ROW_NUMBER () OVER(ORDER BY D.AUTOCOMPLETEFIELD)  AS STT, DT.CHAMSOCDICHTRUYEN_ID,        DT.BACSICHIDINH_ID, DT.DIEUDUONGTHUCHIEN_ID, DT.SOMLCHAYNGUOC, DT.SOMLGIAOLAI, DT.GHICHU, DT.SOGIOTTRENPHUT        from TT_NOITRU_CHAMSOCDICHTRUYEN DT        left join TM_NHANVIEN BS on BS.NHANVIEN_ID = DT.BACSICHIDINH_ID and BS.BENHVIEN_ID = DT.BENHVIEN_ID        left join TM_NHANVIEN DD on DD.NHANVIEN_ID = DT.DIEUDUONGTHUCHIEN_ID and DD.BENHVIEN_ID = DT.BENHVIEN_ID        left join TM_DUOC D on D.DUOC_ID = DT.DUOC_ID and D.BENHVIEN_ID = DT.BENHVIEN_ID        where DT.BENHAN_ID = '5857' and DT.LUUTRU_ID = '9562'                AND DT.CHAMSOCDICHTRUYEN_ID = '6703'        and DT.BENHVIEN_ID = 'HLU01'        order by D.AUTOCOMPLETEFIELD]
2019-08-26 15:12:19,934 [1] DEBUG - Statement Id: [DAO00080_GetChiTietTruyenDich] PreparedStatement : [select DT.DUOC_ID, DT.SOLUONG, DT.SOLOSX, DT.TOCDOTRUYEN, DT.THOIGIANBATDAU, DT.THOIGIANKETTHUC, BS.TENNHANVIEN AS BACSICHIDINH,        DD.TENNHANVIEN AS DIEUDUONG, D.TENDUOCDAYDU, ROW_NUMBER () OVER(ORDER BY D.AUTOCOMPLETEFIELD)  AS STT, DT.CHAMSOCDICHTRUYEN_ID,        DT.BACSICHIDINH_ID, DT.DIEUDUONGTHUCHIEN_ID, DT.SOMLCHAYNGUOC, DT.SOMLGIAOLAI, DT.GHICHU, DT.SOGIOTTRENPHUT        from TT_NOITRU_CHAMSOCDICHTRUYEN DT        left join TM_NHANVIEN BS on BS.NHANVIEN_ID = DT.BACSICHIDINH_ID and BS.BENHVIEN_ID = DT.BENHVIEN_ID        left join TM_NHANVIEN DD on DD.NHANVIEN_ID = DT.DIEUDUONGTHUCHIEN_ID and DD.BENHVIEN_ID = DT.BENHVIEN_ID        left join TM_DUOC D on D.DUOC_ID = DT.DUOC_ID and D.BENHVIEN_ID = DT.BENHVIEN_ID        where DT.BENHAN_ID = '5857' and DT.LUUTRU_ID = '9562'                AND DT.CHAMSOCDICHTRUYEN_ID = '6704'        and DT.BENHVIEN_ID = 'HLU01'        order by D.AUTOCOMPLETEFIELD]
2019-08-26 15:12:20,310 [1] DEBUG - Statement Id: [DAO00080_GetChiTietTruyenDich] PreparedStatement : [select DT.DUOC_ID, DT.SOLUONG, DT.SOLOSX, DT.TOCDOTRUYEN, DT.THOIGIANBATDAU, DT.THOIGIANKETTHUC, BS.TENNHANVIEN AS BACSICHIDINH,        DD.TENNHANVIEN AS DIEUDUONG, D.TENDUOCDAYDU, ROW_NUMBER () OVER(ORDER BY D.AUTOCOMPLETEFIELD)  AS STT, DT.CHAMSOCDICHTRUYEN_ID,        DT.BACSICHIDINH_ID, DT.DIEUDUONGTHUCHIEN_ID, DT.SOMLCHAYNGUOC, DT.SOMLGIAOLAI, DT.GHICHU, DT.SOGIOTTRENPHUT        from TT_NOITRU_CHAMSOCDICHTRUYEN DT        left join TM_NHANVIEN BS on BS.NHANVIEN_ID = DT.BACSICHIDINH_ID and BS.BENHVIEN_ID = DT.BENHVIEN_ID        left join TM_NHANVIEN DD on DD.NHANVIEN_ID = DT.DIEUDUONGTHUCHIEN_ID and DD.BENHVIEN_ID = DT.BENHVIEN_ID        left join TM_DUOC D on D.DUOC_ID = DT.DUOC_ID and D.BENHVIEN_ID = DT.BENHVIEN_ID        where DT.BENHAN_ID = '5857' and DT.LUUTRU_ID = '9562'                AND DT.CHAMSOCDICHTRUYEN_ID = '6705'        and DT.BENHVIEN_ID = 'HLU01'        order by D.AUTOCOMPLETEFIELD]
2019-08-26 15:12:24,662 [1] DEBUG - Statement Id: [DAO00080_GetChiTietTruyenDich] PreparedStatement : [select DT.DUOC_ID, DT.SOLUONG, DT.SOLOSX, DT.TOCDOTRUYEN, DT.THOIGIANBATDAU, DT.THOIGIANKETTHUC, BS.TENNHANVIEN AS BACSICHIDINH,        DD.TENNHANVIEN AS DIEUDUONG, D.TENDUOCDAYDU, ROW_NUMBER () OVER(ORDER BY D.AUTOCOMPLETEFIELD)  AS STT, DT.CHAMSOCDICHTRUYEN_ID,        DT.BACSICHIDINH_ID, DT.DIEUDUONGTHUCHIEN_ID, DT.SOMLCHAYNGUOC, DT.SOMLGIAOLAI, DT.GHICHU, DT.SOGIOTTRENPHUT        from TT_NOITRU_CHAMSOCDICHTRUYEN DT        left join TM_NHANVIEN BS on BS.NHANVIEN_ID = DT.BACSICHIDINH_ID and BS.BENHVIEN_ID = DT.BENHVIEN_ID        left join TM_NHANVIEN DD on DD.NHANVIEN_ID = DT.DIEUDUONGTHUCHIEN_ID and DD.BENHVIEN_ID = DT.BENHVIEN_ID        left join TM_DUOC D on D.DUOC_ID = DT.DUOC_ID and D.BENHVIEN_ID = DT.BENHVIEN_ID        where DT.BENHAN_ID = '5857' and DT.LUUTRU_ID = '9562'                AND DT.CHAMSOCDICHTRUYEN_ID = '6706'        and DT.BENHVIEN_ID = 'HLU01'        order by D.AUTOCOMPLETEFIELD]
2019-08-26 15:12:34,112 [1] DEBUG - Statement Id: [DAO00080_GetChiTietTruyenDich] PreparedStatement : [select DT.DUOC_ID, DT.SOLUONG, DT.SOLOSX, DT.TOCDOTRUYEN, DT.THOIGIANBATDAU, DT.THOIGIANKETTHUC, BS.TENNHANVIEN AS BACSICHIDINH,        DD.TENNHANVIEN AS DIEUDUONG, D.TENDUOCDAYDU, ROW_NUMBER () OVER(ORDER BY D.AUTOCOMPLETEFIELD)  AS STT, DT.CHAMSOCDICHTRUYEN_ID,        DT.BACSICHIDINH_ID, DT.DIEUDUONGTHUCHIEN_ID, DT.SOMLCHAYNGUOC, DT.SOMLGIAOLAI, DT.GHICHU, DT.SOGIOTTRENPHUT        from TT_NOITRU_CHAMSOCDICHTRUYEN DT        left join TM_NHANVIEN BS on BS.NHANVIEN_ID = DT.BACSICHIDINH_ID and BS.BENHVIEN_ID = DT.BENHVIEN_ID        left join TM_NHANVIEN DD on DD.NHANVIEN_ID = DT.DIEUDUONGTHUCHIEN_ID and DD.BENHVIEN_ID = DT.BENHVIEN_ID        left join TM_DUOC D on D.DUOC_ID = DT.DUOC_ID and D.BENHVIEN_ID = DT.BENHVIEN_ID        where DT.BENHAN_ID = '5857' and DT.LUUTRU_ID = '9562'                AND DT.CHAMSOCDICHTRUYEN_ID = '6703'        and DT.BENHVIEN_ID = 'HLU01'        order by D.AUTOCOMPLETEFIELD]
--------------------------------------------------------------------------------
2019-08-26 15:20:52,467 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2019-08-26 15:20:52,736 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-08-26 15:20:52,771 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-08-26 15:20:53,222 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 15:20:53,513 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-08-26 15:20:58,371 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2019-08-26 15:20:58,461 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-08-26 15:21:00,059 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-08-26 15:21:00,139 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-08-26 15:21:00,933 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2019-08-26 15:21:01,073 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2019-08-26 15:21:01,145 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2019-08-26 15:21:01,220 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2019-08-26 15:21:01,289 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2019-08-26 15:21:01,362 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2019-08-26 15:21:01,434 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2019-08-26 15:21:01,510 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2019-08-26 15:21:01,594 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2019-08-26 15:21:02,090 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2019-08-26 15:21:02,129 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2019-08-26 15:21:02,206 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2019-08-26 15:21:02,238 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2019-08-26 15:21:03,584 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2019-08-26 15:21:03,618 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 0 as PHAMVI_ID, 0 as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0         end                else        begin        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2019-08-26 15:21:05,642 [5] DEBUG - Statement Id: [DAO00320_GetList] PreparedStatement : [select M.*            from TM_MAU M            LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID            where            M.TAMNGUNG = '0'            and M.BENHVIEN_ID = 'HLU01'            order by M.TENMAU]
2019-08-26 15:21:05,709 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2019-08-26 15:21:05,742 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT          TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,          TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,          SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH          FROM TT_MAU_TONKHO TK          JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID          JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID          JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'          LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID          LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID          WHERE TK.SOLUONG > 0          GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,          TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2019-08-26 15:21:05,811 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2019-08-26 15:21:05,842 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct          TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,          TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,          TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH          from TM_MAU M          JOIN          (          select          A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO          from          (          select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO          from TT_MAU_TONKHO TK          JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID          inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID          left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'          where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0          ) A          )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'          LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID          LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2019-08-26 15:21:05,910 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2019-08-26 15:21:06,851 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 15:21:07,860 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2019-08-26 15:21:14,049 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2019-08-26 15:21:14,079 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2019-08-26 15:21:14,164 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 15:21:14,287 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 15:21:14,415 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2019-08-26 15:21:14,417 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-08-26 15:21:14,417 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-08-26 15:21:14,448 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2019-08-26 15:21:14,448 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-08-26 15:21:14,448 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-08-26 15:21:14,596 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 15:21:14,806 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 15:21:25,002 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 15:21:25,130 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2019-08-26 15:21:25,529 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2019-08-26 15:22:31,048 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM31'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 15:22:31,204 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'IPD78'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 15:22:35,345 [1] DEBUG - Statement Id: [DAO00014_GetInPatientStatus] PreparedStatement : [select TRANGTHAI, isnull(KHOACHUYENDEN_ID, KHOAVAO_ID) as KHOAHIENTAI from TT_NOITRU_BENHAN        where        TIEPNHAN_ID = '27366'        and BENHVIEN_ID = 'HLU01'         and           BENHAN_ID = '5857']
2019-08-26 15:22:35,530 [1] DEBUG - Statement Id: [DAO00061_GetLuuTruIDByBenhAnID] PreparedStatement : [select lt.LUUTRU_ID, ba.BACSIDIEUTRI_ID as BACSIDIEUTRICHINH_ID        from TT_NOITRU_LUUTRU lt        left join TT_NOITRU_BENHAN ba on lt.BENHAN_ID = ba.BENHAN_ID        where lt.BENHAN_ID = '5857']
2019-08-26 15:22:35,566 [1] DEBUG - Statement Id: [DAO00061_GetChanDoanBenhAnID] PreparedStatement : [DECLARE @ICDPHU NVARCHAR(2000)=''        DECLARE @LISTICDPHU NVARCHAR(200)        DECLARE @CHANDOANRAVIEN NVARCHAR(500)        DECLARE @ICDKHAMBENH NVARCHAR(500) = (SELECT ICD.TENICD + '('+ISNULL(ICD.MAICD,'')+')'        FROM TT_NOITRU_BENHAN BA INNER JOIN TM_ICD ICD        ON BA.ICD_KHAMBENH = ICD.ICD_ID WHERE BA.BENHAN_ID =  @param0 )        DECLARE @ICDCHINH NVARCHAR(500) = (SELECT ICD.TENICD + '('+ISNULL(ICD.MAICD,'')+')'        FROM TT_NOITRU_BENHAN BA INNER JOIN TM_ICD ICD        ON BA.ICD_BENHCHINH = ICD.ICD_ID WHERE BA.BENHAN_ID =  @param0 )        SELECT @CHANDOANRAVIEN = BA.CHANDOANRAVIEN, @LISTICDPHU = BA.ICD_BENHPHU        FROM TT_NOITRU_BENHAN BA WHERE BA.BENHAN_ID =  @param0         SELECT @ICDPHU = @ICDPHU + ISNULL(TENICD, '') +'(' +ISNULL(MAICD,'')+ '); ' FROM TM_ICD WHERE MAICD IN (SELECT S FROM SplitString(@LISTICDPHU,';'))        SELECT ICD_KHAMBENH, CHANDOANKHAMBENH, CHANDOANVAOKHOA, CHANDOANRAVIEN, CHANDOANKHAC        ,ISNULL(@ICDCHINH, '') + '; ' + ISNULL(@CHANDOANRAVIEN, '') + '; ' + ISNULL(@ICDPHU,'') AS CHANDOANNOITRU        ,CASE WHEN @ICDKHAMBENH IS NULL AND (@CHANDOANRAVIEN IS NULL OR @CHANDOANRAVIEN = '') THEN ''        ELSE ISNULL(@ICDKHAMBENH, '') + '; ' + ISNULL(@CHANDOANRAVIEN, '') END        AS CHANDOANCAPCUU        FROM TT_NOITRU_BENHAN BA LEFT JOIN TM_ICD ICD ON BA.ICD_KHAMBENH = ICD.ICD_ID        WHERE BENHAN_ID =  @param0]
2019-08-26 15:22:35,566 [1] DEBUG - Statement Id: [DAO00061_GetChanDoanBenhAnID] Parameters: [@param0=[BENHAN_ID,5857]]
2019-08-26 15:22:35,566 [1] DEBUG - Statement Id: [DAO00061_GetChanDoanBenhAnID] Types: [@param0=[Int64, System.Int64]]
2019-08-26 15:22:35,698 [1] DEBUG - Statement Id: [DAO00080_GetDSYLenhTruyenDich] PreparedStatement : [select DT.THOIGIANYLENH, PB.PHONGBAN_ID, PB.TENPHONGBAN AS KHOACHIDINH        , DT.LUUTRU_ID, DT.CHAMSOCDICHTRUYEN_ID, CAST(0 AS bit) AS CHON, DT.THOIGIANBATDAU        from TT_NOITRU_CHAMSOCDICHTRUYEN DT        left join TT_NOITRU_LUUTRU LT on LT.LUUTRU_ID = DT.LUUTRU_ID and LT.BENHVIEN_ID = DT.BENHVIEN_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = LT.PHONGBAN_ID and PB.BENHVIEN_ID = LT.BENHVIEN_ID        where DT.BENHAN_ID = '5857' and DT.BENHVIEN_ID = 'HLU01'        order by DT.THOIGIANBATDAU desc]
2019-08-26 15:22:36,976 [1] DEBUG - Statement Id: [DAO00080_GetChiTietTruyenDich] PreparedStatement : [select DT.DUOC_ID, DT.SOLUONG, DT.SOLOSX, DT.TOCDOTRUYEN, DT.THOIGIANBATDAU, DT.THOIGIANKETTHUC, BS.TENNHANVIEN AS BACSICHIDINH,        DD.TENNHANVIEN AS DIEUDUONG, D.TENDUOCDAYDU, ROW_NUMBER () OVER(ORDER BY D.AUTOCOMPLETEFIELD)  AS STT, DT.CHAMSOCDICHTRUYEN_ID,        DT.BACSICHIDINH_ID, DT.DIEUDUONGTHUCHIEN_ID, DT.SOMLCHAYNGUOC, DT.SOMLGIAOLAI, DT.GHICHU, DT.SOGIOTTRENPHUT        from TT_NOITRU_CHAMSOCDICHTRUYEN DT        left join TM_NHANVIEN BS on BS.NHANVIEN_ID = DT.BACSICHIDINH_ID and BS.BENHVIEN_ID = DT.BENHVIEN_ID        left join TM_NHANVIEN DD on DD.NHANVIEN_ID = DT.DIEUDUONGTHUCHIEN_ID and DD.BENHVIEN_ID = DT.BENHVIEN_ID        left join TM_DUOC D on D.DUOC_ID = DT.DUOC_ID and D.BENHVIEN_ID = DT.BENHVIEN_ID        where DT.BENHAN_ID = '5857' and DT.LUUTRU_ID = '9562'                AND DT.CHAMSOCDICHTRUYEN_ID = '6703'        and DT.BENHVIEN_ID = 'HLU01'        order by D.AUTOCOMPLETEFIELD]
2019-08-26 15:22:38,060 [1] DEBUG - Statement Id: [DAO00080_GetChiTietTruyenDich] PreparedStatement : [select DT.DUOC_ID, DT.SOLUONG, DT.SOLOSX, DT.TOCDOTRUYEN, DT.THOIGIANBATDAU, DT.THOIGIANKETTHUC, BS.TENNHANVIEN AS BACSICHIDINH,        DD.TENNHANVIEN AS DIEUDUONG, D.TENDUOCDAYDU, ROW_NUMBER () OVER(ORDER BY D.AUTOCOMPLETEFIELD)  AS STT, DT.CHAMSOCDICHTRUYEN_ID,        DT.BACSICHIDINH_ID, DT.DIEUDUONGTHUCHIEN_ID, DT.SOMLCHAYNGUOC, DT.SOMLGIAOLAI, DT.GHICHU, DT.SOGIOTTRENPHUT        from TT_NOITRU_CHAMSOCDICHTRUYEN DT        left join TM_NHANVIEN BS on BS.NHANVIEN_ID = DT.BACSICHIDINH_ID and BS.BENHVIEN_ID = DT.BENHVIEN_ID        left join TM_NHANVIEN DD on DD.NHANVIEN_ID = DT.DIEUDUONGTHUCHIEN_ID and DD.BENHVIEN_ID = DT.BENHVIEN_ID        left join TM_DUOC D on D.DUOC_ID = DT.DUOC_ID and D.BENHVIEN_ID = DT.BENHVIEN_ID        where DT.BENHAN_ID = '5857' and DT.LUUTRU_ID = '9562'                AND DT.CHAMSOCDICHTRUYEN_ID = '6704'        and DT.BENHVIEN_ID = 'HLU01'        order by D.AUTOCOMPLETEFIELD]
2019-08-26 15:22:39,466 [1] DEBUG - Statement Id: [DAO00080_GetChiTietTruyenDich] PreparedStatement : [select DT.DUOC_ID, DT.SOLUONG, DT.SOLOSX, DT.TOCDOTRUYEN, DT.THOIGIANBATDAU, DT.THOIGIANKETTHUC, BS.TENNHANVIEN AS BACSICHIDINH,        DD.TENNHANVIEN AS DIEUDUONG, D.TENDUOCDAYDU, ROW_NUMBER () OVER(ORDER BY D.AUTOCOMPLETEFIELD)  AS STT, DT.CHAMSOCDICHTRUYEN_ID,        DT.BACSICHIDINH_ID, DT.DIEUDUONGTHUCHIEN_ID, DT.SOMLCHAYNGUOC, DT.SOMLGIAOLAI, DT.GHICHU, DT.SOGIOTTRENPHUT        from TT_NOITRU_CHAMSOCDICHTRUYEN DT        left join TM_NHANVIEN BS on BS.NHANVIEN_ID = DT.BACSICHIDINH_ID and BS.BENHVIEN_ID = DT.BENHVIEN_ID        left join TM_NHANVIEN DD on DD.NHANVIEN_ID = DT.DIEUDUONGTHUCHIEN_ID and DD.BENHVIEN_ID = DT.BENHVIEN_ID        left join TM_DUOC D on D.DUOC_ID = DT.DUOC_ID and D.BENHVIEN_ID = DT.BENHVIEN_ID        where DT.BENHAN_ID = '5857' and DT.LUUTRU_ID = '9562'                AND DT.CHAMSOCDICHTRUYEN_ID = '6703'        and DT.BENHVIEN_ID = 'HLU01'        order by D.AUTOCOMPLETEFIELD]
2019-08-26 15:22:47,080 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM98'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 15:22:52,760 [1] DEBUG - Statement Id: [DAO00080_GetLastLuutru_idCuaBenhan] PreparedStatement : [select MAX(LUUTRU_ID) LUUTRU_ID from TT_NOITRU_LUUTRU where BENHAN_ID =  @param0]
2019-08-26 15:22:52,760 [1] DEBUG - Statement Id: [DAO00080_GetLastLuutru_idCuaBenhan] Parameters: [@param0=[BENHAN_ID,5857]]
2019-08-26 15:22:52,760 [1] DEBUG - Statement Id: [DAO00080_GetLastLuutru_idCuaBenhan] Types: [@param0=[Int64, System.Int64]]
2019-08-26 15:22:52,845 [1] DEBUG - Statement Id: [DAO00080_Update_ThongTinDichTruyen] PreparedStatement : [update TT_NOITRU_CHAMSOCDICHTRUYEN set        DUOC_ID =  @param0          , SOLUONG =  @param1  , SOMLCHAYNGUOC =  @param2  , SOMLGIAOLAI =  @param3  , TOCDOTRUYEN =  @param4  , THOIGIANBATDAU =  @param5  , THOIGIANKETTHUC =  @param6  , SOLOSX =  @param7  , THOIGIANYLENH =  @param8  , BENHVIEN_ID =  @param9  , NGAYCAPNHAT =  @param10  , NGUOICAPNHAT_ID =  @param11  , BACSICHIDINH_ID =  @param12  , DIEUDUONGTHUCHIEN_ID =  @param13  , GHICHU =  @param14  , SOGIOTTRENPHUT =  @param15          where      CHAMSOCDICHTRUYEN_ID = '6703']
2019-08-26 15:22:52,846 [1] DEBUG - Statement Id: [DAO00080_Update_ThongTinDichTruyen] Parameters: [@param0=[DUOC_ID,882], @param1=[SOLUONG,200], @param2=[SOMLCHAYNGUOC,0], @param3=[SOMLGIAOLAI,0], @param4=[TOCDOTRUYEN,], @param5=[THOIGIANBATDAU,8/23/2019 2:41:40 PM], @param6=[THOIGIANKETTHUC,8/23/2019 6:01:40 PM], @param7=[SOLOSX,], @param8=[THOIGIANYLENH,8/26/2019 3:22:52 PM], @param9=[BENHVIEN_ID,HLU01], @param10=[NGAYCAPNHAT,8/26/2019 3:22:52 PM], @param11=[NGUOICAPNHAT_ID,0], @param12=[BACSICHIDINH_ID,34], @param13=[DIEUDUONGTHUCHIEN_ID,35], @param14=[GHICHU,test], @param15=[SOGIOTTRENPHUT,20]]
2019-08-26 15:22:52,846 [1] DEBUG - Statement Id: [DAO00080_Update_ThongTinDichTruyen] Types: [@param0=[Int32, System.Int32], @param1=[Decimal, System.Decimal], @param2=[Int32, System.Int32], @param3=[Int32, System.Int32], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[DateTime, System.DateTime], @param7=[String, System.String], @param8=[DateTime, System.DateTime], @param9=[String, System.String], @param10=[DateTime, System.DateTime], @param11=[Int64, System.Int64], @param12=[Int32, System.Int32], @param13=[Int32, System.Int32], @param14=[String, System.String], @param15=[Int32, System.Int32]]
2019-08-26 15:22:53,106 [1] DEBUG - Statement Id: [DAO00080_GetDSYLenhTruyenDich] PreparedStatement : [select DT.THOIGIANYLENH, PB.PHONGBAN_ID, PB.TENPHONGBAN AS KHOACHIDINH        , DT.LUUTRU_ID, DT.CHAMSOCDICHTRUYEN_ID, CAST(0 AS bit) AS CHON, DT.THOIGIANBATDAU        from TT_NOITRU_CHAMSOCDICHTRUYEN DT        left join TT_NOITRU_LUUTRU LT on LT.LUUTRU_ID = DT.LUUTRU_ID and LT.BENHVIEN_ID = DT.BENHVIEN_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = LT.PHONGBAN_ID and PB.BENHVIEN_ID = LT.BENHVIEN_ID        where DT.BENHAN_ID = '5857' and DT.BENHVIEN_ID = 'HLU01'        order by DT.THOIGIANBATDAU desc]
2019-08-26 15:22:55,781 [1] DEBUG - Statement Id: [DAO00080_GetChiTietTruyenDich] PreparedStatement : [select DT.DUOC_ID, DT.SOLUONG, DT.SOLOSX, DT.TOCDOTRUYEN, DT.THOIGIANBATDAU, DT.THOIGIANKETTHUC, BS.TENNHANVIEN AS BACSICHIDINH,        DD.TENNHANVIEN AS DIEUDUONG, D.TENDUOCDAYDU, ROW_NUMBER () OVER(ORDER BY D.AUTOCOMPLETEFIELD)  AS STT, DT.CHAMSOCDICHTRUYEN_ID,        DT.BACSICHIDINH_ID, DT.DIEUDUONGTHUCHIEN_ID, DT.SOMLCHAYNGUOC, DT.SOMLGIAOLAI, DT.GHICHU, DT.SOGIOTTRENPHUT        from TT_NOITRU_CHAMSOCDICHTRUYEN DT        left join TM_NHANVIEN BS on BS.NHANVIEN_ID = DT.BACSICHIDINH_ID and BS.BENHVIEN_ID = DT.BENHVIEN_ID        left join TM_NHANVIEN DD on DD.NHANVIEN_ID = DT.DIEUDUONGTHUCHIEN_ID and DD.BENHVIEN_ID = DT.BENHVIEN_ID        left join TM_DUOC D on D.DUOC_ID = DT.DUOC_ID and D.BENHVIEN_ID = DT.BENHVIEN_ID        where DT.BENHAN_ID = '5857' and DT.LUUTRU_ID = '9562'                AND DT.CHAMSOCDICHTRUYEN_ID = '6703'        and DT.BENHVIEN_ID = 'HLU01'        order by D.AUTOCOMPLETEFIELD]
2019-08-26 15:22:58,458 [1] DEBUG - Statement Id: [DAO00080_GetChiTietTruyenDich] PreparedStatement : [select DT.DUOC_ID, DT.SOLUONG, DT.SOLOSX, DT.TOCDOTRUYEN, DT.THOIGIANBATDAU, DT.THOIGIANKETTHUC, BS.TENNHANVIEN AS BACSICHIDINH,        DD.TENNHANVIEN AS DIEUDUONG, D.TENDUOCDAYDU, ROW_NUMBER () OVER(ORDER BY D.AUTOCOMPLETEFIELD)  AS STT, DT.CHAMSOCDICHTRUYEN_ID,        DT.BACSICHIDINH_ID, DT.DIEUDUONGTHUCHIEN_ID, DT.SOMLCHAYNGUOC, DT.SOMLGIAOLAI, DT.GHICHU, DT.SOGIOTTRENPHUT        from TT_NOITRU_CHAMSOCDICHTRUYEN DT        left join TM_NHANVIEN BS on BS.NHANVIEN_ID = DT.BACSICHIDINH_ID and BS.BENHVIEN_ID = DT.BENHVIEN_ID        left join TM_NHANVIEN DD on DD.NHANVIEN_ID = DT.DIEUDUONGTHUCHIEN_ID and DD.BENHVIEN_ID = DT.BENHVIEN_ID        left join TM_DUOC D on D.DUOC_ID = DT.DUOC_ID and D.BENHVIEN_ID = DT.BENHVIEN_ID        where DT.BENHAN_ID = '5857' and DT.LUUTRU_ID = '9562'                AND DT.CHAMSOCDICHTRUYEN_ID = '6704'        and DT.BENHVIEN_ID = 'HLU01'        order by D.AUTOCOMPLETEFIELD]
2019-08-26 15:22:59,071 [1] DEBUG - Statement Id: [DAO00080_GetChiTietTruyenDich] PreparedStatement : [select DT.DUOC_ID, DT.SOLUONG, DT.SOLOSX, DT.TOCDOTRUYEN, DT.THOIGIANBATDAU, DT.THOIGIANKETTHUC, BS.TENNHANVIEN AS BACSICHIDINH,        DD.TENNHANVIEN AS DIEUDUONG, D.TENDUOCDAYDU, ROW_NUMBER () OVER(ORDER BY D.AUTOCOMPLETEFIELD)  AS STT, DT.CHAMSOCDICHTRUYEN_ID,        DT.BACSICHIDINH_ID, DT.DIEUDUONGTHUCHIEN_ID, DT.SOMLCHAYNGUOC, DT.SOMLGIAOLAI, DT.GHICHU, DT.SOGIOTTRENPHUT        from TT_NOITRU_CHAMSOCDICHTRUYEN DT        left join TM_NHANVIEN BS on BS.NHANVIEN_ID = DT.BACSICHIDINH_ID and BS.BENHVIEN_ID = DT.BENHVIEN_ID        left join TM_NHANVIEN DD on DD.NHANVIEN_ID = DT.DIEUDUONGTHUCHIEN_ID and DD.BENHVIEN_ID = DT.BENHVIEN_ID        left join TM_DUOC D on D.DUOC_ID = DT.DUOC_ID and D.BENHVIEN_ID = DT.BENHVIEN_ID        where DT.BENHAN_ID = '5857' and DT.LUUTRU_ID = '9562'                AND DT.CHAMSOCDICHTRUYEN_ID = '6703'        and DT.BENHVIEN_ID = 'HLU01'        order by D.AUTOCOMPLETEFIELD]
2019-08-26 15:23:39,300 [1] DEBUG - Statement Id: [DAO00080_GetLastLuutru_idCuaBenhan] PreparedStatement : [select MAX(LUUTRU_ID) LUUTRU_ID from TT_NOITRU_LUUTRU where BENHAN_ID =  @param0]
2019-08-26 15:23:39,300 [1] DEBUG - Statement Id: [DAO00080_GetLastLuutru_idCuaBenhan] Parameters: [@param0=[BENHAN_ID,5857]]
2019-08-26 15:23:39,300 [1] DEBUG - Statement Id: [DAO00080_GetLastLuutru_idCuaBenhan] Types: [@param0=[Int64, System.Int64]]
2019-08-26 15:23:39,355 [1] DEBUG - Statement Id: [DAO00080_Update_ThongTinDichTruyen] PreparedStatement : [update TT_NOITRU_CHAMSOCDICHTRUYEN set        DUOC_ID =  @param0          , SOLUONG =  @param1  , SOMLCHAYNGUOC =  @param2  , SOMLGIAOLAI =  @param3  , TOCDOTRUYEN =  @param4  , THOIGIANBATDAU =  @param5  , THOIGIANKETTHUC =  @param6  , SOLOSX =  @param7  , THOIGIANYLENH =  @param8  , BENHVIEN_ID =  @param9  , NGAYCAPNHAT =  @param10  , NGUOICAPNHAT_ID =  @param11  , BACSICHIDINH_ID =  @param12  , DIEUDUONGTHUCHIEN_ID =  @param13  , GHICHU =  @param14  , SOGIOTTRENPHUT =  @param15          where      CHAMSOCDICHTRUYEN_ID = '6703']
2019-08-26 15:23:39,355 [1] DEBUG - Statement Id: [DAO00080_Update_ThongTinDichTruyen] Parameters: [@param0=[DUOC_ID,882], @param1=[SOLUONG,200], @param2=[SOMLCHAYNGUOC,0], @param3=[SOMLGIAOLAI,0], @param4=[TOCDOTRUYEN,], @param5=[THOIGIANBATDAU,8/23/2019 2:41:40 PM], @param6=[THOIGIANKETTHUC,8/23/2019 4:01:40 PM], @param7=[SOLOSX,], @param8=[THOIGIANYLENH,8/26/2019 3:23:39 PM], @param9=[BENHVIEN_ID,HLU01], @param10=[NGAYCAPNHAT,8/26/2019 3:23:39 PM], @param11=[NGUOICAPNHAT_ID,0], @param12=[BACSICHIDINH_ID,34], @param13=[DIEUDUONGTHUCHIEN_ID,35], @param14=[GHICHU,test], @param15=[SOGIOTTRENPHUT,50]]
2019-08-26 15:23:39,355 [1] DEBUG - Statement Id: [DAO00080_Update_ThongTinDichTruyen] Types: [@param0=[Int32, System.Int32], @param1=[Decimal, System.Decimal], @param2=[Int32, System.Int32], @param3=[Int32, System.Int32], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[DateTime, System.DateTime], @param7=[String, System.String], @param8=[DateTime, System.DateTime], @param9=[String, System.String], @param10=[DateTime, System.DateTime], @param11=[Int64, System.Int64], @param12=[Int32, System.Int32], @param13=[Int32, System.Int32], @param14=[String, System.String], @param15=[Int32, System.Int32]]
2019-08-26 15:23:39,439 [1] DEBUG - Statement Id: [DAO00080_GetDSYLenhTruyenDich] PreparedStatement : [select DT.THOIGIANYLENH, PB.PHONGBAN_ID, PB.TENPHONGBAN AS KHOACHIDINH        , DT.LUUTRU_ID, DT.CHAMSOCDICHTRUYEN_ID, CAST(0 AS bit) AS CHON, DT.THOIGIANBATDAU        from TT_NOITRU_CHAMSOCDICHTRUYEN DT        left join TT_NOITRU_LUUTRU LT on LT.LUUTRU_ID = DT.LUUTRU_ID and LT.BENHVIEN_ID = DT.BENHVIEN_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = LT.PHONGBAN_ID and PB.BENHVIEN_ID = LT.BENHVIEN_ID        where DT.BENHAN_ID = '5857' and DT.BENHVIEN_ID = 'HLU01'        order by DT.THOIGIANBATDAU desc]
2019-08-26 15:23:41,948 [1] DEBUG - Statement Id: [DAO00080_GetChiTietTruyenDich] PreparedStatement : [select DT.DUOC_ID, DT.SOLUONG, DT.SOLOSX, DT.TOCDOTRUYEN, DT.THOIGIANBATDAU, DT.THOIGIANKETTHUC, BS.TENNHANVIEN AS BACSICHIDINH,        DD.TENNHANVIEN AS DIEUDUONG, D.TENDUOCDAYDU, ROW_NUMBER () OVER(ORDER BY D.AUTOCOMPLETEFIELD)  AS STT, DT.CHAMSOCDICHTRUYEN_ID,        DT.BACSICHIDINH_ID, DT.DIEUDUONGTHUCHIEN_ID, DT.SOMLCHAYNGUOC, DT.SOMLGIAOLAI, DT.GHICHU, DT.SOGIOTTRENPHUT        from TT_NOITRU_CHAMSOCDICHTRUYEN DT        left join TM_NHANVIEN BS on BS.NHANVIEN_ID = DT.BACSICHIDINH_ID and BS.BENHVIEN_ID = DT.BENHVIEN_ID        left join TM_NHANVIEN DD on DD.NHANVIEN_ID = DT.DIEUDUONGTHUCHIEN_ID and DD.BENHVIEN_ID = DT.BENHVIEN_ID        left join TM_DUOC D on D.DUOC_ID = DT.DUOC_ID and D.BENHVIEN_ID = DT.BENHVIEN_ID        where DT.BENHAN_ID = '5857' and DT.LUUTRU_ID = '9562'                AND DT.CHAMSOCDICHTRUYEN_ID = '6703'        and DT.BENHVIEN_ID = 'HLU01'        order by D.AUTOCOMPLETEFIELD]
--------------------------------------------------------------------------------
2019-08-26 15:27:10,387 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2019-08-26 15:27:10,663 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-08-26 15:27:10,704 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-08-26 15:27:11,252 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 15:27:11,637 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-08-26 15:27:21,540 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2019-08-26 15:27:21,626 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-08-26 15:27:23,437 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-08-26 15:27:23,514 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-08-26 15:27:24,311 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2019-08-26 15:27:24,443 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2019-08-26 15:27:24,523 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2019-08-26 15:27:24,597 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2019-08-26 15:27:24,680 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2019-08-26 15:27:24,770 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2019-08-26 15:27:24,848 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2019-08-26 15:27:24,925 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2019-08-26 15:27:25,003 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2019-08-26 15:27:25,520 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2019-08-26 15:27:25,555 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2019-08-26 15:27:25,628 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2019-08-26 15:27:25,661 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2019-08-26 15:27:27,124 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2019-08-26 15:27:27,160 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 0 as PHAMVI_ID, 0 as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0         end                else        begin        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2019-08-26 15:27:29,290 [5] DEBUG - Statement Id: [DAO00320_GetList] PreparedStatement : [select M.*            from TM_MAU M            LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID            where            M.TAMNGUNG = '0'            and M.BENHVIEN_ID = 'HLU01'            order by M.TENMAU]
2019-08-26 15:27:29,358 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2019-08-26 15:27:29,400 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT          TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,          TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,          SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH          FROM TT_MAU_TONKHO TK          JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID          JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID          JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'          LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID          LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID          WHERE TK.SOLUONG > 0          GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,          TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2019-08-26 15:27:29,468 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2019-08-26 15:27:29,500 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct          TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,          TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,          TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH          from TM_MAU M          JOIN          (          select          A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO          from          (          select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO          from TT_MAU_TONKHO TK          JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID          inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID          left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'          where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0          ) A          )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'          LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID          LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2019-08-26 15:27:29,567 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2019-08-26 15:27:30,478 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 15:27:31,574 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2019-08-26 15:27:37,103 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2019-08-26 15:27:37,133 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2019-08-26 15:27:37,202 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 15:27:37,325 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 15:27:37,527 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2019-08-26 15:27:37,529 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-08-26 15:27:37,529 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-08-26 15:27:37,565 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2019-08-26 15:27:37,565 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-08-26 15:27:37,565 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-08-26 15:27:37,744 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 15:27:37,915 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 15:27:52,785 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 15:27:52,880 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2019-08-26 15:27:53,212 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2019-08-26 15:28:16,166 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM31'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 15:28:16,349 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'IPD78'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 15:28:21,000 [1] DEBUG - Statement Id: [DAO00014_GetInPatientStatus] PreparedStatement : [select TRANGTHAI, isnull(KHOACHUYENDEN_ID, KHOAVAO_ID) as KHOAHIENTAI from TT_NOITRU_BENHAN        where        TIEPNHAN_ID = '27366'        and BENHVIEN_ID = 'HLU01'         and           BENHAN_ID = '5857']
2019-08-26 15:28:21,154 [1] DEBUG - Statement Id: [DAO00061_GetLuuTruIDByBenhAnID] PreparedStatement : [select lt.LUUTRU_ID, ba.BACSIDIEUTRI_ID as BACSIDIEUTRICHINH_ID        from TT_NOITRU_LUUTRU lt        left join TT_NOITRU_BENHAN ba on lt.BENHAN_ID = ba.BENHAN_ID        where lt.BENHAN_ID = '5857']
2019-08-26 15:28:21,192 [1] DEBUG - Statement Id: [DAO00061_GetChanDoanBenhAnID] PreparedStatement : [DECLARE @ICDPHU NVARCHAR(2000)=''        DECLARE @LISTICDPHU NVARCHAR(200)        DECLARE @CHANDOANRAVIEN NVARCHAR(500)        DECLARE @ICDKHAMBENH NVARCHAR(500) = (SELECT ICD.TENICD + '('+ISNULL(ICD.MAICD,'')+')'        FROM TT_NOITRU_BENHAN BA INNER JOIN TM_ICD ICD        ON BA.ICD_KHAMBENH = ICD.ICD_ID WHERE BA.BENHAN_ID =  @param0 )        DECLARE @ICDCHINH NVARCHAR(500) = (SELECT ICD.TENICD + '('+ISNULL(ICD.MAICD,'')+')'        FROM TT_NOITRU_BENHAN BA INNER JOIN TM_ICD ICD        ON BA.ICD_BENHCHINH = ICD.ICD_ID WHERE BA.BENHAN_ID =  @param0 )        SELECT @CHANDOANRAVIEN = BA.CHANDOANRAVIEN, @LISTICDPHU = BA.ICD_BENHPHU        FROM TT_NOITRU_BENHAN BA WHERE BA.BENHAN_ID =  @param0         SELECT @ICDPHU = @ICDPHU + ISNULL(TENICD, '') +'(' +ISNULL(MAICD,'')+ '); ' FROM TM_ICD WHERE MAICD IN (SELECT S FROM SplitString(@LISTICDPHU,';'))        SELECT ICD_KHAMBENH, CHANDOANKHAMBENH, CHANDOANVAOKHOA, CHANDOANRAVIEN, CHANDOANKHAC        ,ISNULL(@ICDCHINH, '') + '; ' + ISNULL(@CHANDOANRAVIEN, '') + '; ' + ISNULL(@ICDPHU,'') AS CHANDOANNOITRU        ,CASE WHEN @ICDKHAMBENH IS NULL AND (@CHANDOANRAVIEN IS NULL OR @CHANDOANRAVIEN = '') THEN ''        ELSE ISNULL(@ICDKHAMBENH, '') + '; ' + ISNULL(@CHANDOANRAVIEN, '') END        AS CHANDOANCAPCUU        FROM TT_NOITRU_BENHAN BA LEFT JOIN TM_ICD ICD ON BA.ICD_KHAMBENH = ICD.ICD_ID        WHERE BENHAN_ID =  @param0]
2019-08-26 15:28:21,192 [1] DEBUG - Statement Id: [DAO00061_GetChanDoanBenhAnID] Parameters: [@param0=[BENHAN_ID,5857]]
2019-08-26 15:28:21,192 [1] DEBUG - Statement Id: [DAO00061_GetChanDoanBenhAnID] Types: [@param0=[Int64, System.Int64]]
2019-08-26 15:28:21,321 [1] DEBUG - Statement Id: [DAO00080_GetDSYLenhTruyenDich] PreparedStatement : [select DT.THOIGIANYLENH, PB.PHONGBAN_ID, PB.TENPHONGBAN AS KHOACHIDINH        , DT.LUUTRU_ID, DT.CHAMSOCDICHTRUYEN_ID, CAST(0 AS bit) AS CHON, DT.THOIGIANBATDAU        from TT_NOITRU_CHAMSOCDICHTRUYEN DT        left join TT_NOITRU_LUUTRU LT on LT.LUUTRU_ID = DT.LUUTRU_ID and LT.BENHVIEN_ID = DT.BENHVIEN_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = LT.PHONGBAN_ID and PB.BENHVIEN_ID = LT.BENHVIEN_ID        where DT.BENHAN_ID = '5857' and DT.BENHVIEN_ID = 'HLU01'        order by DT.THOIGIANBATDAU desc]
2019-08-26 15:28:22,790 [1] DEBUG - Statement Id: [DAO00080_GetChiTietTruyenDich] PreparedStatement : [select DT.DUOC_ID, DT.SOLUONG, DT.SOLOSX, DT.TOCDOTRUYEN, DT.THOIGIANBATDAU, DT.THOIGIANKETTHUC, BS.TENNHANVIEN AS BACSICHIDINH,        DD.TENNHANVIEN AS DIEUDUONG, D.TENDUOCDAYDU, ROW_NUMBER () OVER(ORDER BY D.AUTOCOMPLETEFIELD)  AS STT, DT.CHAMSOCDICHTRUYEN_ID,        DT.BACSICHIDINH_ID, DT.DIEUDUONGTHUCHIEN_ID, DT.SOMLCHAYNGUOC, DT.SOMLGIAOLAI, DT.GHICHU, DT.SOGIOTTRENPHUT        from TT_NOITRU_CHAMSOCDICHTRUYEN DT        left join TM_NHANVIEN BS on BS.NHANVIEN_ID = DT.BACSICHIDINH_ID and BS.BENHVIEN_ID = DT.BENHVIEN_ID        left join TM_NHANVIEN DD on DD.NHANVIEN_ID = DT.DIEUDUONGTHUCHIEN_ID and DD.BENHVIEN_ID = DT.BENHVIEN_ID        left join TM_DUOC D on D.DUOC_ID = DT.DUOC_ID and D.BENHVIEN_ID = DT.BENHVIEN_ID        where DT.BENHAN_ID = '5857' and DT.LUUTRU_ID = '9562'                AND DT.CHAMSOCDICHTRUYEN_ID = '6703'        and DT.BENHVIEN_ID = 'HLU01'        order by D.AUTOCOMPLETEFIELD]
2019-08-26 15:28:28,790 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM98'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 15:28:33,089 [1] DEBUG - Statement Id: [DAO00080_GetChiTietTruyenDich] PreparedStatement : [select DT.DUOC_ID, DT.SOLUONG, DT.SOLOSX, DT.TOCDOTRUYEN, DT.THOIGIANBATDAU, DT.THOIGIANKETTHUC, BS.TENNHANVIEN AS BACSICHIDINH,        DD.TENNHANVIEN AS DIEUDUONG, D.TENDUOCDAYDU, ROW_NUMBER () OVER(ORDER BY D.AUTOCOMPLETEFIELD)  AS STT, DT.CHAMSOCDICHTRUYEN_ID,        DT.BACSICHIDINH_ID, DT.DIEUDUONGTHUCHIEN_ID, DT.SOMLCHAYNGUOC, DT.SOMLGIAOLAI, DT.GHICHU, DT.SOGIOTTRENPHUT        from TT_NOITRU_CHAMSOCDICHTRUYEN DT        left join TM_NHANVIEN BS on BS.NHANVIEN_ID = DT.BACSICHIDINH_ID and BS.BENHVIEN_ID = DT.BENHVIEN_ID        left join TM_NHANVIEN DD on DD.NHANVIEN_ID = DT.DIEUDUONGTHUCHIEN_ID and DD.BENHVIEN_ID = DT.BENHVIEN_ID        left join TM_DUOC D on D.DUOC_ID = DT.DUOC_ID and D.BENHVIEN_ID = DT.BENHVIEN_ID        where DT.BENHAN_ID = '5857' and DT.LUUTRU_ID = '9562'                AND DT.CHAMSOCDICHTRUYEN_ID = '6703'        and DT.BENHVIEN_ID = 'HLU01'        order by D.AUTOCOMPLETEFIELD]
2019-08-26 15:28:46,329 [1] DEBUG - Statement Id: [DAO00080_GetChiTietTruyenDich] PreparedStatement : [select DT.DUOC_ID, DT.SOLUONG, DT.SOLOSX, DT.TOCDOTRUYEN, DT.THOIGIANBATDAU, DT.THOIGIANKETTHUC, BS.TENNHANVIEN AS BACSICHIDINH,        DD.TENNHANVIEN AS DIEUDUONG, D.TENDUOCDAYDU, ROW_NUMBER () OVER(ORDER BY D.AUTOCOMPLETEFIELD)  AS STT, DT.CHAMSOCDICHTRUYEN_ID,        DT.BACSICHIDINH_ID, DT.DIEUDUONGTHUCHIEN_ID, DT.SOMLCHAYNGUOC, DT.SOMLGIAOLAI, DT.GHICHU, DT.SOGIOTTRENPHUT        from TT_NOITRU_CHAMSOCDICHTRUYEN DT        left join TM_NHANVIEN BS on BS.NHANVIEN_ID = DT.BACSICHIDINH_ID and BS.BENHVIEN_ID = DT.BENHVIEN_ID        left join TM_NHANVIEN DD on DD.NHANVIEN_ID = DT.DIEUDUONGTHUCHIEN_ID and DD.BENHVIEN_ID = DT.BENHVIEN_ID        left join TM_DUOC D on D.DUOC_ID = DT.DUOC_ID and D.BENHVIEN_ID = DT.BENHVIEN_ID        where DT.BENHAN_ID = '5857' and DT.LUUTRU_ID = '9562'                AND DT.CHAMSOCDICHTRUYEN_ID = '6704'        and DT.BENHVIEN_ID = 'HLU01'        order by D.AUTOCOMPLETEFIELD]
2019-08-26 15:29:14,467 [1] DEBUG - Statement Id: [DAO00080_GetChiTietTruyenDich] PreparedStatement : [select DT.DUOC_ID, DT.SOLUONG, DT.SOLOSX, DT.TOCDOTRUYEN, DT.THOIGIANBATDAU, DT.THOIGIANKETTHUC, BS.TENNHANVIEN AS BACSICHIDINH,        DD.TENNHANVIEN AS DIEUDUONG, D.TENDUOCDAYDU, ROW_NUMBER () OVER(ORDER BY D.AUTOCOMPLETEFIELD)  AS STT, DT.CHAMSOCDICHTRUYEN_ID,        DT.BACSICHIDINH_ID, DT.DIEUDUONGTHUCHIEN_ID, DT.SOMLCHAYNGUOC, DT.SOMLGIAOLAI, DT.GHICHU, DT.SOGIOTTRENPHUT        from TT_NOITRU_CHAMSOCDICHTRUYEN DT        left join TM_NHANVIEN BS on BS.NHANVIEN_ID = DT.BACSICHIDINH_ID and BS.BENHVIEN_ID = DT.BENHVIEN_ID        left join TM_NHANVIEN DD on DD.NHANVIEN_ID = DT.DIEUDUONGTHUCHIEN_ID and DD.BENHVIEN_ID = DT.BENHVIEN_ID        left join TM_DUOC D on D.DUOC_ID = DT.DUOC_ID and D.BENHVIEN_ID = DT.BENHVIEN_ID        where DT.BENHAN_ID = '5857' and DT.LUUTRU_ID = '9562'                AND DT.CHAMSOCDICHTRUYEN_ID = '6704'        and DT.BENHVIEN_ID = 'HLU01'        order by D.AUTOCOMPLETEFIELD]
2019-08-26 15:29:23,880 [1] DEBUG - Statement Id: [DAO00080_GetChiTietTruyenDich] PreparedStatement : [select DT.DUOC_ID, DT.SOLUONG, DT.SOLOSX, DT.TOCDOTRUYEN, DT.THOIGIANBATDAU, DT.THOIGIANKETTHUC, BS.TENNHANVIEN AS BACSICHIDINH,        DD.TENNHANVIEN AS DIEUDUONG, D.TENDUOCDAYDU, ROW_NUMBER () OVER(ORDER BY D.AUTOCOMPLETEFIELD)  AS STT, DT.CHAMSOCDICHTRUYEN_ID,        DT.BACSICHIDINH_ID, DT.DIEUDUONGTHUCHIEN_ID, DT.SOMLCHAYNGUOC, DT.SOMLGIAOLAI, DT.GHICHU, DT.SOGIOTTRENPHUT        from TT_NOITRU_CHAMSOCDICHTRUYEN DT        left join TM_NHANVIEN BS on BS.NHANVIEN_ID = DT.BACSICHIDINH_ID and BS.BENHVIEN_ID = DT.BENHVIEN_ID        left join TM_NHANVIEN DD on DD.NHANVIEN_ID = DT.DIEUDUONGTHUCHIEN_ID and DD.BENHVIEN_ID = DT.BENHVIEN_ID        left join TM_DUOC D on D.DUOC_ID = DT.DUOC_ID and D.BENHVIEN_ID = DT.BENHVIEN_ID        where DT.BENHAN_ID = '5857' and DT.LUUTRU_ID = '9562'                AND DT.CHAMSOCDICHTRUYEN_ID = '6704'        and DT.BENHVIEN_ID = 'HLU01'        order by D.AUTOCOMPLETEFIELD]
2019-08-26 15:33:03,428 [1] DEBUG - Statement Id: [DAO00080_GetChiTietTruyenDich] PreparedStatement : [select DT.DUOC_ID, DT.SOLUONG, DT.SOLOSX, DT.TOCDOTRUYEN, DT.THOIGIANBATDAU, DT.THOIGIANKETTHUC, BS.TENNHANVIEN AS BACSICHIDINH,        DD.TENNHANVIEN AS DIEUDUONG, D.TENDUOCDAYDU, ROW_NUMBER () OVER(ORDER BY D.AUTOCOMPLETEFIELD)  AS STT, DT.CHAMSOCDICHTRUYEN_ID,        DT.BACSICHIDINH_ID, DT.DIEUDUONGTHUCHIEN_ID, DT.SOMLCHAYNGUOC, DT.SOMLGIAOLAI, DT.GHICHU, DT.SOGIOTTRENPHUT        from TT_NOITRU_CHAMSOCDICHTRUYEN DT        left join TM_NHANVIEN BS on BS.NHANVIEN_ID = DT.BACSICHIDINH_ID and BS.BENHVIEN_ID = DT.BENHVIEN_ID        left join TM_NHANVIEN DD on DD.NHANVIEN_ID = DT.DIEUDUONGTHUCHIEN_ID and DD.BENHVIEN_ID = DT.BENHVIEN_ID        left join TM_DUOC D on D.DUOC_ID = DT.DUOC_ID and D.BENHVIEN_ID = DT.BENHVIEN_ID        where DT.BENHAN_ID = '5857' and DT.LUUTRU_ID = '9562'                AND DT.CHAMSOCDICHTRUYEN_ID = '6704'        and DT.BENHVIEN_ID = 'HLU01'        order by D.AUTOCOMPLETEFIELD]
--------------------------------------------------------------------------------
2019-08-26 15:34:52,388 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2019-08-26 15:34:52,666 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-08-26 15:34:52,706 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-08-26 15:34:53,198 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 15:34:53,491 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-08-26 15:35:07,246 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2019-08-26 15:35:07,276 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-08-26 15:35:09,517 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-08-26 15:35:09,599 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-08-26 15:35:11,023 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2019-08-26 15:35:11,216 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2019-08-26 15:35:11,296 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2019-08-26 15:35:11,456 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2019-08-26 15:35:11,543 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2019-08-26 15:35:11,653 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2019-08-26 15:35:11,740 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2019-08-26 15:35:11,818 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2019-08-26 15:35:12,317 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2019-08-26 15:35:12,902 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2019-08-26 15:35:12,941 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2019-08-26 15:35:13,079 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2019-08-26 15:35:13,661 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2019-08-26 15:35:15,541 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2019-08-26 15:35:15,575 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 0 as PHAMVI_ID, 0 as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0         end                else        begin        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2019-08-26 15:35:17,924 [5] DEBUG - Statement Id: [DAO00320_GetList] PreparedStatement : [select M.*            from TM_MAU M            LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID            where            M.TAMNGUNG = '0'            and M.BENHVIEN_ID = 'HLU01'            order by M.TENMAU]
2019-08-26 15:35:18,009 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2019-08-26 15:35:18,053 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT          TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,          TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,          SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH          FROM TT_MAU_TONKHO TK          JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID          JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID          JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'          LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID          LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID          WHERE TK.SOLUONG > 0          GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,          TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2019-08-26 15:35:18,137 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2019-08-26 15:35:18,169 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct          TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,          TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,          TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH          from TM_MAU M          JOIN          (          select          A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO          from          (          select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO          from TT_MAU_TONKHO TK          JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID          inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID          left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'          where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0          ) A          )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'          LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID          LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2019-08-26 15:35:18,237 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2019-08-26 15:35:19,193 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 15:35:20,291 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2019-08-26 15:35:26,614 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2019-08-26 15:35:26,642 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2019-08-26 15:35:26,720 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 15:35:26,842 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 15:35:26,999 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2019-08-26 15:35:27,001 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-08-26 15:35:27,001 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-08-26 15:35:27,029 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2019-08-26 15:35:27,030 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-08-26 15:35:27,030 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-08-26 15:35:27,165 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 15:35:27,342 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 15:35:35,880 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 15:35:35,984 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2019-08-26 15:35:36,222 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2019-08-26 15:35:53,961 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM31'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 15:35:54,144 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'IPD78'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 15:35:58,235 [1] DEBUG - Statement Id: [DAO00014_GetInPatientStatus] PreparedStatement : [select TRANGTHAI, isnull(KHOACHUYENDEN_ID, KHOAVAO_ID) as KHOAHIENTAI from TT_NOITRU_BENHAN        where        TIEPNHAN_ID = '27366'        and BENHVIEN_ID = 'HLU01'         and           BENHAN_ID = '5857']
2019-08-26 15:35:58,501 [1] DEBUG - Statement Id: [DAO00061_GetLuuTruIDByBenhAnID] PreparedStatement : [select lt.LUUTRU_ID, ba.BACSIDIEUTRI_ID as BACSIDIEUTRICHINH_ID        from TT_NOITRU_LUUTRU lt        left join TT_NOITRU_BENHAN ba on lt.BENHAN_ID = ba.BENHAN_ID        where lt.BENHAN_ID = '5857']
2019-08-26 15:35:58,538 [1] DEBUG - Statement Id: [DAO00061_GetChanDoanBenhAnID] PreparedStatement : [DECLARE @ICDPHU NVARCHAR(2000)=''        DECLARE @LISTICDPHU NVARCHAR(200)        DECLARE @CHANDOANRAVIEN NVARCHAR(500)        DECLARE @ICDKHAMBENH NVARCHAR(500) = (SELECT ICD.TENICD + '('+ISNULL(ICD.MAICD,'')+')'        FROM TT_NOITRU_BENHAN BA INNER JOIN TM_ICD ICD        ON BA.ICD_KHAMBENH = ICD.ICD_ID WHERE BA.BENHAN_ID =  @param0 )        DECLARE @ICDCHINH NVARCHAR(500) = (SELECT ICD.TENICD + '('+ISNULL(ICD.MAICD,'')+')'        FROM TT_NOITRU_BENHAN BA INNER JOIN TM_ICD ICD        ON BA.ICD_BENHCHINH = ICD.ICD_ID WHERE BA.BENHAN_ID =  @param0 )        SELECT @CHANDOANRAVIEN = BA.CHANDOANRAVIEN, @LISTICDPHU = BA.ICD_BENHPHU        FROM TT_NOITRU_BENHAN BA WHERE BA.BENHAN_ID =  @param0         SELECT @ICDPHU = @ICDPHU + ISNULL(TENICD, '') +'(' +ISNULL(MAICD,'')+ '); ' FROM TM_ICD WHERE MAICD IN (SELECT S FROM SplitString(@LISTICDPHU,';'))        SELECT ICD_KHAMBENH, CHANDOANKHAMBENH, CHANDOANVAOKHOA, CHANDOANRAVIEN, CHANDOANKHAC        ,ISNULL(@ICDCHINH, '') + '; ' + ISNULL(@CHANDOANRAVIEN, '') + '; ' + ISNULL(@ICDPHU,'') AS CHANDOANNOITRU        ,CASE WHEN @ICDKHAMBENH IS NULL AND (@CHANDOANRAVIEN IS NULL OR @CHANDOANRAVIEN = '') THEN ''        ELSE ISNULL(@ICDKHAMBENH, '') + '; ' + ISNULL(@CHANDOANRAVIEN, '') END        AS CHANDOANCAPCUU        FROM TT_NOITRU_BENHAN BA LEFT JOIN TM_ICD ICD ON BA.ICD_KHAMBENH = ICD.ICD_ID        WHERE BENHAN_ID =  @param0]
2019-08-26 15:35:58,538 [1] DEBUG - Statement Id: [DAO00061_GetChanDoanBenhAnID] Parameters: [@param0=[BENHAN_ID,5857]]
2019-08-26 15:35:58,538 [1] DEBUG - Statement Id: [DAO00061_GetChanDoanBenhAnID] Types: [@param0=[Int64, System.Int64]]
2019-08-26 15:35:58,669 [1] DEBUG - Statement Id: [DAO00080_GetDSYLenhTruyenDich] PreparedStatement : [select DT.THOIGIANYLENH, PB.PHONGBAN_ID, PB.TENPHONGBAN AS KHOACHIDINH        , DT.LUUTRU_ID, DT.CHAMSOCDICHTRUYEN_ID, CAST(0 AS bit) AS CHON, DT.THOIGIANBATDAU        from TT_NOITRU_CHAMSOCDICHTRUYEN DT        left join TT_NOITRU_LUUTRU LT on LT.LUUTRU_ID = DT.LUUTRU_ID and LT.BENHVIEN_ID = DT.BENHVIEN_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = LT.PHONGBAN_ID and PB.BENHVIEN_ID = LT.BENHVIEN_ID        where DT.BENHAN_ID = '5857' and DT.BENHVIEN_ID = 'HLU01'        order by DT.THOIGIANBATDAU desc]
2019-08-26 15:36:00,075 [1] DEBUG - Statement Id: [DAO00080_GetChiTietTruyenDich] PreparedStatement : [select DT.DUOC_ID, DT.SOLUONG, DT.SOLOSX, DT.TOCDOTRUYEN, DT.THOIGIANBATDAU, DT.THOIGIANKETTHUC, BS.TENNHANVIEN AS BACSICHIDINH,        DD.TENNHANVIEN AS DIEUDUONG, D.TENDUOCDAYDU, ROW_NUMBER () OVER(ORDER BY D.AUTOCOMPLETEFIELD)  AS STT, DT.CHAMSOCDICHTRUYEN_ID,        DT.BACSICHIDINH_ID, DT.DIEUDUONGTHUCHIEN_ID, DT.SOMLCHAYNGUOC, DT.SOMLGIAOLAI, DT.GHICHU, DT.SOGIOTTRENPHUT        from TT_NOITRU_CHAMSOCDICHTRUYEN DT        left join TM_NHANVIEN BS on BS.NHANVIEN_ID = DT.BACSICHIDINH_ID and BS.BENHVIEN_ID = DT.BENHVIEN_ID        left join TM_NHANVIEN DD on DD.NHANVIEN_ID = DT.DIEUDUONGTHUCHIEN_ID and DD.BENHVIEN_ID = DT.BENHVIEN_ID        left join TM_DUOC D on D.DUOC_ID = DT.DUOC_ID and D.BENHVIEN_ID = DT.BENHVIEN_ID        where DT.BENHAN_ID = '5857' and DT.LUUTRU_ID = '9562'                AND DT.CHAMSOCDICHTRUYEN_ID = '6704'        and DT.BENHVIEN_ID = 'HLU01'        order by D.AUTOCOMPLETEFIELD]
2019-08-26 15:36:06,459 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM98'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 15:36:10,350 [1] DEBUG - Statement Id: [DAO00080_GetChiTietTruyenDich] PreparedStatement : [select DT.DUOC_ID, DT.SOLUONG, DT.SOLOSX, DT.TOCDOTRUYEN, DT.THOIGIANBATDAU, DT.THOIGIANKETTHUC, BS.TENNHANVIEN AS BACSICHIDINH,        DD.TENNHANVIEN AS DIEUDUONG, D.TENDUOCDAYDU, ROW_NUMBER () OVER(ORDER BY D.AUTOCOMPLETEFIELD)  AS STT, DT.CHAMSOCDICHTRUYEN_ID,        DT.BACSICHIDINH_ID, DT.DIEUDUONGTHUCHIEN_ID, DT.SOMLCHAYNGUOC, DT.SOMLGIAOLAI, DT.GHICHU, DT.SOGIOTTRENPHUT        from TT_NOITRU_CHAMSOCDICHTRUYEN DT        left join TM_NHANVIEN BS on BS.NHANVIEN_ID = DT.BACSICHIDINH_ID and BS.BENHVIEN_ID = DT.BENHVIEN_ID        left join TM_NHANVIEN DD on DD.NHANVIEN_ID = DT.DIEUDUONGTHUCHIEN_ID and DD.BENHVIEN_ID = DT.BENHVIEN_ID        left join TM_DUOC D on D.DUOC_ID = DT.DUOC_ID and D.BENHVIEN_ID = DT.BENHVIEN_ID        where DT.BENHAN_ID = '5857' and DT.LUUTRU_ID = '9562'                AND DT.CHAMSOCDICHTRUYEN_ID = '6703'        and DT.BENHVIEN_ID = 'HLU01'        order by D.AUTOCOMPLETEFIELD]
2019-08-26 15:36:43,142 [1] DEBUG - Statement Id: [DAO00020_ListKhoDuocOfPhongBan] PreparedStatement : [select B.* from TM_PHONGBAN_KHODUOC A        inner join TM_KHODUOC B on B.KHODUOC_ID = A.KHODUOC_ID        where        A.PHONGBAN_ID = '5'        and A.BENHVIEN_ID = 'HLU01']
2019-08-26 15:36:55,639 [1] DEBUG - Statement Id: [DAO00020_ListKhoDuocOfPhongBan] PreparedStatement : [select B.* from TM_PHONGBAN_KHODUOC A        inner join TM_KHODUOC B on B.KHODUOC_ID = A.KHODUOC_ID        where        A.PHONGBAN_ID = '59'        and A.BENHVIEN_ID = 'HLU01']
2019-08-26 15:36:55,821 [1] DEBUG - Statement Id: [DAO00008_UpdateUserIdPhongBanKhoDuoc] PreparedStatement : [IF EXISTS            (SELECT ACCOUNT_ID FROM TM_SYS_USERS WHERE ACCOUNT_ID =  @param0  and HOSPITAL_ID =  @param1 )            BEGIN            update TM_SYS_USERS set INVENTORY_ID =  @param2 , WORKING_DEPT_ID =  @param3             WHERE ACCOUNT_ID =  @param0  and HOSPITAL_ID =  @param1             END            ELSE            BEGIN            insert into TM_SYS_USERS ([ACCOUNT_ID], [ACCOUNT_NAME], [INVENTORY_ID], [WORKING_DEPT_ID], [HOSPITAL_ID])            values ( @param0 ,  @param4 ,  @param2 ,  @param3 ,  @param1 )            END]
2019-08-26 15:36:55,821 [1] DEBUG - Statement Id: [DAO00008_UpdateUserIdPhongBanKhoDuoc] Parameters: [@param0=[ACCOUNT_ID,113], @param1=[HOSPITAL_ID,HLU01], @param2=[INVENTORY_ID,null], @param3=[WORKING_DEPT_ID,59], @param4=[ACCOUNT_NAME,admin]]
2019-08-26 15:36:55,821 [1] DEBUG - Statement Id: [DAO00008_UpdateUserIdPhongBanKhoDuoc] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[String, System.String]]
2019-08-26 15:37:02,423 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'HSM27'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 15:37:02,688 [1] DEBUG - Statement Id: [DAO00307_GetContractWithDate] PreparedStatement : [SELECT HD.*, HD.SO_HD + ' - ' + CT.TENCONGTY AS HOPDONG, CT.TENCONGTY        FROM TT_KSK_HOPDONG HD JOIN TT_KSK_CONGTY CT ON CT.CONGTY_ID = HD.CONGTY_ID         where               HD.BENHVIEN_ID = 'HLU01']
2019-08-26 15:37:03,172 [1] DEBUG - Statement Id: [DAO00329_GetList_BenhNhan_KSK] PreparedStatement : [select * from(select COUNT(*) OVER() as TOTALROWS,ROW_NUMBER() OVER (ORDER BY a.MAYTE) as ROWNUMBER, * from        (SELECT distinct BN.MAYTE,BN.TENBENHNHAN,BN.BENHNHAN_ID,BNDV.TIEPNHAN_ID,DV.MADICHVU        ,Case when BN.GIOITINH =1 then N'Nam' else N'Nữ' end as GIOITINH,BNDV.DVYEUCAU_ID,BNDV.PHONGBAN_ID as NOITHUCHIEN_ID        ,CONVERT(varchar(20), BN.NGAYSINH, 103) AS NGAYSINH,DV.TENDICHVU,PB.TENPHONGBAN as TENPHONGKHAM,CT.TENCONGTY,BNDV.SOPHIEUYEUCAU        ,HD.SO_HD,TN.SOTIEPNHAN,TN.NGUOITAO_ID,BNDV.DICHVU_ID        FROM TT_KSK_CONGTY CT        left join TT_KSK_HOPDONG HD ON HD.CONGTY_ID=CT.CONGTY_ID        left join TT_KSK_HOPDONG_BENHNHAN BN ON BN.HOPDONG_ID=HD.HOPDONG_ID        left join TT_KSK_HOPDONG_BENHNHAN_DICHVU BNDV ON BNDV.HOPDONG_BENHNHAN_ID=BN.HOPDONG_BENHNHAN_ID        left join TT_KSK_HOPDONG_GOIDICHVU GDV ON GDV.HOPDONG_ID= BN.HOPDONG_ID        left join TM_DICHVU DV ON DV.DICHVU_ID=BNDV.DICHVU_ID        left join TM_PHONGBAN PB ON PB.PHONGBAN_ID=BNDV.PHONGBAN_ID        join TT_TIEPNHAN TN ON TN.TIEPNHAN_ID=BNDV.TIEPNHAN_ID        where BNDV.TRANGTHAI='DAXACNHAN' AND HD.BENHVIEN_ID = 'HLU01' AND BNDV.PHONGBAN_ID='59'        AND BNDV.DATHUCHIEN IS NULL)a )b        where b.ROWNUMBER between '1' AND '20']
2019-08-26 15:37:10,879 [1] DEBUG - Statement Id: [DAO00020_ListKhoDuocOfPhongBan] PreparedStatement : [select B.* from TM_PHONGBAN_KHODUOC A        inner join TM_KHODUOC B on B.KHODUOC_ID = A.KHODUOC_ID        where        A.PHONGBAN_ID = ''        and A.BENHVIEN_ID = 'HLU01']
2019-08-26 15:37:11,219 [1] DEBUG - Statement Id: [DAO00020_ListKhoDuocOfPhongBan] PreparedStatement : [select B.* from TM_PHONGBAN_KHODUOC A        inner join TM_KHODUOC B on B.KHODUOC_ID = A.KHODUOC_ID        where        A.PHONGBAN_ID = '59'        and A.BENHVIEN_ID = 'HLU01']
2019-08-26 15:37:15,551 [1] DEBUG - Statement Id: [DAO00020_ListKhoDuocOfPhongBan] PreparedStatement : [select B.* from TM_PHONGBAN_KHODUOC A        inner join TM_KHODUOC B on B.KHODUOC_ID = A.KHODUOC_ID        where        A.PHONGBAN_ID = '58'        and A.BENHVIEN_ID = 'HLU01']
2019-08-26 15:37:15,719 [1] DEBUG - Statement Id: [DAO00008_UpdateUserIdPhongBanKhoDuoc] PreparedStatement : [IF EXISTS            (SELECT ACCOUNT_ID FROM TM_SYS_USERS WHERE ACCOUNT_ID =  @param0  and HOSPITAL_ID =  @param1 )            BEGIN            update TM_SYS_USERS set INVENTORY_ID =  @param2 , WORKING_DEPT_ID =  @param3             WHERE ACCOUNT_ID =  @param0  and HOSPITAL_ID =  @param1             END            ELSE            BEGIN            insert into TM_SYS_USERS ([ACCOUNT_ID], [ACCOUNT_NAME], [INVENTORY_ID], [WORKING_DEPT_ID], [HOSPITAL_ID])            values ( @param0 ,  @param4 ,  @param2 ,  @param3 ,  @param1 )            END]
2019-08-26 15:37:15,719 [1] DEBUG - Statement Id: [DAO00008_UpdateUserIdPhongBanKhoDuoc] Parameters: [@param0=[ACCOUNT_ID,113], @param1=[HOSPITAL_ID,HLU01], @param2=[INVENTORY_ID,null], @param3=[WORKING_DEPT_ID,58], @param4=[ACCOUNT_NAME,admin]]
2019-08-26 15:37:15,719 [1] DEBUG - Statement Id: [DAO00008_UpdateUserIdPhongBanKhoDuoc] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[String, System.String]]
2019-08-26 15:37:18,579 [1] DEBUG - Statement Id: [DAO00307_GetContractWithDate] PreparedStatement : [SELECT HD.*, HD.SO_HD + ' - ' + CT.TENCONGTY AS HOPDONG, CT.TENCONGTY        FROM TT_KSK_HOPDONG HD JOIN TT_KSK_CONGTY CT ON CT.CONGTY_ID = HD.CONGTY_ID         where               HD.BENHVIEN_ID = 'HLU01']
2019-08-26 15:37:18,700 [1] DEBUG - Statement Id: [DAO00329_GetList_BenhNhan_KSK] PreparedStatement : [select * from(select COUNT(*) OVER() as TOTALROWS,ROW_NUMBER() OVER (ORDER BY a.MAYTE) as ROWNUMBER, * from        (SELECT distinct BN.MAYTE,BN.TENBENHNHAN,BN.BENHNHAN_ID,BNDV.TIEPNHAN_ID,DV.MADICHVU        ,Case when BN.GIOITINH =1 then N'Nam' else N'Nữ' end as GIOITINH,BNDV.DVYEUCAU_ID,BNDV.PHONGBAN_ID as NOITHUCHIEN_ID        ,CONVERT(varchar(20), BN.NGAYSINH, 103) AS NGAYSINH,DV.TENDICHVU,PB.TENPHONGBAN as TENPHONGKHAM,CT.TENCONGTY,BNDV.SOPHIEUYEUCAU        ,HD.SO_HD,TN.SOTIEPNHAN,TN.NGUOITAO_ID,BNDV.DICHVU_ID        FROM TT_KSK_CONGTY CT        left join TT_KSK_HOPDONG HD ON HD.CONGTY_ID=CT.CONGTY_ID        left join TT_KSK_HOPDONG_BENHNHAN BN ON BN.HOPDONG_ID=HD.HOPDONG_ID        left join TT_KSK_HOPDONG_BENHNHAN_DICHVU BNDV ON BNDV.HOPDONG_BENHNHAN_ID=BN.HOPDONG_BENHNHAN_ID        left join TT_KSK_HOPDONG_GOIDICHVU GDV ON GDV.HOPDONG_ID= BN.HOPDONG_ID        left join TM_DICHVU DV ON DV.DICHVU_ID=BNDV.DICHVU_ID        left join TM_PHONGBAN PB ON PB.PHONGBAN_ID=BNDV.PHONGBAN_ID        join TT_TIEPNHAN TN ON TN.TIEPNHAN_ID=BNDV.TIEPNHAN_ID        where BNDV.TRANGTHAI='DAXACNHAN' AND HD.BENHVIEN_ID = 'HLU01' AND BNDV.PHONGBAN_ID='58'        AND BNDV.DATHUCHIEN IS NULL)a )b        where b.ROWNUMBER between '1' AND '20']
2019-08-26 15:37:32,691 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'HSM08'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 15:37:32,922 [1] DEBUG - Statement Id: [DAO00307_GetContractWithDate] PreparedStatement : [SELECT HD.*, HD.SO_HD + ' - ' + CT.TENCONGTY AS HOPDONG, CT.TENCONGTY        FROM TT_KSK_HOPDONG HD JOIN TT_KSK_CONGTY CT ON CT.CONGTY_ID = HD.CONGTY_ID         where               HD.BENHVIEN_ID = 'HLU01']
2019-08-26 15:37:33,176 [1] DEBUG - Statement Id: [DAO00307_GetContractWithDate] PreparedStatement : [SELECT HD.*, HD.SO_HD + ' - ' + CT.TENCONGTY AS HOPDONG, CT.TENCONGTY        FROM TT_KSK_HOPDONG HD JOIN TT_KSK_CONGTY CT ON CT.CONGTY_ID = HD.CONGTY_ID         where               HD.BENHVIEN_ID = 'HLU01']
2019-08-26 15:37:37,204 [1] DEBUG - Statement Id: [DAO00307_GetPatientConfirms] PreparedStatement : [select distinct HD_BN.*        , CASE WHEN HD_BN.GIOITINH = '1' THEN N'Nam' ELSE N'Nữ' END AS GENDER        , CASE WHEN HD_DV.ACTIVE IS NULL THEN 0 ELSE 1 END BENHNHAN_DANGKYKSK_DICHVU        , case when HD_BN.GOI_ID is null then N'Hợp đồng:' + ' ' + HD.SO_HD else N'Gói khám:' + ' ' + G.TENGOI end as DOITUONG        , LST.DICTIONARY_NAME as HONNHAN        from TT_KSK_HOPDONG HD        inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        left join LST_DICTIONARY LST ON LST.DICTIONARY_ID = HD_BN.TINHTRANGHONNHAN_ID AND LST.DICTIONARY_TYPE_CODE = 'TinhTrangGiaDinh'        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        left join TT_TIEPNHAN TN on TN.TIEPNHAN_ID = HD_DV.TIEPNHAN_ID        left join TM_CSKH_GOI G ON G.GOI_ID = HD_BN.GOI_ID        where HD.HOPDONG_ID = 3         AND           HD.BENHVIEN_ID = 'HLU01'                 order by HD_BN.STT]
2019-08-26 15:37:38,222 [1] DEBUG - Statement Id: [DAO00308_GetTiepNhanID] PreparedStatement : [select top 1 TN.TIEPNHAN_ID, TN.SOTIEPNHAN        from TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV        inner join TT_TIEPNHAN TN on TN.TIEPNHAN_ID = HD_DV.TIEPNHAN_ID        where HD_DV.HOPDONG_BENHNHAN_ID = 203 and HD_DV.HOPDONG_ID = 3]
2019-08-26 15:37:38,325 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '203'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-08-26 15:37:58,163 [1] DEBUG - Statement Id: [DAO00020_ListKhoDuocOfPhongBan] PreparedStatement : [select B.* from TM_PHONGBAN_KHODUOC A        inner join TM_KHODUOC B on B.KHODUOC_ID = A.KHODUOC_ID        where        A.PHONGBAN_ID = ''        and A.BENHVIEN_ID = 'HLU01']
2019-08-26 15:37:58,485 [1] DEBUG - Statement Id: [DAO00020_ListKhoDuocOfPhongBan] PreparedStatement : [select B.* from TM_PHONGBAN_KHODUOC A        inner join TM_KHODUOC B on B.KHODUOC_ID = A.KHODUOC_ID        where        A.PHONGBAN_ID = '58'        and A.BENHVIEN_ID = 'HLU01']
2019-08-26 15:38:06,033 [1] DEBUG - Statement Id: [DAO00020_ListKhoDuocOfPhongBan] PreparedStatement : [select B.* from TM_PHONGBAN_KHODUOC A        inner join TM_KHODUOC B on B.KHODUOC_ID = A.KHODUOC_ID        where        A.PHONGBAN_ID = '64'        and A.BENHVIEN_ID = 'HLU01']
2019-08-26 15:38:06,174 [1] DEBUG - Statement Id: [DAO00008_UpdateUserIdPhongBanKhoDuoc] PreparedStatement : [IF EXISTS            (SELECT ACCOUNT_ID FROM TM_SYS_USERS WHERE ACCOUNT_ID =  @param0  and HOSPITAL_ID =  @param1 )            BEGIN            update TM_SYS_USERS set INVENTORY_ID =  @param2 , WORKING_DEPT_ID =  @param3             WHERE ACCOUNT_ID =  @param0  and HOSPITAL_ID =  @param1             END            ELSE            BEGIN            insert into TM_SYS_USERS ([ACCOUNT_ID], [ACCOUNT_NAME], [INVENTORY_ID], [WORKING_DEPT_ID], [HOSPITAL_ID])            values ( @param0 ,  @param4 ,  @param2 ,  @param3 ,  @param1 )            END]
2019-08-26 15:38:06,174 [1] DEBUG - Statement Id: [DAO00008_UpdateUserIdPhongBanKhoDuoc] Parameters: [@param0=[ACCOUNT_ID,113], @param1=[HOSPITAL_ID,HLU01], @param2=[INVENTORY_ID,null], @param3=[WORKING_DEPT_ID,64], @param4=[ACCOUNT_NAME,admin]]
2019-08-26 15:38:06,174 [1] DEBUG - Statement Id: [DAO00008_UpdateUserIdPhongBanKhoDuoc] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[String, System.String]]
2019-08-26 15:38:12,630 [1] DEBUG - Statement Id: [DAO00307_GetContractWithDate] PreparedStatement : [SELECT HD.*, HD.SO_HD + ' - ' + CT.TENCONGTY AS HOPDONG, CT.TENCONGTY        FROM TT_KSK_HOPDONG HD JOIN TT_KSK_CONGTY CT ON CT.CONGTY_ID = HD.CONGTY_ID         where               HD.BENHVIEN_ID = 'HLU01']
2019-08-26 15:38:12,696 [1] DEBUG - Statement Id: [DAO00329_GetList_BenhNhan_KSK] PreparedStatement : [select * from(select COUNT(*) OVER() as TOTALROWS,ROW_NUMBER() OVER (ORDER BY a.MAYTE) as ROWNUMBER, * from        (SELECT distinct BN.MAYTE,BN.TENBENHNHAN,BN.BENHNHAN_ID,BNDV.TIEPNHAN_ID,DV.MADICHVU        ,Case when BN.GIOITINH =1 then N'Nam' else N'Nữ' end as GIOITINH,BNDV.DVYEUCAU_ID,BNDV.PHONGBAN_ID as NOITHUCHIEN_ID        ,CONVERT(varchar(20), BN.NGAYSINH, 103) AS NGAYSINH,DV.TENDICHVU,PB.TENPHONGBAN as TENPHONGKHAM,CT.TENCONGTY,BNDV.SOPHIEUYEUCAU        ,HD.SO_HD,TN.SOTIEPNHAN,TN.NGUOITAO_ID,BNDV.DICHVU_ID        FROM TT_KSK_CONGTY CT        left join TT_KSK_HOPDONG HD ON HD.CONGTY_ID=CT.CONGTY_ID        left join TT_KSK_HOPDONG_BENHNHAN BN ON BN.HOPDONG_ID=HD.HOPDONG_ID        left join TT_KSK_HOPDONG_BENHNHAN_DICHVU BNDV ON BNDV.HOPDONG_BENHNHAN_ID=BN.HOPDONG_BENHNHAN_ID        left join TT_KSK_HOPDONG_GOIDICHVU GDV ON GDV.HOPDONG_ID= BN.HOPDONG_ID        left join TM_DICHVU DV ON DV.DICHVU_ID=BNDV.DICHVU_ID        left join TM_PHONGBAN PB ON PB.PHONGBAN_ID=BNDV.PHONGBAN_ID        join TT_TIEPNHAN TN ON TN.TIEPNHAN_ID=BNDV.TIEPNHAN_ID        where BNDV.TRANGTHAI='DAXACNHAN' AND HD.BENHVIEN_ID = 'HLU01' AND BNDV.PHONGBAN_ID='64'        AND BNDV.DATHUCHIEN IS NULL)a )b        where b.ROWNUMBER between '1' AND '20']
2019-08-26 15:38:15,058 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'HSM20'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 15:38:20,279 [1] DEBUG - Statement Id: [DAO00328_GetListTiepNhanAll] PreparedStatement : [select distinct A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        B.*, HD.SO_HD + ' - ' + CT.TENCONGTY as TENHOPDONG, G.DESCRIPTION as GENDER, DT.TENDOITUONG, N.DICTIONARY_NAME as NGHENGHIEP        , case when B.NGAYSINH is null then convert(varchar(4),B.NAMSINH) else convert(varchar(10),B.NGAYSINH,103) end as NGAYTHANGNAMSINH        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN') and B.ACTIVE = '1'        inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.BENHNHAN_ID = B.BENHNHAN_ID        inner join TT_KSK_HOPDONG HD on HD.HOPDONG_ID = HD_BN.HOPDONG_ID        inner join TT_KSK_CONGTY CT on CT.CONGTY_ID = HD.CONGTY_ID        inner join TM_GENDER G on G.ID = B.GIOITINH        inner join TM_DOITUONG DT on DT.DOITUONG_ID = A.DOITUONG_ID        left join LST_DICTIONARY N on N.DICTIONARY_ID = HD_BN.NGHENGHIEP_ID and N.DICTIONARY_TYPE_CODE = 'NgheNghiep'        where A.BENHVIEN_ID = 'HLU01' and HD.KHOA = '0' and CT.TAMNGUNG = '0']
2019-08-26 15:38:20,379 [1] DEBUG - Statement Id: [DAO00328_GetPatientId] PreparedStatement : [select BN.*, KQ.KETQUA_ID        from TT_KSK_HOPDONG_BENHNHAN BN        left join TT_KSK_KETQUA KQ on KQ.HOPDONG_BENHNHAN_ID = BN.HOPDONG_BENHNHAN_ID         where                 BN.BENHNHAN_ID = 23420             and               BN.BENHVIEN_ID = 'HLU01']
2019-08-26 15:38:20,463 [1] DEBUG - Statement Id: [DAO00329_Insert_Data] PreparedStatement : [DECLARE @CHECK int        IF (SELECT COUNT(*) FROM TT_KSK_KETQUA WHERE HOPDONG_ID=3 AND HOPDONG_BENHNHAN_ID=203) = 0        BEGIN        INSERT INTO TT_KSK_KETQUA (TIEPNHAN_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values( @param0 , @param1 , @param2 , @param3 );        SET @CHECK = (SELECT SCOPE_IDENTITY())        INSERT INTO TT_KSK_KETQUA_NOI(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_NGOAI(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_DALIEU(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_PHUKHOA(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_RHM(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_TMH(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_MAT(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        END        ELSE        BEGIN        RETURN        END;]
2019-08-26 15:38:20,463 [1] DEBUG - Statement Id: [DAO00329_Insert_Data] Parameters: [@param0=[TIEPNHAN_ID,27475], @param1=[HOPDONG_ID,3], @param2=[HOPDONG_BENHNHAN_ID,203], @param3=[BENHVIEN_ID,HLU01]]
2019-08-26 15:38:20,463 [1] DEBUG - Statement Id: [DAO00329_Insert_Data] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64], @param2=[Int64, System.Int64], @param3=[String, System.String]]
2019-08-26 15:38:20,498 [1] DEBUG - Statement Id: [DAO00309_GhiChu] PreparedStatement : [select GHICHU from TT_KSK_HOPDONG_BENHNHAN where HOPDONG_BENHNHAN_ID = 203]
2019-08-26 15:38:20,563 [1] DEBUG - Statement Id: [DAO00328_GetKetQuaKSK] PreparedStatement : [SELECT KQ.KETQUA_ID,KQ.TIEPNHAN_ID,KQ.HOPDONG_ID,KQ.HOPDONG_BENHNHAN_ID,SH.MACH,SH.CANNANG,SH.CHIEUCAO,SH.HUYETAPCAO,SH.HUYETAPTHAP,SH.NHIPTHO,SH.NHIETDO,SH.CHISOBMI AS BMI        ,N.TUANHOAN,N.PLTUANHOAN_ID,N.HOHAP,n.PLHOHAP_ID,N.TIEUHOA,N.PLTIEUHOA_ID,N.THAN,N.PLTHAN_ID,N.NOITIET,N.PLNOITIET_ID        ,N.COXUONGKHOP,N.PLCOXUONGKHOP_ID,N.THANKINH,N.PLTHANKINH_ID,N.TAMTHAN,N.PLTAMTHAN_ID,N.BACSIKHAMNOI_ID,NG.NGOAIKHOA        ,NG.PLNGOAIKHOA_ID,NG.BACSINGOAIKHOA_ID,PK.SANPHUKHOA,PK.PLSANPHUKHOA_ID,PK.BACSISANPHUKHOA_ID,MAT.COKINHMATTRAI        ,MAT.COKINHMATPHAI,MAT.KHONGKINHMATTRAI,MAT.KHONGKINHMATPHAI,MAT.CACBENHVEMAT,MAT.PLMAT_ID,MAT.BACSIMAT_ID        ,TMH.TAITRAINOITHUONG,TMH.TAITRAINOITHAM,TMH.TAIPHAINOITHUONG,TMH.TAIPHAINOITHAM,TMH.CACBENHVETAI,TMH.PLTAIMH_ID,TMH.BACSITMH_ID        ,RHM.HAMTREN,RHM.HAMDUOI,RHM.CACBENHVERHM,RHM.PLRHM_ID,RHM.BACSIRHM_ID,DL.DALIEU,DL.PLDALIEU_ID,DL.BACSIDALIEU_ID        ,KQ.BACSIKETLUAN_ID,KQ.NHANXET,KQ.XEPLOAI_ID,KQ.TENICD        FROM TT_KSK_KETQUA KQ        LEFT JOIN TT_KSK_KETQUA_NOI N ON KQ.KETQUA_ID = N.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_NGOAI NG ON KQ.KETQUA_ID=NG.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_MAT MAT ON KQ.KETQUA_ID=MAT.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_PHUKHOA PK ON KQ.KETQUA_ID=PK.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_RHM RHM ON KQ.KETQUA_ID=RHM.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_TMH TMH ON KQ.KETQUA_ID=TMH.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_DALIEU DL ON KQ.KETQUA_ID=DL.KETQUA_ID        LEFT JOIN TT_NGOAITRU_KHAMBENH_SINHHIEU SH ON KQ.TIEPNHAN_ID = SH.TIEPNHAN_ID        where (DL.HOPDONG_BENHNHAN_ID  = 203 and DL.BENHVIEN_ID = 'HLU01')        OR (KQ.HOPDONG_BENHNHAN_ID  = 203 and KQ.BENHVIEN_ID = 'HLU01')        OR (N.HOPDONG_BENHNHAN_ID  = 203 and N.BENHVIEN_ID = 'HLU01')        OR (NG.HOPDONG_BENHNHAN_ID  = 203 and NG.BENHVIEN_ID = 'HLU01')        OR (RHM.HOPDONG_BENHNHAN_ID  = 203 and RHM.BENHVIEN_ID = 'HLU01')        OR (MAT.HOPDONG_BENHNHAN_ID  = 203 and MAT.BENHVIEN_ID = 'HLU01')        OR (PK.HOPDONG_BENHNHAN_ID  = 203 and PK.BENHVIEN_ID = 'HLU01')        OR (TMH.HOPDONG_BENHNHAN_ID  = 203 and TMH.BENHVIEN_ID = 'HLU01')]
2019-08-26 15:38:20,677 [1] DEBUG - Statement Id: [DAO00328_GetPatientId] PreparedStatement : [select BN.*, KQ.KETQUA_ID        from TT_KSK_HOPDONG_BENHNHAN BN        left join TT_KSK_KETQUA KQ on KQ.HOPDONG_BENHNHAN_ID = BN.HOPDONG_BENHNHAN_ID         where                 BN.BENHNHAN_ID = 23420             and               BN.BENHVIEN_ID = 'HLU01']
2019-08-26 15:38:20,762 [1] DEBUG - Statement Id: [DAO00329_Insert_Data] PreparedStatement : [DECLARE @CHECK int        IF (SELECT COUNT(*) FROM TT_KSK_KETQUA WHERE HOPDONG_ID=3 AND HOPDONG_BENHNHAN_ID=203) = 0        BEGIN        INSERT INTO TT_KSK_KETQUA (TIEPNHAN_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values( @param0 , @param1 , @param2 , @param3 );        SET @CHECK = (SELECT SCOPE_IDENTITY())        INSERT INTO TT_KSK_KETQUA_NOI(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_NGOAI(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_DALIEU(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_PHUKHOA(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_RHM(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_TMH(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_MAT(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        END        ELSE        BEGIN        RETURN        END;]
2019-08-26 15:38:20,762 [1] DEBUG - Statement Id: [DAO00329_Insert_Data] Parameters: [@param0=[TIEPNHAN_ID,27475], @param1=[HOPDONG_ID,3], @param2=[HOPDONG_BENHNHAN_ID,203], @param3=[BENHVIEN_ID,HLU01]]
2019-08-26 15:38:20,762 [1] DEBUG - Statement Id: [DAO00329_Insert_Data] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64], @param2=[Int64, System.Int64], @param3=[String, System.String]]
2019-08-26 15:38:20,789 [1] DEBUG - Statement Id: [DAO00309_GhiChu] PreparedStatement : [select GHICHU from TT_KSK_HOPDONG_BENHNHAN where HOPDONG_BENHNHAN_ID = 203]
2019-08-26 15:38:20,844 [1] DEBUG - Statement Id: [DAO00328_GetKetQuaKSK] PreparedStatement : [SELECT KQ.KETQUA_ID,KQ.TIEPNHAN_ID,KQ.HOPDONG_ID,KQ.HOPDONG_BENHNHAN_ID,SH.MACH,SH.CANNANG,SH.CHIEUCAO,SH.HUYETAPCAO,SH.HUYETAPTHAP,SH.NHIPTHO,SH.NHIETDO,SH.CHISOBMI AS BMI        ,N.TUANHOAN,N.PLTUANHOAN_ID,N.HOHAP,n.PLHOHAP_ID,N.TIEUHOA,N.PLTIEUHOA_ID,N.THAN,N.PLTHAN_ID,N.NOITIET,N.PLNOITIET_ID        ,N.COXUONGKHOP,N.PLCOXUONGKHOP_ID,N.THANKINH,N.PLTHANKINH_ID,N.TAMTHAN,N.PLTAMTHAN_ID,N.BACSIKHAMNOI_ID,NG.NGOAIKHOA        ,NG.PLNGOAIKHOA_ID,NG.BACSINGOAIKHOA_ID,PK.SANPHUKHOA,PK.PLSANPHUKHOA_ID,PK.BACSISANPHUKHOA_ID,MAT.COKINHMATTRAI        ,MAT.COKINHMATPHAI,MAT.KHONGKINHMATTRAI,MAT.KHONGKINHMATPHAI,MAT.CACBENHVEMAT,MAT.PLMAT_ID,MAT.BACSIMAT_ID        ,TMH.TAITRAINOITHUONG,TMH.TAITRAINOITHAM,TMH.TAIPHAINOITHUONG,TMH.TAIPHAINOITHAM,TMH.CACBENHVETAI,TMH.PLTAIMH_ID,TMH.BACSITMH_ID        ,RHM.HAMTREN,RHM.HAMDUOI,RHM.CACBENHVERHM,RHM.PLRHM_ID,RHM.BACSIRHM_ID,DL.DALIEU,DL.PLDALIEU_ID,DL.BACSIDALIEU_ID        ,KQ.BACSIKETLUAN_ID,KQ.NHANXET,KQ.XEPLOAI_ID,KQ.TENICD        FROM TT_KSK_KETQUA KQ        LEFT JOIN TT_KSK_KETQUA_NOI N ON KQ.KETQUA_ID = N.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_NGOAI NG ON KQ.KETQUA_ID=NG.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_MAT MAT ON KQ.KETQUA_ID=MAT.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_PHUKHOA PK ON KQ.KETQUA_ID=PK.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_RHM RHM ON KQ.KETQUA_ID=RHM.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_TMH TMH ON KQ.KETQUA_ID=TMH.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_DALIEU DL ON KQ.KETQUA_ID=DL.KETQUA_ID        LEFT JOIN TT_NGOAITRU_KHAMBENH_SINHHIEU SH ON KQ.TIEPNHAN_ID = SH.TIEPNHAN_ID        where (DL.HOPDONG_BENHNHAN_ID  = 203 and DL.BENHVIEN_ID = 'HLU01')        OR (KQ.HOPDONG_BENHNHAN_ID  = 203 and KQ.BENHVIEN_ID = 'HLU01')        OR (N.HOPDONG_BENHNHAN_ID  = 203 and N.BENHVIEN_ID = 'HLU01')        OR (NG.HOPDONG_BENHNHAN_ID  = 203 and NG.BENHVIEN_ID = 'HLU01')        OR (RHM.HOPDONG_BENHNHAN_ID  = 203 and RHM.BENHVIEN_ID = 'HLU01')        OR (MAT.HOPDONG_BENHNHAN_ID  = 203 and MAT.BENHVIEN_ID = 'HLU01')        OR (PK.HOPDONG_BENHNHAN_ID  = 203 and PK.BENHVIEN_ID = 'HLU01')        OR (TMH.HOPDONG_BENHNHAN_ID  = 203 and TMH.BENHVIEN_ID = 'HLU01')]
2019-08-26 15:38:27,232 [1] DEBUG - Statement Id: [DAO00328_GetListTiepNhanAll] PreparedStatement : [select distinct A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        B.*, HD.SO_HD + ' - ' + CT.TENCONGTY as TENHOPDONG, G.DESCRIPTION as GENDER, DT.TENDOITUONG, N.DICTIONARY_NAME as NGHENGHIEP        , case when B.NGAYSINH is null then convert(varchar(4),B.NAMSINH) else convert(varchar(10),B.NGAYSINH,103) end as NGAYTHANGNAMSINH        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN') and B.ACTIVE = '1'        inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.BENHNHAN_ID = B.BENHNHAN_ID        inner join TT_KSK_HOPDONG HD on HD.HOPDONG_ID = HD_BN.HOPDONG_ID        inner join TT_KSK_CONGTY CT on CT.CONGTY_ID = HD.CONGTY_ID        inner join TM_GENDER G on G.ID = B.GIOITINH        inner join TM_DOITUONG DT on DT.DOITUONG_ID = A.DOITUONG_ID        left join LST_DICTIONARY N on N.DICTIONARY_ID = HD_BN.NGHENGHIEP_ID and N.DICTIONARY_TYPE_CODE = 'NgheNghiep'        where A.BENHVIEN_ID = 'HLU01' and HD.KHOA = '0' and CT.TAMNGUNG = '0']
2019-08-26 15:38:27,324 [1] DEBUG - Statement Id: [DAO00328_GetPatientId] PreparedStatement : [select BN.*, KQ.KETQUA_ID        from TT_KSK_HOPDONG_BENHNHAN BN        left join TT_KSK_KETQUA KQ on KQ.HOPDONG_BENHNHAN_ID = BN.HOPDONG_BENHNHAN_ID         where                 BN.BENHNHAN_ID = 23420             and               BN.BENHVIEN_ID = 'HLU01']
2019-08-26 15:38:27,402 [1] DEBUG - Statement Id: [DAO00329_Insert_Data] PreparedStatement : [DECLARE @CHECK int        IF (SELECT COUNT(*) FROM TT_KSK_KETQUA WHERE HOPDONG_ID=3 AND HOPDONG_BENHNHAN_ID=203) = 0        BEGIN        INSERT INTO TT_KSK_KETQUA (TIEPNHAN_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values( @param0 , @param1 , @param2 , @param3 );        SET @CHECK = (SELECT SCOPE_IDENTITY())        INSERT INTO TT_KSK_KETQUA_NOI(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_NGOAI(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_DALIEU(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_PHUKHOA(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_RHM(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_TMH(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_MAT(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        END        ELSE        BEGIN        RETURN        END;]
2019-08-26 15:38:27,402 [1] DEBUG - Statement Id: [DAO00329_Insert_Data] Parameters: [@param0=[TIEPNHAN_ID,27475], @param1=[HOPDONG_ID,3], @param2=[HOPDONG_BENHNHAN_ID,203], @param3=[BENHVIEN_ID,HLU01]]
2019-08-26 15:38:27,402 [1] DEBUG - Statement Id: [DAO00329_Insert_Data] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64], @param2=[Int64, System.Int64], @param3=[String, System.String]]
2019-08-26 15:38:27,433 [1] DEBUG - Statement Id: [DAO00309_GhiChu] PreparedStatement : [select GHICHU from TT_KSK_HOPDONG_BENHNHAN where HOPDONG_BENHNHAN_ID = 203]
2019-08-26 15:38:27,483 [1] DEBUG - Statement Id: [DAO00328_GetKetQuaKSK] PreparedStatement : [SELECT KQ.KETQUA_ID,KQ.TIEPNHAN_ID,KQ.HOPDONG_ID,KQ.HOPDONG_BENHNHAN_ID,SH.MACH,SH.CANNANG,SH.CHIEUCAO,SH.HUYETAPCAO,SH.HUYETAPTHAP,SH.NHIPTHO,SH.NHIETDO,SH.CHISOBMI AS BMI        ,N.TUANHOAN,N.PLTUANHOAN_ID,N.HOHAP,n.PLHOHAP_ID,N.TIEUHOA,N.PLTIEUHOA_ID,N.THAN,N.PLTHAN_ID,N.NOITIET,N.PLNOITIET_ID        ,N.COXUONGKHOP,N.PLCOXUONGKHOP_ID,N.THANKINH,N.PLTHANKINH_ID,N.TAMTHAN,N.PLTAMTHAN_ID,N.BACSIKHAMNOI_ID,NG.NGOAIKHOA        ,NG.PLNGOAIKHOA_ID,NG.BACSINGOAIKHOA_ID,PK.SANPHUKHOA,PK.PLSANPHUKHOA_ID,PK.BACSISANPHUKHOA_ID,MAT.COKINHMATTRAI        ,MAT.COKINHMATPHAI,MAT.KHONGKINHMATTRAI,MAT.KHONGKINHMATPHAI,MAT.CACBENHVEMAT,MAT.PLMAT_ID,MAT.BACSIMAT_ID        ,TMH.TAITRAINOITHUONG,TMH.TAITRAINOITHAM,TMH.TAIPHAINOITHUONG,TMH.TAIPHAINOITHAM,TMH.CACBENHVETAI,TMH.PLTAIMH_ID,TMH.BACSITMH_ID        ,RHM.HAMTREN,RHM.HAMDUOI,RHM.CACBENHVERHM,RHM.PLRHM_ID,RHM.BACSIRHM_ID,DL.DALIEU,DL.PLDALIEU_ID,DL.BACSIDALIEU_ID        ,KQ.BACSIKETLUAN_ID,KQ.NHANXET,KQ.XEPLOAI_ID,KQ.TENICD        FROM TT_KSK_KETQUA KQ        LEFT JOIN TT_KSK_KETQUA_NOI N ON KQ.KETQUA_ID = N.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_NGOAI NG ON KQ.KETQUA_ID=NG.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_MAT MAT ON KQ.KETQUA_ID=MAT.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_PHUKHOA PK ON KQ.KETQUA_ID=PK.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_RHM RHM ON KQ.KETQUA_ID=RHM.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_TMH TMH ON KQ.KETQUA_ID=TMH.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_DALIEU DL ON KQ.KETQUA_ID=DL.KETQUA_ID        LEFT JOIN TT_NGOAITRU_KHAMBENH_SINHHIEU SH ON KQ.TIEPNHAN_ID = SH.TIEPNHAN_ID        where (DL.HOPDONG_BENHNHAN_ID  = 203 and DL.BENHVIEN_ID = 'HLU01')        OR (KQ.HOPDONG_BENHNHAN_ID  = 203 and KQ.BENHVIEN_ID = 'HLU01')        OR (N.HOPDONG_BENHNHAN_ID  = 203 and N.BENHVIEN_ID = 'HLU01')        OR (NG.HOPDONG_BENHNHAN_ID  = 203 and NG.BENHVIEN_ID = 'HLU01')        OR (RHM.HOPDONG_BENHNHAN_ID  = 203 and RHM.BENHVIEN_ID = 'HLU01')        OR (MAT.HOPDONG_BENHNHAN_ID  = 203 and MAT.BENHVIEN_ID = 'HLU01')        OR (PK.HOPDONG_BENHNHAN_ID  = 203 and PK.BENHVIEN_ID = 'HLU01')        OR (TMH.HOPDONG_BENHNHAN_ID  = 203 and TMH.BENHVIEN_ID = 'HLU01')]
2019-08-26 15:38:27,603 [1] DEBUG - Statement Id: [DAO00328_GetPatientId] PreparedStatement : [select BN.*, KQ.KETQUA_ID        from TT_KSK_HOPDONG_BENHNHAN BN        left join TT_KSK_KETQUA KQ on KQ.HOPDONG_BENHNHAN_ID = BN.HOPDONG_BENHNHAN_ID         where                 BN.BENHNHAN_ID = 23420             and               BN.BENHVIEN_ID = 'HLU01']
2019-08-26 15:38:27,686 [1] DEBUG - Statement Id: [DAO00329_Insert_Data] PreparedStatement : [DECLARE @CHECK int        IF (SELECT COUNT(*) FROM TT_KSK_KETQUA WHERE HOPDONG_ID=3 AND HOPDONG_BENHNHAN_ID=203) = 0        BEGIN        INSERT INTO TT_KSK_KETQUA (TIEPNHAN_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values( @param0 , @param1 , @param2 , @param3 );        SET @CHECK = (SELECT SCOPE_IDENTITY())        INSERT INTO TT_KSK_KETQUA_NOI(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_NGOAI(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_DALIEU(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_PHUKHOA(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_RHM(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_TMH(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_MAT(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        END        ELSE        BEGIN        RETURN        END;]
2019-08-26 15:38:27,686 [1] DEBUG - Statement Id: [DAO00329_Insert_Data] Parameters: [@param0=[TIEPNHAN_ID,27475], @param1=[HOPDONG_ID,3], @param2=[HOPDONG_BENHNHAN_ID,203], @param3=[BENHVIEN_ID,HLU01]]
2019-08-26 15:38:27,686 [1] DEBUG - Statement Id: [DAO00329_Insert_Data] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64], @param2=[Int64, System.Int64], @param3=[String, System.String]]
2019-08-26 15:38:27,714 [1] DEBUG - Statement Id: [DAO00309_GhiChu] PreparedStatement : [select GHICHU from TT_KSK_HOPDONG_BENHNHAN where HOPDONG_BENHNHAN_ID = 203]
2019-08-26 15:38:27,765 [1] DEBUG - Statement Id: [DAO00328_GetKetQuaKSK] PreparedStatement : [SELECT KQ.KETQUA_ID,KQ.TIEPNHAN_ID,KQ.HOPDONG_ID,KQ.HOPDONG_BENHNHAN_ID,SH.MACH,SH.CANNANG,SH.CHIEUCAO,SH.HUYETAPCAO,SH.HUYETAPTHAP,SH.NHIPTHO,SH.NHIETDO,SH.CHISOBMI AS BMI        ,N.TUANHOAN,N.PLTUANHOAN_ID,N.HOHAP,n.PLHOHAP_ID,N.TIEUHOA,N.PLTIEUHOA_ID,N.THAN,N.PLTHAN_ID,N.NOITIET,N.PLNOITIET_ID        ,N.COXUONGKHOP,N.PLCOXUONGKHOP_ID,N.THANKINH,N.PLTHANKINH_ID,N.TAMTHAN,N.PLTAMTHAN_ID,N.BACSIKHAMNOI_ID,NG.NGOAIKHOA        ,NG.PLNGOAIKHOA_ID,NG.BACSINGOAIKHOA_ID,PK.SANPHUKHOA,PK.PLSANPHUKHOA_ID,PK.BACSISANPHUKHOA_ID,MAT.COKINHMATTRAI        ,MAT.COKINHMATPHAI,MAT.KHONGKINHMATTRAI,MAT.KHONGKINHMATPHAI,MAT.CACBENHVEMAT,MAT.PLMAT_ID,MAT.BACSIMAT_ID        ,TMH.TAITRAINOITHUONG,TMH.TAITRAINOITHAM,TMH.TAIPHAINOITHUONG,TMH.TAIPHAINOITHAM,TMH.CACBENHVETAI,TMH.PLTAIMH_ID,TMH.BACSITMH_ID        ,RHM.HAMTREN,RHM.HAMDUOI,RHM.CACBENHVERHM,RHM.PLRHM_ID,RHM.BACSIRHM_ID,DL.DALIEU,DL.PLDALIEU_ID,DL.BACSIDALIEU_ID        ,KQ.BACSIKETLUAN_ID,KQ.NHANXET,KQ.XEPLOAI_ID,KQ.TENICD        FROM TT_KSK_KETQUA KQ        LEFT JOIN TT_KSK_KETQUA_NOI N ON KQ.KETQUA_ID = N.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_NGOAI NG ON KQ.KETQUA_ID=NG.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_MAT MAT ON KQ.KETQUA_ID=MAT.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_PHUKHOA PK ON KQ.KETQUA_ID=PK.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_RHM RHM ON KQ.KETQUA_ID=RHM.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_TMH TMH ON KQ.KETQUA_ID=TMH.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_DALIEU DL ON KQ.KETQUA_ID=DL.KETQUA_ID        LEFT JOIN TT_NGOAITRU_KHAMBENH_SINHHIEU SH ON KQ.TIEPNHAN_ID = SH.TIEPNHAN_ID        where (DL.HOPDONG_BENHNHAN_ID  = 203 and DL.BENHVIEN_ID = 'HLU01')        OR (KQ.HOPDONG_BENHNHAN_ID  = 203 and KQ.BENHVIEN_ID = 'HLU01')        OR (N.HOPDONG_BENHNHAN_ID  = 203 and N.BENHVIEN_ID = 'HLU01')        OR (NG.HOPDONG_BENHNHAN_ID  = 203 and NG.BENHVIEN_ID = 'HLU01')        OR (RHM.HOPDONG_BENHNHAN_ID  = 203 and RHM.BENHVIEN_ID = 'HLU01')        OR (MAT.HOPDONG_BENHNHAN_ID  = 203 and MAT.BENHVIEN_ID = 'HLU01')        OR (PK.HOPDONG_BENHNHAN_ID  = 203 and PK.BENHVIEN_ID = 'HLU01')        OR (TMH.HOPDONG_BENHNHAN_ID  = 203 and TMH.BENHVIEN_ID = 'HLU01')]
2019-08-26 15:38:50,708 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'OPD19'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-26 15:38:53,325 [1] DEBUG - Statement Id: [DAO00000_GetDoiTuongIsBHYT] PreparedStatement : [select * from TM_DOITUONG Where DOITUONG_ID = 1 and MADOITUONG like '%BHYT%']
2019-08-26 15:38:53,404 [1] DEBUG - Statement Id: [DAO00068_GetDSSinhHieuByBenhNhanID] PreparedStatement : [select *              from TT_NGOAITRU_KHAMBENH_SINHHIEU              where BENHNHAN_ID = '23420'              and BENHVIEN_ID = 'HLU01'                             order by THOIGIANDO desc]
2019-08-26 15:38:53,476 [1] DEBUG - Statement Id: [DAO00068_GetTTBenhAnByBenhNhanID] PreparedStatement : [select TOP (1) tn.TIEPNHAN_ID, BENHAN_ID, ba.TRANGTHAI              from TT_TIEPNHAN tn              left join TT_NOITRU_BENHAN ba              on tn.TIEPNHAN_ID = ba.TIEPNHAN_ID              where tn.BENHNHAN_ID = '23420'              order by tn.NGAYTAO desc]
2019-08-26 15:38:53,570 [1] DEBUG - Statement Id: [DAO00014_GetTrangThaiTiepNhan] PreparedStatement : [select tn.TIEPNHAN_ID, tn.KHOADULIEU, xncp.XACNHANCHIPHI_ID from TT_TIEPNHAN tn        left join TT_XACNHANCHIPHI xncp        on tn.TIEPNHAN_ID = xncp.TIEPNHAN_ID        where tn.TIEPNHAN_ID = '27475'        and tn.BENHVIEN_ID = 'HLU01']
2019-08-26 15:39:42,779 [1] DEBUG - Statement Id: [DAO00014_GetPatientStatus] PreparedStatement : [select        CASE        when tn.TRANGTHAI = 'HOANTHANH' Then tn.TRANGTHAI        WHEN xncp.XACNHANCHIPHI_ID is not null THEN 'XACNHANCHIPHI'        WHEN (tn.KHOADULIEU = '1') THEN 'KHOADULIEU'        ELSE tn.TRANGTHAI        END        as TRANGTHAI        from TT_TIEPNHAN tn        left join TT_XACNHANCHIPHI xncp on tn.TIEPNHAN_ID = xncp.TIEPNHAN_ID        where tn.TIEPNHAN_ID = '27475'        and tn.BENHVIEN_ID = 'HLU01']
2019-08-26 15:39:42,891 [1] DEBUG - Statement Id: [DAO00068_GetTTBenhAnByBenhNhanID] PreparedStatement : [select TOP (1) tn.TIEPNHAN_ID, BENHAN_ID, ba.TRANGTHAI              from TT_TIEPNHAN tn              left join TT_NOITRU_BENHAN ba              on tn.TIEPNHAN_ID = ba.TIEPNHAN_ID              where tn.BENHNHAN_ID = '23420'              order by tn.NGAYTAO desc]
2019-08-26 15:39:43,027 [1] DEBUG - Statement Id: [DAO00014_GetTrangThaiTiepNhan] PreparedStatement : [select tn.TIEPNHAN_ID, tn.KHOADULIEU, xncp.XACNHANCHIPHI_ID from TT_TIEPNHAN tn        left join TT_XACNHANCHIPHI xncp        on tn.TIEPNHAN_ID = xncp.TIEPNHAN_ID        where tn.TIEPNHAN_ID = '27475'        and tn.BENHVIEN_ID = 'HLU01']
2019-08-26 15:39:43,188 [1] DEBUG - Statement Id: [DAO00068_Add] PreparedStatement : [insert into TT_NGOAITRU_KHAMBENH_SINHHIEU (              BENHNHAN_ID              , TIEPNHAN_ID              , KHAMBENH_ID              , NGAYDO              , THOIGIANDO              , NGUOIDO_ID              , PHONGBAN_ID              , MACH              , HUYETAPTHAP              , HUYETAPCAO              , NHIPTHO              , NHIETDO              , CHIEUCAO              , CANNANG              , CHISOBMI              , VONGBUNG              , GHICHU              , NGAYTAO              , NGUOITAO_ID              , NGAYCAPNHAT              , NGUOICAPNHAT_ID              , NOITRU_KHAMBENH_ID              , VONGDAU              , SPO2              , BENHVIEN_ID              ) values (               @param0               ,  @param1               ,  @param2               ,  @param3               ,  @param4               ,  @param5               ,  @param6               ,  @param7               ,  @param8               ,  @param9               ,  @param10               ,  @param11               ,  @param12               ,  @param13               ,  @param14               ,  @param15               ,  @param16               ,  @param17               ,  @param18               ,  @param19               ,  @param20               ,  @param21               ,  @param22               ,  @param23               ,  @param24               )              SELECT SCOPE_IDENTITY()]
2019-08-26 15:39:43,188 [1] DEBUG - Statement Id: [DAO00068_Add] Parameters: [@param0=[BENHNHAN_ID,23420], @param1=[TIEPNHAN_ID,27475], @param2=[KHAMBENH_ID,null], @param3=[NGAYDO,8/26/2019 12:00:00 AM], @param4=[THOIGIANDO,8/26/2019 3:38:53 PM], @param5=[NGUOIDO_ID,1], @param6=[PHONGBAN_ID,64], @param7=[MACH,72], @param8=[HUYETAPTHAP,110], @param9=[HUYETAPCAO,130], @param10=[NHIPTHO,80], @param11=[NHIETDO,37.5], @param12=[CHIEUCAO,168], @param13=[CANNANG,60], @param14=[CHISOBMI,21.26], @param15=[VONGBUNG,120], @param16=[GHICHU,null], @param17=[NGAYTAO,8/26/2019 3:39:43 PM], @param18=[NGUOITAO_ID,1], @param19=[NGAYCAPNHAT,8/26/2019 3:39:43 PM], @param20=[NGUOICAPNHAT_ID,1], @param21=[NOITRU_KHAMBENH_ID,null], @param22=[VONGDAU,90], @param23=[SPO2,12], @param24=[BENHVIEN_ID,HLU01]]
2019-08-26 15:39:43,188 [1] DEBUG - Statement Id: [DAO00068_Add] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64], @param2=[System.DBNull, null], @param3=[DateTime, System.DateTime], @param4=[DateTime, System.DateTime], @param5=[Int64, System.Int64], @param6=[Int64, System.Int64], @param7=[Double, System.Double], @param8=[Double, System.Double], @param9=[Double, System.Double], @param10=[Double, System.Double], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[Double, System.Double], @param14=[Double, System.Double], @param15=[Double, System.Double], @param16=[System.DBNull, null], @param17=[DateTime, System.DateTime], @param18=[Int64, System.Int64], @param19=[DateTime, System.DateTime], @param20=[Int64, System.Int64], @param21=[System.DBNull, null], @param22=[Double, System.Double], @param23=[Double, System.Double], @param24=[String, System.String]]
2019-08-26 15:39:48,980 [1] DEBUG - Statement Id: [DAO00328_GetListTiepNhanAll] PreparedStatement : [select distinct A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        B.*, HD.SO_HD + ' - ' + CT.TENCONGTY as TENHOPDONG, G.DESCRIPTION as GENDER, DT.TENDOITUONG, N.DICTIONARY_NAME as NGHENGHIEP        , case when B.NGAYSINH is null then convert(varchar(4),B.NAMSINH) else convert(varchar(10),B.NGAYSINH,103) end as NGAYTHANGNAMSINH        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN') and B.ACTIVE = '1'        inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.BENHNHAN_ID = B.BENHNHAN_ID        inner join TT_KSK_HOPDONG HD on HD.HOPDONG_ID = HD_BN.HOPDONG_ID        inner join TT_KSK_CONGTY CT on CT.CONGTY_ID = HD.CONGTY_ID        inner join TM_GENDER G on G.ID = B.GIOITINH        inner join TM_DOITUONG DT on DT.DOITUONG_ID = A.DOITUONG_ID        left join LST_DICTIONARY N on N.DICTIONARY_ID = HD_BN.NGHENGHIEP_ID and N.DICTIONARY_TYPE_CODE = 'NgheNghiep'        where A.BENHVIEN_ID = 'HLU01' and HD.KHOA = '0' and CT.TAMNGUNG = '0']
2019-08-26 15:39:49,094 [1] DEBUG - Statement Id: [DAO00328_GetPatientId] PreparedStatement : [select BN.*, KQ.KETQUA_ID        from TT_KSK_HOPDONG_BENHNHAN BN        left join TT_KSK_KETQUA KQ on KQ.HOPDONG_BENHNHAN_ID = BN.HOPDONG_BENHNHAN_ID         where                 BN.BENHNHAN_ID = 23420             and               BN.BENHVIEN_ID = 'HLU01']
2019-08-26 15:39:49,175 [1] DEBUG - Statement Id: [DAO00329_Insert_Data] PreparedStatement : [DECLARE @CHECK int        IF (SELECT COUNT(*) FROM TT_KSK_KETQUA WHERE HOPDONG_ID=3 AND HOPDONG_BENHNHAN_ID=203) = 0        BEGIN        INSERT INTO TT_KSK_KETQUA (TIEPNHAN_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values( @param0 , @param1 , @param2 , @param3 );        SET @CHECK = (SELECT SCOPE_IDENTITY())        INSERT INTO TT_KSK_KETQUA_NOI(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_NGOAI(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_DALIEU(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_PHUKHOA(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_RHM(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_TMH(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_MAT(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        END        ELSE        BEGIN        RETURN        END;]
2019-08-26 15:39:49,175 [1] DEBUG - Statement Id: [DAO00329_Insert_Data] Parameters: [@param0=[TIEPNHAN_ID,27475], @param1=[HOPDONG_ID,3], @param2=[HOPDONG_BENHNHAN_ID,203], @param3=[BENHVIEN_ID,HLU01]]
2019-08-26 15:39:49,175 [1] DEBUG - Statement Id: [DAO00329_Insert_Data] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64], @param2=[Int64, System.Int64], @param3=[String, System.String]]
2019-08-26 15:39:49,202 [1] DEBUG - Statement Id: [DAO00309_GhiChu] PreparedStatement : [select GHICHU from TT_KSK_HOPDONG_BENHNHAN where HOPDONG_BENHNHAN_ID = 203]
2019-08-26 15:39:49,253 [1] DEBUG - Statement Id: [DAO00328_GetKetQuaKSK] PreparedStatement : [SELECT KQ.KETQUA_ID,KQ.TIEPNHAN_ID,KQ.HOPDONG_ID,KQ.HOPDONG_BENHNHAN_ID,SH.MACH,SH.CANNANG,SH.CHIEUCAO,SH.HUYETAPCAO,SH.HUYETAPTHAP,SH.NHIPTHO,SH.NHIETDO,SH.CHISOBMI AS BMI        ,N.TUANHOAN,N.PLTUANHOAN_ID,N.HOHAP,n.PLHOHAP_ID,N.TIEUHOA,N.PLTIEUHOA_ID,N.THAN,N.PLTHAN_ID,N.NOITIET,N.PLNOITIET_ID        ,N.COXUONGKHOP,N.PLCOXUONGKHOP_ID,N.THANKINH,N.PLTHANKINH_ID,N.TAMTHAN,N.PLTAMTHAN_ID,N.BACSIKHAMNOI_ID,NG.NGOAIKHOA        ,NG.PLNGOAIKHOA_ID,NG.BACSINGOAIKHOA_ID,PK.SANPHUKHOA,PK.PLSANPHUKHOA_ID,PK.BACSISANPHUKHOA_ID,MAT.COKINHMATTRAI        ,MAT.COKINHMATPHAI,MAT.KHONGKINHMATTRAI,MAT.KHONGKINHMATPHAI,MAT.CACBENHVEMAT,MAT.PLMAT_ID,MAT.BACSIMAT_ID        ,TMH.TAITRAINOITHUONG,TMH.TAITRAINOITHAM,TMH.TAIPHAINOITHUONG,TMH.TAIPHAINOITHAM,TMH.CACBENHVETAI,TMH.PLTAIMH_ID,TMH.BACSITMH_ID        ,RHM.HAMTREN,RHM.HAMDUOI,RHM.CACBENHVERHM,RHM.PLRHM_ID,RHM.BACSIRHM_ID,DL.DALIEU,DL.PLDALIEU_ID,DL.BACSIDALIEU_ID        ,KQ.BACSIKETLUAN_ID,KQ.NHANXET,KQ.XEPLOAI_ID,KQ.TENICD        FROM TT_KSK_KETQUA KQ        LEFT JOIN TT_KSK_KETQUA_NOI N ON KQ.KETQUA_ID = N.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_NGOAI NG ON KQ.KETQUA_ID=NG.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_MAT MAT ON KQ.KETQUA_ID=MAT.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_PHUKHOA PK ON KQ.KETQUA_ID=PK.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_RHM RHM ON KQ.KETQUA_ID=RHM.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_TMH TMH ON KQ.KETQUA_ID=TMH.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_DALIEU DL ON KQ.KETQUA_ID=DL.KETQUA_ID        LEFT JOIN TT_NGOAITRU_KHAMBENH_SINHHIEU SH ON KQ.TIEPNHAN_ID = SH.TIEPNHAN_ID        where (DL.HOPDONG_BENHNHAN_ID  = 203 and DL.BENHVIEN_ID = 'HLU01')        OR (KQ.HOPDONG_BENHNHAN_ID  = 203 and KQ.BENHVIEN_ID = 'HLU01')        OR (N.HOPDONG_BENHNHAN_ID  = 203 and N.BENHVIEN_ID = 'HLU01')        OR (NG.HOPDONG_BENHNHAN_ID  = 203 and NG.BENHVIEN_ID = 'HLU01')        OR (RHM.HOPDONG_BENHNHAN_ID  = 203 and RHM.BENHVIEN_ID = 'HLU01')        OR (MAT.HOPDONG_BENHNHAN_ID  = 203 and MAT.BENHVIEN_ID = 'HLU01')        OR (PK.HOPDONG_BENHNHAN_ID  = 203 and PK.BENHVIEN_ID = 'HLU01')        OR (TMH.HOPDONG_BENHNHAN_ID  = 203 and TMH.BENHVIEN_ID = 'HLU01')]
2019-08-26 15:39:49,375 [1] DEBUG - Statement Id: [DAO00328_GetPatientId] PreparedStatement : [select BN.*, KQ.KETQUA_ID        from TT_KSK_HOPDONG_BENHNHAN BN        left join TT_KSK_KETQUA KQ on KQ.HOPDONG_BENHNHAN_ID = BN.HOPDONG_BENHNHAN_ID         where                 BN.BENHNHAN_ID = 23420             and               BN.BENHVIEN_ID = 'HLU01']
2019-08-26 15:39:49,476 [1] DEBUG - Statement Id: [DAO00329_Insert_Data] PreparedStatement : [DECLARE @CHECK int        IF (SELECT COUNT(*) FROM TT_KSK_KETQUA WHERE HOPDONG_ID=3 AND HOPDONG_BENHNHAN_ID=203) = 0        BEGIN        INSERT INTO TT_KSK_KETQUA (TIEPNHAN_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values( @param0 , @param1 , @param2 , @param3 );        SET @CHECK = (SELECT SCOPE_IDENTITY())        INSERT INTO TT_KSK_KETQUA_NOI(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_NGOAI(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_DALIEU(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_PHUKHOA(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_RHM(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_TMH(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        INSERT INTO TT_KSK_KETQUA_MAT(KETQUA_ID,HOPDONG_ID,HOPDONG_BENHNHAN_ID,BENHVIEN_ID) values(@CHECK, @param1 , @param2 , @param3 );        END        ELSE        BEGIN        RETURN        END;]
2019-08-26 15:39:49,476 [1] DEBUG - Statement Id: [DAO00329_Insert_Data] Parameters: [@param0=[TIEPNHAN_ID,27475], @param1=[HOPDONG_ID,3], @param2=[HOPDONG_BENHNHAN_ID,203], @param3=[BENHVIEN_ID,HLU01]]
2019-08-26 15:39:49,476 [1] DEBUG - Statement Id: [DAO00329_Insert_Data] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64], @param2=[Int64, System.Int64], @param3=[String, System.String]]
2019-08-26 15:39:49,506 [1] DEBUG - Statement Id: [DAO00309_GhiChu] PreparedStatement : [select GHICHU from TT_KSK_HOPDONG_BENHNHAN where HOPDONG_BENHNHAN_ID = 203]
2019-08-26 15:39:49,556 [1] DEBUG - Statement Id: [DAO00328_GetKetQuaKSK] PreparedStatement : [SELECT KQ.KETQUA_ID,KQ.TIEPNHAN_ID,KQ.HOPDONG_ID,KQ.HOPDONG_BENHNHAN_ID,SH.MACH,SH.CANNANG,SH.CHIEUCAO,SH.HUYETAPCAO,SH.HUYETAPTHAP,SH.NHIPTHO,SH.NHIETDO,SH.CHISOBMI AS BMI        ,N.TUANHOAN,N.PLTUANHOAN_ID,N.HOHAP,n.PLHOHAP_ID,N.TIEUHOA,N.PLTIEUHOA_ID,N.THAN,N.PLTHAN_ID,N.NOITIET,N.PLNOITIET_ID        ,N.COXUONGKHOP,N.PLCOXUONGKHOP_ID,N.THANKINH,N.PLTHANKINH_ID,N.TAMTHAN,N.PLTAMTHAN_ID,N.BACSIKHAMNOI_ID,NG.NGOAIKHOA        ,NG.PLNGOAIKHOA_ID,NG.BACSINGOAIKHOA_ID,PK.SANPHUKHOA,PK.PLSANPHUKHOA_ID,PK.BACSISANPHUKHOA_ID,MAT.COKINHMATTRAI        ,MAT.COKINHMATPHAI,MAT.KHONGKINHMATTRAI,MAT.KHONGKINHMATPHAI,MAT.CACBENHVEMAT,MAT.PLMAT_ID,MAT.BACSIMAT_ID        ,TMH.TAITRAINOITHUONG,TMH.TAITRAINOITHAM,TMH.TAIPHAINOITHUONG,TMH.TAIPHAINOITHAM,TMH.CACBENHVETAI,TMH.PLTAIMH_ID,TMH.BACSITMH_ID        ,RHM.HAMTREN,RHM.HAMDUOI,RHM.CACBENHVERHM,RHM.PLRHM_ID,RHM.BACSIRHM_ID,DL.DALIEU,DL.PLDALIEU_ID,DL.BACSIDALIEU_ID        ,KQ.BACSIKETLUAN_ID,KQ.NHANXET,KQ.XEPLOAI_ID,KQ.TENICD        FROM TT_KSK_KETQUA KQ        LEFT JOIN TT_KSK_KETQUA_NOI N ON KQ.KETQUA_ID = N.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_NGOAI NG ON KQ.KETQUA_ID=NG.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_MAT MAT ON KQ.KETQUA_ID=MAT.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_PHUKHOA PK ON KQ.KETQUA_ID=PK.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_RHM RHM ON KQ.KETQUA_ID=RHM.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_TMH TMH ON KQ.KETQUA_ID=TMH.KETQUA_ID        LEFT JOIN TT_KSK_KETQUA_DALIEU DL ON KQ.KETQUA_ID=DL.KETQUA_ID        LEFT JOIN TT_NGOAITRU_KHAMBENH_SINHHIEU SH ON KQ.TIEPNHAN_ID = SH.TIEPNHAN_ID        where (DL.HOPDONG_BENHNHAN_ID  = 203 and DL.BENHVIEN_ID = 'HLU01')        OR (KQ.HOPDONG_BENHNHAN_ID  = 203 and KQ.BENHVIEN_ID = 'HLU01')        OR (N.HOPDONG_BENHNHAN_ID  = 203 and N.BENHVIEN_ID = 'HLU01')        OR (NG.HOPDONG_BENHNHAN_ID  = 203 and NG.BENHVIEN_ID = 'HLU01')        OR (RHM.HOPDONG_BENHNHAN_ID  = 203 and RHM.BENHVIEN_ID = 'HLU01')        OR (MAT.HOPDONG_BENHNHAN_ID  = 203 and MAT.BENHVIEN_ID = 'HLU01')        OR (PK.HOPDONG_BENHNHAN_ID  = 203 and PK.BENHVIEN_ID = 'HLU01')        OR (TMH.HOPDONG_BENHNHAN_ID  = 203 and TMH.BENHVIEN_ID = 'HLU01')]
