--------------------------------------------------------------------------------
2019-12-10 10:18:03,017 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2019-12-10 10:18:03,861 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-12-10 10:18:03,911 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-12-10 10:18:05,915 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 10:18:07,195 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-12-10 10:18:23,757 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2019-12-10 10:18:23,869 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-12-10 10:18:38,731 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-12-10 10:18:38,997 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-12-10 10:18:41,104 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2019-12-10 10:18:43,497 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2019-12-10 10:18:44,081 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2019-12-10 10:18:44,572 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2019-12-10 10:18:45,048 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2019-12-10 10:18:45,601 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2019-12-10 10:18:46,113 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2019-12-10 10:18:46,866 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2019-12-10 10:18:47,210 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2019-12-10 10:18:48,238 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2019-12-10 10:18:48,322 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2019-12-10 10:18:48,425 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2019-12-10 10:18:48,474 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2019-12-10 10:18:50,332 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2019-12-10 10:18:50,374 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @NGUONDUOC_MACDINH varchar(5) = '0';        declare @TOAMUANGOAI int = 0;        select @NGUONDUOC_MACDINH = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'PHA_NGUONDUOC'        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + @NGUONDUOC_MACDINH as DUOC_KEY, 0 as PHAMVI_ID, @NGUONDUOC_MACDINH as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end        else        begin                  select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2019-12-10 10:18:55,734 [5] DEBUG - Statement Id: [DAO00320_GetList] PreparedStatement : [select M.*            from TM_MAU M            LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID            where            M.TAMNGUNG = '0'            and M.BENHVIEN_ID = 'HLU01'            order by M.TENMAU]
2019-12-10 10:18:56,215 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2019-12-10 10:18:56,427 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,        SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH        FROM TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID        WHERE TK.SOLUONG > 0        GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2019-12-10 10:18:56,850 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2019-12-10 10:18:56,979 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,        TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,        TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH        from TM_MAU M        JOIN        (        select        A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO        from        (        select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO        from TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'        where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0        ) A        )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2019-12-10 10:18:57,889 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2019-12-10 10:19:00,272 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 10:19:07,896 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2019-12-10 10:19:46,395 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2019-12-10 10:19:46,495 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2019-12-10 10:19:46,720 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 10:19:47,130 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 10:19:49,209 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2019-12-10 10:19:49,243 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-12-10 10:19:49,243 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-12-10 10:19:49,293 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2019-12-10 10:19:49,294 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-12-10 10:19:49,294 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-12-10 10:19:50,195 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 10:19:51,281 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 10:22:37,332 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 10:22:37,684 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2019-12-10 10:22:38,780 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2019-12-10 10:28:24,463 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'HSM05'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 10:28:30,482 [1] DEBUG - Statement Id: [DAO00307_GetContractWithDate] PreparedStatement : [SELECT HD.*, HD.SO_HD + ' - ' + CT.TENCONGTY AS HOPDONG, CT.TENCONGTY        FROM TT_KSK_HOPDONG HD JOIN TT_KSK_CONGTY CT ON CT.CONGTY_ID = HD.CONGTY_ID         where                 HD.BENHVIEN_ID = 'HLU01']
2019-12-10 10:28:33,136 [1] DEBUG - Statement Id: [DAO00307_GetContractWithDate] PreparedStatement : [SELECT HD.*, HD.SO_HD + ' - ' + CT.TENCONGTY AS HOPDONG, CT.TENCONGTY        FROM TT_KSK_HOPDONG HD JOIN TT_KSK_CONGTY CT ON CT.CONGTY_ID = HD.CONGTY_ID         where                 HD.BENHVIEN_ID = 'HLU01']
2019-12-10 10:28:46,278 [1] DEBUG - Statement Id: [DAO00307_GetContractPatient] PreparedStatement : [SELECT HD_BN.*, LST.DICTIONARY_NAME AS HONNHAN        , CASE WHEN HD_BN.GIOITINH = '1' THEN N'Nam' ELSE N'Nữ' END AS GENDER        , CASE WHEN HD_BN.HOPDONG_BENHNHAN_ID IN (SELECT HOPDONG_BENHNHAN_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU) THEN 1 ELSE 0 END BENHNHAN_DANGKYKSK_DICHVU        , GOI.TENGOI        FROM TT_KSK_HOPDONG_BENHNHAN HD_BN        INNER JOIN TT_KSK_HOPDONG HD ON HD.HOPDONG_ID = HD_BN.HOPDONG_ID        LEFT JOIN LST_DICTIONARY LST ON LST.DICTIONARY_ID = HD_BN.TINHTRANGHONNHAN_ID AND LST.DICTIONARY_TYPE_CODE = 'TinhTrangGiaDinh'        LEFT JOIN TM_CSKH_GOI GOI ON GOI.GOI_ID = HD_BN.GOI_ID        WHERE HD.HOPDONG_ID = 3           AND               HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:28:46,709 [1] DEBUG - Statement Id: [DAO00308_StatusContract] PreparedStatement : [SELECT * FROM TT_KSK_HOPDONG        WHERE HOPDONG_ID = 3]
2019-12-10 10:28:51,121 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhanDichVu] PreparedStatement : [SELECT distinct HD_BN.HOPDONG_ID, DV.TENDICHVU, PB.TENPHONGBAN AS NOITHUCHIEN, NDV.TENNHOMDICHVU, PB.PHONGBAN_ID, DV.DICHVU_ID        , ISNULL(GOI_CT.DONGIATRONGGOI,0) AS DONGIA, ISNULL(GOI_CT.SOLAN,0) AS SOLUONG, GOI_CT.THANHTIENTRONGGOI AS THANHTIEN        , CASE WHEN DV.DICHVU_ID IN (SELECT DICHVU_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU WHERE HOPDONG_ID = '3' AND HOPDONG_BENHNHAN_ID = '203') THEN 1 ELSE 0 END AS DANGKY        FROM TT_KSK_HOPDONG HD                inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        INNER JOIN TM_CSKH_GOI_CHITIET GOI_CT ON GOI_CT.GOI_ID = HD_BN.GOI_ID        INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = GOI_CT.DICHVU_ID        LEFT JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        INNER JOIN TM_PHONGBAN_DICHVU PB_DV ON PB_DV.DICHVU_ID = DV.DICHVU_ID        LEFT JOIN TM_PHONGBAN PB ON PB.PHONGBAN_ID = PB_DV.PHONGBAN_ID        WHERE GOI_CT.GOI_ID = 3 and HD_BN.HOPDONG_BENHNHAN_ID = 203        and PB_DV.PHONGBAN_ID =(select top 1 PHONGBAN_ID from TM_PHONGBAN_DICHVU where DICHVU_ID = DV.DICHVU_ID)]
2019-12-10 10:28:54,123 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhanDichVu] PreparedStatement : [SELECT distinct HD_BN.HOPDONG_ID, DV.TENDICHVU, PB.TENPHONGBAN AS NOITHUCHIEN, NDV.TENNHOMDICHVU, PB.PHONGBAN_ID, DV.DICHVU_ID        , ISNULL(GOI_CT.DONGIATRONGGOI,0) AS DONGIA, ISNULL(GOI_CT.SOLAN,0) AS SOLUONG, GOI_CT.THANHTIENTRONGGOI AS THANHTIEN        , CASE WHEN DV.DICHVU_ID IN (SELECT DICHVU_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU WHERE HOPDONG_ID = '3' AND HOPDONG_BENHNHAN_ID = '204') THEN 1 ELSE 0 END AS DANGKY        FROM TT_KSK_HOPDONG HD                inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        INNER JOIN TM_CSKH_GOI_CHITIET GOI_CT ON GOI_CT.GOI_ID = HD_BN.GOI_ID        INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = GOI_CT.DICHVU_ID        LEFT JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        INNER JOIN TM_PHONGBAN_DICHVU PB_DV ON PB_DV.DICHVU_ID = DV.DICHVU_ID        LEFT JOIN TM_PHONGBAN PB ON PB.PHONGBAN_ID = PB_DV.PHONGBAN_ID        WHERE GOI_CT.GOI_ID = 3 and HD_BN.HOPDONG_BENHNHAN_ID = 204        and PB_DV.PHONGBAN_ID =(select top 1 PHONGBAN_ID from TM_PHONGBAN_DICHVU where DICHVU_ID = DV.DICHVU_ID)]
2019-12-10 10:29:05,998 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhanDichVu] PreparedStatement : [SELECT distinct HD_BN.HOPDONG_ID, DV.TENDICHVU, PB.TENPHONGBAN AS NOITHUCHIEN, NDV.TENNHOMDICHVU, PB.PHONGBAN_ID, DV.DICHVU_ID        , ISNULL(GOI_CT.DONGIATRONGGOI,0) AS DONGIA, ISNULL(GOI_CT.SOLAN,0) AS SOLUONG, GOI_CT.THANHTIENTRONGGOI AS THANHTIEN        , CASE WHEN DV.DICHVU_ID IN (SELECT DICHVU_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU WHERE HOPDONG_ID = '3' AND HOPDONG_BENHNHAN_ID = '203') THEN 1 ELSE 0 END AS DANGKY        FROM TT_KSK_HOPDONG HD                inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        INNER JOIN TM_CSKH_GOI_CHITIET GOI_CT ON GOI_CT.GOI_ID = HD_BN.GOI_ID        INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = GOI_CT.DICHVU_ID        LEFT JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        INNER JOIN TM_PHONGBAN_DICHVU PB_DV ON PB_DV.DICHVU_ID = DV.DICHVU_ID        LEFT JOIN TM_PHONGBAN PB ON PB.PHONGBAN_ID = PB_DV.PHONGBAN_ID        WHERE GOI_CT.GOI_ID = 3 and HD_BN.HOPDONG_BENHNHAN_ID = 203        and PB_DV.PHONGBAN_ID =(select top 1 PHONGBAN_ID from TM_PHONGBAN_DICHVU where DICHVU_ID = DV.DICHVU_ID)]
2019-12-10 10:35:12,650 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhanDichVu] PreparedStatement : [SELECT distinct HD_BN.HOPDONG_ID, DV.TENDICHVU, PB.TENPHONGBAN AS NOITHUCHIEN, NDV.TENNHOMDICHVU, PB.PHONGBAN_ID, DV.DICHVU_ID        , ISNULL(GOI_CT.DONGIATRONGGOI,0) AS DONGIA, ISNULL(GOI_CT.SOLAN,0) AS SOLUONG, GOI_CT.THANHTIENTRONGGOI AS THANHTIEN        , CASE WHEN DV.DICHVU_ID IN (SELECT DICHVU_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU WHERE HOPDONG_ID = '3' AND HOPDONG_BENHNHAN_ID = '204') THEN 1 ELSE 0 END AS DANGKY        FROM TT_KSK_HOPDONG HD                inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        INNER JOIN TM_CSKH_GOI_CHITIET GOI_CT ON GOI_CT.GOI_ID = HD_BN.GOI_ID        INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = GOI_CT.DICHVU_ID        LEFT JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        INNER JOIN TM_PHONGBAN_DICHVU PB_DV ON PB_DV.DICHVU_ID = DV.DICHVU_ID        LEFT JOIN TM_PHONGBAN PB ON PB.PHONGBAN_ID = PB_DV.PHONGBAN_ID        WHERE GOI_CT.GOI_ID = 3 and HD_BN.HOPDONG_BENHNHAN_ID = 204        and PB_DV.PHONGBAN_ID =(select top 1 PHONGBAN_ID from TM_PHONGBAN_DICHVU where DICHVU_ID = DV.DICHVU_ID)]
2019-12-10 10:35:15,460 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhanDichVu] PreparedStatement : [SELECT distinct HD_BN.HOPDONG_ID, DV.TENDICHVU, PB.TENPHONGBAN AS NOITHUCHIEN, NDV.TENNHOMDICHVU, PB.PHONGBAN_ID, DV.DICHVU_ID        , ISNULL(GOI_CT.DONGIATRONGGOI,0) AS DONGIA, ISNULL(GOI_CT.SOLAN,0) AS SOLUONG, GOI_CT.THANHTIENTRONGGOI AS THANHTIEN        , CASE WHEN DV.DICHVU_ID IN (SELECT DICHVU_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU WHERE HOPDONG_ID = '3' AND HOPDONG_BENHNHAN_ID = '203') THEN 1 ELSE 0 END AS DANGKY        FROM TT_KSK_HOPDONG HD                inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        INNER JOIN TM_CSKH_GOI_CHITIET GOI_CT ON GOI_CT.GOI_ID = HD_BN.GOI_ID        INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = GOI_CT.DICHVU_ID        LEFT JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        INNER JOIN TM_PHONGBAN_DICHVU PB_DV ON PB_DV.DICHVU_ID = DV.DICHVU_ID        LEFT JOIN TM_PHONGBAN PB ON PB.PHONGBAN_ID = PB_DV.PHONGBAN_ID        WHERE GOI_CT.GOI_ID = 3 and HD_BN.HOPDONG_BENHNHAN_ID = 203        and PB_DV.PHONGBAN_ID =(select top 1 PHONGBAN_ID from TM_PHONGBAN_DICHVU where DICHVU_ID = DV.DICHVU_ID)]
2019-12-10 10:35:17,137 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhanDichVu] PreparedStatement : [SELECT distinct HD_BN.HOPDONG_ID, DV.TENDICHVU, PB.TENPHONGBAN AS NOITHUCHIEN, NDV.TENNHOMDICHVU, PB.PHONGBAN_ID, DV.DICHVU_ID        , ISNULL(GOI_CT.DONGIATRONGGOI,0) AS DONGIA, ISNULL(GOI_CT.SOLAN,0) AS SOLUONG, GOI_CT.THANHTIENTRONGGOI AS THANHTIEN        , CASE WHEN DV.DICHVU_ID IN (SELECT DICHVU_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU WHERE HOPDONG_ID = '3' AND HOPDONG_BENHNHAN_ID = '210') THEN 1 ELSE 0 END AS DANGKY        FROM TT_KSK_HOPDONG HD                inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        INNER JOIN TM_CSKH_GOI_CHITIET GOI_CT ON GOI_CT.GOI_ID = HD_BN.GOI_ID        INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = GOI_CT.DICHVU_ID        LEFT JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        INNER JOIN TM_PHONGBAN_DICHVU PB_DV ON PB_DV.DICHVU_ID = DV.DICHVU_ID        LEFT JOIN TM_PHONGBAN PB ON PB.PHONGBAN_ID = PB_DV.PHONGBAN_ID        WHERE GOI_CT.GOI_ID = 4 and HD_BN.HOPDONG_BENHNHAN_ID = 210        and PB_DV.PHONGBAN_ID =(select top 1 PHONGBAN_ID from TM_PHONGBAN_DICHVU where DICHVU_ID = DV.DICHVU_ID)]
2019-12-10 10:35:22,522 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhanDichVu] PreparedStatement : [SELECT distinct HD_BN.HOPDONG_ID, DV.TENDICHVU, PB.TENPHONGBAN AS NOITHUCHIEN, NDV.TENNHOMDICHVU, PB.PHONGBAN_ID, DV.DICHVU_ID        , ISNULL(GOI_CT.DONGIATRONGGOI,0) AS DONGIA, ISNULL(GOI_CT.SOLAN,0) AS SOLUONG, GOI_CT.THANHTIENTRONGGOI AS THANHTIEN        , CASE WHEN DV.DICHVU_ID IN (SELECT DICHVU_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU WHERE HOPDONG_ID = '3' AND HOPDONG_BENHNHAN_ID = '203') THEN 1 ELSE 0 END AS DANGKY        FROM TT_KSK_HOPDONG HD                inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        INNER JOIN TM_CSKH_GOI_CHITIET GOI_CT ON GOI_CT.GOI_ID = HD_BN.GOI_ID        INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = GOI_CT.DICHVU_ID        LEFT JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        INNER JOIN TM_PHONGBAN_DICHVU PB_DV ON PB_DV.DICHVU_ID = DV.DICHVU_ID        LEFT JOIN TM_PHONGBAN PB ON PB.PHONGBAN_ID = PB_DV.PHONGBAN_ID        WHERE GOI_CT.GOI_ID = 3 and HD_BN.HOPDONG_BENHNHAN_ID = 203        and PB_DV.PHONGBAN_ID =(select top 1 PHONGBAN_ID from TM_PHONGBAN_DICHVU where DICHVU_ID = DV.DICHVU_ID)]
2019-12-10 10:35:23,595 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhanDichVu] PreparedStatement : [SELECT distinct HD_BN.HOPDONG_ID, DV.TENDICHVU, PB.TENPHONGBAN AS NOITHUCHIEN, NDV.TENNHOMDICHVU, PB.PHONGBAN_ID, DV.DICHVU_ID        , ISNULL(GOI_CT.DONGIATRONGGOI,0) AS DONGIA, ISNULL(GOI_CT.SOLAN,0) AS SOLUONG, GOI_CT.THANHTIENTRONGGOI AS THANHTIEN        , CASE WHEN DV.DICHVU_ID IN (SELECT DICHVU_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU WHERE HOPDONG_ID = '3' AND HOPDONG_BENHNHAN_ID = '210') THEN 1 ELSE 0 END AS DANGKY        FROM TT_KSK_HOPDONG HD                inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        INNER JOIN TM_CSKH_GOI_CHITIET GOI_CT ON GOI_CT.GOI_ID = HD_BN.GOI_ID        INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = GOI_CT.DICHVU_ID        LEFT JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        INNER JOIN TM_PHONGBAN_DICHVU PB_DV ON PB_DV.DICHVU_ID = DV.DICHVU_ID        LEFT JOIN TM_PHONGBAN PB ON PB.PHONGBAN_ID = PB_DV.PHONGBAN_ID        WHERE GOI_CT.GOI_ID = 4 and HD_BN.HOPDONG_BENHNHAN_ID = 210        and PB_DV.PHONGBAN_ID =(select top 1 PHONGBAN_ID from TM_PHONGBAN_DICHVU where DICHVU_ID = DV.DICHVU_ID)]
2019-12-10 10:35:28,927 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhanDichVu] PreparedStatement : [SELECT distinct HD_BN.HOPDONG_ID, DV.TENDICHVU, PB.TENPHONGBAN AS NOITHUCHIEN, NDV.TENNHOMDICHVU, PB.PHONGBAN_ID, DV.DICHVU_ID        , ISNULL(GOI_CT.DONGIATRONGGOI,0) AS DONGIA, ISNULL(GOI_CT.SOLAN,0) AS SOLUONG, GOI_CT.THANHTIENTRONGGOI AS THANHTIEN        , CASE WHEN DV.DICHVU_ID IN (SELECT DICHVU_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU WHERE HOPDONG_ID = '3' AND HOPDONG_BENHNHAN_ID = '211') THEN 1 ELSE 0 END AS DANGKY        FROM TT_KSK_HOPDONG HD                inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        INNER JOIN TM_CSKH_GOI_CHITIET GOI_CT ON GOI_CT.GOI_ID = HD_BN.GOI_ID        INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = GOI_CT.DICHVU_ID        LEFT JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        INNER JOIN TM_PHONGBAN_DICHVU PB_DV ON PB_DV.DICHVU_ID = DV.DICHVU_ID        LEFT JOIN TM_PHONGBAN PB ON PB.PHONGBAN_ID = PB_DV.PHONGBAN_ID        WHERE GOI_CT.GOI_ID = 4 and HD_BN.HOPDONG_BENHNHAN_ID = 211        and PB_DV.PHONGBAN_ID =(select top 1 PHONGBAN_ID from TM_PHONGBAN_DICHVU where DICHVU_ID = DV.DICHVU_ID)]
2019-12-10 10:35:29,858 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhanDichVu] PreparedStatement : [SELECT distinct HD_BN.HOPDONG_ID, DV.TENDICHVU, PB.TENPHONGBAN AS NOITHUCHIEN, NDV.TENNHOMDICHVU, PB.PHONGBAN_ID, DV.DICHVU_ID        , ISNULL(GOI_CT.DONGIATRONGGOI,0) AS DONGIA, ISNULL(GOI_CT.SOLAN,0) AS SOLUONG, GOI_CT.THANHTIENTRONGGOI AS THANHTIEN        , CASE WHEN DV.DICHVU_ID IN (SELECT DICHVU_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU WHERE HOPDONG_ID = '3' AND HOPDONG_BENHNHAN_ID = '212') THEN 1 ELSE 0 END AS DANGKY        FROM TT_KSK_HOPDONG HD                inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        INNER JOIN TM_CSKH_GOI_CHITIET GOI_CT ON GOI_CT.GOI_ID = HD_BN.GOI_ID        INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = GOI_CT.DICHVU_ID        LEFT JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        INNER JOIN TM_PHONGBAN_DICHVU PB_DV ON PB_DV.DICHVU_ID = DV.DICHVU_ID        LEFT JOIN TM_PHONGBAN PB ON PB.PHONGBAN_ID = PB_DV.PHONGBAN_ID        WHERE GOI_CT.GOI_ID = 4 and HD_BN.HOPDONG_BENHNHAN_ID = 212        and PB_DV.PHONGBAN_ID =(select top 1 PHONGBAN_ID from TM_PHONGBAN_DICHVU where DICHVU_ID = DV.DICHVU_ID)]
2019-12-10 10:35:30,649 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhanDichVu] PreparedStatement : [SELECT distinct HD_BN.HOPDONG_ID, DV.TENDICHVU, PB.TENPHONGBAN AS NOITHUCHIEN, NDV.TENNHOMDICHVU, PB.PHONGBAN_ID, DV.DICHVU_ID        , ISNULL(GOI_CT.DONGIATRONGGOI,0) AS DONGIA, ISNULL(GOI_CT.SOLAN,0) AS SOLUONG, GOI_CT.THANHTIENTRONGGOI AS THANHTIEN        , CASE WHEN DV.DICHVU_ID IN (SELECT DICHVU_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU WHERE HOPDONG_ID = '3' AND HOPDONG_BENHNHAN_ID = '213') THEN 1 ELSE 0 END AS DANGKY        FROM TT_KSK_HOPDONG HD                inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        INNER JOIN TM_CSKH_GOI_CHITIET GOI_CT ON GOI_CT.GOI_ID = HD_BN.GOI_ID        INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = GOI_CT.DICHVU_ID        LEFT JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        INNER JOIN TM_PHONGBAN_DICHVU PB_DV ON PB_DV.DICHVU_ID = DV.DICHVU_ID        LEFT JOIN TM_PHONGBAN PB ON PB.PHONGBAN_ID = PB_DV.PHONGBAN_ID        WHERE GOI_CT.GOI_ID = 4 and HD_BN.HOPDONG_BENHNHAN_ID = 213        and PB_DV.PHONGBAN_ID =(select top 1 PHONGBAN_ID from TM_PHONGBAN_DICHVU where DICHVU_ID = DV.DICHVU_ID)]
2019-12-10 10:35:31,367 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhanDichVu] PreparedStatement : [SELECT distinct HD_BN.HOPDONG_ID, DV.TENDICHVU, PB.TENPHONGBAN AS NOITHUCHIEN, NDV.TENNHOMDICHVU, PB.PHONGBAN_ID, DV.DICHVU_ID        , ISNULL(GOI_CT.DONGIATRONGGOI,0) AS DONGIA, ISNULL(GOI_CT.SOLAN,0) AS SOLUONG, GOI_CT.THANHTIENTRONGGOI AS THANHTIEN        , CASE WHEN DV.DICHVU_ID IN (SELECT DICHVU_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU WHERE HOPDONG_ID = '3' AND HOPDONG_BENHNHAN_ID = '214') THEN 1 ELSE 0 END AS DANGKY        FROM TT_KSK_HOPDONG HD                inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        INNER JOIN TM_CSKH_GOI_CHITIET GOI_CT ON GOI_CT.GOI_ID = HD_BN.GOI_ID        INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = GOI_CT.DICHVU_ID        LEFT JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        INNER JOIN TM_PHONGBAN_DICHVU PB_DV ON PB_DV.DICHVU_ID = DV.DICHVU_ID        LEFT JOIN TM_PHONGBAN PB ON PB.PHONGBAN_ID = PB_DV.PHONGBAN_ID        WHERE GOI_CT.GOI_ID = 4 and HD_BN.HOPDONG_BENHNHAN_ID = 214        and PB_DV.PHONGBAN_ID =(select top 1 PHONGBAN_ID from TM_PHONGBAN_DICHVU where DICHVU_ID = DV.DICHVU_ID)]
2019-12-10 10:35:32,113 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhanDichVu] PreparedStatement : [SELECT distinct HD_BN.HOPDONG_ID, DV.TENDICHVU, PB.TENPHONGBAN AS NOITHUCHIEN, NDV.TENNHOMDICHVU, PB.PHONGBAN_ID, DV.DICHVU_ID        , ISNULL(GOI_CT.DONGIATRONGGOI,0) AS DONGIA, ISNULL(GOI_CT.SOLAN,0) AS SOLUONG, GOI_CT.THANHTIENTRONGGOI AS THANHTIEN        , CASE WHEN DV.DICHVU_ID IN (SELECT DICHVU_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU WHERE HOPDONG_ID = '3' AND HOPDONG_BENHNHAN_ID = '215') THEN 1 ELSE 0 END AS DANGKY        FROM TT_KSK_HOPDONG HD                inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        INNER JOIN TM_CSKH_GOI_CHITIET GOI_CT ON GOI_CT.GOI_ID = HD_BN.GOI_ID        INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = GOI_CT.DICHVU_ID        LEFT JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        INNER JOIN TM_PHONGBAN_DICHVU PB_DV ON PB_DV.DICHVU_ID = DV.DICHVU_ID        LEFT JOIN TM_PHONGBAN PB ON PB.PHONGBAN_ID = PB_DV.PHONGBAN_ID        WHERE GOI_CT.GOI_ID = 4 and HD_BN.HOPDONG_BENHNHAN_ID = 215        and PB_DV.PHONGBAN_ID =(select top 1 PHONGBAN_ID from TM_PHONGBAN_DICHVU where DICHVU_ID = DV.DICHVU_ID)]
2019-12-10 10:35:34,674 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhanDichVu] PreparedStatement : [SELECT distinct HD_BN.HOPDONG_ID, DV.TENDICHVU, PB.TENPHONGBAN AS NOITHUCHIEN, NDV.TENNHOMDICHVU, PB.PHONGBAN_ID, DV.DICHVU_ID        , ISNULL(GOI_CT.DONGIATRONGGOI,0) AS DONGIA, ISNULL(GOI_CT.SOLAN,0) AS SOLUONG, GOI_CT.THANHTIENTRONGGOI AS THANHTIEN        , CASE WHEN DV.DICHVU_ID IN (SELECT DICHVU_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU WHERE HOPDONG_ID = '3' AND HOPDONG_BENHNHAN_ID = '213') THEN 1 ELSE 0 END AS DANGKY        FROM TT_KSK_HOPDONG HD                inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        INNER JOIN TM_CSKH_GOI_CHITIET GOI_CT ON GOI_CT.GOI_ID = HD_BN.GOI_ID        INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = GOI_CT.DICHVU_ID        LEFT JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        INNER JOIN TM_PHONGBAN_DICHVU PB_DV ON PB_DV.DICHVU_ID = DV.DICHVU_ID        LEFT JOIN TM_PHONGBAN PB ON PB.PHONGBAN_ID = PB_DV.PHONGBAN_ID        WHERE GOI_CT.GOI_ID = 4 and HD_BN.HOPDONG_BENHNHAN_ID = 213        and PB_DV.PHONGBAN_ID =(select top 1 PHONGBAN_ID from TM_PHONGBAN_DICHVU where DICHVU_ID = DV.DICHVU_ID)]
2019-12-10 10:35:45,089 [1] DEBUG - Statement Id: [DAO00307_GetContractPatient] PreparedStatement : [SELECT HD_BN.*, LST.DICTIONARY_NAME AS HONNHAN        , CASE WHEN HD_BN.GIOITINH = '1' THEN N'Nam' ELSE N'Nữ' END AS GENDER        , CASE WHEN HD_BN.HOPDONG_BENHNHAN_ID IN (SELECT HOPDONG_BENHNHAN_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU) THEN 1 ELSE 0 END BENHNHAN_DANGKYKSK_DICHVU        , GOI.TENGOI        FROM TT_KSK_HOPDONG_BENHNHAN HD_BN        INNER JOIN TT_KSK_HOPDONG HD ON HD.HOPDONG_ID = HD_BN.HOPDONG_ID        LEFT JOIN LST_DICTIONARY LST ON LST.DICTIONARY_ID = HD_BN.TINHTRANGHONNHAN_ID AND LST.DICTIONARY_TYPE_CODE = 'TinhTrangGiaDinh'        LEFT JOIN TM_CSKH_GOI GOI ON GOI.GOI_ID = HD_BN.GOI_ID        WHERE HD.HOPDONG_ID = 3           AND               HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:35:45,453 [1] DEBUG - Statement Id: [DAO00308_StatusContract] PreparedStatement : [SELECT * FROM TT_KSK_HOPDONG        WHERE HOPDONG_ID = 3]
2019-12-10 10:35:49,518 [1] DEBUG - Statement Id: [DAO00307_GetContractPatient] PreparedStatement : [SELECT HD_BN.*, LST.DICTIONARY_NAME AS HONNHAN        , CASE WHEN HD_BN.GIOITINH = '1' THEN N'Nam' ELSE N'Nữ' END AS GENDER        , CASE WHEN HD_BN.HOPDONG_BENHNHAN_ID IN (SELECT HOPDONG_BENHNHAN_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU) THEN 1 ELSE 0 END BENHNHAN_DANGKYKSK_DICHVU        , GOI.TENGOI        FROM TT_KSK_HOPDONG_BENHNHAN HD_BN        INNER JOIN TT_KSK_HOPDONG HD ON HD.HOPDONG_ID = HD_BN.HOPDONG_ID        LEFT JOIN LST_DICTIONARY LST ON LST.DICTIONARY_ID = HD_BN.TINHTRANGHONNHAN_ID AND LST.DICTIONARY_TYPE_CODE = 'TinhTrangGiaDinh'        LEFT JOIN TM_CSKH_GOI GOI ON GOI.GOI_ID = HD_BN.GOI_ID        WHERE HD.HOPDONG_ID = 1           AND               HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:35:49,620 [1] DEBUG - Statement Id: [DAO00308_StatusContract] PreparedStatement : [SELECT * FROM TT_KSK_HOPDONG        WHERE HOPDONG_ID = 1]
2019-12-10 10:35:50,588 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhanDichVu] PreparedStatement : [SELECT distinct HD_BN.HOPDONG_ID, DV.TENDICHVU, PB.TENPHONGBAN AS NOITHUCHIEN, NDV.TENNHOMDICHVU, PB.PHONGBAN_ID, DV.DICHVU_ID        , ISNULL(GOI_CT.DONGIATRONGGOI,0) AS DONGIA, ISNULL(GOI_CT.SOLAN,0) AS SOLUONG, GOI_CT.THANHTIENTRONGGOI AS THANHTIEN        , CASE WHEN DV.DICHVU_ID IN (SELECT DICHVU_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU WHERE HOPDONG_ID = '1' AND HOPDONG_BENHNHAN_ID = '102') THEN 1 ELSE 0 END AS DANGKY        FROM TT_KSK_HOPDONG HD                inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        INNER JOIN TM_CSKH_GOI_CHITIET GOI_CT ON GOI_CT.GOI_ID = HD_BN.GOI_ID        INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = GOI_CT.DICHVU_ID        LEFT JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        INNER JOIN TM_PHONGBAN_DICHVU PB_DV ON PB_DV.DICHVU_ID = DV.DICHVU_ID        LEFT JOIN TM_PHONGBAN PB ON PB.PHONGBAN_ID = PB_DV.PHONGBAN_ID        WHERE GOI_CT.GOI_ID = 4 and HD_BN.HOPDONG_BENHNHAN_ID = 102        and PB_DV.PHONGBAN_ID =(select top 1 PHONGBAN_ID from TM_PHONGBAN_DICHVU where DICHVU_ID = DV.DICHVU_ID)]
2019-12-10 10:35:51,273 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhanDichVu] PreparedStatement : [SELECT distinct HD_BN.HOPDONG_ID, DV.TENDICHVU, PB.TENPHONGBAN AS NOITHUCHIEN, NDV.TENNHOMDICHVU, PB.PHONGBAN_ID, DV.DICHVU_ID        , ISNULL(GOI_CT.DONGIATRONGGOI,0) AS DONGIA, ISNULL(GOI_CT.SOLAN,0) AS SOLUONG, GOI_CT.THANHTIENTRONGGOI AS THANHTIEN        , CASE WHEN DV.DICHVU_ID IN (SELECT DICHVU_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU WHERE HOPDONG_ID = '1' AND HOPDONG_BENHNHAN_ID = '103') THEN 1 ELSE 0 END AS DANGKY        FROM TT_KSK_HOPDONG HD                inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        INNER JOIN TM_CSKH_GOI_CHITIET GOI_CT ON GOI_CT.GOI_ID = HD_BN.GOI_ID        INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = GOI_CT.DICHVU_ID        LEFT JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        INNER JOIN TM_PHONGBAN_DICHVU PB_DV ON PB_DV.DICHVU_ID = DV.DICHVU_ID        LEFT JOIN TM_PHONGBAN PB ON PB.PHONGBAN_ID = PB_DV.PHONGBAN_ID        WHERE GOI_CT.GOI_ID = 4 and HD_BN.HOPDONG_BENHNHAN_ID = 103        and PB_DV.PHONGBAN_ID =(select top 1 PHONGBAN_ID from TM_PHONGBAN_DICHVU where DICHVU_ID = DV.DICHVU_ID)]
2019-12-10 10:35:51,747 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhanDichVu] PreparedStatement : [SELECT distinct HD_BN.HOPDONG_ID, DV.TENDICHVU, PB.TENPHONGBAN AS NOITHUCHIEN, NDV.TENNHOMDICHVU, PB.PHONGBAN_ID, DV.DICHVU_ID        , ISNULL(GOI_CT.DONGIATRONGGOI,0) AS DONGIA, ISNULL(GOI_CT.SOLAN,0) AS SOLUONG, GOI_CT.THANHTIENTRONGGOI AS THANHTIEN        , CASE WHEN DV.DICHVU_ID IN (SELECT DICHVU_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU WHERE HOPDONG_ID = '1' AND HOPDONG_BENHNHAN_ID = '104') THEN 1 ELSE 0 END AS DANGKY        FROM TT_KSK_HOPDONG HD                inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        INNER JOIN TM_CSKH_GOI_CHITIET GOI_CT ON GOI_CT.GOI_ID = HD_BN.GOI_ID        INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = GOI_CT.DICHVU_ID        LEFT JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        INNER JOIN TM_PHONGBAN_DICHVU PB_DV ON PB_DV.DICHVU_ID = DV.DICHVU_ID        LEFT JOIN TM_PHONGBAN PB ON PB.PHONGBAN_ID = PB_DV.PHONGBAN_ID        WHERE GOI_CT.GOI_ID = 4 and HD_BN.HOPDONG_BENHNHAN_ID = 104        and PB_DV.PHONGBAN_ID =(select top 1 PHONGBAN_ID from TM_PHONGBAN_DICHVU where DICHVU_ID = DV.DICHVU_ID)]
2019-12-10 10:36:10,371 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'HSM04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 10:36:14,865 [1] DEBUG - Statement Id: [DAO00328_GetList] PreparedStatement : [SELECT DISTINCT GOI.*, HD_G.HOPDONG_ID        FROM TM_CSKH_GOI GOI        INNER JOIN LST_DICTIONARY L ON L.DICTIONARY_ID = GOI.LOAIGOI_ID        INNER JOIN TT_KSK_HOPDONG_GOIDICHVU HD_G ON HD_G.GOIDICHVU_ID = GOI.GOI_ID        WHERE GOI.TRANGTHAI='GOIDUOCPHEPBAN' AND L.DICTIONARY_TYPE_CODE = 'LoaiGoiDV' AND L.DICTIONARY_CODE = 'KhamSucKhoe']
2019-12-10 10:36:15,705 [1] DEBUG - Statement Id: [DAO00306_GetTinhTrangHonNhan] PreparedStatement : [SELECT *        FROM LST_DICTIONARY        WHERE DICTIONARY_TYPE_CODE = 'TinhTrangGiaDinh' and ENABLED = '1']
2019-12-10 10:36:15,744 [1] DEBUG - Statement Id: [DAO00307_GetContractWithDate] PreparedStatement : [SELECT HD.*, HD.SO_HD + ' - ' + CT.TENCONGTY AS HOPDONG, CT.TENCONGTY        FROM TT_KSK_HOPDONG HD JOIN TT_KSK_CONGTY CT ON CT.CONGTY_ID = HD.CONGTY_ID         where                 HD.BENHVIEN_ID = 'HLU01']
2019-12-10 10:36:16,058 [1] DEBUG - Statement Id: [DAO00306_GetStatus] PreparedStatement : [select DICTIONARY_ID, DICTIONARY_CODE, DICTIONARY_NAME        from LST_DICTIONARY        where DICTIONARY_TYPE_CODE = 'TrangThaiCapMa']
2019-12-10 10:37:10,976 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhan] PreparedStatement : [SELECT HD_BN.*, LST.DICTIONARY_NAME AS HONNHAN        , CASE WHEN HD_BN.GIOITINH = '1' THEN N'Nam' ELSE N'Nữ' END AS GENDER        , NV.TENNHANVIEN, GOI.TENGOI        , DT.DICTIONARY_NAME as DOITUONG        , HC.TENDONVI as NOICAP        , ISNULL(HD_BN.DIACHI,'') + ',' + ISNULL(XP.TENDONVI,'') + ',' + ISNULL(QH.TENDONVI,'') + ',' + ISNULL(TP.TENDONVI,'') as DIACHILIENLAC        , CASE WHEN HD_BN.NGAYSINH IS NULL THEN CAST(HD_BN.NAMSINH AS VARCHAR(4)) ELSE CONVERT(VARCHAR(10), HD_BN.NGAYSINH,103) END AS NGAYTHANGNAMSINH        FROM TT_KSK_HOPDONG_BENHNHAN HD_BN        LEFT JOIN TT_KSK_HOPDONG HD ON HD.HOPDONG_ID = HD_BN.HOPDONG_ID        LEFT JOIN LST_DICTIONARY LST ON LST.DICTIONARY_ID = HD_BN.TINHTRANGHONNHAN_ID AND LST.DICTIONARY_TYPE_CODE = 'TinhTrangGiaDinh'        LEFT JOIN TM_NHANVIEN NV ON NV.NHANVIEN_ID = HD_BN.NHANVIEN_ID        LEFT JOIN TM_CSKH_GOI GOI ON GOI.GOI_ID = HD_BN.GOI_ID        LEFT JOIN LST_DICTIONARY DT ON DT.DICTIONARY_ID = HD_BN.DOITUONG_ID AND DT.DICTIONARY_TYPE_CODE = 'DoiTuongKhamSucKhoe'        LEFT JOIN TM_DONVIHANHCHINH HC ON HC.DONVIHANHCHINH_ID = HD_BN.NOICAP_ID        LEFT JOIN TM_DONVIHANHCHINH XP on XP.MADONVI = HD_BN.XAPHUONGTT_ID        LEFT JOIN TM_DONVIHANHCHINH QH on QH.DONVIHANHCHINH_ID = XP.CAPTREN_ID        LEFT JOIN TM_DONVIHANHCHINH TP on TP.DONVIHANHCHINH_ID = QH.CAPTREN_ID         where                 HD_BN.HOPDONG_ID = 3             and               HD_BN.BENHVIEN_ID = 'HLU01'                       ORDER BY HD_BN.STT]
2019-12-10 10:37:17,858 [1] DEBUG - Statement Id: [DAO00087_GetServiceParams] PreparedStatement : [select CODE, VALUE              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01']
2019-12-10 10:37:27,136 [1] DEBUG - Statement Id: [DAO00308_GetAllPatient] PreparedStatement : [select * from TT_BENHNHAN]
2019-12-10 10:37:49,109 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'HSM19'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 10:37:51,415 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM98'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 10:38:08,118 [1] DEBUG - Statement Id: [DAO00307_MedicalCode] PreparedStatement : [UPDATE TT_KSK_HOPDONG_BENHNHAN SET        MAYTE =  @param0         , BENHNHAN_ID =  @param1         , TONTAI = '0'        , NGAYCAPNHAT = GETDATE()        WHERE HOPDONG_BENHNHAN_ID = 211]
2019-12-10 10:38:08,118 [1] DEBUG - Statement Id: [DAO00307_MedicalCode] Parameters: [@param0=[MAYTE,190043280], @param1=[BENHNHAN_ID,23398]]
2019-12-10 10:38:08,118 [1] DEBUG - Statement Id: [DAO00307_MedicalCode] Types: [@param0=[String, System.String], @param1=[Int64, System.Int64]]
2019-12-10 10:38:11,498 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhan] PreparedStatement : [SELECT HD_BN.*, LST.DICTIONARY_NAME AS HONNHAN        , CASE WHEN HD_BN.GIOITINH = '1' THEN N'Nam' ELSE N'Nữ' END AS GENDER        , NV.TENNHANVIEN, GOI.TENGOI        , DT.DICTIONARY_NAME as DOITUONG        , HC.TENDONVI as NOICAP        , ISNULL(HD_BN.DIACHI,'') + ',' + ISNULL(XP.TENDONVI,'') + ',' + ISNULL(QH.TENDONVI,'') + ',' + ISNULL(TP.TENDONVI,'') as DIACHILIENLAC        , CASE WHEN HD_BN.NGAYSINH IS NULL THEN CAST(HD_BN.NAMSINH AS VARCHAR(4)) ELSE CONVERT(VARCHAR(10), HD_BN.NGAYSINH,103) END AS NGAYTHANGNAMSINH        FROM TT_KSK_HOPDONG_BENHNHAN HD_BN        LEFT JOIN TT_KSK_HOPDONG HD ON HD.HOPDONG_ID = HD_BN.HOPDONG_ID        LEFT JOIN LST_DICTIONARY LST ON LST.DICTIONARY_ID = HD_BN.TINHTRANGHONNHAN_ID AND LST.DICTIONARY_TYPE_CODE = 'TinhTrangGiaDinh'        LEFT JOIN TM_NHANVIEN NV ON NV.NHANVIEN_ID = HD_BN.NHANVIEN_ID        LEFT JOIN TM_CSKH_GOI GOI ON GOI.GOI_ID = HD_BN.GOI_ID        LEFT JOIN LST_DICTIONARY DT ON DT.DICTIONARY_ID = HD_BN.DOITUONG_ID AND DT.DICTIONARY_TYPE_CODE = 'DoiTuongKhamSucKhoe'        LEFT JOIN TM_DONVIHANHCHINH HC ON HC.DONVIHANHCHINH_ID = HD_BN.NOICAP_ID        LEFT JOIN TM_DONVIHANHCHINH XP on XP.MADONVI = HD_BN.XAPHUONGTT_ID        LEFT JOIN TM_DONVIHANHCHINH QH on QH.DONVIHANHCHINH_ID = XP.CAPTREN_ID        LEFT JOIN TM_DONVIHANHCHINH TP on TP.DONVIHANHCHINH_ID = QH.CAPTREN_ID         where                 HD_BN.HOPDONG_ID = 3             and               HD_BN.BENHVIEN_ID = 'HLU01'                       ORDER BY HD_BN.STT]
2019-12-10 10:38:12,340 [1] DEBUG - Statement Id: [DAO00308_GetAllPatient] PreparedStatement : [select * from TT_BENHNHAN]
2019-12-10 10:38:24,553 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhan] PreparedStatement : [SELECT HD_BN.*, LST.DICTIONARY_NAME AS HONNHAN        , CASE WHEN HD_BN.GIOITINH = '1' THEN N'Nam' ELSE N'Nữ' END AS GENDER        , NV.TENNHANVIEN, GOI.TENGOI        , DT.DICTIONARY_NAME as DOITUONG        , HC.TENDONVI as NOICAP        , ISNULL(HD_BN.DIACHI,'') + ',' + ISNULL(XP.TENDONVI,'') + ',' + ISNULL(QH.TENDONVI,'') + ',' + ISNULL(TP.TENDONVI,'') as DIACHILIENLAC        , CASE WHEN HD_BN.NGAYSINH IS NULL THEN CAST(HD_BN.NAMSINH AS VARCHAR(4)) ELSE CONVERT(VARCHAR(10), HD_BN.NGAYSINH,103) END AS NGAYTHANGNAMSINH        FROM TT_KSK_HOPDONG_BENHNHAN HD_BN        LEFT JOIN TT_KSK_HOPDONG HD ON HD.HOPDONG_ID = HD_BN.HOPDONG_ID        LEFT JOIN LST_DICTIONARY LST ON LST.DICTIONARY_ID = HD_BN.TINHTRANGHONNHAN_ID AND LST.DICTIONARY_TYPE_CODE = 'TinhTrangGiaDinh'        LEFT JOIN TM_NHANVIEN NV ON NV.NHANVIEN_ID = HD_BN.NHANVIEN_ID        LEFT JOIN TM_CSKH_GOI GOI ON GOI.GOI_ID = HD_BN.GOI_ID        LEFT JOIN LST_DICTIONARY DT ON DT.DICTIONARY_ID = HD_BN.DOITUONG_ID AND DT.DICTIONARY_TYPE_CODE = 'DoiTuongKhamSucKhoe'        LEFT JOIN TM_DONVIHANHCHINH HC ON HC.DONVIHANHCHINH_ID = HD_BN.NOICAP_ID        LEFT JOIN TM_DONVIHANHCHINH XP on XP.MADONVI = HD_BN.XAPHUONGTT_ID        LEFT JOIN TM_DONVIHANHCHINH QH on QH.DONVIHANHCHINH_ID = XP.CAPTREN_ID        LEFT JOIN TM_DONVIHANHCHINH TP on TP.DONVIHANHCHINH_ID = QH.CAPTREN_ID         where                 HD_BN.HOPDONG_ID = 3             and               HD_BN.BENHVIEN_ID = 'HLU01'                       ORDER BY HD_BN.STT]
2019-12-10 10:41:38,004 [1] DEBUG - Statement Id: [DAO00308_StatusContract] PreparedStatement : [SELECT * FROM TT_KSK_HOPDONG        WHERE HOPDONG_ID = 3]
2019-12-10 10:41:38,182 [1] DEBUG - Statement Id: [DAO00307_Update] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN set        HOPDONG_ID =  @param0         , TENBENHNHAN =  @param1         , GIOITINH =  @param2         , NGAYSINH =  @param3         , NAMSINH =  @param4         , DIACHI =  @param5         , QUOCTICH_ID =  @param6         , TINHTHANH_ID =  @param7         , QUANHUYEN_ID =  @param8         , XAPHUONG_ID =  @param9         , DIACHITHUONGTRU =  @param10         , XAPHUONGTT_ID =  @param11         , DANTOC_ID =  @param12         , LOAITHE =  @param13         , SODIENTHOAI =  @param14         , EMAIL =  @param15         , NGHENGHIEP_ID =  @param16         , TINHTRANGHONNHAN_ID =  @param17         , DOITUONG_ID =  @param18         , CMND =  @param19         , NGAYCAPTHE =  @param20         , NAMCAPTHE =  @param21         , NOICAP_ID =  @param22         , NHANVIEN_ID =  @param23         , NHOMMAU_ID =  @param24         , YEUTORH_ID =  @param25         , NHOMBENH_ID =  @param26         , TIENSUDIUNG =  @param27         , TIENSUBENH =  @param28         , GHICHU =  @param29         , KETQUA =  @param30         , XEPLOAI_ID =  @param31         , BSKETLUAN_ID =  @param32         , GOI_ID =  @param33         , IDCHUYEN =  @param34         , DACOPHIEUYEUCAU =  @param35         , DACOKETQUA =  @param36         , NGAYHEN =  @param37         , BENHVIEN_ID =  @param38         , NGAYTAO =  @param39         , NGUOITAO_ID =  @param40         , NGAYCAPNHAT =  @param41         , NGUOICAPNHAT_ID =  @param42         where        HOPDONG_BENHNHAN_ID = '210']
2019-12-10 10:41:38,182 [1] DEBUG - Statement Id: [DAO00307_Update] Parameters: [@param0=[HOPDONG_ID,3], @param1=[TENBENHNHAN,Nguyễn Hữu Khai], @param2=[GIOITINH,1], @param3=[NGAYSINH,2/15/1990 12:00:00 AM], @param4=[NAMSINH,1990], @param5=[DIACHI,null], @param6=[QUOCTICH_ID,null], @param7=[TINHTHANH_ID,null], @param8=[QUANHUYEN_ID,null], @param9=[XAPHUONG_ID,null], @param10=[DIACHITHUONGTRU,null], @param11=[XAPHUONGTT_ID,null], @param12=[DANTOC_ID,null], @param13=[LOAITHE,null], @param14=[SODIENTHOAI,null], @param15=[EMAIL,null], @param16=[NGHENGHIEP_ID,null], @param17=[TINHTRANGHONNHAN_ID,1578], @param18=[DOITUONG_ID,null], @param19=[CMND,null], @param20=[NGAYCAPTHE,null], @param21=[NAMCAPTHE,null], @param22=[NOICAP_ID,null], @param23=[NHANVIEN_ID,null], @param24=[NHOMMAU_ID,null], @param25=[YEUTORH_ID,null], @param26=[NHOMBENH_ID,null], @param27=[TIENSUDIUNG,null], @param28=[TIENSUBENH,null], @param29=[GHICHU,null], @param30=[KETQUA,null], @param31=[XEPLOAI_ID,null], @param32=[BSKETLUAN_ID,null], @param33=[GOI_ID,3], @param34=[IDCHUYEN,null], @param35=[DACOPHIEUYEUCAU,null], @param36=[DACOKETQUA,null], @param37=[NGAYHEN,null], @param38=[BENHVIEN_ID,HLU01], @param39=[NGAYTAO,12/9/2019 3:16:19 PM], @param40=[NGUOITAO_ID,null], @param41=[NGAYCAPNHAT,12/10/2019 10:41:38 AM], @param42=[NGUOICAPNHAT_ID,1]]
2019-12-10 10:41:38,182 [1] DEBUG - Statement Id: [DAO00307_Update] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String], @param2=[Int64, System.Int64], @param3=[DateTime, System.DateTime], @param4=[Int64, System.Int64], @param5=[System.DBNull, null], @param6=[System.DBNull, null], @param7=[System.DBNull, null], @param8=[System.DBNull, null], @param9=[System.DBNull, null], @param10=[System.DBNull, null], @param11=[System.DBNull, null], @param12=[System.DBNull, null], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[Int64, System.Int64], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[System.DBNull, null], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[Int64, System.Int64], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[DateTime, System.DateTime], @param40=[System.DBNull, null], @param41=[DateTime, System.DateTime], @param42=[Int64, System.Int64]]
2019-12-10 10:41:38,456 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhan] PreparedStatement : [SELECT HD_BN.*, LST.DICTIONARY_NAME AS HONNHAN        , CASE WHEN HD_BN.GIOITINH = '1' THEN N'Nam' ELSE N'Nữ' END AS GENDER        , NV.TENNHANVIEN, GOI.TENGOI        , DT.DICTIONARY_NAME as DOITUONG        , HC.TENDONVI as NOICAP        , ISNULL(HD_BN.DIACHI,'') + ',' + ISNULL(XP.TENDONVI,'') + ',' + ISNULL(QH.TENDONVI,'') + ',' + ISNULL(TP.TENDONVI,'') as DIACHILIENLAC        , CASE WHEN HD_BN.NGAYSINH IS NULL THEN CAST(HD_BN.NAMSINH AS VARCHAR(4)) ELSE CONVERT(VARCHAR(10), HD_BN.NGAYSINH,103) END AS NGAYTHANGNAMSINH        FROM TT_KSK_HOPDONG_BENHNHAN HD_BN        LEFT JOIN TT_KSK_HOPDONG HD ON HD.HOPDONG_ID = HD_BN.HOPDONG_ID        LEFT JOIN LST_DICTIONARY LST ON LST.DICTIONARY_ID = HD_BN.TINHTRANGHONNHAN_ID AND LST.DICTIONARY_TYPE_CODE = 'TinhTrangGiaDinh'        LEFT JOIN TM_NHANVIEN NV ON NV.NHANVIEN_ID = HD_BN.NHANVIEN_ID        LEFT JOIN TM_CSKH_GOI GOI ON GOI.GOI_ID = HD_BN.GOI_ID        LEFT JOIN LST_DICTIONARY DT ON DT.DICTIONARY_ID = HD_BN.DOITUONG_ID AND DT.DICTIONARY_TYPE_CODE = 'DoiTuongKhamSucKhoe'        LEFT JOIN TM_DONVIHANHCHINH HC ON HC.DONVIHANHCHINH_ID = HD_BN.NOICAP_ID        LEFT JOIN TM_DONVIHANHCHINH XP on XP.MADONVI = HD_BN.XAPHUONGTT_ID        LEFT JOIN TM_DONVIHANHCHINH QH on QH.DONVIHANHCHINH_ID = XP.CAPTREN_ID        LEFT JOIN TM_DONVIHANHCHINH TP on TP.DONVIHANHCHINH_ID = QH.CAPTREN_ID         where                 HD_BN.HOPDONG_ID = 3             and               HD_BN.BENHVIEN_ID = 'HLU01'                       ORDER BY HD_BN.STT]
2019-12-10 10:41:44,886 [1] DEBUG - Statement Id: [DAO00308_StatusContract] PreparedStatement : [SELECT * FROM TT_KSK_HOPDONG        WHERE HOPDONG_ID = 3]
2019-12-10 10:41:44,985 [1] DEBUG - Statement Id: [DAO00307_Update] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN set        HOPDONG_ID =  @param0         , TENBENHNHAN =  @param1         , GIOITINH =  @param2         , NGAYSINH =  @param3         , NAMSINH =  @param4         , DIACHI =  @param5         , QUOCTICH_ID =  @param6         , TINHTHANH_ID =  @param7         , QUANHUYEN_ID =  @param8         , XAPHUONG_ID =  @param9         , DIACHITHUONGTRU =  @param10         , XAPHUONGTT_ID =  @param11         , DANTOC_ID =  @param12         , LOAITHE =  @param13         , SODIENTHOAI =  @param14         , EMAIL =  @param15         , NGHENGHIEP_ID =  @param16         , TINHTRANGHONNHAN_ID =  @param17         , DOITUONG_ID =  @param18         , CMND =  @param19         , NGAYCAPTHE =  @param20         , NAMCAPTHE =  @param21         , NOICAP_ID =  @param22         , NHANVIEN_ID =  @param23         , NHOMMAU_ID =  @param24         , YEUTORH_ID =  @param25         , NHOMBENH_ID =  @param26         , TIENSUDIUNG =  @param27         , TIENSUBENH =  @param28         , GHICHU =  @param29         , KETQUA =  @param30         , XEPLOAI_ID =  @param31         , BSKETLUAN_ID =  @param32         , GOI_ID =  @param33         , IDCHUYEN =  @param34         , DACOPHIEUYEUCAU =  @param35         , DACOKETQUA =  @param36         , NGAYHEN =  @param37         , BENHVIEN_ID =  @param38         , NGAYTAO =  @param39         , NGUOITAO_ID =  @param40         , NGAYCAPNHAT =  @param41         , NGUOICAPNHAT_ID =  @param42         where        HOPDONG_BENHNHAN_ID = '211']
2019-12-10 10:41:44,986 [1] DEBUG - Statement Id: [DAO00307_Update] Parameters: [@param0=[HOPDONG_ID,3], @param1=[TENBENHNHAN,Lê Dương Bảo Lâm], @param2=[GIOITINH,1], @param3=[NGAYSINH,2/16/1990 12:00:00 AM], @param4=[NAMSINH,1990], @param5=[DIACHI,null], @param6=[QUOCTICH_ID,null], @param7=[TINHTHANH_ID,null], @param8=[QUANHUYEN_ID,null], @param9=[XAPHUONG_ID,null], @param10=[DIACHITHUONGTRU,null], @param11=[XAPHUONGTT_ID,null], @param12=[DANTOC_ID,null], @param13=[LOAITHE,null], @param14=[SODIENTHOAI,null], @param15=[EMAIL,null], @param16=[NGHENGHIEP_ID,null], @param17=[TINHTRANGHONNHAN_ID,1578], @param18=[DOITUONG_ID,null], @param19=[CMND,null], @param20=[NGAYCAPTHE,null], @param21=[NAMCAPTHE,null], @param22=[NOICAP_ID,null], @param23=[NHANVIEN_ID,null], @param24=[NHOMMAU_ID,null], @param25=[YEUTORH_ID,null], @param26=[NHOMBENH_ID,null], @param27=[TIENSUDIUNG,null], @param28=[TIENSUBENH,null], @param29=[GHICHU,null], @param30=[KETQUA,null], @param31=[XEPLOAI_ID,null], @param32=[BSKETLUAN_ID,null], @param33=[GOI_ID,3], @param34=[IDCHUYEN,null], @param35=[DACOPHIEUYEUCAU,null], @param36=[DACOKETQUA,null], @param37=[NGAYHEN,null], @param38=[BENHVIEN_ID,HLU01], @param39=[NGAYTAO,12/9/2019 3:16:19 PM], @param40=[NGUOITAO_ID,null], @param41=[NGAYCAPNHAT,12/10/2019 10:41:44 AM], @param42=[NGUOICAPNHAT_ID,1]]
2019-12-10 10:41:44,986 [1] DEBUG - Statement Id: [DAO00307_Update] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String], @param2=[Int64, System.Int64], @param3=[DateTime, System.DateTime], @param4=[Int64, System.Int64], @param5=[System.DBNull, null], @param6=[System.DBNull, null], @param7=[System.DBNull, null], @param8=[System.DBNull, null], @param9=[System.DBNull, null], @param10=[System.DBNull, null], @param11=[System.DBNull, null], @param12=[System.DBNull, null], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[Int64, System.Int64], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[System.DBNull, null], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[Int64, System.Int64], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[DateTime, System.DateTime], @param40=[System.DBNull, null], @param41=[DateTime, System.DateTime], @param42=[Int64, System.Int64]]
2019-12-10 10:41:45,216 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhan] PreparedStatement : [SELECT HD_BN.*, LST.DICTIONARY_NAME AS HONNHAN        , CASE WHEN HD_BN.GIOITINH = '1' THEN N'Nam' ELSE N'Nữ' END AS GENDER        , NV.TENNHANVIEN, GOI.TENGOI        , DT.DICTIONARY_NAME as DOITUONG        , HC.TENDONVI as NOICAP        , ISNULL(HD_BN.DIACHI,'') + ',' + ISNULL(XP.TENDONVI,'') + ',' + ISNULL(QH.TENDONVI,'') + ',' + ISNULL(TP.TENDONVI,'') as DIACHILIENLAC        , CASE WHEN HD_BN.NGAYSINH IS NULL THEN CAST(HD_BN.NAMSINH AS VARCHAR(4)) ELSE CONVERT(VARCHAR(10), HD_BN.NGAYSINH,103) END AS NGAYTHANGNAMSINH        FROM TT_KSK_HOPDONG_BENHNHAN HD_BN        LEFT JOIN TT_KSK_HOPDONG HD ON HD.HOPDONG_ID = HD_BN.HOPDONG_ID        LEFT JOIN LST_DICTIONARY LST ON LST.DICTIONARY_ID = HD_BN.TINHTRANGHONNHAN_ID AND LST.DICTIONARY_TYPE_CODE = 'TinhTrangGiaDinh'        LEFT JOIN TM_NHANVIEN NV ON NV.NHANVIEN_ID = HD_BN.NHANVIEN_ID        LEFT JOIN TM_CSKH_GOI GOI ON GOI.GOI_ID = HD_BN.GOI_ID        LEFT JOIN LST_DICTIONARY DT ON DT.DICTIONARY_ID = HD_BN.DOITUONG_ID AND DT.DICTIONARY_TYPE_CODE = 'DoiTuongKhamSucKhoe'        LEFT JOIN TM_DONVIHANHCHINH HC ON HC.DONVIHANHCHINH_ID = HD_BN.NOICAP_ID        LEFT JOIN TM_DONVIHANHCHINH XP on XP.MADONVI = HD_BN.XAPHUONGTT_ID        LEFT JOIN TM_DONVIHANHCHINH QH on QH.DONVIHANHCHINH_ID = XP.CAPTREN_ID        LEFT JOIN TM_DONVIHANHCHINH TP on TP.DONVIHANHCHINH_ID = QH.CAPTREN_ID         where                 HD_BN.HOPDONG_ID = 3             and               HD_BN.BENHVIEN_ID = 'HLU01'                       ORDER BY HD_BN.STT]
2019-12-10 10:41:50,427 [1] DEBUG - Statement Id: [DAO00308_StatusContract] PreparedStatement : [SELECT * FROM TT_KSK_HOPDONG        WHERE HOPDONG_ID = 3]
2019-12-10 10:41:51,414 [1] DEBUG - Statement Id: [DAO00307_Update] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN set        HOPDONG_ID =  @param0         , TENBENHNHAN =  @param1         , GIOITINH =  @param2         , NGAYSINH =  @param3         , NAMSINH =  @param4         , DIACHI =  @param5         , QUOCTICH_ID =  @param6         , TINHTHANH_ID =  @param7         , QUANHUYEN_ID =  @param8         , XAPHUONG_ID =  @param9         , DIACHITHUONGTRU =  @param10         , XAPHUONGTT_ID =  @param11         , DANTOC_ID =  @param12         , LOAITHE =  @param13         , SODIENTHOAI =  @param14         , EMAIL =  @param15         , NGHENGHIEP_ID =  @param16         , TINHTRANGHONNHAN_ID =  @param17         , DOITUONG_ID =  @param18         , CMND =  @param19         , NGAYCAPTHE =  @param20         , NAMCAPTHE =  @param21         , NOICAP_ID =  @param22         , NHANVIEN_ID =  @param23         , NHOMMAU_ID =  @param24         , YEUTORH_ID =  @param25         , NHOMBENH_ID =  @param26         , TIENSUDIUNG =  @param27         , TIENSUBENH =  @param28         , GHICHU =  @param29         , KETQUA =  @param30         , XEPLOAI_ID =  @param31         , BSKETLUAN_ID =  @param32         , GOI_ID =  @param33         , IDCHUYEN =  @param34         , DACOPHIEUYEUCAU =  @param35         , DACOKETQUA =  @param36         , NGAYHEN =  @param37         , BENHVIEN_ID =  @param38         , NGAYTAO =  @param39         , NGUOITAO_ID =  @param40         , NGAYCAPNHAT =  @param41         , NGUOICAPNHAT_ID =  @param42         where        HOPDONG_BENHNHAN_ID = '212']
2019-12-10 10:41:51,414 [1] DEBUG - Statement Id: [DAO00307_Update] Parameters: [@param0=[HOPDONG_ID,3], @param1=[TENBENHNHAN,Nguyễn Anh Hào], @param2=[GIOITINH,1], @param3=[NGAYSINH,2/17/1990 12:00:00 AM], @param4=[NAMSINH,1990], @param5=[DIACHI,null], @param6=[QUOCTICH_ID,null], @param7=[TINHTHANH_ID,null], @param8=[QUANHUYEN_ID,null], @param9=[XAPHUONG_ID,null], @param10=[DIACHITHUONGTRU,null], @param11=[XAPHUONGTT_ID,null], @param12=[DANTOC_ID,null], @param13=[LOAITHE,null], @param14=[SODIENTHOAI,null], @param15=[EMAIL,null], @param16=[NGHENGHIEP_ID,null], @param17=[TINHTRANGHONNHAN_ID,1578], @param18=[DOITUONG_ID,null], @param19=[CMND,null], @param20=[NGAYCAPTHE,null], @param21=[NAMCAPTHE,null], @param22=[NOICAP_ID,null], @param23=[NHANVIEN_ID,null], @param24=[NHOMMAU_ID,null], @param25=[YEUTORH_ID,null], @param26=[NHOMBENH_ID,null], @param27=[TIENSUDIUNG,null], @param28=[TIENSUBENH,null], @param29=[GHICHU,null], @param30=[KETQUA,null], @param31=[XEPLOAI_ID,null], @param32=[BSKETLUAN_ID,null], @param33=[GOI_ID,3], @param34=[IDCHUYEN,null], @param35=[DACOPHIEUYEUCAU,null], @param36=[DACOKETQUA,null], @param37=[NGAYHEN,null], @param38=[BENHVIEN_ID,HLU01], @param39=[NGAYTAO,12/9/2019 3:16:19 PM], @param40=[NGUOITAO_ID,null], @param41=[NGAYCAPNHAT,12/10/2019 10:41:51 AM], @param42=[NGUOICAPNHAT_ID,1]]
2019-12-10 10:41:51,414 [1] DEBUG - Statement Id: [DAO00307_Update] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String], @param2=[Int64, System.Int64], @param3=[DateTime, System.DateTime], @param4=[Int64, System.Int64], @param5=[System.DBNull, null], @param6=[System.DBNull, null], @param7=[System.DBNull, null], @param8=[System.DBNull, null], @param9=[System.DBNull, null], @param10=[System.DBNull, null], @param11=[System.DBNull, null], @param12=[System.DBNull, null], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[Int64, System.Int64], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[System.DBNull, null], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[Int64, System.Int64], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[DateTime, System.DateTime], @param40=[System.DBNull, null], @param41=[DateTime, System.DateTime], @param42=[Int64, System.Int64]]
2019-12-10 10:41:53,505 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhan] PreparedStatement : [SELECT HD_BN.*, LST.DICTIONARY_NAME AS HONNHAN        , CASE WHEN HD_BN.GIOITINH = '1' THEN N'Nam' ELSE N'Nữ' END AS GENDER        , NV.TENNHANVIEN, GOI.TENGOI        , DT.DICTIONARY_NAME as DOITUONG        , HC.TENDONVI as NOICAP        , ISNULL(HD_BN.DIACHI,'') + ',' + ISNULL(XP.TENDONVI,'') + ',' + ISNULL(QH.TENDONVI,'') + ',' + ISNULL(TP.TENDONVI,'') as DIACHILIENLAC        , CASE WHEN HD_BN.NGAYSINH IS NULL THEN CAST(HD_BN.NAMSINH AS VARCHAR(4)) ELSE CONVERT(VARCHAR(10), HD_BN.NGAYSINH,103) END AS NGAYTHANGNAMSINH        FROM TT_KSK_HOPDONG_BENHNHAN HD_BN        LEFT JOIN TT_KSK_HOPDONG HD ON HD.HOPDONG_ID = HD_BN.HOPDONG_ID        LEFT JOIN LST_DICTIONARY LST ON LST.DICTIONARY_ID = HD_BN.TINHTRANGHONNHAN_ID AND LST.DICTIONARY_TYPE_CODE = 'TinhTrangGiaDinh'        LEFT JOIN TM_NHANVIEN NV ON NV.NHANVIEN_ID = HD_BN.NHANVIEN_ID        LEFT JOIN TM_CSKH_GOI GOI ON GOI.GOI_ID = HD_BN.GOI_ID        LEFT JOIN LST_DICTIONARY DT ON DT.DICTIONARY_ID = HD_BN.DOITUONG_ID AND DT.DICTIONARY_TYPE_CODE = 'DoiTuongKhamSucKhoe'        LEFT JOIN TM_DONVIHANHCHINH HC ON HC.DONVIHANHCHINH_ID = HD_BN.NOICAP_ID        LEFT JOIN TM_DONVIHANHCHINH XP on XP.MADONVI = HD_BN.XAPHUONGTT_ID        LEFT JOIN TM_DONVIHANHCHINH QH on QH.DONVIHANHCHINH_ID = XP.CAPTREN_ID        LEFT JOIN TM_DONVIHANHCHINH TP on TP.DONVIHANHCHINH_ID = QH.CAPTREN_ID         where                 HD_BN.HOPDONG_ID = 3             and               HD_BN.BENHVIEN_ID = 'HLU01'                       ORDER BY HD_BN.STT]
2019-12-10 10:41:59,642 [1] DEBUG - Statement Id: [DAO00308_StatusContract] PreparedStatement : [SELECT * FROM TT_KSK_HOPDONG        WHERE HOPDONG_ID = 3]
2019-12-10 10:42:01,047 [1] DEBUG - Statement Id: [DAO00307_Update] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN set        HOPDONG_ID =  @param0         , TENBENHNHAN =  @param1         , GIOITINH =  @param2         , NGAYSINH =  @param3         , NAMSINH =  @param4         , DIACHI =  @param5         , QUOCTICH_ID =  @param6         , TINHTHANH_ID =  @param7         , QUANHUYEN_ID =  @param8         , XAPHUONG_ID =  @param9         , DIACHITHUONGTRU =  @param10         , XAPHUONGTT_ID =  @param11         , DANTOC_ID =  @param12         , LOAITHE =  @param13         , SODIENTHOAI =  @param14         , EMAIL =  @param15         , NGHENGHIEP_ID =  @param16         , TINHTRANGHONNHAN_ID =  @param17         , DOITUONG_ID =  @param18         , CMND =  @param19         , NGAYCAPTHE =  @param20         , NAMCAPTHE =  @param21         , NOICAP_ID =  @param22         , NHANVIEN_ID =  @param23         , NHOMMAU_ID =  @param24         , YEUTORH_ID =  @param25         , NHOMBENH_ID =  @param26         , TIENSUDIUNG =  @param27         , TIENSUBENH =  @param28         , GHICHU =  @param29         , KETQUA =  @param30         , XEPLOAI_ID =  @param31         , BSKETLUAN_ID =  @param32         , GOI_ID =  @param33         , IDCHUYEN =  @param34         , DACOPHIEUYEUCAU =  @param35         , DACOKETQUA =  @param36         , NGAYHEN =  @param37         , BENHVIEN_ID =  @param38         , NGAYTAO =  @param39         , NGUOITAO_ID =  @param40         , NGAYCAPNHAT =  @param41         , NGUOICAPNHAT_ID =  @param42         where        HOPDONG_BENHNHAN_ID = '213']
2019-12-10 10:42:01,048 [1] DEBUG - Statement Id: [DAO00307_Update] Parameters: [@param0=[HOPDONG_ID,3], @param1=[TENBENHNHAN,Nguyễn Hữu Dương], @param2=[GIOITINH,1], @param3=[NGAYSINH,2/18/1990 12:00:00 AM], @param4=[NAMSINH,1990], @param5=[DIACHI,null], @param6=[QUOCTICH_ID,null], @param7=[TINHTHANH_ID,null], @param8=[QUANHUYEN_ID,null], @param9=[XAPHUONG_ID,null], @param10=[DIACHITHUONGTRU,null], @param11=[XAPHUONGTT_ID,null], @param12=[DANTOC_ID,null], @param13=[LOAITHE,null], @param14=[SODIENTHOAI,null], @param15=[EMAIL,null], @param16=[NGHENGHIEP_ID,null], @param17=[TINHTRANGHONNHAN_ID,1578], @param18=[DOITUONG_ID,null], @param19=[CMND,null], @param20=[NGAYCAPTHE,null], @param21=[NAMCAPTHE,null], @param22=[NOICAP_ID,null], @param23=[NHANVIEN_ID,null], @param24=[NHOMMAU_ID,null], @param25=[YEUTORH_ID,null], @param26=[NHOMBENH_ID,null], @param27=[TIENSUDIUNG,null], @param28=[TIENSUBENH,null], @param29=[GHICHU,null], @param30=[KETQUA,null], @param31=[XEPLOAI_ID,null], @param32=[BSKETLUAN_ID,null], @param33=[GOI_ID,3], @param34=[IDCHUYEN,null], @param35=[DACOPHIEUYEUCAU,null], @param36=[DACOKETQUA,null], @param37=[NGAYHEN,null], @param38=[BENHVIEN_ID,HLU01], @param39=[NGAYTAO,12/9/2019 3:16:20 PM], @param40=[NGUOITAO_ID,null], @param41=[NGAYCAPNHAT,12/10/2019 10:42:01 AM], @param42=[NGUOICAPNHAT_ID,1]]
2019-12-10 10:42:01,048 [1] DEBUG - Statement Id: [DAO00307_Update] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String], @param2=[Int64, System.Int64], @param3=[DateTime, System.DateTime], @param4=[Int64, System.Int64], @param5=[System.DBNull, null], @param6=[System.DBNull, null], @param7=[System.DBNull, null], @param8=[System.DBNull, null], @param9=[System.DBNull, null], @param10=[System.DBNull, null], @param11=[System.DBNull, null], @param12=[System.DBNull, null], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[Int64, System.Int64], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[System.DBNull, null], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[Int64, System.Int64], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[DateTime, System.DateTime], @param40=[System.DBNull, null], @param41=[DateTime, System.DateTime], @param42=[Int64, System.Int64]]
2019-12-10 10:42:02,007 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhan] PreparedStatement : [SELECT HD_BN.*, LST.DICTIONARY_NAME AS HONNHAN        , CASE WHEN HD_BN.GIOITINH = '1' THEN N'Nam' ELSE N'Nữ' END AS GENDER        , NV.TENNHANVIEN, GOI.TENGOI        , DT.DICTIONARY_NAME as DOITUONG        , HC.TENDONVI as NOICAP        , ISNULL(HD_BN.DIACHI,'') + ',' + ISNULL(XP.TENDONVI,'') + ',' + ISNULL(QH.TENDONVI,'') + ',' + ISNULL(TP.TENDONVI,'') as DIACHILIENLAC        , CASE WHEN HD_BN.NGAYSINH IS NULL THEN CAST(HD_BN.NAMSINH AS VARCHAR(4)) ELSE CONVERT(VARCHAR(10), HD_BN.NGAYSINH,103) END AS NGAYTHANGNAMSINH        FROM TT_KSK_HOPDONG_BENHNHAN HD_BN        LEFT JOIN TT_KSK_HOPDONG HD ON HD.HOPDONG_ID = HD_BN.HOPDONG_ID        LEFT JOIN LST_DICTIONARY LST ON LST.DICTIONARY_ID = HD_BN.TINHTRANGHONNHAN_ID AND LST.DICTIONARY_TYPE_CODE = 'TinhTrangGiaDinh'        LEFT JOIN TM_NHANVIEN NV ON NV.NHANVIEN_ID = HD_BN.NHANVIEN_ID        LEFT JOIN TM_CSKH_GOI GOI ON GOI.GOI_ID = HD_BN.GOI_ID        LEFT JOIN LST_DICTIONARY DT ON DT.DICTIONARY_ID = HD_BN.DOITUONG_ID AND DT.DICTIONARY_TYPE_CODE = 'DoiTuongKhamSucKhoe'        LEFT JOIN TM_DONVIHANHCHINH HC ON HC.DONVIHANHCHINH_ID = HD_BN.NOICAP_ID        LEFT JOIN TM_DONVIHANHCHINH XP on XP.MADONVI = HD_BN.XAPHUONGTT_ID        LEFT JOIN TM_DONVIHANHCHINH QH on QH.DONVIHANHCHINH_ID = XP.CAPTREN_ID        LEFT JOIN TM_DONVIHANHCHINH TP on TP.DONVIHANHCHINH_ID = QH.CAPTREN_ID         where                 HD_BN.HOPDONG_ID = 3             and               HD_BN.BENHVIEN_ID = 'HLU01'                       ORDER BY HD_BN.STT]
2019-12-10 10:42:07,586 [1] DEBUG - Statement Id: [DAO00308_StatusContract] PreparedStatement : [SELECT * FROM TT_KSK_HOPDONG        WHERE HOPDONG_ID = 3]
2019-12-10 10:42:09,220 [1] DEBUG - Statement Id: [DAO00307_Update] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN set        HOPDONG_ID =  @param0         , TENBENHNHAN =  @param1         , GIOITINH =  @param2         , NGAYSINH =  @param3         , NAMSINH =  @param4         , DIACHI =  @param5         , QUOCTICH_ID =  @param6         , TINHTHANH_ID =  @param7         , QUANHUYEN_ID =  @param8         , XAPHUONG_ID =  @param9         , DIACHITHUONGTRU =  @param10         , XAPHUONGTT_ID =  @param11         , DANTOC_ID =  @param12         , LOAITHE =  @param13         , SODIENTHOAI =  @param14         , EMAIL =  @param15         , NGHENGHIEP_ID =  @param16         , TINHTRANGHONNHAN_ID =  @param17         , DOITUONG_ID =  @param18         , CMND =  @param19         , NGAYCAPTHE =  @param20         , NAMCAPTHE =  @param21         , NOICAP_ID =  @param22         , NHANVIEN_ID =  @param23         , NHOMMAU_ID =  @param24         , YEUTORH_ID =  @param25         , NHOMBENH_ID =  @param26         , TIENSUDIUNG =  @param27         , TIENSUBENH =  @param28         , GHICHU =  @param29         , KETQUA =  @param30         , XEPLOAI_ID =  @param31         , BSKETLUAN_ID =  @param32         , GOI_ID =  @param33         , IDCHUYEN =  @param34         , DACOPHIEUYEUCAU =  @param35         , DACOKETQUA =  @param36         , NGAYHEN =  @param37         , BENHVIEN_ID =  @param38         , NGAYTAO =  @param39         , NGUOITAO_ID =  @param40         , NGAYCAPNHAT =  @param41         , NGUOICAPNHAT_ID =  @param42         where        HOPDONG_BENHNHAN_ID = '214']
2019-12-10 10:42:09,221 [1] DEBUG - Statement Id: [DAO00307_Update] Parameters: [@param0=[HOPDONG_ID,3], @param1=[TENBENHNHAN,Lê Tuấn Anh], @param2=[GIOITINH,1], @param3=[NGAYSINH,2/19/1990 12:00:00 AM], @param4=[NAMSINH,1990], @param5=[DIACHI,null], @param6=[QUOCTICH_ID,null], @param7=[TINHTHANH_ID,null], @param8=[QUANHUYEN_ID,null], @param9=[XAPHUONG_ID,null], @param10=[DIACHITHUONGTRU,null], @param11=[XAPHUONGTT_ID,null], @param12=[DANTOC_ID,null], @param13=[LOAITHE,null], @param14=[SODIENTHOAI,null], @param15=[EMAIL,null], @param16=[NGHENGHIEP_ID,null], @param17=[TINHTRANGHONNHAN_ID,1578], @param18=[DOITUONG_ID,null], @param19=[CMND,null], @param20=[NGAYCAPTHE,null], @param21=[NAMCAPTHE,null], @param22=[NOICAP_ID,null], @param23=[NHANVIEN_ID,null], @param24=[NHOMMAU_ID,null], @param25=[YEUTORH_ID,null], @param26=[NHOMBENH_ID,null], @param27=[TIENSUDIUNG,null], @param28=[TIENSUBENH,null], @param29=[GHICHU,null], @param30=[KETQUA,null], @param31=[XEPLOAI_ID,null], @param32=[BSKETLUAN_ID,null], @param33=[GOI_ID,3], @param34=[IDCHUYEN,null], @param35=[DACOPHIEUYEUCAU,null], @param36=[DACOKETQUA,null], @param37=[NGAYHEN,null], @param38=[BENHVIEN_ID,HLU01], @param39=[NGAYTAO,12/9/2019 3:16:20 PM], @param40=[NGUOITAO_ID,null], @param41=[NGAYCAPNHAT,12/10/2019 10:42:09 AM], @param42=[NGUOICAPNHAT_ID,1]]
2019-12-10 10:42:09,221 [1] DEBUG - Statement Id: [DAO00307_Update] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String], @param2=[Int64, System.Int64], @param3=[DateTime, System.DateTime], @param4=[Int64, System.Int64], @param5=[System.DBNull, null], @param6=[System.DBNull, null], @param7=[System.DBNull, null], @param8=[System.DBNull, null], @param9=[System.DBNull, null], @param10=[System.DBNull, null], @param11=[System.DBNull, null], @param12=[System.DBNull, null], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[Int64, System.Int64], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[System.DBNull, null], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[Int64, System.Int64], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[DateTime, System.DateTime], @param40=[System.DBNull, null], @param41=[DateTime, System.DateTime], @param42=[Int64, System.Int64]]
2019-12-10 10:42:10,791 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhan] PreparedStatement : [SELECT HD_BN.*, LST.DICTIONARY_NAME AS HONNHAN        , CASE WHEN HD_BN.GIOITINH = '1' THEN N'Nam' ELSE N'Nữ' END AS GENDER        , NV.TENNHANVIEN, GOI.TENGOI        , DT.DICTIONARY_NAME as DOITUONG        , HC.TENDONVI as NOICAP        , ISNULL(HD_BN.DIACHI,'') + ',' + ISNULL(XP.TENDONVI,'') + ',' + ISNULL(QH.TENDONVI,'') + ',' + ISNULL(TP.TENDONVI,'') as DIACHILIENLAC        , CASE WHEN HD_BN.NGAYSINH IS NULL THEN CAST(HD_BN.NAMSINH AS VARCHAR(4)) ELSE CONVERT(VARCHAR(10), HD_BN.NGAYSINH,103) END AS NGAYTHANGNAMSINH        FROM TT_KSK_HOPDONG_BENHNHAN HD_BN        LEFT JOIN TT_KSK_HOPDONG HD ON HD.HOPDONG_ID = HD_BN.HOPDONG_ID        LEFT JOIN LST_DICTIONARY LST ON LST.DICTIONARY_ID = HD_BN.TINHTRANGHONNHAN_ID AND LST.DICTIONARY_TYPE_CODE = 'TinhTrangGiaDinh'        LEFT JOIN TM_NHANVIEN NV ON NV.NHANVIEN_ID = HD_BN.NHANVIEN_ID        LEFT JOIN TM_CSKH_GOI GOI ON GOI.GOI_ID = HD_BN.GOI_ID        LEFT JOIN LST_DICTIONARY DT ON DT.DICTIONARY_ID = HD_BN.DOITUONG_ID AND DT.DICTIONARY_TYPE_CODE = 'DoiTuongKhamSucKhoe'        LEFT JOIN TM_DONVIHANHCHINH HC ON HC.DONVIHANHCHINH_ID = HD_BN.NOICAP_ID        LEFT JOIN TM_DONVIHANHCHINH XP on XP.MADONVI = HD_BN.XAPHUONGTT_ID        LEFT JOIN TM_DONVIHANHCHINH QH on QH.DONVIHANHCHINH_ID = XP.CAPTREN_ID        LEFT JOIN TM_DONVIHANHCHINH TP on TP.DONVIHANHCHINH_ID = QH.CAPTREN_ID         where                 HD_BN.HOPDONG_ID = 3             and               HD_BN.BENHVIEN_ID = 'HLU01'                       ORDER BY HD_BN.STT]
2019-12-10 10:42:17,090 [1] DEBUG - Statement Id: [DAO00308_StatusContract] PreparedStatement : [SELECT * FROM TT_KSK_HOPDONG        WHERE HOPDONG_ID = 3]
2019-12-10 10:42:17,418 [1] DEBUG - Statement Id: [DAO00307_Update] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN set        HOPDONG_ID =  @param0         , TENBENHNHAN =  @param1         , GIOITINH =  @param2         , NGAYSINH =  @param3         , NAMSINH =  @param4         , DIACHI =  @param5         , QUOCTICH_ID =  @param6         , TINHTHANH_ID =  @param7         , QUANHUYEN_ID =  @param8         , XAPHUONG_ID =  @param9         , DIACHITHUONGTRU =  @param10         , XAPHUONGTT_ID =  @param11         , DANTOC_ID =  @param12         , LOAITHE =  @param13         , SODIENTHOAI =  @param14         , EMAIL =  @param15         , NGHENGHIEP_ID =  @param16         , TINHTRANGHONNHAN_ID =  @param17         , DOITUONG_ID =  @param18         , CMND =  @param19         , NGAYCAPTHE =  @param20         , NAMCAPTHE =  @param21         , NOICAP_ID =  @param22         , NHANVIEN_ID =  @param23         , NHOMMAU_ID =  @param24         , YEUTORH_ID =  @param25         , NHOMBENH_ID =  @param26         , TIENSUDIUNG =  @param27         , TIENSUBENH =  @param28         , GHICHU =  @param29         , KETQUA =  @param30         , XEPLOAI_ID =  @param31         , BSKETLUAN_ID =  @param32         , GOI_ID =  @param33         , IDCHUYEN =  @param34         , DACOPHIEUYEUCAU =  @param35         , DACOKETQUA =  @param36         , NGAYHEN =  @param37         , BENHVIEN_ID =  @param38         , NGAYTAO =  @param39         , NGUOITAO_ID =  @param40         , NGAYCAPNHAT =  @param41         , NGUOICAPNHAT_ID =  @param42         where        HOPDONG_BENHNHAN_ID = '215']
2019-12-10 10:42:17,418 [1] DEBUG - Statement Id: [DAO00307_Update] Parameters: [@param0=[HOPDONG_ID,3], @param1=[TENBENHNHAN,Nguyễn Văn Công], @param2=[GIOITINH,1], @param3=[NGAYSINH,2/20/1990 12:00:00 AM], @param4=[NAMSINH,1990], @param5=[DIACHI,null], @param6=[QUOCTICH_ID,null], @param7=[TINHTHANH_ID,null], @param8=[QUANHUYEN_ID,null], @param9=[XAPHUONG_ID,null], @param10=[DIACHITHUONGTRU,null], @param11=[XAPHUONGTT_ID,null], @param12=[DANTOC_ID,null], @param13=[LOAITHE,null], @param14=[SODIENTHOAI,null], @param15=[EMAIL,null], @param16=[NGHENGHIEP_ID,null], @param17=[TINHTRANGHONNHAN_ID,1578], @param18=[DOITUONG_ID,null], @param19=[CMND,null], @param20=[NGAYCAPTHE,null], @param21=[NAMCAPTHE,null], @param22=[NOICAP_ID,null], @param23=[NHANVIEN_ID,null], @param24=[NHOMMAU_ID,null], @param25=[YEUTORH_ID,null], @param26=[NHOMBENH_ID,null], @param27=[TIENSUDIUNG,null], @param28=[TIENSUBENH,null], @param29=[GHICHU,null], @param30=[KETQUA,null], @param31=[XEPLOAI_ID,null], @param32=[BSKETLUAN_ID,null], @param33=[GOI_ID,3], @param34=[IDCHUYEN,null], @param35=[DACOPHIEUYEUCAU,null], @param36=[DACOKETQUA,null], @param37=[NGAYHEN,null], @param38=[BENHVIEN_ID,HLU01], @param39=[NGAYTAO,12/9/2019 3:16:20 PM], @param40=[NGUOITAO_ID,null], @param41=[NGAYCAPNHAT,12/10/2019 10:42:17 AM], @param42=[NGUOICAPNHAT_ID,1]]
2019-12-10 10:42:17,418 [1] DEBUG - Statement Id: [DAO00307_Update] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String], @param2=[Int64, System.Int64], @param3=[DateTime, System.DateTime], @param4=[Int64, System.Int64], @param5=[System.DBNull, null], @param6=[System.DBNull, null], @param7=[System.DBNull, null], @param8=[System.DBNull, null], @param9=[System.DBNull, null], @param10=[System.DBNull, null], @param11=[System.DBNull, null], @param12=[System.DBNull, null], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[Int64, System.Int64], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[System.DBNull, null], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[Int64, System.Int64], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[DateTime, System.DateTime], @param40=[System.DBNull, null], @param41=[DateTime, System.DateTime], @param42=[Int64, System.Int64]]
2019-12-10 10:42:17,647 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhan] PreparedStatement : [SELECT HD_BN.*, LST.DICTIONARY_NAME AS HONNHAN        , CASE WHEN HD_BN.GIOITINH = '1' THEN N'Nam' ELSE N'Nữ' END AS GENDER        , NV.TENNHANVIEN, GOI.TENGOI        , DT.DICTIONARY_NAME as DOITUONG        , HC.TENDONVI as NOICAP        , ISNULL(HD_BN.DIACHI,'') + ',' + ISNULL(XP.TENDONVI,'') + ',' + ISNULL(QH.TENDONVI,'') + ',' + ISNULL(TP.TENDONVI,'') as DIACHILIENLAC        , CASE WHEN HD_BN.NGAYSINH IS NULL THEN CAST(HD_BN.NAMSINH AS VARCHAR(4)) ELSE CONVERT(VARCHAR(10), HD_BN.NGAYSINH,103) END AS NGAYTHANGNAMSINH        FROM TT_KSK_HOPDONG_BENHNHAN HD_BN        LEFT JOIN TT_KSK_HOPDONG HD ON HD.HOPDONG_ID = HD_BN.HOPDONG_ID        LEFT JOIN LST_DICTIONARY LST ON LST.DICTIONARY_ID = HD_BN.TINHTRANGHONNHAN_ID AND LST.DICTIONARY_TYPE_CODE = 'TinhTrangGiaDinh'        LEFT JOIN TM_NHANVIEN NV ON NV.NHANVIEN_ID = HD_BN.NHANVIEN_ID        LEFT JOIN TM_CSKH_GOI GOI ON GOI.GOI_ID = HD_BN.GOI_ID        LEFT JOIN LST_DICTIONARY DT ON DT.DICTIONARY_ID = HD_BN.DOITUONG_ID AND DT.DICTIONARY_TYPE_CODE = 'DoiTuongKhamSucKhoe'        LEFT JOIN TM_DONVIHANHCHINH HC ON HC.DONVIHANHCHINH_ID = HD_BN.NOICAP_ID        LEFT JOIN TM_DONVIHANHCHINH XP on XP.MADONVI = HD_BN.XAPHUONGTT_ID        LEFT JOIN TM_DONVIHANHCHINH QH on QH.DONVIHANHCHINH_ID = XP.CAPTREN_ID        LEFT JOIN TM_DONVIHANHCHINH TP on TP.DONVIHANHCHINH_ID = QH.CAPTREN_ID         where                 HD_BN.HOPDONG_ID = 3             and               HD_BN.BENHVIEN_ID = 'HLU01'                       ORDER BY HD_BN.STT]
2019-12-10 10:42:21,392 [1] DEBUG - Statement Id: [DAO00308_StatusContract] PreparedStatement : [SELECT * FROM TT_KSK_HOPDONG        WHERE HOPDONG_ID = 3]
2019-12-10 10:42:21,489 [1] DEBUG - Statement Id: [DAO00307_Update] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN set        HOPDONG_ID =  @param0         , TENBENHNHAN =  @param1         , GIOITINH =  @param2         , NGAYSINH =  @param3         , NAMSINH =  @param4         , DIACHI =  @param5         , QUOCTICH_ID =  @param6         , TINHTHANH_ID =  @param7         , QUANHUYEN_ID =  @param8         , XAPHUONG_ID =  @param9         , DIACHITHUONGTRU =  @param10         , XAPHUONGTT_ID =  @param11         , DANTOC_ID =  @param12         , LOAITHE =  @param13         , SODIENTHOAI =  @param14         , EMAIL =  @param15         , NGHENGHIEP_ID =  @param16         , TINHTRANGHONNHAN_ID =  @param17         , DOITUONG_ID =  @param18         , CMND =  @param19         , NGAYCAPTHE =  @param20         , NAMCAPTHE =  @param21         , NOICAP_ID =  @param22         , NHANVIEN_ID =  @param23         , NHOMMAU_ID =  @param24         , YEUTORH_ID =  @param25         , NHOMBENH_ID =  @param26         , TIENSUDIUNG =  @param27         , TIENSUBENH =  @param28         , GHICHU =  @param29         , KETQUA =  @param30         , XEPLOAI_ID =  @param31         , BSKETLUAN_ID =  @param32         , GOI_ID =  @param33         , IDCHUYEN =  @param34         , DACOPHIEUYEUCAU =  @param35         , DACOKETQUA =  @param36         , NGAYHEN =  @param37         , BENHVIEN_ID =  @param38         , NGAYTAO =  @param39         , NGUOITAO_ID =  @param40         , NGAYCAPNHAT =  @param41         , NGUOICAPNHAT_ID =  @param42         where        HOPDONG_BENHNHAN_ID = '216']
2019-12-10 10:42:21,489 [1] DEBUG - Statement Id: [DAO00307_Update] Parameters: [@param0=[HOPDONG_ID,3], @param1=[TENBENHNHAN,Nguyễn Thị Tuyết Mai], @param2=[GIOITINH,2], @param3=[NGAYSINH,2/21/1990 12:00:00 AM], @param4=[NAMSINH,1990], @param5=[DIACHI,null], @param6=[QUOCTICH_ID,null], @param7=[TINHTHANH_ID,null], @param8=[QUANHUYEN_ID,null], @param9=[XAPHUONG_ID,null], @param10=[DIACHITHUONGTRU,null], @param11=[XAPHUONGTT_ID,null], @param12=[DANTOC_ID,null], @param13=[LOAITHE,null], @param14=[SODIENTHOAI,null], @param15=[EMAIL,null], @param16=[NGHENGHIEP_ID,null], @param17=[TINHTRANGHONNHAN_ID,1578], @param18=[DOITUONG_ID,null], @param19=[CMND,null], @param20=[NGAYCAPTHE,null], @param21=[NAMCAPTHE,null], @param22=[NOICAP_ID,null], @param23=[NHANVIEN_ID,null], @param24=[NHOMMAU_ID,null], @param25=[YEUTORH_ID,null], @param26=[NHOMBENH_ID,null], @param27=[TIENSUDIUNG,null], @param28=[TIENSUBENH,null], @param29=[GHICHU,null], @param30=[KETQUA,null], @param31=[XEPLOAI_ID,null], @param32=[BSKETLUAN_ID,null], @param33=[GOI_ID,3], @param34=[IDCHUYEN,null], @param35=[DACOPHIEUYEUCAU,null], @param36=[DACOKETQUA,null], @param37=[NGAYHEN,null], @param38=[BENHVIEN_ID,HLU01], @param39=[NGAYTAO,12/9/2019 3:16:20 PM], @param40=[NGUOITAO_ID,null], @param41=[NGAYCAPNHAT,12/10/2019 10:42:21 AM], @param42=[NGUOICAPNHAT_ID,1]]
2019-12-10 10:42:21,489 [1] DEBUG - Statement Id: [DAO00307_Update] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String], @param2=[Int64, System.Int64], @param3=[DateTime, System.DateTime], @param4=[Int64, System.Int64], @param5=[System.DBNull, null], @param6=[System.DBNull, null], @param7=[System.DBNull, null], @param8=[System.DBNull, null], @param9=[System.DBNull, null], @param10=[System.DBNull, null], @param11=[System.DBNull, null], @param12=[System.DBNull, null], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[Int64, System.Int64], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[System.DBNull, null], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[Int64, System.Int64], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[DateTime, System.DateTime], @param40=[System.DBNull, null], @param41=[DateTime, System.DateTime], @param42=[Int64, System.Int64]]
2019-12-10 10:42:22,400 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhan] PreparedStatement : [SELECT HD_BN.*, LST.DICTIONARY_NAME AS HONNHAN        , CASE WHEN HD_BN.GIOITINH = '1' THEN N'Nam' ELSE N'Nữ' END AS GENDER        , NV.TENNHANVIEN, GOI.TENGOI        , DT.DICTIONARY_NAME as DOITUONG        , HC.TENDONVI as NOICAP        , ISNULL(HD_BN.DIACHI,'') + ',' + ISNULL(XP.TENDONVI,'') + ',' + ISNULL(QH.TENDONVI,'') + ',' + ISNULL(TP.TENDONVI,'') as DIACHILIENLAC        , CASE WHEN HD_BN.NGAYSINH IS NULL THEN CAST(HD_BN.NAMSINH AS VARCHAR(4)) ELSE CONVERT(VARCHAR(10), HD_BN.NGAYSINH,103) END AS NGAYTHANGNAMSINH        FROM TT_KSK_HOPDONG_BENHNHAN HD_BN        LEFT JOIN TT_KSK_HOPDONG HD ON HD.HOPDONG_ID = HD_BN.HOPDONG_ID        LEFT JOIN LST_DICTIONARY LST ON LST.DICTIONARY_ID = HD_BN.TINHTRANGHONNHAN_ID AND LST.DICTIONARY_TYPE_CODE = 'TinhTrangGiaDinh'        LEFT JOIN TM_NHANVIEN NV ON NV.NHANVIEN_ID = HD_BN.NHANVIEN_ID        LEFT JOIN TM_CSKH_GOI GOI ON GOI.GOI_ID = HD_BN.GOI_ID        LEFT JOIN LST_DICTIONARY DT ON DT.DICTIONARY_ID = HD_BN.DOITUONG_ID AND DT.DICTIONARY_TYPE_CODE = 'DoiTuongKhamSucKhoe'        LEFT JOIN TM_DONVIHANHCHINH HC ON HC.DONVIHANHCHINH_ID = HD_BN.NOICAP_ID        LEFT JOIN TM_DONVIHANHCHINH XP on XP.MADONVI = HD_BN.XAPHUONGTT_ID        LEFT JOIN TM_DONVIHANHCHINH QH on QH.DONVIHANHCHINH_ID = XP.CAPTREN_ID        LEFT JOIN TM_DONVIHANHCHINH TP on TP.DONVIHANHCHINH_ID = QH.CAPTREN_ID         where                 HD_BN.HOPDONG_ID = 3             and               HD_BN.BENHVIEN_ID = 'HLU01'                       ORDER BY HD_BN.STT]
2019-12-10 10:42:29,146 [1] DEBUG - Statement Id: [DAO00308_StatusContract] PreparedStatement : [SELECT * FROM TT_KSK_HOPDONG        WHERE HOPDONG_ID = 3]
2019-12-10 10:42:29,311 [1] DEBUG - Statement Id: [DAO00307_Update] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN set        HOPDONG_ID =  @param0         , TENBENHNHAN =  @param1         , GIOITINH =  @param2         , NGAYSINH =  @param3         , NAMSINH =  @param4         , DIACHI =  @param5         , QUOCTICH_ID =  @param6         , TINHTHANH_ID =  @param7         , QUANHUYEN_ID =  @param8         , XAPHUONG_ID =  @param9         , DIACHITHUONGTRU =  @param10         , XAPHUONGTT_ID =  @param11         , DANTOC_ID =  @param12         , LOAITHE =  @param13         , SODIENTHOAI =  @param14         , EMAIL =  @param15         , NGHENGHIEP_ID =  @param16         , TINHTRANGHONNHAN_ID =  @param17         , DOITUONG_ID =  @param18         , CMND =  @param19         , NGAYCAPTHE =  @param20         , NAMCAPTHE =  @param21         , NOICAP_ID =  @param22         , NHANVIEN_ID =  @param23         , NHOMMAU_ID =  @param24         , YEUTORH_ID =  @param25         , NHOMBENH_ID =  @param26         , TIENSUDIUNG =  @param27         , TIENSUBENH =  @param28         , GHICHU =  @param29         , KETQUA =  @param30         , XEPLOAI_ID =  @param31         , BSKETLUAN_ID =  @param32         , GOI_ID =  @param33         , IDCHUYEN =  @param34         , DACOPHIEUYEUCAU =  @param35         , DACOKETQUA =  @param36         , NGAYHEN =  @param37         , BENHVIEN_ID =  @param38         , NGAYTAO =  @param39         , NGUOITAO_ID =  @param40         , NGAYCAPNHAT =  @param41         , NGUOICAPNHAT_ID =  @param42         where        HOPDONG_BENHNHAN_ID = '217']
2019-12-10 10:42:29,311 [1] DEBUG - Statement Id: [DAO00307_Update] Parameters: [@param0=[HOPDONG_ID,3], @param1=[TENBENHNHAN,Trương Quỳnh Anh], @param2=[GIOITINH,2], @param3=[NGAYSINH,3/22/1992 12:00:00 AM], @param4=[NAMSINH,1992], @param5=[DIACHI,null], @param6=[QUOCTICH_ID,null], @param7=[TINHTHANH_ID,null], @param8=[QUANHUYEN_ID,null], @param9=[XAPHUONG_ID,null], @param10=[DIACHITHUONGTRU,null], @param11=[XAPHUONGTT_ID,null], @param12=[DANTOC_ID,null], @param13=[LOAITHE,null], @param14=[SODIENTHOAI,null], @param15=[EMAIL,null], @param16=[NGHENGHIEP_ID,null], @param17=[TINHTRANGHONNHAN_ID,1578], @param18=[DOITUONG_ID,null], @param19=[CMND,null], @param20=[NGAYCAPTHE,null], @param21=[NAMCAPTHE,null], @param22=[NOICAP_ID,null], @param23=[NHANVIEN_ID,null], @param24=[NHOMMAU_ID,null], @param25=[YEUTORH_ID,null], @param26=[NHOMBENH_ID,null], @param27=[TIENSUDIUNG,null], @param28=[TIENSUBENH,null], @param29=[GHICHU,null], @param30=[KETQUA,null], @param31=[XEPLOAI_ID,null], @param32=[BSKETLUAN_ID,null], @param33=[GOI_ID,3], @param34=[IDCHUYEN,null], @param35=[DACOPHIEUYEUCAU,null], @param36=[DACOKETQUA,null], @param37=[NGAYHEN,null], @param38=[BENHVIEN_ID,HLU01], @param39=[NGAYTAO,12/9/2019 3:16:20 PM], @param40=[NGUOITAO_ID,null], @param41=[NGAYCAPNHAT,12/10/2019 10:42:29 AM], @param42=[NGUOICAPNHAT_ID,1]]
2019-12-10 10:42:29,311 [1] DEBUG - Statement Id: [DAO00307_Update] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String], @param2=[Int64, System.Int64], @param3=[DateTime, System.DateTime], @param4=[Int64, System.Int64], @param5=[System.DBNull, null], @param6=[System.DBNull, null], @param7=[System.DBNull, null], @param8=[System.DBNull, null], @param9=[System.DBNull, null], @param10=[System.DBNull, null], @param11=[System.DBNull, null], @param12=[System.DBNull, null], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[Int64, System.Int64], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[System.DBNull, null], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[Int64, System.Int64], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[DateTime, System.DateTime], @param40=[System.DBNull, null], @param41=[DateTime, System.DateTime], @param42=[Int64, System.Int64]]
2019-12-10 10:42:29,612 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhan] PreparedStatement : [SELECT HD_BN.*, LST.DICTIONARY_NAME AS HONNHAN        , CASE WHEN HD_BN.GIOITINH = '1' THEN N'Nam' ELSE N'Nữ' END AS GENDER        , NV.TENNHANVIEN, GOI.TENGOI        , DT.DICTIONARY_NAME as DOITUONG        , HC.TENDONVI as NOICAP        , ISNULL(HD_BN.DIACHI,'') + ',' + ISNULL(XP.TENDONVI,'') + ',' + ISNULL(QH.TENDONVI,'') + ',' + ISNULL(TP.TENDONVI,'') as DIACHILIENLAC        , CASE WHEN HD_BN.NGAYSINH IS NULL THEN CAST(HD_BN.NAMSINH AS VARCHAR(4)) ELSE CONVERT(VARCHAR(10), HD_BN.NGAYSINH,103) END AS NGAYTHANGNAMSINH        FROM TT_KSK_HOPDONG_BENHNHAN HD_BN        LEFT JOIN TT_KSK_HOPDONG HD ON HD.HOPDONG_ID = HD_BN.HOPDONG_ID        LEFT JOIN LST_DICTIONARY LST ON LST.DICTIONARY_ID = HD_BN.TINHTRANGHONNHAN_ID AND LST.DICTIONARY_TYPE_CODE = 'TinhTrangGiaDinh'        LEFT JOIN TM_NHANVIEN NV ON NV.NHANVIEN_ID = HD_BN.NHANVIEN_ID        LEFT JOIN TM_CSKH_GOI GOI ON GOI.GOI_ID = HD_BN.GOI_ID        LEFT JOIN LST_DICTIONARY DT ON DT.DICTIONARY_ID = HD_BN.DOITUONG_ID AND DT.DICTIONARY_TYPE_CODE = 'DoiTuongKhamSucKhoe'        LEFT JOIN TM_DONVIHANHCHINH HC ON HC.DONVIHANHCHINH_ID = HD_BN.NOICAP_ID        LEFT JOIN TM_DONVIHANHCHINH XP on XP.MADONVI = HD_BN.XAPHUONGTT_ID        LEFT JOIN TM_DONVIHANHCHINH QH on QH.DONVIHANHCHINH_ID = XP.CAPTREN_ID        LEFT JOIN TM_DONVIHANHCHINH TP on TP.DONVIHANHCHINH_ID = QH.CAPTREN_ID         where                 HD_BN.HOPDONG_ID = 3             and               HD_BN.BENHVIEN_ID = 'HLU01'                       ORDER BY HD_BN.STT]
2019-12-10 10:42:35,237 [1] DEBUG - Statement Id: [DAO00308_StatusContract] PreparedStatement : [SELECT * FROM TT_KSK_HOPDONG        WHERE HOPDONG_ID = 3]
2019-12-10 10:42:35,337 [1] DEBUG - Statement Id: [DAO00307_Update] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN set        HOPDONG_ID =  @param0         , TENBENHNHAN =  @param1         , GIOITINH =  @param2         , NGAYSINH =  @param3         , NAMSINH =  @param4         , DIACHI =  @param5         , QUOCTICH_ID =  @param6         , TINHTHANH_ID =  @param7         , QUANHUYEN_ID =  @param8         , XAPHUONG_ID =  @param9         , DIACHITHUONGTRU =  @param10         , XAPHUONGTT_ID =  @param11         , DANTOC_ID =  @param12         , LOAITHE =  @param13         , SODIENTHOAI =  @param14         , EMAIL =  @param15         , NGHENGHIEP_ID =  @param16         , TINHTRANGHONNHAN_ID =  @param17         , DOITUONG_ID =  @param18         , CMND =  @param19         , NGAYCAPTHE =  @param20         , NAMCAPTHE =  @param21         , NOICAP_ID =  @param22         , NHANVIEN_ID =  @param23         , NHOMMAU_ID =  @param24         , YEUTORH_ID =  @param25         , NHOMBENH_ID =  @param26         , TIENSUDIUNG =  @param27         , TIENSUBENH =  @param28         , GHICHU =  @param29         , KETQUA =  @param30         , XEPLOAI_ID =  @param31         , BSKETLUAN_ID =  @param32         , GOI_ID =  @param33         , IDCHUYEN =  @param34         , DACOPHIEUYEUCAU =  @param35         , DACOKETQUA =  @param36         , NGAYHEN =  @param37         , BENHVIEN_ID =  @param38         , NGAYTAO =  @param39         , NGUOITAO_ID =  @param40         , NGAYCAPNHAT =  @param41         , NGUOICAPNHAT_ID =  @param42         where        HOPDONG_BENHNHAN_ID = '218']
2019-12-10 10:42:35,337 [1] DEBUG - Statement Id: [DAO00307_Update] Parameters: [@param0=[HOPDONG_ID,3], @param1=[TENBENHNHAN,Văn Huy Mạnh], @param2=[GIOITINH,1], @param3=[NGAYSINH,3/23/1992 12:00:00 AM], @param4=[NAMSINH,1992], @param5=[DIACHI,null], @param6=[QUOCTICH_ID,null], @param7=[TINHTHANH_ID,null], @param8=[QUANHUYEN_ID,null], @param9=[XAPHUONG_ID,null], @param10=[DIACHITHUONGTRU,null], @param11=[XAPHUONGTT_ID,null], @param12=[DANTOC_ID,null], @param13=[LOAITHE,null], @param14=[SODIENTHOAI,null], @param15=[EMAIL,null], @param16=[NGHENGHIEP_ID,null], @param17=[TINHTRANGHONNHAN_ID,1578], @param18=[DOITUONG_ID,null], @param19=[CMND,null], @param20=[NGAYCAPTHE,null], @param21=[NAMCAPTHE,null], @param22=[NOICAP_ID,null], @param23=[NHANVIEN_ID,null], @param24=[NHOMMAU_ID,null], @param25=[YEUTORH_ID,null], @param26=[NHOMBENH_ID,null], @param27=[TIENSUDIUNG,null], @param28=[TIENSUBENH,null], @param29=[GHICHU,null], @param30=[KETQUA,null], @param31=[XEPLOAI_ID,null], @param32=[BSKETLUAN_ID,null], @param33=[GOI_ID,3], @param34=[IDCHUYEN,null], @param35=[DACOPHIEUYEUCAU,null], @param36=[DACOKETQUA,null], @param37=[NGAYHEN,null], @param38=[BENHVIEN_ID,HLU01], @param39=[NGAYTAO,12/9/2019 3:16:20 PM], @param40=[NGUOITAO_ID,null], @param41=[NGAYCAPNHAT,12/10/2019 10:42:35 AM], @param42=[NGUOICAPNHAT_ID,1]]
2019-12-10 10:42:35,337 [1] DEBUG - Statement Id: [DAO00307_Update] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String], @param2=[Int64, System.Int64], @param3=[DateTime, System.DateTime], @param4=[Int64, System.Int64], @param5=[System.DBNull, null], @param6=[System.DBNull, null], @param7=[System.DBNull, null], @param8=[System.DBNull, null], @param9=[System.DBNull, null], @param10=[System.DBNull, null], @param11=[System.DBNull, null], @param12=[System.DBNull, null], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[Int64, System.Int64], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[System.DBNull, null], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[Int64, System.Int64], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[DateTime, System.DateTime], @param40=[System.DBNull, null], @param41=[DateTime, System.DateTime], @param42=[Int64, System.Int64]]
2019-12-10 10:42:35,583 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhan] PreparedStatement : [SELECT HD_BN.*, LST.DICTIONARY_NAME AS HONNHAN        , CASE WHEN HD_BN.GIOITINH = '1' THEN N'Nam' ELSE N'Nữ' END AS GENDER        , NV.TENNHANVIEN, GOI.TENGOI        , DT.DICTIONARY_NAME as DOITUONG        , HC.TENDONVI as NOICAP        , ISNULL(HD_BN.DIACHI,'') + ',' + ISNULL(XP.TENDONVI,'') + ',' + ISNULL(QH.TENDONVI,'') + ',' + ISNULL(TP.TENDONVI,'') as DIACHILIENLAC        , CASE WHEN HD_BN.NGAYSINH IS NULL THEN CAST(HD_BN.NAMSINH AS VARCHAR(4)) ELSE CONVERT(VARCHAR(10), HD_BN.NGAYSINH,103) END AS NGAYTHANGNAMSINH        FROM TT_KSK_HOPDONG_BENHNHAN HD_BN        LEFT JOIN TT_KSK_HOPDONG HD ON HD.HOPDONG_ID = HD_BN.HOPDONG_ID        LEFT JOIN LST_DICTIONARY LST ON LST.DICTIONARY_ID = HD_BN.TINHTRANGHONNHAN_ID AND LST.DICTIONARY_TYPE_CODE = 'TinhTrangGiaDinh'        LEFT JOIN TM_NHANVIEN NV ON NV.NHANVIEN_ID = HD_BN.NHANVIEN_ID        LEFT JOIN TM_CSKH_GOI GOI ON GOI.GOI_ID = HD_BN.GOI_ID        LEFT JOIN LST_DICTIONARY DT ON DT.DICTIONARY_ID = HD_BN.DOITUONG_ID AND DT.DICTIONARY_TYPE_CODE = 'DoiTuongKhamSucKhoe'        LEFT JOIN TM_DONVIHANHCHINH HC ON HC.DONVIHANHCHINH_ID = HD_BN.NOICAP_ID        LEFT JOIN TM_DONVIHANHCHINH XP on XP.MADONVI = HD_BN.XAPHUONGTT_ID        LEFT JOIN TM_DONVIHANHCHINH QH on QH.DONVIHANHCHINH_ID = XP.CAPTREN_ID        LEFT JOIN TM_DONVIHANHCHINH TP on TP.DONVIHANHCHINH_ID = QH.CAPTREN_ID         where                 HD_BN.HOPDONG_ID = 3             and               HD_BN.BENHVIEN_ID = 'HLU01'                       ORDER BY HD_BN.STT]
2019-12-10 10:42:45,723 [1] DEBUG - Statement Id: [DAO00308_StatusContract] PreparedStatement : [SELECT * FROM TT_KSK_HOPDONG        WHERE HOPDONG_ID = 3]
2019-12-10 10:42:45,814 [1] DEBUG - Statement Id: [DAO00307_Update] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN set        HOPDONG_ID =  @param0         , TENBENHNHAN =  @param1         , GIOITINH =  @param2         , NGAYSINH =  @param3         , NAMSINH =  @param4         , DIACHI =  @param5         , QUOCTICH_ID =  @param6         , TINHTHANH_ID =  @param7         , QUANHUYEN_ID =  @param8         , XAPHUONG_ID =  @param9         , DIACHITHUONGTRU =  @param10         , XAPHUONGTT_ID =  @param11         , DANTOC_ID =  @param12         , LOAITHE =  @param13         , SODIENTHOAI =  @param14         , EMAIL =  @param15         , NGHENGHIEP_ID =  @param16         , TINHTRANGHONNHAN_ID =  @param17         , DOITUONG_ID =  @param18         , CMND =  @param19         , NGAYCAPTHE =  @param20         , NAMCAPTHE =  @param21         , NOICAP_ID =  @param22         , NHANVIEN_ID =  @param23         , NHOMMAU_ID =  @param24         , YEUTORH_ID =  @param25         , NHOMBENH_ID =  @param26         , TIENSUDIUNG =  @param27         , TIENSUBENH =  @param28         , GHICHU =  @param29         , KETQUA =  @param30         , XEPLOAI_ID =  @param31         , BSKETLUAN_ID =  @param32         , GOI_ID =  @param33         , IDCHUYEN =  @param34         , DACOPHIEUYEUCAU =  @param35         , DACOKETQUA =  @param36         , NGAYHEN =  @param37         , BENHVIEN_ID =  @param38         , NGAYTAO =  @param39         , NGUOITAO_ID =  @param40         , NGAYCAPNHAT =  @param41         , NGUOICAPNHAT_ID =  @param42         where        HOPDONG_BENHNHAN_ID = '219']
2019-12-10 10:42:45,815 [1] DEBUG - Statement Id: [DAO00307_Update] Parameters: [@param0=[HOPDONG_ID,3], @param1=[TENBENHNHAN,Cao Tùng Anh], @param2=[GIOITINH,1], @param3=[NGAYSINH,3/24/1992 12:00:00 AM], @param4=[NAMSINH,1992], @param5=[DIACHI,null], @param6=[QUOCTICH_ID,null], @param7=[TINHTHANH_ID,null], @param8=[QUANHUYEN_ID,null], @param9=[XAPHUONG_ID,null], @param10=[DIACHITHUONGTRU,null], @param11=[XAPHUONGTT_ID,null], @param12=[DANTOC_ID,null], @param13=[LOAITHE,null], @param14=[SODIENTHOAI,null], @param15=[EMAIL,null], @param16=[NGHENGHIEP_ID,null], @param17=[TINHTRANGHONNHAN_ID,1578], @param18=[DOITUONG_ID,null], @param19=[CMND,null], @param20=[NGAYCAPTHE,null], @param21=[NAMCAPTHE,null], @param22=[NOICAP_ID,null], @param23=[NHANVIEN_ID,null], @param24=[NHOMMAU_ID,null], @param25=[YEUTORH_ID,null], @param26=[NHOMBENH_ID,null], @param27=[TIENSUDIUNG,null], @param28=[TIENSUBENH,null], @param29=[GHICHU,null], @param30=[KETQUA,null], @param31=[XEPLOAI_ID,null], @param32=[BSKETLUAN_ID,null], @param33=[GOI_ID,3], @param34=[IDCHUYEN,null], @param35=[DACOPHIEUYEUCAU,null], @param36=[DACOKETQUA,null], @param37=[NGAYHEN,null], @param38=[BENHVIEN_ID,HLU01], @param39=[NGAYTAO,12/9/2019 3:16:20 PM], @param40=[NGUOITAO_ID,null], @param41=[NGAYCAPNHAT,12/10/2019 10:42:45 AM], @param42=[NGUOICAPNHAT_ID,1]]
2019-12-10 10:42:45,815 [1] DEBUG - Statement Id: [DAO00307_Update] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String], @param2=[Int64, System.Int64], @param3=[DateTime, System.DateTime], @param4=[Int64, System.Int64], @param5=[System.DBNull, null], @param6=[System.DBNull, null], @param7=[System.DBNull, null], @param8=[System.DBNull, null], @param9=[System.DBNull, null], @param10=[System.DBNull, null], @param11=[System.DBNull, null], @param12=[System.DBNull, null], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[Int64, System.Int64], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[System.DBNull, null], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[Int64, System.Int64], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[DateTime, System.DateTime], @param40=[System.DBNull, null], @param41=[DateTime, System.DateTime], @param42=[Int64, System.Int64]]
2019-12-10 10:42:46,053 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhan] PreparedStatement : [SELECT HD_BN.*, LST.DICTIONARY_NAME AS HONNHAN        , CASE WHEN HD_BN.GIOITINH = '1' THEN N'Nam' ELSE N'Nữ' END AS GENDER        , NV.TENNHANVIEN, GOI.TENGOI        , DT.DICTIONARY_NAME as DOITUONG        , HC.TENDONVI as NOICAP        , ISNULL(HD_BN.DIACHI,'') + ',' + ISNULL(XP.TENDONVI,'') + ',' + ISNULL(QH.TENDONVI,'') + ',' + ISNULL(TP.TENDONVI,'') as DIACHILIENLAC        , CASE WHEN HD_BN.NGAYSINH IS NULL THEN CAST(HD_BN.NAMSINH AS VARCHAR(4)) ELSE CONVERT(VARCHAR(10), HD_BN.NGAYSINH,103) END AS NGAYTHANGNAMSINH        FROM TT_KSK_HOPDONG_BENHNHAN HD_BN        LEFT JOIN TT_KSK_HOPDONG HD ON HD.HOPDONG_ID = HD_BN.HOPDONG_ID        LEFT JOIN LST_DICTIONARY LST ON LST.DICTIONARY_ID = HD_BN.TINHTRANGHONNHAN_ID AND LST.DICTIONARY_TYPE_CODE = 'TinhTrangGiaDinh'        LEFT JOIN TM_NHANVIEN NV ON NV.NHANVIEN_ID = HD_BN.NHANVIEN_ID        LEFT JOIN TM_CSKH_GOI GOI ON GOI.GOI_ID = HD_BN.GOI_ID        LEFT JOIN LST_DICTIONARY DT ON DT.DICTIONARY_ID = HD_BN.DOITUONG_ID AND DT.DICTIONARY_TYPE_CODE = 'DoiTuongKhamSucKhoe'        LEFT JOIN TM_DONVIHANHCHINH HC ON HC.DONVIHANHCHINH_ID = HD_BN.NOICAP_ID        LEFT JOIN TM_DONVIHANHCHINH XP on XP.MADONVI = HD_BN.XAPHUONGTT_ID        LEFT JOIN TM_DONVIHANHCHINH QH on QH.DONVIHANHCHINH_ID = XP.CAPTREN_ID        LEFT JOIN TM_DONVIHANHCHINH TP on TP.DONVIHANHCHINH_ID = QH.CAPTREN_ID         where                 HD_BN.HOPDONG_ID = 3             and               HD_BN.BENHVIEN_ID = 'HLU01'                       ORDER BY HD_BN.STT]
2019-12-10 10:43:02,668 [1] DEBUG - Statement Id: [DAO00308_StatusContract] PreparedStatement : [SELECT * FROM TT_KSK_HOPDONG        WHERE HOPDONG_ID = 3]
2019-12-10 10:43:02,758 [1] DEBUG - Statement Id: [DAO00307_Update] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN set        HOPDONG_ID =  @param0         , TENBENHNHAN =  @param1         , GIOITINH =  @param2         , NGAYSINH =  @param3         , NAMSINH =  @param4         , DIACHI =  @param5         , QUOCTICH_ID =  @param6         , TINHTHANH_ID =  @param7         , QUANHUYEN_ID =  @param8         , XAPHUONG_ID =  @param9         , DIACHITHUONGTRU =  @param10         , XAPHUONGTT_ID =  @param11         , DANTOC_ID =  @param12         , LOAITHE =  @param13         , SODIENTHOAI =  @param14         , EMAIL =  @param15         , NGHENGHIEP_ID =  @param16         , TINHTRANGHONNHAN_ID =  @param17         , DOITUONG_ID =  @param18         , CMND =  @param19         , NGAYCAPTHE =  @param20         , NAMCAPTHE =  @param21         , NOICAP_ID =  @param22         , NHANVIEN_ID =  @param23         , NHOMMAU_ID =  @param24         , YEUTORH_ID =  @param25         , NHOMBENH_ID =  @param26         , TIENSUDIUNG =  @param27         , TIENSUBENH =  @param28         , GHICHU =  @param29         , KETQUA =  @param30         , XEPLOAI_ID =  @param31         , BSKETLUAN_ID =  @param32         , GOI_ID =  @param33         , IDCHUYEN =  @param34         , DACOPHIEUYEUCAU =  @param35         , DACOKETQUA =  @param36         , NGAYHEN =  @param37         , BENHVIEN_ID =  @param38         , NGAYTAO =  @param39         , NGUOITAO_ID =  @param40         , NGAYCAPNHAT =  @param41         , NGUOICAPNHAT_ID =  @param42         where        HOPDONG_BENHNHAN_ID = '220']
2019-12-10 10:43:02,758 [1] DEBUG - Statement Id: [DAO00307_Update] Parameters: [@param0=[HOPDONG_ID,3], @param1=[TENBENHNHAN,Văn Mai Hương], @param2=[GIOITINH,2], @param3=[NGAYSINH,3/25/1992 12:00:00 AM], @param4=[NAMSINH,1992], @param5=[DIACHI,null], @param6=[QUOCTICH_ID,null], @param7=[TINHTHANH_ID,null], @param8=[QUANHUYEN_ID,null], @param9=[XAPHUONG_ID,null], @param10=[DIACHITHUONGTRU,null], @param11=[XAPHUONGTT_ID,null], @param12=[DANTOC_ID,null], @param13=[LOAITHE,null], @param14=[SODIENTHOAI,null], @param15=[EMAIL,null], @param16=[NGHENGHIEP_ID,null], @param17=[TINHTRANGHONNHAN_ID,1578], @param18=[DOITUONG_ID,null], @param19=[CMND,null], @param20=[NGAYCAPTHE,null], @param21=[NAMCAPTHE,null], @param22=[NOICAP_ID,null], @param23=[NHANVIEN_ID,null], @param24=[NHOMMAU_ID,null], @param25=[YEUTORH_ID,null], @param26=[NHOMBENH_ID,null], @param27=[TIENSUDIUNG,null], @param28=[TIENSUBENH,null], @param29=[GHICHU,null], @param30=[KETQUA,null], @param31=[XEPLOAI_ID,null], @param32=[BSKETLUAN_ID,null], @param33=[GOI_ID,3], @param34=[IDCHUYEN,null], @param35=[DACOPHIEUYEUCAU,null], @param36=[DACOKETQUA,null], @param37=[NGAYHEN,null], @param38=[BENHVIEN_ID,HLU01], @param39=[NGAYTAO,12/9/2019 3:16:20 PM], @param40=[NGUOITAO_ID,null], @param41=[NGAYCAPNHAT,12/10/2019 10:43:02 AM], @param42=[NGUOICAPNHAT_ID,1]]
2019-12-10 10:43:02,758 [1] DEBUG - Statement Id: [DAO00307_Update] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String], @param2=[Int64, System.Int64], @param3=[DateTime, System.DateTime], @param4=[Int64, System.Int64], @param5=[System.DBNull, null], @param6=[System.DBNull, null], @param7=[System.DBNull, null], @param8=[System.DBNull, null], @param9=[System.DBNull, null], @param10=[System.DBNull, null], @param11=[System.DBNull, null], @param12=[System.DBNull, null], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[Int64, System.Int64], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[System.DBNull, null], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[Int64, System.Int64], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[DateTime, System.DateTime], @param40=[System.DBNull, null], @param41=[DateTime, System.DateTime], @param42=[Int64, System.Int64]]
2019-12-10 10:43:02,977 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhan] PreparedStatement : [SELECT HD_BN.*, LST.DICTIONARY_NAME AS HONNHAN        , CASE WHEN HD_BN.GIOITINH = '1' THEN N'Nam' ELSE N'Nữ' END AS GENDER        , NV.TENNHANVIEN, GOI.TENGOI        , DT.DICTIONARY_NAME as DOITUONG        , HC.TENDONVI as NOICAP        , ISNULL(HD_BN.DIACHI,'') + ',' + ISNULL(XP.TENDONVI,'') + ',' + ISNULL(QH.TENDONVI,'') + ',' + ISNULL(TP.TENDONVI,'') as DIACHILIENLAC        , CASE WHEN HD_BN.NGAYSINH IS NULL THEN CAST(HD_BN.NAMSINH AS VARCHAR(4)) ELSE CONVERT(VARCHAR(10), HD_BN.NGAYSINH,103) END AS NGAYTHANGNAMSINH        FROM TT_KSK_HOPDONG_BENHNHAN HD_BN        LEFT JOIN TT_KSK_HOPDONG HD ON HD.HOPDONG_ID = HD_BN.HOPDONG_ID        LEFT JOIN LST_DICTIONARY LST ON LST.DICTIONARY_ID = HD_BN.TINHTRANGHONNHAN_ID AND LST.DICTIONARY_TYPE_CODE = 'TinhTrangGiaDinh'        LEFT JOIN TM_NHANVIEN NV ON NV.NHANVIEN_ID = HD_BN.NHANVIEN_ID        LEFT JOIN TM_CSKH_GOI GOI ON GOI.GOI_ID = HD_BN.GOI_ID        LEFT JOIN LST_DICTIONARY DT ON DT.DICTIONARY_ID = HD_BN.DOITUONG_ID AND DT.DICTIONARY_TYPE_CODE = 'DoiTuongKhamSucKhoe'        LEFT JOIN TM_DONVIHANHCHINH HC ON HC.DONVIHANHCHINH_ID = HD_BN.NOICAP_ID        LEFT JOIN TM_DONVIHANHCHINH XP on XP.MADONVI = HD_BN.XAPHUONGTT_ID        LEFT JOIN TM_DONVIHANHCHINH QH on QH.DONVIHANHCHINH_ID = XP.CAPTREN_ID        LEFT JOIN TM_DONVIHANHCHINH TP on TP.DONVIHANHCHINH_ID = QH.CAPTREN_ID         where                 HD_BN.HOPDONG_ID = 3             and               HD_BN.BENHVIEN_ID = 'HLU01'                       ORDER BY HD_BN.STT]
2019-12-10 10:43:24,985 [1] DEBUG - Statement Id: [DAO00307_GetContractPatient] PreparedStatement : [SELECT HD_BN.*, LST.DICTIONARY_NAME AS HONNHAN        , CASE WHEN HD_BN.GIOITINH = '1' THEN N'Nam' ELSE N'Nữ' END AS GENDER        , CASE WHEN HD_BN.HOPDONG_BENHNHAN_ID IN (SELECT HOPDONG_BENHNHAN_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU) THEN 1 ELSE 0 END BENHNHAN_DANGKYKSK_DICHVU        , GOI.TENGOI        FROM TT_KSK_HOPDONG_BENHNHAN HD_BN        INNER JOIN TT_KSK_HOPDONG HD ON HD.HOPDONG_ID = HD_BN.HOPDONG_ID        LEFT JOIN LST_DICTIONARY LST ON LST.DICTIONARY_ID = HD_BN.TINHTRANGHONNHAN_ID AND LST.DICTIONARY_TYPE_CODE = 'TinhTrangGiaDinh'        LEFT JOIN TM_CSKH_GOI GOI ON GOI.GOI_ID = HD_BN.GOI_ID        WHERE HD.HOPDONG_ID = 3           AND               HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:43:25,042 [1] DEBUG - Statement Id: [DAO00308_StatusContract] PreparedStatement : [SELECT * FROM TT_KSK_HOPDONG        WHERE HOPDONG_ID = 3]
2019-12-10 10:43:26,255 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhanDichVu] PreparedStatement : [SELECT distinct HD_BN.HOPDONG_ID, DV.TENDICHVU, PB.TENPHONGBAN AS NOITHUCHIEN, NDV.TENNHOMDICHVU, PB.PHONGBAN_ID, DV.DICHVU_ID        , ISNULL(GOI_CT.DONGIATRONGGOI,0) AS DONGIA, ISNULL(GOI_CT.SOLAN,0) AS SOLUONG, GOI_CT.THANHTIENTRONGGOI AS THANHTIEN        , CASE WHEN DV.DICHVU_ID IN (SELECT DICHVU_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU WHERE HOPDONG_ID = '3' AND HOPDONG_BENHNHAN_ID = '210') THEN 1 ELSE 0 END AS DANGKY        FROM TT_KSK_HOPDONG HD                inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        INNER JOIN TM_CSKH_GOI_CHITIET GOI_CT ON GOI_CT.GOI_ID = HD_BN.GOI_ID        INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = GOI_CT.DICHVU_ID        LEFT JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        INNER JOIN TM_PHONGBAN_DICHVU PB_DV ON PB_DV.DICHVU_ID = DV.DICHVU_ID        LEFT JOIN TM_PHONGBAN PB ON PB.PHONGBAN_ID = PB_DV.PHONGBAN_ID        WHERE GOI_CT.GOI_ID = 3 and HD_BN.HOPDONG_BENHNHAN_ID = 210        and PB_DV.PHONGBAN_ID =(select top 1 PHONGBAN_ID from TM_PHONGBAN_DICHVU where DICHVU_ID = DV.DICHVU_ID)]
2019-12-10 10:43:44,241 [1] DEBUG - Statement Id: [DAO00308_AddByJson] PreparedStatement : [declare @jsonData nvarchar(max) = N'[{"HOPDONG_ID":3,"TENDICHVU":"Chụp Xquang đỉnh phổi ưỡn - số hóa 1 phim","NOITHUCHIEN":"Phòng chụp XQ-KTS (D.208)","TENNHOMDICHVU":"Chụp Xquang số hóa","PHONGBAN_ID":35,"DICHVU_ID":4135,"DONGIA":90000.0,"SOLUONG":1,"THANHTIEN":90000.0,"DANGKY":0,"STT":"1","CHECKSERVICE":true,"HOPDONG_BENHNHAN_ID":210,"NGAYCAPNHAT":"12/10/2019 10:43:44 AM","NGAYTAO":"12/10/2019 10:43:44 AM","NGUOITAO_ID":1,"NGUOICAPNHAT_ID":1,"BENHVIEN_ID":"HLU01"},{"HOPDONG_ID":3,"TENDICHVU":"Tổng phân tích tế bào máu ngoại vi (bằng máy đếm laser)","NOITHUCHIEN":"Phòng XN Huyết học- Sinh hóa-Miễn dịch(D.230)","TENNHOMDICHVU":"Huyết học","PHONGBAN_ID":104,"DICHVU_ID":4524,"DONGIA":50000.0,"SOLUONG":1,"THANHTIEN":50000.0,"DANGKY":0,"STT":"2","CHECKSERVICE":true,"HOPDONG_BENHNHAN_ID":210,"NGAYCAPNHAT":"12/10/2019 10:43:44 AM","NGAYTAO":"12/10/2019 10:43:44 AM","NGUOITAO_ID":1,"NGUOICAPNHAT_ID":1,"BENHVIEN_ID":"HLU01"},{"HOPDONG_ID":3,"TENDICHVU":"Khám Da liễu","NOITHUCHIEN":"P. khám nội TH- Khám SK (D.232)","TENNHOMDICHVU":"Khám bệnh","PHONGBAN_ID":64,"DICHVU_ID":5433,"DONGIA":50000.0,"SOLUONG":1,"THANHTIEN":50000.0,"DANGKY":0,"STT":"3","CHECKSERVICE":true,"HOPDONG_BENHNHAN_ID":210,"NGAYCAPNHAT":"12/10/2019 10:43:44 AM","NGAYTAO":"12/10/2019 10:43:44 AM","NGUOITAO_ID":1,"NGUOICAPNHAT_ID":1,"BENHVIEN_ID":"HLU01"},{"HOPDONG_ID":3,"TENDICHVU":"Khám Nội tổng hợp (D232)","NOITHUCHIEN":"P. khám nội TH- Khám SK (D.232)","TENNHOMDICHVU":"Khám bệnh","PHONGBAN_ID":64,"DICHVU_ID":5438,"DONGIA":50000.0,"SOLUONG":1,"THANHTIEN":50000.0,"DANGKY":0,"STT":"4","CHECKSERVICE":true,"HOPDONG_BENHNHAN_ID":210,"NGAYCAPNHAT":"12/10/2019 10:43:44 AM","NGAYTAO":"12/10/2019 10:43:44 AM","NGUOITAO_ID":1,"NGUOICAPNHAT_ID":1,"BENHVIEN_ID":"HLU01"},{"HOPDONG_ID":3,"TENDICHVU":"Khám Tai mũi họng (B107)","NOITHUCHIEN":"Phòng Khám TMH (B.107)","TENNHOMDICHVU":"Khám bệnh","PHONGBAN_ID":68,"DICHVU_ID":5443,"DONGIA":50000.0,"SOLUONG":1,"THANHTIEN":50000.0,"DANGKY":0,"STT":"5","CHECKSERVICE":true,"HOPDONG_BENHNHAN_ID":210,"NGAYCAPNHAT":"12/10/2019 10:43:44 AM","NGAYTAO":"12/10/2019 10:43:44 AM","NGUOITAO_ID":1,"NGUOICAPNHAT_ID":1,"BENHVIEN_ID":"HLU01"},{"HOPDONG_ID":3,"TENDICHVU":"Khám Mắt (E102)","NOITHUCHIEN":"Phòng khám mắt (E.102)","TENNHOMDICHVU":"Khám bệnh","PHONGBAN_ID":177,"DICHVU_ID":5435,"DONGIA":50000.0,"SOLUONG":1,"THANHTIEN":50000.0,"DANGKY":0,"STT":"6","CHECKSERVICE":true,"HOPDONG_BENHNHAN_ID":210,"NGAYCAPNHAT":"12/10/2019 10:43:44 AM","NGAYTAO":"12/10/2019 10:43:44 AM","NGUOITAO_ID":1,"NGUOICAPNHAT_ID":1,"BENHVIEN_ID":"HLU01"},{"HOPDONG_ID":3,"TENDICHVU":"Tổng phân tích nước tiểu (Bằng máy tự động)","NOITHUCHIEN":"Phòng XN Huyết học- Sinh hóa-Miễn dịch(D.230)","TENNHOMDICHVU":"Nước tiểu","PHONGBAN_ID":104,"DICHVU_ID":4747,"DONGIA":40000.0,"SOLUONG":1,"THANHTIEN":40000.0,"DANGKY":0,"STT":"7","CHECKSERVICE":true,"HOPDONG_BENHNHAN_ID":210,"NGAYCAPNHAT":"12/10/2019 10:43:44 AM","NGAYTAO":"12/10/2019 10:43:44 AM","NGUOITAO_ID":1,"NGUOICAPNHAT_ID":1,"BENHVIEN_ID":"HLU01"},{"HOPDONG_ID":3,"TENDICHVU":"Siêu âm tuyến giáp","NOITHUCHIEN":"Phòng siêu âm D.215","TENNHOMDICHVU":"Siêu âm","PHONGBAN_ID":92,"DICHVU_ID":4005,"DONGIA":70000.0,"SOLUONG":1,"THANHTIEN":70000.0,"DANGKY":0,"STT":"8","CHECKSERVICE":true,"HOPDONG_BENHNHAN_ID":210,"NGAYCAPNHAT":"12/10/2019 10:43:44 AM","NGAYTAO":"12/10/2019 10:43:44 AM","NGUOITAO_ID":1,"NGUOICAPNHAT_ID":1,"BENHVIEN_ID":"HLU01"},{"HOPDONG_ID":3,"TENDICHVU":"Siêu âm ổ bụng (gan mật, tụy, lách, thận, bàng quang)","NOITHUCHIEN":"Phòng siêu âm D.215","TENNHOMDICHVU":"Siêu âm","PHONGBAN_ID":92,"DICHVU_ID":4017,"DONGIA":50000.0,"SOLUONG":1,"THANHTIEN":50000.0,"DANGKY":0,"STT":"9","CHECKSERVICE":true,"HOPDONG_BENHNHAN_ID":210,"NGAYCAPNHAT":"12/10/2019 10:43:44 AM","NGAYTAO":"12/10/2019 10:43:44 AM","NGUOITAO_ID":1,"NGUOICAPNHAT_ID":1,"BENHVIEN_ID":"HLU01"}]';        INSERT INTO TT_KSK_HOPDONG_BENHNHAN_DICHVU        (        HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , DICHVU_ID        , PHONGBAN_ID        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYCAPNHAT        , NGUOICAPNHAT_ID)        SELECT        HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , DICHVU_ID        , PHONGBAN_ID        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYCAPNHAT        , NGUOICAPNHAT_ID        FROM OPENJSON(@jsonData)        WITH        (        HOPDONG_ID int        , HOPDONG_BENHNHAN_ID int        , DICHVU_ID int        , PHONGBAN_ID int        , BENHVIEN_ID varchar(10)        , NGAYTAO datetime        , NGUOITAO_ID int        , NGAYCAPNHAT datetime        , NGUOICAPNHAT_ID int)]
2019-12-10 10:43:44,428 [1] DEBUG - Statement Id: [DAO00307_GetContractPatient] PreparedStatement : [SELECT HD_BN.*, LST.DICTIONARY_NAME AS HONNHAN        , CASE WHEN HD_BN.GIOITINH = '1' THEN N'Nam' ELSE N'Nữ' END AS GENDER        , CASE WHEN HD_BN.HOPDONG_BENHNHAN_ID IN (SELECT HOPDONG_BENHNHAN_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU) THEN 1 ELSE 0 END BENHNHAN_DANGKYKSK_DICHVU        , GOI.TENGOI        FROM TT_KSK_HOPDONG_BENHNHAN HD_BN        INNER JOIN TT_KSK_HOPDONG HD ON HD.HOPDONG_ID = HD_BN.HOPDONG_ID        LEFT JOIN LST_DICTIONARY LST ON LST.DICTIONARY_ID = HD_BN.TINHTRANGHONNHAN_ID AND LST.DICTIONARY_TYPE_CODE = 'TinhTrangGiaDinh'        LEFT JOIN TM_CSKH_GOI GOI ON GOI.GOI_ID = HD_BN.GOI_ID        WHERE HD.HOPDONG_ID = 3           AND               HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:43:44,506 [1] DEBUG - Statement Id: [DAO00308_StatusContract] PreparedStatement : [SELECT * FROM TT_KSK_HOPDONG        WHERE HOPDONG_ID = 3]
2019-12-10 10:43:44,652 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhanDichVu] PreparedStatement : [SELECT distinct HD_BN.HOPDONG_ID, DV.TENDICHVU, PB.TENPHONGBAN AS NOITHUCHIEN, NDV.TENNHOMDICHVU, PB.PHONGBAN_ID, DV.DICHVU_ID        , ISNULL(GOI_CT.DONGIATRONGGOI,0) AS DONGIA, ISNULL(GOI_CT.SOLAN,0) AS SOLUONG, GOI_CT.THANHTIENTRONGGOI AS THANHTIEN        , CASE WHEN DV.DICHVU_ID IN (SELECT DICHVU_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU WHERE HOPDONG_ID = '3' AND HOPDONG_BENHNHAN_ID = '210') THEN 1 ELSE 0 END AS DANGKY        FROM TT_KSK_HOPDONG HD                inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        INNER JOIN TM_CSKH_GOI_CHITIET GOI_CT ON GOI_CT.GOI_ID = HD_BN.GOI_ID        INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = GOI_CT.DICHVU_ID        LEFT JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        INNER JOIN TM_PHONGBAN_DICHVU PB_DV ON PB_DV.DICHVU_ID = DV.DICHVU_ID        LEFT JOIN TM_PHONGBAN PB ON PB.PHONGBAN_ID = PB_DV.PHONGBAN_ID        WHERE GOI_CT.GOI_ID = 3 and HD_BN.HOPDONG_BENHNHAN_ID = 210        and PB_DV.PHONGBAN_ID =(select top 1 PHONGBAN_ID from TM_PHONGBAN_DICHVU where DICHVU_ID = DV.DICHVU_ID)]
2019-12-10 10:44:02,634 [1] DEBUG - Statement Id: [DAO00308_UpdateTrangThai] PreparedStatement : [UPDATE TT_KSK_HOPDONG        SET TRANGTHAI =  @param0         WHERE HOPDONG_ID = 3]
2019-12-10 10:44:02,634 [1] DEBUG - Statement Id: [DAO00308_UpdateTrangThai] Parameters: [@param0=[TRANGTHAI,XACNHAN]]
2019-12-10 10:44:02,634 [1] DEBUG - Statement Id: [DAO00308_UpdateTrangThai] Types: [@param0=[String, System.String]]
2019-12-10 10:44:06,838 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhanDichVu] PreparedStatement : [SELECT distinct HD_BN.HOPDONG_ID, DV.TENDICHVU, PB.TENPHONGBAN AS NOITHUCHIEN, NDV.TENNHOMDICHVU, PB.PHONGBAN_ID, DV.DICHVU_ID        , ISNULL(GOI_CT.DONGIATRONGGOI,0) AS DONGIA, ISNULL(GOI_CT.SOLAN,0) AS SOLUONG, GOI_CT.THANHTIENTRONGGOI AS THANHTIEN        , CASE WHEN DV.DICHVU_ID IN (SELECT DICHVU_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU WHERE HOPDONG_ID = '3' AND HOPDONG_BENHNHAN_ID = '211') THEN 1 ELSE 0 END AS DANGKY        FROM TT_KSK_HOPDONG HD                inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        INNER JOIN TM_CSKH_GOI_CHITIET GOI_CT ON GOI_CT.GOI_ID = HD_BN.GOI_ID        INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = GOI_CT.DICHVU_ID        LEFT JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        INNER JOIN TM_PHONGBAN_DICHVU PB_DV ON PB_DV.DICHVU_ID = DV.DICHVU_ID        LEFT JOIN TM_PHONGBAN PB ON PB.PHONGBAN_ID = PB_DV.PHONGBAN_ID        WHERE GOI_CT.GOI_ID = 3 and HD_BN.HOPDONG_BENHNHAN_ID = 211        and PB_DV.PHONGBAN_ID =(select top 1 PHONGBAN_ID from TM_PHONGBAN_DICHVU where DICHVU_ID = DV.DICHVU_ID)]
2019-12-10 10:44:57,001 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'HSM08'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 10:44:58,856 [1] DEBUG - Statement Id: [DAO00307_GetContractWithDate] PreparedStatement : [SELECT HD.*, HD.SO_HD + ' - ' + CT.TENCONGTY AS HOPDONG, CT.TENCONGTY        FROM TT_KSK_HOPDONG HD JOIN TT_KSK_CONGTY CT ON CT.CONGTY_ID = HD.CONGTY_ID         where                 HD.BENHVIEN_ID = 'HLU01']
2019-12-10 10:44:59,093 [1] DEBUG - Statement Id: [DAO00307_GetContractWithDate] PreparedStatement : [SELECT HD.*, HD.SO_HD + ' - ' + CT.TENCONGTY AS HOPDONG, CT.TENCONGTY        FROM TT_KSK_HOPDONG HD JOIN TT_KSK_CONGTY CT ON CT.CONGTY_ID = HD.CONGTY_ID         where                 HD.BENHVIEN_ID = 'HLU01']
2019-12-10 10:45:04,284 [1] DEBUG - Statement Id: [DAO00307_GetPatientConfirms] PreparedStatement : [select distinct HD_BN.*        , CASE WHEN HD_BN.GIOITINH = '1' THEN N'Nam' ELSE N'Nữ' END AS GENDER        , CASE WHEN HD_DV.ACTIVE IS NULL THEN 0 ELSE 1 END BENHNHAN_DANGKYKSK_DICHVU        , case when HD_BN.GOI_ID is null then N'Hợp đồng:' + ' ' + HD.SO_HD else N'Gói khám:' + ' ' + G.TENGOI end as DOITUONG        , LST.DICTIONARY_NAME as HONNHAN        from TT_KSK_HOPDONG HD        inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        left join LST_DICTIONARY LST ON LST.DICTIONARY_ID = HD_BN.TINHTRANGHONNHAN_ID AND LST.DICTIONARY_TYPE_CODE = 'TinhTrangGiaDinh'        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        left join TT_TIEPNHAN TN on TN.TIEPNHAN_ID = HD_DV.TIEPNHAN_ID        left join TM_CSKH_GOI G ON G.GOI_ID = HD_BN.GOI_ID        where HD.HOPDONG_ID = '3'         AND           HD.BENHVIEN_ID = 'HLU01'                 order by HD_BN.STT]
2019-12-10 10:45:05,488 [1] DEBUG - Statement Id: [DAO00308_GetTiepNhanID] PreparedStatement : [select top 1 TN.TIEPNHAN_ID, TN.SOTIEPNHAN        from TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV        inner join TT_TIEPNHAN TN on TN.TIEPNHAN_ID = HD_DV.TIEPNHAN_ID        where HD_DV.HOPDONG_BENHNHAN_ID = 203 and HD_DV.HOPDONG_ID = 3]
2019-12-10 10:45:05,602 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '203'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:45:08,060 [1] DEBUG - Statement Id: [DAO00308_GetTiepNhanID] PreparedStatement : [select top 1 TN.TIEPNHAN_ID, TN.SOTIEPNHAN        from TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV        inner join TT_TIEPNHAN TN on TN.TIEPNHAN_ID = HD_DV.TIEPNHAN_ID        where HD_DV.HOPDONG_BENHNHAN_ID = 204 and HD_DV.HOPDONG_ID = 3]
2019-12-10 10:45:08,244 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '204'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:45:21,583 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '210'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:45:53,321 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhanDichVu] PreparedStatement : [SELECT distinct HD_BN.HOPDONG_ID, DV.TENDICHVU, PB.TENPHONGBAN AS NOITHUCHIEN, NDV.TENNHOMDICHVU, PB.PHONGBAN_ID, DV.DICHVU_ID        , ISNULL(GOI_CT.DONGIATRONGGOI,0) AS DONGIA, ISNULL(GOI_CT.SOLAN,0) AS SOLUONG, GOI_CT.THANHTIENTRONGGOI AS THANHTIEN        , CASE WHEN DV.DICHVU_ID IN (SELECT DICHVU_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU WHERE HOPDONG_ID = '3' AND HOPDONG_BENHNHAN_ID = '212') THEN 1 ELSE 0 END AS DANGKY        FROM TT_KSK_HOPDONG HD                inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        INNER JOIN TM_CSKH_GOI_CHITIET GOI_CT ON GOI_CT.GOI_ID = HD_BN.GOI_ID        INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = GOI_CT.DICHVU_ID        LEFT JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        INNER JOIN TM_PHONGBAN_DICHVU PB_DV ON PB_DV.DICHVU_ID = DV.DICHVU_ID        LEFT JOIN TM_PHONGBAN PB ON PB.PHONGBAN_ID = PB_DV.PHONGBAN_ID        WHERE GOI_CT.GOI_ID = 3 and HD_BN.HOPDONG_BENHNHAN_ID = 212        and PB_DV.PHONGBAN_ID =(select top 1 PHONGBAN_ID from TM_PHONGBAN_DICHVU where DICHVU_ID = DV.DICHVU_ID)]
2019-12-10 10:45:54,785 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhanDichVu] PreparedStatement : [SELECT distinct HD_BN.HOPDONG_ID, DV.TENDICHVU, PB.TENPHONGBAN AS NOITHUCHIEN, NDV.TENNHOMDICHVU, PB.PHONGBAN_ID, DV.DICHVU_ID        , ISNULL(GOI_CT.DONGIATRONGGOI,0) AS DONGIA, ISNULL(GOI_CT.SOLAN,0) AS SOLUONG, GOI_CT.THANHTIENTRONGGOI AS THANHTIEN        , CASE WHEN DV.DICHVU_ID IN (SELECT DICHVU_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU WHERE HOPDONG_ID = '3' AND HOPDONG_BENHNHAN_ID = '213') THEN 1 ELSE 0 END AS DANGKY        FROM TT_KSK_HOPDONG HD                inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        INNER JOIN TM_CSKH_GOI_CHITIET GOI_CT ON GOI_CT.GOI_ID = HD_BN.GOI_ID        INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = GOI_CT.DICHVU_ID        LEFT JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        INNER JOIN TM_PHONGBAN_DICHVU PB_DV ON PB_DV.DICHVU_ID = DV.DICHVU_ID        LEFT JOIN TM_PHONGBAN PB ON PB.PHONGBAN_ID = PB_DV.PHONGBAN_ID        WHERE GOI_CT.GOI_ID = 3 and HD_BN.HOPDONG_BENHNHAN_ID = 213        and PB_DV.PHONGBAN_ID =(select top 1 PHONGBAN_ID from TM_PHONGBAN_DICHVU where DICHVU_ID = DV.DICHVU_ID)]
2019-12-10 10:45:56,329 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhanDichVu] PreparedStatement : [SELECT distinct HD_BN.HOPDONG_ID, DV.TENDICHVU, PB.TENPHONGBAN AS NOITHUCHIEN, NDV.TENNHOMDICHVU, PB.PHONGBAN_ID, DV.DICHVU_ID        , ISNULL(GOI_CT.DONGIATRONGGOI,0) AS DONGIA, ISNULL(GOI_CT.SOLAN,0) AS SOLUONG, GOI_CT.THANHTIENTRONGGOI AS THANHTIEN        , CASE WHEN DV.DICHVU_ID IN (SELECT DICHVU_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU WHERE HOPDONG_ID = '3' AND HOPDONG_BENHNHAN_ID = '212') THEN 1 ELSE 0 END AS DANGKY        FROM TT_KSK_HOPDONG HD                inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        INNER JOIN TM_CSKH_GOI_CHITIET GOI_CT ON GOI_CT.GOI_ID = HD_BN.GOI_ID        INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = GOI_CT.DICHVU_ID        LEFT JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        INNER JOIN TM_PHONGBAN_DICHVU PB_DV ON PB_DV.DICHVU_ID = DV.DICHVU_ID        LEFT JOIN TM_PHONGBAN PB ON PB.PHONGBAN_ID = PB_DV.PHONGBAN_ID        WHERE GOI_CT.GOI_ID = 3 and HD_BN.HOPDONG_BENHNHAN_ID = 212        and PB_DV.PHONGBAN_ID =(select top 1 PHONGBAN_ID from TM_PHONGBAN_DICHVU where DICHVU_ID = DV.DICHVU_ID)]
2019-12-10 10:45:57,965 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhanDichVu] PreparedStatement : [SELECT distinct HD_BN.HOPDONG_ID, DV.TENDICHVU, PB.TENPHONGBAN AS NOITHUCHIEN, NDV.TENNHOMDICHVU, PB.PHONGBAN_ID, DV.DICHVU_ID        , ISNULL(GOI_CT.DONGIATRONGGOI,0) AS DONGIA, ISNULL(GOI_CT.SOLAN,0) AS SOLUONG, GOI_CT.THANHTIENTRONGGOI AS THANHTIEN        , CASE WHEN DV.DICHVU_ID IN (SELECT DICHVU_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU WHERE HOPDONG_ID = '3' AND HOPDONG_BENHNHAN_ID = '210') THEN 1 ELSE 0 END AS DANGKY        FROM TT_KSK_HOPDONG HD                inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        INNER JOIN TM_CSKH_GOI_CHITIET GOI_CT ON GOI_CT.GOI_ID = HD_BN.GOI_ID        INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = GOI_CT.DICHVU_ID        LEFT JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        INNER JOIN TM_PHONGBAN_DICHVU PB_DV ON PB_DV.DICHVU_ID = DV.DICHVU_ID        LEFT JOIN TM_PHONGBAN PB ON PB.PHONGBAN_ID = PB_DV.PHONGBAN_ID        WHERE GOI_CT.GOI_ID = 3 and HD_BN.HOPDONG_BENHNHAN_ID = 210        and PB_DV.PHONGBAN_ID =(select top 1 PHONGBAN_ID from TM_PHONGBAN_DICHVU where DICHVU_ID = DV.DICHVU_ID)]
2019-12-10 10:45:59,077 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhanDichVu] PreparedStatement : [SELECT distinct HD_BN.HOPDONG_ID, DV.TENDICHVU, PB.TENPHONGBAN AS NOITHUCHIEN, NDV.TENNHOMDICHVU, PB.PHONGBAN_ID, DV.DICHVU_ID        , ISNULL(GOI_CT.DONGIATRONGGOI,0) AS DONGIA, ISNULL(GOI_CT.SOLAN,0) AS SOLUONG, GOI_CT.THANHTIENTRONGGOI AS THANHTIEN        , CASE WHEN DV.DICHVU_ID IN (SELECT DICHVU_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU WHERE HOPDONG_ID = '3' AND HOPDONG_BENHNHAN_ID = '212') THEN 1 ELSE 0 END AS DANGKY        FROM TT_KSK_HOPDONG HD                inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        INNER JOIN TM_CSKH_GOI_CHITIET GOI_CT ON GOI_CT.GOI_ID = HD_BN.GOI_ID        INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = GOI_CT.DICHVU_ID        LEFT JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        INNER JOIN TM_PHONGBAN_DICHVU PB_DV ON PB_DV.DICHVU_ID = DV.DICHVU_ID        LEFT JOIN TM_PHONGBAN PB ON PB.PHONGBAN_ID = PB_DV.PHONGBAN_ID        WHERE GOI_CT.GOI_ID = 3 and HD_BN.HOPDONG_BENHNHAN_ID = 212        and PB_DV.PHONGBAN_ID =(select top 1 PHONGBAN_ID from TM_PHONGBAN_DICHVU where DICHVU_ID = DV.DICHVU_ID)]
2019-12-10 10:46:01,284 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhanDichVu] PreparedStatement : [SELECT distinct HD_BN.HOPDONG_ID, DV.TENDICHVU, PB.TENPHONGBAN AS NOITHUCHIEN, NDV.TENNHOMDICHVU, PB.PHONGBAN_ID, DV.DICHVU_ID        , ISNULL(GOI_CT.DONGIATRONGGOI,0) AS DONGIA, ISNULL(GOI_CT.SOLAN,0) AS SOLUONG, GOI_CT.THANHTIENTRONGGOI AS THANHTIEN        , CASE WHEN DV.DICHVU_ID IN (SELECT DICHVU_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU WHERE HOPDONG_ID = '3' AND HOPDONG_BENHNHAN_ID = '213') THEN 1 ELSE 0 END AS DANGKY        FROM TT_KSK_HOPDONG HD                inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        INNER JOIN TM_CSKH_GOI_CHITIET GOI_CT ON GOI_CT.GOI_ID = HD_BN.GOI_ID        INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = GOI_CT.DICHVU_ID        LEFT JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        INNER JOIN TM_PHONGBAN_DICHVU PB_DV ON PB_DV.DICHVU_ID = DV.DICHVU_ID        LEFT JOIN TM_PHONGBAN PB ON PB.PHONGBAN_ID = PB_DV.PHONGBAN_ID        WHERE GOI_CT.GOI_ID = 3 and HD_BN.HOPDONG_BENHNHAN_ID = 213        and PB_DV.PHONGBAN_ID =(select top 1 PHONGBAN_ID from TM_PHONGBAN_DICHVU where DICHVU_ID = DV.DICHVU_ID)]
2019-12-10 10:46:16,669 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhanDichVu] PreparedStatement : [SELECT distinct HD_BN.HOPDONG_ID, DV.TENDICHVU, PB.TENPHONGBAN AS NOITHUCHIEN, NDV.TENNHOMDICHVU, PB.PHONGBAN_ID, DV.DICHVU_ID        , ISNULL(GOI_CT.DONGIATRONGGOI,0) AS DONGIA, ISNULL(GOI_CT.SOLAN,0) AS SOLUONG, GOI_CT.THANHTIENTRONGGOI AS THANHTIEN        , CASE WHEN DV.DICHVU_ID IN (SELECT DICHVU_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU WHERE HOPDONG_ID = '3' AND HOPDONG_BENHNHAN_ID = '211') THEN 1 ELSE 0 END AS DANGKY        FROM TT_KSK_HOPDONG HD                inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        INNER JOIN TM_CSKH_GOI_CHITIET GOI_CT ON GOI_CT.GOI_ID = HD_BN.GOI_ID        INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = GOI_CT.DICHVU_ID        LEFT JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        INNER JOIN TM_PHONGBAN_DICHVU PB_DV ON PB_DV.DICHVU_ID = DV.DICHVU_ID        LEFT JOIN TM_PHONGBAN PB ON PB.PHONGBAN_ID = PB_DV.PHONGBAN_ID        WHERE GOI_CT.GOI_ID = 3 and HD_BN.HOPDONG_BENHNHAN_ID = 211        and PB_DV.PHONGBAN_ID =(select top 1 PHONGBAN_ID from TM_PHONGBAN_DICHVU where DICHVU_ID = DV.DICHVU_ID)]
2019-12-10 10:46:17,707 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhanDichVu] PreparedStatement : [SELECT distinct HD_BN.HOPDONG_ID, DV.TENDICHVU, PB.TENPHONGBAN AS NOITHUCHIEN, NDV.TENNHOMDICHVU, PB.PHONGBAN_ID, DV.DICHVU_ID        , ISNULL(GOI_CT.DONGIATRONGGOI,0) AS DONGIA, ISNULL(GOI_CT.SOLAN,0) AS SOLUONG, GOI_CT.THANHTIENTRONGGOI AS THANHTIEN        , CASE WHEN DV.DICHVU_ID IN (SELECT DICHVU_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU WHERE HOPDONG_ID = '3' AND HOPDONG_BENHNHAN_ID = '212') THEN 1 ELSE 0 END AS DANGKY        FROM TT_KSK_HOPDONG HD                inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        INNER JOIN TM_CSKH_GOI_CHITIET GOI_CT ON GOI_CT.GOI_ID = HD_BN.GOI_ID        INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = GOI_CT.DICHVU_ID        LEFT JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        INNER JOIN TM_PHONGBAN_DICHVU PB_DV ON PB_DV.DICHVU_ID = DV.DICHVU_ID        LEFT JOIN TM_PHONGBAN PB ON PB.PHONGBAN_ID = PB_DV.PHONGBAN_ID        WHERE GOI_CT.GOI_ID = 3 and HD_BN.HOPDONG_BENHNHAN_ID = 212        and PB_DV.PHONGBAN_ID =(select top 1 PHONGBAN_ID from TM_PHONGBAN_DICHVU where DICHVU_ID = DV.DICHVU_ID)]
2019-12-10 10:46:25,653 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhanDichVu] PreparedStatement : [SELECT distinct HD_BN.HOPDONG_ID, DV.TENDICHVU, PB.TENPHONGBAN AS NOITHUCHIEN, NDV.TENNHOMDICHVU, PB.PHONGBAN_ID, DV.DICHVU_ID        , ISNULL(GOI_CT.DONGIATRONGGOI,0) AS DONGIA, ISNULL(GOI_CT.SOLAN,0) AS SOLUONG, GOI_CT.THANHTIENTRONGGOI AS THANHTIEN        , CASE WHEN DV.DICHVU_ID IN (SELECT DICHVU_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU WHERE HOPDONG_ID = '3' AND HOPDONG_BENHNHAN_ID = '211') THEN 1 ELSE 0 END AS DANGKY        FROM TT_KSK_HOPDONG HD                inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        INNER JOIN TM_CSKH_GOI_CHITIET GOI_CT ON GOI_CT.GOI_ID = HD_BN.GOI_ID        INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = GOI_CT.DICHVU_ID        LEFT JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        INNER JOIN TM_PHONGBAN_DICHVU PB_DV ON PB_DV.DICHVU_ID = DV.DICHVU_ID        LEFT JOIN TM_PHONGBAN PB ON PB.PHONGBAN_ID = PB_DV.PHONGBAN_ID        WHERE GOI_CT.GOI_ID = 3 and HD_BN.HOPDONG_BENHNHAN_ID = 211        and PB_DV.PHONGBAN_ID =(select top 1 PHONGBAN_ID from TM_PHONGBAN_DICHVU where DICHVU_ID = DV.DICHVU_ID)]
2019-12-10 10:46:29,144 [1] DEBUG - Statement Id: [DAO00308_AddByJson] PreparedStatement : [declare @jsonData nvarchar(max) = N'[{"HOPDONG_ID":3,"TENDICHVU":"Chụp Xquang đỉnh phổi ưỡn - số hóa 1 phim","NOITHUCHIEN":"Phòng chụp XQ-KTS (D.208)","TENNHOMDICHVU":"Chụp Xquang số hóa","PHONGBAN_ID":35,"DICHVU_ID":4135,"DONGIA":90000.0,"SOLUONG":1,"THANHTIEN":90000.0,"DANGKY":0,"STT":"1","CHECKSERVICE":true,"HOPDONG_BENHNHAN_ID":211,"NGAYCAPNHAT":"12/10/2019 10:46:29 AM","NGAYTAO":"12/10/2019 10:46:29 AM","NGUOITAO_ID":1,"NGUOICAPNHAT_ID":1,"BENHVIEN_ID":"HLU01"},{"HOPDONG_ID":3,"TENDICHVU":"Tổng phân tích tế bào máu ngoại vi (bằng máy đếm laser)","NOITHUCHIEN":"Phòng XN Huyết học- Sinh hóa-Miễn dịch(D.230)","TENNHOMDICHVU":"Huyết học","PHONGBAN_ID":104,"DICHVU_ID":4524,"DONGIA":50000.0,"SOLUONG":1,"THANHTIEN":50000.0,"DANGKY":0,"STT":"2","CHECKSERVICE":true,"HOPDONG_BENHNHAN_ID":211,"NGAYCAPNHAT":"12/10/2019 10:46:29 AM","NGAYTAO":"12/10/2019 10:46:29 AM","NGUOITAO_ID":1,"NGUOICAPNHAT_ID":1,"BENHVIEN_ID":"HLU01"},{"HOPDONG_ID":3,"TENDICHVU":"Khám Da liễu","NOITHUCHIEN":"P. khám nội TH- Khám SK (D.232)","TENNHOMDICHVU":"Khám bệnh","PHONGBAN_ID":64,"DICHVU_ID":5433,"DONGIA":50000.0,"SOLUONG":1,"THANHTIEN":50000.0,"DANGKY":0,"STT":"3","CHECKSERVICE":true,"HOPDONG_BENHNHAN_ID":211,"NGAYCAPNHAT":"12/10/2019 10:46:29 AM","NGAYTAO":"12/10/2019 10:46:29 AM","NGUOITAO_ID":1,"NGUOICAPNHAT_ID":1,"BENHVIEN_ID":"HLU01"},{"HOPDONG_ID":3,"TENDICHVU":"Khám Nội tổng hợp (D232)","NOITHUCHIEN":"P. khám nội TH- Khám SK (D.232)","TENNHOMDICHVU":"Khám bệnh","PHONGBAN_ID":64,"DICHVU_ID":5438,"DONGIA":50000.0,"SOLUONG":1,"THANHTIEN":50000.0,"DANGKY":0,"STT":"4","CHECKSERVICE":true,"HOPDONG_BENHNHAN_ID":211,"NGAYCAPNHAT":"12/10/2019 10:46:29 AM","NGAYTAO":"12/10/2019 10:46:29 AM","NGUOITAO_ID":1,"NGUOICAPNHAT_ID":1,"BENHVIEN_ID":"HLU01"},{"HOPDONG_ID":3,"TENDICHVU":"Khám Tai mũi họng (B107)","NOITHUCHIEN":"Phòng Khám TMH (B.107)","TENNHOMDICHVU":"Khám bệnh","PHONGBAN_ID":68,"DICHVU_ID":5443,"DONGIA":50000.0,"SOLUONG":1,"THANHTIEN":50000.0,"DANGKY":0,"STT":"5","CHECKSERVICE":true,"HOPDONG_BENHNHAN_ID":211,"NGAYCAPNHAT":"12/10/2019 10:46:29 AM","NGAYTAO":"12/10/2019 10:46:29 AM","NGUOITAO_ID":1,"NGUOICAPNHAT_ID":1,"BENHVIEN_ID":"HLU01"},{"HOPDONG_ID":3,"TENDICHVU":"Khám Mắt (E102)","NOITHUCHIEN":"Phòng khám mắt (E.102)","TENNHOMDICHVU":"Khám bệnh","PHONGBAN_ID":177,"DICHVU_ID":5435,"DONGIA":50000.0,"SOLUONG":1,"THANHTIEN":50000.0,"DANGKY":0,"STT":"6","CHECKSERVICE":true,"HOPDONG_BENHNHAN_ID":211,"NGAYCAPNHAT":"12/10/2019 10:46:29 AM","NGAYTAO":"12/10/2019 10:46:29 AM","NGUOITAO_ID":1,"NGUOICAPNHAT_ID":1,"BENHVIEN_ID":"HLU01"},{"HOPDONG_ID":3,"TENDICHVU":"Tổng phân tích nước tiểu (Bằng máy tự động)","NOITHUCHIEN":"Phòng XN Huyết học- Sinh hóa-Miễn dịch(D.230)","TENNHOMDICHVU":"Nước tiểu","PHONGBAN_ID":104,"DICHVU_ID":4747,"DONGIA":40000.0,"SOLUONG":1,"THANHTIEN":40000.0,"DANGKY":0,"STT":"7","CHECKSERVICE":true,"HOPDONG_BENHNHAN_ID":211,"NGAYCAPNHAT":"12/10/2019 10:46:29 AM","NGAYTAO":"12/10/2019 10:46:29 AM","NGUOITAO_ID":1,"NGUOICAPNHAT_ID":1,"BENHVIEN_ID":"HLU01"},{"HOPDONG_ID":3,"TENDICHVU":"Siêu âm tuyến giáp","NOITHUCHIEN":"Phòng siêu âm D.215","TENNHOMDICHVU":"Siêu âm","PHONGBAN_ID":92,"DICHVU_ID":4005,"DONGIA":70000.0,"SOLUONG":1,"THANHTIEN":70000.0,"DANGKY":0,"STT":"8","CHECKSERVICE":true,"HOPDONG_BENHNHAN_ID":211,"NGAYCAPNHAT":"12/10/2019 10:46:29 AM","NGAYTAO":"12/10/2019 10:46:29 AM","NGUOITAO_ID":1,"NGUOICAPNHAT_ID":1,"BENHVIEN_ID":"HLU01"},{"HOPDONG_ID":3,"TENDICHVU":"Siêu âm ổ bụng (gan mật, tụy, lách, thận, bàng quang)","NOITHUCHIEN":"Phòng siêu âm D.215","TENNHOMDICHVU":"Siêu âm","PHONGBAN_ID":92,"DICHVU_ID":4017,"DONGIA":50000.0,"SOLUONG":1,"THANHTIEN":50000.0,"DANGKY":0,"STT":"9","CHECKSERVICE":true,"HOPDONG_BENHNHAN_ID":211,"NGAYCAPNHAT":"12/10/2019 10:46:29 AM","NGAYTAO":"12/10/2019 10:46:29 AM","NGUOITAO_ID":1,"NGUOICAPNHAT_ID":1,"BENHVIEN_ID":"HLU01"}]';        INSERT INTO TT_KSK_HOPDONG_BENHNHAN_DICHVU        (        HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , DICHVU_ID        , PHONGBAN_ID        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYCAPNHAT        , NGUOICAPNHAT_ID)        SELECT        HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , DICHVU_ID        , PHONGBAN_ID        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYCAPNHAT        , NGUOICAPNHAT_ID        FROM OPENJSON(@jsonData)        WITH        (        HOPDONG_ID int        , HOPDONG_BENHNHAN_ID int        , DICHVU_ID int        , PHONGBAN_ID int        , BENHVIEN_ID varchar(10)        , NGAYTAO datetime        , NGUOITAO_ID int        , NGAYCAPNHAT datetime        , NGUOICAPNHAT_ID int)]
2019-12-10 10:46:29,414 [1] DEBUG - Statement Id: [DAO00307_GetContractPatient] PreparedStatement : [SELECT HD_BN.*, LST.DICTIONARY_NAME AS HONNHAN        , CASE WHEN HD_BN.GIOITINH = '1' THEN N'Nam' ELSE N'Nữ' END AS GENDER        , CASE WHEN HD_BN.HOPDONG_BENHNHAN_ID IN (SELECT HOPDONG_BENHNHAN_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU) THEN 1 ELSE 0 END BENHNHAN_DANGKYKSK_DICHVU        , GOI.TENGOI        FROM TT_KSK_HOPDONG_BENHNHAN HD_BN        INNER JOIN TT_KSK_HOPDONG HD ON HD.HOPDONG_ID = HD_BN.HOPDONG_ID        LEFT JOIN LST_DICTIONARY LST ON LST.DICTIONARY_ID = HD_BN.TINHTRANGHONNHAN_ID AND LST.DICTIONARY_TYPE_CODE = 'TinhTrangGiaDinh'        LEFT JOIN TM_CSKH_GOI GOI ON GOI.GOI_ID = HD_BN.GOI_ID        WHERE HD.HOPDONG_ID = 3           AND               HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:46:35,694 [1] DEBUG - Statement Id: [DAO00308_StatusContract] PreparedStatement : [SELECT * FROM TT_KSK_HOPDONG        WHERE HOPDONG_ID = 3]
2019-12-10 10:46:35,808 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhanDichVu] PreparedStatement : [SELECT distinct HD_BN.HOPDONG_ID, DV.TENDICHVU, PB.TENPHONGBAN AS NOITHUCHIEN, NDV.TENNHOMDICHVU, PB.PHONGBAN_ID, DV.DICHVU_ID        , ISNULL(GOI_CT.DONGIATRONGGOI,0) AS DONGIA, ISNULL(GOI_CT.SOLAN,0) AS SOLUONG, GOI_CT.THANHTIENTRONGGOI AS THANHTIEN        , CASE WHEN DV.DICHVU_ID IN (SELECT DICHVU_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU WHERE HOPDONG_ID = '3' AND HOPDONG_BENHNHAN_ID = '211') THEN 1 ELSE 0 END AS DANGKY        FROM TT_KSK_HOPDONG HD                inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        INNER JOIN TM_CSKH_GOI_CHITIET GOI_CT ON GOI_CT.GOI_ID = HD_BN.GOI_ID        INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = GOI_CT.DICHVU_ID        LEFT JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        INNER JOIN TM_PHONGBAN_DICHVU PB_DV ON PB_DV.DICHVU_ID = DV.DICHVU_ID        LEFT JOIN TM_PHONGBAN PB ON PB.PHONGBAN_ID = PB_DV.PHONGBAN_ID        WHERE GOI_CT.GOI_ID = 3 and HD_BN.HOPDONG_BENHNHAN_ID = 211        and PB_DV.PHONGBAN_ID =(select top 1 PHONGBAN_ID from TM_PHONGBAN_DICHVU where DICHVU_ID = DV.DICHVU_ID)]
2019-12-10 10:46:42,494 [1] DEBUG - Statement Id: [DAO00308_GetTiepNhanID] PreparedStatement : [select top 1 TN.TIEPNHAN_ID, TN.SOTIEPNHAN        from TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV        inner join TT_TIEPNHAN TN on TN.TIEPNHAN_ID = HD_DV.TIEPNHAN_ID        where HD_DV.HOPDONG_BENHNHAN_ID = 204 and HD_DV.HOPDONG_ID = 3]
2019-12-10 10:46:43,017 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '204'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:46:44,911 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '210'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:46:57,574 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhanDichVu] PreparedStatement : [SELECT distinct HD_BN.HOPDONG_ID, DV.TENDICHVU, PB.TENPHONGBAN AS NOITHUCHIEN, NDV.TENNHOMDICHVU, PB.PHONGBAN_ID, DV.DICHVU_ID        , ISNULL(GOI_CT.DONGIATRONGGOI,0) AS DONGIA, ISNULL(GOI_CT.SOLAN,0) AS SOLUONG, GOI_CT.THANHTIENTRONGGOI AS THANHTIEN        , CASE WHEN DV.DICHVU_ID IN (SELECT DICHVU_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU WHERE HOPDONG_ID = '3' AND HOPDONG_BENHNHAN_ID = '212') THEN 1 ELSE 0 END AS DANGKY        FROM TT_KSK_HOPDONG HD                inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        INNER JOIN TM_CSKH_GOI_CHITIET GOI_CT ON GOI_CT.GOI_ID = HD_BN.GOI_ID        INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = GOI_CT.DICHVU_ID        LEFT JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        INNER JOIN TM_PHONGBAN_DICHVU PB_DV ON PB_DV.DICHVU_ID = DV.DICHVU_ID        LEFT JOIN TM_PHONGBAN PB ON PB.PHONGBAN_ID = PB_DV.PHONGBAN_ID        WHERE GOI_CT.GOI_ID = 3 and HD_BN.HOPDONG_BENHNHAN_ID = 212        and PB_DV.PHONGBAN_ID =(select top 1 PHONGBAN_ID from TM_PHONGBAN_DICHVU where DICHVU_ID = DV.DICHVU_ID)]
2019-12-10 10:47:04,773 [1] DEBUG - Statement Id: [DAO00307_GetPatientConfirms] PreparedStatement : [select distinct HD_BN.*        , CASE WHEN HD_BN.GIOITINH = '1' THEN N'Nam' ELSE N'Nữ' END AS GENDER        , CASE WHEN HD_DV.ACTIVE IS NULL THEN 0 ELSE 1 END BENHNHAN_DANGKYKSK_DICHVU        , case when HD_BN.GOI_ID is null then N'Hợp đồng:' + ' ' + HD.SO_HD else N'Gói khám:' + ' ' + G.TENGOI end as DOITUONG        , LST.DICTIONARY_NAME as HONNHAN        from TT_KSK_HOPDONG HD        inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        left join LST_DICTIONARY LST ON LST.DICTIONARY_ID = HD_BN.TINHTRANGHONNHAN_ID AND LST.DICTIONARY_TYPE_CODE = 'TinhTrangGiaDinh'        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        left join TT_TIEPNHAN TN on TN.TIEPNHAN_ID = HD_DV.TIEPNHAN_ID        left join TM_CSKH_GOI G ON G.GOI_ID = HD_BN.GOI_ID        where HD.HOPDONG_ID = '3'         AND           HD.BENHVIEN_ID = 'HLU01'                 order by HD_BN.STT]
2019-12-10 10:47:06,639 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '210'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:47:06,759 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '210'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:47:07,676 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '211'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:47:07,842 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '210'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:47:07,902 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '210'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:47:07,965 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '211'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:47:08,025 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '211'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:47:33,769 [1] DEBUG - Statement Id: [DAO00308_GetTiepNhanID] PreparedStatement : [select top 1 TN.TIEPNHAN_ID, TN.SOTIEPNHAN        from TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV        inner join TT_TIEPNHAN TN on TN.TIEPNHAN_ID = HD_DV.TIEPNHAN_ID        where HD_DV.HOPDONG_BENHNHAN_ID = 203 and HD_DV.HOPDONG_ID = 3]
2019-12-10 10:47:33,884 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '203'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:47:35,588 [1] DEBUG - Statement Id: [DAO00308_GetTiepNhanID] PreparedStatement : [select top 1 TN.TIEPNHAN_ID, TN.SOTIEPNHAN        from TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV        inner join TT_TIEPNHAN TN on TN.TIEPNHAN_ID = HD_DV.TIEPNHAN_ID        where HD_DV.HOPDONG_BENHNHAN_ID = 204 and HD_DV.HOPDONG_ID = 3]
2019-12-10 10:47:35,704 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '204'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:47:37,865 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '210'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:47:38,391 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '211'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:47:43,695 [1] DEBUG - Statement Id: [DAO00308_GetTiepNhanID] PreparedStatement : [select top 1 TN.TIEPNHAN_ID, TN.SOTIEPNHAN        from TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV        inner join TT_TIEPNHAN TN on TN.TIEPNHAN_ID = HD_DV.TIEPNHAN_ID        where HD_DV.HOPDONG_BENHNHAN_ID = 203 and HD_DV.HOPDONG_ID = 3]
2019-12-10 10:47:43,842 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '203'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:47:47,585 [1] DEBUG - Statement Id: [DAO00308_DeleteDVYeuCauAndVienPhi] PreparedStatement : [delete from TT_DVYEUCAU where TIEPNHAN_ID = 27475        delete from TT_VIENPHI where TIEPNHAN_ID = 27475]
2019-12-10 10:47:56,811 [1] DEBUG - Statement Id: [DAOLOG01_LockBegin] PreparedStatement : [INSERT into TT_LOG_UPDATE ( REF_TABLE , REF_ID , BENHVIEN_ID )         values ( @param0 ,  @param1 ,  @param2 );]
2019-12-10 10:47:56,811 [1] DEBUG - Statement Id: [DAOLOG01_LockBegin] Parameters: [@param0=[REF_TABLE,TT_TIEPNHAN_BENHAN], @param1=[REF_ID,27475], @param2=[BENHVIEN_ID,HLU01]]
2019-12-10 10:47:56,811 [1] DEBUG - Statement Id: [DAOLOG01_LockBegin] Types: [@param0=[String, System.String], @param1=[Int64, System.Int64], @param2=[String, System.String]]
2019-12-10 10:47:56,852 [1] DEBUG - Statement Id: [DAO00019_CheckTiepNhanExistNextStep] PreparedStatement : [select T1.STATUS_TN        from        (        select top 1 'NHAPVIEN' AS STATUS_TN        from TT_NOITRU_NHAPVIEN        where (BENHVIEN_ID = 'HLU01' AND TIEPNHAN_ID = '27475')        ORDER BY NHAPVIEN_ID DESC        ) AS T1        UNION ALL        select T2.STATUS_TN        from        (        select top 1 'CDCLS' AS STATUS_TN        from TT_DVYEUCAU        where BENHVIEN_ID = 'HLU01' AND TIEPNHAN_ID = '27475'        ORDER BY DVYEUCAU_ID DESC        ) AS T2        UNION ALL        select T3.STATUS_TN        from        (        select top 1 'TTVP' AS STATUS_TN        from TT_VIENPHI        where BENHVIEN_ID = 'HLU01' AND TIEPNHAN_ID = '27475'        ORDER BY VIENPHI_ID DESC        ) AS T3]
2019-12-10 10:47:57,017 [1] DEBUG - Statement Id: [DAO00019_Delete] PreparedStatement : [delete from TT_TIEPNHAN        where TIEPNHAN_ID = '27475']
2019-12-10 10:48:24,323 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '27475' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-12-10 10:48:28,255 [1] DEBUG - Statement Id: [DAOLOG01_LockEnd] PreparedStatement : [DELETE TT_LOG_UPDATE        where REF_TABLE = 'TT_TIEPNHAN_BENHAN' and REF_ID = '27475' and BENHVIEN_ID = 'HLU01']
2019-12-10 10:48:28,282 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 37          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 203]
2019-12-10 10:48:28,283 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,null], @param1=[DVYEUCAU_ID,null], @param2=[VIENPHI_ID,null], @param3=[SOPHIEUYEUCAU,null], @param4=[TRANGTHAI,null], @param5=[NGAYCAPNHAT,12/10/2019 10:48:28 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,null]]
2019-12-10 10:48:28,283 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[System.DBNull, null], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[System.DBNull, null], @param4=[System.DBNull, null], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[System.DBNull, null]]
2019-12-10 10:48:28,457 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 38          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 203]
2019-12-10 10:48:28,457 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,null], @param1=[DVYEUCAU_ID,null], @param2=[VIENPHI_ID,null], @param3=[SOPHIEUYEUCAU,null], @param4=[TRANGTHAI,null], @param5=[NGAYCAPNHAT,12/10/2019 10:48:28 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,null]]
2019-12-10 10:48:28,457 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[System.DBNull, null], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[System.DBNull, null], @param4=[System.DBNull, null], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[System.DBNull, null]]
2019-12-10 10:48:28,492 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 39          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 203]
2019-12-10 10:48:28,492 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,null], @param1=[DVYEUCAU_ID,null], @param2=[VIENPHI_ID,null], @param3=[SOPHIEUYEUCAU,null], @param4=[TRANGTHAI,null], @param5=[NGAYCAPNHAT,12/10/2019 10:48:28 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,null]]
2019-12-10 10:48:28,492 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[System.DBNull, null], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[System.DBNull, null], @param4=[System.DBNull, null], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[System.DBNull, null]]
2019-12-10 10:48:28,526 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 40          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 203]
2019-12-10 10:48:28,526 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,null], @param1=[DVYEUCAU_ID,null], @param2=[VIENPHI_ID,null], @param3=[SOPHIEUYEUCAU,null], @param4=[TRANGTHAI,null], @param5=[NGAYCAPNHAT,12/10/2019 10:48:28 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,null]]
2019-12-10 10:48:28,526 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[System.DBNull, null], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[System.DBNull, null], @param4=[System.DBNull, null], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[System.DBNull, null]]
2019-12-10 10:48:28,561 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 41          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 203]
2019-12-10 10:48:28,561 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,null], @param1=[DVYEUCAU_ID,null], @param2=[VIENPHI_ID,null], @param3=[SOPHIEUYEUCAU,null], @param4=[TRANGTHAI,null], @param5=[NGAYCAPNHAT,12/10/2019 10:48:28 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,null]]
2019-12-10 10:48:28,561 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[System.DBNull, null], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[System.DBNull, null], @param4=[System.DBNull, null], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[System.DBNull, null]]
2019-12-10 10:48:28,594 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 42          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 203]
2019-12-10 10:48:28,595 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,null], @param1=[DVYEUCAU_ID,null], @param2=[VIENPHI_ID,null], @param3=[SOPHIEUYEUCAU,null], @param4=[TRANGTHAI,null], @param5=[NGAYCAPNHAT,12/10/2019 10:48:28 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,null]]
2019-12-10 10:48:28,595 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[System.DBNull, null], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[System.DBNull, null], @param4=[System.DBNull, null], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[System.DBNull, null]]
2019-12-10 10:48:28,629 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 43          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 203]
2019-12-10 10:48:28,629 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,null], @param1=[DVYEUCAU_ID,null], @param2=[VIENPHI_ID,null], @param3=[SOPHIEUYEUCAU,null], @param4=[TRANGTHAI,null], @param5=[NGAYCAPNHAT,12/10/2019 10:48:28 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,null]]
2019-12-10 10:48:28,629 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[System.DBNull, null], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[System.DBNull, null], @param4=[System.DBNull, null], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[System.DBNull, null]]
2019-12-10 10:48:28,664 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 44          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 203]
2019-12-10 10:48:28,664 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,null], @param1=[DVYEUCAU_ID,null], @param2=[VIENPHI_ID,null], @param3=[SOPHIEUYEUCAU,null], @param4=[TRANGTHAI,null], @param5=[NGAYCAPNHAT,12/10/2019 10:48:28 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,null]]
2019-12-10 10:48:28,664 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[System.DBNull, null], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[System.DBNull, null], @param4=[System.DBNull, null], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[System.DBNull, null]]
2019-12-10 10:48:28,698 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 45          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 203]
2019-12-10 10:48:28,698 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,null], @param1=[DVYEUCAU_ID,null], @param2=[VIENPHI_ID,null], @param3=[SOPHIEUYEUCAU,null], @param4=[TRANGTHAI,null], @param5=[NGAYCAPNHAT,12/10/2019 10:48:28 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,null]]
2019-12-10 10:48:28,698 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[System.DBNull, null], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[System.DBNull, null], @param4=[System.DBNull, null], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[System.DBNull, null]]
2019-12-10 10:48:28,921 [1] DEBUG - Statement Id: [DAO00307_GetPatientConfirms] PreparedStatement : [select distinct HD_BN.*        , CASE WHEN HD_BN.GIOITINH = '1' THEN N'Nam' ELSE N'Nữ' END AS GENDER        , CASE WHEN HD_DV.ACTIVE IS NULL THEN 0 ELSE 1 END BENHNHAN_DANGKYKSK_DICHVU        , case when HD_BN.GOI_ID is null then N'Hợp đồng:' + ' ' + HD.SO_HD else N'Gói khám:' + ' ' + G.TENGOI end as DOITUONG        , LST.DICTIONARY_NAME as HONNHAN        from TT_KSK_HOPDONG HD        inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        left join LST_DICTIONARY LST ON LST.DICTIONARY_ID = HD_BN.TINHTRANGHONNHAN_ID AND LST.DICTIONARY_TYPE_CODE = 'TinhTrangGiaDinh'        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        left join TT_TIEPNHAN TN on TN.TIEPNHAN_ID = HD_DV.TIEPNHAN_ID        left join TM_CSKH_GOI G ON G.GOI_ID = HD_BN.GOI_ID        where HD.HOPDONG_ID = '3'         AND           HD.BENHVIEN_ID = 'HLU01'                 order by HD_BN.STT]
2019-12-10 10:48:29,023 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '203'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:49:09,882 [1] DEBUG - Statement Id: [DAO00308_GetTiepNhanID] PreparedStatement : [select top 1 TN.TIEPNHAN_ID, TN.SOTIEPNHAN        from TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV        inner join TT_TIEPNHAN TN on TN.TIEPNHAN_ID = HD_DV.TIEPNHAN_ID        where HD_DV.HOPDONG_BENHNHAN_ID = 204 and HD_DV.HOPDONG_ID = 3]
2019-12-10 10:49:10,014 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '204'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:49:13,045 [1] DEBUG - Statement Id: [DAO00308_DeleteDVYeuCauAndVienPhi] PreparedStatement : [delete from TT_DVYEUCAU where TIEPNHAN_ID = 27476        delete from TT_VIENPHI where TIEPNHAN_ID = 27476]
2019-12-10 10:49:13,534 [1] DEBUG - Statement Id: [DAOLOG01_LockBegin] PreparedStatement : [INSERT into TT_LOG_UPDATE ( REF_TABLE , REF_ID , BENHVIEN_ID )         values ( @param0 ,  @param1 ,  @param2 );]
2019-12-10 10:49:13,534 [1] DEBUG - Statement Id: [DAOLOG01_LockBegin] Parameters: [@param0=[REF_TABLE,TT_TIEPNHAN_BENHAN], @param1=[REF_ID,27476], @param2=[BENHVIEN_ID,HLU01]]
2019-12-10 10:49:13,534 [1] DEBUG - Statement Id: [DAOLOG01_LockBegin] Types: [@param0=[String, System.String], @param1=[Int64, System.Int64], @param2=[String, System.String]]
2019-12-10 10:49:13,562 [1] DEBUG - Statement Id: [DAO00019_CheckTiepNhanExistNextStep] PreparedStatement : [select T1.STATUS_TN        from        (        select top 1 'NHAPVIEN' AS STATUS_TN        from TT_NOITRU_NHAPVIEN        where (BENHVIEN_ID = 'HLU01' AND TIEPNHAN_ID = '27476')        ORDER BY NHAPVIEN_ID DESC        ) AS T1        UNION ALL        select T2.STATUS_TN        from        (        select top 1 'CDCLS' AS STATUS_TN        from TT_DVYEUCAU        where BENHVIEN_ID = 'HLU01' AND TIEPNHAN_ID = '27476'        ORDER BY DVYEUCAU_ID DESC        ) AS T2        UNION ALL        select T3.STATUS_TN        from        (        select top 1 'TTVP' AS STATUS_TN        from TT_VIENPHI        where BENHVIEN_ID = 'HLU01' AND TIEPNHAN_ID = '27476'        ORDER BY VIENPHI_ID DESC        ) AS T3]
2019-12-10 10:49:13,612 [1] DEBUG - Statement Id: [DAO00019_Delete] PreparedStatement : [delete from TT_TIEPNHAN        where TIEPNHAN_ID = '27476']
2019-12-10 10:49:15,217 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '27476' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-12-10 10:49:15,802 [1] DEBUG - Statement Id: [DAOLOG01_LockEnd] PreparedStatement : [DELETE TT_LOG_UPDATE        where REF_TABLE = 'TT_TIEPNHAN_BENHAN' and REF_ID = '27476' and BENHVIEN_ID = 'HLU01']
2019-12-10 10:49:15,830 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 46          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 204]
2019-12-10 10:49:15,830 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,null], @param1=[DVYEUCAU_ID,null], @param2=[VIENPHI_ID,null], @param3=[SOPHIEUYEUCAU,null], @param4=[TRANGTHAI,null], @param5=[NGAYCAPNHAT,12/10/2019 10:49:15 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,null]]
2019-12-10 10:49:15,830 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[System.DBNull, null], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[System.DBNull, null], @param4=[System.DBNull, null], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[System.DBNull, null]]
2019-12-10 10:49:15,864 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 47          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 204]
2019-12-10 10:49:15,864 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,null], @param1=[DVYEUCAU_ID,null], @param2=[VIENPHI_ID,null], @param3=[SOPHIEUYEUCAU,null], @param4=[TRANGTHAI,null], @param5=[NGAYCAPNHAT,12/10/2019 10:49:15 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,null]]
2019-12-10 10:49:15,865 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[System.DBNull, null], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[System.DBNull, null], @param4=[System.DBNull, null], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[System.DBNull, null]]
2019-12-10 10:49:15,897 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 48          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 204]
2019-12-10 10:49:15,898 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,null], @param1=[DVYEUCAU_ID,null], @param2=[VIENPHI_ID,null], @param3=[SOPHIEUYEUCAU,null], @param4=[TRANGTHAI,null], @param5=[NGAYCAPNHAT,12/10/2019 10:49:15 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,null]]
2019-12-10 10:49:15,898 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[System.DBNull, null], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[System.DBNull, null], @param4=[System.DBNull, null], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[System.DBNull, null]]
2019-12-10 10:49:15,933 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 49          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 204]
2019-12-10 10:49:15,933 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,null], @param1=[DVYEUCAU_ID,null], @param2=[VIENPHI_ID,null], @param3=[SOPHIEUYEUCAU,null], @param4=[TRANGTHAI,null], @param5=[NGAYCAPNHAT,12/10/2019 10:49:15 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,null]]
2019-12-10 10:49:15,933 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[System.DBNull, null], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[System.DBNull, null], @param4=[System.DBNull, null], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[System.DBNull, null]]
2019-12-10 10:49:15,968 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 50          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 204]
2019-12-10 10:49:15,968 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,null], @param1=[DVYEUCAU_ID,null], @param2=[VIENPHI_ID,null], @param3=[SOPHIEUYEUCAU,null], @param4=[TRANGTHAI,null], @param5=[NGAYCAPNHAT,12/10/2019 10:49:15 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,null]]
2019-12-10 10:49:15,968 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[System.DBNull, null], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[System.DBNull, null], @param4=[System.DBNull, null], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[System.DBNull, null]]
2019-12-10 10:49:16,003 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 51          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 204]
2019-12-10 10:49:16,003 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,null], @param1=[DVYEUCAU_ID,null], @param2=[VIENPHI_ID,null], @param3=[SOPHIEUYEUCAU,null], @param4=[TRANGTHAI,null], @param5=[NGAYCAPNHAT,12/10/2019 10:49:16 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,null]]
2019-12-10 10:49:16,003 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[System.DBNull, null], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[System.DBNull, null], @param4=[System.DBNull, null], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[System.DBNull, null]]
2019-12-10 10:49:16,038 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 52          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 204]
2019-12-10 10:49:16,038 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,null], @param1=[DVYEUCAU_ID,null], @param2=[VIENPHI_ID,null], @param3=[SOPHIEUYEUCAU,null], @param4=[TRANGTHAI,null], @param5=[NGAYCAPNHAT,12/10/2019 10:49:16 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,null]]
2019-12-10 10:49:16,038 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[System.DBNull, null], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[System.DBNull, null], @param4=[System.DBNull, null], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[System.DBNull, null]]
2019-12-10 10:49:16,075 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 53          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 204]
2019-12-10 10:49:16,075 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,null], @param1=[DVYEUCAU_ID,null], @param2=[VIENPHI_ID,null], @param3=[SOPHIEUYEUCAU,null], @param4=[TRANGTHAI,null], @param5=[NGAYCAPNHAT,12/10/2019 10:49:16 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,null]]
2019-12-10 10:49:16,075 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[System.DBNull, null], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[System.DBNull, null], @param4=[System.DBNull, null], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[System.DBNull, null]]
2019-12-10 10:49:16,109 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 54          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 204]
2019-12-10 10:49:16,109 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,null], @param1=[DVYEUCAU_ID,null], @param2=[VIENPHI_ID,null], @param3=[SOPHIEUYEUCAU,null], @param4=[TRANGTHAI,null], @param5=[NGAYCAPNHAT,12/10/2019 10:49:16 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,null]]
2019-12-10 10:49:16,109 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[System.DBNull, null], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[System.DBNull, null], @param4=[System.DBNull, null], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[System.DBNull, null]]
2019-12-10 10:49:16,322 [1] DEBUG - Statement Id: [DAO00307_GetPatientConfirms] PreparedStatement : [select distinct HD_BN.*        , CASE WHEN HD_BN.GIOITINH = '1' THEN N'Nam' ELSE N'Nữ' END AS GENDER        , CASE WHEN HD_DV.ACTIVE IS NULL THEN 0 ELSE 1 END BENHNHAN_DANGKYKSK_DICHVU        , case when HD_BN.GOI_ID is null then N'Hợp đồng:' + ' ' + HD.SO_HD else N'Gói khám:' + ' ' + G.TENGOI end as DOITUONG        , LST.DICTIONARY_NAME as HONNHAN        from TT_KSK_HOPDONG HD        inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        left join LST_DICTIONARY LST ON LST.DICTIONARY_ID = HD_BN.TINHTRANGHONNHAN_ID AND LST.DICTIONARY_TYPE_CODE = 'TinhTrangGiaDinh'        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        left join TT_TIEPNHAN TN on TN.TIEPNHAN_ID = HD_DV.TIEPNHAN_ID        left join TM_CSKH_GOI G ON G.GOI_ID = HD_BN.GOI_ID        where HD.HOPDONG_ID = '3'         AND           HD.BENHVIEN_ID = 'HLU01'                 order by HD_BN.STT]
2019-12-10 10:49:16,386 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '204'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:49:18,626 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '203'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:49:18,750 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '203'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:49:29,551 [1] DEBUG - Statement Id: [DAO00307_GetContractWithDate] PreparedStatement : [SELECT HD.*, HD.SO_HD + ' - ' + CT.TENCONGTY AS HOPDONG, CT.TENCONGTY        FROM TT_KSK_HOPDONG HD JOIN TT_KSK_CONGTY CT ON CT.CONGTY_ID = HD.CONGTY_ID         where                 HD.BENHVIEN_ID = 'HLU01']
2019-12-10 10:49:30,366 [1] DEBUG - Statement Id: [DAO00307_GetContractWithDate] PreparedStatement : [SELECT HD.*, HD.SO_HD + ' - ' + CT.TENCONGTY AS HOPDONG, CT.TENCONGTY        FROM TT_KSK_HOPDONG HD JOIN TT_KSK_CONGTY CT ON CT.CONGTY_ID = HD.CONGTY_ID         where                 HD.BENHVIEN_ID = 'HLU01']
2019-12-10 10:49:30,498 [1] DEBUG - Statement Id: [DAO00307_GetContractWithDate] PreparedStatement : [SELECT HD.*, HD.SO_HD + ' - ' + CT.TENCONGTY AS HOPDONG, CT.TENCONGTY        FROM TT_KSK_HOPDONG HD JOIN TT_KSK_CONGTY CT ON CT.CONGTY_ID = HD.CONGTY_ID         where                 HD.BENHVIEN_ID = 'HLU01']
2019-12-10 10:49:30,554 [1] DEBUG - Statement Id: [DAO00307_GetContractWithDate] PreparedStatement : [SELECT HD.*, HD.SO_HD + ' - ' + CT.TENCONGTY AS HOPDONG, CT.TENCONGTY        FROM TT_KSK_HOPDONG HD JOIN TT_KSK_CONGTY CT ON CT.CONGTY_ID = HD.CONGTY_ID         where                 HD.BENHVIEN_ID = 'HLU01']
2019-12-10 10:49:35,713 [1] DEBUG - Statement Id: [DAO00020_ListKhoDuocOfPhongBan] PreparedStatement : [select B.* from TM_PHONGBAN_KHODUOC A        inner join TM_KHODUOC B on B.KHODUOC_ID = A.KHODUOC_ID        where        A.PHONGBAN_ID = '62'        and A.BENHVIEN_ID = 'HLU01']
2019-12-10 10:49:40,146 [1] DEBUG - Statement Id: [DAO00020_ListKhoDuocOfPhongBan] PreparedStatement : [select B.* from TM_PHONGBAN_KHODUOC A        inner join TM_KHODUOC B on B.KHODUOC_ID = A.KHODUOC_ID        where        A.PHONGBAN_ID = '68'        and A.BENHVIEN_ID = 'HLU01']
2019-12-10 10:49:41,186 [1] DEBUG - Statement Id: [DAO00008_UpdateUserIdPhongBanKhoDuoc] PreparedStatement : [IF EXISTS            (SELECT ACCOUNT_ID FROM TM_SYS_USERS WHERE ACCOUNT_ID =  @param0  and HOSPITAL_ID =  @param1 )            BEGIN            update TM_SYS_USERS set INVENTORY_ID =  @param2 , WORKING_DEPT_ID =  @param3             WHERE ACCOUNT_ID =  @param0  and HOSPITAL_ID =  @param1             END            ELSE            BEGIN            insert into TM_SYS_USERS ([ACCOUNT_ID], [ACCOUNT_NAME], [INVENTORY_ID], [WORKING_DEPT_ID], [HOSPITAL_ID])            values ( @param0 ,  @param4 ,  @param2 ,  @param3 ,  @param1 )            END]
2019-12-10 10:49:41,186 [1] DEBUG - Statement Id: [DAO00008_UpdateUserIdPhongBanKhoDuoc] Parameters: [@param0=[ACCOUNT_ID,113], @param1=[HOSPITAL_ID,HLU01], @param2=[INVENTORY_ID,35], @param3=[WORKING_DEPT_ID,68], @param4=[ACCOUNT_NAME,admin]]
2019-12-10 10:49:41,186 [1] DEBUG - Statement Id: [DAO00008_UpdateUserIdPhongBanKhoDuoc] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[String, System.String], @param3=[String, System.String], @param4=[String, System.String]]
2019-12-10 10:49:50,487 [1] DEBUG - Statement Id: [DAO00307_GetContractWithDate] PreparedStatement : [SELECT HD.*, HD.SO_HD + ' - ' + CT.TENCONGTY AS HOPDONG, CT.TENCONGTY        FROM TT_KSK_HOPDONG HD JOIN TT_KSK_CONGTY CT ON CT.CONGTY_ID = HD.CONGTY_ID         where                 HD.BENHVIEN_ID = 'HLU01']
2019-12-10 10:49:50,529 [1] DEBUG - Statement Id: [DAO00307_GetContractWithDate] PreparedStatement : [SELECT HD.*, HD.SO_HD + ' - ' + CT.TENCONGTY AS HOPDONG, CT.TENCONGTY        FROM TT_KSK_HOPDONG HD JOIN TT_KSK_CONGTY CT ON CT.CONGTY_ID = HD.CONGTY_ID         where                 HD.BENHVIEN_ID = 'HLU01']
2019-12-10 10:49:50,638 [1] DEBUG - Statement Id: [DAO00307_GetContractWithDate] PreparedStatement : [SELECT HD.*, HD.SO_HD + ' - ' + CT.TENCONGTY AS HOPDONG, CT.TENCONGTY        FROM TT_KSK_HOPDONG HD JOIN TT_KSK_CONGTY CT ON CT.CONGTY_ID = HD.CONGTY_ID         where                 HD.BENHVIEN_ID = 'HLU01']
2019-12-10 10:49:50,678 [1] DEBUG - Statement Id: [DAO00307_GetContractWithDate] PreparedStatement : [SELECT HD.*, HD.SO_HD + ' - ' + CT.TENCONGTY AS HOPDONG, CT.TENCONGTY        FROM TT_KSK_HOPDONG HD JOIN TT_KSK_CONGTY CT ON CT.CONGTY_ID = HD.CONGTY_ID         where                 HD.BENHVIEN_ID = 'HLU01']
2019-12-10 10:49:54,473 [1] DEBUG - Statement Id: [DAO00307_GetPatientConfirms] PreparedStatement : [select distinct HD_BN.*        , CASE WHEN HD_BN.GIOITINH = '1' THEN N'Nam' ELSE N'Nữ' END AS GENDER        , CASE WHEN HD_DV.ACTIVE IS NULL THEN 0 ELSE 1 END BENHNHAN_DANGKYKSK_DICHVU        , case when HD_BN.GOI_ID is null then N'Hợp đồng:' + ' ' + HD.SO_HD else N'Gói khám:' + ' ' + G.TENGOI end as DOITUONG        , LST.DICTIONARY_NAME as HONNHAN        from TT_KSK_HOPDONG HD        inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        left join LST_DICTIONARY LST ON LST.DICTIONARY_ID = HD_BN.TINHTRANGHONNHAN_ID AND LST.DICTIONARY_TYPE_CODE = 'TinhTrangGiaDinh'        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        left join TT_TIEPNHAN TN on TN.TIEPNHAN_ID = HD_DV.TIEPNHAN_ID        left join TM_CSKH_GOI G ON G.GOI_ID = HD_BN.GOI_ID        where HD.HOPDONG_ID = '3'         AND           HD.BENHVIEN_ID = 'HLU01'                 order by HD_BN.STT]
2019-12-10 10:49:55,824 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '203'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:49:55,948 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '203'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:50:00,644 [1] DEBUG - Statement Id: [DAO00307_CheckSingin] PreparedStatement : [select *        from TT_KSK_HOPDONG_BENHNHAN_DICHVU         where                 HOPDONG_ID = 3             and               HOPDONG_BENHNHAN_ID = 203             and               BENHVIEN_ID = 'HLU01']
2019-12-10 10:50:00,718 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '203'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:50:00,780 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '203'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:50:00,849 [1] DEBUG - Statement Id: [DAOLOG01_LockBegin] PreparedStatement : [INSERT into TT_LOG_UPDATE ( REF_TABLE , REF_ID , BENHVIEN_ID )         values ( @param0 ,  @param1 ,  @param2 );]
2019-12-10 10:50:00,849 [1] DEBUG - Statement Id: [DAOLOG01_LockBegin] Parameters: [@param0=[REF_TABLE,TT_TIEPNHAN_BENHAN], @param1=[REF_ID,23420], @param2=[BENHVIEN_ID,HLU01]]
2019-12-10 10:50:00,850 [1] DEBUG - Statement Id: [DAOLOG01_LockBegin] Types: [@param0=[String, System.String], @param1=[Int64, System.Int64], @param2=[String, System.String]]
2019-12-10 10:50:07,688 [1] DEBUG - Statement Id: [DAO00013_GetPatientInfo] PreparedStatement : [select *        from TT_BENHNHAN        where MAYTE  = '190043301']
2019-12-10 10:50:08,676 [1] DEBUG - Statement Id: [DAO00095_GetListNguoiLienHe] PreparedStatement : [SELECT BNN.*, D.DICTIONARY_NAME AS TENQUANHE          FROM TT_BENHNHAN AS BN          INNER JOIN TT_BENHNHAN_NGUOILIENHE AS BNN ON BNN.BENHNHAN_ID = BN.BENHNHAN_ID          LEFT JOIN LST_DICTIONARY AS D ON D.DICTIONARY_ID = BNN.QUANHE_ID AND D.DICTIONARY_TYPE_CODE = 'QuanHeGiaDinh'          WHERE BN.MAYTE = '190043301' AND BN.ACTIVE = '1' AND BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:50:09,005 [1] DEBUG - Statement Id: [DAO00307_UpdatePatientKSK] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN set        MAYTE =  @param0         , TENBENHNHAN =  @param1         , GIOITINH =  @param2         , NGAYSINH =  @param3         , NAMSINH =  @param4         , DIACHI =  @param5         , QUOCTICH_ID =  @param6         , TINHTHANH_ID =  @param7         , QUANHUYEN_ID =  @param8         , XAPHUONG_ID =  @param9         , DIACHITHUONGTRU =  @param10         , DANTOC_ID =  @param11         , SODIENTHOAI =  @param12         , NGHENGHIEP_ID =  @param13         , CMND =  @param14         , NGAYCAPNHAT =  @param15         , NGUOICAPNHAT_ID =  @param16         where        BENHNHAN_ID = '23420']
2019-12-10 10:50:09,005 [1] DEBUG - Statement Id: [DAO00307_UpdatePatientKSK] Parameters: [@param0=[MAYTE,190043301], @param1=[TENBENHNHAN,Test Fpt01], @param2=[GIOITINH,1], @param3=[NGAYSINH,3/1/1995 12:00:00 AM], @param4=[NAMSINH,1995], @param5=[DIACHI,null], @param6=[QUOCTICH_ID,null], @param7=[TINHTHANH_ID,null], @param8=[QUANHUYEN_ID,null], @param9=[XAPHUONG_ID,null], @param10=[DIACHITHUONGTRU,null], @param11=[DANTOC_ID,null], @param12=[SODIENTHOAI,null], @param13=[NGHENGHIEP_ID,null], @param14=[CMND,null], @param15=[NGAYCAPNHAT,12/10/2019 12:00:00 AM], @param16=[NGUOICAPNHAT_ID,1]]
2019-12-10 10:50:09,005 [1] DEBUG - Statement Id: [DAO00307_UpdatePatientKSK] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[Int64, System.Int64], @param3=[DateTime, System.DateTime], @param4=[Int64, System.Int64], @param5=[System.DBNull, null], @param6=[System.DBNull, null], @param7=[System.DBNull, null], @param8=[System.DBNull, null], @param9=[System.DBNull, null], @param10=[System.DBNull, null], @param11=[System.DBNull, null], @param12=[System.DBNull, null], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[DateTime, System.DateTime], @param16=[Int64, System.Int64]]
2019-12-10 10:50:09,048 [1] DEBUG - Statement Id: [DAO00118_Add_BenhNhan] PreparedStatement : [if not exists (select 1 from TT_BENHNHAN where BENHNHAN_ID = '23420')              insert into TT_BENHNHAN (              BENHNHAN_ID              , MAYTE              , SOVAOVIEN              , TENBENHNHAN              , HO              , TEN              , GIOITINH              , NGAYSINH              , NAMSINH              , SONHA              , DIACHI              , SODIENTHOAI              , XAPHUONG_ID              , QUANHUYEN_ID              , TINHTHANH_ID              , DANTOC_ID              , QUOCTICH_ID              , SOLUUTRUNOITRU              , SOLUUTRUNGOAITRU              , NGHENGHIEP_ID              , CMND              , HOCHIEU              , VIETKIEU              , NGUOINUOCNGOAI              , DIACHITHUONGTRU              , DIACHILIENLAC              , DIACHICOQUAN              , EMAIL              , NHOMMAU_ID              , YEUTORH_ID              , TIENSUDIUNG              , TIENSUBENH              , TIENSUHUTTHUOCLA              , TUVONG              , NGAYTUVONG              , THOIGIANTUVONG              , NGUYENNHANTUVONG_ID              , NGUOIGHINHANTUVONG_ID              , THOIGIANGHINHANTUVONG              , NHANVIEN_ID              , DONVICONGTAC_ID              , DIENTHOAIBAN              , TINHTRANGHONNHAN_ID              , NGUOILIENHE_ID              , MOIQUANHE_ID              , NGUOILIENHE              , THONGTIN_NLH              , GHICHU              , HINHANH_DAIDIEN              , BENHVIEN_ID              , NGAYTAO              , NGUOITAO_ID              , NGAYGIOSINH              ) values (               @param0               ,  @param1               ,  @param2               ,  @param3               ,  @param4               ,  @param5               ,  @param6               ,  @param7               ,  @param8               ,  @param9               ,  @param10               ,  @param11               ,  @param12               ,  @param13               ,  @param14               ,  @param15               ,  @param16               ,  @param17               ,  @param18               ,  @param19               ,  @param20               ,  @param21               ,  @param22               ,  @param23               ,  @param24               ,  @param25               ,  @param26               ,  @param27               ,  @param28               ,  @param29               ,  @param30               ,  @param31               ,  @param32               ,  @param33               ,  @param34               ,  @param35               ,  @param36               ,  @param37               ,  @param38               ,  @param39               ,  @param40               ,  @param41               ,  @param42               ,  @param43               ,  @param44               ,  @param45               ,  @param46               ,  @param47               ,  @param48               ,  @param49               ,  @param50               ,  @param51               ,  @param52               )              else              update TT_BENHNHAN set              MAYTE =  @param1                ,                   SOVAOVIEN =  @param2                ,                   TENBENHNHAN =  @param3                ,                   HO =  @param4                ,                   TEN =  @param5                ,                   GIOITINH =  @param6                ,                   NGAYSINH =  @param7                ,                   NAMSINH =  @param8                ,                   SONHA =  @param9                ,                   SODIENTHOAI =  @param11                ,                   XAPHUONG_ID =  @param12                ,                   DANTOC_ID =  @param15                ,                   QUOCTICH_ID =  @param16                ,                   NGHENGHIEP_ID =  @param19                ,                   CMND =  @param20                ,                   HOCHIEU =  @param21                ,                   DIACHITHUONGTRU =  @param24                ,                   DIACHILIENLAC =  @param25                ,                   NGUOILIENHE_ID =  @param43                ,                   MOIQUANHE_ID =  @param44                ,                   NGUOILIENHE =  @param45                ,                   THONGTIN_NLH =  @param46                ,                   GHICHU =  @param47                ,                   BENHVIEN_ID =  @param49                ,                   NGAYCAPNHAT =  @param53                ,                   NGUOICAPNHAT_ID =  @param54                              where              BENHNHAN_ID = '23420']
2019-12-10 10:50:09,092 [1] DEBUG - Statement Id: [DAO00118_Add_BenhNhan] Parameters: [@param0=[BENHNHAN_ID,23420], @param1=[MAYTE,190043301], @param2=[SOVAOVIEN,0043301], @param3=[TENBENHNHAN,Test Fpt01], @param4=[HO,Test], @param5=[TEN,Fpt01], @param6=[GIOITINH,1], @param7=[NGAYSINH,3/1/1995 12:00:00 AM], @param8=[NAMSINH,1995], @param9=[SONHA,null], @param10=[DIACHI,null], @param11=[SODIENTHOAI,null], @param12=[XAPHUONG_ID,null], @param13=[QUANHUYEN_ID,null], @param14=[TINHTHANH_ID,null], @param15=[DANTOC_ID,null], @param16=[QUOCTICH_ID,null], @param17=[SOLUUTRUNOITRU,null], @param18=[SOLUUTRUNGOAITRU,null], @param19=[NGHENGHIEP_ID,null], @param20=[CMND,null], @param21=[HOCHIEU,null], @param22=[VIETKIEU,null], @param23=[NGUOINUOCNGOAI,null], @param24=[DIACHITHUONGTRU,null], @param25=[DIACHILIENLAC,null], @param26=[DIACHICOQUAN,null], @param27=[EMAIL,null], @param28=[NHOMMAU_ID,null], @param29=[YEUTORH_ID,null], @param30=[TIENSUDIUNG,null], @param31=[TIENSUBENH,null], @param32=[TIENSUHUTTHUOCLA,null], @param33=[TUVONG,null], @param34=[NGAYTUVONG,null], @param35=[THOIGIANTUVONG,null], @param36=[NGUYENNHANTUVONG_ID,null], @param37=[NGUOIGHINHANTUVONG_ID,null], @param38=[THOIGIANGHINHANTUVONG,null], @param39=[NHANVIEN_ID,null], @param40=[DONVICONGTAC_ID,null], @param41=[DIENTHOAIBAN,null], @param42=[TINHTRANGHONNHAN_ID,null], @param43=[NGUOILIENHE_ID,null], @param44=[MOIQUANHE_ID,null], @param45=[NGUOILIENHE,null], @param46=[THONGTIN_NLH,null], @param47=[GHICHU,null], @param48=[HINHANH_DAIDIEN,null], @param49=[BENHVIEN_ID,HLU01], @param50=[NGAYTAO,8/26/2019 1:42:46 PM], @param51=[NGUOITAO_ID,1], @param52=[NGAYGIOSINH,null], @param53=[NGAYCAPNHAT,12/10/2019 12:00:00 AM], @param54=[NGUOICAPNHAT_ID,1]]
2019-12-10 10:50:09,092 [1] DEBUG - Statement Id: [DAO00118_Add_BenhNhan] Types: [@param0=[Int32, System.Int32], @param1=[String, System.String], @param2=[String, System.String], @param3=[String, System.String], @param4=[String, System.String], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[DateTime, System.DateTime], @param8=[Int64, System.Int64], @param9=[System.DBNull, null], @param10=[System.DBNull, null], @param11=[System.DBNull, null], @param12=[System.DBNull, null], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[System.DBNull, null], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[System.DBNull, null], @param39=[System.DBNull, null], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[String, System.String], @param50=[DateTime, System.DateTime], @param51=[Int64, System.Int64], @param52=[System.DBNull, null], @param53=[DateTime, System.DateTime], @param54=[Int64, System.Int64]]
2019-12-10 10:50:27,408 [1] DEBUG - Statement Id: [DAOWF001_Laythongtingateways] PreparedStatement : [select * from TM_PROCESS_GATEWAYS]
2019-12-10 10:50:28,790 [1] DEBUG - Statement Id: [DAO00019_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10),        @yearNow int, @monthNow varchar(2), @dayNow varchar(2),        @Sotiepnhan varchar(20), @SoThuTu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @monthNow = RIGHT('00' + convert(varchar(2), MONTH(getdate())),2)        set @dayNow = RIGHT('00' + convert(varchar(2), DAY(getdate())),2)        BEGIN        select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOTIEPNHAN' and KEYYEAR = @yearNow and KEYMONTH = @monthNow and KEYDAY = @dayNow        and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOTIEPNHAN', @yearNow, @monthNow, @dayNow, '0', '0', '0', 0, @BenhVienId);        Update LST_KEYDATA set KEYVALUE = (KEYVALUE + 1), @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOTIEPNHAN' and KEYYEAR = @yearNow and KEYMONTH = @monthNow and KEYDAY = @dayNow and BENHVIEN_ID = @BenhVienId        set @SoThuTu = right('0000000'+convert(varchar(7), @keyValue), 7)        set @Sotiepnhan = 'TN' + RIGHT(@yearNow, 2) + @monthNow  + @dayNow + '.' + @SoThuTu                   insert into TT_TIEPNHAN (        SOTIEPNHAN        , UUTIEN        , BENHNHAN_ID        , BENHVIEN_ID        , TUYENKHAMBENH_ID        , NOITIEPNHAN_ID        , NGAYTIEPNHAN        , THOIGIANTIEPNHAN        , NAMTIEPNHAN        , THANGTIEPNHAN        , DOITUONG_ID        , LYDOTIEPNHAN_ID        , HINHTHUCDENKHAM_ID        , TINHTRANGHEN        , XACNHANCHIPHI_ID        , THUTIENTRUOC        , TAIKHAM        , SOBHYT        , BHYTTUNGAY        , BHYTDENNGAY        , BHYTNGAYCAP        , BHYTTREN3NAM        , BHYTTREN5NAM        , NGAYMIENDONGCHITRA        , LOAIBHYT        , NGAYBHYT2        , SOCHUYENVIEN        , HINHTHUCCHUYENVIEN_ID        , NOIGIOITHIEU_ID        , NGUOIGIOITHIEU_ID        , THOIGIANCHUYENTUYEN        , LYDOCHUYENVIEN_ID        , ICDNOIGIOITHIEU_ID        , CHANDOANNGT        , TRAITUYEN        , DIACHILIENHE        , XAPHUONG_ID        , QUANHUYEN_ID        , TINHTHANH_ID        , PROCESS_ID        , TRANGTHAI        , KHUVUCSONG_ID        , THANHVIEN_ID        , THE_ID        , LOAITHANHVIEN_ID        , SUDUNG_BHTN        , VIP        , GHICHU_TIEPNHAN        , BAOLANH_VIENPHI        , CONGTY_CHITRA_ID        , NGUON_BENHNHAN_ID        , LOAITIEPNHAN_ID        , THONGTIN_KCB_BHYT        , NGAYTAO        , NGUOITAO_ID        , LYDODENKHAM         ,           ISTHONGTUYEN                 )        OUTPUT INSERTED.TIEPNHAN_ID, INSERTED.SOTIEPNHAN        values (        @Sotiepnhan        ,  @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54          ,            @param55                  )        end]
2019-12-10 10:50:28,790 [1] DEBUG - Statement Id: [DAO00019_Add] Parameters: [@param0=[UUTIEN,0], @param1=[BENHNHAN_ID,23420], @param2=[BENHVIEN_ID,HLU01], @param3=[TUYENKHAMBENH_ID,null], @param4=[NOITIEPNHAN_ID,68], @param5=[NGAYTIEPNHAN,12/10/2019 12:00:00 AM], @param6=[THOIGIANTIEPNHAN,12/10/2019 12:00:00 AM], @param7=[NAMTIEPNHAN,2019], @param8=[THANGTIEPNHAN,12], @param9=[DOITUONG_ID,1], @param10=[LYDOTIEPNHAN_ID,null], @param11=[HINHTHUCDENKHAM_ID,461], @param12=[TINHTRANGHEN,null], @param13=[XACNHANCHIPHI_ID,null], @param14=[THUTIENTRUOC,null], @param15=[TAIKHAM,0], @param16=[SOBHYT,null], @param17=[BHYTTUNGAY,null], @param18=[BHYTDENNGAY,null], @param19=[BHYTNGAYCAP,null], @param20=[BHYTTREN3NAM,0], @param21=[BHYTTREN5NAM,0], @param22=[NGAYMIENDONGCHITRA,null], @param23=[LOAIBHYT,null], @param24=[NGAYBHYT2,null], @param25=[SOCHUYENVIEN,null], @param26=[HINHTHUCCHUYENVIEN_ID,null], @param27=[NOIGIOITHIEU_ID,null], @param28=[NGUOIGIOITHIEU_ID,null], @param29=[THOIGIANCHUYENTUYEN,null], @param30=[LYDOCHUYENVIEN_ID,null], @param31=[ICDNOIGIOITHIEU_ID,null], @param32=[CHANDOANNGT,null], @param33=[TRAITUYEN,0], @param34=[DIACHILIENHE,null], @param35=[XAPHUONG_ID,null], @param36=[QUANHUYEN_ID,null], @param37=[TINHTHANH_ID,null], @param38=[PROCESS_ID,P01], @param39=[TRANGTHAI,DATIEPNHAN], @param40=[KHUVUCSONG_ID,null], @param41=[THANHVIEN_ID,null], @param42=[THE_ID,null], @param43=[LOAITHANHVIEN_ID,null], @param44=[SUDUNG_BHTN,0], @param45=[VIP,0], @param46=[GHICHU_TIEPNHAN,null], @param47=[BAOLANH_VIENPHI,0], @param48=[CONGTY_CHITRA_ID,null], @param49=[NGUON_BENHNHAN_ID,null], @param50=[LOAITIEPNHAN_ID,null], @param51=[THONGTIN_KCB_BHYT,null], @param52=[NGAYTAO,12/10/2019 10:50:28 AM], @param53=[NGUOITAO_ID,1], @param54=[LYDODENKHAM,null], @param55=[ISTHONGTUYEN,0]]
2019-12-10 10:50:28,791 [1] DEBUG - Statement Id: [DAO00019_Add] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[String, System.String], @param3=[System.DBNull, null], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[DateTime, System.DateTime], @param7=[Int32, System.Int32], @param8=[Int32, System.Int32], @param9=[Int64, System.Int64], @param10=[System.DBNull, null], @param11=[Int64, System.Int64], @param12=[System.DBNull, null], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[String, System.String], @param21=[String, System.String], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[String, System.String], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[String, System.String], @param45=[String, System.String], @param46=[System.DBNull, null], @param47=[String, System.String], @param48=[System.DBNull, null], @param49=[System.DBNull, null], @param50=[System.DBNull, null], @param51=[System.DBNull, null], @param52=[DateTime, System.DateTime], @param53=[Int64, System.Int64], @param54=[System.DBNull, null], @param55=[String, System.String]]
2019-12-10 10:50:28,865 [1] DEBUG - Statement Id: [DAO00019_GetTTTiepNhan_byTiepNhanId] PreparedStatement : [select *        from TT_TIEPNHAN        where TIEPNHAN_ID = '28482'        order by TIEPNHAN_ID]
2019-12-10 10:50:28,944 [1] DEBUG - Statement Id: [DAO00080_Add_KhamBenh_CapCuu] PreparedStatement : [insert into TT_KHAMBENH_VAOVIEN (        SOPHIEU        , TIEPNHAN_ID        , KHAMBENH_ID        , BENHNHAN_ID        , NGUOILIENHE        , DIENTHOAILIENHE        , NOILAMVIEC        , CHANDOANNOIGIOITHIEU        , NGAYKHAM        , THOIGIANKHAM        , LYDOVAOVIEN        , QUATRINHBENHLY        , TIENSUBANTHAN        , TIENSUGIADINH        , KHAMXETTOANTHAN        , KHAMXETCACBOPHAN        , KHAMXETKQLS        , CHANDOANVAO        , ICDKHAMXET_ID        , DAXULY        , NGAYRA        , THOIGIANRA        , NHAPKHOA_ID        , CHUYENVIEN_ID        , CHUY        , MACH        , NHIETDO        , HUYETAPCAO        , HUYETAPTHAP        , NHIPTHO        , CANNANG        , CHIEUCAO        , BACSI_ID        , XUTRUKHAMBENH_ID        , CAPCUU        , NGAYTAINAN        , THOIGIANTAINAN        , NOITAINAN_TINHTHANH_ID        , NOITAINAN_QUANHUYEN_ID        , NOITAINAN_PHUONGXA_ID        , NOITAINAN_DIACHI        , DIADIEMTAINAN_ID        , BOPHANBITHUONG_ID        , MUCDO_ID        , DIENBIENSAUTN_ID        , XUTRISAUTN_ID        , NGUYENNHAN_ID        , NGUYENNHANCHITIET_ID        , ICD_NGUYENNHAN        , NGAYTAO        , NGUOITAO_ID        , NGAYCAPNHAT        , NGUOICAPNHAT_ID        , BENHANCHUYENKHOA        , CHANDOANVAOVIEN        , CHANDOANRAVIEN        , DIEUTRITUNGAY        , DIEUTRIDENNGAY        , DIENBIENLS        , KQXETNGHIEM        , PHAUTHUAT        , THUTHUAT        , TINHTRANGNGUOIBENH        , HUONGDIEUTRI        , NGUOIGIAO_ID        , NGUOINHAN_ID        , XQUANG        , CTSCANNER        , SIEUAM        , XETNGHIEM        , KHAC        , TOANBOHS        , LOAICHUYENKHOA        , CONGANCANTHIEP        , CDRR_BENHCHINH        , CDRR_BENHKEM        , ICD_BENHCHINH        , ICD_BENHKEMTHEO        , PHUONGPHAPDIEUTRI        , FIELD_1        , FIELD_2        , FIELD_3        , FIELD_4        , FIELD_5        , FIELD_6        , FIELD_7        , FIELD_8        , FIELD_9        , FIELD_10        , FIELD_11        , FIELD_12        , FIELD_13        , FIELD_14        , FIELD_15        , FIELD_27        , FIELD_28        , FIELD_29        , FIELD_30        , FIELD_31        , FIELD_32        , FIELD_33        , FIELD_34        , FIELD_35        , FIELD_36        , FIELD_37        , FIELD_38        , FIELD_39        , FIELD_40        , FIELD_41        , FIELD_42        , FIELD_43        , FIELD_44        , FIELD_45        , FIELD_46        , FIELD_47        , FIELD_48        , FIELD_49        , FIELD_50        , FIELD_51        , FIELD_52        , FIELD_53        , FIELD_54        , FIELD_55        , FIELD_56        , BENHVIEN_ID        ) values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77         ,  @param78         ,  @param79         ,  @param80         ,  @param81         ,  @param82         ,  @param83         ,  @param84         ,  @param85         ,  @param86         ,  @param87         ,  @param88         ,  @param89         ,  @param90         ,  @param91         ,  @param92         ,  @param93         ,  @param94         ,  @param95         ,  @param96         ,  @param97         ,  @param98         ,  @param99         ,  @param100         ,  @param101         ,  @param102         ,  @param103         ,  @param104         ,  @param105         ,  @param106         ,  @param107         ,  @param108         ,  @param109         ,  @param110         ,  @param111         ,  @param112         ,  @param113         ,  @param114         ,  @param115         ,  @param116         ,  @param117         ,  @param118         ,  @param119         ,  @param120         ,  @param121         ,  @param122         ,  @param123         ,  @param124         )]
2019-12-10 10:50:28,944 [1] DEBUG - Statement Id: [DAO00080_Add_KhamBenh_CapCuu] Parameters: [@param0=[SOPHIEU,null], @param1=[TIEPNHAN_ID,28482], @param2=[KHAMBENH_ID,null], @param3=[BENHNHAN_ID,23420], @param4=[NGUOILIENHE,null], @param5=[DIENTHOAILIENHE,null], @param6=[NOILAMVIEC,null], @param7=[CHANDOANNOIGIOITHIEU,null], @param8=[NGAYKHAM,12/10/2019 12:00:00 AM], @param9=[THOIGIANKHAM,12/10/2019 12:00:00 AM], @param10=[LYDOVAOVIEN,null], @param11=[QUATRINHBENHLY,null], @param12=[TIENSUBANTHAN,null], @param13=[TIENSUGIADINH,null], @param14=[KHAMXETTOANTHAN,null], @param15=[KHAMXETCACBOPHAN,null], @param16=[KHAMXETKQLS,null], @param17=[CHANDOANVAO,null], @param18=[ICDKHAMXET_ID,null], @param19=[DAXULY,null], @param20=[NGAYRA,null], @param21=[THOIGIANRA,null], @param22=[NHAPKHOA_ID,68], @param23=[CHUYENVIEN_ID,null], @param24=[CHUY,null], @param25=[MACH,null], @param26=[NHIETDO,null], @param27=[HUYETAPCAO,null], @param28=[HUYETAPTHAP,null], @param29=[NHIPTHO,null], @param30=[CANNANG,null], @param31=[CHIEUCAO,null], @param32=[BACSI_ID,null], @param33=[XUTRUKHAMBENH_ID,null], @param34=[CAPCUU,null], @param35=[NGAYTAINAN,null], @param36=[THOIGIANTAINAN,null], @param37=[NOITAINAN_TINHTHANH_ID,null], @param38=[NOITAINAN_QUANHUYEN_ID,null], @param39=[NOITAINAN_PHUONGXA_ID,null], @param40=[NOITAINAN_DIACHI,null], @param41=[DIADIEMTAINAN_ID,null], @param42=[BOPHANBITHUONG_ID,null], @param43=[MUCDO_ID,null], @param44=[DIENBIENSAUTN_ID,null], @param45=[XUTRISAUTN_ID,null], @param46=[NGUYENNHAN_ID,null], @param47=[NGUYENNHANCHITIET_ID,null], @param48=[ICD_NGUYENNHAN,null], @param49=[NGAYTAO,12/10/2019 10:50:28 AM], @param50=[NGUOITAO_ID,1], @param51=[NGAYCAPNHAT,12/10/2019 10:50:28 AM], @param52=[NGUOICAPNHAT_ID,1], @param53=[BENHANCHUYENKHOA,null], @param54=[CHANDOANVAOVIEN,null], @param55=[CHANDOANRAVIEN,null], @param56=[DIEUTRITUNGAY,null], @param57=[DIEUTRIDENNGAY,null], @param58=[DIENBIENLS,null], @param59=[KQXETNGHIEM,null], @param60=[PHAUTHUAT,null], @param61=[THUTHUAT,null], @param62=[TINHTRANGNGUOIBENH,null], @param63=[HUONGDIEUTRI,null], @param64=[NGUOIGIAO_ID,null], @param65=[NGUOINHAN_ID,null], @param66=[XQUANG,null], @param67=[CTSCANNER,null], @param68=[SIEUAM,null], @param69=[XETNGHIEM,null], @param70=[KHAC,null], @param71=[TOANBOHS,null], @param72=[LOAICHUYENKHOA,null], @param73=[CONGANCANTHIEP,null], @param74=[CDRR_BENHCHINH,null], @param75=[CDRR_BENHKEM,null], @param76=[ICD_BENHCHINH,null], @param77=[ICD_BENHKEMTHEO,null], @param78=[PHUONGPHAPDIEUTRI,null], @param79=[FIELD_1,null], @param80=[FIELD_2,null], @param81=[FIELD_3,null], @param82=[FIELD_4,null], @param83=[FIELD_5,null], @param84=[FIELD_6,null], @param85=[FIELD_7,null], @param86=[FIELD_8,null], @param87=[FIELD_9,null], @param88=[FIELD_10,null], @param89=[FIELD_11,null], @param90=[FIELD_12,null], @param91=[FIELD_13,null], @param92=[FIELD_14,null], @param93=[FIELD_15,null], @param94=[FIELD_27,null], @param95=[FIELD_28,null], @param96=[FIELD_29,null], @param97=[FIELD_30,null], @param98=[FIELD_31,null], @param99=[FIELD_32,null], @param100=[FIELD_33,null], @param101=[FIELD_34,null], @param102=[FIELD_35,null], @param103=[FIELD_36,null], @param104=[FIELD_37,null], @param105=[FIELD_38,null], @param106=[FIELD_39,null], @param107=[FIELD_40,null], @param108=[FIELD_41,null], @param109=[FIELD_42,null], @param110=[FIELD_43,null], @param111=[FIELD_44,null], @param112=[FIELD_45,null], @param113=[FIELD_46,null], @param114=[FIELD_47,null], @param115=[FIELD_48,null], @param116=[FIELD_49,null], @param117=[FIELD_50,null], @param118=[FIELD_51,null], @param119=[FIELD_52,null], @param120=[FIELD_53,null], @param121=[FIELD_54,null], @param122=[FIELD_55,null], @param123=[FIELD_56,null], @param124=[BENHVIEN_ID,HLU01]]
2019-12-10 10:50:28,944 [1] DEBUG - Statement Id: [DAO00080_Add_KhamBenh_CapCuu] Types: [@param0=[System.DBNull, null], @param1=[Int32, System.Int32], @param2=[System.DBNull, null], @param3=[Int32, System.Int32], @param4=[System.DBNull, null], @param5=[System.DBNull, null], @param6=[System.DBNull, null], @param7=[System.DBNull, null], @param8=[DateTime, System.DateTime], @param9=[DateTime, System.DateTime], @param10=[System.DBNull, null], @param11=[System.DBNull, null], @param12=[System.DBNull, null], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[System.DBNull, null], @param22=[String, System.String], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[System.DBNull, null], @param39=[System.DBNull, null], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[DateTime, System.DateTime], @param50=[Int64, System.Int64], @param51=[DateTime, System.DateTime], @param52=[Int64, System.Int64], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[System.DBNull, null], @param59=[System.DBNull, null], @param60=[System.DBNull, null], @param61=[System.DBNull, null], @param62=[System.DBNull, null], @param63=[System.DBNull, null], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[System.DBNull, null], @param71=[System.DBNull, null], @param72=[System.DBNull, null], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null], @param81=[System.DBNull, null], @param82=[System.DBNull, null], @param83=[System.DBNull, null], @param84=[System.DBNull, null], @param85=[System.DBNull, null], @param86=[System.DBNull, null], @param87=[System.DBNull, null], @param88=[System.DBNull, null], @param89=[System.DBNull, null], @param90=[System.DBNull, null], @param91=[System.DBNull, null], @param92=[System.DBNull, null], @param93=[System.DBNull, null], @param94=[System.DBNull, null], @param95=[System.DBNull, null], @param96=[System.DBNull, null], @param97=[System.DBNull, null], @param98=[System.DBNull, null], @param99=[System.DBNull, null], @param100=[System.DBNull, null], @param101=[System.DBNull, null], @param102=[System.DBNull, null], @param103=[System.DBNull, null], @param104=[System.DBNull, null], @param105=[System.DBNull, null], @param106=[System.DBNull, null], @param107=[System.DBNull, null], @param108=[System.DBNull, null], @param109=[System.DBNull, null], @param110=[System.DBNull, null], @param111=[System.DBNull, null], @param112=[System.DBNull, null], @param113=[System.DBNull, null], @param114=[System.DBNull, null], @param115=[System.DBNull, null], @param116=[System.DBNull, null], @param117=[System.DBNull, null], @param118=[System.DBNull, null], @param119=[System.DBNull, null], @param120=[System.DBNull, null], @param121=[System.DBNull, null], @param122=[System.DBNull, null], @param123=[System.DBNull, null], @param124=[String, System.String]]
2019-12-10 10:50:29,104 [1] DEBUG - Statement Id: [DAO00019_Add_TT_TIEPNHAN_SOTHEBHYT] PreparedStatement : [INSERT INTO TT_TIEPNHAN_SOTHEBHYT        (TIEPNHAN_ID        ,BENHNHAN_ID        ,BENHAN_ID        ,DOITUONG_ID        ,SOBHYT        ,BHYTTUNGAY        ,BHYTDENNGAY        ,BHYTNGAYCAP        ,BHYTTREN3NAM        ,BHYTTREN5NAM        ,NGAYMIENDONGCHITRA        ,TRAITUYEN        ,BENHVIEN_ID        ,NOITAO_ID        ,NGAYTAO        ,NGUOITAO_ID        ,NGAYCAPNHAT        ,NGUOICAPNHAT_ID        ,TYLE_VUOT_LCB        ,TYLE_TRAITUYEN        ,GIOIHAN_VUOT_LCB        ,LUONG_COSO        ,TYLE_THUOC_UT        ,MADOITUONG)        VALUES        ( @param0         , @param1         , @param2         , @param3         , @param4         , @param5         , @param6         , @param7         , @param8         , @param9         , @param10         , @param11         , @param12         , @param13         , @param14         , @param15         , @param16         , @param17         , @param18         , @param19         , @param20         , @param21         , @param22         , @param23 )]
2019-12-10 10:50:29,104 [1] DEBUG - Statement Id: [DAO00019_Add_TT_TIEPNHAN_SOTHEBHYT] Parameters: [@param0=[TIEPNHAN_ID,28482], @param1=[BENHNHAN_ID,23420], @param2=[BENHAN_ID,null], @param3=[DOITUONG_ID,1], @param4=[SOBHYT,null], @param5=[BHYTTUNGAY,null], @param6=[BHYTDENNGAY,null], @param7=[BHYTNGAYCAP,null], @param8=[BHYTTREN3NAM,0], @param9=[BHYTTREN5NAM,0], @param10=[NGAYMIENDONGCHITRA,null], @param11=[TRAITUYEN,0], @param12=[BENHVIEN_ID,HLU01], @param13=[NOITAO_ID,68], @param14=[NGAYTAO,12/10/2019 10:50:28 AM], @param15=[NGUOITAO_ID,1], @param16=[NGAYCAPNHAT,12/10/2019 10:50:28 AM], @param17=[NGUOICAPNHAT_ID,1], @param18=[TYLE_VUOT_LCB,null], @param19=[TYLE_TRAITUYEN,null], @param20=[GIOIHAN_VUOT_LCB,null], @param21=[LUONG_COSO,null], @param22=[TYLE_THUOC_UT,null], @param23=[MADOITUONG,null]]
2019-12-10 10:50:29,104 [1] DEBUG - Statement Id: [DAO00019_Add_TT_TIEPNHAN_SOTHEBHYT] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[System.DBNull, null], @param3=[Int64, System.Int64], @param4=[System.DBNull, null], @param5=[System.DBNull, null], @param6=[System.DBNull, null], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[String, System.String], @param10=[System.DBNull, null], @param11=[String, System.String], @param12=[String, System.String], @param13=[String, System.String], @param14=[DateTime, System.DateTime], @param15=[Int64, System.Int64], @param16=[DateTime, System.DateTime], @param17=[Int64, System.Int64], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[System.DBNull, null], @param22=[System.DBNull, null], @param23=[System.DBNull, null]]
2019-12-10 10:50:29,564 [1] DEBUG - Statement Id: [DAO00027_GetListTiepNhanAllCOM30] PreparedStatement : [select distinct A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, isnull(C.SOBENHAN,NULL) as SOBENHAN,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI, A.SOBHYT, CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYTIEPNHAN,        B.*        , A.UUTIEN        from TT_TIEPNHAN A        inner join (select * from TT_BENHNHAN where MAYTE = '190043301' and ACTIVE = '1') B on B.BENHNHAN_ID = A.BENHNHAN_ID  and B.ACTIVE = '1'        left join TT_NOITRU_BENHAN C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        where A.TIEPNHAN_ID = '28482' and A.BENHVIEN_ID = 'HLU01' and (A.TRANGTHAI not in ('HUY','CAPCUU', 'NOITRU', 'NGOAITRU'))]
2019-12-10 10:50:33,688 [1] DEBUG - Statement Id: [DAOWF001_LaythongtinProcess] PreparedStatement : [select * from TM_PROCESS        where        PROCESS_CODE = 'P01']
2019-12-10 10:50:33,732 [1] DEBUG - Statement Id: [DAOWF001_Kiemtrathongtindayeucau] PreparedStatement : [select * from TT_REQUEST        where        PROCESS_CODE = 'P01'        AND PARA = '{"HOSPITAL_ID":"HLU01","SOTIEPNHAN":"TN191210.0000001"}'        AND CURR_STATE_CODE = '6'        AND ISACTIVE = '1']
2019-12-10 10:50:35,100 [1] DEBUG - Statement Id: [DAOWF002_Add] PreparedStatement : [DECLARE @IDRequestOld int        DECLARE @IDRequestNew int        select top 1 @IDRequestOld = ID from TT_REQUEST where PARA =  @param0  order by ID desc          insert into TT_REQUEST (        PROCESS_CODE        , PARA        , CURR_STATE_CODE        ) values (         @param1         ,  @param0         ,  @param2         )        SELECT @IDRequestNew = SCOPE_IDENTITY()        if (@IDRequestOld is not null)        begin        update TT_REQUEST_SERVICE set REQUEST_ID = @IDRequestNew, PROCESS_CODE =  @param1  where REQUEST_ID = @IDRequestOld        update TT_REQUEST set ISACTIVE = '0' where ID = @IDRequestOld        update TT_REQUEST_SERVICE_DETAIL set REQUEST_ID = @IDRequestNew where REQUEST_ID = @IDRequestOld        end          select @IDRequestNew]
2019-12-10 10:50:35,100 [1] DEBUG - Statement Id: [DAOWF002_Add] Parameters: [@param0=[PARA,{"HOSPITAL_ID":"HLU01","SOTIEPNHAN":"TN191210.0000001"}], @param1=[PROCESS_CODE,P01], @param2=[CURR_STATE_CODE,6]]
2019-12-10 10:50:35,100 [1] DEBUG - Statement Id: [DAOWF002_Add] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[String, System.String]]
2019-12-10 10:50:49,331 [1] DEBUG - Statement Id: [DAO00064_GetREGListVienphiTiepNhan] PreparedStatement : [select A.*, B.THUTIENSAU        from TT_VIENPHI A        left join TT_DVYEUCAU B on A.REF_ID =  B.DVYEUCAU_ID and A.REF_TABLE = 'TT_DVYEUCAU' and B.HUYYEUCAU = '0'        where        A.TIEPNHAN_ID = '28482' and A.BENHVIEN_ID = 'HLU01' and (A.BENHAN_ID is NULL or A.BENHAN_ID = '')        and A.HUY = '0'        ORDER BY A.VIENPHI_ID]
2019-12-10 10:50:49,386 [1] DEBUG - Statement Id: [DAOLOG01_LockEnd] PreparedStatement : [DELETE TT_LOG_UPDATE        where REF_TABLE = 'TT_TIEPNHAN_BENHAN' and REF_ID = '23420' and BENHVIEN_ID = 'HLU01']
2019-12-10 10:50:49,412 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-12-10 10:50:49,413 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,28482], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,23420], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,4135], @param8=[BACSICHIDINH_ID,null], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,12/10/2019 12:00:00 AM], @param11=[THANGYEUCAU,12], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,12/10/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,68], @param16=[NOITHUCHIEN_ID,35], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,3], @param50=[HOPDONG_BENHNHAN_ID,203], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,8/26/2019 1:43:56 PM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-12-10 10:50:49,413 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-12-10 10:50:54,616 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28482' and C.DICHVU_ID = '4135' and A.BENHVIEN_ID = 'HLU01']
2019-12-10 10:50:56,702 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28482' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-12-10 10:50:59,366 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '28482']
2019-12-10 10:51:03,603 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-12-10 10:51:03,604 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,28482], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,23420], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,206448], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,4135], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,9], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,90000], @param12=[THANHTIEN_DOANHTHU,90000], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,90000], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,90000], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,8/26/2019 1:43:56 PM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,12/10/2019 10:48:28 AM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-12-10 10:51:03,605 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-12-10 10:51:04,057 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 37          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 203]
2019-12-10 10:51:04,057 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,28482], @param1=[DVYEUCAU_ID,206448], @param2=[VIENPHI_ID,675736], @param3=[SOPHIEUYEUCAU,19..045194], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,12/10/2019 10:51:04 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-12-10 10:51:04,057 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-12-10 10:51:04,095 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-12-10 10:51:04,096 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,28482], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,23420], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,4524], @param8=[BACSICHIDINH_ID,null], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,12/10/2019 12:00:00 AM], @param11=[THANGYEUCAU,12], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,12/10/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,68], @param16=[NOITHUCHIEN_ID,104], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,3], @param50=[HOPDONG_BENHNHAN_ID,203], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,8/26/2019 1:43:56 PM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-12-10 10:51:04,096 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-12-10 10:51:04,138 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28482' and C.DICHVU_ID = '4524' and A.BENHVIEN_ID = 'HLU01']
2019-12-10 10:51:05,102 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28482' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-12-10 10:51:08,925 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '28482']
2019-12-10 10:51:14,969 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-12-10 10:51:14,970 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,28482], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,23420], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,206449], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,4524], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,3], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,50000], @param12=[THANHTIEN_DOANHTHU,50000], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,50000], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,50000], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,8/26/2019 1:43:56 PM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,12/10/2019 10:48:28 AM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-12-10 10:51:14,970 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-12-10 10:51:15,076 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 38          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 203]
2019-12-10 10:51:15,076 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,28482], @param1=[DVYEUCAU_ID,206449], @param2=[VIENPHI_ID,675737], @param3=[SOPHIEUYEUCAU,19..045195], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,12/10/2019 10:51:15 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-12-10 10:51:15,076 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-12-10 10:51:15,133 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-12-10 10:51:15,134 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,28482], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,23420], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,5433], @param8=[BACSICHIDINH_ID,null], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,12/10/2019 12:00:00 AM], @param11=[THANGYEUCAU,12], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,12/10/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,68], @param16=[NOITHUCHIEN_ID,64], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,3], @param50=[HOPDONG_BENHNHAN_ID,203], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,8/26/2019 1:43:56 PM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-12-10 10:51:15,134 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-12-10 10:51:15,209 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28482' and C.DICHVU_ID = '5433' and A.BENHVIEN_ID = 'HLU01']
2019-12-10 10:51:16,735 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28482' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-12-10 10:51:21,937 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '28482']
2019-12-10 10:51:24,886 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-12-10 10:51:24,887 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,28482], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,23420], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,206450], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,5433], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,3], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,50000], @param12=[THANHTIEN_DOANHTHU,50000], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,50000], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,50000], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,8/26/2019 1:43:56 PM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,12/10/2019 10:48:28 AM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-12-10 10:51:24,887 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-12-10 10:51:25,006 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 39          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 203]
2019-12-10 10:51:25,006 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,28482], @param1=[DVYEUCAU_ID,206450], @param2=[VIENPHI_ID,675738], @param3=[SOPHIEUYEUCAU,19..045196], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,12/10/2019 10:51:25 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-12-10 10:51:25,006 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-12-10 10:51:25,042 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-12-10 10:51:25,043 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,28482], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,23420], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,5438], @param8=[BACSICHIDINH_ID,null], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,12/10/2019 12:00:00 AM], @param11=[THANGYEUCAU,12], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,12/10/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,68], @param16=[NOITHUCHIEN_ID,64], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,3], @param50=[HOPDONG_BENHNHAN_ID,203], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,8/26/2019 1:43:56 PM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-12-10 10:51:25,043 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-12-10 10:51:25,147 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28482' and C.DICHVU_ID = '5438' and A.BENHVIEN_ID = 'HLU01']
2019-12-10 10:51:25,896 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28482' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-12-10 10:51:30,912 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '28482']
2019-12-10 10:51:35,558 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-12-10 10:51:35,558 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,28482], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,23420], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,206451], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,5438], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,3], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,50000], @param12=[THANHTIEN_DOANHTHU,50000], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,50000], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,50000], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,8/26/2019 1:43:56 PM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,12/10/2019 10:48:28 AM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-12-10 10:51:35,558 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-12-10 10:51:35,589 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 40          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 203]
2019-12-10 10:51:35,589 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,28482], @param1=[DVYEUCAU_ID,206451], @param2=[VIENPHI_ID,675739], @param3=[SOPHIEUYEUCAU,19..045197], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,12/10/2019 10:51:35 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-12-10 10:51:35,589 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-12-10 10:51:35,639 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-12-10 10:51:35,640 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,28482], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,23420], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,5443], @param8=[BACSICHIDINH_ID,null], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,12/10/2019 12:00:00 AM], @param11=[THANGYEUCAU,12], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,12/10/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,68], @param16=[NOITHUCHIEN_ID,68], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,3], @param50=[HOPDONG_BENHNHAN_ID,203], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,8/26/2019 1:43:56 PM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-12-10 10:51:35,640 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-12-10 10:51:35,871 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28482' and C.DICHVU_ID = '5443' and A.BENHVIEN_ID = 'HLU01']
2019-12-10 10:51:37,295 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28482' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-12-10 10:51:40,780 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '28482']
2019-12-10 10:51:52,725 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-12-10 10:51:52,726 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,28482], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,23420], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,206452], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,5443], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,3], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,50000], @param12=[THANHTIEN_DOANHTHU,50000], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,50000], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,50000], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,8/26/2019 1:43:56 PM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,12/10/2019 10:48:28 AM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-12-10 10:51:52,726 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-12-10 10:51:52,756 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 41          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 203]
2019-12-10 10:51:52,756 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,28482], @param1=[DVYEUCAU_ID,206452], @param2=[VIENPHI_ID,675740], @param3=[SOPHIEUYEUCAU,19..045198], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,12/10/2019 10:51:52 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-12-10 10:51:52,756 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-12-10 10:51:52,880 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-12-10 10:51:52,881 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,28482], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,23420], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,5435], @param8=[BACSICHIDINH_ID,null], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,12/10/2019 12:00:00 AM], @param11=[THANGYEUCAU,12], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,12/10/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,68], @param16=[NOITHUCHIEN_ID,177], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,3], @param50=[HOPDONG_BENHNHAN_ID,203], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,8/26/2019 1:43:56 PM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-12-10 10:51:52,881 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-12-10 10:51:52,987 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28482' and C.DICHVU_ID = '5435' and A.BENHVIEN_ID = 'HLU01']
2019-12-10 10:51:53,401 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28482' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-12-10 10:51:56,901 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '28482']
2019-12-10 10:52:01,149 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-12-10 10:52:01,150 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,28482], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,23420], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,206453], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,5435], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,3], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,50000], @param12=[THANHTIEN_DOANHTHU,50000], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,50000], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,50000], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,8/26/2019 1:43:56 PM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,12/10/2019 10:48:28 AM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-12-10 10:52:01,150 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-12-10 10:52:01,179 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 42          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 203]
2019-12-10 10:52:01,179 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,28482], @param1=[DVYEUCAU_ID,206453], @param2=[VIENPHI_ID,675741], @param3=[SOPHIEUYEUCAU,19..045199], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,12/10/2019 10:52:01 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-12-10 10:52:01,179 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-12-10 10:52:01,216 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-12-10 10:52:01,217 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,28482], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,23420], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,4747], @param8=[BACSICHIDINH_ID,null], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,12/10/2019 12:00:00 AM], @param11=[THANGYEUCAU,12], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,12/10/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,68], @param16=[NOITHUCHIEN_ID,104], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,3], @param50=[HOPDONG_BENHNHAN_ID,203], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,8/26/2019 1:43:56 PM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-12-10 10:52:01,217 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-12-10 10:52:01,404 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28482' and C.DICHVU_ID = '4747' and A.BENHVIEN_ID = 'HLU01']
2019-12-10 10:52:02,011 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28482' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-12-10 10:52:12,567 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '28482']
2019-12-10 10:52:21,294 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-12-10 10:52:21,294 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,28482], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,23420], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,206454], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,4747], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,3], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,40000], @param12=[THANHTIEN_DOANHTHU,40000], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,40000], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,40000], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,8/26/2019 1:43:56 PM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,12/10/2019 10:48:28 AM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-12-10 10:52:21,294 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-12-10 10:52:21,409 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 43          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 203]
2019-12-10 10:52:21,409 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,28482], @param1=[DVYEUCAU_ID,206454], @param2=[VIENPHI_ID,675742], @param3=[SOPHIEUYEUCAU,19..045200], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,12/10/2019 10:52:21 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-12-10 10:52:21,409 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-12-10 10:52:21,447 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-12-10 10:52:21,448 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,28482], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,23420], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,4005], @param8=[BACSICHIDINH_ID,null], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,12/10/2019 12:00:00 AM], @param11=[THANGYEUCAU,12], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,12/10/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,68], @param16=[NOITHUCHIEN_ID,92], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,3], @param50=[HOPDONG_BENHNHAN_ID,203], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,8/26/2019 1:43:56 PM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-12-10 10:52:21,448 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-12-10 10:52:21,549 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28482' and C.DICHVU_ID = '4005' and A.BENHVIEN_ID = 'HLU01']
2019-12-10 10:52:22,025 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28482' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-12-10 10:52:29,750 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '28482']
2019-12-10 10:52:35,169 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-12-10 10:52:35,170 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,28482], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,23420], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,206455], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,4005], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,9], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,70000], @param12=[THANHTIEN_DOANHTHU,70000], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,70000], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,70000], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,8/26/2019 1:43:56 PM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,12/10/2019 10:48:28 AM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-12-10 10:52:35,170 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-12-10 10:52:35,201 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 44          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 203]
2019-12-10 10:52:35,201 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,28482], @param1=[DVYEUCAU_ID,206455], @param2=[VIENPHI_ID,675743], @param3=[SOPHIEUYEUCAU,19..045201], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,12/10/2019 10:52:35 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-12-10 10:52:35,201 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-12-10 10:52:35,240 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-12-10 10:52:35,241 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,28482], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,23420], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,4017], @param8=[BACSICHIDINH_ID,null], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,12/10/2019 12:00:00 AM], @param11=[THANGYEUCAU,12], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,12/10/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,68], @param16=[NOITHUCHIEN_ID,92], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,3], @param50=[HOPDONG_BENHNHAN_ID,203], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,8/26/2019 1:43:56 PM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-12-10 10:52:35,241 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-12-10 10:52:35,334 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28482' and C.DICHVU_ID = '4017' and A.BENHVIEN_ID = 'HLU01']
2019-12-10 10:52:35,921 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28482' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-12-10 10:52:41,800 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '28482']
2019-12-10 10:52:55,672 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-12-10 10:52:55,672 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,28482], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,23420], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,206456], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,4017], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,3], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,50000], @param12=[THANHTIEN_DOANHTHU,50000], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,50000], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,50000], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,8/26/2019 1:43:56 PM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,12/10/2019 10:48:28 AM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-12-10 10:52:55,672 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-12-10 10:52:55,701 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 45          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 203]
2019-12-10 10:52:55,701 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,28482], @param1=[DVYEUCAU_ID,206456], @param2=[VIENPHI_ID,675744], @param3=[SOPHIEUYEUCAU,19..045202], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,12/10/2019 10:52:55 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-12-10 10:52:55,701 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-12-10 10:52:56,149 [1] DEBUG - Statement Id: [DAO00307_GetPatientConfirms] PreparedStatement : [select distinct HD_BN.*        , CASE WHEN HD_BN.GIOITINH = '1' THEN N'Nam' ELSE N'Nữ' END AS GENDER        , CASE WHEN HD_DV.ACTIVE IS NULL THEN 0 ELSE 1 END BENHNHAN_DANGKYKSK_DICHVU        , case when HD_BN.GOI_ID is null then N'Hợp đồng:' + ' ' + HD.SO_HD else N'Gói khám:' + ' ' + G.TENGOI end as DOITUONG        , LST.DICTIONARY_NAME as HONNHAN        from TT_KSK_HOPDONG HD        inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        left join LST_DICTIONARY LST ON LST.DICTIONARY_ID = HD_BN.TINHTRANGHONNHAN_ID AND LST.DICTIONARY_TYPE_CODE = 'TinhTrangGiaDinh'        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        left join TT_TIEPNHAN TN on TN.TIEPNHAN_ID = HD_DV.TIEPNHAN_ID        left join TM_CSKH_GOI G ON G.GOI_ID = HD_BN.GOI_ID        where HD.HOPDONG_ID = '3'         AND           HD.BENHVIEN_ID = 'HLU01'                 order by HD_BN.STT]
2019-12-10 10:52:56,186 [1] DEBUG - Statement Id: [DAO00308_GetTiepNhanID] PreparedStatement : [select top 1 TN.TIEPNHAN_ID, TN.SOTIEPNHAN        from TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV        inner join TT_TIEPNHAN TN on TN.TIEPNHAN_ID = HD_DV.TIEPNHAN_ID        where HD_DV.HOPDONG_BENHNHAN_ID = 203 and HD_DV.HOPDONG_ID = 3]
2019-12-10 10:52:57,217 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '203'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:53:54,899 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '204'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:53:57,483 [1] DEBUG - Statement Id: [DAO00308_GetTiepNhanID] PreparedStatement : [select top 1 TN.TIEPNHAN_ID, TN.SOTIEPNHAN        from TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV        inner join TT_TIEPNHAN TN on TN.TIEPNHAN_ID = HD_DV.TIEPNHAN_ID        where HD_DV.HOPDONG_BENHNHAN_ID = 203 and HD_DV.HOPDONG_ID = 3]
2019-12-10 10:53:57,657 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '203'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:53:58,883 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '204'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:53:59,882 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '210'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:54:01,007 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '211'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:54:03,077 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '204'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:54:03,205 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '204'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:54:03,907 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '210'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:54:03,999 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '204'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:54:04,063 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '204'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:54:04,126 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '210'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:54:04,186 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '210'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:54:04,547 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '211'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:54:04,617 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '204'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:54:04,682 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '204'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:54:04,750 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '210'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:54:04,819 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '210'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:54:04,882 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '211'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:54:04,942 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '211'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:54:07,312 [1] DEBUG - Statement Id: [DAO00307_CheckSingin] PreparedStatement : [select *        from TT_KSK_HOPDONG_BENHNHAN_DICHVU         where                 HOPDONG_ID = 3             and               HOPDONG_BENHNHAN_ID = 211             and               BENHVIEN_ID = 'HLU01']
2019-12-10 10:54:07,894 [1] DEBUG - Statement Id: [DAO00308_GetTiepNhanID] PreparedStatement : [select top 1 TN.TIEPNHAN_ID, TN.SOTIEPNHAN        from TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV        inner join TT_TIEPNHAN TN on TN.TIEPNHAN_ID = HD_DV.TIEPNHAN_ID        where HD_DV.HOPDONG_BENHNHAN_ID = 203 and HD_DV.HOPDONG_ID = 3]
2019-12-10 10:54:08,002 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '203'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:54:08,090 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '204'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:54:08,188 [1] DEBUG - Statement Id: [DAOLOG01_LockBegin] PreparedStatement : [INSERT into TT_LOG_UPDATE ( REF_TABLE , REF_ID , BENHVIEN_ID )         values ( @param0 ,  @param1 ,  @param2 );]
2019-12-10 10:54:08,188 [1] DEBUG - Statement Id: [DAOLOG01_LockBegin] Parameters: [@param0=[REF_TABLE,TT_TIEPNHAN_BENHAN], @param1=[REF_ID,23421], @param2=[BENHVIEN_ID,HLU01]]
2019-12-10 10:54:08,188 [1] DEBUG - Statement Id: [DAOLOG01_LockBegin] Types: [@param0=[String, System.String], @param1=[Int64, System.Int64], @param2=[String, System.String]]
2019-12-10 10:54:08,255 [1] DEBUG - Statement Id: [DAO00013_GetPatientInfo] PreparedStatement : [select *        from TT_BENHNHAN        where MAYTE  = '190043302']
2019-12-10 10:54:08,289 [1] DEBUG - Statement Id: [DAO00095_GetListNguoiLienHe] PreparedStatement : [SELECT BNN.*, D.DICTIONARY_NAME AS TENQUANHE          FROM TT_BENHNHAN AS BN          INNER JOIN TT_BENHNHAN_NGUOILIENHE AS BNN ON BNN.BENHNHAN_ID = BN.BENHNHAN_ID          LEFT JOIN LST_DICTIONARY AS D ON D.DICTIONARY_ID = BNN.QUANHE_ID AND D.DICTIONARY_TYPE_CODE = 'QuanHeGiaDinh'          WHERE BN.MAYTE = '190043302' AND BN.ACTIVE = '1' AND BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:54:08,329 [1] DEBUG - Statement Id: [DAO00307_UpdatePatientKSK] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN set        MAYTE =  @param0         , TENBENHNHAN =  @param1         , GIOITINH =  @param2         , NGAYSINH =  @param3         , NAMSINH =  @param4         , DIACHI =  @param5         , QUOCTICH_ID =  @param6         , TINHTHANH_ID =  @param7         , QUANHUYEN_ID =  @param8         , XAPHUONG_ID =  @param9         , DIACHITHUONGTRU =  @param10         , DANTOC_ID =  @param11         , SODIENTHOAI =  @param12         , NGHENGHIEP_ID =  @param13         , CMND =  @param14         , NGAYCAPNHAT =  @param15         , NGUOICAPNHAT_ID =  @param16         where        BENHNHAN_ID = '23421']
2019-12-10 10:54:08,329 [1] DEBUG - Statement Id: [DAO00307_UpdatePatientKSK] Parameters: [@param0=[MAYTE,190043302], @param1=[TENBENHNHAN,Test Fpt02], @param2=[GIOITINH,2], @param3=[NGAYSINH,9/12/2000 12:00:00 AM], @param4=[NAMSINH,2000], @param5=[DIACHI,null], @param6=[QUOCTICH_ID,null], @param7=[TINHTHANH_ID,null], @param8=[QUANHUYEN_ID,null], @param9=[XAPHUONG_ID,null], @param10=[DIACHITHUONGTRU,null], @param11=[DANTOC_ID,null], @param12=[SODIENTHOAI,null], @param13=[NGHENGHIEP_ID,null], @param14=[CMND,null], @param15=[NGAYCAPNHAT,12/10/2019 12:00:00 AM], @param16=[NGUOICAPNHAT_ID,1]]
2019-12-10 10:54:08,329 [1] DEBUG - Statement Id: [DAO00307_UpdatePatientKSK] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[Int64, System.Int64], @param3=[DateTime, System.DateTime], @param4=[Int64, System.Int64], @param5=[System.DBNull, null], @param6=[System.DBNull, null], @param7=[System.DBNull, null], @param8=[System.DBNull, null], @param9=[System.DBNull, null], @param10=[System.DBNull, null], @param11=[System.DBNull, null], @param12=[System.DBNull, null], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[DateTime, System.DateTime], @param16=[Int64, System.Int64]]
2019-12-10 10:54:08,365 [1] DEBUG - Statement Id: [DAO00118_Add_BenhNhan] PreparedStatement : [if not exists (select 1 from TT_BENHNHAN where BENHNHAN_ID = '23421')              insert into TT_BENHNHAN (              BENHNHAN_ID              , MAYTE              , SOVAOVIEN              , TENBENHNHAN              , HO              , TEN              , GIOITINH              , NGAYSINH              , NAMSINH              , SONHA              , DIACHI              , SODIENTHOAI              , XAPHUONG_ID              , QUANHUYEN_ID              , TINHTHANH_ID              , DANTOC_ID              , QUOCTICH_ID              , SOLUUTRUNOITRU              , SOLUUTRUNGOAITRU              , NGHENGHIEP_ID              , CMND              , HOCHIEU              , VIETKIEU              , NGUOINUOCNGOAI              , DIACHITHUONGTRU              , DIACHILIENLAC              , DIACHICOQUAN              , EMAIL              , NHOMMAU_ID              , YEUTORH_ID              , TIENSUDIUNG              , TIENSUBENH              , TIENSUHUTTHUOCLA              , TUVONG              , NGAYTUVONG              , THOIGIANTUVONG              , NGUYENNHANTUVONG_ID              , NGUOIGHINHANTUVONG_ID              , THOIGIANGHINHANTUVONG              , NHANVIEN_ID              , DONVICONGTAC_ID              , DIENTHOAIBAN              , TINHTRANGHONNHAN_ID              , NGUOILIENHE_ID              , MOIQUANHE_ID              , NGUOILIENHE              , THONGTIN_NLH              , GHICHU              , HINHANH_DAIDIEN              , BENHVIEN_ID              , NGAYTAO              , NGUOITAO_ID              , NGAYGIOSINH              ) values (               @param0               ,  @param1               ,  @param2               ,  @param3               ,  @param4               ,  @param5               ,  @param6               ,  @param7               ,  @param8               ,  @param9               ,  @param10               ,  @param11               ,  @param12               ,  @param13               ,  @param14               ,  @param15               ,  @param16               ,  @param17               ,  @param18               ,  @param19               ,  @param20               ,  @param21               ,  @param22               ,  @param23               ,  @param24               ,  @param25               ,  @param26               ,  @param27               ,  @param28               ,  @param29               ,  @param30               ,  @param31               ,  @param32               ,  @param33               ,  @param34               ,  @param35               ,  @param36               ,  @param37               ,  @param38               ,  @param39               ,  @param40               ,  @param41               ,  @param42               ,  @param43               ,  @param44               ,  @param45               ,  @param46               ,  @param47               ,  @param48               ,  @param49               ,  @param50               ,  @param51               ,  @param52               )              else              update TT_BENHNHAN set              MAYTE =  @param1                ,                   SOVAOVIEN =  @param2                ,                   TENBENHNHAN =  @param3                ,                   HO =  @param4                ,                   TEN =  @param5                ,                   GIOITINH =  @param6                ,                   NGAYSINH =  @param7                ,                   NAMSINH =  @param8                ,                   SONHA =  @param9                ,                   SODIENTHOAI =  @param11                ,                   XAPHUONG_ID =  @param12                ,                   DANTOC_ID =  @param15                ,                   QUOCTICH_ID =  @param16                ,                   NGHENGHIEP_ID =  @param19                ,                   CMND =  @param20                ,                   HOCHIEU =  @param21                ,                   DIACHITHUONGTRU =  @param24                ,                   DIACHILIENLAC =  @param25                ,                   NGUOILIENHE_ID =  @param43                ,                   MOIQUANHE_ID =  @param44                ,                   NGUOILIENHE =  @param45                ,                   THONGTIN_NLH =  @param46                ,                   GHICHU =  @param47                ,                   BENHVIEN_ID =  @param49                ,                   NGAYCAPNHAT =  @param53                ,                   NGUOICAPNHAT_ID =  @param54                              where              BENHNHAN_ID = '23421']
2019-12-10 10:54:08,365 [1] DEBUG - Statement Id: [DAO00118_Add_BenhNhan] Parameters: [@param0=[BENHNHAN_ID,23421], @param1=[MAYTE,190043302], @param2=[SOVAOVIEN,0043302], @param3=[TENBENHNHAN,Test Fpt02], @param4=[HO,Test], @param5=[TEN,Fpt02], @param6=[GIOITINH,2], @param7=[NGAYSINH,9/12/2000 12:00:00 AM], @param8=[NAMSINH,2000], @param9=[SONHA,null], @param10=[DIACHI,null], @param11=[SODIENTHOAI,null], @param12=[XAPHUONG_ID,null], @param13=[QUANHUYEN_ID,null], @param14=[TINHTHANH_ID,null], @param15=[DANTOC_ID,null], @param16=[QUOCTICH_ID,null], @param17=[SOLUUTRUNOITRU,null], @param18=[SOLUUTRUNGOAITRU,null], @param19=[NGHENGHIEP_ID,null], @param20=[CMND,null], @param21=[HOCHIEU,null], @param22=[VIETKIEU,null], @param23=[NGUOINUOCNGOAI,null], @param24=[DIACHITHUONGTRU,null], @param25=[DIACHILIENLAC,null], @param26=[DIACHICOQUAN,null], @param27=[EMAIL,null], @param28=[NHOMMAU_ID,null], @param29=[YEUTORH_ID,null], @param30=[TIENSUDIUNG,null], @param31=[TIENSUBENH,null], @param32=[TIENSUHUTTHUOCLA,null], @param33=[TUVONG,null], @param34=[NGAYTUVONG,null], @param35=[THOIGIANTUVONG,null], @param36=[NGUYENNHANTUVONG_ID,null], @param37=[NGUOIGHINHANTUVONG_ID,null], @param38=[THOIGIANGHINHANTUVONG,null], @param39=[NHANVIEN_ID,null], @param40=[DONVICONGTAC_ID,null], @param41=[DIENTHOAIBAN,null], @param42=[TINHTRANGHONNHAN_ID,null], @param43=[NGUOILIENHE_ID,null], @param44=[MOIQUANHE_ID,null], @param45=[NGUOILIENHE,null], @param46=[THONGTIN_NLH,null], @param47=[GHICHU,null], @param48=[HINHANH_DAIDIEN,null], @param49=[BENHVIEN_ID,HLU01], @param50=[NGAYTAO,8/26/2019 1:43:10 PM], @param51=[NGUOITAO_ID,1], @param52=[NGAYGIOSINH,null], @param53=[NGAYCAPNHAT,12/10/2019 12:00:00 AM], @param54=[NGUOICAPNHAT_ID,1]]
2019-12-10 10:54:08,365 [1] DEBUG - Statement Id: [DAO00118_Add_BenhNhan] Types: [@param0=[Int32, System.Int32], @param1=[String, System.String], @param2=[String, System.String], @param3=[String, System.String], @param4=[String, System.String], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[DateTime, System.DateTime], @param8=[Int64, System.Int64], @param9=[System.DBNull, null], @param10=[System.DBNull, null], @param11=[System.DBNull, null], @param12=[System.DBNull, null], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[System.DBNull, null], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[System.DBNull, null], @param39=[System.DBNull, null], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[String, System.String], @param50=[DateTime, System.DateTime], @param51=[Int64, System.Int64], @param52=[System.DBNull, null], @param53=[DateTime, System.DateTime], @param54=[Int64, System.Int64]]
2019-12-10 10:54:08,421 [1] DEBUG - Statement Id: [DAOWF001_Laythongtingateways] PreparedStatement : [select * from TM_PROCESS_GATEWAYS]
2019-12-10 10:54:08,452 [1] DEBUG - Statement Id: [DAO00019_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10),        @yearNow int, @monthNow varchar(2), @dayNow varchar(2),        @Sotiepnhan varchar(20), @SoThuTu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @monthNow = RIGHT('00' + convert(varchar(2), MONTH(getdate())),2)        set @dayNow = RIGHT('00' + convert(varchar(2), DAY(getdate())),2)        BEGIN        select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOTIEPNHAN' and KEYYEAR = @yearNow and KEYMONTH = @monthNow and KEYDAY = @dayNow        and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOTIEPNHAN', @yearNow, @monthNow, @dayNow, '0', '0', '0', 0, @BenhVienId);        Update LST_KEYDATA set KEYVALUE = (KEYVALUE + 1), @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOTIEPNHAN' and KEYYEAR = @yearNow and KEYMONTH = @monthNow and KEYDAY = @dayNow and BENHVIEN_ID = @BenhVienId        set @SoThuTu = right('0000000'+convert(varchar(7), @keyValue), 7)        set @Sotiepnhan = 'TN' + RIGHT(@yearNow, 2) + @monthNow  + @dayNow + '.' + @SoThuTu                   insert into TT_TIEPNHAN (        SOTIEPNHAN        , UUTIEN        , BENHNHAN_ID        , BENHVIEN_ID        , TUYENKHAMBENH_ID        , NOITIEPNHAN_ID        , NGAYTIEPNHAN        , THOIGIANTIEPNHAN        , NAMTIEPNHAN        , THANGTIEPNHAN        , DOITUONG_ID        , LYDOTIEPNHAN_ID        , HINHTHUCDENKHAM_ID        , TINHTRANGHEN        , XACNHANCHIPHI_ID        , THUTIENTRUOC        , TAIKHAM        , SOBHYT        , BHYTTUNGAY        , BHYTDENNGAY        , BHYTNGAYCAP        , BHYTTREN3NAM        , BHYTTREN5NAM        , NGAYMIENDONGCHITRA        , LOAIBHYT        , NGAYBHYT2        , SOCHUYENVIEN        , HINHTHUCCHUYENVIEN_ID        , NOIGIOITHIEU_ID        , NGUOIGIOITHIEU_ID        , THOIGIANCHUYENTUYEN        , LYDOCHUYENVIEN_ID        , ICDNOIGIOITHIEU_ID        , CHANDOANNGT        , TRAITUYEN        , DIACHILIENHE        , XAPHUONG_ID        , QUANHUYEN_ID        , TINHTHANH_ID        , PROCESS_ID        , TRANGTHAI        , KHUVUCSONG_ID        , THANHVIEN_ID        , THE_ID        , LOAITHANHVIEN_ID        , SUDUNG_BHTN        , VIP        , GHICHU_TIEPNHAN        , BAOLANH_VIENPHI        , CONGTY_CHITRA_ID        , NGUON_BENHNHAN_ID        , LOAITIEPNHAN_ID        , THONGTIN_KCB_BHYT        , NGAYTAO        , NGUOITAO_ID        , LYDODENKHAM         ,           ISTHONGTUYEN                 )        OUTPUT INSERTED.TIEPNHAN_ID, INSERTED.SOTIEPNHAN        values (        @Sotiepnhan        ,  @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54          ,            @param55                  )        end]
2019-12-10 10:54:08,452 [1] DEBUG - Statement Id: [DAO00019_Add] Parameters: [@param0=[UUTIEN,0], @param1=[BENHNHAN_ID,23421], @param2=[BENHVIEN_ID,HLU01], @param3=[TUYENKHAMBENH_ID,null], @param4=[NOITIEPNHAN_ID,68], @param5=[NGAYTIEPNHAN,12/10/2019 12:00:00 AM], @param6=[THOIGIANTIEPNHAN,12/10/2019 12:00:00 AM], @param7=[NAMTIEPNHAN,2019], @param8=[THANGTIEPNHAN,12], @param9=[DOITUONG_ID,1], @param10=[LYDOTIEPNHAN_ID,null], @param11=[HINHTHUCDENKHAM_ID,461], @param12=[TINHTRANGHEN,null], @param13=[XACNHANCHIPHI_ID,null], @param14=[THUTIENTRUOC,null], @param15=[TAIKHAM,0], @param16=[SOBHYT,null], @param17=[BHYTTUNGAY,null], @param18=[BHYTDENNGAY,null], @param19=[BHYTNGAYCAP,null], @param20=[BHYTTREN3NAM,0], @param21=[BHYTTREN5NAM,0], @param22=[NGAYMIENDONGCHITRA,null], @param23=[LOAIBHYT,null], @param24=[NGAYBHYT2,null], @param25=[SOCHUYENVIEN,null], @param26=[HINHTHUCCHUYENVIEN_ID,null], @param27=[NOIGIOITHIEU_ID,null], @param28=[NGUOIGIOITHIEU_ID,null], @param29=[THOIGIANCHUYENTUYEN,null], @param30=[LYDOCHUYENVIEN_ID,null], @param31=[ICDNOIGIOITHIEU_ID,null], @param32=[CHANDOANNGT,null], @param33=[TRAITUYEN,0], @param34=[DIACHILIENHE,null], @param35=[XAPHUONG_ID,null], @param36=[QUANHUYEN_ID,null], @param37=[TINHTHANH_ID,null], @param38=[PROCESS_ID,P01], @param39=[TRANGTHAI,DATIEPNHAN], @param40=[KHUVUCSONG_ID,null], @param41=[THANHVIEN_ID,null], @param42=[THE_ID,null], @param43=[LOAITHANHVIEN_ID,null], @param44=[SUDUNG_BHTN,0], @param45=[VIP,0], @param46=[GHICHU_TIEPNHAN,null], @param47=[BAOLANH_VIENPHI,0], @param48=[CONGTY_CHITRA_ID,null], @param49=[NGUON_BENHNHAN_ID,null], @param50=[LOAITIEPNHAN_ID,null], @param51=[THONGTIN_KCB_BHYT,null], @param52=[NGAYTAO,12/10/2019 10:54:08 AM], @param53=[NGUOITAO_ID,1], @param54=[LYDODENKHAM,null], @param55=[ISTHONGTUYEN,0]]
2019-12-10 10:54:08,452 [1] DEBUG - Statement Id: [DAO00019_Add] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[String, System.String], @param3=[System.DBNull, null], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[DateTime, System.DateTime], @param7=[Int32, System.Int32], @param8=[Int32, System.Int32], @param9=[Int64, System.Int64], @param10=[System.DBNull, null], @param11=[Int64, System.Int64], @param12=[System.DBNull, null], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[String, System.String], @param21=[String, System.String], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[String, System.String], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[String, System.String], @param45=[String, System.String], @param46=[System.DBNull, null], @param47=[String, System.String], @param48=[System.DBNull, null], @param49=[System.DBNull, null], @param50=[System.DBNull, null], @param51=[System.DBNull, null], @param52=[DateTime, System.DateTime], @param53=[Int64, System.Int64], @param54=[System.DBNull, null], @param55=[String, System.String]]
2019-12-10 10:54:08,482 [1] DEBUG - Statement Id: [DAO00019_GetTTTiepNhan_byTiepNhanId] PreparedStatement : [select *        from TT_TIEPNHAN        where TIEPNHAN_ID = '28483'        order by TIEPNHAN_ID]
2019-12-10 10:54:08,512 [1] DEBUG - Statement Id: [DAO00080_Add_KhamBenh_CapCuu] PreparedStatement : [insert into TT_KHAMBENH_VAOVIEN (        SOPHIEU        , TIEPNHAN_ID        , KHAMBENH_ID        , BENHNHAN_ID        , NGUOILIENHE        , DIENTHOAILIENHE        , NOILAMVIEC        , CHANDOANNOIGIOITHIEU        , NGAYKHAM        , THOIGIANKHAM        , LYDOVAOVIEN        , QUATRINHBENHLY        , TIENSUBANTHAN        , TIENSUGIADINH        , KHAMXETTOANTHAN        , KHAMXETCACBOPHAN        , KHAMXETKQLS        , CHANDOANVAO        , ICDKHAMXET_ID        , DAXULY        , NGAYRA        , THOIGIANRA        , NHAPKHOA_ID        , CHUYENVIEN_ID        , CHUY        , MACH        , NHIETDO        , HUYETAPCAO        , HUYETAPTHAP        , NHIPTHO        , CANNANG        , CHIEUCAO        , BACSI_ID        , XUTRUKHAMBENH_ID        , CAPCUU        , NGAYTAINAN        , THOIGIANTAINAN        , NOITAINAN_TINHTHANH_ID        , NOITAINAN_QUANHUYEN_ID        , NOITAINAN_PHUONGXA_ID        , NOITAINAN_DIACHI        , DIADIEMTAINAN_ID        , BOPHANBITHUONG_ID        , MUCDO_ID        , DIENBIENSAUTN_ID        , XUTRISAUTN_ID        , NGUYENNHAN_ID        , NGUYENNHANCHITIET_ID        , ICD_NGUYENNHAN        , NGAYTAO        , NGUOITAO_ID        , NGAYCAPNHAT        , NGUOICAPNHAT_ID        , BENHANCHUYENKHOA        , CHANDOANVAOVIEN        , CHANDOANRAVIEN        , DIEUTRITUNGAY        , DIEUTRIDENNGAY        , DIENBIENLS        , KQXETNGHIEM        , PHAUTHUAT        , THUTHUAT        , TINHTRANGNGUOIBENH        , HUONGDIEUTRI        , NGUOIGIAO_ID        , NGUOINHAN_ID        , XQUANG        , CTSCANNER        , SIEUAM        , XETNGHIEM        , KHAC        , TOANBOHS        , LOAICHUYENKHOA        , CONGANCANTHIEP        , CDRR_BENHCHINH        , CDRR_BENHKEM        , ICD_BENHCHINH        , ICD_BENHKEMTHEO        , PHUONGPHAPDIEUTRI        , FIELD_1        , FIELD_2        , FIELD_3        , FIELD_4        , FIELD_5        , FIELD_6        , FIELD_7        , FIELD_8        , FIELD_9        , FIELD_10        , FIELD_11        , FIELD_12        , FIELD_13        , FIELD_14        , FIELD_15        , FIELD_27        , FIELD_28        , FIELD_29        , FIELD_30        , FIELD_31        , FIELD_32        , FIELD_33        , FIELD_34        , FIELD_35        , FIELD_36        , FIELD_37        , FIELD_38        , FIELD_39        , FIELD_40        , FIELD_41        , FIELD_42        , FIELD_43        , FIELD_44        , FIELD_45        , FIELD_46        , FIELD_47        , FIELD_48        , FIELD_49        , FIELD_50        , FIELD_51        , FIELD_52        , FIELD_53        , FIELD_54        , FIELD_55        , FIELD_56        , BENHVIEN_ID        ) values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77         ,  @param78         ,  @param79         ,  @param80         ,  @param81         ,  @param82         ,  @param83         ,  @param84         ,  @param85         ,  @param86         ,  @param87         ,  @param88         ,  @param89         ,  @param90         ,  @param91         ,  @param92         ,  @param93         ,  @param94         ,  @param95         ,  @param96         ,  @param97         ,  @param98         ,  @param99         ,  @param100         ,  @param101         ,  @param102         ,  @param103         ,  @param104         ,  @param105         ,  @param106         ,  @param107         ,  @param108         ,  @param109         ,  @param110         ,  @param111         ,  @param112         ,  @param113         ,  @param114         ,  @param115         ,  @param116         ,  @param117         ,  @param118         ,  @param119         ,  @param120         ,  @param121         ,  @param122         ,  @param123         ,  @param124         )]
2019-12-10 10:54:08,513 [1] DEBUG - Statement Id: [DAO00080_Add_KhamBenh_CapCuu] Parameters: [@param0=[SOPHIEU,null], @param1=[TIEPNHAN_ID,28483], @param2=[KHAMBENH_ID,null], @param3=[BENHNHAN_ID,23421], @param4=[NGUOILIENHE,null], @param5=[DIENTHOAILIENHE,null], @param6=[NOILAMVIEC,null], @param7=[CHANDOANNOIGIOITHIEU,null], @param8=[NGAYKHAM,12/10/2019 12:00:00 AM], @param9=[THOIGIANKHAM,12/10/2019 12:00:00 AM], @param10=[LYDOVAOVIEN,null], @param11=[QUATRINHBENHLY,null], @param12=[TIENSUBANTHAN,null], @param13=[TIENSUGIADINH,null], @param14=[KHAMXETTOANTHAN,null], @param15=[KHAMXETCACBOPHAN,null], @param16=[KHAMXETKQLS,null], @param17=[CHANDOANVAO,null], @param18=[ICDKHAMXET_ID,null], @param19=[DAXULY,null], @param20=[NGAYRA,null], @param21=[THOIGIANRA,null], @param22=[NHAPKHOA_ID,68], @param23=[CHUYENVIEN_ID,null], @param24=[CHUY,null], @param25=[MACH,null], @param26=[NHIETDO,null], @param27=[HUYETAPCAO,null], @param28=[HUYETAPTHAP,null], @param29=[NHIPTHO,null], @param30=[CANNANG,null], @param31=[CHIEUCAO,null], @param32=[BACSI_ID,null], @param33=[XUTRUKHAMBENH_ID,null], @param34=[CAPCUU,null], @param35=[NGAYTAINAN,null], @param36=[THOIGIANTAINAN,null], @param37=[NOITAINAN_TINHTHANH_ID,null], @param38=[NOITAINAN_QUANHUYEN_ID,null], @param39=[NOITAINAN_PHUONGXA_ID,null], @param40=[NOITAINAN_DIACHI,null], @param41=[DIADIEMTAINAN_ID,null], @param42=[BOPHANBITHUONG_ID,null], @param43=[MUCDO_ID,null], @param44=[DIENBIENSAUTN_ID,null], @param45=[XUTRISAUTN_ID,null], @param46=[NGUYENNHAN_ID,null], @param47=[NGUYENNHANCHITIET_ID,null], @param48=[ICD_NGUYENNHAN,null], @param49=[NGAYTAO,12/10/2019 10:54:08 AM], @param50=[NGUOITAO_ID,1], @param51=[NGAYCAPNHAT,12/10/2019 10:54:08 AM], @param52=[NGUOICAPNHAT_ID,1], @param53=[BENHANCHUYENKHOA,null], @param54=[CHANDOANVAOVIEN,null], @param55=[CHANDOANRAVIEN,null], @param56=[DIEUTRITUNGAY,null], @param57=[DIEUTRIDENNGAY,null], @param58=[DIENBIENLS,null], @param59=[KQXETNGHIEM,null], @param60=[PHAUTHUAT,null], @param61=[THUTHUAT,null], @param62=[TINHTRANGNGUOIBENH,null], @param63=[HUONGDIEUTRI,null], @param64=[NGUOIGIAO_ID,null], @param65=[NGUOINHAN_ID,null], @param66=[XQUANG,null], @param67=[CTSCANNER,null], @param68=[SIEUAM,null], @param69=[XETNGHIEM,null], @param70=[KHAC,null], @param71=[TOANBOHS,null], @param72=[LOAICHUYENKHOA,null], @param73=[CONGANCANTHIEP,null], @param74=[CDRR_BENHCHINH,null], @param75=[CDRR_BENHKEM,null], @param76=[ICD_BENHCHINH,null], @param77=[ICD_BENHKEMTHEO,null], @param78=[PHUONGPHAPDIEUTRI,null], @param79=[FIELD_1,null], @param80=[FIELD_2,null], @param81=[FIELD_3,null], @param82=[FIELD_4,null], @param83=[FIELD_5,null], @param84=[FIELD_6,null], @param85=[FIELD_7,null], @param86=[FIELD_8,null], @param87=[FIELD_9,null], @param88=[FIELD_10,null], @param89=[FIELD_11,null], @param90=[FIELD_12,null], @param91=[FIELD_13,null], @param92=[FIELD_14,null], @param93=[FIELD_15,null], @param94=[FIELD_27,null], @param95=[FIELD_28,null], @param96=[FIELD_29,null], @param97=[FIELD_30,null], @param98=[FIELD_31,null], @param99=[FIELD_32,null], @param100=[FIELD_33,null], @param101=[FIELD_34,null], @param102=[FIELD_35,null], @param103=[FIELD_36,null], @param104=[FIELD_37,null], @param105=[FIELD_38,null], @param106=[FIELD_39,null], @param107=[FIELD_40,null], @param108=[FIELD_41,null], @param109=[FIELD_42,null], @param110=[FIELD_43,null], @param111=[FIELD_44,null], @param112=[FIELD_45,null], @param113=[FIELD_46,null], @param114=[FIELD_47,null], @param115=[FIELD_48,null], @param116=[FIELD_49,null], @param117=[FIELD_50,null], @param118=[FIELD_51,null], @param119=[FIELD_52,null], @param120=[FIELD_53,null], @param121=[FIELD_54,null], @param122=[FIELD_55,null], @param123=[FIELD_56,null], @param124=[BENHVIEN_ID,HLU01]]
2019-12-10 10:54:08,513 [1] DEBUG - Statement Id: [DAO00080_Add_KhamBenh_CapCuu] Types: [@param0=[System.DBNull, null], @param1=[Int32, System.Int32], @param2=[System.DBNull, null], @param3=[Int32, System.Int32], @param4=[System.DBNull, null], @param5=[System.DBNull, null], @param6=[System.DBNull, null], @param7=[System.DBNull, null], @param8=[DateTime, System.DateTime], @param9=[DateTime, System.DateTime], @param10=[System.DBNull, null], @param11=[System.DBNull, null], @param12=[System.DBNull, null], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[System.DBNull, null], @param22=[String, System.String], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[System.DBNull, null], @param39=[System.DBNull, null], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[DateTime, System.DateTime], @param50=[Int64, System.Int64], @param51=[DateTime, System.DateTime], @param52=[Int64, System.Int64], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[System.DBNull, null], @param59=[System.DBNull, null], @param60=[System.DBNull, null], @param61=[System.DBNull, null], @param62=[System.DBNull, null], @param63=[System.DBNull, null], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[System.DBNull, null], @param71=[System.DBNull, null], @param72=[System.DBNull, null], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null], @param81=[System.DBNull, null], @param82=[System.DBNull, null], @param83=[System.DBNull, null], @param84=[System.DBNull, null], @param85=[System.DBNull, null], @param86=[System.DBNull, null], @param87=[System.DBNull, null], @param88=[System.DBNull, null], @param89=[System.DBNull, null], @param90=[System.DBNull, null], @param91=[System.DBNull, null], @param92=[System.DBNull, null], @param93=[System.DBNull, null], @param94=[System.DBNull, null], @param95=[System.DBNull, null], @param96=[System.DBNull, null], @param97=[System.DBNull, null], @param98=[System.DBNull, null], @param99=[System.DBNull, null], @param100=[System.DBNull, null], @param101=[System.DBNull, null], @param102=[System.DBNull, null], @param103=[System.DBNull, null], @param104=[System.DBNull, null], @param105=[System.DBNull, null], @param106=[System.DBNull, null], @param107=[System.DBNull, null], @param108=[System.DBNull, null], @param109=[System.DBNull, null], @param110=[System.DBNull, null], @param111=[System.DBNull, null], @param112=[System.DBNull, null], @param113=[System.DBNull, null], @param114=[System.DBNull, null], @param115=[System.DBNull, null], @param116=[System.DBNull, null], @param117=[System.DBNull, null], @param118=[System.DBNull, null], @param119=[System.DBNull, null], @param120=[System.DBNull, null], @param121=[System.DBNull, null], @param122=[System.DBNull, null], @param123=[System.DBNull, null], @param124=[String, System.String]]
2019-12-10 10:54:09,826 [1] DEBUG - Statement Id: [DAO00019_Add_TT_TIEPNHAN_SOTHEBHYT] PreparedStatement : [INSERT INTO TT_TIEPNHAN_SOTHEBHYT        (TIEPNHAN_ID        ,BENHNHAN_ID        ,BENHAN_ID        ,DOITUONG_ID        ,SOBHYT        ,BHYTTUNGAY        ,BHYTDENNGAY        ,BHYTNGAYCAP        ,BHYTTREN3NAM        ,BHYTTREN5NAM        ,NGAYMIENDONGCHITRA        ,TRAITUYEN        ,BENHVIEN_ID        ,NOITAO_ID        ,NGAYTAO        ,NGUOITAO_ID        ,NGAYCAPNHAT        ,NGUOICAPNHAT_ID        ,TYLE_VUOT_LCB        ,TYLE_TRAITUYEN        ,GIOIHAN_VUOT_LCB        ,LUONG_COSO        ,TYLE_THUOC_UT        ,MADOITUONG)        VALUES        ( @param0         , @param1         , @param2         , @param3         , @param4         , @param5         , @param6         , @param7         , @param8         , @param9         , @param10         , @param11         , @param12         , @param13         , @param14         , @param15         , @param16         , @param17         , @param18         , @param19         , @param20         , @param21         , @param22         , @param23 )]
2019-12-10 10:54:09,826 [1] DEBUG - Statement Id: [DAO00019_Add_TT_TIEPNHAN_SOTHEBHYT] Parameters: [@param0=[TIEPNHAN_ID,28483], @param1=[BENHNHAN_ID,23421], @param2=[BENHAN_ID,null], @param3=[DOITUONG_ID,1], @param4=[SOBHYT,null], @param5=[BHYTTUNGAY,null], @param6=[BHYTDENNGAY,null], @param7=[BHYTNGAYCAP,null], @param8=[BHYTTREN3NAM,0], @param9=[BHYTTREN5NAM,0], @param10=[NGAYMIENDONGCHITRA,null], @param11=[TRAITUYEN,0], @param12=[BENHVIEN_ID,HLU01], @param13=[NOITAO_ID,68], @param14=[NGAYTAO,12/10/2019 10:54:08 AM], @param15=[NGUOITAO_ID,1], @param16=[NGAYCAPNHAT,12/10/2019 10:54:08 AM], @param17=[NGUOICAPNHAT_ID,1], @param18=[TYLE_VUOT_LCB,null], @param19=[TYLE_TRAITUYEN,null], @param20=[GIOIHAN_VUOT_LCB,null], @param21=[LUONG_COSO,null], @param22=[TYLE_THUOC_UT,null], @param23=[MADOITUONG,null]]
2019-12-10 10:54:09,826 [1] DEBUG - Statement Id: [DAO00019_Add_TT_TIEPNHAN_SOTHEBHYT] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[System.DBNull, null], @param3=[Int64, System.Int64], @param4=[System.DBNull, null], @param5=[System.DBNull, null], @param6=[System.DBNull, null], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[String, System.String], @param10=[System.DBNull, null], @param11=[String, System.String], @param12=[String, System.String], @param13=[String, System.String], @param14=[DateTime, System.DateTime], @param15=[Int64, System.Int64], @param16=[DateTime, System.DateTime], @param17=[Int64, System.Int64], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[System.DBNull, null], @param22=[System.DBNull, null], @param23=[System.DBNull, null]]
2019-12-10 10:54:16,354 [1] DEBUG - Statement Id: [DAO00027_GetListTiepNhanAllCOM30] PreparedStatement : [select distinct A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, isnull(C.SOBENHAN,NULL) as SOBENHAN,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI, A.SOBHYT, CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYTIEPNHAN,        B.*        , A.UUTIEN        from TT_TIEPNHAN A        inner join (select * from TT_BENHNHAN where MAYTE = '190043302' and ACTIVE = '1') B on B.BENHNHAN_ID = A.BENHNHAN_ID  and B.ACTIVE = '1'        left join TT_NOITRU_BENHAN C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        where A.TIEPNHAN_ID = '28483' and A.BENHVIEN_ID = 'HLU01' and (A.TRANGTHAI not in ('HUY','CAPCUU', 'NOITRU', 'NGOAITRU'))]
2019-12-10 10:54:18,405 [1] DEBUG - Statement Id: [DAOWF001_LaythongtinProcess] PreparedStatement : [select * from TM_PROCESS        where        PROCESS_CODE = 'P01']
2019-12-10 10:54:18,433 [1] DEBUG - Statement Id: [DAOWF001_Kiemtrathongtindayeucau] PreparedStatement : [select * from TT_REQUEST        where        PROCESS_CODE = 'P01'        AND PARA = '{"HOSPITAL_ID":"HLU01","SOTIEPNHAN":"TN191210.0000002"}'        AND CURR_STATE_CODE = '6'        AND ISACTIVE = '1']
2019-12-10 10:54:18,480 [1] DEBUG - Statement Id: [DAOWF002_Add] PreparedStatement : [DECLARE @IDRequestOld int        DECLARE @IDRequestNew int        select top 1 @IDRequestOld = ID from TT_REQUEST where PARA =  @param0  order by ID desc          insert into TT_REQUEST (        PROCESS_CODE        , PARA        , CURR_STATE_CODE        ) values (         @param1         ,  @param0         ,  @param2         )        SELECT @IDRequestNew = SCOPE_IDENTITY()        if (@IDRequestOld is not null)        begin        update TT_REQUEST_SERVICE set REQUEST_ID = @IDRequestNew, PROCESS_CODE =  @param1  where REQUEST_ID = @IDRequestOld        update TT_REQUEST set ISACTIVE = '0' where ID = @IDRequestOld        update TT_REQUEST_SERVICE_DETAIL set REQUEST_ID = @IDRequestNew where REQUEST_ID = @IDRequestOld        end          select @IDRequestNew]
2019-12-10 10:54:18,480 [1] DEBUG - Statement Id: [DAOWF002_Add] Parameters: [@param0=[PARA,{"HOSPITAL_ID":"HLU01","SOTIEPNHAN":"TN191210.0000002"}], @param1=[PROCESS_CODE,P01], @param2=[CURR_STATE_CODE,6]]
2019-12-10 10:54:18,480 [1] DEBUG - Statement Id: [DAOWF002_Add] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[String, System.String]]
2019-12-10 10:54:18,529 [1] DEBUG - Statement Id: [DAO00064_GetREGListVienphiTiepNhan] PreparedStatement : [select A.*, B.THUTIENSAU        from TT_VIENPHI A        left join TT_DVYEUCAU B on A.REF_ID =  B.DVYEUCAU_ID and A.REF_TABLE = 'TT_DVYEUCAU' and B.HUYYEUCAU = '0'        where        A.TIEPNHAN_ID = '28483' and A.BENHVIEN_ID = 'HLU01' and (A.BENHAN_ID is NULL or A.BENHAN_ID = '')        and A.HUY = '0'        ORDER BY A.VIENPHI_ID]
2019-12-10 10:54:18,669 [1] DEBUG - Statement Id: [DAOLOG01_LockEnd] PreparedStatement : [DELETE TT_LOG_UPDATE        where REF_TABLE = 'TT_TIEPNHAN_BENHAN' and REF_ID = '23421' and BENHVIEN_ID = 'HLU01']
2019-12-10 10:54:18,700 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-12-10 10:54:18,701 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,28483], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,23421], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,4135], @param8=[BACSICHIDINH_ID,null], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,12/10/2019 12:00:00 AM], @param11=[THANGYEUCAU,12], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,12/10/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,68], @param16=[NOITHUCHIEN_ID,35], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,3], @param50=[HOPDONG_BENHNHAN_ID,204], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,8/26/2019 1:44:06 PM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-12-10 10:54:18,701 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-12-10 10:54:18,791 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28483' and C.DICHVU_ID = '4135' and A.BENHVIEN_ID = 'HLU01']
2019-12-10 10:54:20,828 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28483' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-12-10 10:54:22,822 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '28483']
2019-12-10 10:54:24,295 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-12-10 10:54:24,295 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,28483], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,23421], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,206457], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,4135], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,9], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,90000], @param12=[THANHTIEN_DOANHTHU,90000], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,90000], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,90000], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,8/26/2019 1:44:06 PM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,12/10/2019 10:49:15 AM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-12-10 10:54:24,296 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-12-10 10:54:24,324 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 46          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 204]
2019-12-10 10:54:24,325 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,28483], @param1=[DVYEUCAU_ID,206457], @param2=[VIENPHI_ID,675745], @param3=[SOPHIEUYEUCAU,19..045203], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,12/10/2019 10:54:24 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-12-10 10:54:24,325 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-12-10 10:54:24,364 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-12-10 10:54:24,366 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,28483], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,23421], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,4524], @param8=[BACSICHIDINH_ID,null], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,12/10/2019 12:00:00 AM], @param11=[THANGYEUCAU,12], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,12/10/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,68], @param16=[NOITHUCHIEN_ID,104], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,3], @param50=[HOPDONG_BENHNHAN_ID,204], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,8/26/2019 1:44:06 PM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-12-10 10:54:24,366 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-12-10 10:54:24,407 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28483' and C.DICHVU_ID = '4524' and A.BENHVIEN_ID = 'HLU01']
2019-12-10 10:54:26,290 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28483' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-12-10 10:54:32,082 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '28483']
2019-12-10 10:54:33,495 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-12-10 10:54:33,496 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,28483], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,23421], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,206458], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,4524], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,3], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,50000], @param12=[THANHTIEN_DOANHTHU,50000], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,50000], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,50000], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,8/26/2019 1:44:06 PM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,12/10/2019 10:49:15 AM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-12-10 10:54:33,496 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-12-10 10:54:33,531 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 47          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 204]
2019-12-10 10:54:33,531 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,28483], @param1=[DVYEUCAU_ID,206458], @param2=[VIENPHI_ID,675746], @param3=[SOPHIEUYEUCAU,19..045204], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,12/10/2019 10:54:33 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-12-10 10:54:33,531 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-12-10 10:54:33,565 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-12-10 10:54:33,566 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,28483], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,23421], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,5433], @param8=[BACSICHIDINH_ID,null], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,12/10/2019 12:00:00 AM], @param11=[THANGYEUCAU,12], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,12/10/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,68], @param16=[NOITHUCHIEN_ID,64], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,3], @param50=[HOPDONG_BENHNHAN_ID,204], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,8/26/2019 1:44:06 PM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-12-10 10:54:33,566 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-12-10 10:54:33,635 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28483' and C.DICHVU_ID = '5433' and A.BENHVIEN_ID = 'HLU01']
2019-12-10 10:54:34,769 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28483' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-12-10 10:54:39,119 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '28483']
2019-12-10 10:54:41,563 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-12-10 10:54:41,565 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,28483], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,23421], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,206459], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,5433], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,3], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,50000], @param12=[THANHTIEN_DOANHTHU,50000], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,50000], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,50000], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,8/26/2019 1:44:06 PM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,12/10/2019 10:49:15 AM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-12-10 10:54:41,565 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-12-10 10:54:41,594 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 48          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 204]
2019-12-10 10:54:41,594 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,28483], @param1=[DVYEUCAU_ID,206459], @param2=[VIENPHI_ID,675747], @param3=[SOPHIEUYEUCAU,19..045205], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,12/10/2019 10:54:41 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-12-10 10:54:41,594 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-12-10 10:54:41,632 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-12-10 10:54:41,633 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,28483], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,23421], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,5438], @param8=[BACSICHIDINH_ID,null], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,12/10/2019 12:00:00 AM], @param11=[THANGYEUCAU,12], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,12/10/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,68], @param16=[NOITHUCHIEN_ID,64], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,3], @param50=[HOPDONG_BENHNHAN_ID,204], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,8/26/2019 1:44:06 PM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-12-10 10:54:41,633 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-12-10 10:54:41,673 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28483' and C.DICHVU_ID = '5438' and A.BENHVIEN_ID = 'HLU01']
2019-12-10 10:54:43,100 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28483' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-12-10 10:54:46,862 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '28483']
2019-12-10 10:54:53,096 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-12-10 10:54:53,096 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,28483], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,23421], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,206460], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,5438], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,3], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,50000], @param12=[THANHTIEN_DOANHTHU,50000], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,50000], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,50000], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,8/26/2019 1:44:06 PM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,12/10/2019 10:49:15 AM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-12-10 10:54:53,096 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-12-10 10:54:53,133 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 49          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 204]
2019-12-10 10:54:53,133 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,28483], @param1=[DVYEUCAU_ID,206460], @param2=[VIENPHI_ID,675748], @param3=[SOPHIEUYEUCAU,19..045206], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,12/10/2019 10:54:53 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-12-10 10:54:53,133 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-12-10 10:54:53,176 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-12-10 10:54:53,176 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,28483], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,23421], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,5443], @param8=[BACSICHIDINH_ID,null], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,12/10/2019 12:00:00 AM], @param11=[THANGYEUCAU,12], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,12/10/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,68], @param16=[NOITHUCHIEN_ID,68], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,3], @param50=[HOPDONG_BENHNHAN_ID,204], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,8/26/2019 1:44:06 PM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-12-10 10:54:53,176 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-12-10 10:54:53,342 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28483' and C.DICHVU_ID = '5443' and A.BENHVIEN_ID = 'HLU01']
2019-12-10 10:54:54,984 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28483' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-12-10 10:55:01,050 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '28483']
2019-12-10 10:55:04,277 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-12-10 10:55:04,278 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,28483], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,23421], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,206461], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,5443], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,3], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,50000], @param12=[THANHTIEN_DOANHTHU,50000], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,50000], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,50000], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,8/26/2019 1:44:06 PM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,12/10/2019 10:49:15 AM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-12-10 10:55:04,278 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-12-10 10:55:04,310 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 50          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 204]
2019-12-10 10:55:04,310 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,28483], @param1=[DVYEUCAU_ID,206461], @param2=[VIENPHI_ID,675749], @param3=[SOPHIEUYEUCAU,19..045207], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,12/10/2019 10:55:04 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-12-10 10:55:04,310 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-12-10 10:55:04,352 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-12-10 10:55:04,353 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,28483], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,23421], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,5435], @param8=[BACSICHIDINH_ID,null], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,12/10/2019 12:00:00 AM], @param11=[THANGYEUCAU,12], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,12/10/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,68], @param16=[NOITHUCHIEN_ID,177], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,3], @param50=[HOPDONG_BENHNHAN_ID,204], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,8/26/2019 1:44:06 PM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-12-10 10:55:04,353 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-12-10 10:55:04,779 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28483' and C.DICHVU_ID = '5435' and A.BENHVIEN_ID = 'HLU01']
2019-12-10 10:55:05,732 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28483' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-12-10 10:55:10,903 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '28483']
2019-12-10 10:55:15,540 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-12-10 10:55:15,540 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,28483], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,23421], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,206462], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,5435], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,3], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,50000], @param12=[THANHTIEN_DOANHTHU,50000], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,50000], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,50000], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,8/26/2019 1:44:06 PM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,12/10/2019 10:49:16 AM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-12-10 10:55:15,540 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-12-10 10:55:15,569 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 51          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 204]
2019-12-10 10:55:15,569 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,28483], @param1=[DVYEUCAU_ID,206462], @param2=[VIENPHI_ID,675750], @param3=[SOPHIEUYEUCAU,19..045208], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,12/10/2019 10:55:15 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-12-10 10:55:15,569 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-12-10 10:55:15,667 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-12-10 10:55:15,668 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,28483], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,23421], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,4747], @param8=[BACSICHIDINH_ID,null], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,12/10/2019 12:00:00 AM], @param11=[THANGYEUCAU,12], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,12/10/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,68], @param16=[NOITHUCHIEN_ID,104], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,3], @param50=[HOPDONG_BENHNHAN_ID,204], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,8/26/2019 1:44:06 PM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-12-10 10:55:15,668 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-12-10 10:55:15,755 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28483' and C.DICHVU_ID = '4747' and A.BENHVIEN_ID = 'HLU01']
2019-12-10 10:55:16,526 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28483' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-12-10 10:55:24,663 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '28483']
2019-12-10 10:55:29,765 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-12-10 10:55:29,766 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,28483], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,23421], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,206463], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,4747], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,3], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,40000], @param12=[THANHTIEN_DOANHTHU,40000], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,40000], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,40000], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,8/26/2019 1:44:06 PM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,12/10/2019 10:49:16 AM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-12-10 10:55:29,766 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-12-10 10:55:29,795 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 52          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 204]
2019-12-10 10:55:29,795 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,28483], @param1=[DVYEUCAU_ID,206463], @param2=[VIENPHI_ID,675751], @param3=[SOPHIEUYEUCAU,19..045209], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,12/10/2019 10:55:29 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-12-10 10:55:29,795 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-12-10 10:55:29,835 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-12-10 10:55:29,836 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,28483], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,23421], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,4005], @param8=[BACSICHIDINH_ID,null], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,12/10/2019 12:00:00 AM], @param11=[THANGYEUCAU,12], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,12/10/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,68], @param16=[NOITHUCHIEN_ID,92], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,3], @param50=[HOPDONG_BENHNHAN_ID,204], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,8/26/2019 1:44:06 PM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-12-10 10:55:29,836 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-12-10 10:55:29,991 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28483' and C.DICHVU_ID = '4005' and A.BENHVIEN_ID = 'HLU01']
2019-12-10 10:55:30,806 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28483' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-12-10 10:55:34,754 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '28483']
2019-12-10 10:55:39,171 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-12-10 10:55:39,172 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,28483], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,23421], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,206464], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,4005], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,9], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,70000], @param12=[THANHTIEN_DOANHTHU,70000], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,70000], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,70000], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,8/26/2019 1:44:06 PM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,12/10/2019 10:49:16 AM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-12-10 10:55:39,172 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-12-10 10:55:39,202 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 53          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 204]
2019-12-10 10:55:39,202 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,28483], @param1=[DVYEUCAU_ID,206464], @param2=[VIENPHI_ID,675752], @param3=[SOPHIEUYEUCAU,19..045210], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,12/10/2019 10:55:39 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-12-10 10:55:39,202 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-12-10 10:55:39,238 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-12-10 10:55:39,239 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,28483], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,23421], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,4017], @param8=[BACSICHIDINH_ID,null], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,12/10/2019 12:00:00 AM], @param11=[THANGYEUCAU,12], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,12/10/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,68], @param16=[NOITHUCHIEN_ID,92], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,3], @param50=[HOPDONG_BENHNHAN_ID,204], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,8/26/2019 1:44:06 PM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-12-10 10:55:39,239 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-12-10 10:55:39,286 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28483' and C.DICHVU_ID = '4017' and A.BENHVIEN_ID = 'HLU01']
2019-12-10 10:55:39,974 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28483' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-12-10 10:55:49,905 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '28483']
2019-12-10 10:56:02,338 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-12-10 10:56:02,339 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,28483], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,23421], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,206465], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,4017], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,3], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,50000], @param12=[THANHTIEN_DOANHTHU,50000], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,50000], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,50000], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,8/26/2019 1:44:06 PM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,12/10/2019 10:49:16 AM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-12-10 10:56:02,339 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-12-10 10:56:02,367 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 54          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 204]
2019-12-10 10:56:02,367 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,28483], @param1=[DVYEUCAU_ID,206465], @param2=[VIENPHI_ID,675753], @param3=[SOPHIEUYEUCAU,19..045211], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,12/10/2019 10:56:02 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-12-10 10:56:02,367 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-12-10 10:56:02,488 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '204'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:56:02,597 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '210'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:56:02,633 [1] DEBUG - Statement Id: [DAOLOG01_LockBegin] PreparedStatement : [INSERT into TT_LOG_UPDATE ( REF_TABLE , REF_ID , BENHVIEN_ID )         values ( @param0 ,  @param1 ,  @param2 );]
2019-12-10 10:56:02,634 [1] DEBUG - Statement Id: [DAOLOG01_LockBegin] Parameters: [@param0=[REF_TABLE,TT_TIEPNHAN_BENHAN], @param1=[REF_ID,23397], @param2=[BENHVIEN_ID,HLU01]]
2019-12-10 10:56:02,634 [1] DEBUG - Statement Id: [DAOLOG01_LockBegin] Types: [@param0=[String, System.String], @param1=[Int64, System.Int64], @param2=[String, System.String]]
2019-12-10 10:56:02,690 [1] DEBUG - Statement Id: [DAO00013_GetPatientInfo] PreparedStatement : [select *        from TT_BENHNHAN        where MAYTE  = '190043279']
2019-12-10 10:56:02,727 [1] DEBUG - Statement Id: [DAO00095_GetListNguoiLienHe] PreparedStatement : [SELECT BNN.*, D.DICTIONARY_NAME AS TENQUANHE          FROM TT_BENHNHAN AS BN          INNER JOIN TT_BENHNHAN_NGUOILIENHE AS BNN ON BNN.BENHNHAN_ID = BN.BENHNHAN_ID          LEFT JOIN LST_DICTIONARY AS D ON D.DICTIONARY_ID = BNN.QUANHE_ID AND D.DICTIONARY_TYPE_CODE = 'QuanHeGiaDinh'          WHERE BN.MAYTE = '190043279' AND BN.ACTIVE = '1' AND BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:56:02,771 [1] DEBUG - Statement Id: [DAO00013_GetBenhNhanToDB] PreparedStatement : [select ROW_NUMBER() OVER(order by a.MAYTE) as ROWNUMBER, *,        CASE        WHEN A.GIOITINH = 1 THEN 'Nam'        WHEN A.GIOITINH = 2 THEN N'Nữ'        END as TENGIOITINH        from TT_BENHNHAN A        where  ACTIVE = '1' and MAYTE = '190043279']
2019-12-10 10:56:13,892 [1] DEBUG - Statement Id: [DAO00095_GetListTiepNhanWithBenhNhanId] PreparedStatement : [SELECT A.SOTIEPNHAN, A.TIEPNHAN_ID, B.BENHAN_ID, B.SOBENHAN, bn.MAYTE          from TT_TIEPNHAN A          left join TT_NOITRU_BENHAN B on A.TIEPNHAN_ID = B.TIEPNHAN_ID          left join (select MAYTE, BENHNHAN_ID from TT_BENHNHAN where BENHNHAN_ID = '23397') bn on bn.BENHNHAN_ID = A.BENHNHAN_ID          WHERE A.BENHVIEN_ID = 'HLU01' and A.BENHNHAN_ID = '23397'          and A.TRANGTHAI in ('DATIEPNHAN','CAPCUU','NOITRU')]
2019-12-10 10:56:13,936 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '27466' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-12-10 10:56:17,736 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '27466']
2019-12-10 10:56:23,207 [1] DEBUG - Statement Id: [DAO00027_GetListTiepNhanAllCOM30] PreparedStatement : [select distinct A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, isnull(C.SOBENHAN,NULL) as SOBENHAN,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI, A.SOBHYT, CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYTIEPNHAN,        B.*        , A.UUTIEN        from TT_TIEPNHAN A        inner join (select * from TT_BENHNHAN where MAYTE = '190043279' and ACTIVE = '1') B on B.BENHNHAN_ID = A.BENHNHAN_ID  and B.ACTIVE = '1'        left join TT_NOITRU_BENHAN C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        where A.TIEPNHAN_ID = '27466' and A.BENHVIEN_ID = 'HLU01' and (A.TRANGTHAI not in ('HUY','CAPCUU', 'NOITRU', 'NGOAITRU'))]
2019-12-10 10:56:27,845 [1] DEBUG - Statement Id: [DAO00095_GetListDVYeucauWithBenhNhanId] PreparedStatement : [SELECT A.SOTIEPNHAN, A.TIEPNHAN_ID, C.DICHVU_ID, C.DVYEUCAU_ID          from TT_TIEPNHAN A          left join (select * from TT_DVYEUCAU where BENHNHAN_ID = '23397') C on C.TIEPNHAN_ID = A.TIEPNHAN_ID          WHERE A.BENHVIEN_ID = 'HLU01' and A.BENHNHAN_ID = '23397'          and A.TRANGTHAI in ('DATIEPNHAN','CAPCUU','NOITRU')]
2019-12-10 10:56:27,892 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '27466' and C.DICHVU_ID = '4061' and A.BENHVIEN_ID = 'HLU01'         and           C.DVYEUCAU_ID = '205392']
2019-12-10 10:56:29,275 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '27466' and C.DICHVU_ID = '5435' and A.BENHVIEN_ID = 'HLU01'         and           C.DVYEUCAU_ID = '205393']
2019-12-10 10:56:30,266 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '27466' and C.DICHVU_ID = '203' and A.BENHVIEN_ID = 'HLU01'         and           C.DVYEUCAU_ID = '205394']
2019-12-10 10:56:31,132 [1] DEBUG - Statement Id: [DAO00095_GetListToaThuocNoiTruWithBenhNhanId] PreparedStatement : [SELECT B.KHAMBENH_ID as KHAMBENH_TOATHUOC_ID, 'NOITRU' as LOAITOA          from TT_TIEPNHAN A          left join TT_NOITRU_TOATHUOC B on A.TIEPNHAN_ID = B.TIEPNHAN_ID          WHERE A.BENHVIEN_ID = 'HLU01' and A.BENHNHAN_ID = '23397'          and A.TRANGTHAI in ('DATIEPNHAN','CAPCUU','NOITRU')]
2019-12-10 10:56:31,361 [1] DEBUG - Statement Id: [DAO00027_GetListDuyetToaThuocBHYTCOM24_Noi] PreparedStatement : [select distinct A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        B.*, 'NOITRU' as LOAITOA, C.PHAMVI_ID as PHAMVI_ID        from TT_NOITRU_TOATHUOC C        inner join TT_TIEPNHAN A on C.TIEPNHAN_ID = A.TIEPNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID        where (C.TRANGTHAI = 'DADUYET' or C.TRANGTHAI = 'CHUAXUAT' or C.TRANGTHAI = 'DAXUAT') and C.BENHVIEN_ID = 'HLU01' and C.KHAMBENH_ID = '' and (A.SOBHYT is not null or A.SOBHYT != '')]
2019-12-10 10:56:31,715 [1] DEBUG - Statement Id: [DAO00027_GetListDuyetToaThuocBHYTCOM24_Noi] PreparedStatement : [select distinct A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        B.*, 'NOITRU' as LOAITOA, C.PHAMVI_ID as PHAMVI_ID        from TT_NOITRU_TOATHUOC C        inner join TT_TIEPNHAN A on C.TIEPNHAN_ID = A.TIEPNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID        where (C.TRANGTHAI = 'DADUYET' or C.TRANGTHAI = 'CHUAXUAT' or C.TRANGTHAI = 'DAXUAT') and C.BENHVIEN_ID = 'HLU01' and C.KHAMBENH_ID = '' and (A.SOBHYT is not null or A.SOBHYT != '')]
2019-12-10 10:56:31,744 [1] DEBUG - Statement Id: [DAO00095_GetLisToaThuocNgoaiWithBenhNhanId] PreparedStatement : [SELECT B.KHAMBENH_TOATHUOC_ID, B.LOAITOATHUOC as LOAITOA          from TT_TIEPNHAN A          left join TT_NGOAITRU_KHAMBENH C on C.TIEPNHAN_ID = A.TIEPNHAN_ID          left join TT_NGOAITRU_KHAMBENH_TOATHUOC B on C.KHAMBENH_ID = B.KHAMBENH_ID          WHERE A.BENHVIEN_ID = 'HLU01' and A.BENHNHAN_ID = '23397'          and A.TRANGTHAI in ('DATIEPNHAN','CAPCUU','NOITRU')]
2019-12-10 10:56:31,818 [1] DEBUG - Statement Id: [DAO00027_GetListDuyetToaThuocBHYTCOM24_Ngoai_ForDelete] PreparedStatement : [select distinct A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        B.*, 'NGOAITRU' as LOAITOA, C.PHAMVI_ID as PHAMVI_ID        from TT_NGOAITRU_KHAMBENH_TOATHUOC C        inner join TT_NGOAITRU_KHAMBENH D on C.KHAMBENH_ID = D.KHAMBENH_ID        inner join TT_TIEPNHAN A on D.TIEPNHAN_ID = A.TIEPNHAN_ID              inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID        where C.KHAMBENH_TOATHUOC_ID = '']
2019-12-10 10:56:31,860 [1] DEBUG - Statement Id: [DAO00027_GetListDuyetToaThuocBHYTCOM24_Ngoai] PreparedStatement : [select distinct A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        B.*, 'NGOAITRU' as LOAITOA, C.PHAMVI_ID as PHAMVI_ID        from TT_NGOAITRU_KHAMBENH_TOATHUOC C        inner join TT_NGOAITRU_KHAMBENH D on C.KHAMBENH_ID = D.KHAMBENH_ID        inner join TT_TIEPNHAN A on D.TIEPNHAN_ID = A.TIEPNHAN_ID                inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID        where C.DUYET = '1' and C.TRANGTHAI = 'CHUAXUAT' and C.BENHVIEN_ID = 'HLU01' and C.KHAMBENH_TOATHUOC_ID = '' and (C.LOAITOATHUOC = 'BV' or C.LOAITOATHUOC = 'MP' or C.LOAITOATHUOC = 'KTBV')]
2019-12-10 10:56:31,906 [1] DEBUG - Statement Id: [DAO00307_UpdatePatientKSK] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN set        MAYTE =  @param0         , TENBENHNHAN =  @param1         , GIOITINH =  @param2         , NGAYSINH =  @param3         , NAMSINH =  @param4         , DIACHI =  @param5         , QUOCTICH_ID =  @param6         , TINHTHANH_ID =  @param7         , QUANHUYEN_ID =  @param8         , XAPHUONG_ID =  @param9         , DIACHITHUONGTRU =  @param10         , DANTOC_ID =  @param11         , SODIENTHOAI =  @param12         , NGHENGHIEP_ID =  @param13         , CMND =  @param14         , NGAYCAPNHAT =  @param15         , NGUOICAPNHAT_ID =  @param16         where        BENHNHAN_ID = '23397']
2019-12-10 10:56:31,906 [1] DEBUG - Statement Id: [DAO00307_UpdatePatientKSK] Parameters: [@param0=[MAYTE,190043279], @param1=[TENBENHNHAN,Nguyễn Hữu Khai], @param2=[GIOITINH,1], @param3=[NGAYSINH,2/15/1990 12:00:00 AM], @param4=[NAMSINH,1990], @param5=[DIACHI,null], @param6=[QUOCTICH_ID,null], @param7=[TINHTHANH_ID,null], @param8=[QUANHUYEN_ID,null], @param9=[XAPHUONG_ID,null], @param10=[DIACHITHUONGTRU,null], @param11=[DANTOC_ID,null], @param12=[SODIENTHOAI,null], @param13=[NGHENGHIEP_ID,null], @param14=[CMND,null], @param15=[NGAYCAPNHAT,12/10/2019 12:00:00 AM], @param16=[NGUOICAPNHAT_ID,1]]
2019-12-10 10:56:31,906 [1] DEBUG - Statement Id: [DAO00307_UpdatePatientKSK] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[Int64, System.Int64], @param3=[DateTime, System.DateTime], @param4=[Int64, System.Int64], @param5=[System.DBNull, null], @param6=[System.DBNull, null], @param7=[System.DBNull, null], @param8=[System.DBNull, null], @param9=[System.DBNull, null], @param10=[System.DBNull, null], @param11=[System.DBNull, null], @param12=[System.DBNull, null], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[DateTime, System.DateTime], @param16=[Int64, System.Int64]]
2019-12-10 10:56:31,947 [1] DEBUG - Statement Id: [DAO00118_Add_BenhNhan] PreparedStatement : [if not exists (select 1 from TT_BENHNHAN where BENHNHAN_ID = '23397')              insert into TT_BENHNHAN (              BENHNHAN_ID              , MAYTE              , SOVAOVIEN              , TENBENHNHAN              , HO              , TEN              , GIOITINH              , NGAYSINH              , NAMSINH              , SONHA              , DIACHI              , SODIENTHOAI              , XAPHUONG_ID              , QUANHUYEN_ID              , TINHTHANH_ID              , DANTOC_ID              , QUOCTICH_ID              , SOLUUTRUNOITRU              , SOLUUTRUNGOAITRU              , NGHENGHIEP_ID              , CMND              , HOCHIEU              , VIETKIEU              , NGUOINUOCNGOAI              , DIACHITHUONGTRU              , DIACHILIENLAC              , DIACHICOQUAN              , EMAIL              , NHOMMAU_ID              , YEUTORH_ID              , TIENSUDIUNG              , TIENSUBENH              , TIENSUHUTTHUOCLA              , TUVONG              , NGAYTUVONG              , THOIGIANTUVONG              , NGUYENNHANTUVONG_ID              , NGUOIGHINHANTUVONG_ID              , THOIGIANGHINHANTUVONG              , NHANVIEN_ID              , DONVICONGTAC_ID              , DIENTHOAIBAN              , TINHTRANGHONNHAN_ID              , NGUOILIENHE_ID              , MOIQUANHE_ID              , NGUOILIENHE              , THONGTIN_NLH              , GHICHU              , HINHANH_DAIDIEN              , BENHVIEN_ID              , NGAYTAO              , NGUOITAO_ID              , NGAYGIOSINH              ) values (               @param0               ,  @param1               ,  @param2               ,  @param3               ,  @param4               ,  @param5               ,  @param6               ,  @param7               ,  @param8               ,  @param9               ,  @param10               ,  @param11               ,  @param12               ,  @param13               ,  @param14               ,  @param15               ,  @param16               ,  @param17               ,  @param18               ,  @param19               ,  @param20               ,  @param21               ,  @param22               ,  @param23               ,  @param24               ,  @param25               ,  @param26               ,  @param27               ,  @param28               ,  @param29               ,  @param30               ,  @param31               ,  @param32               ,  @param33               ,  @param34               ,  @param35               ,  @param36               ,  @param37               ,  @param38               ,  @param39               ,  @param40               ,  @param41               ,  @param42               ,  @param43               ,  @param44               ,  @param45               ,  @param46               ,  @param47               ,  @param48               ,  @param49               ,  @param50               ,  @param51               ,  @param52               )              else              update TT_BENHNHAN set              MAYTE =  @param1                ,                   SOVAOVIEN =  @param2                ,                   TENBENHNHAN =  @param3                ,                   HO =  @param4                ,                   TEN =  @param5                ,                   GIOITINH =  @param6                ,                   NGAYSINH =  @param7                ,                   NAMSINH =  @param8                ,                   SONHA =  @param9                ,                   SODIENTHOAI =  @param11                ,                   XAPHUONG_ID =  @param12                ,                   DANTOC_ID =  @param15                ,                   QUOCTICH_ID =  @param16                ,                   NGHENGHIEP_ID =  @param19                ,                   CMND =  @param20                ,                   HOCHIEU =  @param21                ,                   DIACHITHUONGTRU =  @param24                ,                   DIACHILIENLAC =  @param25                ,                   NGUOILIENHE_ID =  @param43                ,                   MOIQUANHE_ID =  @param44                ,                   NGUOILIENHE =  @param45                ,                   THONGTIN_NLH =  @param46                ,                   GHICHU =  @param47                ,                   BENHVIEN_ID =  @param49                ,                   NGAYCAPNHAT =  @param53                ,                   NGUOICAPNHAT_ID =  @param54                              where              BENHNHAN_ID = '23397']
2019-12-10 10:56:31,947 [1] DEBUG - Statement Id: [DAO00118_Add_BenhNhan] Parameters: [@param0=[BENHNHAN_ID,23397], @param1=[MAYTE,190043279], @param2=[SOVAOVIEN,0043279], @param3=[TENBENHNHAN,Nguyễn Hữu Khai], @param4=[HO,Nguyễn], @param5=[TEN,Hữu Khai], @param6=[GIOITINH,1], @param7=[NGAYSINH,2/15/1990 12:00:00 AM], @param8=[NAMSINH,1990], @param9=[SONHA,null], @param10=[DIACHI,null], @param11=[SODIENTHOAI,null], @param12=[XAPHUONG_ID,null], @param13=[QUANHUYEN_ID,null], @param14=[TINHTHANH_ID,null], @param15=[DANTOC_ID,null], @param16=[QUOCTICH_ID,null], @param17=[SOLUUTRUNOITRU,null], @param18=[SOLUUTRUNGOAITRU,null], @param19=[NGHENGHIEP_ID,null], @param20=[CMND,null], @param21=[HOCHIEU,null], @param22=[VIETKIEU,null], @param23=[NGUOINUOCNGOAI,null], @param24=[DIACHITHUONGTRU,null], @param25=[DIACHILIENLAC,null], @param26=[DIACHICOQUAN,null], @param27=[EMAIL,null], @param28=[NHOMMAU_ID,null], @param29=[YEUTORH_ID,null], @param30=[TIENSUDIUNG,null], @param31=[TIENSUBENH,null], @param32=[TIENSUHUTTHUOCLA,null], @param33=[TUVONG,null], @param34=[NGAYTUVONG,null], @param35=[THOIGIANTUVONG,null], @param36=[NGUYENNHANTUVONG_ID,null], @param37=[NGUOIGHINHANTUVONG_ID,null], @param38=[THOIGIANGHINHANTUVONG,null], @param39=[NHANVIEN_ID,null], @param40=[DONVICONGTAC_ID,null], @param41=[DIENTHOAIBAN,null], @param42=[TINHTRANGHONNHAN_ID,null], @param43=[NGUOILIENHE_ID,null], @param44=[MOIQUANHE_ID,null], @param45=[NGUOILIENHE,null], @param46=[THONGTIN_NLH,null], @param47=[GHICHU,null], @param48=[HINHANH_DAIDIEN,null], @param49=[BENHVIEN_ID,HLU01], @param50=[NGAYTAO,12/9/2019 3:16:19 PM], @param51=[NGUOITAO_ID,0], @param52=[NGAYGIOSINH,null], @param53=[NGAYCAPNHAT,12/10/2019 12:00:00 AM], @param54=[NGUOICAPNHAT_ID,1]]
2019-12-10 10:56:31,947 [1] DEBUG - Statement Id: [DAO00118_Add_BenhNhan] Types: [@param0=[Int32, System.Int32], @param1=[String, System.String], @param2=[String, System.String], @param3=[String, System.String], @param4=[String, System.String], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[DateTime, System.DateTime], @param8=[Int64, System.Int64], @param9=[System.DBNull, null], @param10=[System.DBNull, null], @param11=[System.DBNull, null], @param12=[System.DBNull, null], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[System.DBNull, null], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[System.DBNull, null], @param39=[System.DBNull, null], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[String, System.String], @param50=[DateTime, System.DateTime], @param51=[Int64, System.Int64], @param52=[System.DBNull, null], @param53=[DateTime, System.DateTime], @param54=[Int64, System.Int64]]
2019-12-10 10:56:32,022 [1] DEBUG - Statement Id: [DAOWF001_Laythongtingateways] PreparedStatement : [select * from TM_PROCESS_GATEWAYS]
2019-12-10 10:56:32,050 [1] DEBUG - Statement Id: [DAO00019_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10),        @yearNow int, @monthNow varchar(2), @dayNow varchar(2),        @Sotiepnhan varchar(20), @SoThuTu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @monthNow = RIGHT('00' + convert(varchar(2), MONTH(getdate())),2)        set @dayNow = RIGHT('00' + convert(varchar(2), DAY(getdate())),2)        BEGIN        select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOTIEPNHAN' and KEYYEAR = @yearNow and KEYMONTH = @monthNow and KEYDAY = @dayNow        and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOTIEPNHAN', @yearNow, @monthNow, @dayNow, '0', '0', '0', 0, @BenhVienId);        Update LST_KEYDATA set KEYVALUE = (KEYVALUE + 1), @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOTIEPNHAN' and KEYYEAR = @yearNow and KEYMONTH = @monthNow and KEYDAY = @dayNow and BENHVIEN_ID = @BenhVienId        set @SoThuTu = right('0000000'+convert(varchar(7), @keyValue), 7)        set @Sotiepnhan = 'TN' + RIGHT(@yearNow, 2) + @monthNow  + @dayNow + '.' + @SoThuTu                   insert into TT_TIEPNHAN (        SOTIEPNHAN        , UUTIEN        , BENHNHAN_ID        , BENHVIEN_ID        , TUYENKHAMBENH_ID        , NOITIEPNHAN_ID        , NGAYTIEPNHAN        , THOIGIANTIEPNHAN        , NAMTIEPNHAN        , THANGTIEPNHAN        , DOITUONG_ID        , LYDOTIEPNHAN_ID        , HINHTHUCDENKHAM_ID        , TINHTRANGHEN        , XACNHANCHIPHI_ID        , THUTIENTRUOC        , TAIKHAM        , SOBHYT        , BHYTTUNGAY        , BHYTDENNGAY        , BHYTNGAYCAP        , BHYTTREN3NAM        , BHYTTREN5NAM        , NGAYMIENDONGCHITRA        , LOAIBHYT        , NGAYBHYT2        , SOCHUYENVIEN        , HINHTHUCCHUYENVIEN_ID        , NOIGIOITHIEU_ID        , NGUOIGIOITHIEU_ID        , THOIGIANCHUYENTUYEN        , LYDOCHUYENVIEN_ID        , ICDNOIGIOITHIEU_ID        , CHANDOANNGT        , TRAITUYEN        , DIACHILIENHE        , XAPHUONG_ID        , QUANHUYEN_ID        , TINHTHANH_ID        , PROCESS_ID        , TRANGTHAI        , KHUVUCSONG_ID        , THANHVIEN_ID        , THE_ID        , LOAITHANHVIEN_ID        , SUDUNG_BHTN        , VIP        , GHICHU_TIEPNHAN        , BAOLANH_VIENPHI        , CONGTY_CHITRA_ID        , NGUON_BENHNHAN_ID        , LOAITIEPNHAN_ID        , THONGTIN_KCB_BHYT        , NGAYTAO        , NGUOITAO_ID        , LYDODENKHAM         ,           ISTHONGTUYEN                 )        OUTPUT INSERTED.TIEPNHAN_ID, INSERTED.SOTIEPNHAN        values (        @Sotiepnhan        ,  @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54          ,            @param55                  )        end]
2019-12-10 10:56:32,051 [1] DEBUG - Statement Id: [DAO00019_Add] Parameters: [@param0=[UUTIEN,0], @param1=[BENHNHAN_ID,23397], @param2=[BENHVIEN_ID,HLU01], @param3=[TUYENKHAMBENH_ID,null], @param4=[NOITIEPNHAN_ID,68], @param5=[NGAYTIEPNHAN,12/10/2019 12:00:00 AM], @param6=[THOIGIANTIEPNHAN,12/10/2019 12:00:00 AM], @param7=[NAMTIEPNHAN,2019], @param8=[THANGTIEPNHAN,12], @param9=[DOITUONG_ID,1], @param10=[LYDOTIEPNHAN_ID,null], @param11=[HINHTHUCDENKHAM_ID,461], @param12=[TINHTRANGHEN,null], @param13=[XACNHANCHIPHI_ID,null], @param14=[THUTIENTRUOC,null], @param15=[TAIKHAM,0], @param16=[SOBHYT,null], @param17=[BHYTTUNGAY,null], @param18=[BHYTDENNGAY,null], @param19=[BHYTNGAYCAP,null], @param20=[BHYTTREN3NAM,0], @param21=[BHYTTREN5NAM,0], @param22=[NGAYMIENDONGCHITRA,null], @param23=[LOAIBHYT,null], @param24=[NGAYBHYT2,null], @param25=[SOCHUYENVIEN,null], @param26=[HINHTHUCCHUYENVIEN_ID,null], @param27=[NOIGIOITHIEU_ID,null], @param28=[NGUOIGIOITHIEU_ID,null], @param29=[THOIGIANCHUYENTUYEN,null], @param30=[LYDOCHUYENVIEN_ID,null], @param31=[ICDNOIGIOITHIEU_ID,null], @param32=[CHANDOANNGT,null], @param33=[TRAITUYEN,0], @param34=[DIACHILIENHE,null], @param35=[XAPHUONG_ID,null], @param36=[QUANHUYEN_ID,null], @param37=[TINHTHANH_ID,null], @param38=[PROCESS_ID,P01], @param39=[TRANGTHAI,DATIEPNHAN], @param40=[KHUVUCSONG_ID,null], @param41=[THANHVIEN_ID,null], @param42=[THE_ID,null], @param43=[LOAITHANHVIEN_ID,null], @param44=[SUDUNG_BHTN,0], @param45=[VIP,0], @param46=[GHICHU_TIEPNHAN,null], @param47=[BAOLANH_VIENPHI,0], @param48=[CONGTY_CHITRA_ID,null], @param49=[NGUON_BENHNHAN_ID,null], @param50=[LOAITIEPNHAN_ID,null], @param51=[THONGTIN_KCB_BHYT,null], @param52=[NGAYTAO,12/10/2019 10:56:32 AM], @param53=[NGUOITAO_ID,0], @param54=[LYDODENKHAM,null], @param55=[ISTHONGTUYEN,0]]
2019-12-10 10:56:32,051 [1] DEBUG - Statement Id: [DAO00019_Add] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[String, System.String], @param3=[System.DBNull, null], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[DateTime, System.DateTime], @param7=[Int32, System.Int32], @param8=[Int32, System.Int32], @param9=[Int64, System.Int64], @param10=[System.DBNull, null], @param11=[Int64, System.Int64], @param12=[System.DBNull, null], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[String, System.String], @param21=[String, System.String], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[String, System.String], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[String, System.String], @param45=[String, System.String], @param46=[System.DBNull, null], @param47=[String, System.String], @param48=[System.DBNull, null], @param49=[System.DBNull, null], @param50=[System.DBNull, null], @param51=[System.DBNull, null], @param52=[DateTime, System.DateTime], @param53=[Int64, System.Int64], @param54=[System.DBNull, null], @param55=[String, System.String]]
2019-12-10 10:56:32,079 [1] DEBUG - Statement Id: [DAO00019_GetTTTiepNhan_byTiepNhanId] PreparedStatement : [select *        from TT_TIEPNHAN        where TIEPNHAN_ID = '28484'        order by TIEPNHAN_ID]
2019-12-10 10:56:32,108 [1] DEBUG - Statement Id: [DAO00080_Add_KhamBenh_CapCuu] PreparedStatement : [insert into TT_KHAMBENH_VAOVIEN (        SOPHIEU        , TIEPNHAN_ID        , KHAMBENH_ID        , BENHNHAN_ID        , NGUOILIENHE        , DIENTHOAILIENHE        , NOILAMVIEC        , CHANDOANNOIGIOITHIEU        , NGAYKHAM        , THOIGIANKHAM        , LYDOVAOVIEN        , QUATRINHBENHLY        , TIENSUBANTHAN        , TIENSUGIADINH        , KHAMXETTOANTHAN        , KHAMXETCACBOPHAN        , KHAMXETKQLS        , CHANDOANVAO        , ICDKHAMXET_ID        , DAXULY        , NGAYRA        , THOIGIANRA        , NHAPKHOA_ID        , CHUYENVIEN_ID        , CHUY        , MACH        , NHIETDO        , HUYETAPCAO        , HUYETAPTHAP        , NHIPTHO        , CANNANG        , CHIEUCAO        , BACSI_ID        , XUTRUKHAMBENH_ID        , CAPCUU        , NGAYTAINAN        , THOIGIANTAINAN        , NOITAINAN_TINHTHANH_ID        , NOITAINAN_QUANHUYEN_ID        , NOITAINAN_PHUONGXA_ID        , NOITAINAN_DIACHI        , DIADIEMTAINAN_ID        , BOPHANBITHUONG_ID        , MUCDO_ID        , DIENBIENSAUTN_ID        , XUTRISAUTN_ID        , NGUYENNHAN_ID        , NGUYENNHANCHITIET_ID        , ICD_NGUYENNHAN        , NGAYTAO        , NGUOITAO_ID        , NGAYCAPNHAT        , NGUOICAPNHAT_ID        , BENHANCHUYENKHOA        , CHANDOANVAOVIEN        , CHANDOANRAVIEN        , DIEUTRITUNGAY        , DIEUTRIDENNGAY        , DIENBIENLS        , KQXETNGHIEM        , PHAUTHUAT        , THUTHUAT        , TINHTRANGNGUOIBENH        , HUONGDIEUTRI        , NGUOIGIAO_ID        , NGUOINHAN_ID        , XQUANG        , CTSCANNER        , SIEUAM        , XETNGHIEM        , KHAC        , TOANBOHS        , LOAICHUYENKHOA        , CONGANCANTHIEP        , CDRR_BENHCHINH        , CDRR_BENHKEM        , ICD_BENHCHINH        , ICD_BENHKEMTHEO        , PHUONGPHAPDIEUTRI        , FIELD_1        , FIELD_2        , FIELD_3        , FIELD_4        , FIELD_5        , FIELD_6        , FIELD_7        , FIELD_8        , FIELD_9        , FIELD_10        , FIELD_11        , FIELD_12        , FIELD_13        , FIELD_14        , FIELD_15        , FIELD_27        , FIELD_28        , FIELD_29        , FIELD_30        , FIELD_31        , FIELD_32        , FIELD_33        , FIELD_34        , FIELD_35        , FIELD_36        , FIELD_37        , FIELD_38        , FIELD_39        , FIELD_40        , FIELD_41        , FIELD_42        , FIELD_43        , FIELD_44        , FIELD_45        , FIELD_46        , FIELD_47        , FIELD_48        , FIELD_49        , FIELD_50        , FIELD_51        , FIELD_52        , FIELD_53        , FIELD_54        , FIELD_55        , FIELD_56        , BENHVIEN_ID        ) values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77         ,  @param78         ,  @param79         ,  @param80         ,  @param81         ,  @param82         ,  @param83         ,  @param84         ,  @param85         ,  @param86         ,  @param87         ,  @param88         ,  @param89         ,  @param90         ,  @param91         ,  @param92         ,  @param93         ,  @param94         ,  @param95         ,  @param96         ,  @param97         ,  @param98         ,  @param99         ,  @param100         ,  @param101         ,  @param102         ,  @param103         ,  @param104         ,  @param105         ,  @param106         ,  @param107         ,  @param108         ,  @param109         ,  @param110         ,  @param111         ,  @param112         ,  @param113         ,  @param114         ,  @param115         ,  @param116         ,  @param117         ,  @param118         ,  @param119         ,  @param120         ,  @param121         ,  @param122         ,  @param123         ,  @param124         )]
2019-12-10 10:56:32,109 [1] DEBUG - Statement Id: [DAO00080_Add_KhamBenh_CapCuu] Parameters: [@param0=[SOPHIEU,null], @param1=[TIEPNHAN_ID,28484], @param2=[KHAMBENH_ID,null], @param3=[BENHNHAN_ID,23397], @param4=[NGUOILIENHE,null], @param5=[DIENTHOAILIENHE,null], @param6=[NOILAMVIEC,null], @param7=[CHANDOANNOIGIOITHIEU,null], @param8=[NGAYKHAM,12/10/2019 12:00:00 AM], @param9=[THOIGIANKHAM,12/10/2019 12:00:00 AM], @param10=[LYDOVAOVIEN,null], @param11=[QUATRINHBENHLY,null], @param12=[TIENSUBANTHAN,null], @param13=[TIENSUGIADINH,null], @param14=[KHAMXETTOANTHAN,null], @param15=[KHAMXETCACBOPHAN,null], @param16=[KHAMXETKQLS,null], @param17=[CHANDOANVAO,null], @param18=[ICDKHAMXET_ID,null], @param19=[DAXULY,null], @param20=[NGAYRA,null], @param21=[THOIGIANRA,null], @param22=[NHAPKHOA_ID,68], @param23=[CHUYENVIEN_ID,null], @param24=[CHUY,null], @param25=[MACH,null], @param26=[NHIETDO,null], @param27=[HUYETAPCAO,null], @param28=[HUYETAPTHAP,null], @param29=[NHIPTHO,null], @param30=[CANNANG,null], @param31=[CHIEUCAO,null], @param32=[BACSI_ID,null], @param33=[XUTRUKHAMBENH_ID,null], @param34=[CAPCUU,null], @param35=[NGAYTAINAN,null], @param36=[THOIGIANTAINAN,null], @param37=[NOITAINAN_TINHTHANH_ID,null], @param38=[NOITAINAN_QUANHUYEN_ID,null], @param39=[NOITAINAN_PHUONGXA_ID,null], @param40=[NOITAINAN_DIACHI,null], @param41=[DIADIEMTAINAN_ID,null], @param42=[BOPHANBITHUONG_ID,null], @param43=[MUCDO_ID,null], @param44=[DIENBIENSAUTN_ID,null], @param45=[XUTRISAUTN_ID,null], @param46=[NGUYENNHAN_ID,null], @param47=[NGUYENNHANCHITIET_ID,null], @param48=[ICD_NGUYENNHAN,null], @param49=[NGAYTAO,12/10/2019 10:56:32 AM], @param50=[NGUOITAO_ID,0], @param51=[NGAYCAPNHAT,12/10/2019 10:56:32 AM], @param52=[NGUOICAPNHAT_ID,0], @param53=[BENHANCHUYENKHOA,null], @param54=[CHANDOANVAOVIEN,null], @param55=[CHANDOANRAVIEN,null], @param56=[DIEUTRITUNGAY,null], @param57=[DIEUTRIDENNGAY,null], @param58=[DIENBIENLS,null], @param59=[KQXETNGHIEM,null], @param60=[PHAUTHUAT,null], @param61=[THUTHUAT,null], @param62=[TINHTRANGNGUOIBENH,null], @param63=[HUONGDIEUTRI,null], @param64=[NGUOIGIAO_ID,null], @param65=[NGUOINHAN_ID,null], @param66=[XQUANG,null], @param67=[CTSCANNER,null], @param68=[SIEUAM,null], @param69=[XETNGHIEM,null], @param70=[KHAC,null], @param71=[TOANBOHS,null], @param72=[LOAICHUYENKHOA,null], @param73=[CONGANCANTHIEP,null], @param74=[CDRR_BENHCHINH,null], @param75=[CDRR_BENHKEM,null], @param76=[ICD_BENHCHINH,null], @param77=[ICD_BENHKEMTHEO,null], @param78=[PHUONGPHAPDIEUTRI,null], @param79=[FIELD_1,null], @param80=[FIELD_2,null], @param81=[FIELD_3,null], @param82=[FIELD_4,null], @param83=[FIELD_5,null], @param84=[FIELD_6,null], @param85=[FIELD_7,null], @param86=[FIELD_8,null], @param87=[FIELD_9,null], @param88=[FIELD_10,null], @param89=[FIELD_11,null], @param90=[FIELD_12,null], @param91=[FIELD_13,null], @param92=[FIELD_14,null], @param93=[FIELD_15,null], @param94=[FIELD_27,null], @param95=[FIELD_28,null], @param96=[FIELD_29,null], @param97=[FIELD_30,null], @param98=[FIELD_31,null], @param99=[FIELD_32,null], @param100=[FIELD_33,null], @param101=[FIELD_34,null], @param102=[FIELD_35,null], @param103=[FIELD_36,null], @param104=[FIELD_37,null], @param105=[FIELD_38,null], @param106=[FIELD_39,null], @param107=[FIELD_40,null], @param108=[FIELD_41,null], @param109=[FIELD_42,null], @param110=[FIELD_43,null], @param111=[FIELD_44,null], @param112=[FIELD_45,null], @param113=[FIELD_46,null], @param114=[FIELD_47,null], @param115=[FIELD_48,null], @param116=[FIELD_49,null], @param117=[FIELD_50,null], @param118=[FIELD_51,null], @param119=[FIELD_52,null], @param120=[FIELD_53,null], @param121=[FIELD_54,null], @param122=[FIELD_55,null], @param123=[FIELD_56,null], @param124=[BENHVIEN_ID,HLU01]]
2019-12-10 10:56:32,110 [1] DEBUG - Statement Id: [DAO00080_Add_KhamBenh_CapCuu] Types: [@param0=[System.DBNull, null], @param1=[Int32, System.Int32], @param2=[System.DBNull, null], @param3=[Int32, System.Int32], @param4=[System.DBNull, null], @param5=[System.DBNull, null], @param6=[System.DBNull, null], @param7=[System.DBNull, null], @param8=[DateTime, System.DateTime], @param9=[DateTime, System.DateTime], @param10=[System.DBNull, null], @param11=[System.DBNull, null], @param12=[System.DBNull, null], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[System.DBNull, null], @param22=[String, System.String], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[System.DBNull, null], @param39=[System.DBNull, null], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[DateTime, System.DateTime], @param50=[Int64, System.Int64], @param51=[DateTime, System.DateTime], @param52=[Int64, System.Int64], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[System.DBNull, null], @param59=[System.DBNull, null], @param60=[System.DBNull, null], @param61=[System.DBNull, null], @param62=[System.DBNull, null], @param63=[System.DBNull, null], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[System.DBNull, null], @param71=[System.DBNull, null], @param72=[System.DBNull, null], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null], @param81=[System.DBNull, null], @param82=[System.DBNull, null], @param83=[System.DBNull, null], @param84=[System.DBNull, null], @param85=[System.DBNull, null], @param86=[System.DBNull, null], @param87=[System.DBNull, null], @param88=[System.DBNull, null], @param89=[System.DBNull, null], @param90=[System.DBNull, null], @param91=[System.DBNull, null], @param92=[System.DBNull, null], @param93=[System.DBNull, null], @param94=[System.DBNull, null], @param95=[System.DBNull, null], @param96=[System.DBNull, null], @param97=[System.DBNull, null], @param98=[System.DBNull, null], @param99=[System.DBNull, null], @param100=[System.DBNull, null], @param101=[System.DBNull, null], @param102=[System.DBNull, null], @param103=[System.DBNull, null], @param104=[System.DBNull, null], @param105=[System.DBNull, null], @param106=[System.DBNull, null], @param107=[System.DBNull, null], @param108=[System.DBNull, null], @param109=[System.DBNull, null], @param110=[System.DBNull, null], @param111=[System.DBNull, null], @param112=[System.DBNull, null], @param113=[System.DBNull, null], @param114=[System.DBNull, null], @param115=[System.DBNull, null], @param116=[System.DBNull, null], @param117=[System.DBNull, null], @param118=[System.DBNull, null], @param119=[System.DBNull, null], @param120=[System.DBNull, null], @param121=[System.DBNull, null], @param122=[System.DBNull, null], @param123=[System.DBNull, null], @param124=[String, System.String]]
2019-12-10 10:56:32,142 [1] DEBUG - Statement Id: [DAO00019_Add_TT_TIEPNHAN_SOTHEBHYT] PreparedStatement : [INSERT INTO TT_TIEPNHAN_SOTHEBHYT        (TIEPNHAN_ID        ,BENHNHAN_ID        ,BENHAN_ID        ,DOITUONG_ID        ,SOBHYT        ,BHYTTUNGAY        ,BHYTDENNGAY        ,BHYTNGAYCAP        ,BHYTTREN3NAM        ,BHYTTREN5NAM        ,NGAYMIENDONGCHITRA        ,TRAITUYEN        ,BENHVIEN_ID        ,NOITAO_ID        ,NGAYTAO        ,NGUOITAO_ID        ,NGAYCAPNHAT        ,NGUOICAPNHAT_ID        ,TYLE_VUOT_LCB        ,TYLE_TRAITUYEN        ,GIOIHAN_VUOT_LCB        ,LUONG_COSO        ,TYLE_THUOC_UT        ,MADOITUONG)        VALUES        ( @param0         , @param1         , @param2         , @param3         , @param4         , @param5         , @param6         , @param7         , @param8         , @param9         , @param10         , @param11         , @param12         , @param13         , @param14         , @param15         , @param16         , @param17         , @param18         , @param19         , @param20         , @param21         , @param22         , @param23 )]
2019-12-10 10:56:32,142 [1] DEBUG - Statement Id: [DAO00019_Add_TT_TIEPNHAN_SOTHEBHYT] Parameters: [@param0=[TIEPNHAN_ID,28484], @param1=[BENHNHAN_ID,23397], @param2=[BENHAN_ID,null], @param3=[DOITUONG_ID,1], @param4=[SOBHYT,null], @param5=[BHYTTUNGAY,null], @param6=[BHYTDENNGAY,null], @param7=[BHYTNGAYCAP,null], @param8=[BHYTTREN3NAM,0], @param9=[BHYTTREN5NAM,0], @param10=[NGAYMIENDONGCHITRA,null], @param11=[TRAITUYEN,0], @param12=[BENHVIEN_ID,HLU01], @param13=[NOITAO_ID,68], @param14=[NGAYTAO,12/10/2019 10:56:32 AM], @param15=[NGUOITAO_ID,0], @param16=[NGAYCAPNHAT,12/10/2019 10:56:32 AM], @param17=[NGUOICAPNHAT_ID,0], @param18=[TYLE_VUOT_LCB,null], @param19=[TYLE_TRAITUYEN,null], @param20=[GIOIHAN_VUOT_LCB,null], @param21=[LUONG_COSO,null], @param22=[TYLE_THUOC_UT,null], @param23=[MADOITUONG,null]]
2019-12-10 10:56:32,142 [1] DEBUG - Statement Id: [DAO00019_Add_TT_TIEPNHAN_SOTHEBHYT] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[System.DBNull, null], @param3=[Int64, System.Int64], @param4=[System.DBNull, null], @param5=[System.DBNull, null], @param6=[System.DBNull, null], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[String, System.String], @param10=[System.DBNull, null], @param11=[String, System.String], @param12=[String, System.String], @param13=[String, System.String], @param14=[DateTime, System.DateTime], @param15=[Int64, System.Int64], @param16=[DateTime, System.DateTime], @param17=[Int64, System.Int64], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[System.DBNull, null], @param22=[System.DBNull, null], @param23=[System.DBNull, null]]
2019-12-10 10:56:32,190 [1] DEBUG - Statement Id: [DAO00027_GetListTiepNhanAllCOM30] PreparedStatement : [select distinct A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, isnull(C.SOBENHAN,NULL) as SOBENHAN,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI, A.SOBHYT, CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYTIEPNHAN,        B.*        , A.UUTIEN        from TT_TIEPNHAN A        inner join (select * from TT_BENHNHAN where MAYTE = '190043279' and ACTIVE = '1') B on B.BENHNHAN_ID = A.BENHNHAN_ID  and B.ACTIVE = '1'        left join TT_NOITRU_BENHAN C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        where A.TIEPNHAN_ID = '28484' and A.BENHVIEN_ID = 'HLU01' and (A.TRANGTHAI not in ('HUY','CAPCUU', 'NOITRU', 'NGOAITRU'))]
2019-12-10 10:56:33,103 [1] DEBUG - Statement Id: [DAOWF001_LaythongtinProcess] PreparedStatement : [select * from TM_PROCESS        where        PROCESS_CODE = 'P01']
2019-12-10 10:56:33,130 [1] DEBUG - Statement Id: [DAOWF001_Kiemtrathongtindayeucau] PreparedStatement : [select * from TT_REQUEST        where        PROCESS_CODE = 'P01'        AND PARA = '{"HOSPITAL_ID":"HLU01","SOTIEPNHAN":"TN191210.0000003"}'        AND CURR_STATE_CODE = '6'        AND ISACTIVE = '1']
2019-12-10 10:56:33,173 [1] DEBUG - Statement Id: [DAOWF002_Add] PreparedStatement : [DECLARE @IDRequestOld int        DECLARE @IDRequestNew int        select top 1 @IDRequestOld = ID from TT_REQUEST where PARA =  @param0  order by ID desc          insert into TT_REQUEST (        PROCESS_CODE        , PARA        , CURR_STATE_CODE        ) values (         @param1         ,  @param0         ,  @param2         )        SELECT @IDRequestNew = SCOPE_IDENTITY()        if (@IDRequestOld is not null)        begin        update TT_REQUEST_SERVICE set REQUEST_ID = @IDRequestNew, PROCESS_CODE =  @param1  where REQUEST_ID = @IDRequestOld        update TT_REQUEST set ISACTIVE = '0' where ID = @IDRequestOld        update TT_REQUEST_SERVICE_DETAIL set REQUEST_ID = @IDRequestNew where REQUEST_ID = @IDRequestOld        end          select @IDRequestNew]
2019-12-10 10:56:33,173 [1] DEBUG - Statement Id: [DAOWF002_Add] Parameters: [@param0=[PARA,{"HOSPITAL_ID":"HLU01","SOTIEPNHAN":"TN191210.0000003"}], @param1=[PROCESS_CODE,P01], @param2=[CURR_STATE_CODE,6]]
2019-12-10 10:56:33,173 [1] DEBUG - Statement Id: [DAOWF002_Add] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[String, System.String]]
2019-12-10 10:56:33,223 [1] DEBUG - Statement Id: [DAO00064_GetREGListVienphiTiepNhan] PreparedStatement : [select A.*, B.THUTIENSAU        from TT_VIENPHI A        left join TT_DVYEUCAU B on A.REF_ID =  B.DVYEUCAU_ID and A.REF_TABLE = 'TT_DVYEUCAU' and B.HUYYEUCAU = '0'        where        A.TIEPNHAN_ID = '28484' and A.BENHVIEN_ID = 'HLU01' and (A.BENHAN_ID is NULL or A.BENHAN_ID = '')        and A.HUY = '0'        ORDER BY A.VIENPHI_ID]
2019-12-10 10:56:33,275 [1] DEBUG - Statement Id: [DAOLOG01_LockEnd] PreparedStatement : [DELETE TT_LOG_UPDATE        where REF_TABLE = 'TT_TIEPNHAN_BENHAN' and REF_ID = '23397' and BENHVIEN_ID = 'HLU01']
2019-12-10 10:56:33,302 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-12-10 10:56:33,303 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,28484], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,23397], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,4135], @param8=[BACSICHIDINH_ID,null], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,12/10/2019 12:00:00 AM], @param11=[THANGYEUCAU,12], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,12/10/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,68], @param16=[NOITHUCHIEN_ID,35], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,3], @param50=[HOPDONG_BENHNHAN_ID,210], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,12/10/2019 10:43:44 AM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-12-10 10:56:33,303 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-12-10 10:56:33,389 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28484' and C.DICHVU_ID = '4135' and A.BENHVIEN_ID = 'HLU01']
2019-12-10 10:56:33,919 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28484' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-12-10 10:56:34,751 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '28484']
2019-12-10 10:56:35,538 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-12-10 10:56:35,538 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,28484], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,23397], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,206466], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,4135], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,9], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,90000], @param12=[THANHTIEN_DOANHTHU,90000], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,90000], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,90000], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,12/10/2019 10:43:44 AM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,12/10/2019 10:43:44 AM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-12-10 10:56:35,538 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-12-10 10:56:35,576 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 55          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 210]
2019-12-10 10:56:35,576 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,28484], @param1=[DVYEUCAU_ID,206466], @param2=[VIENPHI_ID,675754], @param3=[SOPHIEUYEUCAU,19..045212], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,12/10/2019 10:56:35 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-12-10 10:56:35,576 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-12-10 10:56:35,612 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-12-10 10:56:35,613 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,28484], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,23397], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,4524], @param8=[BACSICHIDINH_ID,null], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,12/10/2019 12:00:00 AM], @param11=[THANGYEUCAU,12], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,12/10/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,68], @param16=[NOITHUCHIEN_ID,104], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,3], @param50=[HOPDONG_BENHNHAN_ID,210], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,12/10/2019 10:43:44 AM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-12-10 10:56:35,613 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-12-10 10:56:36,013 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28484' and C.DICHVU_ID = '4524' and A.BENHVIEN_ID = 'HLU01']
2019-12-10 10:56:36,790 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28484' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-12-10 10:56:38,493 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '28484']
2019-12-10 10:56:40,392 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-12-10 10:56:40,392 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,28484], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,23397], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,206467], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,4524], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,3], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,50000], @param12=[THANHTIEN_DOANHTHU,50000], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,50000], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,50000], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,12/10/2019 10:43:44 AM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,12/10/2019 10:43:44 AM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-12-10 10:56:40,392 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-12-10 10:56:40,424 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 56          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 210]
2019-12-10 10:56:40,424 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,28484], @param1=[DVYEUCAU_ID,206467], @param2=[VIENPHI_ID,675755], @param3=[SOPHIEUYEUCAU,19..045213], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,12/10/2019 10:56:40 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-12-10 10:56:40,424 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-12-10 10:56:40,460 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-12-10 10:56:40,461 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,28484], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,23397], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,5433], @param8=[BACSICHIDINH_ID,null], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,12/10/2019 12:00:00 AM], @param11=[THANGYEUCAU,12], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,12/10/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,68], @param16=[NOITHUCHIEN_ID,64], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,3], @param50=[HOPDONG_BENHNHAN_ID,210], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,12/10/2019 10:43:44 AM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-12-10 10:56:40,461 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-12-10 10:56:40,506 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28484' and C.DICHVU_ID = '5433' and A.BENHVIEN_ID = 'HLU01']
2019-12-10 10:56:41,182 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28484' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-12-10 10:56:44,902 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '28484']
2019-12-10 10:56:47,233 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-12-10 10:56:47,233 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,28484], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,23397], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,206468], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,5433], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,3], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,50000], @param12=[THANHTIEN_DOANHTHU,50000], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,50000], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,50000], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,12/10/2019 10:43:44 AM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,12/10/2019 10:43:44 AM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-12-10 10:56:47,233 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-12-10 10:56:47,266 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 57          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 210]
2019-12-10 10:56:47,266 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,28484], @param1=[DVYEUCAU_ID,206468], @param2=[VIENPHI_ID,675756], @param3=[SOPHIEUYEUCAU,19..045214], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,12/10/2019 10:56:47 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-12-10 10:56:47,266 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-12-10 10:56:47,300 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-12-10 10:56:47,301 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,28484], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,23397], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,5438], @param8=[BACSICHIDINH_ID,null], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,12/10/2019 12:00:00 AM], @param11=[THANGYEUCAU,12], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,12/10/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,68], @param16=[NOITHUCHIEN_ID,64], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,3], @param50=[HOPDONG_BENHNHAN_ID,210], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,12/10/2019 10:43:44 AM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-12-10 10:56:47,301 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-12-10 10:56:47,479 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28484' and C.DICHVU_ID = '5438' and A.BENHVIEN_ID = 'HLU01']
2019-12-10 10:56:48,117 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28484' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-12-10 10:56:52,647 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '28484']
2019-12-10 10:56:56,911 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-12-10 10:56:56,912 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,28484], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,23397], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,206469], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,5438], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,3], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,50000], @param12=[THANHTIEN_DOANHTHU,50000], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,50000], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,50000], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,12/10/2019 10:43:44 AM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,12/10/2019 10:43:44 AM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-12-10 10:56:56,912 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-12-10 10:56:56,943 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 58          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 210]
2019-12-10 10:56:56,943 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,28484], @param1=[DVYEUCAU_ID,206469], @param2=[VIENPHI_ID,675757], @param3=[SOPHIEUYEUCAU,19..045215], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,12/10/2019 10:56:56 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-12-10 10:56:56,943 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-12-10 10:56:56,980 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-12-10 10:56:56,981 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,28484], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,23397], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,5443], @param8=[BACSICHIDINH_ID,null], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,12/10/2019 12:00:00 AM], @param11=[THANGYEUCAU,12], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,12/10/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,68], @param16=[NOITHUCHIEN_ID,68], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,3], @param50=[HOPDONG_BENHNHAN_ID,210], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,12/10/2019 10:43:44 AM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-12-10 10:56:56,981 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-12-10 10:56:57,182 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28484' and C.DICHVU_ID = '5443' and A.BENHVIEN_ID = 'HLU01']
2019-12-10 10:56:58,168 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28484' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-12-10 10:57:00,579 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '28484']
2019-12-10 10:57:03,764 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-12-10 10:57:03,765 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,28484], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,23397], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,206470], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,5443], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,3], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,50000], @param12=[THANHTIEN_DOANHTHU,50000], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,50000], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,50000], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,12/10/2019 10:43:44 AM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,12/10/2019 10:43:44 AM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-12-10 10:57:03,765 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-12-10 10:57:03,797 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 59          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 210]
2019-12-10 10:57:03,797 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,28484], @param1=[DVYEUCAU_ID,206470], @param2=[VIENPHI_ID,675758], @param3=[SOPHIEUYEUCAU,19..045216], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,12/10/2019 10:57:03 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-12-10 10:57:03,797 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-12-10 10:57:03,828 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-12-10 10:57:03,829 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,28484], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,23397], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,5435], @param8=[BACSICHIDINH_ID,null], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,12/10/2019 12:00:00 AM], @param11=[THANGYEUCAU,12], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,12/10/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,68], @param16=[NOITHUCHIEN_ID,177], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,3], @param50=[HOPDONG_BENHNHAN_ID,210], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,12/10/2019 10:43:44 AM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-12-10 10:57:03,829 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-12-10 10:57:03,876 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28484' and C.DICHVU_ID = '5435' and A.BENHVIEN_ID = 'HLU01']
2019-12-10 10:57:04,439 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28484' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-12-10 10:57:08,089 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '28484']
2019-12-10 10:57:09,672 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-12-10 10:57:09,673 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,28484], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,23397], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,206471], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,5435], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,3], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,50000], @param12=[THANHTIEN_DOANHTHU,50000], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,50000], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,50000], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,12/10/2019 10:43:44 AM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,12/10/2019 10:43:44 AM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-12-10 10:57:09,673 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-12-10 10:57:09,707 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 60          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 210]
2019-12-10 10:57:09,707 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,28484], @param1=[DVYEUCAU_ID,206471], @param2=[VIENPHI_ID,675759], @param3=[SOPHIEUYEUCAU,19..045217], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,12/10/2019 10:57:09 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-12-10 10:57:09,707 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-12-10 10:57:09,744 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-12-10 10:57:09,745 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,28484], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,23397], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,4747], @param8=[BACSICHIDINH_ID,null], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,12/10/2019 12:00:00 AM], @param11=[THANGYEUCAU,12], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,12/10/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,68], @param16=[NOITHUCHIEN_ID,104], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,3], @param50=[HOPDONG_BENHNHAN_ID,210], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,12/10/2019 10:43:44 AM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-12-10 10:57:09,745 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-12-10 10:57:09,782 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28484' and C.DICHVU_ID = '4747' and A.BENHVIEN_ID = 'HLU01']
2019-12-10 10:57:10,037 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28484' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-12-10 10:57:12,080 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '28484']
2019-12-10 10:57:14,059 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-12-10 10:57:14,060 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,28484], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,23397], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,206472], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,4747], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,3], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,40000], @param12=[THANHTIEN_DOANHTHU,40000], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,40000], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,40000], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,12/10/2019 10:43:44 AM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,12/10/2019 10:43:44 AM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-12-10 10:57:14,060 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-12-10 10:57:14,089 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 61          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 210]
2019-12-10 10:57:14,089 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,28484], @param1=[DVYEUCAU_ID,206472], @param2=[VIENPHI_ID,675760], @param3=[SOPHIEUYEUCAU,19..045218], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,12/10/2019 10:57:14 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-12-10 10:57:14,089 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-12-10 10:57:14,128 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-12-10 10:57:14,129 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,28484], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,23397], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,4005], @param8=[BACSICHIDINH_ID,null], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,12/10/2019 12:00:00 AM], @param11=[THANGYEUCAU,12], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,12/10/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,68], @param16=[NOITHUCHIEN_ID,92], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,3], @param50=[HOPDONG_BENHNHAN_ID,210], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,12/10/2019 10:43:44 AM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-12-10 10:57:14,129 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-12-10 10:57:14,175 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28484' and C.DICHVU_ID = '4005' and A.BENHVIEN_ID = 'HLU01']
2019-12-10 10:57:14,480 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28484' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-12-10 10:57:16,086 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '28484']
2019-12-10 10:57:21,750 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-12-10 10:57:21,750 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,28484], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,23397], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,206473], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,4005], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,9], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,70000], @param12=[THANHTIEN_DOANHTHU,70000], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,70000], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,70000], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,12/10/2019 10:43:44 AM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,12/10/2019 10:43:44 AM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-12-10 10:57:21,751 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-12-10 10:57:22,001 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 62          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 210]
2019-12-10 10:57:22,001 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,28484], @param1=[DVYEUCAU_ID,206473], @param2=[VIENPHI_ID,675761], @param3=[SOPHIEUYEUCAU,19..045219], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,12/10/2019 10:57:22 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-12-10 10:57:22,001 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-12-10 10:57:22,038 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-12-10 10:57:22,039 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,28484], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,23397], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,4017], @param8=[BACSICHIDINH_ID,null], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,12/10/2019 12:00:00 AM], @param11=[THANGYEUCAU,12], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,12/10/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,68], @param16=[NOITHUCHIEN_ID,92], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,3], @param50=[HOPDONG_BENHNHAN_ID,210], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,12/10/2019 10:43:44 AM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-12-10 10:57:22,040 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-12-10 10:57:22,566 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28484' and C.DICHVU_ID = '4017' and A.BENHVIEN_ID = 'HLU01']
2019-12-10 10:57:23,811 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28484' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-12-10 10:57:29,718 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '28484']
2019-12-10 10:57:35,038 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-12-10 10:57:35,038 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,28484], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,23397], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,206474], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,4017], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,3], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,50000], @param12=[THANHTIEN_DOANHTHU,50000], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,50000], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,50000], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,12/10/2019 10:43:44 AM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,12/10/2019 10:43:44 AM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-12-10 10:57:35,038 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-12-10 10:57:35,067 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 63          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 210]
2019-12-10 10:57:35,067 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,28484], @param1=[DVYEUCAU_ID,206474], @param2=[VIENPHI_ID,675762], @param3=[SOPHIEUYEUCAU,19..045220], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,12/10/2019 10:57:35 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-12-10 10:57:35,067 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-12-10 10:57:35,438 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '210'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:57:35,515 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '211'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:57:35,553 [1] DEBUG - Statement Id: [DAOLOG01_LockBegin] PreparedStatement : [INSERT into TT_LOG_UPDATE ( REF_TABLE , REF_ID , BENHVIEN_ID )         values ( @param0 ,  @param1 ,  @param2 );]
2019-12-10 10:57:35,553 [1] DEBUG - Statement Id: [DAOLOG01_LockBegin] Parameters: [@param0=[REF_TABLE,TT_TIEPNHAN_BENHAN], @param1=[REF_ID,23398], @param2=[BENHVIEN_ID,HLU01]]
2019-12-10 10:57:35,553 [1] DEBUG - Statement Id: [DAOLOG01_LockBegin] Types: [@param0=[String, System.String], @param1=[Int64, System.Int64], @param2=[String, System.String]]
2019-12-10 10:57:35,610 [1] DEBUG - Statement Id: [DAO00013_GetPatientInfo] PreparedStatement : [select *        from TT_BENHNHAN        where MAYTE  = '190043280']
2019-12-10 10:57:35,645 [1] DEBUG - Statement Id: [DAO00095_GetListNguoiLienHe] PreparedStatement : [SELECT BNN.*, D.DICTIONARY_NAME AS TENQUANHE          FROM TT_BENHNHAN AS BN          INNER JOIN TT_BENHNHAN_NGUOILIENHE AS BNN ON BNN.BENHNHAN_ID = BN.BENHNHAN_ID          LEFT JOIN LST_DICTIONARY AS D ON D.DICTIONARY_ID = BNN.QUANHE_ID AND D.DICTIONARY_TYPE_CODE = 'QuanHeGiaDinh'          WHERE BN.MAYTE = '190043280' AND BN.ACTIVE = '1' AND BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:57:35,700 [1] DEBUG - Statement Id: [DAO00013_GetBenhNhanToDB] PreparedStatement : [select ROW_NUMBER() OVER(order by a.MAYTE) as ROWNUMBER, *,        CASE        WHEN A.GIOITINH = 1 THEN 'Nam'        WHEN A.GIOITINH = 2 THEN N'Nữ'        END as TENGIOITINH        from TT_BENHNHAN A        where  ACTIVE = '1' and MAYTE = '190043280']
2019-12-10 10:57:36,578 [1] DEBUG - Statement Id: [DAO00095_GetListTiepNhanWithBenhNhanId] PreparedStatement : [SELECT A.SOTIEPNHAN, A.TIEPNHAN_ID, B.BENHAN_ID, B.SOBENHAN, bn.MAYTE          from TT_TIEPNHAN A          left join TT_NOITRU_BENHAN B on A.TIEPNHAN_ID = B.TIEPNHAN_ID          left join (select MAYTE, BENHNHAN_ID from TT_BENHNHAN where BENHNHAN_ID = '23398') bn on bn.BENHNHAN_ID = A.BENHNHAN_ID          WHERE A.BENHVIEN_ID = 'HLU01' and A.BENHNHAN_ID = '23398'          and A.TRANGTHAI in ('DATIEPNHAN','CAPCUU','NOITRU')]
2019-12-10 10:57:36,619 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '27467' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-12-10 10:57:38,341 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '27467']
2019-12-10 10:57:40,981 [1] DEBUG - Statement Id: [DAO00027_GetListTiepNhanAllCOM30] PreparedStatement : [select distinct A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, isnull(C.SOBENHAN,NULL) as SOBENHAN,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI, A.SOBHYT, CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYTIEPNHAN,        B.*        , A.UUTIEN        from TT_TIEPNHAN A        inner join (select * from TT_BENHNHAN where MAYTE = '190043280' and ACTIVE = '1') B on B.BENHNHAN_ID = A.BENHNHAN_ID  and B.ACTIVE = '1'        left join TT_NOITRU_BENHAN C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        where A.TIEPNHAN_ID = '27467' and A.BENHVIEN_ID = 'HLU01' and (A.TRANGTHAI not in ('HUY','CAPCUU', 'NOITRU', 'NGOAITRU'))]
2019-12-10 10:57:42,174 [1] DEBUG - Statement Id: [DAO00095_GetListDVYeucauWithBenhNhanId] PreparedStatement : [SELECT A.SOTIEPNHAN, A.TIEPNHAN_ID, C.DICHVU_ID, C.DVYEUCAU_ID          from TT_TIEPNHAN A          left join (select * from TT_DVYEUCAU where BENHNHAN_ID = '23398') C on C.TIEPNHAN_ID = A.TIEPNHAN_ID          WHERE A.BENHVIEN_ID = 'HLU01' and A.BENHNHAN_ID = '23398'          and A.TRANGTHAI in ('DATIEPNHAN','CAPCUU','NOITRU')]
2019-12-10 10:57:42,220 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '27467' and C.DICHVU_ID = '4061' and A.BENHVIEN_ID = 'HLU01'         and           C.DVYEUCAU_ID = '205395']
2019-12-10 10:57:42,800 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '27467' and C.DICHVU_ID = '5435' and A.BENHVIEN_ID = 'HLU01'         and           C.DVYEUCAU_ID = '205396']
2019-12-10 10:57:43,290 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '27467' and C.DICHVU_ID = '203' and A.BENHVIEN_ID = 'HLU01'         and           C.DVYEUCAU_ID = '205397']
2019-12-10 10:57:43,993 [1] DEBUG - Statement Id: [DAO00095_GetListToaThuocNoiTruWithBenhNhanId] PreparedStatement : [SELECT B.KHAMBENH_ID as KHAMBENH_TOATHUOC_ID, 'NOITRU' as LOAITOA          from TT_TIEPNHAN A          left join TT_NOITRU_TOATHUOC B on A.TIEPNHAN_ID = B.TIEPNHAN_ID          WHERE A.BENHVIEN_ID = 'HLU01' and A.BENHNHAN_ID = '23398'          and A.TRANGTHAI in ('DATIEPNHAN','CAPCUU','NOITRU')]
2019-12-10 10:57:44,030 [1] DEBUG - Statement Id: [DAO00027_GetListDuyetToaThuocBHYTCOM24_Noi] PreparedStatement : [select distinct A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        B.*, 'NOITRU' as LOAITOA, C.PHAMVI_ID as PHAMVI_ID        from TT_NOITRU_TOATHUOC C        inner join TT_TIEPNHAN A on C.TIEPNHAN_ID = A.TIEPNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID        where (C.TRANGTHAI = 'DADUYET' or C.TRANGTHAI = 'CHUAXUAT' or C.TRANGTHAI = 'DAXUAT') and C.BENHVIEN_ID = 'HLU01' and C.KHAMBENH_ID = '' and (A.SOBHYT is not null or A.SOBHYT != '')]
2019-12-10 10:57:44,061 [1] DEBUG - Statement Id: [DAO00027_GetListDuyetToaThuocBHYTCOM24_Noi] PreparedStatement : [select distinct A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        B.*, 'NOITRU' as LOAITOA, C.PHAMVI_ID as PHAMVI_ID        from TT_NOITRU_TOATHUOC C        inner join TT_TIEPNHAN A on C.TIEPNHAN_ID = A.TIEPNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID        where (C.TRANGTHAI = 'DADUYET' or C.TRANGTHAI = 'CHUAXUAT' or C.TRANGTHAI = 'DAXUAT') and C.BENHVIEN_ID = 'HLU01' and C.KHAMBENH_ID = '' and (A.SOBHYT is not null or A.SOBHYT != '')]
2019-12-10 10:57:44,091 [1] DEBUG - Statement Id: [DAO00095_GetLisToaThuocNgoaiWithBenhNhanId] PreparedStatement : [SELECT B.KHAMBENH_TOATHUOC_ID, B.LOAITOATHUOC as LOAITOA          from TT_TIEPNHAN A          left join TT_NGOAITRU_KHAMBENH C on C.TIEPNHAN_ID = A.TIEPNHAN_ID          left join TT_NGOAITRU_KHAMBENH_TOATHUOC B on C.KHAMBENH_ID = B.KHAMBENH_ID          WHERE A.BENHVIEN_ID = 'HLU01' and A.BENHNHAN_ID = '23398'          and A.TRANGTHAI in ('DATIEPNHAN','CAPCUU','NOITRU')]
2019-12-10 10:57:44,131 [1] DEBUG - Statement Id: [DAO00027_GetListDuyetToaThuocBHYTCOM24_Ngoai_ForDelete] PreparedStatement : [select distinct A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        B.*, 'NGOAITRU' as LOAITOA, C.PHAMVI_ID as PHAMVI_ID        from TT_NGOAITRU_KHAMBENH_TOATHUOC C        inner join TT_NGOAITRU_KHAMBENH D on C.KHAMBENH_ID = D.KHAMBENH_ID        inner join TT_TIEPNHAN A on D.TIEPNHAN_ID = A.TIEPNHAN_ID              inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID        where C.KHAMBENH_TOATHUOC_ID = '']
2019-12-10 10:57:44,159 [1] DEBUG - Statement Id: [DAO00027_GetListDuyetToaThuocBHYTCOM24_Ngoai] PreparedStatement : [select distinct A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        B.*, 'NGOAITRU' as LOAITOA, C.PHAMVI_ID as PHAMVI_ID        from TT_NGOAITRU_KHAMBENH_TOATHUOC C        inner join TT_NGOAITRU_KHAMBENH D on C.KHAMBENH_ID = D.KHAMBENH_ID        inner join TT_TIEPNHAN A on D.TIEPNHAN_ID = A.TIEPNHAN_ID                inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID        where C.DUYET = '1' and C.TRANGTHAI = 'CHUAXUAT' and C.BENHVIEN_ID = 'HLU01' and C.KHAMBENH_TOATHUOC_ID = '' and (C.LOAITOATHUOC = 'BV' or C.LOAITOATHUOC = 'MP' or C.LOAITOATHUOC = 'KTBV')]
2019-12-10 10:57:44,187 [1] DEBUG - Statement Id: [DAO00307_UpdatePatientKSK] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN set        MAYTE =  @param0         , TENBENHNHAN =  @param1         , GIOITINH =  @param2         , NGAYSINH =  @param3         , NAMSINH =  @param4         , DIACHI =  @param5         , QUOCTICH_ID =  @param6         , TINHTHANH_ID =  @param7         , QUANHUYEN_ID =  @param8         , XAPHUONG_ID =  @param9         , DIACHITHUONGTRU =  @param10         , DANTOC_ID =  @param11         , SODIENTHOAI =  @param12         , NGHENGHIEP_ID =  @param13         , CMND =  @param14         , NGAYCAPNHAT =  @param15         , NGUOICAPNHAT_ID =  @param16         where        BENHNHAN_ID = '23398']
2019-12-10 10:57:44,187 [1] DEBUG - Statement Id: [DAO00307_UpdatePatientKSK] Parameters: [@param0=[MAYTE,190043280], @param1=[TENBENHNHAN,Lê Dương Bảo Lâm], @param2=[GIOITINH,1], @param3=[NGAYSINH,2/16/1990 12:00:00 AM], @param4=[NAMSINH,1990], @param5=[DIACHI,null], @param6=[QUOCTICH_ID,null], @param7=[TINHTHANH_ID,null], @param8=[QUANHUYEN_ID,null], @param9=[XAPHUONG_ID,null], @param10=[DIACHITHUONGTRU,null], @param11=[DANTOC_ID,null], @param12=[SODIENTHOAI,null], @param13=[NGHENGHIEP_ID,null], @param14=[CMND,null], @param15=[NGAYCAPNHAT,12/10/2019 12:00:00 AM], @param16=[NGUOICAPNHAT_ID,1]]
2019-12-10 10:57:44,187 [1] DEBUG - Statement Id: [DAO00307_UpdatePatientKSK] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[Int64, System.Int64], @param3=[DateTime, System.DateTime], @param4=[Int64, System.Int64], @param5=[System.DBNull, null], @param6=[System.DBNull, null], @param7=[System.DBNull, null], @param8=[System.DBNull, null], @param9=[System.DBNull, null], @param10=[System.DBNull, null], @param11=[System.DBNull, null], @param12=[System.DBNull, null], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[DateTime, System.DateTime], @param16=[Int64, System.Int64]]
2019-12-10 10:57:44,227 [1] DEBUG - Statement Id: [DAO00118_Add_BenhNhan] PreparedStatement : [if not exists (select 1 from TT_BENHNHAN where BENHNHAN_ID = '23398')              insert into TT_BENHNHAN (              BENHNHAN_ID              , MAYTE              , SOVAOVIEN              , TENBENHNHAN              , HO              , TEN              , GIOITINH              , NGAYSINH              , NAMSINH              , SONHA              , DIACHI              , SODIENTHOAI              , XAPHUONG_ID              , QUANHUYEN_ID              , TINHTHANH_ID              , DANTOC_ID              , QUOCTICH_ID              , SOLUUTRUNOITRU              , SOLUUTRUNGOAITRU              , NGHENGHIEP_ID              , CMND              , HOCHIEU              , VIETKIEU              , NGUOINUOCNGOAI              , DIACHITHUONGTRU              , DIACHILIENLAC              , DIACHICOQUAN              , EMAIL              , NHOMMAU_ID              , YEUTORH_ID              , TIENSUDIUNG              , TIENSUBENH              , TIENSUHUTTHUOCLA              , TUVONG              , NGAYTUVONG              , THOIGIANTUVONG              , NGUYENNHANTUVONG_ID              , NGUOIGHINHANTUVONG_ID              , THOIGIANGHINHANTUVONG              , NHANVIEN_ID              , DONVICONGTAC_ID              , DIENTHOAIBAN              , TINHTRANGHONNHAN_ID              , NGUOILIENHE_ID              , MOIQUANHE_ID              , NGUOILIENHE              , THONGTIN_NLH              , GHICHU              , HINHANH_DAIDIEN              , BENHVIEN_ID              , NGAYTAO              , NGUOITAO_ID              , NGAYGIOSINH              ) values (               @param0               ,  @param1               ,  @param2               ,  @param3               ,  @param4               ,  @param5               ,  @param6               ,  @param7               ,  @param8               ,  @param9               ,  @param10               ,  @param11               ,  @param12               ,  @param13               ,  @param14               ,  @param15               ,  @param16               ,  @param17               ,  @param18               ,  @param19               ,  @param20               ,  @param21               ,  @param22               ,  @param23               ,  @param24               ,  @param25               ,  @param26               ,  @param27               ,  @param28               ,  @param29               ,  @param30               ,  @param31               ,  @param32               ,  @param33               ,  @param34               ,  @param35               ,  @param36               ,  @param37               ,  @param38               ,  @param39               ,  @param40               ,  @param41               ,  @param42               ,  @param43               ,  @param44               ,  @param45               ,  @param46               ,  @param47               ,  @param48               ,  @param49               ,  @param50               ,  @param51               ,  @param52               )              else              update TT_BENHNHAN set              MAYTE =  @param1                ,                   SOVAOVIEN =  @param2                ,                   TENBENHNHAN =  @param3                ,                   HO =  @param4                ,                   TEN =  @param5                ,                   GIOITINH =  @param6                ,                   NGAYSINH =  @param7                ,                   NAMSINH =  @param8                ,                   SONHA =  @param9                ,                   SODIENTHOAI =  @param11                ,                   XAPHUONG_ID =  @param12                ,                   DANTOC_ID =  @param15                ,                   QUOCTICH_ID =  @param16                ,                   NGHENGHIEP_ID =  @param19                ,                   CMND =  @param20                ,                   HOCHIEU =  @param21                ,                   DIACHITHUONGTRU =  @param24                ,                   DIACHILIENLAC =  @param25                ,                   NGUOILIENHE_ID =  @param43                ,                   MOIQUANHE_ID =  @param44                ,                   NGUOILIENHE =  @param45                ,                   THONGTIN_NLH =  @param46                ,                   GHICHU =  @param47                ,                   BENHVIEN_ID =  @param49                ,                   NGAYCAPNHAT =  @param53                ,                   NGUOICAPNHAT_ID =  @param54                              where              BENHNHAN_ID = '23398']
2019-12-10 10:57:44,227 [1] DEBUG - Statement Id: [DAO00118_Add_BenhNhan] Parameters: [@param0=[BENHNHAN_ID,23398], @param1=[MAYTE,190043280], @param2=[SOVAOVIEN,0043280], @param3=[TENBENHNHAN,Lê Dương Bảo Lâm], @param4=[HO,Lê], @param5=[TEN,Dương Bảo Lâm], @param6=[GIOITINH,1], @param7=[NGAYSINH,2/16/1990 12:00:00 AM], @param8=[NAMSINH,1990], @param9=[SONHA,null], @param10=[DIACHI,null], @param11=[SODIENTHOAI,null], @param12=[XAPHUONG_ID,null], @param13=[QUANHUYEN_ID,null], @param14=[TINHTHANH_ID,null], @param15=[DANTOC_ID,null], @param16=[QUOCTICH_ID,null], @param17=[SOLUUTRUNOITRU,null], @param18=[SOLUUTRUNGOAITRU,null], @param19=[NGHENGHIEP_ID,null], @param20=[CMND,null], @param21=[HOCHIEU,null], @param22=[VIETKIEU,null], @param23=[NGUOINUOCNGOAI,null], @param24=[DIACHITHUONGTRU,null], @param25=[DIACHILIENLAC,null], @param26=[DIACHICOQUAN,null], @param27=[EMAIL,null], @param28=[NHOMMAU_ID,null], @param29=[YEUTORH_ID,null], @param30=[TIENSUDIUNG,null], @param31=[TIENSUBENH,null], @param32=[TIENSUHUTTHUOCLA,null], @param33=[TUVONG,null], @param34=[NGAYTUVONG,null], @param35=[THOIGIANTUVONG,null], @param36=[NGUYENNHANTUVONG_ID,null], @param37=[NGUOIGHINHANTUVONG_ID,null], @param38=[THOIGIANGHINHANTUVONG,null], @param39=[NHANVIEN_ID,null], @param40=[DONVICONGTAC_ID,null], @param41=[DIENTHOAIBAN,null], @param42=[TINHTRANGHONNHAN_ID,null], @param43=[NGUOILIENHE_ID,null], @param44=[MOIQUANHE_ID,null], @param45=[NGUOILIENHE,null], @param46=[THONGTIN_NLH,null], @param47=[GHICHU,null], @param48=[HINHANH_DAIDIEN,null], @param49=[BENHVIEN_ID,HLU01], @param50=[NGAYTAO,12/9/2019 3:16:19 PM], @param51=[NGUOITAO_ID,0], @param52=[NGAYGIOSINH,null], @param53=[NGAYCAPNHAT,12/10/2019 12:00:00 AM], @param54=[NGUOICAPNHAT_ID,1]]
2019-12-10 10:57:44,227 [1] DEBUG - Statement Id: [DAO00118_Add_BenhNhan] Types: [@param0=[Int32, System.Int32], @param1=[String, System.String], @param2=[String, System.String], @param3=[String, System.String], @param4=[String, System.String], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[DateTime, System.DateTime], @param8=[Int64, System.Int64], @param9=[System.DBNull, null], @param10=[System.DBNull, null], @param11=[System.DBNull, null], @param12=[System.DBNull, null], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[System.DBNull, null], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[System.DBNull, null], @param39=[System.DBNull, null], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[String, System.String], @param50=[DateTime, System.DateTime], @param51=[Int64, System.Int64], @param52=[System.DBNull, null], @param53=[DateTime, System.DateTime], @param54=[Int64, System.Int64]]
2019-12-10 10:57:44,278 [1] DEBUG - Statement Id: [DAOWF001_Laythongtingateways] PreparedStatement : [select * from TM_PROCESS_GATEWAYS]
2019-12-10 10:57:44,306 [1] DEBUG - Statement Id: [DAO00019_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10),        @yearNow int, @monthNow varchar(2), @dayNow varchar(2),        @Sotiepnhan varchar(20), @SoThuTu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @monthNow = RIGHT('00' + convert(varchar(2), MONTH(getdate())),2)        set @dayNow = RIGHT('00' + convert(varchar(2), DAY(getdate())),2)        BEGIN        select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOTIEPNHAN' and KEYYEAR = @yearNow and KEYMONTH = @monthNow and KEYDAY = @dayNow        and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOTIEPNHAN', @yearNow, @monthNow, @dayNow, '0', '0', '0', 0, @BenhVienId);        Update LST_KEYDATA set KEYVALUE = (KEYVALUE + 1), @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOTIEPNHAN' and KEYYEAR = @yearNow and KEYMONTH = @monthNow and KEYDAY = @dayNow and BENHVIEN_ID = @BenhVienId        set @SoThuTu = right('0000000'+convert(varchar(7), @keyValue), 7)        set @Sotiepnhan = 'TN' + RIGHT(@yearNow, 2) + @monthNow  + @dayNow + '.' + @SoThuTu                   insert into TT_TIEPNHAN (        SOTIEPNHAN        , UUTIEN        , BENHNHAN_ID        , BENHVIEN_ID        , TUYENKHAMBENH_ID        , NOITIEPNHAN_ID        , NGAYTIEPNHAN        , THOIGIANTIEPNHAN        , NAMTIEPNHAN        , THANGTIEPNHAN        , DOITUONG_ID        , LYDOTIEPNHAN_ID        , HINHTHUCDENKHAM_ID        , TINHTRANGHEN        , XACNHANCHIPHI_ID        , THUTIENTRUOC        , TAIKHAM        , SOBHYT        , BHYTTUNGAY        , BHYTDENNGAY        , BHYTNGAYCAP        , BHYTTREN3NAM        , BHYTTREN5NAM        , NGAYMIENDONGCHITRA        , LOAIBHYT        , NGAYBHYT2        , SOCHUYENVIEN        , HINHTHUCCHUYENVIEN_ID        , NOIGIOITHIEU_ID        , NGUOIGIOITHIEU_ID        , THOIGIANCHUYENTUYEN        , LYDOCHUYENVIEN_ID        , ICDNOIGIOITHIEU_ID        , CHANDOANNGT        , TRAITUYEN        , DIACHILIENHE        , XAPHUONG_ID        , QUANHUYEN_ID        , TINHTHANH_ID        , PROCESS_ID        , TRANGTHAI        , KHUVUCSONG_ID        , THANHVIEN_ID        , THE_ID        , LOAITHANHVIEN_ID        , SUDUNG_BHTN        , VIP        , GHICHU_TIEPNHAN        , BAOLANH_VIENPHI        , CONGTY_CHITRA_ID        , NGUON_BENHNHAN_ID        , LOAITIEPNHAN_ID        , THONGTIN_KCB_BHYT        , NGAYTAO        , NGUOITAO_ID        , LYDODENKHAM         ,           ISTHONGTUYEN                 )        OUTPUT INSERTED.TIEPNHAN_ID, INSERTED.SOTIEPNHAN        values (        @Sotiepnhan        ,  @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54          ,            @param55                  )        end]
2019-12-10 10:57:44,306 [1] DEBUG - Statement Id: [DAO00019_Add] Parameters: [@param0=[UUTIEN,0], @param1=[BENHNHAN_ID,23398], @param2=[BENHVIEN_ID,HLU01], @param3=[TUYENKHAMBENH_ID,null], @param4=[NOITIEPNHAN_ID,68], @param5=[NGAYTIEPNHAN,12/10/2019 12:00:00 AM], @param6=[THOIGIANTIEPNHAN,12/10/2019 12:00:00 AM], @param7=[NAMTIEPNHAN,2019], @param8=[THANGTIEPNHAN,12], @param9=[DOITUONG_ID,1], @param10=[LYDOTIEPNHAN_ID,null], @param11=[HINHTHUCDENKHAM_ID,461], @param12=[TINHTRANGHEN,null], @param13=[XACNHANCHIPHI_ID,null], @param14=[THUTIENTRUOC,null], @param15=[TAIKHAM,0], @param16=[SOBHYT,null], @param17=[BHYTTUNGAY,null], @param18=[BHYTDENNGAY,null], @param19=[BHYTNGAYCAP,null], @param20=[BHYTTREN3NAM,0], @param21=[BHYTTREN5NAM,0], @param22=[NGAYMIENDONGCHITRA,null], @param23=[LOAIBHYT,null], @param24=[NGAYBHYT2,null], @param25=[SOCHUYENVIEN,null], @param26=[HINHTHUCCHUYENVIEN_ID,null], @param27=[NOIGIOITHIEU_ID,null], @param28=[NGUOIGIOITHIEU_ID,null], @param29=[THOIGIANCHUYENTUYEN,null], @param30=[LYDOCHUYENVIEN_ID,null], @param31=[ICDNOIGIOITHIEU_ID,null], @param32=[CHANDOANNGT,null], @param33=[TRAITUYEN,0], @param34=[DIACHILIENHE,null], @param35=[XAPHUONG_ID,null], @param36=[QUANHUYEN_ID,null], @param37=[TINHTHANH_ID,null], @param38=[PROCESS_ID,P01], @param39=[TRANGTHAI,DATIEPNHAN], @param40=[KHUVUCSONG_ID,null], @param41=[THANHVIEN_ID,null], @param42=[THE_ID,null], @param43=[LOAITHANHVIEN_ID,null], @param44=[SUDUNG_BHTN,0], @param45=[VIP,0], @param46=[GHICHU_TIEPNHAN,null], @param47=[BAOLANH_VIENPHI,0], @param48=[CONGTY_CHITRA_ID,null], @param49=[NGUON_BENHNHAN_ID,null], @param50=[LOAITIEPNHAN_ID,null], @param51=[THONGTIN_KCB_BHYT,null], @param52=[NGAYTAO,12/10/2019 10:57:44 AM], @param53=[NGUOITAO_ID,0], @param54=[LYDODENKHAM,null], @param55=[ISTHONGTUYEN,0]]
2019-12-10 10:57:44,306 [1] DEBUG - Statement Id: [DAO00019_Add] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[String, System.String], @param3=[System.DBNull, null], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[DateTime, System.DateTime], @param7=[Int32, System.Int32], @param8=[Int32, System.Int32], @param9=[Int64, System.Int64], @param10=[System.DBNull, null], @param11=[Int64, System.Int64], @param12=[System.DBNull, null], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[String, System.String], @param21=[String, System.String], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[String, System.String], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[String, System.String], @param45=[String, System.String], @param46=[System.DBNull, null], @param47=[String, System.String], @param48=[System.DBNull, null], @param49=[System.DBNull, null], @param50=[System.DBNull, null], @param51=[System.DBNull, null], @param52=[DateTime, System.DateTime], @param53=[Int64, System.Int64], @param54=[System.DBNull, null], @param55=[String, System.String]]
2019-12-10 10:57:44,335 [1] DEBUG - Statement Id: [DAO00019_GetTTTiepNhan_byTiepNhanId] PreparedStatement : [select *        from TT_TIEPNHAN        where TIEPNHAN_ID = '28485'        order by TIEPNHAN_ID]
2019-12-10 10:57:44,363 [1] DEBUG - Statement Id: [DAO00080_Add_KhamBenh_CapCuu] PreparedStatement : [insert into TT_KHAMBENH_VAOVIEN (        SOPHIEU        , TIEPNHAN_ID        , KHAMBENH_ID        , BENHNHAN_ID        , NGUOILIENHE        , DIENTHOAILIENHE        , NOILAMVIEC        , CHANDOANNOIGIOITHIEU        , NGAYKHAM        , THOIGIANKHAM        , LYDOVAOVIEN        , QUATRINHBENHLY        , TIENSUBANTHAN        , TIENSUGIADINH        , KHAMXETTOANTHAN        , KHAMXETCACBOPHAN        , KHAMXETKQLS        , CHANDOANVAO        , ICDKHAMXET_ID        , DAXULY        , NGAYRA        , THOIGIANRA        , NHAPKHOA_ID        , CHUYENVIEN_ID        , CHUY        , MACH        , NHIETDO        , HUYETAPCAO        , HUYETAPTHAP        , NHIPTHO        , CANNANG        , CHIEUCAO        , BACSI_ID        , XUTRUKHAMBENH_ID        , CAPCUU        , NGAYTAINAN        , THOIGIANTAINAN        , NOITAINAN_TINHTHANH_ID        , NOITAINAN_QUANHUYEN_ID        , NOITAINAN_PHUONGXA_ID        , NOITAINAN_DIACHI        , DIADIEMTAINAN_ID        , BOPHANBITHUONG_ID        , MUCDO_ID        , DIENBIENSAUTN_ID        , XUTRISAUTN_ID        , NGUYENNHAN_ID        , NGUYENNHANCHITIET_ID        , ICD_NGUYENNHAN        , NGAYTAO        , NGUOITAO_ID        , NGAYCAPNHAT        , NGUOICAPNHAT_ID        , BENHANCHUYENKHOA        , CHANDOANVAOVIEN        , CHANDOANRAVIEN        , DIEUTRITUNGAY        , DIEUTRIDENNGAY        , DIENBIENLS        , KQXETNGHIEM        , PHAUTHUAT        , THUTHUAT        , TINHTRANGNGUOIBENH        , HUONGDIEUTRI        , NGUOIGIAO_ID        , NGUOINHAN_ID        , XQUANG        , CTSCANNER        , SIEUAM        , XETNGHIEM        , KHAC        , TOANBOHS        , LOAICHUYENKHOA        , CONGANCANTHIEP        , CDRR_BENHCHINH        , CDRR_BENHKEM        , ICD_BENHCHINH        , ICD_BENHKEMTHEO        , PHUONGPHAPDIEUTRI        , FIELD_1        , FIELD_2        , FIELD_3        , FIELD_4        , FIELD_5        , FIELD_6        , FIELD_7        , FIELD_8        , FIELD_9        , FIELD_10        , FIELD_11        , FIELD_12        , FIELD_13        , FIELD_14        , FIELD_15        , FIELD_27        , FIELD_28        , FIELD_29        , FIELD_30        , FIELD_31        , FIELD_32        , FIELD_33        , FIELD_34        , FIELD_35        , FIELD_36        , FIELD_37        , FIELD_38        , FIELD_39        , FIELD_40        , FIELD_41        , FIELD_42        , FIELD_43        , FIELD_44        , FIELD_45        , FIELD_46        , FIELD_47        , FIELD_48        , FIELD_49        , FIELD_50        , FIELD_51        , FIELD_52        , FIELD_53        , FIELD_54        , FIELD_55        , FIELD_56        , BENHVIEN_ID        ) values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77         ,  @param78         ,  @param79         ,  @param80         ,  @param81         ,  @param82         ,  @param83         ,  @param84         ,  @param85         ,  @param86         ,  @param87         ,  @param88         ,  @param89         ,  @param90         ,  @param91         ,  @param92         ,  @param93         ,  @param94         ,  @param95         ,  @param96         ,  @param97         ,  @param98         ,  @param99         ,  @param100         ,  @param101         ,  @param102         ,  @param103         ,  @param104         ,  @param105         ,  @param106         ,  @param107         ,  @param108         ,  @param109         ,  @param110         ,  @param111         ,  @param112         ,  @param113         ,  @param114         ,  @param115         ,  @param116         ,  @param117         ,  @param118         ,  @param119         ,  @param120         ,  @param121         ,  @param122         ,  @param123         ,  @param124         )]
2019-12-10 10:57:44,364 [1] DEBUG - Statement Id: [DAO00080_Add_KhamBenh_CapCuu] Parameters: [@param0=[SOPHIEU,null], @param1=[TIEPNHAN_ID,28485], @param2=[KHAMBENH_ID,null], @param3=[BENHNHAN_ID,23398], @param4=[NGUOILIENHE,null], @param5=[DIENTHOAILIENHE,null], @param6=[NOILAMVIEC,null], @param7=[CHANDOANNOIGIOITHIEU,null], @param8=[NGAYKHAM,12/10/2019 12:00:00 AM], @param9=[THOIGIANKHAM,12/10/2019 12:00:00 AM], @param10=[LYDOVAOVIEN,null], @param11=[QUATRINHBENHLY,null], @param12=[TIENSUBANTHAN,null], @param13=[TIENSUGIADINH,null], @param14=[KHAMXETTOANTHAN,null], @param15=[KHAMXETCACBOPHAN,null], @param16=[KHAMXETKQLS,null], @param17=[CHANDOANVAO,null], @param18=[ICDKHAMXET_ID,null], @param19=[DAXULY,null], @param20=[NGAYRA,null], @param21=[THOIGIANRA,null], @param22=[NHAPKHOA_ID,68], @param23=[CHUYENVIEN_ID,null], @param24=[CHUY,null], @param25=[MACH,null], @param26=[NHIETDO,null], @param27=[HUYETAPCAO,null], @param28=[HUYETAPTHAP,null], @param29=[NHIPTHO,null], @param30=[CANNANG,null], @param31=[CHIEUCAO,null], @param32=[BACSI_ID,null], @param33=[XUTRUKHAMBENH_ID,null], @param34=[CAPCUU,null], @param35=[NGAYTAINAN,null], @param36=[THOIGIANTAINAN,null], @param37=[NOITAINAN_TINHTHANH_ID,null], @param38=[NOITAINAN_QUANHUYEN_ID,null], @param39=[NOITAINAN_PHUONGXA_ID,null], @param40=[NOITAINAN_DIACHI,null], @param41=[DIADIEMTAINAN_ID,null], @param42=[BOPHANBITHUONG_ID,null], @param43=[MUCDO_ID,null], @param44=[DIENBIENSAUTN_ID,null], @param45=[XUTRISAUTN_ID,null], @param46=[NGUYENNHAN_ID,null], @param47=[NGUYENNHANCHITIET_ID,null], @param48=[ICD_NGUYENNHAN,null], @param49=[NGAYTAO,12/10/2019 10:57:44 AM], @param50=[NGUOITAO_ID,0], @param51=[NGAYCAPNHAT,12/10/2019 10:57:44 AM], @param52=[NGUOICAPNHAT_ID,0], @param53=[BENHANCHUYENKHOA,null], @param54=[CHANDOANVAOVIEN,null], @param55=[CHANDOANRAVIEN,null], @param56=[DIEUTRITUNGAY,null], @param57=[DIEUTRIDENNGAY,null], @param58=[DIENBIENLS,null], @param59=[KQXETNGHIEM,null], @param60=[PHAUTHUAT,null], @param61=[THUTHUAT,null], @param62=[TINHTRANGNGUOIBENH,null], @param63=[HUONGDIEUTRI,null], @param64=[NGUOIGIAO_ID,null], @param65=[NGUOINHAN_ID,null], @param66=[XQUANG,null], @param67=[CTSCANNER,null], @param68=[SIEUAM,null], @param69=[XETNGHIEM,null], @param70=[KHAC,null], @param71=[TOANBOHS,null], @param72=[LOAICHUYENKHOA,null], @param73=[CONGANCANTHIEP,null], @param74=[CDRR_BENHCHINH,null], @param75=[CDRR_BENHKEM,null], @param76=[ICD_BENHCHINH,null], @param77=[ICD_BENHKEMTHEO,null], @param78=[PHUONGPHAPDIEUTRI,null], @param79=[FIELD_1,null], @param80=[FIELD_2,null], @param81=[FIELD_3,null], @param82=[FIELD_4,null], @param83=[FIELD_5,null], @param84=[FIELD_6,null], @param85=[FIELD_7,null], @param86=[FIELD_8,null], @param87=[FIELD_9,null], @param88=[FIELD_10,null], @param89=[FIELD_11,null], @param90=[FIELD_12,null], @param91=[FIELD_13,null], @param92=[FIELD_14,null], @param93=[FIELD_15,null], @param94=[FIELD_27,null], @param95=[FIELD_28,null], @param96=[FIELD_29,null], @param97=[FIELD_30,null], @param98=[FIELD_31,null], @param99=[FIELD_32,null], @param100=[FIELD_33,null], @param101=[FIELD_34,null], @param102=[FIELD_35,null], @param103=[FIELD_36,null], @param104=[FIELD_37,null], @param105=[FIELD_38,null], @param106=[FIELD_39,null], @param107=[FIELD_40,null], @param108=[FIELD_41,null], @param109=[FIELD_42,null], @param110=[FIELD_43,null], @param111=[FIELD_44,null], @param112=[FIELD_45,null], @param113=[FIELD_46,null], @param114=[FIELD_47,null], @param115=[FIELD_48,null], @param116=[FIELD_49,null], @param117=[FIELD_50,null], @param118=[FIELD_51,null], @param119=[FIELD_52,null], @param120=[FIELD_53,null], @param121=[FIELD_54,null], @param122=[FIELD_55,null], @param123=[FIELD_56,null], @param124=[BENHVIEN_ID,HLU01]]
2019-12-10 10:57:44,364 [1] DEBUG - Statement Id: [DAO00080_Add_KhamBenh_CapCuu] Types: [@param0=[System.DBNull, null], @param1=[Int32, System.Int32], @param2=[System.DBNull, null], @param3=[Int32, System.Int32], @param4=[System.DBNull, null], @param5=[System.DBNull, null], @param6=[System.DBNull, null], @param7=[System.DBNull, null], @param8=[DateTime, System.DateTime], @param9=[DateTime, System.DateTime], @param10=[System.DBNull, null], @param11=[System.DBNull, null], @param12=[System.DBNull, null], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[System.DBNull, null], @param22=[String, System.String], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[System.DBNull, null], @param39=[System.DBNull, null], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[DateTime, System.DateTime], @param50=[Int64, System.Int64], @param51=[DateTime, System.DateTime], @param52=[Int64, System.Int64], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[System.DBNull, null], @param59=[System.DBNull, null], @param60=[System.DBNull, null], @param61=[System.DBNull, null], @param62=[System.DBNull, null], @param63=[System.DBNull, null], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[System.DBNull, null], @param71=[System.DBNull, null], @param72=[System.DBNull, null], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null], @param81=[System.DBNull, null], @param82=[System.DBNull, null], @param83=[System.DBNull, null], @param84=[System.DBNull, null], @param85=[System.DBNull, null], @param86=[System.DBNull, null], @param87=[System.DBNull, null], @param88=[System.DBNull, null], @param89=[System.DBNull, null], @param90=[System.DBNull, null], @param91=[System.DBNull, null], @param92=[System.DBNull, null], @param93=[System.DBNull, null], @param94=[System.DBNull, null], @param95=[System.DBNull, null], @param96=[System.DBNull, null], @param97=[System.DBNull, null], @param98=[System.DBNull, null], @param99=[System.DBNull, null], @param100=[System.DBNull, null], @param101=[System.DBNull, null], @param102=[System.DBNull, null], @param103=[System.DBNull, null], @param104=[System.DBNull, null], @param105=[System.DBNull, null], @param106=[System.DBNull, null], @param107=[System.DBNull, null], @param108=[System.DBNull, null], @param109=[System.DBNull, null], @param110=[System.DBNull, null], @param111=[System.DBNull, null], @param112=[System.DBNull, null], @param113=[System.DBNull, null], @param114=[System.DBNull, null], @param115=[System.DBNull, null], @param116=[System.DBNull, null], @param117=[System.DBNull, null], @param118=[System.DBNull, null], @param119=[System.DBNull, null], @param120=[System.DBNull, null], @param121=[System.DBNull, null], @param122=[System.DBNull, null], @param123=[System.DBNull, null], @param124=[String, System.String]]
2019-12-10 10:57:44,398 [1] DEBUG - Statement Id: [DAO00019_Add_TT_TIEPNHAN_SOTHEBHYT] PreparedStatement : [INSERT INTO TT_TIEPNHAN_SOTHEBHYT        (TIEPNHAN_ID        ,BENHNHAN_ID        ,BENHAN_ID        ,DOITUONG_ID        ,SOBHYT        ,BHYTTUNGAY        ,BHYTDENNGAY        ,BHYTNGAYCAP        ,BHYTTREN3NAM        ,BHYTTREN5NAM        ,NGAYMIENDONGCHITRA        ,TRAITUYEN        ,BENHVIEN_ID        ,NOITAO_ID        ,NGAYTAO        ,NGUOITAO_ID        ,NGAYCAPNHAT        ,NGUOICAPNHAT_ID        ,TYLE_VUOT_LCB        ,TYLE_TRAITUYEN        ,GIOIHAN_VUOT_LCB        ,LUONG_COSO        ,TYLE_THUOC_UT        ,MADOITUONG)        VALUES        ( @param0         , @param1         , @param2         , @param3         , @param4         , @param5         , @param6         , @param7         , @param8         , @param9         , @param10         , @param11         , @param12         , @param13         , @param14         , @param15         , @param16         , @param17         , @param18         , @param19         , @param20         , @param21         , @param22         , @param23 )]
2019-12-10 10:57:44,398 [1] DEBUG - Statement Id: [DAO00019_Add_TT_TIEPNHAN_SOTHEBHYT] Parameters: [@param0=[TIEPNHAN_ID,28485], @param1=[BENHNHAN_ID,23398], @param2=[BENHAN_ID,null], @param3=[DOITUONG_ID,1], @param4=[SOBHYT,null], @param5=[BHYTTUNGAY,null], @param6=[BHYTDENNGAY,null], @param7=[BHYTNGAYCAP,null], @param8=[BHYTTREN3NAM,0], @param9=[BHYTTREN5NAM,0], @param10=[NGAYMIENDONGCHITRA,null], @param11=[TRAITUYEN,0], @param12=[BENHVIEN_ID,HLU01], @param13=[NOITAO_ID,68], @param14=[NGAYTAO,12/10/2019 10:57:44 AM], @param15=[NGUOITAO_ID,0], @param16=[NGAYCAPNHAT,12/10/2019 10:57:44 AM], @param17=[NGUOICAPNHAT_ID,0], @param18=[TYLE_VUOT_LCB,null], @param19=[TYLE_TRAITUYEN,null], @param20=[GIOIHAN_VUOT_LCB,null], @param21=[LUONG_COSO,null], @param22=[TYLE_THUOC_UT,null], @param23=[MADOITUONG,null]]
2019-12-10 10:57:44,398 [1] DEBUG - Statement Id: [DAO00019_Add_TT_TIEPNHAN_SOTHEBHYT] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[System.DBNull, null], @param3=[Int64, System.Int64], @param4=[System.DBNull, null], @param5=[System.DBNull, null], @param6=[System.DBNull, null], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[String, System.String], @param10=[System.DBNull, null], @param11=[String, System.String], @param12=[String, System.String], @param13=[String, System.String], @param14=[DateTime, System.DateTime], @param15=[Int64, System.Int64], @param16=[DateTime, System.DateTime], @param17=[Int64, System.Int64], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[System.DBNull, null], @param22=[System.DBNull, null], @param23=[System.DBNull, null]]
2019-12-10 10:57:44,449 [1] DEBUG - Statement Id: [DAO00027_GetListTiepNhanAllCOM30] PreparedStatement : [select distinct A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, isnull(C.SOBENHAN,NULL) as SOBENHAN,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI, A.SOBHYT, CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYTIEPNHAN,        B.*        , A.UUTIEN        from TT_TIEPNHAN A        inner join (select * from TT_BENHNHAN where MAYTE = '190043280' and ACTIVE = '1') B on B.BENHNHAN_ID = A.BENHNHAN_ID  and B.ACTIVE = '1'        left join TT_NOITRU_BENHAN C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        where A.TIEPNHAN_ID = '28485' and A.BENHVIEN_ID = 'HLU01' and (A.TRANGTHAI not in ('HUY','CAPCUU', 'NOITRU', 'NGOAITRU'))]
2019-12-10 10:57:45,234 [1] DEBUG - Statement Id: [DAOWF001_LaythongtinProcess] PreparedStatement : [select * from TM_PROCESS        where        PROCESS_CODE = 'P01']
2019-12-10 10:57:45,262 [1] DEBUG - Statement Id: [DAOWF001_Kiemtrathongtindayeucau] PreparedStatement : [select * from TT_REQUEST        where        PROCESS_CODE = 'P01'        AND PARA = '{"HOSPITAL_ID":"HLU01","SOTIEPNHAN":"TN191210.0000004"}'        AND CURR_STATE_CODE = '6'        AND ISACTIVE = '1']
2019-12-10 10:57:45,302 [1] DEBUG - Statement Id: [DAOWF002_Add] PreparedStatement : [DECLARE @IDRequestOld int        DECLARE @IDRequestNew int        select top 1 @IDRequestOld = ID from TT_REQUEST where PARA =  @param0  order by ID desc          insert into TT_REQUEST (        PROCESS_CODE        , PARA        , CURR_STATE_CODE        ) values (         @param1         ,  @param0         ,  @param2         )        SELECT @IDRequestNew = SCOPE_IDENTITY()        if (@IDRequestOld is not null)        begin        update TT_REQUEST_SERVICE set REQUEST_ID = @IDRequestNew, PROCESS_CODE =  @param1  where REQUEST_ID = @IDRequestOld        update TT_REQUEST set ISACTIVE = '0' where ID = @IDRequestOld        update TT_REQUEST_SERVICE_DETAIL set REQUEST_ID = @IDRequestNew where REQUEST_ID = @IDRequestOld        end          select @IDRequestNew]
2019-12-10 10:57:45,302 [1] DEBUG - Statement Id: [DAOWF002_Add] Parameters: [@param0=[PARA,{"HOSPITAL_ID":"HLU01","SOTIEPNHAN":"TN191210.0000004"}], @param1=[PROCESS_CODE,P01], @param2=[CURR_STATE_CODE,6]]
2019-12-10 10:57:45,302 [1] DEBUG - Statement Id: [DAOWF002_Add] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[String, System.String]]
2019-12-10 10:57:46,057 [1] DEBUG - Statement Id: [DAO00064_GetREGListVienphiTiepNhan] PreparedStatement : [select A.*, B.THUTIENSAU        from TT_VIENPHI A        left join TT_DVYEUCAU B on A.REF_ID =  B.DVYEUCAU_ID and A.REF_TABLE = 'TT_DVYEUCAU' and B.HUYYEUCAU = '0'        where        A.TIEPNHAN_ID = '28485' and A.BENHVIEN_ID = 'HLU01' and (A.BENHAN_ID is NULL or A.BENHAN_ID = '')        and A.HUY = '0'        ORDER BY A.VIENPHI_ID]
2019-12-10 10:57:46,111 [1] DEBUG - Statement Id: [DAOLOG01_LockEnd] PreparedStatement : [DELETE TT_LOG_UPDATE        where REF_TABLE = 'TT_TIEPNHAN_BENHAN' and REF_ID = '23398' and BENHVIEN_ID = 'HLU01']
2019-12-10 10:57:46,137 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-12-10 10:57:46,137 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,28485], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,23398], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,4135], @param8=[BACSICHIDINH_ID,null], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,12/10/2019 12:00:00 AM], @param11=[THANGYEUCAU,12], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,12/10/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,68], @param16=[NOITHUCHIEN_ID,35], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,3], @param50=[HOPDONG_BENHNHAN_ID,211], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,12/10/2019 10:46:29 AM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-12-10 10:57:46,137 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-12-10 10:57:46,184 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28485' and C.DICHVU_ID = '4135' and A.BENHVIEN_ID = 'HLU01']
2019-12-10 10:57:47,185 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28485' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-12-10 10:57:48,839 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '28485']
2019-12-10 10:57:59,900 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-12-10 10:57:59,901 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,28485], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,23398], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,206475], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,4135], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,9], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,90000], @param12=[THANHTIEN_DOANHTHU,90000], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,90000], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,90000], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,12/10/2019 10:46:29 AM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,12/10/2019 10:46:29 AM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-12-10 10:57:59,901 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-12-10 10:58:00,275 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 64          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 211]
2019-12-10 10:58:00,276 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,28485], @param1=[DVYEUCAU_ID,206475], @param2=[VIENPHI_ID,675763], @param3=[SOPHIEUYEUCAU,19..045221], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,12/10/2019 10:58:00 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-12-10 10:58:00,276 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-12-10 10:58:00,342 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-12-10 10:58:00,343 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,28485], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,23398], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,4524], @param8=[BACSICHIDINH_ID,null], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,12/10/2019 12:00:00 AM], @param11=[THANGYEUCAU,12], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,12/10/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,68], @param16=[NOITHUCHIEN_ID,104], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,3], @param50=[HOPDONG_BENHNHAN_ID,211], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,12/10/2019 10:46:29 AM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-12-10 10:58:00,343 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-12-10 10:58:00,496 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28485' and C.DICHVU_ID = '4524' and A.BENHVIEN_ID = 'HLU01']
2019-12-10 10:58:01,212 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28485' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-12-10 10:58:02,521 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '28485']
2019-12-10 10:58:03,108 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-12-10 10:58:03,108 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,28485], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,23398], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,206476], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,4524], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,3], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,50000], @param12=[THANHTIEN_DOANHTHU,50000], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,50000], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,50000], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,12/10/2019 10:46:29 AM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,12/10/2019 10:46:29 AM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-12-10 10:58:03,109 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-12-10 10:58:03,153 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 65          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 211]
2019-12-10 10:58:03,153 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,28485], @param1=[DVYEUCAU_ID,206476], @param2=[VIENPHI_ID,675764], @param3=[SOPHIEUYEUCAU,19..045222], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,12/10/2019 10:58:03 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-12-10 10:58:03,153 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-12-10 10:58:03,190 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-12-10 10:58:03,191 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,28485], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,23398], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,5433], @param8=[BACSICHIDINH_ID,null], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,12/10/2019 12:00:00 AM], @param11=[THANGYEUCAU,12], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,12/10/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,68], @param16=[NOITHUCHIEN_ID,64], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,3], @param50=[HOPDONG_BENHNHAN_ID,211], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,12/10/2019 10:46:29 AM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-12-10 10:58:03,191 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-12-10 10:58:03,287 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28485' and C.DICHVU_ID = '5433' and A.BENHVIEN_ID = 'HLU01']
2019-12-10 10:58:03,689 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28485' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-12-10 10:58:05,155 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '28485']
2019-12-10 10:58:06,203 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-12-10 10:58:06,203 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,28485], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,23398], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,206477], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,5433], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,3], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,50000], @param12=[THANHTIEN_DOANHTHU,50000], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,50000], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,50000], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,12/10/2019 10:46:29 AM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,12/10/2019 10:46:29 AM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-12-10 10:58:06,203 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-12-10 10:58:06,232 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 66          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 211]
2019-12-10 10:58:06,232 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,28485], @param1=[DVYEUCAU_ID,206477], @param2=[VIENPHI_ID,675765], @param3=[SOPHIEUYEUCAU,19..045223], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,12/10/2019 10:58:06 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-12-10 10:58:06,232 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-12-10 10:58:06,268 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-12-10 10:58:06,269 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,28485], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,23398], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,5438], @param8=[BACSICHIDINH_ID,null], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,12/10/2019 12:00:00 AM], @param11=[THANGYEUCAU,12], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,12/10/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,68], @param16=[NOITHUCHIEN_ID,64], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,3], @param50=[HOPDONG_BENHNHAN_ID,211], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,12/10/2019 10:46:29 AM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-12-10 10:58:06,269 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-12-10 10:58:06,339 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28485' and C.DICHVU_ID = '5438' and A.BENHVIEN_ID = 'HLU01']
2019-12-10 10:58:06,998 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28485' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-12-10 10:58:10,147 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '28485']
2019-12-10 10:58:11,738 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-12-10 10:58:11,739 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,28485], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,23398], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,206478], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,5438], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,3], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,50000], @param12=[THANHTIEN_DOANHTHU,50000], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,50000], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,50000], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,12/10/2019 10:46:29 AM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,12/10/2019 10:46:29 AM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-12-10 10:58:11,739 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-12-10 10:58:11,767 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 67          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 211]
2019-12-10 10:58:11,767 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,28485], @param1=[DVYEUCAU_ID,206478], @param2=[VIENPHI_ID,675766], @param3=[SOPHIEUYEUCAU,19..045224], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,12/10/2019 10:58:11 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-12-10 10:58:11,767 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-12-10 10:58:11,801 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-12-10 10:58:11,802 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,28485], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,23398], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,5443], @param8=[BACSICHIDINH_ID,null], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,12/10/2019 12:00:00 AM], @param11=[THANGYEUCAU,12], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,12/10/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,68], @param16=[NOITHUCHIEN_ID,68], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,3], @param50=[HOPDONG_BENHNHAN_ID,211], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,12/10/2019 10:46:29 AM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-12-10 10:58:11,802 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-12-10 10:58:11,920 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28485' and C.DICHVU_ID = '5443' and A.BENHVIEN_ID = 'HLU01']
2019-12-10 10:58:12,457 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28485' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-12-10 10:58:14,893 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '28485']
2019-12-10 10:58:19,831 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-12-10 10:58:19,831 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,28485], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,23398], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,206479], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,5443], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,3], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,50000], @param12=[THANHTIEN_DOANHTHU,50000], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,50000], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,50000], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,12/10/2019 10:46:29 AM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,12/10/2019 10:46:29 AM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-12-10 10:58:19,831 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-12-10 10:58:19,865 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 68          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 211]
2019-12-10 10:58:19,865 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,28485], @param1=[DVYEUCAU_ID,206479], @param2=[VIENPHI_ID,675767], @param3=[SOPHIEUYEUCAU,19..045225], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,12/10/2019 10:58:19 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-12-10 10:58:19,865 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-12-10 10:58:19,901 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-12-10 10:58:19,902 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,28485], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,23398], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,5435], @param8=[BACSICHIDINH_ID,null], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,12/10/2019 12:00:00 AM], @param11=[THANGYEUCAU,12], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,12/10/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,68], @param16=[NOITHUCHIEN_ID,177], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,3], @param50=[HOPDONG_BENHNHAN_ID,211], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,12/10/2019 10:46:29 AM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-12-10 10:58:19,902 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-12-10 10:58:19,985 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28485' and C.DICHVU_ID = '5435' and A.BENHVIEN_ID = 'HLU01']
2019-12-10 10:58:20,456 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28485' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-12-10 10:58:23,457 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '28485']
2019-12-10 10:58:26,388 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-12-10 10:58:26,389 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,28485], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,23398], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,206480], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,5435], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,3], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,50000], @param12=[THANHTIEN_DOANHTHU,50000], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,50000], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,50000], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,12/10/2019 10:46:29 AM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,12/10/2019 10:46:29 AM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-12-10 10:58:26,389 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-12-10 10:58:26,419 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 69          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 211]
2019-12-10 10:58:26,419 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,28485], @param1=[DVYEUCAU_ID,206480], @param2=[VIENPHI_ID,675768], @param3=[SOPHIEUYEUCAU,19..045226], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,12/10/2019 10:58:26 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-12-10 10:58:26,419 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-12-10 10:58:26,523 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-12-10 10:58:26,524 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,28485], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,23398], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,4747], @param8=[BACSICHIDINH_ID,null], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,12/10/2019 12:00:00 AM], @param11=[THANGYEUCAU,12], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,12/10/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,68], @param16=[NOITHUCHIEN_ID,104], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,3], @param50=[HOPDONG_BENHNHAN_ID,211], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,12/10/2019 10:46:29 AM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-12-10 10:58:26,524 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-12-10 10:58:26,608 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28485' and C.DICHVU_ID = '4747' and A.BENHVIEN_ID = 'HLU01']
2019-12-10 10:58:27,430 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28485' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-12-10 10:58:40,482 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '28485']
2019-12-10 10:58:42,673 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-12-10 10:58:42,673 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,28485], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,23398], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,206481], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,4747], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,3], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,40000], @param12=[THANHTIEN_DOANHTHU,40000], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,40000], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,40000], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,12/10/2019 10:46:29 AM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,12/10/2019 10:46:29 AM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-12-10 10:58:42,674 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-12-10 10:58:42,727 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 70          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 211]
2019-12-10 10:58:42,727 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,28485], @param1=[DVYEUCAU_ID,206481], @param2=[VIENPHI_ID,675769], @param3=[SOPHIEUYEUCAU,19..045227], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,12/10/2019 10:58:42 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-12-10 10:58:42,727 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-12-10 10:58:42,762 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-12-10 10:58:42,763 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,28485], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,23398], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,4005], @param8=[BACSICHIDINH_ID,null], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,12/10/2019 12:00:00 AM], @param11=[THANGYEUCAU,12], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,12/10/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,68], @param16=[NOITHUCHIEN_ID,92], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,3], @param50=[HOPDONG_BENHNHAN_ID,211], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,12/10/2019 10:46:29 AM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-12-10 10:58:42,763 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-12-10 10:58:42,844 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28485' and C.DICHVU_ID = '4005' and A.BENHVIEN_ID = 'HLU01']
2019-12-10 10:58:44,061 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28485' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-12-10 10:58:45,867 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '28485']
2019-12-10 10:58:47,785 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-12-10 10:58:47,786 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,28485], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,23398], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,206482], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,4005], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,9], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,70000], @param12=[THANHTIEN_DOANHTHU,70000], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,70000], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,70000], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,12/10/2019 10:46:29 AM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,12/10/2019 10:46:29 AM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-12-10 10:58:47,786 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-12-10 10:58:48,209 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 71          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 211]
2019-12-10 10:58:48,209 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,28485], @param1=[DVYEUCAU_ID,206482], @param2=[VIENPHI_ID,675770], @param3=[SOPHIEUYEUCAU,19..045228], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,12/10/2019 10:58:48 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-12-10 10:58:48,209 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-12-10 10:58:48,281 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-12-10 10:58:48,283 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,28485], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,23398], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,4017], @param8=[BACSICHIDINH_ID,null], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,12/10/2019 12:00:00 AM], @param11=[THANGYEUCAU,12], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,12/10/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,68], @param16=[NOITHUCHIEN_ID,92], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,3], @param50=[HOPDONG_BENHNHAN_ID,211], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,12/10/2019 10:46:29 AM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-12-10 10:58:48,283 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-12-10 10:58:48,350 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28485' and C.DICHVU_ID = '4017' and A.BENHVIEN_ID = 'HLU01']
2019-12-10 10:58:48,731 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28485' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-12-10 10:58:50,562 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '28485']
2019-12-10 10:58:52,620 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-12-10 10:58:52,621 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,28485], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,23398], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,206483], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,4017], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,3], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,50000], @param12=[THANHTIEN_DOANHTHU,50000], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,50000], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,50000], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,12/10/2019 10:46:29 AM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,12/10/2019 10:46:29 AM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-12-10 10:58:52,621 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-12-10 10:58:52,654 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 72          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 211]
2019-12-10 10:58:52,654 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,28485], @param1=[DVYEUCAU_ID,206483], @param2=[VIENPHI_ID,675771], @param3=[SOPHIEUYEUCAU,19..045229], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,12/10/2019 10:58:52 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-12-10 10:58:52,654 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-12-10 10:58:52,843 [1] DEBUG - Statement Id: [DAO00307_GetPatientConfirms] PreparedStatement : [select distinct HD_BN.*        , CASE WHEN HD_BN.GIOITINH = '1' THEN N'Nam' ELSE N'Nữ' END AS GENDER        , CASE WHEN HD_DV.ACTIVE IS NULL THEN 0 ELSE 1 END BENHNHAN_DANGKYKSK_DICHVU        , case when HD_BN.GOI_ID is null then N'Hợp đồng:' + ' ' + HD.SO_HD else N'Gói khám:' + ' ' + G.TENGOI end as DOITUONG        , LST.DICTIONARY_NAME as HONNHAN        from TT_KSK_HOPDONG HD        inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        left join LST_DICTIONARY LST ON LST.DICTIONARY_ID = HD_BN.TINHTRANGHONNHAN_ID AND LST.DICTIONARY_TYPE_CODE = 'TinhTrangGiaDinh'        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        left join TT_TIEPNHAN TN on TN.TIEPNHAN_ID = HD_DV.TIEPNHAN_ID        left join TM_CSKH_GOI G ON G.GOI_ID = HD_BN.GOI_ID        where HD.HOPDONG_ID = '3'         AND           HD.BENHVIEN_ID = 'HLU01'                 order by HD_BN.STT]
2019-12-10 10:58:52,881 [1] DEBUG - Statement Id: [DAO00308_GetTiepNhanID] PreparedStatement : [select top 1 TN.TIEPNHAN_ID, TN.SOTIEPNHAN        from TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV        inner join TT_TIEPNHAN TN on TN.TIEPNHAN_ID = HD_DV.TIEPNHAN_ID        where HD_DV.HOPDONG_BENHNHAN_ID = 210 and HD_DV.HOPDONG_ID = 3]
2019-12-10 10:58:53,295 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '210'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:58:57,448 [1] DEBUG - Statement Id: [DAO00308_GetTiepNhanID] PreparedStatement : [select top 1 TN.TIEPNHAN_ID, TN.SOTIEPNHAN        from TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV        inner join TT_TIEPNHAN TN on TN.TIEPNHAN_ID = HD_DV.TIEPNHAN_ID        where HD_DV.HOPDONG_BENHNHAN_ID = 204 and HD_DV.HOPDONG_ID = 3]
2019-12-10 10:58:57,731 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '204'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:58:58,748 [1] DEBUG - Statement Id: [DAO00308_GetTiepNhanID] PreparedStatement : [select top 1 TN.TIEPNHAN_ID, TN.SOTIEPNHAN        from TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV        inner join TT_TIEPNHAN TN on TN.TIEPNHAN_ID = HD_DV.TIEPNHAN_ID        where HD_DV.HOPDONG_BENHNHAN_ID = 210 and HD_DV.HOPDONG_ID = 3]
2019-12-10 10:58:58,847 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '210'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:58:59,628 [1] DEBUG - Statement Id: [DAO00308_GetTiepNhanID] PreparedStatement : [select top 1 TN.TIEPNHAN_ID, TN.SOTIEPNHAN        from TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV        inner join TT_TIEPNHAN TN on TN.TIEPNHAN_ID = HD_DV.TIEPNHAN_ID        where HD_DV.HOPDONG_BENHNHAN_ID = 211 and HD_DV.HOPDONG_ID = 3]
2019-12-10 10:58:59,744 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '211'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:59:00,923 [1] DEBUG - Statement Id: [DAO00308_GetTiepNhanID] PreparedStatement : [select top 1 TN.TIEPNHAN_ID, TN.SOTIEPNHAN        from TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV        inner join TT_TIEPNHAN TN on TN.TIEPNHAN_ID = HD_DV.TIEPNHAN_ID        where HD_DV.HOPDONG_BENHNHAN_ID = 204 and HD_DV.HOPDONG_ID = 3]
2019-12-10 10:59:01,023 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '204'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:59:01,476 [1] DEBUG - Statement Id: [DAO00308_GetTiepNhanID] PreparedStatement : [select top 1 TN.TIEPNHAN_ID, TN.SOTIEPNHAN        from TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV        inner join TT_TIEPNHAN TN on TN.TIEPNHAN_ID = HD_DV.TIEPNHAN_ID        where HD_DV.HOPDONG_BENHNHAN_ID = 203 and HD_DV.HOPDONG_ID = 3]
2019-12-10 10:59:01,576 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '203'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:59:06,829 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'HSM27'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 10:59:07,697 [1] DEBUG - Statement Id: [DAO00307_GetContractWithDate] PreparedStatement : [SELECT HD.*, HD.SO_HD + ' - ' + CT.TENCONGTY AS HOPDONG, CT.TENCONGTY        FROM TT_KSK_HOPDONG HD JOIN TT_KSK_CONGTY CT ON CT.CONGTY_ID = HD.CONGTY_ID         where                 HD.BENHVIEN_ID = 'HLU01']
2019-12-10 10:59:08,461 [1] DEBUG - Statement Id: [DAO00329_GetList_BenhNhan_KSK] PreparedStatement : [select * from(select COUNT(*) OVER() as TOTALROWS,ROW_NUMBER() OVER (ORDER BY a.MAYTE) as ROWNUMBER, * from        (SELECT distinct BN.MAYTE,BN.TENBENHNHAN,BN.BENHNHAN_ID,BNDV.TIEPNHAN_ID,DV.MADICHVU        ,Case when BN.GIOITINH =1 then N'Nam' else N'Nữ' end as GIOITINH,BNDV.DVYEUCAU_ID,BNDV.PHONGBAN_ID as NOITHUCHIEN_ID        ,CONVERT(varchar(20), BN.NGAYSINH, 103) AS NGAYSINH,DV.TENDICHVU,PB.TENPHONGBAN as TENPHONGKHAM,CT.TENCONGTY,BNDV.SOPHIEUYEUCAU        ,HD.SO_HD,TN.SOTIEPNHAN,TN.NGUOITAO_ID,BNDV.DICHVU_ID        FROM TT_KSK_CONGTY CT        left join TT_KSK_HOPDONG HD ON HD.CONGTY_ID=CT.CONGTY_ID        left join TT_KSK_HOPDONG_BENHNHAN BN ON BN.HOPDONG_ID=HD.HOPDONG_ID        left join TT_KSK_HOPDONG_BENHNHAN_DICHVU BNDV ON BNDV.HOPDONG_BENHNHAN_ID=BN.HOPDONG_BENHNHAN_ID        left join TT_KSK_HOPDONG_GOIDICHVU GDV ON GDV.HOPDONG_ID= BN.HOPDONG_ID        left join TM_DICHVU DV ON DV.DICHVU_ID=BNDV.DICHVU_ID        left join TM_PHONGBAN PB ON PB.PHONGBAN_ID=BNDV.PHONGBAN_ID        join TT_TIEPNHAN TN ON TN.TIEPNHAN_ID=BNDV.TIEPNHAN_ID        where BNDV.TRANGTHAI='DAXACNHAN' AND HD.BENHVIEN_ID = 'HLU01' AND BNDV.PHONGBAN_ID='68'        AND (TN.NGAYTIEPNHAN BETWEEN CONVERT(DATE,'12/1/2019 12:00:00 AM') AND CONVERT(DATE,'12/10/2019 12:00:00 AM'))          AND             BNDV.DATHUCHIEN IS NULL                   )a )b        where b.ROWNUMBER between '1' AND '5']
2019-12-10 10:59:31,753 [1] DEBUG - Statement Id: [DAO00308_GetTiepNhanID] PreparedStatement : [select top 1 TN.TIEPNHAN_ID, TN.SOTIEPNHAN        from TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV        inner join TT_TIEPNHAN TN on TN.TIEPNHAN_ID = HD_DV.TIEPNHAN_ID        where HD_DV.HOPDONG_BENHNHAN_ID = 204 and HD_DV.HOPDONG_ID = 3]
2019-12-10 10:59:33,732 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '204'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:59:36,869 [1] DEBUG - Statement Id: [DAO00308_GetTiepNhanID] PreparedStatement : [select top 1 TN.TIEPNHAN_ID, TN.SOTIEPNHAN        from TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV        inner join TT_TIEPNHAN TN on TN.TIEPNHAN_ID = HD_DV.TIEPNHAN_ID        where HD_DV.HOPDONG_BENHNHAN_ID = 210 and HD_DV.HOPDONG_ID = 3]
2019-12-10 10:59:38,124 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '210'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 10:59:39,939 [1] DEBUG - Statement Id: [DAO00308_GetTiepNhanID] PreparedStatement : [select top 1 TN.TIEPNHAN_ID, TN.SOTIEPNHAN        from TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV        inner join TT_TIEPNHAN TN on TN.TIEPNHAN_ID = HD_DV.TIEPNHAN_ID        where HD_DV.HOPDONG_BENHNHAN_ID = 211 and HD_DV.HOPDONG_ID = 3]
2019-12-10 10:59:41,188 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '211'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 11:00:01,172 [1] DEBUG - Statement Id: [DAO00329_Search_BenhNhan_KSK] PreparedStatement : [select * from(select COUNT(*) OVER() as TOTALROWS,ROW_NUMBER() OVER (ORDER BY a.MAYTE) as ROWNUMBER, * from        (SELECT distinct BN.MAYTE,BN.TENBENHNHAN,BN.BENHNHAN_ID,BNDV.TIEPNHAN_ID,DV.MADICHVU,DV.DICHVU_ID,TN.SOTIEPNHAN        ,BNDV.DVYEUCAU_ID,BNDV.PHONGBAN_ID AS NOITHUCHIEN_ID,BNDV.SOPHIEUYEUCAU        ,Case when BN.GIOITINH =1 then N'Nam' else N'Nữ' end as GIOITINH        ,CONVERT(varchar(20), BN.NGAYSINH, 103) AS NGAYSINH,DV.TENDICHVU,PB.TENPHONGBAN as TENPHONGKHAM,CT.TENCONGTY,HD.SO_HD        FROM TT_KSK_CONGTY CT        left join TT_KSK_HOPDONG HD ON HD.CONGTY_ID=CT.CONGTY_ID        left join TT_KSK_HOPDONG_BENHNHAN BN ON BN.HOPDONG_ID=HD.HOPDONG_ID        left join TT_KSK_HOPDONG_BENHNHAN_DICHVU BNDV ON BNDV.HOPDONG_BENHNHAN_ID=BN.HOPDONG_BENHNHAN_ID        left join TT_KSK_HOPDONG_GOIDICHVU GDV ON GDV.HOPDONG_ID= BN.HOPDONG_ID        left join TM_DICHVU DV ON DV.DICHVU_ID=BNDV.DICHVU_ID        left join TM_PHONGBAN PB ON PB.PHONGBAN_ID=BNDV.PHONGBAN_ID        join TT_TIEPNHAN TN ON TN.TIEPNHAN_ID= BNDV.TIEPNHAN_ID         where           (TN.NGAYTIEPNHAN BETWEEN CONVERT(DATE,'9/1/2019 12:00:00 AM') AND CONVERT(DATE,'12/10/2019 12:00:00 AM'))          AND BNDV.PHONGBAN_ID='68' AND                              BNDV.DATHUCHIEN IS NULL                         )a )b  where b.ROWNUMBER between '1' AND '5']
2019-12-10 11:00:14,938 [1] DEBUG - Statement Id: [DAO00329_Search_BenhNhan_KSK] PreparedStatement : [select * from(select COUNT(*) OVER() as TOTALROWS,ROW_NUMBER() OVER (ORDER BY a.MAYTE) as ROWNUMBER, * from        (SELECT distinct BN.MAYTE,BN.TENBENHNHAN,BN.BENHNHAN_ID,BNDV.TIEPNHAN_ID,DV.MADICHVU,DV.DICHVU_ID,TN.SOTIEPNHAN        ,BNDV.DVYEUCAU_ID,BNDV.PHONGBAN_ID AS NOITHUCHIEN_ID,BNDV.SOPHIEUYEUCAU        ,Case when BN.GIOITINH =1 then N'Nam' else N'Nữ' end as GIOITINH        ,CONVERT(varchar(20), BN.NGAYSINH, 103) AS NGAYSINH,DV.TENDICHVU,PB.TENPHONGBAN as TENPHONGKHAM,CT.TENCONGTY,HD.SO_HD        FROM TT_KSK_CONGTY CT        left join TT_KSK_HOPDONG HD ON HD.CONGTY_ID=CT.CONGTY_ID        left join TT_KSK_HOPDONG_BENHNHAN BN ON BN.HOPDONG_ID=HD.HOPDONG_ID        left join TT_KSK_HOPDONG_BENHNHAN_DICHVU BNDV ON BNDV.HOPDONG_BENHNHAN_ID=BN.HOPDONG_BENHNHAN_ID        left join TT_KSK_HOPDONG_GOIDICHVU GDV ON GDV.HOPDONG_ID= BN.HOPDONG_ID        left join TM_DICHVU DV ON DV.DICHVU_ID=BNDV.DICHVU_ID        left join TM_PHONGBAN PB ON PB.PHONGBAN_ID=BNDV.PHONGBAN_ID        join TT_TIEPNHAN TN ON TN.TIEPNHAN_ID= BNDV.TIEPNHAN_ID         where           (TN.NGAYTIEPNHAN BETWEEN CONVERT(DATE,'9/1/2019 12:00:00 AM') AND CONVERT(DATE,'12/10/2019 12:00:00 AM'))          AND BNDV.PHONGBAN_ID='68' AND                              BNDV.DATHUCHIEN IS NOT NULL                         )a )b  where b.ROWNUMBER between '1' AND '5']
2019-12-10 11:03:33,431 [1] DEBUG - Statement Id: [DAO00329_Search_BenhNhan_KSK] PreparedStatement : [select * from(select COUNT(*) OVER() as TOTALROWS,ROW_NUMBER() OVER (ORDER BY a.MAYTE) as ROWNUMBER, * from        (SELECT distinct BN.MAYTE,BN.TENBENHNHAN,BN.BENHNHAN_ID,BNDV.TIEPNHAN_ID,DV.MADICHVU,DV.DICHVU_ID,TN.SOTIEPNHAN        ,BNDV.DVYEUCAU_ID,BNDV.PHONGBAN_ID AS NOITHUCHIEN_ID,BNDV.SOPHIEUYEUCAU        ,Case when BN.GIOITINH =1 then N'Nam' else N'Nữ' end as GIOITINH        ,CONVERT(varchar(20), BN.NGAYSINH, 103) AS NGAYSINH,DV.TENDICHVU,PB.TENPHONGBAN as TENPHONGKHAM,CT.TENCONGTY,HD.SO_HD        FROM TT_KSK_CONGTY CT        left join TT_KSK_HOPDONG HD ON HD.CONGTY_ID=CT.CONGTY_ID        left join TT_KSK_HOPDONG_BENHNHAN BN ON BN.HOPDONG_ID=HD.HOPDONG_ID        left join TT_KSK_HOPDONG_BENHNHAN_DICHVU BNDV ON BNDV.HOPDONG_BENHNHAN_ID=BN.HOPDONG_BENHNHAN_ID        left join TT_KSK_HOPDONG_GOIDICHVU GDV ON GDV.HOPDONG_ID= BN.HOPDONG_ID        left join TM_DICHVU DV ON DV.DICHVU_ID=BNDV.DICHVU_ID        left join TM_PHONGBAN PB ON PB.PHONGBAN_ID=BNDV.PHONGBAN_ID        join TT_TIEPNHAN TN ON TN.TIEPNHAN_ID= BNDV.TIEPNHAN_ID         where           (TN.NGAYTIEPNHAN BETWEEN CONVERT(DATE,'9/1/2019 12:00:00 AM') AND CONVERT(DATE,'12/10/2019 12:00:00 AM'))          AND BNDV.PHONGBAN_ID='68' AND                              BNDV.DATHUCHIEN IS NULL                         )a )b  where b.ROWNUMBER between '1' AND '5']
2019-12-10 11:03:43,879 [1] DEBUG - Statement Id: [DAO00308_GetTiepNhanID] PreparedStatement : [select top 1 TN.TIEPNHAN_ID, TN.SOTIEPNHAN        from TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV        inner join TT_TIEPNHAN TN on TN.TIEPNHAN_ID = HD_DV.TIEPNHAN_ID        where HD_DV.HOPDONG_BENHNHAN_ID = 203 and HD_DV.HOPDONG_ID = 3]
2019-12-10 11:03:43,999 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '203'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 11:03:46,687 [1] DEBUG - Statement Id: [DAO00308_DeleteDVYeuCauAndVienPhi] PreparedStatement : [delete from TT_DVYEUCAU where TIEPNHAN_ID = 28482        delete from TT_VIENPHI where TIEPNHAN_ID = 28482]
2019-12-10 11:03:46,768 [1] DEBUG - Statement Id: [DAOLOG01_LockBegin] PreparedStatement : [INSERT into TT_LOG_UPDATE ( REF_TABLE , REF_ID , BENHVIEN_ID )         values ( @param0 ,  @param1 ,  @param2 );]
2019-12-10 11:03:46,768 [1] DEBUG - Statement Id: [DAOLOG01_LockBegin] Parameters: [@param0=[REF_TABLE,TT_TIEPNHAN_BENHAN], @param1=[REF_ID,28482], @param2=[BENHVIEN_ID,HLU01]]
2019-12-10 11:03:46,768 [1] DEBUG - Statement Id: [DAOLOG01_LockBegin] Types: [@param0=[String, System.String], @param1=[Int64, System.Int64], @param2=[String, System.String]]
2019-12-10 11:03:46,794 [1] DEBUG - Statement Id: [DAO00019_CheckTiepNhanExistNextStep] PreparedStatement : [select T1.STATUS_TN        from        (        select top 1 'NHAPVIEN' AS STATUS_TN        from TT_NOITRU_NHAPVIEN        where (BENHVIEN_ID = 'HLU01' AND TIEPNHAN_ID = '28482')        ORDER BY NHAPVIEN_ID DESC        ) AS T1        UNION ALL        select T2.STATUS_TN        from        (        select top 1 'CDCLS' AS STATUS_TN        from TT_DVYEUCAU        where BENHVIEN_ID = 'HLU01' AND TIEPNHAN_ID = '28482'        ORDER BY DVYEUCAU_ID DESC        ) AS T2        UNION ALL        select T3.STATUS_TN        from        (        select top 1 'TTVP' AS STATUS_TN        from TT_VIENPHI        where BENHVIEN_ID = 'HLU01' AND TIEPNHAN_ID = '28482'        ORDER BY VIENPHI_ID DESC        ) AS T3]
2019-12-10 11:03:47,544 [1] DEBUG - Statement Id: [DAO00019_Delete] PreparedStatement : [delete from TT_TIEPNHAN        where TIEPNHAN_ID = '28482']
2019-12-10 11:03:48,124 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28482' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-12-10 11:03:48,558 [1] DEBUG - Statement Id: [DAOLOG01_LockEnd] PreparedStatement : [DELETE TT_LOG_UPDATE        where REF_TABLE = 'TT_TIEPNHAN_BENHAN' and REF_ID = '28482' and BENHVIEN_ID = 'HLU01']
2019-12-10 11:03:49,062 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 37          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 203]
2019-12-10 11:03:49,062 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,null], @param1=[DVYEUCAU_ID,null], @param2=[VIENPHI_ID,null], @param3=[SOPHIEUYEUCAU,null], @param4=[TRANGTHAI,null], @param5=[NGAYCAPNHAT,12/10/2019 11:03:49 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,null]]
2019-12-10 11:03:49,062 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[System.DBNull, null], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[System.DBNull, null], @param4=[System.DBNull, null], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[System.DBNull, null]]
2019-12-10 11:03:49,091 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 38          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 203]
2019-12-10 11:03:49,125 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,null], @param1=[DVYEUCAU_ID,null], @param2=[VIENPHI_ID,null], @param3=[SOPHIEUYEUCAU,null], @param4=[TRANGTHAI,null], @param5=[NGAYCAPNHAT,12/10/2019 11:03:49 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,null]]
2019-12-10 11:03:49,125 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[System.DBNull, null], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[System.DBNull, null], @param4=[System.DBNull, null], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[System.DBNull, null]]
2019-12-10 11:03:49,152 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 39          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 203]
2019-12-10 11:03:49,152 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,null], @param1=[DVYEUCAU_ID,null], @param2=[VIENPHI_ID,null], @param3=[SOPHIEUYEUCAU,null], @param4=[TRANGTHAI,null], @param5=[NGAYCAPNHAT,12/10/2019 11:03:49 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,null]]
2019-12-10 11:03:49,152 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[System.DBNull, null], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[System.DBNull, null], @param4=[System.DBNull, null], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[System.DBNull, null]]
2019-12-10 11:03:49,183 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 40          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 203]
2019-12-10 11:03:49,183 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,null], @param1=[DVYEUCAU_ID,null], @param2=[VIENPHI_ID,null], @param3=[SOPHIEUYEUCAU,null], @param4=[TRANGTHAI,null], @param5=[NGAYCAPNHAT,12/10/2019 11:03:49 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,null]]
2019-12-10 11:03:49,183 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[System.DBNull, null], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[System.DBNull, null], @param4=[System.DBNull, null], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[System.DBNull, null]]
2019-12-10 11:03:49,209 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 41          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 203]
2019-12-10 11:03:49,209 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,null], @param1=[DVYEUCAU_ID,null], @param2=[VIENPHI_ID,null], @param3=[SOPHIEUYEUCAU,null], @param4=[TRANGTHAI,null], @param5=[NGAYCAPNHAT,12/10/2019 11:03:49 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,null]]
2019-12-10 11:03:49,209 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[System.DBNull, null], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[System.DBNull, null], @param4=[System.DBNull, null], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[System.DBNull, null]]
2019-12-10 11:03:49,237 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 42          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 203]
2019-12-10 11:03:49,237 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,null], @param1=[DVYEUCAU_ID,null], @param2=[VIENPHI_ID,null], @param3=[SOPHIEUYEUCAU,null], @param4=[TRANGTHAI,null], @param5=[NGAYCAPNHAT,12/10/2019 11:03:49 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,null]]
2019-12-10 11:03:49,237 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[System.DBNull, null], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[System.DBNull, null], @param4=[System.DBNull, null], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[System.DBNull, null]]
2019-12-10 11:03:49,264 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 43          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 203]
2019-12-10 11:03:49,264 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,null], @param1=[DVYEUCAU_ID,null], @param2=[VIENPHI_ID,null], @param3=[SOPHIEUYEUCAU,null], @param4=[TRANGTHAI,null], @param5=[NGAYCAPNHAT,12/10/2019 11:03:49 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,null]]
2019-12-10 11:03:49,264 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[System.DBNull, null], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[System.DBNull, null], @param4=[System.DBNull, null], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[System.DBNull, null]]
2019-12-10 11:03:49,292 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 44          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 203]
2019-12-10 11:03:49,292 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,null], @param1=[DVYEUCAU_ID,null], @param2=[VIENPHI_ID,null], @param3=[SOPHIEUYEUCAU,null], @param4=[TRANGTHAI,null], @param5=[NGAYCAPNHAT,12/10/2019 11:03:49 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,null]]
2019-12-10 11:03:49,292 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[System.DBNull, null], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[System.DBNull, null], @param4=[System.DBNull, null], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[System.DBNull, null]]
2019-12-10 11:03:49,320 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 45          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 203]
2019-12-10 11:03:49,320 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,null], @param1=[DVYEUCAU_ID,null], @param2=[VIENPHI_ID,null], @param3=[SOPHIEUYEUCAU,null], @param4=[TRANGTHAI,null], @param5=[NGAYCAPNHAT,12/10/2019 11:03:49 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,null]]
2019-12-10 11:03:49,320 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[System.DBNull, null], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[System.DBNull, null], @param4=[System.DBNull, null], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[System.DBNull, null]]
2019-12-10 11:03:49,508 [1] DEBUG - Statement Id: [DAO00307_GetPatientConfirms] PreparedStatement : [select distinct HD_BN.*        , CASE WHEN HD_BN.GIOITINH = '1' THEN N'Nam' ELSE N'Nữ' END AS GENDER        , CASE WHEN HD_DV.ACTIVE IS NULL THEN 0 ELSE 1 END BENHNHAN_DANGKYKSK_DICHVU        , case when HD_BN.GOI_ID is null then N'Hợp đồng:' + ' ' + HD.SO_HD else N'Gói khám:' + ' ' + G.TENGOI end as DOITUONG        , LST.DICTIONARY_NAME as HONNHAN        from TT_KSK_HOPDONG HD        inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        left join LST_DICTIONARY LST ON LST.DICTIONARY_ID = HD_BN.TINHTRANGHONNHAN_ID AND LST.DICTIONARY_TYPE_CODE = 'TinhTrangGiaDinh'        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        left join TT_TIEPNHAN TN on TN.TIEPNHAN_ID = HD_DV.TIEPNHAN_ID        left join TM_CSKH_GOI G ON G.GOI_ID = HD_BN.GOI_ID        where HD.HOPDONG_ID = '3'         AND           HD.BENHVIEN_ID = 'HLU01'                 order by HD_BN.STT]
2019-12-10 11:03:49,787 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '203'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 11:03:53,874 [1] DEBUG - Statement Id: [DAO00329_Search_BenhNhan_KSK] PreparedStatement : [select * from(select COUNT(*) OVER() as TOTALROWS,ROW_NUMBER() OVER (ORDER BY a.MAYTE) as ROWNUMBER, * from        (SELECT distinct BN.MAYTE,BN.TENBENHNHAN,BN.BENHNHAN_ID,BNDV.TIEPNHAN_ID,DV.MADICHVU,DV.DICHVU_ID,TN.SOTIEPNHAN        ,BNDV.DVYEUCAU_ID,BNDV.PHONGBAN_ID AS NOITHUCHIEN_ID,BNDV.SOPHIEUYEUCAU        ,Case when BN.GIOITINH =1 then N'Nam' else N'Nữ' end as GIOITINH        ,CONVERT(varchar(20), BN.NGAYSINH, 103) AS NGAYSINH,DV.TENDICHVU,PB.TENPHONGBAN as TENPHONGKHAM,CT.TENCONGTY,HD.SO_HD        FROM TT_KSK_CONGTY CT        left join TT_KSK_HOPDONG HD ON HD.CONGTY_ID=CT.CONGTY_ID        left join TT_KSK_HOPDONG_BENHNHAN BN ON BN.HOPDONG_ID=HD.HOPDONG_ID        left join TT_KSK_HOPDONG_BENHNHAN_DICHVU BNDV ON BNDV.HOPDONG_BENHNHAN_ID=BN.HOPDONG_BENHNHAN_ID        left join TT_KSK_HOPDONG_GOIDICHVU GDV ON GDV.HOPDONG_ID= BN.HOPDONG_ID        left join TM_DICHVU DV ON DV.DICHVU_ID=BNDV.DICHVU_ID        left join TM_PHONGBAN PB ON PB.PHONGBAN_ID=BNDV.PHONGBAN_ID        join TT_TIEPNHAN TN ON TN.TIEPNHAN_ID= BNDV.TIEPNHAN_ID         where           (TN.NGAYTIEPNHAN BETWEEN CONVERT(DATE,'9/1/2019 12:00:00 AM') AND CONVERT(DATE,'12/10/2019 12:00:00 AM'))          AND BNDV.PHONGBAN_ID='68' AND                              BNDV.DATHUCHIEN IS NOT NULL                         )a )b  where b.ROWNUMBER between '1' AND '5']
2019-12-10 11:03:59,912 [1] DEBUG - Statement Id: [DAO00329_Search_BenhNhan_KSK] PreparedStatement : [select * from(select COUNT(*) OVER() as TOTALROWS,ROW_NUMBER() OVER (ORDER BY a.MAYTE) as ROWNUMBER, * from        (SELECT distinct BN.MAYTE,BN.TENBENHNHAN,BN.BENHNHAN_ID,BNDV.TIEPNHAN_ID,DV.MADICHVU,DV.DICHVU_ID,TN.SOTIEPNHAN        ,BNDV.DVYEUCAU_ID,BNDV.PHONGBAN_ID AS NOITHUCHIEN_ID,BNDV.SOPHIEUYEUCAU        ,Case when BN.GIOITINH =1 then N'Nam' else N'Nữ' end as GIOITINH        ,CONVERT(varchar(20), BN.NGAYSINH, 103) AS NGAYSINH,DV.TENDICHVU,PB.TENPHONGBAN as TENPHONGKHAM,CT.TENCONGTY,HD.SO_HD        FROM TT_KSK_CONGTY CT        left join TT_KSK_HOPDONG HD ON HD.CONGTY_ID=CT.CONGTY_ID        left join TT_KSK_HOPDONG_BENHNHAN BN ON BN.HOPDONG_ID=HD.HOPDONG_ID        left join TT_KSK_HOPDONG_BENHNHAN_DICHVU BNDV ON BNDV.HOPDONG_BENHNHAN_ID=BN.HOPDONG_BENHNHAN_ID        left join TT_KSK_HOPDONG_GOIDICHVU GDV ON GDV.HOPDONG_ID= BN.HOPDONG_ID        left join TM_DICHVU DV ON DV.DICHVU_ID=BNDV.DICHVU_ID        left join TM_PHONGBAN PB ON PB.PHONGBAN_ID=BNDV.PHONGBAN_ID        join TT_TIEPNHAN TN ON TN.TIEPNHAN_ID= BNDV.TIEPNHAN_ID         where           (TN.NGAYTIEPNHAN BETWEEN CONVERT(DATE,'9/1/2019 12:00:00 AM') AND CONVERT(DATE,'12/10/2019 12:00:00 AM'))          AND BNDV.PHONGBAN_ID='68' AND                              BNDV.DATHUCHIEN IS NULL                         )a )b  where b.ROWNUMBER between '1' AND '5']
2019-12-10 11:04:05,872 [1] DEBUG - Statement Id: [DAO00307_CheckSingin] PreparedStatement : [select *        from TT_KSK_HOPDONG_BENHNHAN_DICHVU         where                 HOPDONG_ID = 3             and               HOPDONG_BENHNHAN_ID = 203             and               BENHVIEN_ID = 'HLU01']
2019-12-10 11:04:11,272 [1] DEBUG - Statement Id: [DAO00307_CheckSingin] PreparedStatement : [select *        from TT_KSK_HOPDONG_BENHNHAN_DICHVU         where                 HOPDONG_ID = 3             and               HOPDONG_BENHNHAN_ID = 203             and               BENHVIEN_ID = 'HLU01']
2019-12-10 11:04:11,307 [1] DEBUG - Statement Id: [DAOLOG01_LockBegin] PreparedStatement : [INSERT into TT_LOG_UPDATE ( REF_TABLE , REF_ID , BENHVIEN_ID )         values ( @param0 ,  @param1 ,  @param2 );]
2019-12-10 11:04:11,307 [1] DEBUG - Statement Id: [DAOLOG01_LockBegin] Parameters: [@param0=[REF_TABLE,TT_TIEPNHAN_BENHAN], @param1=[REF_ID,23420], @param2=[BENHVIEN_ID,HLU01]]
2019-12-10 11:04:11,307 [1] DEBUG - Statement Id: [DAOLOG01_LockBegin] Types: [@param0=[String, System.String], @param1=[Int64, System.Int64], @param2=[String, System.String]]
2019-12-10 11:04:11,361 [1] DEBUG - Statement Id: [DAO00013_GetPatientInfo] PreparedStatement : [select *        from TT_BENHNHAN        where MAYTE  = '190043301']
2019-12-10 11:04:11,387 [1] DEBUG - Statement Id: [DAO00095_GetListNguoiLienHe] PreparedStatement : [SELECT BNN.*, D.DICTIONARY_NAME AS TENQUANHE          FROM TT_BENHNHAN AS BN          INNER JOIN TT_BENHNHAN_NGUOILIENHE AS BNN ON BNN.BENHNHAN_ID = BN.BENHNHAN_ID          LEFT JOIN LST_DICTIONARY AS D ON D.DICTIONARY_ID = BNN.QUANHE_ID AND D.DICTIONARY_TYPE_CODE = 'QuanHeGiaDinh'          WHERE BN.MAYTE = '190043301' AND BN.ACTIVE = '1' AND BN.BENHVIEN_ID = 'HLU01']
2019-12-10 11:04:11,416 [1] DEBUG - Statement Id: [DAO00307_UpdatePatientKSK] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN set        MAYTE =  @param0         , TENBENHNHAN =  @param1         , GIOITINH =  @param2         , NGAYSINH =  @param3         , NAMSINH =  @param4         , DIACHI =  @param5         , QUOCTICH_ID =  @param6         , TINHTHANH_ID =  @param7         , QUANHUYEN_ID =  @param8         , XAPHUONG_ID =  @param9         , DIACHITHUONGTRU =  @param10         , DANTOC_ID =  @param11         , SODIENTHOAI =  @param12         , NGHENGHIEP_ID =  @param13         , CMND =  @param14         , NGAYCAPNHAT =  @param15         , NGUOICAPNHAT_ID =  @param16         where        BENHNHAN_ID = '23420']
2019-12-10 11:04:11,416 [1] DEBUG - Statement Id: [DAO00307_UpdatePatientKSK] Parameters: [@param0=[MAYTE,190043301], @param1=[TENBENHNHAN,Test Fpt01], @param2=[GIOITINH,1], @param3=[NGAYSINH,3/1/1995 12:00:00 AM], @param4=[NAMSINH,1995], @param5=[DIACHI,null], @param6=[QUOCTICH_ID,null], @param7=[TINHTHANH_ID,null], @param8=[QUANHUYEN_ID,null], @param9=[XAPHUONG_ID,null], @param10=[DIACHITHUONGTRU,null], @param11=[DANTOC_ID,null], @param12=[SODIENTHOAI,null], @param13=[NGHENGHIEP_ID,null], @param14=[CMND,null], @param15=[NGAYCAPNHAT,12/10/2019 12:00:00 AM], @param16=[NGUOICAPNHAT_ID,1]]
2019-12-10 11:04:11,416 [1] DEBUG - Statement Id: [DAO00307_UpdatePatientKSK] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[Int64, System.Int64], @param3=[DateTime, System.DateTime], @param4=[Int64, System.Int64], @param5=[System.DBNull, null], @param6=[System.DBNull, null], @param7=[System.DBNull, null], @param8=[System.DBNull, null], @param9=[System.DBNull, null], @param10=[System.DBNull, null], @param11=[System.DBNull, null], @param12=[System.DBNull, null], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[DateTime, System.DateTime], @param16=[Int64, System.Int64]]
2019-12-10 11:04:11,444 [1] DEBUG - Statement Id: [DAO00118_Add_BenhNhan] PreparedStatement : [if not exists (select 1 from TT_BENHNHAN where BENHNHAN_ID = '23420')              insert into TT_BENHNHAN (              BENHNHAN_ID              , MAYTE              , SOVAOVIEN              , TENBENHNHAN              , HO              , TEN              , GIOITINH              , NGAYSINH              , NAMSINH              , SONHA              , DIACHI              , SODIENTHOAI              , XAPHUONG_ID              , QUANHUYEN_ID              , TINHTHANH_ID              , DANTOC_ID              , QUOCTICH_ID              , SOLUUTRUNOITRU              , SOLUUTRUNGOAITRU              , NGHENGHIEP_ID              , CMND              , HOCHIEU              , VIETKIEU              , NGUOINUOCNGOAI              , DIACHITHUONGTRU              , DIACHILIENLAC              , DIACHICOQUAN              , EMAIL              , NHOMMAU_ID              , YEUTORH_ID              , TIENSUDIUNG              , TIENSUBENH              , TIENSUHUTTHUOCLA              , TUVONG              , NGAYTUVONG              , THOIGIANTUVONG              , NGUYENNHANTUVONG_ID              , NGUOIGHINHANTUVONG_ID              , THOIGIANGHINHANTUVONG              , NHANVIEN_ID              , DONVICONGTAC_ID              , DIENTHOAIBAN              , TINHTRANGHONNHAN_ID              , NGUOILIENHE_ID              , MOIQUANHE_ID              , NGUOILIENHE              , THONGTIN_NLH              , GHICHU              , HINHANH_DAIDIEN              , BENHVIEN_ID              , NGAYTAO              , NGUOITAO_ID              , NGAYGIOSINH              ) values (               @param0               ,  @param1               ,  @param2               ,  @param3               ,  @param4               ,  @param5               ,  @param6               ,  @param7               ,  @param8               ,  @param9               ,  @param10               ,  @param11               ,  @param12               ,  @param13               ,  @param14               ,  @param15               ,  @param16               ,  @param17               ,  @param18               ,  @param19               ,  @param20               ,  @param21               ,  @param22               ,  @param23               ,  @param24               ,  @param25               ,  @param26               ,  @param27               ,  @param28               ,  @param29               ,  @param30               ,  @param31               ,  @param32               ,  @param33               ,  @param34               ,  @param35               ,  @param36               ,  @param37               ,  @param38               ,  @param39               ,  @param40               ,  @param41               ,  @param42               ,  @param43               ,  @param44               ,  @param45               ,  @param46               ,  @param47               ,  @param48               ,  @param49               ,  @param50               ,  @param51               ,  @param52               )              else              update TT_BENHNHAN set              MAYTE =  @param1                ,                   SOVAOVIEN =  @param2                ,                   TENBENHNHAN =  @param3                ,                   HO =  @param4                ,                   TEN =  @param5                ,                   GIOITINH =  @param6                ,                   NGAYSINH =  @param7                ,                   NAMSINH =  @param8                ,                   SONHA =  @param9                ,                   SODIENTHOAI =  @param11                ,                   XAPHUONG_ID =  @param12                ,                   DANTOC_ID =  @param15                ,                   QUOCTICH_ID =  @param16                ,                   NGHENGHIEP_ID =  @param19                ,                   CMND =  @param20                ,                   HOCHIEU =  @param21                ,                   DIACHITHUONGTRU =  @param24                ,                   DIACHILIENLAC =  @param25                ,                   NGUOILIENHE_ID =  @param43                ,                   MOIQUANHE_ID =  @param44                ,                   NGUOILIENHE =  @param45                ,                   THONGTIN_NLH =  @param46                ,                   GHICHU =  @param47                ,                   BENHVIEN_ID =  @param49                ,                   NGAYCAPNHAT =  @param53                ,                   NGUOICAPNHAT_ID =  @param54                              where              BENHNHAN_ID = '23420']
2019-12-10 11:04:11,444 [1] DEBUG - Statement Id: [DAO00118_Add_BenhNhan] Parameters: [@param0=[BENHNHAN_ID,23420], @param1=[MAYTE,190043301], @param2=[SOVAOVIEN,0043301], @param3=[TENBENHNHAN,Test Fpt01], @param4=[HO,Test], @param5=[TEN,Fpt01], @param6=[GIOITINH,1], @param7=[NGAYSINH,3/1/1995 12:00:00 AM], @param8=[NAMSINH,1995], @param9=[SONHA,null], @param10=[DIACHI,null], @param11=[SODIENTHOAI,null], @param12=[XAPHUONG_ID,null], @param13=[QUANHUYEN_ID,null], @param14=[TINHTHANH_ID,null], @param15=[DANTOC_ID,null], @param16=[QUOCTICH_ID,null], @param17=[SOLUUTRUNOITRU,null], @param18=[SOLUUTRUNGOAITRU,null], @param19=[NGHENGHIEP_ID,null], @param20=[CMND,null], @param21=[HOCHIEU,null], @param22=[VIETKIEU,null], @param23=[NGUOINUOCNGOAI,null], @param24=[DIACHITHUONGTRU,null], @param25=[DIACHILIENLAC,null], @param26=[DIACHICOQUAN,null], @param27=[EMAIL,null], @param28=[NHOMMAU_ID,null], @param29=[YEUTORH_ID,null], @param30=[TIENSUDIUNG,null], @param31=[TIENSUBENH,null], @param32=[TIENSUHUTTHUOCLA,null], @param33=[TUVONG,null], @param34=[NGAYTUVONG,null], @param35=[THOIGIANTUVONG,null], @param36=[NGUYENNHANTUVONG_ID,null], @param37=[NGUOIGHINHANTUVONG_ID,null], @param38=[THOIGIANGHINHANTUVONG,null], @param39=[NHANVIEN_ID,null], @param40=[DONVICONGTAC_ID,null], @param41=[DIENTHOAIBAN,null], @param42=[TINHTRANGHONNHAN_ID,null], @param43=[NGUOILIENHE_ID,null], @param44=[MOIQUANHE_ID,null], @param45=[NGUOILIENHE,null], @param46=[THONGTIN_NLH,null], @param47=[GHICHU,null], @param48=[HINHANH_DAIDIEN,null], @param49=[BENHVIEN_ID,HLU01], @param50=[NGAYTAO,8/26/2019 1:42:46 PM], @param51=[NGUOITAO_ID,1], @param52=[NGAYGIOSINH,null], @param53=[NGAYCAPNHAT,12/10/2019 12:00:00 AM], @param54=[NGUOICAPNHAT_ID,1]]
2019-12-10 11:04:11,444 [1] DEBUG - Statement Id: [DAO00118_Add_BenhNhan] Types: [@param0=[Int32, System.Int32], @param1=[String, System.String], @param2=[String, System.String], @param3=[String, System.String], @param4=[String, System.String], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[DateTime, System.DateTime], @param8=[Int64, System.Int64], @param9=[System.DBNull, null], @param10=[System.DBNull, null], @param11=[System.DBNull, null], @param12=[System.DBNull, null], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[System.DBNull, null], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[System.DBNull, null], @param39=[System.DBNull, null], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[String, System.String], @param50=[DateTime, System.DateTime], @param51=[Int64, System.Int64], @param52=[System.DBNull, null], @param53=[DateTime, System.DateTime], @param54=[Int64, System.Int64]]
2019-12-10 11:04:11,474 [1] DEBUG - Statement Id: [DAOWF001_Laythongtingateways] PreparedStatement : [select * from TM_PROCESS_GATEWAYS]
2019-12-10 11:04:11,651 [1] DEBUG - Statement Id: [DAO00019_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10),        @yearNow int, @monthNow varchar(2), @dayNow varchar(2),        @Sotiepnhan varchar(20), @SoThuTu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @monthNow = RIGHT('00' + convert(varchar(2), MONTH(getdate())),2)        set @dayNow = RIGHT('00' + convert(varchar(2), DAY(getdate())),2)        BEGIN        select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOTIEPNHAN' and KEYYEAR = @yearNow and KEYMONTH = @monthNow and KEYDAY = @dayNow        and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOTIEPNHAN', @yearNow, @monthNow, @dayNow, '0', '0', '0', 0, @BenhVienId);        Update LST_KEYDATA set KEYVALUE = (KEYVALUE + 1), @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOTIEPNHAN' and KEYYEAR = @yearNow and KEYMONTH = @monthNow and KEYDAY = @dayNow and BENHVIEN_ID = @BenhVienId        set @SoThuTu = right('0000000'+convert(varchar(7), @keyValue), 7)        set @Sotiepnhan = 'TN' + RIGHT(@yearNow, 2) + @monthNow  + @dayNow + '.' + @SoThuTu                   insert into TT_TIEPNHAN (        SOTIEPNHAN        , UUTIEN        , BENHNHAN_ID        , BENHVIEN_ID        , TUYENKHAMBENH_ID        , NOITIEPNHAN_ID        , NGAYTIEPNHAN        , THOIGIANTIEPNHAN        , NAMTIEPNHAN        , THANGTIEPNHAN        , DOITUONG_ID        , LYDOTIEPNHAN_ID        , HINHTHUCDENKHAM_ID        , TINHTRANGHEN        , XACNHANCHIPHI_ID        , THUTIENTRUOC        , TAIKHAM        , SOBHYT        , BHYTTUNGAY        , BHYTDENNGAY        , BHYTNGAYCAP        , BHYTTREN3NAM        , BHYTTREN5NAM        , NGAYMIENDONGCHITRA        , LOAIBHYT        , NGAYBHYT2        , SOCHUYENVIEN        , HINHTHUCCHUYENVIEN_ID        , NOIGIOITHIEU_ID        , NGUOIGIOITHIEU_ID        , THOIGIANCHUYENTUYEN        , LYDOCHUYENVIEN_ID        , ICDNOIGIOITHIEU_ID        , CHANDOANNGT        , TRAITUYEN        , DIACHILIENHE        , XAPHUONG_ID        , QUANHUYEN_ID        , TINHTHANH_ID        , PROCESS_ID        , TRANGTHAI        , KHUVUCSONG_ID        , THANHVIEN_ID        , THE_ID        , LOAITHANHVIEN_ID        , SUDUNG_BHTN        , VIP        , GHICHU_TIEPNHAN        , BAOLANH_VIENPHI        , CONGTY_CHITRA_ID        , NGUON_BENHNHAN_ID        , LOAITIEPNHAN_ID        , THONGTIN_KCB_BHYT        , NGAYTAO        , NGUOITAO_ID        , LYDODENKHAM         ,           ISTHONGTUYEN                 )        OUTPUT INSERTED.TIEPNHAN_ID, INSERTED.SOTIEPNHAN        values (        @Sotiepnhan        ,  @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54          ,            @param55                  )        end]
2019-12-10 11:04:11,651 [1] DEBUG - Statement Id: [DAO00019_Add] Parameters: [@param0=[UUTIEN,0], @param1=[BENHNHAN_ID,23420], @param2=[BENHVIEN_ID,HLU01], @param3=[TUYENKHAMBENH_ID,null], @param4=[NOITIEPNHAN_ID,68], @param5=[NGAYTIEPNHAN,12/10/2019 12:00:00 AM], @param6=[THOIGIANTIEPNHAN,12/10/2019 12:00:00 AM], @param7=[NAMTIEPNHAN,2019], @param8=[THANGTIEPNHAN,12], @param9=[DOITUONG_ID,1], @param10=[LYDOTIEPNHAN_ID,null], @param11=[HINHTHUCDENKHAM_ID,461], @param12=[TINHTRANGHEN,null], @param13=[XACNHANCHIPHI_ID,null], @param14=[THUTIENTRUOC,null], @param15=[TAIKHAM,0], @param16=[SOBHYT,null], @param17=[BHYTTUNGAY,null], @param18=[BHYTDENNGAY,null], @param19=[BHYTNGAYCAP,null], @param20=[BHYTTREN3NAM,0], @param21=[BHYTTREN5NAM,0], @param22=[NGAYMIENDONGCHITRA,null], @param23=[LOAIBHYT,null], @param24=[NGAYBHYT2,null], @param25=[SOCHUYENVIEN,null], @param26=[HINHTHUCCHUYENVIEN_ID,null], @param27=[NOIGIOITHIEU_ID,null], @param28=[NGUOIGIOITHIEU_ID,null], @param29=[THOIGIANCHUYENTUYEN,null], @param30=[LYDOCHUYENVIEN_ID,null], @param31=[ICDNOIGIOITHIEU_ID,null], @param32=[CHANDOANNGT,null], @param33=[TRAITUYEN,0], @param34=[DIACHILIENHE,null], @param35=[XAPHUONG_ID,null], @param36=[QUANHUYEN_ID,null], @param37=[TINHTHANH_ID,null], @param38=[PROCESS_ID,P01], @param39=[TRANGTHAI,DATIEPNHAN], @param40=[KHUVUCSONG_ID,null], @param41=[THANHVIEN_ID,null], @param42=[THE_ID,null], @param43=[LOAITHANHVIEN_ID,null], @param44=[SUDUNG_BHTN,0], @param45=[VIP,0], @param46=[GHICHU_TIEPNHAN,null], @param47=[BAOLANH_VIENPHI,0], @param48=[CONGTY_CHITRA_ID,null], @param49=[NGUON_BENHNHAN_ID,null], @param50=[LOAITIEPNHAN_ID,null], @param51=[THONGTIN_KCB_BHYT,null], @param52=[NGAYTAO,12/10/2019 11:04:11 AM], @param53=[NGUOITAO_ID,1], @param54=[LYDODENKHAM,null], @param55=[ISTHONGTUYEN,0]]
2019-12-10 11:04:11,651 [1] DEBUG - Statement Id: [DAO00019_Add] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[String, System.String], @param3=[System.DBNull, null], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[DateTime, System.DateTime], @param7=[Int32, System.Int32], @param8=[Int32, System.Int32], @param9=[Int64, System.Int64], @param10=[System.DBNull, null], @param11=[Int64, System.Int64], @param12=[System.DBNull, null], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[String, System.String], @param21=[String, System.String], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[String, System.String], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[String, System.String], @param45=[String, System.String], @param46=[System.DBNull, null], @param47=[String, System.String], @param48=[System.DBNull, null], @param49=[System.DBNull, null], @param50=[System.DBNull, null], @param51=[System.DBNull, null], @param52=[DateTime, System.DateTime], @param53=[Int64, System.Int64], @param54=[System.DBNull, null], @param55=[String, System.String]]
2019-12-10 11:04:11,680 [1] DEBUG - Statement Id: [DAO00019_GetTTTiepNhan_byTiepNhanId] PreparedStatement : [select *        from TT_TIEPNHAN        where TIEPNHAN_ID = '28486'        order by TIEPNHAN_ID]
2019-12-10 11:04:11,707 [1] DEBUG - Statement Id: [DAO00080_Add_KhamBenh_CapCuu] PreparedStatement : [insert into TT_KHAMBENH_VAOVIEN (        SOPHIEU        , TIEPNHAN_ID        , KHAMBENH_ID        , BENHNHAN_ID        , NGUOILIENHE        , DIENTHOAILIENHE        , NOILAMVIEC        , CHANDOANNOIGIOITHIEU        , NGAYKHAM        , THOIGIANKHAM        , LYDOVAOVIEN        , QUATRINHBENHLY        , TIENSUBANTHAN        , TIENSUGIADINH        , KHAMXETTOANTHAN        , KHAMXETCACBOPHAN        , KHAMXETKQLS        , CHANDOANVAO        , ICDKHAMXET_ID        , DAXULY        , NGAYRA        , THOIGIANRA        , NHAPKHOA_ID        , CHUYENVIEN_ID        , CHUY        , MACH        , NHIETDO        , HUYETAPCAO        , HUYETAPTHAP        , NHIPTHO        , CANNANG        , CHIEUCAO        , BACSI_ID        , XUTRUKHAMBENH_ID        , CAPCUU        , NGAYTAINAN        , THOIGIANTAINAN        , NOITAINAN_TINHTHANH_ID        , NOITAINAN_QUANHUYEN_ID        , NOITAINAN_PHUONGXA_ID        , NOITAINAN_DIACHI        , DIADIEMTAINAN_ID        , BOPHANBITHUONG_ID        , MUCDO_ID        , DIENBIENSAUTN_ID        , XUTRISAUTN_ID        , NGUYENNHAN_ID        , NGUYENNHANCHITIET_ID        , ICD_NGUYENNHAN        , NGAYTAO        , NGUOITAO_ID        , NGAYCAPNHAT        , NGUOICAPNHAT_ID        , BENHANCHUYENKHOA        , CHANDOANVAOVIEN        , CHANDOANRAVIEN        , DIEUTRITUNGAY        , DIEUTRIDENNGAY        , DIENBIENLS        , KQXETNGHIEM        , PHAUTHUAT        , THUTHUAT        , TINHTRANGNGUOIBENH        , HUONGDIEUTRI        , NGUOIGIAO_ID        , NGUOINHAN_ID        , XQUANG        , CTSCANNER        , SIEUAM        , XETNGHIEM        , KHAC        , TOANBOHS        , LOAICHUYENKHOA        , CONGANCANTHIEP        , CDRR_BENHCHINH        , CDRR_BENHKEM        , ICD_BENHCHINH        , ICD_BENHKEMTHEO        , PHUONGPHAPDIEUTRI        , FIELD_1        , FIELD_2        , FIELD_3        , FIELD_4        , FIELD_5        , FIELD_6        , FIELD_7        , FIELD_8        , FIELD_9        , FIELD_10        , FIELD_11        , FIELD_12        , FIELD_13        , FIELD_14        , FIELD_15        , FIELD_27        , FIELD_28        , FIELD_29        , FIELD_30        , FIELD_31        , FIELD_32        , FIELD_33        , FIELD_34        , FIELD_35        , FIELD_36        , FIELD_37        , FIELD_38        , FIELD_39        , FIELD_40        , FIELD_41        , FIELD_42        , FIELD_43        , FIELD_44        , FIELD_45        , FIELD_46        , FIELD_47        , FIELD_48        , FIELD_49        , FIELD_50        , FIELD_51        , FIELD_52        , FIELD_53        , FIELD_54        , FIELD_55        , FIELD_56        , BENHVIEN_ID        ) values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77         ,  @param78         ,  @param79         ,  @param80         ,  @param81         ,  @param82         ,  @param83         ,  @param84         ,  @param85         ,  @param86         ,  @param87         ,  @param88         ,  @param89         ,  @param90         ,  @param91         ,  @param92         ,  @param93         ,  @param94         ,  @param95         ,  @param96         ,  @param97         ,  @param98         ,  @param99         ,  @param100         ,  @param101         ,  @param102         ,  @param103         ,  @param104         ,  @param105         ,  @param106         ,  @param107         ,  @param108         ,  @param109         ,  @param110         ,  @param111         ,  @param112         ,  @param113         ,  @param114         ,  @param115         ,  @param116         ,  @param117         ,  @param118         ,  @param119         ,  @param120         ,  @param121         ,  @param122         ,  @param123         ,  @param124         )]
2019-12-10 11:04:11,708 [1] DEBUG - Statement Id: [DAO00080_Add_KhamBenh_CapCuu] Parameters: [@param0=[SOPHIEU,null], @param1=[TIEPNHAN_ID,28486], @param2=[KHAMBENH_ID,null], @param3=[BENHNHAN_ID,23420], @param4=[NGUOILIENHE,null], @param5=[DIENTHOAILIENHE,null], @param6=[NOILAMVIEC,null], @param7=[CHANDOANNOIGIOITHIEU,null], @param8=[NGAYKHAM,12/10/2019 12:00:00 AM], @param9=[THOIGIANKHAM,12/10/2019 12:00:00 AM], @param10=[LYDOVAOVIEN,null], @param11=[QUATRINHBENHLY,null], @param12=[TIENSUBANTHAN,null], @param13=[TIENSUGIADINH,null], @param14=[KHAMXETTOANTHAN,null], @param15=[KHAMXETCACBOPHAN,null], @param16=[KHAMXETKQLS,null], @param17=[CHANDOANVAO,null], @param18=[ICDKHAMXET_ID,null], @param19=[DAXULY,null], @param20=[NGAYRA,null], @param21=[THOIGIANRA,null], @param22=[NHAPKHOA_ID,68], @param23=[CHUYENVIEN_ID,null], @param24=[CHUY,null], @param25=[MACH,null], @param26=[NHIETDO,null], @param27=[HUYETAPCAO,null], @param28=[HUYETAPTHAP,null], @param29=[NHIPTHO,null], @param30=[CANNANG,null], @param31=[CHIEUCAO,null], @param32=[BACSI_ID,null], @param33=[XUTRUKHAMBENH_ID,null], @param34=[CAPCUU,null], @param35=[NGAYTAINAN,null], @param36=[THOIGIANTAINAN,null], @param37=[NOITAINAN_TINHTHANH_ID,null], @param38=[NOITAINAN_QUANHUYEN_ID,null], @param39=[NOITAINAN_PHUONGXA_ID,null], @param40=[NOITAINAN_DIACHI,null], @param41=[DIADIEMTAINAN_ID,null], @param42=[BOPHANBITHUONG_ID,null], @param43=[MUCDO_ID,null], @param44=[DIENBIENSAUTN_ID,null], @param45=[XUTRISAUTN_ID,null], @param46=[NGUYENNHAN_ID,null], @param47=[NGUYENNHANCHITIET_ID,null], @param48=[ICD_NGUYENNHAN,null], @param49=[NGAYTAO,12/10/2019 11:04:11 AM], @param50=[NGUOITAO_ID,1], @param51=[NGAYCAPNHAT,12/10/2019 11:04:11 AM], @param52=[NGUOICAPNHAT_ID,1], @param53=[BENHANCHUYENKHOA,null], @param54=[CHANDOANVAOVIEN,null], @param55=[CHANDOANRAVIEN,null], @param56=[DIEUTRITUNGAY,null], @param57=[DIEUTRIDENNGAY,null], @param58=[DIENBIENLS,null], @param59=[KQXETNGHIEM,null], @param60=[PHAUTHUAT,null], @param61=[THUTHUAT,null], @param62=[TINHTRANGNGUOIBENH,null], @param63=[HUONGDIEUTRI,null], @param64=[NGUOIGIAO_ID,null], @param65=[NGUOINHAN_ID,null], @param66=[XQUANG,null], @param67=[CTSCANNER,null], @param68=[SIEUAM,null], @param69=[XETNGHIEM,null], @param70=[KHAC,null], @param71=[TOANBOHS,null], @param72=[LOAICHUYENKHOA,null], @param73=[CONGANCANTHIEP,null], @param74=[CDRR_BENHCHINH,null], @param75=[CDRR_BENHKEM,null], @param76=[ICD_BENHCHINH,null], @param77=[ICD_BENHKEMTHEO,null], @param78=[PHUONGPHAPDIEUTRI,null], @param79=[FIELD_1,null], @param80=[FIELD_2,null], @param81=[FIELD_3,null], @param82=[FIELD_4,null], @param83=[FIELD_5,null], @param84=[FIELD_6,null], @param85=[FIELD_7,null], @param86=[FIELD_8,null], @param87=[FIELD_9,null], @param88=[FIELD_10,null], @param89=[FIELD_11,null], @param90=[FIELD_12,null], @param91=[FIELD_13,null], @param92=[FIELD_14,null], @param93=[FIELD_15,null], @param94=[FIELD_27,null], @param95=[FIELD_28,null], @param96=[FIELD_29,null], @param97=[FIELD_30,null], @param98=[FIELD_31,null], @param99=[FIELD_32,null], @param100=[FIELD_33,null], @param101=[FIELD_34,null], @param102=[FIELD_35,null], @param103=[FIELD_36,null], @param104=[FIELD_37,null], @param105=[FIELD_38,null], @param106=[FIELD_39,null], @param107=[FIELD_40,null], @param108=[FIELD_41,null], @param109=[FIELD_42,null], @param110=[FIELD_43,null], @param111=[FIELD_44,null], @param112=[FIELD_45,null], @param113=[FIELD_46,null], @param114=[FIELD_47,null], @param115=[FIELD_48,null], @param116=[FIELD_49,null], @param117=[FIELD_50,null], @param118=[FIELD_51,null], @param119=[FIELD_52,null], @param120=[FIELD_53,null], @param121=[FIELD_54,null], @param122=[FIELD_55,null], @param123=[FIELD_56,null], @param124=[BENHVIEN_ID,HLU01]]
2019-12-10 11:04:11,708 [1] DEBUG - Statement Id: [DAO00080_Add_KhamBenh_CapCuu] Types: [@param0=[System.DBNull, null], @param1=[Int32, System.Int32], @param2=[System.DBNull, null], @param3=[Int32, System.Int32], @param4=[System.DBNull, null], @param5=[System.DBNull, null], @param6=[System.DBNull, null], @param7=[System.DBNull, null], @param8=[DateTime, System.DateTime], @param9=[DateTime, System.DateTime], @param10=[System.DBNull, null], @param11=[System.DBNull, null], @param12=[System.DBNull, null], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[System.DBNull, null], @param22=[String, System.String], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[System.DBNull, null], @param39=[System.DBNull, null], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[DateTime, System.DateTime], @param50=[Int64, System.Int64], @param51=[DateTime, System.DateTime], @param52=[Int64, System.Int64], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[System.DBNull, null], @param59=[System.DBNull, null], @param60=[System.DBNull, null], @param61=[System.DBNull, null], @param62=[System.DBNull, null], @param63=[System.DBNull, null], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[System.DBNull, null], @param71=[System.DBNull, null], @param72=[System.DBNull, null], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null], @param81=[System.DBNull, null], @param82=[System.DBNull, null], @param83=[System.DBNull, null], @param84=[System.DBNull, null], @param85=[System.DBNull, null], @param86=[System.DBNull, null], @param87=[System.DBNull, null], @param88=[System.DBNull, null], @param89=[System.DBNull, null], @param90=[System.DBNull, null], @param91=[System.DBNull, null], @param92=[System.DBNull, null], @param93=[System.DBNull, null], @param94=[System.DBNull, null], @param95=[System.DBNull, null], @param96=[System.DBNull, null], @param97=[System.DBNull, null], @param98=[System.DBNull, null], @param99=[System.DBNull, null], @param100=[System.DBNull, null], @param101=[System.DBNull, null], @param102=[System.DBNull, null], @param103=[System.DBNull, null], @param104=[System.DBNull, null], @param105=[System.DBNull, null], @param106=[System.DBNull, null], @param107=[System.DBNull, null], @param108=[System.DBNull, null], @param109=[System.DBNull, null], @param110=[System.DBNull, null], @param111=[System.DBNull, null], @param112=[System.DBNull, null], @param113=[System.DBNull, null], @param114=[System.DBNull, null], @param115=[System.DBNull, null], @param116=[System.DBNull, null], @param117=[System.DBNull, null], @param118=[System.DBNull, null], @param119=[System.DBNull, null], @param120=[System.DBNull, null], @param121=[System.DBNull, null], @param122=[System.DBNull, null], @param123=[System.DBNull, null], @param124=[String, System.String]]
2019-12-10 11:04:11,746 [1] DEBUG - Statement Id: [DAO00019_Add_TT_TIEPNHAN_SOTHEBHYT] PreparedStatement : [INSERT INTO TT_TIEPNHAN_SOTHEBHYT        (TIEPNHAN_ID        ,BENHNHAN_ID        ,BENHAN_ID        ,DOITUONG_ID        ,SOBHYT        ,BHYTTUNGAY        ,BHYTDENNGAY        ,BHYTNGAYCAP        ,BHYTTREN3NAM        ,BHYTTREN5NAM        ,NGAYMIENDONGCHITRA        ,TRAITUYEN        ,BENHVIEN_ID        ,NOITAO_ID        ,NGAYTAO        ,NGUOITAO_ID        ,NGAYCAPNHAT        ,NGUOICAPNHAT_ID        ,TYLE_VUOT_LCB        ,TYLE_TRAITUYEN        ,GIOIHAN_VUOT_LCB        ,LUONG_COSO        ,TYLE_THUOC_UT        ,MADOITUONG)        VALUES        ( @param0         , @param1         , @param2         , @param3         , @param4         , @param5         , @param6         , @param7         , @param8         , @param9         , @param10         , @param11         , @param12         , @param13         , @param14         , @param15         , @param16         , @param17         , @param18         , @param19         , @param20         , @param21         , @param22         , @param23 )]
2019-12-10 11:04:11,746 [1] DEBUG - Statement Id: [DAO00019_Add_TT_TIEPNHAN_SOTHEBHYT] Parameters: [@param0=[TIEPNHAN_ID,28486], @param1=[BENHNHAN_ID,23420], @param2=[BENHAN_ID,null], @param3=[DOITUONG_ID,1], @param4=[SOBHYT,null], @param5=[BHYTTUNGAY,null], @param6=[BHYTDENNGAY,null], @param7=[BHYTNGAYCAP,null], @param8=[BHYTTREN3NAM,0], @param9=[BHYTTREN5NAM,0], @param10=[NGAYMIENDONGCHITRA,null], @param11=[TRAITUYEN,0], @param12=[BENHVIEN_ID,HLU01], @param13=[NOITAO_ID,68], @param14=[NGAYTAO,12/10/2019 11:04:11 AM], @param15=[NGUOITAO_ID,1], @param16=[NGAYCAPNHAT,12/10/2019 11:04:11 AM], @param17=[NGUOICAPNHAT_ID,1], @param18=[TYLE_VUOT_LCB,null], @param19=[TYLE_TRAITUYEN,null], @param20=[GIOIHAN_VUOT_LCB,null], @param21=[LUONG_COSO,null], @param22=[TYLE_THUOC_UT,null], @param23=[MADOITUONG,null]]
2019-12-10 11:04:11,746 [1] DEBUG - Statement Id: [DAO00019_Add_TT_TIEPNHAN_SOTHEBHYT] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[System.DBNull, null], @param3=[Int64, System.Int64], @param4=[System.DBNull, null], @param5=[System.DBNull, null], @param6=[System.DBNull, null], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[String, System.String], @param10=[System.DBNull, null], @param11=[String, System.String], @param12=[String, System.String], @param13=[String, System.String], @param14=[DateTime, System.DateTime], @param15=[Int64, System.Int64], @param16=[DateTime, System.DateTime], @param17=[Int64, System.Int64], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[System.DBNull, null], @param22=[System.DBNull, null], @param23=[System.DBNull, null]]
2019-12-10 11:04:11,788 [1] DEBUG - Statement Id: [DAO00027_GetListTiepNhanAllCOM30] PreparedStatement : [select distinct A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, isnull(C.SOBENHAN,NULL) as SOBENHAN,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI, A.SOBHYT, CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYTIEPNHAN,        B.*        , A.UUTIEN        from TT_TIEPNHAN A        inner join (select * from TT_BENHNHAN where MAYTE = '190043301' and ACTIVE = '1') B on B.BENHNHAN_ID = A.BENHNHAN_ID  and B.ACTIVE = '1'        left join TT_NOITRU_BENHAN C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        where A.TIEPNHAN_ID = '28486' and A.BENHVIEN_ID = 'HLU01' and (A.TRANGTHAI not in ('HUY','CAPCUU', 'NOITRU', 'NGOAITRU'))]
2019-12-10 11:04:12,307 [1] DEBUG - Statement Id: [DAOWF001_LaythongtinProcess] PreparedStatement : [select * from TM_PROCESS        where        PROCESS_CODE = 'P01']
2019-12-10 11:04:12,354 [1] DEBUG - Statement Id: [DAOWF001_Kiemtrathongtindayeucau] PreparedStatement : [select * from TT_REQUEST        where        PROCESS_CODE = 'P01'        AND PARA = '{"HOSPITAL_ID":"HLU01","SOTIEPNHAN":"TN191210.0000005"}'        AND CURR_STATE_CODE = '6'        AND ISACTIVE = '1']
2019-12-10 11:04:12,404 [1] DEBUG - Statement Id: [DAOWF002_Add] PreparedStatement : [DECLARE @IDRequestOld int        DECLARE @IDRequestNew int        select top 1 @IDRequestOld = ID from TT_REQUEST where PARA =  @param0  order by ID desc          insert into TT_REQUEST (        PROCESS_CODE        , PARA        , CURR_STATE_CODE        ) values (         @param1         ,  @param0         ,  @param2         )        SELECT @IDRequestNew = SCOPE_IDENTITY()        if (@IDRequestOld is not null)        begin        update TT_REQUEST_SERVICE set REQUEST_ID = @IDRequestNew, PROCESS_CODE =  @param1  where REQUEST_ID = @IDRequestOld        update TT_REQUEST set ISACTIVE = '0' where ID = @IDRequestOld        update TT_REQUEST_SERVICE_DETAIL set REQUEST_ID = @IDRequestNew where REQUEST_ID = @IDRequestOld        end          select @IDRequestNew]
2019-12-10 11:04:12,404 [1] DEBUG - Statement Id: [DAOWF002_Add] Parameters: [@param0=[PARA,{"HOSPITAL_ID":"HLU01","SOTIEPNHAN":"TN191210.0000005"}], @param1=[PROCESS_CODE,P01], @param2=[CURR_STATE_CODE,6]]
2019-12-10 11:04:12,404 [1] DEBUG - Statement Id: [DAOWF002_Add] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[String, System.String]]
2019-12-10 11:04:12,462 [1] DEBUG - Statement Id: [DAO00064_GetREGListVienphiTiepNhan] PreparedStatement : [select A.*, B.THUTIENSAU        from TT_VIENPHI A        left join TT_DVYEUCAU B on A.REF_ID =  B.DVYEUCAU_ID and A.REF_TABLE = 'TT_DVYEUCAU' and B.HUYYEUCAU = '0'        where        A.TIEPNHAN_ID = '28486' and A.BENHVIEN_ID = 'HLU01' and (A.BENHAN_ID is NULL or A.BENHAN_ID = '')        and A.HUY = '0'        ORDER BY A.VIENPHI_ID]
2019-12-10 11:04:12,665 [1] DEBUG - Statement Id: [DAOLOG01_LockEnd] PreparedStatement : [DELETE TT_LOG_UPDATE        where REF_TABLE = 'TT_TIEPNHAN_BENHAN' and REF_ID = '23420' and BENHVIEN_ID = 'HLU01']
2019-12-10 11:04:12,695 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-12-10 11:04:12,698 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,28486], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,23420], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,4135], @param8=[BACSICHIDINH_ID,null], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,12/10/2019 12:00:00 AM], @param11=[THANGYEUCAU,12], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,12/10/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,68], @param16=[NOITHUCHIEN_ID,35], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,3], @param50=[HOPDONG_BENHNHAN_ID,203], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,8/26/2019 1:43:56 PM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-12-10 11:04:12,698 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-12-10 11:04:12,742 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28486' and C.DICHVU_ID = '4135' and A.BENHVIEN_ID = 'HLU01']
2019-12-10 11:04:13,388 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28486' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-12-10 11:04:14,084 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '28486']
2019-12-10 11:04:14,893 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-12-10 11:04:14,893 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,28486], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,23420], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,206484], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,4135], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,9], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,90000], @param12=[THANHTIEN_DOANHTHU,90000], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,90000], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,90000], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,8/26/2019 1:43:56 PM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,12/10/2019 11:03:49 AM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-12-10 11:04:14,893 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-12-10 11:04:14,923 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 37          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 203]
2019-12-10 11:04:14,923 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,28486], @param1=[DVYEUCAU_ID,206484], @param2=[VIENPHI_ID,675772], @param3=[SOPHIEUYEUCAU,19..045230], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,12/10/2019 11:04:14 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-12-10 11:04:14,923 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-12-10 11:04:14,950 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-12-10 11:04:14,951 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,28486], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,23420], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,4524], @param8=[BACSICHIDINH_ID,null], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,12/10/2019 12:00:00 AM], @param11=[THANGYEUCAU,12], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,12/10/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,68], @param16=[NOITHUCHIEN_ID,104], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,3], @param50=[HOPDONG_BENHNHAN_ID,203], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,8/26/2019 1:43:56 PM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-12-10 11:04:14,951 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-12-10 11:04:14,988 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28486' and C.DICHVU_ID = '4524' and A.BENHVIEN_ID = 'HLU01']
2019-12-10 11:04:15,662 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28486' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-12-10 11:04:17,150 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '28486']
2019-12-10 11:04:17,882 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-12-10 11:04:17,882 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,28486], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,23420], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,206485], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,4524], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,3], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,50000], @param12=[THANHTIEN_DOANHTHU,50000], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,50000], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,50000], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,8/26/2019 1:43:56 PM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,12/10/2019 11:03:49 AM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-12-10 11:04:17,882 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-12-10 11:04:17,913 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 38          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 203]
2019-12-10 11:04:17,913 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,28486], @param1=[DVYEUCAU_ID,206485], @param2=[VIENPHI_ID,675773], @param3=[SOPHIEUYEUCAU,19..045231], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,12/10/2019 11:04:17 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-12-10 11:04:17,913 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-12-10 11:04:17,940 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-12-10 11:04:17,940 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,28486], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,23420], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,5433], @param8=[BACSICHIDINH_ID,null], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,12/10/2019 12:00:00 AM], @param11=[THANGYEUCAU,12], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,12/10/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,68], @param16=[NOITHUCHIEN_ID,64], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,3], @param50=[HOPDONG_BENHNHAN_ID,203], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,8/26/2019 1:43:56 PM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-12-10 11:04:17,940 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-12-10 11:04:17,977 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28486' and C.DICHVU_ID = '5433' and A.BENHVIEN_ID = 'HLU01']
2019-12-10 11:04:18,790 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28486' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-12-10 11:04:21,104 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '28486']
2019-12-10 11:04:22,875 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-12-10 11:04:22,875 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,28486], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,23420], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,206486], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,5433], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,3], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,50000], @param12=[THANHTIEN_DOANHTHU,50000], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,50000], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,50000], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,8/26/2019 1:43:56 PM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,12/10/2019 11:03:49 AM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-12-10 11:04:22,875 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-12-10 11:04:22,905 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 39          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 203]
2019-12-10 11:04:22,905 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,28486], @param1=[DVYEUCAU_ID,206486], @param2=[VIENPHI_ID,675774], @param3=[SOPHIEUYEUCAU,19..045232], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,12/10/2019 11:04:22 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-12-10 11:04:22,905 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-12-10 11:04:22,933 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-12-10 11:04:22,934 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,28486], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,23420], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,5438], @param8=[BACSICHIDINH_ID,null], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,12/10/2019 12:00:00 AM], @param11=[THANGYEUCAU,12], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,12/10/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,68], @param16=[NOITHUCHIEN_ID,64], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,3], @param50=[HOPDONG_BENHNHAN_ID,203], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,8/26/2019 1:43:56 PM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-12-10 11:04:22,934 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-12-10 11:04:22,974 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28486' and C.DICHVU_ID = '5438' and A.BENHVIEN_ID = 'HLU01']
2019-12-10 11:04:23,979 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28486' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-12-10 11:04:26,577 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '28486']
2019-12-10 11:04:34,302 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-12-10 11:04:34,303 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,28486], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,23420], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,206487], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,5438], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,3], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,50000], @param12=[THANHTIEN_DOANHTHU,50000], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,50000], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,50000], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,8/26/2019 1:43:56 PM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,12/10/2019 11:03:49 AM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-12-10 11:04:34,303 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-12-10 11:04:34,388 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 40          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 203]
2019-12-10 11:04:34,388 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,28486], @param1=[DVYEUCAU_ID,206487], @param2=[VIENPHI_ID,675775], @param3=[SOPHIEUYEUCAU,19..045233], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,12/10/2019 11:04:34 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-12-10 11:04:34,388 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-12-10 11:04:34,415 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-12-10 11:04:34,416 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,28486], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,23420], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,5443], @param8=[BACSICHIDINH_ID,null], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,12/10/2019 12:00:00 AM], @param11=[THANGYEUCAU,12], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,12/10/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,68], @param16=[NOITHUCHIEN_ID,68], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,3], @param50=[HOPDONG_BENHNHAN_ID,203], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,8/26/2019 1:43:56 PM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-12-10 11:04:34,416 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-12-10 11:04:35,020 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28486' and C.DICHVU_ID = '5443' and A.BENHVIEN_ID = 'HLU01']
2019-12-10 11:04:35,885 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28486' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-12-10 11:04:39,083 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '28486']
2019-12-10 11:04:41,916 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-12-10 11:04:41,916 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,28486], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,23420], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,206488], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,5443], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,3], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,50000], @param12=[THANHTIEN_DOANHTHU,50000], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,50000], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,50000], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,8/26/2019 1:43:56 PM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,12/10/2019 11:03:49 AM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-12-10 11:04:41,916 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-12-10 11:04:41,971 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 41          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 203]
2019-12-10 11:04:41,971 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,28486], @param1=[DVYEUCAU_ID,206488], @param2=[VIENPHI_ID,675776], @param3=[SOPHIEUYEUCAU,19..045234], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,12/10/2019 11:04:41 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-12-10 11:04:41,971 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-12-10 11:04:42,003 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-12-10 11:04:42,004 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,28486], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,23420], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,5435], @param8=[BACSICHIDINH_ID,null], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,12/10/2019 12:00:00 AM], @param11=[THANGYEUCAU,12], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,12/10/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,68], @param16=[NOITHUCHIEN_ID,177], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,3], @param50=[HOPDONG_BENHNHAN_ID,203], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,8/26/2019 1:43:56 PM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-12-10 11:04:42,004 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-12-10 11:04:42,102 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28486' and C.DICHVU_ID = '5435' and A.BENHVIEN_ID = 'HLU01']
2019-12-10 11:04:42,861 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28486' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-12-10 11:04:46,115 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '28486']
2019-12-10 11:04:49,277 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-12-10 11:04:49,278 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,28486], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,23420], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,206489], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,5435], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,3], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,50000], @param12=[THANHTIEN_DOANHTHU,50000], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,50000], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,50000], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,8/26/2019 1:43:56 PM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,12/10/2019 11:03:49 AM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-12-10 11:04:49,278 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-12-10 11:04:49,344 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 42          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 203]
2019-12-10 11:04:49,344 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,28486], @param1=[DVYEUCAU_ID,206489], @param2=[VIENPHI_ID,675777], @param3=[SOPHIEUYEUCAU,19..045235], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,12/10/2019 11:04:49 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-12-10 11:04:49,344 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-12-10 11:04:49,373 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-12-10 11:04:49,374 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,28486], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,23420], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,4747], @param8=[BACSICHIDINH_ID,null], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,12/10/2019 12:00:00 AM], @param11=[THANGYEUCAU,12], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,12/10/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,68], @param16=[NOITHUCHIEN_ID,104], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,3], @param50=[HOPDONG_BENHNHAN_ID,203], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,8/26/2019 1:43:56 PM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-12-10 11:04:49,374 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-12-10 11:04:49,469 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28486' and C.DICHVU_ID = '4747' and A.BENHVIEN_ID = 'HLU01']
2019-12-10 11:04:50,154 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28486' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-12-10 11:04:53,608 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '28486']
2019-12-10 11:04:57,668 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-12-10 11:04:57,669 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,28486], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,23420], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,206490], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,4747], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,3], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,40000], @param12=[THANHTIEN_DOANHTHU,40000], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,40000], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,40000], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,8/26/2019 1:43:56 PM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,12/10/2019 11:03:49 AM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-12-10 11:04:57,669 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-12-10 11:04:57,780 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 43          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 203]
2019-12-10 11:04:57,780 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,28486], @param1=[DVYEUCAU_ID,206490], @param2=[VIENPHI_ID,675778], @param3=[SOPHIEUYEUCAU,19..045236], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,12/10/2019 11:04:57 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-12-10 11:04:57,780 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-12-10 11:04:57,811 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-12-10 11:04:57,812 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,28486], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,23420], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,4005], @param8=[BACSICHIDINH_ID,null], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,12/10/2019 12:00:00 AM], @param11=[THANGYEUCAU,12], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,12/10/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,68], @param16=[NOITHUCHIEN_ID,92], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,3], @param50=[HOPDONG_BENHNHAN_ID,203], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,8/26/2019 1:43:56 PM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-12-10 11:04:57,812 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-12-10 11:04:57,903 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28486' and C.DICHVU_ID = '4005' and A.BENHVIEN_ID = 'HLU01']
2019-12-10 11:04:58,609 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28486' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-12-10 11:05:03,101 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '28486']
2019-12-10 11:05:07,647 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-12-10 11:05:07,647 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,28486], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,23420], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,206491], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,4005], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,9], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,70000], @param12=[THANHTIEN_DOANHTHU,70000], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,70000], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,70000], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,8/26/2019 1:43:56 PM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,12/10/2019 11:03:49 AM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-12-10 11:05:07,648 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-12-10 11:05:08,220 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 44          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 203]
2019-12-10 11:05:08,220 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,28486], @param1=[DVYEUCAU_ID,206491], @param2=[VIENPHI_ID,675779], @param3=[SOPHIEUYEUCAU,19..045237], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,12/10/2019 11:05:08 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-12-10 11:05:08,220 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-12-10 11:05:08,253 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-12-10 11:05:08,254 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,28486], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,23420], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,4017], @param8=[BACSICHIDINH_ID,null], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,12/10/2019 12:00:00 AM], @param11=[THANGYEUCAU,12], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,12/10/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,68], @param16=[NOITHUCHIEN_ID,92], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,3], @param50=[HOPDONG_BENHNHAN_ID,203], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,8/26/2019 1:43:56 PM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-12-10 11:05:08,254 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-12-10 11:05:08,345 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28486' and C.DICHVU_ID = '4017' and A.BENHVIEN_ID = 'HLU01']
2019-12-10 11:05:09,257 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28486' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-12-10 11:05:15,995 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '28486']
2019-12-10 11:05:24,969 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-12-10 11:05:24,979 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,28486], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,23420], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,206492], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,4017], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,3], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,50000], @param12=[THANHTIEN_DOANHTHU,50000], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,50000], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,50000], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,8/26/2019 1:43:56 PM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,12/10/2019 11:03:49 AM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-12-10 11:05:24,979 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-12-10 11:05:25,038 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 45          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 203]
2019-12-10 11:05:25,038 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,28486], @param1=[DVYEUCAU_ID,206492], @param2=[VIENPHI_ID,675780], @param3=[SOPHIEUYEUCAU,19..045238], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,12/10/2019 11:05:25 AM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-12-10 11:05:25,038 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-12-10 11:05:25,552 [1] DEBUG - Statement Id: [DAO00307_GetPatientConfirms] PreparedStatement : [select distinct HD_BN.*        , CASE WHEN HD_BN.GIOITINH = '1' THEN N'Nam' ELSE N'Nữ' END AS GENDER        , CASE WHEN HD_DV.ACTIVE IS NULL THEN 0 ELSE 1 END BENHNHAN_DANGKYKSK_DICHVU        , case when HD_BN.GOI_ID is null then N'Hợp đồng:' + ' ' + HD.SO_HD else N'Gói khám:' + ' ' + G.TENGOI end as DOITUONG        , LST.DICTIONARY_NAME as HONNHAN        from TT_KSK_HOPDONG HD        inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        left join LST_DICTIONARY LST ON LST.DICTIONARY_ID = HD_BN.TINHTRANGHONNHAN_ID AND LST.DICTIONARY_TYPE_CODE = 'TinhTrangGiaDinh'        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        left join TT_TIEPNHAN TN on TN.TIEPNHAN_ID = HD_DV.TIEPNHAN_ID        left join TM_CSKH_GOI G ON G.GOI_ID = HD_BN.GOI_ID        where HD.HOPDONG_ID = '3'         AND           HD.BENHVIEN_ID = 'HLU01'                 order by HD_BN.STT]
2019-12-10 11:05:25,653 [1] DEBUG - Statement Id: [DAO00308_GetTiepNhanID] PreparedStatement : [select top 1 TN.TIEPNHAN_ID, TN.SOTIEPNHAN        from TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV        inner join TT_TIEPNHAN TN on TN.TIEPNHAN_ID = HD_DV.TIEPNHAN_ID        where HD_DV.HOPDONG_BENHNHAN_ID = 203 and HD_DV.HOPDONG_ID = 3]
2019-12-10 11:05:25,966 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , PB.TENPHONGBAN as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , PB.PHONGBAN_ID as NOITHUCHIEN_ID        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '203'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 11:06:31,522 [1] DEBUG - Statement Id: [DAO00329_Search_BenhNhan_KSK] PreparedStatement : [select * from(select COUNT(*) OVER() as TOTALROWS,ROW_NUMBER() OVER (ORDER BY a.MAYTE) as ROWNUMBER, * from        (SELECT distinct BN.MAYTE,BN.TENBENHNHAN,BN.BENHNHAN_ID,BNDV.TIEPNHAN_ID,DV.MADICHVU,DV.DICHVU_ID,TN.SOTIEPNHAN        ,BNDV.DVYEUCAU_ID,BNDV.PHONGBAN_ID AS NOITHUCHIEN_ID,BNDV.SOPHIEUYEUCAU        ,Case when BN.GIOITINH =1 then N'Nam' else N'Nữ' end as GIOITINH        ,CONVERT(varchar(20), BN.NGAYSINH, 103) AS NGAYSINH,DV.TENDICHVU,PB.TENPHONGBAN as TENPHONGKHAM,CT.TENCONGTY,HD.SO_HD        FROM TT_KSK_CONGTY CT        left join TT_KSK_HOPDONG HD ON HD.CONGTY_ID=CT.CONGTY_ID        left join TT_KSK_HOPDONG_BENHNHAN BN ON BN.HOPDONG_ID=HD.HOPDONG_ID        left join TT_KSK_HOPDONG_BENHNHAN_DICHVU BNDV ON BNDV.HOPDONG_BENHNHAN_ID=BN.HOPDONG_BENHNHAN_ID        left join TT_KSK_HOPDONG_GOIDICHVU GDV ON GDV.HOPDONG_ID= BN.HOPDONG_ID        left join TM_DICHVU DV ON DV.DICHVU_ID=BNDV.DICHVU_ID        left join TM_PHONGBAN PB ON PB.PHONGBAN_ID=BNDV.PHONGBAN_ID        join TT_TIEPNHAN TN ON TN.TIEPNHAN_ID= BNDV.TIEPNHAN_ID         where           (TN.NGAYTIEPNHAN BETWEEN CONVERT(DATE,'9/1/2019 12:00:00 AM') AND CONVERT(DATE,'12/10/2019 12:00:00 AM'))          AND BNDV.PHONGBAN_ID='68' AND                              BNDV.DATHUCHIEN IS NULL                         )a )b  where b.ROWNUMBER between '1' AND '5']
2019-12-10 11:06:34,018 [1] DEBUG - Statement Id: [DAO00329_Search_BenhNhan_KSK] PreparedStatement : [select * from(select COUNT(*) OVER() as TOTALROWS,ROW_NUMBER() OVER (ORDER BY a.MAYTE) as ROWNUMBER, * from        (SELECT distinct BN.MAYTE,BN.TENBENHNHAN,BN.BENHNHAN_ID,BNDV.TIEPNHAN_ID,DV.MADICHVU,DV.DICHVU_ID,TN.SOTIEPNHAN        ,BNDV.DVYEUCAU_ID,BNDV.PHONGBAN_ID AS NOITHUCHIEN_ID,BNDV.SOPHIEUYEUCAU        ,Case when BN.GIOITINH =1 then N'Nam' else N'Nữ' end as GIOITINH        ,CONVERT(varchar(20), BN.NGAYSINH, 103) AS NGAYSINH,DV.TENDICHVU,PB.TENPHONGBAN as TENPHONGKHAM,CT.TENCONGTY,HD.SO_HD        FROM TT_KSK_CONGTY CT        left join TT_KSK_HOPDONG HD ON HD.CONGTY_ID=CT.CONGTY_ID        left join TT_KSK_HOPDONG_BENHNHAN BN ON BN.HOPDONG_ID=HD.HOPDONG_ID        left join TT_KSK_HOPDONG_BENHNHAN_DICHVU BNDV ON BNDV.HOPDONG_BENHNHAN_ID=BN.HOPDONG_BENHNHAN_ID        left join TT_KSK_HOPDONG_GOIDICHVU GDV ON GDV.HOPDONG_ID= BN.HOPDONG_ID        left join TM_DICHVU DV ON DV.DICHVU_ID=BNDV.DICHVU_ID        left join TM_PHONGBAN PB ON PB.PHONGBAN_ID=BNDV.PHONGBAN_ID        join TT_TIEPNHAN TN ON TN.TIEPNHAN_ID= BNDV.TIEPNHAN_ID         where           (TN.NGAYTIEPNHAN BETWEEN CONVERT(DATE,'9/1/2019 12:00:00 AM') AND CONVERT(DATE,'12/10/2019 12:00:00 AM'))          AND BNDV.PHONGBAN_ID='68' AND                              BNDV.DATHUCHIEN IS NOT NULL                         )a )b  where b.ROWNUMBER between '1' AND '5']
2019-12-10 11:11:53,024 [1] DEBUG - Statement Id: [DAO00307_GetContractWithDate] PreparedStatement : [SELECT HD.*, HD.SO_HD + ' - ' + CT.TENCONGTY AS HOPDONG, CT.TENCONGTY        FROM TT_KSK_HOPDONG HD JOIN TT_KSK_CONGTY CT ON CT.CONGTY_ID = HD.CONGTY_ID         where                 HD.BENHVIEN_ID = 'HLU01']
2019-12-10 11:11:53,448 [1] DEBUG - Statement Id: [DAO00307_GetContractWithDate] PreparedStatement : [SELECT HD.*, HD.SO_HD + ' - ' + CT.TENCONGTY AS HOPDONG, CT.TENCONGTY        FROM TT_KSK_HOPDONG HD JOIN TT_KSK_CONGTY CT ON CT.CONGTY_ID = HD.CONGTY_ID         where                 HD.BENHVIEN_ID = 'HLU01']
2019-12-10 11:11:53,693 [1] DEBUG - Statement Id: [DAO00307_GetContractWithDate] PreparedStatement : [SELECT HD.*, HD.SO_HD + ' - ' + CT.TENCONGTY AS HOPDONG, CT.TENCONGTY        FROM TT_KSK_HOPDONG HD JOIN TT_KSK_CONGTY CT ON CT.CONGTY_ID = HD.CONGTY_ID         where                 HD.BENHVIEN_ID = 'HLU01']
2019-12-10 11:11:54,071 [1] DEBUG - Statement Id: [DAO00307_GetContractWithDate] PreparedStatement : [SELECT HD.*, HD.SO_HD + ' - ' + CT.TENCONGTY AS HOPDONG, CT.TENCONGTY        FROM TT_KSK_HOPDONG HD JOIN TT_KSK_CONGTY CT ON CT.CONGTY_ID = HD.CONGTY_ID         where                 HD.BENHVIEN_ID = 'HLU01']
2019-12-10 11:11:58,371 [1] DEBUG - Statement Id: [DAO00307_GetContractPatient] PreparedStatement : [SELECT HD_BN.*, LST.DICTIONARY_NAME AS HONNHAN        , CASE WHEN HD_BN.GIOITINH = '1' THEN N'Nam' ELSE N'Nữ' END AS GENDER        , CASE WHEN HD_BN.HOPDONG_BENHNHAN_ID IN (SELECT HOPDONG_BENHNHAN_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU) THEN 1 ELSE 0 END BENHNHAN_DANGKYKSK_DICHVU        , GOI.TENGOI        FROM TT_KSK_HOPDONG_BENHNHAN HD_BN        INNER JOIN TT_KSK_HOPDONG HD ON HD.HOPDONG_ID = HD_BN.HOPDONG_ID        LEFT JOIN LST_DICTIONARY LST ON LST.DICTIONARY_ID = HD_BN.TINHTRANGHONNHAN_ID AND LST.DICTIONARY_TYPE_CODE = 'TinhTrangGiaDinh'        LEFT JOIN TM_CSKH_GOI GOI ON GOI.GOI_ID = HD_BN.GOI_ID        WHERE HD.HOPDONG_ID = 3           AND               HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-10 11:11:58,490 [1] DEBUG - Statement Id: [DAO00308_StatusContract] PreparedStatement : [SELECT * FROM TT_KSK_HOPDONG        WHERE HOPDONG_ID = 3]
2019-12-10 11:16:17,009 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MKT15'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 11:16:56,529 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_GetList] PreparedStatement : [select * from TM_CSKH_GOI A         where               A.TRANGTHAI = 'GOIDUOCPHEPBAN'           and             convert(date,A.NGAYTAO) between convert(date, '12/10/2019 11:16:24 AM') and convert(date, '12/10/2019 11:16:24 AM')           and             A.BENHVIEN_ID = 'HLU01']
2019-12-10 11:28:13,400 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_GetList] PreparedStatement : [select * from TM_CSKH_GOI A         where               A.TRANGTHAI = 'GOIDUOCPHEPBAN'           and             convert(date,A.NGAYTAO) between convert(date, '6/1/2019 12:00:00 AM') and convert(date, '12/10/2019 11:16:24 AM')           and             A.BENHVIEN_ID = 'HLU01']
2019-12-10 11:28:27,016 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_Get] PreparedStatement : [select A.*, B.SOLANSUDUNG        from TM_CSKH_GOI A        left join        (select count(*) as SOLANSUDUNG, GOI_ID        from TT_CSKH_GOI_DANGKY        group by GOI_ID        )B on B.GOI_ID = a.GOI_ID         where               A.GOI_ID = '3'           and             A.BENHVIEN_ID = 'HLU01']
2019-12-10 11:28:27,081 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_GetDetail] PreparedStatement : [select A.*, DV.MADICHVU from TM_CSKH_GOI_CHITIET A        left join TM_DICHVU dv on dv.DICHVU_ID = A.DICHVU_ID         where                 A.GOI_ID = '3'             and               A.BENHVIEN_ID = 'HLU01']
2019-12-10 11:28:27,485 [1] DEBUG - Statement Id: [DAO00000_GetDICHVU_DONGIA_LOAIGIA] PreparedStatement : [select A.LOAIGIA_ID, A.BANGGIA_ID, A.GIAVON, A.TYLEVAT  as TYLE_VAT, A.TYLE_LOINHUAN,            A.DONGIA as DONGIA_DOANHTHU, NULL as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DICHVU_DONGIA A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '5435' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.LOAIGIA_ID = '3' and A.DICHVU_ID = '5435'            union            select A.LOAIGIA_ID, null as BANGGIA_ID, null as GIAVON, null as TYLE_VAT, null as TYLE_LOINHUAN,            null as DONGIA_DOANHTHU, C.DONGIA as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DOITUONG_GIADICHVU A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join TM_DICHVU_DONGIA C on C.LOAIGIA_ID = A.LOAIGIA_ID AND C.BENHVIEN_ID = 'HLU01'            and C.BANGGIA_ID = B.BANGGIA_ID and C.DICHVU_ID = A.DICHVU_ID            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '5435' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.DOITUONG_ID = '1'  and A.DICHVU_ID = '5435' and A.LOAIGIA_ID            in (select top 1 LOAIGIA_ID from TM_DOITUONG_LOAIGIA            where DOITUONG_ID = '1' and GIAHOTRO = '1'  AND BENHVIEN_ID = 'HLU01'            and LOAIGIA_ID            in (select LOAIGIA_ID from TM_BANGGIA            where LOAIBANGGIA in            (select LOAIBANGGIA from TM_BANGGIA where LOAIGIA_ID = '3'  AND BENHVIEN_ID = 'HLU01')            and TAMNGUNG = '0')  AND BENHVIEN_ID = 'HLU01'            )]
2019-12-10 11:28:28,111 [1] DEBUG - Statement Id: [DAO00000_GetDICHVU_DONGIA_LOAIGIA] PreparedStatement : [select A.LOAIGIA_ID, A.BANGGIA_ID, A.GIAVON, A.TYLEVAT  as TYLE_VAT, A.TYLE_LOINHUAN,            A.DONGIA as DONGIA_DOANHTHU, NULL as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DICHVU_DONGIA A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '5443' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.LOAIGIA_ID = '3' and A.DICHVU_ID = '5443'            union            select A.LOAIGIA_ID, null as BANGGIA_ID, null as GIAVON, null as TYLE_VAT, null as TYLE_LOINHUAN,            null as DONGIA_DOANHTHU, C.DONGIA as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DOITUONG_GIADICHVU A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join TM_DICHVU_DONGIA C on C.LOAIGIA_ID = A.LOAIGIA_ID AND C.BENHVIEN_ID = 'HLU01'            and C.BANGGIA_ID = B.BANGGIA_ID and C.DICHVU_ID = A.DICHVU_ID            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '5443' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.DOITUONG_ID = '1'  and A.DICHVU_ID = '5443' and A.LOAIGIA_ID            in (select top 1 LOAIGIA_ID from TM_DOITUONG_LOAIGIA            where DOITUONG_ID = '1' and GIAHOTRO = '1'  AND BENHVIEN_ID = 'HLU01'            and LOAIGIA_ID            in (select LOAIGIA_ID from TM_BANGGIA            where LOAIBANGGIA in            (select LOAIBANGGIA from TM_BANGGIA where LOAIGIA_ID = '3'  AND BENHVIEN_ID = 'HLU01')            and TAMNGUNG = '0')  AND BENHVIEN_ID = 'HLU01'            )]
2019-12-10 11:28:28,238 [1] DEBUG - Statement Id: [DAO00000_GetDICHVU_DONGIA_LOAIGIA] PreparedStatement : [select A.LOAIGIA_ID, A.BANGGIA_ID, A.GIAVON, A.TYLEVAT  as TYLE_VAT, A.TYLE_LOINHUAN,            A.DONGIA as DONGIA_DOANHTHU, NULL as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DICHVU_DONGIA A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '5433' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.LOAIGIA_ID = '3' and A.DICHVU_ID = '5433'            union            select A.LOAIGIA_ID, null as BANGGIA_ID, null as GIAVON, null as TYLE_VAT, null as TYLE_LOINHUAN,            null as DONGIA_DOANHTHU, C.DONGIA as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DOITUONG_GIADICHVU A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join TM_DICHVU_DONGIA C on C.LOAIGIA_ID = A.LOAIGIA_ID AND C.BENHVIEN_ID = 'HLU01'            and C.BANGGIA_ID = B.BANGGIA_ID and C.DICHVU_ID = A.DICHVU_ID            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '5433' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.DOITUONG_ID = '1'  and A.DICHVU_ID = '5433' and A.LOAIGIA_ID            in (select top 1 LOAIGIA_ID from TM_DOITUONG_LOAIGIA            where DOITUONG_ID = '1' and GIAHOTRO = '1'  AND BENHVIEN_ID = 'HLU01'            and LOAIGIA_ID            in (select LOAIGIA_ID from TM_BANGGIA            where LOAIBANGGIA in            (select LOAIBANGGIA from TM_BANGGIA where LOAIGIA_ID = '3'  AND BENHVIEN_ID = 'HLU01')            and TAMNGUNG = '0')  AND BENHVIEN_ID = 'HLU01'            )]
2019-12-10 11:28:28,339 [1] DEBUG - Statement Id: [DAO00000_GetDICHVU_DONGIA_LOAIGIA] PreparedStatement : [select A.LOAIGIA_ID, A.BANGGIA_ID, A.GIAVON, A.TYLEVAT  as TYLE_VAT, A.TYLE_LOINHUAN,            A.DONGIA as DONGIA_DOANHTHU, NULL as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DICHVU_DONGIA A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '5438' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.LOAIGIA_ID = '3' and A.DICHVU_ID = '5438'            union            select A.LOAIGIA_ID, null as BANGGIA_ID, null as GIAVON, null as TYLE_VAT, null as TYLE_LOINHUAN,            null as DONGIA_DOANHTHU, C.DONGIA as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DOITUONG_GIADICHVU A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join TM_DICHVU_DONGIA C on C.LOAIGIA_ID = A.LOAIGIA_ID AND C.BENHVIEN_ID = 'HLU01'            and C.BANGGIA_ID = B.BANGGIA_ID and C.DICHVU_ID = A.DICHVU_ID            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '5438' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.DOITUONG_ID = '1'  and A.DICHVU_ID = '5438' and A.LOAIGIA_ID            in (select top 1 LOAIGIA_ID from TM_DOITUONG_LOAIGIA            where DOITUONG_ID = '1' and GIAHOTRO = '1'  AND BENHVIEN_ID = 'HLU01'            and LOAIGIA_ID            in (select LOAIGIA_ID from TM_BANGGIA            where LOAIBANGGIA in            (select LOAIBANGGIA from TM_BANGGIA where LOAIGIA_ID = '3'  AND BENHVIEN_ID = 'HLU01')            and TAMNGUNG = '0')  AND BENHVIEN_ID = 'HLU01'            )]
2019-12-10 11:28:28,990 [1] DEBUG - Statement Id: [DAO00000_GetDICHVU_DONGIA_LOAIGIA] PreparedStatement : [select A.LOAIGIA_ID, A.BANGGIA_ID, A.GIAVON, A.TYLEVAT  as TYLE_VAT, A.TYLE_LOINHUAN,            A.DONGIA as DONGIA_DOANHTHU, NULL as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DICHVU_DONGIA A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '4135' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.LOAIGIA_ID = '9' and A.DICHVU_ID = '4135'            union            select A.LOAIGIA_ID, null as BANGGIA_ID, null as GIAVON, null as TYLE_VAT, null as TYLE_LOINHUAN,            null as DONGIA_DOANHTHU, C.DONGIA as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DOITUONG_GIADICHVU A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join TM_DICHVU_DONGIA C on C.LOAIGIA_ID = A.LOAIGIA_ID AND C.BENHVIEN_ID = 'HLU01'            and C.BANGGIA_ID = B.BANGGIA_ID and C.DICHVU_ID = A.DICHVU_ID            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '4135' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.DOITUONG_ID = '1'  and A.DICHVU_ID = '4135' and A.LOAIGIA_ID            in (select top 1 LOAIGIA_ID from TM_DOITUONG_LOAIGIA            where DOITUONG_ID = '1' and GIAHOTRO = '1'  AND BENHVIEN_ID = 'HLU01'            and LOAIGIA_ID            in (select LOAIGIA_ID from TM_BANGGIA            where LOAIBANGGIA in            (select LOAIBANGGIA from TM_BANGGIA where LOAIGIA_ID = '9'  AND BENHVIEN_ID = 'HLU01')            and TAMNGUNG = '0')  AND BENHVIEN_ID = 'HLU01'            )]
2019-12-10 11:28:29,139 [1] DEBUG - Statement Id: [DAO00000_GetDICHVU_DONGIA_LOAIGIA] PreparedStatement : [select A.LOAIGIA_ID, A.BANGGIA_ID, A.GIAVON, A.TYLEVAT  as TYLE_VAT, A.TYLE_LOINHUAN,            A.DONGIA as DONGIA_DOANHTHU, NULL as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DICHVU_DONGIA A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '4005' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.LOAIGIA_ID = '9' and A.DICHVU_ID = '4005'            union            select A.LOAIGIA_ID, null as BANGGIA_ID, null as GIAVON, null as TYLE_VAT, null as TYLE_LOINHUAN,            null as DONGIA_DOANHTHU, C.DONGIA as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DOITUONG_GIADICHVU A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join TM_DICHVU_DONGIA C on C.LOAIGIA_ID = A.LOAIGIA_ID AND C.BENHVIEN_ID = 'HLU01'            and C.BANGGIA_ID = B.BANGGIA_ID and C.DICHVU_ID = A.DICHVU_ID            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '4005' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.DOITUONG_ID = '1'  and A.DICHVU_ID = '4005' and A.LOAIGIA_ID            in (select top 1 LOAIGIA_ID from TM_DOITUONG_LOAIGIA            where DOITUONG_ID = '1' and GIAHOTRO = '1'  AND BENHVIEN_ID = 'HLU01'            and LOAIGIA_ID            in (select LOAIGIA_ID from TM_BANGGIA            where LOAIBANGGIA in            (select LOAIBANGGIA from TM_BANGGIA where LOAIGIA_ID = '9'  AND BENHVIEN_ID = 'HLU01')            and TAMNGUNG = '0')  AND BENHVIEN_ID = 'HLU01'            )]
2019-12-10 11:28:29,264 [1] DEBUG - Statement Id: [DAO00000_GetDICHVU_DONGIA_LOAIGIA] PreparedStatement : [select A.LOAIGIA_ID, A.BANGGIA_ID, A.GIAVON, A.TYLEVAT  as TYLE_VAT, A.TYLE_LOINHUAN,            A.DONGIA as DONGIA_DOANHTHU, NULL as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DICHVU_DONGIA A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '4017' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.LOAIGIA_ID = '3' and A.DICHVU_ID = '4017'            union            select A.LOAIGIA_ID, null as BANGGIA_ID, null as GIAVON, null as TYLE_VAT, null as TYLE_LOINHUAN,            null as DONGIA_DOANHTHU, C.DONGIA as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DOITUONG_GIADICHVU A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join TM_DICHVU_DONGIA C on C.LOAIGIA_ID = A.LOAIGIA_ID AND C.BENHVIEN_ID = 'HLU01'            and C.BANGGIA_ID = B.BANGGIA_ID and C.DICHVU_ID = A.DICHVU_ID            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '4017' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.DOITUONG_ID = '1'  and A.DICHVU_ID = '4017' and A.LOAIGIA_ID            in (select top 1 LOAIGIA_ID from TM_DOITUONG_LOAIGIA            where DOITUONG_ID = '1' and GIAHOTRO = '1'  AND BENHVIEN_ID = 'HLU01'            and LOAIGIA_ID            in (select LOAIGIA_ID from TM_BANGGIA            where LOAIBANGGIA in            (select LOAIBANGGIA from TM_BANGGIA where LOAIGIA_ID = '3'  AND BENHVIEN_ID = 'HLU01')            and TAMNGUNG = '0')  AND BENHVIEN_ID = 'HLU01'            )]
2019-12-10 11:28:29,381 [1] DEBUG - Statement Id: [DAO00000_GetDICHVU_DONGIA_LOAIGIA] PreparedStatement : [select A.LOAIGIA_ID, A.BANGGIA_ID, A.GIAVON, A.TYLEVAT  as TYLE_VAT, A.TYLE_LOINHUAN,            A.DONGIA as DONGIA_DOANHTHU, NULL as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DICHVU_DONGIA A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '4524' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.LOAIGIA_ID = '3' and A.DICHVU_ID = '4524'            union            select A.LOAIGIA_ID, null as BANGGIA_ID, null as GIAVON, null as TYLE_VAT, null as TYLE_LOINHUAN,            null as DONGIA_DOANHTHU, C.DONGIA as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DOITUONG_GIADICHVU A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join TM_DICHVU_DONGIA C on C.LOAIGIA_ID = A.LOAIGIA_ID AND C.BENHVIEN_ID = 'HLU01'            and C.BANGGIA_ID = B.BANGGIA_ID and C.DICHVU_ID = A.DICHVU_ID            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '4524' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.DOITUONG_ID = '1'  and A.DICHVU_ID = '4524' and A.LOAIGIA_ID            in (select top 1 LOAIGIA_ID from TM_DOITUONG_LOAIGIA            where DOITUONG_ID = '1' and GIAHOTRO = '1'  AND BENHVIEN_ID = 'HLU01'            and LOAIGIA_ID            in (select LOAIGIA_ID from TM_BANGGIA            where LOAIBANGGIA in            (select LOAIBANGGIA from TM_BANGGIA where LOAIGIA_ID = '3'  AND BENHVIEN_ID = 'HLU01')            and TAMNGUNG = '0')  AND BENHVIEN_ID = 'HLU01'            )]
2019-12-10 11:28:29,512 [1] DEBUG - Statement Id: [DAO00000_GetDICHVU_DONGIA_LOAIGIA] PreparedStatement : [select A.LOAIGIA_ID, A.BANGGIA_ID, A.GIAVON, A.TYLEVAT  as TYLE_VAT, A.TYLE_LOINHUAN,            A.DONGIA as DONGIA_DOANHTHU, NULL as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DICHVU_DONGIA A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '4747' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.LOAIGIA_ID = '3' and A.DICHVU_ID = '4747'            union            select A.LOAIGIA_ID, null as BANGGIA_ID, null as GIAVON, null as TYLE_VAT, null as TYLE_LOINHUAN,            null as DONGIA_DOANHTHU, C.DONGIA as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DOITUONG_GIADICHVU A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join TM_DICHVU_DONGIA C on C.LOAIGIA_ID = A.LOAIGIA_ID AND C.BENHVIEN_ID = 'HLU01'            and C.BANGGIA_ID = B.BANGGIA_ID and C.DICHVU_ID = A.DICHVU_ID            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '4747' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.DOITUONG_ID = '1'  and A.DICHVU_ID = '4747' and A.LOAIGIA_ID            in (select top 1 LOAIGIA_ID from TM_DOITUONG_LOAIGIA            where DOITUONG_ID = '1' and GIAHOTRO = '1'  AND BENHVIEN_ID = 'HLU01'            and LOAIGIA_ID            in (select LOAIGIA_ID from TM_BANGGIA            where LOAIBANGGIA in            (select LOAIBANGGIA from TM_BANGGIA where LOAIGIA_ID = '3'  AND BENHVIEN_ID = 'HLU01')            and TAMNGUNG = '0')  AND BENHVIEN_ID = 'HLU01'            )]
2019-12-10 11:28:46,201 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MKT03'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 11:28:46,589 [1] DEBUG - Statement Id: [DAO00041_GetList] PreparedStatement : [declare @ManhomDSA varchar(10);            declare @PhanLoaiNhomDV varchar(20) = '01,02,03,04,06,20';            select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'            if (@ManhomDSA is not null and '05' in (select * from STRING_SPLIT('01,02,03,04,06,20', ',')))             set @PhanLoaiNhomDV += ',' + @ManhomDSA              select * from            (select dv.*, ndv.LOAIDICHVU_ID, ndv.MANHOMDICHVU, ndv.TENNHOMDICHVU as TENNHOMDICHVU,            ndv.TENKHONGDAU as TENNDVKHONGDAU, ndv.TENNHOMDICHVU_EN, ndv.TENNHOMDICHVU_RU,            CASE            WHEN @ManhomDSA is not null and ndv.MANHOMDICHVU in (@ManhomDSA) THEN ndv.MANHOMDICHVU            WHEN Left(ndv.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(ndv.MANHOMDICHVU,2)            END AS PHANLOAI_MANHOMDICHVU            from TM_DICHVU dv            left join TM_NHOMDICHVU ndv on dv.NHOMDICHVU_ID = ndv.NHOMDICHVU_ID                           where ndv.TAMNGUNG = '0' and dv.TAMNGUNG = '0' and dv.BENHVIEN_ID = 'HLU01') as tbl                 where                         PHANLOAI_MANHOMDICHVU in (select * from STRING_SPLIT(@PhanLoaiNhomDV,','))]
2019-12-10 11:28:57,544 [1] DEBUG - Statement Id: [DAO00099_GetListLoaiGoiDV] PreparedStatement : [select * from LST_DICTIONARY        where        DICTIONARY_TYPE_CODE = 'LoaiGoiDV']
--------------------------------------------------------------------------------
2019-12-10 15:25:51,422 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2019-12-10 15:25:52,289 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-12-10 15:25:52,372 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-12-10 15:25:53,257 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 15:25:54,135 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-12-10 15:27:34,283 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2019-12-10 15:27:34,321 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-12-10 15:27:40,150 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-12-10 15:27:40,322 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-12-10 15:27:41,556 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2019-12-10 15:27:42,353 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2019-12-10 15:27:43,353 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2019-12-10 15:27:43,426 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2019-12-10 15:27:43,521 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2019-12-10 15:27:43,594 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2019-12-10 15:27:43,670 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2019-12-10 15:27:43,744 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2019-12-10 15:27:43,847 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2019-12-10 15:27:44,445 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2019-12-10 15:27:44,478 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2019-12-10 15:27:44,544 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2019-12-10 15:27:44,578 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2019-12-10 15:27:46,947 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2019-12-10 15:27:46,979 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @NGUONDUOC_MACDINH varchar(5) = '0';        declare @TOAMUANGOAI int = 0;        select @NGUONDUOC_MACDINH = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'PHA_NGUONDUOC'        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + @NGUONDUOC_MACDINH as DUOC_KEY, 0 as PHAMVI_ID, @NGUONDUOC_MACDINH as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end        else        begin                  select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2019-12-10 15:27:51,521 [5] DEBUG - Statement Id: [DAO00320_GetList] PreparedStatement : [select M.*            from TM_MAU M            LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID            where            M.TAMNGUNG = '0'            and M.BENHVIEN_ID = 'HLU01'            order by M.TENMAU]
2019-12-10 15:27:51,586 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2019-12-10 15:27:51,628 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,        SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH        FROM TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID        WHERE TK.SOLUONG > 0        GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2019-12-10 15:27:51,701 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2019-12-10 15:27:51,732 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,        TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,        TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH        from TM_MAU M        JOIN        (        select        A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO        from        (        select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO        from TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'        where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0        ) A        )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2019-12-10 15:27:51,868 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2019-12-10 15:27:52,778 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 15:27:54,837 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2019-12-10 15:28:02,497 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2019-12-10 15:28:02,664 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2019-12-10 15:28:03,466 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 15:28:03,649 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 15:28:03,905 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2019-12-10 15:28:03,907 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-12-10 15:28:03,907 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-12-10 15:28:03,936 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2019-12-10 15:28:03,936 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-12-10 15:28:03,936 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-12-10 15:28:04,112 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 15:28:04,455 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 15:28:22,914 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 15:28:24,054 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2019-12-10 15:28:24,680 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2019-12-10 15:28:50,808 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MKT03'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
--------------------------------------------------------------------------------
2019-12-10 15:32:32,379 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2019-12-10 15:32:32,653 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-12-10 15:32:32,698 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-12-10 15:32:33,083 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 15:32:34,160 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-12-10 15:34:06,418 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2019-12-10 15:34:06,528 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-12-10 15:34:07,958 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-12-10 15:34:08,111 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-12-10 15:34:09,064 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2019-12-10 15:34:09,278 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2019-12-10 15:34:09,351 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2019-12-10 15:34:09,425 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2019-12-10 15:34:09,498 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2019-12-10 15:34:09,584 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2019-12-10 15:34:09,676 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2019-12-10 15:34:09,748 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2019-12-10 15:34:09,819 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2019-12-10 15:34:10,313 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2019-12-10 15:34:10,348 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2019-12-10 15:34:10,421 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2019-12-10 15:34:10,454 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2019-12-10 15:34:11,188 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2019-12-10 15:34:11,220 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @NGUONDUOC_MACDINH varchar(5) = '0';        declare @TOAMUANGOAI int = 0;        select @NGUONDUOC_MACDINH = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'PHA_NGUONDUOC'        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + @NGUONDUOC_MACDINH as DUOC_KEY, 0 as PHAMVI_ID, @NGUONDUOC_MACDINH as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end        else        begin                  select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2019-12-10 15:34:14,285 [5] DEBUG - Statement Id: [DAO00320_GetList] PreparedStatement : [select M.*            from TM_MAU M            LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID            where            M.TAMNGUNG = '0'            and M.BENHVIEN_ID = 'HLU01'            order by M.TENMAU]
2019-12-10 15:34:14,346 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2019-12-10 15:34:14,380 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,        SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH        FROM TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID        WHERE TK.SOLUONG > 0        GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2019-12-10 15:34:14,445 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2019-12-10 15:34:14,476 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,        TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,        TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH        from TM_MAU M        JOIN        (        select        A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO        from        (        select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO        from TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'        where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0        ) A        )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2019-12-10 15:34:14,544 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2019-12-10 15:34:15,460 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 15:34:16,168 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2019-12-10 15:34:20,249 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2019-12-10 15:34:20,286 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2019-12-10 15:34:20,366 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 15:34:20,487 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 15:34:20,613 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2019-12-10 15:34:20,615 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-12-10 15:34:20,615 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-12-10 15:34:20,662 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2019-12-10 15:34:20,662 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-12-10 15:34:20,662 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-12-10 15:34:20,784 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 15:34:20,946 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 15:34:34,892 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 15:34:34,977 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2019-12-10 15:34:35,190 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2019-12-10 15:35:01,302 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'HSM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 15:35:03,811 [1] DEBUG - Statement Id: [DAO00099_GetListLoaiGoiDV] PreparedStatement : [select * from LST_DICTIONARY        where        DICTIONARY_TYPE_CODE = 'LoaiGoiDV']
2019-12-10 15:35:04,302 [1] DEBUG - Statement Id: [DAO00017_GetDanhSachNoiThucHien] PreparedStatement : [select pb.PHONGBAN_ID, pb.TENPHONGBAN              from [TM_PHONGBAN] as pb              left join LST_DICTIONARY dic on pb.LOAIPHONGBAN_ID = dic.DICTIONARY_ID              where pb.BENHVIEN_ID = 'HLU01'                          and dic.DICTIONARY_TYPE_CODE = 'LoaiPhongBan'            and dic.DICTIONARY_CODE in ('KhamBenh','PhongBenh','KhoaNoi','PhongMo','KhoaDuoc','KhoaCLS', 'KhoaNgoai')]
2019-12-10 15:36:26,309 [1] DEBUG - Statement Id: [DAO00099_GetLoaiGiaDichVu] PreparedStatement : [select A.LOAIGIA_ID,B.TENLOAIGIA, B.MALOAIGIA        from TM_DICHVU_DONGIA A        inner join TM_LOAIGIA B on A.LOAIGIA_ID = B.LOAIGIA_ID        inner join LST_DICTIONARY AS DIC ON DIC.DICTIONARY_ID = B.NHOMGIA_ID AND DIC.DICTIONARY_TYPE_CODE = 'NhomGia'        where A.DICHVU_ID = '5685' and A.BENHVIEN_ID = 'HLU01' and DIC.DICTIONARY_CODE != 'BHYT']
2019-12-10 15:36:30,068 [1] DEBUG - Statement Id: [DAO00000_GetDONGIA_BY_DICHVU_LOAIGIA] PreparedStatement : [SELECT DD.*              FROM TM_DICHVU_DONGIA DD              WHERE DD.DICHVU_ID = '5685' AND DD.LOAIGIA_ID = '3' AND DD.BENHVIEN_ID = 'HLU01' AND DD.TAMNGUNG = '0']
2019-12-10 15:36:30,124 [1] DEBUG - Statement Id: [DAO00000_GetDONGIA_BY_DICHVU_LOAIGIA] PreparedStatement : [SELECT DD.*              FROM TM_DICHVU_DONGIA DD              WHERE DD.DICHVU_ID = '5685' AND DD.LOAIGIA_ID = '3' AND DD.BENHVIEN_ID = 'HLU01' AND DD.TAMNGUNG = '0']
2019-12-10 16:13:00,866 [1] DEBUG - Statement Id: [DAO00099_GetLoaiGiaDichVu] PreparedStatement : [select A.LOAIGIA_ID,B.TENLOAIGIA, B.MALOAIGIA        from TM_DICHVU_DONGIA A        inner join TM_LOAIGIA B on A.LOAIGIA_ID = B.LOAIGIA_ID        inner join LST_DICTIONARY AS DIC ON DIC.DICTIONARY_ID = B.NHOMGIA_ID AND DIC.DICTIONARY_TYPE_CODE = 'NhomGia'        where A.DICHVU_ID = '5435' and A.BENHVIEN_ID = 'HLU01' and DIC.DICTIONARY_CODE != 'BHYT']
--------------------------------------------------------------------------------
2019-12-10 16:43:50,418 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2019-12-10 16:43:50,744 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-12-10 16:43:50,784 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-12-10 16:43:51,349 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 16:43:51,793 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-12-10 16:45:29,503 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2019-12-10 16:45:29,530 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-12-10 16:45:32,538 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-12-10 16:45:32,757 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-12-10 16:45:33,866 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2019-12-10 16:45:34,754 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2019-12-10 16:45:34,889 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2019-12-10 16:45:34,966 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2019-12-10 16:45:35,062 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2019-12-10 16:45:35,133 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2019-12-10 16:45:35,209 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2019-12-10 16:45:35,318 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2019-12-10 16:45:35,403 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2019-12-10 16:45:35,983 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2019-12-10 16:45:36,026 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2019-12-10 16:45:36,095 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2019-12-10 16:45:36,127 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2019-12-10 16:45:36,908 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2019-12-10 16:45:36,937 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @NGUONDUOC_MACDINH varchar(5) = '0';        declare @TOAMUANGOAI int = 0;        select @NGUONDUOC_MACDINH = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'PHA_NGUONDUOC'        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + @NGUONDUOC_MACDINH as DUOC_KEY, 0 as PHAMVI_ID, @NGUONDUOC_MACDINH as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end        else        begin                  select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2019-12-10 16:45:38,790 [5] DEBUG - Statement Id: [DAO00320_GetList] PreparedStatement : [select M.*            from TM_MAU M            LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID            where            M.TAMNGUNG = '0'            and M.BENHVIEN_ID = 'HLU01'            order by M.TENMAU]
2019-12-10 16:45:38,849 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2019-12-10 16:45:38,882 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,        SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH        FROM TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID        WHERE TK.SOLUONG > 0        GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2019-12-10 16:45:38,949 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2019-12-10 16:45:38,979 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,        TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,        TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH        from TM_MAU M        JOIN        (        select        A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO        from        (        select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO        from TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'        where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0        ) A        )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2019-12-10 16:45:39,043 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2019-12-10 16:45:39,945 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 16:45:41,465 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2019-12-10 16:45:47,569 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2019-12-10 16:45:47,597 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2019-12-10 16:45:47,691 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 16:45:47,819 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 16:45:47,998 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2019-12-10 16:45:48,017 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-12-10 16:45:48,017 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-12-10 16:45:48,050 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2019-12-10 16:45:48,050 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-12-10 16:45:48,050 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-12-10 16:45:48,232 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 16:45:48,570 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 16:46:06,991 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 16:46:07,077 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2019-12-10 16:46:07,357 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2019-12-10 16:49:53,061 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'HSM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 16:49:55,423 [1] DEBUG - Statement Id: [DAO00099_GetListLoaiGoiDV] PreparedStatement : [select * from LST_DICTIONARY        where        DICTIONARY_TYPE_CODE = 'LoaiGoiDV']
2019-12-10 16:49:55,769 [1] DEBUG - Statement Id: [DAO00017_GetDanhSachNoiThucHien] PreparedStatement : [select pb.PHONGBAN_ID, pb.TENPHONGBAN              from [TM_PHONGBAN] as pb              left join LST_DICTIONARY dic on pb.LOAIPHONGBAN_ID = dic.DICTIONARY_ID              where pb.BENHVIEN_ID = 'HLU01'                          and dic.DICTIONARY_TYPE_CODE = 'LoaiPhongBan'            and dic.DICTIONARY_CODE in ('KhamBenh','PhongBenh','KhoaNoi','PhongMo','KhoaDuoc','KhoaCLS', 'KhoaNgoai')]
2019-12-10 16:51:50,912 [1] DEBUG - Statement Id: [DAO00099_GetLoaiGiaDichVu] PreparedStatement : [select A.LOAIGIA_ID,B.TENLOAIGIA, B.MALOAIGIA        from TM_DICHVU_DONGIA A        inner join TM_LOAIGIA B on A.LOAIGIA_ID = B.LOAIGIA_ID        inner join LST_DICTIONARY AS DIC ON DIC.DICTIONARY_ID = B.NHOMGIA_ID AND DIC.DICTIONARY_TYPE_CODE = 'NhomGia'        where A.DICHVU_ID = '5435' and A.BENHVIEN_ID = 'HLU01' and DIC.DICTIONARY_CODE != 'BHYT']
2019-12-10 16:52:24,267 [1] DEBUG - Statement Id: [DAO00099_GetLoaiGiaDichVu] PreparedStatement : [select A.LOAIGIA_ID,B.TENLOAIGIA, B.MALOAIGIA        from TM_DICHVU_DONGIA A        inner join TM_LOAIGIA B on A.LOAIGIA_ID = B.LOAIGIA_ID        inner join LST_DICTIONARY AS DIC ON DIC.DICTIONARY_ID = B.NHOMGIA_ID AND DIC.DICTIONARY_TYPE_CODE = 'NhomGia'        where A.DICHVU_ID = '5435' and A.BENHVIEN_ID = 'HLU01' and DIC.DICTIONARY_CODE != 'BHYT']
2019-12-10 16:58:16,564 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM98'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 16:58:23,163 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2019-12-10 16:58:23,316 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-12-10 16:58:23,341 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-12-10 16:58:23,473 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 16:58:23,564 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-12-10 16:59:24,791 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2019-12-10 16:59:24,816 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-12-10 16:59:26,078 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-12-10 16:59:26,157 [13] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-12-10 16:59:26,684 [13] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2019-12-10 16:59:26,832 [13] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2019-12-10 16:59:26,912 [13] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2019-12-10 16:59:26,986 [13] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2019-12-10 16:59:27,115 [13] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2019-12-10 16:59:27,215 [13] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2019-12-10 16:59:27,515 [13] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2019-12-10 16:59:27,586 [13] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2019-12-10 16:59:27,660 [13] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2019-12-10 16:59:28,150 [13] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2019-12-10 16:59:28,181 [13] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2019-12-10 16:59:28,253 [13] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2019-12-10 16:59:28,288 [13] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2019-12-10 16:59:29,041 [13] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2019-12-10 16:59:29,070 [13] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @NGUONDUOC_MACDINH varchar(5) = '0';        declare @TOAMUANGOAI int = 0;        select @NGUONDUOC_MACDINH = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'PHA_NGUONDUOC'        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + @NGUONDUOC_MACDINH as DUOC_KEY, 0 as PHAMVI_ID, @NGUONDUOC_MACDINH as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end        else        begin                  select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2019-12-10 16:59:30,991 [13] DEBUG - Statement Id: [DAO00320_GetList] PreparedStatement : [select M.*            from TM_MAU M            LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID            where            M.TAMNGUNG = '0'            and M.BENHVIEN_ID = 'HLU01'            order by M.TENMAU]
2019-12-10 16:59:31,072 [13] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2019-12-10 16:59:31,101 [13] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,        SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH        FROM TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID        WHERE TK.SOLUONG > 0        GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2019-12-10 16:59:31,173 [13] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2019-12-10 16:59:31,229 [13] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,        TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,        TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH        from TM_MAU M        JOIN        (        select        A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO        from        (        select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO        from TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'        where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0        ) A        )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2019-12-10 16:59:31,307 [13] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2019-12-10 16:59:32,214 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 16:59:32,312 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2019-12-10 16:59:32,358 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2019-12-10 16:59:32,382 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2019-12-10 16:59:32,461 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 16:59:32,546 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 16:59:32,617 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2019-12-10 16:59:32,617 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-12-10 16:59:32,617 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-12-10 16:59:32,644 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2019-12-10 16:59:32,644 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-12-10 16:59:32,644 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-12-10 16:59:32,729 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 16:59:32,839 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 16:59:42,156 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 16:59:42,221 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2019-12-10 16:59:42,419 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2019-12-10 16:59:47,391 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'HSM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 16:59:48,753 [1] DEBUG - Statement Id: [DAO00099_GetListLoaiGoiDV] PreparedStatement : [select * from LST_DICTIONARY        where        DICTIONARY_TYPE_CODE = 'LoaiGoiDV']
2019-12-10 16:59:48,965 [1] DEBUG - Statement Id: [DAO00017_GetDanhSachNoiThucHien] PreparedStatement : [select pb.PHONGBAN_ID, pb.TENPHONGBAN              from [TM_PHONGBAN] as pb              left join LST_DICTIONARY dic on pb.LOAIPHONGBAN_ID = dic.DICTIONARY_ID              where pb.BENHVIEN_ID = 'HLU01'                          and dic.DICTIONARY_TYPE_CODE = 'LoaiPhongBan'            and dic.DICTIONARY_CODE in ('KhamBenh','PhongBenh','KhoaNoi','PhongMo','KhoaDuoc','KhoaCLS', 'KhoaNgoai')]
2019-12-10 16:59:57,662 [1] DEBUG - Statement Id: [DAO00099_GetLoaiGiaDichVu] PreparedStatement : [select A.LOAIGIA_ID,B.TENLOAIGIA, B.MALOAIGIA        from TM_DICHVU_DONGIA A        inner join TM_LOAIGIA B on A.LOAIGIA_ID = B.LOAIGIA_ID        inner join LST_DICTIONARY AS DIC ON DIC.DICTIONARY_ID = B.NHOMGIA_ID AND DIC.DICTIONARY_TYPE_CODE = 'NhomGia'        where A.DICHVU_ID = '5435' and A.BENHVIEN_ID = 'HLU01' and DIC.DICTIONARY_CODE != 'BHYT']
--------------------------------------------------------------------------------
2019-12-10 17:02:59,004 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2019-12-10 17:02:59,232 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-12-10 17:02:59,264 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-12-10 17:02:59,684 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 17:02:59,983 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-12-10 17:03:07,270 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2019-12-10 17:03:07,297 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-12-10 17:03:08,861 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-12-10 17:03:08,948 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-12-10 17:03:09,744 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2019-12-10 17:03:09,928 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2019-12-10 17:03:10,105 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2019-12-10 17:03:10,185 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2019-12-10 17:03:10,283 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2019-12-10 17:03:10,351 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2019-12-10 17:03:10,425 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2019-12-10 17:03:10,498 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2019-12-10 17:03:10,567 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2019-12-10 17:03:11,279 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2019-12-10 17:03:11,330 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2019-12-10 17:03:11,428 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2019-12-10 17:03:11,478 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2019-12-10 17:03:12,206 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2019-12-10 17:03:12,237 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @NGUONDUOC_MACDINH varchar(5) = '0';        declare @TOAMUANGOAI int = 0;        select @NGUONDUOC_MACDINH = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'PHA_NGUONDUOC'        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + @NGUONDUOC_MACDINH as DUOC_KEY, 0 as PHAMVI_ID, @NGUONDUOC_MACDINH as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end        else        begin                  select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2019-12-10 17:03:14,355 [5] DEBUG - Statement Id: [DAO00320_GetList] PreparedStatement : [select M.*            from TM_MAU M            LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID            where            M.TAMNGUNG = '0'            and M.BENHVIEN_ID = 'HLU01'            order by M.TENMAU]
2019-12-10 17:03:14,433 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2019-12-10 17:03:14,464 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,        SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH        FROM TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID        WHERE TK.SOLUONG > 0        GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2019-12-10 17:03:14,577 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2019-12-10 17:03:14,618 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,        TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,        TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH        from TM_MAU M        JOIN        (        select        A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO        from        (        select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO        from TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'        where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0        ) A        )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2019-12-10 17:03:14,717 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2019-12-10 17:03:15,661 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 17:03:16,683 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2019-12-10 17:03:25,411 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2019-12-10 17:03:25,440 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2019-12-10 17:03:25,681 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 17:03:25,807 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 17:03:25,970 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2019-12-10 17:03:25,972 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-12-10 17:03:25,972 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-12-10 17:03:25,999 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2019-12-10 17:03:25,999 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-12-10 17:03:25,999 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-12-10 17:03:26,286 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 17:03:26,573 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 17:03:46,726 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 17:03:46,814 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2019-12-10 17:03:47,073 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2019-12-10 17:04:22,054 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'HSM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 17:04:23,896 [1] DEBUG - Statement Id: [DAO00099_GetListLoaiGoiDV] PreparedStatement : [select * from LST_DICTIONARY        where        DICTIONARY_TYPE_CODE = 'LoaiGoiDV']
2019-12-10 17:04:24,090 [1] DEBUG - Statement Id: [DAO00017_GetDanhSachNoiThucHien] PreparedStatement : [select pb.PHONGBAN_ID, pb.TENPHONGBAN              from [TM_PHONGBAN] as pb              left join LST_DICTIONARY dic on pb.LOAIPHONGBAN_ID = dic.DICTIONARY_ID              where pb.BENHVIEN_ID = 'HLU01'                          and dic.DICTIONARY_TYPE_CODE = 'LoaiPhongBan'            and dic.DICTIONARY_CODE in ('KhamBenh','PhongBenh','KhoaNoi','PhongMo','KhoaDuoc','KhoaCLS', 'KhoaNgoai')]
2019-12-10 17:05:03,937 [1] DEBUG - Statement Id: [DAO00099_GetLoaiGiaDichVu] PreparedStatement : [select A.LOAIGIA_ID,B.TENLOAIGIA, B.MALOAIGIA        from TM_DICHVU_DONGIA A        inner join TM_LOAIGIA B on A.LOAIGIA_ID = B.LOAIGIA_ID        inner join LST_DICTIONARY AS DIC ON DIC.DICTIONARY_ID = B.NHOMGIA_ID AND DIC.DICTIONARY_TYPE_CODE = 'NhomGia'        where A.DICHVU_ID = '5435' and A.BENHVIEN_ID = 'HLU01' and DIC.DICTIONARY_CODE != 'BHYT']
2019-12-10 17:05:24,417 [1] DEBUG - Statement Id: [DAO00000_GetDONGIA_BY_DICHVU_LOAIGIA] PreparedStatement : [SELECT DD.*              FROM TM_DICHVU_DONGIA DD              WHERE DD.DICHVU_ID = '5435' AND DD.LOAIGIA_ID = '3' AND DD.BENHVIEN_ID = 'HLU01' AND DD.TAMNGUNG = '0']
2019-12-10 17:05:24,467 [1] DEBUG - Statement Id: [DAO00000_GetDONGIA_BY_DICHVU_LOAIGIA] PreparedStatement : [SELECT DD.*              FROM TM_DICHVU_DONGIA DD              WHERE DD.DICHVU_ID = '5435' AND DD.LOAIGIA_ID = '3' AND DD.BENHVIEN_ID = 'HLU01' AND DD.TAMNGUNG = '0']
2019-12-10 17:05:41,577 [1] DEBUG - Statement Id: [DAO00099_GetLoaiGiaDichVu] PreparedStatement : [select A.LOAIGIA_ID,B.TENLOAIGIA, B.MALOAIGIA        from TM_DICHVU_DONGIA A        inner join TM_LOAIGIA B on A.LOAIGIA_ID = B.LOAIGIA_ID        inner join LST_DICTIONARY AS DIC ON DIC.DICTIONARY_ID = B.NHOMGIA_ID AND DIC.DICTIONARY_TYPE_CODE = 'NhomGia'        where A.DICHVU_ID = '5438' and A.BENHVIEN_ID = 'HLU01' and DIC.DICTIONARY_CODE != 'BHYT']
2019-12-10 17:05:44,255 [1] DEBUG - Statement Id: [DAO00000_GetDONGIA_BY_DICHVU_LOAIGIA] PreparedStatement : [SELECT DD.*              FROM TM_DICHVU_DONGIA DD              WHERE DD.DICHVU_ID = '5438' AND DD.LOAIGIA_ID = '3' AND DD.BENHVIEN_ID = 'HLU01' AND DD.TAMNGUNG = '0']
2019-12-10 17:05:44,348 [1] DEBUG - Statement Id: [DAO00000_GetDONGIA_BY_DICHVU_LOAIGIA] PreparedStatement : [SELECT DD.*              FROM TM_DICHVU_DONGIA DD              WHERE DD.DICHVU_ID = '5438' AND DD.LOAIGIA_ID = '3' AND DD.BENHVIEN_ID = 'HLU01' AND DD.TAMNGUNG = '0']
2019-12-10 17:06:06,127 [1] DEBUG - Statement Id: [DAO00099_GetLoaiGiaDichVu] PreparedStatement : [select A.LOAIGIA_ID,B.TENLOAIGIA, B.MALOAIGIA        from TM_DICHVU_DONGIA A        inner join TM_LOAIGIA B on A.LOAIGIA_ID = B.LOAIGIA_ID        inner join LST_DICTIONARY AS DIC ON DIC.DICTIONARY_ID = B.NHOMGIA_ID AND DIC.DICTIONARY_TYPE_CODE = 'NhomGia'        where A.DICHVU_ID = '4129' and A.BENHVIEN_ID = 'HLU01' and DIC.DICTIONARY_CODE != 'BHYT']
2019-12-10 17:06:11,567 [1] DEBUG - Statement Id: [DAO00000_GetDONGIA_BY_DICHVU_LOAIGIA] PreparedStatement : [SELECT DD.*              FROM TM_DICHVU_DONGIA DD              WHERE DD.DICHVU_ID = '4129' AND DD.LOAIGIA_ID = '3' AND DD.BENHVIEN_ID = 'HLU01' AND DD.TAMNGUNG = '0']
2019-12-10 17:06:11,610 [1] DEBUG - Statement Id: [DAO00000_GetDONGIA_BY_DICHVU_LOAIGIA] PreparedStatement : [SELECT DD.*              FROM TM_DICHVU_DONGIA DD              WHERE DD.DICHVU_ID = '4129' AND DD.LOAIGIA_ID = '3' AND DD.BENHVIEN_ID = 'HLU01' AND DD.TAMNGUNG = '0']
2019-12-10 17:06:33,172 [1] DEBUG - Statement Id: [DAO00099_GetLoaiGiaDichVu] PreparedStatement : [select A.LOAIGIA_ID,B.TENLOAIGIA, B.MALOAIGIA        from TM_DICHVU_DONGIA A        inner join TM_LOAIGIA B on A.LOAIGIA_ID = B.LOAIGIA_ID        inner join LST_DICTIONARY AS DIC ON DIC.DICTIONARY_ID = B.NHOMGIA_ID AND DIC.DICTIONARY_TYPE_CODE = 'NhomGia'        where A.DICHVU_ID = '4017' and A.BENHVIEN_ID = 'HLU01' and DIC.DICTIONARY_CODE != 'BHYT']
2019-12-10 17:06:36,851 [1] DEBUG - Statement Id: [DAO00000_GetDONGIA_BY_DICHVU_LOAIGIA] PreparedStatement : [SELECT DD.*              FROM TM_DICHVU_DONGIA DD              WHERE DD.DICHVU_ID = '4017' AND DD.LOAIGIA_ID = '3' AND DD.BENHVIEN_ID = 'HLU01' AND DD.TAMNGUNG = '0']
2019-12-10 17:06:36,893 [1] DEBUG - Statement Id: [DAO00000_GetDONGIA_BY_DICHVU_LOAIGIA] PreparedStatement : [SELECT DD.*              FROM TM_DICHVU_DONGIA DD              WHERE DD.DICHVU_ID = '4017' AND DD.LOAIGIA_ID = '3' AND DD.BENHVIEN_ID = 'HLU01' AND DD.TAMNGUNG = '0']
2019-12-10 17:07:09,784 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_Add] PreparedStatement : [INSERT INTO TM_CSKH_GOI             (MAGOI             ,TENGOI             ,LOAIGOI_ID             ,GIATRIGOI             ,GIATRICHUAGIAM             ,TYLEMIENGIAM             ,GIATRIMIENGIAM             ,NGAYBATDAUBAN             ,NGAYKETTHUCBAN             ,THOIGIANSUDUNG             ,NGAYHETHANTUYETDOI             ,MOTAGOI             ,LYDOHUY             ,LAGOIMAU             ,TRANGTHAI             ,NGAYDUYET             ,NGUOIDUYET_ID             ,BENHVIEN_ID             ,NGAYTAO             ,NGUOITAO_ID             ,NGAYCAPNHAT             ,NGUOICAPNHAT_ID)       VALUES             ( @param0              , @param1              , @param2              , @param3              , @param4              , @param5              , @param6              , @param7              , @param8              , @param9              , @param10              , @param11              , @param12              , @param13              , @param14              , @param15              , @param16              , @param17              , @param18              , @param19              , @param20              , @param21              )        select SCOPE_identity() as value]
2019-12-10 17:07:09,785 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_Add] Parameters: [@param0=[MAGOI,FPT01], @param1=[TENGOI,Gói KSK FPT 01], @param2=[LOAIGOI_ID,11675], @param3=[GIATRIGOI,1000000], @param4=[GIATRICHUAGIAM,220000], @param5=[TYLEMIENGIAM,454.545454545455], @param6=[GIATRIMIENGIAM,-780000], @param7=[NGAYBATDAUBAN,12/10/2019 12:00:00 AM], @param8=[NGAYKETTHUCBAN,12/31/2020 12:00:00 AM], @param9=[THOIGIANSUDUNG,365], @param10=[NGAYHETHANTUYETDOI,null], @param11=[MOTAGOI,test 1], @param12=[LYDOHUY,null], @param13=[LAGOIMAU,null], @param14=[TRANGTHAI,GOIDUOCPHEPBAN], @param15=[NGAYDUYET,null], @param16=[NGUOIDUYET_ID,null], @param17=[BENHVIEN_ID,HLU01], @param18=[NGAYTAO,12/10/2019 5:07:09 PM], @param19=[NGUOITAO_ID,1], @param20=[NGAYCAPNHAT,12/10/2019 5:07:09 PM], @param21=[NGUOICAPNHAT_ID,1]]
2019-12-10 17:07:09,785 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_Add] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[Int64, System.Int64], @param3=[Double, System.Double], @param4=[Double, System.Double], @param5=[Double, System.Double], @param6=[Decimal, System.Decimal], @param7=[DateTime, System.DateTime], @param8=[DateTime, System.DateTime], @param9=[Int64, System.Int64], @param10=[System.DBNull, null], @param11=[String, System.String], @param12=[System.DBNull, null], @param13=[System.DBNull, null], @param14=[String, System.String], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[String, System.String], @param18=[DateTime, System.DateTime], @param19=[Int64, System.Int64], @param20=[DateTime, System.DateTime], @param21=[Int64, System.Int64]]
2019-12-10 17:07:09,932 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_Add] PreparedStatement : [INSERT INTO TM_CSKH_GOI_CHITIET        (GOI_ID        ,DICHVU_ID        ,SOLAN        ,DONGIATRONGGOI        ,THANHTIENTRONGGOI        ,LOAIGIA_ID        ,GIAVON_DICHVU        ,GIAVAT_DICHVU        ,MOTA        ,TINHTRANG        ,BENHVIEN_ID        ,NGAYTAO        ,NGUOITAO_ID        ,NGAYCAPNHAT        ,NGUOICAPNHAT_ID                     , NOITHUCHIEN_ID                     , BACSICHIDINH_ID                 )        VALUES        ( @param0         , @param1         , @param2         , @param3         , @param4         , @param5         , @param6         , @param7         , @param8         , @param9         , @param10         , @param11         , @param12         , @param13         , @param14                      ,  @param15                      ,  @param16                  )]
2019-12-10 17:07:09,932 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_Add] Parameters: [@param0=[GOI_ID,4], @param1=[DICHVU_ID,5435], @param2=[SOLAN,1], @param3=[DONGIATRONGGOI,227500], @param4=[THANHTIENTRONGGOI,227500], @param5=[LOAIGIA_ID,3], @param6=[GIAVON_DICHVU,null], @param7=[GIAVAT_DICHVU,null], @param8=[MOTA,null], @param9=[TINHTRANG,null], @param10=[BENHVIEN_ID,HLU01], @param11=[NGAYTAO,12/10/2019 5:07:09 PM], @param12=[NGUOITAO_ID,1], @param13=[NGAYCAPNHAT,12/10/2019 5:07:09 PM], @param14=[NGUOICAPNHAT_ID,1], @param15=[NOITHUCHIEN_ID,177], @param16=[BACSICHIDINH_ID,32]]
2019-12-10 17:07:09,932 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_Add] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64], @param2=[Int64, System.Int64], @param3=[Double, System.Double], @param4=[Double, System.Double], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[System.DBNull, null], @param8=[System.DBNull, null], @param9=[System.DBNull, null], @param10=[String, System.String], @param11=[DateTime, System.DateTime], @param12=[Int64, System.Int64], @param13=[DateTime, System.DateTime], @param14=[Int64, System.Int64], @param15=[Int64, System.Int64], @param16=[Int64, System.Int64]]
2019-12-10 17:07:09,963 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_Add] PreparedStatement : [INSERT INTO TM_CSKH_GOI_CHITIET        (GOI_ID        ,DICHVU_ID        ,SOLAN        ,DONGIATRONGGOI        ,THANHTIENTRONGGOI        ,LOAIGIA_ID        ,GIAVON_DICHVU        ,GIAVAT_DICHVU        ,MOTA        ,TINHTRANG        ,BENHVIEN_ID        ,NGAYTAO        ,NGUOITAO_ID        ,NGAYCAPNHAT        ,NGUOICAPNHAT_ID                     , NOITHUCHIEN_ID                     , BACSICHIDINH_ID                 )        VALUES        ( @param0         , @param1         , @param2         , @param3         , @param4         , @param5         , @param6         , @param7         , @param8         , @param9         , @param10         , @param11         , @param12         , @param13         , @param14                      ,  @param15                      ,  @param16                  )]
2019-12-10 17:07:09,963 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_Add] Parameters: [@param0=[GOI_ID,4], @param1=[DICHVU_ID,5438], @param2=[SOLAN,1], @param3=[DONGIATRONGGOI,227500], @param4=[THANHTIENTRONGGOI,227500], @param5=[LOAIGIA_ID,3], @param6=[GIAVON_DICHVU,null], @param7=[GIAVAT_DICHVU,null], @param8=[MOTA,null], @param9=[TINHTRANG,null], @param10=[BENHVIEN_ID,HLU01], @param11=[NGAYTAO,12/10/2019 5:07:09 PM], @param12=[NGUOITAO_ID,1], @param13=[NGAYCAPNHAT,12/10/2019 5:07:09 PM], @param14=[NGUOICAPNHAT_ID,1], @param15=[NOITHUCHIEN_ID,64], @param16=[BACSICHIDINH_ID,32]]
2019-12-10 17:07:09,963 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_Add] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64], @param2=[Int64, System.Int64], @param3=[Double, System.Double], @param4=[Double, System.Double], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[System.DBNull, null], @param8=[System.DBNull, null], @param9=[System.DBNull, null], @param10=[String, System.String], @param11=[DateTime, System.DateTime], @param12=[Int64, System.Int64], @param13=[DateTime, System.DateTime], @param14=[Int64, System.Int64], @param15=[Int64, System.Int64], @param16=[Int64, System.Int64]]
2019-12-10 17:07:09,990 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_Add] PreparedStatement : [INSERT INTO TM_CSKH_GOI_CHITIET        (GOI_ID        ,DICHVU_ID        ,SOLAN        ,DONGIATRONGGOI        ,THANHTIENTRONGGOI        ,LOAIGIA_ID        ,GIAVON_DICHVU        ,GIAVAT_DICHVU        ,MOTA        ,TINHTRANG        ,BENHVIEN_ID        ,NGAYTAO        ,NGUOITAO_ID        ,NGAYCAPNHAT        ,NGUOICAPNHAT_ID                     , NOITHUCHIEN_ID                     , BACSICHIDINH_ID                 )        VALUES        ( @param0         , @param1         , @param2         , @param3         , @param4         , @param5         , @param6         , @param7         , @param8         , @param9         , @param10         , @param11         , @param12         , @param13         , @param14                      ,  @param15                      ,  @param16                  )]
2019-12-10 17:07:09,990 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_Add] Parameters: [@param0=[GOI_ID,4], @param1=[DICHVU_ID,4129], @param2=[SOLAN,1], @param3=[DONGIATRONGGOI,318500], @param4=[THANHTIENTRONGGOI,318500], @param5=[LOAIGIA_ID,3], @param6=[GIAVON_DICHVU,null], @param7=[GIAVAT_DICHVU,null], @param8=[MOTA,null], @param9=[TINHTRANG,null], @param10=[BENHVIEN_ID,HLU01], @param11=[NGAYTAO,12/10/2019 5:07:09 PM], @param12=[NGUOITAO_ID,1], @param13=[NGAYCAPNHAT,12/10/2019 5:07:09 PM], @param14=[NGUOICAPNHAT_ID,1], @param15=[NOITHUCHIEN_ID,79], @param16=[BACSICHIDINH_ID,32]]
2019-12-10 17:07:09,990 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_Add] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64], @param2=[Int64, System.Int64], @param3=[Double, System.Double], @param4=[Double, System.Double], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[System.DBNull, null], @param8=[System.DBNull, null], @param9=[System.DBNull, null], @param10=[String, System.String], @param11=[DateTime, System.DateTime], @param12=[Int64, System.Int64], @param13=[DateTime, System.DateTime], @param14=[Int64, System.Int64], @param15=[Int64, System.Int64], @param16=[Int64, System.Int64]]
2019-12-10 17:07:10,017 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_Add] PreparedStatement : [INSERT INTO TM_CSKH_GOI_CHITIET        (GOI_ID        ,DICHVU_ID        ,SOLAN        ,DONGIATRONGGOI        ,THANHTIENTRONGGOI        ,LOAIGIA_ID        ,GIAVON_DICHVU        ,GIAVAT_DICHVU        ,MOTA        ,TINHTRANG        ,BENHVIEN_ID        ,NGAYTAO        ,NGUOITAO_ID        ,NGAYCAPNHAT        ,NGUOICAPNHAT_ID                     , NOITHUCHIEN_ID                     , BACSICHIDINH_ID                 )        VALUES        ( @param0         , @param1         , @param2         , @param3         , @param4         , @param5         , @param6         , @param7         , @param8         , @param9         , @param10         , @param11         , @param12         , @param13         , @param14                      ,  @param15                      ,  @param16                  )]
2019-12-10 17:07:10,017 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_Add] Parameters: [@param0=[GOI_ID,4], @param1=[DICHVU_ID,4017], @param2=[SOLAN,1], @param3=[DONGIATRONGGOI,226500], @param4=[THANHTIENTRONGGOI,226500], @param5=[LOAIGIA_ID,3], @param6=[GIAVON_DICHVU,null], @param7=[GIAVAT_DICHVU,null], @param8=[MOTA,null], @param9=[TINHTRANG,null], @param10=[BENHVIEN_ID,HLU01], @param11=[NGAYTAO,12/10/2019 5:07:10 PM], @param12=[NGUOITAO_ID,1], @param13=[NGAYCAPNHAT,12/10/2019 5:07:10 PM], @param14=[NGUOICAPNHAT_ID,1], @param15=[NOITHUCHIEN_ID,91], @param16=[BACSICHIDINH_ID,32]]
2019-12-10 17:07:10,017 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_Add] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64], @param2=[Int64, System.Int64], @param3=[Double, System.Double], @param4=[Double, System.Double], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[System.DBNull, null], @param8=[System.DBNull, null], @param9=[System.DBNull, null], @param10=[String, System.String], @param11=[DateTime, System.DateTime], @param12=[Int64, System.Int64], @param13=[DateTime, System.DateTime], @param14=[Int64, System.Int64], @param15=[Int64, System.Int64], @param16=[Int64, System.Int64]]
2019-12-10 17:07:14,855 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MKT15'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 17:07:15,236 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_GetList] PreparedStatement : [select * from TM_CSKH_GOI A         where               A.TRANGTHAI = 'GOIDUOCPHEPBAN'           and             convert(date,A.NGAYTAO) between convert(date, '12/10/2019 5:07:15 PM') and convert(date, '12/10/2019 5:07:15 PM')           and             A.BENHVIEN_ID = 'HLU01']
2019-12-10 17:07:16,577 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_Get] PreparedStatement : [select A.*, B.SOLANSUDUNG        from TM_CSKH_GOI A        left join        (select count(*) as SOLANSUDUNG, GOI_ID        from TT_CSKH_GOI_DANGKY        group by GOI_ID        )B on B.GOI_ID = a.GOI_ID         where               A.GOI_ID = '4'           and             A.BENHVIEN_ID = 'HLU01']
2019-12-10 17:07:16,635 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_GetDetail] PreparedStatement : [select A.*, DV.MADICHVU from TM_CSKH_GOI_CHITIET A        left join TM_DICHVU dv on dv.DICHVU_ID = A.DICHVU_ID         where                 A.GOI_ID = '4'             and               A.BENHVIEN_ID = 'HLU01']
2019-12-10 17:07:17,007 [1] DEBUG - Statement Id: [DAO00000_GetDICHVU_DONGIA_LOAIGIA] PreparedStatement : [select A.LOAIGIA_ID, A.BANGGIA_ID, A.GIAVON, A.TYLEVAT  as TYLE_VAT, A.TYLE_LOINHUAN,            A.DONGIA as DONGIA_DOANHTHU, NULL as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DICHVU_DONGIA A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '5435' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.LOAIGIA_ID = '3' and A.DICHVU_ID = '5435'            union            select A.LOAIGIA_ID, null as BANGGIA_ID, null as GIAVON, null as TYLE_VAT, null as TYLE_LOINHUAN,            null as DONGIA_DOANHTHU, C.DONGIA as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DOITUONG_GIADICHVU A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join TM_DICHVU_DONGIA C on C.LOAIGIA_ID = A.LOAIGIA_ID AND C.BENHVIEN_ID = 'HLU01'            and C.BANGGIA_ID = B.BANGGIA_ID and C.DICHVU_ID = A.DICHVU_ID            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '5435' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.DOITUONG_ID = '1'  and A.DICHVU_ID = '5435' and A.LOAIGIA_ID            in (select top 1 LOAIGIA_ID from TM_DOITUONG_LOAIGIA            where DOITUONG_ID = '1' and GIAHOTRO = '1'  AND BENHVIEN_ID = 'HLU01'            and LOAIGIA_ID            in (select LOAIGIA_ID from TM_BANGGIA            where LOAIBANGGIA in            (select LOAIBANGGIA from TM_BANGGIA where LOAIGIA_ID = '3'  AND BENHVIEN_ID = 'HLU01')            and TAMNGUNG = '0')  AND BENHVIEN_ID = 'HLU01'            )]
2019-12-10 17:07:17,041 [1] DEBUG - Statement Id: [DAO00000_GetDICHVU_DONGIA_LOAIGIA] PreparedStatement : [select A.LOAIGIA_ID, A.BANGGIA_ID, A.GIAVON, A.TYLEVAT  as TYLE_VAT, A.TYLE_LOINHUAN,            A.DONGIA as DONGIA_DOANHTHU, NULL as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DICHVU_DONGIA A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '5438' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.LOAIGIA_ID = '3' and A.DICHVU_ID = '5438'            union            select A.LOAIGIA_ID, null as BANGGIA_ID, null as GIAVON, null as TYLE_VAT, null as TYLE_LOINHUAN,            null as DONGIA_DOANHTHU, C.DONGIA as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DOITUONG_GIADICHVU A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join TM_DICHVU_DONGIA C on C.LOAIGIA_ID = A.LOAIGIA_ID AND C.BENHVIEN_ID = 'HLU01'            and C.BANGGIA_ID = B.BANGGIA_ID and C.DICHVU_ID = A.DICHVU_ID            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '5438' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.DOITUONG_ID = '1'  and A.DICHVU_ID = '5438' and A.LOAIGIA_ID            in (select top 1 LOAIGIA_ID from TM_DOITUONG_LOAIGIA            where DOITUONG_ID = '1' and GIAHOTRO = '1'  AND BENHVIEN_ID = 'HLU01'            and LOAIGIA_ID            in (select LOAIGIA_ID from TM_BANGGIA            where LOAIBANGGIA in            (select LOAIBANGGIA from TM_BANGGIA where LOAIGIA_ID = '3'  AND BENHVIEN_ID = 'HLU01')            and TAMNGUNG = '0')  AND BENHVIEN_ID = 'HLU01'            )]
2019-12-10 17:07:17,074 [1] DEBUG - Statement Id: [DAO00000_GetDICHVU_DONGIA_LOAIGIA] PreparedStatement : [select A.LOAIGIA_ID, A.BANGGIA_ID, A.GIAVON, A.TYLEVAT  as TYLE_VAT, A.TYLE_LOINHUAN,            A.DONGIA as DONGIA_DOANHTHU, NULL as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DICHVU_DONGIA A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '4129' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.LOAIGIA_ID = '3' and A.DICHVU_ID = '4129'            union            select A.LOAIGIA_ID, null as BANGGIA_ID, null as GIAVON, null as TYLE_VAT, null as TYLE_LOINHUAN,            null as DONGIA_DOANHTHU, C.DONGIA as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DOITUONG_GIADICHVU A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join TM_DICHVU_DONGIA C on C.LOAIGIA_ID = A.LOAIGIA_ID AND C.BENHVIEN_ID = 'HLU01'            and C.BANGGIA_ID = B.BANGGIA_ID and C.DICHVU_ID = A.DICHVU_ID            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '4129' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.DOITUONG_ID = '1'  and A.DICHVU_ID = '4129' and A.LOAIGIA_ID            in (select top 1 LOAIGIA_ID from TM_DOITUONG_LOAIGIA            where DOITUONG_ID = '1' and GIAHOTRO = '1'  AND BENHVIEN_ID = 'HLU01'            and LOAIGIA_ID            in (select LOAIGIA_ID from TM_BANGGIA            where LOAIBANGGIA in            (select LOAIBANGGIA from TM_BANGGIA where LOAIGIA_ID = '3'  AND BENHVIEN_ID = 'HLU01')            and TAMNGUNG = '0')  AND BENHVIEN_ID = 'HLU01'            )]
2019-12-10 17:07:17,167 [1] DEBUG - Statement Id: [DAO00000_GetDICHVU_DONGIA_LOAIGIA] PreparedStatement : [select A.LOAIGIA_ID, A.BANGGIA_ID, A.GIAVON, A.TYLEVAT  as TYLE_VAT, A.TYLE_LOINHUAN,            A.DONGIA as DONGIA_DOANHTHU, NULL as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DICHVU_DONGIA A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '4017' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.LOAIGIA_ID = '3' and A.DICHVU_ID = '4017'            union            select A.LOAIGIA_ID, null as BANGGIA_ID, null as GIAVON, null as TYLE_VAT, null as TYLE_LOINHUAN,            null as DONGIA_DOANHTHU, C.DONGIA as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DOITUONG_GIADICHVU A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join TM_DICHVU_DONGIA C on C.LOAIGIA_ID = A.LOAIGIA_ID AND C.BENHVIEN_ID = 'HLU01'            and C.BANGGIA_ID = B.BANGGIA_ID and C.DICHVU_ID = A.DICHVU_ID            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '4017' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.DOITUONG_ID = '1'  and A.DICHVU_ID = '4017' and A.LOAIGIA_ID            in (select top 1 LOAIGIA_ID from TM_DOITUONG_LOAIGIA            where DOITUONG_ID = '1' and GIAHOTRO = '1'  AND BENHVIEN_ID = 'HLU01'            and LOAIGIA_ID            in (select LOAIGIA_ID from TM_BANGGIA            where LOAIBANGGIA in            (select LOAIBANGGIA from TM_BANGGIA where LOAIGIA_ID = '3'  AND BENHVIEN_ID = 'HLU01')            and TAMNGUNG = '0')  AND BENHVIEN_ID = 'HLU01'            )]
2019-12-10 17:07:51,965 [1] DEBUG - Statement Id: [DAO00099_GetLoaiGiaDichVu] PreparedStatement : [select A.LOAIGIA_ID,B.TENLOAIGIA, B.MALOAIGIA        from TM_DICHVU_DONGIA A        inner join TM_LOAIGIA B on A.LOAIGIA_ID = B.LOAIGIA_ID        inner join LST_DICTIONARY AS DIC ON DIC.DICTIONARY_ID = B.NHOMGIA_ID AND DIC.DICTIONARY_TYPE_CODE = 'NhomGia'        where A.DICHVU_ID = '4524' and A.BENHVIEN_ID = 'HLU01' and DIC.DICTIONARY_CODE != 'BHYT']
2019-12-10 17:08:02,104 [1] DEBUG - Statement Id: [DAO00099_GetLoaiGiaDichVu] PreparedStatement : [select A.LOAIGIA_ID,B.TENLOAIGIA, B.MALOAIGIA        from TM_DICHVU_DONGIA A        inner join TM_LOAIGIA B on A.LOAIGIA_ID = B.LOAIGIA_ID        inner join LST_DICTIONARY AS DIC ON DIC.DICTIONARY_ID = B.NHOMGIA_ID AND DIC.DICTIONARY_TYPE_CODE = 'NhomGia'        where A.DICHVU_ID = '4523' and A.BENHVIEN_ID = 'HLU01' and DIC.DICTIONARY_CODE != 'BHYT']
2019-12-10 17:08:05,194 [1] DEBUG - Statement Id: [DAO00000_GetDONGIA_BY_DICHVU_LOAIGIA] PreparedStatement : [SELECT DD.*              FROM TM_DICHVU_DONGIA DD              WHERE DD.DICHVU_ID = '4523' AND DD.LOAIGIA_ID = '3' AND DD.BENHVIEN_ID = 'HLU01' AND DD.TAMNGUNG = '0']
2019-12-10 17:08:05,239 [1] DEBUG - Statement Id: [DAO00000_GetDONGIA_BY_DICHVU_LOAIGIA] PreparedStatement : [SELECT DD.*              FROM TM_DICHVU_DONGIA DD              WHERE DD.DICHVU_ID = '4523' AND DD.LOAIGIA_ID = '3' AND DD.BENHVIEN_ID = 'HLU01' AND DD.TAMNGUNG = '0']
2019-12-10 17:08:16,120 [1] DEBUG - Statement Id: [DAO00099_TT_CSKH_GOI_DANGKY_GetCount] PreparedStatement : [select Count(*) as SOLAN from TT_CSKH_GOI_DANGKY         where                 GOI_ID = '4'             and               BENHVIEN_ID = 'HLU01']
2019-12-10 17:08:16,206 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_GetDetail] PreparedStatement : [select A.*, DV.MADICHVU from TM_CSKH_GOI_CHITIET A        left join TM_DICHVU dv on dv.DICHVU_ID = A.DICHVU_ID         where                 A.GOI_ID = '4'             and               A.BENHVIEN_ID = 'HLU01']
2019-12-10 17:08:16,249 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_Update] PreparedStatement : [UPDATE TM_CSKH_GOI        SET        MAGOI =  @param0         ,TENGOI =  @param1         ,LOAIGOI_ID =  @param2         ,GIATRIGOI =  @param3         ,GIATRICHUAGIAM =  @param4         ,TYLEMIENGIAM =  @param5         ,GIATRIMIENGIAM =  @param6         ,NGAYBATDAUBAN =  @param7         ,NGAYKETTHUCBAN =  @param8         ,THOIGIANSUDUNG =  @param9         ,NGAYHETHANTUYETDOI =  @param10         ,MOTAGOI =  @param11         ,LYDOHUY =  @param12         ,LAGOIMAU =  @param13         ,TRANGTHAI =  @param14         ,NGAYDUYET =  @param15         ,NGUOIDUYET_ID =  @param16         ,BENHVIEN_ID =  @param17         ,NGAYTAO =  @param18         ,NGUOITAO_ID =  @param19         ,NGAYCAPNHAT =  @param20         ,NGUOICAPNHAT_ID =  @param21         WHERE          GOI_ID =  @param22]
2019-12-10 17:08:16,249 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_Update] Parameters: [@param0=[MAGOI,FPT01], @param1=[TENGOI,Gói KSK FPT 01], @param2=[LOAIGOI_ID,11675], @param3=[GIATRIGOI,1000000], @param4=[GIATRICHUAGIAM,265000], @param5=[TYLEMIENGIAM,377.358490566038], @param6=[GIATRIMIENGIAM,-735000], @param7=[NGAYBATDAUBAN,12/10/2019 12:00:00 AM], @param8=[NGAYKETTHUCBAN,12/31/2020 12:00:00 AM], @param9=[THOIGIANSUDUNG,365], @param10=[NGAYHETHANTUYETDOI,null], @param11=[MOTAGOI,test 1], @param12=[LYDOHUY,null], @param13=[LAGOIMAU,null], @param14=[TRANGTHAI,GOIDUOCPHEPBAN], @param15=[NGAYDUYET,null], @param16=[NGUOIDUYET_ID,null], @param17=[BENHVIEN_ID,HLU01], @param18=[NGAYTAO,12/10/2019 5:04:24 PM], @param19=[NGUOITAO_ID,1], @param20=[NGAYCAPNHAT,12/10/2019 5:08:16 PM], @param21=[NGUOICAPNHAT_ID,1], @param22=[GOI_ID,4]]
2019-12-10 17:08:16,249 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_Update] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[Int64, System.Int64], @param3=[Double, System.Double], @param4=[Double, System.Double], @param5=[Double, System.Double], @param6=[Decimal, System.Decimal], @param7=[DateTime, System.DateTime], @param8=[DateTime, System.DateTime], @param9=[Int64, System.Int64], @param10=[System.DBNull, null], @param11=[String, System.String], @param12=[System.DBNull, null], @param13=[System.DBNull, null], @param14=[String, System.String], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[String, System.String], @param18=[DateTime, System.DateTime], @param19=[Int64, System.Int64], @param20=[DateTime, System.DateTime], @param21=[Int64, System.Int64], @param22=[Int64, System.Int64]]
2019-12-10 17:08:16,289 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_Delete] PreparedStatement : [delete from TM_CSKH_GOI_CHITIET        WHERE GOI_ID =  @param0  AND GOI_CHITIET_ID =  @param1]
2019-12-10 17:08:16,289 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_Delete] Parameters: [@param0=[GOI_ID,4], @param1=[GOI_CHITIET_ID,16]]
2019-12-10 17:08:16,289 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_Delete] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32]]
2019-12-10 17:08:16,316 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_Delete] PreparedStatement : [delete from TM_CSKH_GOI_CHITIET        WHERE GOI_ID =  @param0  AND GOI_CHITIET_ID =  @param1]
2019-12-10 17:08:16,316 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_Delete] Parameters: [@param0=[GOI_ID,4], @param1=[GOI_CHITIET_ID,17]]
2019-12-10 17:08:16,316 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_Delete] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32]]
2019-12-10 17:08:16,340 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_Delete] PreparedStatement : [delete from TM_CSKH_GOI_CHITIET        WHERE GOI_ID =  @param0  AND GOI_CHITIET_ID =  @param1]
2019-12-10 17:08:16,340 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_Delete] Parameters: [@param0=[GOI_ID,4], @param1=[GOI_CHITIET_ID,18]]
2019-12-10 17:08:16,340 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_Delete] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32]]
2019-12-10 17:08:16,366 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_Delete] PreparedStatement : [delete from TM_CSKH_GOI_CHITIET        WHERE GOI_ID =  @param0  AND GOI_CHITIET_ID =  @param1]
2019-12-10 17:08:16,366 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_Delete] Parameters: [@param0=[GOI_ID,4], @param1=[GOI_CHITIET_ID,19]]
2019-12-10 17:08:16,366 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_Delete] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32]]
2019-12-10 17:08:16,390 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_Add] PreparedStatement : [INSERT INTO TM_CSKH_GOI_CHITIET        (GOI_ID        ,DICHVU_ID        ,SOLAN        ,DONGIATRONGGOI        ,THANHTIENTRONGGOI        ,LOAIGIA_ID        ,GIAVON_DICHVU        ,GIAVAT_DICHVU        ,MOTA        ,TINHTRANG        ,BENHVIEN_ID        ,NGAYTAO        ,NGUOITAO_ID        ,NGAYCAPNHAT        ,NGUOICAPNHAT_ID                     , NOITHUCHIEN_ID                     , BACSICHIDINH_ID                 )        VALUES        ( @param0         , @param1         , @param2         , @param3         , @param4         , @param5         , @param6         , @param7         , @param8         , @param9         , @param10         , @param11         , @param12         , @param13         , @param14                      ,  @param15                      ,  @param16                  )]
2019-12-10 17:08:16,390 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_Add] Parameters: [@param0=[GOI_ID,4], @param1=[DICHVU_ID,5435], @param2=[SOLAN,1], @param3=[DONGIATRONGGOI,188500], @param4=[THANHTIENTRONGGOI,188500], @param5=[LOAIGIA_ID,3], @param6=[GIAVON_DICHVU,null], @param7=[GIAVAT_DICHVU,null], @param8=[MOTA,null], @param9=[TINHTRANG,null], @param10=[BENHVIEN_ID,HLU01], @param11=[NGAYTAO,12/10/2019 5:08:16 PM], @param12=[NGUOITAO_ID,1], @param13=[NGAYCAPNHAT,12/10/2019 5:08:16 PM], @param14=[NGUOICAPNHAT_ID,1], @param15=[NOITHUCHIEN_ID,177], @param16=[BACSICHIDINH_ID,32]]
2019-12-10 17:08:16,391 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_Add] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64], @param2=[Int64, System.Int64], @param3=[Double, System.Double], @param4=[Double, System.Double], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[System.DBNull, null], @param8=[System.DBNull, null], @param9=[System.DBNull, null], @param10=[String, System.String], @param11=[DateTime, System.DateTime], @param12=[Int64, System.Int64], @param13=[DateTime, System.DateTime], @param14=[Int64, System.Int64], @param15=[Int64, System.Int64], @param16=[Int64, System.Int64]]
2019-12-10 17:08:16,416 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_Add] PreparedStatement : [INSERT INTO TM_CSKH_GOI_CHITIET        (GOI_ID        ,DICHVU_ID        ,SOLAN        ,DONGIATRONGGOI        ,THANHTIENTRONGGOI        ,LOAIGIA_ID        ,GIAVON_DICHVU        ,GIAVAT_DICHVU        ,MOTA        ,TINHTRANG        ,BENHVIEN_ID        ,NGAYTAO        ,NGUOITAO_ID        ,NGAYCAPNHAT        ,NGUOICAPNHAT_ID                     , NOITHUCHIEN_ID                     , BACSICHIDINH_ID                 )        VALUES        ( @param0         , @param1         , @param2         , @param3         , @param4         , @param5         , @param6         , @param7         , @param8         , @param9         , @param10         , @param11         , @param12         , @param13         , @param14                      ,  @param15                      ,  @param16                  )]
2019-12-10 17:08:16,417 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_Add] Parameters: [@param0=[GOI_ID,4], @param1=[DICHVU_ID,5438], @param2=[SOLAN,1], @param3=[DONGIATRONGGOI,188500], @param4=[THANHTIENTRONGGOI,188500], @param5=[LOAIGIA_ID,3], @param6=[GIAVON_DICHVU,null], @param7=[GIAVAT_DICHVU,null], @param8=[MOTA,null], @param9=[TINHTRANG,null], @param10=[BENHVIEN_ID,HLU01], @param11=[NGAYTAO,12/10/2019 5:08:16 PM], @param12=[NGUOITAO_ID,1], @param13=[NGAYCAPNHAT,12/10/2019 5:08:16 PM], @param14=[NGUOICAPNHAT_ID,1], @param15=[NOITHUCHIEN_ID,64], @param16=[BACSICHIDINH_ID,32]]
2019-12-10 17:08:16,417 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_Add] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64], @param2=[Int64, System.Int64], @param3=[Double, System.Double], @param4=[Double, System.Double], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[System.DBNull, null], @param8=[System.DBNull, null], @param9=[System.DBNull, null], @param10=[String, System.String], @param11=[DateTime, System.DateTime], @param12=[Int64, System.Int64], @param13=[DateTime, System.DateTime], @param14=[Int64, System.Int64], @param15=[Int64, System.Int64], @param16=[Int64, System.Int64]]
2019-12-10 17:08:16,443 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_Add] PreparedStatement : [INSERT INTO TM_CSKH_GOI_CHITIET        (GOI_ID        ,DICHVU_ID        ,SOLAN        ,DONGIATRONGGOI        ,THANHTIENTRONGGOI        ,LOAIGIA_ID        ,GIAVON_DICHVU        ,GIAVAT_DICHVU        ,MOTA        ,TINHTRANG        ,BENHVIEN_ID        ,NGAYTAO        ,NGUOITAO_ID        ,NGAYCAPNHAT        ,NGUOICAPNHAT_ID                     , NOITHUCHIEN_ID                     , BACSICHIDINH_ID                 )        VALUES        ( @param0         , @param1         , @param2         , @param3         , @param4         , @param5         , @param6         , @param7         , @param8         , @param9         , @param10         , @param11         , @param12         , @param13         , @param14                      ,  @param15                      ,  @param16                  )]
2019-12-10 17:08:16,443 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_Add] Parameters: [@param0=[GOI_ID,4], @param1=[DICHVU_ID,4129], @param2=[SOLAN,1], @param3=[DONGIATRONGGOI,263900], @param4=[THANHTIENTRONGGOI,263900], @param5=[LOAIGIA_ID,3], @param6=[GIAVON_DICHVU,null], @param7=[GIAVAT_DICHVU,null], @param8=[MOTA,null], @param9=[TINHTRANG,null], @param10=[BENHVIEN_ID,HLU01], @param11=[NGAYTAO,12/10/2019 5:08:16 PM], @param12=[NGUOITAO_ID,1], @param13=[NGAYCAPNHAT,12/10/2019 5:08:16 PM], @param14=[NGUOICAPNHAT_ID,1], @param15=[NOITHUCHIEN_ID,79], @param16=[BACSICHIDINH_ID,32]]
2019-12-10 17:08:16,443 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_Add] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64], @param2=[Int64, System.Int64], @param3=[Double, System.Double], @param4=[Double, System.Double], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[System.DBNull, null], @param8=[System.DBNull, null], @param9=[System.DBNull, null], @param10=[String, System.String], @param11=[DateTime, System.DateTime], @param12=[Int64, System.Int64], @param13=[DateTime, System.DateTime], @param14=[Int64, System.Int64], @param15=[Int64, System.Int64], @param16=[Int64, System.Int64]]
2019-12-10 17:08:16,468 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_Add] PreparedStatement : [INSERT INTO TM_CSKH_GOI_CHITIET        (GOI_ID        ,DICHVU_ID        ,SOLAN        ,DONGIATRONGGOI        ,THANHTIENTRONGGOI        ,LOAIGIA_ID        ,GIAVON_DICHVU        ,GIAVAT_DICHVU        ,MOTA        ,TINHTRANG        ,BENHVIEN_ID        ,NGAYTAO        ,NGUOITAO_ID        ,NGAYCAPNHAT        ,NGUOICAPNHAT_ID                     , NOITHUCHIEN_ID                     , BACSICHIDINH_ID                 )        VALUES        ( @param0         , @param1         , @param2         , @param3         , @param4         , @param5         , @param6         , @param7         , @param8         , @param9         , @param10         , @param11         , @param12         , @param13         , @param14                      ,  @param15                      ,  @param16                  )]
2019-12-10 17:08:16,469 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_Add] Parameters: [@param0=[GOI_ID,4], @param1=[DICHVU_ID,4017], @param2=[SOLAN,1], @param3=[DONGIATRONGGOI,188500], @param4=[THANHTIENTRONGGOI,188500], @param5=[LOAIGIA_ID,3], @param6=[GIAVON_DICHVU,null], @param7=[GIAVAT_DICHVU,null], @param8=[MOTA,null], @param9=[TINHTRANG,null], @param10=[BENHVIEN_ID,HLU01], @param11=[NGAYTAO,12/10/2019 5:08:16 PM], @param12=[NGUOITAO_ID,1], @param13=[NGAYCAPNHAT,12/10/2019 5:08:16 PM], @param14=[NGUOICAPNHAT_ID,1], @param15=[NOITHUCHIEN_ID,91], @param16=[BACSICHIDINH_ID,32]]
2019-12-10 17:08:16,469 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_Add] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64], @param2=[Int64, System.Int64], @param3=[Double, System.Double], @param4=[Double, System.Double], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[System.DBNull, null], @param8=[System.DBNull, null], @param9=[System.DBNull, null], @param10=[String, System.String], @param11=[DateTime, System.DateTime], @param12=[Int64, System.Int64], @param13=[DateTime, System.DateTime], @param14=[Int64, System.Int64], @param15=[Int64, System.Int64], @param16=[Int64, System.Int64]]
2019-12-10 17:08:16,495 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_Add] PreparedStatement : [INSERT INTO TM_CSKH_GOI_CHITIET        (GOI_ID        ,DICHVU_ID        ,SOLAN        ,DONGIATRONGGOI        ,THANHTIENTRONGGOI        ,LOAIGIA_ID        ,GIAVON_DICHVU        ,GIAVAT_DICHVU        ,MOTA        ,TINHTRANG        ,BENHVIEN_ID        ,NGAYTAO        ,NGUOITAO_ID        ,NGAYCAPNHAT        ,NGUOICAPNHAT_ID                     , NOITHUCHIEN_ID                     , BACSICHIDINH_ID                 )        VALUES        ( @param0         , @param1         , @param2         , @param3         , @param4         , @param5         , @param6         , @param7         , @param8         , @param9         , @param10         , @param11         , @param12         , @param13         , @param14                      ,  @param15                      ,  @param16                  )]
2019-12-10 17:08:16,495 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_Add] Parameters: [@param0=[GOI_ID,4], @param1=[DICHVU_ID,4523], @param2=[SOLAN,1], @param3=[DONGIATRONGGOI,170600], @param4=[THANHTIENTRONGGOI,170600], @param5=[LOAIGIA_ID,3], @param6=[GIAVON_DICHVU,null], @param7=[GIAVAT_DICHVU,null], @param8=[MOTA,null], @param9=[TINHTRANG,null], @param10=[BENHVIEN_ID,HLU01], @param11=[NGAYTAO,12/10/2019 5:08:16 PM], @param12=[NGUOITAO_ID,1], @param13=[NGAYCAPNHAT,12/10/2019 5:08:16 PM], @param14=[NGUOICAPNHAT_ID,1], @param15=[NOITHUCHIEN_ID,104], @param16=[BACSICHIDINH_ID,32]]
2019-12-10 17:08:16,495 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_Add] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64], @param2=[Int64, System.Int64], @param3=[Double, System.Double], @param4=[Double, System.Double], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[System.DBNull, null], @param8=[System.DBNull, null], @param9=[System.DBNull, null], @param10=[String, System.String], @param11=[DateTime, System.DateTime], @param12=[Int64, System.Int64], @param13=[DateTime, System.DateTime], @param14=[Int64, System.Int64], @param15=[Int64, System.Int64], @param16=[Int64, System.Int64]]
2019-12-10 17:08:22,318 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_GetList] PreparedStatement : [select * from TM_CSKH_GOI A         where               A.TRANGTHAI = 'GOIDUOCPHEPBAN'           and             convert(date,A.NGAYTAO) between convert(date, '12/10/2019 5:08:22 PM') and convert(date, '12/10/2019 5:08:22 PM')           and             A.BENHVIEN_ID = 'HLU01']
2019-12-10 17:08:23,439 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_Get] PreparedStatement : [select A.*, B.SOLANSUDUNG        from TM_CSKH_GOI A        left join        (select count(*) as SOLANSUDUNG, GOI_ID        from TT_CSKH_GOI_DANGKY        group by GOI_ID        )B on B.GOI_ID = a.GOI_ID         where               A.GOI_ID = '4'           and             A.BENHVIEN_ID = 'HLU01']
2019-12-10 17:08:23,490 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_GetDetail] PreparedStatement : [select A.*, DV.MADICHVU from TM_CSKH_GOI_CHITIET A        left join TM_DICHVU dv on dv.DICHVU_ID = A.DICHVU_ID         where                 A.GOI_ID = '4'             and               A.BENHVIEN_ID = 'HLU01']
2019-12-10 17:08:23,548 [1] DEBUG - Statement Id: [DAO00000_GetDICHVU_DONGIA_LOAIGIA] PreparedStatement : [select A.LOAIGIA_ID, A.BANGGIA_ID, A.GIAVON, A.TYLEVAT  as TYLE_VAT, A.TYLE_LOINHUAN,            A.DONGIA as DONGIA_DOANHTHU, NULL as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DICHVU_DONGIA A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '5435' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.LOAIGIA_ID = '3' and A.DICHVU_ID = '5435'            union            select A.LOAIGIA_ID, null as BANGGIA_ID, null as GIAVON, null as TYLE_VAT, null as TYLE_LOINHUAN,            null as DONGIA_DOANHTHU, C.DONGIA as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DOITUONG_GIADICHVU A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join TM_DICHVU_DONGIA C on C.LOAIGIA_ID = A.LOAIGIA_ID AND C.BENHVIEN_ID = 'HLU01'            and C.BANGGIA_ID = B.BANGGIA_ID and C.DICHVU_ID = A.DICHVU_ID            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '5435' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.DOITUONG_ID = '1'  and A.DICHVU_ID = '5435' and A.LOAIGIA_ID            in (select top 1 LOAIGIA_ID from TM_DOITUONG_LOAIGIA            where DOITUONG_ID = '1' and GIAHOTRO = '1'  AND BENHVIEN_ID = 'HLU01'            and LOAIGIA_ID            in (select LOAIGIA_ID from TM_BANGGIA            where LOAIBANGGIA in            (select LOAIBANGGIA from TM_BANGGIA where LOAIGIA_ID = '3'  AND BENHVIEN_ID = 'HLU01')            and TAMNGUNG = '0')  AND BENHVIEN_ID = 'HLU01'            )]
2019-12-10 17:08:23,582 [1] DEBUG - Statement Id: [DAO00000_GetDICHVU_DONGIA_LOAIGIA] PreparedStatement : [select A.LOAIGIA_ID, A.BANGGIA_ID, A.GIAVON, A.TYLEVAT  as TYLE_VAT, A.TYLE_LOINHUAN,            A.DONGIA as DONGIA_DOANHTHU, NULL as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DICHVU_DONGIA A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '5438' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.LOAIGIA_ID = '3' and A.DICHVU_ID = '5438'            union            select A.LOAIGIA_ID, null as BANGGIA_ID, null as GIAVON, null as TYLE_VAT, null as TYLE_LOINHUAN,            null as DONGIA_DOANHTHU, C.DONGIA as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DOITUONG_GIADICHVU A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join TM_DICHVU_DONGIA C on C.LOAIGIA_ID = A.LOAIGIA_ID AND C.BENHVIEN_ID = 'HLU01'            and C.BANGGIA_ID = B.BANGGIA_ID and C.DICHVU_ID = A.DICHVU_ID            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '5438' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.DOITUONG_ID = '1'  and A.DICHVU_ID = '5438' and A.LOAIGIA_ID            in (select top 1 LOAIGIA_ID from TM_DOITUONG_LOAIGIA            where DOITUONG_ID = '1' and GIAHOTRO = '1'  AND BENHVIEN_ID = 'HLU01'            and LOAIGIA_ID            in (select LOAIGIA_ID from TM_BANGGIA            where LOAIBANGGIA in            (select LOAIBANGGIA from TM_BANGGIA where LOAIGIA_ID = '3'  AND BENHVIEN_ID = 'HLU01')            and TAMNGUNG = '0')  AND BENHVIEN_ID = 'HLU01'            )]
2019-12-10 17:08:23,614 [1] DEBUG - Statement Id: [DAO00000_GetDICHVU_DONGIA_LOAIGIA] PreparedStatement : [select A.LOAIGIA_ID, A.BANGGIA_ID, A.GIAVON, A.TYLEVAT  as TYLE_VAT, A.TYLE_LOINHUAN,            A.DONGIA as DONGIA_DOANHTHU, NULL as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DICHVU_DONGIA A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '4129' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.LOAIGIA_ID = '3' and A.DICHVU_ID = '4129'            union            select A.LOAIGIA_ID, null as BANGGIA_ID, null as GIAVON, null as TYLE_VAT, null as TYLE_LOINHUAN,            null as DONGIA_DOANHTHU, C.DONGIA as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DOITUONG_GIADICHVU A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join TM_DICHVU_DONGIA C on C.LOAIGIA_ID = A.LOAIGIA_ID AND C.BENHVIEN_ID = 'HLU01'            and C.BANGGIA_ID = B.BANGGIA_ID and C.DICHVU_ID = A.DICHVU_ID            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '4129' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.DOITUONG_ID = '1'  and A.DICHVU_ID = '4129' and A.LOAIGIA_ID            in (select top 1 LOAIGIA_ID from TM_DOITUONG_LOAIGIA            where DOITUONG_ID = '1' and GIAHOTRO = '1'  AND BENHVIEN_ID = 'HLU01'            and LOAIGIA_ID            in (select LOAIGIA_ID from TM_BANGGIA            where LOAIBANGGIA in            (select LOAIBANGGIA from TM_BANGGIA where LOAIGIA_ID = '3'  AND BENHVIEN_ID = 'HLU01')            and TAMNGUNG = '0')  AND BENHVIEN_ID = 'HLU01'            )]
2019-12-10 17:08:23,649 [1] DEBUG - Statement Id: [DAO00000_GetDICHVU_DONGIA_LOAIGIA] PreparedStatement : [select A.LOAIGIA_ID, A.BANGGIA_ID, A.GIAVON, A.TYLEVAT  as TYLE_VAT, A.TYLE_LOINHUAN,            A.DONGIA as DONGIA_DOANHTHU, NULL as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DICHVU_DONGIA A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '4017' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.LOAIGIA_ID = '3' and A.DICHVU_ID = '4017'            union            select A.LOAIGIA_ID, null as BANGGIA_ID, null as GIAVON, null as TYLE_VAT, null as TYLE_LOINHUAN,            null as DONGIA_DOANHTHU, C.DONGIA as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DOITUONG_GIADICHVU A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join TM_DICHVU_DONGIA C on C.LOAIGIA_ID = A.LOAIGIA_ID AND C.BENHVIEN_ID = 'HLU01'            and C.BANGGIA_ID = B.BANGGIA_ID and C.DICHVU_ID = A.DICHVU_ID            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '4017' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.DOITUONG_ID = '1'  and A.DICHVU_ID = '4017' and A.LOAIGIA_ID            in (select top 1 LOAIGIA_ID from TM_DOITUONG_LOAIGIA            where DOITUONG_ID = '1' and GIAHOTRO = '1'  AND BENHVIEN_ID = 'HLU01'            and LOAIGIA_ID            in (select LOAIGIA_ID from TM_BANGGIA            where LOAIBANGGIA in            (select LOAIBANGGIA from TM_BANGGIA where LOAIGIA_ID = '3'  AND BENHVIEN_ID = 'HLU01')            and TAMNGUNG = '0')  AND BENHVIEN_ID = 'HLU01'            )]
2019-12-10 17:08:23,684 [1] DEBUG - Statement Id: [DAO00000_GetDICHVU_DONGIA_LOAIGIA] PreparedStatement : [select A.LOAIGIA_ID, A.BANGGIA_ID, A.GIAVON, A.TYLEVAT  as TYLE_VAT, A.TYLE_LOINHUAN,            A.DONGIA as DONGIA_DOANHTHU, NULL as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DICHVU_DONGIA A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '4523' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.LOAIGIA_ID = '3' and A.DICHVU_ID = '4523'            union            select A.LOAIGIA_ID, null as BANGGIA_ID, null as GIAVON, null as TYLE_VAT, null as TYLE_LOINHUAN,            null as DONGIA_DOANHTHU, C.DONGIA as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DOITUONG_GIADICHVU A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join TM_DICHVU_DONGIA C on C.LOAIGIA_ID = A.LOAIGIA_ID AND C.BENHVIEN_ID = 'HLU01'            and C.BANGGIA_ID = B.BANGGIA_ID and C.DICHVU_ID = A.DICHVU_ID            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '4523' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.DOITUONG_ID = '1'  and A.DICHVU_ID = '4523' and A.LOAIGIA_ID            in (select top 1 LOAIGIA_ID from TM_DOITUONG_LOAIGIA            where DOITUONG_ID = '1' and GIAHOTRO = '1'  AND BENHVIEN_ID = 'HLU01'            and LOAIGIA_ID            in (select LOAIGIA_ID from TM_BANGGIA            where LOAIBANGGIA in            (select LOAIBANGGIA from TM_BANGGIA where LOAIGIA_ID = '3'  AND BENHVIEN_ID = 'HLU01')            and TAMNGUNG = '0')  AND BENHVIEN_ID = 'HLU01'            )]
2019-12-10 17:08:23,872 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MKT03'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 17:08:24,959 [1] DEBUG - Statement Id: [DAO00099_GetListLoaiGoiDV] PreparedStatement : [select * from LST_DICTIONARY        where        DICTIONARY_TYPE_CODE = 'LoaiGoiDV']
2019-12-10 17:08:25,375 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_Get] PreparedStatement : [select A.*, B.SOLANSUDUNG        from TM_CSKH_GOI A        left join        (select count(*) as SOLANSUDUNG, GOI_ID        from TT_CSKH_GOI_DANGKY        group by GOI_ID        )B on B.GOI_ID = a.GOI_ID         where               A.GOI_ID = '4'           and             A.BENHVIEN_ID = 'HLU01']
2019-12-10 17:08:25,425 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_GetDetail] PreparedStatement : [select A.*, DV.MADICHVU from TM_CSKH_GOI_CHITIET A        left join TM_DICHVU dv on dv.DICHVU_ID = A.DICHVU_ID         where                 A.GOI_ID = '4'             and               A.BENHVIEN_ID = 'HLU01']
2019-12-10 17:08:26,704 [1] DEBUG - Statement Id: [DAO00099_GetLoaiGiaDichVu] PreparedStatement : [select A.LOAIGIA_ID,B.TENLOAIGIA, B.MALOAIGIA        from TM_DICHVU_DONGIA A        inner join TM_LOAIGIA B on A.LOAIGIA_ID = B.LOAIGIA_ID        inner join LST_DICTIONARY AS DIC ON DIC.DICTIONARY_ID = B.NHOMGIA_ID AND DIC.DICTIONARY_TYPE_CODE = 'NhomGia'        where A.DICHVU_ID = '5435' and A.BENHVIEN_ID = 'HLU01' and DIC.DICTIONARY_CODE != 'BHYT']
2019-12-10 17:08:26,738 [1] DEBUG - Statement Id: [DAO00000_GetDONGIA_BY_DICHVU_LOAIGIA] PreparedStatement : [SELECT DD.*              FROM TM_DICHVU_DONGIA DD              WHERE DD.DICHVU_ID = '5435' AND DD.LOAIGIA_ID = '3' AND DD.BENHVIEN_ID = 'HLU01' AND DD.TAMNGUNG = '0']
2019-12-10 17:08:26,774 [1] DEBUG - Statement Id: [DAO00099_GetLoaiGiaDichVu] PreparedStatement : [select A.LOAIGIA_ID,B.TENLOAIGIA, B.MALOAIGIA        from TM_DICHVU_DONGIA A        inner join TM_LOAIGIA B on A.LOAIGIA_ID = B.LOAIGIA_ID        inner join LST_DICTIONARY AS DIC ON DIC.DICTIONARY_ID = B.NHOMGIA_ID AND DIC.DICTIONARY_TYPE_CODE = 'NhomGia'        where A.DICHVU_ID = '5438' and A.BENHVIEN_ID = 'HLU01' and DIC.DICTIONARY_CODE != 'BHYT']
2019-12-10 17:08:26,809 [1] DEBUG - Statement Id: [DAO00000_GetDONGIA_BY_DICHVU_LOAIGIA] PreparedStatement : [SELECT DD.*              FROM TM_DICHVU_DONGIA DD              WHERE DD.DICHVU_ID = '5438' AND DD.LOAIGIA_ID = '3' AND DD.BENHVIEN_ID = 'HLU01' AND DD.TAMNGUNG = '0']
2019-12-10 17:08:26,839 [1] DEBUG - Statement Id: [DAO00099_GetLoaiGiaDichVu] PreparedStatement : [select A.LOAIGIA_ID,B.TENLOAIGIA, B.MALOAIGIA        from TM_DICHVU_DONGIA A        inner join TM_LOAIGIA B on A.LOAIGIA_ID = B.LOAIGIA_ID        inner join LST_DICTIONARY AS DIC ON DIC.DICTIONARY_ID = B.NHOMGIA_ID AND DIC.DICTIONARY_TYPE_CODE = 'NhomGia'        where A.DICHVU_ID = '4129' and A.BENHVIEN_ID = 'HLU01' and DIC.DICTIONARY_CODE != 'BHYT']
2019-12-10 17:08:26,880 [1] DEBUG - Statement Id: [DAO00000_GetDONGIA_BY_DICHVU_LOAIGIA] PreparedStatement : [SELECT DD.*              FROM TM_DICHVU_DONGIA DD              WHERE DD.DICHVU_ID = '4129' AND DD.LOAIGIA_ID = '3' AND DD.BENHVIEN_ID = 'HLU01' AND DD.TAMNGUNG = '0']
2019-12-10 17:08:26,913 [1] DEBUG - Statement Id: [DAO00099_GetLoaiGiaDichVu] PreparedStatement : [select A.LOAIGIA_ID,B.TENLOAIGIA, B.MALOAIGIA        from TM_DICHVU_DONGIA A        inner join TM_LOAIGIA B on A.LOAIGIA_ID = B.LOAIGIA_ID        inner join LST_DICTIONARY AS DIC ON DIC.DICTIONARY_ID = B.NHOMGIA_ID AND DIC.DICTIONARY_TYPE_CODE = 'NhomGia'        where A.DICHVU_ID = '4017' and A.BENHVIEN_ID = 'HLU01' and DIC.DICTIONARY_CODE != 'BHYT']
2019-12-10 17:08:26,958 [1] DEBUG - Statement Id: [DAO00000_GetDONGIA_BY_DICHVU_LOAIGIA] PreparedStatement : [SELECT DD.*              FROM TM_DICHVU_DONGIA DD              WHERE DD.DICHVU_ID = '4017' AND DD.LOAIGIA_ID = '3' AND DD.BENHVIEN_ID = 'HLU01' AND DD.TAMNGUNG = '0']
2019-12-10 17:08:26,990 [1] DEBUG - Statement Id: [DAO00099_GetLoaiGiaDichVu] PreparedStatement : [select A.LOAIGIA_ID,B.TENLOAIGIA, B.MALOAIGIA        from TM_DICHVU_DONGIA A        inner join TM_LOAIGIA B on A.LOAIGIA_ID = B.LOAIGIA_ID        inner join LST_DICTIONARY AS DIC ON DIC.DICTIONARY_ID = B.NHOMGIA_ID AND DIC.DICTIONARY_TYPE_CODE = 'NhomGia'        where A.DICHVU_ID = '4523' and A.BENHVIEN_ID = 'HLU01' and DIC.DICTIONARY_CODE != 'BHYT']
2019-12-10 17:08:27,031 [1] DEBUG - Statement Id: [DAO00000_GetDONGIA_BY_DICHVU_LOAIGIA] PreparedStatement : [SELECT DD.*              FROM TM_DICHVU_DONGIA DD              WHERE DD.DICHVU_ID = '4523' AND DD.LOAIGIA_ID = '3' AND DD.BENHVIEN_ID = 'HLU01' AND DD.TAMNGUNG = '0']
--------------------------------------------------------------------------------
2019-12-10 17:22:02,971 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2019-12-10 17:22:03,229 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-12-10 17:22:03,264 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-12-10 17:22:03,793 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 17:22:04,025 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-12-10 17:22:09,226 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2019-12-10 17:22:09,261 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-12-10 17:22:11,173 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-12-10 17:22:11,261 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-12-10 17:22:12,045 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2019-12-10 17:22:12,335 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2019-12-10 17:22:12,423 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2019-12-10 17:22:12,539 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2019-12-10 17:22:12,643 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2019-12-10 17:22:12,809 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2019-12-10 17:22:12,881 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2019-12-10 17:22:12,981 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2019-12-10 17:22:13,077 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2019-12-10 17:22:13,721 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2019-12-10 17:22:13,811 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2019-12-10 17:22:13,881 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2019-12-10 17:22:13,912 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2019-12-10 17:22:14,764 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2019-12-10 17:22:14,795 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @NGUONDUOC_MACDINH varchar(5) = '0';        declare @TOAMUANGOAI int = 0;        select @NGUONDUOC_MACDINH = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'PHA_NGUONDUOC'        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + @NGUONDUOC_MACDINH as DUOC_KEY, 0 as PHAMVI_ID, @NGUONDUOC_MACDINH as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end        else        begin                  select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2019-12-10 17:22:16,744 [5] DEBUG - Statement Id: [DAO00320_GetList] PreparedStatement : [select M.*            from TM_MAU M            LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID            where            M.TAMNGUNG = '0'            and M.BENHVIEN_ID = 'HLU01'            order by M.TENMAU]
2019-12-10 17:22:16,807 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2019-12-10 17:22:16,837 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,        SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH        FROM TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID        WHERE TK.SOLUONG > 0        GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2019-12-10 17:22:16,911 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2019-12-10 17:22:16,940 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,        TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,        TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH        from TM_MAU M        JOIN        (        select        A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO        from        (        select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO        from TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'        where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0        ) A        )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2019-12-10 17:22:17,006 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2019-12-10 17:22:17,920 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 17:22:18,765 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2019-12-10 17:22:24,018 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2019-12-10 17:22:24,051 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2019-12-10 17:22:24,135 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 17:22:24,255 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 17:22:24,401 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2019-12-10 17:22:24,403 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-12-10 17:22:24,403 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-12-10 17:22:24,431 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2019-12-10 17:22:24,431 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-12-10 17:22:24,432 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-12-10 17:22:24,573 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 17:22:24,754 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 17:22:42,857 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 17:22:42,998 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2019-12-10 17:22:43,623 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2019-12-10 17:23:53,883 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MKT15'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 17:23:54,838 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_GetList] PreparedStatement : [select * from TM_CSKH_GOI A         where               A.TRANGTHAI = 'GOIDUOCPHEPBAN'           and             convert(date,A.NGAYTAO) between convert(date, '12/10/2019 5:23:54 PM') and convert(date, '12/10/2019 5:23:54 PM')           and             A.BENHVIEN_ID = 'HLU01']
2019-12-10 17:23:57,129 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_Get] PreparedStatement : [select A.*, B.SOLANSUDUNG        from TM_CSKH_GOI A        left join        (select count(*) as SOLANSUDUNG, GOI_ID        from TT_CSKH_GOI_DANGKY        group by GOI_ID        )B on B.GOI_ID = a.GOI_ID         where               A.GOI_ID = '4'           and             A.BENHVIEN_ID = 'HLU01']
2019-12-10 17:23:57,180 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_GetDetail] PreparedStatement : [select A.*, DV.MADICHVU from TM_CSKH_GOI_CHITIET A        left join TM_DICHVU dv on dv.DICHVU_ID = A.DICHVU_ID         where                 A.GOI_ID = '4'             and               A.BENHVIEN_ID = 'HLU01']
2019-12-10 17:23:57,373 [1] DEBUG - Statement Id: [DAO00000_GetDICHVU_DONGIA_LOAIGIA] PreparedStatement : [select A.LOAIGIA_ID, A.BANGGIA_ID, A.GIAVON, A.TYLEVAT  as TYLE_VAT, A.TYLE_LOINHUAN,            A.DONGIA as DONGIA_DOANHTHU, NULL as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DICHVU_DONGIA A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '5435' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.LOAIGIA_ID = '3' and A.DICHVU_ID = '5435'            union            select A.LOAIGIA_ID, null as BANGGIA_ID, null as GIAVON, null as TYLE_VAT, null as TYLE_LOINHUAN,            null as DONGIA_DOANHTHU, C.DONGIA as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DOITUONG_GIADICHVU A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join TM_DICHVU_DONGIA C on C.LOAIGIA_ID = A.LOAIGIA_ID AND C.BENHVIEN_ID = 'HLU01'            and C.BANGGIA_ID = B.BANGGIA_ID and C.DICHVU_ID = A.DICHVU_ID            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '5435' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.DOITUONG_ID = '1'  and A.DICHVU_ID = '5435' and A.LOAIGIA_ID            in (select top 1 LOAIGIA_ID from TM_DOITUONG_LOAIGIA            where DOITUONG_ID = '1' and GIAHOTRO = '1'  AND BENHVIEN_ID = 'HLU01'            and LOAIGIA_ID            in (select LOAIGIA_ID from TM_BANGGIA            where LOAIBANGGIA in            (select LOAIBANGGIA from TM_BANGGIA where LOAIGIA_ID = '3'  AND BENHVIEN_ID = 'HLU01')            and TAMNGUNG = '0')  AND BENHVIEN_ID = 'HLU01'            )]
2019-12-10 17:23:57,408 [1] DEBUG - Statement Id: [DAO00000_GetDICHVU_DONGIA_LOAIGIA] PreparedStatement : [select A.LOAIGIA_ID, A.BANGGIA_ID, A.GIAVON, A.TYLEVAT  as TYLE_VAT, A.TYLE_LOINHUAN,            A.DONGIA as DONGIA_DOANHTHU, NULL as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DICHVU_DONGIA A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '5438' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.LOAIGIA_ID = '3' and A.DICHVU_ID = '5438'            union            select A.LOAIGIA_ID, null as BANGGIA_ID, null as GIAVON, null as TYLE_VAT, null as TYLE_LOINHUAN,            null as DONGIA_DOANHTHU, C.DONGIA as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DOITUONG_GIADICHVU A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join TM_DICHVU_DONGIA C on C.LOAIGIA_ID = A.LOAIGIA_ID AND C.BENHVIEN_ID = 'HLU01'            and C.BANGGIA_ID = B.BANGGIA_ID and C.DICHVU_ID = A.DICHVU_ID            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '5438' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.DOITUONG_ID = '1'  and A.DICHVU_ID = '5438' and A.LOAIGIA_ID            in (select top 1 LOAIGIA_ID from TM_DOITUONG_LOAIGIA            where DOITUONG_ID = '1' and GIAHOTRO = '1'  AND BENHVIEN_ID = 'HLU01'            and LOAIGIA_ID            in (select LOAIGIA_ID from TM_BANGGIA            where LOAIBANGGIA in            (select LOAIBANGGIA from TM_BANGGIA where LOAIGIA_ID = '3'  AND BENHVIEN_ID = 'HLU01')            and TAMNGUNG = '0')  AND BENHVIEN_ID = 'HLU01'            )]
2019-12-10 17:23:57,442 [1] DEBUG - Statement Id: [DAO00000_GetDICHVU_DONGIA_LOAIGIA] PreparedStatement : [select A.LOAIGIA_ID, A.BANGGIA_ID, A.GIAVON, A.TYLEVAT  as TYLE_VAT, A.TYLE_LOINHUAN,            A.DONGIA as DONGIA_DOANHTHU, NULL as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DICHVU_DONGIA A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '4129' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.LOAIGIA_ID = '3' and A.DICHVU_ID = '4129'            union            select A.LOAIGIA_ID, null as BANGGIA_ID, null as GIAVON, null as TYLE_VAT, null as TYLE_LOINHUAN,            null as DONGIA_DOANHTHU, C.DONGIA as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DOITUONG_GIADICHVU A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join TM_DICHVU_DONGIA C on C.LOAIGIA_ID = A.LOAIGIA_ID AND C.BENHVIEN_ID = 'HLU01'            and C.BANGGIA_ID = B.BANGGIA_ID and C.DICHVU_ID = A.DICHVU_ID            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '4129' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.DOITUONG_ID = '1'  and A.DICHVU_ID = '4129' and A.LOAIGIA_ID            in (select top 1 LOAIGIA_ID from TM_DOITUONG_LOAIGIA            where DOITUONG_ID = '1' and GIAHOTRO = '1'  AND BENHVIEN_ID = 'HLU01'            and LOAIGIA_ID            in (select LOAIGIA_ID from TM_BANGGIA            where LOAIBANGGIA in            (select LOAIBANGGIA from TM_BANGGIA where LOAIGIA_ID = '3'  AND BENHVIEN_ID = 'HLU01')            and TAMNGUNG = '0')  AND BENHVIEN_ID = 'HLU01'            )]
2019-12-10 17:23:57,480 [1] DEBUG - Statement Id: [DAO00000_GetDICHVU_DONGIA_LOAIGIA] PreparedStatement : [select A.LOAIGIA_ID, A.BANGGIA_ID, A.GIAVON, A.TYLEVAT  as TYLE_VAT, A.TYLE_LOINHUAN,            A.DONGIA as DONGIA_DOANHTHU, NULL as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DICHVU_DONGIA A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '4017' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.LOAIGIA_ID = '3' and A.DICHVU_ID = '4017'            union            select A.LOAIGIA_ID, null as BANGGIA_ID, null as GIAVON, null as TYLE_VAT, null as TYLE_LOINHUAN,            null as DONGIA_DOANHTHU, C.DONGIA as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DOITUONG_GIADICHVU A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join TM_DICHVU_DONGIA C on C.LOAIGIA_ID = A.LOAIGIA_ID AND C.BENHVIEN_ID = 'HLU01'            and C.BANGGIA_ID = B.BANGGIA_ID and C.DICHVU_ID = A.DICHVU_ID            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '4017' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.DOITUONG_ID = '1'  and A.DICHVU_ID = '4017' and A.LOAIGIA_ID            in (select top 1 LOAIGIA_ID from TM_DOITUONG_LOAIGIA            where DOITUONG_ID = '1' and GIAHOTRO = '1'  AND BENHVIEN_ID = 'HLU01'            and LOAIGIA_ID            in (select LOAIGIA_ID from TM_BANGGIA            where LOAIBANGGIA in            (select LOAIBANGGIA from TM_BANGGIA where LOAIGIA_ID = '3'  AND BENHVIEN_ID = 'HLU01')            and TAMNGUNG = '0')  AND BENHVIEN_ID = 'HLU01'            )]
2019-12-10 17:23:57,512 [1] DEBUG - Statement Id: [DAO00000_GetDICHVU_DONGIA_LOAIGIA] PreparedStatement : [select A.LOAIGIA_ID, A.BANGGIA_ID, A.GIAVON, A.TYLEVAT  as TYLE_VAT, A.TYLE_LOINHUAN,            A.DONGIA as DONGIA_DOANHTHU, NULL as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DICHVU_DONGIA A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '4523' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.LOAIGIA_ID = '3' and A.DICHVU_ID = '4523'            union            select A.LOAIGIA_ID, null as BANGGIA_ID, null as GIAVON, null as TYLE_VAT, null as TYLE_LOINHUAN,            null as DONGIA_DOANHTHU, C.DONGIA as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DOITUONG_GIADICHVU A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join TM_DICHVU_DONGIA C on C.LOAIGIA_ID = A.LOAIGIA_ID AND C.BENHVIEN_ID = 'HLU01'            and C.BANGGIA_ID = B.BANGGIA_ID and C.DICHVU_ID = A.DICHVU_ID            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '4523' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.DOITUONG_ID = '1'  and A.DICHVU_ID = '4523' and A.LOAIGIA_ID            in (select top 1 LOAIGIA_ID from TM_DOITUONG_LOAIGIA            where DOITUONG_ID = '1' and GIAHOTRO = '1'  AND BENHVIEN_ID = 'HLU01'            and LOAIGIA_ID            in (select LOAIGIA_ID from TM_BANGGIA            where LOAIBANGGIA in            (select LOAIBANGGIA from TM_BANGGIA where LOAIGIA_ID = '3'  AND BENHVIEN_ID = 'HLU01')            and TAMNGUNG = '0')  AND BENHVIEN_ID = 'HLU01'            )]
2019-12-10 17:24:07,117 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MKT03'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 17:24:08,661 [1] DEBUG - Statement Id: [DAO00099_GetListLoaiGoiDV] PreparedStatement : [select * from LST_DICTIONARY        where        DICTIONARY_TYPE_CODE = 'LoaiGoiDV']
--------------------------------------------------------------------------------
2019-12-10 17:40:10,935 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2019-12-10 17:40:11,179 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-12-10 17:40:11,213 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-12-10 17:40:11,622 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 17:40:11,856 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-12-10 17:40:17,089 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2019-12-10 17:40:17,114 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-12-10 17:40:20,162 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-12-10 17:40:20,245 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-12-10 17:40:21,018 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2019-12-10 17:40:21,278 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2019-12-10 17:40:21,363 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2019-12-10 17:40:21,444 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2019-12-10 17:40:21,516 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2019-12-10 17:40:21,587 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2019-12-10 17:40:21,664 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2019-12-10 17:40:21,742 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2019-12-10 17:40:21,810 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2019-12-10 17:40:22,317 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2019-12-10 17:40:22,352 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2019-12-10 17:40:22,423 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2019-12-10 17:40:22,459 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2019-12-10 17:40:23,327 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2019-12-10 17:40:23,358 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @NGUONDUOC_MACDINH varchar(5) = '0';        declare @TOAMUANGOAI int = 0;        select @NGUONDUOC_MACDINH = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'PHA_NGUONDUOC'        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + @NGUONDUOC_MACDINH as DUOC_KEY, 0 as PHAMVI_ID, @NGUONDUOC_MACDINH as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end        else        begin                  select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2019-12-10 17:40:25,233 [5] DEBUG - Statement Id: [DAO00320_GetList] PreparedStatement : [select M.*            from TM_MAU M            LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID            where            M.TAMNGUNG = '0'            and M.BENHVIEN_ID = 'HLU01'            order by M.TENMAU]
2019-12-10 17:40:25,299 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2019-12-10 17:40:25,330 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,        SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH        FROM TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID        WHERE TK.SOLUONG > 0        GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2019-12-10 17:40:25,396 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2019-12-10 17:40:25,426 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,        TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,        TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH        from TM_MAU M        JOIN        (        select        A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO        from        (        select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO        from TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'        where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0        ) A        )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2019-12-10 17:40:25,510 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2019-12-10 17:40:26,424 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 17:40:27,211 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2019-12-10 17:40:31,938 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2019-12-10 17:40:31,966 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2019-12-10 17:40:32,061 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 17:40:32,179 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 17:40:32,318 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2019-12-10 17:40:32,320 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-12-10 17:40:32,320 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-12-10 17:40:32,347 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2019-12-10 17:40:32,347 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-12-10 17:40:32,347 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-12-10 17:40:32,490 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 17:40:32,648 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 17:40:43,804 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 17:40:43,885 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2019-12-10 17:40:44,133 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2019-12-10 17:40:51,661 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MKT15'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 17:40:52,715 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_GetList] PreparedStatement : [select * from TM_CSKH_GOI A         where               A.TRANGTHAI = 'GOIDUOCPHEPBAN'           and             convert(date,A.NGAYTAO) between convert(date, '12/10/2019 5:40:51 PM') and convert(date, '12/10/2019 5:40:51 PM')           and             A.BENHVIEN_ID = 'HLU01']
2019-12-10 17:40:54,353 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_Get] PreparedStatement : [select A.*, B.SOLANSUDUNG        from TM_CSKH_GOI A        left join        (select count(*) as SOLANSUDUNG, GOI_ID        from TT_CSKH_GOI_DANGKY        group by GOI_ID        )B on B.GOI_ID = a.GOI_ID         where               A.GOI_ID = '4'           and             A.BENHVIEN_ID = 'HLU01']
2019-12-10 17:40:54,403 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_GetDetail] PreparedStatement : [select A.*, DV.MADICHVU from TM_CSKH_GOI_CHITIET A        left join TM_DICHVU dv on dv.DICHVU_ID = A.DICHVU_ID         where                 A.GOI_ID = '4'             and               A.BENHVIEN_ID = 'HLU01']
2019-12-10 17:40:54,578 [1] DEBUG - Statement Id: [DAO00000_GetDICHVU_DONGIA_LOAIGIA] PreparedStatement : [select A.LOAIGIA_ID, A.BANGGIA_ID, A.GIAVON, A.TYLEVAT  as TYLE_VAT, A.TYLE_LOINHUAN,            A.DONGIA as DONGIA_DOANHTHU, NULL as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DICHVU_DONGIA A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '5435' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.LOAIGIA_ID = '3' and A.DICHVU_ID = '5435'            union            select A.LOAIGIA_ID, null as BANGGIA_ID, null as GIAVON, null as TYLE_VAT, null as TYLE_LOINHUAN,            null as DONGIA_DOANHTHU, C.DONGIA as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DOITUONG_GIADICHVU A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join TM_DICHVU_DONGIA C on C.LOAIGIA_ID = A.LOAIGIA_ID AND C.BENHVIEN_ID = 'HLU01'            and C.BANGGIA_ID = B.BANGGIA_ID and C.DICHVU_ID = A.DICHVU_ID            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '5435' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.DOITUONG_ID = '1'  and A.DICHVU_ID = '5435' and A.LOAIGIA_ID            in (select top 1 LOAIGIA_ID from TM_DOITUONG_LOAIGIA            where DOITUONG_ID = '1' and GIAHOTRO = '1'  AND BENHVIEN_ID = 'HLU01'            and LOAIGIA_ID            in (select LOAIGIA_ID from TM_BANGGIA            where LOAIBANGGIA in            (select LOAIBANGGIA from TM_BANGGIA where LOAIGIA_ID = '3'  AND BENHVIEN_ID = 'HLU01')            and TAMNGUNG = '0')  AND BENHVIEN_ID = 'HLU01'            )]
2019-12-10 17:40:54,613 [1] DEBUG - Statement Id: [DAO00000_GetDICHVU_DONGIA_LOAIGIA] PreparedStatement : [select A.LOAIGIA_ID, A.BANGGIA_ID, A.GIAVON, A.TYLEVAT  as TYLE_VAT, A.TYLE_LOINHUAN,            A.DONGIA as DONGIA_DOANHTHU, NULL as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DICHVU_DONGIA A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '5438' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.LOAIGIA_ID = '3' and A.DICHVU_ID = '5438'            union            select A.LOAIGIA_ID, null as BANGGIA_ID, null as GIAVON, null as TYLE_VAT, null as TYLE_LOINHUAN,            null as DONGIA_DOANHTHU, C.DONGIA as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DOITUONG_GIADICHVU A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join TM_DICHVU_DONGIA C on C.LOAIGIA_ID = A.LOAIGIA_ID AND C.BENHVIEN_ID = 'HLU01'            and C.BANGGIA_ID = B.BANGGIA_ID and C.DICHVU_ID = A.DICHVU_ID            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '5438' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.DOITUONG_ID = '1'  and A.DICHVU_ID = '5438' and A.LOAIGIA_ID            in (select top 1 LOAIGIA_ID from TM_DOITUONG_LOAIGIA            where DOITUONG_ID = '1' and GIAHOTRO = '1'  AND BENHVIEN_ID = 'HLU01'            and LOAIGIA_ID            in (select LOAIGIA_ID from TM_BANGGIA            where LOAIBANGGIA in            (select LOAIBANGGIA from TM_BANGGIA where LOAIGIA_ID = '3'  AND BENHVIEN_ID = 'HLU01')            and TAMNGUNG = '0')  AND BENHVIEN_ID = 'HLU01'            )]
2019-12-10 17:40:54,648 [1] DEBUG - Statement Id: [DAO00000_GetDICHVU_DONGIA_LOAIGIA] PreparedStatement : [select A.LOAIGIA_ID, A.BANGGIA_ID, A.GIAVON, A.TYLEVAT  as TYLE_VAT, A.TYLE_LOINHUAN,            A.DONGIA as DONGIA_DOANHTHU, NULL as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DICHVU_DONGIA A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '4129' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.LOAIGIA_ID = '3' and A.DICHVU_ID = '4129'            union            select A.LOAIGIA_ID, null as BANGGIA_ID, null as GIAVON, null as TYLE_VAT, null as TYLE_LOINHUAN,            null as DONGIA_DOANHTHU, C.DONGIA as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DOITUONG_GIADICHVU A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join TM_DICHVU_DONGIA C on C.LOAIGIA_ID = A.LOAIGIA_ID AND C.BENHVIEN_ID = 'HLU01'            and C.BANGGIA_ID = B.BANGGIA_ID and C.DICHVU_ID = A.DICHVU_ID            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '4129' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.DOITUONG_ID = '1'  and A.DICHVU_ID = '4129' and A.LOAIGIA_ID            in (select top 1 LOAIGIA_ID from TM_DOITUONG_LOAIGIA            where DOITUONG_ID = '1' and GIAHOTRO = '1'  AND BENHVIEN_ID = 'HLU01'            and LOAIGIA_ID            in (select LOAIGIA_ID from TM_BANGGIA            where LOAIBANGGIA in            (select LOAIBANGGIA from TM_BANGGIA where LOAIGIA_ID = '3'  AND BENHVIEN_ID = 'HLU01')            and TAMNGUNG = '0')  AND BENHVIEN_ID = 'HLU01'            )]
2019-12-10 17:40:54,691 [1] DEBUG - Statement Id: [DAO00000_GetDICHVU_DONGIA_LOAIGIA] PreparedStatement : [select A.LOAIGIA_ID, A.BANGGIA_ID, A.GIAVON, A.TYLEVAT  as TYLE_VAT, A.TYLE_LOINHUAN,            A.DONGIA as DONGIA_DOANHTHU, NULL as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DICHVU_DONGIA A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '4017' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.LOAIGIA_ID = '3' and A.DICHVU_ID = '4017'            union            select A.LOAIGIA_ID, null as BANGGIA_ID, null as GIAVON, null as TYLE_VAT, null as TYLE_LOINHUAN,            null as DONGIA_DOANHTHU, C.DONGIA as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DOITUONG_GIADICHVU A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join TM_DICHVU_DONGIA C on C.LOAIGIA_ID = A.LOAIGIA_ID AND C.BENHVIEN_ID = 'HLU01'            and C.BANGGIA_ID = B.BANGGIA_ID and C.DICHVU_ID = A.DICHVU_ID            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '4017' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.DOITUONG_ID = '1'  and A.DICHVU_ID = '4017' and A.LOAIGIA_ID            in (select top 1 LOAIGIA_ID from TM_DOITUONG_LOAIGIA            where DOITUONG_ID = '1' and GIAHOTRO = '1'  AND BENHVIEN_ID = 'HLU01'            and LOAIGIA_ID            in (select LOAIGIA_ID from TM_BANGGIA            where LOAIBANGGIA in            (select LOAIBANGGIA from TM_BANGGIA where LOAIGIA_ID = '3'  AND BENHVIEN_ID = 'HLU01')            and TAMNGUNG = '0')  AND BENHVIEN_ID = 'HLU01'            )]
2019-12-10 17:40:54,728 [1] DEBUG - Statement Id: [DAO00000_GetDICHVU_DONGIA_LOAIGIA] PreparedStatement : [select A.LOAIGIA_ID, A.BANGGIA_ID, A.GIAVON, A.TYLEVAT  as TYLE_VAT, A.TYLE_LOINHUAN,            A.DONGIA as DONGIA_DOANHTHU, NULL as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DICHVU_DONGIA A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '4523' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.LOAIGIA_ID = '3' and A.DICHVU_ID = '4523'            union            select A.LOAIGIA_ID, null as BANGGIA_ID, null as GIAVON, null as TYLE_VAT, null as TYLE_LOINHUAN,            null as DONGIA_DOANHTHU, C.DONGIA as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DOITUONG_GIADICHVU A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join TM_DICHVU_DONGIA C on C.LOAIGIA_ID = A.LOAIGIA_ID AND C.BENHVIEN_ID = 'HLU01'            and C.BANGGIA_ID = B.BANGGIA_ID and C.DICHVU_ID = A.DICHVU_ID            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '4523' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.DOITUONG_ID = '1'  and A.DICHVU_ID = '4523' and A.LOAIGIA_ID            in (select top 1 LOAIGIA_ID from TM_DOITUONG_LOAIGIA            where DOITUONG_ID = '1' and GIAHOTRO = '1'  AND BENHVIEN_ID = 'HLU01'            and LOAIGIA_ID            in (select LOAIGIA_ID from TM_BANGGIA            where LOAIBANGGIA in            (select LOAIBANGGIA from TM_BANGGIA where LOAIGIA_ID = '3'  AND BENHVIEN_ID = 'HLU01')            and TAMNGUNG = '0')  AND BENHVIEN_ID = 'HLU01'            )]
2019-12-10 17:41:09,204 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM98'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
--------------------------------------------------------------------------------
2019-12-10 17:44:22,652 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2019-12-10 17:44:22,937 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-12-10 17:44:22,971 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-12-10 17:44:23,406 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 17:44:23,640 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-12-10 17:44:28,473 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2019-12-10 17:44:28,497 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-12-10 17:44:30,453 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-12-10 17:44:30,542 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-12-10 17:44:31,324 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2019-12-10 17:44:31,535 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2019-12-10 17:44:31,607 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2019-12-10 17:44:31,672 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2019-12-10 17:44:31,753 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2019-12-10 17:44:31,822 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2019-12-10 17:44:31,891 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2019-12-10 17:44:31,960 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2019-12-10 17:44:32,051 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2019-12-10 17:44:32,546 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2019-12-10 17:44:32,576 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2019-12-10 17:44:32,648 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2019-12-10 17:44:32,676 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2019-12-10 17:44:33,465 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2019-12-10 17:44:33,520 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @NGUONDUOC_MACDINH varchar(5) = '0';        declare @TOAMUANGOAI int = 0;        select @NGUONDUOC_MACDINH = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'PHA_NGUONDUOC'        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + @NGUONDUOC_MACDINH as DUOC_KEY, 0 as PHAMVI_ID, @NGUONDUOC_MACDINH as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end        else        begin                  select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2019-12-10 17:44:35,447 [5] DEBUG - Statement Id: [DAO00320_GetList] PreparedStatement : [select M.*            from TM_MAU M            LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID            where            M.TAMNGUNG = '0'            and M.BENHVIEN_ID = 'HLU01'            order by M.TENMAU]
2019-12-10 17:44:35,514 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2019-12-10 17:44:35,545 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,        SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH        FROM TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID        WHERE TK.SOLUONG > 0        GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2019-12-10 17:44:35,634 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2019-12-10 17:44:35,720 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,        TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,        TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH        from TM_MAU M        JOIN        (        select        A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO        from        (        select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO        from TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'        where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0        ) A        )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2019-12-10 17:44:35,893 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2019-12-10 17:44:36,873 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 17:44:37,764 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2019-12-10 17:44:42,433 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2019-12-10 17:44:42,461 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2019-12-10 17:44:42,533 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 17:44:42,641 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 17:44:42,764 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2019-12-10 17:44:42,765 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-12-10 17:44:42,765 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-12-10 17:44:42,840 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2019-12-10 17:44:42,841 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-12-10 17:44:42,841 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-12-10 17:44:42,983 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 17:44:43,148 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 17:45:05,088 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 17:45:05,183 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2019-12-10 17:45:05,417 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2019-12-10 17:45:31,441 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MKT15'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 17:45:32,663 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_GetList] PreparedStatement : [select * from TM_CSKH_GOI A         where               A.TRANGTHAI = 'GOIDUOCPHEPBAN'           and             convert(date,A.NGAYTAO) between convert(date, '12/10/2019 5:45:31 PM') and convert(date, '12/10/2019 5:45:31 PM')           and             A.BENHVIEN_ID = 'HLU01']
2019-12-10 17:45:34,704 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_Get] PreparedStatement : [select A.*, B.SOLANSUDUNG        from TM_CSKH_GOI A        left join        (select count(*) as SOLANSUDUNG, GOI_ID        from TT_CSKH_GOI_DANGKY        group by GOI_ID        )B on B.GOI_ID = a.GOI_ID         where               A.GOI_ID = '4'           and             A.BENHVIEN_ID = 'HLU01']
2019-12-10 17:45:34,751 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_GetDetail] PreparedStatement : [select A.*, DV.MADICHVU from TM_CSKH_GOI_CHITIET A        left join TM_DICHVU dv on dv.DICHVU_ID = A.DICHVU_ID         where                 A.GOI_ID = '4'             and               A.BENHVIEN_ID = 'HLU01']
2019-12-10 17:45:34,965 [1] DEBUG - Statement Id: [DAO00000_GetDICHVU_DONGIA_LOAIGIA] PreparedStatement : [select A.LOAIGIA_ID, A.BANGGIA_ID, A.GIAVON, A.TYLEVAT  as TYLE_VAT, A.TYLE_LOINHUAN,            A.DONGIA as DONGIA_DOANHTHU, NULL as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DICHVU_DONGIA A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '5435' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.LOAIGIA_ID = '3' and A.DICHVU_ID = '5435'            union            select A.LOAIGIA_ID, null as BANGGIA_ID, null as GIAVON, null as TYLE_VAT, null as TYLE_LOINHUAN,            null as DONGIA_DOANHTHU, C.DONGIA as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DOITUONG_GIADICHVU A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join TM_DICHVU_DONGIA C on C.LOAIGIA_ID = A.LOAIGIA_ID AND C.BENHVIEN_ID = 'HLU01'            and C.BANGGIA_ID = B.BANGGIA_ID and C.DICHVU_ID = A.DICHVU_ID            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '5435' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.DOITUONG_ID = '1'  and A.DICHVU_ID = '5435' and A.LOAIGIA_ID            in (select top 1 LOAIGIA_ID from TM_DOITUONG_LOAIGIA            where DOITUONG_ID = '1' and GIAHOTRO = '1'  AND BENHVIEN_ID = 'HLU01'            and LOAIGIA_ID            in (select LOAIGIA_ID from TM_BANGGIA            where LOAIBANGGIA in            (select LOAIBANGGIA from TM_BANGGIA where LOAIGIA_ID = '3'  AND BENHVIEN_ID = 'HLU01')            and TAMNGUNG = '0')  AND BENHVIEN_ID = 'HLU01'            )]
2019-12-10 17:45:35,000 [1] DEBUG - Statement Id: [DAO00000_GetDICHVU_DONGIA_LOAIGIA] PreparedStatement : [select A.LOAIGIA_ID, A.BANGGIA_ID, A.GIAVON, A.TYLEVAT  as TYLE_VAT, A.TYLE_LOINHUAN,            A.DONGIA as DONGIA_DOANHTHU, NULL as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DICHVU_DONGIA A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '5438' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.LOAIGIA_ID = '3' and A.DICHVU_ID = '5438'            union            select A.LOAIGIA_ID, null as BANGGIA_ID, null as GIAVON, null as TYLE_VAT, null as TYLE_LOINHUAN,            null as DONGIA_DOANHTHU, C.DONGIA as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DOITUONG_GIADICHVU A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join TM_DICHVU_DONGIA C on C.LOAIGIA_ID = A.LOAIGIA_ID AND C.BENHVIEN_ID = 'HLU01'            and C.BANGGIA_ID = B.BANGGIA_ID and C.DICHVU_ID = A.DICHVU_ID            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '5438' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.DOITUONG_ID = '1'  and A.DICHVU_ID = '5438' and A.LOAIGIA_ID            in (select top 1 LOAIGIA_ID from TM_DOITUONG_LOAIGIA            where DOITUONG_ID = '1' and GIAHOTRO = '1'  AND BENHVIEN_ID = 'HLU01'            and LOAIGIA_ID            in (select LOAIGIA_ID from TM_BANGGIA            where LOAIBANGGIA in            (select LOAIBANGGIA from TM_BANGGIA where LOAIGIA_ID = '3'  AND BENHVIEN_ID = 'HLU01')            and TAMNGUNG = '0')  AND BENHVIEN_ID = 'HLU01'            )]
2019-12-10 17:45:35,033 [1] DEBUG - Statement Id: [DAO00000_GetDICHVU_DONGIA_LOAIGIA] PreparedStatement : [select A.LOAIGIA_ID, A.BANGGIA_ID, A.GIAVON, A.TYLEVAT  as TYLE_VAT, A.TYLE_LOINHUAN,            A.DONGIA as DONGIA_DOANHTHU, NULL as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DICHVU_DONGIA A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '4129' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.LOAIGIA_ID = '3' and A.DICHVU_ID = '4129'            union            select A.LOAIGIA_ID, null as BANGGIA_ID, null as GIAVON, null as TYLE_VAT, null as TYLE_LOINHUAN,            null as DONGIA_DOANHTHU, C.DONGIA as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DOITUONG_GIADICHVU A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join TM_DICHVU_DONGIA C on C.LOAIGIA_ID = A.LOAIGIA_ID AND C.BENHVIEN_ID = 'HLU01'            and C.BANGGIA_ID = B.BANGGIA_ID and C.DICHVU_ID = A.DICHVU_ID            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '4129' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.DOITUONG_ID = '1'  and A.DICHVU_ID = '4129' and A.LOAIGIA_ID            in (select top 1 LOAIGIA_ID from TM_DOITUONG_LOAIGIA            where DOITUONG_ID = '1' and GIAHOTRO = '1'  AND BENHVIEN_ID = 'HLU01'            and LOAIGIA_ID            in (select LOAIGIA_ID from TM_BANGGIA            where LOAIBANGGIA in            (select LOAIBANGGIA from TM_BANGGIA where LOAIGIA_ID = '3'  AND BENHVIEN_ID = 'HLU01')            and TAMNGUNG = '0')  AND BENHVIEN_ID = 'HLU01'            )]
2019-12-10 17:45:35,073 [1] DEBUG - Statement Id: [DAO00000_GetDICHVU_DONGIA_LOAIGIA] PreparedStatement : [select A.LOAIGIA_ID, A.BANGGIA_ID, A.GIAVON, A.TYLEVAT  as TYLE_VAT, A.TYLE_LOINHUAN,            A.DONGIA as DONGIA_DOANHTHU, NULL as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DICHVU_DONGIA A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '4017' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.LOAIGIA_ID = '3' and A.DICHVU_ID = '4017'            union            select A.LOAIGIA_ID, null as BANGGIA_ID, null as GIAVON, null as TYLE_VAT, null as TYLE_LOINHUAN,            null as DONGIA_DOANHTHU, C.DONGIA as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DOITUONG_GIADICHVU A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join TM_DICHVU_DONGIA C on C.LOAIGIA_ID = A.LOAIGIA_ID AND C.BENHVIEN_ID = 'HLU01'            and C.BANGGIA_ID = B.BANGGIA_ID and C.DICHVU_ID = A.DICHVU_ID            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '4017' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.DOITUONG_ID = '1'  and A.DICHVU_ID = '4017' and A.LOAIGIA_ID            in (select top 1 LOAIGIA_ID from TM_DOITUONG_LOAIGIA            where DOITUONG_ID = '1' and GIAHOTRO = '1'  AND BENHVIEN_ID = 'HLU01'            and LOAIGIA_ID            in (select LOAIGIA_ID from TM_BANGGIA            where LOAIBANGGIA in            (select LOAIBANGGIA from TM_BANGGIA where LOAIGIA_ID = '3'  AND BENHVIEN_ID = 'HLU01')            and TAMNGUNG = '0')  AND BENHVIEN_ID = 'HLU01'            )]
2019-12-10 17:45:35,109 [1] DEBUG - Statement Id: [DAO00000_GetDICHVU_DONGIA_LOAIGIA] PreparedStatement : [select A.LOAIGIA_ID, A.BANGGIA_ID, A.GIAVON, A.TYLEVAT  as TYLE_VAT, A.TYLE_LOINHUAN,            A.DONGIA as DONGIA_DOANHTHU, NULL as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DICHVU_DONGIA A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '4523' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.LOAIGIA_ID = '3' and A.DICHVU_ID = '4523'            union            select A.LOAIGIA_ID, null as BANGGIA_ID, null as GIAVON, null as TYLE_VAT, null as TYLE_LOINHUAN,            null as DONGIA_DOANHTHU, C.DONGIA as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DOITUONG_GIADICHVU A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join TM_DICHVU_DONGIA C on C.LOAIGIA_ID = A.LOAIGIA_ID AND C.BENHVIEN_ID = 'HLU01'            and C.BANGGIA_ID = B.BANGGIA_ID and C.DICHVU_ID = A.DICHVU_ID            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '4523' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.DOITUONG_ID = '1'  and A.DICHVU_ID = '4523' and A.LOAIGIA_ID            in (select top 1 LOAIGIA_ID from TM_DOITUONG_LOAIGIA            where DOITUONG_ID = '1' and GIAHOTRO = '1'  AND BENHVIEN_ID = 'HLU01'            and LOAIGIA_ID            in (select LOAIGIA_ID from TM_BANGGIA            where LOAIBANGGIA in            (select LOAIBANGGIA from TM_BANGGIA where LOAIGIA_ID = '3'  AND BENHVIEN_ID = 'HLU01')            and TAMNGUNG = '0')  AND BENHVIEN_ID = 'HLU01'            )]
2019-12-10 17:46:04,909 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MKT03'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 17:46:06,262 [1] DEBUG - Statement Id: [DAO00099_GetListLoaiGoiDV] PreparedStatement : [select * from LST_DICTIONARY        where        DICTIONARY_TYPE_CODE = 'LoaiGoiDV']
2019-12-10 17:46:26,043 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_Get] PreparedStatement : [select A.*, B.SOLANSUDUNG        from TM_CSKH_GOI A        left join        (select count(*) as SOLANSUDUNG, GOI_ID        from TT_CSKH_GOI_DANGKY        group by GOI_ID        )B on B.GOI_ID = a.GOI_ID         where               A.GOI_ID = '4'           and             A.BENHVIEN_ID = 'HLU01']
2019-12-10 17:46:26,090 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_GetDetail] PreparedStatement : [select A.*, DV.MADICHVU from TM_CSKH_GOI_CHITIET A        left join TM_DICHVU dv on dv.DICHVU_ID = A.DICHVU_ID         where                 A.GOI_ID = '4'             and               A.BENHVIEN_ID = 'HLU01']
2019-12-10 17:46:27,435 [1] DEBUG - Statement Id: [DAO00099_GetLoaiGiaDichVu] PreparedStatement : [select A.LOAIGIA_ID,B.TENLOAIGIA, B.MALOAIGIA        from TM_DICHVU_DONGIA A        inner join TM_LOAIGIA B on A.LOAIGIA_ID = B.LOAIGIA_ID        inner join LST_DICTIONARY AS DIC ON DIC.DICTIONARY_ID = B.NHOMGIA_ID AND DIC.DICTIONARY_TYPE_CODE = 'NhomGia'        where A.DICHVU_ID = '5435' and A.BENHVIEN_ID = 'HLU01' and DIC.DICTIONARY_CODE != 'BHYT']
2019-12-10 17:46:27,501 [1] DEBUG - Statement Id: [DAO00000_GetDONGIA_BY_DICHVU_LOAIGIA] PreparedStatement : [SELECT DD.*              FROM TM_DICHVU_DONGIA DD              WHERE DD.DICHVU_ID = '5435' AND DD.LOAIGIA_ID = '3' AND DD.BENHVIEN_ID = 'HLU01' AND DD.TAMNGUNG = '0']
2019-12-10 17:46:27,532 [1] DEBUG - Statement Id: [DAO00099_GetLoaiGiaDichVu] PreparedStatement : [select A.LOAIGIA_ID,B.TENLOAIGIA, B.MALOAIGIA        from TM_DICHVU_DONGIA A        inner join TM_LOAIGIA B on A.LOAIGIA_ID = B.LOAIGIA_ID        inner join LST_DICTIONARY AS DIC ON DIC.DICTIONARY_ID = B.NHOMGIA_ID AND DIC.DICTIONARY_TYPE_CODE = 'NhomGia'        where A.DICHVU_ID = '5438' and A.BENHVIEN_ID = 'HLU01' and DIC.DICTIONARY_CODE != 'BHYT']
2019-12-10 17:46:27,563 [1] DEBUG - Statement Id: [DAO00000_GetDONGIA_BY_DICHVU_LOAIGIA] PreparedStatement : [SELECT DD.*              FROM TM_DICHVU_DONGIA DD              WHERE DD.DICHVU_ID = '5438' AND DD.LOAIGIA_ID = '3' AND DD.BENHVIEN_ID = 'HLU01' AND DD.TAMNGUNG = '0']
2019-12-10 17:46:27,592 [1] DEBUG - Statement Id: [DAO00099_GetLoaiGiaDichVu] PreparedStatement : [select A.LOAIGIA_ID,B.TENLOAIGIA, B.MALOAIGIA        from TM_DICHVU_DONGIA A        inner join TM_LOAIGIA B on A.LOAIGIA_ID = B.LOAIGIA_ID        inner join LST_DICTIONARY AS DIC ON DIC.DICTIONARY_ID = B.NHOMGIA_ID AND DIC.DICTIONARY_TYPE_CODE = 'NhomGia'        where A.DICHVU_ID = '4129' and A.BENHVIEN_ID = 'HLU01' and DIC.DICTIONARY_CODE != 'BHYT']
2019-12-10 17:46:27,625 [1] DEBUG - Statement Id: [DAO00000_GetDONGIA_BY_DICHVU_LOAIGIA] PreparedStatement : [SELECT DD.*              FROM TM_DICHVU_DONGIA DD              WHERE DD.DICHVU_ID = '4129' AND DD.LOAIGIA_ID = '3' AND DD.BENHVIEN_ID = 'HLU01' AND DD.TAMNGUNG = '0']
2019-12-10 17:46:27,655 [1] DEBUG - Statement Id: [DAO00099_GetLoaiGiaDichVu] PreparedStatement : [select A.LOAIGIA_ID,B.TENLOAIGIA, B.MALOAIGIA        from TM_DICHVU_DONGIA A        inner join TM_LOAIGIA B on A.LOAIGIA_ID = B.LOAIGIA_ID        inner join LST_DICTIONARY AS DIC ON DIC.DICTIONARY_ID = B.NHOMGIA_ID AND DIC.DICTIONARY_TYPE_CODE = 'NhomGia'        where A.DICHVU_ID = '4017' and A.BENHVIEN_ID = 'HLU01' and DIC.DICTIONARY_CODE != 'BHYT']
2019-12-10 17:46:27,690 [1] DEBUG - Statement Id: [DAO00000_GetDONGIA_BY_DICHVU_LOAIGIA] PreparedStatement : [SELECT DD.*              FROM TM_DICHVU_DONGIA DD              WHERE DD.DICHVU_ID = '4017' AND DD.LOAIGIA_ID = '3' AND DD.BENHVIEN_ID = 'HLU01' AND DD.TAMNGUNG = '0']
2019-12-10 17:46:27,723 [1] DEBUG - Statement Id: [DAO00099_GetLoaiGiaDichVu] PreparedStatement : [select A.LOAIGIA_ID,B.TENLOAIGIA, B.MALOAIGIA        from TM_DICHVU_DONGIA A        inner join TM_LOAIGIA B on A.LOAIGIA_ID = B.LOAIGIA_ID        inner join LST_DICTIONARY AS DIC ON DIC.DICTIONARY_ID = B.NHOMGIA_ID AND DIC.DICTIONARY_TYPE_CODE = 'NhomGia'        where A.DICHVU_ID = '4523' and A.BENHVIEN_ID = 'HLU01' and DIC.DICTIONARY_CODE != 'BHYT']
2019-12-10 17:46:27,761 [1] DEBUG - Statement Id: [DAO00000_GetDONGIA_BY_DICHVU_LOAIGIA] PreparedStatement : [SELECT DD.*              FROM TM_DICHVU_DONGIA DD              WHERE DD.DICHVU_ID = '4523' AND DD.LOAIGIA_ID = '3' AND DD.BENHVIEN_ID = 'HLU01' AND DD.TAMNGUNG = '0']
--------------------------------------------------------------------------------
2019-12-10 17:50:11,461 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2019-12-10 17:50:11,687 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-12-10 17:50:11,721 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-12-10 17:50:12,125 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 17:50:12,463 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-12-10 17:50:17,409 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2019-12-10 17:50:17,433 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-12-10 17:50:19,635 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-12-10 17:50:19,728 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-12-10 17:50:20,503 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2019-12-10 17:50:20,743 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2019-12-10 17:50:20,884 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2019-12-10 17:50:20,969 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2019-12-10 17:50:21,062 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2019-12-10 17:50:21,169 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2019-12-10 17:50:21,252 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2019-12-10 17:50:21,323 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2019-12-10 17:50:21,398 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2019-12-10 17:50:21,983 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2019-12-10 17:50:22,015 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2019-12-10 17:50:22,092 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2019-12-10 17:50:22,121 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2019-12-10 17:50:22,981 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2019-12-10 17:50:23,021 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @NGUONDUOC_MACDINH varchar(5) = '0';        declare @TOAMUANGOAI int = 0;        select @NGUONDUOC_MACDINH = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'PHA_NGUONDUOC'        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + @NGUONDUOC_MACDINH as DUOC_KEY, 0 as PHAMVI_ID, @NGUONDUOC_MACDINH as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end        else        begin                  select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2019-12-10 17:50:25,005 [5] DEBUG - Statement Id: [DAO00320_GetList] PreparedStatement : [select M.*            from TM_MAU M            LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID            where            M.TAMNGUNG = '0'            and M.BENHVIEN_ID = 'HLU01'            order by M.TENMAU]
2019-12-10 17:50:25,066 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2019-12-10 17:50:25,097 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,        SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH        FROM TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID        WHERE TK.SOLUONG > 0        GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2019-12-10 17:50:25,166 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2019-12-10 17:50:25,195 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,        TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,        TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH        from TM_MAU M        JOIN        (        select        A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO        from        (        select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO        from TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'        where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0        ) A        )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2019-12-10 17:50:25,260 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2019-12-10 17:50:26,312 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 17:50:27,256 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2019-12-10 17:50:32,875 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2019-12-10 17:50:32,901 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2019-12-10 17:50:33,002 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 17:50:33,210 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 17:50:33,436 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2019-12-10 17:50:33,438 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-12-10 17:50:33,438 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-12-10 17:50:33,466 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2019-12-10 17:50:33,466 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-12-10 17:50:33,466 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-12-10 17:50:33,636 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 17:50:33,848 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 17:51:05,754 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 17:51:05,855 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2019-12-10 17:51:06,179 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2019-12-10 17:52:43,778 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MKT15'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 17:52:45,435 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_GetList] PreparedStatement : [select * from TM_CSKH_GOI A         where               A.TRANGTHAI = 'GOIDUOCPHEPBAN'           and             convert(date,A.NGAYTAO) between convert(date, '12/10/2019 5:52:44 PM') and convert(date, '12/10/2019 5:52:44 PM')           and             A.BENHVIEN_ID = 'HLU01']
2019-12-10 17:52:47,567 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_Get] PreparedStatement : [select A.*, B.SOLANSUDUNG        from TM_CSKH_GOI A        left join        (select count(*) as SOLANSUDUNG, GOI_ID        from TT_CSKH_GOI_DANGKY        group by GOI_ID        )B on B.GOI_ID = a.GOI_ID         where               A.GOI_ID = '4'           and             A.BENHVIEN_ID = 'HLU01']
2019-12-10 17:52:47,613 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_GetDetail] PreparedStatement : [select A.*, DV.MADICHVU from TM_CSKH_GOI_CHITIET A        left join TM_DICHVU dv on dv.DICHVU_ID = A.DICHVU_ID         where                 A.GOI_ID = '4'             and               A.BENHVIEN_ID = 'HLU01']
2019-12-10 17:52:47,812 [1] DEBUG - Statement Id: [DAO00000_GetDICHVU_DONGIA_LOAIGIA] PreparedStatement : [select A.LOAIGIA_ID, A.BANGGIA_ID, A.GIAVON, A.TYLEVAT  as TYLE_VAT, A.TYLE_LOINHUAN,            A.DONGIA as DONGIA_DOANHTHU, NULL as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DICHVU_DONGIA A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '5435' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.LOAIGIA_ID = '3' and A.DICHVU_ID = '5435'            union            select A.LOAIGIA_ID, null as BANGGIA_ID, null as GIAVON, null as TYLE_VAT, null as TYLE_LOINHUAN,            null as DONGIA_DOANHTHU, C.DONGIA as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DOITUONG_GIADICHVU A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join TM_DICHVU_DONGIA C on C.LOAIGIA_ID = A.LOAIGIA_ID AND C.BENHVIEN_ID = 'HLU01'            and C.BANGGIA_ID = B.BANGGIA_ID and C.DICHVU_ID = A.DICHVU_ID            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '5435' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.DOITUONG_ID = '1'  and A.DICHVU_ID = '5435' and A.LOAIGIA_ID            in (select top 1 LOAIGIA_ID from TM_DOITUONG_LOAIGIA            where DOITUONG_ID = '1' and GIAHOTRO = '1'  AND BENHVIEN_ID = 'HLU01'            and LOAIGIA_ID            in (select LOAIGIA_ID from TM_BANGGIA            where LOAIBANGGIA in            (select LOAIBANGGIA from TM_BANGGIA where LOAIGIA_ID = '3'  AND BENHVIEN_ID = 'HLU01')            and TAMNGUNG = '0')  AND BENHVIEN_ID = 'HLU01'            )]
2019-12-10 17:52:47,847 [1] DEBUG - Statement Id: [DAO00000_GetDICHVU_DONGIA_LOAIGIA] PreparedStatement : [select A.LOAIGIA_ID, A.BANGGIA_ID, A.GIAVON, A.TYLEVAT  as TYLE_VAT, A.TYLE_LOINHUAN,            A.DONGIA as DONGIA_DOANHTHU, NULL as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DICHVU_DONGIA A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '5438' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.LOAIGIA_ID = '3' and A.DICHVU_ID = '5438'            union            select A.LOAIGIA_ID, null as BANGGIA_ID, null as GIAVON, null as TYLE_VAT, null as TYLE_LOINHUAN,            null as DONGIA_DOANHTHU, C.DONGIA as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DOITUONG_GIADICHVU A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join TM_DICHVU_DONGIA C on C.LOAIGIA_ID = A.LOAIGIA_ID AND C.BENHVIEN_ID = 'HLU01'            and C.BANGGIA_ID = B.BANGGIA_ID and C.DICHVU_ID = A.DICHVU_ID            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '5438' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.DOITUONG_ID = '1'  and A.DICHVU_ID = '5438' and A.LOAIGIA_ID            in (select top 1 LOAIGIA_ID from TM_DOITUONG_LOAIGIA            where DOITUONG_ID = '1' and GIAHOTRO = '1'  AND BENHVIEN_ID = 'HLU01'            and LOAIGIA_ID            in (select LOAIGIA_ID from TM_BANGGIA            where LOAIBANGGIA in            (select LOAIBANGGIA from TM_BANGGIA where LOAIGIA_ID = '3'  AND BENHVIEN_ID = 'HLU01')            and TAMNGUNG = '0')  AND BENHVIEN_ID = 'HLU01'            )]
2019-12-10 17:52:47,880 [1] DEBUG - Statement Id: [DAO00000_GetDICHVU_DONGIA_LOAIGIA] PreparedStatement : [select A.LOAIGIA_ID, A.BANGGIA_ID, A.GIAVON, A.TYLEVAT  as TYLE_VAT, A.TYLE_LOINHUAN,            A.DONGIA as DONGIA_DOANHTHU, NULL as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DICHVU_DONGIA A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '4129' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.LOAIGIA_ID = '3' and A.DICHVU_ID = '4129'            union            select A.LOAIGIA_ID, null as BANGGIA_ID, null as GIAVON, null as TYLE_VAT, null as TYLE_LOINHUAN,            null as DONGIA_DOANHTHU, C.DONGIA as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DOITUONG_GIADICHVU A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join TM_DICHVU_DONGIA C on C.LOAIGIA_ID = A.LOAIGIA_ID AND C.BENHVIEN_ID = 'HLU01'            and C.BANGGIA_ID = B.BANGGIA_ID and C.DICHVU_ID = A.DICHVU_ID            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '4129' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.DOITUONG_ID = '1'  and A.DICHVU_ID = '4129' and A.LOAIGIA_ID            in (select top 1 LOAIGIA_ID from TM_DOITUONG_LOAIGIA            where DOITUONG_ID = '1' and GIAHOTRO = '1'  AND BENHVIEN_ID = 'HLU01'            and LOAIGIA_ID            in (select LOAIGIA_ID from TM_BANGGIA            where LOAIBANGGIA in            (select LOAIBANGGIA from TM_BANGGIA where LOAIGIA_ID = '3'  AND BENHVIEN_ID = 'HLU01')            and TAMNGUNG = '0')  AND BENHVIEN_ID = 'HLU01'            )]
2019-12-10 17:52:47,914 [1] DEBUG - Statement Id: [DAO00000_GetDICHVU_DONGIA_LOAIGIA] PreparedStatement : [select A.LOAIGIA_ID, A.BANGGIA_ID, A.GIAVON, A.TYLEVAT  as TYLE_VAT, A.TYLE_LOINHUAN,            A.DONGIA as DONGIA_DOANHTHU, NULL as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DICHVU_DONGIA A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '4017' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.LOAIGIA_ID = '3' and A.DICHVU_ID = '4017'            union            select A.LOAIGIA_ID, null as BANGGIA_ID, null as GIAVON, null as TYLE_VAT, null as TYLE_LOINHUAN,            null as DONGIA_DOANHTHU, C.DONGIA as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DOITUONG_GIADICHVU A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join TM_DICHVU_DONGIA C on C.LOAIGIA_ID = A.LOAIGIA_ID AND C.BENHVIEN_ID = 'HLU01'            and C.BANGGIA_ID = B.BANGGIA_ID and C.DICHVU_ID = A.DICHVU_ID            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '4017' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.DOITUONG_ID = '1'  and A.DICHVU_ID = '4017' and A.LOAIGIA_ID            in (select top 1 LOAIGIA_ID from TM_DOITUONG_LOAIGIA            where DOITUONG_ID = '1' and GIAHOTRO = '1'  AND BENHVIEN_ID = 'HLU01'            and LOAIGIA_ID            in (select LOAIGIA_ID from TM_BANGGIA            where LOAIBANGGIA in            (select LOAIBANGGIA from TM_BANGGIA where LOAIGIA_ID = '3'  AND BENHVIEN_ID = 'HLU01')            and TAMNGUNG = '0')  AND BENHVIEN_ID = 'HLU01'            )]
2019-12-10 17:52:47,948 [1] DEBUG - Statement Id: [DAO00000_GetDICHVU_DONGIA_LOAIGIA] PreparedStatement : [select A.LOAIGIA_ID, A.BANGGIA_ID, A.GIAVON, A.TYLEVAT  as TYLE_VAT, A.TYLE_LOINHUAN,            A.DONGIA as DONGIA_DOANHTHU, NULL as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DICHVU_DONGIA A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '4523' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.LOAIGIA_ID = '3' and A.DICHVU_ID = '4523'            union            select A.LOAIGIA_ID, null as BANGGIA_ID, null as GIAVON, null as TYLE_VAT, null as TYLE_LOINHUAN,            null as DONGIA_DOANHTHU, C.DONGIA as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DOITUONG_GIADICHVU A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join TM_DICHVU_DONGIA C on C.LOAIGIA_ID = A.LOAIGIA_ID AND C.BENHVIEN_ID = 'HLU01'            and C.BANGGIA_ID = B.BANGGIA_ID and C.DICHVU_ID = A.DICHVU_ID            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '4523' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.DOITUONG_ID = '1'  and A.DICHVU_ID = '4523' and A.LOAIGIA_ID            in (select top 1 LOAIGIA_ID from TM_DOITUONG_LOAIGIA            where DOITUONG_ID = '1' and GIAHOTRO = '1'  AND BENHVIEN_ID = 'HLU01'            and LOAIGIA_ID            in (select LOAIGIA_ID from TM_BANGGIA            where LOAIBANGGIA in            (select LOAIBANGGIA from TM_BANGGIA where LOAIGIA_ID = '3'  AND BENHVIEN_ID = 'HLU01')            and TAMNGUNG = '0')  AND BENHVIEN_ID = 'HLU01'            )]
2019-12-10 17:53:04,772 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MKT03'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 17:53:06,969 [1] DEBUG - Statement Id: [DAO00099_GetListLoaiGoiDV] PreparedStatement : [select * from LST_DICTIONARY        where        DICTIONARY_TYPE_CODE = 'LoaiGoiDV']
2019-12-10 17:53:14,465 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_Get] PreparedStatement : [select A.*, B.SOLANSUDUNG        from TM_CSKH_GOI A        left join        (select count(*) as SOLANSUDUNG, GOI_ID        from TT_CSKH_GOI_DANGKY        group by GOI_ID        )B on B.GOI_ID = a.GOI_ID         where               A.GOI_ID = '4'           and             A.BENHVIEN_ID = 'HLU01']
2019-12-10 17:53:14,518 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_GetDetail] PreparedStatement : [select A.*, DV.MADICHVU from TM_CSKH_GOI_CHITIET A        left join TM_DICHVU dv on dv.DICHVU_ID = A.DICHVU_ID         where                 A.GOI_ID = '4'             and               A.BENHVIEN_ID = 'HLU01']
2019-12-10 17:53:16,433 [1] DEBUG - Statement Id: [DAO00099_GetLoaiGiaDichVu] PreparedStatement : [select A.LOAIGIA_ID,B.TENLOAIGIA, B.MALOAIGIA        from TM_DICHVU_DONGIA A        inner join TM_LOAIGIA B on A.LOAIGIA_ID = B.LOAIGIA_ID        inner join LST_DICTIONARY AS DIC ON DIC.DICTIONARY_ID = B.NHOMGIA_ID AND DIC.DICTIONARY_TYPE_CODE = 'NhomGia'        where A.DICHVU_ID = '5435' and A.BENHVIEN_ID = 'HLU01' and DIC.DICTIONARY_CODE != 'BHYT']
2019-12-10 17:53:16,504 [1] DEBUG - Statement Id: [DAO00000_GetDONGIA_BY_DICHVU_LOAIGIA] PreparedStatement : [SELECT DD.*              FROM TM_DICHVU_DONGIA DD              WHERE DD.DICHVU_ID = '5435' AND DD.LOAIGIA_ID = '3' AND DD.BENHVIEN_ID = 'HLU01' AND DD.TAMNGUNG = '0']
2019-12-10 17:53:16,536 [1] DEBUG - Statement Id: [DAO00099_GetLoaiGiaDichVu] PreparedStatement : [select A.LOAIGIA_ID,B.TENLOAIGIA, B.MALOAIGIA        from TM_DICHVU_DONGIA A        inner join TM_LOAIGIA B on A.LOAIGIA_ID = B.LOAIGIA_ID        inner join LST_DICTIONARY AS DIC ON DIC.DICTIONARY_ID = B.NHOMGIA_ID AND DIC.DICTIONARY_TYPE_CODE = 'NhomGia'        where A.DICHVU_ID = '5438' and A.BENHVIEN_ID = 'HLU01' and DIC.DICTIONARY_CODE != 'BHYT']
2019-12-10 17:53:16,571 [1] DEBUG - Statement Id: [DAO00000_GetDONGIA_BY_DICHVU_LOAIGIA] PreparedStatement : [SELECT DD.*              FROM TM_DICHVU_DONGIA DD              WHERE DD.DICHVU_ID = '5438' AND DD.LOAIGIA_ID = '3' AND DD.BENHVIEN_ID = 'HLU01' AND DD.TAMNGUNG = '0']
2019-12-10 17:53:16,601 [1] DEBUG - Statement Id: [DAO00099_GetLoaiGiaDichVu] PreparedStatement : [select A.LOAIGIA_ID,B.TENLOAIGIA, B.MALOAIGIA        from TM_DICHVU_DONGIA A        inner join TM_LOAIGIA B on A.LOAIGIA_ID = B.LOAIGIA_ID        inner join LST_DICTIONARY AS DIC ON DIC.DICTIONARY_ID = B.NHOMGIA_ID AND DIC.DICTIONARY_TYPE_CODE = 'NhomGia'        where A.DICHVU_ID = '4129' and A.BENHVIEN_ID = 'HLU01' and DIC.DICTIONARY_CODE != 'BHYT']
2019-12-10 17:53:16,639 [1] DEBUG - Statement Id: [DAO00000_GetDONGIA_BY_DICHVU_LOAIGIA] PreparedStatement : [SELECT DD.*              FROM TM_DICHVU_DONGIA DD              WHERE DD.DICHVU_ID = '4129' AND DD.LOAIGIA_ID = '3' AND DD.BENHVIEN_ID = 'HLU01' AND DD.TAMNGUNG = '0']
2019-12-10 17:53:16,669 [1] DEBUG - Statement Id: [DAO00099_GetLoaiGiaDichVu] PreparedStatement : [select A.LOAIGIA_ID,B.TENLOAIGIA, B.MALOAIGIA        from TM_DICHVU_DONGIA A        inner join TM_LOAIGIA B on A.LOAIGIA_ID = B.LOAIGIA_ID        inner join LST_DICTIONARY AS DIC ON DIC.DICTIONARY_ID = B.NHOMGIA_ID AND DIC.DICTIONARY_TYPE_CODE = 'NhomGia'        where A.DICHVU_ID = '4017' and A.BENHVIEN_ID = 'HLU01' and DIC.DICTIONARY_CODE != 'BHYT']
2019-12-10 17:53:16,712 [1] DEBUG - Statement Id: [DAO00000_GetDONGIA_BY_DICHVU_LOAIGIA] PreparedStatement : [SELECT DD.*              FROM TM_DICHVU_DONGIA DD              WHERE DD.DICHVU_ID = '4017' AND DD.LOAIGIA_ID = '3' AND DD.BENHVIEN_ID = 'HLU01' AND DD.TAMNGUNG = '0']
2019-12-10 17:53:16,745 [1] DEBUG - Statement Id: [DAO00099_GetLoaiGiaDichVu] PreparedStatement : [select A.LOAIGIA_ID,B.TENLOAIGIA, B.MALOAIGIA        from TM_DICHVU_DONGIA A        inner join TM_LOAIGIA B on A.LOAIGIA_ID = B.LOAIGIA_ID        inner join LST_DICTIONARY AS DIC ON DIC.DICTIONARY_ID = B.NHOMGIA_ID AND DIC.DICTIONARY_TYPE_CODE = 'NhomGia'        where A.DICHVU_ID = '4523' and A.BENHVIEN_ID = 'HLU01' and DIC.DICTIONARY_CODE != 'BHYT']
2019-12-10 17:53:16,786 [1] DEBUG - Statement Id: [DAO00000_GetDONGIA_BY_DICHVU_LOAIGIA] PreparedStatement : [SELECT DD.*              FROM TM_DICHVU_DONGIA DD              WHERE DD.DICHVU_ID = '4523' AND DD.LOAIGIA_ID = '3' AND DD.BENHVIEN_ID = 'HLU01' AND DD.TAMNGUNG = '0']
--------------------------------------------------------------------------------
2019-12-10 17:57:30,447 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2019-12-10 17:57:30,757 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-12-10 17:57:30,794 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-12-10 17:57:31,238 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 17:57:31,528 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-12-10 17:57:36,244 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2019-12-10 17:57:36,269 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-12-10 17:57:38,991 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-12-10 17:57:39,073 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-12-10 17:57:40,155 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2019-12-10 17:57:40,501 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2019-12-10 17:57:40,598 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2019-12-10 17:57:40,726 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2019-12-10 17:57:40,875 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2019-12-10 17:57:41,041 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2019-12-10 17:57:41,113 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2019-12-10 17:57:41,215 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2019-12-10 17:57:41,319 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2019-12-10 17:57:42,051 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2019-12-10 17:57:42,082 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2019-12-10 17:57:42,169 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2019-12-10 17:57:42,206 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2019-12-10 17:57:43,139 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2019-12-10 17:57:43,210 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @NGUONDUOC_MACDINH varchar(5) = '0';        declare @TOAMUANGOAI int = 0;        select @NGUONDUOC_MACDINH = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'PHA_NGUONDUOC'        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + @NGUONDUOC_MACDINH as DUOC_KEY, 0 as PHAMVI_ID, @NGUONDUOC_MACDINH as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end        else        begin                  select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2019-12-10 17:57:45,370 [5] DEBUG - Statement Id: [DAO00320_GetList] PreparedStatement : [select M.*            from TM_MAU M            LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID            where            M.TAMNGUNG = '0'            and M.BENHVIEN_ID = 'HLU01'            order by M.TENMAU]
2019-12-10 17:57:45,495 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2019-12-10 17:57:45,565 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,        SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH        FROM TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID        WHERE TK.SOLUONG > 0        GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2019-12-10 17:57:45,687 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2019-12-10 17:57:45,727 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,        TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,        TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH        from TM_MAU M        JOIN        (        select        A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO        from        (        select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO        from TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'        where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0        ) A        )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2019-12-10 17:57:45,804 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2019-12-10 17:57:46,825 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 17:57:47,632 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2019-12-10 17:57:53,235 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2019-12-10 17:57:53,262 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2019-12-10 17:57:53,337 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 17:57:53,454 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 17:57:53,597 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2019-12-10 17:57:53,600 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-12-10 17:57:53,600 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-12-10 17:57:53,629 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2019-12-10 17:57:53,629 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-12-10 17:57:53,629 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-12-10 17:57:53,765 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 17:57:53,987 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 17:58:12,289 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 17:58:12,376 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2019-12-10 17:58:12,670 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2019-12-10 17:58:26,209 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MKT15'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 17:58:27,290 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_GetList] PreparedStatement : [select * from TM_CSKH_GOI A         where               A.TRANGTHAI = 'GOIDUOCPHEPBAN'           and             convert(date,A.NGAYTAO) between convert(date, '12/10/2019 5:58:26 PM') and convert(date, '12/10/2019 5:58:26 PM')           and             A.BENHVIEN_ID = 'HLU01']
2019-12-10 17:58:29,078 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_Get] PreparedStatement : [select A.*, B.SOLANSUDUNG        from TM_CSKH_GOI A        left join        (select count(*) as SOLANSUDUNG, GOI_ID        from TT_CSKH_GOI_DANGKY        group by GOI_ID        )B on B.GOI_ID = a.GOI_ID         where               A.GOI_ID = '4'           and             A.BENHVIEN_ID = 'HLU01']
2019-12-10 17:58:29,127 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_GetDetail] PreparedStatement : [select A.*, DV.MADICHVU from TM_CSKH_GOI_CHITIET A        left join TM_DICHVU dv on dv.DICHVU_ID = A.DICHVU_ID         where                 A.GOI_ID = '4'             and               A.BENHVIEN_ID = 'HLU01']
2019-12-10 17:58:29,294 [1] DEBUG - Statement Id: [DAO00000_GetDICHVU_DONGIA_LOAIGIA] PreparedStatement : [select A.LOAIGIA_ID, A.BANGGIA_ID, A.GIAVON, A.TYLEVAT  as TYLE_VAT, A.TYLE_LOINHUAN,            A.DONGIA as DONGIA_DOANHTHU, NULL as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DICHVU_DONGIA A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '5435' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.LOAIGIA_ID = '3' and A.DICHVU_ID = '5435'            union            select A.LOAIGIA_ID, null as BANGGIA_ID, null as GIAVON, null as TYLE_VAT, null as TYLE_LOINHUAN,            null as DONGIA_DOANHTHU, C.DONGIA as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DOITUONG_GIADICHVU A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join TM_DICHVU_DONGIA C on C.LOAIGIA_ID = A.LOAIGIA_ID AND C.BENHVIEN_ID = 'HLU01'            and C.BANGGIA_ID = B.BANGGIA_ID and C.DICHVU_ID = A.DICHVU_ID            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '5435' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.DOITUONG_ID = '1'  and A.DICHVU_ID = '5435' and A.LOAIGIA_ID            in (select top 1 LOAIGIA_ID from TM_DOITUONG_LOAIGIA            where DOITUONG_ID = '1' and GIAHOTRO = '1'  AND BENHVIEN_ID = 'HLU01'            and LOAIGIA_ID            in (select LOAIGIA_ID from TM_BANGGIA            where LOAIBANGGIA in            (select LOAIBANGGIA from TM_BANGGIA where LOAIGIA_ID = '3'  AND BENHVIEN_ID = 'HLU01')            and TAMNGUNG = '0')  AND BENHVIEN_ID = 'HLU01'            )]
2019-12-10 17:58:29,331 [1] DEBUG - Statement Id: [DAO00000_GetDICHVU_DONGIA_LOAIGIA] PreparedStatement : [select A.LOAIGIA_ID, A.BANGGIA_ID, A.GIAVON, A.TYLEVAT  as TYLE_VAT, A.TYLE_LOINHUAN,            A.DONGIA as DONGIA_DOANHTHU, NULL as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DICHVU_DONGIA A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '5438' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.LOAIGIA_ID = '3' and A.DICHVU_ID = '5438'            union            select A.LOAIGIA_ID, null as BANGGIA_ID, null as GIAVON, null as TYLE_VAT, null as TYLE_LOINHUAN,            null as DONGIA_DOANHTHU, C.DONGIA as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DOITUONG_GIADICHVU A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join TM_DICHVU_DONGIA C on C.LOAIGIA_ID = A.LOAIGIA_ID AND C.BENHVIEN_ID = 'HLU01'            and C.BANGGIA_ID = B.BANGGIA_ID and C.DICHVU_ID = A.DICHVU_ID            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '5438' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.DOITUONG_ID = '1'  and A.DICHVU_ID = '5438' and A.LOAIGIA_ID            in (select top 1 LOAIGIA_ID from TM_DOITUONG_LOAIGIA            where DOITUONG_ID = '1' and GIAHOTRO = '1'  AND BENHVIEN_ID = 'HLU01'            and LOAIGIA_ID            in (select LOAIGIA_ID from TM_BANGGIA            where LOAIBANGGIA in            (select LOAIBANGGIA from TM_BANGGIA where LOAIGIA_ID = '3'  AND BENHVIEN_ID = 'HLU01')            and TAMNGUNG = '0')  AND BENHVIEN_ID = 'HLU01'            )]
2019-12-10 17:58:29,381 [1] DEBUG - Statement Id: [DAO00000_GetDICHVU_DONGIA_LOAIGIA] PreparedStatement : [select A.LOAIGIA_ID, A.BANGGIA_ID, A.GIAVON, A.TYLEVAT  as TYLE_VAT, A.TYLE_LOINHUAN,            A.DONGIA as DONGIA_DOANHTHU, NULL as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DICHVU_DONGIA A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '4129' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.LOAIGIA_ID = '3' and A.DICHVU_ID = '4129'            union            select A.LOAIGIA_ID, null as BANGGIA_ID, null as GIAVON, null as TYLE_VAT, null as TYLE_LOINHUAN,            null as DONGIA_DOANHTHU, C.DONGIA as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DOITUONG_GIADICHVU A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join TM_DICHVU_DONGIA C on C.LOAIGIA_ID = A.LOAIGIA_ID AND C.BENHVIEN_ID = 'HLU01'            and C.BANGGIA_ID = B.BANGGIA_ID and C.DICHVU_ID = A.DICHVU_ID            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '4129' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.DOITUONG_ID = '1'  and A.DICHVU_ID = '4129' and A.LOAIGIA_ID            in (select top 1 LOAIGIA_ID from TM_DOITUONG_LOAIGIA            where DOITUONG_ID = '1' and GIAHOTRO = '1'  AND BENHVIEN_ID = 'HLU01'            and LOAIGIA_ID            in (select LOAIGIA_ID from TM_BANGGIA            where LOAIBANGGIA in            (select LOAIBANGGIA from TM_BANGGIA where LOAIGIA_ID = '3'  AND BENHVIEN_ID = 'HLU01')            and TAMNGUNG = '0')  AND BENHVIEN_ID = 'HLU01'            )]
2019-12-10 17:58:29,415 [1] DEBUG - Statement Id: [DAO00000_GetDICHVU_DONGIA_LOAIGIA] PreparedStatement : [select A.LOAIGIA_ID, A.BANGGIA_ID, A.GIAVON, A.TYLEVAT  as TYLE_VAT, A.TYLE_LOINHUAN,            A.DONGIA as DONGIA_DOANHTHU, NULL as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DICHVU_DONGIA A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '4017' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.LOAIGIA_ID = '3' and A.DICHVU_ID = '4017'            union            select A.LOAIGIA_ID, null as BANGGIA_ID, null as GIAVON, null as TYLE_VAT, null as TYLE_LOINHUAN,            null as DONGIA_DOANHTHU, C.DONGIA as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DOITUONG_GIADICHVU A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join TM_DICHVU_DONGIA C on C.LOAIGIA_ID = A.LOAIGIA_ID AND C.BENHVIEN_ID = 'HLU01'            and C.BANGGIA_ID = B.BANGGIA_ID and C.DICHVU_ID = A.DICHVU_ID            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '4017' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.DOITUONG_ID = '1'  and A.DICHVU_ID = '4017' and A.LOAIGIA_ID            in (select top 1 LOAIGIA_ID from TM_DOITUONG_LOAIGIA            where DOITUONG_ID = '1' and GIAHOTRO = '1'  AND BENHVIEN_ID = 'HLU01'            and LOAIGIA_ID            in (select LOAIGIA_ID from TM_BANGGIA            where LOAIBANGGIA in            (select LOAIBANGGIA from TM_BANGGIA where LOAIGIA_ID = '3'  AND BENHVIEN_ID = 'HLU01')            and TAMNGUNG = '0')  AND BENHVIEN_ID = 'HLU01'            )]
2019-12-10 17:58:29,450 [1] DEBUG - Statement Id: [DAO00000_GetDICHVU_DONGIA_LOAIGIA] PreparedStatement : [select A.LOAIGIA_ID, A.BANGGIA_ID, A.GIAVON, A.TYLEVAT  as TYLE_VAT, A.TYLE_LOINHUAN,            A.DONGIA as DONGIA_DOANHTHU, NULL as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DICHVU_DONGIA A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '4523' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.LOAIGIA_ID = '3' and A.DICHVU_ID = '4523'            union            select A.LOAIGIA_ID, null as BANGGIA_ID, null as GIAVON, null as TYLE_VAT, null as TYLE_LOINHUAN,            null as DONGIA_DOANHTHU, C.DONGIA as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DOITUONG_GIADICHVU A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join TM_DICHVU_DONGIA C on C.LOAIGIA_ID = A.LOAIGIA_ID AND C.BENHVIEN_ID = 'HLU01'            and C.BANGGIA_ID = B.BANGGIA_ID and C.DICHVU_ID = A.DICHVU_ID            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '4523' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.DOITUONG_ID = '1'  and A.DICHVU_ID = '4523' and A.LOAIGIA_ID            in (select top 1 LOAIGIA_ID from TM_DOITUONG_LOAIGIA            where DOITUONG_ID = '1' and GIAHOTRO = '1'  AND BENHVIEN_ID = 'HLU01'            and LOAIGIA_ID            in (select LOAIGIA_ID from TM_BANGGIA            where LOAIBANGGIA in            (select LOAIBANGGIA from TM_BANGGIA where LOAIGIA_ID = '3'  AND BENHVIEN_ID = 'HLU01')            and TAMNGUNG = '0')  AND BENHVIEN_ID = 'HLU01'            )]
2019-12-10 17:58:36,408 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM98'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 17:58:43,669 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_Get] PreparedStatement : [select A.*, B.SOLANSUDUNG        from TM_CSKH_GOI A        left join        (select count(*) as SOLANSUDUNG, GOI_ID        from TT_CSKH_GOI_DANGKY        group by GOI_ID        )B on B.GOI_ID = a.GOI_ID         where               A.GOI_ID = '4'           and             A.BENHVIEN_ID = 'HLU01']
2019-12-10 17:58:43,717 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_GetDetail] PreparedStatement : [select A.*, DV.MADICHVU from TM_CSKH_GOI_CHITIET A        left join TM_DICHVU dv on dv.DICHVU_ID = A.DICHVU_ID         where                 A.GOI_ID = '4'             and               A.BENHVIEN_ID = 'HLU01']
2019-12-10 17:58:43,775 [1] DEBUG - Statement Id: [DAO00000_GetDICHVU_DONGIA_LOAIGIA] PreparedStatement : [select A.LOAIGIA_ID, A.BANGGIA_ID, A.GIAVON, A.TYLEVAT  as TYLE_VAT, A.TYLE_LOINHUAN,            A.DONGIA as DONGIA_DOANHTHU, NULL as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DICHVU_DONGIA A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '5435' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.LOAIGIA_ID = '3' and A.DICHVU_ID = '5435'            union            select A.LOAIGIA_ID, null as BANGGIA_ID, null as GIAVON, null as TYLE_VAT, null as TYLE_LOINHUAN,            null as DONGIA_DOANHTHU, C.DONGIA as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DOITUONG_GIADICHVU A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join TM_DICHVU_DONGIA C on C.LOAIGIA_ID = A.LOAIGIA_ID AND C.BENHVIEN_ID = 'HLU01'            and C.BANGGIA_ID = B.BANGGIA_ID and C.DICHVU_ID = A.DICHVU_ID            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '5435' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.DOITUONG_ID = '1'  and A.DICHVU_ID = '5435' and A.LOAIGIA_ID            in (select top 1 LOAIGIA_ID from TM_DOITUONG_LOAIGIA            where DOITUONG_ID = '1' and GIAHOTRO = '1'  AND BENHVIEN_ID = 'HLU01'            and LOAIGIA_ID            in (select LOAIGIA_ID from TM_BANGGIA            where LOAIBANGGIA in            (select LOAIBANGGIA from TM_BANGGIA where LOAIGIA_ID = '3'  AND BENHVIEN_ID = 'HLU01')            and TAMNGUNG = '0')  AND BENHVIEN_ID = 'HLU01'            )]
2019-12-10 17:58:43,808 [1] DEBUG - Statement Id: [DAO00000_GetDICHVU_DONGIA_LOAIGIA] PreparedStatement : [select A.LOAIGIA_ID, A.BANGGIA_ID, A.GIAVON, A.TYLEVAT  as TYLE_VAT, A.TYLE_LOINHUAN,            A.DONGIA as DONGIA_DOANHTHU, NULL as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DICHVU_DONGIA A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '5438' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.LOAIGIA_ID = '3' and A.DICHVU_ID = '5438'            union            select A.LOAIGIA_ID, null as BANGGIA_ID, null as GIAVON, null as TYLE_VAT, null as TYLE_LOINHUAN,            null as DONGIA_DOANHTHU, C.DONGIA as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DOITUONG_GIADICHVU A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join TM_DICHVU_DONGIA C on C.LOAIGIA_ID = A.LOAIGIA_ID AND C.BENHVIEN_ID = 'HLU01'            and C.BANGGIA_ID = B.BANGGIA_ID and C.DICHVU_ID = A.DICHVU_ID            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '5438' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.DOITUONG_ID = '1'  and A.DICHVU_ID = '5438' and A.LOAIGIA_ID            in (select top 1 LOAIGIA_ID from TM_DOITUONG_LOAIGIA            where DOITUONG_ID = '1' and GIAHOTRO = '1'  AND BENHVIEN_ID = 'HLU01'            and LOAIGIA_ID            in (select LOAIGIA_ID from TM_BANGGIA            where LOAIBANGGIA in            (select LOAIBANGGIA from TM_BANGGIA where LOAIGIA_ID = '3'  AND BENHVIEN_ID = 'HLU01')            and TAMNGUNG = '0')  AND BENHVIEN_ID = 'HLU01'            )]
2019-12-10 17:58:43,840 [1] DEBUG - Statement Id: [DAO00000_GetDICHVU_DONGIA_LOAIGIA] PreparedStatement : [select A.LOAIGIA_ID, A.BANGGIA_ID, A.GIAVON, A.TYLEVAT  as TYLE_VAT, A.TYLE_LOINHUAN,            A.DONGIA as DONGIA_DOANHTHU, NULL as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DICHVU_DONGIA A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '4129' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.LOAIGIA_ID = '3' and A.DICHVU_ID = '4129'            union            select A.LOAIGIA_ID, null as BANGGIA_ID, null as GIAVON, null as TYLE_VAT, null as TYLE_LOINHUAN,            null as DONGIA_DOANHTHU, C.DONGIA as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DOITUONG_GIADICHVU A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join TM_DICHVU_DONGIA C on C.LOAIGIA_ID = A.LOAIGIA_ID AND C.BENHVIEN_ID = 'HLU01'            and C.BANGGIA_ID = B.BANGGIA_ID and C.DICHVU_ID = A.DICHVU_ID            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '4129' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.DOITUONG_ID = '1'  and A.DICHVU_ID = '4129' and A.LOAIGIA_ID            in (select top 1 LOAIGIA_ID from TM_DOITUONG_LOAIGIA            where DOITUONG_ID = '1' and GIAHOTRO = '1'  AND BENHVIEN_ID = 'HLU01'            and LOAIGIA_ID            in (select LOAIGIA_ID from TM_BANGGIA            where LOAIBANGGIA in            (select LOAIBANGGIA from TM_BANGGIA where LOAIGIA_ID = '3'  AND BENHVIEN_ID = 'HLU01')            and TAMNGUNG = '0')  AND BENHVIEN_ID = 'HLU01'            )]
2019-12-10 17:58:43,875 [1] DEBUG - Statement Id: [DAO00000_GetDICHVU_DONGIA_LOAIGIA] PreparedStatement : [select A.LOAIGIA_ID, A.BANGGIA_ID, A.GIAVON, A.TYLEVAT  as TYLE_VAT, A.TYLE_LOINHUAN,            A.DONGIA as DONGIA_DOANHTHU, NULL as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DICHVU_DONGIA A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '4017' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.LOAIGIA_ID = '3' and A.DICHVU_ID = '4017'            union            select A.LOAIGIA_ID, null as BANGGIA_ID, null as GIAVON, null as TYLE_VAT, null as TYLE_LOINHUAN,            null as DONGIA_DOANHTHU, C.DONGIA as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DOITUONG_GIADICHVU A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join TM_DICHVU_DONGIA C on C.LOAIGIA_ID = A.LOAIGIA_ID AND C.BENHVIEN_ID = 'HLU01'            and C.BANGGIA_ID = B.BANGGIA_ID and C.DICHVU_ID = A.DICHVU_ID            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '4017' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.DOITUONG_ID = '1'  and A.DICHVU_ID = '4017' and A.LOAIGIA_ID            in (select top 1 LOAIGIA_ID from TM_DOITUONG_LOAIGIA            where DOITUONG_ID = '1' and GIAHOTRO = '1'  AND BENHVIEN_ID = 'HLU01'            and LOAIGIA_ID            in (select LOAIGIA_ID from TM_BANGGIA            where LOAIBANGGIA in            (select LOAIBANGGIA from TM_BANGGIA where LOAIGIA_ID = '3'  AND BENHVIEN_ID = 'HLU01')            and TAMNGUNG = '0')  AND BENHVIEN_ID = 'HLU01'            )]
2019-12-10 17:58:43,911 [1] DEBUG - Statement Id: [DAO00000_GetDICHVU_DONGIA_LOAIGIA] PreparedStatement : [select A.LOAIGIA_ID, A.BANGGIA_ID, A.GIAVON, A.TYLEVAT  as TYLE_VAT, A.TYLE_LOINHUAN,            A.DONGIA as DONGIA_DOANHTHU, NULL as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DICHVU_DONGIA A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '4523' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.LOAIGIA_ID = '3' and A.DICHVU_ID = '4523'            union            select A.LOAIGIA_ID, null as BANGGIA_ID, null as GIAVON, null as TYLE_VAT, null as TYLE_LOINHUAN,            null as DONGIA_DOANHTHU, C.DONGIA as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DOITUONG_GIADICHVU A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join TM_DICHVU_DONGIA C on C.LOAIGIA_ID = A.LOAIGIA_ID AND C.BENHVIEN_ID = 'HLU01'            and C.BANGGIA_ID = B.BANGGIA_ID and C.DICHVU_ID = A.DICHVU_ID            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '4523' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.DOITUONG_ID = '1'  and A.DICHVU_ID = '4523' and A.LOAIGIA_ID            in (select top 1 LOAIGIA_ID from TM_DOITUONG_LOAIGIA            where DOITUONG_ID = '1' and GIAHOTRO = '1'  AND BENHVIEN_ID = 'HLU01'            and LOAIGIA_ID            in (select LOAIGIA_ID from TM_BANGGIA            where LOAIBANGGIA in            (select LOAIBANGGIA from TM_BANGGIA where LOAIGIA_ID = '3'  AND BENHVIEN_ID = 'HLU01')            and TAMNGUNG = '0')  AND BENHVIEN_ID = 'HLU01'            )]
--------------------------------------------------------------------------------
2019-12-10 18:00:06,713 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2019-12-10 18:00:06,965 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-12-10 18:00:07,002 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-12-10 18:00:07,742 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 18:00:08,079 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-12-10 18:00:56,808 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2019-12-10 18:00:56,833 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-12-10 18:00:58,428 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-12-10 18:00:58,520 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-12-10 18:00:59,379 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2019-12-10 18:00:59,548 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2019-12-10 18:00:59,617 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2019-12-10 18:00:59,700 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2019-12-10 18:00:59,774 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2019-12-10 18:00:59,850 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2019-12-10 18:00:59,946 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2019-12-10 18:01:00,104 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2019-12-10 18:01:00,186 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2019-12-10 18:01:00,717 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2019-12-10 18:01:00,786 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2019-12-10 18:01:00,856 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2019-12-10 18:01:00,925 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2019-12-10 18:01:01,683 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2019-12-10 18:01:01,715 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @NGUONDUOC_MACDINH varchar(5) = '0';        declare @TOAMUANGOAI int = 0;        select @NGUONDUOC_MACDINH = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'PHA_NGUONDUOC'        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + @NGUONDUOC_MACDINH as DUOC_KEY, 0 as PHAMVI_ID, @NGUONDUOC_MACDINH as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end        else        begin                  select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2019-12-10 18:01:03,606 [5] DEBUG - Statement Id: [DAO00320_GetList] PreparedStatement : [select M.*            from TM_MAU M            LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID            where            M.TAMNGUNG = '0'            and M.BENHVIEN_ID = 'HLU01'            order by M.TENMAU]
2019-12-10 18:01:03,671 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2019-12-10 18:01:03,702 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,        SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH        FROM TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID        WHERE TK.SOLUONG > 0        GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2019-12-10 18:01:03,832 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2019-12-10 18:01:03,861 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,        TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,        TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH        from TM_MAU M        JOIN        (        select        A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO        from        (        select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO        from TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'        where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0        ) A        )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2019-12-10 18:01:03,927 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2019-12-10 18:01:04,861 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 18:01:05,626 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2019-12-10 18:01:10,250 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2019-12-10 18:01:10,277 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2019-12-10 18:01:10,368 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 18:01:10,489 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 18:01:10,641 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2019-12-10 18:01:10,644 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-12-10 18:01:10,644 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-12-10 18:01:10,671 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2019-12-10 18:01:10,671 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-12-10 18:01:10,672 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-12-10 18:01:10,808 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 18:01:10,965 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 18:01:24,290 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 18:01:24,387 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2019-12-10 18:01:24,612 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2019-12-10 18:01:29,342 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MKT15'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 18:01:30,253 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_GetList] PreparedStatement : [select * from TM_CSKH_GOI A         where               A.TRANGTHAI = 'GOIDUOCPHEPBAN'           and             convert(date,A.NGAYTAO) between convert(date, '12/10/2019 6:01:29 PM') and convert(date, '12/10/2019 6:01:29 PM')           and             A.BENHVIEN_ID = 'HLU01']
2019-12-10 18:01:31,889 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_Get] PreparedStatement : [select A.*, B.SOLANSUDUNG        from TM_CSKH_GOI A        left join        (select count(*) as SOLANSUDUNG, GOI_ID        from TT_CSKH_GOI_DANGKY        group by GOI_ID        )B on B.GOI_ID = a.GOI_ID         where               A.GOI_ID = '4'           and             A.BENHVIEN_ID = 'HLU01']
2019-12-10 18:01:31,939 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_GetDetail] PreparedStatement : [select A.*, DV.MADICHVU from TM_CSKH_GOI_CHITIET A        left join TM_DICHVU dv on dv.DICHVU_ID = A.DICHVU_ID         where                 A.GOI_ID = '4'             and               A.BENHVIEN_ID = 'HLU01']
2019-12-10 18:01:32,085 [1] DEBUG - Statement Id: [DAO00000_GetDICHVU_DONGIA_LOAIGIA] PreparedStatement : [select A.LOAIGIA_ID, A.BANGGIA_ID, A.GIAVON, A.TYLEVAT  as TYLE_VAT, A.TYLE_LOINHUAN,            A.DONGIA as DONGIA_DOANHTHU, NULL as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DICHVU_DONGIA A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '5435' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.LOAIGIA_ID = '3' and A.DICHVU_ID = '5435'            union            select A.LOAIGIA_ID, null as BANGGIA_ID, null as GIAVON, null as TYLE_VAT, null as TYLE_LOINHUAN,            null as DONGIA_DOANHTHU, C.DONGIA as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DOITUONG_GIADICHVU A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join TM_DICHVU_DONGIA C on C.LOAIGIA_ID = A.LOAIGIA_ID AND C.BENHVIEN_ID = 'HLU01'            and C.BANGGIA_ID = B.BANGGIA_ID and C.DICHVU_ID = A.DICHVU_ID            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '5435' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.DOITUONG_ID = '1'  and A.DICHVU_ID = '5435' and A.LOAIGIA_ID            in (select top 1 LOAIGIA_ID from TM_DOITUONG_LOAIGIA            where DOITUONG_ID = '1' and GIAHOTRO = '1'  AND BENHVIEN_ID = 'HLU01'            and LOAIGIA_ID            in (select LOAIGIA_ID from TM_BANGGIA            where LOAIBANGGIA in            (select LOAIBANGGIA from TM_BANGGIA where LOAIGIA_ID = '3'  AND BENHVIEN_ID = 'HLU01')            and TAMNGUNG = '0')  AND BENHVIEN_ID = 'HLU01'            )]
2019-12-10 18:01:32,119 [1] DEBUG - Statement Id: [DAO00000_GetDICHVU_DONGIA_LOAIGIA] PreparedStatement : [select A.LOAIGIA_ID, A.BANGGIA_ID, A.GIAVON, A.TYLEVAT  as TYLE_VAT, A.TYLE_LOINHUAN,            A.DONGIA as DONGIA_DOANHTHU, NULL as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DICHVU_DONGIA A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '5438' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.LOAIGIA_ID = '3' and A.DICHVU_ID = '5438'            union            select A.LOAIGIA_ID, null as BANGGIA_ID, null as GIAVON, null as TYLE_VAT, null as TYLE_LOINHUAN,            null as DONGIA_DOANHTHU, C.DONGIA as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DOITUONG_GIADICHVU A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join TM_DICHVU_DONGIA C on C.LOAIGIA_ID = A.LOAIGIA_ID AND C.BENHVIEN_ID = 'HLU01'            and C.BANGGIA_ID = B.BANGGIA_ID and C.DICHVU_ID = A.DICHVU_ID            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '5438' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.DOITUONG_ID = '1'  and A.DICHVU_ID = '5438' and A.LOAIGIA_ID            in (select top 1 LOAIGIA_ID from TM_DOITUONG_LOAIGIA            where DOITUONG_ID = '1' and GIAHOTRO = '1'  AND BENHVIEN_ID = 'HLU01'            and LOAIGIA_ID            in (select LOAIGIA_ID from TM_BANGGIA            where LOAIBANGGIA in            (select LOAIBANGGIA from TM_BANGGIA where LOAIGIA_ID = '3'  AND BENHVIEN_ID = 'HLU01')            and TAMNGUNG = '0')  AND BENHVIEN_ID = 'HLU01'            )]
2019-12-10 18:01:32,153 [1] DEBUG - Statement Id: [DAO00000_GetDICHVU_DONGIA_LOAIGIA] PreparedStatement : [select A.LOAIGIA_ID, A.BANGGIA_ID, A.GIAVON, A.TYLEVAT  as TYLE_VAT, A.TYLE_LOINHUAN,            A.DONGIA as DONGIA_DOANHTHU, NULL as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DICHVU_DONGIA A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '4129' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.LOAIGIA_ID = '3' and A.DICHVU_ID = '4129'            union            select A.LOAIGIA_ID, null as BANGGIA_ID, null as GIAVON, null as TYLE_VAT, null as TYLE_LOINHUAN,            null as DONGIA_DOANHTHU, C.DONGIA as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DOITUONG_GIADICHVU A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join TM_DICHVU_DONGIA C on C.LOAIGIA_ID = A.LOAIGIA_ID AND C.BENHVIEN_ID = 'HLU01'            and C.BANGGIA_ID = B.BANGGIA_ID and C.DICHVU_ID = A.DICHVU_ID            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '4129' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.DOITUONG_ID = '1'  and A.DICHVU_ID = '4129' and A.LOAIGIA_ID            in (select top 1 LOAIGIA_ID from TM_DOITUONG_LOAIGIA            where DOITUONG_ID = '1' and GIAHOTRO = '1'  AND BENHVIEN_ID = 'HLU01'            and LOAIGIA_ID            in (select LOAIGIA_ID from TM_BANGGIA            where LOAIBANGGIA in            (select LOAIBANGGIA from TM_BANGGIA where LOAIGIA_ID = '3'  AND BENHVIEN_ID = 'HLU01')            and TAMNGUNG = '0')  AND BENHVIEN_ID = 'HLU01'            )]
2019-12-10 18:01:32,186 [1] DEBUG - Statement Id: [DAO00000_GetDICHVU_DONGIA_LOAIGIA] PreparedStatement : [select A.LOAIGIA_ID, A.BANGGIA_ID, A.GIAVON, A.TYLEVAT  as TYLE_VAT, A.TYLE_LOINHUAN,            A.DONGIA as DONGIA_DOANHTHU, NULL as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DICHVU_DONGIA A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '4017' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.LOAIGIA_ID = '3' and A.DICHVU_ID = '4017'            union            select A.LOAIGIA_ID, null as BANGGIA_ID, null as GIAVON, null as TYLE_VAT, null as TYLE_LOINHUAN,            null as DONGIA_DOANHTHU, C.DONGIA as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DOITUONG_GIADICHVU A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join TM_DICHVU_DONGIA C on C.LOAIGIA_ID = A.LOAIGIA_ID AND C.BENHVIEN_ID = 'HLU01'            and C.BANGGIA_ID = B.BANGGIA_ID and C.DICHVU_ID = A.DICHVU_ID            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '4017' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.DOITUONG_ID = '1'  and A.DICHVU_ID = '4017' and A.LOAIGIA_ID            in (select top 1 LOAIGIA_ID from TM_DOITUONG_LOAIGIA            where DOITUONG_ID = '1' and GIAHOTRO = '1'  AND BENHVIEN_ID = 'HLU01'            and LOAIGIA_ID            in (select LOAIGIA_ID from TM_BANGGIA            where LOAIBANGGIA in            (select LOAIBANGGIA from TM_BANGGIA where LOAIGIA_ID = '3'  AND BENHVIEN_ID = 'HLU01')            and TAMNGUNG = '0')  AND BENHVIEN_ID = 'HLU01'            )]
2019-12-10 18:01:32,217 [1] DEBUG - Statement Id: [DAO00000_GetDICHVU_DONGIA_LOAIGIA] PreparedStatement : [select A.LOAIGIA_ID, A.BANGGIA_ID, A.GIAVON, A.TYLEVAT  as TYLE_VAT, A.TYLE_LOINHUAN,            A.DONGIA as DONGIA_DOANHTHU, NULL as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DICHVU_DONGIA A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '4523' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.LOAIGIA_ID = '3' and A.DICHVU_ID = '4523'            union            select A.LOAIGIA_ID, null as BANGGIA_ID, null as GIAVON, null as TYLE_VAT, null as TYLE_LOINHUAN,            null as DONGIA_DOANHTHU, C.DONGIA as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DOITUONG_GIADICHVU A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join TM_DICHVU_DONGIA C on C.LOAIGIA_ID = A.LOAIGIA_ID AND C.BENHVIEN_ID = 'HLU01'            and C.BANGGIA_ID = B.BANGGIA_ID and C.DICHVU_ID = A.DICHVU_ID            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '4523' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.DOITUONG_ID = '1'  and A.DICHVU_ID = '4523' and A.LOAIGIA_ID            in (select top 1 LOAIGIA_ID from TM_DOITUONG_LOAIGIA            where DOITUONG_ID = '1' and GIAHOTRO = '1'  AND BENHVIEN_ID = 'HLU01'            and LOAIGIA_ID            in (select LOAIGIA_ID from TM_BANGGIA            where LOAIBANGGIA in            (select LOAIBANGGIA from TM_BANGGIA where LOAIGIA_ID = '3'  AND BENHVIEN_ID = 'HLU01')            and TAMNGUNG = '0')  AND BENHVIEN_ID = 'HLU01'            )]
2019-12-10 18:01:38,091 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'HSM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-10 18:01:39,906 [1] DEBUG - Statement Id: [DAO00099_GetListLoaiGoiDV] PreparedStatement : [select * from LST_DICTIONARY        where        DICTIONARY_TYPE_CODE = 'LoaiGoiDV']
2019-12-10 18:01:40,103 [1] DEBUG - Statement Id: [DAO00017_GetDanhSachNoiThucHien] PreparedStatement : [select pb.PHONGBAN_ID, pb.TENPHONGBAN              from [TM_PHONGBAN] as pb              left join LST_DICTIONARY dic on pb.LOAIPHONGBAN_ID = dic.DICTIONARY_ID              where pb.BENHVIEN_ID = 'HLU01'                          and dic.DICTIONARY_TYPE_CODE = 'LoaiPhongBan'            and dic.DICTIONARY_CODE in ('KhamBenh','PhongBenh','KhoaNoi','PhongMo','KhoaDuoc','KhoaCLS', 'KhoaNgoai')]
2019-12-10 18:01:47,308 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_Get] PreparedStatement : [select A.*, B.SOLANSUDUNG        from TM_CSKH_GOI A        left join        (select count(*) as SOLANSUDUNG, GOI_ID        from TT_CSKH_GOI_DANGKY        group by GOI_ID        )B on B.GOI_ID = a.GOI_ID         where               A.GOI_ID = '4'           and             A.BENHVIEN_ID = 'HLU01']
2019-12-10 18:01:47,359 [1] DEBUG - Statement Id: [DAO00099_TM_CSKH_GOI_CHITIET_GetDetail] PreparedStatement : [select A.*, DV.MADICHVU from TM_CSKH_GOI_CHITIET A        left join TM_DICHVU dv on dv.DICHVU_ID = A.DICHVU_ID         where                 A.GOI_ID = '4'             and               A.BENHVIEN_ID = 'HLU01']
2019-12-10 18:01:48,809 [1] DEBUG - Statement Id: [DAO00099_GetLoaiGiaDichVu] PreparedStatement : [select A.LOAIGIA_ID,B.TENLOAIGIA, B.MALOAIGIA        from TM_DICHVU_DONGIA A        inner join TM_LOAIGIA B on A.LOAIGIA_ID = B.LOAIGIA_ID        inner join LST_DICTIONARY AS DIC ON DIC.DICTIONARY_ID = B.NHOMGIA_ID AND DIC.DICTIONARY_TYPE_CODE = 'NhomGia'        where A.DICHVU_ID = '5435' and A.BENHVIEN_ID = 'HLU01' and DIC.DICTIONARY_CODE != 'BHYT']
2019-12-10 18:01:48,844 [1] DEBUG - Statement Id: [DAO00000_GetDONGIA_BY_DICHVU_LOAIGIA] PreparedStatement : [SELECT DD.*              FROM TM_DICHVU_DONGIA DD              WHERE DD.DICHVU_ID = '5435' AND DD.LOAIGIA_ID = '3' AND DD.BENHVIEN_ID = 'HLU01' AND DD.TAMNGUNG = '0']
2019-12-10 18:01:48,875 [1] DEBUG - Statement Id: [DAO00099_GetLoaiGiaDichVu] PreparedStatement : [select A.LOAIGIA_ID,B.TENLOAIGIA, B.MALOAIGIA        from TM_DICHVU_DONGIA A        inner join TM_LOAIGIA B on A.LOAIGIA_ID = B.LOAIGIA_ID        inner join LST_DICTIONARY AS DIC ON DIC.DICTIONARY_ID = B.NHOMGIA_ID AND DIC.DICTIONARY_TYPE_CODE = 'NhomGia'        where A.DICHVU_ID = '5438' and A.BENHVIEN_ID = 'HLU01' and DIC.DICTIONARY_CODE != 'BHYT']
2019-12-10 18:01:48,907 [1] DEBUG - Statement Id: [DAO00000_GetDONGIA_BY_DICHVU_LOAIGIA] PreparedStatement : [SELECT DD.*              FROM TM_DICHVU_DONGIA DD              WHERE DD.DICHVU_ID = '5438' AND DD.LOAIGIA_ID = '3' AND DD.BENHVIEN_ID = 'HLU01' AND DD.TAMNGUNG = '0']
2019-12-10 18:01:48,937 [1] DEBUG - Statement Id: [DAO00099_GetLoaiGiaDichVu] PreparedStatement : [select A.LOAIGIA_ID,B.TENLOAIGIA, B.MALOAIGIA        from TM_DICHVU_DONGIA A        inner join TM_LOAIGIA B on A.LOAIGIA_ID = B.LOAIGIA_ID        inner join LST_DICTIONARY AS DIC ON DIC.DICTIONARY_ID = B.NHOMGIA_ID AND DIC.DICTIONARY_TYPE_CODE = 'NhomGia'        where A.DICHVU_ID = '4129' and A.BENHVIEN_ID = 'HLU01' and DIC.DICTIONARY_CODE != 'BHYT']
2019-12-10 18:01:48,973 [1] DEBUG - Statement Id: [DAO00000_GetDONGIA_BY_DICHVU_LOAIGIA] PreparedStatement : [SELECT DD.*              FROM TM_DICHVU_DONGIA DD              WHERE DD.DICHVU_ID = '4129' AND DD.LOAIGIA_ID = '3' AND DD.BENHVIEN_ID = 'HLU01' AND DD.TAMNGUNG = '0']
2019-12-10 18:01:49,007 [1] DEBUG - Statement Id: [DAO00099_GetLoaiGiaDichVu] PreparedStatement : [select A.LOAIGIA_ID,B.TENLOAIGIA, B.MALOAIGIA        from TM_DICHVU_DONGIA A        inner join TM_LOAIGIA B on A.LOAIGIA_ID = B.LOAIGIA_ID        inner join LST_DICTIONARY AS DIC ON DIC.DICTIONARY_ID = B.NHOMGIA_ID AND DIC.DICTIONARY_TYPE_CODE = 'NhomGia'        where A.DICHVU_ID = '4017' and A.BENHVIEN_ID = 'HLU01' and DIC.DICTIONARY_CODE != 'BHYT']
2019-12-10 18:01:49,052 [1] DEBUG - Statement Id: [DAO00000_GetDONGIA_BY_DICHVU_LOAIGIA] PreparedStatement : [SELECT DD.*              FROM TM_DICHVU_DONGIA DD              WHERE DD.DICHVU_ID = '4017' AND DD.LOAIGIA_ID = '3' AND DD.BENHVIEN_ID = 'HLU01' AND DD.TAMNGUNG = '0']
2019-12-10 18:01:49,084 [1] DEBUG - Statement Id: [DAO00099_GetLoaiGiaDichVu] PreparedStatement : [select A.LOAIGIA_ID,B.TENLOAIGIA, B.MALOAIGIA        from TM_DICHVU_DONGIA A        inner join TM_LOAIGIA B on A.LOAIGIA_ID = B.LOAIGIA_ID        inner join LST_DICTIONARY AS DIC ON DIC.DICTIONARY_ID = B.NHOMGIA_ID AND DIC.DICTIONARY_TYPE_CODE = 'NhomGia'        where A.DICHVU_ID = '4523' and A.BENHVIEN_ID = 'HLU01' and DIC.DICTIONARY_CODE != 'BHYT']
2019-12-10 18:01:49,125 [1] DEBUG - Statement Id: [DAO00000_GetDONGIA_BY_DICHVU_LOAIGIA] PreparedStatement : [SELECT DD.*              FROM TM_DICHVU_DONGIA DD              WHERE DD.DICHVU_ID = '4523' AND DD.LOAIGIA_ID = '3' AND DD.BENHVIEN_ID = 'HLU01' AND DD.TAMNGUNG = '0']
2019-12-10 18:02:42,789 [1] DEBUG - Statement Id: [DAO00099_GetLoaiGiaDichVu] PreparedStatement : [select A.LOAIGIA_ID,B.TENLOAIGIA, B.MALOAIGIA        from TM_DICHVU_DONGIA A        inner join TM_LOAIGIA B on A.LOAIGIA_ID = B.LOAIGIA_ID        inner join LST_DICTIONARY AS DIC ON DIC.DICTIONARY_ID = B.NHOMGIA_ID AND DIC.DICTIONARY_TYPE_CODE = 'NhomGia'        where A.DICHVU_ID = '5435' and A.BENHVIEN_ID = 'HLU01' and DIC.DICTIONARY_CODE != 'BHYT']
