--------------------------------------------------------------------------------
2019-10-29 16:37:30,904 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2019-10-29 16:37:31,445 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-10-29 16:37:31,489 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-10-29 16:37:32,093 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 16:37:32,460 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-10-29 16:37:40,570 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2019-10-29 16:37:40,669 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-10-29 16:37:44,314 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-10-29 16:37:44,640 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-10-29 16:37:46,855 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2019-10-29 16:37:47,423 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2019-10-29 16:37:47,527 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2019-10-29 16:37:47,620 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2019-10-29 16:37:47,719 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2019-10-29 16:37:47,807 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2019-10-29 16:37:47,933 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2019-10-29 16:37:48,353 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2019-10-29 16:37:48,461 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2019-10-29 16:37:49,027 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2019-10-29 16:37:49,063 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2019-10-29 16:37:49,139 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2019-10-29 16:37:49,182 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2019-10-29 16:37:52,536 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2019-10-29 16:37:52,597 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @NGUONDUOC_MACDINH varchar(5) = '0';        declare @TOAMUANGOAI int = 0;        select @NGUONDUOC_MACDINH = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'PHA_NGUONDUOC'        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + @NGUONDUOC_MACDINH as DUOC_KEY, 0 as PHAMVI_ID, @NGUONDUOC_MACDINH as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end        else        begin                  select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2019-10-29 16:37:55,939 [5] DEBUG - Statement Id: [DAO00320_GetList] PreparedStatement : [select M.*            from TM_MAU M            LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID            where            M.TAMNGUNG = '0'            and M.BENHVIEN_ID = 'HLU01'            order by M.TENMAU]
2019-10-29 16:37:56,015 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2019-10-29 16:37:56,048 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT          TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,          TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,          SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH          FROM TT_MAU_TONKHO TK          JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID          JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID          JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'          LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID          LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID          WHERE TK.SOLUONG > 0          GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,          TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2019-10-29 16:37:56,143 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2019-10-29 16:37:56,189 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct          TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,          TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,          TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH          from TM_MAU M          JOIN          (          select          A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO          from          (          select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO          from TT_MAU_TONKHO TK          JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID          inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID          left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'          where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0          ) A          )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'          LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID          LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2019-10-29 16:37:56,265 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2019-10-29 16:37:57,248 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 16:37:59,343 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2019-10-29 16:38:08,895 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2019-10-29 16:38:08,976 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2019-10-29 16:38:09,062 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 16:38:09,211 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 16:38:09,555 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2019-10-29 16:38:09,558 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-10-29 16:38:09,558 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-10-29 16:38:09,622 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2019-10-29 16:38:09,622 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-10-29 16:38:09,622 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-10-29 16:38:09,804 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 16:38:10,052 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 16:38:24,689 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 16:38:24,808 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2019-10-29 16:38:25,187 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2019-10-29 16:39:20,392 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS03'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 16:39:24,081 [1] DEBUG - Statement Id: [DAO00006_GetDSNhomDichVu] PreparedStatement : [select * from TM_NHOMDICHVU              where captren_id =              (select top (1) NHOMDICHVU_ID from TM_NHOMDICHVU where MANHOMDICHVU = '02')              and BENHVIEN_ID = 'HLU01']
2019-10-29 16:39:24,139 [1] DEBUG - Statement Id: [DAO00006_GetDSNhomDichVu] PreparedStatement : [select * from TM_NHOMDICHVU              where captren_id =              (select top (1) NHOMDICHVU_ID from TM_NHOMDICHVU where MANHOMDICHVU = '03')              and BENHVIEN_ID = 'HLU01']
2019-10-29 16:39:24,713 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 16:39:25,203 [1] DEBUG - Statement Id: [DAO00019_DanhSachCDHA] PreparedStatement : [declare @TenBenhVien nvarchar(500)        declare @ManhomDSA varchar(10);        set @TenBenhVien = (select VALUE from TM_SYS_APPSETTINGS where CODE = 'APP_BENHVIEN_TEN')        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        select * from(        select ROW_NUMBER() OVER(order by NGAYGIOYEUCAU) as ROWNUMBER, *        from        (SELECT distinct        COUNT(*) OVER() as TOTALROWS,        N'Mã người bệnh: ' + bn.MAYTE + ' - ' + N'Tên người bệnh: ' + bn.TENBENHNHAN + ' - ' + N'Số bệnh án: ' + ISNULL(BA.SOBENHAN,'') + ' - ' + N'Sinh ngày: ' + isnull(Convert(varchar(10),bn.NGAYSINH,103),bn.NAMSINH) + ' - ' + N'Giới tính: ' + GD.DESCRIPTION as GROUPNAME,        bn.MAYTE, bn.TENBENHNHAN, bn.NAMSINH, bn.NGAYSINH as TUOI, ISNULL(CONVERT(VARCHAR(10), bn.NGAYSINH, 103),CAST(bn.NAMSINH AS varchar)) as NGAYSINH, bn.DIACHILIENLAC as DIACHI, bn.GIOITINH, GD.DESCRIPTION as TENGIOITINH,        tn.DOITUONG_ID, tn.THOIGIANTIEPNHAN, tn.BENHNHAN_ID, tn.TIEPNHAN_ID, tn.TRAITUYEN, tn.SOTIEPNHAN,        dv.DICHVU_ID, dv.NOITHUCHIEN_ID, isnull(dv.NGAYTAO, dv.NGAYCAPNHAT) as THOIGIANDKDICHVU,        dv.KHAN, dv.NOIYEUCAU_ID, dv.NGAYGIOYEUCAU, dv.BACSICHIDINH_ID, dv.DONVIGIOITHIEU_ID, dv.NGUOIGIOITHIEU_ID, dv.TRANGTHAI_WFL,        tn.NOIGIOITHIEU_ID, kbnt.HUONGGIAIQUYET_ID,        dv.DVYEUCAU_ID, dv.MARIS, dv.TRANGTHAI as TRANGTHAICODE, B.TENNHOMDICHVU, dv.SOPHIEUYEUCAU, dv.KHAMBENH_NGOAITRU_ID, dv.NGUOICAPNHAT_ID, dv.NGAYCAPNHAT,        CASE        WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU        WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2) END AS MANHOMDICHVU, B.MANHOMDICHVU as MANHOMDICHVUCHITIET, tn.TRANGTHAI as TRANGTHAI_TIEPNHAN,        'False' as DAKHAM,        vp.DATHANHTOAN, vp.DONGIA_DOANHTHU, BA.SOBENHAN, dv.CHANDOAN        , a.TENDICHVU, nth.TENPHONGBAN as TENPHONGKHAM, nyc.TENPHONGBAN as TENKHOACHIDINH        , case when (dv.DONVIGIOITHIEU_ID is not null and dv.DONVIGIOITHIEU_ID != '') then ngt.TENBENHVIEN else @TenBenhVien end as TENBENHVIENCHIDINH        , case when (dv.BACSICHIDINH_ID is not null and dv.BACSICHIDINH_ID != '') then bscd.TENNHANVIEN else ngtt.TENNHANVIEN end as TENBACSICHIDINH          ,             0 as GUINGOAI, 0 as VTYT, 0 as CLSKETQUA_ID                   FROM TT_DVYEUCAU (NOLOCK) dv        inner join TT_TIEPNHAN (NOLOCK) tn on dv.TIEPNHAN_ID = tn.TIEPNHAN_ID        inner join TT_BENHNHAN (NOLOCK) bn on tn.BENHNHAN_ID = bn.BENHNHAN_ID        inner join TM_DICHVU A on A.DICHVU_ID = dv.DICHVU_ID        inner join TM_PHONGBAN nth on nth.PHONGBAN_ID = dv.NOITHUCHIEN_ID        left join TM_BENHVIEN ngt on ngt.BENHVIEN_STT_ID = dv.DONVIGIOITHIEU_ID        left join TM_NHANVIEN bscd on bscd.NHANVIEN_ID = dv.BACSICHIDINH_ID        left join TM_NHANVIEN ngtt on ngtt.NHANVIEN_ID = dv.NGUOIGIOITHIEU_ID        inner join TM_PHONGBAN nyc on nyc.PHONGBAN_ID = dv.NOIYEUCAU_ID        inner join TM_NHOMDICHVU B on B.NHOMDICHVU_ID = A.NHOMDICHVU_ID        inner join TT_VIENPHI (NOLOCK) VP on VP.TIEPNHAN_ID = tn.TIEPNHAN_ID and VP.DICHVU_ID = dv.DICHVU_ID and VP.REF_ID = dv.DVYEUCAU_ID        left join TT_NOITRU_BENHAN (NOLOCK) BA on BA.TIEPNHAN_ID = tn.TIEPNHAN_ID AND dv.BENHAN_ID = BA.BENHAN_ID        inner join TM_GENDER GD on GD.ID = bn.GIOITINH        left join TT_NGOAITRU_KHAMBENH (NOLOCK) kbnt on kbnt.KHAMBENH_ID = dv.KHAMBENH_NGOAITRU_ID                 where        dv.DICHVU_ID IS NOT NULL        and tn.BENHVIEN_ID = 'HLU01'        and HUYYEUCAU = 0        and dv.NGAYHENCLS is NULL                       and dv.TRANGTHAI = 'CHUAKETQUA'           and           dv.NGAYYEUCAU >= '10/29/2019 12:00:00 AM'         and           dv.NGAYYEUCAU <= '10/29/2019 12:00:00 AM'         and           dv.NOITHUCHIEN_ID = 79         and           (vp.DATHANHTOAN = '1'  or vp.DONGIA_DOANHTHU = '0' OR TN.SUDUNG_BHTN='1' OR TN.BAOLANH_VIENPHI='1'  OR tn.TRANGTHAI IN ('NOITRU','CAPCUU','NGOAITRU') or dv.HOPDONG_BENHNHAN_ID is not null or vp.BENHNHAN_PHAITHANHTOAN >= 0)         and           (CASE          WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU          WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2) END) in (02)         and           tn.TRANGTHAI IN ('DATIEPNHAN','NOITRU','CAPCUU','NGOAITRU', 'HOANTHANH')                 ) data1) lst                    where          lst.ROWNUMBER between 1 and 5                 order by NGAYGIOYEUCAU asc]
2019-10-29 16:39:26,547 [1] DEBUG - Statement Id: [DAO00019_DanhSachCDHA] PreparedStatement : [declare @TenBenhVien nvarchar(500)        declare @ManhomDSA varchar(10);        set @TenBenhVien = (select VALUE from TM_SYS_APPSETTINGS where CODE = 'APP_BENHVIEN_TEN')        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        select * from(        select ROW_NUMBER() OVER(order by NGAYGIOYEUCAU) as ROWNUMBER, *        from        (SELECT distinct        COUNT(*) OVER() as TOTALROWS,        N'Mã người bệnh: ' + bn.MAYTE + ' - ' + N'Tên người bệnh: ' + bn.TENBENHNHAN + ' - ' + N'Số bệnh án: ' + ISNULL(BA.SOBENHAN,'') + ' - ' + N'Sinh ngày: ' + isnull(Convert(varchar(10),bn.NGAYSINH,103),bn.NAMSINH) + ' - ' + N'Giới tính: ' + GD.DESCRIPTION as GROUPNAME,        bn.MAYTE, bn.TENBENHNHAN, bn.NAMSINH, bn.NGAYSINH as TUOI, ISNULL(CONVERT(VARCHAR(10), bn.NGAYSINH, 103),CAST(bn.NAMSINH AS varchar)) as NGAYSINH, bn.DIACHILIENLAC as DIACHI, bn.GIOITINH, GD.DESCRIPTION as TENGIOITINH,        tn.DOITUONG_ID, tn.THOIGIANTIEPNHAN, tn.BENHNHAN_ID, tn.TIEPNHAN_ID, tn.TRAITUYEN, tn.SOTIEPNHAN,        dv.DICHVU_ID, dv.NOITHUCHIEN_ID, isnull(dv.NGAYTAO, dv.NGAYCAPNHAT) as THOIGIANDKDICHVU,        dv.KHAN, dv.NOIYEUCAU_ID, dv.NGAYGIOYEUCAU, dv.BACSICHIDINH_ID, dv.DONVIGIOITHIEU_ID, dv.NGUOIGIOITHIEU_ID, dv.TRANGTHAI_WFL,        tn.NOIGIOITHIEU_ID, kbnt.HUONGGIAIQUYET_ID,        dv.DVYEUCAU_ID, dv.MARIS, dv.TRANGTHAI as TRANGTHAICODE, B.TENNHOMDICHVU, dv.SOPHIEUYEUCAU, dv.KHAMBENH_NGOAITRU_ID, dv.NGUOICAPNHAT_ID, dv.NGAYCAPNHAT,        CASE        WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU        WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2) END AS MANHOMDICHVU, B.MANHOMDICHVU as MANHOMDICHVUCHITIET, tn.TRANGTHAI as TRANGTHAI_TIEPNHAN,        'False' as DAKHAM,        vp.DATHANHTOAN, vp.DONGIA_DOANHTHU, BA.SOBENHAN, dv.CHANDOAN        , a.TENDICHVU, nth.TENPHONGBAN as TENPHONGKHAM, nyc.TENPHONGBAN as TENKHOACHIDINH        , case when (dv.DONVIGIOITHIEU_ID is not null and dv.DONVIGIOITHIEU_ID != '') then ngt.TENBENHVIEN else @TenBenhVien end as TENBENHVIENCHIDINH        , case when (dv.BACSICHIDINH_ID is not null and dv.BACSICHIDINH_ID != '') then bscd.TENNHANVIEN else ngtt.TENNHANVIEN end as TENBACSICHIDINH          ,             0 as GUINGOAI, 0 as VTYT, 0 as CLSKETQUA_ID                   FROM TT_DVYEUCAU (NOLOCK) dv        inner join TT_TIEPNHAN (NOLOCK) tn on dv.TIEPNHAN_ID = tn.TIEPNHAN_ID        inner join TT_BENHNHAN (NOLOCK) bn on tn.BENHNHAN_ID = bn.BENHNHAN_ID        inner join TM_DICHVU A on A.DICHVU_ID = dv.DICHVU_ID        inner join TM_PHONGBAN nth on nth.PHONGBAN_ID = dv.NOITHUCHIEN_ID        left join TM_BENHVIEN ngt on ngt.BENHVIEN_STT_ID = dv.DONVIGIOITHIEU_ID        left join TM_NHANVIEN bscd on bscd.NHANVIEN_ID = dv.BACSICHIDINH_ID        left join TM_NHANVIEN ngtt on ngtt.NHANVIEN_ID = dv.NGUOIGIOITHIEU_ID        inner join TM_PHONGBAN nyc on nyc.PHONGBAN_ID = dv.NOIYEUCAU_ID        inner join TM_NHOMDICHVU B on B.NHOMDICHVU_ID = A.NHOMDICHVU_ID        inner join TT_VIENPHI (NOLOCK) VP on VP.TIEPNHAN_ID = tn.TIEPNHAN_ID and VP.DICHVU_ID = dv.DICHVU_ID and VP.REF_ID = dv.DVYEUCAU_ID        left join TT_NOITRU_BENHAN (NOLOCK) BA on BA.TIEPNHAN_ID = tn.TIEPNHAN_ID AND dv.BENHAN_ID = BA.BENHAN_ID        inner join TM_GENDER GD on GD.ID = bn.GIOITINH        left join TT_NGOAITRU_KHAMBENH (NOLOCK) kbnt on kbnt.KHAMBENH_ID = dv.KHAMBENH_NGOAITRU_ID                 where        dv.DICHVU_ID IS NOT NULL        and tn.BENHVIEN_ID = 'HLU01'        and HUYYEUCAU = 0        and dv.NGAYHENCLS is NULL                       and dv.TRANGTHAI = 'CHUAKETQUA'           and           dv.NGAYYEUCAU >= '10/29/2019 12:00:00 AM'         and           dv.NGAYYEUCAU <= '10/29/2019 12:00:00 AM'         and           dv.NOITHUCHIEN_ID = 79         and           (vp.DATHANHTOAN = '1'  or vp.DONGIA_DOANHTHU = '0' OR TN.SUDUNG_BHTN='1' OR TN.BAOLANH_VIENPHI='1'  OR tn.TRANGTHAI IN ('NOITRU','CAPCUU','NGOAITRU') or dv.HOPDONG_BENHNHAN_ID is not null or vp.BENHNHAN_PHAITHANHTOAN >= 0)         and           (CASE          WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU          WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2) END) in (02)         and           tn.TRANGTHAI IN ('DATIEPNHAN','NOITRU','CAPCUU','NGOAITRU', 'HOANTHANH')                 ) data1) lst                    where          lst.ROWNUMBER between 1 and 5                 order by NGAYGIOYEUCAU asc]
2019-10-29 16:39:37,649 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS31'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 16:39:37,740 [1] DEBUG - Statement Id: [DAO00019_DanhSachCDHA] PreparedStatement : [declare @TenBenhVien nvarchar(500)        declare @ManhomDSA varchar(10);        set @TenBenhVien = (select VALUE from TM_SYS_APPSETTINGS where CODE = 'APP_BENHVIEN_TEN')        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        select * from(        select ROW_NUMBER() OVER(order by NGAYGIOYEUCAU) as ROWNUMBER, *        from        (SELECT distinct        COUNT(*) OVER() as TOTALROWS,        N'Mã người bệnh: ' + bn.MAYTE + ' - ' + N'Tên người bệnh: ' + bn.TENBENHNHAN + ' - ' + N'Số bệnh án: ' + ISNULL(BA.SOBENHAN,'') + ' - ' + N'Sinh ngày: ' + isnull(Convert(varchar(10),bn.NGAYSINH,103),bn.NAMSINH) + ' - ' + N'Giới tính: ' + GD.DESCRIPTION as GROUPNAME,        bn.MAYTE, bn.TENBENHNHAN, bn.NAMSINH, bn.NGAYSINH as TUOI, ISNULL(CONVERT(VARCHAR(10), bn.NGAYSINH, 103),CAST(bn.NAMSINH AS varchar)) as NGAYSINH, bn.DIACHILIENLAC as DIACHI, bn.GIOITINH, GD.DESCRIPTION as TENGIOITINH,        tn.DOITUONG_ID, tn.THOIGIANTIEPNHAN, tn.BENHNHAN_ID, tn.TIEPNHAN_ID, tn.TRAITUYEN, tn.SOTIEPNHAN,        dv.DICHVU_ID, dv.NOITHUCHIEN_ID, isnull(dv.NGAYTAO, dv.NGAYCAPNHAT) as THOIGIANDKDICHVU,        dv.KHAN, dv.NOIYEUCAU_ID, dv.NGAYGIOYEUCAU, dv.BACSICHIDINH_ID, dv.DONVIGIOITHIEU_ID, dv.NGUOIGIOITHIEU_ID, dv.TRANGTHAI_WFL,        tn.NOIGIOITHIEU_ID, kbnt.HUONGGIAIQUYET_ID,        dv.DVYEUCAU_ID, dv.MARIS, dv.TRANGTHAI as TRANGTHAICODE, B.TENNHOMDICHVU, dv.SOPHIEUYEUCAU, dv.KHAMBENH_NGOAITRU_ID, dv.NGUOICAPNHAT_ID, dv.NGAYCAPNHAT,        CASE        WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU        WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2) END AS MANHOMDICHVU, B.MANHOMDICHVU as MANHOMDICHVUCHITIET, tn.TRANGTHAI as TRANGTHAI_TIEPNHAN,        'True' as DAKHAM,        vp.DATHANHTOAN, vp.DONGIA_DOANHTHU, BA.SOBENHAN, dv.CHANDOAN        , a.TENDICHVU, nth.TENPHONGBAN as TENPHONGKHAM, nyc.TENPHONGBAN as TENKHOACHIDINH        , case when (dv.DONVIGIOITHIEU_ID is not null and dv.DONVIGIOITHIEU_ID != '') then ngt.TENBENHVIEN else @TenBenhVien end as TENBENHVIENCHIDINH        , case when (dv.BACSICHIDINH_ID is not null and dv.BACSICHIDINH_ID != '') then bscd.TENNHANVIEN else ngtt.TENNHANVIEN end as TENBACSICHIDINH          ,             cls.CLSKETQUA_ID, cls.NGAYGIOTHUCHIEN , cls.THOIGIANKHOADULIEU, cls.NGUOIKHOA_ID, cls_vtyt.CLSKETQUA_ID as VTYT            , cls.GUINGOAI, cls.NOIGUIDEN_ID, dv.TENNGUOIKHOA                   FROM TT_DVYEUCAU (NOLOCK) dv        inner join TT_TIEPNHAN (NOLOCK) tn on dv.TIEPNHAN_ID = tn.TIEPNHAN_ID        inner join TT_BENHNHAN (NOLOCK) bn on tn.BENHNHAN_ID = bn.BENHNHAN_ID        inner join TM_DICHVU A on A.DICHVU_ID = dv.DICHVU_ID        inner join TM_PHONGBAN nth on nth.PHONGBAN_ID = dv.NOITHUCHIEN_ID        left join TM_BENHVIEN ngt on ngt.BENHVIEN_STT_ID = dv.DONVIGIOITHIEU_ID        left join TM_NHANVIEN bscd on bscd.NHANVIEN_ID = dv.BACSICHIDINH_ID        left join TM_NHANVIEN ngtt on ngtt.NHANVIEN_ID = dv.NGUOIGIOITHIEU_ID        inner join TM_PHONGBAN nyc on nyc.PHONGBAN_ID = dv.NOIYEUCAU_ID        inner join TM_NHOMDICHVU B on B.NHOMDICHVU_ID = A.NHOMDICHVU_ID        inner join TT_VIENPHI (NOLOCK) VP on VP.TIEPNHAN_ID = tn.TIEPNHAN_ID and VP.DICHVU_ID = dv.DICHVU_ID and VP.REF_ID = dv.DVYEUCAU_ID        left join TT_NOITRU_BENHAN (NOLOCK) BA on BA.TIEPNHAN_ID = tn.TIEPNHAN_ID AND dv.BENHAN_ID = BA.BENHAN_ID        inner join TM_GENDER GD on GD.ID = bn.GIOITINH        left join TT_NGOAITRU_KHAMBENH (NOLOCK) kbnt on kbnt.KHAMBENH_ID = dv.KHAMBENH_NGOAITRU_ID                       left join TT_CLSKETQUA (NOLOCK) cls on dv.DVYEUCAU_ID = cls.DVYEUCAU_ID            left join TT_CLSKETQUA_VTYT (NOLOCK) cls_vtyt on cls_vtyt.DVYEUCAU_ID = dv.DVYEUCAU_ID                   where        dv.DICHVU_ID IS NOT NULL        and tn.BENHVIEN_ID = 'HLU01'        and HUYYEUCAU = 0        and dv.NGAYHENCLS is NULL                       and dv.TRANGTHAI IN ('CHOXACNHAN','HOANTAT')           and           dv.NGAYYEUCAU >= '6/1/2019 12:00:00 AM'         and           dv.NGAYYEUCAU <= '10/29/2019 12:00:00 AM'         and           dv.NOITHUCHIEN_ID = 79         and           (vp.DATHANHTOAN = '1'  or vp.DONGIA_DOANHTHU = '0' OR TN.SUDUNG_BHTN='1' OR TN.BAOLANH_VIENPHI='1'  OR tn.TRANGTHAI IN ('NOITRU','CAPCUU','NGOAITRU') or dv.HOPDONG_BENHNHAN_ID is not null or vp.BENHNHAN_PHAITHANHTOAN >= 0)         and           (bn.TENBENHNHAN like '%' +  @param0  + '%' or bn.MAYTE like '%' +  @param0  + '%')         and           (CASE          WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU          WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2) END) in (02)                 ) data1) lst                    where          lst.ROWNUMBER between 1 and 5                 order by NGAYGIOYEUCAU asc]
2019-10-29 16:39:37,740 [1] DEBUG - Statement Id: [DAO00019_DanhSachCDHA] Parameters: [@param0=[TENBENHNHAN,Côi]]
2019-10-29 16:39:37,740 [1] DEBUG - Statement Id: [DAO00019_DanhSachCDHA] Types: [@param0=[String, System.String]]
2019-10-29 16:39:38,316 [1] DEBUG - Statement Id: [DAO00000_GetNhomDoiTuong] PreparedStatement : [SELECT DOITUONG_ID              ,[TENDOITUONG]              ,[NHOMDICHVU]              ,[TYLE_VUOT_LCB]              ,[GIOIHAN_VUOT_LCB]              ,[GIOIHAN_VUOT_DVKTC]              ,[TYLE_THUOC_UT]              ,[CPVC]              ,[CHIPHINGOAI_BHYT]              ,[NGANSACH_TL]              ,[MIENGIAM_TL]              ,[TAITRO_TL]              ,[BHTN_TL]              FROM [dbo].[TM_DOITUONG]]
2019-10-29 16:39:42,729 [1] DEBUG - Statement Id: [DAO00019_ThongTinBenhNhanDvYeuCau] PreparedStatement : [select distinct A.SOTIEPNHAN, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI, A.NGAYMIENDONGCHITRA,        B.*,  C.DICHVU_ID, C.DVYEUCAU_ID, C.NOITHUCHIEN_ID, A.SOBHYT        from TT_TIEPNHAN A        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'        where                    C.DVYEUCAU_ID = '205346'                 and A.BENHVIEN_ID = 'HLU01']
2019-10-29 16:39:43,326 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '26239'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2019-10-29 16:39:43,420 [1] DEBUG - Statement Id: [DAO00046_GETLISTDVYEUCAUINLISTDVID] PreparedStatement : [SELECT dvyc.*, clskqct.CLSKETQUA_ID, clskqct.DICHVU_ID as KETQUA_DICHVU_ID,        clskqct.CLSKETQUACHITIET_ID, clskqct.DONVITINH, clskqct.KETQUA, clskqct.KETQUA2,        clskqct.MUCBINHTHUONG, clskqct.MUCBINHTHUONGMIN, clskqct.MUCBINHTHUONGMAX, clskqct.BATTHUONG        FROM dbo.TT_CLSKETQUACHITIET as clskqct RIGHT OUTER JOIN        dbo.TT_DVYEUCAU as dvyc ON                 clskqct.DVYEUCAU_ID = dvyc.DVYEUCAU_ID        where dvyc.BENHVIEN_ID = 'HLU01'          and             exists (select DICHVU_ID from TM_DICHVU a join TM_NHOMDICHVU b on a.NHOMDICHVU_ID = b.NHOMDICHVU_ID            where dvyc.DICHVU_ID = DICHVU_ID and (left(MANHOMDICHVU,2) in ('02', '03') OR MANHOMDICHVU in ('02', '03')))           and             dvyc.TIEPNHAN_ID =  @param0                    order by DVYEUCAU_ID]
2019-10-29 16:39:43,420 [1] DEBUG - Statement Id: [DAO00046_GETLISTDVYEUCAUINLISTDVID] Parameters: [@param0=[TIEPNHAN_ID,26239]]
2019-10-29 16:39:43,420 [1] DEBUG - Statement Id: [DAO00046_GETLISTDVYEUCAUINLISTDVID] Types: [@param0=[Int64, System.Int64]]
2019-10-29 16:39:43,452 [1] DEBUG - Statement Id: [DAO00045_GetListDVYeuCau] PreparedStatement : [select *              from VIEW_DICHVU_NHOMDV              where BENHVIEN_ID = 'HLU01']
2019-10-29 16:39:44,121 [1] DEBUG - Statement Id: [DAO00018_GetList] PreparedStatement : [select A.*, B.DICTIONARY_NAME, B.DICTIONARY_CODE, B.DICTIONARY_NAME_EN CHUCDANH, (B.DICTIONARY_NAME_EN + '. ' + A.TENNHANVIEN) TENHOCVIHOCHAM            from TM_NHANVIEN A            left join (select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE = 'chucdanh' and DICTIONARY_NAME_EN is not null) B on A.CHUCDANH_ID = B.DICTIONARY_ID            where A.BENHVIEN_ID = '' and A.TAMNGUNG = '0']
2019-10-29 16:39:44,603 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '26239'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2019-10-29 16:39:47,239 [1] DEBUG - Statement Id: [DAO00037_GetCLSKetQua] PreparedStatement : [select *              from TT_CLSKETQUA               where                             TT_CLSKETQUA.DVYEUCAU_ID = '205346'                       and                           TT_CLSKETQUA.BENHVIEN_ID = 'HLU01'                                     order by CLSKETQUA_ID]
2019-10-29 16:39:47,333 [1] DEBUG - Statement Id: [DAO00020_GetDetailP] PreparedStatement : [select *        from TT_DVYEUCAU        where TT_DVYEUCAU.DVYEUCAU_ID  = 205346        order by DVYEUCAU_ID]
2019-10-29 16:39:47,439 [1] DEBUG - Statement Id: [DAO00017_GetNameByID] PreparedStatement : [select TENPHONGBAN              from [TM_PHONGBAN]              where PHONGBAN_ID = '18' and BENHVIEN_ID = 'HLU01']
2019-10-29 16:39:47,524 [1] DEBUG - Statement Id: [DAO00041_GetNameByID] PreparedStatement : [select TENDICHVU              from TM_DICHVU              where DICHVU_ID = '4144']
2019-10-29 16:39:48,298 [1] DEBUG - Statement Id: [DAO00038_GetList] PreparedStatement : [select *              from TT_CLSKETQUA_IMAGES               where                             TT_CLSKETQUA_IMAGES.CLSKETQUA_ID = '96455'                       and                           TT_CLSKETQUA_IMAGES.BENHVIEN_ID = 'HLU01'                                     order by IDX]
2019-10-29 16:39:48,351 [1] DEBUG - Statement Id: [DAO00222_GetList] PreparedStatement : [select *        from TT_CLSKETQUA_DOCUMENTS         where                 CLSKETQUA_ID = '96455'                     order by CLSKETQUA_DOCUMENTS_ID]
2019-10-29 16:39:48,695 [1] DEBUG - Statement Id: [DAO00116_File_GetList] PreparedStatement : [select *              from TT_FILE_DINHKEM               where                             TT_FILE_DINHKEM.REF_TABLE = 'TT_CLSKETQUA'                       and                           TT_FILE_DINHKEM.REF_ID = '96455'                       and                           TT_FILE_DINHKEM.BENHVIEN_ID = 'HLU01'                                     order by FILE_ID]
2019-10-29 16:39:48,777 [1] DEBUG - Statement Id: [DAO00087_GetServiceParams] PreparedStatement : [select CODE, VALUE              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01']
2019-10-29 16:39:48,950 [1] DEBUG - Statement Id: [DAO00042_GetList] PreparedStatement : [select *              from TM_TUDIENKETQUA              where BENHVIEN_ID = 'HLU01'                and                       TM_TUDIENKETQUA.DICHVU_ID = '4144'                    and                       (TM_TUDIENKETQUA.NGUOITAO_ID = '1' OR TM_TUDIENKETQUA.SUDUNGCHUNG = '1')                                 order by TM_TUDIENKETQUA.TENNOIDUNG]
2019-10-29 16:39:48,983 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '26239'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2019-10-29 16:39:50,531 [1] DEBUG - Statement Id: [DAO00037_GetCLSKetQua] PreparedStatement : [select *              from TT_CLSKETQUA               where                             TT_CLSKETQUA.DVYEUCAU_ID = '205346'                       and                           TT_CLSKETQUA.BENHVIEN_ID = 'HLU01'                                     order by CLSKETQUA_ID]
2019-10-29 16:39:50,627 [1] DEBUG - Statement Id: [DAO00020_GetDetailP] PreparedStatement : [select *        from TT_DVYEUCAU        where TT_DVYEUCAU.DVYEUCAU_ID  = 205346        order by DVYEUCAU_ID]
2019-10-29 16:39:50,717 [1] DEBUG - Statement Id: [DAO00017_GetNameByID] PreparedStatement : [select TENPHONGBAN              from [TM_PHONGBAN]              where PHONGBAN_ID = '18' and BENHVIEN_ID = 'HLU01']
2019-10-29 16:39:50,807 [1] DEBUG - Statement Id: [DAO00041_GetNameByID] PreparedStatement : [select TENDICHVU              from TM_DICHVU              where DICHVU_ID = '4144']
2019-10-29 16:39:50,906 [1] DEBUG - Statement Id: [DAO00038_GetList] PreparedStatement : [select *              from TT_CLSKETQUA_IMAGES               where                             TT_CLSKETQUA_IMAGES.CLSKETQUA_ID = '96455'                       and                           TT_CLSKETQUA_IMAGES.BENHVIEN_ID = 'HLU01'                                     order by IDX]
2019-10-29 16:39:50,936 [1] DEBUG - Statement Id: [DAO00222_GetList] PreparedStatement : [select *        from TT_CLSKETQUA_DOCUMENTS         where                 CLSKETQUA_ID = '96455'                     order by CLSKETQUA_DOCUMENTS_ID]
2019-10-29 16:39:50,964 [1] DEBUG - Statement Id: [DAO00116_File_GetList] PreparedStatement : [select *              from TT_FILE_DINHKEM               where                             TT_FILE_DINHKEM.REF_TABLE = 'TT_CLSKETQUA'                       and                           TT_FILE_DINHKEM.REF_ID = '96455'                       and                           TT_FILE_DINHKEM.BENHVIEN_ID = 'HLU01'                                     order by FILE_ID]
2019-10-29 16:39:51,003 [1] DEBUG - Statement Id: [DAO00042_GetList] PreparedStatement : [select *              from TM_TUDIENKETQUA              where BENHVIEN_ID = 'HLU01'                and                       TM_TUDIENKETQUA.DICHVU_ID = '4144'                    and                       (TM_TUDIENKETQUA.NGUOITAO_ID = '1' OR TM_TUDIENKETQUA.SUDUNGCHUNG = '1')                                 order by TM_TUDIENKETQUA.TENNOIDUNG]
2019-10-29 16:39:51,034 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '26239'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2019-10-29 16:39:52,200 [1] DEBUG - Statement Id: [DAO00116_GetListThietBiCLS] PreparedStatement : [SELECT THIETBI_ID, MATHIETBI, TENTHIETBI, NHOMTHIETBI_ID          FROM TM_THIETBI MP          where          TAMNGUNG = '0'          and BENHVIEN_ID = 'HLU01'           AND             PHONGBAN_ID = 79                     order by TENTHIETBI]
--------------------------------------------------------------------------------
2019-10-29 16:50:24,407 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2019-10-29 16:50:24,720 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-10-29 16:50:24,759 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-10-29 16:50:25,237 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 16:50:26,123 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-10-29 16:50:31,944 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2019-10-29 16:50:31,974 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-10-29 16:50:33,619 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-10-29 16:50:33,832 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-10-29 16:50:34,733 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2019-10-29 16:50:34,883 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2019-10-29 16:50:34,964 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2019-10-29 16:50:35,055 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2019-10-29 16:50:35,130 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2019-10-29 16:50:35,210 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2019-10-29 16:50:35,380 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2019-10-29 16:50:35,481 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2019-10-29 16:50:35,568 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2019-10-29 16:50:36,075 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2019-10-29 16:50:36,111 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2019-10-29 16:50:36,205 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2019-10-29 16:50:36,246 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2019-10-29 16:50:37,185 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2019-10-29 16:50:37,219 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @NGUONDUOC_MACDINH varchar(5) = '0';        declare @TOAMUANGOAI int = 0;        select @NGUONDUOC_MACDINH = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'PHA_NGUONDUOC'        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + @NGUONDUOC_MACDINH as DUOC_KEY, 0 as PHAMVI_ID, @NGUONDUOC_MACDINH as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end        else        begin                  select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2019-10-29 16:50:39,108 [5] DEBUG - Statement Id: [DAO00320_GetList] PreparedStatement : [select M.*            from TM_MAU M            LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID            where            M.TAMNGUNG = '0'            and M.BENHVIEN_ID = 'HLU01'            order by M.TENMAU]
2019-10-29 16:50:39,589 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2019-10-29 16:50:39,672 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT          TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,          TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,          SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH          FROM TT_MAU_TONKHO TK          JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID          JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID          JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'          LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID          LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID          WHERE TK.SOLUONG > 0          GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,          TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2019-10-29 16:50:39,745 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2019-10-29 16:50:39,778 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct          TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,          TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,          TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH          from TM_MAU M          JOIN          (          select          A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO          from          (          select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO          from TT_MAU_TONKHO TK          JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID          inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID          left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'          where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0          ) A          )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'          LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID          LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2019-10-29 16:50:39,851 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2019-10-29 16:50:40,805 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 16:50:41,609 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2019-10-29 16:50:46,550 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2019-10-29 16:50:46,592 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2019-10-29 16:50:46,669 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 16:50:46,806 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 16:50:46,945 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2019-10-29 16:50:46,947 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-10-29 16:50:46,947 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-10-29 16:50:46,980 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2019-10-29 16:50:46,980 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-10-29 16:50:46,980 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-10-29 16:50:47,132 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 16:50:47,329 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 16:50:54,856 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 16:50:54,947 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2019-10-29 16:50:55,212 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2019-10-29 16:52:09,672 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS03'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 16:52:12,940 [1] DEBUG - Statement Id: [DAO00006_GetDSNhomDichVu] PreparedStatement : [select * from TM_NHOMDICHVU              where captren_id =              (select top (1) NHOMDICHVU_ID from TM_NHOMDICHVU where MANHOMDICHVU = '02')              and BENHVIEN_ID = 'HLU01']
2019-10-29 16:52:12,968 [1] DEBUG - Statement Id: [DAO00006_GetDSNhomDichVu] PreparedStatement : [select * from TM_NHOMDICHVU              where captren_id =              (select top (1) NHOMDICHVU_ID from TM_NHOMDICHVU where MANHOMDICHVU = '03')              and BENHVIEN_ID = 'HLU01']
2019-10-29 16:52:13,355 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 16:52:13,508 [1] DEBUG - Statement Id: [DAO00019_DanhSachCDHA] PreparedStatement : [declare @TenBenhVien nvarchar(500)        declare @ManhomDSA varchar(10);        set @TenBenhVien = (select VALUE from TM_SYS_APPSETTINGS where CODE = 'APP_BENHVIEN_TEN')        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        select * from(        select ROW_NUMBER() OVER(order by NGAYGIOYEUCAU) as ROWNUMBER, *        from        (SELECT distinct        COUNT(*) OVER() as TOTALROWS,        N'Mã người bệnh: ' + bn.MAYTE + ' - ' + N'Tên người bệnh: ' + bn.TENBENHNHAN + ' - ' + N'Số bệnh án: ' + ISNULL(BA.SOBENHAN,'') + ' - ' + N'Sinh ngày: ' + isnull(Convert(varchar(10),bn.NGAYSINH,103),bn.NAMSINH) + ' - ' + N'Giới tính: ' + GD.DESCRIPTION as GROUPNAME,        bn.MAYTE, bn.TENBENHNHAN, bn.NAMSINH, bn.NGAYSINH as TUOI, ISNULL(CONVERT(VARCHAR(10), bn.NGAYSINH, 103),CAST(bn.NAMSINH AS varchar)) as NGAYSINH, bn.DIACHILIENLAC as DIACHI, bn.GIOITINH, GD.DESCRIPTION as TENGIOITINH,        tn.DOITUONG_ID, tn.THOIGIANTIEPNHAN, tn.BENHNHAN_ID, tn.TIEPNHAN_ID, tn.TRAITUYEN, tn.SOTIEPNHAN,        dv.DICHVU_ID, dv.NOITHUCHIEN_ID, isnull(dv.NGAYTAO, dv.NGAYCAPNHAT) as THOIGIANDKDICHVU,        dv.KHAN, dv.NOIYEUCAU_ID, dv.NGAYGIOYEUCAU, dv.BACSICHIDINH_ID, dv.DONVIGIOITHIEU_ID, dv.NGUOIGIOITHIEU_ID, dv.TRANGTHAI_WFL,        tn.NOIGIOITHIEU_ID, kbnt.HUONGGIAIQUYET_ID,        dv.DVYEUCAU_ID, dv.MARIS, dv.TRANGTHAI as TRANGTHAICODE, B.TENNHOMDICHVU, dv.SOPHIEUYEUCAU, dv.KHAMBENH_NGOAITRU_ID, dv.NGUOICAPNHAT_ID, dv.NGAYCAPNHAT,        CASE        WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU        WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2) END AS MANHOMDICHVU, B.MANHOMDICHVU as MANHOMDICHVUCHITIET, tn.TRANGTHAI as TRANGTHAI_TIEPNHAN,        'False' as DAKHAM,        vp.DATHANHTOAN, vp.DONGIA_DOANHTHU, BA.SOBENHAN, dv.CHANDOAN        , a.TENDICHVU, nth.TENPHONGBAN as TENPHONGKHAM, nyc.TENPHONGBAN as TENKHOACHIDINH        , case when (dv.DONVIGIOITHIEU_ID is not null and dv.DONVIGIOITHIEU_ID != '') then ngt.TENBENHVIEN else @TenBenhVien end as TENBENHVIENCHIDINH        , case when (dv.BACSICHIDINH_ID is not null and dv.BACSICHIDINH_ID != '') then bscd.TENNHANVIEN else ngtt.TENNHANVIEN end as TENBACSICHIDINH          ,             0 as GUINGOAI, 0 as VTYT, 0 as CLSKETQUA_ID                   FROM TT_DVYEUCAU (NOLOCK) dv        inner join TT_TIEPNHAN (NOLOCK) tn on dv.TIEPNHAN_ID = tn.TIEPNHAN_ID        inner join TT_BENHNHAN (NOLOCK) bn on tn.BENHNHAN_ID = bn.BENHNHAN_ID        inner join TM_DICHVU A on A.DICHVU_ID = dv.DICHVU_ID        inner join TM_PHONGBAN nth on nth.PHONGBAN_ID = dv.NOITHUCHIEN_ID        left join TM_BENHVIEN ngt on ngt.BENHVIEN_STT_ID = dv.DONVIGIOITHIEU_ID        left join TM_NHANVIEN bscd on bscd.NHANVIEN_ID = dv.BACSICHIDINH_ID        left join TM_NHANVIEN ngtt on ngtt.NHANVIEN_ID = dv.NGUOIGIOITHIEU_ID        inner join TM_PHONGBAN nyc on nyc.PHONGBAN_ID = dv.NOIYEUCAU_ID        inner join TM_NHOMDICHVU B on B.NHOMDICHVU_ID = A.NHOMDICHVU_ID        inner join TT_VIENPHI (NOLOCK) VP on VP.TIEPNHAN_ID = tn.TIEPNHAN_ID and VP.DICHVU_ID = dv.DICHVU_ID and VP.REF_ID = dv.DVYEUCAU_ID        left join TT_NOITRU_BENHAN (NOLOCK) BA on BA.TIEPNHAN_ID = tn.TIEPNHAN_ID AND dv.BENHAN_ID = BA.BENHAN_ID        inner join TM_GENDER GD on GD.ID = bn.GIOITINH        left join TT_NGOAITRU_KHAMBENH (NOLOCK) kbnt on kbnt.KHAMBENH_ID = dv.KHAMBENH_NGOAITRU_ID                 where        dv.DICHVU_ID IS NOT NULL        and tn.BENHVIEN_ID = 'HLU01'        and HUYYEUCAU = 0        and dv.NGAYHENCLS is NULL                       and dv.TRANGTHAI = 'CHUAKETQUA'           and           dv.NGAYYEUCAU >= '10/29/2019 12:00:00 AM'         and           dv.NGAYYEUCAU <= '10/29/2019 12:00:00 AM'         and           dv.NOITHUCHIEN_ID = 79         and           (vp.DATHANHTOAN = '1'  or vp.DONGIA_DOANHTHU = '0' OR TN.SUDUNG_BHTN='1' OR TN.BAOLANH_VIENPHI='1'  OR tn.TRANGTHAI IN ('NOITRU','CAPCUU','NGOAITRU') or dv.HOPDONG_BENHNHAN_ID is not null or vp.BENHNHAN_PHAITHANHTOAN >= 0)         and           (CASE          WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU          WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2) END) in (02)         and           tn.TRANGTHAI IN ('DATIEPNHAN','NOITRU','CAPCUU','NGOAITRU', 'HOANTHANH')                 ) data1) lst                    where          lst.ROWNUMBER between 1 and 5                 order by NGAYGIOYEUCAU asc]
2019-10-29 16:52:15,143 [1] DEBUG - Statement Id: [DAO00019_DanhSachCDHA] PreparedStatement : [declare @TenBenhVien nvarchar(500)        declare @ManhomDSA varchar(10);        set @TenBenhVien = (select VALUE from TM_SYS_APPSETTINGS where CODE = 'APP_BENHVIEN_TEN')        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        select * from(        select ROW_NUMBER() OVER(order by NGAYGIOYEUCAU) as ROWNUMBER, *        from        (SELECT distinct        COUNT(*) OVER() as TOTALROWS,        N'Mã người bệnh: ' + bn.MAYTE + ' - ' + N'Tên người bệnh: ' + bn.TENBENHNHAN + ' - ' + N'Số bệnh án: ' + ISNULL(BA.SOBENHAN,'') + ' - ' + N'Sinh ngày: ' + isnull(Convert(varchar(10),bn.NGAYSINH,103),bn.NAMSINH) + ' - ' + N'Giới tính: ' + GD.DESCRIPTION as GROUPNAME,        bn.MAYTE, bn.TENBENHNHAN, bn.NAMSINH, bn.NGAYSINH as TUOI, ISNULL(CONVERT(VARCHAR(10), bn.NGAYSINH, 103),CAST(bn.NAMSINH AS varchar)) as NGAYSINH, bn.DIACHILIENLAC as DIACHI, bn.GIOITINH, GD.DESCRIPTION as TENGIOITINH,        tn.DOITUONG_ID, tn.THOIGIANTIEPNHAN, tn.BENHNHAN_ID, tn.TIEPNHAN_ID, tn.TRAITUYEN, tn.SOTIEPNHAN,        dv.DICHVU_ID, dv.NOITHUCHIEN_ID, isnull(dv.NGAYTAO, dv.NGAYCAPNHAT) as THOIGIANDKDICHVU,        dv.KHAN, dv.NOIYEUCAU_ID, dv.NGAYGIOYEUCAU, dv.BACSICHIDINH_ID, dv.DONVIGIOITHIEU_ID, dv.NGUOIGIOITHIEU_ID, dv.TRANGTHAI_WFL,        tn.NOIGIOITHIEU_ID, kbnt.HUONGGIAIQUYET_ID,        dv.DVYEUCAU_ID, dv.MARIS, dv.TRANGTHAI as TRANGTHAICODE, B.TENNHOMDICHVU, dv.SOPHIEUYEUCAU, dv.KHAMBENH_NGOAITRU_ID, dv.NGUOICAPNHAT_ID, dv.NGAYCAPNHAT,        CASE        WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU        WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2) END AS MANHOMDICHVU, B.MANHOMDICHVU as MANHOMDICHVUCHITIET, tn.TRANGTHAI as TRANGTHAI_TIEPNHAN,        'False' as DAKHAM,        vp.DATHANHTOAN, vp.DONGIA_DOANHTHU, BA.SOBENHAN, dv.CHANDOAN        , a.TENDICHVU, nth.TENPHONGBAN as TENPHONGKHAM, nyc.TENPHONGBAN as TENKHOACHIDINH        , case when (dv.DONVIGIOITHIEU_ID is not null and dv.DONVIGIOITHIEU_ID != '') then ngt.TENBENHVIEN else @TenBenhVien end as TENBENHVIENCHIDINH        , case when (dv.BACSICHIDINH_ID is not null and dv.BACSICHIDINH_ID != '') then bscd.TENNHANVIEN else ngtt.TENNHANVIEN end as TENBACSICHIDINH          ,             0 as GUINGOAI, 0 as VTYT, 0 as CLSKETQUA_ID                   FROM TT_DVYEUCAU (NOLOCK) dv        inner join TT_TIEPNHAN (NOLOCK) tn on dv.TIEPNHAN_ID = tn.TIEPNHAN_ID        inner join TT_BENHNHAN (NOLOCK) bn on tn.BENHNHAN_ID = bn.BENHNHAN_ID        inner join TM_DICHVU A on A.DICHVU_ID = dv.DICHVU_ID        inner join TM_PHONGBAN nth on nth.PHONGBAN_ID = dv.NOITHUCHIEN_ID        left join TM_BENHVIEN ngt on ngt.BENHVIEN_STT_ID = dv.DONVIGIOITHIEU_ID        left join TM_NHANVIEN bscd on bscd.NHANVIEN_ID = dv.BACSICHIDINH_ID        left join TM_NHANVIEN ngtt on ngtt.NHANVIEN_ID = dv.NGUOIGIOITHIEU_ID        inner join TM_PHONGBAN nyc on nyc.PHONGBAN_ID = dv.NOIYEUCAU_ID        inner join TM_NHOMDICHVU B on B.NHOMDICHVU_ID = A.NHOMDICHVU_ID        inner join TT_VIENPHI (NOLOCK) VP on VP.TIEPNHAN_ID = tn.TIEPNHAN_ID and VP.DICHVU_ID = dv.DICHVU_ID and VP.REF_ID = dv.DVYEUCAU_ID        left join TT_NOITRU_BENHAN (NOLOCK) BA on BA.TIEPNHAN_ID = tn.TIEPNHAN_ID AND dv.BENHAN_ID = BA.BENHAN_ID        inner join TM_GENDER GD on GD.ID = bn.GIOITINH        left join TT_NGOAITRU_KHAMBENH (NOLOCK) kbnt on kbnt.KHAMBENH_ID = dv.KHAMBENH_NGOAITRU_ID                 where        dv.DICHVU_ID IS NOT NULL        and tn.BENHVIEN_ID = 'HLU01'        and HUYYEUCAU = 0        and dv.NGAYHENCLS is NULL                       and dv.TRANGTHAI = 'CHUAKETQUA'           and           dv.NGAYYEUCAU >= '10/29/2019 12:00:00 AM'         and           dv.NGAYYEUCAU <= '10/29/2019 12:00:00 AM'         and           dv.NOITHUCHIEN_ID = 79         and           (vp.DATHANHTOAN = '1'  or vp.DONGIA_DOANHTHU = '0' OR TN.SUDUNG_BHTN='1' OR TN.BAOLANH_VIENPHI='1'  OR tn.TRANGTHAI IN ('NOITRU','CAPCUU','NGOAITRU') or dv.HOPDONG_BENHNHAN_ID is not null or vp.BENHNHAN_PHAITHANHTOAN >= 0)         and           (CASE          WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU          WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2) END) in (02)         and           tn.TRANGTHAI IN ('DATIEPNHAN','NOITRU','CAPCUU','NGOAITRU', 'HOANTHANH')                 ) data1) lst                    where          lst.ROWNUMBER between 1 and 5                 order by NGAYGIOYEUCAU asc]
2019-10-29 16:52:25,871 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS31'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 16:52:26,102 [1] DEBUG - Statement Id: [DAO00019_DanhSachCDHA] PreparedStatement : [declare @TenBenhVien nvarchar(500)        declare @ManhomDSA varchar(10);        set @TenBenhVien = (select VALUE from TM_SYS_APPSETTINGS where CODE = 'APP_BENHVIEN_TEN')        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        select * from(        select ROW_NUMBER() OVER(order by NGAYGIOYEUCAU) as ROWNUMBER, *        from        (SELECT distinct        COUNT(*) OVER() as TOTALROWS,        N'Mã người bệnh: ' + bn.MAYTE + ' - ' + N'Tên người bệnh: ' + bn.TENBENHNHAN + ' - ' + N'Số bệnh án: ' + ISNULL(BA.SOBENHAN,'') + ' - ' + N'Sinh ngày: ' + isnull(Convert(varchar(10),bn.NGAYSINH,103),bn.NAMSINH) + ' - ' + N'Giới tính: ' + GD.DESCRIPTION as GROUPNAME,        bn.MAYTE, bn.TENBENHNHAN, bn.NAMSINH, bn.NGAYSINH as TUOI, ISNULL(CONVERT(VARCHAR(10), bn.NGAYSINH, 103),CAST(bn.NAMSINH AS varchar)) as NGAYSINH, bn.DIACHILIENLAC as DIACHI, bn.GIOITINH, GD.DESCRIPTION as TENGIOITINH,        tn.DOITUONG_ID, tn.THOIGIANTIEPNHAN, tn.BENHNHAN_ID, tn.TIEPNHAN_ID, tn.TRAITUYEN, tn.SOTIEPNHAN,        dv.DICHVU_ID, dv.NOITHUCHIEN_ID, isnull(dv.NGAYTAO, dv.NGAYCAPNHAT) as THOIGIANDKDICHVU,        dv.KHAN, dv.NOIYEUCAU_ID, dv.NGAYGIOYEUCAU, dv.BACSICHIDINH_ID, dv.DONVIGIOITHIEU_ID, dv.NGUOIGIOITHIEU_ID, dv.TRANGTHAI_WFL,        tn.NOIGIOITHIEU_ID, kbnt.HUONGGIAIQUYET_ID,        dv.DVYEUCAU_ID, dv.MARIS, dv.TRANGTHAI as TRANGTHAICODE, B.TENNHOMDICHVU, dv.SOPHIEUYEUCAU, dv.KHAMBENH_NGOAITRU_ID, dv.NGUOICAPNHAT_ID, dv.NGAYCAPNHAT,        CASE        WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU        WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2) END AS MANHOMDICHVU, B.MANHOMDICHVU as MANHOMDICHVUCHITIET, tn.TRANGTHAI as TRANGTHAI_TIEPNHAN,        'True' as DAKHAM,        vp.DATHANHTOAN, vp.DONGIA_DOANHTHU, BA.SOBENHAN, dv.CHANDOAN        , a.TENDICHVU, nth.TENPHONGBAN as TENPHONGKHAM, nyc.TENPHONGBAN as TENKHOACHIDINH        , case when (dv.DONVIGIOITHIEU_ID is not null and dv.DONVIGIOITHIEU_ID != '') then ngt.TENBENHVIEN else @TenBenhVien end as TENBENHVIENCHIDINH        , case when (dv.BACSICHIDINH_ID is not null and dv.BACSICHIDINH_ID != '') then bscd.TENNHANVIEN else ngtt.TENNHANVIEN end as TENBACSICHIDINH          ,             cls.CLSKETQUA_ID, cls.NGAYGIOTHUCHIEN , cls.THOIGIANKHOADULIEU, cls.NGUOIKHOA_ID, cls_vtyt.CLSKETQUA_ID as VTYT            , cls.GUINGOAI, cls.NOIGUIDEN_ID, dv.TENNGUOIKHOA                   FROM TT_DVYEUCAU (NOLOCK) dv        inner join TT_TIEPNHAN (NOLOCK) tn on dv.TIEPNHAN_ID = tn.TIEPNHAN_ID        inner join TT_BENHNHAN (NOLOCK) bn on tn.BENHNHAN_ID = bn.BENHNHAN_ID        inner join TM_DICHVU A on A.DICHVU_ID = dv.DICHVU_ID        inner join TM_PHONGBAN nth on nth.PHONGBAN_ID = dv.NOITHUCHIEN_ID        left join TM_BENHVIEN ngt on ngt.BENHVIEN_STT_ID = dv.DONVIGIOITHIEU_ID        left join TM_NHANVIEN bscd on bscd.NHANVIEN_ID = dv.BACSICHIDINH_ID        left join TM_NHANVIEN ngtt on ngtt.NHANVIEN_ID = dv.NGUOIGIOITHIEU_ID        inner join TM_PHONGBAN nyc on nyc.PHONGBAN_ID = dv.NOIYEUCAU_ID        inner join TM_NHOMDICHVU B on B.NHOMDICHVU_ID = A.NHOMDICHVU_ID        inner join TT_VIENPHI (NOLOCK) VP on VP.TIEPNHAN_ID = tn.TIEPNHAN_ID and VP.DICHVU_ID = dv.DICHVU_ID and VP.REF_ID = dv.DVYEUCAU_ID        left join TT_NOITRU_BENHAN (NOLOCK) BA on BA.TIEPNHAN_ID = tn.TIEPNHAN_ID AND dv.BENHAN_ID = BA.BENHAN_ID        inner join TM_GENDER GD on GD.ID = bn.GIOITINH        left join TT_NGOAITRU_KHAMBENH (NOLOCK) kbnt on kbnt.KHAMBENH_ID = dv.KHAMBENH_NGOAITRU_ID                       left join TT_CLSKETQUA (NOLOCK) cls on dv.DVYEUCAU_ID = cls.DVYEUCAU_ID            left join TT_CLSKETQUA_VTYT (NOLOCK) cls_vtyt on cls_vtyt.DVYEUCAU_ID = dv.DVYEUCAU_ID                   where        dv.DICHVU_ID IS NOT NULL        and tn.BENHVIEN_ID = 'HLU01'        and HUYYEUCAU = 0        and dv.NGAYHENCLS is NULL                       and dv.TRANGTHAI IN ('CHOXACNHAN','HOANTAT')           and           dv.NGAYYEUCAU >= '6/1/2019 12:00:00 AM'         and           dv.NGAYYEUCAU <= '10/29/2019 12:00:00 AM'         and           dv.NOITHUCHIEN_ID = 79         and           (vp.DATHANHTOAN = '1'  or vp.DONGIA_DOANHTHU = '0' OR TN.SUDUNG_BHTN='1' OR TN.BAOLANH_VIENPHI='1'  OR tn.TRANGTHAI IN ('NOITRU','CAPCUU','NGOAITRU') or dv.HOPDONG_BENHNHAN_ID is not null or vp.BENHNHAN_PHAITHANHTOAN >= 0)         and           (bn.TENBENHNHAN like '%' +  @param0  + '%' or bn.MAYTE like '%' +  @param0  + '%')         and           (CASE          WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU          WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2) END) in (02)                 ) data1) lst                    where          lst.ROWNUMBER between 1 and 5                 order by NGAYGIOYEUCAU asc]
2019-10-29 16:52:26,103 [1] DEBUG - Statement Id: [DAO00019_DanhSachCDHA] Parameters: [@param0=[TENBENHNHAN,Côi]]
2019-10-29 16:52:26,103 [1] DEBUG - Statement Id: [DAO00019_DanhSachCDHA] Types: [@param0=[String, System.String]]
2019-10-29 16:52:26,249 [1] DEBUG - Statement Id: [DAO00000_GetNhomDoiTuong] PreparedStatement : [SELECT DOITUONG_ID              ,[TENDOITUONG]              ,[NHOMDICHVU]              ,[TYLE_VUOT_LCB]              ,[GIOIHAN_VUOT_LCB]              ,[GIOIHAN_VUOT_DVKTC]              ,[TYLE_THUOC_UT]              ,[CPVC]              ,[CHIPHINGOAI_BHYT]              ,[NGANSACH_TL]              ,[MIENGIAM_TL]              ,[TAITRO_TL]              ,[BHTN_TL]              FROM [dbo].[TM_DOITUONG]]
2019-10-29 16:52:27,887 [1] DEBUG - Statement Id: [DAO00019_ThongTinBenhNhanDvYeuCau] PreparedStatement : [select distinct A.SOTIEPNHAN, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI, A.NGAYMIENDONGCHITRA,        B.*,  C.DICHVU_ID, C.DVYEUCAU_ID, C.NOITHUCHIEN_ID, A.SOBHYT        from TT_TIEPNHAN A        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'        where                    C.DVYEUCAU_ID = '205346'                 and A.BENHVIEN_ID = 'HLU01']
2019-10-29 16:52:28,134 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '26239'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2019-10-29 16:52:28,223 [1] DEBUG - Statement Id: [DAO00046_GETLISTDVYEUCAUINLISTDVID] PreparedStatement : [SELECT dvyc.*, clskqct.CLSKETQUA_ID, clskqct.DICHVU_ID as KETQUA_DICHVU_ID,        clskqct.CLSKETQUACHITIET_ID, clskqct.DONVITINH, clskqct.KETQUA, clskqct.KETQUA2,        clskqct.MUCBINHTHUONG, clskqct.MUCBINHTHUONGMIN, clskqct.MUCBINHTHUONGMAX, clskqct.BATTHUONG        FROM dbo.TT_CLSKETQUACHITIET as clskqct RIGHT OUTER JOIN        dbo.TT_DVYEUCAU as dvyc ON                 clskqct.DVYEUCAU_ID = dvyc.DVYEUCAU_ID        where dvyc.BENHVIEN_ID = 'HLU01'          and             exists (select DICHVU_ID from TM_DICHVU a join TM_NHOMDICHVU b on a.NHOMDICHVU_ID = b.NHOMDICHVU_ID            where dvyc.DICHVU_ID = DICHVU_ID and (left(MANHOMDICHVU,2) in ('02', '03') OR MANHOMDICHVU in ('02', '03')))           and             dvyc.TIEPNHAN_ID =  @param0                    order by DVYEUCAU_ID]
2019-10-29 16:52:28,223 [1] DEBUG - Statement Id: [DAO00046_GETLISTDVYEUCAUINLISTDVID] Parameters: [@param0=[TIEPNHAN_ID,26239]]
2019-10-29 16:52:28,223 [1] DEBUG - Statement Id: [DAO00046_GETLISTDVYEUCAUINLISTDVID] Types: [@param0=[Int64, System.Int64]]
2019-10-29 16:52:28,254 [1] DEBUG - Statement Id: [DAO00045_GetListDVYeuCau] PreparedStatement : [select *              from VIEW_DICHVU_NHOMDV              where BENHVIEN_ID = 'HLU01']
2019-10-29 16:52:30,109 [1] DEBUG - Statement Id: [DAO00018_GetList] PreparedStatement : [select A.*, B.DICTIONARY_NAME, B.DICTIONARY_CODE, B.DICTIONARY_NAME_EN CHUCDANH, (B.DICTIONARY_NAME_EN + '. ' + A.TENNHANVIEN) TENHOCVIHOCHAM            from TM_NHANVIEN A            left join (select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE = 'chucdanh' and DICTIONARY_NAME_EN is not null) B on A.CHUCDANH_ID = B.DICTIONARY_ID            where A.BENHVIEN_ID = '' and A.TAMNGUNG = '0']
2019-10-29 16:52:30,139 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '26239'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2019-10-29 16:52:37,068 [1] DEBUG - Statement Id: [DAO00037_GetCLSKetQua] PreparedStatement : [select *              from TT_CLSKETQUA               where                             TT_CLSKETQUA.DVYEUCAU_ID = '205346'                       and                           TT_CLSKETQUA.BENHVIEN_ID = 'HLU01'                                     order by CLSKETQUA_ID]
2019-10-29 16:52:37,223 [1] DEBUG - Statement Id: [DAO00020_GetDetailP] PreparedStatement : [select *        from TT_DVYEUCAU        where TT_DVYEUCAU.DVYEUCAU_ID  = 205346        order by DVYEUCAU_ID]
2019-10-29 16:52:37,340 [1] DEBUG - Statement Id: [DAO00017_GetNameByID] PreparedStatement : [select TENPHONGBAN              from [TM_PHONGBAN]              where PHONGBAN_ID = '18' and BENHVIEN_ID = 'HLU01']
2019-10-29 16:52:37,431 [1] DEBUG - Statement Id: [DAO00041_GetNameByID] PreparedStatement : [select TENDICHVU              from TM_DICHVU              where DICHVU_ID = '4144']
2019-10-29 16:52:38,076 [1] DEBUG - Statement Id: [DAO00038_GetList] PreparedStatement : [select *              from TT_CLSKETQUA_IMAGES               where                             TT_CLSKETQUA_IMAGES.CLSKETQUA_ID = '96455'                       and                           TT_CLSKETQUA_IMAGES.BENHVIEN_ID = 'HLU01'                                     order by IDX]
2019-10-29 16:52:38,112 [1] DEBUG - Statement Id: [DAO00222_GetList] PreparedStatement : [select *        from TT_CLSKETQUA_DOCUMENTS         where                 CLSKETQUA_ID = '96455'                     order by CLSKETQUA_DOCUMENTS_ID]
2019-10-29 16:52:38,146 [1] DEBUG - Statement Id: [DAO00116_File_GetList] PreparedStatement : [select *              from TT_FILE_DINHKEM               where                             TT_FILE_DINHKEM.REF_TABLE = 'TT_CLSKETQUA'                       and                           TT_FILE_DINHKEM.REF_ID = '96455'                       and                           TT_FILE_DINHKEM.BENHVIEN_ID = 'HLU01'                                     order by FILE_ID]
2019-10-29 16:52:38,220 [1] DEBUG - Statement Id: [DAO00087_GetServiceParams] PreparedStatement : [select CODE, VALUE              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01']
2019-10-29 16:52:38,254 [1] DEBUG - Statement Id: [DAO00042_GetList] PreparedStatement : [select *              from TM_TUDIENKETQUA              where BENHVIEN_ID = 'HLU01'                and                       TM_TUDIENKETQUA.DICHVU_ID = '4144'                    and                       (TM_TUDIENKETQUA.NGUOITAO_ID = '1' OR TM_TUDIENKETQUA.SUDUNGCHUNG = '1')                                 order by TM_TUDIENKETQUA.TENNOIDUNG]
2019-10-29 16:52:38,288 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '26239'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2019-10-29 16:52:47,561 [1] DEBUG - Statement Id: [DAO00037_GetCLSKetQua] PreparedStatement : [select *              from TT_CLSKETQUA               where                             TT_CLSKETQUA.DVYEUCAU_ID = '205346'                       and                           TT_CLSKETQUA.BENHVIEN_ID = 'HLU01'                                     order by CLSKETQUA_ID]
2019-10-29 16:52:52,900 [1] DEBUG - Statement Id: [DAO00020_GetDetailP] PreparedStatement : [select *        from TT_DVYEUCAU        where TT_DVYEUCAU.DVYEUCAU_ID  = 205346        order by DVYEUCAU_ID]
2019-10-29 16:52:53,053 [1] DEBUG - Statement Id: [DAO00017_GetNameByID] PreparedStatement : [select TENPHONGBAN              from [TM_PHONGBAN]              where PHONGBAN_ID = '18' and BENHVIEN_ID = 'HLU01']
2019-10-29 16:52:53,197 [1] DEBUG - Statement Id: [DAO00041_GetNameByID] PreparedStatement : [select TENDICHVU              from TM_DICHVU              where DICHVU_ID = '4144']
2019-10-29 16:52:53,314 [1] DEBUG - Statement Id: [DAO00038_GetList] PreparedStatement : [select *              from TT_CLSKETQUA_IMAGES               where                             TT_CLSKETQUA_IMAGES.CLSKETQUA_ID = '96455'                       and                           TT_CLSKETQUA_IMAGES.BENHVIEN_ID = 'HLU01'                                     order by IDX]
2019-10-29 16:52:53,367 [1] DEBUG - Statement Id: [DAO00222_GetList] PreparedStatement : [select *        from TT_CLSKETQUA_DOCUMENTS         where                 CLSKETQUA_ID = '96455'                     order by CLSKETQUA_DOCUMENTS_ID]
2019-10-29 16:52:53,415 [1] DEBUG - Statement Id: [DAO00116_File_GetList] PreparedStatement : [select *              from TT_FILE_DINHKEM               where                             TT_FILE_DINHKEM.REF_TABLE = 'TT_CLSKETQUA'                       and                           TT_FILE_DINHKEM.REF_ID = '96455'                       and                           TT_FILE_DINHKEM.BENHVIEN_ID = 'HLU01'                                     order by FILE_ID]
2019-10-29 16:54:14,983 [1] DEBUG - Statement Id: [DAO00042_GetList] PreparedStatement : [select *              from TM_TUDIENKETQUA              where BENHVIEN_ID = 'HLU01'                and                       TM_TUDIENKETQUA.DICHVU_ID = '4144'                    and                       (TM_TUDIENKETQUA.NGUOITAO_ID = '1' OR TM_TUDIENKETQUA.SUDUNGCHUNG = '1')                                 order by TM_TUDIENKETQUA.TENNOIDUNG]
2019-10-29 16:54:15,024 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '26239'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2019-10-29 16:54:17,229 [1] DEBUG - Statement Id: [DAO00116_GetListThietBiCLS] PreparedStatement : [SELECT THIETBI_ID, MATHIETBI, TENTHIETBI, NHOMTHIETBI_ID          FROM TM_THIETBI MP          where          TAMNGUNG = '0'          and BENHVIEN_ID = 'HLU01'           AND             PHONGBAN_ID = 79                     order by TENTHIETBI]
--------------------------------------------------------------------------------
2019-10-29 17:05:14,267 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2019-10-29 17:05:14,583 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-10-29 17:05:14,620 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-10-29 17:05:15,080 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 17:05:15,963 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-10-29 17:05:21,840 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2019-10-29 17:05:21,868 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-10-29 17:05:23,928 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-10-29 17:05:24,144 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-10-29 17:05:25,066 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2019-10-29 17:05:25,251 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2019-10-29 17:05:25,331 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2019-10-29 17:05:25,413 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2019-10-29 17:05:25,489 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2019-10-29 17:05:25,572 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2019-10-29 17:05:25,649 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2019-10-29 17:05:25,745 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2019-10-29 17:05:25,867 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2019-10-29 17:05:26,749 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2019-10-29 17:05:26,793 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2019-10-29 17:05:26,872 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2019-10-29 17:05:26,906 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2019-10-29 17:05:29,294 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2019-10-29 17:05:29,340 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @NGUONDUOC_MACDINH varchar(5) = '0';        declare @TOAMUANGOAI int = 0;        select @NGUONDUOC_MACDINH = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'PHA_NGUONDUOC'        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + @NGUONDUOC_MACDINH as DUOC_KEY, 0 as PHAMVI_ID, @NGUONDUOC_MACDINH as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end        else        begin                  select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2019-10-29 17:05:32,044 [5] DEBUG - Statement Id: [DAO00320_GetList] PreparedStatement : [select M.*            from TM_MAU M            LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID            where            M.TAMNGUNG = '0'            and M.BENHVIEN_ID = 'HLU01'            order by M.TENMAU]
2019-10-29 17:05:32,113 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2019-10-29 17:05:32,149 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,        SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH        FROM TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID        WHERE TK.SOLUONG > 0        GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2019-10-29 17:05:32,554 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2019-10-29 17:05:32,588 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,        TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,        TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH        from TM_MAU M        JOIN        (        select        A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO        from        (        select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO        from TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'        where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0        ) A        )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2019-10-29 17:05:33,615 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2019-10-29 17:05:34,577 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 17:05:35,408 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2019-10-29 17:05:41,239 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2019-10-29 17:05:41,270 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2019-10-29 17:05:41,351 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 17:05:41,492 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 17:05:41,632 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2019-10-29 17:05:41,635 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-10-29 17:05:41,635 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-10-29 17:05:41,666 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2019-10-29 17:05:41,667 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-10-29 17:05:41,667 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-10-29 17:05:41,809 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 17:05:41,967 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 17:05:49,491 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 17:05:49,583 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2019-10-29 17:05:50,028 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2019-10-29 17:05:59,786 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS03'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 17:06:04,260 [1] DEBUG - Statement Id: [DAO00006_GetDSNhomDichVu] PreparedStatement : [select * from TM_NHOMDICHVU              where captren_id =              (select top (1) NHOMDICHVU_ID from TM_NHOMDICHVU where MANHOMDICHVU = '02')              and BENHVIEN_ID = 'HLU01']
2019-10-29 17:06:04,295 [1] DEBUG - Statement Id: [DAO00006_GetDSNhomDichVu] PreparedStatement : [select * from TM_NHOMDICHVU              where captren_id =              (select top (1) NHOMDICHVU_ID from TM_NHOMDICHVU where MANHOMDICHVU = '03')              and BENHVIEN_ID = 'HLU01']
2019-10-29 17:06:04,782 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 17:06:04,999 [1] DEBUG - Statement Id: [DAO00019_DanhSachCDHA] PreparedStatement : [declare @TenBenhVien nvarchar(500)        declare @ManhomDSA varchar(10);        set @TenBenhVien = (select VALUE from TM_SYS_APPSETTINGS where CODE = 'APP_BENHVIEN_TEN')        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        select * from(        select ROW_NUMBER() OVER(order by NGAYGIOYEUCAU) as ROWNUMBER, *        from        (SELECT distinct        COUNT(*) OVER() as TOTALROWS,        N'Mã người bệnh: ' + bn.MAYTE + ' - ' + N'Tên người bệnh: ' + bn.TENBENHNHAN + ' - ' + N'Số bệnh án: ' + ISNULL(BA.SOBENHAN,'') + ' - ' + N'Sinh ngày: ' + isnull(Convert(varchar(10),bn.NGAYSINH,103),bn.NAMSINH) + ' - ' + N'Giới tính: ' + GD.DESCRIPTION as GROUPNAME,        bn.MAYTE, bn.TENBENHNHAN, bn.NAMSINH, bn.NGAYSINH as TUOI, ISNULL(CONVERT(VARCHAR(10), bn.NGAYSINH, 103),CAST(bn.NAMSINH AS varchar)) as NGAYSINH, bn.DIACHILIENLAC as DIACHI, bn.GIOITINH, GD.DESCRIPTION as TENGIOITINH,        tn.DOITUONG_ID, tn.THOIGIANTIEPNHAN, tn.BENHNHAN_ID, tn.TIEPNHAN_ID, tn.TRAITUYEN, tn.SOTIEPNHAN,        dv.DICHVU_ID, dv.NOITHUCHIEN_ID, isnull(dv.NGAYTAO, dv.NGAYCAPNHAT) as THOIGIANDKDICHVU,        dv.KHAN, dv.NOIYEUCAU_ID, dv.NGAYGIOYEUCAU, dv.BACSICHIDINH_ID, dv.DONVIGIOITHIEU_ID, dv.NGUOIGIOITHIEU_ID, dv.TRANGTHAI_WFL,        tn.NOIGIOITHIEU_ID, kbnt.HUONGGIAIQUYET_ID,        dv.DVYEUCAU_ID, dv.MARIS, dv.TRANGTHAI as TRANGTHAICODE, B.TENNHOMDICHVU, dv.SOPHIEUYEUCAU, dv.KHAMBENH_NGOAITRU_ID, dv.NGUOICAPNHAT_ID, dv.NGAYCAPNHAT,        CASE        WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU        WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2) END AS MANHOMDICHVU, B.MANHOMDICHVU as MANHOMDICHVUCHITIET, tn.TRANGTHAI as TRANGTHAI_TIEPNHAN,        'False' as DAKHAM,        vp.DATHANHTOAN, vp.DONGIA_DOANHTHU, BA.SOBENHAN, dv.CHANDOAN        , a.TENDICHVU, nth.TENPHONGBAN as TENPHONGKHAM, nyc.TENPHONGBAN as TENKHOACHIDINH        , case when (dv.DONVIGIOITHIEU_ID is not null and dv.DONVIGIOITHIEU_ID != '') then ngt.TENBENHVIEN else @TenBenhVien end as TENBENHVIENCHIDINH        , case when (dv.BACSICHIDINH_ID is not null and dv.BACSICHIDINH_ID != '') then bscd.TENNHANVIEN else ngtt.TENNHANVIEN end as TENBACSICHIDINH          ,             0 as GUINGOAI, 0 as VTYT, 0 as CLSKETQUA_ID                   FROM TT_DVYEUCAU (NOLOCK) dv        inner join TT_TIEPNHAN (NOLOCK) tn on dv.TIEPNHAN_ID = tn.TIEPNHAN_ID        inner join TT_BENHNHAN (NOLOCK) bn on tn.BENHNHAN_ID = bn.BENHNHAN_ID        inner join TM_DICHVU A on A.DICHVU_ID = dv.DICHVU_ID        inner join TM_PHONGBAN nth on nth.PHONGBAN_ID = dv.NOITHUCHIEN_ID        left join TM_BENHVIEN ngt on ngt.BENHVIEN_STT_ID = dv.DONVIGIOITHIEU_ID        left join TM_NHANVIEN bscd on bscd.NHANVIEN_ID = dv.BACSICHIDINH_ID        left join TM_NHANVIEN ngtt on ngtt.NHANVIEN_ID = dv.NGUOIGIOITHIEU_ID        inner join TM_PHONGBAN nyc on nyc.PHONGBAN_ID = dv.NOIYEUCAU_ID        inner join TM_NHOMDICHVU B on B.NHOMDICHVU_ID = A.NHOMDICHVU_ID        inner join TT_VIENPHI (NOLOCK) VP on VP.TIEPNHAN_ID = tn.TIEPNHAN_ID and VP.DICHVU_ID = dv.DICHVU_ID and VP.REF_ID = dv.DVYEUCAU_ID        left join TT_NOITRU_BENHAN (NOLOCK) BA on BA.TIEPNHAN_ID = tn.TIEPNHAN_ID AND dv.BENHAN_ID = BA.BENHAN_ID        inner join TM_GENDER GD on GD.ID = bn.GIOITINH        left join TT_NGOAITRU_KHAMBENH (NOLOCK) kbnt on kbnt.KHAMBENH_ID = dv.KHAMBENH_NGOAITRU_ID                 where        dv.DICHVU_ID IS NOT NULL        and tn.BENHVIEN_ID = 'HLU01'        and HUYYEUCAU = 0        and dv.NGAYHENCLS is NULL                       and dv.TRANGTHAI = 'CHUAKETQUA'           and           dv.NGAYYEUCAU >= '10/29/2019 12:00:00 AM'         and           dv.NGAYYEUCAU <= '10/29/2019 12:00:00 AM'         and           dv.NOITHUCHIEN_ID = 79         and           (vp.DATHANHTOAN = '1'  or vp.DONGIA_DOANHTHU = '0' OR TN.SUDUNG_BHTN='1' OR TN.BAOLANH_VIENPHI='1'  OR tn.TRANGTHAI IN ('NOITRU','CAPCUU','NGOAITRU') or dv.HOPDONG_BENHNHAN_ID is not null or vp.BENHNHAN_PHAITHANHTOAN >= 0)         and           (CASE          WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU          WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2) END) in (02)         and           tn.TRANGTHAI IN ('DATIEPNHAN','NOITRU','CAPCUU','NGOAITRU', 'HOANTHANH')                 ) data1) lst                    where          lst.ROWNUMBER between 1 and 5                 order by NGAYGIOYEUCAU asc]
2019-10-29 17:06:05,883 [1] DEBUG - Statement Id: [DAO00019_DanhSachCDHA] PreparedStatement : [declare @TenBenhVien nvarchar(500)        declare @ManhomDSA varchar(10);        set @TenBenhVien = (select VALUE from TM_SYS_APPSETTINGS where CODE = 'APP_BENHVIEN_TEN')        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        select * from(        select ROW_NUMBER() OVER(order by NGAYGIOYEUCAU) as ROWNUMBER, *        from        (SELECT distinct        COUNT(*) OVER() as TOTALROWS,        N'Mã người bệnh: ' + bn.MAYTE + ' - ' + N'Tên người bệnh: ' + bn.TENBENHNHAN + ' - ' + N'Số bệnh án: ' + ISNULL(BA.SOBENHAN,'') + ' - ' + N'Sinh ngày: ' + isnull(Convert(varchar(10),bn.NGAYSINH,103),bn.NAMSINH) + ' - ' + N'Giới tính: ' + GD.DESCRIPTION as GROUPNAME,        bn.MAYTE, bn.TENBENHNHAN, bn.NAMSINH, bn.NGAYSINH as TUOI, ISNULL(CONVERT(VARCHAR(10), bn.NGAYSINH, 103),CAST(bn.NAMSINH AS varchar)) as NGAYSINH, bn.DIACHILIENLAC as DIACHI, bn.GIOITINH, GD.DESCRIPTION as TENGIOITINH,        tn.DOITUONG_ID, tn.THOIGIANTIEPNHAN, tn.BENHNHAN_ID, tn.TIEPNHAN_ID, tn.TRAITUYEN, tn.SOTIEPNHAN,        dv.DICHVU_ID, dv.NOITHUCHIEN_ID, isnull(dv.NGAYTAO, dv.NGAYCAPNHAT) as THOIGIANDKDICHVU,        dv.KHAN, dv.NOIYEUCAU_ID, dv.NGAYGIOYEUCAU, dv.BACSICHIDINH_ID, dv.DONVIGIOITHIEU_ID, dv.NGUOIGIOITHIEU_ID, dv.TRANGTHAI_WFL,        tn.NOIGIOITHIEU_ID, kbnt.HUONGGIAIQUYET_ID,        dv.DVYEUCAU_ID, dv.MARIS, dv.TRANGTHAI as TRANGTHAICODE, B.TENNHOMDICHVU, dv.SOPHIEUYEUCAU, dv.KHAMBENH_NGOAITRU_ID, dv.NGUOICAPNHAT_ID, dv.NGAYCAPNHAT,        CASE        WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU        WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2) END AS MANHOMDICHVU, B.MANHOMDICHVU as MANHOMDICHVUCHITIET, tn.TRANGTHAI as TRANGTHAI_TIEPNHAN,        'False' as DAKHAM,        vp.DATHANHTOAN, vp.DONGIA_DOANHTHU, BA.SOBENHAN, dv.CHANDOAN        , a.TENDICHVU, nth.TENPHONGBAN as TENPHONGKHAM, nyc.TENPHONGBAN as TENKHOACHIDINH        , case when (dv.DONVIGIOITHIEU_ID is not null and dv.DONVIGIOITHIEU_ID != '') then ngt.TENBENHVIEN else @TenBenhVien end as TENBENHVIENCHIDINH        , case when (dv.BACSICHIDINH_ID is not null and dv.BACSICHIDINH_ID != '') then bscd.TENNHANVIEN else ngtt.TENNHANVIEN end as TENBACSICHIDINH          ,             0 as GUINGOAI, 0 as VTYT, 0 as CLSKETQUA_ID                   FROM TT_DVYEUCAU (NOLOCK) dv        inner join TT_TIEPNHAN (NOLOCK) tn on dv.TIEPNHAN_ID = tn.TIEPNHAN_ID        inner join TT_BENHNHAN (NOLOCK) bn on tn.BENHNHAN_ID = bn.BENHNHAN_ID        inner join TM_DICHVU A on A.DICHVU_ID = dv.DICHVU_ID        inner join TM_PHONGBAN nth on nth.PHONGBAN_ID = dv.NOITHUCHIEN_ID        left join TM_BENHVIEN ngt on ngt.BENHVIEN_STT_ID = dv.DONVIGIOITHIEU_ID        left join TM_NHANVIEN bscd on bscd.NHANVIEN_ID = dv.BACSICHIDINH_ID        left join TM_NHANVIEN ngtt on ngtt.NHANVIEN_ID = dv.NGUOIGIOITHIEU_ID        inner join TM_PHONGBAN nyc on nyc.PHONGBAN_ID = dv.NOIYEUCAU_ID        inner join TM_NHOMDICHVU B on B.NHOMDICHVU_ID = A.NHOMDICHVU_ID        inner join TT_VIENPHI (NOLOCK) VP on VP.TIEPNHAN_ID = tn.TIEPNHAN_ID and VP.DICHVU_ID = dv.DICHVU_ID and VP.REF_ID = dv.DVYEUCAU_ID        left join TT_NOITRU_BENHAN (NOLOCK) BA on BA.TIEPNHAN_ID = tn.TIEPNHAN_ID AND dv.BENHAN_ID = BA.BENHAN_ID        inner join TM_GENDER GD on GD.ID = bn.GIOITINH        left join TT_NGOAITRU_KHAMBENH (NOLOCK) kbnt on kbnt.KHAMBENH_ID = dv.KHAMBENH_NGOAITRU_ID                 where        dv.DICHVU_ID IS NOT NULL        and tn.BENHVIEN_ID = 'HLU01'        and HUYYEUCAU = 0        and dv.NGAYHENCLS is NULL                       and dv.TRANGTHAI = 'CHUAKETQUA'           and           dv.NGAYYEUCAU >= '10/29/2019 12:00:00 AM'         and           dv.NGAYYEUCAU <= '10/29/2019 12:00:00 AM'         and           dv.NOITHUCHIEN_ID = 79         and           (vp.DATHANHTOAN = '1'  or vp.DONGIA_DOANHTHU = '0' OR TN.SUDUNG_BHTN='1' OR TN.BAOLANH_VIENPHI='1'  OR tn.TRANGTHAI IN ('NOITRU','CAPCUU','NGOAITRU') or dv.HOPDONG_BENHNHAN_ID is not null or vp.BENHNHAN_PHAITHANHTOAN >= 0)         and           (CASE          WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU          WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2) END) in (02)         and           tn.TRANGTHAI IN ('DATIEPNHAN','NOITRU','CAPCUU','NGOAITRU', 'HOANTHANH')                 ) data1) lst                    where          lst.ROWNUMBER between 1 and 5                 order by NGAYGIOYEUCAU asc]
2019-10-29 17:06:16,883 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS31'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 17:06:16,993 [1] DEBUG - Statement Id: [DAO00019_DanhSachCDHA] PreparedStatement : [declare @TenBenhVien nvarchar(500)        declare @ManhomDSA varchar(10);        set @TenBenhVien = (select VALUE from TM_SYS_APPSETTINGS where CODE = 'APP_BENHVIEN_TEN')        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        select * from(        select ROW_NUMBER() OVER(order by NGAYGIOYEUCAU) as ROWNUMBER, *        from        (SELECT distinct        COUNT(*) OVER() as TOTALROWS,        N'Mã người bệnh: ' + bn.MAYTE + ' - ' + N'Tên người bệnh: ' + bn.TENBENHNHAN + ' - ' + N'Số bệnh án: ' + ISNULL(BA.SOBENHAN,'') + ' - ' + N'Sinh ngày: ' + isnull(Convert(varchar(10),bn.NGAYSINH,103),bn.NAMSINH) + ' - ' + N'Giới tính: ' + GD.DESCRIPTION as GROUPNAME,        bn.MAYTE, bn.TENBENHNHAN, bn.NAMSINH, bn.NGAYSINH as TUOI, ISNULL(CONVERT(VARCHAR(10), bn.NGAYSINH, 103),CAST(bn.NAMSINH AS varchar)) as NGAYSINH, bn.DIACHILIENLAC as DIACHI, bn.GIOITINH, GD.DESCRIPTION as TENGIOITINH,        tn.DOITUONG_ID, tn.THOIGIANTIEPNHAN, tn.BENHNHAN_ID, tn.TIEPNHAN_ID, tn.TRAITUYEN, tn.SOTIEPNHAN,        dv.DICHVU_ID, dv.NOITHUCHIEN_ID, isnull(dv.NGAYTAO, dv.NGAYCAPNHAT) as THOIGIANDKDICHVU,        dv.KHAN, dv.NOIYEUCAU_ID, dv.NGAYGIOYEUCAU, dv.BACSICHIDINH_ID, dv.DONVIGIOITHIEU_ID, dv.NGUOIGIOITHIEU_ID, dv.TRANGTHAI_WFL,        tn.NOIGIOITHIEU_ID, kbnt.HUONGGIAIQUYET_ID,        dv.DVYEUCAU_ID, dv.MARIS, dv.TRANGTHAI as TRANGTHAICODE, B.TENNHOMDICHVU, dv.SOPHIEUYEUCAU, dv.KHAMBENH_NGOAITRU_ID, dv.NGUOICAPNHAT_ID, dv.NGAYCAPNHAT,        CASE        WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU        WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2) END AS MANHOMDICHVU, B.MANHOMDICHVU as MANHOMDICHVUCHITIET, tn.TRANGTHAI as TRANGTHAI_TIEPNHAN,        'True' as DAKHAM,        vp.DATHANHTOAN, vp.DONGIA_DOANHTHU, BA.SOBENHAN, dv.CHANDOAN        , a.TENDICHVU, nth.TENPHONGBAN as TENPHONGKHAM, nyc.TENPHONGBAN as TENKHOACHIDINH        , case when (dv.DONVIGIOITHIEU_ID is not null and dv.DONVIGIOITHIEU_ID != '') then ngt.TENBENHVIEN else @TenBenhVien end as TENBENHVIENCHIDINH        , case when (dv.BACSICHIDINH_ID is not null and dv.BACSICHIDINH_ID != '') then bscd.TENNHANVIEN else ngtt.TENNHANVIEN end as TENBACSICHIDINH          ,             cls.CLSKETQUA_ID, cls.NGAYGIOTHUCHIEN , cls.THOIGIANKHOADULIEU, cls.NGUOIKHOA_ID, cls_vtyt.CLSKETQUA_ID as VTYT            , cls.GUINGOAI, cls.NOIGUIDEN_ID, dv.TENNGUOIKHOA                   FROM TT_DVYEUCAU (NOLOCK) dv        inner join TT_TIEPNHAN (NOLOCK) tn on dv.TIEPNHAN_ID = tn.TIEPNHAN_ID        inner join TT_BENHNHAN (NOLOCK) bn on tn.BENHNHAN_ID = bn.BENHNHAN_ID        inner join TM_DICHVU A on A.DICHVU_ID = dv.DICHVU_ID        inner join TM_PHONGBAN nth on nth.PHONGBAN_ID = dv.NOITHUCHIEN_ID        left join TM_BENHVIEN ngt on ngt.BENHVIEN_STT_ID = dv.DONVIGIOITHIEU_ID        left join TM_NHANVIEN bscd on bscd.NHANVIEN_ID = dv.BACSICHIDINH_ID        left join TM_NHANVIEN ngtt on ngtt.NHANVIEN_ID = dv.NGUOIGIOITHIEU_ID        inner join TM_PHONGBAN nyc on nyc.PHONGBAN_ID = dv.NOIYEUCAU_ID        inner join TM_NHOMDICHVU B on B.NHOMDICHVU_ID = A.NHOMDICHVU_ID        inner join TT_VIENPHI (NOLOCK) VP on VP.TIEPNHAN_ID = tn.TIEPNHAN_ID and VP.DICHVU_ID = dv.DICHVU_ID and VP.REF_ID = dv.DVYEUCAU_ID        left join TT_NOITRU_BENHAN (NOLOCK) BA on BA.TIEPNHAN_ID = tn.TIEPNHAN_ID AND dv.BENHAN_ID = BA.BENHAN_ID        inner join TM_GENDER GD on GD.ID = bn.GIOITINH        left join TT_NGOAITRU_KHAMBENH (NOLOCK) kbnt on kbnt.KHAMBENH_ID = dv.KHAMBENH_NGOAITRU_ID                       left join TT_CLSKETQUA (NOLOCK) cls on dv.DVYEUCAU_ID = cls.DVYEUCAU_ID            left join TT_CLSKETQUA_VTYT (NOLOCK) cls_vtyt on cls_vtyt.DVYEUCAU_ID = dv.DVYEUCAU_ID                   where        dv.DICHVU_ID IS NOT NULL        and tn.BENHVIEN_ID = 'HLU01'        and HUYYEUCAU = 0        and dv.NGAYHENCLS is NULL                       and dv.TRANGTHAI IN ('CHOXACNHAN','HOANTAT')           and           dv.NGAYYEUCAU >= '5/1/2019 12:00:00 AM'         and           dv.NGAYYEUCAU <= '10/29/2019 12:00:00 AM'         and           dv.NOITHUCHIEN_ID = 79         and           (vp.DATHANHTOAN = '1'  or vp.DONGIA_DOANHTHU = '0' OR TN.SUDUNG_BHTN='1' OR TN.BAOLANH_VIENPHI='1'  OR tn.TRANGTHAI IN ('NOITRU','CAPCUU','NGOAITRU') or dv.HOPDONG_BENHNHAN_ID is not null or vp.BENHNHAN_PHAITHANHTOAN >= 0)         and           (bn.TENBENHNHAN like '%' +  @param0  + '%' or bn.MAYTE like '%' +  @param0  + '%')         and           (CASE          WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU          WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2) END) in (02)                 ) data1) lst                    where          lst.ROWNUMBER between 1 and 5                 order by NGAYGIOYEUCAU asc]
2019-10-29 17:06:16,993 [1] DEBUG - Statement Id: [DAO00019_DanhSachCDHA] Parameters: [@param0=[TENBENHNHAN,Côi]]
2019-10-29 17:06:16,993 [1] DEBUG - Statement Id: [DAO00019_DanhSachCDHA] Types: [@param0=[String, System.String]]
2019-10-29 17:06:17,732 [1] DEBUG - Statement Id: [DAO00000_GetNhomDoiTuong] PreparedStatement : [SELECT DOITUONG_ID              ,[TENDOITUONG]              ,[NHOMDICHVU]              ,[TYLE_VUOT_LCB]              ,[GIOIHAN_VUOT_LCB]              ,[GIOIHAN_VUOT_DVKTC]              ,[TYLE_THUOC_UT]              ,[CPVC]              ,[CHIPHINGOAI_BHYT]              ,[NGANSACH_TL]              ,[MIENGIAM_TL]              ,[TAITRO_TL]              ,[BHTN_TL]              FROM [dbo].[TM_DOITUONG]]
2019-10-29 17:06:25,417 [1] DEBUG - Statement Id: [DAO00019_ThongTinBenhNhanDvYeuCau] PreparedStatement : [select distinct A.SOTIEPNHAN, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI, A.NGAYMIENDONGCHITRA,        B.*,  C.DICHVU_ID, C.DVYEUCAU_ID, C.NOITHUCHIEN_ID, A.SOBHYT        from TT_TIEPNHAN A        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'        where                    C.DVYEUCAU_ID = '205346'                 and A.BENHVIEN_ID = 'HLU01']
2019-10-29 17:06:26,214 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '26239'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2019-10-29 17:06:26,339 [1] DEBUG - Statement Id: [DAO00046_GETLISTDVYEUCAUINLISTDVID] PreparedStatement : [SELECT dvyc.*, clskqct.CLSKETQUA_ID, clskqct.DICHVU_ID as KETQUA_DICHVU_ID,        clskqct.CLSKETQUACHITIET_ID, clskqct.DONVITINH, clskqct.KETQUA, clskqct.KETQUA2,        clskqct.MUCBINHTHUONG, clskqct.MUCBINHTHUONGMIN, clskqct.MUCBINHTHUONGMAX, clskqct.BATTHUONG        FROM dbo.TT_CLSKETQUACHITIET as clskqct RIGHT OUTER JOIN        dbo.TT_DVYEUCAU as dvyc ON                 clskqct.DVYEUCAU_ID = dvyc.DVYEUCAU_ID        where dvyc.BENHVIEN_ID = 'HLU01'          and             exists (select DICHVU_ID from TM_DICHVU a join TM_NHOMDICHVU b on a.NHOMDICHVU_ID = b.NHOMDICHVU_ID            where dvyc.DICHVU_ID = DICHVU_ID and (left(MANHOMDICHVU,2) in ('02', '03') OR MANHOMDICHVU in ('02', '03')))           and             dvyc.TIEPNHAN_ID =  @param0                    order by DVYEUCAU_ID]
2019-10-29 17:06:26,339 [1] DEBUG - Statement Id: [DAO00046_GETLISTDVYEUCAUINLISTDVID] Parameters: [@param0=[TIEPNHAN_ID,26239]]
2019-10-29 17:06:26,339 [1] DEBUG - Statement Id: [DAO00046_GETLISTDVYEUCAUINLISTDVID] Types: [@param0=[Int64, System.Int64]]
2019-10-29 17:06:26,387 [1] DEBUG - Statement Id: [DAO00045_GetListDVYeuCau] PreparedStatement : [select *              from VIEW_DICHVU_NHOMDV              where BENHVIEN_ID = 'HLU01']
2019-10-29 17:06:28,049 [1] DEBUG - Statement Id: [DAO00018_GetList] PreparedStatement : [select A.*, B.DICTIONARY_NAME, B.DICTIONARY_CODE, B.DICTIONARY_NAME_EN CHUCDANH, (B.DICTIONARY_NAME_EN + '. ' + A.TENNHANVIEN) TENHOCVIHOCHAM            from TM_NHANVIEN A            left join (select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE = 'chucdanh' and DICTIONARY_NAME_EN is not null) B on A.CHUCDANH_ID = B.DICTIONARY_ID            where A.BENHVIEN_ID = '' and A.TAMNGUNG = '0']
2019-10-29 17:06:28,083 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '26239'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2019-10-29 17:06:40,282 [1] DEBUG - Statement Id: [DAO00037_GetCLSKetQua] PreparedStatement : [select *              from TT_CLSKETQUA               where                             TT_CLSKETQUA.DVYEUCAU_ID = '205346'                       and                           TT_CLSKETQUA.BENHVIEN_ID = 'HLU01'                                     order by CLSKETQUA_ID]
2019-10-29 17:06:41,269 [1] DEBUG - Statement Id: [DAO00020_GetDetailP] PreparedStatement : [select *        from TT_DVYEUCAU        where TT_DVYEUCAU.DVYEUCAU_ID  = 205346        order by DVYEUCAU_ID]
2019-10-29 17:06:45,993 [1] DEBUG - Statement Id: [DAO00017_GetNameByID] PreparedStatement : [select TENPHONGBAN              from [TM_PHONGBAN]              where PHONGBAN_ID = '18' and BENHVIEN_ID = 'HLU01']
2019-10-29 17:06:46,077 [1] DEBUG - Statement Id: [DAO00041_GetNameByID] PreparedStatement : [select TENDICHVU              from TM_DICHVU              where DICHVU_ID = '4144']
2019-10-29 17:06:46,634 [1] DEBUG - Statement Id: [DAO00038_GetList] PreparedStatement : [select *              from TT_CLSKETQUA_IMAGES               where                             TT_CLSKETQUA_IMAGES.CLSKETQUA_ID = '96455'                       and                           TT_CLSKETQUA_IMAGES.BENHVIEN_ID = 'HLU01'                                     order by IDX]
2019-10-29 17:06:46,669 [1] DEBUG - Statement Id: [DAO00222_GetList] PreparedStatement : [select *        from TT_CLSKETQUA_DOCUMENTS         where                 CLSKETQUA_ID = '96455'                     order by CLSKETQUA_DOCUMENTS_ID]
2019-10-29 17:06:46,695 [1] DEBUG - Statement Id: [DAO00116_File_GetList] PreparedStatement : [select *              from TT_FILE_DINHKEM               where                             TT_FILE_DINHKEM.REF_TABLE = 'TT_CLSKETQUA'                       and                           TT_FILE_DINHKEM.REF_ID = '96455'                       and                           TT_FILE_DINHKEM.BENHVIEN_ID = 'HLU01'                                     order by FILE_ID]
2019-10-29 17:06:46,771 [1] DEBUG - Statement Id: [DAO00087_GetServiceParams] PreparedStatement : [select CODE, VALUE              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01']
2019-10-29 17:06:48,030 [1] DEBUG - Statement Id: [DAO00042_GetList] PreparedStatement : [select *              from TM_TUDIENKETQUA              where BENHVIEN_ID = 'HLU01'                and                       TM_TUDIENKETQUA.DICHVU_ID = '4144'                    and                       (TM_TUDIENKETQUA.NGUOITAO_ID = '1' OR TM_TUDIENKETQUA.SUDUNGCHUNG = '1')                                 order by TM_TUDIENKETQUA.TENNOIDUNG]
2019-10-29 17:06:48,062 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '26239'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2019-10-29 17:06:51,222 [1] DEBUG - Statement Id: [DAO00037_GetCLSKetQua] PreparedStatement : [select *              from TT_CLSKETQUA               where                             TT_CLSKETQUA.DVYEUCAU_ID = '205346'                       and                           TT_CLSKETQUA.BENHVIEN_ID = 'HLU01'                                     order by CLSKETQUA_ID]
2019-10-29 17:06:51,327 [1] DEBUG - Statement Id: [DAO00020_GetDetailP] PreparedStatement : [select *        from TT_DVYEUCAU        where TT_DVYEUCAU.DVYEUCAU_ID  = 205346        order by DVYEUCAU_ID]
2019-10-29 17:06:51,429 [1] DEBUG - Statement Id: [DAO00017_GetNameByID] PreparedStatement : [select TENPHONGBAN              from [TM_PHONGBAN]              where PHONGBAN_ID = '18' and BENHVIEN_ID = 'HLU01']
2019-10-29 17:06:51,556 [1] DEBUG - Statement Id: [DAO00041_GetNameByID] PreparedStatement : [select TENDICHVU              from TM_DICHVU              where DICHVU_ID = '4144']
2019-10-29 17:06:51,660 [1] DEBUG - Statement Id: [DAO00038_GetList] PreparedStatement : [select *              from TT_CLSKETQUA_IMAGES               where                             TT_CLSKETQUA_IMAGES.CLSKETQUA_ID = '96455'                       and                           TT_CLSKETQUA_IMAGES.BENHVIEN_ID = 'HLU01'                                     order by IDX]
2019-10-29 17:06:51,695 [1] DEBUG - Statement Id: [DAO00222_GetList] PreparedStatement : [select *        from TT_CLSKETQUA_DOCUMENTS         where                 CLSKETQUA_ID = '96455'                     order by CLSKETQUA_DOCUMENTS_ID]
2019-10-29 17:06:51,723 [1] DEBUG - Statement Id: [DAO00116_File_GetList] PreparedStatement : [select *              from TT_FILE_DINHKEM               where                             TT_FILE_DINHKEM.REF_TABLE = 'TT_CLSKETQUA'                       and                           TT_FILE_DINHKEM.REF_ID = '96455'                       and                           TT_FILE_DINHKEM.BENHVIEN_ID = 'HLU01'                                     order by FILE_ID]
2019-10-29 17:06:51,760 [1] DEBUG - Statement Id: [DAO00042_GetList] PreparedStatement : [select *              from TM_TUDIENKETQUA              where BENHVIEN_ID = 'HLU01'                and                       TM_TUDIENKETQUA.DICHVU_ID = '4144'                    and                       (TM_TUDIENKETQUA.NGUOITAO_ID = '1' OR TM_TUDIENKETQUA.SUDUNGCHUNG = '1')                                 order by TM_TUDIENKETQUA.TENNOIDUNG]
2019-10-29 17:06:51,793 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '26239'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2019-10-29 17:06:54,328 [1] DEBUG - Statement Id: [DAO00116_GetListThietBiCLS] PreparedStatement : [SELECT THIETBI_ID, MATHIETBI, TENTHIETBI, NHOMTHIETBI_ID          FROM TM_THIETBI MP          where          TAMNGUNG = '0'          and BENHVIEN_ID = 'HLU01'           AND             PHONGBAN_ID = 79                     order by TENTHIETBI]
--------------------------------------------------------------------------------
2019-10-29 17:07:37,699 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2019-10-29 17:07:37,969 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-10-29 17:07:38,012 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-10-29 17:07:38,376 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 17:07:38,608 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-10-29 17:07:43,644 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2019-10-29 17:07:43,699 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-10-29 17:07:45,323 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-10-29 17:07:45,413 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-10-29 17:07:46,266 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2019-10-29 17:07:46,448 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2019-10-29 17:07:46,522 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2019-10-29 17:07:46,628 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2019-10-29 17:07:46,713 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2019-10-29 17:07:46,819 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2019-10-29 17:07:46,914 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2019-10-29 17:07:46,987 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2019-10-29 17:07:47,061 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2019-10-29 17:07:47,568 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2019-10-29 17:07:47,605 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2019-10-29 17:07:47,673 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2019-10-29 17:07:47,710 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2019-10-29 17:07:49,523 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2019-10-29 17:07:49,583 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @NGUONDUOC_MACDINH varchar(5) = '0';        declare @TOAMUANGOAI int = 0;        select @NGUONDUOC_MACDINH = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'PHA_NGUONDUOC'        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + @NGUONDUOC_MACDINH as DUOC_KEY, 0 as PHAMVI_ID, @NGUONDUOC_MACDINH as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end        else        begin                  select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2019-10-29 17:07:54,978 [5] DEBUG - Statement Id: [DAO00320_GetList] PreparedStatement : [select M.*            from TM_MAU M            LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID            where            M.TAMNGUNG = '0'            and M.BENHVIEN_ID = 'HLU01'            order by M.TENMAU]
2019-10-29 17:07:55,145 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2019-10-29 17:07:55,180 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,        SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH        FROM TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID        WHERE TK.SOLUONG > 0        GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2019-10-29 17:07:55,255 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2019-10-29 17:07:55,287 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,        TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,        TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH        from TM_MAU M        JOIN        (        select        A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO        from        (        select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO        from TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'        where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0        ) A        )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2019-10-29 17:07:55,356 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2019-10-29 17:07:56,340 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 17:07:57,190 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2019-10-29 17:08:02,089 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2019-10-29 17:08:02,171 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2019-10-29 17:08:02,249 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 17:08:02,367 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 17:08:02,507 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2019-10-29 17:08:02,509 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-10-29 17:08:02,509 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-10-29 17:08:02,538 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2019-10-29 17:08:02,538 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-10-29 17:08:02,538 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-10-29 17:08:02,675 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 17:08:02,849 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 17:08:10,233 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 17:08:10,321 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2019-10-29 17:08:10,599 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2019-10-29 17:08:17,717 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS03'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 17:08:21,921 [1] DEBUG - Statement Id: [DAO00006_GetDSNhomDichVu] PreparedStatement : [select * from TM_NHOMDICHVU              where captren_id =              (select top (1) NHOMDICHVU_ID from TM_NHOMDICHVU where MANHOMDICHVU = '02')              and BENHVIEN_ID = 'HLU01']
2019-10-29 17:08:22,058 [1] DEBUG - Statement Id: [DAO00006_GetDSNhomDichVu] PreparedStatement : [select * from TM_NHOMDICHVU              where captren_id =              (select top (1) NHOMDICHVU_ID from TM_NHOMDICHVU where MANHOMDICHVU = '03')              and BENHVIEN_ID = 'HLU01']
2019-10-29 17:08:22,515 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 17:08:22,671 [1] DEBUG - Statement Id: [DAO00019_DanhSachCDHA] PreparedStatement : [declare @TenBenhVien nvarchar(500)        declare @ManhomDSA varchar(10);        set @TenBenhVien = (select VALUE from TM_SYS_APPSETTINGS where CODE = 'APP_BENHVIEN_TEN')        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        select * from(        select ROW_NUMBER() OVER(order by NGAYGIOYEUCAU) as ROWNUMBER, *        from        (SELECT distinct        COUNT(*) OVER() as TOTALROWS,        N'Mã người bệnh: ' + bn.MAYTE + ' - ' + N'Tên người bệnh: ' + bn.TENBENHNHAN + ' - ' + N'Số bệnh án: ' + ISNULL(BA.SOBENHAN,'') + ' - ' + N'Sinh ngày: ' + isnull(Convert(varchar(10),bn.NGAYSINH,103),bn.NAMSINH) + ' - ' + N'Giới tính: ' + GD.DESCRIPTION as GROUPNAME,        bn.MAYTE, bn.TENBENHNHAN, bn.NAMSINH, bn.NGAYSINH as TUOI, ISNULL(CONVERT(VARCHAR(10), bn.NGAYSINH, 103),CAST(bn.NAMSINH AS varchar)) as NGAYSINH, bn.DIACHILIENLAC as DIACHI, bn.GIOITINH, GD.DESCRIPTION as TENGIOITINH,        tn.DOITUONG_ID, tn.THOIGIANTIEPNHAN, tn.BENHNHAN_ID, tn.TIEPNHAN_ID, tn.TRAITUYEN, tn.SOTIEPNHAN,        dv.DICHVU_ID, dv.NOITHUCHIEN_ID, isnull(dv.NGAYTAO, dv.NGAYCAPNHAT) as THOIGIANDKDICHVU,        dv.KHAN, dv.NOIYEUCAU_ID, dv.NGAYGIOYEUCAU, dv.BACSICHIDINH_ID, dv.DONVIGIOITHIEU_ID, dv.NGUOIGIOITHIEU_ID, dv.TRANGTHAI_WFL,        tn.NOIGIOITHIEU_ID, kbnt.HUONGGIAIQUYET_ID,        dv.DVYEUCAU_ID, dv.MARIS, dv.TRANGTHAI as TRANGTHAICODE, B.TENNHOMDICHVU, dv.SOPHIEUYEUCAU, dv.KHAMBENH_NGOAITRU_ID, dv.NGUOICAPNHAT_ID, dv.NGAYCAPNHAT,        CASE        WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU        WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2) END AS MANHOMDICHVU, B.MANHOMDICHVU as MANHOMDICHVUCHITIET, tn.TRANGTHAI as TRANGTHAI_TIEPNHAN,        'False' as DAKHAM,        vp.DATHANHTOAN, vp.DONGIA_DOANHTHU, BA.SOBENHAN, dv.CHANDOAN        , a.TENDICHVU, nth.TENPHONGBAN as TENPHONGKHAM, nyc.TENPHONGBAN as TENKHOACHIDINH        , case when (dv.DONVIGIOITHIEU_ID is not null and dv.DONVIGIOITHIEU_ID != '') then ngt.TENBENHVIEN else @TenBenhVien end as TENBENHVIENCHIDINH        , case when (dv.BACSICHIDINH_ID is not null and dv.BACSICHIDINH_ID != '') then bscd.TENNHANVIEN else ngtt.TENNHANVIEN end as TENBACSICHIDINH          ,             0 as GUINGOAI, 0 as VTYT, 0 as CLSKETQUA_ID                   FROM TT_DVYEUCAU (NOLOCK) dv        inner join TT_TIEPNHAN (NOLOCK) tn on dv.TIEPNHAN_ID = tn.TIEPNHAN_ID        inner join TT_BENHNHAN (NOLOCK) bn on tn.BENHNHAN_ID = bn.BENHNHAN_ID        inner join TM_DICHVU A on A.DICHVU_ID = dv.DICHVU_ID        inner join TM_PHONGBAN nth on nth.PHONGBAN_ID = dv.NOITHUCHIEN_ID        left join TM_BENHVIEN ngt on ngt.BENHVIEN_STT_ID = dv.DONVIGIOITHIEU_ID        left join TM_NHANVIEN bscd on bscd.NHANVIEN_ID = dv.BACSICHIDINH_ID        left join TM_NHANVIEN ngtt on ngtt.NHANVIEN_ID = dv.NGUOIGIOITHIEU_ID        inner join TM_PHONGBAN nyc on nyc.PHONGBAN_ID = dv.NOIYEUCAU_ID        inner join TM_NHOMDICHVU B on B.NHOMDICHVU_ID = A.NHOMDICHVU_ID        inner join TT_VIENPHI (NOLOCK) VP on VP.TIEPNHAN_ID = tn.TIEPNHAN_ID and VP.DICHVU_ID = dv.DICHVU_ID and VP.REF_ID = dv.DVYEUCAU_ID        left join TT_NOITRU_BENHAN (NOLOCK) BA on BA.TIEPNHAN_ID = tn.TIEPNHAN_ID AND dv.BENHAN_ID = BA.BENHAN_ID        inner join TM_GENDER GD on GD.ID = bn.GIOITINH        left join TT_NGOAITRU_KHAMBENH (NOLOCK) kbnt on kbnt.KHAMBENH_ID = dv.KHAMBENH_NGOAITRU_ID                 where        dv.DICHVU_ID IS NOT NULL        and tn.BENHVIEN_ID = 'HLU01'        and HUYYEUCAU = 0        and dv.NGAYHENCLS is NULL                       and dv.TRANGTHAI = 'CHUAKETQUA'           and           dv.NGAYYEUCAU >= '10/29/2019 12:00:00 AM'         and           dv.NGAYYEUCAU <= '10/29/2019 12:00:00 AM'         and           dv.NOITHUCHIEN_ID = 79         and           (vp.DATHANHTOAN = '1'  or vp.DONGIA_DOANHTHU = '0' OR TN.SUDUNG_BHTN='1' OR TN.BAOLANH_VIENPHI='1'  OR tn.TRANGTHAI IN ('NOITRU','CAPCUU','NGOAITRU') or dv.HOPDONG_BENHNHAN_ID is not null or vp.BENHNHAN_PHAITHANHTOAN >= 0)         and           (CASE          WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU          WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2) END) in (02)         and           tn.TRANGTHAI IN ('DATIEPNHAN','NOITRU','CAPCUU','NGOAITRU', 'HOANTHANH')                 ) data1) lst                    where          lst.ROWNUMBER between 1 and 5                 order by NGAYGIOYEUCAU asc]
2019-10-29 17:08:23,450 [1] DEBUG - Statement Id: [DAO00019_DanhSachCDHA] PreparedStatement : [declare @TenBenhVien nvarchar(500)        declare @ManhomDSA varchar(10);        set @TenBenhVien = (select VALUE from TM_SYS_APPSETTINGS where CODE = 'APP_BENHVIEN_TEN')        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        select * from(        select ROW_NUMBER() OVER(order by NGAYGIOYEUCAU) as ROWNUMBER, *        from        (SELECT distinct        COUNT(*) OVER() as TOTALROWS,        N'Mã người bệnh: ' + bn.MAYTE + ' - ' + N'Tên người bệnh: ' + bn.TENBENHNHAN + ' - ' + N'Số bệnh án: ' + ISNULL(BA.SOBENHAN,'') + ' - ' + N'Sinh ngày: ' + isnull(Convert(varchar(10),bn.NGAYSINH,103),bn.NAMSINH) + ' - ' + N'Giới tính: ' + GD.DESCRIPTION as GROUPNAME,        bn.MAYTE, bn.TENBENHNHAN, bn.NAMSINH, bn.NGAYSINH as TUOI, ISNULL(CONVERT(VARCHAR(10), bn.NGAYSINH, 103),CAST(bn.NAMSINH AS varchar)) as NGAYSINH, bn.DIACHILIENLAC as DIACHI, bn.GIOITINH, GD.DESCRIPTION as TENGIOITINH,        tn.DOITUONG_ID, tn.THOIGIANTIEPNHAN, tn.BENHNHAN_ID, tn.TIEPNHAN_ID, tn.TRAITUYEN, tn.SOTIEPNHAN,        dv.DICHVU_ID, dv.NOITHUCHIEN_ID, isnull(dv.NGAYTAO, dv.NGAYCAPNHAT) as THOIGIANDKDICHVU,        dv.KHAN, dv.NOIYEUCAU_ID, dv.NGAYGIOYEUCAU, dv.BACSICHIDINH_ID, dv.DONVIGIOITHIEU_ID, dv.NGUOIGIOITHIEU_ID, dv.TRANGTHAI_WFL,        tn.NOIGIOITHIEU_ID, kbnt.HUONGGIAIQUYET_ID,        dv.DVYEUCAU_ID, dv.MARIS, dv.TRANGTHAI as TRANGTHAICODE, B.TENNHOMDICHVU, dv.SOPHIEUYEUCAU, dv.KHAMBENH_NGOAITRU_ID, dv.NGUOICAPNHAT_ID, dv.NGAYCAPNHAT,        CASE        WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU        WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2) END AS MANHOMDICHVU, B.MANHOMDICHVU as MANHOMDICHVUCHITIET, tn.TRANGTHAI as TRANGTHAI_TIEPNHAN,        'False' as DAKHAM,        vp.DATHANHTOAN, vp.DONGIA_DOANHTHU, BA.SOBENHAN, dv.CHANDOAN        , a.TENDICHVU, nth.TENPHONGBAN as TENPHONGKHAM, nyc.TENPHONGBAN as TENKHOACHIDINH        , case when (dv.DONVIGIOITHIEU_ID is not null and dv.DONVIGIOITHIEU_ID != '') then ngt.TENBENHVIEN else @TenBenhVien end as TENBENHVIENCHIDINH        , case when (dv.BACSICHIDINH_ID is not null and dv.BACSICHIDINH_ID != '') then bscd.TENNHANVIEN else ngtt.TENNHANVIEN end as TENBACSICHIDINH          ,             0 as GUINGOAI, 0 as VTYT, 0 as CLSKETQUA_ID                   FROM TT_DVYEUCAU (NOLOCK) dv        inner join TT_TIEPNHAN (NOLOCK) tn on dv.TIEPNHAN_ID = tn.TIEPNHAN_ID        inner join TT_BENHNHAN (NOLOCK) bn on tn.BENHNHAN_ID = bn.BENHNHAN_ID        inner join TM_DICHVU A on A.DICHVU_ID = dv.DICHVU_ID        inner join TM_PHONGBAN nth on nth.PHONGBAN_ID = dv.NOITHUCHIEN_ID        left join TM_BENHVIEN ngt on ngt.BENHVIEN_STT_ID = dv.DONVIGIOITHIEU_ID        left join TM_NHANVIEN bscd on bscd.NHANVIEN_ID = dv.BACSICHIDINH_ID        left join TM_NHANVIEN ngtt on ngtt.NHANVIEN_ID = dv.NGUOIGIOITHIEU_ID        inner join TM_PHONGBAN nyc on nyc.PHONGBAN_ID = dv.NOIYEUCAU_ID        inner join TM_NHOMDICHVU B on B.NHOMDICHVU_ID = A.NHOMDICHVU_ID        inner join TT_VIENPHI (NOLOCK) VP on VP.TIEPNHAN_ID = tn.TIEPNHAN_ID and VP.DICHVU_ID = dv.DICHVU_ID and VP.REF_ID = dv.DVYEUCAU_ID        left join TT_NOITRU_BENHAN (NOLOCK) BA on BA.TIEPNHAN_ID = tn.TIEPNHAN_ID AND dv.BENHAN_ID = BA.BENHAN_ID        inner join TM_GENDER GD on GD.ID = bn.GIOITINH        left join TT_NGOAITRU_KHAMBENH (NOLOCK) kbnt on kbnt.KHAMBENH_ID = dv.KHAMBENH_NGOAITRU_ID                 where        dv.DICHVU_ID IS NOT NULL        and tn.BENHVIEN_ID = 'HLU01'        and HUYYEUCAU = 0        and dv.NGAYHENCLS is NULL                       and dv.TRANGTHAI = 'CHUAKETQUA'           and           dv.NGAYYEUCAU >= '10/29/2019 12:00:00 AM'         and           dv.NGAYYEUCAU <= '10/29/2019 12:00:00 AM'         and           dv.NOITHUCHIEN_ID = 79         and           (vp.DATHANHTOAN = '1'  or vp.DONGIA_DOANHTHU = '0' OR TN.SUDUNG_BHTN='1' OR TN.BAOLANH_VIENPHI='1'  OR tn.TRANGTHAI IN ('NOITRU','CAPCUU','NGOAITRU') or dv.HOPDONG_BENHNHAN_ID is not null or vp.BENHNHAN_PHAITHANHTOAN >= 0)         and           (CASE          WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU          WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2) END) in (02)         and           tn.TRANGTHAI IN ('DATIEPNHAN','NOITRU','CAPCUU','NGOAITRU', 'HOANTHANH')                 ) data1) lst                    where          lst.ROWNUMBER between 1 and 5                 order by NGAYGIOYEUCAU asc]
2019-10-29 17:08:37,139 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS31'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 17:08:37,784 [1] DEBUG - Statement Id: [DAO00019_DanhSachCDHA] PreparedStatement : [declare @TenBenhVien nvarchar(500)        declare @ManhomDSA varchar(10);        set @TenBenhVien = (select VALUE from TM_SYS_APPSETTINGS where CODE = 'APP_BENHVIEN_TEN')        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        select * from(        select ROW_NUMBER() OVER(order by NGAYGIOYEUCAU) as ROWNUMBER, *        from        (SELECT distinct        COUNT(*) OVER() as TOTALROWS,        N'Mã người bệnh: ' + bn.MAYTE + ' - ' + N'Tên người bệnh: ' + bn.TENBENHNHAN + ' - ' + N'Số bệnh án: ' + ISNULL(BA.SOBENHAN,'') + ' - ' + N'Sinh ngày: ' + isnull(Convert(varchar(10),bn.NGAYSINH,103),bn.NAMSINH) + ' - ' + N'Giới tính: ' + GD.DESCRIPTION as GROUPNAME,        bn.MAYTE, bn.TENBENHNHAN, bn.NAMSINH, bn.NGAYSINH as TUOI, ISNULL(CONVERT(VARCHAR(10), bn.NGAYSINH, 103),CAST(bn.NAMSINH AS varchar)) as NGAYSINH, bn.DIACHILIENLAC as DIACHI, bn.GIOITINH, GD.DESCRIPTION as TENGIOITINH,        tn.DOITUONG_ID, tn.THOIGIANTIEPNHAN, tn.BENHNHAN_ID, tn.TIEPNHAN_ID, tn.TRAITUYEN, tn.SOTIEPNHAN,        dv.DICHVU_ID, dv.NOITHUCHIEN_ID, isnull(dv.NGAYTAO, dv.NGAYCAPNHAT) as THOIGIANDKDICHVU,        dv.KHAN, dv.NOIYEUCAU_ID, dv.NGAYGIOYEUCAU, dv.BACSICHIDINH_ID, dv.DONVIGIOITHIEU_ID, dv.NGUOIGIOITHIEU_ID, dv.TRANGTHAI_WFL,        tn.NOIGIOITHIEU_ID, kbnt.HUONGGIAIQUYET_ID,        dv.DVYEUCAU_ID, dv.MARIS, dv.TRANGTHAI as TRANGTHAICODE, B.TENNHOMDICHVU, dv.SOPHIEUYEUCAU, dv.KHAMBENH_NGOAITRU_ID, dv.NGUOICAPNHAT_ID, dv.NGAYCAPNHAT,        CASE        WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU        WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2) END AS MANHOMDICHVU, B.MANHOMDICHVU as MANHOMDICHVUCHITIET, tn.TRANGTHAI as TRANGTHAI_TIEPNHAN,        'True' as DAKHAM,        vp.DATHANHTOAN, vp.DONGIA_DOANHTHU, BA.SOBENHAN, dv.CHANDOAN        , a.TENDICHVU, nth.TENPHONGBAN as TENPHONGKHAM, nyc.TENPHONGBAN as TENKHOACHIDINH        , case when (dv.DONVIGIOITHIEU_ID is not null and dv.DONVIGIOITHIEU_ID != '') then ngt.TENBENHVIEN else @TenBenhVien end as TENBENHVIENCHIDINH        , case when (dv.BACSICHIDINH_ID is not null and dv.BACSICHIDINH_ID != '') then bscd.TENNHANVIEN else ngtt.TENNHANVIEN end as TENBACSICHIDINH          ,             cls.CLSKETQUA_ID, cls.NGAYGIOTHUCHIEN , cls.THOIGIANKHOADULIEU, cls.NGUOIKHOA_ID, cls_vtyt.CLSKETQUA_ID as VTYT            , cls.GUINGOAI, cls.NOIGUIDEN_ID, dv.TENNGUOIKHOA                   FROM TT_DVYEUCAU (NOLOCK) dv        inner join TT_TIEPNHAN (NOLOCK) tn on dv.TIEPNHAN_ID = tn.TIEPNHAN_ID        inner join TT_BENHNHAN (NOLOCK) bn on tn.BENHNHAN_ID = bn.BENHNHAN_ID        inner join TM_DICHVU A on A.DICHVU_ID = dv.DICHVU_ID        inner join TM_PHONGBAN nth on nth.PHONGBAN_ID = dv.NOITHUCHIEN_ID        left join TM_BENHVIEN ngt on ngt.BENHVIEN_STT_ID = dv.DONVIGIOITHIEU_ID        left join TM_NHANVIEN bscd on bscd.NHANVIEN_ID = dv.BACSICHIDINH_ID        left join TM_NHANVIEN ngtt on ngtt.NHANVIEN_ID = dv.NGUOIGIOITHIEU_ID        inner join TM_PHONGBAN nyc on nyc.PHONGBAN_ID = dv.NOIYEUCAU_ID        inner join TM_NHOMDICHVU B on B.NHOMDICHVU_ID = A.NHOMDICHVU_ID        inner join TT_VIENPHI (NOLOCK) VP on VP.TIEPNHAN_ID = tn.TIEPNHAN_ID and VP.DICHVU_ID = dv.DICHVU_ID and VP.REF_ID = dv.DVYEUCAU_ID        left join TT_NOITRU_BENHAN (NOLOCK) BA on BA.TIEPNHAN_ID = tn.TIEPNHAN_ID AND dv.BENHAN_ID = BA.BENHAN_ID        inner join TM_GENDER GD on GD.ID = bn.GIOITINH        left join TT_NGOAITRU_KHAMBENH (NOLOCK) kbnt on kbnt.KHAMBENH_ID = dv.KHAMBENH_NGOAITRU_ID                       left join TT_CLSKETQUA (NOLOCK) cls on dv.DVYEUCAU_ID = cls.DVYEUCAU_ID            left join TT_CLSKETQUA_VTYT (NOLOCK) cls_vtyt on cls_vtyt.DVYEUCAU_ID = dv.DVYEUCAU_ID                   where        dv.DICHVU_ID IS NOT NULL        and tn.BENHVIEN_ID = 'HLU01'        and HUYYEUCAU = 0        and dv.NGAYHENCLS is NULL                       and dv.TRANGTHAI IN ('CHOXACNHAN','HOANTAT')           and           dv.NGAYYEUCAU >= '6/1/2019 12:00:00 AM'         and           dv.NGAYYEUCAU <= '10/29/2019 12:00:00 AM'         and           dv.NOITHUCHIEN_ID = 79         and           (vp.DATHANHTOAN = '1'  or vp.DONGIA_DOANHTHU = '0' OR TN.SUDUNG_BHTN='1' OR TN.BAOLANH_VIENPHI='1'  OR tn.TRANGTHAI IN ('NOITRU','CAPCUU','NGOAITRU') or dv.HOPDONG_BENHNHAN_ID is not null or vp.BENHNHAN_PHAITHANHTOAN >= 0)         and           (bn.TENBENHNHAN like '%' +  @param0  + '%' or bn.MAYTE like '%' +  @param0  + '%')         and           (CASE          WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU          WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2) END) in (02)                 ) data1) lst                    where          lst.ROWNUMBER between 1 and 5                 order by NGAYGIOYEUCAU asc]
2019-10-29 17:08:37,784 [1] DEBUG - Statement Id: [DAO00019_DanhSachCDHA] Parameters: [@param0=[TENBENHNHAN,Côi]]
2019-10-29 17:08:37,784 [1] DEBUG - Statement Id: [DAO00019_DanhSachCDHA] Types: [@param0=[String, System.String]]
2019-10-29 17:08:38,058 [1] DEBUG - Statement Id: [DAO00000_GetNhomDoiTuong] PreparedStatement : [SELECT DOITUONG_ID              ,[TENDOITUONG]              ,[NHOMDICHVU]              ,[TYLE_VUOT_LCB]              ,[GIOIHAN_VUOT_LCB]              ,[GIOIHAN_VUOT_DVKTC]              ,[TYLE_THUOC_UT]              ,[CPVC]              ,[CHIPHINGOAI_BHYT]              ,[NGANSACH_TL]              ,[MIENGIAM_TL]              ,[TAITRO_TL]              ,[BHTN_TL]              FROM [dbo].[TM_DOITUONG]]
2019-10-29 17:08:39,608 [1] DEBUG - Statement Id: [DAO00019_ThongTinBenhNhanDvYeuCau] PreparedStatement : [select distinct A.SOTIEPNHAN, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI, A.NGAYMIENDONGCHITRA,        B.*,  C.DICHVU_ID, C.DVYEUCAU_ID, C.NOITHUCHIEN_ID, A.SOBHYT        from TT_TIEPNHAN A        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'        where                    C.DVYEUCAU_ID = '205346'                 and A.BENHVIEN_ID = 'HLU01']
2019-10-29 17:08:40,008 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '26239'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2019-10-29 17:08:40,107 [1] DEBUG - Statement Id: [DAO00046_GETLISTDVYEUCAUINLISTDVID] PreparedStatement : [SELECT dvyc.*, clskqct.CLSKETQUA_ID, clskqct.DICHVU_ID as KETQUA_DICHVU_ID,        clskqct.CLSKETQUACHITIET_ID, clskqct.DONVITINH, clskqct.KETQUA, clskqct.KETQUA2,        clskqct.MUCBINHTHUONG, clskqct.MUCBINHTHUONGMIN, clskqct.MUCBINHTHUONGMAX, clskqct.BATTHUONG        FROM dbo.TT_CLSKETQUACHITIET as clskqct RIGHT OUTER JOIN        dbo.TT_DVYEUCAU as dvyc ON                 clskqct.DVYEUCAU_ID = dvyc.DVYEUCAU_ID        where dvyc.BENHVIEN_ID = 'HLU01'          and             exists (select DICHVU_ID from TM_DICHVU a join TM_NHOMDICHVU b on a.NHOMDICHVU_ID = b.NHOMDICHVU_ID            where dvyc.DICHVU_ID = DICHVU_ID and (left(MANHOMDICHVU,2) in ('02', '03') OR MANHOMDICHVU in ('02', '03')))           and             dvyc.TIEPNHAN_ID =  @param0                    order by DVYEUCAU_ID]
2019-10-29 17:08:40,107 [1] DEBUG - Statement Id: [DAO00046_GETLISTDVYEUCAUINLISTDVID] Parameters: [@param0=[TIEPNHAN_ID,26239]]
2019-10-29 17:08:40,107 [1] DEBUG - Statement Id: [DAO00046_GETLISTDVYEUCAUINLISTDVID] Types: [@param0=[Int64, System.Int64]]
2019-10-29 17:08:40,143 [1] DEBUG - Statement Id: [DAO00045_GetListDVYeuCau] PreparedStatement : [select *              from VIEW_DICHVU_NHOMDV              where BENHVIEN_ID = 'HLU01']
2019-10-29 17:08:40,667 [1] DEBUG - Statement Id: [DAO00018_GetList] PreparedStatement : [select A.*, B.DICTIONARY_NAME, B.DICTIONARY_CODE, B.DICTIONARY_NAME_EN CHUCDANH, (B.DICTIONARY_NAME_EN + '. ' + A.TENNHANVIEN) TENHOCVIHOCHAM            from TM_NHANVIEN A            left join (select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE = 'chucdanh' and DICTIONARY_NAME_EN is not null) B on A.CHUCDANH_ID = B.DICTIONARY_ID            where A.BENHVIEN_ID = '' and A.TAMNGUNG = '0']
2019-10-29 17:08:40,711 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '26239'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2019-10-29 17:08:47,681 [1] DEBUG - Statement Id: [DAO00037_GetCLSKetQua] PreparedStatement : [select *              from TT_CLSKETQUA               where                             TT_CLSKETQUA.DVYEUCAU_ID = '205346'                       and                           TT_CLSKETQUA.BENHVIEN_ID = 'HLU01'                                     order by CLSKETQUA_ID]
2019-10-29 17:08:47,774 [1] DEBUG - Statement Id: [DAO00020_GetDetailP] PreparedStatement : [select *        from TT_DVYEUCAU        where TT_DVYEUCAU.DVYEUCAU_ID  = 205346        order by DVYEUCAU_ID]
2019-10-29 17:08:47,858 [1] DEBUG - Statement Id: [DAO00017_GetNameByID] PreparedStatement : [select TENPHONGBAN              from [TM_PHONGBAN]              where PHONGBAN_ID = '18' and BENHVIEN_ID = 'HLU01']
2019-10-29 17:08:47,944 [1] DEBUG - Statement Id: [DAO00041_GetNameByID] PreparedStatement : [select TENDICHVU              from TM_DICHVU              where DICHVU_ID = '4144']
2019-10-29 17:08:48,573 [1] DEBUG - Statement Id: [DAO00038_GetList] PreparedStatement : [select *              from TT_CLSKETQUA_IMAGES               where                             TT_CLSKETQUA_IMAGES.CLSKETQUA_ID = '96455'                       and                           TT_CLSKETQUA_IMAGES.BENHVIEN_ID = 'HLU01'                                     order by IDX]
2019-10-29 17:08:48,610 [1] DEBUG - Statement Id: [DAO00222_GetList] PreparedStatement : [select *        from TT_CLSKETQUA_DOCUMENTS         where                 CLSKETQUA_ID = '96455'                     order by CLSKETQUA_DOCUMENTS_ID]
2019-10-29 17:08:48,636 [1] DEBUG - Statement Id: [DAO00116_File_GetList] PreparedStatement : [select *              from TT_FILE_DINHKEM               where                             TT_FILE_DINHKEM.REF_TABLE = 'TT_CLSKETQUA'                       and                           TT_FILE_DINHKEM.REF_ID = '96455'                       and                           TT_FILE_DINHKEM.BENHVIEN_ID = 'HLU01'                                     order by FILE_ID]
2019-10-29 17:08:48,710 [1] DEBUG - Statement Id: [DAO00087_GetServiceParams] PreparedStatement : [select CODE, VALUE              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01']
2019-10-29 17:08:48,757 [1] DEBUG - Statement Id: [DAO00042_GetList] PreparedStatement : [select *              from TM_TUDIENKETQUA              where BENHVIEN_ID = 'HLU01'                and                       TM_TUDIENKETQUA.DICHVU_ID = '4144'                    and                       (TM_TUDIENKETQUA.NGUOITAO_ID = '1' OR TM_TUDIENKETQUA.SUDUNGCHUNG = '1')                                 order by TM_TUDIENKETQUA.TENNOIDUNG]
2019-10-29 17:08:48,809 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '26239'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2019-10-29 17:08:50,040 [1] DEBUG - Statement Id: [DAO00037_GetCLSKetQua] PreparedStatement : [select *              from TT_CLSKETQUA               where                             TT_CLSKETQUA.DVYEUCAU_ID = '205346'                       and                           TT_CLSKETQUA.BENHVIEN_ID = 'HLU01'                                     order by CLSKETQUA_ID]
2019-10-29 17:08:50,149 [1] DEBUG - Statement Id: [DAO00020_GetDetailP] PreparedStatement : [select *        from TT_DVYEUCAU        where TT_DVYEUCAU.DVYEUCAU_ID  = 205346        order by DVYEUCAU_ID]
2019-10-29 17:08:50,253 [1] DEBUG - Statement Id: [DAO00017_GetNameByID] PreparedStatement : [select TENPHONGBAN              from [TM_PHONGBAN]              where PHONGBAN_ID = '18' and BENHVIEN_ID = 'HLU01']
2019-10-29 17:08:50,364 [1] DEBUG - Statement Id: [DAO00041_GetNameByID] PreparedStatement : [select TENDICHVU              from TM_DICHVU              where DICHVU_ID = '4144']
2019-10-29 17:08:51,461 [1] DEBUG - Statement Id: [DAO00038_GetList] PreparedStatement : [select *              from TT_CLSKETQUA_IMAGES               where                             TT_CLSKETQUA_IMAGES.CLSKETQUA_ID = '96455'                       and                           TT_CLSKETQUA_IMAGES.BENHVIEN_ID = 'HLU01'                                     order by IDX]
2019-10-29 17:08:51,495 [1] DEBUG - Statement Id: [DAO00222_GetList] PreparedStatement : [select *        from TT_CLSKETQUA_DOCUMENTS         where                 CLSKETQUA_ID = '96455'                     order by CLSKETQUA_DOCUMENTS_ID]
2019-10-29 17:08:51,525 [1] DEBUG - Statement Id: [DAO00116_File_GetList] PreparedStatement : [select *              from TT_FILE_DINHKEM               where                             TT_FILE_DINHKEM.REF_TABLE = 'TT_CLSKETQUA'                       and                           TT_FILE_DINHKEM.REF_ID = '96455'                       and                           TT_FILE_DINHKEM.BENHVIEN_ID = 'HLU01'                                     order by FILE_ID]
2019-10-29 17:08:51,560 [1] DEBUG - Statement Id: [DAO00042_GetList] PreparedStatement : [select *              from TM_TUDIENKETQUA              where BENHVIEN_ID = 'HLU01'                and                       TM_TUDIENKETQUA.DICHVU_ID = '4144'                    and                       (TM_TUDIENKETQUA.NGUOITAO_ID = '1' OR TM_TUDIENKETQUA.SUDUNGCHUNG = '1')                                 order by TM_TUDIENKETQUA.TENNOIDUNG]
2019-10-29 17:08:51,600 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '26239'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2019-10-29 17:08:53,875 [1] DEBUG - Statement Id: [DAO00116_GetListThietBiCLS] PreparedStatement : [SELECT THIETBI_ID, MATHIETBI, TENTHIETBI, NHOMTHIETBI_ID          FROM TM_THIETBI MP          where          TAMNGUNG = '0'          and BENHVIEN_ID = 'HLU01'           AND             PHONGBAN_ID = 79                     order by TENTHIETBI]
--------------------------------------------------------------------------------
2019-10-29 17:10:40,694 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2019-10-29 17:10:40,969 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-10-29 17:10:41,009 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-10-29 17:10:41,490 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 17:10:41,759 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-10-29 17:10:53,500 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2019-10-29 17:10:53,540 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-10-29 17:10:55,108 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-10-29 17:10:55,221 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-10-29 17:10:56,083 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2019-10-29 17:10:56,217 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2019-10-29 17:10:56,292 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2019-10-29 17:10:56,372 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2019-10-29 17:10:56,448 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2019-10-29 17:10:56,525 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2019-10-29 17:10:56,604 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2019-10-29 17:10:56,680 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2019-10-29 17:10:56,781 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2019-10-29 17:10:57,304 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2019-10-29 17:10:57,340 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2019-10-29 17:10:57,412 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2019-10-29 17:10:57,445 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2019-10-29 17:10:58,607 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2019-10-29 17:10:58,687 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @NGUONDUOC_MACDINH varchar(5) = '0';        declare @TOAMUANGOAI int = 0;        select @NGUONDUOC_MACDINH = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'PHA_NGUONDUOC'        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + @NGUONDUOC_MACDINH as DUOC_KEY, 0 as PHAMVI_ID, @NGUONDUOC_MACDINH as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end        else        begin                  select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2019-10-29 17:11:00,890 [5] DEBUG - Statement Id: [DAO00320_GetList] PreparedStatement : [select M.*            from TM_MAU M            LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID            where            M.TAMNGUNG = '0'            and M.BENHVIEN_ID = 'HLU01'            order by M.TENMAU]
2019-10-29 17:11:00,956 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2019-10-29 17:11:00,990 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,        SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH        FROM TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID        WHERE TK.SOLUONG > 0        GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2019-10-29 17:11:01,071 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2019-10-29 17:11:01,105 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,        TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,        TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH        from TM_MAU M        JOIN        (        select        A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO        from        (        select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO        from TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'        where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0        ) A        )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2019-10-29 17:11:01,247 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2019-10-29 17:11:02,226 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 17:11:03,054 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2019-10-29 17:11:08,407 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2019-10-29 17:11:08,459 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2019-10-29 17:11:08,537 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 17:11:08,669 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 17:11:08,803 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2019-10-29 17:11:08,805 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-10-29 17:11:08,805 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-10-29 17:11:08,838 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2019-10-29 17:11:08,838 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-10-29 17:11:08,838 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-10-29 17:11:08,977 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 17:11:09,182 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 17:11:16,480 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 17:11:16,579 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2019-10-29 17:11:16,834 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2019-10-29 17:11:24,498 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS03'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 17:11:28,513 [1] DEBUG - Statement Id: [DAO00006_GetDSNhomDichVu] PreparedStatement : [select * from TM_NHOMDICHVU              where captren_id =              (select top (1) NHOMDICHVU_ID from TM_NHOMDICHVU where MANHOMDICHVU = '02')              and BENHVIEN_ID = 'HLU01']
2019-10-29 17:11:28,542 [1] DEBUG - Statement Id: [DAO00006_GetDSNhomDichVu] PreparedStatement : [select * from TM_NHOMDICHVU              where captren_id =              (select top (1) NHOMDICHVU_ID from TM_NHOMDICHVU where MANHOMDICHVU = '03')              and BENHVIEN_ID = 'HLU01']
2019-10-29 17:11:29,014 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 17:11:29,235 [1] DEBUG - Statement Id: [DAO00019_DanhSachCDHA] PreparedStatement : [declare @TenBenhVien nvarchar(500)        declare @ManhomDSA varchar(10);        set @TenBenhVien = (select VALUE from TM_SYS_APPSETTINGS where CODE = 'APP_BENHVIEN_TEN')        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        select * from(        select ROW_NUMBER() OVER(order by NGAYGIOYEUCAU) as ROWNUMBER, *        from        (SELECT distinct        COUNT(*) OVER() as TOTALROWS,        N'Mã người bệnh: ' + bn.MAYTE + ' - ' + N'Tên người bệnh: ' + bn.TENBENHNHAN + ' - ' + N'Số bệnh án: ' + ISNULL(BA.SOBENHAN,'') + ' - ' + N'Sinh ngày: ' + isnull(Convert(varchar(10),bn.NGAYSINH,103),bn.NAMSINH) + ' - ' + N'Giới tính: ' + GD.DESCRIPTION as GROUPNAME,        bn.MAYTE, bn.TENBENHNHAN, bn.NAMSINH, bn.NGAYSINH as TUOI, ISNULL(CONVERT(VARCHAR(10), bn.NGAYSINH, 103),CAST(bn.NAMSINH AS varchar)) as NGAYSINH, bn.DIACHILIENLAC as DIACHI, bn.GIOITINH, GD.DESCRIPTION as TENGIOITINH,        tn.DOITUONG_ID, tn.THOIGIANTIEPNHAN, tn.BENHNHAN_ID, tn.TIEPNHAN_ID, tn.TRAITUYEN, tn.SOTIEPNHAN,        dv.DICHVU_ID, dv.NOITHUCHIEN_ID, isnull(dv.NGAYTAO, dv.NGAYCAPNHAT) as THOIGIANDKDICHVU,        dv.KHAN, dv.NOIYEUCAU_ID, dv.NGAYGIOYEUCAU, dv.BACSICHIDINH_ID, dv.DONVIGIOITHIEU_ID, dv.NGUOIGIOITHIEU_ID, dv.TRANGTHAI_WFL,        tn.NOIGIOITHIEU_ID, kbnt.HUONGGIAIQUYET_ID,        dv.DVYEUCAU_ID, dv.MARIS, dv.TRANGTHAI as TRANGTHAICODE, B.TENNHOMDICHVU, dv.SOPHIEUYEUCAU, dv.KHAMBENH_NGOAITRU_ID, dv.NGUOICAPNHAT_ID, dv.NGAYCAPNHAT,        CASE        WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU        WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2) END AS MANHOMDICHVU, B.MANHOMDICHVU as MANHOMDICHVUCHITIET, tn.TRANGTHAI as TRANGTHAI_TIEPNHAN,        'False' as DAKHAM,        vp.DATHANHTOAN, vp.DONGIA_DOANHTHU, BA.SOBENHAN, dv.CHANDOAN        , a.TENDICHVU, nth.TENPHONGBAN as TENPHONGKHAM, nyc.TENPHONGBAN as TENKHOACHIDINH        , case when (dv.DONVIGIOITHIEU_ID is not null and dv.DONVIGIOITHIEU_ID != '') then ngt.TENBENHVIEN else @TenBenhVien end as TENBENHVIENCHIDINH        , case when (dv.BACSICHIDINH_ID is not null and dv.BACSICHIDINH_ID != '') then bscd.TENNHANVIEN else ngtt.TENNHANVIEN end as TENBACSICHIDINH          ,             0 as GUINGOAI, 0 as VTYT, 0 as CLSKETQUA_ID                   FROM TT_DVYEUCAU (NOLOCK) dv        inner join TT_TIEPNHAN (NOLOCK) tn on dv.TIEPNHAN_ID = tn.TIEPNHAN_ID        inner join TT_BENHNHAN (NOLOCK) bn on tn.BENHNHAN_ID = bn.BENHNHAN_ID        inner join TM_DICHVU A on A.DICHVU_ID = dv.DICHVU_ID        inner join TM_PHONGBAN nth on nth.PHONGBAN_ID = dv.NOITHUCHIEN_ID        left join TM_BENHVIEN ngt on ngt.BENHVIEN_STT_ID = dv.DONVIGIOITHIEU_ID        left join TM_NHANVIEN bscd on bscd.NHANVIEN_ID = dv.BACSICHIDINH_ID        left join TM_NHANVIEN ngtt on ngtt.NHANVIEN_ID = dv.NGUOIGIOITHIEU_ID        inner join TM_PHONGBAN nyc on nyc.PHONGBAN_ID = dv.NOIYEUCAU_ID        inner join TM_NHOMDICHVU B on B.NHOMDICHVU_ID = A.NHOMDICHVU_ID        inner join TT_VIENPHI (NOLOCK) VP on VP.TIEPNHAN_ID = tn.TIEPNHAN_ID and VP.DICHVU_ID = dv.DICHVU_ID and VP.REF_ID = dv.DVYEUCAU_ID        left join TT_NOITRU_BENHAN (NOLOCK) BA on BA.TIEPNHAN_ID = tn.TIEPNHAN_ID AND dv.BENHAN_ID = BA.BENHAN_ID        inner join TM_GENDER GD on GD.ID = bn.GIOITINH        left join TT_NGOAITRU_KHAMBENH (NOLOCK) kbnt on kbnt.KHAMBENH_ID = dv.KHAMBENH_NGOAITRU_ID                 where        dv.DICHVU_ID IS NOT NULL        and tn.BENHVIEN_ID = 'HLU01'        and HUYYEUCAU = 0        and dv.NGAYHENCLS is NULL                       and dv.TRANGTHAI = 'CHUAKETQUA'           and           dv.NGAYYEUCAU >= '10/29/2019 12:00:00 AM'         and           dv.NGAYYEUCAU <= '10/29/2019 12:00:00 AM'         and           dv.NOITHUCHIEN_ID = 79         and           (vp.DATHANHTOAN = '1'  or vp.DONGIA_DOANHTHU = '0' OR TN.SUDUNG_BHTN='1' OR TN.BAOLANH_VIENPHI='1'  OR tn.TRANGTHAI IN ('NOITRU','CAPCUU','NGOAITRU') or dv.HOPDONG_BENHNHAN_ID is not null or vp.BENHNHAN_PHAITHANHTOAN >= 0)         and           (CASE          WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU          WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2) END) in (02)         and           tn.TRANGTHAI IN ('DATIEPNHAN','NOITRU','CAPCUU','NGOAITRU', 'HOANTHANH')                 ) data1) lst                    where          lst.ROWNUMBER between 1 and 5                 order by NGAYGIOYEUCAU asc]
2019-10-29 17:11:29,996 [1] DEBUG - Statement Id: [DAO00019_DanhSachCDHA] PreparedStatement : [declare @TenBenhVien nvarchar(500)        declare @ManhomDSA varchar(10);        set @TenBenhVien = (select VALUE from TM_SYS_APPSETTINGS where CODE = 'APP_BENHVIEN_TEN')        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        select * from(        select ROW_NUMBER() OVER(order by NGAYGIOYEUCAU) as ROWNUMBER, *        from        (SELECT distinct        COUNT(*) OVER() as TOTALROWS,        N'Mã người bệnh: ' + bn.MAYTE + ' - ' + N'Tên người bệnh: ' + bn.TENBENHNHAN + ' - ' + N'Số bệnh án: ' + ISNULL(BA.SOBENHAN,'') + ' - ' + N'Sinh ngày: ' + isnull(Convert(varchar(10),bn.NGAYSINH,103),bn.NAMSINH) + ' - ' + N'Giới tính: ' + GD.DESCRIPTION as GROUPNAME,        bn.MAYTE, bn.TENBENHNHAN, bn.NAMSINH, bn.NGAYSINH as TUOI, ISNULL(CONVERT(VARCHAR(10), bn.NGAYSINH, 103),CAST(bn.NAMSINH AS varchar)) as NGAYSINH, bn.DIACHILIENLAC as DIACHI, bn.GIOITINH, GD.DESCRIPTION as TENGIOITINH,        tn.DOITUONG_ID, tn.THOIGIANTIEPNHAN, tn.BENHNHAN_ID, tn.TIEPNHAN_ID, tn.TRAITUYEN, tn.SOTIEPNHAN,        dv.DICHVU_ID, dv.NOITHUCHIEN_ID, isnull(dv.NGAYTAO, dv.NGAYCAPNHAT) as THOIGIANDKDICHVU,        dv.KHAN, dv.NOIYEUCAU_ID, dv.NGAYGIOYEUCAU, dv.BACSICHIDINH_ID, dv.DONVIGIOITHIEU_ID, dv.NGUOIGIOITHIEU_ID, dv.TRANGTHAI_WFL,        tn.NOIGIOITHIEU_ID, kbnt.HUONGGIAIQUYET_ID,        dv.DVYEUCAU_ID, dv.MARIS, dv.TRANGTHAI as TRANGTHAICODE, B.TENNHOMDICHVU, dv.SOPHIEUYEUCAU, dv.KHAMBENH_NGOAITRU_ID, dv.NGUOICAPNHAT_ID, dv.NGAYCAPNHAT,        CASE        WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU        WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2) END AS MANHOMDICHVU, B.MANHOMDICHVU as MANHOMDICHVUCHITIET, tn.TRANGTHAI as TRANGTHAI_TIEPNHAN,        'False' as DAKHAM,        vp.DATHANHTOAN, vp.DONGIA_DOANHTHU, BA.SOBENHAN, dv.CHANDOAN        , a.TENDICHVU, nth.TENPHONGBAN as TENPHONGKHAM, nyc.TENPHONGBAN as TENKHOACHIDINH        , case when (dv.DONVIGIOITHIEU_ID is not null and dv.DONVIGIOITHIEU_ID != '') then ngt.TENBENHVIEN else @TenBenhVien end as TENBENHVIENCHIDINH        , case when (dv.BACSICHIDINH_ID is not null and dv.BACSICHIDINH_ID != '') then bscd.TENNHANVIEN else ngtt.TENNHANVIEN end as TENBACSICHIDINH          ,             0 as GUINGOAI, 0 as VTYT, 0 as CLSKETQUA_ID                   FROM TT_DVYEUCAU (NOLOCK) dv        inner join TT_TIEPNHAN (NOLOCK) tn on dv.TIEPNHAN_ID = tn.TIEPNHAN_ID        inner join TT_BENHNHAN (NOLOCK) bn on tn.BENHNHAN_ID = bn.BENHNHAN_ID        inner join TM_DICHVU A on A.DICHVU_ID = dv.DICHVU_ID        inner join TM_PHONGBAN nth on nth.PHONGBAN_ID = dv.NOITHUCHIEN_ID        left join TM_BENHVIEN ngt on ngt.BENHVIEN_STT_ID = dv.DONVIGIOITHIEU_ID        left join TM_NHANVIEN bscd on bscd.NHANVIEN_ID = dv.BACSICHIDINH_ID        left join TM_NHANVIEN ngtt on ngtt.NHANVIEN_ID = dv.NGUOIGIOITHIEU_ID        inner join TM_PHONGBAN nyc on nyc.PHONGBAN_ID = dv.NOIYEUCAU_ID        inner join TM_NHOMDICHVU B on B.NHOMDICHVU_ID = A.NHOMDICHVU_ID        inner join TT_VIENPHI (NOLOCK) VP on VP.TIEPNHAN_ID = tn.TIEPNHAN_ID and VP.DICHVU_ID = dv.DICHVU_ID and VP.REF_ID = dv.DVYEUCAU_ID        left join TT_NOITRU_BENHAN (NOLOCK) BA on BA.TIEPNHAN_ID = tn.TIEPNHAN_ID AND dv.BENHAN_ID = BA.BENHAN_ID        inner join TM_GENDER GD on GD.ID = bn.GIOITINH        left join TT_NGOAITRU_KHAMBENH (NOLOCK) kbnt on kbnt.KHAMBENH_ID = dv.KHAMBENH_NGOAITRU_ID                 where        dv.DICHVU_ID IS NOT NULL        and tn.BENHVIEN_ID = 'HLU01'        and HUYYEUCAU = 0        and dv.NGAYHENCLS is NULL                       and dv.TRANGTHAI = 'CHUAKETQUA'           and           dv.NGAYYEUCAU >= '10/29/2019 12:00:00 AM'         and           dv.NGAYYEUCAU <= '10/29/2019 12:00:00 AM'         and           dv.NOITHUCHIEN_ID = 79         and           (vp.DATHANHTOAN = '1'  or vp.DONGIA_DOANHTHU = '0' OR TN.SUDUNG_BHTN='1' OR TN.BAOLANH_VIENPHI='1'  OR tn.TRANGTHAI IN ('NOITRU','CAPCUU','NGOAITRU') or dv.HOPDONG_BENHNHAN_ID is not null or vp.BENHNHAN_PHAITHANHTOAN >= 0)         and           (CASE          WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU          WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2) END) in (02)         and           tn.TRANGTHAI IN ('DATIEPNHAN','NOITRU','CAPCUU','NGOAITRU', 'HOANTHANH')                 ) data1) lst                    where          lst.ROWNUMBER between 1 and 5                 order by NGAYGIOYEUCAU asc]
2019-10-29 17:11:38,316 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS31'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 17:11:38,390 [1] DEBUG - Statement Id: [DAO00019_DanhSachCDHA] PreparedStatement : [declare @TenBenhVien nvarchar(500)        declare @ManhomDSA varchar(10);        set @TenBenhVien = (select VALUE from TM_SYS_APPSETTINGS where CODE = 'APP_BENHVIEN_TEN')        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        select * from(        select ROW_NUMBER() OVER(order by NGAYGIOYEUCAU) as ROWNUMBER, *        from        (SELECT distinct        COUNT(*) OVER() as TOTALROWS,        N'Mã người bệnh: ' + bn.MAYTE + ' - ' + N'Tên người bệnh: ' + bn.TENBENHNHAN + ' - ' + N'Số bệnh án: ' + ISNULL(BA.SOBENHAN,'') + ' - ' + N'Sinh ngày: ' + isnull(Convert(varchar(10),bn.NGAYSINH,103),bn.NAMSINH) + ' - ' + N'Giới tính: ' + GD.DESCRIPTION as GROUPNAME,        bn.MAYTE, bn.TENBENHNHAN, bn.NAMSINH, bn.NGAYSINH as TUOI, ISNULL(CONVERT(VARCHAR(10), bn.NGAYSINH, 103),CAST(bn.NAMSINH AS varchar)) as NGAYSINH, bn.DIACHILIENLAC as DIACHI, bn.GIOITINH, GD.DESCRIPTION as TENGIOITINH,        tn.DOITUONG_ID, tn.THOIGIANTIEPNHAN, tn.BENHNHAN_ID, tn.TIEPNHAN_ID, tn.TRAITUYEN, tn.SOTIEPNHAN,        dv.DICHVU_ID, dv.NOITHUCHIEN_ID, isnull(dv.NGAYTAO, dv.NGAYCAPNHAT) as THOIGIANDKDICHVU,        dv.KHAN, dv.NOIYEUCAU_ID, dv.NGAYGIOYEUCAU, dv.BACSICHIDINH_ID, dv.DONVIGIOITHIEU_ID, dv.NGUOIGIOITHIEU_ID, dv.TRANGTHAI_WFL,        tn.NOIGIOITHIEU_ID, kbnt.HUONGGIAIQUYET_ID,        dv.DVYEUCAU_ID, dv.MARIS, dv.TRANGTHAI as TRANGTHAICODE, B.TENNHOMDICHVU, dv.SOPHIEUYEUCAU, dv.KHAMBENH_NGOAITRU_ID, dv.NGUOICAPNHAT_ID, dv.NGAYCAPNHAT,        CASE        WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU        WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2) END AS MANHOMDICHVU, B.MANHOMDICHVU as MANHOMDICHVUCHITIET, tn.TRANGTHAI as TRANGTHAI_TIEPNHAN,        'True' as DAKHAM,        vp.DATHANHTOAN, vp.DONGIA_DOANHTHU, BA.SOBENHAN, dv.CHANDOAN        , a.TENDICHVU, nth.TENPHONGBAN as TENPHONGKHAM, nyc.TENPHONGBAN as TENKHOACHIDINH        , case when (dv.DONVIGIOITHIEU_ID is not null and dv.DONVIGIOITHIEU_ID != '') then ngt.TENBENHVIEN else @TenBenhVien end as TENBENHVIENCHIDINH        , case when (dv.BACSICHIDINH_ID is not null and dv.BACSICHIDINH_ID != '') then bscd.TENNHANVIEN else ngtt.TENNHANVIEN end as TENBACSICHIDINH          ,             cls.CLSKETQUA_ID, cls.NGAYGIOTHUCHIEN , cls.THOIGIANKHOADULIEU, cls.NGUOIKHOA_ID, cls_vtyt.CLSKETQUA_ID as VTYT            , cls.GUINGOAI, cls.NOIGUIDEN_ID, dv.TENNGUOIKHOA                   FROM TT_DVYEUCAU (NOLOCK) dv        inner join TT_TIEPNHAN (NOLOCK) tn on dv.TIEPNHAN_ID = tn.TIEPNHAN_ID        inner join TT_BENHNHAN (NOLOCK) bn on tn.BENHNHAN_ID = bn.BENHNHAN_ID        inner join TM_DICHVU A on A.DICHVU_ID = dv.DICHVU_ID        inner join TM_PHONGBAN nth on nth.PHONGBAN_ID = dv.NOITHUCHIEN_ID        left join TM_BENHVIEN ngt on ngt.BENHVIEN_STT_ID = dv.DONVIGIOITHIEU_ID        left join TM_NHANVIEN bscd on bscd.NHANVIEN_ID = dv.BACSICHIDINH_ID        left join TM_NHANVIEN ngtt on ngtt.NHANVIEN_ID = dv.NGUOIGIOITHIEU_ID        inner join TM_PHONGBAN nyc on nyc.PHONGBAN_ID = dv.NOIYEUCAU_ID        inner join TM_NHOMDICHVU B on B.NHOMDICHVU_ID = A.NHOMDICHVU_ID        inner join TT_VIENPHI (NOLOCK) VP on VP.TIEPNHAN_ID = tn.TIEPNHAN_ID and VP.DICHVU_ID = dv.DICHVU_ID and VP.REF_ID = dv.DVYEUCAU_ID        left join TT_NOITRU_BENHAN (NOLOCK) BA on BA.TIEPNHAN_ID = tn.TIEPNHAN_ID AND dv.BENHAN_ID = BA.BENHAN_ID        inner join TM_GENDER GD on GD.ID = bn.GIOITINH        left join TT_NGOAITRU_KHAMBENH (NOLOCK) kbnt on kbnt.KHAMBENH_ID = dv.KHAMBENH_NGOAITRU_ID                       left join TT_CLSKETQUA (NOLOCK) cls on dv.DVYEUCAU_ID = cls.DVYEUCAU_ID            left join TT_CLSKETQUA_VTYT (NOLOCK) cls_vtyt on cls_vtyt.DVYEUCAU_ID = dv.DVYEUCAU_ID                   where        dv.DICHVU_ID IS NOT NULL        and tn.BENHVIEN_ID = 'HLU01'        and HUYYEUCAU = 0        and dv.NGAYHENCLS is NULL                       and dv.TRANGTHAI IN ('CHOXACNHAN','HOANTAT')           and           dv.NGAYYEUCAU >= '6/1/2019 12:00:00 AM'         and           dv.NGAYYEUCAU <= '10/29/2019 12:00:00 AM'         and           dv.NOITHUCHIEN_ID = 79         and           (vp.DATHANHTOAN = '1'  or vp.DONGIA_DOANHTHU = '0' OR TN.SUDUNG_BHTN='1' OR TN.BAOLANH_VIENPHI='1'  OR tn.TRANGTHAI IN ('NOITRU','CAPCUU','NGOAITRU') or dv.HOPDONG_BENHNHAN_ID is not null or vp.BENHNHAN_PHAITHANHTOAN >= 0)         and           (bn.TENBENHNHAN like '%' +  @param0  + '%' or bn.MAYTE like '%' +  @param0  + '%')         and           (CASE          WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU          WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2) END) in (02)                 ) data1) lst                    where          lst.ROWNUMBER between 1 and 5                 order by NGAYGIOYEUCAU asc]
2019-10-29 17:11:38,390 [1] DEBUG - Statement Id: [DAO00019_DanhSachCDHA] Parameters: [@param0=[TENBENHNHAN,Côi]]
2019-10-29 17:11:38,390 [1] DEBUG - Statement Id: [DAO00019_DanhSachCDHA] Types: [@param0=[String, System.String]]
2019-10-29 17:11:38,536 [1] DEBUG - Statement Id: [DAO00000_GetNhomDoiTuong] PreparedStatement : [SELECT DOITUONG_ID              ,[TENDOITUONG]              ,[NHOMDICHVU]              ,[TYLE_VUOT_LCB]              ,[GIOIHAN_VUOT_LCB]              ,[GIOIHAN_VUOT_DVKTC]              ,[TYLE_THUOC_UT]              ,[CPVC]              ,[CHIPHINGOAI_BHYT]              ,[NGANSACH_TL]              ,[MIENGIAM_TL]              ,[TAITRO_TL]              ,[BHTN_TL]              FROM [dbo].[TM_DOITUONG]]
2019-10-29 17:11:40,181 [1] DEBUG - Statement Id: [DAO00019_ThongTinBenhNhanDvYeuCau] PreparedStatement : [select distinct A.SOTIEPNHAN, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI, A.NGAYMIENDONGCHITRA,        B.*,  C.DICHVU_ID, C.DVYEUCAU_ID, C.NOITHUCHIEN_ID, A.SOBHYT        from TT_TIEPNHAN A        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'        where                    C.DVYEUCAU_ID = '205346'                 and A.BENHVIEN_ID = 'HLU01']
2019-10-29 17:11:40,530 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '26239'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2019-10-29 17:11:40,644 [1] DEBUG - Statement Id: [DAO00046_GETLISTDVYEUCAUINLISTDVID] PreparedStatement : [SELECT dvyc.*, clskqct.CLSKETQUA_ID, clskqct.DICHVU_ID as KETQUA_DICHVU_ID,        clskqct.CLSKETQUACHITIET_ID, clskqct.DONVITINH, clskqct.KETQUA, clskqct.KETQUA2,        clskqct.MUCBINHTHUONG, clskqct.MUCBINHTHUONGMIN, clskqct.MUCBINHTHUONGMAX, clskqct.BATTHUONG        FROM dbo.TT_CLSKETQUACHITIET as clskqct RIGHT OUTER JOIN        dbo.TT_DVYEUCAU as dvyc ON                 clskqct.DVYEUCAU_ID = dvyc.DVYEUCAU_ID        where dvyc.BENHVIEN_ID = 'HLU01'          and             exists (select DICHVU_ID from TM_DICHVU a join TM_NHOMDICHVU b on a.NHOMDICHVU_ID = b.NHOMDICHVU_ID            where dvyc.DICHVU_ID = DICHVU_ID and (left(MANHOMDICHVU,2) in ('02', '03') OR MANHOMDICHVU in ('02', '03')))           and             dvyc.TIEPNHAN_ID =  @param0                    order by DVYEUCAU_ID]
2019-10-29 17:11:40,644 [1] DEBUG - Statement Id: [DAO00046_GETLISTDVYEUCAUINLISTDVID] Parameters: [@param0=[TIEPNHAN_ID,26239]]
2019-10-29 17:11:40,644 [1] DEBUG - Statement Id: [DAO00046_GETLISTDVYEUCAUINLISTDVID] Types: [@param0=[Int64, System.Int64]]
2019-10-29 17:11:40,677 [1] DEBUG - Statement Id: [DAO00045_GetListDVYeuCau] PreparedStatement : [select *              from VIEW_DICHVU_NHOMDV              where BENHVIEN_ID = 'HLU01']
2019-10-29 17:11:40,862 [1] DEBUG - Statement Id: [DAO00018_GetList] PreparedStatement : [select A.*, B.DICTIONARY_NAME, B.DICTIONARY_CODE, B.DICTIONARY_NAME_EN CHUCDANH, (B.DICTIONARY_NAME_EN + '. ' + A.TENNHANVIEN) TENHOCVIHOCHAM            from TM_NHANVIEN A            left join (select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE = 'chucdanh' and DICTIONARY_NAME_EN is not null) B on A.CHUCDANH_ID = B.DICTIONARY_ID            where A.BENHVIEN_ID = '' and A.TAMNGUNG = '0']
2019-10-29 17:11:40,898 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '26239'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2019-10-29 17:11:43,362 [1] DEBUG - Statement Id: [DAO00116_GetListThietBiCLS] PreparedStatement : [SELECT THIETBI_ID, MATHIETBI, TENTHIETBI, NHOMTHIETBI_ID          FROM TM_THIETBI MP          where          TAMNGUNG = '0'          and BENHVIEN_ID = 'HLU01'           AND             PHONGBAN_ID = 79                     order by TENTHIETBI]
2019-10-29 17:11:44,233 [1] DEBUG - Statement Id: [DAO00037_GetCLSKetQua] PreparedStatement : [select *              from TT_CLSKETQUA               where                             TT_CLSKETQUA.DVYEUCAU_ID = '205346'                       and                           TT_CLSKETQUA.BENHVIEN_ID = 'HLU01'                                     order by CLSKETQUA_ID]
2019-10-29 17:11:44,336 [1] DEBUG - Statement Id: [DAO00020_GetDetailP] PreparedStatement : [select *        from TT_DVYEUCAU        where TT_DVYEUCAU.DVYEUCAU_ID  = 205346        order by DVYEUCAU_ID]
2019-10-29 17:11:44,422 [1] DEBUG - Statement Id: [DAO00017_GetNameByID] PreparedStatement : [select TENPHONGBAN              from [TM_PHONGBAN]              where PHONGBAN_ID = '18' and BENHVIEN_ID = 'HLU01']
2019-10-29 17:11:44,503 [1] DEBUG - Statement Id: [DAO00041_GetNameByID] PreparedStatement : [select TENDICHVU              from TM_DICHVU              where DICHVU_ID = '4144']
2019-10-29 17:11:45,297 [1] DEBUG - Statement Id: [DAO00038_GetList] PreparedStatement : [select *              from TT_CLSKETQUA_IMAGES               where                             TT_CLSKETQUA_IMAGES.CLSKETQUA_ID = '96455'                       and                           TT_CLSKETQUA_IMAGES.BENHVIEN_ID = 'HLU01'                                     order by IDX]
2019-10-29 17:11:45,366 [1] DEBUG - Statement Id: [DAO00222_GetList] PreparedStatement : [select *        from TT_CLSKETQUA_DOCUMENTS         where                 CLSKETQUA_ID = '96455'                     order by CLSKETQUA_DOCUMENTS_ID]
2019-10-29 17:11:45,400 [1] DEBUG - Statement Id: [DAO00116_File_GetList] PreparedStatement : [select *              from TT_FILE_DINHKEM               where                             TT_FILE_DINHKEM.REF_TABLE = 'TT_CLSKETQUA'                       and                           TT_FILE_DINHKEM.REF_ID = '96455'                       and                           TT_FILE_DINHKEM.BENHVIEN_ID = 'HLU01'                                     order by FILE_ID]
2019-10-29 17:11:45,468 [1] DEBUG - Statement Id: [DAO00087_GetServiceParams] PreparedStatement : [select CODE, VALUE              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01']
2019-10-29 17:11:45,503 [1] DEBUG - Statement Id: [DAO00042_GetList] PreparedStatement : [select *              from TM_TUDIENKETQUA              where BENHVIEN_ID = 'HLU01'                and                       TM_TUDIENKETQUA.DICHVU_ID = '4144'                    and                       (TM_TUDIENKETQUA.NGUOITAO_ID = '1' OR TM_TUDIENKETQUA.SUDUNGCHUNG = '1')                                 order by TM_TUDIENKETQUA.TENNOIDUNG]
2019-10-29 17:11:45,542 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '26239'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2019-10-29 17:11:46,590 [1] DEBUG - Statement Id: [DAO00037_GetCLSKetQua] PreparedStatement : [select *              from TT_CLSKETQUA               where                             TT_CLSKETQUA.DVYEUCAU_ID = '205346'                       and                           TT_CLSKETQUA.BENHVIEN_ID = 'HLU01'                                     order by CLSKETQUA_ID]
2019-10-29 17:11:46,672 [1] DEBUG - Statement Id: [DAO00020_GetDetailP] PreparedStatement : [select *        from TT_DVYEUCAU        where TT_DVYEUCAU.DVYEUCAU_ID  = 205346        order by DVYEUCAU_ID]
2019-10-29 17:11:46,752 [1] DEBUG - Statement Id: [DAO00017_GetNameByID] PreparedStatement : [select TENPHONGBAN              from [TM_PHONGBAN]              where PHONGBAN_ID = '18' and BENHVIEN_ID = 'HLU01']
2019-10-29 17:11:46,872 [1] DEBUG - Statement Id: [DAO00041_GetNameByID] PreparedStatement : [select TENDICHVU              from TM_DICHVU              where DICHVU_ID = '4144']
2019-10-29 17:11:46,985 [1] DEBUG - Statement Id: [DAO00038_GetList] PreparedStatement : [select *              from TT_CLSKETQUA_IMAGES               where                             TT_CLSKETQUA_IMAGES.CLSKETQUA_ID = '96455'                       and                           TT_CLSKETQUA_IMAGES.BENHVIEN_ID = 'HLU01'                                     order by IDX]
2019-10-29 17:11:47,020 [1] DEBUG - Statement Id: [DAO00222_GetList] PreparedStatement : [select *        from TT_CLSKETQUA_DOCUMENTS         where                 CLSKETQUA_ID = '96455'                     order by CLSKETQUA_DOCUMENTS_ID]
2019-10-29 17:11:47,050 [1] DEBUG - Statement Id: [DAO00116_File_GetList] PreparedStatement : [select *              from TT_FILE_DINHKEM               where                             TT_FILE_DINHKEM.REF_TABLE = 'TT_CLSKETQUA'                       and                           TT_FILE_DINHKEM.REF_ID = '96455'                       and                           TT_FILE_DINHKEM.BENHVIEN_ID = 'HLU01'                                     order by FILE_ID]
2019-10-29 17:11:47,087 [1] DEBUG - Statement Id: [DAO00042_GetList] PreparedStatement : [select *              from TM_TUDIENKETQUA              where BENHVIEN_ID = 'HLU01'                and                       TM_TUDIENKETQUA.DICHVU_ID = '4144'                    and                       (TM_TUDIENKETQUA.NGUOITAO_ID = '1' OR TM_TUDIENKETQUA.SUDUNGCHUNG = '1')                                 order by TM_TUDIENKETQUA.TENNOIDUNG]
2019-10-29 17:11:47,121 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '26239'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2019-10-29 17:11:49,048 [1] DEBUG - Statement Id: [DAO00116_GetListThietBiCLS] PreparedStatement : [SELECT THIETBI_ID, MATHIETBI, TENTHIETBI, NHOMTHIETBI_ID          FROM TM_THIETBI MP          where          TAMNGUNG = '0'          and BENHVIEN_ID = 'HLU01'           AND             PHONGBAN_ID = 79                     order by TENTHIETBI]
--------------------------------------------------------------------------------
2019-10-29 17:12:46,711 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2019-10-29 17:12:46,990 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-10-29 17:12:47,028 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-10-29 17:12:47,427 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 17:12:47,711 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-10-29 17:12:54,164 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2019-10-29 17:12:54,192 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-10-29 17:12:55,759 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-10-29 17:12:55,850 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-10-29 17:12:56,703 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2019-10-29 17:12:56,847 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2019-10-29 17:12:56,920 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2019-10-29 17:12:57,002 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2019-10-29 17:12:57,109 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2019-10-29 17:12:57,595 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2019-10-29 17:12:57,679 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2019-10-29 17:12:57,753 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2019-10-29 17:12:57,834 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2019-10-29 17:12:58,343 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2019-10-29 17:12:58,382 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2019-10-29 17:12:58,460 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2019-10-29 17:12:58,493 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2019-10-29 17:13:00,103 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2019-10-29 17:13:00,138 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @NGUONDUOC_MACDINH varchar(5) = '0';        declare @TOAMUANGOAI int = 0;        select @NGUONDUOC_MACDINH = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'PHA_NGUONDUOC'        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + @NGUONDUOC_MACDINH as DUOC_KEY, 0 as PHAMVI_ID, @NGUONDUOC_MACDINH as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end        else        begin                  select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2019-10-29 17:13:02,258 [5] DEBUG - Statement Id: [DAO00320_GetList] PreparedStatement : [select M.*            from TM_MAU M            LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID            where            M.TAMNGUNG = '0'            and M.BENHVIEN_ID = 'HLU01'            order by M.TENMAU]
2019-10-29 17:13:02,395 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2019-10-29 17:13:02,436 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,        SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH        FROM TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID        WHERE TK.SOLUONG > 0        GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2019-10-29 17:13:02,504 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2019-10-29 17:13:02,536 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,        TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,        TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH        from TM_MAU M        JOIN        (        select        A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO        from        (        select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO        from TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'        where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0        ) A        )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2019-10-29 17:13:02,609 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2019-10-29 17:13:03,590 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 17:13:04,477 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2019-10-29 17:13:09,263 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2019-10-29 17:13:09,366 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2019-10-29 17:13:09,450 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 17:13:09,577 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 17:13:09,732 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2019-10-29 17:13:09,734 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-10-29 17:13:09,734 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-10-29 17:13:09,812 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2019-10-29 17:13:09,812 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-10-29 17:13:09,812 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-10-29 17:13:09,964 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 17:13:10,128 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 17:13:17,292 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 17:13:17,496 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2019-10-29 17:13:17,810 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2019-10-29 17:13:23,107 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS03'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 17:13:27,103 [1] DEBUG - Statement Id: [DAO00006_GetDSNhomDichVu] PreparedStatement : [select * from TM_NHOMDICHVU              where captren_id =              (select top (1) NHOMDICHVU_ID from TM_NHOMDICHVU where MANHOMDICHVU = '02')              and BENHVIEN_ID = 'HLU01']
2019-10-29 17:13:27,730 [1] DEBUG - Statement Id: [DAO00006_GetDSNhomDichVu] PreparedStatement : [select * from TM_NHOMDICHVU              where captren_id =              (select top (1) NHOMDICHVU_ID from TM_NHOMDICHVU where MANHOMDICHVU = '03')              and BENHVIEN_ID = 'HLU01']
2019-10-29 17:13:28,166 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 17:13:28,395 [1] DEBUG - Statement Id: [DAO00019_DanhSachCDHA] PreparedStatement : [declare @TenBenhVien nvarchar(500)        declare @ManhomDSA varchar(10);        set @TenBenhVien = (select VALUE from TM_SYS_APPSETTINGS where CODE = 'APP_BENHVIEN_TEN')        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        select * from(        select ROW_NUMBER() OVER(order by NGAYGIOYEUCAU) as ROWNUMBER, *        from        (SELECT distinct        COUNT(*) OVER() as TOTALROWS,        N'Mã người bệnh: ' + bn.MAYTE + ' - ' + N'Tên người bệnh: ' + bn.TENBENHNHAN + ' - ' + N'Số bệnh án: ' + ISNULL(BA.SOBENHAN,'') + ' - ' + N'Sinh ngày: ' + isnull(Convert(varchar(10),bn.NGAYSINH,103),bn.NAMSINH) + ' - ' + N'Giới tính: ' + GD.DESCRIPTION as GROUPNAME,        bn.MAYTE, bn.TENBENHNHAN, bn.NAMSINH, bn.NGAYSINH as TUOI, ISNULL(CONVERT(VARCHAR(10), bn.NGAYSINH, 103),CAST(bn.NAMSINH AS varchar)) as NGAYSINH, bn.DIACHILIENLAC as DIACHI, bn.GIOITINH, GD.DESCRIPTION as TENGIOITINH,        tn.DOITUONG_ID, tn.THOIGIANTIEPNHAN, tn.BENHNHAN_ID, tn.TIEPNHAN_ID, tn.TRAITUYEN, tn.SOTIEPNHAN,        dv.DICHVU_ID, dv.NOITHUCHIEN_ID, isnull(dv.NGAYTAO, dv.NGAYCAPNHAT) as THOIGIANDKDICHVU,        dv.KHAN, dv.NOIYEUCAU_ID, dv.NGAYGIOYEUCAU, dv.BACSICHIDINH_ID, dv.DONVIGIOITHIEU_ID, dv.NGUOIGIOITHIEU_ID, dv.TRANGTHAI_WFL,        tn.NOIGIOITHIEU_ID, kbnt.HUONGGIAIQUYET_ID,        dv.DVYEUCAU_ID, dv.MARIS, dv.TRANGTHAI as TRANGTHAICODE, B.TENNHOMDICHVU, dv.SOPHIEUYEUCAU, dv.KHAMBENH_NGOAITRU_ID, dv.NGUOICAPNHAT_ID, dv.NGAYCAPNHAT,        CASE        WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU        WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2) END AS MANHOMDICHVU, B.MANHOMDICHVU as MANHOMDICHVUCHITIET, tn.TRANGTHAI as TRANGTHAI_TIEPNHAN,        'False' as DAKHAM,        vp.DATHANHTOAN, vp.DONGIA_DOANHTHU, BA.SOBENHAN, dv.CHANDOAN        , a.TENDICHVU, nth.TENPHONGBAN as TENPHONGKHAM, nyc.TENPHONGBAN as TENKHOACHIDINH        , case when (dv.DONVIGIOITHIEU_ID is not null and dv.DONVIGIOITHIEU_ID != '') then ngt.TENBENHVIEN else @TenBenhVien end as TENBENHVIENCHIDINH        , case when (dv.BACSICHIDINH_ID is not null and dv.BACSICHIDINH_ID != '') then bscd.TENNHANVIEN else ngtt.TENNHANVIEN end as TENBACSICHIDINH          ,             0 as GUINGOAI, 0 as VTYT, 0 as CLSKETQUA_ID                   FROM TT_DVYEUCAU (NOLOCK) dv        inner join TT_TIEPNHAN (NOLOCK) tn on dv.TIEPNHAN_ID = tn.TIEPNHAN_ID        inner join TT_BENHNHAN (NOLOCK) bn on tn.BENHNHAN_ID = bn.BENHNHAN_ID        inner join TM_DICHVU A on A.DICHVU_ID = dv.DICHVU_ID        inner join TM_PHONGBAN nth on nth.PHONGBAN_ID = dv.NOITHUCHIEN_ID        left join TM_BENHVIEN ngt on ngt.BENHVIEN_STT_ID = dv.DONVIGIOITHIEU_ID        left join TM_NHANVIEN bscd on bscd.NHANVIEN_ID = dv.BACSICHIDINH_ID        left join TM_NHANVIEN ngtt on ngtt.NHANVIEN_ID = dv.NGUOIGIOITHIEU_ID        inner join TM_PHONGBAN nyc on nyc.PHONGBAN_ID = dv.NOIYEUCAU_ID        inner join TM_NHOMDICHVU B on B.NHOMDICHVU_ID = A.NHOMDICHVU_ID        inner join TT_VIENPHI (NOLOCK) VP on VP.TIEPNHAN_ID = tn.TIEPNHAN_ID and VP.DICHVU_ID = dv.DICHVU_ID and VP.REF_ID = dv.DVYEUCAU_ID        left join TT_NOITRU_BENHAN (NOLOCK) BA on BA.TIEPNHAN_ID = tn.TIEPNHAN_ID AND dv.BENHAN_ID = BA.BENHAN_ID        inner join TM_GENDER GD on GD.ID = bn.GIOITINH        left join TT_NGOAITRU_KHAMBENH (NOLOCK) kbnt on kbnt.KHAMBENH_ID = dv.KHAMBENH_NGOAITRU_ID                 where        dv.DICHVU_ID IS NOT NULL        and tn.BENHVIEN_ID = 'HLU01'        and HUYYEUCAU = 0        and dv.NGAYHENCLS is NULL                       and dv.TRANGTHAI = 'CHUAKETQUA'           and           dv.NGAYYEUCAU >= '10/29/2019 12:00:00 AM'         and           dv.NGAYYEUCAU <= '10/29/2019 12:00:00 AM'         and           dv.NOITHUCHIEN_ID = 79         and           (vp.DATHANHTOAN = '1'  or vp.DONGIA_DOANHTHU = '0' OR TN.SUDUNG_BHTN='1' OR TN.BAOLANH_VIENPHI='1'  OR tn.TRANGTHAI IN ('NOITRU','CAPCUU','NGOAITRU') or dv.HOPDONG_BENHNHAN_ID is not null or vp.BENHNHAN_PHAITHANHTOAN >= 0)         and           (CASE          WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU          WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2) END) in (02)         and           tn.TRANGTHAI IN ('DATIEPNHAN','NOITRU','CAPCUU','NGOAITRU', 'HOANTHANH')                 ) data1) lst                    where          lst.ROWNUMBER between 1 and 5                 order by NGAYGIOYEUCAU asc]
2019-10-29 17:13:29,188 [1] DEBUG - Statement Id: [DAO00019_DanhSachCDHA] PreparedStatement : [declare @TenBenhVien nvarchar(500)        declare @ManhomDSA varchar(10);        set @TenBenhVien = (select VALUE from TM_SYS_APPSETTINGS where CODE = 'APP_BENHVIEN_TEN')        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        select * from(        select ROW_NUMBER() OVER(order by NGAYGIOYEUCAU) as ROWNUMBER, *        from        (SELECT distinct        COUNT(*) OVER() as TOTALROWS,        N'Mã người bệnh: ' + bn.MAYTE + ' - ' + N'Tên người bệnh: ' + bn.TENBENHNHAN + ' - ' + N'Số bệnh án: ' + ISNULL(BA.SOBENHAN,'') + ' - ' + N'Sinh ngày: ' + isnull(Convert(varchar(10),bn.NGAYSINH,103),bn.NAMSINH) + ' - ' + N'Giới tính: ' + GD.DESCRIPTION as GROUPNAME,        bn.MAYTE, bn.TENBENHNHAN, bn.NAMSINH, bn.NGAYSINH as TUOI, ISNULL(CONVERT(VARCHAR(10), bn.NGAYSINH, 103),CAST(bn.NAMSINH AS varchar)) as NGAYSINH, bn.DIACHILIENLAC as DIACHI, bn.GIOITINH, GD.DESCRIPTION as TENGIOITINH,        tn.DOITUONG_ID, tn.THOIGIANTIEPNHAN, tn.BENHNHAN_ID, tn.TIEPNHAN_ID, tn.TRAITUYEN, tn.SOTIEPNHAN,        dv.DICHVU_ID, dv.NOITHUCHIEN_ID, isnull(dv.NGAYTAO, dv.NGAYCAPNHAT) as THOIGIANDKDICHVU,        dv.KHAN, dv.NOIYEUCAU_ID, dv.NGAYGIOYEUCAU, dv.BACSICHIDINH_ID, dv.DONVIGIOITHIEU_ID, dv.NGUOIGIOITHIEU_ID, dv.TRANGTHAI_WFL,        tn.NOIGIOITHIEU_ID, kbnt.HUONGGIAIQUYET_ID,        dv.DVYEUCAU_ID, dv.MARIS, dv.TRANGTHAI as TRANGTHAICODE, B.TENNHOMDICHVU, dv.SOPHIEUYEUCAU, dv.KHAMBENH_NGOAITRU_ID, dv.NGUOICAPNHAT_ID, dv.NGAYCAPNHAT,        CASE        WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU        WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2) END AS MANHOMDICHVU, B.MANHOMDICHVU as MANHOMDICHVUCHITIET, tn.TRANGTHAI as TRANGTHAI_TIEPNHAN,        'False' as DAKHAM,        vp.DATHANHTOAN, vp.DONGIA_DOANHTHU, BA.SOBENHAN, dv.CHANDOAN        , a.TENDICHVU, nth.TENPHONGBAN as TENPHONGKHAM, nyc.TENPHONGBAN as TENKHOACHIDINH        , case when (dv.DONVIGIOITHIEU_ID is not null and dv.DONVIGIOITHIEU_ID != '') then ngt.TENBENHVIEN else @TenBenhVien end as TENBENHVIENCHIDINH        , case when (dv.BACSICHIDINH_ID is not null and dv.BACSICHIDINH_ID != '') then bscd.TENNHANVIEN else ngtt.TENNHANVIEN end as TENBACSICHIDINH          ,             0 as GUINGOAI, 0 as VTYT, 0 as CLSKETQUA_ID                   FROM TT_DVYEUCAU (NOLOCK) dv        inner join TT_TIEPNHAN (NOLOCK) tn on dv.TIEPNHAN_ID = tn.TIEPNHAN_ID        inner join TT_BENHNHAN (NOLOCK) bn on tn.BENHNHAN_ID = bn.BENHNHAN_ID        inner join TM_DICHVU A on A.DICHVU_ID = dv.DICHVU_ID        inner join TM_PHONGBAN nth on nth.PHONGBAN_ID = dv.NOITHUCHIEN_ID        left join TM_BENHVIEN ngt on ngt.BENHVIEN_STT_ID = dv.DONVIGIOITHIEU_ID        left join TM_NHANVIEN bscd on bscd.NHANVIEN_ID = dv.BACSICHIDINH_ID        left join TM_NHANVIEN ngtt on ngtt.NHANVIEN_ID = dv.NGUOIGIOITHIEU_ID        inner join TM_PHONGBAN nyc on nyc.PHONGBAN_ID = dv.NOIYEUCAU_ID        inner join TM_NHOMDICHVU B on B.NHOMDICHVU_ID = A.NHOMDICHVU_ID        inner join TT_VIENPHI (NOLOCK) VP on VP.TIEPNHAN_ID = tn.TIEPNHAN_ID and VP.DICHVU_ID = dv.DICHVU_ID and VP.REF_ID = dv.DVYEUCAU_ID        left join TT_NOITRU_BENHAN (NOLOCK) BA on BA.TIEPNHAN_ID = tn.TIEPNHAN_ID AND dv.BENHAN_ID = BA.BENHAN_ID        inner join TM_GENDER GD on GD.ID = bn.GIOITINH        left join TT_NGOAITRU_KHAMBENH (NOLOCK) kbnt on kbnt.KHAMBENH_ID = dv.KHAMBENH_NGOAITRU_ID                 where        dv.DICHVU_ID IS NOT NULL        and tn.BENHVIEN_ID = 'HLU01'        and HUYYEUCAU = 0        and dv.NGAYHENCLS is NULL                       and dv.TRANGTHAI = 'CHUAKETQUA'           and           dv.NGAYYEUCAU >= '10/29/2019 12:00:00 AM'         and           dv.NGAYYEUCAU <= '10/29/2019 12:00:00 AM'         and           dv.NOITHUCHIEN_ID = 79         and           (vp.DATHANHTOAN = '1'  or vp.DONGIA_DOANHTHU = '0' OR TN.SUDUNG_BHTN='1' OR TN.BAOLANH_VIENPHI='1'  OR tn.TRANGTHAI IN ('NOITRU','CAPCUU','NGOAITRU') or dv.HOPDONG_BENHNHAN_ID is not null or vp.BENHNHAN_PHAITHANHTOAN >= 0)         and           (CASE          WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU          WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2) END) in (02)         and           tn.TRANGTHAI IN ('DATIEPNHAN','NOITRU','CAPCUU','NGOAITRU', 'HOANTHANH')                 ) data1) lst                    where          lst.ROWNUMBER between 1 and 5                 order by NGAYGIOYEUCAU asc]
2019-10-29 17:13:38,225 [1] DEBUG - Statement Id: [DAO00019_DanhSachCDHA] PreparedStatement : [declare @TenBenhVien nvarchar(500)        declare @ManhomDSA varchar(10);        set @TenBenhVien = (select VALUE from TM_SYS_APPSETTINGS where CODE = 'APP_BENHVIEN_TEN')        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        select * from(        select ROW_NUMBER() OVER(order by NGAYGIOYEUCAU) as ROWNUMBER, *        from        (SELECT distinct        COUNT(*) OVER() as TOTALROWS,        N'Mã người bệnh: ' + bn.MAYTE + ' - ' + N'Tên người bệnh: ' + bn.TENBENHNHAN + ' - ' + N'Số bệnh án: ' + ISNULL(BA.SOBENHAN,'') + ' - ' + N'Sinh ngày: ' + isnull(Convert(varchar(10),bn.NGAYSINH,103),bn.NAMSINH) + ' - ' + N'Giới tính: ' + GD.DESCRIPTION as GROUPNAME,        bn.MAYTE, bn.TENBENHNHAN, bn.NAMSINH, bn.NGAYSINH as TUOI, ISNULL(CONVERT(VARCHAR(10), bn.NGAYSINH, 103),CAST(bn.NAMSINH AS varchar)) as NGAYSINH, bn.DIACHILIENLAC as DIACHI, bn.GIOITINH, GD.DESCRIPTION as TENGIOITINH,        tn.DOITUONG_ID, tn.THOIGIANTIEPNHAN, tn.BENHNHAN_ID, tn.TIEPNHAN_ID, tn.TRAITUYEN, tn.SOTIEPNHAN,        dv.DICHVU_ID, dv.NOITHUCHIEN_ID, isnull(dv.NGAYTAO, dv.NGAYCAPNHAT) as THOIGIANDKDICHVU,        dv.KHAN, dv.NOIYEUCAU_ID, dv.NGAYGIOYEUCAU, dv.BACSICHIDINH_ID, dv.DONVIGIOITHIEU_ID, dv.NGUOIGIOITHIEU_ID, dv.TRANGTHAI_WFL,        tn.NOIGIOITHIEU_ID, kbnt.HUONGGIAIQUYET_ID,        dv.DVYEUCAU_ID, dv.MARIS, dv.TRANGTHAI as TRANGTHAICODE, B.TENNHOMDICHVU, dv.SOPHIEUYEUCAU, dv.KHAMBENH_NGOAITRU_ID, dv.NGUOICAPNHAT_ID, dv.NGAYCAPNHAT,        CASE        WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU        WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2) END AS MANHOMDICHVU, B.MANHOMDICHVU as MANHOMDICHVUCHITIET, tn.TRANGTHAI as TRANGTHAI_TIEPNHAN,        'False' as DAKHAM,        vp.DATHANHTOAN, vp.DONGIA_DOANHTHU, BA.SOBENHAN, dv.CHANDOAN        , a.TENDICHVU, nth.TENPHONGBAN as TENPHONGKHAM, nyc.TENPHONGBAN as TENKHOACHIDINH        , case when (dv.DONVIGIOITHIEU_ID is not null and dv.DONVIGIOITHIEU_ID != '') then ngt.TENBENHVIEN else @TenBenhVien end as TENBENHVIENCHIDINH        , case when (dv.BACSICHIDINH_ID is not null and dv.BACSICHIDINH_ID != '') then bscd.TENNHANVIEN else ngtt.TENNHANVIEN end as TENBACSICHIDINH          ,             0 as GUINGOAI, 0 as VTYT, 0 as CLSKETQUA_ID                   FROM TT_DVYEUCAU (NOLOCK) dv        inner join TT_TIEPNHAN (NOLOCK) tn on dv.TIEPNHAN_ID = tn.TIEPNHAN_ID        inner join TT_BENHNHAN (NOLOCK) bn on tn.BENHNHAN_ID = bn.BENHNHAN_ID        inner join TM_DICHVU A on A.DICHVU_ID = dv.DICHVU_ID        inner join TM_PHONGBAN nth on nth.PHONGBAN_ID = dv.NOITHUCHIEN_ID        left join TM_BENHVIEN ngt on ngt.BENHVIEN_STT_ID = dv.DONVIGIOITHIEU_ID        left join TM_NHANVIEN bscd on bscd.NHANVIEN_ID = dv.BACSICHIDINH_ID        left join TM_NHANVIEN ngtt on ngtt.NHANVIEN_ID = dv.NGUOIGIOITHIEU_ID        inner join TM_PHONGBAN nyc on nyc.PHONGBAN_ID = dv.NOIYEUCAU_ID        inner join TM_NHOMDICHVU B on B.NHOMDICHVU_ID = A.NHOMDICHVU_ID        inner join TT_VIENPHI (NOLOCK) VP on VP.TIEPNHAN_ID = tn.TIEPNHAN_ID and VP.DICHVU_ID = dv.DICHVU_ID and VP.REF_ID = dv.DVYEUCAU_ID        left join TT_NOITRU_BENHAN (NOLOCK) BA on BA.TIEPNHAN_ID = tn.TIEPNHAN_ID AND dv.BENHAN_ID = BA.BENHAN_ID        inner join TM_GENDER GD on GD.ID = bn.GIOITINH        left join TT_NGOAITRU_KHAMBENH (NOLOCK) kbnt on kbnt.KHAMBENH_ID = dv.KHAMBENH_NGOAITRU_ID                 where        dv.DICHVU_ID IS NOT NULL        and tn.BENHVIEN_ID = 'HLU01'        and HUYYEUCAU = 0        and dv.NGAYHENCLS is NULL                       and dv.TRANGTHAI = 'CHUAKETQUA'           and           dv.NGAYYEUCAU >= '6/1/2019 12:00:00 AM'         and           dv.NGAYYEUCAU <= '10/29/2019 12:00:00 AM'         and           dv.NOITHUCHIEN_ID = 79         and           (vp.DATHANHTOAN = '1'  or vp.DONGIA_DOANHTHU = '0' OR TN.SUDUNG_BHTN='1' OR TN.BAOLANH_VIENPHI='1'  OR tn.TRANGTHAI IN ('NOITRU','CAPCUU','NGOAITRU') or dv.HOPDONG_BENHNHAN_ID is not null or vp.BENHNHAN_PHAITHANHTOAN >= 0)         and           (bn.TENBENHNHAN like '%' +  @param0  + '%' or bn.MAYTE like '%' +  @param0  + '%')         and           (CASE          WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU          WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2) END) in (02)         and           tn.TRANGTHAI IN ('DATIEPNHAN','NOITRU','CAPCUU','NGOAITRU', 'HOANTHANH')                 ) data1) lst                    where          lst.ROWNUMBER between 1 and 5                 order by NGAYGIOYEUCAU asc]
2019-10-29 17:13:38,226 [1] DEBUG - Statement Id: [DAO00019_DanhSachCDHA] Parameters: [@param0=[TENBENHNHAN,Côi]]
2019-10-29 17:13:38,226 [1] DEBUG - Statement Id: [DAO00019_DanhSachCDHA] Types: [@param0=[String, System.String]]
2019-10-29 17:13:39,814 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS31'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 17:13:39,893 [1] DEBUG - Statement Id: [DAO00019_DanhSachCDHA] PreparedStatement : [declare @TenBenhVien nvarchar(500)        declare @ManhomDSA varchar(10);        set @TenBenhVien = (select VALUE from TM_SYS_APPSETTINGS where CODE = 'APP_BENHVIEN_TEN')        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        select * from(        select ROW_NUMBER() OVER(order by NGAYGIOYEUCAU) as ROWNUMBER, *        from        (SELECT distinct        COUNT(*) OVER() as TOTALROWS,        N'Mã người bệnh: ' + bn.MAYTE + ' - ' + N'Tên người bệnh: ' + bn.TENBENHNHAN + ' - ' + N'Số bệnh án: ' + ISNULL(BA.SOBENHAN,'') + ' - ' + N'Sinh ngày: ' + isnull(Convert(varchar(10),bn.NGAYSINH,103),bn.NAMSINH) + ' - ' + N'Giới tính: ' + GD.DESCRIPTION as GROUPNAME,        bn.MAYTE, bn.TENBENHNHAN, bn.NAMSINH, bn.NGAYSINH as TUOI, ISNULL(CONVERT(VARCHAR(10), bn.NGAYSINH, 103),CAST(bn.NAMSINH AS varchar)) as NGAYSINH, bn.DIACHILIENLAC as DIACHI, bn.GIOITINH, GD.DESCRIPTION as TENGIOITINH,        tn.DOITUONG_ID, tn.THOIGIANTIEPNHAN, tn.BENHNHAN_ID, tn.TIEPNHAN_ID, tn.TRAITUYEN, tn.SOTIEPNHAN,        dv.DICHVU_ID, dv.NOITHUCHIEN_ID, isnull(dv.NGAYTAO, dv.NGAYCAPNHAT) as THOIGIANDKDICHVU,        dv.KHAN, dv.NOIYEUCAU_ID, dv.NGAYGIOYEUCAU, dv.BACSICHIDINH_ID, dv.DONVIGIOITHIEU_ID, dv.NGUOIGIOITHIEU_ID, dv.TRANGTHAI_WFL,        tn.NOIGIOITHIEU_ID, kbnt.HUONGGIAIQUYET_ID,        dv.DVYEUCAU_ID, dv.MARIS, dv.TRANGTHAI as TRANGTHAICODE, B.TENNHOMDICHVU, dv.SOPHIEUYEUCAU, dv.KHAMBENH_NGOAITRU_ID, dv.NGUOICAPNHAT_ID, dv.NGAYCAPNHAT,        CASE        WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU        WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2) END AS MANHOMDICHVU, B.MANHOMDICHVU as MANHOMDICHVUCHITIET, tn.TRANGTHAI as TRANGTHAI_TIEPNHAN,        'True' as DAKHAM,        vp.DATHANHTOAN, vp.DONGIA_DOANHTHU, BA.SOBENHAN, dv.CHANDOAN        , a.TENDICHVU, nth.TENPHONGBAN as TENPHONGKHAM, nyc.TENPHONGBAN as TENKHOACHIDINH        , case when (dv.DONVIGIOITHIEU_ID is not null and dv.DONVIGIOITHIEU_ID != '') then ngt.TENBENHVIEN else @TenBenhVien end as TENBENHVIENCHIDINH        , case when (dv.BACSICHIDINH_ID is not null and dv.BACSICHIDINH_ID != '') then bscd.TENNHANVIEN else ngtt.TENNHANVIEN end as TENBACSICHIDINH          ,             cls.CLSKETQUA_ID, cls.NGAYGIOTHUCHIEN , cls.THOIGIANKHOADULIEU, cls.NGUOIKHOA_ID, cls_vtyt.CLSKETQUA_ID as VTYT            , cls.GUINGOAI, cls.NOIGUIDEN_ID, dv.TENNGUOIKHOA                   FROM TT_DVYEUCAU (NOLOCK) dv        inner join TT_TIEPNHAN (NOLOCK) tn on dv.TIEPNHAN_ID = tn.TIEPNHAN_ID        inner join TT_BENHNHAN (NOLOCK) bn on tn.BENHNHAN_ID = bn.BENHNHAN_ID        inner join TM_DICHVU A on A.DICHVU_ID = dv.DICHVU_ID        inner join TM_PHONGBAN nth on nth.PHONGBAN_ID = dv.NOITHUCHIEN_ID        left join TM_BENHVIEN ngt on ngt.BENHVIEN_STT_ID = dv.DONVIGIOITHIEU_ID        left join TM_NHANVIEN bscd on bscd.NHANVIEN_ID = dv.BACSICHIDINH_ID        left join TM_NHANVIEN ngtt on ngtt.NHANVIEN_ID = dv.NGUOIGIOITHIEU_ID        inner join TM_PHONGBAN nyc on nyc.PHONGBAN_ID = dv.NOIYEUCAU_ID        inner join TM_NHOMDICHVU B on B.NHOMDICHVU_ID = A.NHOMDICHVU_ID        inner join TT_VIENPHI (NOLOCK) VP on VP.TIEPNHAN_ID = tn.TIEPNHAN_ID and VP.DICHVU_ID = dv.DICHVU_ID and VP.REF_ID = dv.DVYEUCAU_ID        left join TT_NOITRU_BENHAN (NOLOCK) BA on BA.TIEPNHAN_ID = tn.TIEPNHAN_ID AND dv.BENHAN_ID = BA.BENHAN_ID        inner join TM_GENDER GD on GD.ID = bn.GIOITINH        left join TT_NGOAITRU_KHAMBENH (NOLOCK) kbnt on kbnt.KHAMBENH_ID = dv.KHAMBENH_NGOAITRU_ID                       left join TT_CLSKETQUA (NOLOCK) cls on dv.DVYEUCAU_ID = cls.DVYEUCAU_ID            left join TT_CLSKETQUA_VTYT (NOLOCK) cls_vtyt on cls_vtyt.DVYEUCAU_ID = dv.DVYEUCAU_ID                   where        dv.DICHVU_ID IS NOT NULL        and tn.BENHVIEN_ID = 'HLU01'        and HUYYEUCAU = 0        and dv.NGAYHENCLS is NULL                       and dv.TRANGTHAI IN ('CHOXACNHAN','HOANTAT')           and           dv.NGAYYEUCAU >= '6/1/2019 12:00:00 AM'         and           dv.NGAYYEUCAU <= '10/29/2019 12:00:00 AM'         and           dv.NOITHUCHIEN_ID = 79         and           (vp.DATHANHTOAN = '1'  or vp.DONGIA_DOANHTHU = '0' OR TN.SUDUNG_BHTN='1' OR TN.BAOLANH_VIENPHI='1'  OR tn.TRANGTHAI IN ('NOITRU','CAPCUU','NGOAITRU') or dv.HOPDONG_BENHNHAN_ID is not null or vp.BENHNHAN_PHAITHANHTOAN >= 0)         and           (bn.TENBENHNHAN like '%' +  @param0  + '%' or bn.MAYTE like '%' +  @param0  + '%')         and           (CASE          WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU          WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2) END) in (02)                 ) data1) lst                    where          lst.ROWNUMBER between 1 and 5                 order by NGAYGIOYEUCAU asc]
2019-10-29 17:13:39,894 [1] DEBUG - Statement Id: [DAO00019_DanhSachCDHA] Parameters: [@param0=[TENBENHNHAN,Côi]]
2019-10-29 17:13:39,894 [1] DEBUG - Statement Id: [DAO00019_DanhSachCDHA] Types: [@param0=[String, System.String]]
2019-10-29 17:13:40,052 [1] DEBUG - Statement Id: [DAO00000_GetNhomDoiTuong] PreparedStatement : [SELECT DOITUONG_ID              ,[TENDOITUONG]              ,[NHOMDICHVU]              ,[TYLE_VUOT_LCB]              ,[GIOIHAN_VUOT_LCB]              ,[GIOIHAN_VUOT_DVKTC]              ,[TYLE_THUOC_UT]              ,[CPVC]              ,[CHIPHINGOAI_BHYT]              ,[NGANSACH_TL]              ,[MIENGIAM_TL]              ,[TAITRO_TL]              ,[BHTN_TL]              FROM [dbo].[TM_DOITUONG]]
2019-10-29 17:13:41,705 [1] DEBUG - Statement Id: [DAO00019_ThongTinBenhNhanDvYeuCau] PreparedStatement : [select distinct A.SOTIEPNHAN, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI, A.NGAYMIENDONGCHITRA,        B.*,  C.DICHVU_ID, C.DVYEUCAU_ID, C.NOITHUCHIEN_ID, A.SOBHYT        from TT_TIEPNHAN A        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'        where                    C.DVYEUCAU_ID = '205346'                 and A.BENHVIEN_ID = 'HLU01']
2019-10-29 17:13:42,013 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '26239'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2019-10-29 17:13:42,110 [1] DEBUG - Statement Id: [DAO00046_GETLISTDVYEUCAUINLISTDVID] PreparedStatement : [SELECT dvyc.*, clskqct.CLSKETQUA_ID, clskqct.DICHVU_ID as KETQUA_DICHVU_ID,        clskqct.CLSKETQUACHITIET_ID, clskqct.DONVITINH, clskqct.KETQUA, clskqct.KETQUA2,        clskqct.MUCBINHTHUONG, clskqct.MUCBINHTHUONGMIN, clskqct.MUCBINHTHUONGMAX, clskqct.BATTHUONG        FROM dbo.TT_CLSKETQUACHITIET as clskqct RIGHT OUTER JOIN        dbo.TT_DVYEUCAU as dvyc ON                 clskqct.DVYEUCAU_ID = dvyc.DVYEUCAU_ID        where dvyc.BENHVIEN_ID = 'HLU01'          and             exists (select DICHVU_ID from TM_DICHVU a join TM_NHOMDICHVU b on a.NHOMDICHVU_ID = b.NHOMDICHVU_ID            where dvyc.DICHVU_ID = DICHVU_ID and (left(MANHOMDICHVU,2) in ('02', '03') OR MANHOMDICHVU in ('02', '03')))           and             dvyc.TIEPNHAN_ID =  @param0                    order by DVYEUCAU_ID]
2019-10-29 17:13:42,110 [1] DEBUG - Statement Id: [DAO00046_GETLISTDVYEUCAUINLISTDVID] Parameters: [@param0=[TIEPNHAN_ID,26239]]
2019-10-29 17:13:42,110 [1] DEBUG - Statement Id: [DAO00046_GETLISTDVYEUCAUINLISTDVID] Types: [@param0=[Int64, System.Int64]]
2019-10-29 17:13:42,150 [1] DEBUG - Statement Id: [DAO00045_GetListDVYeuCau] PreparedStatement : [select *              from VIEW_DICHVU_NHOMDV              where BENHVIEN_ID = 'HLU01']
2019-10-29 17:13:42,828 [1] DEBUG - Statement Id: [DAO00018_GetList] PreparedStatement : [select A.*, B.DICTIONARY_NAME, B.DICTIONARY_CODE, B.DICTIONARY_NAME_EN CHUCDANH, (B.DICTIONARY_NAME_EN + '. ' + A.TENNHANVIEN) TENHOCVIHOCHAM            from TM_NHANVIEN A            left join (select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE = 'chucdanh' and DICTIONARY_NAME_EN is not null) B on A.CHUCDANH_ID = B.DICTIONARY_ID            where A.BENHVIEN_ID = '' and A.TAMNGUNG = '0']
2019-10-29 17:13:42,859 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '26239'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2019-10-29 17:13:45,715 [1] DEBUG - Statement Id: [DAO00116_GetListThietBiCLS] PreparedStatement : [SELECT THIETBI_ID, MATHIETBI, TENTHIETBI, NHOMTHIETBI_ID          FROM TM_THIETBI MP          where          TAMNGUNG = '0'          and BENHVIEN_ID = 'HLU01'           AND             PHONGBAN_ID = 79                     order by TENTHIETBI]
2019-10-29 17:13:46,630 [1] DEBUG - Statement Id: [DAO00037_GetCLSKetQua] PreparedStatement : [select *              from TT_CLSKETQUA               where                             TT_CLSKETQUA.DVYEUCAU_ID = '205346'                       and                           TT_CLSKETQUA.BENHVIEN_ID = 'HLU01'                                     order by CLSKETQUA_ID]
2019-10-29 17:13:46,769 [1] DEBUG - Statement Id: [DAO00020_GetDetailP] PreparedStatement : [select *        from TT_DVYEUCAU        where TT_DVYEUCAU.DVYEUCAU_ID  = 205346        order by DVYEUCAU_ID]
2019-10-29 17:13:46,926 [1] DEBUG - Statement Id: [DAO00017_GetNameByID] PreparedStatement : [select TENPHONGBAN              from [TM_PHONGBAN]              where PHONGBAN_ID = '18' and BENHVIEN_ID = 'HLU01']
2019-10-29 17:13:47,041 [1] DEBUG - Statement Id: [DAO00041_GetNameByID] PreparedStatement : [select TENDICHVU              from TM_DICHVU              where DICHVU_ID = '4144']
2019-10-29 17:13:47,763 [1] DEBUG - Statement Id: [DAO00038_GetList] PreparedStatement : [select *              from TT_CLSKETQUA_IMAGES               where                             TT_CLSKETQUA_IMAGES.CLSKETQUA_ID = '96455'                       and                           TT_CLSKETQUA_IMAGES.BENHVIEN_ID = 'HLU01'                                     order by IDX]
2019-10-29 17:13:47,802 [1] DEBUG - Statement Id: [DAO00222_GetList] PreparedStatement : [select *        from TT_CLSKETQUA_DOCUMENTS         where                 CLSKETQUA_ID = '96455'                     order by CLSKETQUA_DOCUMENTS_ID]
2019-10-29 17:13:47,830 [1] DEBUG - Statement Id: [DAO00116_File_GetList] PreparedStatement : [select *              from TT_FILE_DINHKEM               where                             TT_FILE_DINHKEM.REF_TABLE = 'TT_CLSKETQUA'                       and                           TT_FILE_DINHKEM.REF_ID = '96455'                       and                           TT_FILE_DINHKEM.BENHVIEN_ID = 'HLU01'                                     order by FILE_ID]
2019-10-29 17:13:47,910 [1] DEBUG - Statement Id: [DAO00087_GetServiceParams] PreparedStatement : [select CODE, VALUE              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01']
2019-10-29 17:13:47,943 [1] DEBUG - Statement Id: [DAO00042_GetList] PreparedStatement : [select *              from TM_TUDIENKETQUA              where BENHVIEN_ID = 'HLU01'                and                       TM_TUDIENKETQUA.DICHVU_ID = '4144'                    and                       (TM_TUDIENKETQUA.NGUOITAO_ID = '1' OR TM_TUDIENKETQUA.SUDUNGCHUNG = '1')                                 order by TM_TUDIENKETQUA.TENNOIDUNG]
2019-10-29 17:13:47,974 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '26239'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2019-10-29 17:13:49,218 [1] DEBUG - Statement Id: [DAO00037_GetCLSKetQua] PreparedStatement : [select *              from TT_CLSKETQUA               where                             TT_CLSKETQUA.DVYEUCAU_ID = '205346'                       and                           TT_CLSKETQUA.BENHVIEN_ID = 'HLU01'                                     order by CLSKETQUA_ID]
2019-10-29 17:13:49,306 [1] DEBUG - Statement Id: [DAO00020_GetDetailP] PreparedStatement : [select *        from TT_DVYEUCAU        where TT_DVYEUCAU.DVYEUCAU_ID  = 205346        order by DVYEUCAU_ID]
2019-10-29 17:13:49,396 [1] DEBUG - Statement Id: [DAO00017_GetNameByID] PreparedStatement : [select TENPHONGBAN              from [TM_PHONGBAN]              where PHONGBAN_ID = '18' and BENHVIEN_ID = 'HLU01']
2019-10-29 17:13:49,480 [1] DEBUG - Statement Id: [DAO00041_GetNameByID] PreparedStatement : [select TENDICHVU              from TM_DICHVU              where DICHVU_ID = '4144']
2019-10-29 17:13:49,565 [1] DEBUG - Statement Id: [DAO00038_GetList] PreparedStatement : [select *              from TT_CLSKETQUA_IMAGES               where                             TT_CLSKETQUA_IMAGES.CLSKETQUA_ID = '96455'                       and                           TT_CLSKETQUA_IMAGES.BENHVIEN_ID = 'HLU01'                                     order by IDX]
2019-10-29 17:13:49,602 [1] DEBUG - Statement Id: [DAO00222_GetList] PreparedStatement : [select *        from TT_CLSKETQUA_DOCUMENTS         where                 CLSKETQUA_ID = '96455'                     order by CLSKETQUA_DOCUMENTS_ID]
2019-10-29 17:13:49,634 [1] DEBUG - Statement Id: [DAO00116_File_GetList] PreparedStatement : [select *              from TT_FILE_DINHKEM               where                             TT_FILE_DINHKEM.REF_TABLE = 'TT_CLSKETQUA'                       and                           TT_FILE_DINHKEM.REF_ID = '96455'                       and                           TT_FILE_DINHKEM.BENHVIEN_ID = 'HLU01'                                     order by FILE_ID]
2019-10-29 17:13:49,673 [1] DEBUG - Statement Id: [DAO00042_GetList] PreparedStatement : [select *              from TM_TUDIENKETQUA              where BENHVIEN_ID = 'HLU01'                and                       TM_TUDIENKETQUA.DICHVU_ID = '4144'                    and                       (TM_TUDIENKETQUA.NGUOITAO_ID = '1' OR TM_TUDIENKETQUA.SUDUNGCHUNG = '1')                                 order by TM_TUDIENKETQUA.TENNOIDUNG]
2019-10-29 17:13:49,706 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '26239'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2019-10-29 17:14:08,128 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '26239'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2019-10-29 17:14:08,219 [1] DEBUG - Statement Id: [DAO00014_GetInPatientStatus] PreparedStatement : [select TRANGTHAI, isnull(KHOACHUYENDEN_ID, KHOAVAO_ID) as KHOAHIENTAI from TT_NOITRU_BENHAN        where        TIEPNHAN_ID = '26239'        and BENHVIEN_ID = 'HLU01'         and           BENHAN_ID = '5641']
2019-10-29 17:14:08,305 [1] DEBUG - Statement Id: [DAO00019_CheckStatusDichVu] PreparedStatement : [select a.* from TT_DVYEUCAU a join TT_CLSKETQUA b on a.DVYEUCAU_ID = b.DVYEUCAU_ID where a.DVYEUCAU_ID = '205346' and a.TIEPNHAN_ID = '26239'        and (a.TRANGTHAI = 'CHOXACNHAN' or a.TRANGTHAI = 'HOANTAT')]
2019-10-29 17:14:08,408 [1] DEBUG - Statement Id: [DAO00037_KiemTraTrangThaiYeuCau] PreparedStatement : [IF EXISTS (          select DVYEUCAU_ID          from TT_DVYEUCAU          where DVYEUCAU_ID = 205346          and BENHVIEN_ID = 'HLU01'          and HUYYEUCAU = 0          )          BEGIN          SELECT -1 AS RESULT          END          ELSE          BEGIN          SELECT 1 AS RESULT          END]
2019-10-29 17:14:08,524 [1] DEBUG - Statement Id: [DAO00037_Update] PreparedStatement : [update TT_CLSKETQUA set              NGAYTHUCHIEN =  @param0               , THOIGIANTHUCHIEN =  @param1               , NGAYGIOTHUCHIEN =  @param2               , GIOTHUCHIEN =  @param3               , NAMTHUCHIEN =  @param4               , THANGTHUCHIEN =  @param5               , NOITHUCHIEN_ID =  @param6               , BACSICHIDINH_ID =  @param7               , BACSICHIDINH =  @param8               , NGAYCHIDINH =  @param9               , BACSITHUCHIEN_ID =  @param10               , BACSIKETLUAN_ID =  @param11               , BACSIGMHS_ID =  @param12               , DIEUDUONG_ID =  @param13               , KYTHUATVIEN01_ID =  @param14               , KYTHUATVIEN02_ID =  @param15               , CHANDOANLAMSANG =  @param16               , DENGHI =  @param17               , SINHTHIET =  @param18               , CLOTEST =  @param19               , PHOTO =  @param20               , VIDEO =  @param21               , TIEMCANQUANG =  @param22               , PHANLOAIKETQUA_ID =  @param23               , THUCHIENBENNGOAI =  @param24               , BENHVIENTHUCHIEN_ID =  @param25               , TENBACSIBENNGOAI =  @param26               , KHOABENNGOAI_ID =  @param27               , GUINGOAI =  @param28               , NOIGUIDEN_ID =  @param29               , ICD_ID1 =  @param30               , ICD_ID2 =  @param31               , ICD_ID3 =  @param32               , DIUNGTHUOC =  @param33               , TIENME =  @param34               , DACBIET =  @param35               , KQCUOICUNG =  @param36               , THONGTINNHAN =  @param37               , KETLUANKSK =  @param38               , VUNGKHAOSAT =  @param39               , MOTA =  @param40               , MOTA_TEXT =  @param41               , KETLUAN =  @param42               , GHICHU =  @param43               , MAPHIM =  @param44               , GPB_AMSO =  @param45               , GPB_PHANLOAIKETQUA_ID =  @param46               , GPB_PHUONGPHAPLAYBENHPHAM_ID =  @param47               , GPB_SOMAU =  @param48               , GPB_SOLUONGMAU =  @param49               , GPB_TOPO_ID =  @param50               , GPB_TOPOREGIONS_ID =  @param51               , GPB_MORPHO_ID =  @param52               , GPB_ETIO_ID =  @param53               , GPB_DAITHE =  @param54               , GPB_VITHE =  @param55               , GPB_NHUOM_HE =  @param56               , GPB_NHUOM_PAS =  @param57               , GPB_NHUOM_TRI =  @param58               , GPB_NHUOM_AFB =  @param59               , GPB_NHUOM_GIEMSA =  @param60               , GPB_NHUOM_PAPANICOLAOU =  @param61               , GPB_NHUOM_RETICULINE =  @param62               , GPB_NHUOM_OTHER =  @param63               , GPB_HOAMIENDICH =  @param64               , GPB_HOAMIENDICHHUYNHQUANG =  @param65               , GPB_HOICHAN =  @param66               , GPB_MAUTHU =  @param67               , GPB_NOILAYMAUTHU =  @param68               , HLVIKHUAN1 =  @param69               , HLVIKHUAN2 =  @param70               , LOAIFILM_ID =  @param71               , SOPHIMSUDUNG =  @param72               , THIETBI_ID =  @param73               , SOTHUOCSUDUNG =  @param74               , KHOADULIEU =  @param75               , NGAYKHOADULIEU =  @param76               , THOIGIANKHOADULIEU =  @param77               , NGUOIKHOA_ID =  @param78               , MANGUOIKHOA =  @param79               , TENNGUOIKHOA =  @param80               , TRANGTHAI =  @param81               , MACH =  @param82               , HUYETAP =  @param83               , NHIPTHO =  @param84               , NHIETDO =  @param85               , CHIEUCAO =  @param86               , CANNANG =  @param87               , BSA =  @param88               , TINHTRANGDIENNAO =  @param89               , SOVAOVIEN =  @param90               , MAYTE =  @param91               , TENBENHNHAN =  @param92               , NAMSINH =  @param93               , GIOITINH =  @param94               , DIACHI =  @param95               , NOICHIDINH_ID =  @param96               , MAUTHU_ID =  @param97               , THOIGIANNHAN =  @param98               , MAU =  @param99               , LOAITHUOCCANQUANG_ID =  @param100               , MA =  @param101               , IDHINH =  @param102               , SOPHIMHU =  @param103               , LOAIPHIMHU_ID =  @param104               , DOSOI =  @param105               , DOSOI_ID =  @param106               , BANKINHSOI =  @param107               , SODT =  @param108               , KYTHUAT =  @param109               , KYTHUAT_TEXT =  @param110               , SOPHIMSUDUNG2 =  @param111               , LOAIFILM_ID2 =  @param112               , SOPHIMSUDUNG3 =  @param113               , LOAIFILM_ID3 =  @param114               , RESISTANCEMARKERS =  @param115                           , NGAYCAPNHAT =  @param116             , NGUOICAPNHAT_ID =  @param117             , SOLUONGONG =  @param118             , SOMLMAU =  @param119             , THOIGIANLAYMAU =  @param120             , THOIGIANNHANMAU =  @param121             , THOIGIANCDBENHPHAM =  @param122             , DUNGDICHCD_ID =  @param123             , SOONGTHUCNHAN =  @param124             , THUOCDADUNG =  @param125             , NGAYGANMAY =  @param126             , NGAYTHAOMAY =  @param127             , LOAIMAUBENHPHAM =  @param128             where            CLSKETQUA_ID = '96455']
2019-10-29 17:14:08,525 [1] DEBUG - Statement Id: [DAO00037_Update] Parameters: [@param0=[NGAYTHUCHIEN,10/28/2019 12:00:00 AM], @param1=[THOIGIANTHUCHIEN,10/28/2019 5:40:23 PM], @param2=[NGAYGIOTHUCHIEN,10/28/2019 5:40:23 PM], @param3=[GIOTHUCHIEN,0], @param4=[NAMTHUCHIEN,0], @param5=[THANGTHUCHIEN,0], @param6=[NOITHUCHIEN_ID,79], @param7=[BACSICHIDINH_ID,712], @param8=[BACSICHIDINH,Bùi Xuân Kiên], @param9=[NGAYCHIDINH,7/9/2019 11:13:00 AM], @param10=[BACSITHUCHIEN_ID,1], @param11=[BACSIKETLUAN_ID,373], @param12=[BACSIGMHS_ID,0], @param13=[DIEUDUONG_ID,0], @param14=[KYTHUATVIEN01_ID,null], @param15=[KYTHUATVIEN02_ID,null], @param16=[CHANDOANLAMSANG,Tắc ruột khác và không xác định(K56.6)], @param17=[DENGHI,], @param18=[SINHTHIET,0], @param19=[CLOTEST,0], @param20=[PHOTO,0], @param21=[VIDEO,0], @param22=[TIEMCANQUANG,0], @param23=[PHANLOAIKETQUA_ID,null], @param24=[THUCHIENBENNGOAI,0], @param25=[BENHVIENTHUCHIEN_ID,null], @param26=[TENBACSIBENNGOAI,null], @param27=[KHOABENNGOAI_ID,null], @param28=[GUINGOAI,0], @param29=[NOIGUIDEN_ID,null], @param30=[ICD_ID1,null], @param31=[ICD_ID2,null], @param32=[ICD_ID3,null], @param33=[DIUNGTHUOC,0], @param34=[TIENME,0], @param35=[DACBIET,0], @param36=[KQCUOICUNG,0], @param37=[THONGTINNHAN,], @param38=[KETLUANKSK,], @param39=[VUNGKHAOSAT,null], @param40=[MOTA,<body>
	<div style="text-align:left;text-indent:0pt;margin:0pt 0pt 0pt 0pt;"><span style="color:#000000;background-color:transparent;font-family:Times New Roman;font-size:12pt;font-weight:normal;font-style:normal;">test	</span></div></body>
], @param41=[MOTA_TEXT,null], @param42=[KETLUAN,test 2], @param43=[GHICHU,null], @param44=[MAPHIM,null], @param45=[GPB_AMSO,null], @param46=[GPB_PHANLOAIKETQUA_ID,null], @param47=[GPB_PHUONGPHAPLAYBENHPHAM_ID,null], @param48=[GPB_SOMAU,null], @param49=[GPB_SOLUONGMAU,null], @param50=[GPB_TOPO_ID,null], @param51=[GPB_TOPOREGIONS_ID,null], @param52=[GPB_MORPHO_ID,null], @param53=[GPB_ETIO_ID,null], @param54=[GPB_DAITHE,null], @param55=[GPB_VITHE,null], @param56=[GPB_NHUOM_HE,0], @param57=[GPB_NHUOM_PAS,0], @param58=[GPB_NHUOM_TRI,0], @param59=[GPB_NHUOM_AFB,0], @param60=[GPB_NHUOM_GIEMSA,0], @param61=[GPB_NHUOM_PAPANICOLAOU,null], @param62=[GPB_NHUOM_RETICULINE,null], @param63=[GPB_NHUOM_OTHER,0], @param64=[GPB_HOAMIENDICH,0], @param65=[GPB_HOAMIENDICHHUYNHQUANG,0], @param66=[GPB_HOICHAN,0], @param67=[GPB_MAUTHU,null], @param68=[GPB_NOILAYMAUTHU,null], @param69=[HLVIKHUAN1,null], @param70=[HLVIKHUAN2,null], @param71=[LOAIFILM_ID,null], @param72=[SOPHIMSUDUNG,null], @param73=[THIETBI_ID,8], @param74=[SOTHUOCSUDUNG,null], @param75=[KHOADULIEU,0], @param76=[NGAYKHOADULIEU,null], @param77=[THOIGIANKHOADULIEU,null], @param78=[NGUOIKHOA_ID,null], @param79=[MANGUOIKHOA,null], @param80=[TENNGUOIKHOA,null], @param81=[TRANGTHAI,CHOXACNHAN], @param82=[MACH,null], @param83=[HUYETAP,null], @param84=[NHIPTHO,null], @param85=[NHIETDO,null], @param86=[CHIEUCAO,null], @param87=[CANNANG,null], @param88=[BSA,null], @param89=[TINHTRANGDIENNAO,null], @param90=[SOVAOVIEN,null], @param91=[MAYTE,null], @param92=[TENBENHNHAN,null], @param93=[NAMSINH,null], @param94=[GIOITINH,0], @param95=[DIACHI,null], @param96=[NOICHIDINH_ID,18], @param97=[MAUTHU_ID,null], @param98=[THOIGIANNHAN,null], @param99=[MAU,null], @param100=[LOAITHUOCCANQUANG_ID,null], @param101=[MA,null], @param102=[IDHINH,null], @param103=[SOPHIMHU,null], @param104=[LOAIPHIMHU_ID,null], @param105=[DOSOI,null], @param106=[DOSOI_ID,null], @param107=[BANKINHSOI,null], @param108=[SODT,null], @param109=[KYTHUAT,], @param110=[KYTHUAT_TEXT,null], @param111=[SOPHIMSUDUNG2,null], @param112=[LOAIFILM_ID2,null], @param113=[SOPHIMSUDUNG3,null], @param114=[LOAIFILM_ID3,null], @param115=[RESISTANCEMARKERS,null], @param116=[NGAYCAPNHAT,10/29/2019 5:14:08 PM], @param117=[NGUOICAPNHAT_ID,1], @param118=[SOLUONGONG,null], @param119=[SOMLMAU,null], @param120=[THOIGIANLAYMAU,null], @param121=[THOIGIANNHANMAU,null], @param122=[THOIGIANCDBENHPHAM,null], @param123=[DUNGDICHCD_ID,null], @param124=[SOONGTHUCNHAN,null], @param125=[THUOCDADUNG,], @param126=[NGAYGANMAY,null], @param127=[NGAYTHAOMAY,null], @param128=[LOAIMAUBENHPHAM,null]]
2019-10-29 17:14:08,525 [1] DEBUG - Statement Id: [DAO00037_Update] Types: [@param0=[DateTime, System.DateTime], @param1=[DateTime, System.DateTime], @param2=[DateTime, System.DateTime], @param3=[Int64, System.Int64], @param4=[Int64, System.Int64], @param5=[Int64, System.Int64], @param6=[Int64, System.Int64], @param7=[Int64, System.Int64], @param8=[String, System.String], @param9=[DateTime, System.DateTime], @param10=[Int64, System.Int64], @param11=[Int64, System.Int64], @param12=[Int64, System.Int64], @param13=[Int64, System.Int64], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[String, System.String], @param17=[String, System.String], @param18=[String, System.String], @param19=[String, System.String], @param20=[String, System.String], @param21=[String, System.String], @param22=[String, System.String], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[String, System.String], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[String, System.String], @param34=[String, System.String], @param35=[String, System.String], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[System.DBNull, null], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[String, System.String], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[System.DBNull, null], @param50=[System.DBNull, null], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[String, System.String], @param57=[String, System.String], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[System.DBNull, null], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[String, System.String], @param65=[String, System.String], @param66=[String, System.String], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[System.DBNull, null], @param71=[System.DBNull, null], @param72=[System.DBNull, null], @param73=[Int64, System.Int64], @param74=[System.DBNull, null], @param75=[String, System.String], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null], @param81=[String, System.String], @param82=[System.DBNull, null], @param83=[System.DBNull, null], @param84=[System.DBNull, null], @param85=[System.DBNull, null], @param86=[System.DBNull, null], @param87=[System.DBNull, null], @param88=[System.DBNull, null], @param89=[System.DBNull, null], @param90=[System.DBNull, null], @param91=[System.DBNull, null], @param92=[System.DBNull, null], @param93=[System.DBNull, null], @param94=[String, System.String], @param95=[System.DBNull, null], @param96=[Int64, System.Int64], @param97=[System.DBNull, null], @param98=[System.DBNull, null], @param99=[System.DBNull, null], @param100=[System.DBNull, null], @param101=[System.DBNull, null], @param102=[System.DBNull, null], @param103=[System.DBNull, null], @param104=[System.DBNull, null], @param105=[System.DBNull, null], @param106=[System.DBNull, null], @param107=[System.DBNull, null], @param108=[System.DBNull, null], @param109=[String, System.String], @param110=[System.DBNull, null], @param111=[System.DBNull, null], @param112=[System.DBNull, null], @param113=[System.DBNull, null], @param114=[System.DBNull, null], @param115=[System.DBNull, null], @param116=[DateTime, System.DateTime], @param117=[Int64, System.Int64], @param118=[System.DBNull, null], @param119=[System.DBNull, null], @param120=[System.DBNull, null], @param121=[System.DBNull, null], @param122=[System.DBNull, null], @param123=[System.DBNull, null], @param124=[System.DBNull, null], @param125=[String, System.String], @param126=[System.DBNull, null], @param127=[System.DBNull, null], @param128=[System.DBNull, null]]
2019-10-29 17:14:08,655 [1] DEBUG - Statement Id: [DAO00020_KiemTraMaRIS] PreparedStatement : [select * from LST_KEYDATA        where KEYTYPE = 'RISID'        and KEYYEAR = '2019'        and KEYMONTH = '10'        and KEYDAY = '29'        and SEGMENT_1 = 'MR'        and KEYVALUE >= '']
2019-10-29 17:14:08,683 [1] DEBUG - Statement Id: [DAO00020_CapNhatMaRIS] PreparedStatement : [update LST_KEYDATA        set KEYVALUE = ''        where KEYTYPE = 'RISID'        and KEYYEAR = '2019'        and KEYMONTH = '10'        and KEYDAY = '29'        and SEGMENT_1 = 'MR']
2019-10-29 17:14:08,710 [1] DEBUG - Statement Id: [DAO00020_CapMaRIS] PreparedStatement : [update TT_DVYEUCAU set        MARIS =  @param0         , NGUOICAPNHAT_ID =  @param1         , NGAYCAPNHAT =  @param2         where        DVYEUCAU_ID = 205346]
2019-10-29 17:14:08,710 [1] DEBUG - Statement Id: [DAO00020_CapMaRIS] Parameters: [@param0=[MARIS,], @param1=[NGUOICAPNHAT_ID,1], @param2=[NGAYCAPNHAT,10/29/2019 5:14:08 PM]]
2019-10-29 17:14:08,710 [1] DEBUG - Statement Id: [DAO00020_CapMaRIS] Types: [@param0=[String, System.String], @param1=[Int64, System.Int64], @param2=[DateTime, System.DateTime]]
2019-10-29 17:14:08,741 [1] DEBUG - Statement Id: [DAO00116_File_Delete] PreparedStatement : [delete from TT_FILE_DINHKEM               where                             REF_TABLE = 'TT_CLSKETQUA'                       and                           REF_ID = '96455']
2019-10-29 17:14:08,770 [1] DEBUG - Statement Id: [DAO00305_GetClsKetQua] PreparedStatement : [select a.*, b.SOPHIEUYEUCAU from TT_CLSKETQUA a        left join TT_DVYEUCAU b on a.DVYEUCAU_ID = b.DVYEUCAU_ID where a.CLSKETQUA_ID = 96455]
2019-10-29 17:14:09,072 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '26239' and C.DICHVU_ID = '4144' and A.BENHVIEN_ID = 'HLU01'         and           C.DVYEUCAU_ID = '205346']
2019-10-29 17:14:09,481 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '26239']
2019-10-29 17:14:11,516 [1] DEBUG - Statement Id: [DAO00020_UpdateTrangThaiDVYeuCau] PreparedStatement : [update TT_DVYEUCAU set        TRANGTHAI =  @param0         , NGAYCAPNHAT =  @param1         , NGUOICAPNHAT_ID =  @param2         , KHOADULIEU =  @param3         , NGAYKHOADULIEU =  @param4         , THOIGIANKHOADULIEU =  @param5         , NGUOIKHOA_ID =  @param6         , MANGUOIKHOA =  @param7         , TENNGUOIKHOA =  @param8         where        DVYEUCAU_ID =  @param9           update TT_VIENPHI        set                 DATHUCHIEN =  @param10 ,        NGUOICAPNHAT_ID = '1',        NGAYCAPNHAT = '10/29/2019 5:14:11 PM'        where REF_ID = '205346'        and REF_TABLE = 'TT_DVYEUCAU'        and TIEPNHAN_ID = '26239']
2019-10-29 17:14:11,517 [1] DEBUG - Statement Id: [DAO00020_UpdateTrangThaiDVYeuCau] Parameters: [@param0=[TRANGTHAI,CHOXACNHAN], @param1=[NGAYCAPNHAT,10/29/2019 5:14:11 PM], @param2=[NGUOICAPNHAT_ID,1], @param3=[KHOADULIEU,null], @param4=[NGAYKHOADULIEU,null], @param5=[THOIGIANKHOADULIEU,null], @param6=[NGUOIKHOA_ID,null], @param7=[MANGUOIKHOA,null], @param8=[TENNGUOIKHOA,null], @param9=[DVYEUCAU_ID,205346], @param10=[DATHUCHIEN,1]]
2019-10-29 17:14:11,517 [1] DEBUG - Statement Id: [DAO00020_UpdateTrangThaiDVYeuCau] Types: [@param0=[String, System.String], @param1=[DateTime, System.DateTime], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[System.DBNull, null], @param5=[System.DBNull, null], @param6=[System.DBNull, null], @param7=[System.DBNull, null], @param8=[System.DBNull, null], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64]]
2019-10-29 17:14:11,593 [1] DEBUG - Statement Id: [DAO00023_UpdateTTDVYeuCauVienPhi] PreparedStatement : [update TT_VIENPHI        set                 DATHUCHIEN =  @param0 ,        NGUOICAPNHAT_ID = '1',        NGAYCAPNHAT = '10/29/2019 5:14:11 PM'        where REF_ID = '205346'        and REF_TABLE = 'TT_DVYEUCAU'        and TIEPNHAN_ID = '26239']
2019-10-29 17:14:11,593 [1] DEBUG - Statement Id: [DAO00023_UpdateTTDVYeuCauVienPhi] Parameters: [@param0=[DATHUCHIEN,1]]
2019-10-29 17:14:11,593 [1] DEBUG - Statement Id: [DAO00023_UpdateTTDVYeuCauVienPhi] Types: [@param0=[Int64, System.Int64]]
2019-10-29 17:14:40,174 [1] DEBUG - Statement Id: [DAO00019_ThongTinBenhNhanDvYeuCau] PreparedStatement : [select distinct A.SOTIEPNHAN, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI, A.NGAYMIENDONGCHITRA,        B.*,  C.DICHVU_ID, C.DVYEUCAU_ID, C.NOITHUCHIEN_ID, A.SOBHYT        from TT_TIEPNHAN A        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'        where                    C.DVYEUCAU_ID = '205346'                 and A.BENHVIEN_ID = 'HLU01']
2019-10-29 17:14:40,297 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '26239'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2019-10-29 17:14:40,392 [1] DEBUG - Statement Id: [DAO00046_GETLISTDVYEUCAUINLISTDVID] PreparedStatement : [SELECT dvyc.*, clskqct.CLSKETQUA_ID, clskqct.DICHVU_ID as KETQUA_DICHVU_ID,        clskqct.CLSKETQUACHITIET_ID, clskqct.DONVITINH, clskqct.KETQUA, clskqct.KETQUA2,        clskqct.MUCBINHTHUONG, clskqct.MUCBINHTHUONGMIN, clskqct.MUCBINHTHUONGMAX, clskqct.BATTHUONG        FROM dbo.TT_CLSKETQUACHITIET as clskqct RIGHT OUTER JOIN        dbo.TT_DVYEUCAU as dvyc ON                 clskqct.DVYEUCAU_ID = dvyc.DVYEUCAU_ID        where dvyc.BENHVIEN_ID = 'HLU01'          and             exists (select DICHVU_ID from TM_DICHVU a join TM_NHOMDICHVU b on a.NHOMDICHVU_ID = b.NHOMDICHVU_ID            where dvyc.DICHVU_ID = DICHVU_ID and (left(MANHOMDICHVU,2) in ('02', '03') OR MANHOMDICHVU in ('02', '03')))           and             dvyc.TIEPNHAN_ID =  @param0                    order by DVYEUCAU_ID]
2019-10-29 17:14:40,392 [1] DEBUG - Statement Id: [DAO00046_GETLISTDVYEUCAUINLISTDVID] Parameters: [@param0=[TIEPNHAN_ID,26239]]
2019-10-29 17:14:40,392 [1] DEBUG - Statement Id: [DAO00046_GETLISTDVYEUCAUINLISTDVID] Types: [@param0=[Int64, System.Int64]]
2019-10-29 17:14:40,432 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '26239'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2019-10-29 17:14:41,339 [1] DEBUG - Statement Id: [DAO00116_GetListThietBiCLS] PreparedStatement : [SELECT THIETBI_ID, MATHIETBI, TENTHIETBI, NHOMTHIETBI_ID          FROM TM_THIETBI MP          where          TAMNGUNG = '0'          and BENHVIEN_ID = 'HLU01'           AND             PHONGBAN_ID = 79                     order by TENTHIETBI]
2019-10-29 17:14:42,226 [1] DEBUG - Statement Id: [DAO00037_GetCLSKetQua] PreparedStatement : [select *              from TT_CLSKETQUA               where                             TT_CLSKETQUA.DVYEUCAU_ID = '205346'                       and                           TT_CLSKETQUA.BENHVIEN_ID = 'HLU01'                                     order by CLSKETQUA_ID]
2019-10-29 17:14:42,310 [1] DEBUG - Statement Id: [DAO00020_GetDetailP] PreparedStatement : [select *        from TT_DVYEUCAU        where TT_DVYEUCAU.DVYEUCAU_ID  = 205346        order by DVYEUCAU_ID]
2019-10-29 17:14:42,392 [1] DEBUG - Statement Id: [DAO00017_GetNameByID] PreparedStatement : [select TENPHONGBAN              from [TM_PHONGBAN]              where PHONGBAN_ID = '18' and BENHVIEN_ID = 'HLU01']
2019-10-29 17:14:42,475 [1] DEBUG - Statement Id: [DAO00041_GetNameByID] PreparedStatement : [select TENDICHVU              from TM_DICHVU              where DICHVU_ID = '4144']
2019-10-29 17:14:42,589 [1] DEBUG - Statement Id: [DAO00038_GetList] PreparedStatement : [select *              from TT_CLSKETQUA_IMAGES               where                             TT_CLSKETQUA_IMAGES.CLSKETQUA_ID = '96455'                       and                           TT_CLSKETQUA_IMAGES.BENHVIEN_ID = 'HLU01'                                     order by IDX]
2019-10-29 17:14:42,632 [1] DEBUG - Statement Id: [DAO00222_GetList] PreparedStatement : [select *        from TT_CLSKETQUA_DOCUMENTS         where                 CLSKETQUA_ID = '96455'                     order by CLSKETQUA_DOCUMENTS_ID]
2019-10-29 17:14:42,671 [1] DEBUG - Statement Id: [DAO00116_File_GetList] PreparedStatement : [select *              from TT_FILE_DINHKEM               where                             TT_FILE_DINHKEM.REF_TABLE = 'TT_CLSKETQUA'                       and                           TT_FILE_DINHKEM.REF_ID = '96455'                       and                           TT_FILE_DINHKEM.BENHVIEN_ID = 'HLU01'                                     order by FILE_ID]
2019-10-29 17:14:42,705 [1] DEBUG - Statement Id: [DAO00042_GetList] PreparedStatement : [select *              from TM_TUDIENKETQUA              where BENHVIEN_ID = 'HLU01'                and                       TM_TUDIENKETQUA.DICHVU_ID = '4144'                    and                       (TM_TUDIENKETQUA.NGUOITAO_ID = '1' OR TM_TUDIENKETQUA.SUDUNGCHUNG = '1')                                 order by TM_TUDIENKETQUA.TENNOIDUNG]
2019-10-29 17:14:42,736 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '26239'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2019-10-29 17:14:43,855 [1] DEBUG - Statement Id: [DAO00037_GetCLSKetQua] PreparedStatement : [select *              from TT_CLSKETQUA               where                             TT_CLSKETQUA.DVYEUCAU_ID = '205346'                       and                           TT_CLSKETQUA.BENHVIEN_ID = 'HLU01'                                     order by CLSKETQUA_ID]
2019-10-29 17:14:43,942 [1] DEBUG - Statement Id: [DAO00020_GetDetailP] PreparedStatement : [select *        from TT_DVYEUCAU        where TT_DVYEUCAU.DVYEUCAU_ID  = 205346        order by DVYEUCAU_ID]
2019-10-29 17:14:44,025 [1] DEBUG - Statement Id: [DAO00017_GetNameByID] PreparedStatement : [select TENPHONGBAN              from [TM_PHONGBAN]              where PHONGBAN_ID = '18' and BENHVIEN_ID = 'HLU01']
2019-10-29 17:14:44,106 [1] DEBUG - Statement Id: [DAO00041_GetNameByID] PreparedStatement : [select TENDICHVU              from TM_DICHVU              where DICHVU_ID = '4144']
2019-10-29 17:14:44,197 [1] DEBUG - Statement Id: [DAO00038_GetList] PreparedStatement : [select *              from TT_CLSKETQUA_IMAGES               where                             TT_CLSKETQUA_IMAGES.CLSKETQUA_ID = '96455'                       and                           TT_CLSKETQUA_IMAGES.BENHVIEN_ID = 'HLU01'                                     order by IDX]
2019-10-29 17:14:44,227 [1] DEBUG - Statement Id: [DAO00222_GetList] PreparedStatement : [select *        from TT_CLSKETQUA_DOCUMENTS         where                 CLSKETQUA_ID = '96455'                     order by CLSKETQUA_DOCUMENTS_ID]
2019-10-29 17:14:44,254 [1] DEBUG - Statement Id: [DAO00116_File_GetList] PreparedStatement : [select *              from TT_FILE_DINHKEM               where                             TT_FILE_DINHKEM.REF_TABLE = 'TT_CLSKETQUA'                       and                           TT_FILE_DINHKEM.REF_ID = '96455'                       and                           TT_FILE_DINHKEM.BENHVIEN_ID = 'HLU01'                                     order by FILE_ID]
2019-10-29 17:14:44,295 [1] DEBUG - Statement Id: [DAO00042_GetList] PreparedStatement : [select *              from TM_TUDIENKETQUA              where BENHVIEN_ID = 'HLU01'                and                       TM_TUDIENKETQUA.DICHVU_ID = '4144'                    and                       (TM_TUDIENKETQUA.NGUOITAO_ID = '1' OR TM_TUDIENKETQUA.SUDUNGCHUNG = '1')                                 order by TM_TUDIENKETQUA.TENNOIDUNG]
2019-10-29 17:14:44,345 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '26239'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2019-10-29 17:19:44,725 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'EIN02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 17:19:47,495 [1] DEBUG - Statement Id: [EIN00002_GetListHoaDonBenhVien] PreparedStatement : [select * from          (select distinct hd.HOADON_ID, hd.SOHOADON, hd.NGAYHOADON, httt.GIATRITHUCTHU, bn.TENBENHNHAN, bn.MAYTE, bn.DIACHILIENLAC DIACHI,        case when hdngt.HOADON_ID is not null then N'Ngoại trú/ nhà thuốc' else N'Nội trú' end LOAIHOADONTHU,        case when hdngt.HOADON_ID is not null then N'TT_HOADON_CHITIET_NGOAITRU' else N'TT_HOADON_CHITIET_NOITRU' end REF_TABLE,        nv.TENNHANVIEN, httt.TENHINHTHUCTHANHTOAN, 'BENHVIEN' THANHTOANTAI        from TT_HOADON hd        left join TT_HOADON_HINHTHUCTHANHTOAN httt on httt.HOADON_ID = hd.HOADON_ID        left join TT_BENHNHAN bn on bn.BENHNHAN_ID = hd.BENHNHAN_ID        left join TT_HOADON_CHITIET_NGOAITRU hdngt on hdngt.HOADON_ID = hd.HOADON_ID        left join TT_HOADON_CHITIET_NOITRU hdnt on hdnt.HOADON_ID = hd.HOADON_ID        left join TM_NHANVIEN nv on nv.NHANVIEN_ID = hd.NGUOITAO_ID        left join TT_INVOICE_HOADON vnpt on vnpt.HOADON_ID = hd.HOADON_ID        left join TT_INVOICE main on main.INVOICE_ID = vnpt.INVOICE_ID        where        (hd.TIEPNHAN_ID is not null or hd.BENHNHAN_ID is not null ) and hd.LOAIHOADON = 'BL'        and (vnpt.HOADON_ID is null)        and hd.DATHANHTOAN = '1' and hd.HUYHOADON = '0' and hd.HOANTRA = '0'                 union all        select distinct hd.HOADON_ID, hd.SOHOADON, hd.NGAYHOADON, httt.GIATRITHUCTHU, NM.TENNGUOIMUA TENBENHNHAN, ('VANGLAI' + cast(NM.NGOAITRU_TOATHUOC_NGUOIMUA_ID as varchar(10))) MAYTE, NM.DIACHI,        N'Vãng lai nhà thuốc' LOAIHOADONTHU,        N'TT_HOADON_CHITIET_NGOAITRU' REF_TABLE,        nv.TENNHANVIEN, httt.TENHINHTHUCTHANHTOAN, 'VANGLAI' THANHTOANTAI        from TT_HOADON hd        left join TT_HOADON_HINHTHUCTHANHTOAN httt on httt.HOADON_ID = hd.HOADON_ID        left join TT_HOADON_CHITIET_NGOAITRU hdngt on hdngt.HOADON_ID = hd.HOADON_ID        left join TT_DUOC_CHUNGTU_CHITIET ctct on ctct.CHUNGTUCHITIET_ID= hdngt.REF_ID        left join TT_DUOC_CHUNGTU ct on ct.CHUNGTU_ID = ctct.CHUNGTU_ID        left join TT_NGOAITRU_TOATHUOC_NGUOIMUA NM on NM.NGOAITRU_TOATHUOC_NGUOIMUA_ID = CT.NGOAITRU_TOATHUOC_NGUOIMUA_ID        left join TM_NHANVIEN nv on nv.NHANVIEN_ID = hd.NGUOITAO_ID        left join TT_INVOICE_HOADON vnpt on vnpt.HOADON_ID = hd.HOADON_ID        left join TT_INVOICE main on main.INVOICE_ID = vnpt.INVOICE_ID        where        hd.TIEPNHAN_ID is null and hd.BENHNHAN_ID is null  and hd.LOAIHOADON = 'BL'        and (vnpt.HOADON_ID is null)        and hd.DATHANHTOAN = '1' and hd.HUYHOADON = '0' and hd.HOANTRA = '0'                 ) ds        order by ds.TENBENHNHAN]
2019-10-29 17:20:13,078 [1] DEBUG - Statement Id: [EIN00002_GetListHoaDonBenhVien] PreparedStatement : [select * from          (select distinct hd.HOADON_ID, hd.SOHOADON, hd.NGAYHOADON, httt.GIATRITHUCTHU, bn.TENBENHNHAN, bn.MAYTE, bn.DIACHILIENLAC DIACHI,        case when hdngt.HOADON_ID is not null then N'Ngoại trú/ nhà thuốc' else N'Nội trú' end LOAIHOADONTHU,        case when hdngt.HOADON_ID is not null then N'TT_HOADON_CHITIET_NGOAITRU' else N'TT_HOADON_CHITIET_NOITRU' end REF_TABLE,        nv.TENNHANVIEN, httt.TENHINHTHUCTHANHTOAN, 'BENHVIEN' THANHTOANTAI        from TT_HOADON hd        left join TT_HOADON_HINHTHUCTHANHTOAN httt on httt.HOADON_ID = hd.HOADON_ID        left join TT_BENHNHAN bn on bn.BENHNHAN_ID = hd.BENHNHAN_ID        left join TT_HOADON_CHITIET_NGOAITRU hdngt on hdngt.HOADON_ID = hd.HOADON_ID        left join TT_HOADON_CHITIET_NOITRU hdnt on hdnt.HOADON_ID = hd.HOADON_ID        left join TM_NHANVIEN nv on nv.NHANVIEN_ID = hd.NGUOITAO_ID        left join TT_INVOICE_HOADON vnpt on vnpt.HOADON_ID = hd.HOADON_ID        left join TT_INVOICE main on main.INVOICE_ID = vnpt.INVOICE_ID        where        (hd.TIEPNHAN_ID is not null or hd.BENHNHAN_ID is not null ) and hd.LOAIHOADON = 'BL'        and (vnpt.HOADON_ID is null)        and hd.DATHANHTOAN = '1' and hd.HUYHOADON = '0' and hd.HOANTRA = '0'         and           convert(date, hd.NGAYHOADON) >= convert(date, '6/1/2019 12:00:00 AM')         and           convert(date, hd.NGAYHOADON) <= convert(date, '10/29/2019 12:00:00 AM')                 union all        select distinct hd.HOADON_ID, hd.SOHOADON, hd.NGAYHOADON, httt.GIATRITHUCTHU, NM.TENNGUOIMUA TENBENHNHAN, ('VANGLAI' + cast(NM.NGOAITRU_TOATHUOC_NGUOIMUA_ID as varchar(10))) MAYTE, NM.DIACHI,        N'Vãng lai nhà thuốc' LOAIHOADONTHU,        N'TT_HOADON_CHITIET_NGOAITRU' REF_TABLE,        nv.TENNHANVIEN, httt.TENHINHTHUCTHANHTOAN, 'VANGLAI' THANHTOANTAI        from TT_HOADON hd        left join TT_HOADON_HINHTHUCTHANHTOAN httt on httt.HOADON_ID = hd.HOADON_ID        left join TT_HOADON_CHITIET_NGOAITRU hdngt on hdngt.HOADON_ID = hd.HOADON_ID        left join TT_DUOC_CHUNGTU_CHITIET ctct on ctct.CHUNGTUCHITIET_ID= hdngt.REF_ID        left join TT_DUOC_CHUNGTU ct on ct.CHUNGTU_ID = ctct.CHUNGTU_ID        left join TT_NGOAITRU_TOATHUOC_NGUOIMUA NM on NM.NGOAITRU_TOATHUOC_NGUOIMUA_ID = CT.NGOAITRU_TOATHUOC_NGUOIMUA_ID        left join TM_NHANVIEN nv on nv.NHANVIEN_ID = hd.NGUOITAO_ID        left join TT_INVOICE_HOADON vnpt on vnpt.HOADON_ID = hd.HOADON_ID        left join TT_INVOICE main on main.INVOICE_ID = vnpt.INVOICE_ID        where        hd.TIEPNHAN_ID is null and hd.BENHNHAN_ID is null  and hd.LOAIHOADON = 'BL'        and (vnpt.HOADON_ID is null)        and hd.DATHANHTOAN = '1' and hd.HUYHOADON = '0' and hd.HOANTRA = '0'         and           convert(date, hd.NGAYHOADON) >= convert(date, '6/1/2019 12:00:00 AM')         and           convert(date, hd.NGAYHOADON) <= convert(date, '10/29/2019 12:00:00 AM')                 ) ds        order by ds.TENBENHNHAN]
2019-10-29 17:20:17,933 [1] DEBUG - Statement Id: [EIN00002_GetChiTietHoaDon] PreparedStatement : [select distinct hdct.*, hdct.GIATRI_BENHNHAN_DATHANHTOAN AMOUNT, hdct.SOLUONG PRODQUANTITY,        isnull(dv.TENDICHVU, dc.TENDUOCDAYDU) PRODNAME        from TT_HOADON_CHITIET_NGOAITRU hdct        left join TM_DICHVU dv on dv.DICHVU_ID = hdct.DICHVU_ID and hdct.DUOC_ID is null        left join TM_DUOC dc on dc.DUOC_ID = hdct.DUOC_ID and hdct.DICHVU_ID is null        where HOADON_ID = 43061]
2019-10-29 17:20:19,376 [1] DEBUG - Statement Id: [EIN00002_GetChiTietHoaDon] PreparedStatement : [select distinct hdct.*, hdct.GIATRI_BENHNHAN_DATHANHTOAN AMOUNT, hdct.SOLUONG PRODQUANTITY,        isnull(dv.TENDICHVU, dc.TENDUOCDAYDU) PRODNAME        from TT_HOADON_CHITIET_NGOAITRU hdct        left join TM_DICHVU dv on dv.DICHVU_ID = hdct.DICHVU_ID and hdct.DUOC_ID is null        left join TM_DUOC dc on dc.DUOC_ID = hdct.DUOC_ID and hdct.DICHVU_ID is null        where HOADON_ID = 43695]
2019-10-29 17:20:21,414 [1] DEBUG - Statement Id: [EIN00002_GetChiTietHoaDon] PreparedStatement : [select distinct hdct.*, hdct.GIATRI_BENHNHAN_DATHANHTOAN AMOUNT, hdct.SOLUONG PRODQUANTITY,        isnull(dv.TENDICHVU, dc.TENDUOCDAYDU) PRODNAME        from TT_HOADON_CHITIET_NGOAITRU hdct        left join TM_DICHVU dv on dv.DICHVU_ID = hdct.DICHVU_ID and hdct.DUOC_ID is null        left join TM_DUOC dc on dc.DUOC_ID = hdct.DUOC_ID and hdct.DICHVU_ID is null        where HOADON_ID = 42663]
2019-10-29 17:20:22,697 [1] DEBUG - Statement Id: [EIN00002_GetChiTietHoaDon] PreparedStatement : [select distinct hdct.*, hdct.GIATRI_BENHNHAN_DATHANHTOAN AMOUNT, hdct.SOLUONG PRODQUANTITY,        isnull(dv.TENDICHVU, dc.TENDUOCDAYDU) PRODNAME        from TT_HOADON_CHITIET_NGOAITRU hdct        left join TM_DICHVU dv on dv.DICHVU_ID = hdct.DICHVU_ID and hdct.DUOC_ID is null        left join TM_DUOC dc on dc.DUOC_ID = hdct.DUOC_ID and hdct.DICHVU_ID is null        where HOADON_ID = 42104]
2019-10-29 17:20:48,084 [1] DEBUG - Statement Id: [EIN00002_GetChiTietHoaDon] PreparedStatement : [select distinct hdct.*, hdct.GIATRI_BENHNHAN_DATHANHTOAN AMOUNT, hdct.SOLUONG PRODQUANTITY,        isnull(dv.TENDICHVU, dc.TENDUOCDAYDU) PRODNAME        from TT_HOADON_CHITIET_NGOAITRU hdct        left join TM_DICHVU dv on dv.DICHVU_ID = hdct.DICHVU_ID and hdct.DUOC_ID is null        left join TM_DUOC dc on dc.DUOC_ID = hdct.DUOC_ID and hdct.DICHVU_ID is null        where HOADON_ID = 43061]
2019-10-29 17:20:51,565 [1] DEBUG - Statement Id: [EIN00002_CheckHoadondaxuat] PreparedStatement : [select B.*        from TT_INVOICE A        left join TT_INVOICE_HOADON B on A.INVOICE_ID = B.INVOICE_ID        where B.HOADON_ID = 43061 and A.HUY = '0']
2019-10-29 17:21:53,709 [1] DEBUG - Statement Id: [EIN00002_GetChiTietHoaDon] PreparedStatement : [select distinct hdct.*, hdct.GIATRI_BENHNHAN_DATHANHTOAN AMOUNT, hdct.SOLUONG PRODQUANTITY,        isnull(dv.TENDICHVU, dc.TENDUOCDAYDU) PRODNAME        from TT_HOADON_CHITIET_NGOAITRU hdct        left join TM_DICHVU dv on dv.DICHVU_ID = hdct.DICHVU_ID and hdct.DUOC_ID is null        left join TM_DUOC dc on dc.DUOC_ID = hdct.DUOC_ID and hdct.DICHVU_ID is null        where HOADON_ID = 43695]
2019-10-29 17:21:56,431 [1] DEBUG - Statement Id: [EIN00002_CheckHoadondaxuat] PreparedStatement : [select B.*        from TT_INVOICE A        left join TT_INVOICE_HOADON B on A.INVOICE_ID = B.INVOICE_ID        where B.HOADON_ID = 43695 and A.HUY = '0']
2019-10-29 17:22:10,396 [1] DEBUG - Statement Id: [EIN00002_GetChiTietHoaDon] PreparedStatement : [select distinct hdct.*, hdct.GIATRI_BENHNHAN_DATHANHTOAN AMOUNT, hdct.SOLUONG PRODQUANTITY,        isnull(dv.TENDICHVU, dc.TENDUOCDAYDU) PRODNAME        from TT_HOADON_CHITIET_NGOAITRU hdct        left join TM_DICHVU dv on dv.DICHVU_ID = hdct.DICHVU_ID and hdct.DUOC_ID is null        left join TM_DUOC dc on dc.DUOC_ID = hdct.DUOC_ID and hdct.DICHVU_ID is null        where HOADON_ID = 42663]
2019-10-29 17:22:13,835 [1] DEBUG - Statement Id: [EIN00002_CheckHoadondaxuat] PreparedStatement : [select B.*        from TT_INVOICE A        left join TT_INVOICE_HOADON B on A.INVOICE_ID = B.INVOICE_ID        where B.HOADON_ID = 42663 and A.HUY = '0']
2019-10-29 17:22:21,057 [1] DEBUG - Statement Id: [EIN00002_GetChiTietHoaDon] PreparedStatement : [select distinct hdct.*, hdct.GIATRI_BENHNHAN_DATHANHTOAN AMOUNT, hdct.SOLUONG PRODQUANTITY,        isnull(dv.TENDICHVU, dc.TENDUOCDAYDU) PRODNAME        from TT_HOADON_CHITIET_NGOAITRU hdct        left join TM_DICHVU dv on dv.DICHVU_ID = hdct.DICHVU_ID and hdct.DUOC_ID is null        left join TM_DUOC dc on dc.DUOC_ID = hdct.DUOC_ID and hdct.DICHVU_ID is null        where HOADON_ID = 42104]
2019-10-29 17:22:21,086 [1] DEBUG - Statement Id: [EIN00002_CheckHoadondaxuat] PreparedStatement : [select B.*        from TT_INVOICE A        left join TT_INVOICE_HOADON B on A.INVOICE_ID = B.INVOICE_ID        where B.HOADON_ID = 42104 and A.HUY = '0']
--------------------------------------------------------------------------------
2019-10-29 17:25:09,569 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2019-10-29 17:25:10,167 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-10-29 17:25:10,530 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-10-29 17:25:11,556 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 17:25:11,985 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-10-29 17:25:48,805 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2019-10-29 17:25:48,843 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-10-29 17:25:52,562 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-10-29 17:25:52,747 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-10-29 17:25:53,790 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2019-10-29 17:25:54,065 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2019-10-29 17:25:54,138 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2019-10-29 17:25:54,246 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2019-10-29 17:25:54,331 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2019-10-29 17:25:54,427 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2019-10-29 17:25:54,518 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2019-10-29 17:25:54,604 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2019-10-29 17:25:54,714 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2019-10-29 17:25:55,263 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2019-10-29 17:25:55,297 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2019-10-29 17:25:55,374 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2019-10-29 17:25:55,406 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2019-10-29 17:25:56,297 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2019-10-29 17:25:56,343 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @NGUONDUOC_MACDINH varchar(5) = '0';        declare @TOAMUANGOAI int = 0;        select @NGUONDUOC_MACDINH = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'PHA_NGUONDUOC'        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + @NGUONDUOC_MACDINH as DUOC_KEY, 0 as PHAMVI_ID, @NGUONDUOC_MACDINH as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end        else        begin                  select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2019-10-29 17:25:59,051 [5] DEBUG - Statement Id: [DAO00320_GetList] PreparedStatement : [select M.*            from TM_MAU M            LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID            where            M.TAMNGUNG = '0'            and M.BENHVIEN_ID = 'HLU01'            order by M.TENMAU]
2019-10-29 17:25:59,234 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2019-10-29 17:25:59,267 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,        SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH        FROM TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID        WHERE TK.SOLUONG > 0        GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2019-10-29 17:25:59,341 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2019-10-29 17:25:59,373 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,        TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,        TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH        from TM_MAU M        JOIN        (        select        A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO        from        (        select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO        from TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'        where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0        ) A        )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2019-10-29 17:25:59,438 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2019-10-29 17:26:00,372 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 17:26:02,248 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2019-10-29 17:26:08,844 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2019-10-29 17:26:08,890 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2019-10-29 17:26:09,083 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 17:26:09,276 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 17:26:09,543 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2019-10-29 17:26:09,546 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-10-29 17:26:09,548 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-10-29 17:26:09,580 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2019-10-29 17:26:09,580 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-10-29 17:26:09,580 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-10-29 17:26:09,756 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 17:26:09,965 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 17:26:19,809 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 17:26:19,917 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2019-10-29 17:26:20,232 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2019-10-29 17:26:36,287 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'EIN02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-10-29 17:26:37,456 [1] DEBUG - Statement Id: [EIN00002_GetListHoaDonBenhVien] PreparedStatement : [select * from          (select distinct hd.HOADON_ID, hd.SOHOADON, hd.NGAYHOADON, httt.GIATRITHUCTHU, bn.TENBENHNHAN, bn.MAYTE, bn.DIACHILIENLAC DIACHI,        case when hdngt.HOADON_ID is not null then N'Ngoại trú/ nhà thuốc' else N'Nội trú' end LOAIHOADONTHU,        case when hdngt.HOADON_ID is not null then N'TT_HOADON_CHITIET_NGOAITRU' else N'TT_HOADON_CHITIET_NOITRU' end REF_TABLE,        nv.TENNHANVIEN, httt.TENHINHTHUCTHANHTOAN, 'BENHVIEN' THANHTOANTAI        from TT_HOADON hd        left join TT_HOADON_HINHTHUCTHANHTOAN httt on httt.HOADON_ID = hd.HOADON_ID        left join TT_BENHNHAN bn on bn.BENHNHAN_ID = hd.BENHNHAN_ID        left join TT_HOADON_CHITIET_NGOAITRU hdngt on hdngt.HOADON_ID = hd.HOADON_ID        left join TT_HOADON_CHITIET_NOITRU hdnt on hdnt.HOADON_ID = hd.HOADON_ID        left join TM_NHANVIEN nv on nv.NHANVIEN_ID = hd.NGUOITAO_ID        left join TT_INVOICE_HOADON vnpt on vnpt.HOADON_ID = hd.HOADON_ID        left join TT_INVOICE main on main.INVOICE_ID = vnpt.INVOICE_ID        where        (hd.TIEPNHAN_ID is not null or hd.BENHNHAN_ID is not null ) and hd.LOAIHOADON = 'BL'        and (vnpt.HOADON_ID is null)        and hd.DATHANHTOAN = '1' and hd.HUYHOADON = '0' and hd.HOANTRA = '0'                 union all        select distinct hd.HOADON_ID, hd.SOHOADON, hd.NGAYHOADON, httt.GIATRITHUCTHU, NM.TENNGUOIMUA TENBENHNHAN, ('VANGLAI' + cast(NM.NGOAITRU_TOATHUOC_NGUOIMUA_ID as varchar(10))) MAYTE, NM.DIACHI,        N'Vãng lai nhà thuốc' LOAIHOADONTHU,        N'TT_HOADON_CHITIET_NGOAITRU' REF_TABLE,        nv.TENNHANVIEN, httt.TENHINHTHUCTHANHTOAN, 'VANGLAI' THANHTOANTAI        from TT_HOADON hd        left join TT_HOADON_HINHTHUCTHANHTOAN httt on httt.HOADON_ID = hd.HOADON_ID        left join TT_HOADON_CHITIET_NGOAITRU hdngt on hdngt.HOADON_ID = hd.HOADON_ID        left join TT_DUOC_CHUNGTU_CHITIET ctct on ctct.CHUNGTUCHITIET_ID= hdngt.REF_ID        left join TT_DUOC_CHUNGTU ct on ct.CHUNGTU_ID = ctct.CHUNGTU_ID        left join TT_NGOAITRU_TOATHUOC_NGUOIMUA NM on NM.NGOAITRU_TOATHUOC_NGUOIMUA_ID = CT.NGOAITRU_TOATHUOC_NGUOIMUA_ID        left join TM_NHANVIEN nv on nv.NHANVIEN_ID = hd.NGUOITAO_ID        left join TT_INVOICE_HOADON vnpt on vnpt.HOADON_ID = hd.HOADON_ID        left join TT_INVOICE main on main.INVOICE_ID = vnpt.INVOICE_ID        where        hd.TIEPNHAN_ID is null and hd.BENHNHAN_ID is null  and hd.LOAIHOADON = 'BL'        and (vnpt.HOADON_ID is null)        and hd.DATHANHTOAN = '1' and hd.HUYHOADON = '0' and hd.HOANTRA = '0'                 ) ds        order by ds.TENBENHNHAN]
2019-10-29 17:26:52,327 [1] DEBUG - Statement Id: [EIN00002_GetListHoaDonBenhVien] PreparedStatement : [select * from          (select distinct hd.HOADON_ID, hd.SOHOADON, hd.NGAYHOADON, httt.GIATRITHUCTHU, bn.TENBENHNHAN, bn.MAYTE, bn.DIACHILIENLAC DIACHI,        case when hdngt.HOADON_ID is not null then N'Ngoại trú/ nhà thuốc' else N'Nội trú' end LOAIHOADONTHU,        case when hdngt.HOADON_ID is not null then N'TT_HOADON_CHITIET_NGOAITRU' else N'TT_HOADON_CHITIET_NOITRU' end REF_TABLE,        nv.TENNHANVIEN, httt.TENHINHTHUCTHANHTOAN, 'BENHVIEN' THANHTOANTAI        from TT_HOADON hd        left join TT_HOADON_HINHTHUCTHANHTOAN httt on httt.HOADON_ID = hd.HOADON_ID        left join TT_BENHNHAN bn on bn.BENHNHAN_ID = hd.BENHNHAN_ID        left join TT_HOADON_CHITIET_NGOAITRU hdngt on hdngt.HOADON_ID = hd.HOADON_ID        left join TT_HOADON_CHITIET_NOITRU hdnt on hdnt.HOADON_ID = hd.HOADON_ID        left join TM_NHANVIEN nv on nv.NHANVIEN_ID = hd.NGUOITAO_ID        left join TT_INVOICE_HOADON vnpt on vnpt.HOADON_ID = hd.HOADON_ID        left join TT_INVOICE main on main.INVOICE_ID = vnpt.INVOICE_ID        where        (hd.TIEPNHAN_ID is not null or hd.BENHNHAN_ID is not null ) and hd.LOAIHOADON = 'BL'        and (vnpt.HOADON_ID is null)        and hd.DATHANHTOAN = '1' and hd.HUYHOADON = '0' and hd.HOANTRA = '0'         and           convert(date, hd.NGAYHOADON) >= convert(date, '6/1/2019 12:00:00 AM')         and           convert(date, hd.NGAYHOADON) <= convert(date, '10/29/2019 12:00:00 AM')                 union all        select distinct hd.HOADON_ID, hd.SOHOADON, hd.NGAYHOADON, httt.GIATRITHUCTHU, NM.TENNGUOIMUA TENBENHNHAN, ('VANGLAI' + cast(NM.NGOAITRU_TOATHUOC_NGUOIMUA_ID as varchar(10))) MAYTE, NM.DIACHI,        N'Vãng lai nhà thuốc' LOAIHOADONTHU,        N'TT_HOADON_CHITIET_NGOAITRU' REF_TABLE,        nv.TENNHANVIEN, httt.TENHINHTHUCTHANHTOAN, 'VANGLAI' THANHTOANTAI        from TT_HOADON hd        left join TT_HOADON_HINHTHUCTHANHTOAN httt on httt.HOADON_ID = hd.HOADON_ID        left join TT_HOADON_CHITIET_NGOAITRU hdngt on hdngt.HOADON_ID = hd.HOADON_ID        left join TT_DUOC_CHUNGTU_CHITIET ctct on ctct.CHUNGTUCHITIET_ID= hdngt.REF_ID        left join TT_DUOC_CHUNGTU ct on ct.CHUNGTU_ID = ctct.CHUNGTU_ID        left join TT_NGOAITRU_TOATHUOC_NGUOIMUA NM on NM.NGOAITRU_TOATHUOC_NGUOIMUA_ID = CT.NGOAITRU_TOATHUOC_NGUOIMUA_ID        left join TM_NHANVIEN nv on nv.NHANVIEN_ID = hd.NGUOITAO_ID        left join TT_INVOICE_HOADON vnpt on vnpt.HOADON_ID = hd.HOADON_ID        left join TT_INVOICE main on main.INVOICE_ID = vnpt.INVOICE_ID        where        hd.TIEPNHAN_ID is null and hd.BENHNHAN_ID is null  and hd.LOAIHOADON = 'BL'        and (vnpt.HOADON_ID is null)        and hd.DATHANHTOAN = '1' and hd.HUYHOADON = '0' and hd.HOANTRA = '0'         and           convert(date, hd.NGAYHOADON) >= convert(date, '6/1/2019 12:00:00 AM')         and           convert(date, hd.NGAYHOADON) <= convert(date, '10/29/2019 12:00:00 AM')                 ) ds        order by ds.TENBENHNHAN]
2019-10-29 17:26:59,146 [1] DEBUG - Statement Id: [EIN00002_GetChiTietHoaDon] PreparedStatement : [select distinct hdct.*, hdct.GIATRI_BENHNHAN_DATHANHTOAN AMOUNT, hdct.SOLUONG PRODQUANTITY,        isnull(dv.TENDICHVU, dc.TENDUOCDAYDU) PRODNAME        from TT_HOADON_CHITIET_NGOAITRU hdct        left join TM_DICHVU dv on dv.DICHVU_ID = hdct.DICHVU_ID and hdct.DUOC_ID is null        left join TM_DUOC dc on dc.DUOC_ID = hdct.DUOC_ID and hdct.DICHVU_ID is null        where HOADON_ID = 43061]
2019-10-29 17:27:03,298 [1] DEBUG - Statement Id: [EIN00002_GetChiTietHoaDon] PreparedStatement : [select distinct hdct.*, hdct.GIATRI_BENHNHAN_DATHANHTOAN AMOUNT, hdct.SOLUONG PRODQUANTITY,        isnull(dv.TENDICHVU, dc.TENDUOCDAYDU) PRODNAME        from TT_HOADON_CHITIET_NGOAITRU hdct        left join TM_DICHVU dv on dv.DICHVU_ID = hdct.DICHVU_ID and hdct.DUOC_ID is null        left join TM_DUOC dc on dc.DUOC_ID = hdct.DUOC_ID and hdct.DICHVU_ID is null        where HOADON_ID = 43695]
2019-10-29 17:27:15,190 [1] DEBUG - Statement Id: [EIN00002_GetChiTietHoaDon] PreparedStatement : [select distinct hdct.*, hdct.GIATRI_BENHNHAN_DATHANHTOAN AMOUNT, hdct.SOLUONG PRODQUANTITY,        isnull(dv.TENDICHVU, dc.TENDUOCDAYDU) PRODNAME        from TT_HOADON_CHITIET_NGOAITRU hdct        left join TM_DICHVU dv on dv.DICHVU_ID = hdct.DICHVU_ID and hdct.DUOC_ID is null        left join TM_DUOC dc on dc.DUOC_ID = hdct.DUOC_ID and hdct.DICHVU_ID is null        where HOADON_ID = 43061]
2019-10-29 17:27:15,225 [1] DEBUG - Statement Id: [EIN00002_CheckHoadondaxuat] PreparedStatement : [select B.*        from TT_INVOICE A        left join TT_INVOICE_HOADON B on A.INVOICE_ID = B.INVOICE_ID        where B.HOADON_ID = 43061 and A.HUY = '0']
2019-10-29 17:27:29,229 [1] DEBUG - Statement Id: [DAO00087_GetServiceParams] PreparedStatement : [select CODE, VALUE              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01']
2019-10-29 17:27:37,430 [1] DEBUG - Statement Id: [EIN00002_INVOICE_Json] PreparedStatement : [declare @json nvarchar(max);        declare @jsonHODON_ID nvarchar(max);        set @json = N'[{"HOADONCHITIET_ID":83303,"HOADON_ID":43061,"VIENPHI_ID":660812,"REF_ID":201219,"REF_TABLE":"TT_DVYEUCAU","DICHVU_ID":4523,"DUOC_ID":null,"LOAI_CHIPHI":"TT","LOAIGIA_ID":3,"SOLUONG":1,"DONGIA_DOANHTHU":45000.0,"THANHTIEN_DOANHTHU":45000.0,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":45000.0,"GIATRI_HOADON":45000.0,"GIATRI_HOADON_DATHANHTOAN":45000.0,"GIATRI_BIENLAI":45000.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":45000.0,"TYLE_THATTHU":null,"GIATRI_THATTHU":0.0,"MIENGIAM_TL":0.0,"MIENGIAM_GIATRI":0.0,"NGANSACH_TL":0.0,"NGANSACH_GIATRI":0.0,"TAITRO_TL":0.0,"TAITRO_GIATRI":0.0,"BHTN_GIATRI":null,"NOIDUNGTHU":null,"CHUNGTUXUATBN_ID":null,"TYLEVAT":null,"GIATRIVAT":null,"MASOTHUE":null,"SOCHUNGTUKETOAN":null,"DAHOANTRA":"0","TRANGTHAI":"DATHUCHIEN","PHONGBAN_ID":null,"PHONGBAN_THAYDOI_ID":null,"CONGTYCHITRA_GIATRI":0.0,"HOIVIEN_GIATRI":0.0,"BENHVIEN_ID":"HLU01","NGAYTAO":"2019-06-03T10:00:35.557","NGUOITAO_ID":700,"NGAYCAPNHAT":"2019-06-03T10:00:35.557","NGUOICAPNHAT_ID":700,"AMOUNT":45000.0,"PRODQUANTITY":1,"PRODNAME":"Tổng phân tích tế bào máu ngoại vi (bằng máy đếm tổng trở)"},{"HOADONCHITIET_ID":83304,"HOADON_ID":43061,"VIENPHI_ID":660813,"REF_ID":201220,"REF_TABLE":"TT_DVYEUCAU","DICHVU_ID":4641,"DUOC_ID":null,"LOAI_CHIPHI":"TT","LOAIGIA_ID":3,"SOLUONG":1,"DONGIA_DOANHTHU":30000.0,"THANHTIEN_DOANHTHU":30000.0,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":30000.0,"GIATRI_HOADON":30000.0,"GIATRI_HOADON_DATHANHTOAN":30000.0,"GIATRI_BIENLAI":30000.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":30000.0,"TYLE_THATTHU":null,"GIATRI_THATTHU":0.0,"MIENGIAM_TL":0.0,"MIENGIAM_GIATRI":0.0,"NGANSACH_TL":0.0,"NGANSACH_GIATRI":0.0,"TAITRO_TL":0.0,"TAITRO_GIATRI":0.0,"BHTN_GIATRI":null,"NOIDUNGTHU":null,"CHUNGTUXUATBN_ID":null,"TYLEVAT":null,"GIATRIVAT":null,"MASOTHUE":null,"SOCHUNGTUKETOAN":null,"DAHOANTRA":"0","TRANGTHAI":"DATHUCHIEN","PHONGBAN_ID":null,"PHONGBAN_THAYDOI_ID":null,"CONGTYCHITRA_GIATRI":0.0,"HOIVIEN_GIATRI":0.0,"BENHVIEN_ID":"HLU01","NGAYTAO":"2019-06-03T10:00:35.557","NGUOITAO_ID":700,"NGAYCAPNHAT":"2019-06-03T10:00:35.557","NGUOICAPNHAT_ID":700,"AMOUNT":30000.0,"PRODQUANTITY":1,"PRODNAME":"Đo hoạt độ ALT (GPT) [Máu]"},{"HOADONCHITIET_ID":83305,"HOADON_ID":43061,"VIENPHI_ID":660814,"REF_ID":201221,"REF_TABLE":"TT_DVYEUCAU","DICHVU_ID":4642,"DUOC_ID":null,"LOAI_CHIPHI":"TT","LOAIGIA_ID":3,"SOLUONG":1,"DONGIA_DOANHTHU":30000.0,"THANHTIEN_DOANHTHU":30000.0,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":30000.0,"GIATRI_HOADON":30000.0,"GIATRI_HOADON_DATHANHTOAN":30000.0,"GIATRI_BIENLAI":30000.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":30000.0,"TYLE_THATTHU":null,"GIATRI_THATTHU":0.0,"MIENGIAM_TL":0.0,"MIENGIAM_GIATRI":0.0,"NGANSACH_TL":0.0,"NGANSACH_GIATRI":0.0,"TAITRO_TL":0.0,"TAITRO_GIATRI":0.0,"BHTN_GIATRI":null,"NOIDUNGTHU":null,"CHUNGTUXUATBN_ID":null,"TYLEVAT":null,"GIATRIVAT":null,"MASOTHUE":null,"SOCHUNGTUKETOAN":null,"DAHOANTRA":"0","TRANGTHAI":"DATHUCHIEN","PHONGBAN_ID":null,"PHONGBAN_THAYDOI_ID":null,"CONGTYCHITRA_GIATRI":0.0,"HOIVIEN_GIATRI":0.0,"BENHVIEN_ID":"HLU01","NGAYTAO":"2019-06-03T10:00:35.557","NGUOITAO_ID":700,"NGAYCAPNHAT":"2019-06-03T10:00:35.557","NGUOICAPNHAT_ID":700,"AMOUNT":30000.0,"PRODQUANTITY":1,"PRODNAME":"Đo hoạt độ AST (GOT) [Máu]"},{"HOADONCHITIET_ID":83306,"HOADON_ID":43061,"VIENPHI_ID":660815,"REF_ID":201222,"REF_TABLE":"TT_DVYEUCAU","DICHVU_ID":4668,"DUOC_ID":null,"LOAI_CHIPHI":"TT","LOAIGIA_ID":3,"SOLUONG":1,"DONGIA_DOANHTHU":40000.0,"THANHTIEN_DOANHTHU":40000.0,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":40000.0,"GIATRI_HOADON":40000.0,"GIATRI_HOADON_DATHANHTOAN":40000.0,"GIATRI_BIENLAI":40000.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":40000.0,"TYLE_THATTHU":null,"GIATRI_THATTHU":0.0,"MIENGIAM_TL":0.0,"MIENGIAM_GIATRI":0.0,"NGANSACH_TL":0.0,"NGANSACH_GIATRI":0.0,"TAITRO_TL":0.0,"TAITRO_GIATRI":0.0,"BHTN_GIATRI":null,"NOIDUNGTHU":null,"CHUNGTUXUATBN_ID":null,"TYLEVAT":null,"GIATRIVAT":null,"MASOTHUE":null,"SOCHUNGTUKETOAN":null,"DAHOANTRA":"0","TRANGTHAI":"DATHUCHIEN","PHONGBAN_ID":null,"PHONGBAN_THAYDOI_ID":null,"CONGTYCHITRA_GIATRI":0.0,"HOIVIEN_GIATRI":0.0,"BENHVIEN_ID":"HLU01","NGAYTAO":"2019-06-03T10:00:35.557","NGUOITAO_ID":700,"NGAYCAPNHAT":"2019-06-03T10:00:35.557","NGUOICAPNHAT_ID":700,"AMOUNT":40000.0,"PRODQUANTITY":1,"PRODNAME":"Định lượng Creatinin (máu)"},{"HOADONCHITIET_ID":83307,"HOADON_ID":43061,"VIENPHI_ID":660816,"REF_ID":201223,"REF_TABLE":"TT_DVYEUCAU","DICHVU_ID":4681,"DUOC_ID":null,"LOAI_CHIPHI":"TT","LOAIGIA_ID":3,"SOLUONG":1,"DONGIA_DOANHTHU":40000.0,"THANHTIEN_DOANHTHU":40000.0,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":40000.0,"GIATRI_HOADON":40000.0,"GIATRI_HOADON_DATHANHTOAN":40000.0,"GIATRI_BIENLAI":40000.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":40000.0,"TYLE_THATTHU":null,"GIATRI_THATTHU":0.0,"MIENGIAM_TL":0.0,"MIENGIAM_GIATRI":0.0,"NGANSACH_TL":0.0,"NGANSACH_GIATRI":0.0,"TAITRO_TL":0.0,"TAITRO_GIATRI":0.0,"BHTN_GIATRI":null,"NOIDUNGTHU":null,"CHUNGTUXUATBN_ID":null,"TYLEVAT":null,"GIATRIVAT":null,"MASOTHUE":null,"SOCHUNGTUKETOAN":null,"DAHOANTRA":"0","TRANGTHAI":"DATHUCHIEN","PHONGBAN_ID":null,"PHONGBAN_THAYDOI_ID":null,"CONGTYCHITRA_GIATRI":0.0,"HOIVIEN_GIATRI":0.0,"BENHVIEN_ID":"HLU01","NGAYTAO":"2019-06-03T10:00:35.557","NGUOITAO_ID":700,"NGAYCAPNHAT":"2019-06-03T10:00:35.557","NGUOICAPNHAT_ID":700,"AMOUNT":40000.0,"PRODQUANTITY":1,"PRODNAME":"Định lượng Glucose [Máu]"},{"HOADONCHITIET_ID":83308,"HOADON_ID":43061,"VIENPHI_ID":660817,"REF_ID":201224,"REF_TABLE":"TT_DVYEUCAU","DICHVU_ID":4722,"DUOC_ID":null,"LOAI_CHIPHI":"TT","LOAIGIA_ID":3,"SOLUONG":1,"DONGIA_DOANHTHU":40000.0,"THANHTIEN_DOANHTHU":40000.0,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":40000.0,"GIATRI_HOADON":40000.0,"GIATRI_HOADON_DATHANHTOAN":40000.0,"GIATRI_BIENLAI":40000.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":40000.0,"TYLE_THATTHU":null,"GIATRI_THATTHU":0.0,"MIENGIAM_TL":0.0,"MIENGIAM_GIATRI":0.0,"NGANSACH_TL":0.0,"NGANSACH_GIATRI":0.0,"TAITRO_TL":0.0,"TAITRO_GIATRI":0.0,"BHTN_GIATRI":null,"NOIDUNGTHU":null,"CHUNGTUXUATBN_ID":null,"TYLEVAT":null,"GIATRIVAT":null,"MASOTHUE":null,"SOCHUNGTUKETOAN":null,"DAHOANTRA":"0","TRANGTHAI":"DATHUCHIEN","PHONGBAN_ID":null,"PHONGBAN_THAYDOI_ID":null,"CONGTYCHITRA_GIATRI":0.0,"HOIVIEN_GIATRI":0.0,"BENHVIEN_ID":"HLU01","NGAYTAO":"2019-06-03T10:00:35.557","NGUOITAO_ID":700,"NGAYCAPNHAT":"2019-06-03T10:00:35.557","NGUOICAPNHAT_ID":700,"AMOUNT":40000.0,"PRODQUANTITY":1,"PRODNAME":"Định lượng Urê máu [Máu]"},{"HOADONCHITIET_ID":83309,"HOADON_ID":43061,"VIENPHI_ID":660818,"REF_ID":201225,"REF_TABLE":"TT_DVYEUCAU","DICHVU_ID":4683,"DUOC_ID":null,"LOAI_CHIPHI":"TT","LOAIGIA_ID":3,"SOLUONG":1,"DONGIA_DOANHTHU":40000.0,"THANHTIEN_DOANHTHU":40000.0,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":40000.0,"GIATRI_HOADON":40000.0,"GIATRI_HOADON_DATHANHTOAN":40000.0,"GIATRI_BIENLAI":40000.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":40000.0,"TYLE_THATTHU":null,"GIATRI_THATTHU":0.0,"MIENGIAM_TL":0.0,"MIENGIAM_GIATRI":0.0,"NGANSACH_TL":0.0,"NGANSACH_GIATRI":0.0,"TAITRO_TL":0.0,"TAITRO_GIATRI":0.0,"BHTN_GIATRI":null,"NOIDUNGTHU":null,"CHUNGTUXUATBN_ID":null,"TYLEVAT":null,"GIATRIVAT":null,"MASOTHUE":null,"SOCHUNGTUKETOAN":null,"DAHOANTRA":"0","TRANGTHAI":"DATHUCHIEN","PHONGBAN_ID":null,"PHONGBAN_THAYDOI_ID":null,"CONGTYCHITRA_GIATRI":0.0,"HOIVIEN_GIATRI":0.0,"BENHVIEN_ID":"HLU01","NGAYTAO":"2019-06-03T10:00:35.56","NGUOITAO_ID":700,"NGAYCAPNHAT":"2019-06-03T10:00:35.56","NGUOICAPNHAT_ID":700,"AMOUNT":40000.0,"PRODQUANTITY":1,"PRODNAME":"Đo hoạt độ GGT (Gama Glutamyl Transferase) [Máu]"},{"HOADONCHITIET_ID":83310,"HOADON_ID":43061,"VIENPHI_ID":660819,"REF_ID":201226,"REF_TABLE":"TT_DVYEUCAU","DICHVU_ID":4660,"DUOC_ID":null,"LOAI_CHIPHI":"TT","LOAIGIA_ID":3,"SOLUONG":1,"DONGIA_DOANHTHU":40000.0,"THANHTIEN_DOANHTHU":40000.0,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":40000.0,"GIATRI_HOADON":40000.0,"GIATRI_HOADON_DATHANHTOAN":40000.0,"GIATRI_BIENLAI":40000.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":40000.0,"TYLE_THATTHU":null,"GIATRI_THATTHU":0.0,"MIENGIAM_TL":0.0,"MIENGIAM_GIATRI":0.0,"NGANSACH_TL":0.0,"NGANSACH_GIATRI":0.0,"TAITRO_TL":0.0,"TAITRO_GIATRI":0.0,"BHTN_GIATRI":null,"NOIDUNGTHU":null,"CHUNGTUXUATBN_ID":null,"TYLEVAT":null,"GIATRIVAT":null,"MASOTHUE":null,"SOCHUNGTUKETOAN":null,"DAHOANTRA":"0","TRANGTHAI":"DATHUCHIEN","PHONGBAN_ID":null,"PHONGBAN_THAYDOI_ID":null,"CONGTYCHITRA_GIATRI":0.0,"HOIVIEN_GIATRI":0.0,"BENHVIEN_ID":"HLU01","NGAYTAO":"2019-06-03T10:00:35.56","NGUOITAO_ID":700,"NGAYCAPNHAT":"2019-06-03T10:00:35.56","NGUOICAPNHAT_ID":700,"AMOUNT":40000.0,"PRODQUANTITY":1,"PRODNAME":"Định lượng Cholesterol toàn phần (máu)"},{"HOADONCHITIET_ID":83311,"HOADON_ID":43061,"VIENPHI_ID":660820,"REF_ID":201227,"REF_TABLE":"TT_DVYEUCAU","DICHVU_ID":4717,"DUOC_ID":null,"LOAI_CHIPHI":"TT","LOAIGIA_ID":3,"SOLUONG":1,"DONGIA_DOANHTHU":40000.0,"THANHTIEN_DOANHTHU":40000.0,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":40000.0,"GIATRI_HOADON":40000.0,"GIATRI_HOADON_DATHANHTOAN":40000.0,"GIATRI_BIENLAI":40000.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":40000.0,"TYLE_THATTHU":null,"GIATRI_THATTHU":0.0,"MIENGIAM_TL":0.0,"MIENGIAM_GIATRI":0.0,"NGANSACH_TL":0.0,"NGANSACH_GIATRI":0.0,"TAITRO_TL":0.0,"TAITRO_GIATRI":0.0,"BHTN_GIATRI":null,"NOIDUNGTHU":null,"CHUNGTUXUATBN_ID":null,"TYLEVAT":null,"GIATRIVAT":null,"MASOTHUE":null,"SOCHUNGTUKETOAN":null,"DAHOANTRA":"0","TRANGTHAI":"DATHUCHIEN","PHONGBAN_ID":null,"PHONGBAN_THAYDOI_ID":null,"CONGTYCHITRA_GIATRI":0.0,"HOIVIEN_GIATRI":0.0,"BENHVIEN_ID":"HLU01","NGAYTAO":"2019-06-03T10:00:35.56","NGUOITAO_ID":700,"NGAYCAPNHAT":"2019-06-03T10:00:35.56","NGUOICAPNHAT_ID":700,"AMOUNT":40000.0,"PRODQUANTITY":1,"PRODNAME":"Định lượng Triglycerid (máu) [Máu]"},{"HOADONCHITIET_ID":83312,"HOADON_ID":43061,"VIENPHI_ID":660821,"REF_ID":201228,"REF_TABLE":"TT_DVYEUCAU","DICHVU_ID":4017,"DUOC_ID":null,"LOAI_CHIPHI":"TT","LOAIGIA_ID":3,"SOLUONG":1,"DONGIA_DOANHTHU":50000.0,"THANHTIEN_DOANHTHU":50000.0,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":50000.0,"GIATRI_HOADON":50000.0,"GIATRI_HOADON_DATHANHTOAN":50000.0,"GIATRI_BIENLAI":50000.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":50000.0,"TYLE_THATTHU":null,"GIATRI_THATTHU":0.0,"MIENGIAM_TL":0.0,"MIENGIAM_GIATRI":0.0,"NGANSACH_TL":0.0,"NGANSACH_GIATRI":0.0,"TAITRO_TL":0.0,"TAITRO_GIATRI":0.0,"BHTN_GIATRI":null,"NOIDUNGTHU":null,"CHUNGTUXUATBN_ID":null,"TYLEVAT":null,"GIATRIVAT":null,"MASOTHUE":null,"SOCHUNGTUKETOAN":null,"DAHOANTRA":"0","TRANGTHAI":"DATHUCHIEN","PHONGBAN_ID":null,"PHONGBAN_THAYDOI_ID":null,"CONGTYCHITRA_GIATRI":0.0,"HOIVIEN_GIATRI":0.0,"BENHVIEN_ID":"HLU01","NGAYTAO":"2019-06-03T10:00:35.56","NGUOITAO_ID":700,"NGAYCAPNHAT":"2019-06-03T10:00:35.56","NGUOICAPNHAT_ID":700,"AMOUNT":50000.0,"PRODQUANTITY":1,"PRODNAME":"Siêu âm ổ bụng (gan mật, tụy, lách, thận, bàng quang)"},{"HOADONCHITIET_ID":83313,"HOADON_ID":43061,"VIENPHI_ID":660822,"REF_ID":201229,"REF_TABLE":"TT_DVYEUCAU","DICHVU_ID":4129,"DUOC_ID":null,"LOAI_CHIPHI":"TT","LOAIGIA_ID":3,"SOLUONG":1,"DONGIA_DOANHTHU":70000.0,"THANHTIEN_DOANHTHU":70000.0,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":70000.0,"GIATRI_HOADON":70000.0,"GIATRI_HOADON_DATHANHTOAN":70000.0,"GIATRI_BIENLAI":70000.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":70000.0,"TYLE_THATTHU":null,"GIATRI_THATTHU":0.0,"MIENGIAM_TL":0.0,"MIENGIAM_GIATRI":0.0,"NGANSACH_TL":0.0,"NGANSACH_GIATRI":0.0,"TAITRO_TL":0.0,"TAITRO_GIATRI":0.0,"BHTN_GIATRI":null,"NOIDUNGTHU":null,"CHUNGTUXUATBN_ID":null,"TYLEVAT":null,"GIATRIVAT":null,"MASOTHUE":null,"SOCHUNGTUKETOAN":null,"DAHOANTRA":"0","TRANGTHAI":"DATHUCHIEN","PHONGBAN_ID":null,"PHONGBAN_THAYDOI_ID":null,"CONGTYCHITRA_GIATRI":0.0,"HOIVIEN_GIATRI":0.0,"BENHVIEN_ID":"HLU01","NGAYTAO":"2019-06-03T10:00:35.56","NGUOITAO_ID":700,"NGAYCAPNHAT":"2019-06-03T10:00:35.56","NGUOICAPNHAT_ID":700,"AMOUNT":70000.0,"PRODQUANTITY":1,"PRODNAME":"Chụp Xquang ngực thẳng - số hóa 1 phim"},{"HOADONCHITIET_ID":83314,"HOADON_ID":43061,"VIENPHI_ID":660823,"REF_ID":201230,"REF_TABLE":"TT_DVYEUCAU","DICHVU_ID":4832,"DUOC_ID":null,"LOAI_CHIPHI":"TT","LOAIGIA_ID":3,"SOLUONG":1,"DONGIA_DOANHTHU":70000.0,"THANHTIEN_DOANHTHU":70000.0,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":70000.0,"GIATRI_HOADON":70000.0,"GIATRI_HOADON_DATHANHTOAN":70000.0,"GIATRI_BIENLAI":70000.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":70000.0,"TYLE_THATTHU":null,"GIATRI_THATTHU":0.0,"MIENGIAM_TL":0.0,"MIENGIAM_GIATRI":0.0,"NGANSACH_TL":0.0,"NGANSACH_GIATRI":0.0,"TAITRO_TL":0.0,"TAITRO_GIATRI":0.0,"BHTN_GIATRI":null,"NOIDUNGTHU":null,"CHUNGTUXUATBN_ID":null,"TYLEVAT":null,"GIATRIVAT":null,"MASOTHUE":null,"SOCHUNGTUKETOAN":null,"DAHOANTRA":"0","TRANGTHAI":"DATHUCHIEN","PHONGBAN_ID":null,"PHONGBAN_THAYDOI_ID":null,"CONGTYCHITRA_GIATRI":0.0,"HOIVIEN_GIATRI":0.0,"BENHVIEN_ID":"HLU01","NGAYTAO":"2019-06-03T10:00:35.56","NGUOITAO_ID":700,"NGAYCAPNHAT":"2019-06-03T10:00:35.56","NGUOICAPNHAT_ID":700,"AMOUNT":70000.0,"PRODQUANTITY":1,"PRODNAME":"HBsAg test nhanh"},{"HOADONCHITIET_ID":83315,"HOADON_ID":43061,"VIENPHI_ID":660824,"REF_ID":201231,"REF_TABLE":"TT_DVYEUCAU","DICHVU_ID":4852,"DUOC_ID":null,"LOAI_CHIPHI":"TT","LOAIGIA_ID":3,"SOLUONG":1,"DONGIA_DOANHTHU":80000.0,"THANHTIEN_DOANHTHU":80000.0,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":80000.0,"GIATRI_HOADON":80000.0,"GIATRI_HOADON_DATHANHTOAN":80000.0,"GIATRI_BIENLAI":80000.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":80000.0,"TYLE_THATTHU":null,"GIATRI_THATTHU":0.0,"MIENGIAM_TL":0.0,"MIENGIAM_GIATRI":0.0,"NGANSACH_TL":0.0,"NGANSACH_GIATRI":0.0,"TAITRO_TL":0.0,"TAITRO_GIATRI":0.0,"BHTN_GIATRI":null,"NOIDUNGTHU":null,"CHUNGTUXUATBN_ID":null,"TYLEVAT":null,"GIATRIVAT":null,"MASOTHUE":null,"SOCHUNGTUKETOAN":null,"DAHOANTRA":"0","TRANGTHAI":"DATHUCHIEN","PHONGBAN_ID":null,"PHONGBAN_THAYDOI_ID":null,"CONGTYCHITRA_GIATRI":0.0,"HOIVIEN_GIATRI":0.0,"BENHVIEN_ID":"HLU01","NGAYTAO":"2019-06-03T10:00:35.563","NGUOITAO_ID":700,"NGAYCAPNHAT":"2019-06-03T10:00:35.563","NGUOICAPNHAT_ID":700,"AMOUNT":80000.0,"PRODQUANTITY":1,"PRODNAME":"HCV Ab test nhanh"}]';        set @jsonHODON_ID = N'[{"HOADON_ID":43061}]';          declare @INVOICE_ID int;        INSERT INTO TT_INVOICE        (KEYINVOICE ,BUYER, [ADDRESS], CUSCODE ,CUSNAME ,PAYMENTMETHOD ,NGAYPHATSINH ,SOHOADON ,GIATRITHUCTHU ,SOTIENBANGCHU        , HUY, NGUOITAO_ID, NGAYTAO, BENHVIEN_ID)        VALUES        ( @param0 ,  @param1 ,  @param2 ,  @param3 ,  @param4 ,  @param5 , CONVERT(DATETIME,  @param6 , 103),  @param7 ,  @param8 ,  @param9         ,'0', '1', Getdate(), 'HLU01')        set @INVOICE_ID = SCOPE_IDENTITY()          insert into TT_INVOICE_HOADON        SELECT @INVOICE_ID, jsonHD.HOADON_ID, 'HLU01'        FROM OPENJSON(@jsonHODON_ID)        WITH ( HOADON_ID int) jsonHD          insert into TT_INVOICE_DETAIL        SELECT @INVOICE_ID, json.HOADON_ID, json.PRODNAME, json.PRODQUANTITY, json.PRODUNIT, json.AMOUNT, '1', getdate() , 'HLU01'        FROM OPENJSON(@json)        WITH ( HOADON_ID int, PRODNAME nvarchar(300), PRODQUANTITY float, PRODUNIT nvarchar(100), AMOUNT float) json]
2019-10-29 17:27:37,430 [1] DEBUG - Statement Id: [EIN00002_INVOICE_Json] Parameters: [@param0=[KEYINVOICE,20191029172729_190042834], @param1=[BUYER,Bạch Văn Bình], @param2=[ADDRESS,Xã Cầu Lộc, Huyện Hậu Lộc, Tỉnh Thanh Hóa], @param3=[CUSCODE,190042834], @param4=[CUSNAME,Bạch Văn Bình], @param5=[PAYMENTMETHOD,Tiền mặt], @param6=[NGAYPHATSINH,29/10/2019], @param7=[SOHOADON,null], @param8=[GIATRITHUCTHU,615000], @param9=[SOTIENBANGCHU,Sáu trăm mười lăm nghìn đồng chẵn.]]
2019-10-29 17:27:37,430 [1] DEBUG - Statement Id: [EIN00002_INVOICE_Json] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[String, System.String], @param3=[String, System.String], @param4=[String, System.String], @param5=[String, System.String], @param6=[String, System.String], @param7=[System.DBNull, null], @param8=[Double, System.Double], @param9=[String, System.String]]
2019-10-29 17:27:45,565 [1] DEBUG - Statement Id: [EIN00002_GetHoaDonDaXuatLenCong] PreparedStatement : [select * from TT_INVOICE hd        where         HUY = '0'         and           convert(date, hd.NGAYPHATSINH) >= convert(date, '6/1/2019 12:00:00 AM')       and         convert(date, hd.NGAYPHATSINH) <= convert(date, '10/29/2019 12:00:00 AM')]
2019-10-29 17:27:50,835 [1] DEBUG - Statement Id: [EIN00002_GetListHoaDonBenhVien] PreparedStatement : [select * from          (select distinct hd.HOADON_ID, hd.SOHOADON, hd.NGAYHOADON, httt.GIATRITHUCTHU, bn.TENBENHNHAN, bn.MAYTE, bn.DIACHILIENLAC DIACHI,        case when hdngt.HOADON_ID is not null then N'Ngoại trú/ nhà thuốc' else N'Nội trú' end LOAIHOADONTHU,        case when hdngt.HOADON_ID is not null then N'TT_HOADON_CHITIET_NGOAITRU' else N'TT_HOADON_CHITIET_NOITRU' end REF_TABLE,        nv.TENNHANVIEN, httt.TENHINHTHUCTHANHTOAN, 'BENHVIEN' THANHTOANTAI        from TT_HOADON hd        left join TT_HOADON_HINHTHUCTHANHTOAN httt on httt.HOADON_ID = hd.HOADON_ID        left join TT_BENHNHAN bn on bn.BENHNHAN_ID = hd.BENHNHAN_ID        left join TT_HOADON_CHITIET_NGOAITRU hdngt on hdngt.HOADON_ID = hd.HOADON_ID        left join TT_HOADON_CHITIET_NOITRU hdnt on hdnt.HOADON_ID = hd.HOADON_ID        left join TM_NHANVIEN nv on nv.NHANVIEN_ID = hd.NGUOITAO_ID        left join TT_INVOICE_HOADON vnpt on vnpt.HOADON_ID = hd.HOADON_ID        left join TT_INVOICE main on main.INVOICE_ID = vnpt.INVOICE_ID        where        (hd.TIEPNHAN_ID is not null or hd.BENHNHAN_ID is not null ) and hd.LOAIHOADON = 'BL'        and (vnpt.HOADON_ID is null)        and hd.DATHANHTOAN = '1' and hd.HUYHOADON = '0' and hd.HOANTRA = '0'         and           convert(date, hd.NGAYHOADON) >= convert(date, '6/1/2019 12:00:00 AM')         and           convert(date, hd.NGAYHOADON) <= convert(date, '10/29/2019 12:00:00 AM')                 union all        select distinct hd.HOADON_ID, hd.SOHOADON, hd.NGAYHOADON, httt.GIATRITHUCTHU, NM.TENNGUOIMUA TENBENHNHAN, ('VANGLAI' + cast(NM.NGOAITRU_TOATHUOC_NGUOIMUA_ID as varchar(10))) MAYTE, NM.DIACHI,        N'Vãng lai nhà thuốc' LOAIHOADONTHU,        N'TT_HOADON_CHITIET_NGOAITRU' REF_TABLE,        nv.TENNHANVIEN, httt.TENHINHTHUCTHANHTOAN, 'VANGLAI' THANHTOANTAI        from TT_HOADON hd        left join TT_HOADON_HINHTHUCTHANHTOAN httt on httt.HOADON_ID = hd.HOADON_ID        left join TT_HOADON_CHITIET_NGOAITRU hdngt on hdngt.HOADON_ID = hd.HOADON_ID        left join TT_DUOC_CHUNGTU_CHITIET ctct on ctct.CHUNGTUCHITIET_ID= hdngt.REF_ID        left join TT_DUOC_CHUNGTU ct on ct.CHUNGTU_ID = ctct.CHUNGTU_ID        left join TT_NGOAITRU_TOATHUOC_NGUOIMUA NM on NM.NGOAITRU_TOATHUOC_NGUOIMUA_ID = CT.NGOAITRU_TOATHUOC_NGUOIMUA_ID        left join TM_NHANVIEN nv on nv.NHANVIEN_ID = hd.NGUOITAO_ID        left join TT_INVOICE_HOADON vnpt on vnpt.HOADON_ID = hd.HOADON_ID        left join TT_INVOICE main on main.INVOICE_ID = vnpt.INVOICE_ID        where        hd.TIEPNHAN_ID is null and hd.BENHNHAN_ID is null  and hd.LOAIHOADON = 'BL'        and (vnpt.HOADON_ID is null)        and hd.DATHANHTOAN = '1' and hd.HUYHOADON = '0' and hd.HOANTRA = '0'         and           convert(date, hd.NGAYHOADON) >= convert(date, '6/1/2019 12:00:00 AM')         and           convert(date, hd.NGAYHOADON) <= convert(date, '10/29/2019 12:00:00 AM')                 ) ds        order by ds.TENBENHNHAN]
2019-10-29 17:27:53,188 [1] DEBUG - Statement Id: [EIN00002_GetChiTietHoaDon] PreparedStatement : [select distinct hdct.*, hdct.GIATRI_BENHNHAN_DATHANHTOAN AMOUNT, hdct.SOLUONG PRODQUANTITY,        isnull(dv.TENDICHVU, dc.TENDUOCDAYDU) PRODNAME        from TT_HOADON_CHITIET_NGOAITRU hdct        left join TM_DICHVU dv on dv.DICHVU_ID = hdct.DICHVU_ID and hdct.DUOC_ID is null        left join TM_DUOC dc on dc.DUOC_ID = hdct.DUOC_ID and hdct.DICHVU_ID is null        where HOADON_ID = 43695]
2019-10-29 17:27:54,091 [1] DEBUG - Statement Id: [EIN00002_GetChiTietHoaDon] PreparedStatement : [select distinct hdct.*, hdct.GIATRI_BENHNHAN_DATHANHTOAN AMOUNT, hdct.SOLUONG PRODQUANTITY,        isnull(dv.TENDICHVU, dc.TENDUOCDAYDU) PRODNAME        from TT_HOADON_CHITIET_NGOAITRU hdct        left join TM_DICHVU dv on dv.DICHVU_ID = hdct.DICHVU_ID and hdct.DUOC_ID is null        left join TM_DUOC dc on dc.DUOC_ID = hdct.DUOC_ID and hdct.DICHVU_ID is null        where HOADON_ID = 42663]
2019-10-29 17:28:06,086 [1] DEBUG - Statement Id: [EIN00002_GetChiTietHoaDon] PreparedStatement : [select distinct hdct.*, hdct.GIATRI_BENHNHAN_DATHANHTOAN AMOUNT, hdct.SOLUONG PRODQUANTITY,        isnull(dv.TENDICHVU, dc.TENDUOCDAYDU) PRODNAME        from TT_HOADON_CHITIET_NGOAITRU hdct        left join TM_DICHVU dv on dv.DICHVU_ID = hdct.DICHVU_ID and hdct.DUOC_ID is null        left join TM_DUOC dc on dc.DUOC_ID = hdct.DUOC_ID and hdct.DICHVU_ID is null        where HOADON_ID = 43695]
2019-10-29 17:28:06,309 [1] DEBUG - Statement Id: [EIN00002_CheckHoadondaxuat] PreparedStatement : [select B.*        from TT_INVOICE A        left join TT_INVOICE_HOADON B on A.INVOICE_ID = B.INVOICE_ID        where B.HOADON_ID = 43695 and A.HUY = '0']
2019-10-29 17:28:06,343 [1] DEBUG - Statement Id: [EIN00002_GetChiTietHoaDon] PreparedStatement : [select distinct hdct.*, hdct.GIATRI_BENHNHAN_DATHANHTOAN AMOUNT, hdct.SOLUONG PRODQUANTITY,        isnull(dv.TENDICHVU, dc.TENDUOCDAYDU) PRODNAME        from TT_HOADON_CHITIET_NGOAITRU hdct        left join TM_DICHVU dv on dv.DICHVU_ID = hdct.DICHVU_ID and hdct.DUOC_ID is null        left join TM_DUOC dc on dc.DUOC_ID = hdct.DUOC_ID and hdct.DICHVU_ID is null        where HOADON_ID = 42663]
2019-10-29 17:28:06,374 [1] DEBUG - Statement Id: [EIN00002_CheckHoadondaxuat] PreparedStatement : [select B.*        from TT_INVOICE A        left join TT_INVOICE_HOADON B on A.INVOICE_ID = B.INVOICE_ID        where B.HOADON_ID = 42663 and A.HUY = '0']
2019-10-29 17:28:18,066 [1] DEBUG - Statement Id: [EIN00002_INVOICE_Json] PreparedStatement : [declare @json nvarchar(max);        declare @jsonHODON_ID nvarchar(max);        set @json = N'[{"HOADONCHITIET_ID":82192,"HOADON_ID":42663,"VIENPHI_ID":655708,"REF_ID":199777,"REF_TABLE":"TT_DVYEUCAU","DICHVU_ID":5686,"DUOC_ID":null,"LOAI_CHIPHI":"TT","LOAIGIA_ID":2,"SOLUONG":1,"DONGIA_DOANHTHU":33000.0,"THANHTIEN_DOANHTHU":33000.0,"BHYT_TL":0.95,"BHYT_DONGIA":33000.0,"BHYT_THANHTIEN":33000.0,"BHYT_DONGIA_CHITRA":31350.0,"BHYT_THANHTIEN_CHITRA":31350.0,"BENHNHAN_PHAITHANHTOAN":1650.0,"GIATRI_HOADON":1650.0,"GIATRI_HOADON_DATHANHTOAN":1650.0,"GIATRI_BIENLAI":1650.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":1650.0,"TYLE_THATTHU":null,"GIATRI_THATTHU":0.0,"MIENGIAM_TL":0.0,"MIENGIAM_GIATRI":0.0,"NGANSACH_TL":0.0,"NGANSACH_GIATRI":0.0,"TAITRO_TL":0.0,"TAITRO_GIATRI":0.0,"BHTN_GIATRI":null,"NOIDUNGTHU":null,"CHUNGTUXUATBN_ID":null,"TYLEVAT":null,"GIATRIVAT":null,"MASOTHUE":null,"SOCHUNGTUKETOAN":null,"DAHOANTRA":"0","TRANGTHAI":"DATHUCHIEN","PHONGBAN_ID":null,"PHONGBAN_THAYDOI_ID":null,"CONGTYCHITRA_GIATRI":0.0,"HOIVIEN_GIATRI":0.0,"BENHVIEN_ID":"HLU01","NGAYTAO":"2019-06-02T15:34:25.56","NGUOITAO_ID":687,"NGAYCAPNHAT":"2019-06-02T15:34:25.56","NGUOICAPNHAT_ID":687,"AMOUNT":1650.0,"PRODQUANTITY":1,"PRODNAME":"Khám Nội tổng hợp (D223)"},{"HOADONCHITIET_ID":82193,"HOADON_ID":42663,"VIENPHI_ID":655836,"REF_ID":32547,"REF_TABLE":"TT_NGOAITRU_TOATHUOC","DICHVU_ID":null,"DUOC_ID":892,"LOAI_CHIPHI":"TT","LOAIGIA_ID":null,"SOLUONG":200,"DONGIA_DOANHTHU":1050.0,"THANHTIEN_DOANHTHU":210000.0,"BHYT_TL":0.95,"BHYT_DONGIA":1050.0,"BHYT_THANHTIEN":210000.0,"BHYT_DONGIA_CHITRA":997.5,"BHYT_THANHTIEN_CHITRA":199500.0,"BENHNHAN_PHAITHANHTOAN":10500.0,"GIATRI_HOADON":10500.0,"GIATRI_HOADON_DATHANHTOAN":10500.0,"GIATRI_BIENLAI":10500.0,"GIATRI_BIENLAI_DATHANHTOAN":null,"GIATRI_BENHNHAN_DATHANHTOAN":10500.0,"TYLE_THATTHU":null,"GIATRI_THATTHU":null,"MIENGIAM_TL":null,"MIENGIAM_GIATRI":0.0,"NGANSACH_TL":null,"NGANSACH_GIATRI":null,"TAITRO_TL":null,"TAITRO_GIATRI":null,"BHTN_GIATRI":null,"NOIDUNGTHU":null,"CHUNGTUXUATBN_ID":null,"TYLEVAT":null,"GIATRIVAT":null,"MASOTHUE":null,"SOCHUNGTUKETOAN":null,"DAHOANTRA":"0","TRANGTHAI":"DATHUCHIEN","PHONGBAN_ID":null,"PHONGBAN_THAYDOI_ID":null,"CONGTYCHITRA_GIATRI":0.0,"HOIVIEN_GIATRI":0.0,"BENHVIEN_ID":"HLU01","NGAYTAO":"2019-06-02T15:34:25.563","NGUOITAO_ID":687,"NGAYCAPNHAT":"2019-06-02T15:34:25.563","NGUOICAPNHAT_ID":687,"AMOUNT":10500.0,"PRODQUANTITY":200,"PRODNAME":"Hộ tâm đan Thephaco"},{"HOADONCHITIET_ID":82194,"HOADON_ID":42663,"VIENPHI_ID":655837,"REF_ID":32548,"REF_TABLE":"TT_NGOAITRU_TOATHUOC","DICHVU_ID":null,"DUOC_ID":924,"LOAI_CHIPHI":"TT","LOAIGIA_ID":null,"SOLUONG":30,"DONGIA_DOANHTHU":1900.0,"THANHTIEN_DOANHTHU":57000.0,"BHYT_TL":0.95,"BHYT_DONGIA":1900.0,"BHYT_THANHTIEN":57000.0,"BHYT_DONGIA_CHITRA":1805.0,"BHYT_THANHTIEN_CHITRA":54150.0,"BENHNHAN_PHAITHANHTOAN":2850.0,"GIATRI_HOADON":2850.0,"GIATRI_HOADON_DATHANHTOAN":2850.0,"GIATRI_BIENLAI":2850.0,"GIATRI_BIENLAI_DATHANHTOAN":null,"GIATRI_BENHNHAN_DATHANHTOAN":2850.0,"TYLE_THATTHU":null,"GIATRI_THATTHU":null,"MIENGIAM_TL":null,"MIENGIAM_GIATRI":0.0,"NGANSACH_TL":null,"NGANSACH_GIATRI":null,"TAITRO_TL":null,"TAITRO_GIATRI":null,"BHTN_GIATRI":null,"NOIDUNGTHU":null,"CHUNGTUXUATBN_ID":null,"TYLEVAT":null,"GIATRIVAT":null,"MASOTHUE":null,"SOCHUNGTUKETOAN":null,"DAHOANTRA":"0","TRANGTHAI":"DATHUCHIEN","PHONGBAN_ID":null,"PHONGBAN_THAYDOI_ID":null,"CONGTYCHITRA_GIATRI":0.0,"HOIVIEN_GIATRI":0.0,"BENHVIEN_ID":"HLU01","NGAYTAO":"2019-06-02T15:34:25.563","NGUOITAO_ID":687,"NGAYCAPNHAT":"2019-06-02T15:34:25.563","NGUOICAPNHAT_ID":687,"AMOUNT":2850.0,"PRODQUANTITY":30,"PRODNAME":"Cefadroxil( Mekocefal) 500mg"},{"HOADONCHITIET_ID":82195,"HOADON_ID":42663,"VIENPHI_ID":655838,"REF_ID":32549,"REF_TABLE":"TT_NGOAITRU_TOATHUOC","DICHVU_ID":null,"DUOC_ID":809,"LOAI_CHIPHI":"TT","LOAIGIA_ID":null,"SOLUONG":40,"DONGIA_DOANHTHU":1690.0,"THANHTIEN_DOANHTHU":67600.0,"BHYT_TL":0.95,"BHYT_DONGIA":1690.0,"BHYT_THANHTIEN":67600.0,"BHYT_DONGIA_CHITRA":1605.5,"BHYT_THANHTIEN_CHITRA":64220.0,"BENHNHAN_PHAITHANHTOAN":3380.0,"GIATRI_HOADON":3380.0,"GIATRI_HOADON_DATHANHTOAN":3380.0,"GIATRI_BIENLAI":3380.0,"GIATRI_BIENLAI_DATHANHTOAN":null,"GIATRI_BENHNHAN_DATHANHTOAN":3380.0,"TYLE_THATTHU":null,"GIATRI_THATTHU":null,"MIENGIAM_TL":null,"MIENGIAM_GIATRI":0.0,"NGANSACH_TL":null,"NGANSACH_GIATRI":null,"TAITRO_TL":null,"TAITRO_GIATRI":null,"BHTN_GIATRI":null,"NOIDUNGTHU":null,"CHUNGTUXUATBN_ID":null,"TYLEVAT":null,"GIATRIVAT":null,"MASOTHUE":null,"SOCHUNGTUKETOAN":null,"DAHOANTRA":"0","TRANGTHAI":"DATHUCHIEN","PHONGBAN_ID":null,"PHONGBAN_THAYDOI_ID":null,"CONGTYCHITRA_GIATRI":0.0,"HOIVIEN_GIATRI":0.0,"BENHVIEN_ID":"HLU01","NGAYTAO":"2019-06-02T15:34:25.563","NGUOITAO_ID":687,"NGAYCAPNHAT":"2019-06-02T15:34:25.563","NGUOICAPNHAT_ID":687,"AMOUNT":3380.0,"PRODQUANTITY":40,"PRODNAME":"Acetyl leucin (Ad- Liver) 100mg, 50mg, 50mg"}]';        set @jsonHODON_ID = N'[{"HOADON_ID":43695}]';          declare @INVOICE_ID int;        INSERT INTO TT_INVOICE        (KEYINVOICE ,BUYER, [ADDRESS], CUSCODE ,CUSNAME ,PAYMENTMETHOD ,NGAYPHATSINH ,SOHOADON ,GIATRITHUCTHU ,SOTIENBANGCHU        , HUY, NGUOITAO_ID, NGAYTAO, BENHVIEN_ID)        VALUES        ( @param0 ,  @param1 ,  @param2 ,  @param3 ,  @param4 ,  @param5 , CONVERT(DATETIME,  @param6 , 103),  @param7 ,  @param8 ,  @param9         ,'0', '1', Getdate(), 'HLU01')        set @INVOICE_ID = SCOPE_IDENTITY()          insert into TT_INVOICE_HOADON        SELECT @INVOICE_ID, jsonHD.HOADON_ID, 'HLU01'        FROM OPENJSON(@jsonHODON_ID)        WITH ( HOADON_ID int) jsonHD          insert into TT_INVOICE_DETAIL        SELECT @INVOICE_ID, json.HOADON_ID, json.PRODNAME, json.PRODQUANTITY, json.PRODUNIT, json.AMOUNT, '1', getdate() , 'HLU01'        FROM OPENJSON(@json)        WITH ( HOADON_ID int, PRODNAME nvarchar(300), PRODQUANTITY float, PRODUNIT nvarchar(100), AMOUNT float) json]
2019-10-29 17:28:18,066 [1] DEBUG - Statement Id: [EIN00002_INVOICE_Json] Parameters: [@param0=[KEYINVOICE,20191029172816_190043179], @param1=[BUYER,Bùi Anh Dũng], @param2=[ADDRESS,Xã Thành Kim, Huyện Thạch Thành, Tỉnh Thanh Hóa], @param3=[CUSCODE,190043179], @param4=[CUSNAME,Bùi Anh Dũng], @param5=[PAYMENTMETHOD,Tiền mặt], @param6=[NGAYPHATSINH,29/10/2019], @param7=[SOHOADON,null], @param8=[GIATRITHUCTHU,300000], @param9=[SOTIENBANGCHU,Ba trăm nghìn đồng chẵn.]]
2019-10-29 17:28:18,066 [1] DEBUG - Statement Id: [EIN00002_INVOICE_Json] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[String, System.String], @param3=[String, System.String], @param4=[String, System.String], @param5=[String, System.String], @param6=[String, System.String], @param7=[System.DBNull, null], @param8=[Double, System.Double], @param9=[String, System.String]]
2019-10-29 17:28:18,662 [1] DEBUG - Statement Id: [EIN00002_INVOICE_Json] PreparedStatement : [declare @json nvarchar(max);        declare @jsonHODON_ID nvarchar(max);        set @json = N'[{"HOADONCHITIET_ID":82192,"HOADON_ID":42663,"VIENPHI_ID":655708,"REF_ID":199777,"REF_TABLE":"TT_DVYEUCAU","DICHVU_ID":5686,"DUOC_ID":null,"LOAI_CHIPHI":"TT","LOAIGIA_ID":2,"SOLUONG":1,"DONGIA_DOANHTHU":33000.0,"THANHTIEN_DOANHTHU":33000.0,"BHYT_TL":0.95,"BHYT_DONGIA":33000.0,"BHYT_THANHTIEN":33000.0,"BHYT_DONGIA_CHITRA":31350.0,"BHYT_THANHTIEN_CHITRA":31350.0,"BENHNHAN_PHAITHANHTOAN":1650.0,"GIATRI_HOADON":1650.0,"GIATRI_HOADON_DATHANHTOAN":1650.0,"GIATRI_BIENLAI":1650.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":1650.0,"TYLE_THATTHU":null,"GIATRI_THATTHU":0.0,"MIENGIAM_TL":0.0,"MIENGIAM_GIATRI":0.0,"NGANSACH_TL":0.0,"NGANSACH_GIATRI":0.0,"TAITRO_TL":0.0,"TAITRO_GIATRI":0.0,"BHTN_GIATRI":null,"NOIDUNGTHU":null,"CHUNGTUXUATBN_ID":null,"TYLEVAT":null,"GIATRIVAT":null,"MASOTHUE":null,"SOCHUNGTUKETOAN":null,"DAHOANTRA":"0","TRANGTHAI":"DATHUCHIEN","PHONGBAN_ID":null,"PHONGBAN_THAYDOI_ID":null,"CONGTYCHITRA_GIATRI":0.0,"HOIVIEN_GIATRI":0.0,"BENHVIEN_ID":"HLU01","NGAYTAO":"2019-06-02T15:34:25.56","NGUOITAO_ID":687,"NGAYCAPNHAT":"2019-06-02T15:34:25.56","NGUOICAPNHAT_ID":687,"AMOUNT":1650.0,"PRODQUANTITY":1,"PRODNAME":"Khám Nội tổng hợp (D223)"},{"HOADONCHITIET_ID":82193,"HOADON_ID":42663,"VIENPHI_ID":655836,"REF_ID":32547,"REF_TABLE":"TT_NGOAITRU_TOATHUOC","DICHVU_ID":null,"DUOC_ID":892,"LOAI_CHIPHI":"TT","LOAIGIA_ID":null,"SOLUONG":200,"DONGIA_DOANHTHU":1050.0,"THANHTIEN_DOANHTHU":210000.0,"BHYT_TL":0.95,"BHYT_DONGIA":1050.0,"BHYT_THANHTIEN":210000.0,"BHYT_DONGIA_CHITRA":997.5,"BHYT_THANHTIEN_CHITRA":199500.0,"BENHNHAN_PHAITHANHTOAN":10500.0,"GIATRI_HOADON":10500.0,"GIATRI_HOADON_DATHANHTOAN":10500.0,"GIATRI_BIENLAI":10500.0,"GIATRI_BIENLAI_DATHANHTOAN":null,"GIATRI_BENHNHAN_DATHANHTOAN":10500.0,"TYLE_THATTHU":null,"GIATRI_THATTHU":null,"MIENGIAM_TL":null,"MIENGIAM_GIATRI":0.0,"NGANSACH_TL":null,"NGANSACH_GIATRI":null,"TAITRO_TL":null,"TAITRO_GIATRI":null,"BHTN_GIATRI":null,"NOIDUNGTHU":null,"CHUNGTUXUATBN_ID":null,"TYLEVAT":null,"GIATRIVAT":null,"MASOTHUE":null,"SOCHUNGTUKETOAN":null,"DAHOANTRA":"0","TRANGTHAI":"DATHUCHIEN","PHONGBAN_ID":null,"PHONGBAN_THAYDOI_ID":null,"CONGTYCHITRA_GIATRI":0.0,"HOIVIEN_GIATRI":0.0,"BENHVIEN_ID":"HLU01","NGAYTAO":"2019-06-02T15:34:25.563","NGUOITAO_ID":687,"NGAYCAPNHAT":"2019-06-02T15:34:25.563","NGUOICAPNHAT_ID":687,"AMOUNT":10500.0,"PRODQUANTITY":200,"PRODNAME":"Hộ tâm đan Thephaco"},{"HOADONCHITIET_ID":82194,"HOADON_ID":42663,"VIENPHI_ID":655837,"REF_ID":32548,"REF_TABLE":"TT_NGOAITRU_TOATHUOC","DICHVU_ID":null,"DUOC_ID":924,"LOAI_CHIPHI":"TT","LOAIGIA_ID":null,"SOLUONG":30,"DONGIA_DOANHTHU":1900.0,"THANHTIEN_DOANHTHU":57000.0,"BHYT_TL":0.95,"BHYT_DONGIA":1900.0,"BHYT_THANHTIEN":57000.0,"BHYT_DONGIA_CHITRA":1805.0,"BHYT_THANHTIEN_CHITRA":54150.0,"BENHNHAN_PHAITHANHTOAN":2850.0,"GIATRI_HOADON":2850.0,"GIATRI_HOADON_DATHANHTOAN":2850.0,"GIATRI_BIENLAI":2850.0,"GIATRI_BIENLAI_DATHANHTOAN":null,"GIATRI_BENHNHAN_DATHANHTOAN":2850.0,"TYLE_THATTHU":null,"GIATRI_THATTHU":null,"MIENGIAM_TL":null,"MIENGIAM_GIATRI":0.0,"NGANSACH_TL":null,"NGANSACH_GIATRI":null,"TAITRO_TL":null,"TAITRO_GIATRI":null,"BHTN_GIATRI":null,"NOIDUNGTHU":null,"CHUNGTUXUATBN_ID":null,"TYLEVAT":null,"GIATRIVAT":null,"MASOTHUE":null,"SOCHUNGTUKETOAN":null,"DAHOANTRA":"0","TRANGTHAI":"DATHUCHIEN","PHONGBAN_ID":null,"PHONGBAN_THAYDOI_ID":null,"CONGTYCHITRA_GIATRI":0.0,"HOIVIEN_GIATRI":0.0,"BENHVIEN_ID":"HLU01","NGAYTAO":"2019-06-02T15:34:25.563","NGUOITAO_ID":687,"NGAYCAPNHAT":"2019-06-02T15:34:25.563","NGUOICAPNHAT_ID":687,"AMOUNT":2850.0,"PRODQUANTITY":30,"PRODNAME":"Cefadroxil( Mekocefal) 500mg"},{"HOADONCHITIET_ID":82195,"HOADON_ID":42663,"VIENPHI_ID":655838,"REF_ID":32549,"REF_TABLE":"TT_NGOAITRU_TOATHUOC","DICHVU_ID":null,"DUOC_ID":809,"LOAI_CHIPHI":"TT","LOAIGIA_ID":null,"SOLUONG":40,"DONGIA_DOANHTHU":1690.0,"THANHTIEN_DOANHTHU":67600.0,"BHYT_TL":0.95,"BHYT_DONGIA":1690.0,"BHYT_THANHTIEN":67600.0,"BHYT_DONGIA_CHITRA":1605.5,"BHYT_THANHTIEN_CHITRA":64220.0,"BENHNHAN_PHAITHANHTOAN":3380.0,"GIATRI_HOADON":3380.0,"GIATRI_HOADON_DATHANHTOAN":3380.0,"GIATRI_BIENLAI":3380.0,"GIATRI_BIENLAI_DATHANHTOAN":null,"GIATRI_BENHNHAN_DATHANHTOAN":3380.0,"TYLE_THATTHU":null,"GIATRI_THATTHU":null,"MIENGIAM_TL":null,"MIENGIAM_GIATRI":0.0,"NGANSACH_TL":null,"NGANSACH_GIATRI":null,"TAITRO_TL":null,"TAITRO_GIATRI":null,"BHTN_GIATRI":null,"NOIDUNGTHU":null,"CHUNGTUXUATBN_ID":null,"TYLEVAT":null,"GIATRIVAT":null,"MASOTHUE":null,"SOCHUNGTUKETOAN":null,"DAHOANTRA":"0","TRANGTHAI":"DATHUCHIEN","PHONGBAN_ID":null,"PHONGBAN_THAYDOI_ID":null,"CONGTYCHITRA_GIATRI":0.0,"HOIVIEN_GIATRI":0.0,"BENHVIEN_ID":"HLU01","NGAYTAO":"2019-06-02T15:34:25.563","NGUOITAO_ID":687,"NGAYCAPNHAT":"2019-06-02T15:34:25.563","NGUOICAPNHAT_ID":687,"AMOUNT":3380.0,"PRODQUANTITY":40,"PRODNAME":"Acetyl leucin (Ad- Liver) 100mg, 50mg, 50mg"}]';        set @jsonHODON_ID = N'[{"HOADON_ID":42663}]';          declare @INVOICE_ID int;        INSERT INTO TT_INVOICE        (KEYINVOICE ,BUYER, [ADDRESS], CUSCODE ,CUSNAME ,PAYMENTMETHOD ,NGAYPHATSINH ,SOHOADON ,GIATRITHUCTHU ,SOTIENBANGCHU        , HUY, NGUOITAO_ID, NGAYTAO, BENHVIEN_ID)        VALUES        ( @param0 ,  @param1 ,  @param2 ,  @param3 ,  @param4 ,  @param5 , CONVERT(DATETIME,  @param6 , 103),  @param7 ,  @param8 ,  @param9         ,'0', '1', Getdate(), 'HLU01')        set @INVOICE_ID = SCOPE_IDENTITY()          insert into TT_INVOICE_HOADON        SELECT @INVOICE_ID, jsonHD.HOADON_ID, 'HLU01'        FROM OPENJSON(@jsonHODON_ID)        WITH ( HOADON_ID int) jsonHD          insert into TT_INVOICE_DETAIL        SELECT @INVOICE_ID, json.HOADON_ID, json.PRODNAME, json.PRODQUANTITY, json.PRODUNIT, json.AMOUNT, '1', getdate() , 'HLU01'        FROM OPENJSON(@json)        WITH ( HOADON_ID int, PRODNAME nvarchar(300), PRODQUANTITY float, PRODUNIT nvarchar(100), AMOUNT float) json]
2019-10-29 17:28:18,663 [1] DEBUG - Statement Id: [EIN00002_INVOICE_Json] Parameters: [@param0=[KEYINVOICE,20191029172818_190027113], @param1=[BUYER,Bùi Cao Kháng], @param2=[ADDRESS,Phường Đông Thọ, Thành phố Thanh Hóa, Tỉnh Thanh Hóa], @param3=[CUSCODE,190027113], @param4=[CUSNAME,Bùi Cao Kháng], @param5=[PAYMENTMETHOD,Tiền mặt], @param6=[NGAYPHATSINH,29/10/2019], @param7=[SOHOADON,null], @param8=[GIATRITHUCTHU,18380], @param9=[SOTIENBANGCHU,Mười tám nghìn ba trăm tám mươi đồng chẵn.]]
2019-10-29 17:28:18,663 [1] DEBUG - Statement Id: [EIN00002_INVOICE_Json] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[String, System.String], @param3=[String, System.String], @param4=[String, System.String], @param5=[String, System.String], @param6=[String, System.String], @param7=[System.DBNull, null], @param8=[Double, System.Double], @param9=[String, System.String]]
2019-10-29 17:28:18,761 [1] DEBUG - Statement Id: [EIN00002_GetChiTietHoaDon] PreparedStatement : [select distinct hdct.*, hdct.GIATRI_BENHNHAN_DATHANHTOAN AMOUNT, hdct.SOLUONG PRODQUANTITY,        isnull(dv.TENDICHVU, dc.TENDUOCDAYDU) PRODNAME        from TT_HOADON_CHITIET_NGOAITRU hdct        left join TM_DICHVU dv on dv.DICHVU_ID = hdct.DICHVU_ID and hdct.DUOC_ID is null        left join TM_DUOC dc on dc.DUOC_ID = hdct.DUOC_ID and hdct.DICHVU_ID is null        where HOADON_ID = 42663]
2019-10-29 17:28:24,318 [1] DEBUG - Statement Id: [EIN00002_GetHoaDonDaXuatLenCong] PreparedStatement : [select * from TT_INVOICE hd        where         HUY = '0'         and           convert(date, hd.NGAYPHATSINH) >= convert(date, '6/1/2019 12:00:00 AM')       and         convert(date, hd.NGAYPHATSINH) <= convert(date, '10/29/2019 12:00:00 AM')]
2019-10-29 17:28:35,896 [1] DEBUG - Statement Id: [EIN00002_GetListHoaDonBenhVien] PreparedStatement : [select * from          (select distinct hd.HOADON_ID, hd.SOHOADON, hd.NGAYHOADON, httt.GIATRITHUCTHU, bn.TENBENHNHAN, bn.MAYTE, bn.DIACHILIENLAC DIACHI,        case when hdngt.HOADON_ID is not null then N'Ngoại trú/ nhà thuốc' else N'Nội trú' end LOAIHOADONTHU,        case when hdngt.HOADON_ID is not null then N'TT_HOADON_CHITIET_NGOAITRU' else N'TT_HOADON_CHITIET_NOITRU' end REF_TABLE,        nv.TENNHANVIEN, httt.TENHINHTHUCTHANHTOAN, 'BENHVIEN' THANHTOANTAI        from TT_HOADON hd        left join TT_HOADON_HINHTHUCTHANHTOAN httt on httt.HOADON_ID = hd.HOADON_ID        left join TT_BENHNHAN bn on bn.BENHNHAN_ID = hd.BENHNHAN_ID        left join TT_HOADON_CHITIET_NGOAITRU hdngt on hdngt.HOADON_ID = hd.HOADON_ID        left join TT_HOADON_CHITIET_NOITRU hdnt on hdnt.HOADON_ID = hd.HOADON_ID        left join TM_NHANVIEN nv on nv.NHANVIEN_ID = hd.NGUOITAO_ID        left join TT_INVOICE_HOADON vnpt on vnpt.HOADON_ID = hd.HOADON_ID        left join TT_INVOICE main on main.INVOICE_ID = vnpt.INVOICE_ID        where        (hd.TIEPNHAN_ID is not null or hd.BENHNHAN_ID is not null ) and hd.LOAIHOADON = 'BL'        and (vnpt.HOADON_ID is null)        and hd.DATHANHTOAN = '1' and hd.HUYHOADON = '0' and hd.HOANTRA = '0'         and           convert(date, hd.NGAYHOADON) >= convert(date, '6/1/2019 12:00:00 AM')         and           convert(date, hd.NGAYHOADON) <= convert(date, '10/29/2019 12:00:00 AM')                 union all        select distinct hd.HOADON_ID, hd.SOHOADON, hd.NGAYHOADON, httt.GIATRITHUCTHU, NM.TENNGUOIMUA TENBENHNHAN, ('VANGLAI' + cast(NM.NGOAITRU_TOATHUOC_NGUOIMUA_ID as varchar(10))) MAYTE, NM.DIACHI,        N'Vãng lai nhà thuốc' LOAIHOADONTHU,        N'TT_HOADON_CHITIET_NGOAITRU' REF_TABLE,        nv.TENNHANVIEN, httt.TENHINHTHUCTHANHTOAN, 'VANGLAI' THANHTOANTAI        from TT_HOADON hd        left join TT_HOADON_HINHTHUCTHANHTOAN httt on httt.HOADON_ID = hd.HOADON_ID        left join TT_HOADON_CHITIET_NGOAITRU hdngt on hdngt.HOADON_ID = hd.HOADON_ID        left join TT_DUOC_CHUNGTU_CHITIET ctct on ctct.CHUNGTUCHITIET_ID= hdngt.REF_ID        left join TT_DUOC_CHUNGTU ct on ct.CHUNGTU_ID = ctct.CHUNGTU_ID        left join TT_NGOAITRU_TOATHUOC_NGUOIMUA NM on NM.NGOAITRU_TOATHUOC_NGUOIMUA_ID = CT.NGOAITRU_TOATHUOC_NGUOIMUA_ID        left join TM_NHANVIEN nv on nv.NHANVIEN_ID = hd.NGUOITAO_ID        left join TT_INVOICE_HOADON vnpt on vnpt.HOADON_ID = hd.HOADON_ID        left join TT_INVOICE main on main.INVOICE_ID = vnpt.INVOICE_ID        where        hd.TIEPNHAN_ID is null and hd.BENHNHAN_ID is null  and hd.LOAIHOADON = 'BL'        and (vnpt.HOADON_ID is null)        and hd.DATHANHTOAN = '1' and hd.HUYHOADON = '0' and hd.HOANTRA = '0'         and           convert(date, hd.NGAYHOADON) >= convert(date, '6/1/2019 12:00:00 AM')         and           convert(date, hd.NGAYHOADON) <= convert(date, '10/29/2019 12:00:00 AM')                 ) ds        order by ds.TENBENHNHAN]
2019-10-29 17:28:39,136 [1] DEBUG - Statement Id: [EIN00002_GetChiTietHoaDon] PreparedStatement : [select distinct hdct.*, hdct.GIATRI_BENHNHAN_DATHANHTOAN AMOUNT, hdct.SOLUONG PRODQUANTITY,        isnull(dv.TENDICHVU, dc.TENDUOCDAYDU) PRODNAME        from TT_HOADON_CHITIET_NGOAITRU hdct        left join TM_DICHVU dv on dv.DICHVU_ID = hdct.DICHVU_ID and hdct.DUOC_ID is null        left join TM_DUOC dc on dc.DUOC_ID = hdct.DUOC_ID and hdct.DICHVU_ID is null        where HOADON_ID = 42981]
2019-10-29 17:28:43,988 [1] DEBUG - Statement Id: [EIN00002_GetChiTietHoaDon] PreparedStatement : [select distinct hdct.*, hdct.GIATRI_BENHNHAN_DATHANHTOAN AMOUNT, hdct.SOLUONG PRODQUANTITY,        isnull(dv.TENDICHVU, dc.TENDUOCDAYDU) PRODNAME        from TT_HOADON_CHITIET_NGOAITRU hdct        left join TM_DICHVU dv on dv.DICHVU_ID = hdct.DICHVU_ID and hdct.DUOC_ID is null        left join TM_DUOC dc on dc.DUOC_ID = hdct.DUOC_ID and hdct.DICHVU_ID is null        where HOADON_ID = 43017]
2019-10-29 17:28:58,582 [1] DEBUG - Statement Id: [EIN00002_GetChiTietHoaDon] PreparedStatement : [select distinct hdct.*, hdct.GIATRI_BENHNHAN_DATHANHTOAN AMOUNT, hdct.SOLUONG PRODQUANTITY,        isnull(dv.TENDICHVU, dc.TENDUOCDAYDU) PRODNAME        from TT_HOADON_CHITIET_NGOAITRU hdct        left join TM_DICHVU dv on dv.DICHVU_ID = hdct.DICHVU_ID and hdct.DUOC_ID is null        left join TM_DUOC dc on dc.DUOC_ID = hdct.DUOC_ID and hdct.DICHVU_ID is null        where HOADON_ID = 42981]
2019-10-29 17:28:58,613 [1] DEBUG - Statement Id: [EIN00002_CheckHoadondaxuat] PreparedStatement : [select B.*        from TT_INVOICE A        left join TT_INVOICE_HOADON B on A.INVOICE_ID = B.INVOICE_ID        where B.HOADON_ID = 42981 and A.HUY = '0']
2019-10-29 17:28:58,654 [1] DEBUG - Statement Id: [EIN00002_GetChiTietHoaDon] PreparedStatement : [select distinct hdct.*, hdct.GIATRI_BENHNHAN_DATHANHTOAN AMOUNT, hdct.SOLUONG PRODQUANTITY,        isnull(dv.TENDICHVU, dc.TENDUOCDAYDU) PRODNAME        from TT_HOADON_CHITIET_NGOAITRU hdct        left join TM_DICHVU dv on dv.DICHVU_ID = hdct.DICHVU_ID and hdct.DUOC_ID is null        left join TM_DUOC dc on dc.DUOC_ID = hdct.DUOC_ID and hdct.DICHVU_ID is null        where HOADON_ID = 43017]
2019-10-29 17:28:58,686 [1] DEBUG - Statement Id: [EIN00002_CheckHoadondaxuat] PreparedStatement : [select B.*        from TT_INVOICE A        left join TT_INVOICE_HOADON B on A.INVOICE_ID = B.INVOICE_ID        where B.HOADON_ID = 43017 and A.HUY = '0']
2019-10-29 17:29:05,005 [1] DEBUG - Statement Id: [EIN00002_INVOICE_Json] PreparedStatement : [declare @json nvarchar(max);        declare @jsonHODON_ID nvarchar(max);        set @json = N'[{"HOADONCHITIET_ID":83137,"HOADON_ID":43017,"VIENPHI_ID":658828,"REF_ID":200314,"REF_TABLE":"TT_DVYEUCAU","DICHVU_ID":5439,"DUOC_ID":null,"LOAI_CHIPHI":"TT","LOAIGIA_ID":2,"SOLUONG":1,"DONGIA_DOANHTHU":33000.0,"THANHTIEN_DOANHTHU":33000.0,"BHYT_TL":1.0,"BHYT_DONGIA":33000.0,"BHYT_THANHTIEN":33000.0,"BHYT_DONGIA_CHITRA":33000.0,"BHYT_THANHTIEN_CHITRA":33000.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"TYLE_THATTHU":null,"GIATRI_THATTHU":0.0,"MIENGIAM_TL":0.0,"MIENGIAM_GIATRI":0.0,"NGANSACH_TL":0.0,"NGANSACH_GIATRI":0.0,"TAITRO_TL":0.0,"TAITRO_GIATRI":0.0,"BHTN_GIATRI":null,"NOIDUNGTHU":null,"CHUNGTUXUATBN_ID":null,"TYLEVAT":null,"GIATRIVAT":null,"MASOTHUE":null,"SOCHUNGTUKETOAN":null,"DAHOANTRA":"0","TRANGTHAI":"DATHUCHIEN","PHONGBAN_ID":null,"PHONGBAN_THAYDOI_ID":null,"CONGTYCHITRA_GIATRI":0.0,"HOIVIEN_GIATRI":0.0,"BENHVIEN_ID":"HLU01","NGAYTAO":"2019-06-03T09:37:07.717","NGUOITAO_ID":691,"NGAYCAPNHAT":"2019-06-03T09:37:07.717","NGUOICAPNHAT_ID":691,"AMOUNT":0.0,"PRODQUANTITY":1,"PRODNAME":"Khám Nội tiết (225)"},{"HOADONCHITIET_ID":83138,"HOADON_ID":43017,"VIENPHI_ID":658829,"REF_ID":200315,"REF_TABLE":"TT_DVYEUCAU","DICHVU_ID":5554,"DUOC_ID":null,"LOAI_CHIPHI":"TT","LOAIGIA_ID":3,"SOLUONG":1,"DONGIA_DOANHTHU":5000.0,"THANHTIEN_DOANHTHU":5000.0,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":5000.0,"GIATRI_HOADON":5000.0,"GIATRI_HOADON_DATHANHTOAN":5000.0,"GIATRI_BIENLAI":5000.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":5000.0,"TYLE_THATTHU":null,"GIATRI_THATTHU":0.0,"MIENGIAM_TL":0.0,"MIENGIAM_GIATRI":0.0,"NGANSACH_TL":0.0,"NGANSACH_GIATRI":0.0,"TAITRO_TL":0.0,"TAITRO_GIATRI":0.0,"BHTN_GIATRI":null,"NOIDUNGTHU":null,"CHUNGTUXUATBN_ID":null,"TYLEVAT":null,"GIATRIVAT":null,"MASOTHUE":null,"SOCHUNGTUKETOAN":null,"DAHOANTRA":"0","TRANGTHAI":"CHUATHUCHIEN","PHONGBAN_ID":null,"PHONGBAN_THAYDOI_ID":null,"CONGTYCHITRA_GIATRI":0.0,"HOIVIEN_GIATRI":0.0,"BENHVIEN_ID":"HLU01","NGAYTAO":"2019-06-03T09:37:07.72","NGUOITAO_ID":691,"NGAYCAPNHAT":"2019-06-03T09:37:07.72","NGUOICAPNHAT_ID":691,"AMOUNT":5000.0,"PRODQUANTITY":1,"PRODNAME":"Sổ khám bệnh (SKB)"},{"HOADONCHITIET_ID":83139,"HOADON_ID":43017,"VIENPHI_ID":659098,"REF_ID":200482,"REF_TABLE":"TT_DVYEUCAU","DICHVU_ID":4681,"DUOC_ID":null,"LOAI_CHIPHI":"TT","LOAIGIA_ID":2,"SOLUONG":1,"DONGIA_DOANHTHU":21400.0,"THANHTIEN_DOANHTHU":21400.0,"BHYT_TL":1.0,"BHYT_DONGIA":21400.0,"BHYT_THANHTIEN":21400.0,"BHYT_DONGIA_CHITRA":21400.0,"BHYT_THANHTIEN_CHITRA":21400.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"TYLE_THATTHU":null,"GIATRI_THATTHU":0.0,"MIENGIAM_TL":0.0,"MIENGIAM_GIATRI":0.0,"NGANSACH_TL":0.0,"NGANSACH_GIATRI":0.0,"TAITRO_TL":0.0,"TAITRO_GIATRI":0.0,"BHTN_GIATRI":null,"NOIDUNGTHU":null,"CHUNGTUXUATBN_ID":null,"TYLEVAT":null,"GIATRIVAT":null,"MASOTHUE":null,"SOCHUNGTUKETOAN":null,"DAHOANTRA":"0","TRANGTHAI":"DATHUCHIEN","PHONGBAN_ID":null,"PHONGBAN_THAYDOI_ID":null,"CONGTYCHITRA_GIATRI":0.0,"HOIVIEN_GIATRI":0.0,"BENHVIEN_ID":"HLU01","NGAYTAO":"2019-06-03T09:37:07.72","NGUOITAO_ID":691,"NGAYCAPNHAT":"2019-06-03T09:37:07.72","NGUOICAPNHAT_ID":691,"AMOUNT":0.0,"PRODQUANTITY":1,"PRODNAME":"Định lượng Glucose [Máu]"},{"HOADONCHITIET_ID":83140,"HOADON_ID":43017,"VIENPHI_ID":659099,"REF_ID":200483,"REF_TABLE":"TT_DVYEUCAU","DICHVU_ID":4722,"DUOC_ID":null,"LOAI_CHIPHI":"TT","LOAIGIA_ID":2,"SOLUONG":1,"DONGIA_DOANHTHU":21400.0,"THANHTIEN_DOANHTHU":21400.0,"BHYT_TL":1.0,"BHYT_DONGIA":21400.0,"BHYT_THANHTIEN":21400.0,"BHYT_DONGIA_CHITRA":21400.0,"BHYT_THANHTIEN_CHITRA":21400.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"TYLE_THATTHU":null,"GIATRI_THATTHU":0.0,"MIENGIAM_TL":0.0,"MIENGIAM_GIATRI":0.0,"NGANSACH_TL":0.0,"NGANSACH_GIATRI":0.0,"TAITRO_TL":0.0,"TAITRO_GIATRI":0.0,"BHTN_GIATRI":null,"NOIDUNGTHU":null,"CHUNGTUXUATBN_ID":null,"TYLEVAT":null,"GIATRIVAT":null,"MASOTHUE":null,"SOCHUNGTUKETOAN":null,"DAHOANTRA":"0","TRANGTHAI":"DATHUCHIEN","PHONGBAN_ID":null,"PHONGBAN_THAYDOI_ID":null,"CONGTYCHITRA_GIATRI":0.0,"HOIVIEN_GIATRI":0.0,"BENHVIEN_ID":"HLU01","NGAYTAO":"2019-06-03T09:37:07.72","NGUOITAO_ID":691,"NGAYCAPNHAT":"2019-06-03T09:37:07.72","NGUOICAPNHAT_ID":691,"AMOUNT":0.0,"PRODQUANTITY":1,"PRODNAME":"Định lượng Urê máu [Máu]"},{"HOADONCHITIET_ID":83141,"HOADON_ID":43017,"VIENPHI_ID":659100,"REF_ID":200484,"REF_TABLE":"TT_DVYEUCAU","DICHVU_ID":4668,"DUOC_ID":null,"LOAI_CHIPHI":"TT","LOAIGIA_ID":2,"SOLUONG":1,"DONGIA_DOANHTHU":21400.0,"THANHTIEN_DOANHTHU":21400.0,"BHYT_TL":1.0,"BHYT_DONGIA":21400.0,"BHYT_THANHTIEN":21400.0,"BHYT_DONGIA_CHITRA":21400.0,"BHYT_THANHTIEN_CHITRA":21400.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"TYLE_THATTHU":null,"GIATRI_THATTHU":0.0,"MIENGIAM_TL":0.0,"MIENGIAM_GIATRI":0.0,"NGANSACH_TL":0.0,"NGANSACH_GIATRI":0.0,"TAITRO_TL":0.0,"TAITRO_GIATRI":0.0,"BHTN_GIATRI":null,"NOIDUNGTHU":null,"CHUNGTUXUATBN_ID":null,"TYLEVAT":null,"GIATRIVAT":null,"MASOTHUE":null,"SOCHUNGTUKETOAN":null,"DAHOANTRA":"0","TRANGTHAI":"DATHUCHIEN","PHONGBAN_ID":null,"PHONGBAN_THAYDOI_ID":null,"CONGTYCHITRA_GIATRI":0.0,"HOIVIEN_GIATRI":0.0,"BENHVIEN_ID":"HLU01","NGAYTAO":"2019-06-03T09:37:07.72","NGUOITAO_ID":691,"NGAYCAPNHAT":"2019-06-03T09:37:07.72","NGUOICAPNHAT_ID":691,"AMOUNT":0.0,"PRODQUANTITY":1,"PRODNAME":"Định lượng Creatinin (máu)"},{"HOADONCHITIET_ID":83142,"HOADON_ID":43017,"VIENPHI_ID":659101,"REF_ID":200485,"REF_TABLE":"TT_DVYEUCAU","DICHVU_ID":4641,"DUOC_ID":null,"LOAI_CHIPHI":"TT","LOAIGIA_ID":2,"SOLUONG":1,"DONGIA_DOANHTHU":21400.0,"THANHTIEN_DOANHTHU":21400.0,"BHYT_TL":1.0,"BHYT_DONGIA":21400.0,"BHYT_THANHTIEN":21400.0,"BHYT_DONGIA_CHITRA":21400.0,"BHYT_THANHTIEN_CHITRA":21400.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"TYLE_THATTHU":null,"GIATRI_THATTHU":0.0,"MIENGIAM_TL":0.0,"MIENGIAM_GIATRI":0.0,"NGANSACH_TL":0.0,"NGANSACH_GIATRI":0.0,"TAITRO_TL":0.0,"TAITRO_GIATRI":0.0,"BHTN_GIATRI":null,"NOIDUNGTHU":null,"CHUNGTUXUATBN_ID":null,"TYLEVAT":null,"GIATRIVAT":null,"MASOTHUE":null,"SOCHUNGTUKETOAN":null,"DAHOANTRA":"0","TRANGTHAI":"DATHUCHIEN","PHONGBAN_ID":null,"PHONGBAN_THAYDOI_ID":null,"CONGTYCHITRA_GIATRI":0.0,"HOIVIEN_GIATRI":0.0,"BENHVIEN_ID":"HLU01","NGAYTAO":"2019-06-03T09:37:07.72","NGUOITAO_ID":691,"NGAYCAPNHAT":"2019-06-03T09:37:07.72","NGUOICAPNHAT_ID":691,"AMOUNT":0.0,"PRODQUANTITY":1,"PRODNAME":"Đo hoạt độ ALT (GPT) [Máu]"},{"HOADONCHITIET_ID":83143,"HOADON_ID":43017,"VIENPHI_ID":659102,"REF_ID":200486,"REF_TABLE":"TT_DVYEUCAU","DICHVU_ID":4642,"DUOC_ID":null,"LOAI_CHIPHI":"TT","LOAIGIA_ID":2,"SOLUONG":1,"DONGIA_DOANHTHU":21400.0,"THANHTIEN_DOANHTHU":21400.0,"BHYT_TL":1.0,"BHYT_DONGIA":21400.0,"BHYT_THANHTIEN":21400.0,"BHYT_DONGIA_CHITRA":21400.0,"BHYT_THANHTIEN_CHITRA":21400.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"TYLE_THATTHU":null,"GIATRI_THATTHU":0.0,"MIENGIAM_TL":0.0,"MIENGIAM_GIATRI":0.0,"NGANSACH_TL":0.0,"NGANSACH_GIATRI":0.0,"TAITRO_TL":0.0,"TAITRO_GIATRI":0.0,"BHTN_GIATRI":null,"NOIDUNGTHU":null,"CHUNGTUXUATBN_ID":null,"TYLEVAT":null,"GIATRIVAT":null,"MASOTHUE":null,"SOCHUNGTUKETOAN":null,"DAHOANTRA":"0","TRANGTHAI":"DATHUCHIEN","PHONGBAN_ID":null,"PHONGBAN_THAYDOI_ID":null,"CONGTYCHITRA_GIATRI":0.0,"HOIVIEN_GIATRI":0.0,"BENHVIEN_ID":"HLU01","NGAYTAO":"2019-06-03T09:37:07.72","NGUOITAO_ID":691,"NGAYCAPNHAT":"2019-06-03T09:37:07.72","NGUOICAPNHAT_ID":691,"AMOUNT":0.0,"PRODQUANTITY":1,"PRODNAME":"Đo hoạt độ AST (GOT) [Máu]"},{"HOADONCHITIET_ID":83144,"HOADON_ID":43017,"VIENPHI_ID":659103,"REF_ID":200487,"REF_TABLE":"TT_DVYEUCAU","DICHVU_ID":4660,"DUOC_ID":null,"LOAI_CHIPHI":"TT","LOAIGIA_ID":2,"SOLUONG":1,"DONGIA_DOANHTHU":26800.0,"THANHTIEN_DOANHTHU":26800.0,"BHYT_TL":1.0,"BHYT_DONGIA":26800.0,"BHYT_THANHTIEN":26800.0,"BHYT_DONGIA_CHITRA":26800.0,"BHYT_THANHTIEN_CHITRA":26800.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"TYLE_THATTHU":null,"GIATRI_THATTHU":0.0,"MIENGIAM_TL":0.0,"MIENGIAM_GIATRI":0.0,"NGANSACH_TL":0.0,"NGANSACH_GIATRI":0.0,"TAITRO_TL":0.0,"TAITRO_GIATRI":0.0,"BHTN_GIATRI":null,"NOIDUNGTHU":null,"CHUNGTUXUATBN_ID":null,"TYLEVAT":null,"GIATRIVAT":null,"MASOTHUE":null,"SOCHUNGTUKETOAN":null,"DAHOANTRA":"0","TRANGTHAI":"DATHUCHIEN","PHONGBAN_ID":null,"PHONGBAN_THAYDOI_ID":null,"CONGTYCHITRA_GIATRI":0.0,"HOIVIEN_GIATRI":0.0,"BENHVIEN_ID":"HLU01","NGAYTAO":"2019-06-03T09:37:07.723","NGUOITAO_ID":691,"NGAYCAPNHAT":"2019-06-03T09:37:07.723","NGUOICAPNHAT_ID":691,"AMOUNT":0.0,"PRODQUANTITY":1,"PRODNAME":"Định lượng Cholesterol toàn phần (máu)"},{"HOADONCHITIET_ID":83145,"HOADON_ID":43017,"VIENPHI_ID":659104,"REF_ID":200488,"REF_TABLE":"TT_DVYEUCAU","DICHVU_ID":4717,"DUOC_ID":null,"LOAI_CHIPHI":"TT","LOAIGIA_ID":2,"SOLUONG":1,"DONGIA_DOANHTHU":26800.0,"THANHTIEN_DOANHTHU":26800.0,"BHYT_TL":1.0,"BHYT_DONGIA":26800.0,"BHYT_THANHTIEN":26800.0,"BHYT_DONGIA_CHITRA":26800.0,"BHYT_THANHTIEN_CHITRA":26800.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"TYLE_THATTHU":null,"GIATRI_THATTHU":0.0,"MIENGIAM_TL":0.0,"MIENGIAM_GIATRI":0.0,"NGANSACH_TL":0.0,"NGANSACH_GIATRI":0.0,"TAITRO_TL":0.0,"TAITRO_GIATRI":0.0,"BHTN_GIATRI":null,"NOIDUNGTHU":null,"CHUNGTUXUATBN_ID":null,"TYLEVAT":null,"GIATRIVAT":null,"MASOTHUE":null,"SOCHUNGTUKETOAN":null,"DAHOANTRA":"0","TRANGTHAI":"DATHUCHIEN","PHONGBAN_ID":null,"PHONGBAN_THAYDOI_ID":null,"CONGTYCHITRA_GIATRI":0.0,"HOIVIEN_GIATRI":0.0,"BENHVIEN_ID":"HLU01","NGAYTAO":"2019-06-03T09:37:07.723","NGUOITAO_ID":691,"NGAYCAPNHAT":"2019-06-03T09:37:07.723","NGUOICAPNHAT_ID":691,"AMOUNT":0.0,"PRODQUANTITY":1,"PRODNAME":"Định lượng Triglycerid (máu) [Máu]"},{"HOADONCHITIET_ID":83146,"HOADON_ID":43017,"VIENPHI_ID":663037,"REF_ID":32851,"REF_TABLE":"TT_NGOAITRU_TOATHUOC","DICHVU_ID":null,"DUOC_ID":897,"LOAI_CHIPHI":"TT","LOAIGIA_ID":null,"SOLUONG":1,"DONGIA_DOANHTHU":210000.0,"THANHTIEN_DOANHTHU":210000.0,"BHYT_TL":1.0,"BHYT_DONGIA":210000.0,"BHYT_THANHTIEN":210000.0,"BHYT_DONGIA_CHITRA":210000.0,"BHYT_THANHTIEN_CHITRA":210000.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":null,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"TYLE_THATTHU":null,"GIATRI_THATTHU":null,"MIENGIAM_TL":null,"MIENGIAM_GIATRI":0.0,"NGANSACH_TL":null,"NGANSACH_GIATRI":null,"TAITRO_TL":null,"TAITRO_GIATRI":null,"BHTN_GIATRI":null,"NOIDUNGTHU":null,"CHUNGTUXUATBN_ID":null,"TYLEVAT":null,"GIATRIVAT":null,"MASOTHUE":null,"SOCHUNGTUKETOAN":null,"DAHOANTRA":"0","TRANGTHAI":"DATHUCHIEN","PHONGBAN_ID":null,"PHONGBAN_THAYDOI_ID":null,"CONGTYCHITRA_GIATRI":0.0,"HOIVIEN_GIATRI":0.0,"BENHVIEN_ID":"HLU01","NGAYTAO":"2019-06-03T09:37:07.723","NGUOITAO_ID":691,"NGAYCAPNHAT":"2019-06-03T09:37:07.723","NGUOICAPNHAT_ID":691,"AMOUNT":0.0,"PRODQUANTITY":1,"PRODNAME":"Glaritus"},{"HOADONCHITIET_ID":83147,"HOADON_ID":43017,"VIENPHI_ID":663038,"REF_ID":32852,"REF_TABLE":"TT_NGOAITRU_TOATHUOC","DICHVU_ID":null,"DUOC_ID":963,"LOAI_CHIPHI":"TT","LOAIGIA_ID":null,"SOLUONG":50,"DONGIA_DOANHTHU":1554.0,"THANHTIEN_DOANHTHU":77700.0,"BHYT_TL":1.0,"BHYT_DONGIA":1554.0,"BHYT_THANHTIEN":77700.0,"BHYT_DONGIA_CHITRA":1554.0,"BHYT_THANHTIEN_CHITRA":77700.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":null,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"TYLE_THATTHU":null,"GIATRI_THATTHU":null,"MIENGIAM_TL":null,"MIENGIAM_GIATRI":0.0,"NGANSACH_TL":null,"NGANSACH_GIATRI":null,"TAITRO_TL":null,"TAITRO_GIATRI":null,"BHTN_GIATRI":null,"NOIDUNGTHU":null,"CHUNGTUXUATBN_ID":null,"TYLEVAT":null,"GIATRIVAT":null,"MASOTHUE":null,"SOCHUNGTUKETOAN":null,"DAHOANTRA":"0","TRANGTHAI":"DATHUCHIEN","PHONGBAN_ID":null,"PHONGBAN_THAYDOI_ID":null,"CONGTYCHITRA_GIATRI":0.0,"HOIVIEN_GIATRI":0.0,"BENHVIEN_ID":"HLU01","NGAYTAO":"2019-06-03T09:37:07.723","NGUOITAO_ID":691,"NGAYCAPNHAT":"2019-06-03T09:37:07.723","NGUOICAPNHAT_ID":691,"AMOUNT":0.0,"PRODQUANTITY":50,"PRODNAME":"(Panangin) 175mg + 166,3mg"}]';        set @jsonHODON_ID = N'[{"HOADON_ID":42981}]';          declare @INVOICE_ID int;        INSERT INTO TT_INVOICE        (KEYINVOICE ,BUYER, [ADDRESS], CUSCODE ,CUSNAME ,PAYMENTMETHOD ,NGAYPHATSINH ,SOHOADON ,GIATRITHUCTHU ,SOTIENBANGCHU        , HUY, NGUOITAO_ID, NGAYTAO, BENHVIEN_ID)        VALUES        ( @param0 ,  @param1 ,  @param2 ,  @param3 ,  @param4 ,  @param5 , CONVERT(DATETIME,  @param6 , 103),  @param7 ,  @param8 ,  @param9         ,'0', '1', Getdate(), 'HLU01')        set @INVOICE_ID = SCOPE_IDENTITY()          insert into TT_INVOICE_HOADON        SELECT @INVOICE_ID, jsonHD.HOADON_ID, 'HLU01'        FROM OPENJSON(@jsonHODON_ID)        WITH ( HOADON_ID int) jsonHD          insert into TT_INVOICE_DETAIL        SELECT @INVOICE_ID, json.HOADON_ID, json.PRODNAME, json.PRODQUANTITY, json.PRODUNIT, json.AMOUNT, '1', getdate() , 'HLU01'        FROM OPENJSON(@json)        WITH ( HOADON_ID int, PRODNAME nvarchar(300), PRODQUANTITY float, PRODUNIT nvarchar(100), AMOUNT float) json]
2019-10-29 17:29:05,005 [1] DEBUG - Statement Id: [EIN00002_INVOICE_Json] Parameters: [@param0=[KEYINVOICE,20191029172900_190042885], @param1=[BUYER,Bùi Đức Điệp], @param2=[ADDRESS,Xã Hà Thái, Huyện Hà Trung, Tỉnh Thanh Hóa], @param3=[CUSCODE,190042885], @param4=[CUSNAME,Bùi Đức Điệp], @param5=[PAYMENTMETHOD,Tiền mặt], @param6=[NGAYPHATSINH,29/10/2019], @param7=[SOHOADON,null], @param8=[GIATRITHUCTHU,900000], @param9=[SOTIENBANGCHU,Chín trăm nghìn đồng chẵn.]]
2019-10-29 17:29:05,005 [1] DEBUG - Statement Id: [EIN00002_INVOICE_Json] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[String, System.String], @param3=[String, System.String], @param4=[String, System.String], @param5=[String, System.String], @param6=[String, System.String], @param7=[System.DBNull, null], @param8=[Double, System.Double], @param9=[String, System.String]]
2019-10-29 17:29:06,216 [1] DEBUG - Statement Id: [EIN00002_INVOICE_Json] PreparedStatement : [declare @json nvarchar(max);        declare @jsonHODON_ID nvarchar(max);        set @json = N'[{"HOADONCHITIET_ID":83137,"HOADON_ID":43017,"VIENPHI_ID":658828,"REF_ID":200314,"REF_TABLE":"TT_DVYEUCAU","DICHVU_ID":5439,"DUOC_ID":null,"LOAI_CHIPHI":"TT","LOAIGIA_ID":2,"SOLUONG":1,"DONGIA_DOANHTHU":33000.0,"THANHTIEN_DOANHTHU":33000.0,"BHYT_TL":1.0,"BHYT_DONGIA":33000.0,"BHYT_THANHTIEN":33000.0,"BHYT_DONGIA_CHITRA":33000.0,"BHYT_THANHTIEN_CHITRA":33000.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"TYLE_THATTHU":null,"GIATRI_THATTHU":0.0,"MIENGIAM_TL":0.0,"MIENGIAM_GIATRI":0.0,"NGANSACH_TL":0.0,"NGANSACH_GIATRI":0.0,"TAITRO_TL":0.0,"TAITRO_GIATRI":0.0,"BHTN_GIATRI":null,"NOIDUNGTHU":null,"CHUNGTUXUATBN_ID":null,"TYLEVAT":null,"GIATRIVAT":null,"MASOTHUE":null,"SOCHUNGTUKETOAN":null,"DAHOANTRA":"0","TRANGTHAI":"DATHUCHIEN","PHONGBAN_ID":null,"PHONGBAN_THAYDOI_ID":null,"CONGTYCHITRA_GIATRI":0.0,"HOIVIEN_GIATRI":0.0,"BENHVIEN_ID":"HLU01","NGAYTAO":"2019-06-03T09:37:07.717","NGUOITAO_ID":691,"NGAYCAPNHAT":"2019-06-03T09:37:07.717","NGUOICAPNHAT_ID":691,"AMOUNT":0.0,"PRODQUANTITY":1,"PRODNAME":"Khám Nội tiết (225)"},{"HOADONCHITIET_ID":83138,"HOADON_ID":43017,"VIENPHI_ID":658829,"REF_ID":200315,"REF_TABLE":"TT_DVYEUCAU","DICHVU_ID":5554,"DUOC_ID":null,"LOAI_CHIPHI":"TT","LOAIGIA_ID":3,"SOLUONG":1,"DONGIA_DOANHTHU":5000.0,"THANHTIEN_DOANHTHU":5000.0,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":5000.0,"GIATRI_HOADON":5000.0,"GIATRI_HOADON_DATHANHTOAN":5000.0,"GIATRI_BIENLAI":5000.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":5000.0,"TYLE_THATTHU":null,"GIATRI_THATTHU":0.0,"MIENGIAM_TL":0.0,"MIENGIAM_GIATRI":0.0,"NGANSACH_TL":0.0,"NGANSACH_GIATRI":0.0,"TAITRO_TL":0.0,"TAITRO_GIATRI":0.0,"BHTN_GIATRI":null,"NOIDUNGTHU":null,"CHUNGTUXUATBN_ID":null,"TYLEVAT":null,"GIATRIVAT":null,"MASOTHUE":null,"SOCHUNGTUKETOAN":null,"DAHOANTRA":"0","TRANGTHAI":"CHUATHUCHIEN","PHONGBAN_ID":null,"PHONGBAN_THAYDOI_ID":null,"CONGTYCHITRA_GIATRI":0.0,"HOIVIEN_GIATRI":0.0,"BENHVIEN_ID":"HLU01","NGAYTAO":"2019-06-03T09:37:07.72","NGUOITAO_ID":691,"NGAYCAPNHAT":"2019-06-03T09:37:07.72","NGUOICAPNHAT_ID":691,"AMOUNT":5000.0,"PRODQUANTITY":1,"PRODNAME":"Sổ khám bệnh (SKB)"},{"HOADONCHITIET_ID":83139,"HOADON_ID":43017,"VIENPHI_ID":659098,"REF_ID":200482,"REF_TABLE":"TT_DVYEUCAU","DICHVU_ID":4681,"DUOC_ID":null,"LOAI_CHIPHI":"TT","LOAIGIA_ID":2,"SOLUONG":1,"DONGIA_DOANHTHU":21400.0,"THANHTIEN_DOANHTHU":21400.0,"BHYT_TL":1.0,"BHYT_DONGIA":21400.0,"BHYT_THANHTIEN":21400.0,"BHYT_DONGIA_CHITRA":21400.0,"BHYT_THANHTIEN_CHITRA":21400.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"TYLE_THATTHU":null,"GIATRI_THATTHU":0.0,"MIENGIAM_TL":0.0,"MIENGIAM_GIATRI":0.0,"NGANSACH_TL":0.0,"NGANSACH_GIATRI":0.0,"TAITRO_TL":0.0,"TAITRO_GIATRI":0.0,"BHTN_GIATRI":null,"NOIDUNGTHU":null,"CHUNGTUXUATBN_ID":null,"TYLEVAT":null,"GIATRIVAT":null,"MASOTHUE":null,"SOCHUNGTUKETOAN":null,"DAHOANTRA":"0","TRANGTHAI":"DATHUCHIEN","PHONGBAN_ID":null,"PHONGBAN_THAYDOI_ID":null,"CONGTYCHITRA_GIATRI":0.0,"HOIVIEN_GIATRI":0.0,"BENHVIEN_ID":"HLU01","NGAYTAO":"2019-06-03T09:37:07.72","NGUOITAO_ID":691,"NGAYCAPNHAT":"2019-06-03T09:37:07.72","NGUOICAPNHAT_ID":691,"AMOUNT":0.0,"PRODQUANTITY":1,"PRODNAME":"Định lượng Glucose [Máu]"},{"HOADONCHITIET_ID":83140,"HOADON_ID":43017,"VIENPHI_ID":659099,"REF_ID":200483,"REF_TABLE":"TT_DVYEUCAU","DICHVU_ID":4722,"DUOC_ID":null,"LOAI_CHIPHI":"TT","LOAIGIA_ID":2,"SOLUONG":1,"DONGIA_DOANHTHU":21400.0,"THANHTIEN_DOANHTHU":21400.0,"BHYT_TL":1.0,"BHYT_DONGIA":21400.0,"BHYT_THANHTIEN":21400.0,"BHYT_DONGIA_CHITRA":21400.0,"BHYT_THANHTIEN_CHITRA":21400.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"TYLE_THATTHU":null,"GIATRI_THATTHU":0.0,"MIENGIAM_TL":0.0,"MIENGIAM_GIATRI":0.0,"NGANSACH_TL":0.0,"NGANSACH_GIATRI":0.0,"TAITRO_TL":0.0,"TAITRO_GIATRI":0.0,"BHTN_GIATRI":null,"NOIDUNGTHU":null,"CHUNGTUXUATBN_ID":null,"TYLEVAT":null,"GIATRIVAT":null,"MASOTHUE":null,"SOCHUNGTUKETOAN":null,"DAHOANTRA":"0","TRANGTHAI":"DATHUCHIEN","PHONGBAN_ID":null,"PHONGBAN_THAYDOI_ID":null,"CONGTYCHITRA_GIATRI":0.0,"HOIVIEN_GIATRI":0.0,"BENHVIEN_ID":"HLU01","NGAYTAO":"2019-06-03T09:37:07.72","NGUOITAO_ID":691,"NGAYCAPNHAT":"2019-06-03T09:37:07.72","NGUOICAPNHAT_ID":691,"AMOUNT":0.0,"PRODQUANTITY":1,"PRODNAME":"Định lượng Urê máu [Máu]"},{"HOADONCHITIET_ID":83141,"HOADON_ID":43017,"VIENPHI_ID":659100,"REF_ID":200484,"REF_TABLE":"TT_DVYEUCAU","DICHVU_ID":4668,"DUOC_ID":null,"LOAI_CHIPHI":"TT","LOAIGIA_ID":2,"SOLUONG":1,"DONGIA_DOANHTHU":21400.0,"THANHTIEN_DOANHTHU":21400.0,"BHYT_TL":1.0,"BHYT_DONGIA":21400.0,"BHYT_THANHTIEN":21400.0,"BHYT_DONGIA_CHITRA":21400.0,"BHYT_THANHTIEN_CHITRA":21400.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"TYLE_THATTHU":null,"GIATRI_THATTHU":0.0,"MIENGIAM_TL":0.0,"MIENGIAM_GIATRI":0.0,"NGANSACH_TL":0.0,"NGANSACH_GIATRI":0.0,"TAITRO_TL":0.0,"TAITRO_GIATRI":0.0,"BHTN_GIATRI":null,"NOIDUNGTHU":null,"CHUNGTUXUATBN_ID":null,"TYLEVAT":null,"GIATRIVAT":null,"MASOTHUE":null,"SOCHUNGTUKETOAN":null,"DAHOANTRA":"0","TRANGTHAI":"DATHUCHIEN","PHONGBAN_ID":null,"PHONGBAN_THAYDOI_ID":null,"CONGTYCHITRA_GIATRI":0.0,"HOIVIEN_GIATRI":0.0,"BENHVIEN_ID":"HLU01","NGAYTAO":"2019-06-03T09:37:07.72","NGUOITAO_ID":691,"NGAYCAPNHAT":"2019-06-03T09:37:07.72","NGUOICAPNHAT_ID":691,"AMOUNT":0.0,"PRODQUANTITY":1,"PRODNAME":"Định lượng Creatinin (máu)"},{"HOADONCHITIET_ID":83142,"HOADON_ID":43017,"VIENPHI_ID":659101,"REF_ID":200485,"REF_TABLE":"TT_DVYEUCAU","DICHVU_ID":4641,"DUOC_ID":null,"LOAI_CHIPHI":"TT","LOAIGIA_ID":2,"SOLUONG":1,"DONGIA_DOANHTHU":21400.0,"THANHTIEN_DOANHTHU":21400.0,"BHYT_TL":1.0,"BHYT_DONGIA":21400.0,"BHYT_THANHTIEN":21400.0,"BHYT_DONGIA_CHITRA":21400.0,"BHYT_THANHTIEN_CHITRA":21400.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"TYLE_THATTHU":null,"GIATRI_THATTHU":0.0,"MIENGIAM_TL":0.0,"MIENGIAM_GIATRI":0.0,"NGANSACH_TL":0.0,"NGANSACH_GIATRI":0.0,"TAITRO_TL":0.0,"TAITRO_GIATRI":0.0,"BHTN_GIATRI":null,"NOIDUNGTHU":null,"CHUNGTUXUATBN_ID":null,"TYLEVAT":null,"GIATRIVAT":null,"MASOTHUE":null,"SOCHUNGTUKETOAN":null,"DAHOANTRA":"0","TRANGTHAI":"DATHUCHIEN","PHONGBAN_ID":null,"PHONGBAN_THAYDOI_ID":null,"CONGTYCHITRA_GIATRI":0.0,"HOIVIEN_GIATRI":0.0,"BENHVIEN_ID":"HLU01","NGAYTAO":"2019-06-03T09:37:07.72","NGUOITAO_ID":691,"NGAYCAPNHAT":"2019-06-03T09:37:07.72","NGUOICAPNHAT_ID":691,"AMOUNT":0.0,"PRODQUANTITY":1,"PRODNAME":"Đo hoạt độ ALT (GPT) [Máu]"},{"HOADONCHITIET_ID":83143,"HOADON_ID":43017,"VIENPHI_ID":659102,"REF_ID":200486,"REF_TABLE":"TT_DVYEUCAU","DICHVU_ID":4642,"DUOC_ID":null,"LOAI_CHIPHI":"TT","LOAIGIA_ID":2,"SOLUONG":1,"DONGIA_DOANHTHU":21400.0,"THANHTIEN_DOANHTHU":21400.0,"BHYT_TL":1.0,"BHYT_DONGIA":21400.0,"BHYT_THANHTIEN":21400.0,"BHYT_DONGIA_CHITRA":21400.0,"BHYT_THANHTIEN_CHITRA":21400.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"TYLE_THATTHU":null,"GIATRI_THATTHU":0.0,"MIENGIAM_TL":0.0,"MIENGIAM_GIATRI":0.0,"NGANSACH_TL":0.0,"NGANSACH_GIATRI":0.0,"TAITRO_TL":0.0,"TAITRO_GIATRI":0.0,"BHTN_GIATRI":null,"NOIDUNGTHU":null,"CHUNGTUXUATBN_ID":null,"TYLEVAT":null,"GIATRIVAT":null,"MASOTHUE":null,"SOCHUNGTUKETOAN":null,"DAHOANTRA":"0","TRANGTHAI":"DATHUCHIEN","PHONGBAN_ID":null,"PHONGBAN_THAYDOI_ID":null,"CONGTYCHITRA_GIATRI":0.0,"HOIVIEN_GIATRI":0.0,"BENHVIEN_ID":"HLU01","NGAYTAO":"2019-06-03T09:37:07.72","NGUOITAO_ID":691,"NGAYCAPNHAT":"2019-06-03T09:37:07.72","NGUOICAPNHAT_ID":691,"AMOUNT":0.0,"PRODQUANTITY":1,"PRODNAME":"Đo hoạt độ AST (GOT) [Máu]"},{"HOADONCHITIET_ID":83144,"HOADON_ID":43017,"VIENPHI_ID":659103,"REF_ID":200487,"REF_TABLE":"TT_DVYEUCAU","DICHVU_ID":4660,"DUOC_ID":null,"LOAI_CHIPHI":"TT","LOAIGIA_ID":2,"SOLUONG":1,"DONGIA_DOANHTHU":26800.0,"THANHTIEN_DOANHTHU":26800.0,"BHYT_TL":1.0,"BHYT_DONGIA":26800.0,"BHYT_THANHTIEN":26800.0,"BHYT_DONGIA_CHITRA":26800.0,"BHYT_THANHTIEN_CHITRA":26800.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"TYLE_THATTHU":null,"GIATRI_THATTHU":0.0,"MIENGIAM_TL":0.0,"MIENGIAM_GIATRI":0.0,"NGANSACH_TL":0.0,"NGANSACH_GIATRI":0.0,"TAITRO_TL":0.0,"TAITRO_GIATRI":0.0,"BHTN_GIATRI":null,"NOIDUNGTHU":null,"CHUNGTUXUATBN_ID":null,"TYLEVAT":null,"GIATRIVAT":null,"MASOTHUE":null,"SOCHUNGTUKETOAN":null,"DAHOANTRA":"0","TRANGTHAI":"DATHUCHIEN","PHONGBAN_ID":null,"PHONGBAN_THAYDOI_ID":null,"CONGTYCHITRA_GIATRI":0.0,"HOIVIEN_GIATRI":0.0,"BENHVIEN_ID":"HLU01","NGAYTAO":"2019-06-03T09:37:07.723","NGUOITAO_ID":691,"NGAYCAPNHAT":"2019-06-03T09:37:07.723","NGUOICAPNHAT_ID":691,"AMOUNT":0.0,"PRODQUANTITY":1,"PRODNAME":"Định lượng Cholesterol toàn phần (máu)"},{"HOADONCHITIET_ID":83145,"HOADON_ID":43017,"VIENPHI_ID":659104,"REF_ID":200488,"REF_TABLE":"TT_DVYEUCAU","DICHVU_ID":4717,"DUOC_ID":null,"LOAI_CHIPHI":"TT","LOAIGIA_ID":2,"SOLUONG":1,"DONGIA_DOANHTHU":26800.0,"THANHTIEN_DOANHTHU":26800.0,"BHYT_TL":1.0,"BHYT_DONGIA":26800.0,"BHYT_THANHTIEN":26800.0,"BHYT_DONGIA_CHITRA":26800.0,"BHYT_THANHTIEN_CHITRA":26800.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"TYLE_THATTHU":null,"GIATRI_THATTHU":0.0,"MIENGIAM_TL":0.0,"MIENGIAM_GIATRI":0.0,"NGANSACH_TL":0.0,"NGANSACH_GIATRI":0.0,"TAITRO_TL":0.0,"TAITRO_GIATRI":0.0,"BHTN_GIATRI":null,"NOIDUNGTHU":null,"CHUNGTUXUATBN_ID":null,"TYLEVAT":null,"GIATRIVAT":null,"MASOTHUE":null,"SOCHUNGTUKETOAN":null,"DAHOANTRA":"0","TRANGTHAI":"DATHUCHIEN","PHONGBAN_ID":null,"PHONGBAN_THAYDOI_ID":null,"CONGTYCHITRA_GIATRI":0.0,"HOIVIEN_GIATRI":0.0,"BENHVIEN_ID":"HLU01","NGAYTAO":"2019-06-03T09:37:07.723","NGUOITAO_ID":691,"NGAYCAPNHAT":"2019-06-03T09:37:07.723","NGUOICAPNHAT_ID":691,"AMOUNT":0.0,"PRODQUANTITY":1,"PRODNAME":"Định lượng Triglycerid (máu) [Máu]"},{"HOADONCHITIET_ID":83146,"HOADON_ID":43017,"VIENPHI_ID":663037,"REF_ID":32851,"REF_TABLE":"TT_NGOAITRU_TOATHUOC","DICHVU_ID":null,"DUOC_ID":897,"LOAI_CHIPHI":"TT","LOAIGIA_ID":null,"SOLUONG":1,"DONGIA_DOANHTHU":210000.0,"THANHTIEN_DOANHTHU":210000.0,"BHYT_TL":1.0,"BHYT_DONGIA":210000.0,"BHYT_THANHTIEN":210000.0,"BHYT_DONGIA_CHITRA":210000.0,"BHYT_THANHTIEN_CHITRA":210000.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":null,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"TYLE_THATTHU":null,"GIATRI_THATTHU":null,"MIENGIAM_TL":null,"MIENGIAM_GIATRI":0.0,"NGANSACH_TL":null,"NGANSACH_GIATRI":null,"TAITRO_TL":null,"TAITRO_GIATRI":null,"BHTN_GIATRI":null,"NOIDUNGTHU":null,"CHUNGTUXUATBN_ID":null,"TYLEVAT":null,"GIATRIVAT":null,"MASOTHUE":null,"SOCHUNGTUKETOAN":null,"DAHOANTRA":"0","TRANGTHAI":"DATHUCHIEN","PHONGBAN_ID":null,"PHONGBAN_THAYDOI_ID":null,"CONGTYCHITRA_GIATRI":0.0,"HOIVIEN_GIATRI":0.0,"BENHVIEN_ID":"HLU01","NGAYTAO":"2019-06-03T09:37:07.723","NGUOITAO_ID":691,"NGAYCAPNHAT":"2019-06-03T09:37:07.723","NGUOICAPNHAT_ID":691,"AMOUNT":0.0,"PRODQUANTITY":1,"PRODNAME":"Glaritus"},{"HOADONCHITIET_ID":83147,"HOADON_ID":43017,"VIENPHI_ID":663038,"REF_ID":32852,"REF_TABLE":"TT_NGOAITRU_TOATHUOC","DICHVU_ID":null,"DUOC_ID":963,"LOAI_CHIPHI":"TT","LOAIGIA_ID":null,"SOLUONG":50,"DONGIA_DOANHTHU":1554.0,"THANHTIEN_DOANHTHU":77700.0,"BHYT_TL":1.0,"BHYT_DONGIA":1554.0,"BHYT_THANHTIEN":77700.0,"BHYT_DONGIA_CHITRA":1554.0,"BHYT_THANHTIEN_CHITRA":77700.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":null,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"TYLE_THATTHU":null,"GIATRI_THATTHU":null,"MIENGIAM_TL":null,"MIENGIAM_GIATRI":0.0,"NGANSACH_TL":null,"NGANSACH_GIATRI":null,"TAITRO_TL":null,"TAITRO_GIATRI":null,"BHTN_GIATRI":null,"NOIDUNGTHU":null,"CHUNGTUXUATBN_ID":null,"TYLEVAT":null,"GIATRIVAT":null,"MASOTHUE":null,"SOCHUNGTUKETOAN":null,"DAHOANTRA":"0","TRANGTHAI":"DATHUCHIEN","PHONGBAN_ID":null,"PHONGBAN_THAYDOI_ID":null,"CONGTYCHITRA_GIATRI":0.0,"HOIVIEN_GIATRI":0.0,"BENHVIEN_ID":"HLU01","NGAYTAO":"2019-06-03T09:37:07.723","NGUOITAO_ID":691,"NGAYCAPNHAT":"2019-06-03T09:37:07.723","NGUOICAPNHAT_ID":691,"AMOUNT":0.0,"PRODQUANTITY":50,"PRODNAME":"(Panangin) 175mg + 166,3mg"}]';        set @jsonHODON_ID = N'[{"HOADON_ID":43017}]';          declare @INVOICE_ID int;        INSERT INTO TT_INVOICE        (KEYINVOICE ,BUYER, [ADDRESS], CUSCODE ,CUSNAME ,PAYMENTMETHOD ,NGAYPHATSINH ,SOHOADON ,GIATRITHUCTHU ,SOTIENBANGCHU        , HUY, NGUOITAO_ID, NGAYTAO, BENHVIEN_ID)        VALUES        ( @param0 ,  @param1 ,  @param2 ,  @param3 ,  @param4 ,  @param5 , CONVERT(DATETIME,  @param6 , 103),  @param7 ,  @param8 ,  @param9         ,'0', '1', Getdate(), 'HLU01')        set @INVOICE_ID = SCOPE_IDENTITY()          insert into TT_INVOICE_HOADON        SELECT @INVOICE_ID, jsonHD.HOADON_ID, 'HLU01'        FROM OPENJSON(@jsonHODON_ID)        WITH ( HOADON_ID int) jsonHD          insert into TT_INVOICE_DETAIL        SELECT @INVOICE_ID, json.HOADON_ID, json.PRODNAME, json.PRODQUANTITY, json.PRODUNIT, json.AMOUNT, '1', getdate() , 'HLU01'        FROM OPENJSON(@json)        WITH ( HOADON_ID int, PRODNAME nvarchar(300), PRODQUANTITY float, PRODUNIT nvarchar(100), AMOUNT float) json]
2019-10-29 17:29:06,216 [1] DEBUG - Statement Id: [EIN00002_INVOICE_Json] Parameters: [@param0=[KEYINVOICE,20191029172905_190022821], @param1=[BUYER,Bùi Ngọc Linh], @param2=[ADDRESS, Phường Đông Thọ, Thành phố Thanh Hóa, Tỉnh Thanh Hóa], @param3=[CUSCODE,190022821], @param4=[CUSNAME,Bùi Ngọc Linh], @param5=[PAYMENTMETHOD,Tiền mặt], @param6=[NGAYPHATSINH,29/10/2019], @param7=[SOHOADON,null], @param8=[GIATRITHUCTHU,5000], @param9=[SOTIENBANGCHU,Năm nghìn đồng chẵn.]]
2019-10-29 17:29:06,216 [1] DEBUG - Statement Id: [EIN00002_INVOICE_Json] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[String, System.String], @param3=[String, System.String], @param4=[String, System.String], @param5=[String, System.String], @param6=[String, System.String], @param7=[System.DBNull, null], @param8=[Double, System.Double], @param9=[String, System.String]]
2019-10-29 17:29:06,360 [1] DEBUG - Statement Id: [EIN00002_GetChiTietHoaDon] PreparedStatement : [select distinct hdct.*, hdct.GIATRI_BENHNHAN_DATHANHTOAN AMOUNT, hdct.SOLUONG PRODQUANTITY,        isnull(dv.TENDICHVU, dc.TENDUOCDAYDU) PRODNAME        from TT_HOADON_CHITIET_NGOAITRU hdct        left join TM_DICHVU dv on dv.DICHVU_ID = hdct.DICHVU_ID and hdct.DUOC_ID is null        left join TM_DUOC dc on dc.DUOC_ID = hdct.DUOC_ID and hdct.DICHVU_ID is null        where HOADON_ID = 43017]
2019-10-29 17:29:11,114 [1] DEBUG - Statement Id: [EIN00002_GetHoaDonDaXuatLenCong] PreparedStatement : [select * from TT_INVOICE hd        where         HUY = '0'         and           convert(date, hd.NGAYPHATSINH) >= convert(date, '6/1/2019 12:00:00 AM')       and         convert(date, hd.NGAYPHATSINH) <= convert(date, '10/29/2019 12:00:00 AM')]
