--------------------------------------------------------------------------------
2020-03-26 10:47:23,466 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2020-03-26 10:47:24,333 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2020-03-26 10:47:24,387 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2020-03-26 10:47:25,645 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 10:47:26,874 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2020-03-26 10:48:02,079 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '01819' and TYPE = 'D']
2020-03-26 10:48:02,109 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '01819' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2020-03-26 10:48:10,267 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '01819')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '01819' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2020-03-26 10:48:10,477 [6] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2020-03-26 10:48:10,836 [6] DEBUG - Statement Id: [DAO00004_GetList] PreparedStatement : [declare @BOOTS varchar(15)              select @BOOTS = VALUE from TM_SYS_APPSETTINGS BOOST where CODE = 'APP_LOCATION_DVHC'  and BENHVIEN_ID = '01819'              select              TINH.TENDONVI AS TINH              , TINH.TENTAT AS TENTATTINH              , HUYEN.TENDONVI AS HUYEN              , HUYEN.TENTAT AS TENTATHUYEN              , XA.TENDONVI AS XA              , XA.MADONVI              , (XA.TENDONVI + ' ' + HUYEN.TENDONVI + ' ' + TINH.TENDONVI) AS TENTIMKIEM              , (XA.TENDAYDU + ', ' + HUYEN.TENDAYDU + ', ' + TINH.TENDAYDU) AS TENDAYDU,              XA.TENTAT AS TENTATXA,              (CASE              WHEN TINH.MADONVI  = @BOOTS              THEN 1              ELSE 0              END) as BOOST_SCORED              FROM TM_DONVIHANHCHINH XA              JOIN TM_DONVIHANHCHINH HUYEN ON (XA.CAPTREN_ID = HUYEN.DONVIHANHCHINH_ID AND XA.CAPDONVI = 4)              JOIN TM_DONVIHANHCHINH TINH ON (HUYEN.CAPTREN_ID = TINH.DONVIHANHCHINH_ID AND HUYEN.CAPDONVI = 3)              WHERE XA.TAMNGUNG != '1'              ORDER BY BOOST_SCORED desc, TINH, HUYEN, XA asc]
2020-03-26 10:48:16,094 [6] DEBUG - Statement Id: [DAO00106_GetList] PreparedStatement : [select * from TM_ICD_CHUONG              where TAMNGUNG = 0              and BENHVIEN_ID = '01819']
2020-03-26 10:48:17,236 [6] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2020-03-26 10:48:20,031 [6] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2020-03-26 10:48:20,145 [6] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2020-03-26 10:48:20,264 [6] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2020-03-26 10:48:20,414 [6] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2020-03-26 10:48:20,560 [6] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2020-03-26 10:48:20,720 [6] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2020-03-26 10:48:20,796 [6] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2020-03-26 10:48:20,870 [6] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2020-03-26 10:48:20,958 [6] DEBUG - Statement Id: [DAO00034_GetList] PreparedStatement : [select *            from TM_BENHVIEN where isnull(TAMNGUNG,0) = '0']
2020-03-26 10:48:27,142 [6] DEBUG - Statement Id: [DAO00039_GetList] PreparedStatement : [select *              from TM_CHUYENKHOA              where BENHVIEN_ID = '01819']
2020-03-26 10:48:27,398 [6] DEBUG - Statement Id: [DAO00041_GetList] PreparedStatement : [declare @ManhomDSA varchar(10);            declare @PhanLoaiNhomDV varchar(20) = '';            select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'            if (@ManhomDSA is not null and '05' in (select * from STRING_SPLIT('', ',')))             set @PhanLoaiNhomDV += ',' + @ManhomDSA              select * from            (select dv.*, ndv.LOAIDICHVU_ID, ndv.MANHOMDICHVU, ndv.TENNHOMDICHVU as TENNHOMDICHVU,            ndv.TENKHONGDAU as TENNDVKHONGDAU, ndv.TENNHOMDICHVU_EN, ndv.TENNHOMDICHVU_RU,            CASE            WHEN @ManhomDSA is not null and ndv.MANHOMDICHVU in (@ManhomDSA) THEN ndv.MANHOMDICHVU            WHEN Left(ndv.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(ndv.MANHOMDICHVU,2)            END AS PHANLOAI_MANHOMDICHVU            from TM_DICHVU dv            left join TM_NHOMDICHVU ndv on dv.NHOMDICHVU_ID = ndv.NHOMDICHVU_ID                           where ndv.TAMNGUNG = '0' and dv.TAMNGUNG = '0' and dv.BENHVIEN_ID = '01819') as tbl]
2020-03-26 10:48:30,752 [6] DEBUG - Statement Id: [DAO00041_GetList_DVAll] PreparedStatement : [select * from          (select dv.*, ndv.LOAIDICHVU_ID, ndv.MANHOMDICHVU, ndv.TENNHOMDICHVU as TENNHOMDICHVU,          ndv.TENKHONGDAU as TENNDVKHONGDAU, ndv.TENNHOMDICHVU_EN, ndv.TENNHOMDICHVU_RU,          CASE WHEN Left(ndv.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(ndv.MANHOMDICHVU,2) END AS PHANLOAI_MANHOMDICHVU          from TM_DICHVU dv          left join TM_NHOMDICHVU ndv on dv.NHOMDICHVU_ID = ndv.NHOMDICHVU_ID                     where dv.BENHVIEN_ID = '01819') as tbl]
2020-03-26 10:48:35,783 [6] DEBUG - Statement Id: [DAO00016_GetList] PreparedStatement : [select TM_LOAIDUOC.MALOAIDUOC, TM_DUOC.*, TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.TENDUOC_RU, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID,TM_LOAIVATTU.TENLOAIVATTU        from TM_DUOC        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_TENDUOC.BENHVIEN_ID = '01819'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = '01819'        left join TM_LOAIVATTU on TM_LOAIDUOC.LOAIVATTU_ID=TM_LOAIVATTU.LOAIVATTU_ID and TM_LOAIVATTU.BENHVIEN_ID = '01819'        where        TM_DUOC.BENHVIEN_ID = '01819'                 order by DUOC_ID]
2020-03-26 10:48:39,460 [6] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2020-03-26 10:48:39,523 [6] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = '01819' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = '01819'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = '01819')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = '01819' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = '01819'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = '01819' AND TT_TONKHO.SOLUONG >= 0]
2020-03-26 10:48:39,635 [6] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2020-03-26 10:48:39,677 [6] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = '01819' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = '01819'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = '01819')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = '01819' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = '01819' and TT_TONKHO.SOLUONG >= 0]
2020-03-26 10:48:40,948 [6] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2020-03-26 10:48:41,009 [6] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @NGUONDUOC_MACDINH varchar(5) = '0';        declare @TOAMUANGOAI int = 0;        select @NGUONDUOC_MACDINH = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'PHA_NGUONDUOC'        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + @NGUONDUOC_MACDINH as DUOC_KEY, 0 as PHAMVI_ID, @NGUONDUOC_MACDINH as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = '01819'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = '01819')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = '01819'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = '01819')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = '01819'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = '01819'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = '01819'        where d.BENHVIEN_ID = '01819'  and tk.SOLUONG >= 0        end        else        begin                select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = '01819'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = '01819')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (        select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID)        B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (        select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID)        A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = '01819'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = '01819'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = '01819'        where d.BENHVIEN_ID = '01819'  and tk.SOLUONG >= 0        end]
2020-03-26 10:48:43,498 [6] DEBUG - Statement Id: [DAO00005_GetList] PreparedStatement : [select *              from TM_GENDER]
2020-03-26 10:48:44,105 [6] DEBUG - Statement Id: [DAO00320_GetList] PreparedStatement : [select M.*            from TM_MAU M            LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID            where            M.TAMNGUNG = '0'            and M.BENHVIEN_ID = '01819'            order by M.TENMAU]
2020-03-26 10:48:44,431 [6] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2020-03-26 10:48:44,527 [6] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,        SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH        FROM TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID        WHERE TK.SOLUONG > 0        GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2020-03-26 10:48:44,646 [6] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2020-03-26 10:48:44,686 [6] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,        TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,        TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH        from TM_MAU M        JOIN        (        select        A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO        from        (        select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO        from TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'        where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0        ) A        )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2020-03-26 10:48:44,809 [6] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2020-03-26 10:48:45,802 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 10:48:49,647 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = '01819']
2020-03-26 10:48:59,622 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = '01819' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2020-03-26 10:48:59,700 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = '01819'              order by SETTING_ID]
2020-03-26 10:48:59,827 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 10:49:00,053 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 10:49:00,521 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2020-03-26 10:49:00,584 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,01819], @param1=[ACCOUNT_ID,113]]
2020-03-26 10:49:00,584 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2020-03-26 10:49:00,641 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2020-03-26 10:49:00,641 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,01819], @param1=[ACCOUNT_ID,113]]
2020-03-26 10:49:00,641 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2020-03-26 10:49:00,702 [1] DEBUG - Statement Id: [DAO00028_GetInventories] PreparedStatement : [select distinct kd.KHO_ID,MAKHO, TENKHO, LOAIKHO_ID,          CASE WHEN KHOQUANLY_ID IS NULL THEN 0  ELSE KHOQUANLY_ID  END  AS KHOQUANLY_ID,          module.DICTIONARY_CODE AS MODULE_CODE, module.DICTIONARY_NAME AS MODULE_NAME, module.DICTIONARY_ID AS MODULE_ID          from TM_KHO kd          left join LST_DICTIONARY lst on lst.DICTIONARY_ID = kd.LOAIKHO_ID          left join LST_DICTIONARY module on module.DICTIONARY_ID = kd.MODULE_ID          inner join TM_PHONGBAN_KHO k on k.KHO_ID = kd.KHO_ID          where kd.TAMNGUNG = '0'          and kd.BENHVIEN_ID = '01819']
2020-03-26 10:49:01,093 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 10:49:01,558 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 10:49:02,286 [1] DEBUG - Statement Id: [DAO00015_GetList] PreparedStatement : [select n.MANHOMICD, n.ICD_NHOM_ID as NHOM_ICD_ID, n.TENNHOMICD,              c.MACHUONGICD, c.ICD_CHUONG_ID, c.TENCHUONGICD, i.*              from TM_ICD i              left join TM_ICD_NHOM n on i.ICD_NHOM_ID = n.ICD_NHOM_ID              left join TM_ICD_CHUONG c on n.ICD_CHUONG_ID = c.ICD_CHUONG_ID              where i.TAMNGUNG = 0              and n.TAMNGUNG = 0              and c.TAMNGUNG = 0              and i.BENHVIEN_ID = '01819']
2020-03-26 10:49:09,231 [1] DEBUG - Statement Id: [DAO00018_GetList] PreparedStatement : [select A.*, B.DICTIONARY_NAME, B.DICTIONARY_CODE, B.DICTIONARY_NAME_EN CHUCDANH, (B.DICTIONARY_NAME_EN + '. ' + A.TENNHANVIEN) TENHOCVIHOCHAM            from TM_NHANVIEN A            left join (select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE = 'chucdanh' and DICTIONARY_NAME_EN is not null) B on A.CHUCDANH_ID = B.DICTIONARY_ID            where A.BENHVIEN_ID = '01819' and A.TAMNGUNG = '0'             and               exists (select DICTIONARY_ID from LST_DICTIONARY where A.CHUCDANH_ID = DICTIONARY_ID and DICTIONARY_CODE in ('BS', 'BSCKDH', '4', '5', '45'))]
2020-03-26 10:49:10,620 [1] DEBUG - Statement Id: [DAO00018_GetList] PreparedStatement : [select A.*, B.DICTIONARY_NAME, B.DICTIONARY_CODE, B.DICTIONARY_NAME_EN CHUCDANH, (B.DICTIONARY_NAME_EN + '. ' + A.TENNHANVIEN) TENHOCVIHOCHAM            from TM_NHANVIEN A            left join (select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE = 'chucdanh' and DICTIONARY_NAME_EN is not null) B on A.CHUCDANH_ID = B.DICTIONARY_ID            where A.BENHVIEN_ID = '01819' and A.TAMNGUNG = '0']
2020-03-26 10:49:11,439 [1] DEBUG - Statement Id: [DAO00012_GetList] PreparedStatement : [select        DICTIONARY_ID,        DICTIONARY_CODE,        DICTIONARY_NAME,        ATTRIBUTE1,        ATTRIBUTE2,        DICTIONARY_NAME_EN,        DICTIONARY_TYPE_CODE        from LST_DICTIONARY        where LST_DICTIONARY.Enabled = '1'         AND           LST_DICTIONARY.DICTIONARY_TYPE_CODE = 'CLS_LoaiThuocCanQuang'                 order by LST_DICTIONARY.IDX]
2020-03-26 10:49:11,865 [1] DEBUG - Statement Id: [DAO00012_GetList] PreparedStatement : [select        DICTIONARY_ID,        DICTIONARY_CODE,        DICTIONARY_NAME,        ATTRIBUTE1,        ATTRIBUTE2,        DICTIONARY_NAME_EN,        DICTIONARY_TYPE_CODE        from LST_DICTIONARY        where LST_DICTIONARY.Enabled = '1'         AND           LST_DICTIONARY.DICTIONARY_TYPE_CODE = 'CLS_LoaiPhim'                 order by LST_DICTIONARY.IDX]
2020-03-26 10:49:36,184 [1] DEBUG - Statement Id: [DAO00045_GetList] PreparedStatement : [SELECT            TM_DICHVU.DICHVU_ID, TM_NHOMDICHVU.NHOMDICHVU_ID, TM_NHOMDICHVU.MANHOMDICHVU, TM_DICHVU.MADICHVU, TM_NHOMDICHVU.TENNHOMDICHVU,            TM_NHOMDICHVU.TENNHOMDICHVU_EN, TM_NHOMDICHVU.TENNHOMDICHVU_RU, TM_NHOMDICHVU.CAP, TM_NHOMDICHVU.CAPTREN_ID, TM_DICHVU.TENDICHVU,            TM_DICHVU.BENHVIEN_ID, TM_DICHVU.CHONHETCAPDUOI, TM_DICHVU.CAPTREN_ID AS DICHVU_CAPTREN_ID            FROM            TM_DICHVU            INNER JOIN            TM_NHOMDICHVU ON TM_DICHVU.NHOMDICHVU_ID = TM_NHOMDICHVU.NHOMDICHVU_ID AND TM_DICHVU.BENHVIEN_ID = TM_NHOMDICHVU.BENHVIEN_ID            where left(MANHOMDICHVU,2) in (02, 03)            and TM_DICHVU.BENHVIEN_ID = '01819']
2020-03-26 10:49:36,861 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 10:49:37,118 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = '01819' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2020-03-26 10:49:38,686 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = '01819' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2020-03-26 11:08:40,975 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'BIL27'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 11:08:41,596 [1] DEBUG - Statement Id: [DAO00018_GetList] PreparedStatement : [select A.*, B.DICTIONARY_NAME, B.DICTIONARY_CODE, B.DICTIONARY_NAME_EN CHUCDANH, (B.DICTIONARY_NAME_EN + '. ' + A.TENNHANVIEN) TENHOCVIHOCHAM            from TM_NHANVIEN A            left join (select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE = 'chucdanh' and DICTIONARY_NAME_EN is not null) B on A.CHUCDANH_ID = B.DICTIONARY_ID            where A.BENHVIEN_ID = '01819' and A.TAMNGUNG = '0']
2020-03-26 11:08:42,534 [1] DEBUG - Statement Id: [DAO00012_GetList] PreparedStatement : [select        DICTIONARY_ID,        DICTIONARY_CODE,        DICTIONARY_NAME,        ATTRIBUTE1,        ATTRIBUTE2,        DICTIONARY_NAME_EN,        DICTIONARY_TYPE_CODE        from LST_DICTIONARY        where LST_DICTIONARY.Enabled = '1'         AND           LST_DICTIONARY.DICTIONARY_TYPE_CODE = 'LoaiHoaDon'                 order by LST_DICTIONARY.IDX]
2020-03-26 11:08:43,142 [1] DEBUG - Statement Id: [DAO00119_GetDanhsachHTTT] PreparedStatement : [select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE = 'HinhThucThanhToan' and ENABLED = '1' and BENHVIEN_ID = '01819']
2020-03-26 11:08:45,267 [1] DEBUG - Statement Id: [DAO00101_GetListSuatAn] PreparedStatement : [SELECT        kP.KHAUPHANAN_ID,        kP.MAKHAUPHANAN,        kP.TENKHAUPHANAN,        LKP.LOAIKHAUPHANAN_ID,        LKP.MALOAIKHAUPHANAN,        LKP.TENLOAIKHAUPHANAN,        DG.DONGIA,        kP.HANGMUC_ID        FROM TM_NUT_KHAUPHANAN kP        INNER JOIN TM_NUT_LOAIKHAUPHANAN LKP ON  kP.LOAIKHAUPHANAN_ID = LKP.LOAIKHAUPHANAN_ID        INNER JOIN TM_NUT_KHAUPHANAN_DONGIA DG ON DG.KHAUPHANAN_ID = kP.KHAUPHANAN_ID        WHERE DG.DONGIA IS NOT NULL]
2020-03-26 11:08:52,014 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'COM31'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 11:08:52,204 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'BIL18'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 11:08:53,505 [1] DEBUG - Statement Id: [DAO00119_GetDanhsachHTTT] PreparedStatement : [select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE = 'HinhThucThanhToan' and ENABLED = '1' and BENHVIEN_ID = '01819']
2020-03-26 11:08:53,922 [1] DEBUG - Statement Id: [DAO00101_GetListSuatAn] PreparedStatement : [SELECT        kP.KHAUPHANAN_ID,        kP.MAKHAUPHANAN,        kP.TENKHAUPHANAN,        LKP.LOAIKHAUPHANAN_ID,        LKP.MALOAIKHAUPHANAN,        LKP.TENLOAIKHAUPHANAN,        DG.DONGIA,        kP.HANGMUC_ID        FROM TM_NUT_KHAUPHANAN kP        INNER JOIN TM_NUT_LOAIKHAUPHANAN LKP ON  kP.LOAIKHAUPHANAN_ID = LKP.LOAIKHAUPHANAN_ID        INNER JOIN TM_NUT_KHAUPHANAN_DONGIA DG ON DG.KHAUPHANAN_ID = kP.KHAUPHANAN_ID        WHERE DG.DONGIA IS NOT NULL]
2020-03-26 11:09:03,520 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'COM56'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 11:09:03,803 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'COM98'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 11:09:16,862 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NOITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = a.BENHAN_ID                 where(                             A.HUYHOADON = '1'                                             )                       and                           convert(date,A.NGAYHOADON) between convert(date, '3/1/2020 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is not null                order by A.NGAYHOADON]
2020-03-26 11:09:17,424 [1] DEBUG - Statement Id: [DAO00017_GetList] PreparedStatement : [select A.*, B.DICTIONARY_CODE from TM_PHONGBAN A            inner join LST_DICTIONARY B on A.LOAIPHONGBAN_ID = B.DICTIONARY_ID            and B.DICTIONARY_TYPE_CODE = 'LoaiPhongBan'            where A.BENHVIEN_ID = '01819' AND A.TAMNGUNG = '0'  order by A.TENPHONGBAN asc]
2020-03-26 11:09:26,701 [1] DEBUG - Statement Id: [DAO00019_ThongTinBenhNhanBenhAn] PreparedStatement : [select distinct C.SOBENHAN, C.BENHAN_ID, A.SOTIEPNHAN, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI, A.SOBHYT,        B.*        from TT_NOITRU_BENHAN C        inner join TT_TIEPNHAN A on C.TIEPNHAN_ID = A.TIEPNHAN_ID        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'        where                    C.SOBENHAN = '20.002255'                 and A.BENHVIEN_ID = '01819']
2020-03-26 11:09:27,491 [1] DEBUG - Statement Id: [DAO00012_GetList] PreparedStatement : [select        DICTIONARY_ID,        DICTIONARY_CODE,        DICTIONARY_NAME,        ATTRIBUTE1,        ATTRIBUTE2,        DICTIONARY_NAME_EN,        DICTIONARY_TYPE_CODE        from LST_DICTIONARY        where LST_DICTIONARY.Enabled = '1'         AND           LST_DICTIONARY.DICTIONARY_TYPE_CODE = 'NgheNghiep'                 order by LST_DICTIONARY.IDX]
2020-03-26 11:09:27,728 [1] DEBUG - Statement Id: [DAO00031_GetList] PreparedStatement : [select *              from TM_DOITUONG              where ACTIVE = 1 and BENHVIEN_ID = '01819']
2020-03-26 11:09:27,995 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_HINHTHUCTHANHTOAN_GetList] PreparedStatement : [select TT_HOADON_HINHTHUCTHANHTOAN.*, htttCode.DICTIONARY_CODE HINHTHUCTHANHTOAN_CODE            from TT_HOADON_HINHTHUCTHANHTOAN TT_HOADON_HINHTHUCTHANHTOAN            left join (select DICTIONARY_ID, DICTIONARY_CODE from LST_DICTIONARY where DICTIONARY_TYPE_CODE like 'HinhThucThanhToan') htttCode on htttCode.DICTIONARY_ID = TT_HOADON_HINHTHUCTHANHTOAN.HINHTHUCTHANHTOAN_ID             where                             TT_HOADON_HINHTHUCTHANHTOAN.HOADON_ID = '106692'                       and                           TT_HOADON_HINHTHUCTHANHTOAN.BENHVIEN_ID = '01819'                                     order by HOADON_HTTT_ID]
2020-03-26 11:09:28,343 [1] DEBUG - Statement Id: [DAO00119_TT_VIENPHI_GetList_BenhAnByHoadon] PreparedStatement : [select  a.*, a.MIENGIAM_GIATRI as GIATRIMIENGIAM_BH, a.BHTN_GIATRI as GIATRIMIENGIAM_BHTN,        a.HOIVIEN_GIATRI as GIATRIMIENGIAM_THANHVIEN, a.CONGTYCHITRA_GIATRI as GIATRIMIENGIAM_CTCT,        isnull(dv.TENDICHVU, dc.TENDUOCDAYDU) NOIDUNG, isnull(dv.MADICHVU, dc.MADUOC) MADICHVU, dv.NORESULT, dc.DONVITINH, ld.MALOAIDUOC, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ndv.MANHOMDICHVU        from        (        select * from (        select vp.*, c.NOITHUCHIEN_ID, c.NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_DVYEUCAU c on c.DVYEUCAU_ID = VP.REF_ID and vpp.REF_TABLE = 'TT_DVYEUCAU'        union        select vp.*, C.PHONGBANRATOA_ID as NOITHUCHIEN_ID, D.PHONGBAN_ID NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_NOITRU_TOATHUOC c on c.TOATHUOC_ID = VP.REF_ID and vpp.REF_TABLE = 'TT_NOITRU_TOATHUOC'        inner join TT_NOITRU_KHAMBENH D on D.KHAMBENH_ID = C.KHAMBENH_ID        union        select vp.*, C.PHONGBAN_ID as NOITHUCHIEN_ID, C.PHONGBAN_ID as NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_CLSKETQUA_VTYT c on c.CLSKETQUA_VTYT_ID = VP.REF_ID and vpp.REF_TABLE = 'TT_CLSKETQUA_VTYT'        union        select vp.*, ISNULL(D.PHONGBANTHUCHIEN_ID,d.PHONGBANCHIDINH_ID) as NOITHUCHIEN_ID, ISNULL(D.PHONGBANCHIDINH_ID,D.PHONGBANTHUCHIEN_ID) as NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_PHAUTHUAT_VTYT c on c.PHAUTHUAT_VTYT_ID = VP.REF_ID and vpp.REF_TABLE = 'TT_PHAUTHUAT_VTYT'        inner join TT_PHAUTHUAT D on D.PHAUTHUAT_ID = C.PHAUTHUAT_ID        union        select vp.*, c.PHONGBAN_ID as NOITHUCHIEN_ID, c.PHONGBAN_ID as NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_NGOAITRU_KHAMBENH_VTYT c on c.KHAMBENH_VTYT_ID = VP.REF_ID and vpp.REF_TABLE = 'TT_NGOAITRU_KHAMBENH_VTYT'        union        select vp.*, E.PHONGBAN_ID as NOITHUCHIEN_ID, E.PHONGBAN_ID as NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_NUT_XACNHANSUATAN_CHITIET XNC on XNC.XACNHANSUATANCHITIET_ID = vp.REF_ID and vpp.REF_TABLE = 'TT_NUT_XACNHANSUATAN_CHITIET'        inner join TT_NUT_CHIDINHKHAUPHAN_CHITIET D on D.CHIDINHKHAUPHANCHITIET_ID = XNC.CHIDINHKHAUPHANCHITIET_ID        inner join TM_NUT_KHAUPHANAN c on C.KHAUPHANAN_ID = D.KHAUPHANAN_ID        inner join TT_NUT_CHIDINHKHAUPHAN E on E.CHIDINHKHAUPHAN_ID = D.CHIDINHKHAUPHAN_ID        ) B        where B.HOADON_ID = '106692'        ) a        left join TM_DUOC dc on a.DUOC_ID = dc.DUOC_ID        left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID        left join TM_DICHVU dv on a.DICHVU_ID = dv.DICHVU_ID and a.REF_TABLE = 'TT_DVYEUCAU'        left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID]
2020-03-26 11:09:28,990 [1] DEBUG - Statement Id: [DAO00056_GetList] PreparedStatement : [select * from TM_LOAIGIA where BENHVIEN_ID = '01819']
2020-03-26 11:09:29,185 [1] DEBUG - Statement Id: [DAO00194_GetList] PreparedStatement : [select A.* from TM_PHONGBAN A        inner join LST_DICTIONARY B on A.LOAIPHONGBAN_ID = B.DICTIONARY_ID        and B.DICTIONARY_TYPE_CODE = 'LoaiPhongBan' and B.DICTIONARY_CODE not in ('PhongMo','PhongBenh')        where A.BENHVIEN_ID = '01819' order by A.TENPHONGBAN asc]
2020-03-26 11:09:29,529 [1] DEBUG - Statement Id: [DAO00091_GetList] PreparedStatement : [select DICHVU_ID from TM_DICHVU_PHANNHOMDICHVU        where PHANNHOMDICHVU_ID in (select PHANNHOMDICHVU_ID                                    from TM_PHANNHOMDICHVU                                    where MAPHANNHOMDICHVU = 'KTC')        and BENHVIEN_ID = '01819']
2020-03-26 11:09:30,530 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 11:09:30,530 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 11:09:30,530 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2020-03-26 11:09:30,612 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1              and               BLCT.BIENLAICHITIET_ID = '1067'                         order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 11:09:30,612 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 11:09:30,612 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2020-03-26 11:09:30,668 [1] DEBUG - Statement Id: [DAO00014_GetInPatientStatus] PreparedStatement : [select TRANGTHAI, isnull(KHOACHUYENDEN_ID, KHOAVAO_ID) as KHOAHIENTAI from TT_NOITRU_BENHAN        where        TIEPNHAN_ID = '104260'        and BENHVIEN_ID = '01819'         and           BENHAN_ID = '19427']
2020-03-26 11:09:49,403 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NOITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = a.BENHAN_ID                 where(                           (A.DATHANHTOAN = '1'                         and                           A.TRANGTHAI != 'DADUYETCONGNO'                         )                          and (A.HUYHOADON is null or A.HUYHOADON = '0')                          and (A.HOANTRA is null or A.HOANTRA = '0')                                             )                       and                           A.TIEPNHAN_ID = '104260'                       and                           A.BENHAN_ID = '19427'                       and                         (bn.TENBENHNHAN like '%' +  @param0  + '%' or bn.MAYTE like '%' +  @param0  + '%')                       and                           convert(date,A.NGAYHOADON) between convert(date, '3/26/2020 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is not null  and                           ntba.BENHAN_ID = '19427'                                       order by A.NGAYHOADON]
2020-03-26 11:09:49,403 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] Parameters: [@param0=[TENBENHNHAN,190033170]]
2020-03-26 11:09:49,403 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] Types: [@param0=[String, System.String]]
2020-03-26 11:09:53,166 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NOITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = a.BENHAN_ID                 where(                             A.HUYHOADON = '1'                                             )                       and                           A.TIEPNHAN_ID = '104260'                       and                           A.BENHAN_ID = '19427'                       and                         (bn.TENBENHNHAN like '%' +  @param0  + '%' or bn.MAYTE like '%' +  @param0  + '%')                       and                           convert(date,A.NGAYHOADON) between convert(date, '3/26/2020 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is not null  and                           ntba.BENHAN_ID = '19427'                                       order by A.NGAYHOADON]
2020-03-26 11:09:53,166 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] Parameters: [@param0=[TENBENHNHAN,190033170]]
2020-03-26 11:09:53,166 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] Types: [@param0=[String, System.String]]
2020-03-26 11:09:59,165 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NOITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = a.BENHAN_ID                 where(                             A.HUYHOADON = '1'                                             )                       and                           A.TIEPNHAN_ID = '104260'                       and                           A.BENHAN_ID = '19427'                       and                         (bn.TENBENHNHAN like '%' +  @param0  + '%' or bn.MAYTE like '%' +  @param0  + '%')                       and                           convert(date,A.NGAYHOADON) between convert(date, '3/1/2020 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is not null  and                           ntba.BENHAN_ID = '19427'                                       order by A.NGAYHOADON]
2020-03-26 11:09:59,165 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] Parameters: [@param0=[TENBENHNHAN,190033170]]
2020-03-26 11:09:59,165 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] Types: [@param0=[String, System.String]]
2020-03-26 11:10:42,618 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_HINHTHUCTHANHTOAN_GetList] PreparedStatement : [select TT_HOADON_HINHTHUCTHANHTOAN.*, htttCode.DICTIONARY_CODE HINHTHUCTHANHTOAN_CODE            from TT_HOADON_HINHTHUCTHANHTOAN TT_HOADON_HINHTHUCTHANHTOAN            left join (select DICTIONARY_ID, DICTIONARY_CODE from LST_DICTIONARY where DICTIONARY_TYPE_CODE like 'HinhThucThanhToan') htttCode on htttCode.DICTIONARY_ID = TT_HOADON_HINHTHUCTHANHTOAN.HINHTHUCTHANHTOAN_ID             where                             TT_HOADON_HINHTHUCTHANHTOAN.HOADON_ID = '106692'                       and                           TT_HOADON_HINHTHUCTHANHTOAN.BENHVIEN_ID = '01819'                                     order by HOADON_HTTT_ID]
2020-03-26 11:10:42,667 [1] DEBUG - Statement Id: [DAO00119_TT_VIENPHI_GetList_BenhAnByHoadon] PreparedStatement : [select  a.*, a.MIENGIAM_GIATRI as GIATRIMIENGIAM_BH, a.BHTN_GIATRI as GIATRIMIENGIAM_BHTN,        a.HOIVIEN_GIATRI as GIATRIMIENGIAM_THANHVIEN, a.CONGTYCHITRA_GIATRI as GIATRIMIENGIAM_CTCT,        isnull(dv.TENDICHVU, dc.TENDUOCDAYDU) NOIDUNG, isnull(dv.MADICHVU, dc.MADUOC) MADICHVU, dv.NORESULT, dc.DONVITINH, ld.MALOAIDUOC, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ndv.MANHOMDICHVU        from        (        select * from (        select vp.*, c.NOITHUCHIEN_ID, c.NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_DVYEUCAU c on c.DVYEUCAU_ID = VP.REF_ID and vpp.REF_TABLE = 'TT_DVYEUCAU'        union        select vp.*, C.PHONGBANRATOA_ID as NOITHUCHIEN_ID, D.PHONGBAN_ID NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_NOITRU_TOATHUOC c on c.TOATHUOC_ID = VP.REF_ID and vpp.REF_TABLE = 'TT_NOITRU_TOATHUOC'        inner join TT_NOITRU_KHAMBENH D on D.KHAMBENH_ID = C.KHAMBENH_ID        union        select vp.*, C.PHONGBAN_ID as NOITHUCHIEN_ID, C.PHONGBAN_ID as NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_CLSKETQUA_VTYT c on c.CLSKETQUA_VTYT_ID = VP.REF_ID and vpp.REF_TABLE = 'TT_CLSKETQUA_VTYT'        union        select vp.*, ISNULL(D.PHONGBANTHUCHIEN_ID,d.PHONGBANCHIDINH_ID) as NOITHUCHIEN_ID, ISNULL(D.PHONGBANCHIDINH_ID,D.PHONGBANTHUCHIEN_ID) as NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_PHAUTHUAT_VTYT c on c.PHAUTHUAT_VTYT_ID = VP.REF_ID and vpp.REF_TABLE = 'TT_PHAUTHUAT_VTYT'        inner join TT_PHAUTHUAT D on D.PHAUTHUAT_ID = C.PHAUTHUAT_ID        union        select vp.*, c.PHONGBAN_ID as NOITHUCHIEN_ID, c.PHONGBAN_ID as NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_NGOAITRU_KHAMBENH_VTYT c on c.KHAMBENH_VTYT_ID = VP.REF_ID and vpp.REF_TABLE = 'TT_NGOAITRU_KHAMBENH_VTYT'        union        select vp.*, E.PHONGBAN_ID as NOITHUCHIEN_ID, E.PHONGBAN_ID as NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_NUT_XACNHANSUATAN_CHITIET XNC on XNC.XACNHANSUATANCHITIET_ID = vp.REF_ID and vpp.REF_TABLE = 'TT_NUT_XACNHANSUATAN_CHITIET'        inner join TT_NUT_CHIDINHKHAUPHAN_CHITIET D on D.CHIDINHKHAUPHANCHITIET_ID = XNC.CHIDINHKHAUPHANCHITIET_ID        inner join TM_NUT_KHAUPHANAN c on C.KHAUPHANAN_ID = D.KHAUPHANAN_ID        inner join TT_NUT_CHIDINHKHAUPHAN E on E.CHIDINHKHAUPHAN_ID = D.CHIDINHKHAUPHAN_ID        ) B        where B.HOADON_ID = '106692'        ) a        left join TM_DUOC dc on a.DUOC_ID = dc.DUOC_ID        left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID        left join TM_DICHVU dv on a.DICHVU_ID = dv.DICHVU_ID and a.REF_TABLE = 'TT_DVYEUCAU'        left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID]
2020-03-26 11:10:43,818 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 11:10:43,819 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 11:10:43,819 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2020-03-26 11:10:43,856 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 11:10:43,857 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 11:10:43,857 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2020-03-26 11:10:43,893 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1              and               BLCT.BIENLAICHITIET_ID = '1067'                         order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 11:10:43,893 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 11:10:43,893 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2020-03-26 11:10:43,943 [1] DEBUG - Statement Id: [DAO00014_GetInPatientStatus] PreparedStatement : [select TRANGTHAI, isnull(KHOACHUYENDEN_ID, KHOAVAO_ID) as KHOAHIENTAI from TT_NOITRU_BENHAN        where        TIEPNHAN_ID = '104260'        and BENHVIEN_ID = '01819'         and           BENHAN_ID = '19427']
2020-03-26 11:11:05,885 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NOITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = a.BENHAN_ID                 where(                           (A.DATHANHTOAN = '1'                         and                           A.TRANGTHAI != 'DADUYETCONGNO'                         )                          and (A.HUYHOADON is null or A.HUYHOADON = '0')                          and (A.HOANTRA is null or A.HOANTRA = '0')                                             )                       and                           A.TIEPNHAN_ID = '104260'                       and                           A.BENHAN_ID = '19427'                       and                         (bn.TENBENHNHAN like '%' +  @param0  + '%' or bn.MAYTE like '%' +  @param0  + '%')                       and                           convert(date,A.NGAYHOADON) between convert(date, '3/26/2020 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is not null  and                           ntba.BENHAN_ID = '19427'                                       order by A.NGAYHOADON]
2020-03-26 11:11:05,886 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] Parameters: [@param0=[TENBENHNHAN,190033170]]
2020-03-26 11:11:05,886 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] Types: [@param0=[String, System.String]]
2020-03-26 11:11:08,957 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NOITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = a.BENHAN_ID                 where(                             A.HUYHOADON = '1'                                             )                       and                           A.TIEPNHAN_ID = '104260'                       and                           A.BENHAN_ID = '19427'                       and                         (bn.TENBENHNHAN like '%' +  @param0  + '%' or bn.MAYTE like '%' +  @param0  + '%')                       and                           convert(date,A.NGAYHOADON) between convert(date, '3/26/2020 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is not null  and                           ntba.BENHAN_ID = '19427'                                       order by A.NGAYHOADON]
2020-03-26 11:11:08,957 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] Parameters: [@param0=[TENBENHNHAN,190033170]]
2020-03-26 11:11:08,957 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] Types: [@param0=[String, System.String]]
2020-03-26 11:11:14,285 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NOITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = a.BENHAN_ID                 where(                             A.HUYHOADON = '1'                                             )                       and                           A.TIEPNHAN_ID = '104260'                       and                           A.BENHAN_ID = '19427'                       and                         (bn.TENBENHNHAN like '%' +  @param0  + '%' or bn.MAYTE like '%' +  @param0  + '%')                       and                           convert(date,A.NGAYHOADON) between convert(date, '3/1/2020 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is not null  and                           ntba.BENHAN_ID = '19427'                                       order by A.NGAYHOADON]
2020-03-26 11:11:14,286 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] Parameters: [@param0=[TENBENHNHAN,190033170]]
2020-03-26 11:11:14,286 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] Types: [@param0=[String, System.String]]
2020-03-26 11:12:19,823 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_HINHTHUCTHANHTOAN_GetList] PreparedStatement : [select TT_HOADON_HINHTHUCTHANHTOAN.*, htttCode.DICTIONARY_CODE HINHTHUCTHANHTOAN_CODE            from TT_HOADON_HINHTHUCTHANHTOAN TT_HOADON_HINHTHUCTHANHTOAN            left join (select DICTIONARY_ID, DICTIONARY_CODE from LST_DICTIONARY where DICTIONARY_TYPE_CODE like 'HinhThucThanhToan') htttCode on htttCode.DICTIONARY_ID = TT_HOADON_HINHTHUCTHANHTOAN.HINHTHUCTHANHTOAN_ID             where                             TT_HOADON_HINHTHUCTHANHTOAN.HOADON_ID = '106692'                       and                           TT_HOADON_HINHTHUCTHANHTOAN.BENHVIEN_ID = '01819'                                     order by HOADON_HTTT_ID]
2020-03-26 11:12:19,869 [1] DEBUG - Statement Id: [DAO00119_TT_VIENPHI_GetList_BenhAnByHoadon] PreparedStatement : [select  a.*, a.MIENGIAM_GIATRI as GIATRIMIENGIAM_BH, a.BHTN_GIATRI as GIATRIMIENGIAM_BHTN,        a.HOIVIEN_GIATRI as GIATRIMIENGIAM_THANHVIEN, a.CONGTYCHITRA_GIATRI as GIATRIMIENGIAM_CTCT,        isnull(dv.TENDICHVU, dc.TENDUOCDAYDU) NOIDUNG, isnull(dv.MADICHVU, dc.MADUOC) MADICHVU, dv.NORESULT, dc.DONVITINH, ld.MALOAIDUOC, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ndv.MANHOMDICHVU        from        (        select * from (        select vp.*, c.NOITHUCHIEN_ID, c.NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_DVYEUCAU c on c.DVYEUCAU_ID = VP.REF_ID and vpp.REF_TABLE = 'TT_DVYEUCAU'        union        select vp.*, C.PHONGBANRATOA_ID as NOITHUCHIEN_ID, D.PHONGBAN_ID NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_NOITRU_TOATHUOC c on c.TOATHUOC_ID = VP.REF_ID and vpp.REF_TABLE = 'TT_NOITRU_TOATHUOC'        inner join TT_NOITRU_KHAMBENH D on D.KHAMBENH_ID = C.KHAMBENH_ID        union        select vp.*, C.PHONGBAN_ID as NOITHUCHIEN_ID, C.PHONGBAN_ID as NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_CLSKETQUA_VTYT c on c.CLSKETQUA_VTYT_ID = VP.REF_ID and vpp.REF_TABLE = 'TT_CLSKETQUA_VTYT'        union        select vp.*, ISNULL(D.PHONGBANTHUCHIEN_ID,d.PHONGBANCHIDINH_ID) as NOITHUCHIEN_ID, ISNULL(D.PHONGBANCHIDINH_ID,D.PHONGBANTHUCHIEN_ID) as NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_PHAUTHUAT_VTYT c on c.PHAUTHUAT_VTYT_ID = VP.REF_ID and vpp.REF_TABLE = 'TT_PHAUTHUAT_VTYT'        inner join TT_PHAUTHUAT D on D.PHAUTHUAT_ID = C.PHAUTHUAT_ID        union        select vp.*, c.PHONGBAN_ID as NOITHUCHIEN_ID, c.PHONGBAN_ID as NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_NGOAITRU_KHAMBENH_VTYT c on c.KHAMBENH_VTYT_ID = VP.REF_ID and vpp.REF_TABLE = 'TT_NGOAITRU_KHAMBENH_VTYT'        union        select vp.*, E.PHONGBAN_ID as NOITHUCHIEN_ID, E.PHONGBAN_ID as NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_NUT_XACNHANSUATAN_CHITIET XNC on XNC.XACNHANSUATANCHITIET_ID = vp.REF_ID and vpp.REF_TABLE = 'TT_NUT_XACNHANSUATAN_CHITIET'        inner join TT_NUT_CHIDINHKHAUPHAN_CHITIET D on D.CHIDINHKHAUPHANCHITIET_ID = XNC.CHIDINHKHAUPHANCHITIET_ID        inner join TM_NUT_KHAUPHANAN c on C.KHAUPHANAN_ID = D.KHAUPHANAN_ID        inner join TT_NUT_CHIDINHKHAUPHAN E on E.CHIDINHKHAUPHAN_ID = D.CHIDINHKHAUPHAN_ID        ) B        where B.HOADON_ID = '106692'        ) a        left join TM_DUOC dc on a.DUOC_ID = dc.DUOC_ID        left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID        left join TM_DICHVU dv on a.DICHVU_ID = dv.DICHVU_ID and a.REF_TABLE = 'TT_DVYEUCAU'        left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID]
2020-03-26 11:12:21,130 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 11:12:21,131 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 11:12:21,131 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2020-03-26 11:12:21,179 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 11:12:21,179 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 11:12:21,179 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2020-03-26 11:12:21,219 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1              and               BLCT.BIENLAICHITIET_ID = '1067'                         order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 11:12:21,219 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 11:12:21,219 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2020-03-26 11:12:21,258 [1] DEBUG - Statement Id: [DAO00014_GetInPatientStatus] PreparedStatement : [select TRANGTHAI, isnull(KHOACHUYENDEN_ID, KHOAVAO_ID) as KHOAHIENTAI from TT_NOITRU_BENHAN        where        TIEPNHAN_ID = '104260'        and BENHVIEN_ID = '01819'         and           BENHAN_ID = '19427']
--------------------------------------------------------------------------------
2020-03-26 12:49:42,777 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2020-03-26 12:49:43,130 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2020-03-26 12:49:43,170 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2020-03-26 12:49:43,746 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 12:49:44,188 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2020-03-26 12:50:05,688 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '01819' and TYPE = 'D']
2020-03-26 12:50:05,716 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '01819' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2020-03-26 12:50:10,664 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '01819')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '01819' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2020-03-26 12:50:10,861 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2020-03-26 12:50:11,960 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2020-03-26 12:50:12,308 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2020-03-26 12:50:12,399 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2020-03-26 12:50:12,530 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2020-03-26 12:50:12,610 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2020-03-26 12:50:12,690 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2020-03-26 12:50:12,797 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2020-03-26 12:50:12,881 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2020-03-26 12:50:13,083 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2020-03-26 12:50:13,738 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2020-03-26 12:50:13,797 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = '01819' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = '01819'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = '01819')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = '01819' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = '01819'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = '01819' AND TT_TONKHO.SOLUONG >= 0]
2020-03-26 12:50:13,885 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2020-03-26 12:50:13,921 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = '01819' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = '01819'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = '01819')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = '01819' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = '01819' and TT_TONKHO.SOLUONG >= 0]
2020-03-26 12:50:15,563 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2020-03-26 12:50:15,611 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @NGUONDUOC_MACDINH varchar(5) = '0';        declare @TOAMUANGOAI int = 0;        select @NGUONDUOC_MACDINH = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'PHA_NGUONDUOC'        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + @NGUONDUOC_MACDINH as DUOC_KEY, 0 as PHAMVI_ID, @NGUONDUOC_MACDINH as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = '01819'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = '01819')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = '01819'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = '01819')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = '01819'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = '01819'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = '01819'        where d.BENHVIEN_ID = '01819'  and tk.SOLUONG >= 0        end        else        begin                select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = '01819'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = '01819')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (        select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID)        B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (        select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID)        A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = '01819'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = '01819'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = '01819'        where d.BENHVIEN_ID = '01819'  and tk.SOLUONG >= 0        end]
2020-03-26 12:50:18,621 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2020-03-26 12:50:18,684 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,        SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH        FROM TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID        WHERE TK.SOLUONG > 0        GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2020-03-26 12:50:18,793 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2020-03-26 12:50:18,828 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,        TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,        TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH        from TM_MAU M        JOIN        (        select        A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO        from        (        select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO        from TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'        where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0        ) A        )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2020-03-26 12:50:18,970 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2020-03-26 12:50:19,932 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 12:50:21,474 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = '01819']
2020-03-26 12:50:30,613 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = '01819' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2020-03-26 12:50:30,670 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = '01819'              order by SETTING_ID]
2020-03-26 12:50:30,794 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 12:50:31,035 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 12:50:31,356 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2020-03-26 12:50:31,389 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,01819], @param1=[ACCOUNT_ID,113]]
2020-03-26 12:50:31,389 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2020-03-26 12:50:31,432 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2020-03-26 12:50:31,432 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,01819], @param1=[ACCOUNT_ID,113]]
2020-03-26 12:50:31,432 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2020-03-26 12:50:31,764 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 12:50:32,347 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 12:51:02,134 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 12:51:02,355 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = '01819' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2020-03-26 12:51:02,849 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = '01819' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2020-03-26 12:55:58,276 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'COM31'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 12:55:58,464 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'BIL18'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 12:56:00,835 [1] DEBUG - Statement Id: [DAO00119_GetDanhsachHTTT] PreparedStatement : [select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE = 'HinhThucThanhToan' and ENABLED = '1' and BENHVIEN_ID = '01819']
2020-03-26 12:56:03,011 [1] DEBUG - Statement Id: [DAO00101_GetListSuatAn] PreparedStatement : [SELECT        kP.KHAUPHANAN_ID,        kP.MAKHAUPHANAN,        kP.TENKHAUPHANAN,        LKP.LOAIKHAUPHANAN_ID,        LKP.MALOAIKHAUPHANAN,        LKP.TENLOAIKHAUPHANAN,        DG.DONGIA,        kP.HANGMUC_ID        FROM TM_NUT_KHAUPHANAN kP        INNER JOIN TM_NUT_LOAIKHAUPHANAN LKP ON  kP.LOAIKHAUPHANAN_ID = LKP.LOAIKHAUPHANAN_ID        INNER JOIN TM_NUT_KHAUPHANAN_DONGIA DG ON DG.KHAUPHANAN_ID = kP.KHAUPHANAN_ID        WHERE DG.DONGIA IS NOT NULL]
2020-03-26 12:56:14,251 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'COM56'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 12:56:14,494 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'COM98'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 12:56:22,329 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NOITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = a.BENHAN_ID                 where(                             A.HUYHOADON = '1'                                             )                       and                           convert(date,A.NGAYHOADON) between convert(date, '3/1/2020 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is not null                order by A.NGAYHOADON]
2020-03-26 12:56:52,860 [1] DEBUG - Statement Id: [DAO00019_ThongTinBenhNhanBenhAn] PreparedStatement : [select distinct C.SOBENHAN, C.BENHAN_ID, A.SOTIEPNHAN, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI, A.SOBHYT,        B.*        from TT_NOITRU_BENHAN C        inner join TT_TIEPNHAN A on C.TIEPNHAN_ID = A.TIEPNHAN_ID        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'        where                    C.SOBENHAN = '20.002255'                 and A.BENHVIEN_ID = '01819']
2020-03-26 12:56:55,970 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_HINHTHUCTHANHTOAN_GetList] PreparedStatement : [select TT_HOADON_HINHTHUCTHANHTOAN.*, htttCode.DICTIONARY_CODE HINHTHUCTHANHTOAN_CODE            from TT_HOADON_HINHTHUCTHANHTOAN TT_HOADON_HINHTHUCTHANHTOAN            left join (select DICTIONARY_ID, DICTIONARY_CODE from LST_DICTIONARY where DICTIONARY_TYPE_CODE like 'HinhThucThanhToan') htttCode on htttCode.DICTIONARY_ID = TT_HOADON_HINHTHUCTHANHTOAN.HINHTHUCTHANHTOAN_ID             where                             TT_HOADON_HINHTHUCTHANHTOAN.HOADON_ID = '106692'                       and                           TT_HOADON_HINHTHUCTHANHTOAN.BENHVIEN_ID = '01819'                                     order by HOADON_HTTT_ID]
2020-03-26 12:56:56,054 [1] DEBUG - Statement Id: [DAO00119_TT_VIENPHI_GetList_BenhAnByHoadon] PreparedStatement : [select  a.*, a.MIENGIAM_GIATRI as GIATRIMIENGIAM_BH, a.BHTN_GIATRI as GIATRIMIENGIAM_BHTN,        a.HOIVIEN_GIATRI as GIATRIMIENGIAM_THANHVIEN, a.CONGTYCHITRA_GIATRI as GIATRIMIENGIAM_CTCT,        isnull(dv.TENDICHVU, dc.TENDUOCDAYDU) NOIDUNG, isnull(dv.MADICHVU, dc.MADUOC) MADICHVU, dv.NORESULT, dc.DONVITINH, ld.MALOAIDUOC, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ndv.MANHOMDICHVU        from        (        select * from (        select vp.*, c.NOITHUCHIEN_ID, c.NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_DVYEUCAU c on c.DVYEUCAU_ID = VP.REF_ID and vpp.REF_TABLE = 'TT_DVYEUCAU'        union        select vp.*, C.PHONGBANRATOA_ID as NOITHUCHIEN_ID, D.PHONGBAN_ID NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_NOITRU_TOATHUOC c on c.TOATHUOC_ID = VP.REF_ID and vpp.REF_TABLE = 'TT_NOITRU_TOATHUOC'        inner join TT_NOITRU_KHAMBENH D on D.KHAMBENH_ID = C.KHAMBENH_ID        union        select vp.*, C.PHONGBAN_ID as NOITHUCHIEN_ID, C.PHONGBAN_ID as NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_CLSKETQUA_VTYT c on c.CLSKETQUA_VTYT_ID = VP.REF_ID and vpp.REF_TABLE = 'TT_CLSKETQUA_VTYT'        union        select vp.*, ISNULL(D.PHONGBANTHUCHIEN_ID,d.PHONGBANCHIDINH_ID) as NOITHUCHIEN_ID, ISNULL(D.PHONGBANCHIDINH_ID,D.PHONGBANTHUCHIEN_ID) as NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_PHAUTHUAT_VTYT c on c.PHAUTHUAT_VTYT_ID = VP.REF_ID and vpp.REF_TABLE = 'TT_PHAUTHUAT_VTYT'        inner join TT_PHAUTHUAT D on D.PHAUTHUAT_ID = C.PHAUTHUAT_ID        union        select vp.*, c.PHONGBAN_ID as NOITHUCHIEN_ID, c.PHONGBAN_ID as NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_NGOAITRU_KHAMBENH_VTYT c on c.KHAMBENH_VTYT_ID = VP.REF_ID and vpp.REF_TABLE = 'TT_NGOAITRU_KHAMBENH_VTYT'        union        select vp.*, E.PHONGBAN_ID as NOITHUCHIEN_ID, E.PHONGBAN_ID as NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_NUT_XACNHANSUATAN_CHITIET XNC on XNC.XACNHANSUATANCHITIET_ID = vp.REF_ID and vpp.REF_TABLE = 'TT_NUT_XACNHANSUATAN_CHITIET'        inner join TT_NUT_CHIDINHKHAUPHAN_CHITIET D on D.CHIDINHKHAUPHANCHITIET_ID = XNC.CHIDINHKHAUPHANCHITIET_ID        inner join TM_NUT_KHAUPHANAN c on C.KHAUPHANAN_ID = D.KHAUPHANAN_ID        inner join TT_NUT_CHIDINHKHAUPHAN E on E.CHIDINHKHAUPHAN_ID = D.CHIDINHKHAUPHAN_ID        ) B        where B.HOADON_ID = '106692'        ) a        left join TM_DUOC dc on a.DUOC_ID = dc.DUOC_ID        left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID        left join TM_DICHVU dv on a.DICHVU_ID = dv.DICHVU_ID and a.REF_TABLE = 'TT_DVYEUCAU'        left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID]
2020-03-26 12:57:00,836 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 12:57:00,836 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 12:57:00,836 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2020-03-26 12:57:00,907 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1              and               BLCT.BIENLAICHITIET_ID = '1067'                         order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 12:57:00,907 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 12:57:00,907 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2020-03-26 12:57:05,934 [1] DEBUG - Statement Id: [DAO00014_GetInPatientStatus] PreparedStatement : [select TRANGTHAI, isnull(KHOACHUYENDEN_ID, KHOAVAO_ID) as KHOAHIENTAI from TT_NOITRU_BENHAN        where        TIEPNHAN_ID = '104260'        and BENHVIEN_ID = '01819'         and           BENHAN_ID = '19427']
--------------------------------------------------------------------------------
2020-03-26 13:04:03,418 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2020-03-26 13:04:03,983 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2020-03-26 13:04:04,028 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2020-03-26 13:04:04,766 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 13:04:05,270 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2020-03-26 13:04:12,679 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '01819' and TYPE = 'D']
2020-03-26 13:04:12,711 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '01819' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2020-03-26 13:04:15,388 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '01819')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '01819' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2020-03-26 13:04:15,512 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2020-03-26 13:04:16,660 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2020-03-26 13:04:16,879 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2020-03-26 13:04:17,064 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2020-03-26 13:04:17,200 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2020-03-26 13:04:17,333 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2020-03-26 13:04:17,408 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2020-03-26 13:04:17,512 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2020-03-26 13:04:17,593 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2020-03-26 13:04:17,671 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2020-03-26 13:04:18,201 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2020-03-26 13:04:18,238 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = '01819' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = '01819'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = '01819')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = '01819' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = '01819'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = '01819' AND TT_TONKHO.SOLUONG >= 0]
2020-03-26 13:04:18,333 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2020-03-26 13:04:18,379 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = '01819' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = '01819'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = '01819')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = '01819' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = '01819' and TT_TONKHO.SOLUONG >= 0]
2020-03-26 13:04:20,331 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2020-03-26 13:04:20,371 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @NGUONDUOC_MACDINH varchar(5) = '0';        declare @TOAMUANGOAI int = 0;        select @NGUONDUOC_MACDINH = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'PHA_NGUONDUOC'        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + @NGUONDUOC_MACDINH as DUOC_KEY, 0 as PHAMVI_ID, @NGUONDUOC_MACDINH as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = '01819'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = '01819')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = '01819'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = '01819')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = '01819'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = '01819'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = '01819'        where d.BENHVIEN_ID = '01819'  and tk.SOLUONG >= 0        end        else        begin                select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = '01819'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = '01819')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (        select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID)        B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (        select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID)        A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = '01819'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = '01819'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = '01819'        where d.BENHVIEN_ID = '01819'  and tk.SOLUONG >= 0        end]
2020-03-26 13:04:23,349 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2020-03-26 13:04:23,390 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,        SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH        FROM TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID        WHERE TK.SOLUONG > 0        GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2020-03-26 13:04:23,629 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2020-03-26 13:04:23,686 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,        TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,        TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH        from TM_MAU M        JOIN        (        select        A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO        from        (        select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO        from TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'        where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0        ) A        )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2020-03-26 13:04:23,826 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2020-03-26 13:04:24,771 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 13:04:25,757 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = '01819']
2020-03-26 13:04:32,981 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = '01819' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2020-03-26 13:04:33,045 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = '01819'              order by SETTING_ID]
2020-03-26 13:04:33,152 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 13:04:33,309 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 13:04:33,510 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2020-03-26 13:04:33,513 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,01819], @param1=[ACCOUNT_ID,113]]
2020-03-26 13:04:33,513 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2020-03-26 13:04:33,550 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2020-03-26 13:04:33,550 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,01819], @param1=[ACCOUNT_ID,113]]
2020-03-26 13:04:33,550 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2020-03-26 13:04:33,730 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 13:04:33,918 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 13:04:52,492 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 13:04:52,591 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = '01819' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2020-03-26 13:04:52,939 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = '01819' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2020-03-26 13:04:59,588 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'COM31'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 13:04:59,795 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'BIL18'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 13:05:01,541 [1] DEBUG - Statement Id: [DAO00119_GetDanhsachHTTT] PreparedStatement : [select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE = 'HinhThucThanhToan' and ENABLED = '1' and BENHVIEN_ID = '01819']
2020-03-26 13:05:03,109 [1] DEBUG - Statement Id: [DAO00101_GetListSuatAn] PreparedStatement : [SELECT        kP.KHAUPHANAN_ID,        kP.MAKHAUPHANAN,        kP.TENKHAUPHANAN,        LKP.LOAIKHAUPHANAN_ID,        LKP.MALOAIKHAUPHANAN,        LKP.TENLOAIKHAUPHANAN,        DG.DONGIA,        kP.HANGMUC_ID        FROM TM_NUT_KHAUPHANAN kP        INNER JOIN TM_NUT_LOAIKHAUPHANAN LKP ON  kP.LOAIKHAUPHANAN_ID = LKP.LOAIKHAUPHANAN_ID        INNER JOIN TM_NUT_KHAUPHANAN_DONGIA DG ON DG.KHAUPHANAN_ID = kP.KHAUPHANAN_ID        WHERE DG.DONGIA IS NOT NULL]
2020-03-26 13:05:09,743 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'COM56'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 13:05:09,980 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'COM98'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 13:05:37,269 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NOITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = a.BENHAN_ID                 where(                             A.HUYHOADON = '1'                                             )                       and                           convert(date,A.NGAYHOADON) between convert(date, '3/1/2020 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is not null                order by A.NGAYHOADON]
2020-03-26 13:05:49,119 [1] DEBUG - Statement Id: [DAO00019_ThongTinBenhNhanBenhAn] PreparedStatement : [select distinct C.SOBENHAN, C.BENHAN_ID, A.SOTIEPNHAN, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI, A.SOBHYT,        B.*        from TT_NOITRU_BENHAN C        inner join TT_TIEPNHAN A on C.TIEPNHAN_ID = A.TIEPNHAN_ID        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'        where                    C.SOBENHAN = '20.002255'                 and A.BENHVIEN_ID = '01819']
2020-03-26 13:05:49,405 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_HINHTHUCTHANHTOAN_GetList] PreparedStatement : [select TT_HOADON_HINHTHUCTHANHTOAN.*, htttCode.DICTIONARY_CODE HINHTHUCTHANHTOAN_CODE            from TT_HOADON_HINHTHUCTHANHTOAN TT_HOADON_HINHTHUCTHANHTOAN            left join (select DICTIONARY_ID, DICTIONARY_CODE from LST_DICTIONARY where DICTIONARY_TYPE_CODE like 'HinhThucThanhToan') htttCode on htttCode.DICTIONARY_ID = TT_HOADON_HINHTHUCTHANHTOAN.HINHTHUCTHANHTOAN_ID             where                             TT_HOADON_HINHTHUCTHANHTOAN.HOADON_ID = '106692'                       and                           TT_HOADON_HINHTHUCTHANHTOAN.BENHVIEN_ID = '01819'                                     order by HOADON_HTTT_ID]
2020-03-26 13:05:49,499 [1] DEBUG - Statement Id: [DAO00119_TT_VIENPHI_GetList_BenhAnByHoadon] PreparedStatement : [select  a.*, a.MIENGIAM_GIATRI as GIATRIMIENGIAM_BH, a.BHTN_GIATRI as GIATRIMIENGIAM_BHTN,        a.HOIVIEN_GIATRI as GIATRIMIENGIAM_THANHVIEN, a.CONGTYCHITRA_GIATRI as GIATRIMIENGIAM_CTCT,        isnull(dv.TENDICHVU, dc.TENDUOCDAYDU) NOIDUNG, isnull(dv.MADICHVU, dc.MADUOC) MADICHVU, dv.NORESULT, dc.DONVITINH, ld.MALOAIDUOC, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ndv.MANHOMDICHVU        from        (        select * from (        select vp.*, c.NOITHUCHIEN_ID, c.NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_DVYEUCAU c on c.DVYEUCAU_ID = VP.REF_ID and vpp.REF_TABLE = 'TT_DVYEUCAU'        union        select vp.*, C.PHONGBANRATOA_ID as NOITHUCHIEN_ID, D.PHONGBAN_ID NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_NOITRU_TOATHUOC c on c.TOATHUOC_ID = VP.REF_ID and vpp.REF_TABLE = 'TT_NOITRU_TOATHUOC'        inner join TT_NOITRU_KHAMBENH D on D.KHAMBENH_ID = C.KHAMBENH_ID        union        select vp.*, C.PHONGBAN_ID as NOITHUCHIEN_ID, C.PHONGBAN_ID as NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_CLSKETQUA_VTYT c on c.CLSKETQUA_VTYT_ID = VP.REF_ID and vpp.REF_TABLE = 'TT_CLSKETQUA_VTYT'        union        select vp.*, ISNULL(D.PHONGBANTHUCHIEN_ID,d.PHONGBANCHIDINH_ID) as NOITHUCHIEN_ID, ISNULL(D.PHONGBANCHIDINH_ID,D.PHONGBANTHUCHIEN_ID) as NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_PHAUTHUAT_VTYT c on c.PHAUTHUAT_VTYT_ID = VP.REF_ID and vpp.REF_TABLE = 'TT_PHAUTHUAT_VTYT'        inner join TT_PHAUTHUAT D on D.PHAUTHUAT_ID = C.PHAUTHUAT_ID        union        select vp.*, c.PHONGBAN_ID as NOITHUCHIEN_ID, c.PHONGBAN_ID as NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_NGOAITRU_KHAMBENH_VTYT c on c.KHAMBENH_VTYT_ID = VP.REF_ID and vpp.REF_TABLE = 'TT_NGOAITRU_KHAMBENH_VTYT'        union        select vp.*, E.PHONGBAN_ID as NOITHUCHIEN_ID, E.PHONGBAN_ID as NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_NUT_XACNHANSUATAN_CHITIET XNC on XNC.XACNHANSUATANCHITIET_ID = vp.REF_ID and vpp.REF_TABLE = 'TT_NUT_XACNHANSUATAN_CHITIET'        inner join TT_NUT_CHIDINHKHAUPHAN_CHITIET D on D.CHIDINHKHAUPHANCHITIET_ID = XNC.CHIDINHKHAUPHANCHITIET_ID        inner join TM_NUT_KHAUPHANAN c on C.KHAUPHANAN_ID = D.KHAUPHANAN_ID        inner join TT_NUT_CHIDINHKHAUPHAN E on E.CHIDINHKHAUPHAN_ID = D.CHIDINHKHAUPHAN_ID        ) B        where B.HOADON_ID = '106692'        ) a        left join TM_DUOC dc on a.DUOC_ID = dc.DUOC_ID        left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID        left join TM_DICHVU dv on a.DICHVU_ID = dv.DICHVU_ID and a.REF_TABLE = 'TT_DVYEUCAU'        left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID]
2020-03-26 13:05:51,656 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 13:05:51,657 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 13:05:51,657 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2020-03-26 13:05:51,727 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1              and               BLCT.BIENLAICHITIET_ID = '1067'                         order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 13:05:51,727 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 13:05:51,727 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2020-03-26 13:05:51,772 [1] DEBUG - Statement Id: [DAO00014_GetInPatientStatus] PreparedStatement : [select TRANGTHAI, isnull(KHOACHUYENDEN_ID, KHOAVAO_ID) as KHOAHIENTAI from TT_NOITRU_BENHAN        where        TIEPNHAN_ID = '104260'        and BENHVIEN_ID = '01819'         and           BENHAN_ID = '19427']
--------------------------------------------------------------------------------
2020-03-26 13:08:17,705 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2020-03-26 13:08:18,048 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2020-03-26 13:08:18,095 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2020-03-26 13:08:19,174 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 13:08:19,579 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2020-03-26 13:08:26,225 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '01819' and TYPE = 'D']
2020-03-26 13:08:26,255 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '01819' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2020-03-26 13:08:28,337 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '01819')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '01819' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2020-03-26 13:08:28,432 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2020-03-26 13:08:29,320 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2020-03-26 13:08:29,606 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2020-03-26 13:08:29,706 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2020-03-26 13:08:29,787 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2020-03-26 13:08:29,890 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2020-03-26 13:08:29,976 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2020-03-26 13:08:30,063 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2020-03-26 13:08:30,139 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2020-03-26 13:08:30,225 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2020-03-26 13:08:30,906 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2020-03-26 13:08:30,945 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = '01819' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = '01819'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = '01819')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = '01819' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = '01819'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = '01819' AND TT_TONKHO.SOLUONG >= 0]
2020-03-26 13:08:31,087 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2020-03-26 13:08:31,127 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = '01819' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = '01819'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = '01819')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = '01819' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = '01819' and TT_TONKHO.SOLUONG >= 0]
2020-03-26 13:08:32,790 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2020-03-26 13:08:32,834 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @NGUONDUOC_MACDINH varchar(5) = '0';        declare @TOAMUANGOAI int = 0;        select @NGUONDUOC_MACDINH = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'PHA_NGUONDUOC'        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + @NGUONDUOC_MACDINH as DUOC_KEY, 0 as PHAMVI_ID, @NGUONDUOC_MACDINH as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = '01819'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = '01819')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = '01819'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = '01819')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = '01819'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = '01819'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = '01819'        where d.BENHVIEN_ID = '01819'  and tk.SOLUONG >= 0        end        else        begin                select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = '01819'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = '01819')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (        select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID)        B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (        select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID)        A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = '01819'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = '01819'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = '01819'        where d.BENHVIEN_ID = '01819'  and tk.SOLUONG >= 0        end]
2020-03-26 13:08:35,692 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2020-03-26 13:08:35,762 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,        SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH        FROM TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID        WHERE TK.SOLUONG > 0        GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2020-03-26 13:08:35,915 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2020-03-26 13:08:35,979 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,        TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,        TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH        from TM_MAU M        JOIN        (        select        A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO        from        (        select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO        from TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'        where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0        ) A        )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2020-03-26 13:08:36,125 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2020-03-26 13:08:37,181 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 13:08:38,258 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = '01819']
2020-03-26 13:08:46,930 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = '01819' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2020-03-26 13:08:46,967 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = '01819'              order by SETTING_ID]
2020-03-26 13:08:47,060 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 13:08:47,210 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 13:08:47,408 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2020-03-26 13:08:47,415 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,01819], @param1=[ACCOUNT_ID,113]]
2020-03-26 13:08:47,415 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2020-03-26 13:08:47,446 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2020-03-26 13:08:47,446 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,01819], @param1=[ACCOUNT_ID,113]]
2020-03-26 13:08:47,446 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2020-03-26 13:08:47,621 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 13:08:47,833 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 13:09:02,275 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 13:09:02,371 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = '01819' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2020-03-26 13:09:02,734 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = '01819' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2020-03-26 13:09:20,678 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'COM31'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 13:09:20,919 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'BIL18'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 13:09:22,780 [1] DEBUG - Statement Id: [DAO00119_GetDanhsachHTTT] PreparedStatement : [select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE = 'HinhThucThanhToan' and ENABLED = '1' and BENHVIEN_ID = '01819']
2020-03-26 13:09:24,689 [1] DEBUG - Statement Id: [DAO00101_GetListSuatAn] PreparedStatement : [SELECT        kP.KHAUPHANAN_ID,        kP.MAKHAUPHANAN,        kP.TENKHAUPHANAN,        LKP.LOAIKHAUPHANAN_ID,        LKP.MALOAIKHAUPHANAN,        LKP.TENLOAIKHAUPHANAN,        DG.DONGIA,        kP.HANGMUC_ID        FROM TM_NUT_KHAUPHANAN kP        INNER JOIN TM_NUT_LOAIKHAUPHANAN LKP ON  kP.LOAIKHAUPHANAN_ID = LKP.LOAIKHAUPHANAN_ID        INNER JOIN TM_NUT_KHAUPHANAN_DONGIA DG ON DG.KHAUPHANAN_ID = kP.KHAUPHANAN_ID        WHERE DG.DONGIA IS NOT NULL]
2020-03-26 13:09:31,562 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'COM56'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 13:09:31,795 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'COM98'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 13:09:39,644 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NOITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = a.BENHAN_ID                 where(                             A.HUYHOADON = '1'                                             )                       and                           convert(date,A.NGAYHOADON) between convert(date, '3/1/2020 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is not null                order by A.NGAYHOADON]
2020-03-26 13:09:53,563 [1] DEBUG - Statement Id: [DAO00019_ThongTinBenhNhanBenhAn] PreparedStatement : [select distinct C.SOBENHAN, C.BENHAN_ID, A.SOTIEPNHAN, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI, A.SOBHYT,        B.*        from TT_NOITRU_BENHAN C        inner join TT_TIEPNHAN A on C.TIEPNHAN_ID = A.TIEPNHAN_ID        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'        where                    C.SOBENHAN = '20.002255'                 and A.BENHVIEN_ID = '01819']
2020-03-26 13:09:53,947 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_HINHTHUCTHANHTOAN_GetList] PreparedStatement : [select TT_HOADON_HINHTHUCTHANHTOAN.*, htttCode.DICTIONARY_CODE HINHTHUCTHANHTOAN_CODE            from TT_HOADON_HINHTHUCTHANHTOAN TT_HOADON_HINHTHUCTHANHTOAN            left join (select DICTIONARY_ID, DICTIONARY_CODE from LST_DICTIONARY where DICTIONARY_TYPE_CODE like 'HinhThucThanhToan') htttCode on htttCode.DICTIONARY_ID = TT_HOADON_HINHTHUCTHANHTOAN.HINHTHUCTHANHTOAN_ID             where                             TT_HOADON_HINHTHUCTHANHTOAN.HOADON_ID = '106692'                       and                           TT_HOADON_HINHTHUCTHANHTOAN.BENHVIEN_ID = '01819'                                     order by HOADON_HTTT_ID]
2020-03-26 13:09:54,025 [1] DEBUG - Statement Id: [DAO00119_TT_VIENPHI_GetList_BenhAnByHoadon] PreparedStatement : [select  a.*, a.MIENGIAM_GIATRI as GIATRIMIENGIAM_BH, a.BHTN_GIATRI as GIATRIMIENGIAM_BHTN,        a.HOIVIEN_GIATRI as GIATRIMIENGIAM_THANHVIEN, a.CONGTYCHITRA_GIATRI as GIATRIMIENGIAM_CTCT,        isnull(dv.TENDICHVU, dc.TENDUOCDAYDU) NOIDUNG, isnull(dv.MADICHVU, dc.MADUOC) MADICHVU, dv.NORESULT, dc.DONVITINH, ld.MALOAIDUOC, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ndv.MANHOMDICHVU        from        (        select * from (        select vp.*, c.NOITHUCHIEN_ID, c.NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_DVYEUCAU c on c.DVYEUCAU_ID = VP.REF_ID and vpp.REF_TABLE = 'TT_DVYEUCAU'        union        select vp.*, C.PHONGBANRATOA_ID as NOITHUCHIEN_ID, D.PHONGBAN_ID NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_NOITRU_TOATHUOC c on c.TOATHUOC_ID = VP.REF_ID and vpp.REF_TABLE = 'TT_NOITRU_TOATHUOC'        inner join TT_NOITRU_KHAMBENH D on D.KHAMBENH_ID = C.KHAMBENH_ID        union        select vp.*, C.PHONGBAN_ID as NOITHUCHIEN_ID, C.PHONGBAN_ID as NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_CLSKETQUA_VTYT c on c.CLSKETQUA_VTYT_ID = VP.REF_ID and vpp.REF_TABLE = 'TT_CLSKETQUA_VTYT'        union        select vp.*, ISNULL(D.PHONGBANTHUCHIEN_ID,d.PHONGBANCHIDINH_ID) as NOITHUCHIEN_ID, ISNULL(D.PHONGBANCHIDINH_ID,D.PHONGBANTHUCHIEN_ID) as NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_PHAUTHUAT_VTYT c on c.PHAUTHUAT_VTYT_ID = VP.REF_ID and vpp.REF_TABLE = 'TT_PHAUTHUAT_VTYT'        inner join TT_PHAUTHUAT D on D.PHAUTHUAT_ID = C.PHAUTHUAT_ID        union        select vp.*, c.PHONGBAN_ID as NOITHUCHIEN_ID, c.PHONGBAN_ID as NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_NGOAITRU_KHAMBENH_VTYT c on c.KHAMBENH_VTYT_ID = VP.REF_ID and vpp.REF_TABLE = 'TT_NGOAITRU_KHAMBENH_VTYT'        union        select vp.*, E.PHONGBAN_ID as NOITHUCHIEN_ID, E.PHONGBAN_ID as NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_NUT_XACNHANSUATAN_CHITIET XNC on XNC.XACNHANSUATANCHITIET_ID = vp.REF_ID and vpp.REF_TABLE = 'TT_NUT_XACNHANSUATAN_CHITIET'        inner join TT_NUT_CHIDINHKHAUPHAN_CHITIET D on D.CHIDINHKHAUPHANCHITIET_ID = XNC.CHIDINHKHAUPHANCHITIET_ID        inner join TM_NUT_KHAUPHANAN c on C.KHAUPHANAN_ID = D.KHAUPHANAN_ID        inner join TT_NUT_CHIDINHKHAUPHAN E on E.CHIDINHKHAUPHAN_ID = D.CHIDINHKHAUPHAN_ID        ) B        where B.HOADON_ID = '106692'        ) a        left join TM_DUOC dc on a.DUOC_ID = dc.DUOC_ID        left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID        left join TM_DICHVU dv on a.DICHVU_ID = dv.DICHVU_ID and a.REF_TABLE = 'TT_DVYEUCAU'        left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID]
2020-03-26 13:09:56,467 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 13:09:56,468 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 13:09:56,468 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2020-03-26 13:09:56,519 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1              and               BLCT.BIENLAICHITIET_ID = '1067'                         order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 13:09:56,519 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 13:09:56,519 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2020-03-26 13:09:56,572 [1] DEBUG - Statement Id: [DAO00014_GetInPatientStatus] PreparedStatement : [select TRANGTHAI, isnull(KHOACHUYENDEN_ID, KHOAVAO_ID) as KHOAHIENTAI from TT_NOITRU_BENHAN        where        TIEPNHAN_ID = '104260'        and BENHVIEN_ID = '01819'         and           BENHAN_ID = '19427']
--------------------------------------------------------------------------------
2020-03-26 13:19:21,489 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2020-03-26 13:19:21,792 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2020-03-26 13:19:21,832 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2020-03-26 13:19:22,380 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 13:19:22,666 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2020-03-26 13:19:29,808 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '01819' and TYPE = 'D']
2020-03-26 13:19:29,843 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '01819' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2020-03-26 13:19:33,321 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '01819')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '01819' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2020-03-26 13:19:33,818 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2020-03-26 13:19:34,896 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2020-03-26 13:19:35,154 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2020-03-26 13:19:35,300 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2020-03-26 13:19:35,528 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2020-03-26 13:19:35,634 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2020-03-26 13:19:35,726 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2020-03-26 13:19:35,828 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2020-03-26 13:19:35,992 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2020-03-26 13:19:36,088 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2020-03-26 13:19:36,679 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2020-03-26 13:19:36,729 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = '01819' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = '01819'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = '01819')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = '01819' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = '01819'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = '01819' AND TT_TONKHO.SOLUONG >= 0]
2020-03-26 13:19:36,871 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2020-03-26 13:19:36,915 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = '01819' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = '01819'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = '01819')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = '01819' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = '01819' and TT_TONKHO.SOLUONG >= 0]
2020-03-26 13:19:39,139 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2020-03-26 13:19:39,176 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @NGUONDUOC_MACDINH varchar(5) = '0';        declare @TOAMUANGOAI int = 0;        select @NGUONDUOC_MACDINH = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'PHA_NGUONDUOC'        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + @NGUONDUOC_MACDINH as DUOC_KEY, 0 as PHAMVI_ID, @NGUONDUOC_MACDINH as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = '01819'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = '01819')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = '01819'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = '01819')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = '01819'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = '01819'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = '01819'        where d.BENHVIEN_ID = '01819'  and tk.SOLUONG >= 0        end        else        begin                select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = '01819'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = '01819')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (        select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID)        B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (        select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID)        A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = '01819'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = '01819'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = '01819'        where d.BENHVIEN_ID = '01819'  and tk.SOLUONG >= 0        end]
2020-03-26 13:19:42,342 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2020-03-26 13:19:42,381 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,        SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH        FROM TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID        WHERE TK.SOLUONG > 0        GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2020-03-26 13:19:42,486 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2020-03-26 13:19:42,548 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,        TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,        TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH        from TM_MAU M        JOIN        (        select        A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO        from        (        select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO        from TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'        where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0        ) A        )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2020-03-26 13:19:42,670 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2020-03-26 13:19:43,649 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 13:19:44,802 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = '01819']
2020-03-26 13:19:52,415 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = '01819' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2020-03-26 13:19:52,481 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = '01819'              order by SETTING_ID]
2020-03-26 13:19:52,834 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 13:19:53,033 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 13:19:53,330 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2020-03-26 13:19:53,332 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,01819], @param1=[ACCOUNT_ID,113]]
2020-03-26 13:19:53,332 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2020-03-26 13:19:53,379 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2020-03-26 13:19:53,379 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,01819], @param1=[ACCOUNT_ID,113]]
2020-03-26 13:19:53,379 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2020-03-26 13:19:53,731 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 13:19:53,966 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 13:20:11,730 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 13:20:11,830 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = '01819' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2020-03-26 13:20:12,239 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = '01819' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2020-03-26 13:25:15,201 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'BIL27'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 13:25:16,814 [1] DEBUG - Statement Id: [DAO00119_GetDanhsachHTTT] PreparedStatement : [select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE = 'HinhThucThanhToan' and ENABLED = '1' and BENHVIEN_ID = '01819']
2020-03-26 13:25:18,218 [1] DEBUG - Statement Id: [DAO00101_GetListSuatAn] PreparedStatement : [SELECT        kP.KHAUPHANAN_ID,        kP.MAKHAUPHANAN,        kP.TENKHAUPHANAN,        LKP.LOAIKHAUPHANAN_ID,        LKP.MALOAIKHAUPHANAN,        LKP.TENLOAIKHAUPHANAN,        DG.DONGIA,        kP.HANGMUC_ID        FROM TM_NUT_KHAUPHANAN kP        INNER JOIN TM_NUT_LOAIKHAUPHANAN LKP ON  kP.LOAIKHAUPHANAN_ID = LKP.LOAIKHAUPHANAN_ID        INNER JOIN TM_NUT_KHAUPHANAN_DONGIA DG ON DG.KHAUPHANAN_ID = kP.KHAUPHANAN_ID        WHERE DG.DONGIA IS NOT NULL]
2020-03-26 13:25:34,899 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'COM56'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 13:25:35,159 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'COM98'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 13:25:41,813 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NGOAITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.TIEPNHAN_ID = a.TIEPNHAN_ID                 where(                             A.HUYHOADON = '1'                                             )                       and                           convert(date,A.NGAYHOADON) between convert(date, '3/1/2020 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is null or A.BENHAN_ID = 0                                     order by A.NGAYHOADON]
2020-03-26 13:25:57,894 [1] DEBUG - Statement Id: [DAO00019_ThongTinBenhNhanTiepNhan] PreparedStatement : [select distinct A.SOTIEPNHAN, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        B.*, A.SOBHYT        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'        where                    A.TIEPNHAN_ID = '107238'                 and A.BENHVIEN_ID = '01819']
2020-03-26 13:25:58,125 [1] DEBUG - Statement Id: [DAO00119_TT_VIENPHI_GetList_TiepNhanByHoadon] PreparedStatement : [select  a.*, a.MIENGIAM_GIATRI as GIATRIMIENGIAM_BH, a.BHTN_GIATRI as GIATRIMIENGIAM_BHTN, a.HOIVIEN_GIATRI as GIATRIMIENGIAM_THANHVIEN, a.CONGTYCHITRA_GIATRI as GIATRIMIENGIAM_CTCT,        isnull(dv.TENDICHVU, dc.TENDUOCDAYDU) NOIDUNG, isnull(dv.MADICHVU, dc.MADUOC) MADICHVU, dv.NORESULT, dc.DONVITINH, ld.MALOAIDUOC, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ndv.MANHOMDICHVU        from        (select        vp.HOADONCHITIET_ID, vp.HOADON_ID, vp.VIENPHI_ID, vp.REF_ID, vp.REF_TABLE, vp.DICHVU_ID, vp.DUOC_ID        , vp.LOAI_CHIPHI, vp.LOAIGIA_ID, vp.SOLUONG, vp.DONGIA_DOANHTHU, vp.THANHTIEN_DOANHTHU, vp.BHYT_TL, vpp.BHYT_DONGIA, vpp.BHYT_THANHTIEN, vpp.BHYT_DONGIA_CHITRA        , vp.BHYT_THANHTIEN_CHITRA, vp.BENHNHAN_PHAITHANHTOAN, vp.GIATRI_HOADON, vp.GIATRI_HOADON_DATHANHTOAN, vp.GIATRI_BIENLAI        , vp.GIATRI_BIENLAI_DATHANHTOAN, vp.GIATRI_BENHNHAN_DATHANHTOAN, vp.TYLE_THATTHU, vp.GIATRI_THATTHU, vp.MIENGIAM_TL, vp.MIENGIAM_GIATRI, vp.NGANSACH_TL, vp.NGANSACH_GIATRI        , vp.TAITRO_TL, vp.TAITRO_GIATRI, vp.BHTN_GIATRI, vp.NOIDUNGTHU, vp.CHUNGTUXUATBN_ID, vp.TYLEVAT, vp.GIATRIVAT, vp.MASOTHUE, vp.SOCHUNGTUKETOAN, vp.DAHOANTRA, c.TRANGTHAI        , vp.PHONGBAN_ID, vp.PHONGBAN_THAYDOI_ID, vp.CONGTYCHITRA_GIATRI, vp.HOIVIEN_GIATRI, vp.BENHVIEN_ID, isnull(c.NGAYGIOYEUCAU, vp.NGAYTAO) NGAYTAO, vp.NGUOITAO_ID, vp.NGAYCAPNHAT, vp.NGUOICAPNHAT_ID        , c.NOITHUCHIEN_ID, c.NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NGOAITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        left join TT_DVYEUCAU c on c.DVYEUCAU_ID = VP.REF_ID        where        vp.HOADON_ID = '107822'        ) a        left join TM_DUOC dc on a.DUOC_ID = dc.DUOC_ID        left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID        left join TM_DICHVU dv on a.DICHVU_ID = dv.DICHVU_ID and a.REF_TABLE = 'TT_DVYEUCAU'        left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID        WHERE a.REF_TABLE!='TT_MAU_CHUNGTU_CHITIET']
2020-03-26 13:25:58,323 [1] DEBUG - Statement Id: [DAO00087_GetServiceParams] PreparedStatement : [select CODE, VALUE              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = '01819']
2020-03-26 13:25:58,367 [1] DEBUG - Statement Id: [DAO00330_TT_VIENPHI_GetList_TiepNhanByHoadon] PreparedStatement : [select  a.*, a.MIENGIAM_GIATRI as GIATRIMIENGIAM_BH, a.BHTN_GIATRI as GIATRIMIENGIAM_BHTN, a.HOIVIEN_GIATRI as GIATRIMIENGIAM_THANHVIEN, a.CONGTYCHITRA_GIATRI as GIATRIMIENGIAM_CTCT        from        (select        vp.HOADONCHITIET_ID, vp.HOADON_ID, vp.VIENPHI_ID, vp.REF_ID, vp.REF_TABLE, vp.DICHVU_ID, vp.DUOC_ID        , vp.LOAI_CHIPHI, vp.LOAIGIA_ID, vp.SOLUONG, vp.DONGIA_DOANHTHU, vp.THANHTIEN_DOANHTHU, vp.BHYT_TL, vpp.BHYT_DONGIA, vpp.BHYT_THANHTIEN, vpp.BHYT_DONGIA_CHITRA        , vp.BHYT_THANHTIEN_CHITRA, vp.BENHNHAN_PHAITHANHTOAN, vp.GIATRI_HOADON, vp.GIATRI_HOADON_DATHANHTOAN, vp.GIATRI_BIENLAI        , vp.GIATRI_BIENLAI_DATHANHTOAN, vp.GIATRI_BENHNHAN_DATHANHTOAN, vp.TYLE_THATTHU, vp.GIATRI_THATTHU, vp.MIENGIAM_TL, vp.MIENGIAM_GIATRI, vp.NGANSACH_TL, vp.NGANSACH_GIATRI        , vp.TAITRO_TL, vp.TAITRO_GIATRI, vp.BHTN_GIATRI, vp.NOIDUNGTHU, vp.CHUNGTUXUATBN_ID, vp.TYLEVAT, vp.GIATRIVAT, vp.MASOTHUE, vp.SOCHUNGTUKETOAN, vp.DAHOANTRA, vp.TRANGTHAI        , vp.PHONGBAN_ID, vp.PHONGBAN_THAYDOI_ID, vp.CONGTYCHITRA_GIATRI, vp.HOIVIEN_GIATRI, vp.BENHVIEN_ID, vp.NGAYTAO, vp.NGUOITAO_ID, vp.NGAYCAPNHAT, vp.NGUOICAPNHAT_ID        , NULL AS NOITHUCHIEN_ID, dk.NOICHIDINH_ID as NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        ,M.TENMAU AS NOIDUNG, M.MAMAU AS MADICHVU, NULL AS NORESULT, DVT.TENDONVITINH AS DONVITINH, LM.MALOAIMAU AS MALOAIDUOC, M.BHYT AS DUOC_BHYT, 'M' AS LOAIVATTU_ID, NM.TENNHOMMAU AS MANHOMDICHVU        from TT_HOADON_CHITIET_NGOAITRU VP        join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        INNER JOIN TT_MAU_CHUNGTU_CHITIET CT ON VP.REF_ID=CT.CHUNGTUCHITIET_ID AND VP.REF_TABLE='TT_MAU_CHUNGTU_CHITIET' AND CT.BENHVIEN_ID='01819'        INNER JOIN TT_MAU_CHUNGTU CTU ON CT.CHUNGTU_ID=CTU.CHUNGTU_ID AND CTU.CHUNGTULIENQUAN_ID IS NULL        INNER join TM_MAU M on CT.MAU_ID = M.MAU_ID        LEFT JOIN TM_MAU_DONVITINH DVT ON M.DONVITINH_ID = DVT.DONVITINH_ID        LEFT JOIN TT_MAU_DANGKYMAU_CHITIET DKCT ON DKCT.CHUNGTU_ID = CTU.CHUNGTU_ID AND DKCT.BENHVIEN_ID='01819'        LEFT JOIN TT_MAU_DANGKYMAU DK ON DK.DANGKYMAU_ID = DKCT.DANGKYMAU_ID        LEFT JOIN TM_MAU_LOAIMAU LM ON LM.LOAIMAU_ID = M.LOAIMAU_ID        LEFT JOIN TM_MAU_NHOMMAU NM ON NM.NHOMMAU_ID = LM.NHOMMAU_ID        where        vp.HOADON_ID = '107822'        ) a]
2020-03-26 13:25:58,563 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_HINHTHUCTHANHTOAN_GetList] PreparedStatement : [select TT_HOADON_HINHTHUCTHANHTOAN.*, htttCode.DICTIONARY_CODE HINHTHUCTHANHTOAN_CODE            from TT_HOADON_HINHTHUCTHANHTOAN TT_HOADON_HINHTHUCTHANHTOAN            left join (select DICTIONARY_ID, DICTIONARY_CODE from LST_DICTIONARY where DICTIONARY_TYPE_CODE like 'HinhThucThanhToan') htttCode on htttCode.DICTIONARY_ID = TT_HOADON_HINHTHUCTHANHTOAN.HINHTHUCTHANHTOAN_ID             where                             TT_HOADON_HINHTHUCTHANHTOAN.HOADON_ID = '107822'                       and                           TT_HOADON_HINHTHUCTHANHTOAN.BENHVIEN_ID = '01819'                                     order by HOADON_HTTT_ID]
2020-03-26 13:25:58,635 [1] DEBUG - Statement Id: [DAO00114_GetThongtin_Congtyrahoadon] PreparedStatement : [select KH_TENCONGTY, KH_DIACHI, KH_MASOTHUE from TT_HOADON        where HOADON_ID = '107822']
2020-03-26 13:25:58,727 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 13:25:58,727 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 13:25:58,727 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2020-03-26 13:25:58,776 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1              and               BLCT.BIENLAICHITIET_ID = '1067'                         order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 13:25:58,776 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 13:25:58,776 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2020-03-26 13:26:17,866 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NGOAITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.TIEPNHAN_ID = a.TIEPNHAN_ID                 where(                           (A.DATHANHTOAN = '1'                         and                           A.TRANGTHAI != 'DADUYETCONGNO'                         )                          and (A.HUYHOADON is null or A.HUYHOADON = '0')                          and (A.HOANTRA is null or A.HOANTRA = '0')                                             )                       and                           A.TIEPNHAN_ID = '107238'                       and                         (bn.TENBENHNHAN like '%' +  @param0  + '%' or bn.MAYTE like '%' +  @param0  + '%')                       and                           convert(date,A.NGAYHOADON) between convert(date, '3/26/2020 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is null or A.BENHAN_ID = 0                                     order by A.NGAYHOADON]
2020-03-26 13:26:17,866 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] Parameters: [@param0=[TENBENHNHAN,200006325]]
2020-03-26 13:26:17,866 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] Types: [@param0=[String, System.String]]
2020-03-26 13:26:27,399 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NGOAITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.TIEPNHAN_ID = a.TIEPNHAN_ID                 where(                             A.HOANTRA = '1'                                             )                       and                           A.TIEPNHAN_ID = '107238'                       and                           convert(date,A.NGAYHOADON) between convert(date, '3/1/2020 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is null or A.BENHAN_ID = 0                                     order by A.NGAYHOADON]
2020-03-26 13:26:30,975 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NGOAITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.TIEPNHAN_ID = a.TIEPNHAN_ID                 where(                             A.HOANTRA = '1'                                             )                       and                           A.TIEPNHAN_ID = '107238'                       and                           convert(date,A.NGAYHOADON) between convert(date, '3/1/2020 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is null or A.BENHAN_ID = 0                                     order by A.NGAYHOADON]
2020-03-26 13:26:38,015 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NGOAITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.TIEPNHAN_ID = a.TIEPNHAN_ID                 where(                             A.HOANTRA = '1'                                             )                       and                           A.TIEPNHAN_ID = '107238'                       and                           convert(date,A.NGAYHOADON) between convert(date, '3/1/2020 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is null or A.BENHAN_ID = 0                                     order by A.NGAYHOADON]
2020-03-26 13:26:43,088 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NGOAITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.TIEPNHAN_ID = a.TIEPNHAN_ID                 where(                             A.HOANTRA = '1'                                             )                       and                           A.TIEPNHAN_ID = '107238'                       and                           convert(date,A.NGAYHOADON) between convert(date, '2/1/2020 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is null or A.BENHAN_ID = 0                                     order by A.NGAYHOADON]
2020-03-26 13:26:48,402 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NGOAITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.TIEPNHAN_ID = a.TIEPNHAN_ID                 where(                             A.HOANTRA = '1'                                             )                       and                           A.TIEPNHAN_ID = '107238'                       and                           convert(date,A.NGAYHOADON) between convert(date, '2/1/2020 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is null or A.BENHAN_ID = 0                                     order by A.NGAYHOADON]
2020-03-26 13:26:53,743 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NGOAITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.TIEPNHAN_ID = a.TIEPNHAN_ID                 where(                             A.HOANTRA = '1'                                             )                       and                           A.TIEPNHAN_ID = '107238'                       and                           convert(date,A.NGAYHOADON) between convert(date, '12/1/2019 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is null or A.BENHAN_ID = 0                                     order by A.NGAYHOADON]
2020-03-26 13:26:58,281 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NGOAITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.TIEPNHAN_ID = a.TIEPNHAN_ID                 where(                           (A.DATHANHTOAN = '1'                         and                           A.TRANGTHAI != 'DADUYETCONGNO'                         )                          and (A.HUYHOADON is null or A.HUYHOADON = '0')                          and (A.HOANTRA is null or A.HOANTRA = '0')                                             )                       and                           A.TIEPNHAN_ID = '107238'                       and                         (bn.TENBENHNHAN like '%' +  @param0  + '%' or bn.MAYTE like '%' +  @param0  + '%')                       and                           convert(date,A.NGAYHOADON) between convert(date, '3/26/2020 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is null or A.BENHAN_ID = 0                                     order by A.NGAYHOADON]
2020-03-26 13:26:58,281 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] Parameters: [@param0=[TENBENHNHAN,200006325]]
2020-03-26 13:26:58,281 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] Types: [@param0=[String, System.String]]
2020-03-26 13:27:03,042 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NGOAITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.TIEPNHAN_ID = a.TIEPNHAN_ID                 where(                           (A.DATHANHTOAN = '1'                         and                           A.TRANGTHAI != 'DADUYETCONGNO'                         )                          and (A.HUYHOADON is null or A.HUYHOADON = '0')                          and (A.HOANTRA is null or A.HOANTRA = '0')                                             )                       and                           A.TIEPNHAN_ID = '107238'                       and                         (bn.TENBENHNHAN like '%' +  @param0  + '%' or bn.MAYTE like '%' +  @param0  + '%')                       and                           convert(date,A.NGAYHOADON) between convert(date, '3/26/2020 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is null or A.BENHAN_ID = 0                                     order by A.NGAYHOADON]
2020-03-26 13:27:03,042 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] Parameters: [@param0=[TENBENHNHAN,200006325]]
2020-03-26 13:27:03,042 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] Types: [@param0=[String, System.String]]
2020-03-26 13:27:14,591 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NGOAITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.TIEPNHAN_ID = a.TIEPNHAN_ID                 where(                             A.HOANTRA = '1'                                             )                       and                           A.TIEPNHAN_ID = '107238'                       and                           convert(date,A.NGAYHOADON) between convert(date, '8/1/2019 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is null or A.BENHAN_ID = 0                                     order by A.NGAYHOADON]
2020-03-26 13:27:16,120 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NGOAITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.TIEPNHAN_ID = a.TIEPNHAN_ID                 where(                             A.HOANTRA = '1'                                             )                       and                           A.TIEPNHAN_ID = '107238'                       and                           convert(date,A.NGAYHOADON) between convert(date, '8/1/2019 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is null or A.BENHAN_ID = 0                                     order by A.NGAYHOADON]
2020-03-26 13:27:19,311 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NGOAITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.TIEPNHAN_ID = a.TIEPNHAN_ID                 where(                             A.HUYHOADON = '1'                                             )                       and                           A.TIEPNHAN_ID = '107238'                       and                           convert(date,A.NGAYHOADON) between convert(date, '8/1/2019 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is null or A.BENHAN_ID = 0                                     order by A.NGAYHOADON]
2020-03-26 13:27:25,676 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NGOAITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.TIEPNHAN_ID = a.TIEPNHAN_ID                 where(                             A.HOANTRA = '1'                                             )                       and                           A.TIEPNHAN_ID = '107238'                       and                           convert(date,A.NGAYHOADON) between convert(date, '8/1/2019 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is null or A.BENHAN_ID = 0                                     order by A.NGAYHOADON]
2020-03-26 13:27:31,664 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NGOAITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.TIEPNHAN_ID = a.TIEPNHAN_ID                 where(                             A.HOANTRA = '1'                                             )                       and                           A.TIEPNHAN_ID = '107238'                       and                           convert(date,A.NGAYHOADON) between convert(date, '4/1/2019 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is null or A.BENHAN_ID = 0                                     order by A.NGAYHOADON]
2020-03-26 13:27:32,855 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NGOAITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.TIEPNHAN_ID = a.TIEPNHAN_ID                 where(                             A.HOANTRA = '1'                                             )                       and                           A.TIEPNHAN_ID = '107238'                       and                           convert(date,A.NGAYHOADON) between convert(date, '4/1/2019 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is null or A.BENHAN_ID = 0                                     order by A.NGAYHOADON]
2020-03-26 13:27:39,471 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NGOAITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.TIEPNHAN_ID = a.TIEPNHAN_ID                 where(                             A.HOANTRA = '1'                                             )                       and                           A.TIEPNHAN_ID = '107238'                       and                           convert(date,A.NGAYHOADON) between convert(date, '9/1/2018 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is null or A.BENHAN_ID = 0                                     order by A.NGAYHOADON]
2020-03-26 13:27:47,059 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NGOAITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.TIEPNHAN_ID = a.TIEPNHAN_ID                 where(                           (A.DATHANHTOAN = '1'                         and                           A.TRANGTHAI != 'DADUYETCONGNO'                         )                          and (A.HUYHOADON is null or A.HUYHOADON = '0')                          and (A.HOANTRA is null or A.HOANTRA = '0')                                             )                       and                           A.TIEPNHAN_ID = '107238'                       and                         (bn.TENBENHNHAN like '%' +  @param0  + '%' or bn.MAYTE like '%' +  @param0  + '%')                       and                           convert(date,A.NGAYHOADON) between convert(date, '3/26/2020 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is null or A.BENHAN_ID = 0                                     order by A.NGAYHOADON]
2020-03-26 13:27:47,059 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] Parameters: [@param0=[TENBENHNHAN,200006325]]
2020-03-26 13:27:47,059 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] Types: [@param0=[String, System.String]]
2020-03-26 13:27:54,998 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NGOAITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.TIEPNHAN_ID = a.TIEPNHAN_ID                 where(                           (A.DATHANHTOAN = '1'                         and                           A.TRANGTHAI != 'DADUYETCONGNO'                         )                          and (A.HUYHOADON is null or A.HUYHOADON = '0')                          and (A.HOANTRA is null or A.HOANTRA = '0')                                             )                       and                           A.TIEPNHAN_ID = '107238'                       and                           convert(date,A.NGAYHOADON) between convert(date, '3/1/2020 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is null or A.BENHAN_ID = 0                                     order by A.NGAYHOADON]
2020-03-26 13:27:58,023 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NGOAITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.TIEPNHAN_ID = a.TIEPNHAN_ID                 where(                           (A.DATHANHTOAN = '1'                         and                           A.TRANGTHAI != 'DADUYETCONGNO'                         )                          and (A.HUYHOADON is null or A.HUYHOADON = '0')                          and (A.HOANTRA is null or A.HOANTRA = '0')                       or                           A.HUYHOADON = '1'                       or                           A.HOANTRA = '1'                       or                           A.DATHANHTOAN = 0                                             )                       and                           A.TIEPNHAN_ID = '107238'                       and                           convert(date,A.NGAYHOADON) between convert(date, '3/1/2020 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is null or A.BENHAN_ID = 0                                     order by A.NGAYHOADON]
2020-03-26 13:28:08,044 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NGOAITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.TIEPNHAN_ID = a.TIEPNHAN_ID                 where(                             A.HUYHOADON = '1'                                             )                       and                           A.TIEPNHAN_ID = '107238'                       and                           convert(date,A.NGAYHOADON) between convert(date, '3/1/2020 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is null or A.BENHAN_ID = 0                                     order by A.NGAYHOADON]
2020-03-26 13:28:11,016 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NGOAITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.TIEPNHAN_ID = a.TIEPNHAN_ID                 where(                             A.HOANTRA = '1'                                             )                       and                           A.TIEPNHAN_ID = '107238'                       and                           convert(date,A.NGAYHOADON) between convert(date, '3/1/2020 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is null or A.BENHAN_ID = 0                                     order by A.NGAYHOADON]
2020-03-26 13:28:25,196 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'COM31'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 13:28:25,431 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'BIL18'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 13:28:26,630 [1] DEBUG - Statement Id: [DAO00119_GetDanhsachHTTT] PreparedStatement : [select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE = 'HinhThucThanhToan' and ENABLED = '1' and BENHVIEN_ID = '01819']
2020-03-26 13:28:27,026 [1] DEBUG - Statement Id: [DAO00101_GetListSuatAn] PreparedStatement : [SELECT        kP.KHAUPHANAN_ID,        kP.MAKHAUPHANAN,        kP.TENKHAUPHANAN,        LKP.LOAIKHAUPHANAN_ID,        LKP.MALOAIKHAUPHANAN,        LKP.TENLOAIKHAUPHANAN,        DG.DONGIA,        kP.HANGMUC_ID        FROM TM_NUT_KHAUPHANAN kP        INNER JOIN TM_NUT_LOAIKHAUPHANAN LKP ON  kP.LOAIKHAUPHANAN_ID = LKP.LOAIKHAUPHANAN_ID        INNER JOIN TM_NUT_KHAUPHANAN_DONGIA DG ON DG.KHAUPHANAN_ID = kP.KHAUPHANAN_ID        WHERE DG.DONGIA IS NOT NULL]
2020-03-26 13:28:35,945 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NOITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = a.BENHAN_ID                 where(                             A.HOANTRA = '1'                                             )                       and                           convert(date,A.NGAYHOADON) between convert(date, '3/1/2020 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is not null                order by A.NGAYHOADON]
2020-03-26 13:28:44,929 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NOITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = a.BENHAN_ID                 where(                           (A.DATHANHTOAN = '1'                         and                           A.TRANGTHAI != 'DADUYETCONGNO'                         )                          and (A.HUYHOADON is null or A.HUYHOADON = '0')                          and (A.HOANTRA is null or A.HOANTRA = '0')                       or                           A.HUYHOADON = '1'                       or                           A.HOANTRA = '1'                       or                           A.DATHANHTOAN = 0                                             )                       and                           convert(date,A.NGAYHOADON) between convert(date, '3/1/2020 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is not null                order by A.NGAYHOADON]
--------------------------------------------------------------------------------
2020-03-26 13:32:53,101 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2020-03-26 13:32:53,417 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2020-03-26 13:32:53,457 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2020-03-26 13:32:54,392 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 13:32:54,703 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2020-03-26 13:33:04,279 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '01819' and TYPE = 'D']
2020-03-26 13:33:04,309 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '01819' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2020-03-26 13:33:06,292 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '01819')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '01819' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2020-03-26 13:33:06,384 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2020-03-26 13:33:07,303 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2020-03-26 13:33:07,534 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2020-03-26 13:33:07,626 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2020-03-26 13:33:07,771 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2020-03-26 13:33:07,864 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2020-03-26 13:33:07,963 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2020-03-26 13:33:08,061 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2020-03-26 13:33:08,140 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2020-03-26 13:33:08,284 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2020-03-26 13:33:08,802 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2020-03-26 13:33:08,865 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = '01819' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = '01819'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = '01819')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = '01819' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = '01819'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = '01819' AND TT_TONKHO.SOLUONG >= 0]
2020-03-26 13:33:08,943 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2020-03-26 13:33:08,979 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = '01819' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = '01819'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = '01819')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = '01819' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = '01819' and TT_TONKHO.SOLUONG >= 0]
2020-03-26 13:33:10,562 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2020-03-26 13:33:10,611 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @NGUONDUOC_MACDINH varchar(5) = '0';        declare @TOAMUANGOAI int = 0;        select @NGUONDUOC_MACDINH = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'PHA_NGUONDUOC'        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + @NGUONDUOC_MACDINH as DUOC_KEY, 0 as PHAMVI_ID, @NGUONDUOC_MACDINH as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = '01819'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = '01819')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = '01819'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = '01819')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = '01819'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = '01819'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = '01819'        where d.BENHVIEN_ID = '01819'  and tk.SOLUONG >= 0        end        else        begin                select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = '01819'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = '01819')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (        select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID)        B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (        select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID)        A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = '01819'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = '01819'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = '01819'        where d.BENHVIEN_ID = '01819'  and tk.SOLUONG >= 0        end]
2020-03-26 13:33:13,208 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2020-03-26 13:33:13,246 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,        SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH        FROM TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID        WHERE TK.SOLUONG > 0        GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2020-03-26 13:33:13,371 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2020-03-26 13:33:13,406 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,        TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,        TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH        from TM_MAU M        JOIN        (        select        A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO        from        (        select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO        from TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'        where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0        ) A        )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2020-03-26 13:33:13,516 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2020-03-26 13:33:14,435 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 13:33:15,401 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = '01819']
2020-03-26 13:33:22,411 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = '01819' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2020-03-26 13:33:22,442 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = '01819'              order by SETTING_ID]
2020-03-26 13:33:22,538 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 13:33:22,674 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 13:33:22,843 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2020-03-26 13:33:22,844 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,01819], @param1=[ACCOUNT_ID,113]]
2020-03-26 13:33:22,844 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2020-03-26 13:33:22,876 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2020-03-26 13:33:22,876 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,01819], @param1=[ACCOUNT_ID,113]]
2020-03-26 13:33:22,876 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2020-03-26 13:33:23,029 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 13:33:23,223 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 13:33:41,133 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 13:33:41,226 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = '01819' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2020-03-26 13:33:41,643 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = '01819' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2020-03-26 13:33:53,325 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'BIL27'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 13:33:55,326 [1] DEBUG - Statement Id: [DAO00119_GetDanhsachHTTT] PreparedStatement : [select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE = 'HinhThucThanhToan' and ENABLED = '1' and BENHVIEN_ID = '01819']
2020-03-26 13:33:56,782 [1] DEBUG - Statement Id: [DAO00101_GetListSuatAn] PreparedStatement : [SELECT        kP.KHAUPHANAN_ID,        kP.MAKHAUPHANAN,        kP.TENKHAUPHANAN,        LKP.LOAIKHAUPHANAN_ID,        LKP.MALOAIKHAUPHANAN,        LKP.TENLOAIKHAUPHANAN,        DG.DONGIA,        kP.HANGMUC_ID        FROM TM_NUT_KHAUPHANAN kP        INNER JOIN TM_NUT_LOAIKHAUPHANAN LKP ON  kP.LOAIKHAUPHANAN_ID = LKP.LOAIKHAUPHANAN_ID        INNER JOIN TM_NUT_KHAUPHANAN_DONGIA DG ON DG.KHAUPHANAN_ID = kP.KHAUPHANAN_ID        WHERE DG.DONGIA IS NOT NULL]
2020-03-26 13:34:10,005 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'COM31'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 13:34:10,221 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'BIL18'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 13:34:11,489 [1] DEBUG - Statement Id: [DAO00119_GetDanhsachHTTT] PreparedStatement : [select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE = 'HinhThucThanhToan' and ENABLED = '1' and BENHVIEN_ID = '01819']
2020-03-26 13:34:12,042 [1] DEBUG - Statement Id: [DAO00101_GetListSuatAn] PreparedStatement : [SELECT        kP.KHAUPHANAN_ID,        kP.MAKHAUPHANAN,        kP.TENKHAUPHANAN,        LKP.LOAIKHAUPHANAN_ID,        LKP.MALOAIKHAUPHANAN,        LKP.TENLOAIKHAUPHANAN,        DG.DONGIA,        kP.HANGMUC_ID        FROM TM_NUT_KHAUPHANAN kP        INNER JOIN TM_NUT_LOAIKHAUPHANAN LKP ON  kP.LOAIKHAUPHANAN_ID = LKP.LOAIKHAUPHANAN_ID        INNER JOIN TM_NUT_KHAUPHANAN_DONGIA DG ON DG.KHAUPHANAN_ID = kP.KHAUPHANAN_ID        WHERE DG.DONGIA IS NOT NULL]
2020-03-26 13:34:16,453 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'COM56'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 13:34:16,639 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'COM98'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 13:34:42,058 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NGOAITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.TIEPNHAN_ID = a.TIEPNHAN_ID                 where(                             A.HOANTRA = '1'                                             )                       and                           convert(date,A.NGAYHOADON) between convert(date, '9/1/2019 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is null or A.BENHAN_ID = 0                                     order by A.NGAYHOADON]
2020-03-26 13:36:14,443 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'COM37'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 13:36:15,657 [1] DEBUG - Statement Id: [DAO00119_TT_NOITRU_BENHAN_VP_Select] PreparedStatement : [select Count(*) as TOTAL from TT_VIENPHI        where BENHAN_ID = '' and HOADON_ID is not null and HOADON_ID in (select HOADON_ID from TT_HOADON where BENHAN_ID = '')]
2020-03-26 13:36:15,694 [1] DEBUG - Statement Id: [DAO00119_TT_NOITRU_XACNHAN_CHIPHI_Select] PreparedStatement : [select * from TT_NOITRU_XACNHAN_CHIPHI        where TIEPNHAN_ID = '']
2020-03-26 13:36:15,725 [1] DEBUG - Statement Id: [DAO00119_GetDanhsachHTTT] PreparedStatement : [select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE = 'HinhThucThanhToan' and ENABLED = '1' and BENHVIEN_ID = '01819']
2020-03-26 13:36:16,230 [1] DEBUG - Statement Id: [DAO00101_GetListSuatAn] PreparedStatement : [SELECT        kP.KHAUPHANAN_ID,        kP.MAKHAUPHANAN,        kP.TENKHAUPHANAN,        LKP.LOAIKHAUPHANAN_ID,        LKP.MALOAIKHAUPHANAN,        LKP.TENLOAIKHAUPHANAN,        DG.DONGIA,        kP.HANGMUC_ID        FROM TM_NUT_KHAUPHANAN kP        INNER JOIN TM_NUT_LOAIKHAUPHANAN LKP ON  kP.LOAIKHAUPHANAN_ID = LKP.LOAIKHAUPHANAN_ID        INNER JOIN TM_NUT_KHAUPHANAN_DONGIA DG ON DG.KHAUPHANAN_ID = kP.KHAUPHANAN_ID        WHERE DG.DONGIA IS NOT NULL]
--------------------------------------------------------------------------------
2020-03-26 13:45:33,997 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2020-03-26 13:45:34,441 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2020-03-26 13:45:34,484 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2020-03-26 13:45:35,147 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 13:45:35,526 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2020-03-26 13:45:41,718 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '01819' and TYPE = 'D']
2020-03-26 13:45:41,749 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '01819' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2020-03-26 13:45:46,196 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '01819')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '01819' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2020-03-26 13:45:46,307 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2020-03-26 13:45:47,310 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2020-03-26 13:45:47,676 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2020-03-26 13:45:47,757 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2020-03-26 13:45:47,938 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2020-03-26 13:45:48,053 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2020-03-26 13:45:48,205 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2020-03-26 13:45:48,325 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2020-03-26 13:45:48,460 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2020-03-26 13:45:48,618 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2020-03-26 13:45:49,155 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2020-03-26 13:45:49,189 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = '01819' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = '01819'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = '01819')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = '01819' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = '01819'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = '01819' AND TT_TONKHO.SOLUONG >= 0]
2020-03-26 13:45:49,267 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2020-03-26 13:45:49,309 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = '01819' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = '01819'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = '01819')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = '01819' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = '01819' and TT_TONKHO.SOLUONG >= 0]
2020-03-26 13:45:50,643 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2020-03-26 13:45:50,807 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @NGUONDUOC_MACDINH varchar(5) = '0';        declare @TOAMUANGOAI int = 0;        select @NGUONDUOC_MACDINH = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'PHA_NGUONDUOC'        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + @NGUONDUOC_MACDINH as DUOC_KEY, 0 as PHAMVI_ID, @NGUONDUOC_MACDINH as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = '01819'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = '01819')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = '01819'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = '01819')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = '01819'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = '01819'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = '01819'        where d.BENHVIEN_ID = '01819'  and tk.SOLUONG >= 0        end        else        begin                select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = '01819'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = '01819')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (        select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID)        B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (        select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID)        A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = '01819'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = '01819'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = '01819'        where d.BENHVIEN_ID = '01819'  and tk.SOLUONG >= 0        end]
2020-03-26 13:45:53,881 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2020-03-26 13:45:53,918 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,        SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH        FROM TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID        WHERE TK.SOLUONG > 0        GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2020-03-26 13:45:54,038 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2020-03-26 13:45:54,076 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,        TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,        TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH        from TM_MAU M        JOIN        (        select        A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO        from        (        select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO        from TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'        where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0        ) A        )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2020-03-26 13:45:54,187 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2020-03-26 13:45:55,155 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 13:45:56,390 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = '01819']
2020-03-26 13:46:03,483 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = '01819' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2020-03-26 13:46:03,544 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = '01819'              order by SETTING_ID]
2020-03-26 13:46:03,656 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 13:46:03,806 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 13:46:04,031 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2020-03-26 13:46:04,034 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,01819], @param1=[ACCOUNT_ID,113]]
2020-03-26 13:46:04,034 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2020-03-26 13:46:04,066 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2020-03-26 13:46:04,066 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,01819], @param1=[ACCOUNT_ID,113]]
2020-03-26 13:46:04,066 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2020-03-26 13:46:04,307 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 13:46:04,632 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 13:46:20,807 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 13:46:20,912 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = '01819' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2020-03-26 13:46:21,293 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = '01819' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2020-03-26 13:46:37,311 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'BIL27'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 13:46:39,503 [1] DEBUG - Statement Id: [DAO00119_GetDanhsachHTTT] PreparedStatement : [select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE = 'HinhThucThanhToan' and ENABLED = '1' and BENHVIEN_ID = '01819']
2020-03-26 13:46:41,197 [1] DEBUG - Statement Id: [DAO00101_GetListSuatAn] PreparedStatement : [SELECT        kP.KHAUPHANAN_ID,        kP.MAKHAUPHANAN,        kP.TENKHAUPHANAN,        LKP.LOAIKHAUPHANAN_ID,        LKP.MALOAIKHAUPHANAN,        LKP.TENLOAIKHAUPHANAN,        DG.DONGIA,        kP.HANGMUC_ID        FROM TM_NUT_KHAUPHANAN kP        INNER JOIN TM_NUT_LOAIKHAUPHANAN LKP ON  kP.LOAIKHAUPHANAN_ID = LKP.LOAIKHAUPHANAN_ID        INNER JOIN TM_NUT_KHAUPHANAN_DONGIA DG ON DG.KHAUPHANAN_ID = kP.KHAUPHANAN_ID        WHERE DG.DONGIA IS NOT NULL]
2020-03-26 13:46:45,561 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'COM56'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 13:46:45,829 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'COM98'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 13:46:53,156 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NGOAITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.TIEPNHAN_ID = a.TIEPNHAN_ID                 where(                             A.HOANTRA = '1'                                             )                       and                           convert(date,A.NGAYHOADON) between convert(date, '3/1/2020 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is null or A.BENHAN_ID = 0                                     order by A.NGAYHOADON]
2020-03-26 13:47:21,477 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NGOAITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.TIEPNHAN_ID = a.TIEPNHAN_ID                 where(                             A.HOANTRA = '1'                                             )                       and                           convert(date,A.NGAYHOADON) between convert(date, '3/1/2020 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is null or A.BENHAN_ID = 0                                     order by A.NGAYHOADON]
--------------------------------------------------------------------------------
2020-03-26 13:51:50,625 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2020-03-26 13:51:50,937 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2020-03-26 13:51:50,975 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2020-03-26 13:51:51,447 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 13:51:51,794 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2020-03-26 13:51:57,506 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '01819' and TYPE = 'D']
2020-03-26 13:51:57,537 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '01819' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2020-03-26 13:51:59,584 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '01819')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '01819' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2020-03-26 13:51:59,688 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2020-03-26 13:52:00,592 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2020-03-26 13:52:00,873 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2020-03-26 13:52:00,997 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2020-03-26 13:52:01,076 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2020-03-26 13:52:01,174 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2020-03-26 13:52:01,496 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2020-03-26 13:52:01,598 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2020-03-26 13:52:01,700 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2020-03-26 13:52:01,797 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2020-03-26 13:52:02,422 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2020-03-26 13:52:02,475 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = '01819' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = '01819'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = '01819')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = '01819' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = '01819'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = '01819' AND TT_TONKHO.SOLUONG >= 0]
2020-03-26 13:52:02,561 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2020-03-26 13:52:02,611 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = '01819' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = '01819'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = '01819')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = '01819' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = '01819' and TT_TONKHO.SOLUONG >= 0]
2020-03-26 13:52:04,921 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2020-03-26 13:52:04,964 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @NGUONDUOC_MACDINH varchar(5) = '0';        declare @TOAMUANGOAI int = 0;        select @NGUONDUOC_MACDINH = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'PHA_NGUONDUOC'        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + @NGUONDUOC_MACDINH as DUOC_KEY, 0 as PHAMVI_ID, @NGUONDUOC_MACDINH as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = '01819'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = '01819')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = '01819'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = '01819')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = '01819'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = '01819'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = '01819'        where d.BENHVIEN_ID = '01819'  and tk.SOLUONG >= 0        end        else        begin                select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = '01819'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = '01819')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (        select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID)        B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (        select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID)        A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = '01819'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = '01819'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = '01819'        where d.BENHVIEN_ID = '01819'  and tk.SOLUONG >= 0        end]
2020-03-26 13:52:07,857 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2020-03-26 13:52:07,891 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,        SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH        FROM TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID        WHERE TK.SOLUONG > 0        GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2020-03-26 13:52:07,997 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2020-03-26 13:52:08,030 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,        TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,        TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH        from TM_MAU M        JOIN        (        select        A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO        from        (        select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO        from TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'        where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0        ) A        )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2020-03-26 13:52:08,161 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2020-03-26 13:52:09,344 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 13:52:10,572 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = '01819']
2020-03-26 13:52:17,661 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = '01819' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2020-03-26 13:52:17,697 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = '01819'              order by SETTING_ID]
2020-03-26 13:52:17,811 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 13:52:17,964 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 13:52:18,137 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2020-03-26 13:52:18,139 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,01819], @param1=[ACCOUNT_ID,113]]
2020-03-26 13:52:18,139 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2020-03-26 13:52:18,170 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2020-03-26 13:52:18,170 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,01819], @param1=[ACCOUNT_ID,113]]
2020-03-26 13:52:18,170 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2020-03-26 13:52:18,324 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 13:52:18,515 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 13:52:29,030 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 13:52:29,133 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = '01819' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2020-03-26 13:52:29,567 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = '01819' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2020-03-26 13:52:37,548 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'BIL27'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 13:52:39,267 [1] DEBUG - Statement Id: [DAO00119_GetDanhsachHTTT] PreparedStatement : [select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE = 'HinhThucThanhToan' and ENABLED = '1' and BENHVIEN_ID = '01819']
2020-03-26 13:52:40,725 [1] DEBUG - Statement Id: [DAO00101_GetListSuatAn] PreparedStatement : [SELECT        kP.KHAUPHANAN_ID,        kP.MAKHAUPHANAN,        kP.TENKHAUPHANAN,        LKP.LOAIKHAUPHANAN_ID,        LKP.MALOAIKHAUPHANAN,        LKP.TENLOAIKHAUPHANAN,        DG.DONGIA,        kP.HANGMUC_ID        FROM TM_NUT_KHAUPHANAN kP        INNER JOIN TM_NUT_LOAIKHAUPHANAN LKP ON  kP.LOAIKHAUPHANAN_ID = LKP.LOAIKHAUPHANAN_ID        INNER JOIN TM_NUT_KHAUPHANAN_DONGIA DG ON DG.KHAUPHANAN_ID = kP.KHAUPHANAN_ID        WHERE DG.DONGIA IS NOT NULL]
2020-03-26 13:52:45,309 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'COM56'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 13:52:45,544 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'COM98'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 13:52:54,050 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NGOAITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.TIEPNHAN_ID = a.TIEPNHAN_ID                 where(                             A.HOANTRA = '1'                                             )                       and                           convert(date,A.NGAYHOADON) between convert(date, '3/1/2020 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is null or A.BENHAN_ID = 0                                     order by A.NGAYHOADON]
2020-03-26 13:53:03,925 [1] DEBUG - Statement Id: [DAO00019_ThongTinBenhNhanTiepNhan] PreparedStatement : [select distinct A.SOTIEPNHAN, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        B.*, A.SOBHYT        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'        where                    A.TIEPNHAN_ID = '108086'                 and A.BENHVIEN_ID = '01819']
2020-03-26 13:53:04,287 [1] DEBUG - Statement Id: [DAO00119_TT_VIENPHI_GetList_TiepNhanByHoadon] PreparedStatement : [select  a.*, a.MIENGIAM_GIATRI as GIATRIMIENGIAM_BH, a.BHTN_GIATRI as GIATRIMIENGIAM_BHTN, a.HOIVIEN_GIATRI as GIATRIMIENGIAM_THANHVIEN, a.CONGTYCHITRA_GIATRI as GIATRIMIENGIAM_CTCT,        isnull(dv.TENDICHVU, dc.TENDUOCDAYDU) NOIDUNG, isnull(dv.MADICHVU, dc.MADUOC) MADICHVU, dv.NORESULT, dc.DONVITINH, ld.MALOAIDUOC, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ndv.MANHOMDICHVU        from        (select        vp.HOADONCHITIET_ID, vp.HOADON_ID, vp.VIENPHI_ID, vp.REF_ID, vp.REF_TABLE, vp.DICHVU_ID, vp.DUOC_ID        , vp.LOAI_CHIPHI, vp.LOAIGIA_ID, vp.SOLUONG, vp.DONGIA_DOANHTHU, vp.THANHTIEN_DOANHTHU, vp.BHYT_TL, vpp.BHYT_DONGIA, vpp.BHYT_THANHTIEN, vpp.BHYT_DONGIA_CHITRA        , vp.BHYT_THANHTIEN_CHITRA, vp.BENHNHAN_PHAITHANHTOAN, vp.GIATRI_HOADON, vp.GIATRI_HOADON_DATHANHTOAN, vp.GIATRI_BIENLAI        , vp.GIATRI_BIENLAI_DATHANHTOAN, vp.GIATRI_BENHNHAN_DATHANHTOAN, vp.TYLE_THATTHU, vp.GIATRI_THATTHU, vp.MIENGIAM_TL, vp.MIENGIAM_GIATRI, vp.NGANSACH_TL, vp.NGANSACH_GIATRI        , vp.TAITRO_TL, vp.TAITRO_GIATRI, vp.BHTN_GIATRI, vp.NOIDUNGTHU, vp.CHUNGTUXUATBN_ID, vp.TYLEVAT, vp.GIATRIVAT, vp.MASOTHUE, vp.SOCHUNGTUKETOAN, vp.DAHOANTRA, c.TRANGTHAI        , vp.PHONGBAN_ID, vp.PHONGBAN_THAYDOI_ID, vp.CONGTYCHITRA_GIATRI, vp.HOIVIEN_GIATRI, vp.BENHVIEN_ID, isnull(c.NGAYGIOYEUCAU, vp.NGAYTAO) NGAYTAO, vp.NGUOITAO_ID, vp.NGAYCAPNHAT, vp.NGUOICAPNHAT_ID        , c.NOITHUCHIEN_ID, c.NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NGOAITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        left join TT_DVYEUCAU c on c.DVYEUCAU_ID = VP.REF_ID        where        vp.HOADON_ID = '108788'        ) a        left join TM_DUOC dc on a.DUOC_ID = dc.DUOC_ID        left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID        left join TM_DICHVU dv on a.DICHVU_ID = dv.DICHVU_ID and a.REF_TABLE = 'TT_DVYEUCAU'        left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID        WHERE a.REF_TABLE!='TT_MAU_CHUNGTU_CHITIET']
2020-03-26 13:53:04,451 [1] DEBUG - Statement Id: [DAO00087_GetServiceParams] PreparedStatement : [select CODE, VALUE              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = '01819']
2020-03-26 13:53:04,492 [1] DEBUG - Statement Id: [DAO00330_TT_VIENPHI_GetList_TiepNhanByHoadon] PreparedStatement : [select  a.*, a.MIENGIAM_GIATRI as GIATRIMIENGIAM_BH, a.BHTN_GIATRI as GIATRIMIENGIAM_BHTN, a.HOIVIEN_GIATRI as GIATRIMIENGIAM_THANHVIEN, a.CONGTYCHITRA_GIATRI as GIATRIMIENGIAM_CTCT        from        (select        vp.HOADONCHITIET_ID, vp.HOADON_ID, vp.VIENPHI_ID, vp.REF_ID, vp.REF_TABLE, vp.DICHVU_ID, vp.DUOC_ID        , vp.LOAI_CHIPHI, vp.LOAIGIA_ID, vp.SOLUONG, vp.DONGIA_DOANHTHU, vp.THANHTIEN_DOANHTHU, vp.BHYT_TL, vpp.BHYT_DONGIA, vpp.BHYT_THANHTIEN, vpp.BHYT_DONGIA_CHITRA        , vp.BHYT_THANHTIEN_CHITRA, vp.BENHNHAN_PHAITHANHTOAN, vp.GIATRI_HOADON, vp.GIATRI_HOADON_DATHANHTOAN, vp.GIATRI_BIENLAI        , vp.GIATRI_BIENLAI_DATHANHTOAN, vp.GIATRI_BENHNHAN_DATHANHTOAN, vp.TYLE_THATTHU, vp.GIATRI_THATTHU, vp.MIENGIAM_TL, vp.MIENGIAM_GIATRI, vp.NGANSACH_TL, vp.NGANSACH_GIATRI        , vp.TAITRO_TL, vp.TAITRO_GIATRI, vp.BHTN_GIATRI, vp.NOIDUNGTHU, vp.CHUNGTUXUATBN_ID, vp.TYLEVAT, vp.GIATRIVAT, vp.MASOTHUE, vp.SOCHUNGTUKETOAN, vp.DAHOANTRA, vp.TRANGTHAI        , vp.PHONGBAN_ID, vp.PHONGBAN_THAYDOI_ID, vp.CONGTYCHITRA_GIATRI, vp.HOIVIEN_GIATRI, vp.BENHVIEN_ID, vp.NGAYTAO, vp.NGUOITAO_ID, vp.NGAYCAPNHAT, vp.NGUOICAPNHAT_ID        , NULL AS NOITHUCHIEN_ID, dk.NOICHIDINH_ID as NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        ,M.TENMAU AS NOIDUNG, M.MAMAU AS MADICHVU, NULL AS NORESULT, DVT.TENDONVITINH AS DONVITINH, LM.MALOAIMAU AS MALOAIDUOC, M.BHYT AS DUOC_BHYT, 'M' AS LOAIVATTU_ID, NM.TENNHOMMAU AS MANHOMDICHVU        from TT_HOADON_CHITIET_NGOAITRU VP        join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        INNER JOIN TT_MAU_CHUNGTU_CHITIET CT ON VP.REF_ID=CT.CHUNGTUCHITIET_ID AND VP.REF_TABLE='TT_MAU_CHUNGTU_CHITIET' AND CT.BENHVIEN_ID='01819'        INNER JOIN TT_MAU_CHUNGTU CTU ON CT.CHUNGTU_ID=CTU.CHUNGTU_ID AND CTU.CHUNGTULIENQUAN_ID IS NULL        INNER join TM_MAU M on CT.MAU_ID = M.MAU_ID        LEFT JOIN TM_MAU_DONVITINH DVT ON M.DONVITINH_ID = DVT.DONVITINH_ID        LEFT JOIN TT_MAU_DANGKYMAU_CHITIET DKCT ON DKCT.CHUNGTU_ID = CTU.CHUNGTU_ID AND DKCT.BENHVIEN_ID='01819'        LEFT JOIN TT_MAU_DANGKYMAU DK ON DK.DANGKYMAU_ID = DKCT.DANGKYMAU_ID        LEFT JOIN TM_MAU_LOAIMAU LM ON LM.LOAIMAU_ID = M.LOAIMAU_ID        LEFT JOIN TM_MAU_NHOMMAU NM ON NM.NHOMMAU_ID = LM.NHOMMAU_ID        where        vp.HOADON_ID = '108788'        ) a]
2020-03-26 13:53:04,672 [1] DEBUG - Statement Id: [DAO00028_GetList] PreparedStatement : [select KHODUOC_ID,MAKHO, TENKHO, LOAIKHO_ID, LOAIDUOC, PHAMVI_ID, CHUYENKHOA_ID, PHONGBAN_ID,              CASE WHEN KHOQUANLY_ID IS NULL THEN 0  ELSE KHOQUANLY_ID  END  AS KHOQUANLY_ID,              lst.DICTIONARY_CODE  LOAIKHO              from TM_KHODUOC kd              left join LST_DICTIONARY lst on lst.DICTIONARY_ID = kd.LOAIKHO_ID and lst.DICTIONARY_TYPE_CODE = 'LoaiKhoDuoc'              where kd.TAMNGUNG = '0'              and kd.BENHVIEN_ID = '01819'              order by kd.TENKHO]
2020-03-26 13:53:05,991 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_HINHTHUCTHANHTOAN_GetList] PreparedStatement : [select TT_HOADON_HINHTHUCTHANHTOAN.*, htttCode.DICTIONARY_CODE HINHTHUCTHANHTOAN_CODE            from TT_HOADON_HINHTHUCTHANHTOAN TT_HOADON_HINHTHUCTHANHTOAN            left join (select DICTIONARY_ID, DICTIONARY_CODE from LST_DICTIONARY where DICTIONARY_TYPE_CODE like 'HinhThucThanhToan') htttCode on htttCode.DICTIONARY_ID = TT_HOADON_HINHTHUCTHANHTOAN.HINHTHUCTHANHTOAN_ID             where                             TT_HOADON_HINHTHUCTHANHTOAN.HOADON_ID = '108788'                       and                           TT_HOADON_HINHTHUCTHANHTOAN.BENHVIEN_ID = '01819'                                     order by HOADON_HTTT_ID]
2020-03-26 13:53:06,062 [1] DEBUG - Statement Id: [DAO00114_GetThongtin_Congtyrahoadon] PreparedStatement : [select KH_TENCONGTY, KH_DIACHI, KH_MASOTHUE from TT_HOADON        where HOADON_ID = '108788']
2020-03-26 13:53:06,148 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 13:53:06,148 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 13:53:06,148 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2020-03-26 13:53:06,198 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1              and               BLCT.BIENLAICHITIET_ID = '1067'                         order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 13:53:06,198 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 13:53:06,198 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2020-03-26 13:53:33,514 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NGOAITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.TIEPNHAN_ID = a.TIEPNHAN_ID                 where(                           (A.DATHANHTOAN = '1'                         and                           A.TRANGTHAI != 'DADUYETCONGNO'                         )                          and (A.HUYHOADON is null or A.HUYHOADON = '0')                          and (A.HOANTRA is null or A.HOANTRA = '0')                                             )                       and                           A.TIEPNHAN_ID = '108086'                       and                         (bn.TENBENHNHAN like '%' +  @param0  + '%' or bn.MAYTE like '%' +  @param0  + '%')                       and                           convert(date,A.NGAYHOADON) between convert(date, '3/26/2020 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is null or A.BENHAN_ID = 0                                     order by A.NGAYHOADON]
2020-03-26 13:53:33,514 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] Parameters: [@param0=[TENBENHNHAN,200006607]]
2020-03-26 13:53:33,514 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] Types: [@param0=[String, System.String]]
2020-03-26 13:53:37,981 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NGOAITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.TIEPNHAN_ID = a.TIEPNHAN_ID                 where(                           (A.DATHANHTOAN = '1'                         and                           A.TRANGTHAI != 'DADUYETCONGNO'                         )                          and (A.HUYHOADON is null or A.HUYHOADON = '0')                          and (A.HOANTRA is null or A.HOANTRA = '0')                       or                           A.HUYHOADON = '1'                       or                           A.HOANTRA = '1'                       or                           A.DATHANHTOAN = 0                                             )                       and                           A.TIEPNHAN_ID = '108086'                       and                         (bn.TENBENHNHAN like '%' +  @param0  + '%' or bn.MAYTE like '%' +  @param0  + '%')                       and                           convert(date,A.NGAYHOADON) between convert(date, '3/26/2020 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is null or A.BENHAN_ID = 0                                     order by A.NGAYHOADON]
2020-03-26 13:53:37,981 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] Parameters: [@param0=[TENBENHNHAN,200006607]]
2020-03-26 13:53:37,981 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] Types: [@param0=[String, System.String]]
2020-03-26 13:53:42,430 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NGOAITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.TIEPNHAN_ID = a.TIEPNHAN_ID                 where(                           (A.DATHANHTOAN = '1'                         and                           A.TRANGTHAI != 'DADUYETCONGNO'                         )                          and (A.HUYHOADON is null or A.HUYHOADON = '0')                          and (A.HOANTRA is null or A.HOANTRA = '0')                       or                           A.HUYHOADON = '1'                       or                           A.HOANTRA = '1'                       or                           A.DATHANHTOAN = 0                                             )                       and                           A.TIEPNHAN_ID = '108086'                       and                         (bn.TENBENHNHAN like '%' +  @param0  + '%' or bn.MAYTE like '%' +  @param0  + '%')                       and                           convert(date,A.NGAYHOADON) between convert(date, '3/26/2020 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is null or A.BENHAN_ID = 0                                     order by A.NGAYHOADON]
2020-03-26 13:53:42,430 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] Parameters: [@param0=[TENBENHNHAN,200006607]]
2020-03-26 13:53:42,430 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] Types: [@param0=[String, System.String]]
2020-03-26 13:53:45,455 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NGOAITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.TIEPNHAN_ID = a.TIEPNHAN_ID                 where(                           (A.DATHANHTOAN = '1'                         and                           A.TRANGTHAI != 'DADUYETCONGNO'                         )                          and (A.HUYHOADON is null or A.HUYHOADON = '0')                          and (A.HOANTRA is null or A.HOANTRA = '0')                       or                           A.HUYHOADON = '1'                       or                           A.HOANTRA = '1'                       or                           A.DATHANHTOAN = 0                                             )                       and                           A.TIEPNHAN_ID = '108086'                       and                         (bn.TENBENHNHAN like '%' +  @param0  + '%' or bn.MAYTE like '%' +  @param0  + '%')                       and                           convert(date,A.NGAYHOADON) between convert(date, '3/1/2020 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is null or A.BENHAN_ID = 0                                     order by A.NGAYHOADON]
2020-03-26 13:53:45,455 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] Parameters: [@param0=[TENBENHNHAN,200006607]]
2020-03-26 13:53:45,455 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] Types: [@param0=[String, System.String]]
--------------------------------------------------------------------------------
2020-03-26 14:01:42,654 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2020-03-26 14:01:42,953 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2020-03-26 14:01:42,996 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2020-03-26 14:01:43,465 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 14:01:43,719 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2020-03-26 14:04:25,103 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '01819' and TYPE = 'D']
2020-03-26 14:04:25,133 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '01819' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2020-03-26 14:04:27,355 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '01819')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '01819' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2020-03-26 14:04:27,534 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2020-03-26 14:04:28,468 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2020-03-26 14:04:28,721 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2020-03-26 14:04:28,837 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2020-03-26 14:04:28,969 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2020-03-26 14:04:29,125 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2020-03-26 14:04:29,269 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2020-03-26 14:04:29,355 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2020-03-26 14:04:29,431 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2020-03-26 14:04:29,507 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2020-03-26 14:04:30,173 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2020-03-26 14:04:30,260 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = '01819' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = '01819'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = '01819')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = '01819' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = '01819'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = '01819' AND TT_TONKHO.SOLUONG >= 0]
2020-03-26 14:04:30,407 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2020-03-26 14:04:30,441 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = '01819' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = '01819'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = '01819')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = '01819' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = '01819' and TT_TONKHO.SOLUONG >= 0]
2020-03-26 14:04:32,276 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2020-03-26 14:04:32,358 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @NGUONDUOC_MACDINH varchar(5) = '0';        declare @TOAMUANGOAI int = 0;        select @NGUONDUOC_MACDINH = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'PHA_NGUONDUOC'        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + @NGUONDUOC_MACDINH as DUOC_KEY, 0 as PHAMVI_ID, @NGUONDUOC_MACDINH as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = '01819'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = '01819')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = '01819'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = '01819')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = '01819'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = '01819'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = '01819'        where d.BENHVIEN_ID = '01819'  and tk.SOLUONG >= 0        end        else        begin                select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = '01819'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = '01819')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (        select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID)        B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (        select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID)        A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = '01819'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = '01819'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = '01819'        where d.BENHVIEN_ID = '01819'  and tk.SOLUONG >= 0        end]
2020-03-26 14:04:35,294 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2020-03-26 14:04:35,354 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,        SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH        FROM TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID        WHERE TK.SOLUONG > 0        GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2020-03-26 14:04:35,508 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2020-03-26 14:04:35,572 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,        TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,        TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH        from TM_MAU M        JOIN        (        select        A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO        from        (        select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO        from TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'        where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0        ) A        )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2020-03-26 14:04:35,717 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2020-03-26 14:04:36,757 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 14:04:38,225 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = '01819']
2020-03-26 14:04:43,781 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = '01819' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2020-03-26 14:04:43,811 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = '01819'              order by SETTING_ID]
2020-03-26 14:04:43,953 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 14:04:44,083 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 14:04:44,241 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2020-03-26 14:04:44,243 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,01819], @param1=[ACCOUNT_ID,113]]
2020-03-26 14:04:44,243 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2020-03-26 14:04:44,276 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2020-03-26 14:04:44,276 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,01819], @param1=[ACCOUNT_ID,113]]
2020-03-26 14:04:44,276 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2020-03-26 14:04:44,449 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 14:04:44,633 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 14:04:54,835 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 14:04:54,922 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = '01819' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2020-03-26 14:04:55,234 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = '01819' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2020-03-26 14:05:34,336 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'BIL27'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 14:05:35,897 [1] DEBUG - Statement Id: [DAO00119_GetDanhsachHTTT] PreparedStatement : [select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE = 'HinhThucThanhToan' and ENABLED = '1' and BENHVIEN_ID = '01819']
2020-03-26 14:05:37,521 [1] DEBUG - Statement Id: [DAO00101_GetListSuatAn] PreparedStatement : [SELECT        kP.KHAUPHANAN_ID,        kP.MAKHAUPHANAN,        kP.TENKHAUPHANAN,        LKP.LOAIKHAUPHANAN_ID,        LKP.MALOAIKHAUPHANAN,        LKP.TENLOAIKHAUPHANAN,        DG.DONGIA,        kP.HANGMUC_ID        FROM TM_NUT_KHAUPHANAN kP        INNER JOIN TM_NUT_LOAIKHAUPHANAN LKP ON  kP.LOAIKHAUPHANAN_ID = LKP.LOAIKHAUPHANAN_ID        INNER JOIN TM_NUT_KHAUPHANAN_DONGIA DG ON DG.KHAUPHANAN_ID = kP.KHAUPHANAN_ID        WHERE DG.DONGIA IS NOT NULL]
2020-03-26 14:05:40,246 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'COM56'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 14:05:40,422 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'COM98'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 14:05:49,929 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NGOAITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.TIEPNHAN_ID = a.TIEPNHAN_ID                 where(                             A.HOANTRA = '1'                                             )                       and                           convert(date,A.NGAYHOADON) between convert(date, '3/1/2020 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is null or A.BENHAN_ID = 0                                     order by A.NGAYHOADON]
2020-03-26 14:05:59,237 [1] DEBUG - Statement Id: [DAO00019_ThongTinBenhNhanTiepNhan] PreparedStatement : [select distinct A.SOTIEPNHAN, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        B.*, A.SOBHYT        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'        where                    A.TIEPNHAN_ID = '108086'                 and A.BENHVIEN_ID = '01819']
2020-03-26 14:05:59,432 [1] DEBUG - Statement Id: [DAO00119_TT_VIENPHI_GetList_TiepNhanByHoadon] PreparedStatement : [select  a.*, a.MIENGIAM_GIATRI as GIATRIMIENGIAM_BH, a.BHTN_GIATRI as GIATRIMIENGIAM_BHTN, a.HOIVIEN_GIATRI as GIATRIMIENGIAM_THANHVIEN, a.CONGTYCHITRA_GIATRI as GIATRIMIENGIAM_CTCT,        isnull(dv.TENDICHVU, dc.TENDUOCDAYDU) NOIDUNG, isnull(dv.MADICHVU, dc.MADUOC) MADICHVU, dv.NORESULT, dc.DONVITINH, ld.MALOAIDUOC, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ndv.MANHOMDICHVU        from        (select        vp.HOADONCHITIET_ID, vp.HOADON_ID, vp.VIENPHI_ID, vp.REF_ID, vp.REF_TABLE, vp.DICHVU_ID, vp.DUOC_ID        , vp.LOAI_CHIPHI, vp.LOAIGIA_ID, vp.SOLUONG, vp.DONGIA_DOANHTHU, vp.THANHTIEN_DOANHTHU, vp.BHYT_TL, vpp.BHYT_DONGIA, vpp.BHYT_THANHTIEN, vpp.BHYT_DONGIA_CHITRA        , vp.BHYT_THANHTIEN_CHITRA, vp.BENHNHAN_PHAITHANHTOAN, vp.GIATRI_HOADON, vp.GIATRI_HOADON_DATHANHTOAN, vp.GIATRI_BIENLAI        , vp.GIATRI_BIENLAI_DATHANHTOAN, vp.GIATRI_BENHNHAN_DATHANHTOAN, vp.TYLE_THATTHU, vp.GIATRI_THATTHU, vp.MIENGIAM_TL, vp.MIENGIAM_GIATRI, vp.NGANSACH_TL, vp.NGANSACH_GIATRI        , vp.TAITRO_TL, vp.TAITRO_GIATRI, vp.BHTN_GIATRI, vp.NOIDUNGTHU, vp.CHUNGTUXUATBN_ID, vp.TYLEVAT, vp.GIATRIVAT, vp.MASOTHUE, vp.SOCHUNGTUKETOAN, vp.DAHOANTRA, c.TRANGTHAI        , vp.PHONGBAN_ID, vp.PHONGBAN_THAYDOI_ID, vp.CONGTYCHITRA_GIATRI, vp.HOIVIEN_GIATRI, vp.BENHVIEN_ID, isnull(c.NGAYGIOYEUCAU, vp.NGAYTAO) NGAYTAO, vp.NGUOITAO_ID, vp.NGAYCAPNHAT, vp.NGUOICAPNHAT_ID        , c.NOITHUCHIEN_ID, c.NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NGOAITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        left join TT_DVYEUCAU c on c.DVYEUCAU_ID = VP.REF_ID        where        vp.HOADON_ID = '108788'        ) a        left join TM_DUOC dc on a.DUOC_ID = dc.DUOC_ID        left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID        left join TM_DICHVU dv on a.DICHVU_ID = dv.DICHVU_ID and a.REF_TABLE = 'TT_DVYEUCAU'        left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID        WHERE a.REF_TABLE!='TT_MAU_CHUNGTU_CHITIET']
2020-03-26 14:05:59,538 [1] DEBUG - Statement Id: [DAO00087_GetServiceParams] PreparedStatement : [select CODE, VALUE              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = '01819']
2020-03-26 14:05:59,578 [1] DEBUG - Statement Id: [DAO00330_TT_VIENPHI_GetList_TiepNhanByHoadon] PreparedStatement : [select  a.*, a.MIENGIAM_GIATRI as GIATRIMIENGIAM_BH, a.BHTN_GIATRI as GIATRIMIENGIAM_BHTN, a.HOIVIEN_GIATRI as GIATRIMIENGIAM_THANHVIEN, a.CONGTYCHITRA_GIATRI as GIATRIMIENGIAM_CTCT        from        (select        vp.HOADONCHITIET_ID, vp.HOADON_ID, vp.VIENPHI_ID, vp.REF_ID, vp.REF_TABLE, vp.DICHVU_ID, vp.DUOC_ID        , vp.LOAI_CHIPHI, vp.LOAIGIA_ID, vp.SOLUONG, vp.DONGIA_DOANHTHU, vp.THANHTIEN_DOANHTHU, vp.BHYT_TL, vpp.BHYT_DONGIA, vpp.BHYT_THANHTIEN, vpp.BHYT_DONGIA_CHITRA        , vp.BHYT_THANHTIEN_CHITRA, vp.BENHNHAN_PHAITHANHTOAN, vp.GIATRI_HOADON, vp.GIATRI_HOADON_DATHANHTOAN, vp.GIATRI_BIENLAI        , vp.GIATRI_BIENLAI_DATHANHTOAN, vp.GIATRI_BENHNHAN_DATHANHTOAN, vp.TYLE_THATTHU, vp.GIATRI_THATTHU, vp.MIENGIAM_TL, vp.MIENGIAM_GIATRI, vp.NGANSACH_TL, vp.NGANSACH_GIATRI        , vp.TAITRO_TL, vp.TAITRO_GIATRI, vp.BHTN_GIATRI, vp.NOIDUNGTHU, vp.CHUNGTUXUATBN_ID, vp.TYLEVAT, vp.GIATRIVAT, vp.MASOTHUE, vp.SOCHUNGTUKETOAN, vp.DAHOANTRA, vp.TRANGTHAI        , vp.PHONGBAN_ID, vp.PHONGBAN_THAYDOI_ID, vp.CONGTYCHITRA_GIATRI, vp.HOIVIEN_GIATRI, vp.BENHVIEN_ID, vp.NGAYTAO, vp.NGUOITAO_ID, vp.NGAYCAPNHAT, vp.NGUOICAPNHAT_ID        , NULL AS NOITHUCHIEN_ID, dk.NOICHIDINH_ID as NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        ,M.TENMAU AS NOIDUNG, M.MAMAU AS MADICHVU, NULL AS NORESULT, DVT.TENDONVITINH AS DONVITINH, LM.MALOAIMAU AS MALOAIDUOC, M.BHYT AS DUOC_BHYT, 'M' AS LOAIVATTU_ID, NM.TENNHOMMAU AS MANHOMDICHVU        from TT_HOADON_CHITIET_NGOAITRU VP        join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        INNER JOIN TT_MAU_CHUNGTU_CHITIET CT ON VP.REF_ID=CT.CHUNGTUCHITIET_ID AND VP.REF_TABLE='TT_MAU_CHUNGTU_CHITIET' AND CT.BENHVIEN_ID='01819'        INNER JOIN TT_MAU_CHUNGTU CTU ON CT.CHUNGTU_ID=CTU.CHUNGTU_ID AND CTU.CHUNGTULIENQUAN_ID IS NULL        INNER join TM_MAU M on CT.MAU_ID = M.MAU_ID        LEFT JOIN TM_MAU_DONVITINH DVT ON M.DONVITINH_ID = DVT.DONVITINH_ID        LEFT JOIN TT_MAU_DANGKYMAU_CHITIET DKCT ON DKCT.CHUNGTU_ID = CTU.CHUNGTU_ID AND DKCT.BENHVIEN_ID='01819'        LEFT JOIN TT_MAU_DANGKYMAU DK ON DK.DANGKYMAU_ID = DKCT.DANGKYMAU_ID        LEFT JOIN TM_MAU_LOAIMAU LM ON LM.LOAIMAU_ID = M.LOAIMAU_ID        LEFT JOIN TM_MAU_NHOMMAU NM ON NM.NHOMMAU_ID = LM.NHOMMAU_ID        where        vp.HOADON_ID = '108788'        ) a]
2020-03-26 14:05:59,753 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_HINHTHUCTHANHTOAN_GetList] PreparedStatement : [select TT_HOADON_HINHTHUCTHANHTOAN.*, htttCode.DICTIONARY_CODE HINHTHUCTHANHTOAN_CODE            from TT_HOADON_HINHTHUCTHANHTOAN TT_HOADON_HINHTHUCTHANHTOAN            left join (select DICTIONARY_ID, DICTIONARY_CODE from LST_DICTIONARY where DICTIONARY_TYPE_CODE like 'HinhThucThanhToan') htttCode on htttCode.DICTIONARY_ID = TT_HOADON_HINHTHUCTHANHTOAN.HINHTHUCTHANHTOAN_ID             where                             TT_HOADON_HINHTHUCTHANHTOAN.HOADON_ID = '108788'                       and                           TT_HOADON_HINHTHUCTHANHTOAN.BENHVIEN_ID = '01819'                                     order by HOADON_HTTT_ID]
2020-03-26 14:05:59,812 [1] DEBUG - Statement Id: [DAO00114_GetThongtin_Congtyrahoadon] PreparedStatement : [select KH_TENCONGTY, KH_DIACHI, KH_MASOTHUE from TT_HOADON        where HOADON_ID = '108788']
2020-03-26 14:05:59,911 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 14:05:59,912 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 14:05:59,912 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2020-03-26 14:05:59,964 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1              and               BLCT.BIENLAICHITIET_ID = '1067'                         order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 14:05:59,964 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 14:05:59,964 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2020-03-26 14:06:06,904 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NGOAITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.TIEPNHAN_ID = a.TIEPNHAN_ID                 where(                           (A.DATHANHTOAN = '1'                         and                           A.TRANGTHAI != 'DADUYETCONGNO'                         )                          and (A.HUYHOADON is null or A.HUYHOADON = '0')                          and (A.HOANTRA is null or A.HOANTRA = '0')                                             )                       and                           A.TIEPNHAN_ID = '108086'                       and                         (bn.TENBENHNHAN like '%' +  @param0  + '%' or bn.MAYTE like '%' +  @param0  + '%')                       and                           convert(date,A.NGAYHOADON) between convert(date, '3/26/2020 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is null or A.BENHAN_ID = 0                                     order by A.NGAYHOADON]
2020-03-26 14:06:06,904 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] Parameters: [@param0=[TENBENHNHAN,200006607]]
2020-03-26 14:06:06,904 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] Types: [@param0=[String, System.String]]
2020-03-26 14:06:10,948 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NGOAITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.TIEPNHAN_ID = a.TIEPNHAN_ID                 where(                           (A.DATHANHTOAN = '1'                         and                           A.TRANGTHAI != 'DADUYETCONGNO'                         )                          and (A.HUYHOADON is null or A.HUYHOADON = '0')                          and (A.HOANTRA is null or A.HOANTRA = '0')                       or                           A.HUYHOADON = '1'                       or                           A.HOANTRA = '1'                       or                           A.DATHANHTOAN = 0                                             )                       and                           A.TIEPNHAN_ID = '108086'                       and                         (bn.TENBENHNHAN like '%' +  @param0  + '%' or bn.MAYTE like '%' +  @param0  + '%')                       and                           convert(date,A.NGAYHOADON) between convert(date, '3/26/2020 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is null or A.BENHAN_ID = 0                                     order by A.NGAYHOADON]
2020-03-26 14:06:10,948 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] Parameters: [@param0=[TENBENHNHAN,200006607]]
2020-03-26 14:06:10,948 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] Types: [@param0=[String, System.String]]
2020-03-26 14:06:16,755 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NGOAITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.TIEPNHAN_ID = a.TIEPNHAN_ID                 where(                           (A.DATHANHTOAN = '1'                         and                           A.TRANGTHAI != 'DADUYETCONGNO'                         )                          and (A.HUYHOADON is null or A.HUYHOADON = '0')                          and (A.HOANTRA is null or A.HOANTRA = '0')                       or                           A.HUYHOADON = '1'                       or                           A.HOANTRA = '1'                       or                           A.DATHANHTOAN = 0                                             )                       and                           A.TIEPNHAN_ID = '108086'                       and                         (bn.TENBENHNHAN like '%' +  @param0  + '%' or bn.MAYTE like '%' +  @param0  + '%')                       and                           convert(date,A.NGAYHOADON) between convert(date, '3/26/2020 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is null or A.BENHAN_ID = 0                                     order by A.NGAYHOADON]
2020-03-26 14:06:16,755 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] Parameters: [@param0=[TENBENHNHAN,200006607]]
2020-03-26 14:06:16,755 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] Types: [@param0=[String, System.String]]
2020-03-26 14:06:20,643 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NGOAITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.TIEPNHAN_ID = a.TIEPNHAN_ID                 where(                           (A.DATHANHTOAN = '1'                         and                           A.TRANGTHAI != 'DADUYETCONGNO'                         )                          and (A.HUYHOADON is null or A.HUYHOADON = '0')                          and (A.HOANTRA is null or A.HOANTRA = '0')                       or                           A.HUYHOADON = '1'                       or                           A.HOANTRA = '1'                       or                           A.DATHANHTOAN = 0                                             )                       and                           A.TIEPNHAN_ID = '108086'                       and                         (bn.TENBENHNHAN like '%' +  @param0  + '%' or bn.MAYTE like '%' +  @param0  + '%')                       and                           convert(date,A.NGAYHOADON) between convert(date, '3/1/2020 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is null or A.BENHAN_ID = 0                                     order by A.NGAYHOADON]
2020-03-26 14:06:20,643 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] Parameters: [@param0=[TENBENHNHAN,200006607]]
2020-03-26 14:06:20,643 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] Types: [@param0=[String, System.String]]
2020-03-26 14:06:25,574 [1] DEBUG - Statement Id: [DAO00119_TT_VIENPHI_GetList_TiepNhanByHoadon] PreparedStatement : [select  a.*, a.MIENGIAM_GIATRI as GIATRIMIENGIAM_BH, a.BHTN_GIATRI as GIATRIMIENGIAM_BHTN, a.HOIVIEN_GIATRI as GIATRIMIENGIAM_THANHVIEN, a.CONGTYCHITRA_GIATRI as GIATRIMIENGIAM_CTCT,        isnull(dv.TENDICHVU, dc.TENDUOCDAYDU) NOIDUNG, isnull(dv.MADICHVU, dc.MADUOC) MADICHVU, dv.NORESULT, dc.DONVITINH, ld.MALOAIDUOC, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ndv.MANHOMDICHVU        from        (select        vp.HOADONCHITIET_ID, vp.HOADON_ID, vp.VIENPHI_ID, vp.REF_ID, vp.REF_TABLE, vp.DICHVU_ID, vp.DUOC_ID        , vp.LOAI_CHIPHI, vp.LOAIGIA_ID, vp.SOLUONG, vp.DONGIA_DOANHTHU, vp.THANHTIEN_DOANHTHU, vp.BHYT_TL, vpp.BHYT_DONGIA, vpp.BHYT_THANHTIEN, vpp.BHYT_DONGIA_CHITRA        , vp.BHYT_THANHTIEN_CHITRA, vp.BENHNHAN_PHAITHANHTOAN, vp.GIATRI_HOADON, vp.GIATRI_HOADON_DATHANHTOAN, vp.GIATRI_BIENLAI        , vp.GIATRI_BIENLAI_DATHANHTOAN, vp.GIATRI_BENHNHAN_DATHANHTOAN, vp.TYLE_THATTHU, vp.GIATRI_THATTHU, vp.MIENGIAM_TL, vp.MIENGIAM_GIATRI, vp.NGANSACH_TL, vp.NGANSACH_GIATRI        , vp.TAITRO_TL, vp.TAITRO_GIATRI, vp.BHTN_GIATRI, vp.NOIDUNGTHU, vp.CHUNGTUXUATBN_ID, vp.TYLEVAT, vp.GIATRIVAT, vp.MASOTHUE, vp.SOCHUNGTUKETOAN, vp.DAHOANTRA, c.TRANGTHAI        , vp.PHONGBAN_ID, vp.PHONGBAN_THAYDOI_ID, vp.CONGTYCHITRA_GIATRI, vp.HOIVIEN_GIATRI, vp.BENHVIEN_ID, isnull(c.NGAYGIOYEUCAU, vp.NGAYTAO) NGAYTAO, vp.NGUOITAO_ID, vp.NGAYCAPNHAT, vp.NGUOICAPNHAT_ID        , c.NOITHUCHIEN_ID, c.NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NGOAITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        left join TT_DVYEUCAU c on c.DVYEUCAU_ID = VP.REF_ID        where        vp.HOADON_ID = '108918'        ) a        left join TM_DUOC dc on a.DUOC_ID = dc.DUOC_ID        left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID        left join TM_DICHVU dv on a.DICHVU_ID = dv.DICHVU_ID and a.REF_TABLE = 'TT_DVYEUCAU'        left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID        WHERE a.REF_TABLE!='TT_MAU_CHUNGTU_CHITIET']
2020-03-26 14:06:25,647 [1] DEBUG - Statement Id: [DAO00330_TT_VIENPHI_GetList_TiepNhanByHoadon] PreparedStatement : [select  a.*, a.MIENGIAM_GIATRI as GIATRIMIENGIAM_BH, a.BHTN_GIATRI as GIATRIMIENGIAM_BHTN, a.HOIVIEN_GIATRI as GIATRIMIENGIAM_THANHVIEN, a.CONGTYCHITRA_GIATRI as GIATRIMIENGIAM_CTCT        from        (select        vp.HOADONCHITIET_ID, vp.HOADON_ID, vp.VIENPHI_ID, vp.REF_ID, vp.REF_TABLE, vp.DICHVU_ID, vp.DUOC_ID        , vp.LOAI_CHIPHI, vp.LOAIGIA_ID, vp.SOLUONG, vp.DONGIA_DOANHTHU, vp.THANHTIEN_DOANHTHU, vp.BHYT_TL, vpp.BHYT_DONGIA, vpp.BHYT_THANHTIEN, vpp.BHYT_DONGIA_CHITRA        , vp.BHYT_THANHTIEN_CHITRA, vp.BENHNHAN_PHAITHANHTOAN, vp.GIATRI_HOADON, vp.GIATRI_HOADON_DATHANHTOAN, vp.GIATRI_BIENLAI        , vp.GIATRI_BIENLAI_DATHANHTOAN, vp.GIATRI_BENHNHAN_DATHANHTOAN, vp.TYLE_THATTHU, vp.GIATRI_THATTHU, vp.MIENGIAM_TL, vp.MIENGIAM_GIATRI, vp.NGANSACH_TL, vp.NGANSACH_GIATRI        , vp.TAITRO_TL, vp.TAITRO_GIATRI, vp.BHTN_GIATRI, vp.NOIDUNGTHU, vp.CHUNGTUXUATBN_ID, vp.TYLEVAT, vp.GIATRIVAT, vp.MASOTHUE, vp.SOCHUNGTUKETOAN, vp.DAHOANTRA, vp.TRANGTHAI        , vp.PHONGBAN_ID, vp.PHONGBAN_THAYDOI_ID, vp.CONGTYCHITRA_GIATRI, vp.HOIVIEN_GIATRI, vp.BENHVIEN_ID, vp.NGAYTAO, vp.NGUOITAO_ID, vp.NGAYCAPNHAT, vp.NGUOICAPNHAT_ID        , NULL AS NOITHUCHIEN_ID, dk.NOICHIDINH_ID as NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        ,M.TENMAU AS NOIDUNG, M.MAMAU AS MADICHVU, NULL AS NORESULT, DVT.TENDONVITINH AS DONVITINH, LM.MALOAIMAU AS MALOAIDUOC, M.BHYT AS DUOC_BHYT, 'M' AS LOAIVATTU_ID, NM.TENNHOMMAU AS MANHOMDICHVU        from TT_HOADON_CHITIET_NGOAITRU VP        join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        INNER JOIN TT_MAU_CHUNGTU_CHITIET CT ON VP.REF_ID=CT.CHUNGTUCHITIET_ID AND VP.REF_TABLE='TT_MAU_CHUNGTU_CHITIET' AND CT.BENHVIEN_ID='01819'        INNER JOIN TT_MAU_CHUNGTU CTU ON CT.CHUNGTU_ID=CTU.CHUNGTU_ID AND CTU.CHUNGTULIENQUAN_ID IS NULL        INNER join TM_MAU M on CT.MAU_ID = M.MAU_ID        LEFT JOIN TM_MAU_DONVITINH DVT ON M.DONVITINH_ID = DVT.DONVITINH_ID        LEFT JOIN TT_MAU_DANGKYMAU_CHITIET DKCT ON DKCT.CHUNGTU_ID = CTU.CHUNGTU_ID AND DKCT.BENHVIEN_ID='01819'        LEFT JOIN TT_MAU_DANGKYMAU DK ON DK.DANGKYMAU_ID = DKCT.DANGKYMAU_ID        LEFT JOIN TM_MAU_LOAIMAU LM ON LM.LOAIMAU_ID = M.LOAIMAU_ID        LEFT JOIN TM_MAU_NHOMMAU NM ON NM.NHOMMAU_ID = LM.NHOMMAU_ID        where        vp.HOADON_ID = '108918'        ) a]
2020-03-26 14:06:25,735 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_HINHTHUCTHANHTOAN_GetList] PreparedStatement : [select TT_HOADON_HINHTHUCTHANHTOAN.*, htttCode.DICTIONARY_CODE HINHTHUCTHANHTOAN_CODE            from TT_HOADON_HINHTHUCTHANHTOAN TT_HOADON_HINHTHUCTHANHTOAN            left join (select DICTIONARY_ID, DICTIONARY_CODE from LST_DICTIONARY where DICTIONARY_TYPE_CODE like 'HinhThucThanhToan') htttCode on htttCode.DICTIONARY_ID = TT_HOADON_HINHTHUCTHANHTOAN.HINHTHUCTHANHTOAN_ID             where                             TT_HOADON_HINHTHUCTHANHTOAN.HOADON_ID = '108918'                       and                           TT_HOADON_HINHTHUCTHANHTOAN.BENHVIEN_ID = '01819'                                     order by HOADON_HTTT_ID]
2020-03-26 14:06:25,791 [1] DEBUG - Statement Id: [DAO00114_GetThongtin_Congtyrahoadon] PreparedStatement : [select KH_TENCONGTY, KH_DIACHI, KH_MASOTHUE from TT_HOADON        where HOADON_ID = '108918']
2020-03-26 14:06:25,872 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 14:06:25,873 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 14:06:25,873 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2020-03-26 14:06:25,906 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 14:06:25,906 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 14:06:25,906 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2020-03-26 14:06:25,952 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1              and               BLCT.BIENLAICHITIET_ID = '1067'                         order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 14:06:25,952 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 14:06:25,952 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
--------------------------------------------------------------------------------
2020-03-26 14:13:31,784 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2020-03-26 14:13:32,178 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2020-03-26 14:13:32,220 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2020-03-26 14:13:33,273 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 14:13:33,890 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2020-03-26 14:13:42,710 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '01819' and TYPE = 'D']
2020-03-26 14:13:42,742 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '01819' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2020-03-26 14:13:45,137 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '01819')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '01819' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2020-03-26 14:13:45,236 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2020-03-26 14:13:46,435 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2020-03-26 14:13:46,766 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2020-03-26 14:13:46,861 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2020-03-26 14:13:47,076 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2020-03-26 14:13:47,223 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2020-03-26 14:13:47,309 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2020-03-26 14:13:47,403 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2020-03-26 14:13:47,564 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2020-03-26 14:13:47,734 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2020-03-26 14:13:48,560 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2020-03-26 14:13:48,641 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = '01819' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = '01819'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = '01819')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = '01819' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = '01819'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = '01819' AND TT_TONKHO.SOLUONG >= 0]
2020-03-26 14:13:48,747 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2020-03-26 14:13:48,783 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = '01819' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = '01819'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = '01819')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = '01819' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = '01819' and TT_TONKHO.SOLUONG >= 0]
2020-03-26 14:13:50,998 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2020-03-26 14:13:51,042 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @NGUONDUOC_MACDINH varchar(5) = '0';        declare @TOAMUANGOAI int = 0;        select @NGUONDUOC_MACDINH = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'PHA_NGUONDUOC'        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + @NGUONDUOC_MACDINH as DUOC_KEY, 0 as PHAMVI_ID, @NGUONDUOC_MACDINH as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = '01819'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = '01819')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = '01819'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = '01819')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = '01819'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = '01819'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = '01819'        where d.BENHVIEN_ID = '01819'  and tk.SOLUONG >= 0        end        else        begin                select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = '01819'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = '01819')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (        select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID)        B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (        select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID)        A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = '01819'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = '01819'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = '01819'        where d.BENHVIEN_ID = '01819'  and tk.SOLUONG >= 0        end]
2020-03-26 14:13:53,974 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2020-03-26 14:13:54,044 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,        SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH        FROM TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID        WHERE TK.SOLUONG > 0        GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2020-03-26 14:13:54,159 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2020-03-26 14:13:54,214 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,        TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,        TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH        from TM_MAU M        JOIN        (        select        A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO        from        (        select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO        from TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'        where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0        ) A        )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2020-03-26 14:13:54,326 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2020-03-26 14:13:55,265 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 14:13:56,342 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = '01819']
2020-03-26 14:14:04,825 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = '01819' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2020-03-26 14:14:04,859 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = '01819'              order by SETTING_ID]
2020-03-26 14:14:04,978 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 14:14:05,153 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 14:14:05,350 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2020-03-26 14:14:05,354 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,01819], @param1=[ACCOUNT_ID,113]]
2020-03-26 14:14:05,354 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2020-03-26 14:14:05,390 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2020-03-26 14:14:05,390 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,01819], @param1=[ACCOUNT_ID,113]]
2020-03-26 14:14:05,390 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2020-03-26 14:14:05,565 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 14:14:05,811 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 14:14:27,681 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 14:14:27,779 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = '01819' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2020-03-26 14:14:28,139 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = '01819' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2020-03-26 14:14:32,393 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'BIL27'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 14:14:34,490 [1] DEBUG - Statement Id: [DAO00119_GetDanhsachHTTT] PreparedStatement : [select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE = 'HinhThucThanhToan' and ENABLED = '1' and BENHVIEN_ID = '01819']
2020-03-26 14:14:36,042 [1] DEBUG - Statement Id: [DAO00101_GetListSuatAn] PreparedStatement : [SELECT        kP.KHAUPHANAN_ID,        kP.MAKHAUPHANAN,        kP.TENKHAUPHANAN,        LKP.LOAIKHAUPHANAN_ID,        LKP.MALOAIKHAUPHANAN,        LKP.TENLOAIKHAUPHANAN,        DG.DONGIA,        kP.HANGMUC_ID        FROM TM_NUT_KHAUPHANAN kP        INNER JOIN TM_NUT_LOAIKHAUPHANAN LKP ON  kP.LOAIKHAUPHANAN_ID = LKP.LOAIKHAUPHANAN_ID        INNER JOIN TM_NUT_KHAUPHANAN_DONGIA DG ON DG.KHAUPHANAN_ID = kP.KHAUPHANAN_ID        WHERE DG.DONGIA IS NOT NULL]
2020-03-26 14:14:39,037 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'COM56'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 14:14:39,241 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'COM98'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 14:14:51,182 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NGOAITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.TIEPNHAN_ID = a.TIEPNHAN_ID                 where(                             A.HUYHOADON = '1'                                             )                       and                           convert(date,A.NGAYHOADON) between convert(date, '3/1/2020 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is null or A.BENHAN_ID = 0                                     order by A.NGAYHOADON]
2020-03-26 14:14:54,204 [1] DEBUG - Statement Id: [DAO00019_ThongTinBenhNhanTiepNhan] PreparedStatement : [select distinct A.SOTIEPNHAN, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        B.*, A.SOBHYT        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'        where                    A.TIEPNHAN_ID = '107238'                 and A.BENHVIEN_ID = '01819']
2020-03-26 14:14:54,465 [1] DEBUG - Statement Id: [DAO00119_TT_VIENPHI_GetList_TiepNhanByHoadon] PreparedStatement : [select  a.*, a.MIENGIAM_GIATRI as GIATRIMIENGIAM_BH, a.BHTN_GIATRI as GIATRIMIENGIAM_BHTN, a.HOIVIEN_GIATRI as GIATRIMIENGIAM_THANHVIEN, a.CONGTYCHITRA_GIATRI as GIATRIMIENGIAM_CTCT,        isnull(dv.TENDICHVU, dc.TENDUOCDAYDU) NOIDUNG, isnull(dv.MADICHVU, dc.MADUOC) MADICHVU, dv.NORESULT, dc.DONVITINH, ld.MALOAIDUOC, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ndv.MANHOMDICHVU        from        (select        vp.HOADONCHITIET_ID, vp.HOADON_ID, vp.VIENPHI_ID, vp.REF_ID, vp.REF_TABLE, vp.DICHVU_ID, vp.DUOC_ID        , vp.LOAI_CHIPHI, vp.LOAIGIA_ID, vp.SOLUONG, vp.DONGIA_DOANHTHU, vp.THANHTIEN_DOANHTHU, vp.BHYT_TL, vpp.BHYT_DONGIA, vpp.BHYT_THANHTIEN, vpp.BHYT_DONGIA_CHITRA        , vp.BHYT_THANHTIEN_CHITRA, vp.BENHNHAN_PHAITHANHTOAN, vp.GIATRI_HOADON, vp.GIATRI_HOADON_DATHANHTOAN, vp.GIATRI_BIENLAI        , vp.GIATRI_BIENLAI_DATHANHTOAN, vp.GIATRI_BENHNHAN_DATHANHTOAN, vp.TYLE_THATTHU, vp.GIATRI_THATTHU, vp.MIENGIAM_TL, vp.MIENGIAM_GIATRI, vp.NGANSACH_TL, vp.NGANSACH_GIATRI        , vp.TAITRO_TL, vp.TAITRO_GIATRI, vp.BHTN_GIATRI, vp.NOIDUNGTHU, vp.CHUNGTUXUATBN_ID, vp.TYLEVAT, vp.GIATRIVAT, vp.MASOTHUE, vp.SOCHUNGTUKETOAN, vp.DAHOANTRA, c.TRANGTHAI        , vp.PHONGBAN_ID, vp.PHONGBAN_THAYDOI_ID, vp.CONGTYCHITRA_GIATRI, vp.HOIVIEN_GIATRI, vp.BENHVIEN_ID, isnull(c.NGAYGIOYEUCAU, vp.NGAYTAO) NGAYTAO, vp.NGUOITAO_ID, vp.NGAYCAPNHAT, vp.NGUOICAPNHAT_ID        , c.NOITHUCHIEN_ID, c.NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NGOAITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        left join TT_DVYEUCAU c on c.DVYEUCAU_ID = VP.REF_ID        where        vp.HOADON_ID = '107822'        ) a        left join TM_DUOC dc on a.DUOC_ID = dc.DUOC_ID        left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID        left join TM_DICHVU dv on a.DICHVU_ID = dv.DICHVU_ID and a.REF_TABLE = 'TT_DVYEUCAU'        left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID        WHERE a.REF_TABLE!='TT_MAU_CHUNGTU_CHITIET']
2020-03-26 14:14:54,575 [1] DEBUG - Statement Id: [DAO00087_GetServiceParams] PreparedStatement : [select CODE, VALUE              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = '01819']
2020-03-26 14:14:54,616 [1] DEBUG - Statement Id: [DAO00330_TT_VIENPHI_GetList_TiepNhanByHoadon] PreparedStatement : [select  a.*, a.MIENGIAM_GIATRI as GIATRIMIENGIAM_BH, a.BHTN_GIATRI as GIATRIMIENGIAM_BHTN, a.HOIVIEN_GIATRI as GIATRIMIENGIAM_THANHVIEN, a.CONGTYCHITRA_GIATRI as GIATRIMIENGIAM_CTCT        from        (select        vp.HOADONCHITIET_ID, vp.HOADON_ID, vp.VIENPHI_ID, vp.REF_ID, vp.REF_TABLE, vp.DICHVU_ID, vp.DUOC_ID        , vp.LOAI_CHIPHI, vp.LOAIGIA_ID, vp.SOLUONG, vp.DONGIA_DOANHTHU, vp.THANHTIEN_DOANHTHU, vp.BHYT_TL, vpp.BHYT_DONGIA, vpp.BHYT_THANHTIEN, vpp.BHYT_DONGIA_CHITRA        , vp.BHYT_THANHTIEN_CHITRA, vp.BENHNHAN_PHAITHANHTOAN, vp.GIATRI_HOADON, vp.GIATRI_HOADON_DATHANHTOAN, vp.GIATRI_BIENLAI        , vp.GIATRI_BIENLAI_DATHANHTOAN, vp.GIATRI_BENHNHAN_DATHANHTOAN, vp.TYLE_THATTHU, vp.GIATRI_THATTHU, vp.MIENGIAM_TL, vp.MIENGIAM_GIATRI, vp.NGANSACH_TL, vp.NGANSACH_GIATRI        , vp.TAITRO_TL, vp.TAITRO_GIATRI, vp.BHTN_GIATRI, vp.NOIDUNGTHU, vp.CHUNGTUXUATBN_ID, vp.TYLEVAT, vp.GIATRIVAT, vp.MASOTHUE, vp.SOCHUNGTUKETOAN, vp.DAHOANTRA, vp.TRANGTHAI        , vp.PHONGBAN_ID, vp.PHONGBAN_THAYDOI_ID, vp.CONGTYCHITRA_GIATRI, vp.HOIVIEN_GIATRI, vp.BENHVIEN_ID, vp.NGAYTAO, vp.NGUOITAO_ID, vp.NGAYCAPNHAT, vp.NGUOICAPNHAT_ID        , NULL AS NOITHUCHIEN_ID, dk.NOICHIDINH_ID as NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        ,M.TENMAU AS NOIDUNG, M.MAMAU AS MADICHVU, NULL AS NORESULT, DVT.TENDONVITINH AS DONVITINH, LM.MALOAIMAU AS MALOAIDUOC, M.BHYT AS DUOC_BHYT, 'M' AS LOAIVATTU_ID, NM.TENNHOMMAU AS MANHOMDICHVU        from TT_HOADON_CHITIET_NGOAITRU VP        join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        INNER JOIN TT_MAU_CHUNGTU_CHITIET CT ON VP.REF_ID=CT.CHUNGTUCHITIET_ID AND VP.REF_TABLE='TT_MAU_CHUNGTU_CHITIET' AND CT.BENHVIEN_ID='01819'        INNER JOIN TT_MAU_CHUNGTU CTU ON CT.CHUNGTU_ID=CTU.CHUNGTU_ID AND CTU.CHUNGTULIENQUAN_ID IS NULL        INNER join TM_MAU M on CT.MAU_ID = M.MAU_ID        LEFT JOIN TM_MAU_DONVITINH DVT ON M.DONVITINH_ID = DVT.DONVITINH_ID        LEFT JOIN TT_MAU_DANGKYMAU_CHITIET DKCT ON DKCT.CHUNGTU_ID = CTU.CHUNGTU_ID AND DKCT.BENHVIEN_ID='01819'        LEFT JOIN TT_MAU_DANGKYMAU DK ON DK.DANGKYMAU_ID = DKCT.DANGKYMAU_ID        LEFT JOIN TM_MAU_LOAIMAU LM ON LM.LOAIMAU_ID = M.LOAIMAU_ID        LEFT JOIN TM_MAU_NHOMMAU NM ON NM.NHOMMAU_ID = LM.NHOMMAU_ID        where        vp.HOADON_ID = '107822'        ) a]
2020-03-26 14:14:54,734 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_HINHTHUCTHANHTOAN_GetList] PreparedStatement : [select TT_HOADON_HINHTHUCTHANHTOAN.*, htttCode.DICTIONARY_CODE HINHTHUCTHANHTOAN_CODE            from TT_HOADON_HINHTHUCTHANHTOAN TT_HOADON_HINHTHUCTHANHTOAN            left join (select DICTIONARY_ID, DICTIONARY_CODE from LST_DICTIONARY where DICTIONARY_TYPE_CODE like 'HinhThucThanhToan') htttCode on htttCode.DICTIONARY_ID = TT_HOADON_HINHTHUCTHANHTOAN.HINHTHUCTHANHTOAN_ID             where                             TT_HOADON_HINHTHUCTHANHTOAN.HOADON_ID = '107822'                       and                           TT_HOADON_HINHTHUCTHANHTOAN.BENHVIEN_ID = '01819'                                     order by HOADON_HTTT_ID]
2020-03-26 14:14:54,790 [1] DEBUG - Statement Id: [DAO00114_GetThongtin_Congtyrahoadon] PreparedStatement : [select KH_TENCONGTY, KH_DIACHI, KH_MASOTHUE from TT_HOADON        where HOADON_ID = '107822']
2020-03-26 14:14:54,878 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 14:14:54,878 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 14:14:54,878 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2020-03-26 14:14:54,929 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1              and               BLCT.BIENLAICHITIET_ID = '1067'                         order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 14:14:54,929 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 14:14:54,929 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2020-03-26 14:14:58,743 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NGOAITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.TIEPNHAN_ID = a.TIEPNHAN_ID                 where(                           (A.DATHANHTOAN = '1'                         and                           A.TRANGTHAI != 'DADUYETCONGNO'                         )                          and (A.HUYHOADON is null or A.HUYHOADON = '0')                          and (A.HOANTRA is null or A.HOANTRA = '0')                                             )                       and                           A.TIEPNHAN_ID = '107238'                       and                         (bn.TENBENHNHAN like '%' +  @param0  + '%' or bn.MAYTE like '%' +  @param0  + '%')                       and                           convert(date,A.NGAYHOADON) between convert(date, '3/26/2020 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is null or A.BENHAN_ID = 0                                     order by A.NGAYHOADON]
2020-03-26 14:14:58,744 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] Parameters: [@param0=[TENBENHNHAN,200006325]]
2020-03-26 14:14:58,744 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] Types: [@param0=[String, System.String]]
2020-03-26 14:15:03,819 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NGOAITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.TIEPNHAN_ID = a.TIEPNHAN_ID                 where(                           (A.DATHANHTOAN = '1'                         and                           A.TRANGTHAI != 'DADUYETCONGNO'                         )                          and (A.HUYHOADON is null or A.HUYHOADON = '0')                          and (A.HOANTRA is null or A.HOANTRA = '0')                       or                           A.HUYHOADON = '1'                       or                           A.HOANTRA = '1'                       or                           A.DATHANHTOAN = 0                                             )                       and                           A.TIEPNHAN_ID = '107238'                       and                         (bn.TENBENHNHAN like '%' +  @param0  + '%' or bn.MAYTE like '%' +  @param0  + '%')                       and                           convert(date,A.NGAYHOADON) between convert(date, '3/1/2020 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is null or A.BENHAN_ID = 0                                     order by A.NGAYHOADON]
2020-03-26 14:15:03,819 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] Parameters: [@param0=[TENBENHNHAN,200006325]]
2020-03-26 14:15:03,819 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] Types: [@param0=[String, System.String]]
2020-03-26 14:15:05,186 [1] DEBUG - Statement Id: [DAO00119_TT_VIENPHI_GetList_TiepNhanByHoadon] PreparedStatement : [select  a.*, a.MIENGIAM_GIATRI as GIATRIMIENGIAM_BH, a.BHTN_GIATRI as GIATRIMIENGIAM_BHTN, a.HOIVIEN_GIATRI as GIATRIMIENGIAM_THANHVIEN, a.CONGTYCHITRA_GIATRI as GIATRIMIENGIAM_CTCT,        isnull(dv.TENDICHVU, dc.TENDUOCDAYDU) NOIDUNG, isnull(dv.MADICHVU, dc.MADUOC) MADICHVU, dv.NORESULT, dc.DONVITINH, ld.MALOAIDUOC, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ndv.MANHOMDICHVU        from        (select        vp.HOADONCHITIET_ID, vp.HOADON_ID, vp.VIENPHI_ID, vp.REF_ID, vp.REF_TABLE, vp.DICHVU_ID, vp.DUOC_ID        , vp.LOAI_CHIPHI, vp.LOAIGIA_ID, vp.SOLUONG, vp.DONGIA_DOANHTHU, vp.THANHTIEN_DOANHTHU, vp.BHYT_TL, vpp.BHYT_DONGIA, vpp.BHYT_THANHTIEN, vpp.BHYT_DONGIA_CHITRA        , vp.BHYT_THANHTIEN_CHITRA, vp.BENHNHAN_PHAITHANHTOAN, vp.GIATRI_HOADON, vp.GIATRI_HOADON_DATHANHTOAN, vp.GIATRI_BIENLAI        , vp.GIATRI_BIENLAI_DATHANHTOAN, vp.GIATRI_BENHNHAN_DATHANHTOAN, vp.TYLE_THATTHU, vp.GIATRI_THATTHU, vp.MIENGIAM_TL, vp.MIENGIAM_GIATRI, vp.NGANSACH_TL, vp.NGANSACH_GIATRI        , vp.TAITRO_TL, vp.TAITRO_GIATRI, vp.BHTN_GIATRI, vp.NOIDUNGTHU, vp.CHUNGTUXUATBN_ID, vp.TYLEVAT, vp.GIATRIVAT, vp.MASOTHUE, vp.SOCHUNGTUKETOAN, vp.DAHOANTRA, c.TRANGTHAI        , vp.PHONGBAN_ID, vp.PHONGBAN_THAYDOI_ID, vp.CONGTYCHITRA_GIATRI, vp.HOIVIEN_GIATRI, vp.BENHVIEN_ID, isnull(c.NGAYGIOYEUCAU, vp.NGAYTAO) NGAYTAO, vp.NGUOITAO_ID, vp.NGAYCAPNHAT, vp.NGUOICAPNHAT_ID        , c.NOITHUCHIEN_ID, c.NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NGOAITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        left join TT_DVYEUCAU c on c.DVYEUCAU_ID = VP.REF_ID        where        vp.HOADON_ID = '107822'        ) a        left join TM_DUOC dc on a.DUOC_ID = dc.DUOC_ID        left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID        left join TM_DICHVU dv on a.DICHVU_ID = dv.DICHVU_ID and a.REF_TABLE = 'TT_DVYEUCAU'        left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID        WHERE a.REF_TABLE!='TT_MAU_CHUNGTU_CHITIET']
2020-03-26 14:15:05,221 [1] DEBUG - Statement Id: [DAO00330_TT_VIENPHI_GetList_TiepNhanByHoadon] PreparedStatement : [select  a.*, a.MIENGIAM_GIATRI as GIATRIMIENGIAM_BH, a.BHTN_GIATRI as GIATRIMIENGIAM_BHTN, a.HOIVIEN_GIATRI as GIATRIMIENGIAM_THANHVIEN, a.CONGTYCHITRA_GIATRI as GIATRIMIENGIAM_CTCT        from        (select        vp.HOADONCHITIET_ID, vp.HOADON_ID, vp.VIENPHI_ID, vp.REF_ID, vp.REF_TABLE, vp.DICHVU_ID, vp.DUOC_ID        , vp.LOAI_CHIPHI, vp.LOAIGIA_ID, vp.SOLUONG, vp.DONGIA_DOANHTHU, vp.THANHTIEN_DOANHTHU, vp.BHYT_TL, vpp.BHYT_DONGIA, vpp.BHYT_THANHTIEN, vpp.BHYT_DONGIA_CHITRA        , vp.BHYT_THANHTIEN_CHITRA, vp.BENHNHAN_PHAITHANHTOAN, vp.GIATRI_HOADON, vp.GIATRI_HOADON_DATHANHTOAN, vp.GIATRI_BIENLAI        , vp.GIATRI_BIENLAI_DATHANHTOAN, vp.GIATRI_BENHNHAN_DATHANHTOAN, vp.TYLE_THATTHU, vp.GIATRI_THATTHU, vp.MIENGIAM_TL, vp.MIENGIAM_GIATRI, vp.NGANSACH_TL, vp.NGANSACH_GIATRI        , vp.TAITRO_TL, vp.TAITRO_GIATRI, vp.BHTN_GIATRI, vp.NOIDUNGTHU, vp.CHUNGTUXUATBN_ID, vp.TYLEVAT, vp.GIATRIVAT, vp.MASOTHUE, vp.SOCHUNGTUKETOAN, vp.DAHOANTRA, vp.TRANGTHAI        , vp.PHONGBAN_ID, vp.PHONGBAN_THAYDOI_ID, vp.CONGTYCHITRA_GIATRI, vp.HOIVIEN_GIATRI, vp.BENHVIEN_ID, vp.NGAYTAO, vp.NGUOITAO_ID, vp.NGAYCAPNHAT, vp.NGUOICAPNHAT_ID        , NULL AS NOITHUCHIEN_ID, dk.NOICHIDINH_ID as NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        ,M.TENMAU AS NOIDUNG, M.MAMAU AS MADICHVU, NULL AS NORESULT, DVT.TENDONVITINH AS DONVITINH, LM.MALOAIMAU AS MALOAIDUOC, M.BHYT AS DUOC_BHYT, 'M' AS LOAIVATTU_ID, NM.TENNHOMMAU AS MANHOMDICHVU        from TT_HOADON_CHITIET_NGOAITRU VP        join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        INNER JOIN TT_MAU_CHUNGTU_CHITIET CT ON VP.REF_ID=CT.CHUNGTUCHITIET_ID AND VP.REF_TABLE='TT_MAU_CHUNGTU_CHITIET' AND CT.BENHVIEN_ID='01819'        INNER JOIN TT_MAU_CHUNGTU CTU ON CT.CHUNGTU_ID=CTU.CHUNGTU_ID AND CTU.CHUNGTULIENQUAN_ID IS NULL        INNER join TM_MAU M on CT.MAU_ID = M.MAU_ID        LEFT JOIN TM_MAU_DONVITINH DVT ON M.DONVITINH_ID = DVT.DONVITINH_ID        LEFT JOIN TT_MAU_DANGKYMAU_CHITIET DKCT ON DKCT.CHUNGTU_ID = CTU.CHUNGTU_ID AND DKCT.BENHVIEN_ID='01819'        LEFT JOIN TT_MAU_DANGKYMAU DK ON DK.DANGKYMAU_ID = DKCT.DANGKYMAU_ID        LEFT JOIN TM_MAU_LOAIMAU LM ON LM.LOAIMAU_ID = M.LOAIMAU_ID        LEFT JOIN TM_MAU_NHOMMAU NM ON NM.NHOMMAU_ID = LM.NHOMMAU_ID        where        vp.HOADON_ID = '107822'        ) a]
2020-03-26 14:15:05,280 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_HINHTHUCTHANHTOAN_GetList] PreparedStatement : [select TT_HOADON_HINHTHUCTHANHTOAN.*, htttCode.DICTIONARY_CODE HINHTHUCTHANHTOAN_CODE            from TT_HOADON_HINHTHUCTHANHTOAN TT_HOADON_HINHTHUCTHANHTOAN            left join (select DICTIONARY_ID, DICTIONARY_CODE from LST_DICTIONARY where DICTIONARY_TYPE_CODE like 'HinhThucThanhToan') htttCode on htttCode.DICTIONARY_ID = TT_HOADON_HINHTHUCTHANHTOAN.HINHTHUCTHANHTOAN_ID             where                             TT_HOADON_HINHTHUCTHANHTOAN.HOADON_ID = '107822'                       and                           TT_HOADON_HINHTHUCTHANHTOAN.BENHVIEN_ID = '01819'                                     order by HOADON_HTTT_ID]
2020-03-26 14:15:05,325 [1] DEBUG - Statement Id: [DAO00114_GetThongtin_Congtyrahoadon] PreparedStatement : [select KH_TENCONGTY, KH_DIACHI, KH_MASOTHUE from TT_HOADON        where HOADON_ID = '107822']
2020-03-26 14:15:05,410 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 14:15:05,410 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 14:15:05,410 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2020-03-26 14:15:05,445 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 14:15:05,446 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 14:15:05,446 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2020-03-26 14:15:05,482 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1              and               BLCT.BIENLAICHITIET_ID = '1067'                         order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 14:15:05,482 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 14:15:05,482 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2020-03-26 14:15:08,687 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NGOAITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.TIEPNHAN_ID = a.TIEPNHAN_ID                 where(                           (A.DATHANHTOAN = '1'                         and                           A.TRANGTHAI != 'DADUYETCONGNO'                         )                          and (A.HUYHOADON is null or A.HUYHOADON = '0')                          and (A.HOANTRA is null or A.HOANTRA = '0')                                             )                       and                           A.TIEPNHAN_ID = '107238'                       and                         (bn.TENBENHNHAN like '%' +  @param0  + '%' or bn.MAYTE like '%' +  @param0  + '%')                       and                           convert(date,A.NGAYHOADON) between convert(date, '3/26/2020 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is null or A.BENHAN_ID = 0                                     order by A.NGAYHOADON]
2020-03-26 14:15:08,687 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] Parameters: [@param0=[TENBENHNHAN,200006325]]
2020-03-26 14:15:08,687 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] Types: [@param0=[String, System.String]]
2020-03-26 14:15:16,402 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NGOAITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.TIEPNHAN_ID = a.TIEPNHAN_ID                 where(                           (A.DATHANHTOAN = '1'                         and                           A.TRANGTHAI != 'DADUYETCONGNO'                         )                          and (A.HUYHOADON is null or A.HUYHOADON = '0')                          and (A.HOANTRA is null or A.HOANTRA = '0')                       or                           A.HUYHOADON = '1'                       or                           A.HOANTRA = '1'                       or                           A.DATHANHTOAN = 0                                             )                       and                           A.TIEPNHAN_ID = '107238'                       and                           convert(date,A.NGAYHOADON) between convert(date, '3/1/2020 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is null or A.BENHAN_ID = 0                                     order by A.NGAYHOADON]
2020-03-26 14:15:18,908 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NGOAITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.TIEPNHAN_ID = a.TIEPNHAN_ID                 where(                           (A.DATHANHTOAN = '1'                         and                           A.TRANGTHAI != 'DADUYETCONGNO'                         )                          and (A.HUYHOADON is null or A.HUYHOADON = '0')                          and (A.HOANTRA is null or A.HOANTRA = '0')                       or                           A.HUYHOADON = '1'                       or                           A.HOANTRA = '1'                       or                           A.DATHANHTOAN = 0                                             )                       and                           A.TIEPNHAN_ID = '107238'                       and                           convert(date,A.NGAYHOADON) between convert(date, '3/1/2020 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is null or A.BENHAN_ID = 0                                     order by A.NGAYHOADON]
2020-03-26 14:15:22,564 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NGOAITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.TIEPNHAN_ID = a.TIEPNHAN_ID                 where(                           (A.DATHANHTOAN = '1'                         and                           A.TRANGTHAI != 'DADUYETCONGNO'                         )                          and (A.HUYHOADON is null or A.HUYHOADON = '0')                          and (A.HOANTRA is null or A.HOANTRA = '0')                       or                           A.HUYHOADON = '1'                       or                           A.HOANTRA = '1'                       or                           A.DATHANHTOAN = 0                                             )                       and                           A.TIEPNHAN_ID = '107238'                       and                         (bn.TENBENHNHAN like '%' +  @param0  + '%' or bn.MAYTE like '%' +  @param0  + '%')                       and                           convert(date,A.NGAYHOADON) between convert(date, '3/1/2020 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is null or A.BENHAN_ID = 0                                     order by A.NGAYHOADON]
2020-03-26 14:15:22,564 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] Parameters: [@param0=[TENBENHNHAN,xdxg]]
2020-03-26 14:15:22,564 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] Types: [@param0=[String, System.String]]
2020-03-26 14:15:25,714 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NGOAITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.TIEPNHAN_ID = a.TIEPNHAN_ID                 where(                           (A.DATHANHTOAN = '1'                         and                           A.TRANGTHAI != 'DADUYETCONGNO'                         )                          and (A.HUYHOADON is null or A.HUYHOADON = '0')                          and (A.HOANTRA is null or A.HOANTRA = '0')                       or                           A.HUYHOADON = '1'                       or                           A.HOANTRA = '1'                       or                           A.DATHANHTOAN = 0                                             )                       and                           A.TIEPNHAN_ID = '107238'                       and                           convert(date,A.NGAYHOADON) between convert(date, '3/1/2020 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is null or A.BENHAN_ID = 0                                     order by A.NGAYHOADON]
2020-03-26 14:15:26,804 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NGOAITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.TIEPNHAN_ID = a.TIEPNHAN_ID                 where(                           (A.DATHANHTOAN = '1'                         and                           A.TRANGTHAI != 'DADUYETCONGNO'                         )                          and (A.HUYHOADON is null or A.HUYHOADON = '0')                          and (A.HOANTRA is null or A.HOANTRA = '0')                       or                           A.HUYHOADON = '1'                       or                           A.HOANTRA = '1'                       or                           A.DATHANHTOAN = 0                                             )                       and                           A.TIEPNHAN_ID = '107238'                       and                           convert(date,A.NGAYHOADON) between convert(date, '3/1/2020 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is null or A.BENHAN_ID = 0                                     order by A.NGAYHOADON]
2020-03-26 14:15:33,483 [1] DEBUG - Statement Id: [DAO00119_TT_VIENPHI_GetList_TiepNhanPhaiThanhToan] PreparedStatement : [select distinct  a.*, b.GIATRIMIENGIAM_BH, c.GIATRIMIENGIAM_BHTN, f.GIATRIMIENGIAM_THANHVIEN, g.GIATRIMIENGIAM_CTCT,        isnull(dv.TENDICHVU, dc.TENDUOCDAYDU) NOIDUNG, isnull(dv.MADICHVU, dc.MADUOC) MADICHVU, dv.NORESULT, dc.DONVITINH, ld.MALOAIDUOC, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ndv.MANHOMDICHVU        from        (select VP.*, isnull(c.TRANGTHAI, '') TRANGTHAI, c.THUTIENSAU, c.NOITHUCHIEN_ID,        CASE        when REF_TABLE = 'TT_NGOAITRU_TOATHUOC' then ntkb.PHONGBAN_ID        when REF_TABLE = 'TT_CLSKETQUA_VTYT' then clsvtyt.PHONGBAN_ID        when REF_TABLE = 'TT_NGOAITRU_KHAMBENH_VTYT' then kbd.PHONGBAN_ID        ELSE        c.NOIYEUCAU_ID        END NOIYEUCAU_ID,        CASE        when REF_TABLE = 'TT_NGOAITRU_TOATHUOC' then ngtd.KHOXUAT_ID        when REF_TABLE = 'TT_CLSKETQUA_VTYT' then clsvtyt.KHOTAO_ID        when REF_TABLE = 'TT_NGOAITRU_KHAMBENH_VTYT' then kbd.KHOTAO_ID        ELSE null        END KHODUOC_ID          from TT_VIENPHI VP        left join TT_DVYEUCAU c on c.DVYEUCAU_ID = VP.REF_ID  and vp.REF_TABLE = 'TT_DVYEUCAU'        left join TT_NGOAITRU_TOATHUOC nttt on nttt.TOATHUOC_ID = vp.REF_ID and vp.REF_TABLE = 'TT_NGOAITRU_TOATHUOC'        left join TT_NGOAITRU_KHAMBENH_TOATHUOC ngtd on ngtd.KHAMBENH_TOATHUOC_ID = nttt.KHAMBENH_TOATHUOC_ID        left join TT_CLSKETQUA_VTYT clsvtyt on clsvtyt.CLSKETQUA_ID = vp.REF_ID and REF_TABLE = 'TT_CLSKETQUA_VTYT'        left join TT_NGOAITRU_KHAMBENH_VTYT kbd on kbd.KHAMBENH_VTYT_ID = vp.REF_ID and REF_TABLE = 'TT_NGOAITRU_KHAMBENH_VTYT'        left join TT_NGOAITRU_KHAMBENH ntkb on ntkb.KHAMBENH_ID = vp.KHAMBENH_ID and REF_TABLE = 'TT_NGOAITRU_TOATHUOC'          where Vp.TIEPNHAN_ID = '107238' and Vp.ACTIVE = '1' and ((c.HUYYEUCAU != '1' and vp.DICHVU_ID is not null) or (vp.DUOC_ID is not null)) and        ((vp.DATHANHTOAN = '0') or (vp.BENHNHAN_PHAITHANHTOAN > vp.GIATRI_BENHNHAN_DATHANHTOAN and vp.DATHANHTOAN = '1')) and c.DANGKY_CHITIET_ID is null        and vp.REF_TABLE != 'TT_MAU_CHUNGTU_CHITIET'        and vp.REF_TABLE != 'TT_DUOC_CHUNGTU_CHITIET'          AND             VP.KHONGTHUTIEN != '1'                   ) a        left join TM_DUOC dc on a.DUOC_ID = dc.DUOC_ID        left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID        left join TM_DICHVU dv on a.DICHVU_ID = dv.DICHVU_ID and a.REF_TABLE = 'TT_DVYEUCAU'        left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID        left join (select VIENPHI_ID,        sum(MGCT.GIATRIMIENGIAM) AS GIATRIMIENGIAM_BH from TT_MIENGIAM MG        INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_ID = MGCT.MIENGIAM_ID        where MG.TIEPNHAN_ID= '107238' and MGCT.REF_TABLE = 'TT_MIENGIAM' and MG.TINHTRANG = 1 group by VIENPHI_ID        ) b on a.VIENPHI_ID = b.VIENPHI_ID          left join (select VIENPHI_ID, sum(MGCT.GIATRIMIENGIAM) AS GIATRIMIENGIAM_BHTN        from TT_MIENGIAM_BHTN MG        INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_BHTN_ID = MGCT.MIENGIAM_ID        where  MG.TIEPNHAN_ID= '107238' and MGCT.REF_TABLE = 'TT_MIENGIAM_BHTN' and MG.TINHTRANG = 1 group by VIENPHI_ID        )c on a.VIENPHI_ID = c.VIENPHI_ID          left join (select VIENPHI_ID, sum(MGCT.GIATRIMIENGIAM) AS GIATRIMIENGIAM_THANHVIEN        from TT_MIENGIAM_THANHVIEN MG        INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_THANHVIEN_ID = MGCT.MIENGIAM_ID        where MG.TIEPNHAN_ID= '107238' and MGCT.REF_TABLE = 'TT_MIENGIAM_THANHVIEN' and MG.TINHTRANG = 1 group by VIENPHI_ID        )f on a.VIENPHI_ID = f.VIENPHI_ID          left join(select VIENPHI_ID, sum(MGCT.GIATRIMIENGIAM) AS GIATRIMIENGIAM_CTCT        from TT_MIENGIAM_CONGTY MG        INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_CONGTY_ID = MGCT.MIENGIAM_ID        where MG.TIEPNHAN_ID= '107238' and MGCT.REF_TABLE = 'TT_MIENGIAM_CONGTY' and MG.TINHTRANG = 1 group by VIENPHI_ID        )g on a.VIENPHI_ID = g.VIENPHI_ID]
2020-03-26 14:15:33,822 [1] DEBUG - Statement Id: [DAO00330_TT_VIENPHI_GetList_TiepNhanPhaiThanhToan] PreparedStatement : [select distinct  a.*, b.GIATRIMIENGIAM_BH, c.GIATRIMIENGIAM_BHTN, f.GIATRIMIENGIAM_THANHVIEN, g.GIATRIMIENGIAM_CTCT        from        (select VP.*,NULL AS NOITHUCHIEN_ID, DK.NOICHIDINH_ID as NOIYEUCAU_ID, NULL AS THUTIENSAU, isnull(DK.TRANGTHAI, '') TRANGTHAI,        M.TENMAU AS NOIDUNG, M.MAMAU AS MADICHVU, NULL AS NORESULT, DVT.TENDONVITINH AS DONVITINH, LM.MALOAIMAU AS MALOAIDUOC, M.BHYT AS DUOC_BHYT, 'M' AS LOAIVATTU_ID, NM.TENNHOMMAU AS MANHOMDICHVU        from TT_VIENPHI VP        INNER JOIN TT_MAU_CHUNGTU_CHITIET CT ON VP.REF_ID=CT.CHUNGTUCHITIET_ID AND VP.REF_TABLE='TT_MAU_CHUNGTU_CHITIET' AND CT.BENHVIEN_ID='01819'        INNER JOIN TT_MAU_CHUNGTU CTU ON CT.CHUNGTU_ID=CTU.CHUNGTU_ID AND CTU.CHUNGTULIENQUAN_ID IS NULL        INNER join TM_MAU M on CT.MAU_ID = M.MAU_ID        LEFT JOIN TM_MAU_DONVITINH DVT ON M.DONVITINH_ID = DVT.DONVITINH_ID        LEFT JOIN TT_MAU_DANGKYMAU_CHITIET DKCT ON DKCT.CHUNGTU_ID = CTU.CHUNGTU_ID AND DKCT.BENHVIEN_ID='01819'        LEFT JOIN TT_MAU_DANGKYMAU DK ON DK.DANGKYMAU_ID = DKCT.DANGKYMAU_ID        LEFT JOIN TM_MAU_LOAIMAU LM ON LM.LOAIMAU_ID = M.LOAIMAU_ID        LEFT JOIN TM_MAU_NHOMMAU NM ON NM.NHOMMAU_ID = LM.NHOMMAU_ID        where Vp.TIEPNHAN_ID = '107238' and Vp.ACTIVE = '1' and vp.DUOC_ID is not null and        ((vp.DATHANHTOAN = '0') or (vp.BENHNHAN_PHAITHANHTOAN > vp.GIATRI_BENHNHAN_DATHANHTOAN and vp.DATHANHTOAN = '1'))   AND             VP.KHONGTHUTIEN != '1'                   ) a        left join (select VIENPHI_ID,        sum(MGCT.GIATRIMIENGIAM) AS GIATRIMIENGIAM_BH from TT_MIENGIAM MG        INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_ID = MGCT.MIENGIAM_ID        where MG.TIEPNHAN_ID= '107238' and MGCT.REF_TABLE = 'TT_MIENGIAM' and MG.TINHTRANG = 1 group by VIENPHI_ID        ) b on a.VIENPHI_ID = b.VIENPHI_ID          left join (select VIENPHI_ID, sum(MGCT.GIATRIMIENGIAM) AS GIATRIMIENGIAM_BHTN        from TT_MIENGIAM_BHTN MG        INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_BHTN_ID = MGCT.MIENGIAM_ID        where  MG.TIEPNHAN_ID= '107238' and MGCT.REF_TABLE = 'TT_MIENGIAM_BHTN' and MG.TINHTRANG = 1 group by VIENPHI_ID        )c on a.VIENPHI_ID = c.VIENPHI_ID          left join (select VIENPHI_ID, sum(MGCT.GIATRIMIENGIAM) AS GIATRIMIENGIAM_THANHVIEN        from TT_MIENGIAM_THANHVIEN MG        INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_THANHVIEN_ID = MGCT.MIENGIAM_ID        where MG.TIEPNHAN_ID= '107238' and MGCT.REF_TABLE = 'TT_MIENGIAM_THANHVIEN' and MG.TINHTRANG = 1 group by VIENPHI_ID        )f on a.VIENPHI_ID = f.VIENPHI_ID          left join(select VIENPHI_ID, sum(MGCT.GIATRIMIENGIAM) AS GIATRIMIENGIAM_CTCT        from TT_MIENGIAM_CONGTY MG        INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_CONGTY_ID = MGCT.MIENGIAM_ID        where MG.TIEPNHAN_ID= '107238' and MGCT.REF_TABLE = 'TT_MIENGIAM_CONGTY' and MG.TINHTRANG = 1 group by VIENPHI_ID        )g on a.VIENPHI_ID = g.VIENPHI_ID]
2020-03-26 14:15:34,268 [1] DEBUG - Statement Id: [DAO00119_GetDanhsachHTTT] PreparedStatement : [select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE = 'HinhThucThanhToan' and ENABLED = '1' and BENHVIEN_ID = '01819']
2020-03-26 14:15:34,320 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 14:15:34,320 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 14:15:34,320 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2020-03-26 14:15:34,366 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 14:15:34,366 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 14:15:34,366 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2020-03-26 14:15:34,406 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1              and               BLCT.BIENLAICHITIET_ID = '1067'                         order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 14:15:34,406 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 14:15:34,406 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2020-03-26 14:15:34,623 [1] DEBUG - Statement Id: [DAO00119_GetDanhsachHTTT] PreparedStatement : [select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE = 'HinhThucThanhToan' and ENABLED = '1' and BENHVIEN_ID = '01819']
2020-03-26 14:15:42,682 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NGOAITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.TIEPNHAN_ID = a.TIEPNHAN_ID                 where(                             A.HOANTRA = '1'                                             )                       and                           convert(date,A.NGAYHOADON) between convert(date, '3/1/2020 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is null or A.BENHAN_ID = 0                                     order by A.NGAYHOADON]
2020-03-26 14:15:45,888 [1] DEBUG - Statement Id: [DAO00019_ThongTinBenhNhanTiepNhan] PreparedStatement : [select distinct A.SOTIEPNHAN, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        B.*, A.SOBHYT        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'        where                    A.TIEPNHAN_ID = '108045'                 and A.BENHVIEN_ID = '01819']
2020-03-26 14:15:46,006 [1] DEBUG - Statement Id: [DAO00119_TT_VIENPHI_GetList_TiepNhanByHoadon] PreparedStatement : [select  a.*, a.MIENGIAM_GIATRI as GIATRIMIENGIAM_BH, a.BHTN_GIATRI as GIATRIMIENGIAM_BHTN, a.HOIVIEN_GIATRI as GIATRIMIENGIAM_THANHVIEN, a.CONGTYCHITRA_GIATRI as GIATRIMIENGIAM_CTCT,        isnull(dv.TENDICHVU, dc.TENDUOCDAYDU) NOIDUNG, isnull(dv.MADICHVU, dc.MADUOC) MADICHVU, dv.NORESULT, dc.DONVITINH, ld.MALOAIDUOC, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ndv.MANHOMDICHVU        from        (select        vp.HOADONCHITIET_ID, vp.HOADON_ID, vp.VIENPHI_ID, vp.REF_ID, vp.REF_TABLE, vp.DICHVU_ID, vp.DUOC_ID        , vp.LOAI_CHIPHI, vp.LOAIGIA_ID, vp.SOLUONG, vp.DONGIA_DOANHTHU, vp.THANHTIEN_DOANHTHU, vp.BHYT_TL, vpp.BHYT_DONGIA, vpp.BHYT_THANHTIEN, vpp.BHYT_DONGIA_CHITRA        , vp.BHYT_THANHTIEN_CHITRA, vp.BENHNHAN_PHAITHANHTOAN, vp.GIATRI_HOADON, vp.GIATRI_HOADON_DATHANHTOAN, vp.GIATRI_BIENLAI        , vp.GIATRI_BIENLAI_DATHANHTOAN, vp.GIATRI_BENHNHAN_DATHANHTOAN, vp.TYLE_THATTHU, vp.GIATRI_THATTHU, vp.MIENGIAM_TL, vp.MIENGIAM_GIATRI, vp.NGANSACH_TL, vp.NGANSACH_GIATRI        , vp.TAITRO_TL, vp.TAITRO_GIATRI, vp.BHTN_GIATRI, vp.NOIDUNGTHU, vp.CHUNGTUXUATBN_ID, vp.TYLEVAT, vp.GIATRIVAT, vp.MASOTHUE, vp.SOCHUNGTUKETOAN, vp.DAHOANTRA, c.TRANGTHAI        , vp.PHONGBAN_ID, vp.PHONGBAN_THAYDOI_ID, vp.CONGTYCHITRA_GIATRI, vp.HOIVIEN_GIATRI, vp.BENHVIEN_ID, isnull(c.NGAYGIOYEUCAU, vp.NGAYTAO) NGAYTAO, vp.NGUOITAO_ID, vp.NGAYCAPNHAT, vp.NGUOICAPNHAT_ID        , c.NOITHUCHIEN_ID, c.NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NGOAITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        left join TT_DVYEUCAU c on c.DVYEUCAU_ID = VP.REF_ID        where        vp.HOADON_ID = '108721'        ) a        left join TM_DUOC dc on a.DUOC_ID = dc.DUOC_ID        left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID        left join TM_DICHVU dv on a.DICHVU_ID = dv.DICHVU_ID and a.REF_TABLE = 'TT_DVYEUCAU'        left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID        WHERE a.REF_TABLE!='TT_MAU_CHUNGTU_CHITIET']
2020-03-26 14:15:46,079 [1] DEBUG - Statement Id: [DAO00330_TT_VIENPHI_GetList_TiepNhanByHoadon] PreparedStatement : [select  a.*, a.MIENGIAM_GIATRI as GIATRIMIENGIAM_BH, a.BHTN_GIATRI as GIATRIMIENGIAM_BHTN, a.HOIVIEN_GIATRI as GIATRIMIENGIAM_THANHVIEN, a.CONGTYCHITRA_GIATRI as GIATRIMIENGIAM_CTCT        from        (select        vp.HOADONCHITIET_ID, vp.HOADON_ID, vp.VIENPHI_ID, vp.REF_ID, vp.REF_TABLE, vp.DICHVU_ID, vp.DUOC_ID        , vp.LOAI_CHIPHI, vp.LOAIGIA_ID, vp.SOLUONG, vp.DONGIA_DOANHTHU, vp.THANHTIEN_DOANHTHU, vp.BHYT_TL, vpp.BHYT_DONGIA, vpp.BHYT_THANHTIEN, vpp.BHYT_DONGIA_CHITRA        , vp.BHYT_THANHTIEN_CHITRA, vp.BENHNHAN_PHAITHANHTOAN, vp.GIATRI_HOADON, vp.GIATRI_HOADON_DATHANHTOAN, vp.GIATRI_BIENLAI        , vp.GIATRI_BIENLAI_DATHANHTOAN, vp.GIATRI_BENHNHAN_DATHANHTOAN, vp.TYLE_THATTHU, vp.GIATRI_THATTHU, vp.MIENGIAM_TL, vp.MIENGIAM_GIATRI, vp.NGANSACH_TL, vp.NGANSACH_GIATRI        , vp.TAITRO_TL, vp.TAITRO_GIATRI, vp.BHTN_GIATRI, vp.NOIDUNGTHU, vp.CHUNGTUXUATBN_ID, vp.TYLEVAT, vp.GIATRIVAT, vp.MASOTHUE, vp.SOCHUNGTUKETOAN, vp.DAHOANTRA, vp.TRANGTHAI        , vp.PHONGBAN_ID, vp.PHONGBAN_THAYDOI_ID, vp.CONGTYCHITRA_GIATRI, vp.HOIVIEN_GIATRI, vp.BENHVIEN_ID, vp.NGAYTAO, vp.NGUOITAO_ID, vp.NGAYCAPNHAT, vp.NGUOICAPNHAT_ID        , NULL AS NOITHUCHIEN_ID, dk.NOICHIDINH_ID as NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        ,M.TENMAU AS NOIDUNG, M.MAMAU AS MADICHVU, NULL AS NORESULT, DVT.TENDONVITINH AS DONVITINH, LM.MALOAIMAU AS MALOAIDUOC, M.BHYT AS DUOC_BHYT, 'M' AS LOAIVATTU_ID, NM.TENNHOMMAU AS MANHOMDICHVU        from TT_HOADON_CHITIET_NGOAITRU VP        join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        INNER JOIN TT_MAU_CHUNGTU_CHITIET CT ON VP.REF_ID=CT.CHUNGTUCHITIET_ID AND VP.REF_TABLE='TT_MAU_CHUNGTU_CHITIET' AND CT.BENHVIEN_ID='01819'        INNER JOIN TT_MAU_CHUNGTU CTU ON CT.CHUNGTU_ID=CTU.CHUNGTU_ID AND CTU.CHUNGTULIENQUAN_ID IS NULL        INNER join TM_MAU M on CT.MAU_ID = M.MAU_ID        LEFT JOIN TM_MAU_DONVITINH DVT ON M.DONVITINH_ID = DVT.DONVITINH_ID        LEFT JOIN TT_MAU_DANGKYMAU_CHITIET DKCT ON DKCT.CHUNGTU_ID = CTU.CHUNGTU_ID AND DKCT.BENHVIEN_ID='01819'        LEFT JOIN TT_MAU_DANGKYMAU DK ON DK.DANGKYMAU_ID = DKCT.DANGKYMAU_ID        LEFT JOIN TM_MAU_LOAIMAU LM ON LM.LOAIMAU_ID = M.LOAIMAU_ID        LEFT JOIN TM_MAU_NHOMMAU NM ON NM.NHOMMAU_ID = LM.NHOMMAU_ID        where        vp.HOADON_ID = '108721'        ) a]
2020-03-26 14:15:46,167 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_HINHTHUCTHANHTOAN_GetList] PreparedStatement : [select TT_HOADON_HINHTHUCTHANHTOAN.*, htttCode.DICTIONARY_CODE HINHTHUCTHANHTOAN_CODE            from TT_HOADON_HINHTHUCTHANHTOAN TT_HOADON_HINHTHUCTHANHTOAN            left join (select DICTIONARY_ID, DICTIONARY_CODE from LST_DICTIONARY where DICTIONARY_TYPE_CODE like 'HinhThucThanhToan') htttCode on htttCode.DICTIONARY_ID = TT_HOADON_HINHTHUCTHANHTOAN.HINHTHUCTHANHTOAN_ID             where                             TT_HOADON_HINHTHUCTHANHTOAN.HOADON_ID = '108721'                       and                           TT_HOADON_HINHTHUCTHANHTOAN.BENHVIEN_ID = '01819'                                     order by HOADON_HTTT_ID]
2020-03-26 14:15:46,224 [1] DEBUG - Statement Id: [DAO00114_GetThongtin_Congtyrahoadon] PreparedStatement : [select KH_TENCONGTY, KH_DIACHI, KH_MASOTHUE from TT_HOADON        where HOADON_ID = '108721']
2020-03-26 14:15:46,307 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 14:15:46,307 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 14:15:46,307 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2020-03-26 14:15:46,350 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 14:15:46,350 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 14:15:46,350 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2020-03-26 14:15:46,392 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1              and               BLCT.BIENLAICHITIET_ID = '1067'                         order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 14:15:46,392 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 14:15:46,392 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2020-03-26 14:15:49,878 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NGOAITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.TIEPNHAN_ID = a.TIEPNHAN_ID                 where(                           (A.DATHANHTOAN = '1'                         and                           A.TRANGTHAI != 'DADUYETCONGNO'                         )                          and (A.HUYHOADON is null or A.HUYHOADON = '0')                          and (A.HOANTRA is null or A.HOANTRA = '0')                                             )                       and                           A.TIEPNHAN_ID = '108045'                       and                         (bn.TENBENHNHAN like '%' +  @param0  + '%' or bn.MAYTE like '%' +  @param0  + '%')                       and                           convert(date,A.NGAYHOADON) between convert(date, '3/26/2020 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is null or A.BENHAN_ID = 0                                     order by A.NGAYHOADON]
2020-03-26 14:15:49,878 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] Parameters: [@param0=[TENBENHNHAN,200006678]]
2020-03-26 14:15:49,879 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] Types: [@param0=[String, System.String]]
2020-03-26 14:15:54,770 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NGOAITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.TIEPNHAN_ID = a.TIEPNHAN_ID                 where(                           (A.DATHANHTOAN = '1'                         and                           A.TRANGTHAI != 'DADUYETCONGNO'                         )                          and (A.HUYHOADON is null or A.HUYHOADON = '0')                          and (A.HOANTRA is null or A.HOANTRA = '0')                       or                           A.HUYHOADON = '1'                       or                           A.HOANTRA = '1'                       or                           A.DATHANHTOAN = 0                                             )                       and                           A.TIEPNHAN_ID = '108045'                       and                         (bn.TENBENHNHAN like '%' +  @param0  + '%' or bn.MAYTE like '%' +  @param0  + '%')                       and                           convert(date,A.NGAYHOADON) between convert(date, '3/1/2020 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is null or A.BENHAN_ID = 0                                     order by A.NGAYHOADON]
2020-03-26 14:15:54,770 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] Parameters: [@param0=[TENBENHNHAN,200006678]]
2020-03-26 14:15:54,770 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] Types: [@param0=[String, System.String]]
2020-03-26 14:15:57,919 [1] DEBUG - Statement Id: [DAO00119_TT_VIENPHI_GetList_TiepNhanByHoadon] PreparedStatement : [select  a.*, a.MIENGIAM_GIATRI as GIATRIMIENGIAM_BH, a.BHTN_GIATRI as GIATRIMIENGIAM_BHTN, a.HOIVIEN_GIATRI as GIATRIMIENGIAM_THANHVIEN, a.CONGTYCHITRA_GIATRI as GIATRIMIENGIAM_CTCT,        isnull(dv.TENDICHVU, dc.TENDUOCDAYDU) NOIDUNG, isnull(dv.MADICHVU, dc.MADUOC) MADICHVU, dv.NORESULT, dc.DONVITINH, ld.MALOAIDUOC, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ndv.MANHOMDICHVU        from        (select        vp.HOADONCHITIET_ID, vp.HOADON_ID, vp.VIENPHI_ID, vp.REF_ID, vp.REF_TABLE, vp.DICHVU_ID, vp.DUOC_ID        , vp.LOAI_CHIPHI, vp.LOAIGIA_ID, vp.SOLUONG, vp.DONGIA_DOANHTHU, vp.THANHTIEN_DOANHTHU, vp.BHYT_TL, vpp.BHYT_DONGIA, vpp.BHYT_THANHTIEN, vpp.BHYT_DONGIA_CHITRA        , vp.BHYT_THANHTIEN_CHITRA, vp.BENHNHAN_PHAITHANHTOAN, vp.GIATRI_HOADON, vp.GIATRI_HOADON_DATHANHTOAN, vp.GIATRI_BIENLAI        , vp.GIATRI_BIENLAI_DATHANHTOAN, vp.GIATRI_BENHNHAN_DATHANHTOAN, vp.TYLE_THATTHU, vp.GIATRI_THATTHU, vp.MIENGIAM_TL, vp.MIENGIAM_GIATRI, vp.NGANSACH_TL, vp.NGANSACH_GIATRI        , vp.TAITRO_TL, vp.TAITRO_GIATRI, vp.BHTN_GIATRI, vp.NOIDUNGTHU, vp.CHUNGTUXUATBN_ID, vp.TYLEVAT, vp.GIATRIVAT, vp.MASOTHUE, vp.SOCHUNGTUKETOAN, vp.DAHOANTRA, c.TRANGTHAI        , vp.PHONGBAN_ID, vp.PHONGBAN_THAYDOI_ID, vp.CONGTYCHITRA_GIATRI, vp.HOIVIEN_GIATRI, vp.BENHVIEN_ID, isnull(c.NGAYGIOYEUCAU, vp.NGAYTAO) NGAYTAO, vp.NGUOITAO_ID, vp.NGAYCAPNHAT, vp.NGUOICAPNHAT_ID        , c.NOITHUCHIEN_ID, c.NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NGOAITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        left join TT_DVYEUCAU c on c.DVYEUCAU_ID = VP.REF_ID        where        vp.HOADON_ID = '108721'        ) a        left join TM_DUOC dc on a.DUOC_ID = dc.DUOC_ID        left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID        left join TM_DICHVU dv on a.DICHVU_ID = dv.DICHVU_ID and a.REF_TABLE = 'TT_DVYEUCAU'        left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID        WHERE a.REF_TABLE!='TT_MAU_CHUNGTU_CHITIET']
2020-03-26 14:15:57,958 [1] DEBUG - Statement Id: [DAO00330_TT_VIENPHI_GetList_TiepNhanByHoadon] PreparedStatement : [select  a.*, a.MIENGIAM_GIATRI as GIATRIMIENGIAM_BH, a.BHTN_GIATRI as GIATRIMIENGIAM_BHTN, a.HOIVIEN_GIATRI as GIATRIMIENGIAM_THANHVIEN, a.CONGTYCHITRA_GIATRI as GIATRIMIENGIAM_CTCT        from        (select        vp.HOADONCHITIET_ID, vp.HOADON_ID, vp.VIENPHI_ID, vp.REF_ID, vp.REF_TABLE, vp.DICHVU_ID, vp.DUOC_ID        , vp.LOAI_CHIPHI, vp.LOAIGIA_ID, vp.SOLUONG, vp.DONGIA_DOANHTHU, vp.THANHTIEN_DOANHTHU, vp.BHYT_TL, vpp.BHYT_DONGIA, vpp.BHYT_THANHTIEN, vpp.BHYT_DONGIA_CHITRA        , vp.BHYT_THANHTIEN_CHITRA, vp.BENHNHAN_PHAITHANHTOAN, vp.GIATRI_HOADON, vp.GIATRI_HOADON_DATHANHTOAN, vp.GIATRI_BIENLAI        , vp.GIATRI_BIENLAI_DATHANHTOAN, vp.GIATRI_BENHNHAN_DATHANHTOAN, vp.TYLE_THATTHU, vp.GIATRI_THATTHU, vp.MIENGIAM_TL, vp.MIENGIAM_GIATRI, vp.NGANSACH_TL, vp.NGANSACH_GIATRI        , vp.TAITRO_TL, vp.TAITRO_GIATRI, vp.BHTN_GIATRI, vp.NOIDUNGTHU, vp.CHUNGTUXUATBN_ID, vp.TYLEVAT, vp.GIATRIVAT, vp.MASOTHUE, vp.SOCHUNGTUKETOAN, vp.DAHOANTRA, vp.TRANGTHAI        , vp.PHONGBAN_ID, vp.PHONGBAN_THAYDOI_ID, vp.CONGTYCHITRA_GIATRI, vp.HOIVIEN_GIATRI, vp.BENHVIEN_ID, vp.NGAYTAO, vp.NGUOITAO_ID, vp.NGAYCAPNHAT, vp.NGUOICAPNHAT_ID        , NULL AS NOITHUCHIEN_ID, dk.NOICHIDINH_ID as NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        ,M.TENMAU AS NOIDUNG, M.MAMAU AS MADICHVU, NULL AS NORESULT, DVT.TENDONVITINH AS DONVITINH, LM.MALOAIMAU AS MALOAIDUOC, M.BHYT AS DUOC_BHYT, 'M' AS LOAIVATTU_ID, NM.TENNHOMMAU AS MANHOMDICHVU        from TT_HOADON_CHITIET_NGOAITRU VP        join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        INNER JOIN TT_MAU_CHUNGTU_CHITIET CT ON VP.REF_ID=CT.CHUNGTUCHITIET_ID AND VP.REF_TABLE='TT_MAU_CHUNGTU_CHITIET' AND CT.BENHVIEN_ID='01819'        INNER JOIN TT_MAU_CHUNGTU CTU ON CT.CHUNGTU_ID=CTU.CHUNGTU_ID AND CTU.CHUNGTULIENQUAN_ID IS NULL        INNER join TM_MAU M on CT.MAU_ID = M.MAU_ID        LEFT JOIN TM_MAU_DONVITINH DVT ON M.DONVITINH_ID = DVT.DONVITINH_ID        LEFT JOIN TT_MAU_DANGKYMAU_CHITIET DKCT ON DKCT.CHUNGTU_ID = CTU.CHUNGTU_ID AND DKCT.BENHVIEN_ID='01819'        LEFT JOIN TT_MAU_DANGKYMAU DK ON DK.DANGKYMAU_ID = DKCT.DANGKYMAU_ID        LEFT JOIN TM_MAU_LOAIMAU LM ON LM.LOAIMAU_ID = M.LOAIMAU_ID        LEFT JOIN TM_MAU_NHOMMAU NM ON NM.NHOMMAU_ID = LM.NHOMMAU_ID        where        vp.HOADON_ID = '108721'        ) a]
2020-03-26 14:15:58,012 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_HINHTHUCTHANHTOAN_GetList] PreparedStatement : [select TT_HOADON_HINHTHUCTHANHTOAN.*, htttCode.DICTIONARY_CODE HINHTHUCTHANHTOAN_CODE            from TT_HOADON_HINHTHUCTHANHTOAN TT_HOADON_HINHTHUCTHANHTOAN            left join (select DICTIONARY_ID, DICTIONARY_CODE from LST_DICTIONARY where DICTIONARY_TYPE_CODE like 'HinhThucThanhToan') htttCode on htttCode.DICTIONARY_ID = TT_HOADON_HINHTHUCTHANHTOAN.HINHTHUCTHANHTOAN_ID             where                             TT_HOADON_HINHTHUCTHANHTOAN.HOADON_ID = '108721'                       and                           TT_HOADON_HINHTHUCTHANHTOAN.BENHVIEN_ID = '01819'                                     order by HOADON_HTTT_ID]
2020-03-26 14:15:58,055 [1] DEBUG - Statement Id: [DAO00114_GetThongtin_Congtyrahoadon] PreparedStatement : [select KH_TENCONGTY, KH_DIACHI, KH_MASOTHUE from TT_HOADON        where HOADON_ID = '108721']
2020-03-26 14:15:58,143 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 14:15:58,143 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 14:15:58,143 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2020-03-26 14:15:58,180 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 14:15:58,180 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 14:15:58,180 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2020-03-26 14:15:58,216 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1              and               BLCT.BIENLAICHITIET_ID = '1067'                         order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 14:15:58,216 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 14:15:58,216 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2020-03-26 14:16:00,595 [1] DEBUG - Statement Id: [DAO00119_TT_VIENPHI_GetList_TiepNhanPhaiThanhToan] PreparedStatement : [select distinct  a.*, b.GIATRIMIENGIAM_BH, c.GIATRIMIENGIAM_BHTN, f.GIATRIMIENGIAM_THANHVIEN, g.GIATRIMIENGIAM_CTCT,        isnull(dv.TENDICHVU, dc.TENDUOCDAYDU) NOIDUNG, isnull(dv.MADICHVU, dc.MADUOC) MADICHVU, dv.NORESULT, dc.DONVITINH, ld.MALOAIDUOC, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ndv.MANHOMDICHVU        from        (select VP.*, isnull(c.TRANGTHAI, '') TRANGTHAI, c.THUTIENSAU, c.NOITHUCHIEN_ID,        CASE        when REF_TABLE = 'TT_NGOAITRU_TOATHUOC' then ntkb.PHONGBAN_ID        when REF_TABLE = 'TT_CLSKETQUA_VTYT' then clsvtyt.PHONGBAN_ID        when REF_TABLE = 'TT_NGOAITRU_KHAMBENH_VTYT' then kbd.PHONGBAN_ID        ELSE        c.NOIYEUCAU_ID        END NOIYEUCAU_ID,        CASE        when REF_TABLE = 'TT_NGOAITRU_TOATHUOC' then ngtd.KHOXUAT_ID        when REF_TABLE = 'TT_CLSKETQUA_VTYT' then clsvtyt.KHOTAO_ID        when REF_TABLE = 'TT_NGOAITRU_KHAMBENH_VTYT' then kbd.KHOTAO_ID        ELSE null        END KHODUOC_ID          from TT_VIENPHI VP        left join TT_DVYEUCAU c on c.DVYEUCAU_ID = VP.REF_ID  and vp.REF_TABLE = 'TT_DVYEUCAU'        left join TT_NGOAITRU_TOATHUOC nttt on nttt.TOATHUOC_ID = vp.REF_ID and vp.REF_TABLE = 'TT_NGOAITRU_TOATHUOC'        left join TT_NGOAITRU_KHAMBENH_TOATHUOC ngtd on ngtd.KHAMBENH_TOATHUOC_ID = nttt.KHAMBENH_TOATHUOC_ID        left join TT_CLSKETQUA_VTYT clsvtyt on clsvtyt.CLSKETQUA_ID = vp.REF_ID and REF_TABLE = 'TT_CLSKETQUA_VTYT'        left join TT_NGOAITRU_KHAMBENH_VTYT kbd on kbd.KHAMBENH_VTYT_ID = vp.REF_ID and REF_TABLE = 'TT_NGOAITRU_KHAMBENH_VTYT'        left join TT_NGOAITRU_KHAMBENH ntkb on ntkb.KHAMBENH_ID = vp.KHAMBENH_ID and REF_TABLE = 'TT_NGOAITRU_TOATHUOC'          where Vp.TIEPNHAN_ID = '108045' and Vp.ACTIVE = '1' and ((c.HUYYEUCAU != '1' and vp.DICHVU_ID is not null) or (vp.DUOC_ID is not null)) and        ((vp.DATHANHTOAN = '0') or (vp.BENHNHAN_PHAITHANHTOAN > vp.GIATRI_BENHNHAN_DATHANHTOAN and vp.DATHANHTOAN = '1')) and c.DANGKY_CHITIET_ID is null        and vp.REF_TABLE != 'TT_MAU_CHUNGTU_CHITIET'        and vp.REF_TABLE != 'TT_DUOC_CHUNGTU_CHITIET'          AND             VP.KHONGTHUTIEN != '1'                   ) a        left join TM_DUOC dc on a.DUOC_ID = dc.DUOC_ID        left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID        left join TM_DICHVU dv on a.DICHVU_ID = dv.DICHVU_ID and a.REF_TABLE = 'TT_DVYEUCAU'        left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID        left join (select VIENPHI_ID,        sum(MGCT.GIATRIMIENGIAM) AS GIATRIMIENGIAM_BH from TT_MIENGIAM MG        INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_ID = MGCT.MIENGIAM_ID        where MG.TIEPNHAN_ID= '108045' and MGCT.REF_TABLE = 'TT_MIENGIAM' and MG.TINHTRANG = 1 group by VIENPHI_ID        ) b on a.VIENPHI_ID = b.VIENPHI_ID          left join (select VIENPHI_ID, sum(MGCT.GIATRIMIENGIAM) AS GIATRIMIENGIAM_BHTN        from TT_MIENGIAM_BHTN MG        INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_BHTN_ID = MGCT.MIENGIAM_ID        where  MG.TIEPNHAN_ID= '108045' and MGCT.REF_TABLE = 'TT_MIENGIAM_BHTN' and MG.TINHTRANG = 1 group by VIENPHI_ID        )c on a.VIENPHI_ID = c.VIENPHI_ID          left join (select VIENPHI_ID, sum(MGCT.GIATRIMIENGIAM) AS GIATRIMIENGIAM_THANHVIEN        from TT_MIENGIAM_THANHVIEN MG        INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_THANHVIEN_ID = MGCT.MIENGIAM_ID        where MG.TIEPNHAN_ID= '108045' and MGCT.REF_TABLE = 'TT_MIENGIAM_THANHVIEN' and MG.TINHTRANG = 1 group by VIENPHI_ID        )f on a.VIENPHI_ID = f.VIENPHI_ID          left join(select VIENPHI_ID, sum(MGCT.GIATRIMIENGIAM) AS GIATRIMIENGIAM_CTCT        from TT_MIENGIAM_CONGTY MG        INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_CONGTY_ID = MGCT.MIENGIAM_ID        where MG.TIEPNHAN_ID= '108045' and MGCT.REF_TABLE = 'TT_MIENGIAM_CONGTY' and MG.TINHTRANG = 1 group by VIENPHI_ID        )g on a.VIENPHI_ID = g.VIENPHI_ID]
2020-03-26 14:16:00,927 [1] DEBUG - Statement Id: [DAO00330_TT_VIENPHI_GetList_TiepNhanPhaiThanhToan] PreparedStatement : [select distinct  a.*, b.GIATRIMIENGIAM_BH, c.GIATRIMIENGIAM_BHTN, f.GIATRIMIENGIAM_THANHVIEN, g.GIATRIMIENGIAM_CTCT        from        (select VP.*,NULL AS NOITHUCHIEN_ID, DK.NOICHIDINH_ID as NOIYEUCAU_ID, NULL AS THUTIENSAU, isnull(DK.TRANGTHAI, '') TRANGTHAI,        M.TENMAU AS NOIDUNG, M.MAMAU AS MADICHVU, NULL AS NORESULT, DVT.TENDONVITINH AS DONVITINH, LM.MALOAIMAU AS MALOAIDUOC, M.BHYT AS DUOC_BHYT, 'M' AS LOAIVATTU_ID, NM.TENNHOMMAU AS MANHOMDICHVU        from TT_VIENPHI VP        INNER JOIN TT_MAU_CHUNGTU_CHITIET CT ON VP.REF_ID=CT.CHUNGTUCHITIET_ID AND VP.REF_TABLE='TT_MAU_CHUNGTU_CHITIET' AND CT.BENHVIEN_ID='01819'        INNER JOIN TT_MAU_CHUNGTU CTU ON CT.CHUNGTU_ID=CTU.CHUNGTU_ID AND CTU.CHUNGTULIENQUAN_ID IS NULL        INNER join TM_MAU M on CT.MAU_ID = M.MAU_ID        LEFT JOIN TM_MAU_DONVITINH DVT ON M.DONVITINH_ID = DVT.DONVITINH_ID        LEFT JOIN TT_MAU_DANGKYMAU_CHITIET DKCT ON DKCT.CHUNGTU_ID = CTU.CHUNGTU_ID AND DKCT.BENHVIEN_ID='01819'        LEFT JOIN TT_MAU_DANGKYMAU DK ON DK.DANGKYMAU_ID = DKCT.DANGKYMAU_ID        LEFT JOIN TM_MAU_LOAIMAU LM ON LM.LOAIMAU_ID = M.LOAIMAU_ID        LEFT JOIN TM_MAU_NHOMMAU NM ON NM.NHOMMAU_ID = LM.NHOMMAU_ID        where Vp.TIEPNHAN_ID = '108045' and Vp.ACTIVE = '1' and vp.DUOC_ID is not null and        ((vp.DATHANHTOAN = '0') or (vp.BENHNHAN_PHAITHANHTOAN > vp.GIATRI_BENHNHAN_DATHANHTOAN and vp.DATHANHTOAN = '1'))   AND             VP.KHONGTHUTIEN != '1'                   ) a        left join (select VIENPHI_ID,        sum(MGCT.GIATRIMIENGIAM) AS GIATRIMIENGIAM_BH from TT_MIENGIAM MG        INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_ID = MGCT.MIENGIAM_ID        where MG.TIEPNHAN_ID= '108045' and MGCT.REF_TABLE = 'TT_MIENGIAM' and MG.TINHTRANG = 1 group by VIENPHI_ID        ) b on a.VIENPHI_ID = b.VIENPHI_ID          left join (select VIENPHI_ID, sum(MGCT.GIATRIMIENGIAM) AS GIATRIMIENGIAM_BHTN        from TT_MIENGIAM_BHTN MG        INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_BHTN_ID = MGCT.MIENGIAM_ID        where  MG.TIEPNHAN_ID= '108045' and MGCT.REF_TABLE = 'TT_MIENGIAM_BHTN' and MG.TINHTRANG = 1 group by VIENPHI_ID        )c on a.VIENPHI_ID = c.VIENPHI_ID          left join (select VIENPHI_ID, sum(MGCT.GIATRIMIENGIAM) AS GIATRIMIENGIAM_THANHVIEN        from TT_MIENGIAM_THANHVIEN MG        INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_THANHVIEN_ID = MGCT.MIENGIAM_ID        where MG.TIEPNHAN_ID= '108045' and MGCT.REF_TABLE = 'TT_MIENGIAM_THANHVIEN' and MG.TINHTRANG = 1 group by VIENPHI_ID        )f on a.VIENPHI_ID = f.VIENPHI_ID          left join(select VIENPHI_ID, sum(MGCT.GIATRIMIENGIAM) AS GIATRIMIENGIAM_CTCT        from TT_MIENGIAM_CONGTY MG        INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_CONGTY_ID = MGCT.MIENGIAM_ID        where MG.TIEPNHAN_ID= '108045' and MGCT.REF_TABLE = 'TT_MIENGIAM_CONGTY' and MG.TINHTRANG = 1 group by VIENPHI_ID        )g on a.VIENPHI_ID = g.VIENPHI_ID]
2020-03-26 14:16:01,963 [1] DEBUG - Statement Id: [DAO00119_GetDataTamUng_HoaUng] PreparedStatement : [select SUM(TAMUNG) AS TONGTIEN_TU, SUM(HOANUNG) AS TONGTIEN_HU, TIEPNHAN_ID        from (        select HD.TIEPNHAN_ID,        CASE WHEN LOAIHOADON = 'TU' then HD.GIATRIHOADON ELSE 0 END TAMUNG,        CASE WHEN LOAIHOADON = 'HU' then HD.GIATRIHOADON ELSE 0 END HOANUNG        from TT_HOADON HD        where HD.DATHANHTOAN = '1' and HD.HUYHOADON = '0' and HD.HOANTRA = '0'        and HD.TIEPNHAN_ID = 108045        and HD.BENHVIEN_ID = '01819'        ) temp        group by temp.TIEPNHAN_ID]
2020-03-26 14:16:02,009 [1] DEBUG - Statement Id: [DAO00119_GetDanhsachHTTT] PreparedStatement : [select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE = 'HinhThucThanhToan' and ENABLED = '1' and BENHVIEN_ID = '01819']
2020-03-26 14:16:02,066 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 14:16:02,066 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 14:16:02,066 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2020-03-26 14:16:02,108 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 14:16:02,108 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 14:16:02,108 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2020-03-26 14:16:02,151 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1              and               BLCT.BIENLAICHITIET_ID = '1067'                         order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 14:16:02,152 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 14:16:02,152 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2020-03-26 14:16:02,373 [1] DEBUG - Statement Id: [DAO00119_GetDanhsachHTTT] PreparedStatement : [select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE = 'HinhThucThanhToan' and ENABLED = '1' and BENHVIEN_ID = '01819']
2020-03-26 14:16:08,658 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NGOAITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.TIEPNHAN_ID = a.TIEPNHAN_ID                 where(                           (A.DATHANHTOAN = '1'                         and                           A.TRANGTHAI != 'DADUYETCONGNO'                         )                          and (A.HUYHOADON is null or A.HUYHOADON = '0')                          and (A.HOANTRA is null or A.HOANTRA = '0')                       or                           A.HUYHOADON = '1'                       or                           A.HOANTRA = '1'                       or                           A.DATHANHTOAN = 0                                             )                       and                           convert(date,A.NGAYHOADON) between convert(date, '3/1/2020 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is null or A.BENHAN_ID = 0                                     order by A.NGAYHOADON]
2020-03-26 14:16:42,620 [1] DEBUG - Statement Id: [DAO00019_ThongTinBenhNhanTiepNhan] PreparedStatement : [select distinct A.SOTIEPNHAN, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        B.*, A.SOBHYT        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'        where                    A.TIEPNHAN_ID = '108545'                 and A.BENHVIEN_ID = '01819']
2020-03-26 14:16:42,746 [1] DEBUG - Statement Id: [DAO00119_TT_VIENPHI_GetList_TiepNhanByHoadon] PreparedStatement : [select  a.*, a.MIENGIAM_GIATRI as GIATRIMIENGIAM_BH, a.BHTN_GIATRI as GIATRIMIENGIAM_BHTN, a.HOIVIEN_GIATRI as GIATRIMIENGIAM_THANHVIEN, a.CONGTYCHITRA_GIATRI as GIATRIMIENGIAM_CTCT,        isnull(dv.TENDICHVU, dc.TENDUOCDAYDU) NOIDUNG, isnull(dv.MADICHVU, dc.MADUOC) MADICHVU, dv.NORESULT, dc.DONVITINH, ld.MALOAIDUOC, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ndv.MANHOMDICHVU        from        (select        vp.HOADONCHITIET_ID, vp.HOADON_ID, vp.VIENPHI_ID, vp.REF_ID, vp.REF_TABLE, vp.DICHVU_ID, vp.DUOC_ID        , vp.LOAI_CHIPHI, vp.LOAIGIA_ID, vp.SOLUONG, vp.DONGIA_DOANHTHU, vp.THANHTIEN_DOANHTHU, vp.BHYT_TL, vpp.BHYT_DONGIA, vpp.BHYT_THANHTIEN, vpp.BHYT_DONGIA_CHITRA        , vp.BHYT_THANHTIEN_CHITRA, vp.BENHNHAN_PHAITHANHTOAN, vp.GIATRI_HOADON, vp.GIATRI_HOADON_DATHANHTOAN, vp.GIATRI_BIENLAI        , vp.GIATRI_BIENLAI_DATHANHTOAN, vp.GIATRI_BENHNHAN_DATHANHTOAN, vp.TYLE_THATTHU, vp.GIATRI_THATTHU, vp.MIENGIAM_TL, vp.MIENGIAM_GIATRI, vp.NGANSACH_TL, vp.NGANSACH_GIATRI        , vp.TAITRO_TL, vp.TAITRO_GIATRI, vp.BHTN_GIATRI, vp.NOIDUNGTHU, vp.CHUNGTUXUATBN_ID, vp.TYLEVAT, vp.GIATRIVAT, vp.MASOTHUE, vp.SOCHUNGTUKETOAN, vp.DAHOANTRA, c.TRANGTHAI        , vp.PHONGBAN_ID, vp.PHONGBAN_THAYDOI_ID, vp.CONGTYCHITRA_GIATRI, vp.HOIVIEN_GIATRI, vp.BENHVIEN_ID, isnull(c.NGAYGIOYEUCAU, vp.NGAYTAO) NGAYTAO, vp.NGUOITAO_ID, vp.NGAYCAPNHAT, vp.NGUOICAPNHAT_ID        , c.NOITHUCHIEN_ID, c.NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NGOAITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        left join TT_DVYEUCAU c on c.DVYEUCAU_ID = VP.REF_ID        where        vp.HOADON_ID = '109288'        ) a        left join TM_DUOC dc on a.DUOC_ID = dc.DUOC_ID        left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID        left join TM_DICHVU dv on a.DICHVU_ID = dv.DICHVU_ID and a.REF_TABLE = 'TT_DVYEUCAU'        left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID        WHERE a.REF_TABLE!='TT_MAU_CHUNGTU_CHITIET']
2020-03-26 14:16:42,815 [1] DEBUG - Statement Id: [DAO00330_TT_VIENPHI_GetList_TiepNhanByHoadon] PreparedStatement : [select  a.*, a.MIENGIAM_GIATRI as GIATRIMIENGIAM_BH, a.BHTN_GIATRI as GIATRIMIENGIAM_BHTN, a.HOIVIEN_GIATRI as GIATRIMIENGIAM_THANHVIEN, a.CONGTYCHITRA_GIATRI as GIATRIMIENGIAM_CTCT        from        (select        vp.HOADONCHITIET_ID, vp.HOADON_ID, vp.VIENPHI_ID, vp.REF_ID, vp.REF_TABLE, vp.DICHVU_ID, vp.DUOC_ID        , vp.LOAI_CHIPHI, vp.LOAIGIA_ID, vp.SOLUONG, vp.DONGIA_DOANHTHU, vp.THANHTIEN_DOANHTHU, vp.BHYT_TL, vpp.BHYT_DONGIA, vpp.BHYT_THANHTIEN, vpp.BHYT_DONGIA_CHITRA        , vp.BHYT_THANHTIEN_CHITRA, vp.BENHNHAN_PHAITHANHTOAN, vp.GIATRI_HOADON, vp.GIATRI_HOADON_DATHANHTOAN, vp.GIATRI_BIENLAI        , vp.GIATRI_BIENLAI_DATHANHTOAN, vp.GIATRI_BENHNHAN_DATHANHTOAN, vp.TYLE_THATTHU, vp.GIATRI_THATTHU, vp.MIENGIAM_TL, vp.MIENGIAM_GIATRI, vp.NGANSACH_TL, vp.NGANSACH_GIATRI        , vp.TAITRO_TL, vp.TAITRO_GIATRI, vp.BHTN_GIATRI, vp.NOIDUNGTHU, vp.CHUNGTUXUATBN_ID, vp.TYLEVAT, vp.GIATRIVAT, vp.MASOTHUE, vp.SOCHUNGTUKETOAN, vp.DAHOANTRA, vp.TRANGTHAI        , vp.PHONGBAN_ID, vp.PHONGBAN_THAYDOI_ID, vp.CONGTYCHITRA_GIATRI, vp.HOIVIEN_GIATRI, vp.BENHVIEN_ID, vp.NGAYTAO, vp.NGUOITAO_ID, vp.NGAYCAPNHAT, vp.NGUOICAPNHAT_ID        , NULL AS NOITHUCHIEN_ID, dk.NOICHIDINH_ID as NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        ,M.TENMAU AS NOIDUNG, M.MAMAU AS MADICHVU, NULL AS NORESULT, DVT.TENDONVITINH AS DONVITINH, LM.MALOAIMAU AS MALOAIDUOC, M.BHYT AS DUOC_BHYT, 'M' AS LOAIVATTU_ID, NM.TENNHOMMAU AS MANHOMDICHVU        from TT_HOADON_CHITIET_NGOAITRU VP        join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        INNER JOIN TT_MAU_CHUNGTU_CHITIET CT ON VP.REF_ID=CT.CHUNGTUCHITIET_ID AND VP.REF_TABLE='TT_MAU_CHUNGTU_CHITIET' AND CT.BENHVIEN_ID='01819'        INNER JOIN TT_MAU_CHUNGTU CTU ON CT.CHUNGTU_ID=CTU.CHUNGTU_ID AND CTU.CHUNGTULIENQUAN_ID IS NULL        INNER join TM_MAU M on CT.MAU_ID = M.MAU_ID        LEFT JOIN TM_MAU_DONVITINH DVT ON M.DONVITINH_ID = DVT.DONVITINH_ID        LEFT JOIN TT_MAU_DANGKYMAU_CHITIET DKCT ON DKCT.CHUNGTU_ID = CTU.CHUNGTU_ID AND DKCT.BENHVIEN_ID='01819'        LEFT JOIN TT_MAU_DANGKYMAU DK ON DK.DANGKYMAU_ID = DKCT.DANGKYMAU_ID        LEFT JOIN TM_MAU_LOAIMAU LM ON LM.LOAIMAU_ID = M.LOAIMAU_ID        LEFT JOIN TM_MAU_NHOMMAU NM ON NM.NHOMMAU_ID = LM.NHOMMAU_ID        where        vp.HOADON_ID = '109288'        ) a]
2020-03-26 14:16:42,948 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_HINHTHUCTHANHTOAN_GetList] PreparedStatement : [select TT_HOADON_HINHTHUCTHANHTOAN.*, htttCode.DICTIONARY_CODE HINHTHUCTHANHTOAN_CODE            from TT_HOADON_HINHTHUCTHANHTOAN TT_HOADON_HINHTHUCTHANHTOAN            left join (select DICTIONARY_ID, DICTIONARY_CODE from LST_DICTIONARY where DICTIONARY_TYPE_CODE like 'HinhThucThanhToan') htttCode on htttCode.DICTIONARY_ID = TT_HOADON_HINHTHUCTHANHTOAN.HINHTHUCTHANHTOAN_ID             where                             TT_HOADON_HINHTHUCTHANHTOAN.HOADON_ID = '109288'                       and                           TT_HOADON_HINHTHUCTHANHTOAN.BENHVIEN_ID = '01819'                                     order by HOADON_HTTT_ID]
2020-03-26 14:16:43,000 [1] DEBUG - Statement Id: [DAO00114_GetThongtin_Congtyrahoadon] PreparedStatement : [select KH_TENCONGTY, KH_DIACHI, KH_MASOTHUE from TT_HOADON        where HOADON_ID = '109288']
2020-03-26 14:16:43,095 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 14:16:43,095 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 14:16:43,095 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2020-03-26 14:16:43,132 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 14:16:43,132 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 14:16:43,132 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2020-03-26 14:16:43,173 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1              and               BLCT.BIENLAICHITIET_ID = '1067'                         order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 14:16:43,173 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 14:16:43,173 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2020-03-26 14:16:46,445 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NGOAITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.TIEPNHAN_ID = a.TIEPNHAN_ID                 where(                           (A.DATHANHTOAN = '1'                         and                           A.TRANGTHAI != 'DADUYETCONGNO'                         )                          and (A.HUYHOADON is null or A.HUYHOADON = '0')                          and (A.HOANTRA is null or A.HOANTRA = '0')                                             )                       and                           A.TIEPNHAN_ID = '108545'                       and                         (bn.TENBENHNHAN like '%' +  @param0  + '%' or bn.MAYTE like '%' +  @param0  + '%')                       and                           convert(date,A.NGAYHOADON) between convert(date, '3/26/2020 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is null or A.BENHAN_ID = 0                                     order by A.NGAYHOADON]
2020-03-26 14:16:46,446 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] Parameters: [@param0=[TENBENHNHAN,200006904]]
2020-03-26 14:16:46,446 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] Types: [@param0=[String, System.String]]
2020-03-26 14:16:51,428 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NGOAITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.TIEPNHAN_ID = a.TIEPNHAN_ID                 where(                           (A.DATHANHTOAN = '1'                         and                           A.TRANGTHAI != 'DADUYETCONGNO'                         )                          and (A.HUYHOADON is null or A.HUYHOADON = '0')                          and (A.HOANTRA is null or A.HOANTRA = '0')                       or                           A.HUYHOADON = '1'                       or                           A.HOANTRA = '1'                       or                           A.DATHANHTOAN = 0                                             )                       and                           A.TIEPNHAN_ID = '108545'                       and                         (bn.TENBENHNHAN like '%' +  @param0  + '%' or bn.MAYTE like '%' +  @param0  + '%')                       and                           convert(date,A.NGAYHOADON) between convert(date, '3/1/2020 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is null or A.BENHAN_ID = 0                                     order by A.NGAYHOADON]
2020-03-26 14:16:51,428 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] Parameters: [@param0=[TENBENHNHAN,200006904]]
2020-03-26 14:16:51,428 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] Types: [@param0=[String, System.String]]
2020-03-26 14:16:56,573 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NGOAITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.TIEPNHAN_ID = a.TIEPNHAN_ID                 where(                             A.HUYHOADON = '1'                                             )                       and                           A.TIEPNHAN_ID = '108545'                       and                           convert(date,A.NGAYHOADON) between convert(date, '3/1/2020 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is null or A.BENHAN_ID = 0                                     order by A.NGAYHOADON]
2020-03-26 14:17:00,506 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NGOAITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.TIEPNHAN_ID = a.TIEPNHAN_ID                 where(                             A.HUYHOADON = '1'                                             )                       and                           A.TIEPNHAN_ID = '108545'                       and                           convert(date,A.NGAYHOADON) between convert(date, '3/1/2020 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is null or A.BENHAN_ID = 0                                     order by A.NGAYHOADON]
2020-03-26 14:17:05,071 [1] DEBUG - Statement Id: [DAO00119_TT_VIENPHI_GetList_TiepNhanPhaiThanhToan] PreparedStatement : [select distinct  a.*, b.GIATRIMIENGIAM_BH, c.GIATRIMIENGIAM_BHTN, f.GIATRIMIENGIAM_THANHVIEN, g.GIATRIMIENGIAM_CTCT,        isnull(dv.TENDICHVU, dc.TENDUOCDAYDU) NOIDUNG, isnull(dv.MADICHVU, dc.MADUOC) MADICHVU, dv.NORESULT, dc.DONVITINH, ld.MALOAIDUOC, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ndv.MANHOMDICHVU        from        (select VP.*, isnull(c.TRANGTHAI, '') TRANGTHAI, c.THUTIENSAU, c.NOITHUCHIEN_ID,        CASE        when REF_TABLE = 'TT_NGOAITRU_TOATHUOC' then ntkb.PHONGBAN_ID        when REF_TABLE = 'TT_CLSKETQUA_VTYT' then clsvtyt.PHONGBAN_ID        when REF_TABLE = 'TT_NGOAITRU_KHAMBENH_VTYT' then kbd.PHONGBAN_ID        ELSE        c.NOIYEUCAU_ID        END NOIYEUCAU_ID,        CASE        when REF_TABLE = 'TT_NGOAITRU_TOATHUOC' then ngtd.KHOXUAT_ID        when REF_TABLE = 'TT_CLSKETQUA_VTYT' then clsvtyt.KHOTAO_ID        when REF_TABLE = 'TT_NGOAITRU_KHAMBENH_VTYT' then kbd.KHOTAO_ID        ELSE null        END KHODUOC_ID          from TT_VIENPHI VP        left join TT_DVYEUCAU c on c.DVYEUCAU_ID = VP.REF_ID  and vp.REF_TABLE = 'TT_DVYEUCAU'        left join TT_NGOAITRU_TOATHUOC nttt on nttt.TOATHUOC_ID = vp.REF_ID and vp.REF_TABLE = 'TT_NGOAITRU_TOATHUOC'        left join TT_NGOAITRU_KHAMBENH_TOATHUOC ngtd on ngtd.KHAMBENH_TOATHUOC_ID = nttt.KHAMBENH_TOATHUOC_ID        left join TT_CLSKETQUA_VTYT clsvtyt on clsvtyt.CLSKETQUA_ID = vp.REF_ID and REF_TABLE = 'TT_CLSKETQUA_VTYT'        left join TT_NGOAITRU_KHAMBENH_VTYT kbd on kbd.KHAMBENH_VTYT_ID = vp.REF_ID and REF_TABLE = 'TT_NGOAITRU_KHAMBENH_VTYT'        left join TT_NGOAITRU_KHAMBENH ntkb on ntkb.KHAMBENH_ID = vp.KHAMBENH_ID and REF_TABLE = 'TT_NGOAITRU_TOATHUOC'          where Vp.TIEPNHAN_ID = '108545' and Vp.ACTIVE = '1' and ((c.HUYYEUCAU != '1' and vp.DICHVU_ID is not null) or (vp.DUOC_ID is not null)) and        ((vp.DATHANHTOAN = '0') or (vp.BENHNHAN_PHAITHANHTOAN > vp.GIATRI_BENHNHAN_DATHANHTOAN and vp.DATHANHTOAN = '1')) and c.DANGKY_CHITIET_ID is null        and vp.REF_TABLE != 'TT_MAU_CHUNGTU_CHITIET'        and vp.REF_TABLE != 'TT_DUOC_CHUNGTU_CHITIET'          AND             VP.KHONGTHUTIEN != '1'                   ) a        left join TM_DUOC dc on a.DUOC_ID = dc.DUOC_ID        left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID        left join TM_DICHVU dv on a.DICHVU_ID = dv.DICHVU_ID and a.REF_TABLE = 'TT_DVYEUCAU'        left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID        left join (select VIENPHI_ID,        sum(MGCT.GIATRIMIENGIAM) AS GIATRIMIENGIAM_BH from TT_MIENGIAM MG        INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_ID = MGCT.MIENGIAM_ID        where MG.TIEPNHAN_ID= '108545' and MGCT.REF_TABLE = 'TT_MIENGIAM' and MG.TINHTRANG = 1 group by VIENPHI_ID        ) b on a.VIENPHI_ID = b.VIENPHI_ID          left join (select VIENPHI_ID, sum(MGCT.GIATRIMIENGIAM) AS GIATRIMIENGIAM_BHTN        from TT_MIENGIAM_BHTN MG        INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_BHTN_ID = MGCT.MIENGIAM_ID        where  MG.TIEPNHAN_ID= '108545' and MGCT.REF_TABLE = 'TT_MIENGIAM_BHTN' and MG.TINHTRANG = 1 group by VIENPHI_ID        )c on a.VIENPHI_ID = c.VIENPHI_ID          left join (select VIENPHI_ID, sum(MGCT.GIATRIMIENGIAM) AS GIATRIMIENGIAM_THANHVIEN        from TT_MIENGIAM_THANHVIEN MG        INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_THANHVIEN_ID = MGCT.MIENGIAM_ID        where MG.TIEPNHAN_ID= '108545' and MGCT.REF_TABLE = 'TT_MIENGIAM_THANHVIEN' and MG.TINHTRANG = 1 group by VIENPHI_ID        )f on a.VIENPHI_ID = f.VIENPHI_ID          left join(select VIENPHI_ID, sum(MGCT.GIATRIMIENGIAM) AS GIATRIMIENGIAM_CTCT        from TT_MIENGIAM_CONGTY MG        INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_CONGTY_ID = MGCT.MIENGIAM_ID        where MG.TIEPNHAN_ID= '108545' and MGCT.REF_TABLE = 'TT_MIENGIAM_CONGTY' and MG.TINHTRANG = 1 group by VIENPHI_ID        )g on a.VIENPHI_ID = g.VIENPHI_ID]
2020-03-26 14:17:05,335 [1] DEBUG - Statement Id: [DAO00330_TT_VIENPHI_GetList_TiepNhanPhaiThanhToan] PreparedStatement : [select distinct  a.*, b.GIATRIMIENGIAM_BH, c.GIATRIMIENGIAM_BHTN, f.GIATRIMIENGIAM_THANHVIEN, g.GIATRIMIENGIAM_CTCT        from        (select VP.*,NULL AS NOITHUCHIEN_ID, DK.NOICHIDINH_ID as NOIYEUCAU_ID, NULL AS THUTIENSAU, isnull(DK.TRANGTHAI, '') TRANGTHAI,        M.TENMAU AS NOIDUNG, M.MAMAU AS MADICHVU, NULL AS NORESULT, DVT.TENDONVITINH AS DONVITINH, LM.MALOAIMAU AS MALOAIDUOC, M.BHYT AS DUOC_BHYT, 'M' AS LOAIVATTU_ID, NM.TENNHOMMAU AS MANHOMDICHVU        from TT_VIENPHI VP        INNER JOIN TT_MAU_CHUNGTU_CHITIET CT ON VP.REF_ID=CT.CHUNGTUCHITIET_ID AND VP.REF_TABLE='TT_MAU_CHUNGTU_CHITIET' AND CT.BENHVIEN_ID='01819'        INNER JOIN TT_MAU_CHUNGTU CTU ON CT.CHUNGTU_ID=CTU.CHUNGTU_ID AND CTU.CHUNGTULIENQUAN_ID IS NULL        INNER join TM_MAU M on CT.MAU_ID = M.MAU_ID        LEFT JOIN TM_MAU_DONVITINH DVT ON M.DONVITINH_ID = DVT.DONVITINH_ID        LEFT JOIN TT_MAU_DANGKYMAU_CHITIET DKCT ON DKCT.CHUNGTU_ID = CTU.CHUNGTU_ID AND DKCT.BENHVIEN_ID='01819'        LEFT JOIN TT_MAU_DANGKYMAU DK ON DK.DANGKYMAU_ID = DKCT.DANGKYMAU_ID        LEFT JOIN TM_MAU_LOAIMAU LM ON LM.LOAIMAU_ID = M.LOAIMAU_ID        LEFT JOIN TM_MAU_NHOMMAU NM ON NM.NHOMMAU_ID = LM.NHOMMAU_ID        where Vp.TIEPNHAN_ID = '108545' and Vp.ACTIVE = '1' and vp.DUOC_ID is not null and        ((vp.DATHANHTOAN = '0') or (vp.BENHNHAN_PHAITHANHTOAN > vp.GIATRI_BENHNHAN_DATHANHTOAN and vp.DATHANHTOAN = '1'))   AND             VP.KHONGTHUTIEN != '1'                   ) a        left join (select VIENPHI_ID,        sum(MGCT.GIATRIMIENGIAM) AS GIATRIMIENGIAM_BH from TT_MIENGIAM MG        INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_ID = MGCT.MIENGIAM_ID        where MG.TIEPNHAN_ID= '108545' and MGCT.REF_TABLE = 'TT_MIENGIAM' and MG.TINHTRANG = 1 group by VIENPHI_ID        ) b on a.VIENPHI_ID = b.VIENPHI_ID          left join (select VIENPHI_ID, sum(MGCT.GIATRIMIENGIAM) AS GIATRIMIENGIAM_BHTN        from TT_MIENGIAM_BHTN MG        INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_BHTN_ID = MGCT.MIENGIAM_ID        where  MG.TIEPNHAN_ID= '108545' and MGCT.REF_TABLE = 'TT_MIENGIAM_BHTN' and MG.TINHTRANG = 1 group by VIENPHI_ID        )c on a.VIENPHI_ID = c.VIENPHI_ID          left join (select VIENPHI_ID, sum(MGCT.GIATRIMIENGIAM) AS GIATRIMIENGIAM_THANHVIEN        from TT_MIENGIAM_THANHVIEN MG        INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_THANHVIEN_ID = MGCT.MIENGIAM_ID        where MG.TIEPNHAN_ID= '108545' and MGCT.REF_TABLE = 'TT_MIENGIAM_THANHVIEN' and MG.TINHTRANG = 1 group by VIENPHI_ID        )f on a.VIENPHI_ID = f.VIENPHI_ID          left join(select VIENPHI_ID, sum(MGCT.GIATRIMIENGIAM) AS GIATRIMIENGIAM_CTCT        from TT_MIENGIAM_CONGTY MG        INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_CONGTY_ID = MGCT.MIENGIAM_ID        where MG.TIEPNHAN_ID= '108545' and MGCT.REF_TABLE = 'TT_MIENGIAM_CONGTY' and MG.TINHTRANG = 1 group by VIENPHI_ID        )g on a.VIENPHI_ID = g.VIENPHI_ID]
2020-03-26 14:17:05,596 [1] DEBUG - Statement Id: [DAO00119_GetDanhsachHTTT] PreparedStatement : [select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE = 'HinhThucThanhToan' and ENABLED = '1' and BENHVIEN_ID = '01819']
2020-03-26 14:17:05,647 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 14:17:05,647 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 14:17:05,647 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2020-03-26 14:17:05,685 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 14:17:05,685 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 14:17:05,685 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2020-03-26 14:17:05,737 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1              and               BLCT.BIENLAICHITIET_ID = '1067'                         order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 14:17:05,737 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 14:17:05,737 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2020-03-26 14:17:05,916 [1] DEBUG - Statement Id: [DAO00119_GetDanhsachHTTT] PreparedStatement : [select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE = 'HinhThucThanhToan' and ENABLED = '1' and BENHVIEN_ID = '01819']
2020-03-26 14:17:11,514 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NGOAITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.TIEPNHAN_ID = a.TIEPNHAN_ID                 where(                             A.HUYHOADON = '1'                                             )                       and                           convert(date,A.NGAYHOADON) between convert(date, '3/8/2020 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is null or A.BENHAN_ID = 0                                     order by A.NGAYHOADON]
2020-03-26 14:17:14,517 [1] DEBUG - Statement Id: [DAO00019_ThongTinBenhNhanTiepNhan] PreparedStatement : [select distinct A.SOTIEPNHAN, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        B.*, A.SOBHYT        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'        where                    A.TIEPNHAN_ID = '107238'                 and A.BENHVIEN_ID = '01819']
2020-03-26 14:17:14,623 [1] DEBUG - Statement Id: [DAO00119_TT_VIENPHI_GetList_TiepNhanByHoadon] PreparedStatement : [select  a.*, a.MIENGIAM_GIATRI as GIATRIMIENGIAM_BH, a.BHTN_GIATRI as GIATRIMIENGIAM_BHTN, a.HOIVIEN_GIATRI as GIATRIMIENGIAM_THANHVIEN, a.CONGTYCHITRA_GIATRI as GIATRIMIENGIAM_CTCT,        isnull(dv.TENDICHVU, dc.TENDUOCDAYDU) NOIDUNG, isnull(dv.MADICHVU, dc.MADUOC) MADICHVU, dv.NORESULT, dc.DONVITINH, ld.MALOAIDUOC, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ndv.MANHOMDICHVU        from        (select        vp.HOADONCHITIET_ID, vp.HOADON_ID, vp.VIENPHI_ID, vp.REF_ID, vp.REF_TABLE, vp.DICHVU_ID, vp.DUOC_ID        , vp.LOAI_CHIPHI, vp.LOAIGIA_ID, vp.SOLUONG, vp.DONGIA_DOANHTHU, vp.THANHTIEN_DOANHTHU, vp.BHYT_TL, vpp.BHYT_DONGIA, vpp.BHYT_THANHTIEN, vpp.BHYT_DONGIA_CHITRA        , vp.BHYT_THANHTIEN_CHITRA, vp.BENHNHAN_PHAITHANHTOAN, vp.GIATRI_HOADON, vp.GIATRI_HOADON_DATHANHTOAN, vp.GIATRI_BIENLAI        , vp.GIATRI_BIENLAI_DATHANHTOAN, vp.GIATRI_BENHNHAN_DATHANHTOAN, vp.TYLE_THATTHU, vp.GIATRI_THATTHU, vp.MIENGIAM_TL, vp.MIENGIAM_GIATRI, vp.NGANSACH_TL, vp.NGANSACH_GIATRI        , vp.TAITRO_TL, vp.TAITRO_GIATRI, vp.BHTN_GIATRI, vp.NOIDUNGTHU, vp.CHUNGTUXUATBN_ID, vp.TYLEVAT, vp.GIATRIVAT, vp.MASOTHUE, vp.SOCHUNGTUKETOAN, vp.DAHOANTRA, c.TRANGTHAI        , vp.PHONGBAN_ID, vp.PHONGBAN_THAYDOI_ID, vp.CONGTYCHITRA_GIATRI, vp.HOIVIEN_GIATRI, vp.BENHVIEN_ID, isnull(c.NGAYGIOYEUCAU, vp.NGAYTAO) NGAYTAO, vp.NGUOITAO_ID, vp.NGAYCAPNHAT, vp.NGUOICAPNHAT_ID        , c.NOITHUCHIEN_ID, c.NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NGOAITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        left join TT_DVYEUCAU c on c.DVYEUCAU_ID = VP.REF_ID        where        vp.HOADON_ID = '107822'        ) a        left join TM_DUOC dc on a.DUOC_ID = dc.DUOC_ID        left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID        left join TM_DICHVU dv on a.DICHVU_ID = dv.DICHVU_ID and a.REF_TABLE = 'TT_DVYEUCAU'        left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID        WHERE a.REF_TABLE!='TT_MAU_CHUNGTU_CHITIET']
2020-03-26 14:17:14,660 [1] DEBUG - Statement Id: [DAO00330_TT_VIENPHI_GetList_TiepNhanByHoadon] PreparedStatement : [select  a.*, a.MIENGIAM_GIATRI as GIATRIMIENGIAM_BH, a.BHTN_GIATRI as GIATRIMIENGIAM_BHTN, a.HOIVIEN_GIATRI as GIATRIMIENGIAM_THANHVIEN, a.CONGTYCHITRA_GIATRI as GIATRIMIENGIAM_CTCT        from        (select        vp.HOADONCHITIET_ID, vp.HOADON_ID, vp.VIENPHI_ID, vp.REF_ID, vp.REF_TABLE, vp.DICHVU_ID, vp.DUOC_ID        , vp.LOAI_CHIPHI, vp.LOAIGIA_ID, vp.SOLUONG, vp.DONGIA_DOANHTHU, vp.THANHTIEN_DOANHTHU, vp.BHYT_TL, vpp.BHYT_DONGIA, vpp.BHYT_THANHTIEN, vpp.BHYT_DONGIA_CHITRA        , vp.BHYT_THANHTIEN_CHITRA, vp.BENHNHAN_PHAITHANHTOAN, vp.GIATRI_HOADON, vp.GIATRI_HOADON_DATHANHTOAN, vp.GIATRI_BIENLAI        , vp.GIATRI_BIENLAI_DATHANHTOAN, vp.GIATRI_BENHNHAN_DATHANHTOAN, vp.TYLE_THATTHU, vp.GIATRI_THATTHU, vp.MIENGIAM_TL, vp.MIENGIAM_GIATRI, vp.NGANSACH_TL, vp.NGANSACH_GIATRI        , vp.TAITRO_TL, vp.TAITRO_GIATRI, vp.BHTN_GIATRI, vp.NOIDUNGTHU, vp.CHUNGTUXUATBN_ID, vp.TYLEVAT, vp.GIATRIVAT, vp.MASOTHUE, vp.SOCHUNGTUKETOAN, vp.DAHOANTRA, vp.TRANGTHAI        , vp.PHONGBAN_ID, vp.PHONGBAN_THAYDOI_ID, vp.CONGTYCHITRA_GIATRI, vp.HOIVIEN_GIATRI, vp.BENHVIEN_ID, vp.NGAYTAO, vp.NGUOITAO_ID, vp.NGAYCAPNHAT, vp.NGUOICAPNHAT_ID        , NULL AS NOITHUCHIEN_ID, dk.NOICHIDINH_ID as NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        ,M.TENMAU AS NOIDUNG, M.MAMAU AS MADICHVU, NULL AS NORESULT, DVT.TENDONVITINH AS DONVITINH, LM.MALOAIMAU AS MALOAIDUOC, M.BHYT AS DUOC_BHYT, 'M' AS LOAIVATTU_ID, NM.TENNHOMMAU AS MANHOMDICHVU        from TT_HOADON_CHITIET_NGOAITRU VP        join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        INNER JOIN TT_MAU_CHUNGTU_CHITIET CT ON VP.REF_ID=CT.CHUNGTUCHITIET_ID AND VP.REF_TABLE='TT_MAU_CHUNGTU_CHITIET' AND CT.BENHVIEN_ID='01819'        INNER JOIN TT_MAU_CHUNGTU CTU ON CT.CHUNGTU_ID=CTU.CHUNGTU_ID AND CTU.CHUNGTULIENQUAN_ID IS NULL        INNER join TM_MAU M on CT.MAU_ID = M.MAU_ID        LEFT JOIN TM_MAU_DONVITINH DVT ON M.DONVITINH_ID = DVT.DONVITINH_ID        LEFT JOIN TT_MAU_DANGKYMAU_CHITIET DKCT ON DKCT.CHUNGTU_ID = CTU.CHUNGTU_ID AND DKCT.BENHVIEN_ID='01819'        LEFT JOIN TT_MAU_DANGKYMAU DK ON DK.DANGKYMAU_ID = DKCT.DANGKYMAU_ID        LEFT JOIN TM_MAU_LOAIMAU LM ON LM.LOAIMAU_ID = M.LOAIMAU_ID        LEFT JOIN TM_MAU_NHOMMAU NM ON NM.NHOMMAU_ID = LM.NHOMMAU_ID        where        vp.HOADON_ID = '107822'        ) a]
2020-03-26 14:17:14,714 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_HINHTHUCTHANHTOAN_GetList] PreparedStatement : [select TT_HOADON_HINHTHUCTHANHTOAN.*, htttCode.DICTIONARY_CODE HINHTHUCTHANHTOAN_CODE            from TT_HOADON_HINHTHUCTHANHTOAN TT_HOADON_HINHTHUCTHANHTOAN            left join (select DICTIONARY_ID, DICTIONARY_CODE from LST_DICTIONARY where DICTIONARY_TYPE_CODE like 'HinhThucThanhToan') htttCode on htttCode.DICTIONARY_ID = TT_HOADON_HINHTHUCTHANHTOAN.HINHTHUCTHANHTOAN_ID             where                             TT_HOADON_HINHTHUCTHANHTOAN.HOADON_ID = '107822'                       and                           TT_HOADON_HINHTHUCTHANHTOAN.BENHVIEN_ID = '01819'                                     order by HOADON_HTTT_ID]
2020-03-26 14:17:14,760 [1] DEBUG - Statement Id: [DAO00114_GetThongtin_Congtyrahoadon] PreparedStatement : [select KH_TENCONGTY, KH_DIACHI, KH_MASOTHUE from TT_HOADON        where HOADON_ID = '107822']
2020-03-26 14:17:14,841 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 14:17:14,841 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 14:17:14,841 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2020-03-26 14:17:14,878 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 14:17:14,878 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 14:17:14,878 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2020-03-26 14:17:14,919 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1              and               BLCT.BIENLAICHITIET_ID = '1067'                         order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 14:17:14,919 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 14:17:14,919 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2020-03-26 14:17:19,888 [1] DEBUG - Statement Id: [DAO00119_TT_VIENPHI_GetList_TiepNhanPhaiThanhToan] PreparedStatement : [select distinct  a.*, b.GIATRIMIENGIAM_BH, c.GIATRIMIENGIAM_BHTN, f.GIATRIMIENGIAM_THANHVIEN, g.GIATRIMIENGIAM_CTCT,        isnull(dv.TENDICHVU, dc.TENDUOCDAYDU) NOIDUNG, isnull(dv.MADICHVU, dc.MADUOC) MADICHVU, dv.NORESULT, dc.DONVITINH, ld.MALOAIDUOC, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ndv.MANHOMDICHVU        from        (select VP.*, isnull(c.TRANGTHAI, '') TRANGTHAI, c.THUTIENSAU, c.NOITHUCHIEN_ID,        CASE        when REF_TABLE = 'TT_NGOAITRU_TOATHUOC' then ntkb.PHONGBAN_ID        when REF_TABLE = 'TT_CLSKETQUA_VTYT' then clsvtyt.PHONGBAN_ID        when REF_TABLE = 'TT_NGOAITRU_KHAMBENH_VTYT' then kbd.PHONGBAN_ID        ELSE        c.NOIYEUCAU_ID        END NOIYEUCAU_ID,        CASE        when REF_TABLE = 'TT_NGOAITRU_TOATHUOC' then ngtd.KHOXUAT_ID        when REF_TABLE = 'TT_CLSKETQUA_VTYT' then clsvtyt.KHOTAO_ID        when REF_TABLE = 'TT_NGOAITRU_KHAMBENH_VTYT' then kbd.KHOTAO_ID        ELSE null        END KHODUOC_ID          from TT_VIENPHI VP        left join TT_DVYEUCAU c on c.DVYEUCAU_ID = VP.REF_ID  and vp.REF_TABLE = 'TT_DVYEUCAU'        left join TT_NGOAITRU_TOATHUOC nttt on nttt.TOATHUOC_ID = vp.REF_ID and vp.REF_TABLE = 'TT_NGOAITRU_TOATHUOC'        left join TT_NGOAITRU_KHAMBENH_TOATHUOC ngtd on ngtd.KHAMBENH_TOATHUOC_ID = nttt.KHAMBENH_TOATHUOC_ID        left join TT_CLSKETQUA_VTYT clsvtyt on clsvtyt.CLSKETQUA_ID = vp.REF_ID and REF_TABLE = 'TT_CLSKETQUA_VTYT'        left join TT_NGOAITRU_KHAMBENH_VTYT kbd on kbd.KHAMBENH_VTYT_ID = vp.REF_ID and REF_TABLE = 'TT_NGOAITRU_KHAMBENH_VTYT'        left join TT_NGOAITRU_KHAMBENH ntkb on ntkb.KHAMBENH_ID = vp.KHAMBENH_ID and REF_TABLE = 'TT_NGOAITRU_TOATHUOC'          where Vp.TIEPNHAN_ID = '107238' and Vp.ACTIVE = '1' and ((c.HUYYEUCAU != '1' and vp.DICHVU_ID is not null) or (vp.DUOC_ID is not null)) and        ((vp.DATHANHTOAN = '0') or (vp.BENHNHAN_PHAITHANHTOAN > vp.GIATRI_BENHNHAN_DATHANHTOAN and vp.DATHANHTOAN = '1')) and c.DANGKY_CHITIET_ID is null        and vp.REF_TABLE != 'TT_MAU_CHUNGTU_CHITIET'        and vp.REF_TABLE != 'TT_DUOC_CHUNGTU_CHITIET'          AND             VP.KHONGTHUTIEN != '1'                   ) a        left join TM_DUOC dc on a.DUOC_ID = dc.DUOC_ID        left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID        left join TM_DICHVU dv on a.DICHVU_ID = dv.DICHVU_ID and a.REF_TABLE = 'TT_DVYEUCAU'        left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID        left join (select VIENPHI_ID,        sum(MGCT.GIATRIMIENGIAM) AS GIATRIMIENGIAM_BH from TT_MIENGIAM MG        INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_ID = MGCT.MIENGIAM_ID        where MG.TIEPNHAN_ID= '107238' and MGCT.REF_TABLE = 'TT_MIENGIAM' and MG.TINHTRANG = 1 group by VIENPHI_ID        ) b on a.VIENPHI_ID = b.VIENPHI_ID          left join (select VIENPHI_ID, sum(MGCT.GIATRIMIENGIAM) AS GIATRIMIENGIAM_BHTN        from TT_MIENGIAM_BHTN MG        INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_BHTN_ID = MGCT.MIENGIAM_ID        where  MG.TIEPNHAN_ID= '107238' and MGCT.REF_TABLE = 'TT_MIENGIAM_BHTN' and MG.TINHTRANG = 1 group by VIENPHI_ID        )c on a.VIENPHI_ID = c.VIENPHI_ID          left join (select VIENPHI_ID, sum(MGCT.GIATRIMIENGIAM) AS GIATRIMIENGIAM_THANHVIEN        from TT_MIENGIAM_THANHVIEN MG        INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_THANHVIEN_ID = MGCT.MIENGIAM_ID        where MG.TIEPNHAN_ID= '107238' and MGCT.REF_TABLE = 'TT_MIENGIAM_THANHVIEN' and MG.TINHTRANG = 1 group by VIENPHI_ID        )f on a.VIENPHI_ID = f.VIENPHI_ID          left join(select VIENPHI_ID, sum(MGCT.GIATRIMIENGIAM) AS GIATRIMIENGIAM_CTCT        from TT_MIENGIAM_CONGTY MG        INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_CONGTY_ID = MGCT.MIENGIAM_ID        where MG.TIEPNHAN_ID= '107238' and MGCT.REF_TABLE = 'TT_MIENGIAM_CONGTY' and MG.TINHTRANG = 1 group by VIENPHI_ID        )g on a.VIENPHI_ID = g.VIENPHI_ID]
2020-03-26 14:17:19,971 [1] DEBUG - Statement Id: [DAO00330_TT_VIENPHI_GetList_TiepNhanPhaiThanhToan] PreparedStatement : [select distinct  a.*, b.GIATRIMIENGIAM_BH, c.GIATRIMIENGIAM_BHTN, f.GIATRIMIENGIAM_THANHVIEN, g.GIATRIMIENGIAM_CTCT        from        (select VP.*,NULL AS NOITHUCHIEN_ID, DK.NOICHIDINH_ID as NOIYEUCAU_ID, NULL AS THUTIENSAU, isnull(DK.TRANGTHAI, '') TRANGTHAI,        M.TENMAU AS NOIDUNG, M.MAMAU AS MADICHVU, NULL AS NORESULT, DVT.TENDONVITINH AS DONVITINH, LM.MALOAIMAU AS MALOAIDUOC, M.BHYT AS DUOC_BHYT, 'M' AS LOAIVATTU_ID, NM.TENNHOMMAU AS MANHOMDICHVU        from TT_VIENPHI VP        INNER JOIN TT_MAU_CHUNGTU_CHITIET CT ON VP.REF_ID=CT.CHUNGTUCHITIET_ID AND VP.REF_TABLE='TT_MAU_CHUNGTU_CHITIET' AND CT.BENHVIEN_ID='01819'        INNER JOIN TT_MAU_CHUNGTU CTU ON CT.CHUNGTU_ID=CTU.CHUNGTU_ID AND CTU.CHUNGTULIENQUAN_ID IS NULL        INNER join TM_MAU M on CT.MAU_ID = M.MAU_ID        LEFT JOIN TM_MAU_DONVITINH DVT ON M.DONVITINH_ID = DVT.DONVITINH_ID        LEFT JOIN TT_MAU_DANGKYMAU_CHITIET DKCT ON DKCT.CHUNGTU_ID = CTU.CHUNGTU_ID AND DKCT.BENHVIEN_ID='01819'        LEFT JOIN TT_MAU_DANGKYMAU DK ON DK.DANGKYMAU_ID = DKCT.DANGKYMAU_ID        LEFT JOIN TM_MAU_LOAIMAU LM ON LM.LOAIMAU_ID = M.LOAIMAU_ID        LEFT JOIN TM_MAU_NHOMMAU NM ON NM.NHOMMAU_ID = LM.NHOMMAU_ID        where Vp.TIEPNHAN_ID = '107238' and Vp.ACTIVE = '1' and vp.DUOC_ID is not null and        ((vp.DATHANHTOAN = '0') or (vp.BENHNHAN_PHAITHANHTOAN > vp.GIATRI_BENHNHAN_DATHANHTOAN and vp.DATHANHTOAN = '1'))   AND             VP.KHONGTHUTIEN != '1'                   ) a        left join (select VIENPHI_ID,        sum(MGCT.GIATRIMIENGIAM) AS GIATRIMIENGIAM_BH from TT_MIENGIAM MG        INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_ID = MGCT.MIENGIAM_ID        where MG.TIEPNHAN_ID= '107238' and MGCT.REF_TABLE = 'TT_MIENGIAM' and MG.TINHTRANG = 1 group by VIENPHI_ID        ) b on a.VIENPHI_ID = b.VIENPHI_ID          left join (select VIENPHI_ID, sum(MGCT.GIATRIMIENGIAM) AS GIATRIMIENGIAM_BHTN        from TT_MIENGIAM_BHTN MG        INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_BHTN_ID = MGCT.MIENGIAM_ID        where  MG.TIEPNHAN_ID= '107238' and MGCT.REF_TABLE = 'TT_MIENGIAM_BHTN' and MG.TINHTRANG = 1 group by VIENPHI_ID        )c on a.VIENPHI_ID = c.VIENPHI_ID          left join (select VIENPHI_ID, sum(MGCT.GIATRIMIENGIAM) AS GIATRIMIENGIAM_THANHVIEN        from TT_MIENGIAM_THANHVIEN MG        INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_THANHVIEN_ID = MGCT.MIENGIAM_ID        where MG.TIEPNHAN_ID= '107238' and MGCT.REF_TABLE = 'TT_MIENGIAM_THANHVIEN' and MG.TINHTRANG = 1 group by VIENPHI_ID        )f on a.VIENPHI_ID = f.VIENPHI_ID          left join(select VIENPHI_ID, sum(MGCT.GIATRIMIENGIAM) AS GIATRIMIENGIAM_CTCT        from TT_MIENGIAM_CONGTY MG        INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_CONGTY_ID = MGCT.MIENGIAM_ID        where MG.TIEPNHAN_ID= '107238' and MGCT.REF_TABLE = 'TT_MIENGIAM_CONGTY' and MG.TINHTRANG = 1 group by VIENPHI_ID        )g on a.VIENPHI_ID = g.VIENPHI_ID]
2020-03-26 14:17:20,139 [1] DEBUG - Statement Id: [DAO00119_GetDanhsachHTTT] PreparedStatement : [select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE = 'HinhThucThanhToan' and ENABLED = '1' and BENHVIEN_ID = '01819']
2020-03-26 14:17:20,185 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 14:17:20,185 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 14:17:20,185 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2020-03-26 14:17:20,223 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 14:17:20,223 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 14:17:20,223 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2020-03-26 14:17:20,274 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1              and               BLCT.BIENLAICHITIET_ID = '1067'                         order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 14:17:20,274 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 14:17:20,274 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2020-03-26 14:17:20,496 [1] DEBUG - Statement Id: [DAO00119_GetDanhsachHTTT] PreparedStatement : [select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE = 'HinhThucThanhToan' and ENABLED = '1' and BENHVIEN_ID = '01819']
2020-03-26 14:17:26,870 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NGOAITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.TIEPNHAN_ID = a.TIEPNHAN_ID                 where(                             A.HOANTRA = '1'                                             )                       and                           convert(date,A.NGAYHOADON) between convert(date, '3/1/2020 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is null or A.BENHAN_ID = 0                                     order by A.NGAYHOADON]
2020-03-26 14:17:28,787 [1] DEBUG - Statement Id: [DAO00019_ThongTinBenhNhanTiepNhan] PreparedStatement : [select distinct A.SOTIEPNHAN, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        B.*, A.SOBHYT        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'        where                    A.TIEPNHAN_ID = '108096'                 and A.BENHVIEN_ID = '01819']
2020-03-26 14:17:28,906 [1] DEBUG - Statement Id: [DAO00119_TT_VIENPHI_GetList_TiepNhanByHoadon] PreparedStatement : [select  a.*, a.MIENGIAM_GIATRI as GIATRIMIENGIAM_BH, a.BHTN_GIATRI as GIATRIMIENGIAM_BHTN, a.HOIVIEN_GIATRI as GIATRIMIENGIAM_THANHVIEN, a.CONGTYCHITRA_GIATRI as GIATRIMIENGIAM_CTCT,        isnull(dv.TENDICHVU, dc.TENDUOCDAYDU) NOIDUNG, isnull(dv.MADICHVU, dc.MADUOC) MADICHVU, dv.NORESULT, dc.DONVITINH, ld.MALOAIDUOC, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ndv.MANHOMDICHVU        from        (select        vp.HOADONCHITIET_ID, vp.HOADON_ID, vp.VIENPHI_ID, vp.REF_ID, vp.REF_TABLE, vp.DICHVU_ID, vp.DUOC_ID        , vp.LOAI_CHIPHI, vp.LOAIGIA_ID, vp.SOLUONG, vp.DONGIA_DOANHTHU, vp.THANHTIEN_DOANHTHU, vp.BHYT_TL, vpp.BHYT_DONGIA, vpp.BHYT_THANHTIEN, vpp.BHYT_DONGIA_CHITRA        , vp.BHYT_THANHTIEN_CHITRA, vp.BENHNHAN_PHAITHANHTOAN, vp.GIATRI_HOADON, vp.GIATRI_HOADON_DATHANHTOAN, vp.GIATRI_BIENLAI        , vp.GIATRI_BIENLAI_DATHANHTOAN, vp.GIATRI_BENHNHAN_DATHANHTOAN, vp.TYLE_THATTHU, vp.GIATRI_THATTHU, vp.MIENGIAM_TL, vp.MIENGIAM_GIATRI, vp.NGANSACH_TL, vp.NGANSACH_GIATRI        , vp.TAITRO_TL, vp.TAITRO_GIATRI, vp.BHTN_GIATRI, vp.NOIDUNGTHU, vp.CHUNGTUXUATBN_ID, vp.TYLEVAT, vp.GIATRIVAT, vp.MASOTHUE, vp.SOCHUNGTUKETOAN, vp.DAHOANTRA, c.TRANGTHAI        , vp.PHONGBAN_ID, vp.PHONGBAN_THAYDOI_ID, vp.CONGTYCHITRA_GIATRI, vp.HOIVIEN_GIATRI, vp.BENHVIEN_ID, isnull(c.NGAYGIOYEUCAU, vp.NGAYTAO) NGAYTAO, vp.NGUOITAO_ID, vp.NGAYCAPNHAT, vp.NGUOICAPNHAT_ID        , c.NOITHUCHIEN_ID, c.NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NGOAITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        left join TT_DVYEUCAU c on c.DVYEUCAU_ID = VP.REF_ID        where        vp.HOADON_ID = '108829'        ) a        left join TM_DUOC dc on a.DUOC_ID = dc.DUOC_ID        left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID        left join TM_DICHVU dv on a.DICHVU_ID = dv.DICHVU_ID and a.REF_TABLE = 'TT_DVYEUCAU'        left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID        WHERE a.REF_TABLE!='TT_MAU_CHUNGTU_CHITIET']
2020-03-26 14:17:28,986 [1] DEBUG - Statement Id: [DAO00330_TT_VIENPHI_GetList_TiepNhanByHoadon] PreparedStatement : [select  a.*, a.MIENGIAM_GIATRI as GIATRIMIENGIAM_BH, a.BHTN_GIATRI as GIATRIMIENGIAM_BHTN, a.HOIVIEN_GIATRI as GIATRIMIENGIAM_THANHVIEN, a.CONGTYCHITRA_GIATRI as GIATRIMIENGIAM_CTCT        from        (select        vp.HOADONCHITIET_ID, vp.HOADON_ID, vp.VIENPHI_ID, vp.REF_ID, vp.REF_TABLE, vp.DICHVU_ID, vp.DUOC_ID        , vp.LOAI_CHIPHI, vp.LOAIGIA_ID, vp.SOLUONG, vp.DONGIA_DOANHTHU, vp.THANHTIEN_DOANHTHU, vp.BHYT_TL, vpp.BHYT_DONGIA, vpp.BHYT_THANHTIEN, vpp.BHYT_DONGIA_CHITRA        , vp.BHYT_THANHTIEN_CHITRA, vp.BENHNHAN_PHAITHANHTOAN, vp.GIATRI_HOADON, vp.GIATRI_HOADON_DATHANHTOAN, vp.GIATRI_BIENLAI        , vp.GIATRI_BIENLAI_DATHANHTOAN, vp.GIATRI_BENHNHAN_DATHANHTOAN, vp.TYLE_THATTHU, vp.GIATRI_THATTHU, vp.MIENGIAM_TL, vp.MIENGIAM_GIATRI, vp.NGANSACH_TL, vp.NGANSACH_GIATRI        , vp.TAITRO_TL, vp.TAITRO_GIATRI, vp.BHTN_GIATRI, vp.NOIDUNGTHU, vp.CHUNGTUXUATBN_ID, vp.TYLEVAT, vp.GIATRIVAT, vp.MASOTHUE, vp.SOCHUNGTUKETOAN, vp.DAHOANTRA, vp.TRANGTHAI        , vp.PHONGBAN_ID, vp.PHONGBAN_THAYDOI_ID, vp.CONGTYCHITRA_GIATRI, vp.HOIVIEN_GIATRI, vp.BENHVIEN_ID, vp.NGAYTAO, vp.NGUOITAO_ID, vp.NGAYCAPNHAT, vp.NGUOICAPNHAT_ID        , NULL AS NOITHUCHIEN_ID, dk.NOICHIDINH_ID as NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        ,M.TENMAU AS NOIDUNG, M.MAMAU AS MADICHVU, NULL AS NORESULT, DVT.TENDONVITINH AS DONVITINH, LM.MALOAIMAU AS MALOAIDUOC, M.BHYT AS DUOC_BHYT, 'M' AS LOAIVATTU_ID, NM.TENNHOMMAU AS MANHOMDICHVU        from TT_HOADON_CHITIET_NGOAITRU VP        join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        INNER JOIN TT_MAU_CHUNGTU_CHITIET CT ON VP.REF_ID=CT.CHUNGTUCHITIET_ID AND VP.REF_TABLE='TT_MAU_CHUNGTU_CHITIET' AND CT.BENHVIEN_ID='01819'        INNER JOIN TT_MAU_CHUNGTU CTU ON CT.CHUNGTU_ID=CTU.CHUNGTU_ID AND CTU.CHUNGTULIENQUAN_ID IS NULL        INNER join TM_MAU M on CT.MAU_ID = M.MAU_ID        LEFT JOIN TM_MAU_DONVITINH DVT ON M.DONVITINH_ID = DVT.DONVITINH_ID        LEFT JOIN TT_MAU_DANGKYMAU_CHITIET DKCT ON DKCT.CHUNGTU_ID = CTU.CHUNGTU_ID AND DKCT.BENHVIEN_ID='01819'        LEFT JOIN TT_MAU_DANGKYMAU DK ON DK.DANGKYMAU_ID = DKCT.DANGKYMAU_ID        LEFT JOIN TM_MAU_LOAIMAU LM ON LM.LOAIMAU_ID = M.LOAIMAU_ID        LEFT JOIN TM_MAU_NHOMMAU NM ON NM.NHOMMAU_ID = LM.NHOMMAU_ID        where        vp.HOADON_ID = '108829'        ) a]
2020-03-26 14:17:29,142 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_HINHTHUCTHANHTOAN_GetList] PreparedStatement : [select TT_HOADON_HINHTHUCTHANHTOAN.*, htttCode.DICTIONARY_CODE HINHTHUCTHANHTOAN_CODE            from TT_HOADON_HINHTHUCTHANHTOAN TT_HOADON_HINHTHUCTHANHTOAN            left join (select DICTIONARY_ID, DICTIONARY_CODE from LST_DICTIONARY where DICTIONARY_TYPE_CODE like 'HinhThucThanhToan') htttCode on htttCode.DICTIONARY_ID = TT_HOADON_HINHTHUCTHANHTOAN.HINHTHUCTHANHTOAN_ID             where                             TT_HOADON_HINHTHUCTHANHTOAN.HOADON_ID = '108829'                       and                           TT_HOADON_HINHTHUCTHANHTOAN.BENHVIEN_ID = '01819'                                     order by HOADON_HTTT_ID]
2020-03-26 14:17:29,200 [1] DEBUG - Statement Id: [DAO00114_GetThongtin_Congtyrahoadon] PreparedStatement : [select KH_TENCONGTY, KH_DIACHI, KH_MASOTHUE from TT_HOADON        where HOADON_ID = '108829']
2020-03-26 14:17:29,280 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 14:17:29,280 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 14:17:29,280 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2020-03-26 14:17:29,317 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 14:17:29,317 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 14:17:29,318 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2020-03-26 14:17:29,368 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1              and               BLCT.BIENLAICHITIET_ID = '1067'                         order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 14:17:29,369 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 14:17:29,369 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2020-03-26 14:17:47,359 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'COM31'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 14:17:47,571 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'BIL18'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 14:17:48,985 [1] DEBUG - Statement Id: [DAO00119_GetDanhsachHTTT] PreparedStatement : [select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE = 'HinhThucThanhToan' and ENABLED = '1' and BENHVIEN_ID = '01819']
2020-03-26 14:17:49,459 [1] DEBUG - Statement Id: [DAO00101_GetListSuatAn] PreparedStatement : [SELECT        kP.KHAUPHANAN_ID,        kP.MAKHAUPHANAN,        kP.TENKHAUPHANAN,        LKP.LOAIKHAUPHANAN_ID,        LKP.MALOAIKHAUPHANAN,        LKP.TENLOAIKHAUPHANAN,        DG.DONGIA,        kP.HANGMUC_ID        FROM TM_NUT_KHAUPHANAN kP        INNER JOIN TM_NUT_LOAIKHAUPHANAN LKP ON  kP.LOAIKHAUPHANAN_ID = LKP.LOAIKHAUPHANAN_ID        INNER JOIN TM_NUT_KHAUPHANAN_DONGIA DG ON DG.KHAUPHANAN_ID = kP.KHAUPHANAN_ID        WHERE DG.DONGIA IS NOT NULL]
2020-03-26 14:17:56,945 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NOITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = a.BENHAN_ID                 where(                             A.HUYHOADON = '1'                                             )                       and                           convert(date,A.NGAYHOADON) between convert(date, '3/1/2020 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is not null                order by A.NGAYHOADON]
2020-03-26 14:18:03,985 [1] DEBUG - Statement Id: [DAO00019_ThongTinBenhNhanBenhAn] PreparedStatement : [select distinct C.SOBENHAN, C.BENHAN_ID, A.SOTIEPNHAN, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI, A.SOBHYT,        B.*        from TT_NOITRU_BENHAN C        inner join TT_TIEPNHAN A on C.TIEPNHAN_ID = A.TIEPNHAN_ID        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'        where                    C.SOBENHAN = '20.002255'                 and A.BENHVIEN_ID = '01819']
2020-03-26 14:18:04,231 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_HINHTHUCTHANHTOAN_GetList] PreparedStatement : [select TT_HOADON_HINHTHUCTHANHTOAN.*, htttCode.DICTIONARY_CODE HINHTHUCTHANHTOAN_CODE            from TT_HOADON_HINHTHUCTHANHTOAN TT_HOADON_HINHTHUCTHANHTOAN            left join (select DICTIONARY_ID, DICTIONARY_CODE from LST_DICTIONARY where DICTIONARY_TYPE_CODE like 'HinhThucThanhToan') htttCode on htttCode.DICTIONARY_ID = TT_HOADON_HINHTHUCTHANHTOAN.HINHTHUCTHANHTOAN_ID             where                             TT_HOADON_HINHTHUCTHANHTOAN.HOADON_ID = '106692'                       and                           TT_HOADON_HINHTHUCTHANHTOAN.BENHVIEN_ID = '01819'                                     order by HOADON_HTTT_ID]
2020-03-26 14:18:04,281 [1] DEBUG - Statement Id: [DAO00119_TT_VIENPHI_GetList_BenhAnByHoadon] PreparedStatement : [select  a.*, a.MIENGIAM_GIATRI as GIATRIMIENGIAM_BH, a.BHTN_GIATRI as GIATRIMIENGIAM_BHTN,        a.HOIVIEN_GIATRI as GIATRIMIENGIAM_THANHVIEN, a.CONGTYCHITRA_GIATRI as GIATRIMIENGIAM_CTCT,        isnull(dv.TENDICHVU, dc.TENDUOCDAYDU) NOIDUNG, isnull(dv.MADICHVU, dc.MADUOC) MADICHVU, dv.NORESULT, dc.DONVITINH, ld.MALOAIDUOC, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ndv.MANHOMDICHVU        from        (        select * from (        select vp.*, c.NOITHUCHIEN_ID, c.NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_DVYEUCAU c on c.DVYEUCAU_ID = VP.REF_ID and vpp.REF_TABLE = 'TT_DVYEUCAU'        union        select vp.*, C.PHONGBANRATOA_ID as NOITHUCHIEN_ID, D.PHONGBAN_ID NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_NOITRU_TOATHUOC c on c.TOATHUOC_ID = VP.REF_ID and vpp.REF_TABLE = 'TT_NOITRU_TOATHUOC'        inner join TT_NOITRU_KHAMBENH D on D.KHAMBENH_ID = C.KHAMBENH_ID        union        select vp.*, C.PHONGBAN_ID as NOITHUCHIEN_ID, C.PHONGBAN_ID as NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_CLSKETQUA_VTYT c on c.CLSKETQUA_VTYT_ID = VP.REF_ID and vpp.REF_TABLE = 'TT_CLSKETQUA_VTYT'        union        select vp.*, ISNULL(D.PHONGBANTHUCHIEN_ID,d.PHONGBANCHIDINH_ID) as NOITHUCHIEN_ID, ISNULL(D.PHONGBANCHIDINH_ID,D.PHONGBANTHUCHIEN_ID) as NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_PHAUTHUAT_VTYT c on c.PHAUTHUAT_VTYT_ID = VP.REF_ID and vpp.REF_TABLE = 'TT_PHAUTHUAT_VTYT'        inner join TT_PHAUTHUAT D on D.PHAUTHUAT_ID = C.PHAUTHUAT_ID        union        select vp.*, c.PHONGBAN_ID as NOITHUCHIEN_ID, c.PHONGBAN_ID as NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_NGOAITRU_KHAMBENH_VTYT c on c.KHAMBENH_VTYT_ID = VP.REF_ID and vpp.REF_TABLE = 'TT_NGOAITRU_KHAMBENH_VTYT'        union        select vp.*, E.PHONGBAN_ID as NOITHUCHIEN_ID, E.PHONGBAN_ID as NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_NUT_XACNHANSUATAN_CHITIET XNC on XNC.XACNHANSUATANCHITIET_ID = vp.REF_ID and vpp.REF_TABLE = 'TT_NUT_XACNHANSUATAN_CHITIET'        inner join TT_NUT_CHIDINHKHAUPHAN_CHITIET D on D.CHIDINHKHAUPHANCHITIET_ID = XNC.CHIDINHKHAUPHANCHITIET_ID        inner join TM_NUT_KHAUPHANAN c on C.KHAUPHANAN_ID = D.KHAUPHANAN_ID        inner join TT_NUT_CHIDINHKHAUPHAN E on E.CHIDINHKHAUPHAN_ID = D.CHIDINHKHAUPHAN_ID        ) B        where B.HOADON_ID = '106692'        ) a        left join TM_DUOC dc on a.DUOC_ID = dc.DUOC_ID        left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID        left join TM_DICHVU dv on a.DICHVU_ID = dv.DICHVU_ID and a.REF_TABLE = 'TT_DVYEUCAU'        left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID]
2020-03-26 14:18:05,623 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 14:18:05,623 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 14:18:05,623 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2020-03-26 14:18:05,670 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1              and               BLCT.BIENLAICHITIET_ID = '1067'                         order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 14:18:05,670 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 14:18:05,670 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2020-03-26 14:18:05,771 [1] DEBUG - Statement Id: [DAO00014_GetInPatientStatus] PreparedStatement : [select TRANGTHAI, isnull(KHOACHUYENDEN_ID, KHOAVAO_ID) as KHOAHIENTAI from TT_NOITRU_BENHAN        where        TIEPNHAN_ID = '104260'        and BENHVIEN_ID = '01819'         and           BENHAN_ID = '19427']
2020-03-26 14:18:14,793 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NOITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = a.BENHAN_ID                 where(                           (A.DATHANHTOAN = '1'                         and                           A.TRANGTHAI != 'DADUYETCONGNO'                         )                          and (A.HUYHOADON is null or A.HUYHOADON = '0')                          and (A.HOANTRA is null or A.HOANTRA = '0')                                             )                       and                           A.TIEPNHAN_ID = '104260'                       and                           A.BENHAN_ID = '19427'                       and                         (bn.TENBENHNHAN like '%' +  @param0  + '%' or bn.MAYTE like '%' +  @param0  + '%')                       and                           convert(date,A.NGAYHOADON) between convert(date, '3/26/2020 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is not null  and                           ntba.BENHAN_ID = '19427'                                       order by A.NGAYHOADON]
2020-03-26 14:18:14,793 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] Parameters: [@param0=[TENBENHNHAN,190033170]]
2020-03-26 14:18:14,793 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] Types: [@param0=[String, System.String]]
2020-03-26 14:18:18,451 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NOITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = a.BENHAN_ID                 where(                             A.HOANTRA = '1'                                             )                       and                           A.TIEPNHAN_ID = '104260'                       and                           A.BENHAN_ID = '19427'                       and                         (bn.TENBENHNHAN like '%' +  @param0  + '%' or bn.MAYTE like '%' +  @param0  + '%')                       and                           convert(date,A.NGAYHOADON) between convert(date, '3/26/2020 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is not null  and                           ntba.BENHAN_ID = '19427'                                       order by A.NGAYHOADON]
2020-03-26 14:18:18,451 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] Parameters: [@param0=[TENBENHNHAN,190033170]]
2020-03-26 14:18:18,451 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] Types: [@param0=[String, System.String]]
2020-03-26 14:18:23,890 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NOITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = a.BENHAN_ID                 where(                             A.HOANTRA = '1'                                             )                       and                           A.TIEPNHAN_ID = '104260'                       and                           A.BENHAN_ID = '19427'                       and                           convert(date,A.NGAYHOADON) between convert(date, '3/1/2020 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is not null  and                           ntba.BENHAN_ID = '19427'                                       order by A.NGAYHOADON]
2020-03-26 14:18:25,450 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NOITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = a.BENHAN_ID                 where(                             A.HOANTRA = '1'                                             )                       and                           A.TIEPNHAN_ID = '104260'                       and                           A.BENHAN_ID = '19427'                       and                           convert(date,A.NGAYHOADON) between convert(date, '3/1/2020 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is not null  and                           ntba.BENHAN_ID = '19427'                                       order by A.NGAYHOADON]
2020-03-26 14:18:27,508 [1] DEBUG - Statement Id: [DAO00014_GetInPatientStatus] PreparedStatement : [select TRANGTHAI, isnull(KHOACHUYENDEN_ID, KHOAVAO_ID) as KHOAHIENTAI from TT_NOITRU_BENHAN        where        TIEPNHAN_ID = '104260'        and BENHVIEN_ID = '01819'         and           BENHAN_ID = '19427']
2020-03-26 14:18:27,591 [1] DEBUG - Statement Id: [DAO00119_GetDanhsachHTTT] PreparedStatement : [select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE = 'HinhThucThanhToan' and ENABLED = '1' and BENHVIEN_ID = '01819']
2020-03-26 14:18:27,638 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 14:18:27,638 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 14:18:27,638 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2020-03-26 14:18:27,672 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 14:18:27,672 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 14:18:27,672 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2020-03-26 14:18:27,712 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1              and               BLCT.BIENLAICHITIET_ID = '1067'                         order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 14:18:27,712 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 14:18:27,712 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2020-03-26 14:18:27,922 [1] DEBUG - Statement Id: [DAO00119_GetDanhsachHTTT] PreparedStatement : [select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE = 'HinhThucThanhToan' and ENABLED = '1' and BENHVIEN_ID = '01819']
2020-03-26 14:18:34,233 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NOITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = a.BENHAN_ID                 where(                             A.HOANTRA = '1'                                             )                       and                           convert(date,A.NGAYHOADON) between convert(date, '3/1/2020 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is not null                order by A.NGAYHOADON]
2020-03-26 14:18:45,793 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NOITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = a.BENHAN_ID                 where(                             A.HOANTRA = '1'                                             )                       and                           convert(date,A.NGAYHOADON) between convert(date, '10/2/2019 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is not null                order by A.NGAYHOADON]
2020-03-26 14:18:54,128 [1] DEBUG - Statement Id: [DAO00019_ThongTinBenhNhanBenhAn] PreparedStatement : [select distinct C.SOBENHAN, C.BENHAN_ID, A.SOTIEPNHAN, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI, A.SOBHYT,        B.*        from TT_NOITRU_BENHAN C        inner join TT_TIEPNHAN A on C.TIEPNHAN_ID = A.TIEPNHAN_ID        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'        where                    C.SOBENHAN = '20.001855'                 and A.BENHVIEN_ID = '01819']
2020-03-26 14:18:54,409 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_HINHTHUCTHANHTOAN_GetList] PreparedStatement : [select TT_HOADON_HINHTHUCTHANHTOAN.*, htttCode.DICTIONARY_CODE HINHTHUCTHANHTOAN_CODE            from TT_HOADON_HINHTHUCTHANHTOAN TT_HOADON_HINHTHUCTHANHTOAN            left join (select DICTIONARY_ID, DICTIONARY_CODE from LST_DICTIONARY where DICTIONARY_TYPE_CODE like 'HinhThucThanhToan') htttCode on htttCode.DICTIONARY_ID = TT_HOADON_HINHTHUCTHANHTOAN.HINHTHUCTHANHTOAN_ID             where                             TT_HOADON_HINHTHUCTHANHTOAN.HOADON_ID = '103674'                       and                           TT_HOADON_HINHTHUCTHANHTOAN.BENHVIEN_ID = '01819'                                     order by HOADON_HTTT_ID]
2020-03-26 14:18:54,466 [1] DEBUG - Statement Id: [DAO00119_TT_VIENPHI_GetList_BenhAnByHoadon] PreparedStatement : [select  a.*, a.MIENGIAM_GIATRI as GIATRIMIENGIAM_BH, a.BHTN_GIATRI as GIATRIMIENGIAM_BHTN,        a.HOIVIEN_GIATRI as GIATRIMIENGIAM_THANHVIEN, a.CONGTYCHITRA_GIATRI as GIATRIMIENGIAM_CTCT,        isnull(dv.TENDICHVU, dc.TENDUOCDAYDU) NOIDUNG, isnull(dv.MADICHVU, dc.MADUOC) MADICHVU, dv.NORESULT, dc.DONVITINH, ld.MALOAIDUOC, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ndv.MANHOMDICHVU        from        (        select * from (        select vp.*, c.NOITHUCHIEN_ID, c.NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_DVYEUCAU c on c.DVYEUCAU_ID = VP.REF_ID and vpp.REF_TABLE = 'TT_DVYEUCAU'        union        select vp.*, C.PHONGBANRATOA_ID as NOITHUCHIEN_ID, D.PHONGBAN_ID NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_NOITRU_TOATHUOC c on c.TOATHUOC_ID = VP.REF_ID and vpp.REF_TABLE = 'TT_NOITRU_TOATHUOC'        inner join TT_NOITRU_KHAMBENH D on D.KHAMBENH_ID = C.KHAMBENH_ID        union        select vp.*, C.PHONGBAN_ID as NOITHUCHIEN_ID, C.PHONGBAN_ID as NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_CLSKETQUA_VTYT c on c.CLSKETQUA_VTYT_ID = VP.REF_ID and vpp.REF_TABLE = 'TT_CLSKETQUA_VTYT'        union        select vp.*, ISNULL(D.PHONGBANTHUCHIEN_ID,d.PHONGBANCHIDINH_ID) as NOITHUCHIEN_ID, ISNULL(D.PHONGBANCHIDINH_ID,D.PHONGBANTHUCHIEN_ID) as NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_PHAUTHUAT_VTYT c on c.PHAUTHUAT_VTYT_ID = VP.REF_ID and vpp.REF_TABLE = 'TT_PHAUTHUAT_VTYT'        inner join TT_PHAUTHUAT D on D.PHAUTHUAT_ID = C.PHAUTHUAT_ID        union        select vp.*, c.PHONGBAN_ID as NOITHUCHIEN_ID, c.PHONGBAN_ID as NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_NGOAITRU_KHAMBENH_VTYT c on c.KHAMBENH_VTYT_ID = VP.REF_ID and vpp.REF_TABLE = 'TT_NGOAITRU_KHAMBENH_VTYT'        union        select vp.*, E.PHONGBAN_ID as NOITHUCHIEN_ID, E.PHONGBAN_ID as NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_NUT_XACNHANSUATAN_CHITIET XNC on XNC.XACNHANSUATANCHITIET_ID = vp.REF_ID and vpp.REF_TABLE = 'TT_NUT_XACNHANSUATAN_CHITIET'        inner join TT_NUT_CHIDINHKHAUPHAN_CHITIET D on D.CHIDINHKHAUPHANCHITIET_ID = XNC.CHIDINHKHAUPHANCHITIET_ID        inner join TM_NUT_KHAUPHANAN c on C.KHAUPHANAN_ID = D.KHAUPHANAN_ID        inner join TT_NUT_CHIDINHKHAUPHAN E on E.CHIDINHKHAUPHAN_ID = D.CHIDINHKHAUPHAN_ID        ) B        where B.HOADON_ID = '103674'        ) a        left join TM_DUOC dc on a.DUOC_ID = dc.DUOC_ID        left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID        left join TM_DICHVU dv on a.DICHVU_ID = dv.DICHVU_ID and a.REF_TABLE = 'TT_DVYEUCAU'        left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID]
2020-03-26 14:18:55,607 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 14:18:55,607 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 14:18:55,607 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2020-03-26 14:18:55,651 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 14:18:55,651 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 14:18:55,651 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2020-03-26 14:18:55,689 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1              and               BLCT.BIENLAICHITIET_ID = '1067'                         order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 14:18:55,690 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 14:18:55,690 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2020-03-26 14:18:55,730 [1] DEBUG - Statement Id: [DAO00014_GetInPatientStatus] PreparedStatement : [select TRANGTHAI, isnull(KHOACHUYENDEN_ID, KHOAVAO_ID) as KHOAHIENTAI from TT_NOITRU_BENHAN        where        TIEPNHAN_ID = '102194'        and BENHVIEN_ID = '01819'         and           BENHAN_ID = '19026']
2020-03-26 14:19:00,399 [1] DEBUG - Statement Id: [DAO00014_GetInPatientStatus] PreparedStatement : [select TRANGTHAI, isnull(KHOACHUYENDEN_ID, KHOAVAO_ID) as KHOAHIENTAI from TT_NOITRU_BENHAN        where        TIEPNHAN_ID = '102194'        and BENHVIEN_ID = '01819'         and           BENHAN_ID = '19026']
2020-03-26 14:19:00,485 [1] DEBUG - Statement Id: [DAO00119_GetDanhsachHTTT] PreparedStatement : [select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE = 'HinhThucThanhToan' and ENABLED = '1' and BENHVIEN_ID = '01819']
2020-03-26 14:19:00,543 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 14:19:00,543 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 14:19:00,543 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2020-03-26 14:19:00,586 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 14:19:00,586 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 14:19:00,586 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2020-03-26 14:19:00,636 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1              and               BLCT.BIENLAICHITIET_ID = '1067'                         order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 14:19:00,636 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 14:19:00,636 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2020-03-26 14:19:00,846 [1] DEBUG - Statement Id: [DAO00119_GetDanhsachHTTT] PreparedStatement : [select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE = 'HinhThucThanhToan' and ENABLED = '1' and BENHVIEN_ID = '01819']
2020-03-26 14:19:01,102 [1] DEBUG - Statement Id: [DAO00119_GetDanhsachHTTT] PreparedStatement : [select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE = 'HinhThucThanhToan' and ENABLED = '1' and BENHVIEN_ID = '01819']
2020-03-26 14:19:08,762 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NOITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = a.BENHAN_ID                 where(                           (A.DATHANHTOAN = '1'                         and                           A.TRANGTHAI != 'DADUYETCONGNO'                         )                          and (A.HUYHOADON is null or A.HUYHOADON = '0')                          and (A.HOANTRA is null or A.HOANTRA = '0')                                             )                       and                           convert(date,A.NGAYHOADON) between convert(date, '3/1/2020 12:00:00 AM') and convert(date, '3/26/2020 12:00:00 AM')                       and                           A.BENHVIEN_ID = '01819'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is not null                order by A.NGAYHOADON]
2020-03-26 14:19:51,653 [1] DEBUG - Statement Id: [DAO00059_GetList] PreparedStatement : [select A.* from TM_PHONGBAN A            inner join LST_DICTIONARY B on A.LOAIPHONGBAN_ID = B.DICTIONARY_ID            and B.DICTIONARY_TYPE_CODE = 'LoaiPhongBan' and (B.DICTIONARY_CODE = 'KhoaNoi' or B.DICTIONARY_CODE = 'KhoaNgoai')            where A.BENHVIEN_ID = '01819'            and A.MAPHONGBAN != '' AND A.TAMNGUNG = '0' order by A.TENPHONGBAN asc]
2020-03-26 14:19:52,331 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_HINHTHUCTHANHTOAN_GetList] PreparedStatement : [select TT_HOADON_HINHTHUCTHANHTOAN.*, htttCode.DICTIONARY_CODE HINHTHUCTHANHTOAN_CODE            from TT_HOADON_HINHTHUCTHANHTOAN TT_HOADON_HINHTHUCTHANHTOAN            left join (select DICTIONARY_ID, DICTIONARY_CODE from LST_DICTIONARY where DICTIONARY_TYPE_CODE like 'HinhThucThanhToan') htttCode on htttCode.DICTIONARY_ID = TT_HOADON_HINHTHUCTHANHTOAN.HINHTHUCTHANHTOAN_ID             where                             TT_HOADON_HINHTHUCTHANHTOAN.HOADON_ID = '109319'                       and                           TT_HOADON_HINHTHUCTHANHTOAN.BENHVIEN_ID = '01819'                                     order by HOADON_HTTT_ID]
2020-03-26 14:19:52,392 [1] DEBUG - Statement Id: [DAO00119_TT_VIENPHI_GetList_BenhAnByHoadon] PreparedStatement : [select  a.*, a.MIENGIAM_GIATRI as GIATRIMIENGIAM_BH, a.BHTN_GIATRI as GIATRIMIENGIAM_BHTN,        a.HOIVIEN_GIATRI as GIATRIMIENGIAM_THANHVIEN, a.CONGTYCHITRA_GIATRI as GIATRIMIENGIAM_CTCT,        isnull(dv.TENDICHVU, dc.TENDUOCDAYDU) NOIDUNG, isnull(dv.MADICHVU, dc.MADUOC) MADICHVU, dv.NORESULT, dc.DONVITINH, ld.MALOAIDUOC, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ndv.MANHOMDICHVU        from        (        select * from (        select vp.*, c.NOITHUCHIEN_ID, c.NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_DVYEUCAU c on c.DVYEUCAU_ID = VP.REF_ID and vpp.REF_TABLE = 'TT_DVYEUCAU'        union        select vp.*, C.PHONGBANRATOA_ID as NOITHUCHIEN_ID, D.PHONGBAN_ID NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_NOITRU_TOATHUOC c on c.TOATHUOC_ID = VP.REF_ID and vpp.REF_TABLE = 'TT_NOITRU_TOATHUOC'        inner join TT_NOITRU_KHAMBENH D on D.KHAMBENH_ID = C.KHAMBENH_ID        union        select vp.*, C.PHONGBAN_ID as NOITHUCHIEN_ID, C.PHONGBAN_ID as NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_CLSKETQUA_VTYT c on c.CLSKETQUA_VTYT_ID = VP.REF_ID and vpp.REF_TABLE = 'TT_CLSKETQUA_VTYT'        union        select vp.*, ISNULL(D.PHONGBANTHUCHIEN_ID,d.PHONGBANCHIDINH_ID) as NOITHUCHIEN_ID, ISNULL(D.PHONGBANCHIDINH_ID,D.PHONGBANTHUCHIEN_ID) as NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_PHAUTHUAT_VTYT c on c.PHAUTHUAT_VTYT_ID = VP.REF_ID and vpp.REF_TABLE = 'TT_PHAUTHUAT_VTYT'        inner join TT_PHAUTHUAT D on D.PHAUTHUAT_ID = C.PHAUTHUAT_ID        union        select vp.*, c.PHONGBAN_ID as NOITHUCHIEN_ID, c.PHONGBAN_ID as NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_NGOAITRU_KHAMBENH_VTYT c on c.KHAMBENH_VTYT_ID = VP.REF_ID and vpp.REF_TABLE = 'TT_NGOAITRU_KHAMBENH_VTYT'        union        select vp.*, E.PHONGBAN_ID as NOITHUCHIEN_ID, E.PHONGBAN_ID as NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_NUT_XACNHANSUATAN_CHITIET XNC on XNC.XACNHANSUATANCHITIET_ID = vp.REF_ID and vpp.REF_TABLE = 'TT_NUT_XACNHANSUATAN_CHITIET'        inner join TT_NUT_CHIDINHKHAUPHAN_CHITIET D on D.CHIDINHKHAUPHANCHITIET_ID = XNC.CHIDINHKHAUPHANCHITIET_ID        inner join TM_NUT_KHAUPHANAN c on C.KHAUPHANAN_ID = D.KHAUPHANAN_ID        inner join TT_NUT_CHIDINHKHAUPHAN E on E.CHIDINHKHAUPHAN_ID = D.CHIDINHKHAUPHAN_ID        ) B        where B.HOADON_ID = '109319'        ) a        left join TM_DUOC dc on a.DUOC_ID = dc.DUOC_ID        left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID        left join TM_DICHVU dv on a.DICHVU_ID = dv.DICHVU_ID and a.REF_TABLE = 'TT_DVYEUCAU'        left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID]
2020-03-26 14:19:52,662 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 14:19:52,662 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 14:19:52,662 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2020-03-26 14:19:52,704 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 14:19:52,704 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 14:19:52,704 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2020-03-26 14:19:52,749 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1              and               BLCT.BIENLAICHITIET_ID = '1067'                         order by BLCT.THOIGIANSUDUNG DESC]
2020-03-26 14:19:52,749 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,01819]]
2020-03-26 14:19:52,749 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2020-03-26 14:19:52,789 [1] DEBUG - Statement Id: [DAO00014_GetInPatientStatus] PreparedStatement : [select TRANGTHAI, isnull(KHOACHUYENDEN_ID, KHOAVAO_ID) as KHOAHIENTAI from TT_NOITRU_BENHAN        where        TIEPNHAN_ID = '108573'        and BENHVIEN_ID = '01819'         and           BENHAN_ID = '20329']
--------------------------------------------------------------------------------
2020-03-26 14:28:19,985 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2020-03-26 14:28:20,337 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2020-03-26 14:28:20,380 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2020-03-26 14:28:23,767 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 14:28:24,138 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2020-03-26 14:28:36,737 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '01819' and TYPE = 'D']
2020-03-26 14:28:36,767 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '01819' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2020-03-26 14:28:39,702 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '01819')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '01819' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2020-03-26 14:28:39,812 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2020-03-26 14:28:40,736 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2020-03-26 14:28:41,083 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2020-03-26 14:28:41,172 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2020-03-26 14:28:41,254 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2020-03-26 14:28:41,404 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2020-03-26 14:28:41,793 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2020-03-26 14:28:42,068 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2020-03-26 14:28:42,265 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2020-03-26 14:28:42,447 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2020-03-26 14:28:43,211 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2020-03-26 14:28:43,251 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = '01819' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = '01819'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = '01819')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = '01819' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = '01819'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = '01819' AND TT_TONKHO.SOLUONG >= 0]
2020-03-26 14:28:43,376 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2020-03-26 14:28:43,499 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = '01819' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = '01819'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = '01819')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = '01819' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = '01819' and TT_TONKHO.SOLUONG >= 0]
2020-03-26 14:28:45,716 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2020-03-26 14:28:45,761 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @NGUONDUOC_MACDINH varchar(5) = '0';        declare @TOAMUANGOAI int = 0;        select @NGUONDUOC_MACDINH = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'PHA_NGUONDUOC'        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + @NGUONDUOC_MACDINH as DUOC_KEY, 0 as PHAMVI_ID, @NGUONDUOC_MACDINH as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = '01819'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = '01819')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = '01819'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = '01819')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = '01819'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = '01819'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = '01819'        where d.BENHVIEN_ID = '01819'  and tk.SOLUONG >= 0        end        else        begin                select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = '01819'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = '01819')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (        select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID)        B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (        select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID)        A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = '01819'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = '01819'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = '01819'        where d.BENHVIEN_ID = '01819'  and tk.SOLUONG >= 0        end]
2020-03-26 14:28:49,875 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2020-03-26 14:28:49,953 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,        SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH        FROM TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID        WHERE TK.SOLUONG > 0        GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2020-03-26 14:28:50,428 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2020-03-26 14:28:50,665 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,        TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,        TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH        from TM_MAU M        JOIN        (        select        A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO        from        (        select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO        from TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'        where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0        ) A        )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2020-03-26 14:28:50,918 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '01819'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2020-03-26 14:28:51,897 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 14:28:53,014 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = '01819']
2020-03-26 14:29:00,854 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = '01819' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2020-03-26 14:29:00,929 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = '01819'              order by SETTING_ID]
2020-03-26 14:29:01,063 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 14:29:01,210 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 14:29:01,365 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2020-03-26 14:29:01,367 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,01819], @param1=[ACCOUNT_ID,113]]
2020-03-26 14:29:01,368 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2020-03-26 14:29:01,404 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2020-03-26 14:29:01,404 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,01819], @param1=[ACCOUNT_ID,113]]
2020-03-26 14:29:01,404 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2020-03-26 14:29:01,569 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 14:29:01,796 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 14:29:26,331 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 14:29:26,431 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = '01819' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2020-03-26 14:29:26,828 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = '01819' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2020-03-26 15:42:58,652 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'MTR03'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 15:43:01,726 [1] DEBUG - Statement Id: [DAO00212_DEP04_KHODUOC_GetList] PreparedStatement : [SELECT KHODUOC_ID AS CATEGORY_ID, MAKHO AS CATEGORY_CODE, TENKHO AS CATEGORY_NAME, 1 AS FOLDER_LEVEL, 0 AS PARENT_ID, '0' AS IS_FOLDER        FROM TM_KHODUOC        WHERE TAMNGUNG = '0' AND BENHVIEN_ID = '01819']
2020-03-26 15:43:01,945 [1] DEBUG - Statement Id: [DAO00212_DEP04_PHONGBAN_GetList] PreparedStatement : [WITH PhongbanRec AS        (        SELECT P.PHONGBAN_ID AS CATEGORY_ID, P.MAPHONGBAN AS CATEGORY_CODE, P.TENPHONGBAN AS CATEGORY_NAME, P.CAP AS FOLDER_LEVEL, ISNULL(P.CAPTREN_ID,0) AS PARENT_ID, '0' AS IS_FOLDER, P.LOAIPHONGBAN_ID        FROM TM_PHONGBAN AS P        WHERE P.CAP = 1 AND ISNULL(P.CAPTREN_ID,0) = 0 AND P.BENHVIEN_ID = '01819' AND P.TAMNGUNG = '0'        UNION ALL        SELECT P.PHONGBAN_ID AS CATEGORY_ID, P.MAPHONGBAN AS CATEGORY_CODE, P.TENPHONGBAN AS CATEGORY_NAME, P.CAP AS FOLDER_LEVEL, P.CAPTREN_ID AS PARENT_ID, '0' AS IS_FOLDER, P.LOAIPHONGBAN_ID        FROM PhongbanRec AS PR        INNER JOIN dbo.TM_PHONGBAN AS P ON P.CAPTREN_ID = PR.CATEGORY_ID AND P.BENHVIEN_ID = '01819' AND P.TAMNGUNG = '0'        )        SELECT '' AS TREE_COLUMN, P.* FROM PhongbanRec AS P        INNER JOIN LST_DICTIONARY AS D on P.LOAIPHONGBAN_ID = D.DICTIONARY_ID AND D.DICTIONARY_TYPE_CODE = 'LoaiPhongBan'         where                 D.DICTIONARY_CODE IN ('KhamBenh','KhoaNoi','PhongMo','KhoaCLS', 'KhoaDuoc', 'PhongBenh', 'KhoaNgoai', 'KhoaPhucVu')]
2020-03-26 15:43:05,851 [1] DEBUG - Statement Id: [DAO00212_DEP04_GetListByID] PreparedStatement : [SELECT * FROM TM_PHONGBAN_KHODUOC WHERE PHONGBAN_ID = '6' AND BENHVIEN_ID ='01819']
2020-03-26 15:46:30,630 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'MTR04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 15:46:31,289 [1] DEBUG - Statement Id: [DAO00212_PHA63_DOITUONG_GetList] PreparedStatement : [SELECT DT.DOITUONG_ID AS CATEGORY_ID, DT.MADOITUONG AS CATEGORY_CODE, DT.TENDOITUONG AS CATEGORY_NAME, 1 AS FOLDER_LEVEL, 0 AS PARENT_ID, '0' AS IS_FOLDER        FROM TM_DOITUONG AS DT        WHERE DT.ACTIVE = '1' AND DT.BENHVIEN_ID = '01819' AND        DT.NHOMDICHVU IN (SELECT DICTIONARY_ID        FROM LST_DICTIONARY        where DICTIONARY_TYPE_CODE = 'nhomdoituong' and DICTIONARY_CODE = 'BHYT')]
2020-03-26 15:46:54,468 [1] DEBUG - Statement Id: [DAO00212_PHA63_DUOC_GetList] PreparedStatement : [SELECT D.DUOC_ID, DVT.TENDONVITINH, DGT.TYLE                , D.TENDUOCDAYDU AS TENDUOC        , ISNULL(LD.LOAIDUOC_ID,0) AS LOAIDUOC_ID, ISNULL(LD.TENLOAIDUOC,N'Nhóm khác') AS TENLOAIDUOC, DGT.DONGIA        , D.MADUOC        FROM TM_DUOC AS D        INNER JOIN TM_DONVITINH AS DVT ON DVT.DONVITINH_ID = D.DONVITINH_ID AND DVT.BENHVIEN_ID = '01819'        LEFT JOIN TM_HANGSANXUAT AS HSX ON HSX.HANGSANXUAT_ID = D.HANGSANXUAT_ID AND HSX.TAMNGUNG = '0' AND HSX.BENHVIEN_ID = '01819'        LEFT JOIN LST_DICTIONARY AS DIC ON DIC.DICTIONARY_ID = D.QUOCGIA_ID AND DIC.DICTIONARY_TYPE_CODE = 'QuocGia' AND DIC.ENABLED = '1'                LEFT JOIN TM_TENDUOC AS TD ON TD.TENDUOC_ID = D.TENDUOC_ID AND TD.TAMNGUNG = '0' AND TD.BENHVIEN_ID = '01819'        LEFT JOIN TM_DOITUONG_GIADUOC_TYLE AS DGT ON DGT.DOITUONG_ID = '2' AND DGT.DUOC_ID = D.DUOC_ID AND DGT.TAMNGUNG = '0' AND DGT.BENHVIEN_ID = '01819'        LEFT JOIN TM_LOAIDUOC AS LD ON LD.LOAIDUOC_ID = D.LOAIDUOC_ID AND LD.TAMNGUNG = '0' AND LD.BENHVIEN_ID = '01819'        WHERE D.BENHVIEN_ID = '01819' AND D.TAMNGUNG = '0' AND D.BHYT = '1']
2020-03-26 15:53:01,460 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '01819'               AND                   TM_SYS_SCREEN.PAGE = 'COM98'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-03-26 15:53:08,256 [1] DEBUG - Statement Id: [DAO00017_GetList] PreparedStatement : [select A.*, B.DICTIONARY_CODE from TM_PHONGBAN A            inner join LST_DICTIONARY B on A.LOAIPHONGBAN_ID = B.DICTIONARY_ID            and B.DICTIONARY_TYPE_CODE = 'LoaiPhongBan'            where A.BENHVIEN_ID = '01819' AND A.TAMNGUNG = '0'  order by A.TENPHONGBAN asc]
2020-03-26 15:53:08,850 [1] DEBUG - Statement Id: [DAO00020_ListKhoDuocOfPhongBan] PreparedStatement : [select B.* from TM_PHONGBAN_KHODUOC A        inner join TM_KHODUOC B on B.KHODUOC_ID = A.KHODUOC_ID        where        A.PHONGBAN_ID = '68'        and A.BENHVIEN_ID = '01819']
2020-03-26 15:53:18,952 [1] DEBUG - Statement Id: [DAO00020_ListKhoDuocOfPhongBan] PreparedStatement : [select B.* from TM_PHONGBAN_KHODUOC A        inner join TM_KHODUOC B on B.KHODUOC_ID = A.KHODUOC_ID        where        A.PHONGBAN_ID = '7'        and A.BENHVIEN_ID = '01819']
