--------------------------------------------------------------------------------
2019-08-16 10:00:30,795 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2019-08-16 10:00:31,072 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-08-16 10:00:31,111 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-08-16 10:00:31,841 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 10:00:32,192 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-08-16 10:00:41,152 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2019-08-16 10:00:41,177 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-08-16 10:00:44,297 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-08-16 10:00:44,397 [6] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-08-16 10:00:45,450 [6] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2019-08-16 10:00:45,705 [6] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2019-08-16 10:00:45,800 [6] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2019-08-16 10:00:45,876 [6] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2019-08-16 10:00:45,959 [6] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2019-08-16 10:00:46,038 [6] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2019-08-16 10:00:46,147 [6] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2019-08-16 10:00:46,311 [6] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2019-08-16 10:00:46,398 [6] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2019-08-16 10:00:46,910 [6] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2019-08-16 10:00:46,942 [6] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2019-08-16 10:00:47,034 [6] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2019-08-16 10:00:47,066 [6] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2019-08-16 10:00:47,856 [6] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2019-08-16 10:00:47,889 [6] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 0 as PHAMVI_ID, 0 as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0         end                else        begin        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2019-08-16 10:00:49,820 [6] DEBUG - Statement Id: [DAO00320_GetList] PreparedStatement : [select M.*            from TM_MAU M            LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID            where            M.TAMNGUNG = '0'            and M.BENHVIEN_ID = 'HLU01'            order by M.TENMAU]
2019-08-16 10:00:49,910 [6] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2019-08-16 10:00:49,943 [6] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT          TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,          TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,          SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH          FROM TT_MAU_TONKHO TK          JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID          JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID          JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'          LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID          LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID          WHERE TK.SOLUONG > 0          GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,          TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2019-08-16 10:00:50,017 [6] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2019-08-16 10:00:50,059 [6] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct          TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,          TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,          TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH          from TM_MAU M          JOIN          (          select          A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO          from          (          select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO          from TT_MAU_TONKHO TK          JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID          inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID          left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'          where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0          ) A          )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'          LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID          LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2019-08-16 10:00:50,134 [6] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2019-08-16 10:00:51,073 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 10:00:52,888 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2019-08-16 10:01:01,758 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2019-08-16 10:01:01,787 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2019-08-16 10:01:01,870 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 10:01:02,011 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 10:01:02,355 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2019-08-16 10:01:02,357 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-08-16 10:01:02,357 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-08-16 10:01:02,389 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2019-08-16 10:01:02,389 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-08-16 10:01:02,389 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-08-16 10:01:02,577 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 10:01:02,789 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 10:01:13,563 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 10:01:13,654 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2019-08-16 10:01:14,031 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2019-08-16 10:01:22,784 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'STA18'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 10:01:23,066 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM98'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 10:01:25,063 [1] DEBUG - Statement Id: [DAO00008_DeleteUserInvSettings] PreparedStatement : [delete TM_SYS_USERKHO          where HOSPITAL_ID =  @param0  and ACCOUNT_ID =  @param1]
2019-08-16 10:01:25,063 [1] DEBUG - Statement Id: [DAO00008_DeleteUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-08-16 10:01:25,063 [1] DEBUG - Statement Id: [DAO00008_DeleteUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-08-16 10:01:25,121 [1] DEBUG - Statement Id: [DAO00008_UpdateUserInvSettings] PreparedStatement : [insert into TM_SYS_USERKHO            (HOSPITAL_ID, ACCOUNT_ID, MODULE_ID, KHO_ID)          values            ( @param0 ,  @param1 ,  @param2 ,  @param3 )]
2019-08-16 10:01:25,121 [1] DEBUG - Statement Id: [DAO00008_UpdateUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113], @param2=[MODULE_ID,11709], @param3=[KHO_ID,3]]
2019-08-16 10:01:25,122 [1] DEBUG - Statement Id: [DAO00008_UpdateUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[Int64, System.Int64], @param3=[Int64, System.Int64]]
2019-08-16 10:01:31,355 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'STA06'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 10:01:31,964 [1] DEBUG - Statement Id: [DAO00400_GetList] PreparedStatement : [select *,ID AS HANGHOA_ID, MA AS MAHANGHOA, TEN AS TENHANGHOA from TM_PUR_HANGHOA where BENHVIEN_ID = 'HLU01'        order by TEN]
2019-08-16 10:01:33,473 [1] DEBUG - Statement Id: [DAO00401_INV001_GetDMNhanVien] PreparedStatement : [SELECT NHANVIEN_ID,TENNHANVIEN,NHANVIEN_ID AS NHANVIENNHAN_ID,TENNHANVIEN AS TENNHANVIENNHAN FROM [TM_NHANVIEN]        where BENHVIEN_ID = 'HLU01'        ORDER BY TENNHANVIEN]
2019-08-16 10:01:34,362 [1] DEBUG - Statement Id: [DAO00401_INV001_GetDMKHOVPP] PreparedStatement : [Select K.*,BB.SODU,BB.SODUDENNGAY,BB.KHOASO,BB.NGAYKHOA  From TM_KHO K        LEFT JOIN TM_INV_KHO BB ON K.MAKHO = BB.MAKHO        LEFT JOIN LST_DICTIONARY AA ON AA.DICTIONARY_ID = K.MODULE_ID        WHERE AA.DICTIONARY_CODE = 'KhoVPP']
2019-08-16 10:01:35,740 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 10:01:40,533 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'STA07'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 10:01:40,866 [1] DEBUG - Statement Id: [DAO00401_INV001_ChungTuXuatSearch] PreparedStatement : [select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/16/2019 10:01:40 AM' AND '8/16/2019 10:01:40 AM'        AND CT.MAKHOXUAT = 'KCVPP']
--------------------------------------------------------------------------------
2019-08-16 10:39:46,660 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2019-08-16 10:39:46,921 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-08-16 10:39:46,957 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-08-16 10:39:47,391 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 10:39:47,784 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-08-16 10:39:57,883 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2019-08-16 10:39:57,948 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-08-16 10:39:59,486 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-08-16 10:39:59,572 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-08-16 10:40:00,366 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2019-08-16 10:40:00,585 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2019-08-16 10:40:00,672 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2019-08-16 10:40:00,750 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2019-08-16 10:40:00,838 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2019-08-16 10:40:00,947 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2019-08-16 10:40:01,035 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2019-08-16 10:40:01,124 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2019-08-16 10:40:01,203 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2019-08-16 10:40:01,720 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2019-08-16 10:40:01,753 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2019-08-16 10:40:01,836 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2019-08-16 10:40:01,868 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2019-08-16 10:40:03,537 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2019-08-16 10:40:03,568 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 0 as PHAMVI_ID, 0 as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0         end                else        begin        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2019-08-16 10:40:07,247 [5] DEBUG - Statement Id: [DAO00320_GetList] PreparedStatement : [select M.*            from TM_MAU M            LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID            where            M.TAMNGUNG = '0'            and M.BENHVIEN_ID = 'HLU01'            order by M.TENMAU]
2019-08-16 10:40:07,328 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2019-08-16 10:40:07,362 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT          TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,          TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,          SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH          FROM TT_MAU_TONKHO TK          JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID          JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID          JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'          LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID          LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID          WHERE TK.SOLUONG > 0          GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,          TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2019-08-16 10:40:07,442 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2019-08-16 10:40:07,483 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct          TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,          TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,          TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH          from TM_MAU M          JOIN          (          select          A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO          from          (          select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO          from TT_MAU_TONKHO TK          JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID          inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID          left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'          where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0          ) A          )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'          LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID          LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2019-08-16 10:40:07,564 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2019-08-16 10:40:08,491 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 10:40:09,531 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2019-08-16 10:40:16,322 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2019-08-16 10:40:16,351 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2019-08-16 10:40:16,437 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 10:40:16,562 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 10:40:16,697 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2019-08-16 10:40:16,700 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-08-16 10:40:16,701 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-08-16 10:40:16,729 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2019-08-16 10:40:16,729 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-08-16 10:40:16,729 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-08-16 10:40:16,884 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 10:40:17,060 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 10:40:25,027 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 10:40:25,134 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2019-08-16 10:40:25,372 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2019-08-16 10:41:04,975 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'STA06'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 10:41:05,361 [1] DEBUG - Statement Id: [DAO00401_INV001_GetDMNhanVien] PreparedStatement : [SELECT NHANVIEN_ID,TENNHANVIEN,NHANVIEN_ID AS NHANVIENNHAN_ID,TENNHANVIEN AS TENNHANVIENNHAN FROM [TM_NHANVIEN]        where BENHVIEN_ID = 'HLU01'        ORDER BY TENNHANVIEN]
2019-08-16 10:41:06,199 [1] DEBUG - Statement Id: [DAO00401_INV001_GetDMKHOVPP] PreparedStatement : [Select K.*,BB.SODU,BB.SODUDENNGAY,BB.KHOASO,BB.NGAYKHOA  From TM_KHO K        LEFT JOIN TM_INV_KHO BB ON K.MAKHO = BB.MAKHO        LEFT JOIN LST_DICTIONARY AA ON AA.DICTIONARY_ID = K.MODULE_ID        WHERE AA.DICTIONARY_CODE = 'KhoVPP']
2019-08-16 10:41:07,067 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 10:41:10,686 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 10:41:25,858 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'STA05'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 10:41:26,622 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM98'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 10:41:27,149 [1] DEBUG - Statement Id: [DAO00401_INV001_PhieuYeuCauSearch] PreparedStatement : [select YC.PHIEUYEUCAU_ID,YC.MAPHIEUYEUCAU,YC.MMYY,YC.NGAYLAP,YC.PHONGBAN_ID,YC.TENPHONGBAN,YC.MAKHOXUAT,YC.TENKHOXUAT,YC.GHICHU,YC.TENNGUOITAO,YC.TENNGUOICAPNHAT,YC.BENHVIEN_ID,YC.NGAYTAO,YC.NGUOITAO_ID,YC.NGAYCAPNHAT,YC.NGUOICAPNHAT_ID        FROM TT_INV_PHIEUYEUCAU YC        WHERE YC.BENHVIEN_ID = 'HLU01' AND YC.NGAYLAP BETWEEN '7/16/2019 10:41:27 AM' AND '8/16/2019 10:41:27 AM'         AND           YC.CHUNGTUXUAT_ID IS NULL         AND           YC.MAKHOXUAT = 'KCVPP']
2019-08-16 10:41:33,721 [1] DEBUG - Statement Id: [DAO00401_INV001_PhieuYeuCauSearch] PreparedStatement : [select YC.PHIEUYEUCAU_ID,YC.MAPHIEUYEUCAU,YC.MMYY,YC.NGAYLAP,YC.PHONGBAN_ID,YC.TENPHONGBAN,YC.MAKHOXUAT,YC.TENKHOXUAT,YC.GHICHU,YC.TENNGUOITAO,YC.TENNGUOICAPNHAT,YC.BENHVIEN_ID,YC.NGAYTAO,YC.NGUOITAO_ID,YC.NGAYCAPNHAT,YC.NGUOICAPNHAT_ID        FROM TT_INV_PHIEUYEUCAU YC        WHERE YC.BENHVIEN_ID = 'HLU01' AND YC.NGAYLAP BETWEEN '4/1/2019 12:00:00 AM' AND '8/16/2019 10:41:27 AM'         AND           YC.CHUNGTUXUAT_ID IS NULL         AND           YC.MAKHOXUAT = 'KCVPP']
2019-08-16 10:41:43,003 [1] DEBUG - Statement Id: [DAO00401_INV001_GetPhieuYeuCauChiTiet_PhieuYeuCauID] PreparedStatement : [select YCCT.PHIEUYEUCAUCHITIET_ID,YCCT.HANGHOA_ID,YCCT.MAHANGHOA,YCCT.TENHANGHOA,YCCT.DONVITINH_ID,YCCT.TENDONVITINH,YCCT.SOLUONGYEUCAU,YCCT.SOLUONGDAXUAT        FROM TT_INV_PHIEUYEUCAUCHITIET YCCT        WHERE YCCT.BENHVIEN_ID = 'HLU01' AND YCCT.PHIEUYEUCAU_ID='21']
2019-08-16 10:41:43,335 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChiTietYC_MaPhieuYeuCau] PreparedStatement : [select YC.PHIEUYEUCAU_ID,YC.MAPHIEUYEUCAU,YC.MMYY,YC.NGAYLAP,YC.PHONGBAN_ID AS PHONGBANNHAN_ID,YC.TENPHONGBAN AS TENPHONGBANNHAN,YC.MAKHOXUAT,YC.TENKHOXUAT,        YCCT.PHIEUYEUCAUCHITIET_ID,YCCT.HANGHOA_ID,YCCT.MAHANGHOA,YCCT.TENHANGHOA,YCCT.DONVITINH_ID,YCCT.TENDONVITINH,YCCT.SOLUONGYEUCAU,YCCT.SOLUONGYEUCAU AS SOLUONGXUAT, NULL AS DONGIA,NULL AS LOSX,NULL AS HANDUNG,        TKTH.SOLUONGTONCUOI        FROM TT_INV_PHIEUYEUCAU YC INNER JOIN TT_INV_PHIEUYEUCAUCHITIET YCCT ON YC.PHIEUYEUCAU_ID=YCCT.PHIEUYEUCAU_ID        LEFT JOIN (SELECT (SOLUONGTONDAU+SOLUONGNHAP-SOLUONGXUAT) AS SOLUONGTONCUOI, HANGHOA_ID,MAKHO        FROM TT_INV_TONKHOTONGHOP WHERE BENHVIEN_ID='HLU01' AND MMYY='0819'        ) TKTH ON YCCT.HANGHOA_ID = TKTH.HANGHOA_ID AND YC.MAKHOXUAT = TKTH.MAKHO        WHERE YC.MAPHIEUYEUCAU='YC5190525070426' AND YC.BENHVIEN_ID = 'HLU01']
2019-08-16 10:52:01,068 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'OPD08'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 10:52:10,629 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN190530.0000018']
2019-08-16 10:52:10,868 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"5336","DVYEUCAU_ID":"193101"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"5336","DVYEUCAU_ID":"193101"}' order by ID desc)        order by A.ID desc]
2019-08-16 10:52:11,440 [1] DEBUG - Statement Id: [DAO00080_GetThongTinNgoaiTruKhambenhBenhan] PreparedStatement : [select *        from TT_NGOAITRU_KHAMBENH_BENHAN where        TIEPNHAN_ID = '25265'        and DVYEUCAU_ID = '193101'        and BENHVIEN_ID = 'HLU01']
2019-08-16 10:52:12,267 [1] DEBUG - Statement Id: [DAO00092_TT_NGOAITRU_BENHAN_Getdata] PreparedStatement : [select *        from TT_NGOAITRU_BENHAN        where TIEPNHAN_ID = '25265']
2019-08-16 10:52:12,297 [1] DEBUG - Statement Id: [DAO00067_GetLastSinhhieuNgoaiTruTiepNhan] PreparedStatement : [select top 1 *          from TT_NGOAITRU_KHAMBENH_SINHHIEU          where          TIEPNHAN_ID = '25265'          order by KHAMBENH_SINHHIEU_ID desc]
2019-08-16 10:54:29,069 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN190530.0000018']
2019-08-16 10:54:29,167 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"5485","DVYEUCAU_ID":"193099"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"5485","DVYEUCAU_ID":"193099"}' order by ID desc)        order by A.ID desc]
2019-08-16 10:55:13,006 [1] DEBUG - Statement Id: [DAO00080_GetThongTinNgoaiTruKhambenhBenhan] PreparedStatement : [select *        from TT_NGOAITRU_KHAMBENH_BENHAN where        TIEPNHAN_ID = '25265'        and DVYEUCAU_ID = '193099'        and BENHVIEN_ID = 'HLU01']
--------------------------------------------------------------------------------
2019-08-16 10:55:39,329 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2019-08-16 10:55:39,705 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-08-16 10:55:39,741 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-08-16 10:55:40,217 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 10:55:40,476 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-08-16 10:55:46,871 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2019-08-16 10:55:46,897 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-08-16 10:55:48,552 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-08-16 10:55:48,636 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-08-16 10:55:49,502 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2019-08-16 10:55:49,717 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2019-08-16 10:55:49,802 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2019-08-16 10:55:49,883 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2019-08-16 10:55:49,970 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2019-08-16 10:55:50,050 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2019-08-16 10:55:50,143 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2019-08-16 10:55:50,229 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2019-08-16 10:55:50,323 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2019-08-16 10:55:50,843 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2019-08-16 10:55:50,877 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2019-08-16 10:55:50,957 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2019-08-16 10:55:51,002 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2019-08-16 10:55:51,839 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2019-08-16 10:55:51,872 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 0 as PHAMVI_ID, 0 as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0         end                else        begin        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2019-08-16 10:55:53,839 [5] DEBUG - Statement Id: [DAO00320_GetList] PreparedStatement : [select M.*            from TM_MAU M            LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID            where            M.TAMNGUNG = '0'            and M.BENHVIEN_ID = 'HLU01'            order by M.TENMAU]
2019-08-16 10:55:53,932 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2019-08-16 10:55:53,965 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT          TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,          TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,          SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH          FROM TT_MAU_TONKHO TK          JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID          JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID          JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'          LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID          LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID          WHERE TK.SOLUONG > 0          GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,          TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2019-08-16 10:55:54,044 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2019-08-16 10:55:54,078 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct          TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,          TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,          TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH          from TM_MAU M          JOIN          (          select          A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO          from          (          select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO          from TT_MAU_TONKHO TK          JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID          inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID          left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'          where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0          ) A          )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'          LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID          LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2019-08-16 10:55:54,164 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2019-08-16 10:55:55,183 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 10:55:56,143 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2019-08-16 10:56:02,590 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2019-08-16 10:56:02,619 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2019-08-16 10:56:02,705 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 10:56:02,832 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 10:56:02,970 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2019-08-16 10:56:02,971 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-08-16 10:56:02,971 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-08-16 10:56:02,998 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2019-08-16 10:56:02,998 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-08-16 10:56:02,998 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-08-16 10:56:03,156 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 10:56:03,321 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 10:56:10,980 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 10:56:11,074 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2019-08-16 10:56:11,366 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2019-08-16 10:56:15,697 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM98'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 10:56:16,513 [1] DEBUG - Statement Id: [DAO00020_ListKhoDuocOfPhongBan] PreparedStatement : [select B.* from TM_PHONGBAN_KHODUOC A        inner join TM_KHODUOC B on B.KHODUOC_ID = A.KHODUOC_ID        where        A.PHONGBAN_ID = '18'        and A.BENHVIEN_ID = 'HLU01']
2019-08-16 10:56:19,617 [1] DEBUG - Statement Id: [DAO00020_ListKhoDuocOfPhongBan] PreparedStatement : [select B.* from TM_PHONGBAN_KHODUOC A        inner join TM_KHODUOC B on B.KHODUOC_ID = A.KHODUOC_ID        where        A.PHONGBAN_ID = '61'        and A.BENHVIEN_ID = 'HLU01']
2019-08-16 10:56:19,799 [1] DEBUG - Statement Id: [DAO00008_UpdateUserIdPhongBanKhoDuoc] PreparedStatement : [IF EXISTS            (SELECT ACCOUNT_ID FROM TM_SYS_USERS WHERE ACCOUNT_ID =  @param0  and HOSPITAL_ID =  @param1 )            BEGIN            update TM_SYS_USERS set INVENTORY_ID =  @param2 , WORKING_DEPT_ID =  @param3             WHERE ACCOUNT_ID =  @param0  and HOSPITAL_ID =  @param1             END            ELSE            BEGIN            insert into TM_SYS_USERS ([ACCOUNT_ID], [ACCOUNT_NAME], [INVENTORY_ID], [WORKING_DEPT_ID], [HOSPITAL_ID])            values ( @param0 ,  @param4 ,  @param2 ,  @param3 ,  @param1 )            END]
2019-08-16 10:56:19,799 [1] DEBUG - Statement Id: [DAO00008_UpdateUserIdPhongBanKhoDuoc] Parameters: [@param0=[ACCOUNT_ID,113], @param1=[HOSPITAL_ID,HLU01], @param2=[INVENTORY_ID,null], @param3=[WORKING_DEPT_ID,61], @param4=[ACCOUNT_NAME,admin]]
2019-08-16 10:56:19,799 [1] DEBUG - Statement Id: [DAO00008_UpdateUserIdPhongBanKhoDuoc] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[String, System.String]]
2019-08-16 10:56:26,577 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'OPD08'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 10:56:32,256 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN190604.0000170']
2019-08-16 10:56:32,421 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"5436","DVYEUCAU_ID":"204130"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"5436","DVYEUCAU_ID":"204130"}' order by ID desc)        order by A.ID desc]
2019-08-16 10:56:45,087 [1] DEBUG - Statement Id: [DAO00080_GetThongTinNgoaiTruKhambenhBenhan] PreparedStatement : [select *        from TT_NGOAITRU_KHAMBENH_BENHAN where        TIEPNHAN_ID = '27296'        and DVYEUCAU_ID = '204130'        and BENHVIEN_ID = 'HLU01']
2019-08-16 10:56:56,936 [1] DEBUG - Statement Id: [DAO00092_TT_NGOAITRU_BENHAN_Getdata] PreparedStatement : [select *        from TT_NGOAITRU_BENHAN        where TIEPNHAN_ID = '27296']
2019-08-16 10:57:05,789 [1] DEBUG - Statement Id: [DAO00067_GetLastSinhhieuNgoaiTruTiepNhan] PreparedStatement : [select top 1 *          from TT_NGOAITRU_KHAMBENH_SINHHIEU          where          TIEPNHAN_ID = '27296'          order by KHAMBENH_SINHHIEU_ID desc]
2019-08-16 11:06:59,114 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'STA06'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 11:06:59,708 [1] DEBUG - Statement Id: [DAO00401_INV001_GetDMNhanVien] PreparedStatement : [SELECT NHANVIEN_ID,TENNHANVIEN,NHANVIEN_ID AS NHANVIENNHAN_ID,TENNHANVIEN AS TENNHANVIENNHAN FROM [TM_NHANVIEN]        where BENHVIEN_ID = 'HLU01'        ORDER BY TENNHANVIEN]
2019-08-16 11:07:00,256 [1] DEBUG - Statement Id: [DAO00401_INV001_GetDMKHOVPP] PreparedStatement : [Select K.*,BB.SODU,BB.SODUDENNGAY,BB.KHOASO,BB.NGAYKHOA  From TM_KHO K        LEFT JOIN TM_INV_KHO BB ON K.MAKHO = BB.MAKHO        LEFT JOIN LST_DICTIONARY AA ON AA.DICTIONARY_ID = K.MODULE_ID        WHERE AA.DICTIONARY_CODE = 'KhoVPP']
2019-08-16 11:07:00,940 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 11:07:03,116 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'STA05'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 11:07:03,307 [1] DEBUG - Statement Id: [DAO00401_INV001_PhieuYeuCauSearch] PreparedStatement : [select YC.PHIEUYEUCAU_ID,YC.MAPHIEUYEUCAU,YC.MMYY,YC.NGAYLAP,YC.PHONGBAN_ID,YC.TENPHONGBAN,YC.MAKHOXUAT,YC.TENKHOXUAT,YC.GHICHU,YC.TENNGUOITAO,YC.TENNGUOICAPNHAT,YC.BENHVIEN_ID,YC.NGAYTAO,YC.NGUOITAO_ID,YC.NGAYCAPNHAT,YC.NGUOICAPNHAT_ID        FROM TT_INV_PHIEUYEUCAU YC        WHERE YC.BENHVIEN_ID = 'HLU01' AND YC.NGAYLAP BETWEEN '7/16/2019 11:07:03 AM' AND '8/16/2019 11:07:03 AM'         AND           YC.CHUNGTUXUAT_ID IS NULL         AND           YC.MAKHOXUAT = 'KCVPP']
2019-08-16 11:07:07,638 [1] DEBUG - Statement Id: [DAO00401_INV001_PhieuYeuCauSearch] PreparedStatement : [select YC.PHIEUYEUCAU_ID,YC.MAPHIEUYEUCAU,YC.MMYY,YC.NGAYLAP,YC.PHONGBAN_ID,YC.TENPHONGBAN,YC.MAKHOXUAT,YC.TENKHOXUAT,YC.GHICHU,YC.TENNGUOITAO,YC.TENNGUOICAPNHAT,YC.BENHVIEN_ID,YC.NGAYTAO,YC.NGUOITAO_ID,YC.NGAYCAPNHAT,YC.NGUOICAPNHAT_ID        FROM TT_INV_PHIEUYEUCAU YC        WHERE YC.BENHVIEN_ID = 'HLU01' AND YC.NGAYLAP BETWEEN '7/1/2019 12:00:00 AM' AND '8/16/2019 11:07:03 AM'         AND           YC.CHUNGTUXUAT_ID IS NULL         AND           YC.MAKHOXUAT = 'KCVPP']
2019-08-16 11:07:11,545 [1] DEBUG - Statement Id: [DAO00401_INV001_PhieuYeuCauSearch] PreparedStatement : [select YC.PHIEUYEUCAU_ID,YC.MAPHIEUYEUCAU,YC.MMYY,YC.NGAYLAP,YC.PHONGBAN_ID,YC.TENPHONGBAN,YC.MAKHOXUAT,YC.TENKHOXUAT,YC.GHICHU,YC.TENNGUOITAO,YC.TENNGUOICAPNHAT,YC.BENHVIEN_ID,YC.NGAYTAO,YC.NGUOITAO_ID,YC.NGAYCAPNHAT,YC.NGUOICAPNHAT_ID        FROM TT_INV_PHIEUYEUCAU YC        WHERE YC.BENHVIEN_ID = 'HLU01' AND YC.NGAYLAP BETWEEN '5/1/2019 12:00:00 AM' AND '8/16/2019 11:07:03 AM'         AND           YC.CHUNGTUXUAT_ID IS NULL         AND           YC.MAKHOXUAT = 'KCVPP']
2019-08-16 11:07:12,611 [1] DEBUG - Statement Id: [DAO00401_INV001_GetPhieuYeuCauChiTiet_PhieuYeuCauID] PreparedStatement : [select YCCT.PHIEUYEUCAUCHITIET_ID,YCCT.HANGHOA_ID,YCCT.MAHANGHOA,YCCT.TENHANGHOA,YCCT.DONVITINH_ID,YCCT.TENDONVITINH,YCCT.SOLUONGYEUCAU,YCCT.SOLUONGDAXUAT        FROM TT_INV_PHIEUYEUCAUCHITIET YCCT        WHERE YCCT.BENHVIEN_ID = 'HLU01' AND YCCT.PHIEUYEUCAU_ID='21']
2019-08-16 11:07:12,897 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChiTietYC_MaPhieuYeuCau] PreparedStatement : [select YC.PHIEUYEUCAU_ID,YC.MAPHIEUYEUCAU,YC.MMYY,YC.NGAYLAP,YC.PHONGBAN_ID AS PHONGBANNHAN_ID,YC.TENPHONGBAN AS TENPHONGBANNHAN,YC.MAKHOXUAT,YC.TENKHOXUAT,        YCCT.PHIEUYEUCAUCHITIET_ID,YCCT.HANGHOA_ID,YCCT.MAHANGHOA,YCCT.TENHANGHOA,YCCT.DONVITINH_ID,YCCT.TENDONVITINH,YCCT.SOLUONGYEUCAU,YCCT.SOLUONGYEUCAU AS SOLUONGXUAT, NULL AS DONGIA,NULL AS LOSX,NULL AS HANDUNG,        TKTH.SOLUONGTONCUOI        FROM TT_INV_PHIEUYEUCAU YC INNER JOIN TT_INV_PHIEUYEUCAUCHITIET YCCT ON YC.PHIEUYEUCAU_ID=YCCT.PHIEUYEUCAU_ID        LEFT JOIN (SELECT (SOLUONGTONDAU+SOLUONGNHAP-SOLUONGXUAT) AS SOLUONGTONCUOI, HANGHOA_ID,MAKHO        FROM TT_INV_TONKHOTONGHOP WHERE BENHVIEN_ID='HLU01' AND MMYY='0819'        ) TKTH ON YCCT.HANGHOA_ID = TKTH.HANGHOA_ID AND YC.MAKHOXUAT = TKTH.MAKHO        WHERE YC.MAPHIEUYEUCAU='YC5190525070426' AND YC.BENHVIEN_ID = 'HLU01']
2019-08-16 11:07:17,014 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 11:07:21,881 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 11:07:21,943 [1] DEBUG - Statement Id: [DAO00401_INV001_GetTonKho] PreparedStatement : [SELECT TKTH.HANGHOA_ID,TKTH.MAHANGHOA,TKTH.TENHANGHOA,HH.DONVITINH_ID,HH.TENDONVITINH,SUM(TKTH.SOLUONGTONDAU+TKTH.SOLUONGNHAP-TKTH.SOLUONGXUAT) AS SOLUONGTONCUOI        FROM TM_PUR_HANGHOA HH INNER JOIN TT_INV_TONKHOTONGHOP TKTH ON HH.ID = TKTH.HANGHOA_ID        where TKTH.BENHVIEN_ID = 'HLU01' AND TKTH.MAKHO = 'KCVPP' AND TKTH.MMYY='0819'        GROUP BY TKTH.HANGHOA_ID,TKTH.MAHANGHOA,TKTH.TENHANGHOA,HH.DONVITINH_ID,HH.TENDONVITINH]
2019-08-16 11:07:43,533 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'STA08'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 11:07:43,732 [1] DEBUG - Statement Id: [DAO00401_INV001_GetDMKHOVPP] PreparedStatement : [Select K.*,BB.SODU,BB.SODUDENNGAY,BB.KHOASO,BB.NGAYKHOA  From TM_KHO K        LEFT JOIN TM_INV_KHO BB ON K.MAKHO = BB.MAKHO        LEFT JOIN LST_DICTIONARY AA ON AA.DICTIONARY_ID = K.MODULE_ID        WHERE AA.DICTIONARY_CODE = 'KhoVPP']
2019-08-16 11:07:43,766 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = '' AND BENHVIEN_ID = 'HLU01']
2019-08-16 11:07:49,059 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 11:07:49,092 [1] DEBUG - Statement Id: [DAO00401_INV001_TinhSoDuDauKy] PreparedStatement : [UPDATE TT_INV_TONKHOCHITIET SET SOLUONGTONDAU=0 WHERE MMYY='0819' AND MAKHO IN('KCVPP');        MERGE TT_INV_TONKHOCHITIET AS X USING (        SELECT TK.MMYY, TK.MAKHO,TK.TENKHO,TK.THEODOI_ID,SUM(TK.SOLUONGTONDAU+TK.SOLUONGNHAP-TK.SOLUONGXUAT) AS SOLUONGTONDAU        FROM                (SELECT '0819' AS MMYY, A.MAKHO,A.TENKHO,B.THEODOI_ID,A.SOLUONGTONDAU,0 AS SOLUONGNHAP,0 AS SOLUONGXUAT,B.NGAYTAO,B.NGUOITAO_ID        FROM TT_INV_TONKHOCHITIET A INNER JOIN TT_INV_THEODOI B ON A.THEODOI_ID=B.THEODOI_ID AND A.MMYY='0719'        WHERE A.MMYY='0719' AND A.BENHVIEN_ID='HLU01' AND A.MAKHO IN('KCVPP')        UNION ALL                SELECT '0819' AS MMYY, A.MAKHOXUAT AS MAKHO,A.TENKHOXUAT AS TENKHO,B.THEODOI_ID,0 AS SOLUONGTONDAU,0 AS SOLUONGNHAP,B.SOLUONGXUAT,C.NGAYTAO,C.NGUOITAO_ID        FROM TT_INV_CHUNGTUXUAT A INNER JOIN TT_INV_CHUNGTUXUATCHITIET B ON A.CHUNGTUXUAT_ID=B.CHUNGTUXUAT_ID AND A.MMYY='0719'        INNER JOIN TT_INV_THEODOI C ON B.THEODOI_ID=C.THEODOI_ID        WHERE A.MMYY='0719' AND A.BENHVIEN_ID='HLU01' AND A.MAKHOXUAT IN('KCVPP')        UNION ALL        SELECT '0819' AS MMYY, A.MAKHO,A.TENKHO,B.THEODOI_ID,0 AS SOLUONGTONDAU,0 AS SOLUONGNHAP,B.SOLUONG AS SOLUONGXUAT,C.NGAYTAO,C.NGUOITAO_ID        FROM TT_INV_CHUNGTUTANGGIAM A INNER JOIN TT_INV_CHUNGTUTANGGIAMCHITIET B ON A.CHUNGTUTANGGIAM_ID=B.CHUNGTUTANGGIAM_ID AND A.MMYY='0719' AND A.LOAI='giam'        INNER JOIN TT_INV_THEODOI C ON B.THEODOI_ID=C.THEODOI_ID        WHERE A.MMYY='0719' AND A.LOAI='giam' AND A.BENHVIEN_ID='HLU01' AND A.MAKHO IN('KCVPP')        UNION ALL                SELECT '0819' AS MMYY, A.MAKHO,A.TENKHO,B.THEODOI_ID,0 AS SOLUONGTONDAU,B.SOLUONGNHAP,0 AS SOLUONGXUAT,C.NGAYTAO,C.NGUOITAO_ID        FROM TT_INV_CHUNGTUNHAP A INNER JOIN TT_INV_CHUNGTUNHAPCHITIET B ON A.CHUNGTUNHAP_ID=B.CHUNGTUNHAP_ID AND A.MMYY='0719'        INNER JOIN TT_INV_THEODOI C ON B.THEODOI_ID=C.THEODOI_ID        WHERE A.MMYY='0719' AND A.MATRANGTHAI='DaNhapKho' AND A.BENHVIEN_ID='HLU01' AND A.MAKHO IN('KCVPP')        UNION ALL        SELECT '0819' AS MMYY, A.MAKHO,A.TENKHO,B.THEODOI_ID,0 AS SOLUONGTONDAU,B.SOLUONG AS SOLUONGNHAP,0 AS SOLUONGXUAT,C.NGAYTAO,C.NGUOITAO_ID        FROM TT_INV_CHUNGTUTANGGIAM A INNER JOIN TT_INV_CHUNGTUTANGGIAMCHITIET B ON A.CHUNGTUTANGGIAM_ID=B.CHUNGTUTANGGIAM_ID AND A.MMYY='0719' AND A.LOAI='tang'        INNER JOIN TT_INV_THEODOI C ON B.THEODOI_ID=C.THEODOI_ID        WHERE A.MMYY='0719' AND A.LOAI='tang' AND A.BENHVIEN_ID='HLU01' AND A.MAKHO IN('KCVPP')        ) TK GROUP BY TK.MMYY, TK.MAKHO,TK.TENKHO,TK.THEODOI_ID) AS Y     ON (X.MMYY=Y.MMYY AND X.MAKHO=Y.MAKHO AND X.THEODOI_ID=Y.THEODOI_ID)             WHEN MATCHED THEN UPDATE SET X.SOLUONGTONDAU=Y.SOLUONGTONDAU        WHEN NOT MATCHED THEN             INSERT (MMYY,MAKHO,TENKHO,THEODOI_ID,SOLUONGTONDAU,BENHVIEN_ID,NGAYTAO,NGUOITAO_ID) VALUES        ('0819',Y.MAKHO,Y.TENKHO,Y.THEODOI_ID,Y.SOLUONGTONDAU, @param0 ,GETDATE(),'');          UPDATE TT_INV_TONKHOTONGHOP SET SOLUONGTONDAU=0,SOLUONGNHAP=0,SOLUONGXUAT=0 WHERE MMYY='0819' AND MAKHO IN('KCVPP');        MERGE TT_INV_TONKHOTONGHOP AS X USING        (SELECT '0819' AS MMYY,A.MAKHO,A.TENKHO,B.HANGHOA_ID,B.MAHANGHOA,HH.TEN,SUM(A.SOLUONGTONDAU) AS SOLUONGTONDAU,SUM(A.SOLUONGNHAP) AS SOLUONGNHAP,SUM(A.SOLUONGXUAT) AS SOLUONGXUAT        FROM TT_INV_TONKHOCHITIET A INNER JOIN TT_INV_THEODOI B ON A.THEODOI_ID=B.THEODOI_ID AND A.MMYY='0819'     JOIN TM_PUR_HANGHOA HH on HH.ID = B.HANGHOA_ID          WHERE A.MMYY='0819' AND A.BENHVIEN_ID='HLU01' AND A.MAKHO IN('KCVPP')        GROUP BY A.MAKHO,A.TENKHO,B.HANGHOA_ID,B.MAHANGHOA,HH.TEN) AS Y        ON (X.MMYY=Y.MMYY AND X.MAKHO=Y.MAKHO AND X.HANGHOA_ID=Y.HANGHOA_ID)        WHEN MATCHED THEN UPDATE SET X.SOLUONGTONDAU=Y.SOLUONGTONDAU, X.SOLUONGNHAP=Y.SOLUONGNHAP,X.SOLUONGXUAT=Y.SOLUONGXUAT        WHEN NOT MATCHED THEN        INSERT (MMYY,MAKHO,TENKHO,HANGHOA_ID,MAHANGHOA,TENHANGHOA,SOLUONGTONDAU,SOLUONGNHAP,SOLUONGXUAT,BENHVIEN_ID,NGAYTAO)        VALUES ('0819',Y.MAKHO,Y.TENKHO,Y.HANGHOA_ID,Y.MAHANGHOA,Y.TEN,Y.SOLUONGTONDAU,Y.SOLUONGNHAP,Y.SOLUONGXUAT, @param0 ,GETDATE());          DELETE FROM TT_INV_TONKHOCHITIET WHERE SOLUONGTONDAU=0 AND SOLUONGNHAP=0 AND SOLUONGXUAT=0;        DELETE FROM TT_INV_TONKHOTONGHOP WHERE SOLUONGTONDAU=0 AND SOLUONGNHAP=0 AND SOLUONGXUAT=0;]
2019-08-16 11:07:49,092 [1] DEBUG - Statement Id: [DAO00401_INV001_TinhSoDuDauKy] Parameters: [@param0=[BENHVIEN_ID,HLU01]]
2019-08-16 11:07:49,092 [1] DEBUG - Statement Id: [DAO00401_INV001_TinhSoDuDauKy] Types: [@param0=[String, System.String]]
2019-08-16 11:07:49,751 [1] DEBUG - Statement Id: [DAO00401_INV001_SoDuDMKho] PreparedStatement : [MERGE TM_INV_KHO AS X USING (        SELECT AA.MAKHO,AA.TENKHO, @param0  AS SODU, @param1  AS SODUDENNGAY        FROM TM_KHO AA LEFT JOIN TM_INV_KHO BB ON AA.MAKHO = BB.MAKHO        WHERE AA.MAKHO IN('KCVPP')) AS Y        ON (X.MAKHO=Y.MAKHO)        WHEN MATCHED THEN UPDATE SET X.SODU= @param0 ,X.SODUDENNGAY= @param1 ,X.NGUOICAPNHAT_ID= @param2         WHEN NOT MATCHED THEN        INSERT (MAKHO,TENKHO,SODU,SODUDENNGAY,BENHVIEN_ID,NGAYTAO,NGUOITAO_ID) VALUES        (Y.MAKHO,Y.TENKHO,Y.SODU,Y.SODUDENNGAY, @param3 ,GETDATE(), @param2 );]
2019-08-16 11:07:49,752 [1] DEBUG - Statement Id: [DAO00401_INV001_SoDuDMKho] Parameters: [@param0=[SODU,Số dư đến 01/08/2019], @param1=[SODUDENNGAY,8/1/2019 12:00:00 AM], @param2=[NGUOITAO_ID,1], @param3=[BENHVIEN_ID,HLU01]]
2019-08-16 11:07:49,752 [1] DEBUG - Statement Id: [DAO00401_INV001_SoDuDMKho] Types: [@param0=[String, System.String], @param1=[DateTime, System.DateTime], @param2=[Int64, System.Int64], @param3=[String, System.String]]
2019-08-16 11:07:49,988 [1] DEBUG - Statement Id: [DAO00401_INV001_GetDMKHOVPP] PreparedStatement : [Select K.*,BB.SODU,BB.SODUDENNGAY,BB.KHOASO,BB.NGAYKHOA  From TM_KHO K        LEFT JOIN TM_INV_KHO BB ON K.MAKHO = BB.MAKHO        LEFT JOIN LST_DICTIONARY AA ON AA.DICTIONARY_ID = K.MODULE_ID        WHERE AA.DICTIONARY_CODE = 'KhoVPP']
2019-08-16 11:07:58,728 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 11:07:58,769 [1] DEBUG - Statement Id: [DAO00401_INV001_GetTonKho] PreparedStatement : [SELECT TKTH.HANGHOA_ID,TKTH.MAHANGHOA,TKTH.TENHANGHOA,HH.DONVITINH_ID,HH.TENDONVITINH,SUM(TKTH.SOLUONGTONDAU+TKTH.SOLUONGNHAP-TKTH.SOLUONGXUAT) AS SOLUONGTONCUOI        FROM TM_PUR_HANGHOA HH INNER JOIN TT_INV_TONKHOTONGHOP TKTH ON HH.ID = TKTH.HANGHOA_ID        where TKTH.BENHVIEN_ID = 'HLU01' AND TKTH.MAKHO = 'KCVPP' AND TKTH.MMYY='0819'        GROUP BY TKTH.HANGHOA_ID,TKTH.MAHANGHOA,TKTH.TENHANGHOA,HH.DONVITINH_ID,HH.TENDONVITINH]
2019-08-16 11:08:05,098 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 11:08:07,369 [1] DEBUG - Statement Id: [DAO00401_INV001_PhieuYeuCauSearch] PreparedStatement : [select YC.PHIEUYEUCAU_ID,YC.MAPHIEUYEUCAU,YC.MMYY,YC.NGAYLAP,YC.PHONGBAN_ID,YC.TENPHONGBAN,YC.MAKHOXUAT,YC.TENKHOXUAT,YC.GHICHU,YC.TENNGUOITAO,YC.TENNGUOICAPNHAT,YC.BENHVIEN_ID,YC.NGAYTAO,YC.NGUOITAO_ID,YC.NGAYCAPNHAT,YC.NGUOICAPNHAT_ID        FROM TT_INV_PHIEUYEUCAU YC        WHERE YC.BENHVIEN_ID = 'HLU01' AND YC.NGAYLAP BETWEEN '7/16/2019 11:08:07 AM' AND '8/16/2019 11:08:07 AM'         AND           YC.CHUNGTUXUAT_ID IS NULL         AND           YC.MAKHOXUAT = 'KCVPP']
2019-08-16 11:08:09,354 [1] DEBUG - Statement Id: [DAO00401_INV001_PhieuYeuCauSearch] PreparedStatement : [select YC.PHIEUYEUCAU_ID,YC.MAPHIEUYEUCAU,YC.MMYY,YC.NGAYLAP,YC.PHONGBAN_ID,YC.TENPHONGBAN,YC.MAKHOXUAT,YC.TENKHOXUAT,YC.GHICHU,YC.TENNGUOITAO,YC.TENNGUOICAPNHAT,YC.BENHVIEN_ID,YC.NGAYTAO,YC.NGUOITAO_ID,YC.NGAYCAPNHAT,YC.NGUOICAPNHAT_ID        FROM TT_INV_PHIEUYEUCAU YC        WHERE YC.BENHVIEN_ID = 'HLU01' AND YC.NGAYLAP BETWEEN '7/16/2019 11:08:07 AM' AND '8/16/2019 11:08:07 AM'         AND           YC.CHUNGTUXUAT_ID IS NULL         AND           YC.MAKHOXUAT = 'KCVPP']
2019-08-16 11:08:14,529 [1] DEBUG - Statement Id: [DAO00401_INV001_PhieuYeuCauSearch] PreparedStatement : [select YC.PHIEUYEUCAU_ID,YC.MAPHIEUYEUCAU,YC.MMYY,YC.NGAYLAP,YC.PHONGBAN_ID,YC.TENPHONGBAN,YC.MAKHOXUAT,YC.TENKHOXUAT,YC.GHICHU,YC.TENNGUOITAO,YC.TENNGUOICAPNHAT,YC.BENHVIEN_ID,YC.NGAYTAO,YC.NGUOITAO_ID,YC.NGAYCAPNHAT,YC.NGUOICAPNHAT_ID        FROM TT_INV_PHIEUYEUCAU YC        WHERE YC.BENHVIEN_ID = 'HLU01' AND YC.NGAYLAP BETWEEN '6/1/2019 12:00:00 AM' AND '8/16/2019 11:08:07 AM'         AND           YC.CHUNGTUXUAT_ID IS NULL         AND           YC.MAKHOXUAT = 'KCVPP']
2019-08-16 11:08:15,283 [1] DEBUG - Statement Id: [DAO00401_INV001_GetPhieuYeuCauChiTiet_PhieuYeuCauID] PreparedStatement : [select YCCT.PHIEUYEUCAUCHITIET_ID,YCCT.HANGHOA_ID,YCCT.MAHANGHOA,YCCT.TENHANGHOA,YCCT.DONVITINH_ID,YCCT.TENDONVITINH,YCCT.SOLUONGYEUCAU,YCCT.SOLUONGDAXUAT        FROM TT_INV_PHIEUYEUCAUCHITIET YCCT        WHERE YCCT.BENHVIEN_ID = 'HLU01' AND YCCT.PHIEUYEUCAU_ID='35']
2019-08-16 11:08:15,643 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChiTietYC_MaPhieuYeuCau] PreparedStatement : [select YC.PHIEUYEUCAU_ID,YC.MAPHIEUYEUCAU,YC.MMYY,YC.NGAYLAP,YC.PHONGBAN_ID AS PHONGBANNHAN_ID,YC.TENPHONGBAN AS TENPHONGBANNHAN,YC.MAKHOXUAT,YC.TENKHOXUAT,        YCCT.PHIEUYEUCAUCHITIET_ID,YCCT.HANGHOA_ID,YCCT.MAHANGHOA,YCCT.TENHANGHOA,YCCT.DONVITINH_ID,YCCT.TENDONVITINH,YCCT.SOLUONGYEUCAU,YCCT.SOLUONGYEUCAU AS SOLUONGXUAT, NULL AS DONGIA,NULL AS LOSX,NULL AS HANDUNG,        TKTH.SOLUONGTONCUOI        FROM TT_INV_PHIEUYEUCAU YC INNER JOIN TT_INV_PHIEUYEUCAUCHITIET YCCT ON YC.PHIEUYEUCAU_ID=YCCT.PHIEUYEUCAU_ID        LEFT JOIN (SELECT (SOLUONGTONDAU+SOLUONGNHAP-SOLUONGXUAT) AS SOLUONGTONCUOI, HANGHOA_ID,MAKHO        FROM TT_INV_TONKHOTONGHOP WHERE BENHVIEN_ID='HLU01' AND MMYY='0819'        ) TKTH ON YCCT.HANGHOA_ID = TKTH.HANGHOA_ID AND YC.MAKHOXUAT = TKTH.MAKHO        WHERE YC.MAPHIEUYEUCAU='YC25190603082813' AND YC.BENHVIEN_ID = 'HLU01']
2019-08-16 11:08:20,317 [1] DEBUG - Statement Id: [DAO00401_INV001_PhieuYeuCauSearch] PreparedStatement : [select YC.PHIEUYEUCAU_ID,YC.MAPHIEUYEUCAU,YC.MMYY,YC.NGAYLAP,YC.PHONGBAN_ID,YC.TENPHONGBAN,YC.MAKHOXUAT,YC.TENKHOXUAT,YC.GHICHU,YC.TENNGUOITAO,YC.TENNGUOICAPNHAT,YC.BENHVIEN_ID,YC.NGAYTAO,YC.NGUOITAO_ID,YC.NGAYCAPNHAT,YC.NGUOICAPNHAT_ID        FROM TT_INV_PHIEUYEUCAU YC        WHERE YC.BENHVIEN_ID = 'HLU01' AND YC.NGAYLAP BETWEEN '7/16/2019 11:08:20 AM' AND '8/16/2019 11:08:20 AM'         AND           YC.CHUNGTUXUAT_ID IS NULL         AND           YC.MAKHOXUAT = 'KCVPP']
2019-08-16 11:08:27,314 [1] DEBUG - Statement Id: [DAO00401_INV001_PhieuYeuCauSearch] PreparedStatement : [select YC.PHIEUYEUCAU_ID,YC.MAPHIEUYEUCAU,YC.MMYY,YC.NGAYLAP,YC.PHONGBAN_ID,YC.TENPHONGBAN,YC.MAKHOXUAT,YC.TENKHOXUAT,YC.GHICHU,YC.TENNGUOITAO,YC.TENNGUOICAPNHAT,YC.BENHVIEN_ID,YC.NGAYTAO,YC.NGUOITAO_ID,YC.NGAYCAPNHAT,YC.NGUOICAPNHAT_ID        FROM TT_INV_PHIEUYEUCAU YC        WHERE YC.BENHVIEN_ID = 'HLU01' AND YC.NGAYLAP BETWEEN '5/1/2019 12:00:00 AM' AND '8/16/2019 11:08:20 AM'         AND           YC.CHUNGTUXUAT_ID IS NULL         AND           YC.MAKHOXUAT = 'KCVPP']
2019-08-16 11:08:27,898 [1] DEBUG - Statement Id: [DAO00401_INV001_GetPhieuYeuCauChiTiet_PhieuYeuCauID] PreparedStatement : [select YCCT.PHIEUYEUCAUCHITIET_ID,YCCT.HANGHOA_ID,YCCT.MAHANGHOA,YCCT.TENHANGHOA,YCCT.DONVITINH_ID,YCCT.TENDONVITINH,YCCT.SOLUONGYEUCAU,YCCT.SOLUONGDAXUAT        FROM TT_INV_PHIEUYEUCAUCHITIET YCCT        WHERE YCCT.BENHVIEN_ID = 'HLU01' AND YCCT.PHIEUYEUCAU_ID='21']
2019-08-16 11:08:28,250 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChiTietYC_MaPhieuYeuCau] PreparedStatement : [select YC.PHIEUYEUCAU_ID,YC.MAPHIEUYEUCAU,YC.MMYY,YC.NGAYLAP,YC.PHONGBAN_ID AS PHONGBANNHAN_ID,YC.TENPHONGBAN AS TENPHONGBANNHAN,YC.MAKHOXUAT,YC.TENKHOXUAT,        YCCT.PHIEUYEUCAUCHITIET_ID,YCCT.HANGHOA_ID,YCCT.MAHANGHOA,YCCT.TENHANGHOA,YCCT.DONVITINH_ID,YCCT.TENDONVITINH,YCCT.SOLUONGYEUCAU,YCCT.SOLUONGYEUCAU AS SOLUONGXUAT, NULL AS DONGIA,NULL AS LOSX,NULL AS HANDUNG,        TKTH.SOLUONGTONCUOI        FROM TT_INV_PHIEUYEUCAU YC INNER JOIN TT_INV_PHIEUYEUCAUCHITIET YCCT ON YC.PHIEUYEUCAU_ID=YCCT.PHIEUYEUCAU_ID        LEFT JOIN (SELECT (SOLUONGTONDAU+SOLUONGNHAP-SOLUONGXUAT) AS SOLUONGTONCUOI, HANGHOA_ID,MAKHO        FROM TT_INV_TONKHOTONGHOP WHERE BENHVIEN_ID='HLU01' AND MMYY='0819'        ) TKTH ON YCCT.HANGHOA_ID = TKTH.HANGHOA_ID AND YC.MAKHOXUAT = TKTH.MAKHO        WHERE YC.MAPHIEUYEUCAU='YC5190525070426' AND YC.BENHVIEN_ID = 'HLU01']
2019-08-16 11:08:40,637 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'STA13'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 11:08:40,941 [1] DEBUG - Statement Id: [DAO00401_INV001_GetDMKHOVPP] PreparedStatement : [Select K.*,BB.SODU,BB.SODUDENNGAY,BB.KHOASO,BB.NGAYKHOA  From TM_KHO K        LEFT JOIN TM_INV_KHO BB ON K.MAKHO = BB.MAKHO        LEFT JOIN LST_DICTIONARY AA ON AA.DICTIONARY_ID = K.MODULE_ID        WHERE AA.DICTIONARY_CODE = 'KhoVPP']
2019-08-16 11:08:41,437 [1] DEBUG - Statement Id: [DAO00401_INV001_GetDMNhanVen] PreparedStatement : [SELECT AA.NHANVIEN_ID,AA.TENNHANVIEN,AA.CHUCVU_ID,BB.DICTIONARY_NAME AS TENCHUCVU        FROM TM_NHANVIEN AA LEFT JOIN LST_DICTIONARY BB ON AA.CHUCVU_ID=BB.DICTIONARY_ID AND BB.DICTIONARY_TYPE_CODE='ChucVu';]
2019-08-16 11:09:02,793 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RPT02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 11:09:04,229 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RPT01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 11:09:05,603 [1] DEBUG - Statement Id: [DAO00200_GetDetail] PreparedStatement : [select *              from TM_REPORT              where TM_REPORT.REPORT_CODE  = 'STA13' AND TM_REPORT.BENHVIEN_ID = 'HLU01']
2019-08-16 11:09:05,656 [1] DEBUG - Statement Id: [DAO00201_GetList] PreparedStatement : [select *              from TM_REPORT_DETAIL               where                             TM_REPORT_DETAIL.REPORT_CODE = 'STA13'                       and                           TM_REPORT_DETAIL.BENHVIEN_ID = 'HLU01'                                     order by PARAMETER_INDEX]
2019-08-16 11:09:05,689 [1] DEBUG - Statement Id: [DAO00203_GetList] PreparedStatement : [select *              from TM_REPORT_SUB_DEFINITION               where                             TM_REPORT_SUB_DEFINITION.REPORT_CODE = 'STA13'                       and                           TM_REPORT_SUB_DEFINITION.BENHVIEN_ID = 'HLU01'                                     order by REPORT_SUB_DEFINITION_ID]
2019-08-16 11:09:05,718 [1] DEBUG - Statement Id: [DAO00201_GetListByParentReportID] PreparedStatement : [select RD.*              from TM_REPORT AS R              INNER JOIN TM_REPORT_SUB_DEFINITION AS RS ON R.REPORT_CODE = RS.REPORT_CODE AND R.BENHVIEN_ID = RS.BENHVIEN_ID              INNER JOIN TM_REPORT_DETAIL AS RD ON RD.REPORT_CODE = RS.SUB_REPORT_CODE AND RD.BENHVIEN_ID = RS.BENHVIEN_ID              where R.REPORT_CODE  = 'STA13' AND R.BENHVIEN_ID = 'HLU01']
2019-08-16 11:09:05,905 [1] DEBUG - Statement Id: [DAO00203_GetListReportSubFileByReportID] PreparedStatement : [select R.*              from TM_REPORT_SUB_DEFINITION AS RS              inner join TM_REPORT AS R ON RS.SUB_REPORT_CODE = R.REPORT_CODE AND R.BENHVIEN_ID = RS.BENHVIEN_ID              where RS.REPORT_CODE = 'STA13' AND RS.BENHVIEN_ID = 'HLU01']
2019-08-16 11:09:05,957 [1] DEBUG - Statement Id: [DAO00204_GetListParameter] PreparedStatement : [SELECT SUBSTRING(p.name, 2, LEN(p.name) - 1) AS PARAMETER, p.parameter_id AS Idx, CONVERT(varchar(1),p.is_nullable) as Allow_Null              FROM sys.procedures sp              INNER JOIN sys.parameters p ON sp.object_id = p.object_id              WHERE sp.name = 'STA13P00301_CTKK'              ORDER BY p.parameter_id]
2019-08-16 11:09:06,027 [1] DEBUG - Statement Id: [DAO00204_GetReportData] PreparedStatement : [STA13P00301_CTKK]
2019-08-16 11:09:06,028 [1] DEBUG - Statement Id: [DAO00204_GetReportData] Parameters: [@NGAYKIEMKE=[PARAMETERS.NGAYKIEMKE,16/08/2019], @MABENHVIEN=[PARAMETERS.MABENHVIEN,HLU01]]
2019-08-16 11:09:06,028 [1] DEBUG - Statement Id: [DAO00204_GetReportData] Types: [@NGAYKIEMKE=[String, System.String], @MABENHVIEN=[String, System.String]]
2019-08-16 11:09:06,095 [1] DEBUG - Statement Id: [DAO00204_GetListParameter] PreparedStatement : [SELECT SUBSTRING(p.name, 2, LEN(p.name) - 1) AS PARAMETER, p.parameter_id AS Idx, CONVERT(varchar(1),p.is_nullable) as Allow_Null              FROM sys.procedures sp              INNER JOIN sys.parameters p ON sp.object_id = p.object_id              WHERE sp.name = 'STA13P00302_CTKK'              ORDER BY p.parameter_id]
2019-08-16 11:09:06,149 [1] DEBUG - Statement Id: [DAO00204_GetReportData] PreparedStatement : [STA13P00302_CTKK]
2019-08-16 11:09:06,149 [1] DEBUG - Statement Id: [DAO00204_GetReportData] Parameters: [@LISTNHANVIEN_ID=[PARAMETERS.LISTNHANVIEN_ID,1799], @MABENHVIEN=[PARAMETERS.MABENHVIEN,HLU01]]
2019-08-16 11:09:06,149 [1] DEBUG - Statement Id: [DAO00204_GetReportData] Types: [@LISTNHANVIEN_ID=[String, System.String], @MABENHVIEN=[String, System.String]]
2019-08-16 11:09:06,196 [1] DEBUG - Statement Id: [DAO00200_GetSettingReportPrinting] PreparedStatement : [SELECT DICTIONARY_CODE AS REPORT_CODE, DICTIONARY_NAME AS COMPUTER_NAME, DICTIONARY_NAME_EN AS NAME_PRINTER          FROM LST_DICTIONARY          WHERE BENHVIEN_ID = 'HLU01' AND ENABLED = '1' AND DICTIONARY_TYPE_CODE = 'Report_Printer_Setting'          AND DICTIONARY_CODE = 'STA13' AND DICTIONARY_NAME = 'GMC-HAIPN6']
2019-08-16 11:09:35,520 [1] DEBUG - Statement Id: [DAO00401_INV001_GetDMKHOVPP] PreparedStatement : [Select K.*,BB.SODU,BB.SODUDENNGAY,BB.KHOASO,BB.NGAYKHOA  From TM_KHO K        LEFT JOIN TM_INV_KHO BB ON K.MAKHO = BB.MAKHO        LEFT JOIN LST_DICTIONARY AA ON AA.DICTIONARY_ID = K.MODULE_ID        WHERE AA.DICTIONARY_CODE = 'KhoVPP']
2019-08-16 11:09:35,545 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 11:09:47,641 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0519' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 11:09:47,667 [1] DEBUG - Statement Id: [DAO00401_INV001_TinhSoDuDauKy] PreparedStatement : [UPDATE TT_INV_TONKHOCHITIET SET SOLUONGTONDAU=0 WHERE MMYY='0519' AND MAKHO IN('KCVPP');        MERGE TT_INV_TONKHOCHITIET AS X USING (        SELECT TK.MMYY, TK.MAKHO,TK.TENKHO,TK.THEODOI_ID,SUM(TK.SOLUONGTONDAU+TK.SOLUONGNHAP-TK.SOLUONGXUAT) AS SOLUONGTONDAU        FROM                (SELECT '0519' AS MMYY, A.MAKHO,A.TENKHO,B.THEODOI_ID,A.SOLUONGTONDAU,0 AS SOLUONGNHAP,0 AS SOLUONGXUAT,B.NGAYTAO,B.NGUOITAO_ID        FROM TT_INV_TONKHOCHITIET A INNER JOIN TT_INV_THEODOI B ON A.THEODOI_ID=B.THEODOI_ID AND A.MMYY='0419'        WHERE A.MMYY='0419' AND A.BENHVIEN_ID='HLU01' AND A.MAKHO IN('KCVPP')        UNION ALL                SELECT '0519' AS MMYY, A.MAKHOXUAT AS MAKHO,A.TENKHOXUAT AS TENKHO,B.THEODOI_ID,0 AS SOLUONGTONDAU,0 AS SOLUONGNHAP,B.SOLUONGXUAT,C.NGAYTAO,C.NGUOITAO_ID        FROM TT_INV_CHUNGTUXUAT A INNER JOIN TT_INV_CHUNGTUXUATCHITIET B ON A.CHUNGTUXUAT_ID=B.CHUNGTUXUAT_ID AND A.MMYY='0419'        INNER JOIN TT_INV_THEODOI C ON B.THEODOI_ID=C.THEODOI_ID        WHERE A.MMYY='0419' AND A.BENHVIEN_ID='HLU01' AND A.MAKHOXUAT IN('KCVPP')        UNION ALL        SELECT '0519' AS MMYY, A.MAKHO,A.TENKHO,B.THEODOI_ID,0 AS SOLUONGTONDAU,0 AS SOLUONGNHAP,B.SOLUONG AS SOLUONGXUAT,C.NGAYTAO,C.NGUOITAO_ID        FROM TT_INV_CHUNGTUTANGGIAM A INNER JOIN TT_INV_CHUNGTUTANGGIAMCHITIET B ON A.CHUNGTUTANGGIAM_ID=B.CHUNGTUTANGGIAM_ID AND A.MMYY='0419' AND A.LOAI='giam'        INNER JOIN TT_INV_THEODOI C ON B.THEODOI_ID=C.THEODOI_ID        WHERE A.MMYY='0419' AND A.LOAI='giam' AND A.BENHVIEN_ID='HLU01' AND A.MAKHO IN('KCVPP')        UNION ALL                SELECT '0519' AS MMYY, A.MAKHO,A.TENKHO,B.THEODOI_ID,0 AS SOLUONGTONDAU,B.SOLUONGNHAP,0 AS SOLUONGXUAT,C.NGAYTAO,C.NGUOITAO_ID        FROM TT_INV_CHUNGTUNHAP A INNER JOIN TT_INV_CHUNGTUNHAPCHITIET B ON A.CHUNGTUNHAP_ID=B.CHUNGTUNHAP_ID AND A.MMYY='0419'        INNER JOIN TT_INV_THEODOI C ON B.THEODOI_ID=C.THEODOI_ID        WHERE A.MMYY='0419' AND A.MATRANGTHAI='DaNhapKho' AND A.BENHVIEN_ID='HLU01' AND A.MAKHO IN('KCVPP')        UNION ALL        SELECT '0519' AS MMYY, A.MAKHO,A.TENKHO,B.THEODOI_ID,0 AS SOLUONGTONDAU,B.SOLUONG AS SOLUONGNHAP,0 AS SOLUONGXUAT,C.NGAYTAO,C.NGUOITAO_ID        FROM TT_INV_CHUNGTUTANGGIAM A INNER JOIN TT_INV_CHUNGTUTANGGIAMCHITIET B ON A.CHUNGTUTANGGIAM_ID=B.CHUNGTUTANGGIAM_ID AND A.MMYY='0419' AND A.LOAI='tang'        INNER JOIN TT_INV_THEODOI C ON B.THEODOI_ID=C.THEODOI_ID        WHERE A.MMYY='0419' AND A.LOAI='tang' AND A.BENHVIEN_ID='HLU01' AND A.MAKHO IN('KCVPP')        ) TK GROUP BY TK.MMYY, TK.MAKHO,TK.TENKHO,TK.THEODOI_ID) AS Y     ON (X.MMYY=Y.MMYY AND X.MAKHO=Y.MAKHO AND X.THEODOI_ID=Y.THEODOI_ID)             WHEN MATCHED THEN UPDATE SET X.SOLUONGTONDAU=Y.SOLUONGTONDAU        WHEN NOT MATCHED THEN             INSERT (MMYY,MAKHO,TENKHO,THEODOI_ID,SOLUONGTONDAU,BENHVIEN_ID,NGAYTAO,NGUOITAO_ID) VALUES        ('0519',Y.MAKHO,Y.TENKHO,Y.THEODOI_ID,Y.SOLUONGTONDAU, @param0 ,GETDATE(),'');          UPDATE TT_INV_TONKHOTONGHOP SET SOLUONGTONDAU=0,SOLUONGNHAP=0,SOLUONGXUAT=0 WHERE MMYY='0519' AND MAKHO IN('KCVPP');        MERGE TT_INV_TONKHOTONGHOP AS X USING        (SELECT '0519' AS MMYY,A.MAKHO,A.TENKHO,B.HANGHOA_ID,B.MAHANGHOA,HH.TEN,SUM(A.SOLUONGTONDAU) AS SOLUONGTONDAU,SUM(A.SOLUONGNHAP) AS SOLUONGNHAP,SUM(A.SOLUONGXUAT) AS SOLUONGXUAT        FROM TT_INV_TONKHOCHITIET A INNER JOIN TT_INV_THEODOI B ON A.THEODOI_ID=B.THEODOI_ID AND A.MMYY='0519'     JOIN TM_PUR_HANGHOA HH on HH.ID = B.HANGHOA_ID          WHERE A.MMYY='0519' AND A.BENHVIEN_ID='HLU01' AND A.MAKHO IN('KCVPP')        GROUP BY A.MAKHO,A.TENKHO,B.HANGHOA_ID,B.MAHANGHOA,HH.TEN) AS Y        ON (X.MMYY=Y.MMYY AND X.MAKHO=Y.MAKHO AND X.HANGHOA_ID=Y.HANGHOA_ID)        WHEN MATCHED THEN UPDATE SET X.SOLUONGTONDAU=Y.SOLUONGTONDAU, X.SOLUONGNHAP=Y.SOLUONGNHAP,X.SOLUONGXUAT=Y.SOLUONGXUAT        WHEN NOT MATCHED THEN        INSERT (MMYY,MAKHO,TENKHO,HANGHOA_ID,MAHANGHOA,TENHANGHOA,SOLUONGTONDAU,SOLUONGNHAP,SOLUONGXUAT,BENHVIEN_ID,NGAYTAO)        VALUES ('0519',Y.MAKHO,Y.TENKHO,Y.HANGHOA_ID,Y.MAHANGHOA,Y.TEN,Y.SOLUONGTONDAU,Y.SOLUONGNHAP,Y.SOLUONGXUAT, @param0 ,GETDATE());          DELETE FROM TT_INV_TONKHOCHITIET WHERE SOLUONGTONDAU=0 AND SOLUONGNHAP=0 AND SOLUONGXUAT=0;        DELETE FROM TT_INV_TONKHOTONGHOP WHERE SOLUONGTONDAU=0 AND SOLUONGNHAP=0 AND SOLUONGXUAT=0;]
2019-08-16 11:09:47,667 [1] DEBUG - Statement Id: [DAO00401_INV001_TinhSoDuDauKy] Parameters: [@param0=[BENHVIEN_ID,HLU01]]
2019-08-16 11:09:47,667 [1] DEBUG - Statement Id: [DAO00401_INV001_TinhSoDuDauKy] Types: [@param0=[String, System.String]]
2019-08-16 11:09:48,111 [1] DEBUG - Statement Id: [DAO00401_INV001_GetDMKHOVPP] PreparedStatement : [Select K.*,BB.SODU,BB.SODUDENNGAY,BB.KHOASO,BB.NGAYKHOA  From TM_KHO K        LEFT JOIN TM_INV_KHO BB ON K.MAKHO = BB.MAKHO        LEFT JOIN LST_DICTIONARY AA ON AA.DICTIONARY_ID = K.MODULE_ID        WHERE AA.DICTIONARY_CODE = 'KhoVPP']
2019-08-16 11:09:52,354 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0619' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 11:09:52,409 [1] DEBUG - Statement Id: [DAO00401_INV001_TinhSoDuDauKy] PreparedStatement : [UPDATE TT_INV_TONKHOCHITIET SET SOLUONGTONDAU=0 WHERE MMYY='0619' AND MAKHO IN('KCVPP');        MERGE TT_INV_TONKHOCHITIET AS X USING (        SELECT TK.MMYY, TK.MAKHO,TK.TENKHO,TK.THEODOI_ID,SUM(TK.SOLUONGTONDAU+TK.SOLUONGNHAP-TK.SOLUONGXUAT) AS SOLUONGTONDAU        FROM                (SELECT '0619' AS MMYY, A.MAKHO,A.TENKHO,B.THEODOI_ID,A.SOLUONGTONDAU,0 AS SOLUONGNHAP,0 AS SOLUONGXUAT,B.NGAYTAO,B.NGUOITAO_ID        FROM TT_INV_TONKHOCHITIET A INNER JOIN TT_INV_THEODOI B ON A.THEODOI_ID=B.THEODOI_ID AND A.MMYY='0519'        WHERE A.MMYY='0519' AND A.BENHVIEN_ID='HLU01' AND A.MAKHO IN('KCVPP')        UNION ALL                SELECT '0619' AS MMYY, A.MAKHOXUAT AS MAKHO,A.TENKHOXUAT AS TENKHO,B.THEODOI_ID,0 AS SOLUONGTONDAU,0 AS SOLUONGNHAP,B.SOLUONGXUAT,C.NGAYTAO,C.NGUOITAO_ID        FROM TT_INV_CHUNGTUXUAT A INNER JOIN TT_INV_CHUNGTUXUATCHITIET B ON A.CHUNGTUXUAT_ID=B.CHUNGTUXUAT_ID AND A.MMYY='0519'        INNER JOIN TT_INV_THEODOI C ON B.THEODOI_ID=C.THEODOI_ID        WHERE A.MMYY='0519' AND A.BENHVIEN_ID='HLU01' AND A.MAKHOXUAT IN('KCVPP')        UNION ALL        SELECT '0619' AS MMYY, A.MAKHO,A.TENKHO,B.THEODOI_ID,0 AS SOLUONGTONDAU,0 AS SOLUONGNHAP,B.SOLUONG AS SOLUONGXUAT,C.NGAYTAO,C.NGUOITAO_ID        FROM TT_INV_CHUNGTUTANGGIAM A INNER JOIN TT_INV_CHUNGTUTANGGIAMCHITIET B ON A.CHUNGTUTANGGIAM_ID=B.CHUNGTUTANGGIAM_ID AND A.MMYY='0519' AND A.LOAI='giam'        INNER JOIN TT_INV_THEODOI C ON B.THEODOI_ID=C.THEODOI_ID        WHERE A.MMYY='0519' AND A.LOAI='giam' AND A.BENHVIEN_ID='HLU01' AND A.MAKHO IN('KCVPP')        UNION ALL                SELECT '0619' AS MMYY, A.MAKHO,A.TENKHO,B.THEODOI_ID,0 AS SOLUONGTONDAU,B.SOLUONGNHAP,0 AS SOLUONGXUAT,C.NGAYTAO,C.NGUOITAO_ID        FROM TT_INV_CHUNGTUNHAP A INNER JOIN TT_INV_CHUNGTUNHAPCHITIET B ON A.CHUNGTUNHAP_ID=B.CHUNGTUNHAP_ID AND A.MMYY='0519'        INNER JOIN TT_INV_THEODOI C ON B.THEODOI_ID=C.THEODOI_ID        WHERE A.MMYY='0519' AND A.MATRANGTHAI='DaNhapKho' AND A.BENHVIEN_ID='HLU01' AND A.MAKHO IN('KCVPP')        UNION ALL        SELECT '0619' AS MMYY, A.MAKHO,A.TENKHO,B.THEODOI_ID,0 AS SOLUONGTONDAU,B.SOLUONG AS SOLUONGNHAP,0 AS SOLUONGXUAT,C.NGAYTAO,C.NGUOITAO_ID        FROM TT_INV_CHUNGTUTANGGIAM A INNER JOIN TT_INV_CHUNGTUTANGGIAMCHITIET B ON A.CHUNGTUTANGGIAM_ID=B.CHUNGTUTANGGIAM_ID AND A.MMYY='0519' AND A.LOAI='tang'        INNER JOIN TT_INV_THEODOI C ON B.THEODOI_ID=C.THEODOI_ID        WHERE A.MMYY='0519' AND A.LOAI='tang' AND A.BENHVIEN_ID='HLU01' AND A.MAKHO IN('KCVPP')        ) TK GROUP BY TK.MMYY, TK.MAKHO,TK.TENKHO,TK.THEODOI_ID) AS Y     ON (X.MMYY=Y.MMYY AND X.MAKHO=Y.MAKHO AND X.THEODOI_ID=Y.THEODOI_ID)             WHEN MATCHED THEN UPDATE SET X.SOLUONGTONDAU=Y.SOLUONGTONDAU        WHEN NOT MATCHED THEN             INSERT (MMYY,MAKHO,TENKHO,THEODOI_ID,SOLUONGTONDAU,BENHVIEN_ID,NGAYTAO,NGUOITAO_ID) VALUES        ('0619',Y.MAKHO,Y.TENKHO,Y.THEODOI_ID,Y.SOLUONGTONDAU, @param0 ,GETDATE(),'');          UPDATE TT_INV_TONKHOTONGHOP SET SOLUONGTONDAU=0,SOLUONGNHAP=0,SOLUONGXUAT=0 WHERE MMYY='0619' AND MAKHO IN('KCVPP');        MERGE TT_INV_TONKHOTONGHOP AS X USING        (SELECT '0619' AS MMYY,A.MAKHO,A.TENKHO,B.HANGHOA_ID,B.MAHANGHOA,HH.TEN,SUM(A.SOLUONGTONDAU) AS SOLUONGTONDAU,SUM(A.SOLUONGNHAP) AS SOLUONGNHAP,SUM(A.SOLUONGXUAT) AS SOLUONGXUAT        FROM TT_INV_TONKHOCHITIET A INNER JOIN TT_INV_THEODOI B ON A.THEODOI_ID=B.THEODOI_ID AND A.MMYY='0619'     JOIN TM_PUR_HANGHOA HH on HH.ID = B.HANGHOA_ID          WHERE A.MMYY='0619' AND A.BENHVIEN_ID='HLU01' AND A.MAKHO IN('KCVPP')        GROUP BY A.MAKHO,A.TENKHO,B.HANGHOA_ID,B.MAHANGHOA,HH.TEN) AS Y        ON (X.MMYY=Y.MMYY AND X.MAKHO=Y.MAKHO AND X.HANGHOA_ID=Y.HANGHOA_ID)        WHEN MATCHED THEN UPDATE SET X.SOLUONGTONDAU=Y.SOLUONGTONDAU, X.SOLUONGNHAP=Y.SOLUONGNHAP,X.SOLUONGXUAT=Y.SOLUONGXUAT        WHEN NOT MATCHED THEN        INSERT (MMYY,MAKHO,TENKHO,HANGHOA_ID,MAHANGHOA,TENHANGHOA,SOLUONGTONDAU,SOLUONGNHAP,SOLUONGXUAT,BENHVIEN_ID,NGAYTAO)        VALUES ('0619',Y.MAKHO,Y.TENKHO,Y.HANGHOA_ID,Y.MAHANGHOA,Y.TEN,Y.SOLUONGTONDAU,Y.SOLUONGNHAP,Y.SOLUONGXUAT, @param0 ,GETDATE());          DELETE FROM TT_INV_TONKHOCHITIET WHERE SOLUONGTONDAU=0 AND SOLUONGNHAP=0 AND SOLUONGXUAT=0;        DELETE FROM TT_INV_TONKHOTONGHOP WHERE SOLUONGTONDAU=0 AND SOLUONGNHAP=0 AND SOLUONGXUAT=0;]
2019-08-16 11:09:52,409 [1] DEBUG - Statement Id: [DAO00401_INV001_TinhSoDuDauKy] Parameters: [@param0=[BENHVIEN_ID,HLU01]]
2019-08-16 11:09:52,409 [1] DEBUG - Statement Id: [DAO00401_INV001_TinhSoDuDauKy] Types: [@param0=[String, System.String]]
2019-08-16 11:09:52,881 [1] DEBUG - Statement Id: [DAO00401_INV001_GetDMKHOVPP] PreparedStatement : [Select K.*,BB.SODU,BB.SODUDENNGAY,BB.KHOASO,BB.NGAYKHOA  From TM_KHO K        LEFT JOIN TM_INV_KHO BB ON K.MAKHO = BB.MAKHO        LEFT JOIN LST_DICTIONARY AA ON AA.DICTIONARY_ID = K.MODULE_ID        WHERE AA.DICTIONARY_CODE = 'KhoVPP']
2019-08-16 11:09:56,473 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0719' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 11:09:56,499 [1] DEBUG - Statement Id: [DAO00401_INV001_TinhSoDuDauKy] PreparedStatement : [UPDATE TT_INV_TONKHOCHITIET SET SOLUONGTONDAU=0 WHERE MMYY='0719' AND MAKHO IN('KCVPP');        MERGE TT_INV_TONKHOCHITIET AS X USING (        SELECT TK.MMYY, TK.MAKHO,TK.TENKHO,TK.THEODOI_ID,SUM(TK.SOLUONGTONDAU+TK.SOLUONGNHAP-TK.SOLUONGXUAT) AS SOLUONGTONDAU        FROM                (SELECT '0719' AS MMYY, A.MAKHO,A.TENKHO,B.THEODOI_ID,A.SOLUONGTONDAU,0 AS SOLUONGNHAP,0 AS SOLUONGXUAT,B.NGAYTAO,B.NGUOITAO_ID        FROM TT_INV_TONKHOCHITIET A INNER JOIN TT_INV_THEODOI B ON A.THEODOI_ID=B.THEODOI_ID AND A.MMYY='0619'        WHERE A.MMYY='0619' AND A.BENHVIEN_ID='HLU01' AND A.MAKHO IN('KCVPP')        UNION ALL                SELECT '0719' AS MMYY, A.MAKHOXUAT AS MAKHO,A.TENKHOXUAT AS TENKHO,B.THEODOI_ID,0 AS SOLUONGTONDAU,0 AS SOLUONGNHAP,B.SOLUONGXUAT,C.NGAYTAO,C.NGUOITAO_ID        FROM TT_INV_CHUNGTUXUAT A INNER JOIN TT_INV_CHUNGTUXUATCHITIET B ON A.CHUNGTUXUAT_ID=B.CHUNGTUXUAT_ID AND A.MMYY='0619'        INNER JOIN TT_INV_THEODOI C ON B.THEODOI_ID=C.THEODOI_ID        WHERE A.MMYY='0619' AND A.BENHVIEN_ID='HLU01' AND A.MAKHOXUAT IN('KCVPP')        UNION ALL        SELECT '0719' AS MMYY, A.MAKHO,A.TENKHO,B.THEODOI_ID,0 AS SOLUONGTONDAU,0 AS SOLUONGNHAP,B.SOLUONG AS SOLUONGXUAT,C.NGAYTAO,C.NGUOITAO_ID        FROM TT_INV_CHUNGTUTANGGIAM A INNER JOIN TT_INV_CHUNGTUTANGGIAMCHITIET B ON A.CHUNGTUTANGGIAM_ID=B.CHUNGTUTANGGIAM_ID AND A.MMYY='0619' AND A.LOAI='giam'        INNER JOIN TT_INV_THEODOI C ON B.THEODOI_ID=C.THEODOI_ID        WHERE A.MMYY='0619' AND A.LOAI='giam' AND A.BENHVIEN_ID='HLU01' AND A.MAKHO IN('KCVPP')        UNION ALL                SELECT '0719' AS MMYY, A.MAKHO,A.TENKHO,B.THEODOI_ID,0 AS SOLUONGTONDAU,B.SOLUONGNHAP,0 AS SOLUONGXUAT,C.NGAYTAO,C.NGUOITAO_ID        FROM TT_INV_CHUNGTUNHAP A INNER JOIN TT_INV_CHUNGTUNHAPCHITIET B ON A.CHUNGTUNHAP_ID=B.CHUNGTUNHAP_ID AND A.MMYY='0619'        INNER JOIN TT_INV_THEODOI C ON B.THEODOI_ID=C.THEODOI_ID        WHERE A.MMYY='0619' AND A.MATRANGTHAI='DaNhapKho' AND A.BENHVIEN_ID='HLU01' AND A.MAKHO IN('KCVPP')        UNION ALL        SELECT '0719' AS MMYY, A.MAKHO,A.TENKHO,B.THEODOI_ID,0 AS SOLUONGTONDAU,B.SOLUONG AS SOLUONGNHAP,0 AS SOLUONGXUAT,C.NGAYTAO,C.NGUOITAO_ID        FROM TT_INV_CHUNGTUTANGGIAM A INNER JOIN TT_INV_CHUNGTUTANGGIAMCHITIET B ON A.CHUNGTUTANGGIAM_ID=B.CHUNGTUTANGGIAM_ID AND A.MMYY='0619' AND A.LOAI='tang'        INNER JOIN TT_INV_THEODOI C ON B.THEODOI_ID=C.THEODOI_ID        WHERE A.MMYY='0619' AND A.LOAI='tang' AND A.BENHVIEN_ID='HLU01' AND A.MAKHO IN('KCVPP')        ) TK GROUP BY TK.MMYY, TK.MAKHO,TK.TENKHO,TK.THEODOI_ID) AS Y     ON (X.MMYY=Y.MMYY AND X.MAKHO=Y.MAKHO AND X.THEODOI_ID=Y.THEODOI_ID)             WHEN MATCHED THEN UPDATE SET X.SOLUONGTONDAU=Y.SOLUONGTONDAU        WHEN NOT MATCHED THEN             INSERT (MMYY,MAKHO,TENKHO,THEODOI_ID,SOLUONGTONDAU,BENHVIEN_ID,NGAYTAO,NGUOITAO_ID) VALUES        ('0719',Y.MAKHO,Y.TENKHO,Y.THEODOI_ID,Y.SOLUONGTONDAU, @param0 ,GETDATE(),'');          UPDATE TT_INV_TONKHOTONGHOP SET SOLUONGTONDAU=0,SOLUONGNHAP=0,SOLUONGXUAT=0 WHERE MMYY='0719' AND MAKHO IN('KCVPP');        MERGE TT_INV_TONKHOTONGHOP AS X USING        (SELECT '0719' AS MMYY,A.MAKHO,A.TENKHO,B.HANGHOA_ID,B.MAHANGHOA,HH.TEN,SUM(A.SOLUONGTONDAU) AS SOLUONGTONDAU,SUM(A.SOLUONGNHAP) AS SOLUONGNHAP,SUM(A.SOLUONGXUAT) AS SOLUONGXUAT        FROM TT_INV_TONKHOCHITIET A INNER JOIN TT_INV_THEODOI B ON A.THEODOI_ID=B.THEODOI_ID AND A.MMYY='0719'     JOIN TM_PUR_HANGHOA HH on HH.ID = B.HANGHOA_ID          WHERE A.MMYY='0719' AND A.BENHVIEN_ID='HLU01' AND A.MAKHO IN('KCVPP')        GROUP BY A.MAKHO,A.TENKHO,B.HANGHOA_ID,B.MAHANGHOA,HH.TEN) AS Y        ON (X.MMYY=Y.MMYY AND X.MAKHO=Y.MAKHO AND X.HANGHOA_ID=Y.HANGHOA_ID)        WHEN MATCHED THEN UPDATE SET X.SOLUONGTONDAU=Y.SOLUONGTONDAU, X.SOLUONGNHAP=Y.SOLUONGNHAP,X.SOLUONGXUAT=Y.SOLUONGXUAT        WHEN NOT MATCHED THEN        INSERT (MMYY,MAKHO,TENKHO,HANGHOA_ID,MAHANGHOA,TENHANGHOA,SOLUONGTONDAU,SOLUONGNHAP,SOLUONGXUAT,BENHVIEN_ID,NGAYTAO)        VALUES ('0719',Y.MAKHO,Y.TENKHO,Y.HANGHOA_ID,Y.MAHANGHOA,Y.TEN,Y.SOLUONGTONDAU,Y.SOLUONGNHAP,Y.SOLUONGXUAT, @param0 ,GETDATE());          DELETE FROM TT_INV_TONKHOCHITIET WHERE SOLUONGTONDAU=0 AND SOLUONGNHAP=0 AND SOLUONGXUAT=0;        DELETE FROM TT_INV_TONKHOTONGHOP WHERE SOLUONGTONDAU=0 AND SOLUONGNHAP=0 AND SOLUONGXUAT=0;]
2019-08-16 11:09:56,499 [1] DEBUG - Statement Id: [DAO00401_INV001_TinhSoDuDauKy] Parameters: [@param0=[BENHVIEN_ID,HLU01]]
2019-08-16 11:09:56,499 [1] DEBUG - Statement Id: [DAO00401_INV001_TinhSoDuDauKy] Types: [@param0=[String, System.String]]
2019-08-16 11:09:57,391 [1] DEBUG - Statement Id: [DAO00401_INV001_GetDMKHOVPP] PreparedStatement : [Select K.*,BB.SODU,BB.SODUDENNGAY,BB.KHOASO,BB.NGAYKHOA  From TM_KHO K        LEFT JOIN TM_INV_KHO BB ON K.MAKHO = BB.MAKHO        LEFT JOIN LST_DICTIONARY AA ON AA.DICTIONARY_ID = K.MODULE_ID        WHERE AA.DICTIONARY_CODE = 'KhoVPP']
2019-08-16 11:10:01,298 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 11:10:01,323 [1] DEBUG - Statement Id: [DAO00401_INV001_TinhSoDuDauKy] PreparedStatement : [UPDATE TT_INV_TONKHOCHITIET SET SOLUONGTONDAU=0 WHERE MMYY='0819' AND MAKHO IN('KCVPP');        MERGE TT_INV_TONKHOCHITIET AS X USING (        SELECT TK.MMYY, TK.MAKHO,TK.TENKHO,TK.THEODOI_ID,SUM(TK.SOLUONGTONDAU+TK.SOLUONGNHAP-TK.SOLUONGXUAT) AS SOLUONGTONDAU        FROM                (SELECT '0819' AS MMYY, A.MAKHO,A.TENKHO,B.THEODOI_ID,A.SOLUONGTONDAU,0 AS SOLUONGNHAP,0 AS SOLUONGXUAT,B.NGAYTAO,B.NGUOITAO_ID        FROM TT_INV_TONKHOCHITIET A INNER JOIN TT_INV_THEODOI B ON A.THEODOI_ID=B.THEODOI_ID AND A.MMYY='0719'        WHERE A.MMYY='0719' AND A.BENHVIEN_ID='HLU01' AND A.MAKHO IN('KCVPP')        UNION ALL                SELECT '0819' AS MMYY, A.MAKHOXUAT AS MAKHO,A.TENKHOXUAT AS TENKHO,B.THEODOI_ID,0 AS SOLUONGTONDAU,0 AS SOLUONGNHAP,B.SOLUONGXUAT,C.NGAYTAO,C.NGUOITAO_ID        FROM TT_INV_CHUNGTUXUAT A INNER JOIN TT_INV_CHUNGTUXUATCHITIET B ON A.CHUNGTUXUAT_ID=B.CHUNGTUXUAT_ID AND A.MMYY='0719'        INNER JOIN TT_INV_THEODOI C ON B.THEODOI_ID=C.THEODOI_ID        WHERE A.MMYY='0719' AND A.BENHVIEN_ID='HLU01' AND A.MAKHOXUAT IN('KCVPP')        UNION ALL        SELECT '0819' AS MMYY, A.MAKHO,A.TENKHO,B.THEODOI_ID,0 AS SOLUONGTONDAU,0 AS SOLUONGNHAP,B.SOLUONG AS SOLUONGXUAT,C.NGAYTAO,C.NGUOITAO_ID        FROM TT_INV_CHUNGTUTANGGIAM A INNER JOIN TT_INV_CHUNGTUTANGGIAMCHITIET B ON A.CHUNGTUTANGGIAM_ID=B.CHUNGTUTANGGIAM_ID AND A.MMYY='0719' AND A.LOAI='giam'        INNER JOIN TT_INV_THEODOI C ON B.THEODOI_ID=C.THEODOI_ID        WHERE A.MMYY='0719' AND A.LOAI='giam' AND A.BENHVIEN_ID='HLU01' AND A.MAKHO IN('KCVPP')        UNION ALL                SELECT '0819' AS MMYY, A.MAKHO,A.TENKHO,B.THEODOI_ID,0 AS SOLUONGTONDAU,B.SOLUONGNHAP,0 AS SOLUONGXUAT,C.NGAYTAO,C.NGUOITAO_ID        FROM TT_INV_CHUNGTUNHAP A INNER JOIN TT_INV_CHUNGTUNHAPCHITIET B ON A.CHUNGTUNHAP_ID=B.CHUNGTUNHAP_ID AND A.MMYY='0719'        INNER JOIN TT_INV_THEODOI C ON B.THEODOI_ID=C.THEODOI_ID        WHERE A.MMYY='0719' AND A.MATRANGTHAI='DaNhapKho' AND A.BENHVIEN_ID='HLU01' AND A.MAKHO IN('KCVPP')        UNION ALL        SELECT '0819' AS MMYY, A.MAKHO,A.TENKHO,B.THEODOI_ID,0 AS SOLUONGTONDAU,B.SOLUONG AS SOLUONGNHAP,0 AS SOLUONGXUAT,C.NGAYTAO,C.NGUOITAO_ID        FROM TT_INV_CHUNGTUTANGGIAM A INNER JOIN TT_INV_CHUNGTUTANGGIAMCHITIET B ON A.CHUNGTUTANGGIAM_ID=B.CHUNGTUTANGGIAM_ID AND A.MMYY='0719' AND A.LOAI='tang'        INNER JOIN TT_INV_THEODOI C ON B.THEODOI_ID=C.THEODOI_ID        WHERE A.MMYY='0719' AND A.LOAI='tang' AND A.BENHVIEN_ID='HLU01' AND A.MAKHO IN('KCVPP')        ) TK GROUP BY TK.MMYY, TK.MAKHO,TK.TENKHO,TK.THEODOI_ID) AS Y     ON (X.MMYY=Y.MMYY AND X.MAKHO=Y.MAKHO AND X.THEODOI_ID=Y.THEODOI_ID)             WHEN MATCHED THEN UPDATE SET X.SOLUONGTONDAU=Y.SOLUONGTONDAU        WHEN NOT MATCHED THEN             INSERT (MMYY,MAKHO,TENKHO,THEODOI_ID,SOLUONGTONDAU,BENHVIEN_ID,NGAYTAO,NGUOITAO_ID) VALUES        ('0819',Y.MAKHO,Y.TENKHO,Y.THEODOI_ID,Y.SOLUONGTONDAU, @param0 ,GETDATE(),'');          UPDATE TT_INV_TONKHOTONGHOP SET SOLUONGTONDAU=0,SOLUONGNHAP=0,SOLUONGXUAT=0 WHERE MMYY='0819' AND MAKHO IN('KCVPP');        MERGE TT_INV_TONKHOTONGHOP AS X USING        (SELECT '0819' AS MMYY,A.MAKHO,A.TENKHO,B.HANGHOA_ID,B.MAHANGHOA,HH.TEN,SUM(A.SOLUONGTONDAU) AS SOLUONGTONDAU,SUM(A.SOLUONGNHAP) AS SOLUONGNHAP,SUM(A.SOLUONGXUAT) AS SOLUONGXUAT        FROM TT_INV_TONKHOCHITIET A INNER JOIN TT_INV_THEODOI B ON A.THEODOI_ID=B.THEODOI_ID AND A.MMYY='0819'     JOIN TM_PUR_HANGHOA HH on HH.ID = B.HANGHOA_ID          WHERE A.MMYY='0819' AND A.BENHVIEN_ID='HLU01' AND A.MAKHO IN('KCVPP')        GROUP BY A.MAKHO,A.TENKHO,B.HANGHOA_ID,B.MAHANGHOA,HH.TEN) AS Y        ON (X.MMYY=Y.MMYY AND X.MAKHO=Y.MAKHO AND X.HANGHOA_ID=Y.HANGHOA_ID)        WHEN MATCHED THEN UPDATE SET X.SOLUONGTONDAU=Y.SOLUONGTONDAU, X.SOLUONGNHAP=Y.SOLUONGNHAP,X.SOLUONGXUAT=Y.SOLUONGXUAT        WHEN NOT MATCHED THEN        INSERT (MMYY,MAKHO,TENKHO,HANGHOA_ID,MAHANGHOA,TENHANGHOA,SOLUONGTONDAU,SOLUONGNHAP,SOLUONGXUAT,BENHVIEN_ID,NGAYTAO)        VALUES ('0819',Y.MAKHO,Y.TENKHO,Y.HANGHOA_ID,Y.MAHANGHOA,Y.TEN,Y.SOLUONGTONDAU,Y.SOLUONGNHAP,Y.SOLUONGXUAT, @param0 ,GETDATE());          DELETE FROM TT_INV_TONKHOCHITIET WHERE SOLUONGTONDAU=0 AND SOLUONGNHAP=0 AND SOLUONGXUAT=0;        DELETE FROM TT_INV_TONKHOTONGHOP WHERE SOLUONGTONDAU=0 AND SOLUONGNHAP=0 AND SOLUONGXUAT=0;]
2019-08-16 11:10:01,323 [1] DEBUG - Statement Id: [DAO00401_INV001_TinhSoDuDauKy] Parameters: [@param0=[BENHVIEN_ID,HLU01]]
2019-08-16 11:10:01,323 [1] DEBUG - Statement Id: [DAO00401_INV001_TinhSoDuDauKy] Types: [@param0=[String, System.String]]
2019-08-16 11:10:01,761 [1] DEBUG - Statement Id: [DAO00401_INV001_GetDMKHOVPP] PreparedStatement : [Select K.*,BB.SODU,BB.SODUDENNGAY,BB.KHOASO,BB.NGAYKHOA  From TM_KHO K        LEFT JOIN TM_INV_KHO BB ON K.MAKHO = BB.MAKHO        LEFT JOIN LST_DICTIONARY AA ON AA.DICTIONARY_ID = K.MODULE_ID        WHERE AA.DICTIONARY_CODE = 'KhoVPP']
2019-08-16 11:10:15,837 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'STA09'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 11:10:16,258 [1] DEBUG - Statement Id: [DAO00401_INV001_GetDMKHOVPP] PreparedStatement : [Select K.*,BB.SODU,BB.SODUDENNGAY,BB.KHOASO,BB.NGAYKHOA  From TM_KHO K        LEFT JOIN TM_INV_KHO BB ON K.MAKHO = BB.MAKHO        LEFT JOIN LST_DICTIONARY AA ON AA.DICTIONARY_ID = K.MODULE_ID        WHERE AA.DICTIONARY_CODE = 'KhoVPP']
2019-08-16 11:10:16,464 [1] DEBUG - Statement Id: [DAO00401_INV001_GetTonKhoChiTietTongTon] PreparedStatement : [SELECT TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.DONGIA AS DONGIATRUOCVAT,        TD.DONGIASAUVAT AS DONGIA,CONVERT(VARCHAR(10),TD.HANDUNG,103) HANDUNG, TD.HANDUNG as HANDUNGDT,        TD.LOSX,CONVERT(VARCHAR(10),TD.NGAYTAO,103) +' '+CONVERT(VARCHAR(10),TD.NGAYTAO,108) NGAYTAO,        SUM(TKCT.SOLUONGTONDAU+TKCT.SOLUONGNHAP-TKCT.SOLUONGXUAT) AS SOLUONGTONCHITIET,SUM(TKTH.SOLUONGTONDAU+TKTH.SOLUONGNHAP-TKTH.SOLUONGXUAT) AS SOLUONGTONCUOI        FROM TM_PUR_HANGHOA HH INNER JOIN TT_INV_THEODOI TD ON HH.ID = TD.HANGHOA_ID        INNER JOIN TT_INV_TONKHOTONGHOP TKTH ON HH.ID = TKTH.HANGHOA_ID AND TKTH.MMYY='0819'        INNER JOIN TT_INV_TONKHOCHITIET TKCT ON TD.THEODOI_ID = TKCT.THEODOI_ID AND TKCT.MMYY='0819'        where TKCT.MMYY='0819' AND TKCT.BENHVIEN_ID = 'HLU01' AND TKCT.MAKHO = 'KCVPP'        GROUP BY TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.DONGIA,TD.DONGIASAUVAT,TD.HANDUNG,TD.NGAYTAO,TD.LOSX]
2019-08-16 11:10:16,740 [1] DEBUG - Statement Id: [DAO00401_INV001_GetTonKhoChiTietTongTon] PreparedStatement : [SELECT TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.DONGIA AS DONGIATRUOCVAT,        TD.DONGIASAUVAT AS DONGIA,CONVERT(VARCHAR(10),TD.HANDUNG,103) HANDUNG, TD.HANDUNG as HANDUNGDT,        TD.LOSX,CONVERT(VARCHAR(10),TD.NGAYTAO,103) +' '+CONVERT(VARCHAR(10),TD.NGAYTAO,108) NGAYTAO,        SUM(TKCT.SOLUONGTONDAU+TKCT.SOLUONGNHAP-TKCT.SOLUONGXUAT) AS SOLUONGTONCHITIET,SUM(TKTH.SOLUONGTONDAU+TKTH.SOLUONGNHAP-TKTH.SOLUONGXUAT) AS SOLUONGTONCUOI        FROM TM_PUR_HANGHOA HH INNER JOIN TT_INV_THEODOI TD ON HH.ID = TD.HANGHOA_ID        INNER JOIN TT_INV_TONKHOTONGHOP TKTH ON HH.ID = TKTH.HANGHOA_ID AND TKTH.MMYY='0819'        INNER JOIN TT_INV_TONKHOCHITIET TKCT ON TD.THEODOI_ID = TKCT.THEODOI_ID AND TKCT.MMYY='0819'        where TKCT.MMYY='0819' AND TKCT.BENHVIEN_ID = 'HLU01' AND TKCT.MAKHO = 'KCVPP'        GROUP BY TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.DONGIA,TD.DONGIASAUVAT,TD.HANDUNG,TD.NGAYTAO,TD.LOSX]
2019-08-16 11:10:16,886 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 11:10:22,111 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 11:10:32,830 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2019-08-16 11:10:32,966 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-08-16 11:10:32,996 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-08-16 11:10:33,153 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 11:10:33,240 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-08-16 11:10:46,372 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2019-08-16 11:10:46,398 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-08-16 11:10:47,683 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-08-16 11:10:47,775 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-08-16 11:10:48,404 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2019-08-16 11:10:48,491 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2019-08-16 11:10:48,580 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2019-08-16 11:10:48,734 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2019-08-16 11:10:48,854 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2019-08-16 11:10:48,937 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2019-08-16 11:10:49,031 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2019-08-16 11:10:49,120 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2019-08-16 11:10:49,196 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2019-08-16 11:10:49,719 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2019-08-16 11:10:49,750 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2019-08-16 11:10:49,823 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2019-08-16 11:10:49,857 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2019-08-16 11:10:50,742 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2019-08-16 11:10:50,774 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 0 as PHAMVI_ID, 0 as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0         end                else        begin        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2019-08-16 11:10:52,753 [5] DEBUG - Statement Id: [DAO00320_GetList] PreparedStatement : [select M.*            from TM_MAU M            LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID            where            M.TAMNGUNG = '0'            and M.BENHVIEN_ID = 'HLU01'            order by M.TENMAU]
2019-08-16 11:10:52,887 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2019-08-16 11:10:52,929 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT          TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,          TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,          SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH          FROM TT_MAU_TONKHO TK          JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID          JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID          JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'          LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID          LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID          WHERE TK.SOLUONG > 0          GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,          TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2019-08-16 11:10:53,016 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2019-08-16 11:10:53,050 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct          TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,          TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,          TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH          from TM_MAU M          JOIN          (          select          A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO          from          (          select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO          from TT_MAU_TONKHO TK          JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID          inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID          left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'          where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0          ) A          )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'          LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID          LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2019-08-16 11:10:53,126 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2019-08-16 11:10:54,092 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 11:10:54,191 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2019-08-16 11:10:54,235 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2019-08-16 11:10:54,261 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2019-08-16 11:10:54,347 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 11:10:54,490 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 11:10:54,560 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2019-08-16 11:10:54,561 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-08-16 11:10:54,561 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-08-16 11:10:54,587 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2019-08-16 11:10:54,588 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-08-16 11:10:54,588 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-08-16 11:10:54,673 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 11:10:54,810 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 11:10:55,872 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 11:10:55,959 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2019-08-16 11:10:56,188 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2019-08-16 11:11:23,269 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'STA06'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 11:11:23,619 [1] DEBUG - Statement Id: [DAO00401_INV001_GetDMNhanVien] PreparedStatement : [SELECT NHANVIEN_ID,TENNHANVIEN,NHANVIEN_ID AS NHANVIENNHAN_ID,TENNHANVIEN AS TENNHANVIENNHAN FROM [TM_NHANVIEN]        where BENHVIEN_ID = 'HLU01'        ORDER BY TENNHANVIEN]
2019-08-16 11:11:23,933 [1] DEBUG - Statement Id: [DAO00401_INV001_GetDMKHOVPP] PreparedStatement : [Select K.*,BB.SODU,BB.SODUDENNGAY,BB.KHOASO,BB.NGAYKHOA  From TM_KHO K        LEFT JOIN TM_INV_KHO BB ON K.MAKHO = BB.MAKHO        LEFT JOIN LST_DICTIONARY AA ON AA.DICTIONARY_ID = K.MODULE_ID        WHERE AA.DICTIONARY_CODE = 'KhoVPP']
2019-08-16 11:11:24,111 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 11:11:29,302 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'STA05'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 11:11:29,462 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM98'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 11:11:29,992 [1] DEBUG - Statement Id: [DAO00401_INV001_PhieuYeuCauSearch] PreparedStatement : [select YC.PHIEUYEUCAU_ID,YC.MAPHIEUYEUCAU,YC.MMYY,YC.NGAYLAP,YC.PHONGBAN_ID,YC.TENPHONGBAN,YC.MAKHOXUAT,YC.TENKHOXUAT,YC.GHICHU,YC.TENNGUOITAO,YC.TENNGUOICAPNHAT,YC.BENHVIEN_ID,YC.NGAYTAO,YC.NGUOITAO_ID,YC.NGAYCAPNHAT,YC.NGUOICAPNHAT_ID        FROM TT_INV_PHIEUYEUCAU YC        WHERE YC.BENHVIEN_ID = 'HLU01' AND YC.NGAYLAP BETWEEN '7/16/2019 11:11:29 AM' AND '8/16/2019 11:11:29 AM'         AND           YC.CHUNGTUXUAT_ID IS NULL         AND           YC.MAKHOXUAT = 'KCVPP']
2019-08-16 11:11:35,537 [1] DEBUG - Statement Id: [DAO00401_INV001_PhieuYeuCauSearch] PreparedStatement : [select YC.PHIEUYEUCAU_ID,YC.MAPHIEUYEUCAU,YC.MMYY,YC.NGAYLAP,YC.PHONGBAN_ID,YC.TENPHONGBAN,YC.MAKHOXUAT,YC.TENKHOXUAT,YC.GHICHU,YC.TENNGUOITAO,YC.TENNGUOICAPNHAT,YC.BENHVIEN_ID,YC.NGAYTAO,YC.NGUOITAO_ID,YC.NGAYCAPNHAT,YC.NGUOICAPNHAT_ID        FROM TT_INV_PHIEUYEUCAU YC        WHERE YC.BENHVIEN_ID = 'HLU01' AND YC.NGAYLAP BETWEEN '4/1/2019 12:00:00 AM' AND '8/16/2019 11:11:29 AM'         AND           YC.CHUNGTUXUAT_ID IS NULL         AND           YC.MAKHOXUAT = 'KCVPP']
2019-08-16 11:11:36,120 [1] DEBUG - Statement Id: [DAO00401_INV001_GetPhieuYeuCauChiTiet_PhieuYeuCauID] PreparedStatement : [select YCCT.PHIEUYEUCAUCHITIET_ID,YCCT.HANGHOA_ID,YCCT.MAHANGHOA,YCCT.TENHANGHOA,YCCT.DONVITINH_ID,YCCT.TENDONVITINH,YCCT.SOLUONGYEUCAU,YCCT.SOLUONGDAXUAT        FROM TT_INV_PHIEUYEUCAUCHITIET YCCT        WHERE YCCT.BENHVIEN_ID = 'HLU01' AND YCCT.PHIEUYEUCAU_ID='21']
2019-08-16 11:11:36,495 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChiTietYC_MaPhieuYeuCau] PreparedStatement : [select YC.PHIEUYEUCAU_ID,YC.MAPHIEUYEUCAU,YC.MMYY,YC.NGAYLAP,YC.PHONGBAN_ID AS PHONGBANNHAN_ID,YC.TENPHONGBAN AS TENPHONGBANNHAN,YC.MAKHOXUAT,YC.TENKHOXUAT,        YCCT.PHIEUYEUCAUCHITIET_ID,YCCT.HANGHOA_ID,YCCT.MAHANGHOA,YCCT.TENHANGHOA,YCCT.DONVITINH_ID,YCCT.TENDONVITINH,YCCT.SOLUONGYEUCAU,YCCT.SOLUONGYEUCAU AS SOLUONGXUAT, NULL AS DONGIA,NULL AS LOSX,NULL AS HANDUNG,        TKTH.SOLUONGTONCUOI        FROM TT_INV_PHIEUYEUCAU YC INNER JOIN TT_INV_PHIEUYEUCAUCHITIET YCCT ON YC.PHIEUYEUCAU_ID=YCCT.PHIEUYEUCAU_ID        LEFT JOIN (SELECT (SOLUONGTONDAU+SOLUONGNHAP-SOLUONGXUAT) AS SOLUONGTONCUOI, HANGHOA_ID,MAKHO        FROM TT_INV_TONKHOTONGHOP WHERE BENHVIEN_ID='HLU01' AND MMYY='0819'        ) TKTH ON YCCT.HANGHOA_ID = TKTH.HANGHOA_ID AND YC.MAKHOXUAT = TKTH.MAKHO        WHERE YC.MAPHIEUYEUCAU='YC5190525070426' AND YC.BENHVIEN_ID = 'HLU01']
2019-08-16 11:11:41,929 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 11:11:41,967 [1] DEBUG - Statement Id: [DAO00401_INV001_GetTonKho] PreparedStatement : [SELECT TKTH.HANGHOA_ID,TKTH.MAHANGHOA,TKTH.TENHANGHOA,HH.DONVITINH_ID,HH.TENDONVITINH,SUM(TKTH.SOLUONGTONDAU+TKTH.SOLUONGNHAP-TKTH.SOLUONGXUAT) AS SOLUONGTONCUOI        FROM TM_PUR_HANGHOA HH INNER JOIN TT_INV_TONKHOTONGHOP TKTH ON HH.ID = TKTH.HANGHOA_ID        where TKTH.BENHVIEN_ID = 'HLU01' AND TKTH.MAKHO = 'KCVPP' AND TKTH.MMYY='0819'        GROUP BY TKTH.HANGHOA_ID,TKTH.MAHANGHOA,TKTH.TENHANGHOA,HH.DONVITINH_ID,HH.TENDONVITINH]
2019-08-16 11:11:42,026 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraMaChungTuXuatTonTai] PreparedStatement : [select CT.IDCHUYEN        FROM TT_INV_CHUNGTUXUAT CT        where CT.MACHUNGTU = 'X190816111142' AND CT.BENHVIEN_ID = 'HLU01'         AND         CT.MMYY IN(0819)]
2019-08-16 11:11:42,497 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuat] PreparedStatement : [INSERT INTO TT_INV_CHUNGTUXUAT        (MACHUNGTU,MMYY,NGAYCHUNGTU,MAKHOXUAT,TENKHOXUAT,PHONGBANNHAN_ID,TENPHONGBANNHAN,NHANVIENNHAN_ID,TENNHANVIENNHAN,GHICHU,PHIEUYEUCAU_ID,MAPHIEUYEUCAU,XUATKHOTHEO,TENNGUOITAO,BENHVIEN_ID,NGAYTAO,NGUOITAO_ID)        VALUES ( @param0 , @param1 , @param2 , @param3 , @param4 , @param5 , @param6 , @param7 , @param8 , @param9 , @param10 , @param11 , @param12 , @param13 , @param14 ,GETDATE(), @param15 )        SELECT SCOPE_IDENTITY()]
2019-08-16 11:11:42,498 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuat] Parameters: [@param0=[MACHUNGTU,X190816111142], @param1=[MMYY,0819], @param2=[NGAYCHUNGTU,8/16/2019 11:11:36 AM], @param3=[MAKHOXUAT,KCVPP], @param4=[TENKHOXUAT,Kho chính VPP], @param5=[PHONGBANNHAN_ID,5], @param6=[TENPHONGBANNHAN,Khoa Nội Tiêu hóa -Hô hấp- Nội tiết], @param7=[NHANVIENNHAN_ID,2], @param8=[TENNHANVIENNHAN,Bùi Cao Kháng], @param9=[GHICHU,null], @param10=[PHIEUYEUCAU_ID,21], @param11=[MAPHIEUYEUCAU,YC5190525070426], @param12=[XUATKHOTHEO,Hạn dùng], @param13=[TENNGUOITAO,Administrator], @param14=[BENHVIEN_ID,HLU01], @param15=[NGUOITAO_ID,1]]
2019-08-16 11:11:42,498 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuat] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[DateTime, System.DateTime], @param3=[String, System.String], @param4=[String, System.String], @param5=[Int64, System.Int64], @param6=[String, System.String], @param7=[Int64, System.Int64], @param8=[String, System.String], @param9=[System.DBNull, null], @param10=[Int64, System.Int64], @param11=[String, System.String], @param12=[String, System.String], @param13=[String, System.String], @param14=[String, System.String], @param15=[Int64, System.Int64]]
2019-08-16 11:11:42,596 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdChungTuXuatID_PhieuYeuCau] PreparedStatement : [UPDATE TT_INV_PHIEUYEUCAU SET CHUNGTUXUAT_ID =  @param0  WHERE PHIEUYEUCAU_ID = '21' AND BENHVIEN_ID = 'HLU01']
2019-08-16 11:11:42,596 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdChungTuXuatID_PhieuYeuCau] Parameters: [@param0=[CHUNGTUXUAT_ID,6]]
2019-08-16 11:11:42,596 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdChungTuXuatID_PhieuYeuCau] Types: [@param0=[Int64, System.Int64]]
2019-08-16 11:11:42,662 [1] DEBUG - Statement Id: [DAO00401_INV001_GetTonKhoChiTiet] PreparedStatement : [SELECT TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.DONGIA AS DONGIATRUOCVAT,TD.DONGIASAUVAT AS DONGIA,CASE WHEN TD.HANDUNG IS NULL THEN DATEADD(YEAR,999, GETDATE()) ELSE TD.HANDUNG END AS HANDUNG ,TD.NGAYTAO,        SUM(TKCT.SOLUONGTONDAU+TKCT.SOLUONGNHAP-TKCT.SOLUONGXUAT) AS SOLUONGTONCUOI        FROM TM_PUR_HANGHOA HH INNER JOIN TT_INV_THEODOI TD ON HH.ID = TD.HANGHOA_ID        INNER JOIN TT_INV_TONKHOCHITIET TKCT ON TD.THEODOI_ID = TKCT.THEODOI_ID        where TKCT.BENHVIEN_ID = 'HLU01' AND TKCT.MAKHO = 'KCVPP' AND TKCT.MMYY='0819'        GROUP BY TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.DONGIA,TD.DONGIASAUVAT,TD.HANDUNG,TD.NGAYTAO        ORDER BY TD.NGAYTAO]
2019-08-16 11:11:42,717 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuatChiTiet] PreparedStatement : [INSERT INTO TT_INV_CHUNGTUXUATCHITIET(CHUNGTUXUAT_ID,MMYY,THEODOI_ID,SOLUONGYEUCAU,SOLUONGXUAT,THANHTIEN,GHICHU,PHIEUYEUCAUCHITIET_ID,TENNGUOITAO,BENHVIEN_ID,NGAYTAO,NGUOITAO_ID)       VALUES( @param0 , @param1 , @param2 , @param3 , @param4 , @param5 , @param6 , @param7 , @param8 , @param9 ,GETDATE(), @param10 )        SELECT SCOPE_IDENTITY()]
2019-08-16 11:11:42,718 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuatChiTiet] Parameters: [@param0=[CHUNGTUXUAT_ID,6], @param1=[MMYY,0819], @param2=[THEODOI_ID,76], @param3=[SOLUONGYEUCAU,10], @param4=[SOLUONGXUAT,10], @param5=[THANHTIEN,265000.0000], @param6=[CT_GHICHU,null], @param7=[PHIEUYEUCAUCHITIET_ID,21], @param8=[TENNGUOITAO,null], @param9=[BENHVIEN_ID,HLU01], @param10=[NGUOITAO_ID,null]]
2019-08-16 11:11:42,718 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuatChiTiet] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String], @param2=[Int32, System.Int32], @param3=[Double, System.Double], @param4=[Decimal, System.Decimal], @param5=[Decimal, System.Decimal], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[String, System.String], @param10=[System.DBNull, null]]
2019-08-16 11:11:43,255 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLDaXuat_PhieuYeuCauChiTietID] PreparedStatement : [UPDATE TT_INV_PHIEUYEUCAUCHITIET        SET SOLUONGDAXUAT= @param0         WHERE PHIEUYEUCAUCHITIET_ID = '21' AND BENHVIEN_ID = 'HLU01']
2019-08-16 11:11:43,255 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLDaXuat_PhieuYeuCauChiTietID] Parameters: [@param0=[SOLUONGXUAT,10]]
2019-08-16 11:11:43,255 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLDaXuat_PhieuYeuCauChiTietID] Types: [@param0=[Decimal, System.Decimal]]
2019-08-16 11:11:43,482 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuatChiTiet] PreparedStatement : [INSERT INTO TT_INV_CHUNGTUXUATCHITIET(CHUNGTUXUAT_ID,MMYY,THEODOI_ID,SOLUONGYEUCAU,SOLUONGXUAT,THANHTIEN,GHICHU,PHIEUYEUCAUCHITIET_ID,TENNGUOITAO,BENHVIEN_ID,NGAYTAO,NGUOITAO_ID)       VALUES( @param0 , @param1 , @param2 , @param3 , @param4 , @param5 , @param6 , @param7 , @param8 , @param9 ,GETDATE(), @param10 )        SELECT SCOPE_IDENTITY()]
2019-08-16 11:11:43,482 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuatChiTiet] Parameters: [@param0=[CHUNGTUXUAT_ID,6], @param1=[MMYY,0819], @param2=[THEODOI_ID,250], @param3=[SOLUONGYEUCAU,1000], @param4=[SOLUONGXUAT,1000], @param5=[THANHTIEN,0.0000], @param6=[CT_GHICHU,null], @param7=[PHIEUYEUCAUCHITIET_ID,22], @param8=[TENNGUOITAO,null], @param9=[BENHVIEN_ID,HLU01], @param10=[NGUOITAO_ID,null]]
2019-08-16 11:11:43,482 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuatChiTiet] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String], @param2=[Int32, System.Int32], @param3=[Double, System.Double], @param4=[Decimal, System.Decimal], @param5=[Decimal, System.Decimal], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[String, System.String], @param10=[System.DBNull, null]]
2019-08-16 11:11:43,513 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLDaXuat_PhieuYeuCauChiTietID] PreparedStatement : [UPDATE TT_INV_PHIEUYEUCAUCHITIET        SET SOLUONGDAXUAT= @param0         WHERE PHIEUYEUCAUCHITIET_ID = '22' AND BENHVIEN_ID = 'HLU01']
2019-08-16 11:11:43,513 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLDaXuat_PhieuYeuCauChiTietID] Parameters: [@param0=[SOLUONGXUAT,1000]]
2019-08-16 11:11:43,513 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLDaXuat_PhieuYeuCauChiTietID] Types: [@param0=[Decimal, System.Decimal]]
2019-08-16 11:11:43,543 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuatChiTiet] PreparedStatement : [INSERT INTO TT_INV_CHUNGTUXUATCHITIET(CHUNGTUXUAT_ID,MMYY,THEODOI_ID,SOLUONGYEUCAU,SOLUONGXUAT,THANHTIEN,GHICHU,PHIEUYEUCAUCHITIET_ID,TENNGUOITAO,BENHVIEN_ID,NGAYTAO,NGUOITAO_ID)       VALUES( @param0 , @param1 , @param2 , @param3 , @param4 , @param5 , @param6 , @param7 , @param8 , @param9 ,GETDATE(), @param10 )        SELECT SCOPE_IDENTITY()]
2019-08-16 11:11:43,543 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuatChiTiet] Parameters: [@param0=[CHUNGTUXUAT_ID,6], @param1=[MMYY,0819], @param2=[THEODOI_ID,95], @param3=[SOLUONGYEUCAU,1000], @param4=[SOLUONGXUAT,1000], @param5=[THANHTIEN,1000.0000], @param6=[CT_GHICHU,null], @param7=[PHIEUYEUCAUCHITIET_ID,23], @param8=[TENNGUOITAO,null], @param9=[BENHVIEN_ID,HLU01], @param10=[NGUOITAO_ID,null]]
2019-08-16 11:11:43,543 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuatChiTiet] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String], @param2=[Int32, System.Int32], @param3=[Double, System.Double], @param4=[Decimal, System.Decimal], @param5=[Decimal, System.Decimal], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[String, System.String], @param10=[System.DBNull, null]]
2019-08-16 11:11:43,575 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLDaXuat_PhieuYeuCauChiTietID] PreparedStatement : [UPDATE TT_INV_PHIEUYEUCAUCHITIET        SET SOLUONGDAXUAT= @param0         WHERE PHIEUYEUCAUCHITIET_ID = '23' AND BENHVIEN_ID = 'HLU01']
2019-08-16 11:11:43,575 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLDaXuat_PhieuYeuCauChiTietID] Parameters: [@param0=[SOLUONGXUAT,1000]]
2019-08-16 11:11:43,575 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLDaXuat_PhieuYeuCauChiTietID] Types: [@param0=[Decimal, System.Decimal]]
2019-08-16 11:11:43,606 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuatChiTiet] PreparedStatement : [INSERT INTO TT_INV_CHUNGTUXUATCHITIET(CHUNGTUXUAT_ID,MMYY,THEODOI_ID,SOLUONGYEUCAU,SOLUONGXUAT,THANHTIEN,GHICHU,PHIEUYEUCAUCHITIET_ID,TENNGUOITAO,BENHVIEN_ID,NGAYTAO,NGUOITAO_ID)       VALUES( @param0 , @param1 , @param2 , @param3 , @param4 , @param5 , @param6 , @param7 , @param8 , @param9 ,GETDATE(), @param10 )        SELECT SCOPE_IDENTITY()]
2019-08-16 11:11:43,607 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuatChiTiet] Parameters: [@param0=[CHUNGTUXUAT_ID,6], @param1=[MMYY,0819], @param2=[THEODOI_ID,251], @param3=[SOLUONGYEUCAU,200], @param4=[SOLUONGXUAT,200], @param5=[THANHTIEN,0.0000], @param6=[CT_GHICHU,null], @param7=[PHIEUYEUCAUCHITIET_ID,24], @param8=[TENNGUOITAO,null], @param9=[BENHVIEN_ID,HLU01], @param10=[NGUOITAO_ID,null]]
2019-08-16 11:11:43,607 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuatChiTiet] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String], @param2=[Int32, System.Int32], @param3=[Double, System.Double], @param4=[Decimal, System.Decimal], @param5=[Decimal, System.Decimal], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[String, System.String], @param10=[System.DBNull, null]]
2019-08-16 11:11:43,688 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLDaXuat_PhieuYeuCauChiTietID] PreparedStatement : [UPDATE TT_INV_PHIEUYEUCAUCHITIET        SET SOLUONGDAXUAT= @param0         WHERE PHIEUYEUCAUCHITIET_ID = '24' AND BENHVIEN_ID = 'HLU01']
2019-08-16 11:11:43,688 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLDaXuat_PhieuYeuCauChiTietID] Parameters: [@param0=[SOLUONGXUAT,200]]
2019-08-16 11:11:43,689 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLDaXuat_PhieuYeuCauChiTietID] Types: [@param0=[Decimal, System.Decimal]]
2019-08-16 11:11:43,719 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLXuatTonKho] PreparedStatement : [UPDATE TT_INV_TONKHOCHITIET SET SOLUONGXUAT=0 WHERE MMYY='0819' AND MAKHO IN('KCVPP');        MERGE TT_INV_TONKHOCHITIET AS X USING        (SELECT QQ.MMYY, QQ.MAKHO,QQ.TENKHO,QQ.THEODOI_ID,SUM(QQ.SOLUONGXUAT) AS SOLUONGXUAT FROM (        SELECT '0819' AS MMYY, A.MAKHOXUAT AS MAKHO,A.TENKHOXUAT AS TENKHO,B.THEODOI_ID,B.SOLUONGXUAT,C.NGAYTAO,C.NGUOITAO_ID        FROM TT_INV_CHUNGTUXUAT A INNER JOIN TT_INV_CHUNGTUXUATCHITIET B ON A.CHUNGTUXUAT_ID=B.CHUNGTUXUAT_ID AND A.MMYY='0819'        INNER JOIN TT_INV_THEODOI C ON B.THEODOI_ID=C.THEODOI_ID        WHERE A.MMYY='0819' AND A.BENHVIEN_ID='HLU01' AND A.MAKHOXUAT IN('KCVPP')        UNION ALL        SELECT '0819' AS MMYY, A.MAKHO,A.TENKHO,B.THEODOI_ID,B.SOLUONG AS SOLUONGXUAT,C.NGAYTAO,C.NGUOITAO_ID        FROM TT_INV_CHUNGTUTANGGIAM A INNER JOIN TT_INV_CHUNGTUTANGGIAMCHITIET B ON A.CHUNGTUTANGGIAM_ID=B.CHUNGTUTANGGIAM_ID AND A.MMYY='0819' AND A.LOAI='giam'        INNER JOIN TT_INV_THEODOI C ON B.THEODOI_ID=C.THEODOI_ID        WHERE A.MMYY='0819' AND A.LOAI='giam' AND A.BENHVIEN_ID='HLU01' AND A.MAKHO IN('KCVPP')) QQ        GROUP BY QQ.MMYY, QQ.MAKHO,QQ.TENKHO,QQ.THEODOI_ID) AS Y        ON (X.MMYY=Y.MMYY AND X.MAKHO=Y.MAKHO AND X.THEODOI_ID=Y.THEODOI_ID)        WHEN MATCHED THEN UPDATE SET X.SOLUONGXUAT=Y.SOLUONGXUAT        WHEN NOT MATCHED THEN                INSERT (MMYY,MAKHO,TENKHO,THEODOI_ID,SOLUONGXUAT,BENHVIEN_ID,NGAYTAO,NGUOITAO_ID) VALUES        ('0819',Y.MAKHO,Y.TENKHO,Y.THEODOI_ID,Y.SOLUONGXUAT, @param0 ,GETDATE(), '');          UPDATE TT_INV_TONKHOTONGHOP SET SOLUONGTONDAU=0,SOLUONGNHAP=0,SOLUONGXUAT=0 WHERE MMYY='0819' AND MAKHO IN('KCVPP');        MERGE TT_INV_TONKHOTONGHOP AS X USING        (SELECT '0819' AS MMYY,A.MAKHO,A.TENKHO,B.HANGHOA_ID,B.MAHANGHOA,HH.TEN,SUM(A.SOLUONGTONDAU) AS SOLUONGTONDAU,SUM(A.SOLUONGNHAP) AS SOLUONGNHAP,SUM(A.SOLUONGXUAT) AS SOLUONGXUAT        FROM TT_INV_TONKHOCHITIET A INNER JOIN TT_INV_THEODOI B ON A.THEODOI_ID=B.THEODOI_ID AND A.MMYY='0819'        JOIN TM_PUR_HANGHOA HH on HH.ID = B.HANGHOA_ID        WHERE A.MMYY='0819' AND A.BENHVIEN_ID='HLU01' AND A.MAKHO IN('KCVPP')        GROUP BY A.MAKHO,A.TENKHO,B.HANGHOA_ID,B.MAHANGHOA,HH.TEN) AS Y        ON (X.MMYY=Y.MMYY AND X.MAKHO=Y.MAKHO AND X.HANGHOA_ID=Y.HANGHOA_ID)          WHEN MATCHED THEN UPDATE SET X.SOLUONGTONDAU=Y.SOLUONGTONDAU, X.SOLUONGNHAP=Y.SOLUONGNHAP,X.SOLUONGXUAT=Y.SOLUONGXUAT        WHEN NOT MATCHED THEN                INSERT (MMYY,MAKHO,TENKHO,HANGHOA_ID,MAHANGHOA,TENHANGHOA,SOLUONGTONDAU,SOLUONGNHAP,SOLUONGXUAT,BENHVIEN_ID,NGAYTAO)        VALUES ('0819',Y.MAKHO,Y.TENKHO,Y.HANGHOA_ID,Y.MAHANGHOA,Y.TEN,Y.SOLUONGTONDAU,Y.SOLUONGNHAP,Y.SOLUONGXUAT, @param0 ,GETDATE());          DELETE FROM TT_INV_TONKHOCHITIET WHERE SOLUONGTONDAU=0 AND SOLUONGNHAP=0 AND SOLUONGXUAT=0;        DELETE FROM TT_INV_TONKHOTONGHOP WHERE SOLUONGTONDAU=0 AND SOLUONGNHAP=0 AND SOLUONGXUAT=0;]
2019-08-16 11:11:43,719 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLXuatTonKho] Parameters: [@param0=[BENHVIEN_ID,HLU01]]
2019-08-16 11:11:43,719 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLXuatTonKho] Types: [@param0=[String, System.String]]
2019-08-16 11:11:44,261 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdateTrangThaiPO_NhapKho] PreparedStatement : [UPDATE TT_PUR_CHUNGTU SET STATE_CODE =  @param0 , STATE_NAME =  @param1  WHERE MACHUNGTU = 'YC5190525070426' AND PROCESS_CODE = 'PO']
2019-08-16 11:11:44,261 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdateTrangThaiPO_NhapKho] Parameters: [@param0=[STATE_CODE,9], @param1=[STATE_NAME,Đã xuất kho]]
2019-08-16 11:11:44,261 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdateTrangThaiPO_NhapKho] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2019-08-16 11:11:44,501 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatAll] PreparedStatement : [SELECT CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,      CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID,      CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,      TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA      FROM TT_INV_CHUNGTUXUAT CT INNER JOIN TT_INV_CHUNGTUXUATCHITIET CTCT ON CT.CHUNGTUXUAT_ID=CTCT.CHUNGTUXUAT_ID             INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID      where CT.BENHVIEN_ID = 'HLU01' AND CT.MACHUNGTU = 'X190816111142'             ORDER BY TD.TENHANGHOA]
2019-08-16 11:11:44,550 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
--------------------------------------------------------------------------------
2019-08-16 11:29:53,601 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2019-08-16 11:29:53,850 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-08-16 11:29:53,896 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-08-16 11:29:54,348 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 11:29:54,635 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-08-16 11:30:06,792 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2019-08-16 11:30:06,818 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-08-16 11:30:08,450 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-08-16 11:30:08,530 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-08-16 11:30:09,495 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2019-08-16 11:30:09,696 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2019-08-16 11:30:09,776 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2019-08-16 11:30:09,853 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2019-08-16 11:30:09,932 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2019-08-16 11:30:10,009 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2019-08-16 11:30:10,098 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2019-08-16 11:30:10,168 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2019-08-16 11:30:10,247 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2019-08-16 11:30:10,760 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2019-08-16 11:30:10,797 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2019-08-16 11:30:10,877 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2019-08-16 11:30:10,916 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2019-08-16 11:30:11,758 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2019-08-16 11:30:11,790 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 0 as PHAMVI_ID, 0 as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0         end                else        begin        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2019-08-16 11:30:13,686 [5] DEBUG - Statement Id: [DAO00320_GetList] PreparedStatement : [select M.*            from TM_MAU M            LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID            where            M.TAMNGUNG = '0'            and M.BENHVIEN_ID = 'HLU01'            order by M.TENMAU]
2019-08-16 11:30:13,753 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2019-08-16 11:30:13,785 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT          TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,          TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,          SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH          FROM TT_MAU_TONKHO TK          JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID          JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID          JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'          LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID          LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID          WHERE TK.SOLUONG > 0          GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,          TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2019-08-16 11:30:13,879 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2019-08-16 11:30:13,909 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct          TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,          TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,          TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH          from TM_MAU M          JOIN          (          select          A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO          from          (          select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO          from TT_MAU_TONKHO TK          JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID          inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID          left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'          where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0          ) A          )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'          LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID          LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2019-08-16 11:30:13,974 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2019-08-16 11:30:14,921 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 11:30:15,862 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2019-08-16 11:30:22,231 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2019-08-16 11:30:22,260 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2019-08-16 11:30:22,345 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 11:30:22,498 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 11:30:22,638 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2019-08-16 11:30:22,641 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-08-16 11:30:22,641 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-08-16 11:30:22,668 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2019-08-16 11:30:22,668 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-08-16 11:30:22,668 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-08-16 11:30:22,812 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 11:30:22,963 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 11:30:31,994 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 11:30:32,106 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2019-08-16 11:30:32,431 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2019-08-16 11:30:39,869 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'OPD08'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 11:30:44,213 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN190604.0000247']
2019-08-16 11:30:44,393 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"5436","DVYEUCAU_ID":"205317"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"5436","DVYEUCAU_ID":"205317"}' order by ID desc)        order by A.ID desc]
2019-08-16 11:30:53,402 [1] DEBUG - Statement Id: [DAO00080_GetThongTinNgoaiTruKhambenhBenhan] PreparedStatement : [select *        from TT_NGOAITRU_KHAMBENH_BENHAN where        TIEPNHAN_ID = '27373'        and DVYEUCAU_ID = '205317'        and BENHVIEN_ID = 'HLU01']
2019-08-16 11:30:55,242 [1] DEBUG - Statement Id: [DAO00092_TT_NGOAITRU_BENHAN_Getdata] PreparedStatement : [select *        from TT_NGOAITRU_BENHAN        where TIEPNHAN_ID = '27373']
2019-08-16 11:31:00,074 [1] DEBUG - Statement Id: [DAO00067_GetLastSinhhieuNgoaiTruTiepNhan] PreparedStatement : [select top 1 *          from TT_NGOAITRU_KHAMBENH_SINHHIEU          where          TIEPNHAN_ID = '27373'          order by KHAMBENH_SINHHIEU_ID desc]
--------------------------------------------------------------------------------
2019-08-16 11:31:42,547 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2019-08-16 11:31:42,791 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-08-16 11:31:42,832 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-08-16 11:31:43,193 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 11:31:43,423 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-08-16 11:31:50,736 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2019-08-16 11:31:50,766 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-08-16 11:31:52,388 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-08-16 11:31:52,548 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-08-16 11:31:53,428 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2019-08-16 11:31:53,623 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2019-08-16 11:31:53,720 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2019-08-16 11:31:53,794 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2019-08-16 11:31:53,868 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2019-08-16 11:31:53,971 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2019-08-16 11:31:54,053 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2019-08-16 11:31:54,132 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2019-08-16 11:31:54,277 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2019-08-16 11:31:54,785 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2019-08-16 11:31:54,817 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2019-08-16 11:31:54,898 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2019-08-16 11:31:54,933 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2019-08-16 11:31:55,809 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2019-08-16 11:31:55,842 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 0 as PHAMVI_ID, 0 as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0         end                else        begin        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2019-08-16 11:31:57,710 [5] DEBUG - Statement Id: [DAO00320_GetList] PreparedStatement : [select M.*            from TM_MAU M            LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID            where            M.TAMNGUNG = '0'            and M.BENHVIEN_ID = 'HLU01'            order by M.TENMAU]
2019-08-16 11:31:57,780 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2019-08-16 11:31:57,811 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT          TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,          TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,          SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH          FROM TT_MAU_TONKHO TK          JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID          JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID          JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'          LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID          LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID          WHERE TK.SOLUONG > 0          GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,          TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2019-08-16 11:31:57,896 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2019-08-16 11:31:57,926 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct          TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,          TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,          TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH          from TM_MAU M          JOIN          (          select          A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO          from          (          select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO          from TT_MAU_TONKHO TK          JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID          inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID          left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'          where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0          ) A          )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'          LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID          LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2019-08-16 11:31:57,997 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2019-08-16 11:31:58,942 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 11:31:59,866 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2019-08-16 11:32:05,975 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2019-08-16 11:32:06,003 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2019-08-16 11:32:06,100 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 11:32:06,255 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 11:32:06,408 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2019-08-16 11:32:06,411 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-08-16 11:32:06,411 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-08-16 11:32:06,438 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2019-08-16 11:32:06,438 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-08-16 11:32:06,438 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-08-16 11:32:06,596 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 11:32:06,775 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 11:32:14,684 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 11:32:14,772 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2019-08-16 11:32:15,025 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2019-08-16 11:32:24,039 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'OPD08'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 11:32:27,079 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN190604.0000202']
2019-08-16 11:32:27,224 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"5436","DVYEUCAU_ID":"204348"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"5436","DVYEUCAU_ID":"204348"}' order by ID desc)        order by A.ID desc]
2019-08-16 11:32:33,051 [1] DEBUG - Statement Id: [DAO00080_GetThongTinNgoaiTruKhambenhBenhan] PreparedStatement : [select *        from TT_NGOAITRU_KHAMBENH_BENHAN where        TIEPNHAN_ID = '27328'        and DVYEUCAU_ID = '204348'        and BENHVIEN_ID = 'HLU01']
2019-08-16 11:32:33,723 [1] DEBUG - Statement Id: [DAO00092_TT_NGOAITRU_BENHAN_Getdata] PreparedStatement : [select *        from TT_NGOAITRU_BENHAN        where TIEPNHAN_ID = '27328']
2019-08-16 11:32:33,754 [1] DEBUG - Statement Id: [DAO00067_GetLastSinhhieuNgoaiTruTiepNhan] PreparedStatement : [select top 1 *          from TT_NGOAITRU_KHAMBENH_SINHHIEU          where          TIEPNHAN_ID = '27328'          order by KHAMBENH_SINHHIEU_ID desc]
2019-08-16 11:33:02,489 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN190604.0000286']
2019-08-16 11:33:02,576 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"5436","DVYEUCAU_ID":"205094"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"5436","DVYEUCAU_ID":"205094"}' order by ID desc)        order by A.ID desc]
2019-08-16 11:33:04,277 [1] DEBUG - Statement Id: [DAO00080_GetThongTinNgoaiTruKhambenhBenhan] PreparedStatement : [select *        from TT_NGOAITRU_KHAMBENH_BENHAN where        TIEPNHAN_ID = '27413'        and DVYEUCAU_ID = '205094'        and BENHVIEN_ID = 'HLU01']
2019-08-16 11:33:04,364 [1] DEBUG - Statement Id: [DAO00092_TT_NGOAITRU_BENHAN_Getdata] PreparedStatement : [select *        from TT_NGOAITRU_BENHAN        where TIEPNHAN_ID = '27413']
2019-08-16 11:33:04,393 [1] DEBUG - Statement Id: [DAO00067_GetLastSinhhieuNgoaiTruTiepNhan] PreparedStatement : [select top 1 *          from TT_NGOAITRU_KHAMBENH_SINHHIEU          where          TIEPNHAN_ID = '27413'          order by KHAMBENH_SINHHIEU_ID desc]
2019-08-16 11:33:10,366 [1] DEBUG - Statement Id: [DAO00067_GetDanhsachDichvuKhongKhambenh] PreparedStatement : [select B.TENDICHVU          from TT_DVYEUCAU A          left join TM_DICHVU B on A.DICHVU_ID = B.DICHVU_ID          left join TM_NHOMDICHVU C on C.NHOMDICHVU_ID = B.NHOMDICHVU_ID          where LEFT(C.MANHOMDICHVU,2) != '04' and A.HUYYEUCAU = '0'           and             A.TIEPNHAN_ID = '27413']
--------------------------------------------------------------------------------
2019-08-16 15:05:19,939 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2019-08-16 15:05:20,235 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-08-16 15:05:20,280 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-08-16 15:05:20,772 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 15:05:21,064 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-08-16 15:05:30,307 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2019-08-16 15:05:30,360 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-08-16 15:05:32,796 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-08-16 15:05:32,874 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-08-16 15:05:33,826 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2019-08-16 15:05:34,051 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2019-08-16 15:05:34,252 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2019-08-16 15:05:34,347 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2019-08-16 15:05:34,438 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2019-08-16 15:05:34,528 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2019-08-16 15:05:34,626 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2019-08-16 15:05:34,719 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2019-08-16 15:05:34,805 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2019-08-16 15:05:35,330 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2019-08-16 15:05:35,397 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2019-08-16 15:05:35,475 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2019-08-16 15:05:35,525 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2019-08-16 15:05:40,300 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2019-08-16 15:05:40,338 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 0 as PHAMVI_ID, 0 as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0         end                else        begin        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2019-08-16 15:05:43,569 [5] DEBUG - Statement Id: [DAO00320_GetList] PreparedStatement : [select M.*            from TM_MAU M            LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID            where            M.TAMNGUNG = '0'            and M.BENHVIEN_ID = 'HLU01'            order by M.TENMAU]
2019-08-16 15:05:43,671 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2019-08-16 15:05:43,973 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT          TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,          TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,          SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH          FROM TT_MAU_TONKHO TK          JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID          JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID          JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'          LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID          LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID          WHERE TK.SOLUONG > 0          GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,          TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2019-08-16 15:05:44,086 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2019-08-16 15:05:44,118 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct          TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,          TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,          TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH          from TM_MAU M          JOIN          (          select          A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO          from          (          select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO          from TT_MAU_TONKHO TK          JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID          inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID          left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'          where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0          ) A          )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'          LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID          LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2019-08-16 15:05:44,185 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2019-08-16 15:05:45,121 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 15:05:46,504 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2019-08-16 15:05:51,858 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2019-08-16 15:05:51,890 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2019-08-16 15:05:51,973 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 15:05:52,091 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 15:05:52,301 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2019-08-16 15:05:52,302 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-08-16 15:05:52,302 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-08-16 15:05:52,339 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2019-08-16 15:05:52,339 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-08-16 15:05:52,339 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-08-16 15:05:52,471 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 15:05:52,650 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 15:06:03,605 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 15:06:03,708 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2019-08-16 15:06:04,082 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2019-08-16 15:06:12,228 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'STA06'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 15:06:12,570 [1] DEBUG - Statement Id: [DAO00401_INV001_GetDMNhanVien] PreparedStatement : [SELECT NHANVIEN_ID,TENNHANVIEN,NHANVIEN_ID AS NHANVIENNHAN_ID,TENNHANVIEN AS TENNHANVIENNHAN FROM [TM_NHANVIEN]        where BENHVIEN_ID = 'HLU01'        ORDER BY TENNHANVIEN]
2019-08-16 15:06:12,923 [1] DEBUG - Statement Id: [DAO00401_INV001_GetDMKHOVPP] PreparedStatement : [Select K.*,BB.SODU,BB.SODUDENNGAY,BB.KHOASO,BB.NGAYKHOA  From TM_KHO K        LEFT JOIN TM_INV_KHO BB ON K.MAKHO = BB.MAKHO        LEFT JOIN LST_DICTIONARY AA ON AA.DICTIONARY_ID = K.MODULE_ID        WHERE AA.DICTIONARY_CODE = 'KhoVPP']
2019-08-16 15:06:13,715 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 15:06:20,766 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 15:06:23,991 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'STA05'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 15:06:24,633 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM98'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 15:06:25,065 [1] DEBUG - Statement Id: [DAO00401_INV001_PhieuYeuCauSearch] PreparedStatement : [select YC.PHIEUYEUCAU_ID,YC.MAPHIEUYEUCAU,YC.MMYY,YC.NGAYLAP,YC.PHONGBAN_ID,YC.TENPHONGBAN,YC.MAKHOXUAT,YC.TENKHOXUAT,YC.GHICHU,YC.TENNGUOITAO,YC.TENNGUOICAPNHAT,YC.BENHVIEN_ID,YC.NGAYTAO,YC.NGUOITAO_ID,YC.NGAYCAPNHAT,YC.NGUOICAPNHAT_ID        FROM TT_INV_PHIEUYEUCAU YC        WHERE YC.BENHVIEN_ID = 'HLU01' AND YC.NGAYLAP BETWEEN '7/16/2019 3:06:25 PM' AND '8/16/2019 3:06:25 PM'         AND           YC.CHUNGTUXUAT_ID IS NULL         AND           YC.MAKHOXUAT = 'KCVPP']
2019-08-16 15:06:29,617 [1] DEBUG - Statement Id: [DAO00401_INV001_PhieuYeuCauSearch] PreparedStatement : [select YC.PHIEUYEUCAU_ID,YC.MAPHIEUYEUCAU,YC.MMYY,YC.NGAYLAP,YC.PHONGBAN_ID,YC.TENPHONGBAN,YC.MAKHOXUAT,YC.TENKHOXUAT,YC.GHICHU,YC.TENNGUOITAO,YC.TENNGUOICAPNHAT,YC.BENHVIEN_ID,YC.NGAYTAO,YC.NGUOITAO_ID,YC.NGAYCAPNHAT,YC.NGUOICAPNHAT_ID        FROM TT_INV_PHIEUYEUCAU YC        WHERE YC.BENHVIEN_ID = 'HLU01' AND YC.NGAYLAP BETWEEN '5/1/2019 12:00:00 AM' AND '8/16/2019 3:06:25 PM'         AND           YC.CHUNGTUXUAT_ID IS NULL         AND           YC.MAKHOXUAT = 'KCVPP']
2019-08-16 15:06:30,801 [1] DEBUG - Statement Id: [DAO00401_INV001_GetPhieuYeuCauChiTiet_PhieuYeuCauID] PreparedStatement : [select YCCT.PHIEUYEUCAUCHITIET_ID,YCCT.HANGHOA_ID,YCCT.MAHANGHOA,YCCT.TENHANGHOA,YCCT.DONVITINH_ID,YCCT.TENDONVITINH,YCCT.SOLUONGYEUCAU,YCCT.SOLUONGDAXUAT        FROM TT_INV_PHIEUYEUCAUCHITIET YCCT        WHERE YCCT.BENHVIEN_ID = 'HLU01' AND YCCT.PHIEUYEUCAU_ID='23']
2019-08-16 15:06:31,122 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChiTietYC_MaPhieuYeuCau] PreparedStatement : [select YC.PHIEUYEUCAU_ID,YC.MAPHIEUYEUCAU,YC.MMYY,YC.NGAYLAP,YC.PHONGBAN_ID AS PHONGBANNHAN_ID,YC.TENPHONGBAN AS TENPHONGBANNHAN,YC.MAKHOXUAT,YC.TENKHOXUAT,        YCCT.PHIEUYEUCAUCHITIET_ID,YCCT.HANGHOA_ID,YCCT.MAHANGHOA,YCCT.TENHANGHOA,YCCT.DONVITINH_ID,YCCT.TENDONVITINH,YCCT.SOLUONGYEUCAU,YCCT.SOLUONGYEUCAU AS SOLUONGXUAT, NULL AS DONGIA,NULL AS LOSX,NULL AS HANDUNG,        TKTH.SOLUONGTONCUOI        FROM TT_INV_PHIEUYEUCAU YC INNER JOIN TT_INV_PHIEUYEUCAUCHITIET YCCT ON YC.PHIEUYEUCAU_ID=YCCT.PHIEUYEUCAU_ID        LEFT JOIN (SELECT (SOLUONGTONDAU+SOLUONGNHAP-SOLUONGXUAT) AS SOLUONGTONCUOI, HANGHOA_ID,MAKHO        FROM TT_INV_TONKHOTONGHOP WHERE BENHVIEN_ID='HLU01' AND MMYY='0819'        ) TKTH ON YCCT.HANGHOA_ID = TKTH.HANGHOA_ID AND YC.MAKHOXUAT = TKTH.MAKHO        WHERE YC.MAPHIEUYEUCAU='YC13190526081135' AND YC.BENHVIEN_ID = 'HLU01']
2019-08-16 15:06:35,032 [1] DEBUG - Statement Id: [DAO00401_INV001_PhieuYeuCauSearch] PreparedStatement : [select YC.PHIEUYEUCAU_ID,YC.MAPHIEUYEUCAU,YC.MMYY,YC.NGAYLAP,YC.PHONGBAN_ID,YC.TENPHONGBAN,YC.MAKHOXUAT,YC.TENKHOXUAT,YC.GHICHU,YC.TENNGUOITAO,YC.TENNGUOICAPNHAT,YC.BENHVIEN_ID,YC.NGAYTAO,YC.NGUOITAO_ID,YC.NGAYCAPNHAT,YC.NGUOICAPNHAT_ID        FROM TT_INV_PHIEUYEUCAU YC        WHERE YC.BENHVIEN_ID = 'HLU01' AND YC.NGAYLAP BETWEEN '7/16/2019 3:06:35 PM' AND '8/16/2019 3:06:35 PM'         AND           YC.CHUNGTUXUAT_ID IS NULL         AND           YC.MAKHOXUAT = 'KCVPP']
2019-08-16 15:06:41,762 [1] DEBUG - Statement Id: [DAO00401_INV001_PhieuYeuCauSearch] PreparedStatement : [select YC.PHIEUYEUCAU_ID,YC.MAPHIEUYEUCAU,YC.MMYY,YC.NGAYLAP,YC.PHONGBAN_ID,YC.TENPHONGBAN,YC.MAKHOXUAT,YC.TENKHOXUAT,YC.GHICHU,YC.TENNGUOITAO,YC.TENNGUOICAPNHAT,YC.BENHVIEN_ID,YC.NGAYTAO,YC.NGUOITAO_ID,YC.NGAYCAPNHAT,YC.NGUOICAPNHAT_ID        FROM TT_INV_PHIEUYEUCAU YC        WHERE YC.BENHVIEN_ID = 'HLU01' AND YC.NGAYLAP BETWEEN '4/1/2019 12:00:00 AM' AND '8/16/2019 3:06:35 PM'         AND           YC.CHUNGTUXUAT_ID IS NULL         AND           YC.MAKHOXUAT = 'KCVPP']
2019-08-16 15:06:44,571 [1] DEBUG - Statement Id: [DAO00401_INV001_GetPhieuYeuCauChiTiet_PhieuYeuCauID] PreparedStatement : [select YCCT.PHIEUYEUCAUCHITIET_ID,YCCT.HANGHOA_ID,YCCT.MAHANGHOA,YCCT.TENHANGHOA,YCCT.DONVITINH_ID,YCCT.TENDONVITINH,YCCT.SOLUONGYEUCAU,YCCT.SOLUONGDAXUAT        FROM TT_INV_PHIEUYEUCAUCHITIET YCCT        WHERE YCCT.BENHVIEN_ID = 'HLU01' AND YCCT.PHIEUYEUCAU_ID='25']
2019-08-16 15:06:44,906 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChiTietYC_MaPhieuYeuCau] PreparedStatement : [select YC.PHIEUYEUCAU_ID,YC.MAPHIEUYEUCAU,YC.MMYY,YC.NGAYLAP,YC.PHONGBAN_ID AS PHONGBANNHAN_ID,YC.TENPHONGBAN AS TENPHONGBANNHAN,YC.MAKHOXUAT,YC.TENKHOXUAT,        YCCT.PHIEUYEUCAUCHITIET_ID,YCCT.HANGHOA_ID,YCCT.MAHANGHOA,YCCT.TENHANGHOA,YCCT.DONVITINH_ID,YCCT.TENDONVITINH,YCCT.SOLUONGYEUCAU,YCCT.SOLUONGYEUCAU AS SOLUONGXUAT, NULL AS DONGIA,NULL AS LOSX,NULL AS HANDUNG,        TKTH.SOLUONGTONCUOI        FROM TT_INV_PHIEUYEUCAU YC INNER JOIN TT_INV_PHIEUYEUCAUCHITIET YCCT ON YC.PHIEUYEUCAU_ID=YCCT.PHIEUYEUCAU_ID        LEFT JOIN (SELECT (SOLUONGTONDAU+SOLUONGNHAP-SOLUONGXUAT) AS SOLUONGTONCUOI, HANGHOA_ID,MAKHO        FROM TT_INV_TONKHOTONGHOP WHERE BENHVIEN_ID='HLU01' AND MMYY='0819'        ) TKTH ON YCCT.HANGHOA_ID = TKTH.HANGHOA_ID AND YC.MAKHOXUAT = TKTH.MAKHO        WHERE YC.MAPHIEUYEUCAU='YC53190528092336' AND YC.BENHVIEN_ID = 'HLU01']
2019-08-16 15:07:03,069 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 15:07:03,110 [1] DEBUG - Statement Id: [DAO00401_INV001_GetTonKho] PreparedStatement : [SELECT TKTH.HANGHOA_ID,TKTH.MAHANGHOA,TKTH.TENHANGHOA,HH.DONVITINH_ID,HH.TENDONVITINH,SUM(TKTH.SOLUONGTONDAU+TKTH.SOLUONGNHAP-TKTH.SOLUONGXUAT) AS SOLUONGTONCUOI        FROM TM_PUR_HANGHOA HH INNER JOIN TT_INV_TONKHOTONGHOP TKTH ON HH.ID = TKTH.HANGHOA_ID        where TKTH.BENHVIEN_ID = 'HLU01' AND TKTH.MAKHO = 'KCVPP' AND TKTH.MMYY='0819'        GROUP BY TKTH.HANGHOA_ID,TKTH.MAHANGHOA,TKTH.TENHANGHOA,HH.DONVITINH_ID,HH.TENDONVITINH]
2019-08-16 15:07:13,592 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraMaChungTuXuatTonTai] PreparedStatement : [select CT.IDCHUYEN        FROM TT_INV_CHUNGTUXUAT CT        where CT.MACHUNGTU = 'X190816150712' AND CT.BENHVIEN_ID = 'HLU01'         AND         CT.MMYY IN(0819)]
2019-08-16 15:07:45,068 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuat] PreparedStatement : [INSERT INTO TT_INV_CHUNGTUXUAT      (MACHUNGTU,MMYY,NGAYCHUNGTU,MAKHOXUAT,TENKHOXUAT,PHONGBANNHAN_ID,TENPHONGBANNHAN,NHANVIENNHAN_ID,TENNHANVIENNHAN,GHICHU,PHIEUYEUCAU_ID,MAPHIEUYEUCAU,XUATKHOTHEO,TENNGUOITAO,BENHVIEN_ID,NGAYTAO,NGUOITAO_ID             )      VALUES ( @param0 , @param1 , @param2 , @param3 , @param4 , @param5 , @param6 , @param7 , @param8 , @param9 , @param10 , @param11 , @param12 , @param13 , @param14 ,GETDATE(), @param15              )      SELECT SCOPE_IDENTITY()]
2019-08-16 15:07:45,068 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuat] Parameters: [@param0=[MACHUNGTU,X190816150712], @param1=[MMYY,0819], @param2=[NGAYCHUNGTU,8/16/2019 3:06:44 PM], @param3=[MAKHOXUAT,KCVPP], @param4=[TENKHOXUAT,Kho chính VPP], @param5=[PHONGBANNHAN_ID,53], @param6=[TENPHONGBANNHAN,Phòng TCHC - Công nghệ thông tin], @param7=[NHANVIENNHAN_ID,47], @param8=[TENNHANVIENNHAN,Bùi Bá Cường], @param9=[GHICHU,null], @param10=[PHIEUYEUCAU_ID,25], @param11=[MAPHIEUYEUCAU,YC53190528092336], @param12=[XUATKHOTHEO,Hạn dùng], @param13=[TENNGUOITAO,Administrator], @param14=[BENHVIEN_ID,HLU01], @param15=[NGUOITAO_ID,1]]
2019-08-16 15:07:45,068 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuat] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[DateTime, System.DateTime], @param3=[String, System.String], @param4=[String, System.String], @param5=[Int64, System.Int64], @param6=[String, System.String], @param7=[Int64, System.Int64], @param8=[String, System.String], @param9=[System.DBNull, null], @param10=[Int64, System.Int64], @param11=[String, System.String], @param12=[String, System.String], @param13=[String, System.String], @param14=[String, System.String], @param15=[Int64, System.Int64]]
2019-08-16 15:07:51,180 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdChungTuXuatID_PhieuYeuCau] PreparedStatement : [UPDATE TT_INV_PHIEUYEUCAU SET CHUNGTUXUAT_ID =  @param0  WHERE PHIEUYEUCAU_ID = '25' AND BENHVIEN_ID = 'HLU01']
2019-08-16 15:07:51,180 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdChungTuXuatID_PhieuYeuCau] Parameters: [@param0=[CHUNGTUXUAT_ID,7]]
2019-08-16 15:07:51,180 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdChungTuXuatID_PhieuYeuCau] Types: [@param0=[Int64, System.Int64]]
2019-08-16 15:07:56,179 [1] DEBUG - Statement Id: [DAO00401_INV001_GetTonKhoChiTiet] PreparedStatement : [SELECT TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.DONGIA AS DONGIATRUOCVAT,TD.DONGIASAUVAT AS DONGIA,CASE WHEN TD.HANDUNG IS NULL THEN DATEADD(YEAR,999, GETDATE()) ELSE TD.HANDUNG END AS HANDUNG ,TD.NGAYTAO,        SUM(TKCT.SOLUONGTONDAU+TKCT.SOLUONGNHAP-TKCT.SOLUONGXUAT) AS SOLUONGTONCUOI        FROM TM_PUR_HANGHOA HH INNER JOIN TT_INV_THEODOI TD ON HH.ID = TD.HANGHOA_ID        INNER JOIN TT_INV_TONKHOCHITIET TKCT ON TD.THEODOI_ID = TKCT.THEODOI_ID        where TKCT.BENHVIEN_ID = 'HLU01' AND TKCT.MAKHO = 'KCVPP' AND TKCT.MMYY='0819'        GROUP BY TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.DONGIA,TD.DONGIASAUVAT,TD.HANDUNG,TD.NGAYTAO        ORDER BY TD.NGAYTAO]
2019-08-16 15:07:56,221 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuatChiTiet] PreparedStatement : [INSERT INTO TT_INV_CHUNGTUXUATCHITIET(CHUNGTUXUAT_ID,MMYY,THEODOI_ID,SOLUONGYEUCAU,SOLUONGXUAT,THANHTIEN,GHICHU,PHIEUYEUCAUCHITIET_ID,TENNGUOITAO,BENHVIEN_ID,NGAYTAO,NGUOITAO_ID)       VALUES( @param0 , @param1 , @param2 , @param3 , @param4 , @param5 , @param6 , @param7 , @param8 , @param9 ,GETDATE(), @param10 )        SELECT SCOPE_IDENTITY()]
2019-08-16 15:07:56,221 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuatChiTiet] Parameters: [@param0=[CHUNGTUXUAT_ID,7], @param1=[MMYY,0819], @param2=[THEODOI_ID,61], @param3=[SOLUONGYEUCAU,10], @param4=[SOLUONGXUAT,10], @param5=[THANHTIEN,7500.0000], @param6=[CT_GHICHU,null], @param7=[PHIEUYEUCAUCHITIET_ID,52], @param8=[TENNGUOITAO,null], @param9=[BENHVIEN_ID,HLU01], @param10=[NGUOITAO_ID,null]]
2019-08-16 15:07:56,221 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuatChiTiet] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String], @param2=[Int32, System.Int32], @param3=[Double, System.Double], @param4=[Decimal, System.Decimal], @param5=[Decimal, System.Decimal], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[String, System.String], @param10=[System.DBNull, null]]
2019-08-16 15:07:56,257 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLDaXuat_PhieuYeuCauChiTietID] PreparedStatement : [UPDATE TT_INV_PHIEUYEUCAUCHITIET        SET SOLUONGDAXUAT= @param0         WHERE PHIEUYEUCAUCHITIET_ID = '52' AND BENHVIEN_ID = 'HLU01']
2019-08-16 15:07:56,257 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLDaXuat_PhieuYeuCauChiTietID] Parameters: [@param0=[SOLUONGXUAT,10]]
2019-08-16 15:07:56,257 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLDaXuat_PhieuYeuCauChiTietID] Types: [@param0=[Decimal, System.Decimal]]
2019-08-16 15:07:56,294 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuatChiTiet] PreparedStatement : [INSERT INTO TT_INV_CHUNGTUXUATCHITIET(CHUNGTUXUAT_ID,MMYY,THEODOI_ID,SOLUONGYEUCAU,SOLUONGXUAT,THANHTIEN,GHICHU,PHIEUYEUCAUCHITIET_ID,TENNGUOITAO,BENHVIEN_ID,NGAYTAO,NGUOITAO_ID)       VALUES( @param0 , @param1 , @param2 , @param3 , @param4 , @param5 , @param6 , @param7 , @param8 , @param9 ,GETDATE(), @param10 )        SELECT SCOPE_IDENTITY()]
2019-08-16 15:07:56,294 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuatChiTiet] Parameters: [@param0=[CHUNGTUXUAT_ID,7], @param1=[MMYY,0819], @param2=[THEODOI_ID,80], @param3=[SOLUONGYEUCAU,10], @param4=[SOLUONGXUAT,10], @param5=[THANHTIEN,30000.0000], @param6=[CT_GHICHU,null], @param7=[PHIEUYEUCAUCHITIET_ID,53], @param8=[TENNGUOITAO,null], @param9=[BENHVIEN_ID,HLU01], @param10=[NGUOITAO_ID,null]]
2019-08-16 15:07:56,294 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuatChiTiet] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String], @param2=[Int32, System.Int32], @param3=[Double, System.Double], @param4=[Decimal, System.Decimal], @param5=[Decimal, System.Decimal], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[String, System.String], @param10=[System.DBNull, null]]
2019-08-16 15:07:56,332 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLDaXuat_PhieuYeuCauChiTietID] PreparedStatement : [UPDATE TT_INV_PHIEUYEUCAUCHITIET        SET SOLUONGDAXUAT= @param0         WHERE PHIEUYEUCAUCHITIET_ID = '53' AND BENHVIEN_ID = 'HLU01']
2019-08-16 15:07:56,332 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLDaXuat_PhieuYeuCauChiTietID] Parameters: [@param0=[SOLUONGXUAT,10]]
2019-08-16 15:07:56,332 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLDaXuat_PhieuYeuCauChiTietID] Types: [@param0=[Decimal, System.Decimal]]
2019-08-16 15:07:56,371 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuatChiTiet] PreparedStatement : [INSERT INTO TT_INV_CHUNGTUXUATCHITIET(CHUNGTUXUAT_ID,MMYY,THEODOI_ID,SOLUONGYEUCAU,SOLUONGXUAT,THANHTIEN,GHICHU,PHIEUYEUCAUCHITIET_ID,TENNGUOITAO,BENHVIEN_ID,NGAYTAO,NGUOITAO_ID)       VALUES( @param0 , @param1 , @param2 , @param3 , @param4 , @param5 , @param6 , @param7 , @param8 , @param9 ,GETDATE(), @param10 )        SELECT SCOPE_IDENTITY()]
2019-08-16 15:07:56,371 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuatChiTiet] Parameters: [@param0=[CHUNGTUXUAT_ID,7], @param1=[MMYY,0819], @param2=[THEODOI_ID,969], @param3=[SOLUONGYEUCAU,1], @param4=[SOLUONGXUAT,1], @param5=[THANHTIEN,0.0000], @param6=[CT_GHICHU,null], @param7=[PHIEUYEUCAUCHITIET_ID,54], @param8=[TENNGUOITAO,null], @param9=[BENHVIEN_ID,HLU01], @param10=[NGUOITAO_ID,null]]
2019-08-16 15:07:56,371 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuatChiTiet] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String], @param2=[Int32, System.Int32], @param3=[Double, System.Double], @param4=[Decimal, System.Decimal], @param5=[Decimal, System.Decimal], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[String, System.String], @param10=[System.DBNull, null]]
2019-08-16 15:07:56,405 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLDaXuat_PhieuYeuCauChiTietID] PreparedStatement : [UPDATE TT_INV_PHIEUYEUCAUCHITIET        SET SOLUONGDAXUAT= @param0         WHERE PHIEUYEUCAUCHITIET_ID = '54' AND BENHVIEN_ID = 'HLU01']
2019-08-16 15:07:56,405 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLDaXuat_PhieuYeuCauChiTietID] Parameters: [@param0=[SOLUONGXUAT,1]]
2019-08-16 15:07:56,405 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLDaXuat_PhieuYeuCauChiTietID] Types: [@param0=[Decimal, System.Decimal]]
2019-08-16 15:07:56,436 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuatChiTiet] PreparedStatement : [INSERT INTO TT_INV_CHUNGTUXUATCHITIET(CHUNGTUXUAT_ID,MMYY,THEODOI_ID,SOLUONGYEUCAU,SOLUONGXUAT,THANHTIEN,GHICHU,PHIEUYEUCAUCHITIET_ID,TENNGUOITAO,BENHVIEN_ID,NGAYTAO,NGUOITAO_ID)       VALUES( @param0 , @param1 , @param2 , @param3 , @param4 , @param5 , @param6 , @param7 , @param8 , @param9 ,GETDATE(), @param10 )        SELECT SCOPE_IDENTITY()]
2019-08-16 15:07:56,436 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuatChiTiet] Parameters: [@param0=[CHUNGTUXUAT_ID,7], @param1=[MMYY,0819], @param2=[THEODOI_ID,10], @param3=[SOLUONGYEUCAU,2], @param4=[SOLUONGXUAT,2], @param5=[THANHTIEN,20600.0000], @param6=[CT_GHICHU,null], @param7=[PHIEUYEUCAUCHITIET_ID,55], @param8=[TENNGUOITAO,null], @param9=[BENHVIEN_ID,HLU01], @param10=[NGUOITAO_ID,null]]
2019-08-16 15:07:56,436 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuatChiTiet] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String], @param2=[Int32, System.Int32], @param3=[Double, System.Double], @param4=[Decimal, System.Decimal], @param5=[Decimal, System.Decimal], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[String, System.String], @param10=[System.DBNull, null]]
2019-08-16 15:07:56,471 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLDaXuat_PhieuYeuCauChiTietID] PreparedStatement : [UPDATE TT_INV_PHIEUYEUCAUCHITIET        SET SOLUONGDAXUAT= @param0         WHERE PHIEUYEUCAUCHITIET_ID = '55' AND BENHVIEN_ID = 'HLU01']
2019-08-16 15:07:56,471 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLDaXuat_PhieuYeuCauChiTietID] Parameters: [@param0=[SOLUONGXUAT,2]]
2019-08-16 15:07:56,471 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLDaXuat_PhieuYeuCauChiTietID] Types: [@param0=[Decimal, System.Decimal]]
2019-08-16 15:07:56,502 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuatChiTiet] PreparedStatement : [INSERT INTO TT_INV_CHUNGTUXUATCHITIET(CHUNGTUXUAT_ID,MMYY,THEODOI_ID,SOLUONGYEUCAU,SOLUONGXUAT,THANHTIEN,GHICHU,PHIEUYEUCAUCHITIET_ID,TENNGUOITAO,BENHVIEN_ID,NGAYTAO,NGUOITAO_ID)       VALUES( @param0 , @param1 , @param2 , @param3 , @param4 , @param5 , @param6 , @param7 , @param8 , @param9 ,GETDATE(), @param10 )        SELECT SCOPE_IDENTITY()]
2019-08-16 15:07:56,503 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuatChiTiet] Parameters: [@param0=[CHUNGTUXUAT_ID,7], @param1=[MMYY,0819], @param2=[THEODOI_ID,85], @param3=[SOLUONGYEUCAU,5], @param4=[SOLUONGXUAT,5], @param5=[THANHTIEN,11665.0000], @param6=[CT_GHICHU,null], @param7=[PHIEUYEUCAUCHITIET_ID,56], @param8=[TENNGUOITAO,null], @param9=[BENHVIEN_ID,HLU01], @param10=[NGUOITAO_ID,null]]
2019-08-16 15:07:56,503 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuatChiTiet] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String], @param2=[Int32, System.Int32], @param3=[Double, System.Double], @param4=[Decimal, System.Decimal], @param5=[Decimal, System.Decimal], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[String, System.String], @param10=[System.DBNull, null]]
2019-08-16 15:07:56,549 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLDaXuat_PhieuYeuCauChiTietID] PreparedStatement : [UPDATE TT_INV_PHIEUYEUCAUCHITIET        SET SOLUONGDAXUAT= @param0         WHERE PHIEUYEUCAUCHITIET_ID = '56' AND BENHVIEN_ID = 'HLU01']
2019-08-16 15:07:56,549 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLDaXuat_PhieuYeuCauChiTietID] Parameters: [@param0=[SOLUONGXUAT,5]]
2019-08-16 15:07:56,549 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLDaXuat_PhieuYeuCauChiTietID] Types: [@param0=[Decimal, System.Decimal]]
2019-08-16 15:07:56,586 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuatChiTiet] PreparedStatement : [INSERT INTO TT_INV_CHUNGTUXUATCHITIET(CHUNGTUXUAT_ID,MMYY,THEODOI_ID,SOLUONGYEUCAU,SOLUONGXUAT,THANHTIEN,GHICHU,PHIEUYEUCAUCHITIET_ID,TENNGUOITAO,BENHVIEN_ID,NGAYTAO,NGUOITAO_ID)       VALUES( @param0 , @param1 , @param2 , @param3 , @param4 , @param5 , @param6 , @param7 , @param8 , @param9 ,GETDATE(), @param10 )        SELECT SCOPE_IDENTITY()]
2019-08-16 15:07:56,587 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuatChiTiet] Parameters: [@param0=[CHUNGTUXUAT_ID,7], @param1=[MMYY,0819], @param2=[THEODOI_ID,960], @param3=[SOLUONGYEUCAU,1], @param4=[SOLUONGXUAT,1], @param5=[THANHTIEN,0.0000], @param6=[CT_GHICHU,null], @param7=[PHIEUYEUCAUCHITIET_ID,57], @param8=[TENNGUOITAO,null], @param9=[BENHVIEN_ID,HLU01], @param10=[NGUOITAO_ID,null]]
2019-08-16 15:07:56,587 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuatChiTiet] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String], @param2=[Int32, System.Int32], @param3=[Double, System.Double], @param4=[Decimal, System.Decimal], @param5=[Decimal, System.Decimal], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[String, System.String], @param10=[System.DBNull, null]]
2019-08-16 15:07:56,620 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLDaXuat_PhieuYeuCauChiTietID] PreparedStatement : [UPDATE TT_INV_PHIEUYEUCAUCHITIET        SET SOLUONGDAXUAT= @param0         WHERE PHIEUYEUCAUCHITIET_ID = '57' AND BENHVIEN_ID = 'HLU01']
2019-08-16 15:07:56,620 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLDaXuat_PhieuYeuCauChiTietID] Parameters: [@param0=[SOLUONGXUAT,1]]
2019-08-16 15:07:56,620 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLDaXuat_PhieuYeuCauChiTietID] Types: [@param0=[Decimal, System.Decimal]]
2019-08-16 15:07:56,651 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLXuatTonKho] PreparedStatement : [UPDATE TT_INV_TONKHOCHITIET SET SOLUONGXUAT=0 WHERE MMYY='0819' AND MAKHO IN('KCVPP');        MERGE TT_INV_TONKHOCHITIET AS X USING        (SELECT QQ.MMYY, QQ.MAKHO,QQ.TENKHO,QQ.THEODOI_ID,SUM(QQ.SOLUONGXUAT) AS SOLUONGXUAT FROM (        SELECT '0819' AS MMYY, A.MAKHOXUAT AS MAKHO,A.TENKHOXUAT AS TENKHO,B.THEODOI_ID,B.SOLUONGXUAT,C.NGAYTAO,C.NGUOITAO_ID        FROM TT_INV_CHUNGTUXUAT A INNER JOIN TT_INV_CHUNGTUXUATCHITIET B ON A.CHUNGTUXUAT_ID=B.CHUNGTUXUAT_ID AND A.MMYY='0819'        INNER JOIN TT_INV_THEODOI C ON B.THEODOI_ID=C.THEODOI_ID        WHERE A.MMYY='0819' AND A.BENHVIEN_ID='HLU01' AND A.MAKHOXUAT IN('KCVPP')        UNION ALL        SELECT '0819' AS MMYY, A.MAKHO,A.TENKHO,B.THEODOI_ID,B.SOLUONG AS SOLUONGXUAT,C.NGAYTAO,C.NGUOITAO_ID        FROM TT_INV_CHUNGTUTANGGIAM A INNER JOIN TT_INV_CHUNGTUTANGGIAMCHITIET B ON A.CHUNGTUTANGGIAM_ID=B.CHUNGTUTANGGIAM_ID AND A.MMYY='0819' AND A.LOAI='giam'        INNER JOIN TT_INV_THEODOI C ON B.THEODOI_ID=C.THEODOI_ID        WHERE A.MMYY='0819' AND A.LOAI='giam' AND A.BENHVIEN_ID='HLU01' AND A.MAKHO IN('KCVPP')) QQ        GROUP BY QQ.MMYY, QQ.MAKHO,QQ.TENKHO,QQ.THEODOI_ID) AS Y        ON (X.MMYY=Y.MMYY AND X.MAKHO=Y.MAKHO AND X.THEODOI_ID=Y.THEODOI_ID)        WHEN MATCHED THEN UPDATE SET X.SOLUONGXUAT=Y.SOLUONGXUAT        WHEN NOT MATCHED THEN                INSERT (MMYY,MAKHO,TENKHO,THEODOI_ID,SOLUONGXUAT,BENHVIEN_ID,NGAYTAO,NGUOITAO_ID) VALUES        ('0819',Y.MAKHO,Y.TENKHO,Y.THEODOI_ID,Y.SOLUONGXUAT, @param0 ,GETDATE(), '');          UPDATE TT_INV_TONKHOTONGHOP SET SOLUONGTONDAU=0,SOLUONGNHAP=0,SOLUONGXUAT=0 WHERE MMYY='0819' AND MAKHO IN('KCVPP');        MERGE TT_INV_TONKHOTONGHOP AS X USING        (SELECT '0819' AS MMYY,A.MAKHO,A.TENKHO,B.HANGHOA_ID,B.MAHANGHOA,HH.TEN,SUM(A.SOLUONGTONDAU) AS SOLUONGTONDAU,SUM(A.SOLUONGNHAP) AS SOLUONGNHAP,SUM(A.SOLUONGXUAT) AS SOLUONGXUAT        FROM TT_INV_TONKHOCHITIET A INNER JOIN TT_INV_THEODOI B ON A.THEODOI_ID=B.THEODOI_ID AND A.MMYY='0819'        JOIN TM_PUR_HANGHOA HH on HH.ID = B.HANGHOA_ID        WHERE A.MMYY='0819' AND A.BENHVIEN_ID='HLU01' AND A.MAKHO IN('KCVPP')        GROUP BY A.MAKHO,A.TENKHO,B.HANGHOA_ID,B.MAHANGHOA,HH.TEN) AS Y        ON (X.MMYY=Y.MMYY AND X.MAKHO=Y.MAKHO AND X.HANGHOA_ID=Y.HANGHOA_ID)          WHEN MATCHED THEN UPDATE SET X.SOLUONGTONDAU=Y.SOLUONGTONDAU, X.SOLUONGNHAP=Y.SOLUONGNHAP,X.SOLUONGXUAT=Y.SOLUONGXUAT        WHEN NOT MATCHED THEN                INSERT (MMYY,MAKHO,TENKHO,HANGHOA_ID,MAHANGHOA,TENHANGHOA,SOLUONGTONDAU,SOLUONGNHAP,SOLUONGXUAT,BENHVIEN_ID,NGAYTAO)        VALUES ('0819',Y.MAKHO,Y.TENKHO,Y.HANGHOA_ID,Y.MAHANGHOA,Y.TEN,Y.SOLUONGTONDAU,Y.SOLUONGNHAP,Y.SOLUONGXUAT, @param0 ,GETDATE());          DELETE FROM TT_INV_TONKHOCHITIET WHERE SOLUONGTONDAU=0 AND SOLUONGNHAP=0 AND SOLUONGXUAT=0;        DELETE FROM TT_INV_TONKHOTONGHOP WHERE SOLUONGTONDAU=0 AND SOLUONGNHAP=0 AND SOLUONGXUAT=0;]
2019-08-16 15:07:56,651 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLXuatTonKho] Parameters: [@param0=[BENHVIEN_ID,HLU01]]
2019-08-16 15:07:56,651 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLXuatTonKho] Types: [@param0=[String, System.String]]
2019-08-16 15:07:56,702 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdateTrangThaiPO_NhapKho] PreparedStatement : [UPDATE TT_PUR_CHUNGTU SET STATE_CODE =  @param0 , STATE_NAME =  @param1  WHERE MACHUNGTU = 'YC53190528092336' AND PROCESS_CODE = 'PO']
2019-08-16 15:07:56,702 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdateTrangThaiPO_NhapKho] Parameters: [@param0=[STATE_CODE,9], @param1=[STATE_NAME,Đã xuất kho]]
2019-08-16 15:07:56,702 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdateTrangThaiPO_NhapKho] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2019-08-16 15:07:57,060 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatAll] PreparedStatement : [SELECT CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,      CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID,      CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,      TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA      FROM TT_INV_CHUNGTUXUAT CT INNER JOIN TT_INV_CHUNGTUXUATCHITIET CTCT ON CT.CHUNGTUXUAT_ID=CTCT.CHUNGTUXUAT_ID             INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID      where CT.BENHVIEN_ID = 'HLU01' AND CT.MACHUNGTU = 'X190816150712'             ORDER BY TD.TENHANGHOA]
2019-08-16 15:07:57,117 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
--------------------------------------------------------------------------------
2019-08-16 15:10:08,696 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2019-08-16 15:10:09,334 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-08-16 15:10:09,377 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-08-16 15:10:09,747 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 15:10:10,148 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-08-16 15:10:16,913 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2019-08-16 15:10:16,953 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-08-16 15:10:18,547 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-08-16 15:10:18,698 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-08-16 15:10:19,642 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2019-08-16 15:10:19,783 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2019-08-16 15:10:19,858 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2019-08-16 15:10:19,936 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2019-08-16 15:10:20,021 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2019-08-16 15:10:20,093 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2019-08-16 15:10:20,191 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2019-08-16 15:10:20,273 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2019-08-16 15:10:20,354 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2019-08-16 15:10:20,869 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2019-08-16 15:10:20,902 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2019-08-16 15:10:20,975 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2019-08-16 15:10:21,011 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2019-08-16 15:10:25,432 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2019-08-16 15:10:25,469 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 0 as PHAMVI_ID, 0 as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0         end                else        begin        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2019-08-16 15:10:29,009 [5] DEBUG - Statement Id: [DAO00320_GetList] PreparedStatement : [select M.*            from TM_MAU M            LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID            where            M.TAMNGUNG = '0'            and M.BENHVIEN_ID = 'HLU01'            order by M.TENMAU]
2019-08-16 15:10:29,076 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2019-08-16 15:10:29,121 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT          TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,          TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,          SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH          FROM TT_MAU_TONKHO TK          JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID          JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID          JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'          LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID          LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID          WHERE TK.SOLUONG > 0          GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,          TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2019-08-16 15:10:29,191 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2019-08-16 15:10:29,228 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct          TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,          TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,          TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH          from TM_MAU M          JOIN          (          select          A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO          from          (          select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO          from TT_MAU_TONKHO TK          JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID          inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID          left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'          where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0          ) A          )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'          LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID          LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2019-08-16 15:10:29,297 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2019-08-16 15:10:30,233 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 15:10:31,112 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2019-08-16 15:10:35,921 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2019-08-16 15:10:35,953 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2019-08-16 15:10:36,028 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 15:10:36,146 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 15:10:36,288 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2019-08-16 15:10:36,289 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-08-16 15:10:36,290 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-08-16 15:10:36,323 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2019-08-16 15:10:36,323 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-08-16 15:10:36,323 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-08-16 15:10:36,452 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 15:10:36,602 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 15:10:43,938 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 15:10:44,195 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2019-08-16 15:10:44,482 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2019-08-16 15:10:48,671 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'STA06'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 15:10:49,021 [1] DEBUG - Statement Id: [DAO00401_INV001_GetDMNhanVien] PreparedStatement : [SELECT NHANVIEN_ID,TENNHANVIEN,NHANVIEN_ID AS NHANVIENNHAN_ID,TENNHANVIEN AS TENNHANVIENNHAN FROM [TM_NHANVIEN]        where BENHVIEN_ID = 'HLU01'        ORDER BY TENNHANVIEN]
2019-08-16 15:10:49,725 [1] DEBUG - Statement Id: [DAO00401_INV001_GetDMKHOVPP] PreparedStatement : [Select K.*,BB.SODU,BB.SODUDENNGAY,BB.KHOASO,BB.NGAYKHOA  From TM_KHO K        LEFT JOIN TM_INV_KHO BB ON K.MAKHO = BB.MAKHO        LEFT JOIN LST_DICTIONARY AA ON AA.DICTIONARY_ID = K.MODULE_ID        WHERE AA.DICTIONARY_CODE = 'KhoVPP']
2019-08-16 15:10:49,912 [1] DEBUG - Statement Id: [DAO00401_GetListMucDichChungTu] PreparedStatement : [SELECT DICTIONARY_ID, DICTIONARY_CODE, DICTIONARY_NAME        FROM LST_DICTIONARY        WHERE DICTIONARY_TYPE_CODE = 'VPP_MucDichChungTu'        AND ENABLED = '1']
2019-08-16 15:10:50,674 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 15:11:01,087 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'STA05'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 15:11:01,309 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM98'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 15:11:01,751 [1] DEBUG - Statement Id: [DAO00401_INV001_PhieuYeuCauSearch] PreparedStatement : [select YC.PHIEUYEUCAU_ID,YC.MAPHIEUYEUCAU,YC.MMYY,YC.NGAYLAP,YC.PHONGBAN_ID,YC.TENPHONGBAN,YC.MAKHOXUAT,YC.TENKHOXUAT,YC.GHICHU,YC.TENNGUOITAO,YC.TENNGUOICAPNHAT,YC.BENHVIEN_ID,YC.NGAYTAO,YC.NGUOITAO_ID,YC.NGAYCAPNHAT,YC.NGUOICAPNHAT_ID        FROM TT_INV_PHIEUYEUCAU YC        WHERE YC.BENHVIEN_ID = 'HLU01' AND YC.NGAYLAP BETWEEN '7/16/2019 3:11:01 PM' AND '8/16/2019 3:11:01 PM'         AND           YC.CHUNGTUXUAT_ID IS NULL         AND           YC.MAKHOXUAT = 'KCVPP']
2019-08-16 15:11:05,399 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 15:11:05,448 [1] DEBUG - Statement Id: [DAO00401_INV001_GetTonKho] PreparedStatement : [SELECT TKTH.HANGHOA_ID,TKTH.MAHANGHOA,TKTH.TENHANGHOA,HH.DONVITINH_ID,HH.TENDONVITINH,SUM(TKTH.SOLUONGTONDAU+TKTH.SOLUONGNHAP-TKTH.SOLUONGXUAT) AS SOLUONGTONCUOI        FROM TM_PUR_HANGHOA HH INNER JOIN TT_INV_TONKHOTONGHOP TKTH ON HH.ID = TKTH.HANGHOA_ID        where TKTH.BENHVIEN_ID = 'HLU01' AND TKTH.MAKHO = 'KCVPP' AND TKTH.MMYY='0819'        GROUP BY TKTH.HANGHOA_ID,TKTH.MAHANGHOA,TKTH.TENHANGHOA,HH.DONVITINH_ID,HH.TENDONVITINH]
2019-08-16 15:11:08,186 [1] DEBUG - Statement Id: [DAO00401_INV001_PhieuYeuCauSearch] PreparedStatement : [select YC.PHIEUYEUCAU_ID,YC.MAPHIEUYEUCAU,YC.MMYY,YC.NGAYLAP,YC.PHONGBAN_ID,YC.TENPHONGBAN,YC.MAKHOXUAT,YC.TENKHOXUAT,YC.GHICHU,YC.TENNGUOITAO,YC.TENNGUOICAPNHAT,YC.BENHVIEN_ID,YC.NGAYTAO,YC.NGUOITAO_ID,YC.NGAYCAPNHAT,YC.NGUOICAPNHAT_ID        FROM TT_INV_PHIEUYEUCAU YC        WHERE YC.BENHVIEN_ID = 'HLU01' AND YC.NGAYLAP BETWEEN '7/16/2019 3:11:08 PM' AND '8/16/2019 3:11:08 PM'         AND           YC.CHUNGTUXUAT_ID IS NULL         AND           YC.MAKHOXUAT = 'KCVPP']
2019-08-16 15:11:12,682 [1] DEBUG - Statement Id: [DAO00401_INV001_PhieuYeuCauSearch] PreparedStatement : [select YC.PHIEUYEUCAU_ID,YC.MAPHIEUYEUCAU,YC.MMYY,YC.NGAYLAP,YC.PHONGBAN_ID,YC.TENPHONGBAN,YC.MAKHOXUAT,YC.TENKHOXUAT,YC.GHICHU,YC.TENNGUOITAO,YC.TENNGUOICAPNHAT,YC.BENHVIEN_ID,YC.NGAYTAO,YC.NGUOITAO_ID,YC.NGAYCAPNHAT,YC.NGUOICAPNHAT_ID        FROM TT_INV_PHIEUYEUCAU YC        WHERE YC.BENHVIEN_ID = 'HLU01' AND YC.NGAYLAP BETWEEN '5/1/2019 12:00:00 AM' AND '8/16/2019 3:11:08 PM'         AND           YC.CHUNGTUXUAT_ID IS NULL         AND           YC.MAKHOXUAT = 'KCVPP']
2019-08-16 15:11:14,092 [1] DEBUG - Statement Id: [DAO00401_INV001_GetPhieuYeuCauChiTiet_PhieuYeuCauID] PreparedStatement : [select YCCT.PHIEUYEUCAUCHITIET_ID,YCCT.HANGHOA_ID,YCCT.MAHANGHOA,YCCT.TENHANGHOA,YCCT.DONVITINH_ID,YCCT.TENDONVITINH,YCCT.SOLUONGYEUCAU,YCCT.SOLUONGDAXUAT        FROM TT_INV_PHIEUYEUCAUCHITIET YCCT        WHERE YCCT.BENHVIEN_ID = 'HLU01' AND YCCT.PHIEUYEUCAU_ID='26']
2019-08-16 15:11:14,369 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChiTietYC_MaPhieuYeuCau] PreparedStatement : [select YC.PHIEUYEUCAU_ID,YC.MAPHIEUYEUCAU,YC.MMYY,YC.NGAYLAP,YC.PHONGBAN_ID AS PHONGBANNHAN_ID,YC.TENPHONGBAN AS TENPHONGBANNHAN,YC.MAKHOXUAT,YC.TENKHOXUAT,        YCCT.PHIEUYEUCAUCHITIET_ID,YCCT.HANGHOA_ID,YCCT.MAHANGHOA,YCCT.TENHANGHOA,YCCT.DONVITINH_ID,YCCT.TENDONVITINH,YCCT.SOLUONGYEUCAU,YCCT.SOLUONGYEUCAU AS SOLUONGXUAT, NULL AS DONGIA,NULL AS LOSX,NULL AS HANDUNG,        TKTH.SOLUONGTONCUOI        FROM TT_INV_PHIEUYEUCAU YC INNER JOIN TT_INV_PHIEUYEUCAUCHITIET YCCT ON YC.PHIEUYEUCAU_ID=YCCT.PHIEUYEUCAU_ID        LEFT JOIN (SELECT (SOLUONGTONDAU+SOLUONGNHAP-SOLUONGXUAT) AS SOLUONGTONCUOI, HANGHOA_ID,MAKHO        FROM TT_INV_TONKHOTONGHOP WHERE BENHVIEN_ID='HLU01' AND MMYY='0819'        ) TKTH ON YCCT.HANGHOA_ID = TKTH.HANGHOA_ID AND YC.MAKHOXUAT = TKTH.MAKHO        WHERE YC.MAPHIEUYEUCAU='YC53190528093211' AND YC.BENHVIEN_ID = 'HLU01']
2019-08-16 15:11:17,601 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 15:11:17,652 [1] DEBUG - Statement Id: [DAO00401_INV001_GetTonKho] PreparedStatement : [SELECT TKTH.HANGHOA_ID,TKTH.MAHANGHOA,TKTH.TENHANGHOA,HH.DONVITINH_ID,HH.TENDONVITINH,SUM(TKTH.SOLUONGTONDAU+TKTH.SOLUONGNHAP-TKTH.SOLUONGXUAT) AS SOLUONGTONCUOI        FROM TM_PUR_HANGHOA HH INNER JOIN TT_INV_TONKHOTONGHOP TKTH ON HH.ID = TKTH.HANGHOA_ID        where TKTH.BENHVIEN_ID = 'HLU01' AND TKTH.MAKHO = 'KCVPP' AND TKTH.MMYY='0819'        GROUP BY TKTH.HANGHOA_ID,TKTH.MAHANGHOA,TKTH.TENHANGHOA,HH.DONVITINH_ID,HH.TENDONVITINH]
2019-08-16 15:11:47,484 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraMaChungTuXuatTonTai] PreparedStatement : [select CT.IDCHUYEN        FROM TT_INV_CHUNGTUXUAT CT        where CT.MACHUNGTU = 'X190816151144' AND CT.BENHVIEN_ID = 'HLU01'         AND         CT.MMYY IN(0819)]
2019-08-16 15:11:52,393 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuat] PreparedStatement : [INSERT INTO TT_INV_CHUNGTUXUAT      (MACHUNGTU,MMYY,NGAYCHUNGTU,MAKHOXUAT,TENKHOXUAT,PHONGBANNHAN_ID,TENPHONGBANNHAN,NHANVIENNHAN_ID,TENNHANVIENNHAN,GHICHU,PHIEUYEUCAU_ID,MAPHIEUYEUCAU,XUATKHOTHEO,TENNGUOITAO,BENHVIEN_ID,NGAYTAO,NGUOITAO_ID                , MUCDICHCHUNGTU_ID                , MUCDICHCHUNGTU_CODE             )      VALUES ( @param0 , @param1 , @param2 , @param3 , @param4 , @param5 , @param6 , @param7 , @param8 , @param9 , @param10 , @param11 , @param12 , @param13 , @param14 ,GETDATE(), @param15                 ,  @param16                 ,  @param17              )      SELECT SCOPE_IDENTITY()]
2019-08-16 15:11:52,393 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuat] Parameters: [@param0=[MACHUNGTU,X190816151144], @param1=[MMYY,0819], @param2=[NGAYCHUNGTU,8/16/2019 3:11:14 PM], @param3=[MAKHOXUAT,KCVPP], @param4=[TENKHOXUAT,Kho chính VPP], @param5=[PHONGBANNHAN_ID,53], @param6=[TENPHONGBANNHAN,Phòng TCHC - Công nghệ thông tin], @param7=[NHANVIENNHAN_ID,null], @param8=[TENNHANVIENNHAN,], @param9=[GHICHU,null], @param10=[PHIEUYEUCAU_ID,26], @param11=[MAPHIEUYEUCAU,YC53190528093211], @param12=[XUATKHOTHEO,Hạn dùng], @param13=[TENNGUOITAO,Administrator], @param14=[BENHVIEN_ID,HLU01], @param15=[NGUOITAO_ID,1], @param16=[MUCDICHCHUNGTU_ID,null], @param17=[MUCDICHCHUNGTU_CODE,null]]
2019-08-16 15:11:52,393 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuat] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[DateTime, System.DateTime], @param3=[String, System.String], @param4=[String, System.String], @param5=[Int64, System.Int64], @param6=[String, System.String], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[System.DBNull, null], @param10=[Int64, System.Int64], @param11=[String, System.String], @param12=[String, System.String], @param13=[String, System.String], @param14=[String, System.String], @param15=[Int64, System.Int64], @param16=[System.DBNull, null], @param17=[System.DBNull, null]]
2019-08-16 15:12:25,128 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'STA07'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 15:12:25,384 [1] DEBUG - Statement Id: [DAO00401_INV001_ChungTuXuatSearch] PreparedStatement : [select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/16/2019 3:12:25 PM' AND '8/16/2019 3:12:25 PM'        AND CT.MAKHOXUAT = 'KCVPP'                   UNION          select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/16/2019 3:12:25 PM' AND '8/16/2019 3:12:25 PM'        AND CT.MAKHOXUAT = 'KCVPP']
2019-08-16 15:12:25,532 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatChiTiet_ChungTuID] PreparedStatement : [select CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        FROM TT_INV_CHUNGTUXUATCHITIET CTCT INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID        WHERE CTCT.BENHVIEN_ID = 'HLU01' AND CTCT.CHUNGTUXUAT_ID='6']
2019-08-16 15:12:43,101 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 15:12:45,374 [1] DEBUG - Statement Id: [DAO00401_INV001_ChungTuXuatSearch] PreparedStatement : [select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/16/2019 3:12:45 PM' AND '8/16/2019 3:12:45 PM'        AND CT.MAKHOXUAT = 'KCVPP'                   UNION          select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/16/2019 3:12:45 PM' AND '8/16/2019 3:12:45 PM'        AND CT.MAKHOXUAT = 'KCVPP']
2019-08-16 15:13:09,162 [1] DEBUG - Statement Id: [DAO00401_INV001_GetPhieuYeuCauChiTiet_PhieuYeuCauID] PreparedStatement : [select YCCT.PHIEUYEUCAUCHITIET_ID,YCCT.HANGHOA_ID,YCCT.MAHANGHOA,YCCT.TENHANGHOA,YCCT.DONVITINH_ID,YCCT.TENDONVITINH,YCCT.SOLUONGYEUCAU,YCCT.SOLUONGDAXUAT        FROM TT_INV_PHIEUYEUCAUCHITIET YCCT        WHERE YCCT.BENHVIEN_ID = 'HLU01' AND YCCT.PHIEUYEUCAU_ID='23']
2019-08-16 15:13:09,214 [1] DEBUG - Statement Id: [DAO00401_INV001_PhieuYeuCauSearch] PreparedStatement : [select YC.PHIEUYEUCAU_ID,YC.MAPHIEUYEUCAU,YC.MMYY,YC.NGAYLAP,YC.PHONGBAN_ID,YC.TENPHONGBAN,YC.MAKHOXUAT,YC.TENKHOXUAT,YC.GHICHU,YC.TENNGUOITAO,YC.TENNGUOICAPNHAT,YC.BENHVIEN_ID,YC.NGAYTAO,YC.NGUOITAO_ID,YC.NGAYCAPNHAT,YC.NGUOICAPNHAT_ID        FROM TT_INV_PHIEUYEUCAU YC        WHERE YC.BENHVIEN_ID = 'HLU01' AND YC.NGAYLAP BETWEEN '7/16/2019 3:13:09 PM' AND '8/16/2019 3:13:09 PM'         AND           YC.CHUNGTUXUAT_ID IS NULL         AND           YC.MAKHOXUAT = 'KCVPP']
2019-08-16 15:13:13,489 [1] DEBUG - Statement Id: [DAO00401_INV001_PhieuYeuCauSearch] PreparedStatement : [select YC.PHIEUYEUCAU_ID,YC.MAPHIEUYEUCAU,YC.MMYY,YC.NGAYLAP,YC.PHONGBAN_ID,YC.TENPHONGBAN,YC.MAKHOXUAT,YC.TENKHOXUAT,YC.GHICHU,YC.TENNGUOITAO,YC.TENNGUOICAPNHAT,YC.BENHVIEN_ID,YC.NGAYTAO,YC.NGUOITAO_ID,YC.NGAYCAPNHAT,YC.NGUOICAPNHAT_ID        FROM TT_INV_PHIEUYEUCAU YC        WHERE YC.BENHVIEN_ID = 'HLU01' AND YC.NGAYLAP BETWEEN '5/1/2019 12:00:00 AM' AND '8/16/2019 3:13:09 PM'         AND           YC.CHUNGTUXUAT_ID IS NULL         AND           YC.MAKHOXUAT = 'KCVPP']
2019-08-16 15:13:14,253 [1] DEBUG - Statement Id: [DAO00401_INV001_GetPhieuYeuCauChiTiet_PhieuYeuCauID] PreparedStatement : [select YCCT.PHIEUYEUCAUCHITIET_ID,YCCT.HANGHOA_ID,YCCT.MAHANGHOA,YCCT.TENHANGHOA,YCCT.DONVITINH_ID,YCCT.TENDONVITINH,YCCT.SOLUONGYEUCAU,YCCT.SOLUONGDAXUAT        FROM TT_INV_PHIEUYEUCAUCHITIET YCCT        WHERE YCCT.BENHVIEN_ID = 'HLU01' AND YCCT.PHIEUYEUCAU_ID='26']
2019-08-16 15:13:14,594 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChiTietYC_MaPhieuYeuCau] PreparedStatement : [select YC.PHIEUYEUCAU_ID,YC.MAPHIEUYEUCAU,YC.MMYY,YC.NGAYLAP,YC.PHONGBAN_ID AS PHONGBANNHAN_ID,YC.TENPHONGBAN AS TENPHONGBANNHAN,YC.MAKHOXUAT,YC.TENKHOXUAT,        YCCT.PHIEUYEUCAUCHITIET_ID,YCCT.HANGHOA_ID,YCCT.MAHANGHOA,YCCT.TENHANGHOA,YCCT.DONVITINH_ID,YCCT.TENDONVITINH,YCCT.SOLUONGYEUCAU,YCCT.SOLUONGYEUCAU AS SOLUONGXUAT, NULL AS DONGIA,NULL AS LOSX,NULL AS HANDUNG,        TKTH.SOLUONGTONCUOI        FROM TT_INV_PHIEUYEUCAU YC INNER JOIN TT_INV_PHIEUYEUCAUCHITIET YCCT ON YC.PHIEUYEUCAU_ID=YCCT.PHIEUYEUCAU_ID        LEFT JOIN (SELECT (SOLUONGTONDAU+SOLUONGNHAP-SOLUONGXUAT) AS SOLUONGTONCUOI, HANGHOA_ID,MAKHO        FROM TT_INV_TONKHOTONGHOP WHERE BENHVIEN_ID='HLU01' AND MMYY='0819'        ) TKTH ON YCCT.HANGHOA_ID = TKTH.HANGHOA_ID AND YC.MAKHOXUAT = TKTH.MAKHO        WHERE YC.MAPHIEUYEUCAU='YC53190528093211' AND YC.BENHVIEN_ID = 'HLU01']
2019-08-16 15:13:21,696 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
--------------------------------------------------------------------------------
2019-08-16 15:28:05,995 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2019-08-16 15:28:06,312 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-08-16 15:28:06,368 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-08-16 15:28:06,812 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 15:28:07,041 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-08-16 15:28:14,113 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2019-08-16 15:28:14,162 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-08-16 15:28:15,663 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-08-16 15:28:15,757 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-08-16 15:28:16,565 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2019-08-16 15:28:16,705 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2019-08-16 15:28:16,778 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2019-08-16 15:28:16,859 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2019-08-16 15:28:16,934 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2019-08-16 15:28:17,003 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2019-08-16 15:28:17,084 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2019-08-16 15:28:17,163 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2019-08-16 15:28:17,250 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2019-08-16 15:28:17,762 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2019-08-16 15:28:17,798 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2019-08-16 15:28:17,869 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2019-08-16 15:28:17,905 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2019-08-16 15:28:20,156 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2019-08-16 15:28:20,580 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 0 as PHAMVI_ID, 0 as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0         end                else        begin        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2019-08-16 15:28:24,108 [5] DEBUG - Statement Id: [DAO00320_GetList] PreparedStatement : [select M.*            from TM_MAU M            LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID            where            M.TAMNGUNG = '0'            and M.BENHVIEN_ID = 'HLU01'            order by M.TENMAU]
2019-08-16 15:28:24,172 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2019-08-16 15:28:24,220 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT          TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,          TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,          SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH          FROM TT_MAU_TONKHO TK          JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID          JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID          JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'          LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID          LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID          WHERE TK.SOLUONG > 0          GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,          TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2019-08-16 15:28:24,305 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2019-08-16 15:28:24,347 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct          TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,          TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,          TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH          from TM_MAU M          JOIN          (          select          A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO          from          (          select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO          from TT_MAU_TONKHO TK          JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID          inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID          left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'          where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0          ) A          )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'          LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID          LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2019-08-16 15:28:24,729 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2019-08-16 15:28:25,981 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 15:28:26,950 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2019-08-16 15:28:31,872 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2019-08-16 15:28:31,904 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2019-08-16 15:28:31,979 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 15:28:32,133 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 15:28:32,269 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2019-08-16 15:28:32,271 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-08-16 15:28:32,271 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-08-16 15:28:32,306 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2019-08-16 15:28:32,307 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-08-16 15:28:32,307 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-08-16 15:28:32,436 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 15:28:32,593 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 15:28:40,772 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 15:28:40,884 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2019-08-16 15:28:41,409 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2019-08-16 15:28:51,983 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'STA06'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 15:28:52,312 [1] DEBUG - Statement Id: [DAO00401_INV001_GetDMNhanVien] PreparedStatement : [SELECT NHANVIEN_ID,TENNHANVIEN,NHANVIEN_ID AS NHANVIENNHAN_ID,TENNHANVIEN AS TENNHANVIENNHAN FROM [TM_NHANVIEN]        where BENHVIEN_ID = 'HLU01'        ORDER BY TENNHANVIEN]
2019-08-16 15:28:52,707 [1] DEBUG - Statement Id: [DAO00401_INV001_GetDMKHOVPP] PreparedStatement : [Select K.*,BB.SODU,BB.SODUDENNGAY,BB.KHOASO,BB.NGAYKHOA  From TM_KHO K        LEFT JOIN TM_INV_KHO BB ON K.MAKHO = BB.MAKHO        LEFT JOIN LST_DICTIONARY AA ON AA.DICTIONARY_ID = K.MODULE_ID        WHERE AA.DICTIONARY_CODE = 'KhoVPP']
2019-08-16 15:28:52,892 [1] DEBUG - Statement Id: [DAO00401_GetListMucDichChungTu] PreparedStatement : [SELECT DICTIONARY_ID, DICTIONARY_CODE, DICTIONARY_NAME        FROM LST_DICTIONARY        WHERE DICTIONARY_TYPE_CODE = 'VPP_MucDichChungTu'        AND ENABLED = '1']
2019-08-16 15:28:53,699 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 15:28:59,071 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'STA05'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 15:28:59,226 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM98'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 15:28:59,709 [1] DEBUG - Statement Id: [DAO00401_INV001_PhieuYeuCauSearch] PreparedStatement : [select YC.PHIEUYEUCAU_ID,YC.MAPHIEUYEUCAU,YC.MMYY,YC.NGAYLAP,YC.PHONGBAN_ID,YC.TENPHONGBAN,YC.MAKHOXUAT,YC.TENKHOXUAT,YC.GHICHU,YC.TENNGUOITAO,YC.TENNGUOICAPNHAT,YC.BENHVIEN_ID,YC.NGAYTAO,YC.NGUOITAO_ID,YC.NGAYCAPNHAT,YC.NGUOICAPNHAT_ID        FROM TT_INV_PHIEUYEUCAU YC        WHERE YC.BENHVIEN_ID = 'HLU01' AND YC.NGAYLAP BETWEEN '7/16/2019 3:28:59 PM' AND '8/16/2019 3:28:59 PM'         AND           YC.CHUNGTUXUAT_ID IS NULL         AND           YC.MAKHOXUAT = 'KCVPP']
2019-08-16 15:29:04,609 [1] DEBUG - Statement Id: [DAO00401_INV001_PhieuYeuCauSearch] PreparedStatement : [select YC.PHIEUYEUCAU_ID,YC.MAPHIEUYEUCAU,YC.MMYY,YC.NGAYLAP,YC.PHONGBAN_ID,YC.TENPHONGBAN,YC.MAKHOXUAT,YC.TENKHOXUAT,YC.GHICHU,YC.TENNGUOITAO,YC.TENNGUOICAPNHAT,YC.BENHVIEN_ID,YC.NGAYTAO,YC.NGUOITAO_ID,YC.NGAYCAPNHAT,YC.NGUOICAPNHAT_ID        FROM TT_INV_PHIEUYEUCAU YC        WHERE YC.BENHVIEN_ID = 'HLU01' AND YC.NGAYLAP BETWEEN '4/30/2019 12:00:00 AM' AND '8/16/2019 3:28:59 PM'         AND           YC.CHUNGTUXUAT_ID IS NULL         AND           YC.MAKHOXUAT = 'KCVPP']
2019-08-16 15:29:06,407 [1] DEBUG - Statement Id: [DAO00401_INV001_GetPhieuYeuCauChiTiet_PhieuYeuCauID] PreparedStatement : [select YCCT.PHIEUYEUCAUCHITIET_ID,YCCT.HANGHOA_ID,YCCT.MAHANGHOA,YCCT.TENHANGHOA,YCCT.DONVITINH_ID,YCCT.TENDONVITINH,YCCT.SOLUONGYEUCAU,YCCT.SOLUONGDAXUAT        FROM TT_INV_PHIEUYEUCAUCHITIET YCCT        WHERE YCCT.BENHVIEN_ID = 'HLU01' AND YCCT.PHIEUYEUCAU_ID='26']
2019-08-16 15:29:06,673 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChiTietYC_MaPhieuYeuCau] PreparedStatement : [select YC.PHIEUYEUCAU_ID,YC.MAPHIEUYEUCAU,YC.MMYY,YC.NGAYLAP,YC.PHONGBAN_ID AS PHONGBANNHAN_ID,YC.TENPHONGBAN AS TENPHONGBANNHAN,YC.MAKHOXUAT,YC.TENKHOXUAT,        YCCT.PHIEUYEUCAUCHITIET_ID,YCCT.HANGHOA_ID,YCCT.MAHANGHOA,YCCT.TENHANGHOA,YCCT.DONVITINH_ID,YCCT.TENDONVITINH,YCCT.SOLUONGYEUCAU,YCCT.SOLUONGYEUCAU AS SOLUONGXUAT, NULL AS DONGIA,NULL AS LOSX,NULL AS HANDUNG,        TKTH.SOLUONGTONCUOI        FROM TT_INV_PHIEUYEUCAU YC INNER JOIN TT_INV_PHIEUYEUCAUCHITIET YCCT ON YC.PHIEUYEUCAU_ID=YCCT.PHIEUYEUCAU_ID        LEFT JOIN (SELECT (SOLUONGTONDAU+SOLUONGNHAP-SOLUONGXUAT) AS SOLUONGTONCUOI, HANGHOA_ID,MAKHO        FROM TT_INV_TONKHOTONGHOP WHERE BENHVIEN_ID='HLU01' AND MMYY='0819'        ) TKTH ON YCCT.HANGHOA_ID = TKTH.HANGHOA_ID AND YC.MAKHOXUAT = TKTH.MAKHO        WHERE YC.MAPHIEUYEUCAU='YC53190528093211' AND YC.BENHVIEN_ID = 'HLU01']
2019-08-16 15:29:13,511 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 15:29:52,022 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 15:30:06,706 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 15:30:47,169 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 15:30:50,239 [1] DEBUG - Statement Id: [DAO00401_INV001_GetTonKho] PreparedStatement : [SELECT TKTH.HANGHOA_ID,TKTH.MAHANGHOA,TKTH.TENHANGHOA,HH.DONVITINH_ID,HH.TENDONVITINH,SUM(TKTH.SOLUONGTONDAU+TKTH.SOLUONGNHAP-TKTH.SOLUONGXUAT) AS SOLUONGTONCUOI        FROM TM_PUR_HANGHOA HH INNER JOIN TT_INV_TONKHOTONGHOP TKTH ON HH.ID = TKTH.HANGHOA_ID        where TKTH.BENHVIEN_ID = 'HLU01' AND TKTH.MAKHO = 'KCVPP' AND TKTH.MMYY='0819'        GROUP BY TKTH.HANGHOA_ID,TKTH.MAHANGHOA,TKTH.TENHANGHOA,HH.DONVITINH_ID,HH.TENDONVITINH]
2019-08-16 15:31:04,523 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraMaChungTuXuatTonTai] PreparedStatement : [select CT.IDCHUYEN        FROM TT_INV_CHUNGTUXUAT CT        where CT.MACHUNGTU = 'X07190816153103' AND CT.BENHVIEN_ID = 'HLU01'         AND         CT.MMYY IN(0819)]
2019-08-16 15:31:10,761 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuat] PreparedStatement : [INSERT INTO TT_INV_CHUNGTUXUAT      (MACHUNGTU,MMYY,NGAYCHUNGTU,MAKHOXUAT,TENKHOXUAT,PHONGBANNHAN_ID,TENPHONGBANNHAN,NHANVIENNHAN_ID,TENNHANVIENNHAN,GHICHU,PHIEUYEUCAU_ID,MAPHIEUYEUCAU,XUATKHOTHEO,TENNGUOITAO,BENHVIEN_ID,NGAYTAO,NGUOITAO_ID                , MUCDICHCHUNGTU_ID                , MUCDICHCHUNGTU_CODE             )      VALUES ( @param0 , @param1 , @param2 , @param3 , @param4 , @param5 , @param6 , @param7 , @param8 , @param9 , @param10 , @param11 , @param12 , @param13 , @param14 ,GETDATE(), @param15                 ,  @param16                 ,  @param17              )      SELECT SCOPE_IDENTITY()]
2019-08-16 15:31:10,762 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuat] Parameters: [@param0=[MACHUNGTU,X07190816153103], @param1=[MMYY,0819], @param2=[NGAYCHUNGTU,8/16/2019 3:29:06 PM], @param3=[MAKHOXUAT,KCVPP], @param4=[TENKHOXUAT,Kho chính VPP], @param5=[PHONGBANNHAN_ID,53], @param6=[TENPHONGBANNHAN,Phòng TCHC - Công nghệ thông tin], @param7=[NHANVIENNHAN_ID,47], @param8=[TENNHANVIENNHAN,Bùi Bá Cường], @param9=[GHICHU,null], @param10=[PHIEUYEUCAU_ID,26], @param11=[MAPHIEUYEUCAU,YC53190528093211], @param12=[XUATKHOTHEO,Hạn dùng], @param13=[TENNGUOITAO,Administrator], @param14=[BENHVIEN_ID,HLU01], @param15=[NGUOITAO_ID,1], @param16=[MUCDICHCHUNGTU_ID,6994], @param17=[MUCDICHCHUNGTU_CODE,X07]]
2019-08-16 15:31:10,762 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuat] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[DateTime, System.DateTime], @param3=[String, System.String], @param4=[String, System.String], @param5=[Int64, System.Int64], @param6=[String, System.String], @param7=[Int64, System.Int64], @param8=[String, System.String], @param9=[System.DBNull, null], @param10=[Int64, System.Int64], @param11=[String, System.String], @param12=[String, System.String], @param13=[String, System.String], @param14=[String, System.String], @param15=[Int64, System.Int64], @param16=[Int64, System.Int64], @param17=[String, System.String]]
2019-08-16 15:32:03,082 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 15:32:04,800 [1] DEBUG - Statement Id: [DAO00401_INV001_GetTonKho] PreparedStatement : [SELECT TKTH.HANGHOA_ID,TKTH.MAHANGHOA,TKTH.TENHANGHOA,HH.DONVITINH_ID,HH.TENDONVITINH,SUM(TKTH.SOLUONGTONDAU+TKTH.SOLUONGNHAP-TKTH.SOLUONGXUAT) AS SOLUONGTONCUOI        FROM TM_PUR_HANGHOA HH INNER JOIN TT_INV_TONKHOTONGHOP TKTH ON HH.ID = TKTH.HANGHOA_ID        where TKTH.BENHVIEN_ID = 'HLU01' AND TKTH.MAKHO = 'KCVPP' AND TKTH.MMYY='0819'        GROUP BY TKTH.HANGHOA_ID,TKTH.MAHANGHOA,TKTH.TENHANGHOA,HH.DONVITINH_ID,HH.TENDONVITINH]
2019-08-16 15:32:18,685 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraMaChungTuXuatTonTai] PreparedStatement : [select CT.IDCHUYEN        FROM TT_INV_CHUNGTUXUAT CT        where CT.MACHUNGTU = 'X07190816153217' AND CT.BENHVIEN_ID = 'HLU01'         AND         CT.MMYY IN(0819)]
2019-08-16 15:32:25,802 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuat] PreparedStatement : [INSERT INTO TT_INV_CHUNGTUXUAT      (MACHUNGTU,MMYY,NGAYCHUNGTU,MAKHOXUAT,TENKHOXUAT,PHONGBANNHAN_ID,TENPHONGBANNHAN,NHANVIENNHAN_ID,TENNHANVIENNHAN,GHICHU,PHIEUYEUCAU_ID,MAPHIEUYEUCAU,XUATKHOTHEO,TENNGUOITAO,BENHVIEN_ID,NGAYTAO,NGUOITAO_ID                , MUCDICHCHUNGTU_ID                , MUCDICHCHUNGTU_CODE             )      VALUES ( @param0 , @param1 , @param2 , @param3 , @param4 , @param5 , @param6 , @param7 , @param8 , @param9 , @param10 , @param11 , @param12 , @param13 , @param14 ,GETDATE(), @param15                 ,  @param16                 ,  @param17              )      SELECT SCOPE_IDENTITY()]
2019-08-16 15:32:25,802 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuat] Parameters: [@param0=[MACHUNGTU,X07190816153217], @param1=[MMYY,0819], @param2=[NGAYCHUNGTU,8/16/2019 3:29:06 PM], @param3=[MAKHOXUAT,KCVPP], @param4=[TENKHOXUAT,Kho chính VPP], @param5=[PHONGBANNHAN_ID,53], @param6=[TENPHONGBANNHAN,Phòng TCHC - Công nghệ thông tin], @param7=[NHANVIENNHAN_ID,47], @param8=[TENNHANVIENNHAN,Bùi Bá Cường], @param9=[GHICHU,null], @param10=[PHIEUYEUCAU_ID,26], @param11=[MAPHIEUYEUCAU,YC53190528093211], @param12=[XUATKHOTHEO,Hạn dùng], @param13=[TENNGUOITAO,Administrator], @param14=[BENHVIEN_ID,HLU01], @param15=[NGUOITAO_ID,1], @param16=[MUCDICHCHUNGTU_ID,6994], @param17=[MUCDICHCHUNGTU_CODE,X07]]
2019-08-16 15:32:25,802 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuat] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[DateTime, System.DateTime], @param3=[String, System.String], @param4=[String, System.String], @param5=[Int64, System.Int64], @param6=[String, System.String], @param7=[Int64, System.Int64], @param8=[String, System.String], @param9=[System.DBNull, null], @param10=[Int64, System.Int64], @param11=[String, System.String], @param12=[String, System.String], @param13=[String, System.String], @param14=[String, System.String], @param15=[Int64, System.Int64], @param16=[Int64, System.Int64], @param17=[String, System.String]]
2019-08-16 15:32:29,020 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdChungTuXuatID_PhieuYeuCau] PreparedStatement : [UPDATE TT_INV_PHIEUYEUCAU SET CHUNGTUXUAT_ID =  @param0  WHERE PHIEUYEUCAU_ID = '26' AND BENHVIEN_ID = 'HLU01']
2019-08-16 15:32:29,020 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdChungTuXuatID_PhieuYeuCau] Parameters: [@param0=[CHUNGTUXUAT_ID,8]]
2019-08-16 15:32:29,020 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdChungTuXuatID_PhieuYeuCau] Types: [@param0=[Int64, System.Int64]]
2019-08-16 15:32:29,742 [1] DEBUG - Statement Id: [DAO00401_INV001_GetTonKhoChiTiet] PreparedStatement : [SELECT TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.DONGIA AS DONGIATRUOCVAT,TD.DONGIASAUVAT AS DONGIA,CASE WHEN TD.HANDUNG IS NULL THEN DATEADD(YEAR,999, GETDATE()) ELSE TD.HANDUNG END AS HANDUNG ,TD.NGAYTAO,        SUM(TKCT.SOLUONGTONDAU+TKCT.SOLUONGNHAP-TKCT.SOLUONGXUAT) AS SOLUONGTONCUOI        FROM TM_PUR_HANGHOA HH INNER JOIN TT_INV_THEODOI TD ON HH.ID = TD.HANGHOA_ID        INNER JOIN TT_INV_TONKHOCHITIET TKCT ON TD.THEODOI_ID = TKCT.THEODOI_ID        where TKCT.BENHVIEN_ID = 'HLU01' AND TKCT.MAKHO = 'KCVPP' AND TKCT.MMYY='0819'        GROUP BY TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.DONGIA,TD.DONGIASAUVAT,TD.HANDUNG,TD.NGAYTAO        ORDER BY TD.NGAYTAO]
2019-08-16 15:32:29,856 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuatChiTiet] PreparedStatement : [INSERT INTO TT_INV_CHUNGTUXUATCHITIET(CHUNGTUXUAT_ID,MMYY,THEODOI_ID,SOLUONGYEUCAU,SOLUONGXUAT,THANHTIEN,GHICHU,PHIEUYEUCAUCHITIET_ID,TENNGUOITAO,BENHVIEN_ID,NGAYTAO,NGUOITAO_ID)       VALUES( @param0 , @param1 , @param2 , @param3 , @param4 , @param5 , @param6 , @param7 , @param8 , @param9 ,GETDATE(), @param10 )        SELECT SCOPE_IDENTITY()]
2019-08-16 15:32:29,856 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuatChiTiet] Parameters: [@param0=[CHUNGTUXUAT_ID,8], @param1=[MMYY,0819], @param2=[THEODOI_ID,92], @param3=[SOLUONGYEUCAU,10], @param4=[SOLUONGXUAT,10], @param5=[THANHTIEN,275000.0000], @param6=[CT_GHICHU,null], @param7=[PHIEUYEUCAUCHITIET_ID,58], @param8=[TENNGUOITAO,null], @param9=[BENHVIEN_ID,HLU01], @param10=[NGUOITAO_ID,null]]
2019-08-16 15:32:29,856 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuatChiTiet] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String], @param2=[Int32, System.Int32], @param3=[Double, System.Double], @param4=[Decimal, System.Decimal], @param5=[Decimal, System.Decimal], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[String, System.String], @param10=[System.DBNull, null]]
2019-08-16 15:32:29,900 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLDaXuat_PhieuYeuCauChiTietID] PreparedStatement : [UPDATE TT_INV_PHIEUYEUCAUCHITIET        SET SOLUONGDAXUAT= @param0         WHERE PHIEUYEUCAUCHITIET_ID = '58' AND BENHVIEN_ID = 'HLU01']
2019-08-16 15:32:29,900 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLDaXuat_PhieuYeuCauChiTietID] Parameters: [@param0=[SOLUONGXUAT,10]]
2019-08-16 15:32:29,900 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLDaXuat_PhieuYeuCauChiTietID] Types: [@param0=[Decimal, System.Decimal]]
2019-08-16 15:32:29,947 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuatChiTiet] PreparedStatement : [INSERT INTO TT_INV_CHUNGTUXUATCHITIET(CHUNGTUXUAT_ID,MMYY,THEODOI_ID,SOLUONGYEUCAU,SOLUONGXUAT,THANHTIEN,GHICHU,PHIEUYEUCAUCHITIET_ID,TENNGUOITAO,BENHVIEN_ID,NGAYTAO,NGUOITAO_ID)       VALUES( @param0 , @param1 , @param2 , @param3 , @param4 , @param5 , @param6 , @param7 , @param8 , @param9 ,GETDATE(), @param10 )        SELECT SCOPE_IDENTITY()]
2019-08-16 15:32:29,947 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuatChiTiet] Parameters: [@param0=[CHUNGTUXUAT_ID,8], @param1=[MMYY,0819], @param2=[THEODOI_ID,101], @param3=[SOLUONGYEUCAU,5], @param4=[SOLUONGXUAT,5], @param5=[THANHTIEN,132500.0000], @param6=[CT_GHICHU,null], @param7=[PHIEUYEUCAUCHITIET_ID,59], @param8=[TENNGUOITAO,null], @param9=[BENHVIEN_ID,HLU01], @param10=[NGUOITAO_ID,null]]
2019-08-16 15:32:29,947 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuatChiTiet] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String], @param2=[Int32, System.Int32], @param3=[Double, System.Double], @param4=[Decimal, System.Decimal], @param5=[Decimal, System.Decimal], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[String, System.String], @param10=[System.DBNull, null]]
2019-08-16 15:32:29,985 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLDaXuat_PhieuYeuCauChiTietID] PreparedStatement : [UPDATE TT_INV_PHIEUYEUCAUCHITIET        SET SOLUONGDAXUAT= @param0         WHERE PHIEUYEUCAUCHITIET_ID = '59' AND BENHVIEN_ID = 'HLU01']
2019-08-16 15:32:29,985 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLDaXuat_PhieuYeuCauChiTietID] Parameters: [@param0=[SOLUONGXUAT,5]]
2019-08-16 15:32:29,985 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLDaXuat_PhieuYeuCauChiTietID] Types: [@param0=[Decimal, System.Decimal]]
2019-08-16 15:32:30,020 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuatChiTiet] PreparedStatement : [INSERT INTO TT_INV_CHUNGTUXUATCHITIET(CHUNGTUXUAT_ID,MMYY,THEODOI_ID,SOLUONGYEUCAU,SOLUONGXUAT,THANHTIEN,GHICHU,PHIEUYEUCAUCHITIET_ID,TENNGUOITAO,BENHVIEN_ID,NGAYTAO,NGUOITAO_ID)       VALUES( @param0 , @param1 , @param2 , @param3 , @param4 , @param5 , @param6 , @param7 , @param8 , @param9 ,GETDATE(), @param10 )        SELECT SCOPE_IDENTITY()]
2019-08-16 15:32:30,020 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuatChiTiet] Parameters: [@param0=[CHUNGTUXUAT_ID,8], @param1=[MMYY,0819], @param2=[THEODOI_ID,58], @param3=[SOLUONGYEUCAU,5], @param4=[SOLUONGXUAT,5], @param5=[THANHTIEN,250000.0000], @param6=[CT_GHICHU,null], @param7=[PHIEUYEUCAUCHITIET_ID,60], @param8=[TENNGUOITAO,null], @param9=[BENHVIEN_ID,HLU01], @param10=[NGUOITAO_ID,null]]
2019-08-16 15:32:30,020 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuatChiTiet] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String], @param2=[Int32, System.Int32], @param3=[Double, System.Double], @param4=[Decimal, System.Decimal], @param5=[Decimal, System.Decimal], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[String, System.String], @param10=[System.DBNull, null]]
2019-08-16 15:32:30,053 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLDaXuat_PhieuYeuCauChiTietID] PreparedStatement : [UPDATE TT_INV_PHIEUYEUCAUCHITIET        SET SOLUONGDAXUAT= @param0         WHERE PHIEUYEUCAUCHITIET_ID = '60' AND BENHVIEN_ID = 'HLU01']
2019-08-16 15:32:30,053 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLDaXuat_PhieuYeuCauChiTietID] Parameters: [@param0=[SOLUONGXUAT,5]]
2019-08-16 15:32:30,053 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLDaXuat_PhieuYeuCauChiTietID] Types: [@param0=[Decimal, System.Decimal]]
2019-08-16 15:32:30,100 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuatChiTiet] PreparedStatement : [INSERT INTO TT_INV_CHUNGTUXUATCHITIET(CHUNGTUXUAT_ID,MMYY,THEODOI_ID,SOLUONGYEUCAU,SOLUONGXUAT,THANHTIEN,GHICHU,PHIEUYEUCAUCHITIET_ID,TENNGUOITAO,BENHVIEN_ID,NGAYTAO,NGUOITAO_ID)       VALUES( @param0 , @param1 , @param2 , @param3 , @param4 , @param5 , @param6 , @param7 , @param8 , @param9 ,GETDATE(), @param10 )        SELECT SCOPE_IDENTITY()]
2019-08-16 15:32:30,100 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuatChiTiet] Parameters: [@param0=[CHUNGTUXUAT_ID,8], @param1=[MMYY,0819], @param2=[THEODOI_ID,89], @param3=[SOLUONGYEUCAU,5], @param4=[SOLUONGXUAT,5], @param5=[THANHTIEN,475000.0000], @param6=[CT_GHICHU,null], @param7=[PHIEUYEUCAUCHITIET_ID,61], @param8=[TENNGUOITAO,null], @param9=[BENHVIEN_ID,HLU01], @param10=[NGUOITAO_ID,null]]
2019-08-16 15:32:30,100 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuatChiTiet] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String], @param2=[Int32, System.Int32], @param3=[Double, System.Double], @param4=[Decimal, System.Decimal], @param5=[Decimal, System.Decimal], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[String, System.String], @param10=[System.DBNull, null]]
2019-08-16 15:32:30,148 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLDaXuat_PhieuYeuCauChiTietID] PreparedStatement : [UPDATE TT_INV_PHIEUYEUCAUCHITIET        SET SOLUONGDAXUAT= @param0         WHERE PHIEUYEUCAUCHITIET_ID = '61' AND BENHVIEN_ID = 'HLU01']
2019-08-16 15:32:30,148 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLDaXuat_PhieuYeuCauChiTietID] Parameters: [@param0=[SOLUONGXUAT,5]]
2019-08-16 15:32:30,148 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLDaXuat_PhieuYeuCauChiTietID] Types: [@param0=[Decimal, System.Decimal]]
2019-08-16 15:32:30,202 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLXuatTonKho] PreparedStatement : [UPDATE TT_INV_TONKHOCHITIET SET SOLUONGXUAT=0 WHERE MMYY='0819' AND MAKHO IN('KCVPP');        MERGE TT_INV_TONKHOCHITIET AS X USING        (SELECT QQ.MMYY, QQ.MAKHO,QQ.TENKHO,QQ.THEODOI_ID,SUM(QQ.SOLUONGXUAT) AS SOLUONGXUAT FROM (        SELECT '0819' AS MMYY, A.MAKHOXUAT AS MAKHO,A.TENKHOXUAT AS TENKHO,B.THEODOI_ID,B.SOLUONGXUAT,C.NGAYTAO,C.NGUOITAO_ID        FROM TT_INV_CHUNGTUXUAT A INNER JOIN TT_INV_CHUNGTUXUATCHITIET B ON A.CHUNGTUXUAT_ID=B.CHUNGTUXUAT_ID AND A.MMYY='0819'        INNER JOIN TT_INV_THEODOI C ON B.THEODOI_ID=C.THEODOI_ID        WHERE A.MMYY='0819' AND A.BENHVIEN_ID='HLU01' AND A.MAKHOXUAT IN('KCVPP')        UNION ALL        SELECT '0819' AS MMYY, A.MAKHO,A.TENKHO,B.THEODOI_ID,B.SOLUONG AS SOLUONGXUAT,C.NGAYTAO,C.NGUOITAO_ID        FROM TT_INV_CHUNGTUTANGGIAM A INNER JOIN TT_INV_CHUNGTUTANGGIAMCHITIET B ON A.CHUNGTUTANGGIAM_ID=B.CHUNGTUTANGGIAM_ID AND A.MMYY='0819' AND A.LOAI='giam'        INNER JOIN TT_INV_THEODOI C ON B.THEODOI_ID=C.THEODOI_ID        WHERE A.MMYY='0819' AND A.LOAI='giam' AND A.BENHVIEN_ID='HLU01' AND A.MAKHO IN('KCVPP')) QQ        GROUP BY QQ.MMYY, QQ.MAKHO,QQ.TENKHO,QQ.THEODOI_ID) AS Y        ON (X.MMYY=Y.MMYY AND X.MAKHO=Y.MAKHO AND X.THEODOI_ID=Y.THEODOI_ID)        WHEN MATCHED THEN UPDATE SET X.SOLUONGXUAT=Y.SOLUONGXUAT        WHEN NOT MATCHED THEN                INSERT (MMYY,MAKHO,TENKHO,THEODOI_ID,SOLUONGXUAT,BENHVIEN_ID,NGAYTAO,NGUOITAO_ID) VALUES        ('0819',Y.MAKHO,Y.TENKHO,Y.THEODOI_ID,Y.SOLUONGXUAT, @param0 ,GETDATE(), '');          UPDATE TT_INV_TONKHOTONGHOP SET SOLUONGTONDAU=0,SOLUONGNHAP=0,SOLUONGXUAT=0 WHERE MMYY='0819' AND MAKHO IN('KCVPP');        MERGE TT_INV_TONKHOTONGHOP AS X USING        (SELECT '0819' AS MMYY,A.MAKHO,A.TENKHO,B.HANGHOA_ID,B.MAHANGHOA,HH.TEN,SUM(A.SOLUONGTONDAU) AS SOLUONGTONDAU,SUM(A.SOLUONGNHAP) AS SOLUONGNHAP,SUM(A.SOLUONGXUAT) AS SOLUONGXUAT        FROM TT_INV_TONKHOCHITIET A INNER JOIN TT_INV_THEODOI B ON A.THEODOI_ID=B.THEODOI_ID AND A.MMYY='0819'        JOIN TM_PUR_HANGHOA HH on HH.ID = B.HANGHOA_ID        WHERE A.MMYY='0819' AND A.BENHVIEN_ID='HLU01' AND A.MAKHO IN('KCVPP')        GROUP BY A.MAKHO,A.TENKHO,B.HANGHOA_ID,B.MAHANGHOA,HH.TEN) AS Y        ON (X.MMYY=Y.MMYY AND X.MAKHO=Y.MAKHO AND X.HANGHOA_ID=Y.HANGHOA_ID)          WHEN MATCHED THEN UPDATE SET X.SOLUONGTONDAU=Y.SOLUONGTONDAU, X.SOLUONGNHAP=Y.SOLUONGNHAP,X.SOLUONGXUAT=Y.SOLUONGXUAT        WHEN NOT MATCHED THEN                INSERT (MMYY,MAKHO,TENKHO,HANGHOA_ID,MAHANGHOA,TENHANGHOA,SOLUONGTONDAU,SOLUONGNHAP,SOLUONGXUAT,BENHVIEN_ID,NGAYTAO)        VALUES ('0819',Y.MAKHO,Y.TENKHO,Y.HANGHOA_ID,Y.MAHANGHOA,Y.TEN,Y.SOLUONGTONDAU,Y.SOLUONGNHAP,Y.SOLUONGXUAT, @param0 ,GETDATE());          DELETE FROM TT_INV_TONKHOCHITIET WHERE SOLUONGTONDAU=0 AND SOLUONGNHAP=0 AND SOLUONGXUAT=0;        DELETE FROM TT_INV_TONKHOTONGHOP WHERE SOLUONGTONDAU=0 AND SOLUONGNHAP=0 AND SOLUONGXUAT=0;]
2019-08-16 15:32:30,202 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLXuatTonKho] Parameters: [@param0=[BENHVIEN_ID,HLU01]]
2019-08-16 15:32:30,202 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLXuatTonKho] Types: [@param0=[String, System.String]]
2019-08-16 15:32:30,394 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdateTrangThaiPO_NhapKho] PreparedStatement : [UPDATE TT_PUR_CHUNGTU SET STATE_CODE =  @param0 , STATE_NAME =  @param1  WHERE MACHUNGTU = 'YC53190528093211' AND PROCESS_CODE = 'PO']
2019-08-16 15:32:30,394 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdateTrangThaiPO_NhapKho] Parameters: [@param0=[STATE_CODE,9], @param1=[STATE_NAME,Đã xuất kho]]
2019-08-16 15:32:30,394 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdateTrangThaiPO_NhapKho] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2019-08-16 15:32:30,782 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatAll] PreparedStatement : [SELECT CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,      CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID,      CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,      TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA      FROM TT_INV_CHUNGTUXUAT CT INNER JOIN TT_INV_CHUNGTUXUATCHITIET CTCT ON CT.CHUNGTUXUAT_ID=CTCT.CHUNGTUXUAT_ID             INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID      where CT.BENHVIEN_ID = 'HLU01' AND CT.MACHUNGTU = 'X07190816153217'             ORDER BY TD.TENHANGHOA]
2019-08-16 15:32:30,831 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 15:33:37,833 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'ADM05'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 15:33:40,100 [1] DEBUG - Statement Id: [DAO00205_GetAllWithoutDeactive] PreparedStatement : [SELECT DISTINCT C.CATEGORY_ID AS CATEGORY_ID            , ISNULL(C.PARENT_ID,0) AS PARENT_ID            , C.CATEGORY_CODE AS CATEGORY_CODE            , C.CATEGORY_NAME AS CATEGORY_NAME            , C.FOLDER_LEVEL            , C.IS_FOLDER            , C.FOLDER_CODE            , CASE WHEN (C.FOLDER_CODE IS NULL OR C.FOLDER_CODE = 'ROOT' OR C.FOLDER_CODE = '' )            THEN NULL ELSE C.FOLDER_CODE END AS PARENT_CODE            , C.CATEGORY_TYPE            FROM TM_CATEGORY AS C            WHERE C.ENABLED = '1'            AND C.BENHVIEN_ID = 'HLU01' AND C.CATEGORY_ID != 0            ORDER BY C.CATEGORY_ID]
2019-08-16 15:33:44,166 [1] DEBUG - Statement Id: [DAO00205_GetDetail] PreparedStatement : [select *              from TM_CATEGORY              where TM_CATEGORY.CATEGORY_ID  = '266'              order by CATEGORY_ID]
2019-08-16 15:33:44,228 [1] DEBUG - Statement Id: [DAO00206_GetList] PreparedStatement : [select *              from TM_CATEGORY_DETAIL               where                             TM_CATEGORY_DETAIL.CATEGORY_ID = '266'                       and                           TM_CATEGORY_DETAIL.BENHVIEN_ID = 'HLU01'                                     order by FIELD_INDEX]
2019-08-16 15:33:44,439 [1] DEBUG - Statement Id: [DAO00205_GetTableColumns] PreparedStatement : [SELECT c.name AS COLUMN_NAME, t.name AS TABLE_NAME, d.definition AS COLUMN_DEFAULT, CAST(c.is_nullable AS char(1)) AS IS_NULLABLE              , dt.name AS DATA_TYPE, c.max_length AS CHARACTER_MAXIMUM_LENGTH, CAST(c.is_identity AS char(1)) AS IS_IDENTITY              , CHARACTER_SET_NAME = (case dt.name when 'nvarchar' then 'UNICODE' else NULL end), t2.name as PRIMARY_TABLE, c2.name as PRIMARY_COLUMN              , IS_PRIMARY = CASE WHEN i.column_id IS NULL THEN 0 ELSE 1 END              FROM sys.columns as c              inner join sys.tables as t on c.object_id = t.object_id              left join sys.default_constraints as d on d.object_id = c.default_object_id              inner join sys.types as dt on c.system_type_id = dt.system_type_id and c.user_type_id = dt.user_type_id              left join sys.foreign_key_columns as fk on fk.parent_object_id = c.object_id and c.column_id = fk.parent_column_id              left join sys.tables as t2 on t2.object_id = fk.referenced_object_id              left join sys.columns as c2 on c2.object_id = t2.object_id and c2.column_id = fk.referenced_column_id              left join sys.key_constraints as k on k.parent_object_id = t.object_id and k.type = 'PK'              left join sys.index_columns as i on i.object_id = t.object_id and i.index_id = k.unique_index_id and i.column_id = c.column_id              WHERE t.name = 'LST_DICTIONARY_TYPE'              ORDER BY c.column_id]
2019-08-16 15:33:44,479 [1] DEBUG - Statement Id: [DAO00012_GetList] PreparedStatement : [select        DICTIONARY_ID,        DICTIONARY_CODE,        DICTIONARY_NAME,        ATTRIBUTE1,        ATTRIBUTE2,        DICTIONARY_NAME_EN        from LST_DICTIONARY        where LST_DICTIONARY.Enabled = '1'         AND           LST_DICTIONARY.DICTIONARY_TYPE_CODE = 'DM_Columns_Properties'                 order by LST_DICTIONARY.IDX]
2019-08-16 15:33:44,516 [1] DEBUG - Statement Id: [DAO00208_GetDataByCategory] PreparedStatement : [SELECT ROW_NUMBER() OVER(ORDER BY(SELECT 1)) AS PRIMARY_ID, DICTIONARY_TYPE_ID,DICTIONARY_TYPE_ID AS DISPLAY              FROM LST_DICTIONARY_TYPE              WHERE BENHVIEN_ID = 'HLU01']
2019-08-16 15:33:44,638 [1] DEBUG - Statement Id: [DAO00205_GetTableColumns] PreparedStatement : [SELECT c.name AS COLUMN_NAME, t.name AS TABLE_NAME, d.definition AS COLUMN_DEFAULT, CAST(c.is_nullable AS char(1)) AS IS_NULLABLE              , dt.name AS DATA_TYPE, c.max_length AS CHARACTER_MAXIMUM_LENGTH, CAST(c.is_identity AS char(1)) AS IS_IDENTITY              , CHARACTER_SET_NAME = (case dt.name when 'nvarchar' then 'UNICODE' else NULL end), t2.name as PRIMARY_TABLE, c2.name as PRIMARY_COLUMN              , IS_PRIMARY = CASE WHEN i.column_id IS NULL THEN 0 ELSE 1 END              FROM sys.columns as c              inner join sys.tables as t on c.object_id = t.object_id              left join sys.default_constraints as d on d.object_id = c.default_object_id              inner join sys.types as dt on c.system_type_id = dt.system_type_id and c.user_type_id = dt.user_type_id              left join sys.foreign_key_columns as fk on fk.parent_object_id = c.object_id and c.column_id = fk.parent_column_id              left join sys.tables as t2 on t2.object_id = fk.referenced_object_id              left join sys.columns as c2 on c2.object_id = t2.object_id and c2.column_id = fk.referenced_column_id              left join sys.key_constraints as k on k.parent_object_id = t.object_id and k.type = 'PK'              left join sys.index_columns as i on i.object_id = t.object_id and i.index_id = k.unique_index_id and i.column_id = c.column_id              WHERE t.name = 'LST_DICTIONARY_TYPE'              ORDER BY c.column_id]
2019-08-16 15:33:44,689 [1] DEBUG - Statement Id: [DAO00012_GetList] PreparedStatement : [select        DICTIONARY_ID,        DICTIONARY_CODE,        DICTIONARY_NAME,        ATTRIBUTE1,        ATTRIBUTE2,        DICTIONARY_NAME_EN        from LST_DICTIONARY        where LST_DICTIONARY.Enabled = '1'         AND           LST_DICTIONARY.DICTIONARY_TYPE_CODE = 'DM_Columns_Properties'                 order by LST_DICTIONARY.IDX]
2019-08-16 15:33:44,719 [1] DEBUG - Statement Id: [DAO00208_GetDataByCategory] PreparedStatement : [SELECT ROW_NUMBER() OVER(ORDER BY(SELECT 1)) AS PRIMARY_ID, DICTIONARY_TYPE_ID,DICTIONARY_TYPE_ID AS DISPLAY              FROM LST_DICTIONARY_TYPE              WHERE BENHVIEN_ID = 'HLU01']
2019-08-16 15:33:45,782 [1] DEBUG - Statement Id: [DAO00205_GetTableColumns] PreparedStatement : [SELECT c.name AS COLUMN_NAME, t.name AS TABLE_NAME, d.definition AS COLUMN_DEFAULT, CAST(c.is_nullable AS char(1)) AS IS_NULLABLE              , dt.name AS DATA_TYPE, c.max_length AS CHARACTER_MAXIMUM_LENGTH, CAST(c.is_identity AS char(1)) AS IS_IDENTITY              , CHARACTER_SET_NAME = (case dt.name when 'nvarchar' then 'UNICODE' else NULL end), t2.name as PRIMARY_TABLE, c2.name as PRIMARY_COLUMN              , IS_PRIMARY = CASE WHEN i.column_id IS NULL THEN 0 ELSE 1 END              FROM sys.columns as c              inner join sys.tables as t on c.object_id = t.object_id              left join sys.default_constraints as d on d.object_id = c.default_object_id              inner join sys.types as dt on c.system_type_id = dt.system_type_id and c.user_type_id = dt.user_type_id              left join sys.foreign_key_columns as fk on fk.parent_object_id = c.object_id and c.column_id = fk.parent_column_id              left join sys.tables as t2 on t2.object_id = fk.referenced_object_id              left join sys.columns as c2 on c2.object_id = t2.object_id and c2.column_id = fk.referenced_column_id              left join sys.key_constraints as k on k.parent_object_id = t.object_id and k.type = 'PK'              left join sys.index_columns as i on i.object_id = t.object_id and i.index_id = k.unique_index_id and i.column_id = c.column_id              WHERE t.name = 'LST_DICTIONARY'              ORDER BY c.column_id]
2019-08-16 15:33:46,276 [1] DEBUG - Statement Id: [DAO00012_GetList] PreparedStatement : [select        DICTIONARY_ID,        DICTIONARY_CODE,        DICTIONARY_NAME,        ATTRIBUTE1,        ATTRIBUTE2,        DICTIONARY_NAME_EN        from LST_DICTIONARY        where LST_DICTIONARY.Enabled = '1'         AND           LST_DICTIONARY.DICTIONARY_TYPE_CODE = 'DM_Columns_Properties'                 order by LST_DICTIONARY.IDX]
2019-08-16 15:33:46,559 [1] DEBUG - Statement Id: [DAO00208_GetDataByCategory] PreparedStatement : [SELECT ROW_NUMBER() OVER(ORDER BY(SELECT 1)) AS PRIMARY_ID, DICTIONARY_ID, DICTIONARY_TYPE_ID, DICTIONARY_TYPE_CODE, DICTIONARY_CODE, DICTIONARY_NAME, DICTIONARY_NAME_EN, DICTIONARY_NAME_RU, PARENT_ID, IDX, ENABLED, LATIN_NAME, ATTRIBUTE1, ATTRIBUTE2, ATTRIBUTE3, ATTRIBUTE4              FROM LST_DICTIONARY               WHERE DICTIONARY_TYPE_ID = 37 AND DICTIONARY_TYPE_CODE = 'VPP_MucDichChungTu']
2019-08-16 15:34:09,533 [1] DEBUG - Statement Id: [DAO00205_GetTableColumns] PreparedStatement : [SELECT c.name AS COLUMN_NAME, t.name AS TABLE_NAME, d.definition AS COLUMN_DEFAULT, CAST(c.is_nullable AS char(1)) AS IS_NULLABLE              , dt.name AS DATA_TYPE, c.max_length AS CHARACTER_MAXIMUM_LENGTH, CAST(c.is_identity AS char(1)) AS IS_IDENTITY              , CHARACTER_SET_NAME = (case dt.name when 'nvarchar' then 'UNICODE' else NULL end), t2.name as PRIMARY_TABLE, c2.name as PRIMARY_COLUMN              , IS_PRIMARY = CASE WHEN i.column_id IS NULL THEN 0 ELSE 1 END              FROM sys.columns as c              inner join sys.tables as t on c.object_id = t.object_id              left join sys.default_constraints as d on d.object_id = c.default_object_id              inner join sys.types as dt on c.system_type_id = dt.system_type_id and c.user_type_id = dt.user_type_id              left join sys.foreign_key_columns as fk on fk.parent_object_id = c.object_id and c.column_id = fk.parent_column_id              left join sys.tables as t2 on t2.object_id = fk.referenced_object_id              left join sys.columns as c2 on c2.object_id = t2.object_id and c2.column_id = fk.referenced_column_id              left join sys.key_constraints as k on k.parent_object_id = t.object_id and k.type = 'PK'              left join sys.index_columns as i on i.object_id = t.object_id and i.index_id = k.unique_index_id and i.column_id = c.column_id              WHERE t.name = 'LST_DICTIONARY'              ORDER BY c.column_id]
2019-08-16 15:34:09,567 [1] DEBUG - Statement Id: [DAO00012_GetList] PreparedStatement : [select        DICTIONARY_ID,        DICTIONARY_CODE,        DICTIONARY_NAME,        ATTRIBUTE1,        ATTRIBUTE2,        DICTIONARY_NAME_EN        from LST_DICTIONARY        where LST_DICTIONARY.Enabled = '1'         AND           LST_DICTIONARY.DICTIONARY_TYPE_CODE = 'DM_Columns_Create_Date'                 order by LST_DICTIONARY.IDX]
2019-08-16 15:34:09,603 [1] DEBUG - Statement Id: [DAO00012_GetList] PreparedStatement : [select        DICTIONARY_ID,        DICTIONARY_CODE,        DICTIONARY_NAME,        ATTRIBUTE1,        ATTRIBUTE2,        DICTIONARY_NAME_EN        from LST_DICTIONARY        where LST_DICTIONARY.Enabled = '1'         AND           LST_DICTIONARY.DICTIONARY_TYPE_CODE = 'DM_Columns_Create_By'                 order by LST_DICTIONARY.IDX]
2019-08-16 15:34:09,641 [1] DEBUG - Statement Id: [DAO00012_GetList] PreparedStatement : [select        DICTIONARY_ID,        DICTIONARY_CODE,        DICTIONARY_NAME,        ATTRIBUTE1,        ATTRIBUTE2,        DICTIONARY_NAME_EN        from LST_DICTIONARY        where LST_DICTIONARY.Enabled = '1'         AND           LST_DICTIONARY.DICTIONARY_TYPE_CODE = 'DM_Columns_Properties'                 order by LST_DICTIONARY.IDX]
2019-08-16 15:34:09,679 [1] DEBUG - Statement Id: [DAO00205_InsertDM_Ibatis] PreparedStatement : [INSERT INTO LST_DICTIONARY                (                   DICTIONARY_TYPE_CODE              ,                    DICTIONARY_CODE              ,                    DICTIONARY_NAME              ,                    DICTIONARY_NAME_EN              ,                    IDX              ,                    ENABLED              ,                    DICTIONARY_TYPE_ID              ,                    DICTIONARY_NAME_RU              ,                    PARENT_ID              ,                    LATIN_NAME              ,                    ATTRIBUTE1              ,                    ATTRIBUTE2              ,                    ATTRIBUTE3              ,                    ATTRIBUTE4              ,                    CREATION_DATE              ,                    CREATED_BY              ,                    LAST_UPDATE_DATE              ,                    LAST_UPDATED_BY              ,                    BENHVIEN_ID              )                VALUES                (                    @param0               ,                     @param1               ,                     @param2               ,                     @param3               ,                     @param4               ,                     @param5               ,                     @param6               ,                     @param7               ,                     @param8               ,                     @param9               ,                     @param10               ,                     @param11               ,                     @param12               ,                     @param13               ,                     @param14               ,                     @param15               ,                     @param16               ,                     @param17               ,                     @param18               )                SELECT CASE ISNULL('DICTIONARY_ID','') WHEN '' THEN 1 ELSE SCOPE_IDENTITY() END]
2019-08-16 15:34:09,679 [1] DEBUG - Statement Id: [DAO00205_InsertDM_Ibatis] Parameters: [@param0=[COLUMN_VALUE[0],VPP_MucDichChungTu], @param1=[COLUMN_VALUE[1],X21], @param2=[COLUMN_VALUE[2],Xuất khác], @param3=[COLUMN_VALUE[3],null], @param4=[COLUMN_VALUE[4],null], @param5=[COLUMN_VALUE[5],1], @param6=[COLUMN_VALUE[6],37], @param7=[COLUMN_VALUE[7],null], @param8=[COLUMN_VALUE[8],null], @param9=[COLUMN_VALUE[9],null], @param10=[COLUMN_VALUE[10],null], @param11=[COLUMN_VALUE[11],null], @param12=[COLUMN_VALUE[12],null], @param13=[COLUMN_VALUE[13],null], @param14=[COLUMN_VALUE[14],8/16/2019 3:34:09 PM], @param15=[COLUMN_VALUE[15],1], @param16=[COLUMN_VALUE[16],null], @param17=[COLUMN_VALUE[17],null], @param18=[COLUMN_VALUE[18],HLU01]]
2019-08-16 15:34:09,679 [1] DEBUG - Statement Id: [DAO00205_InsertDM_Ibatis] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[String, System.String], @param3=[System.DBNull, null], @param4=[System.DBNull, null], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[System.DBNull, null], @param9=[System.DBNull, null], @param10=[System.DBNull, null], @param11=[System.DBNull, null], @param12=[System.DBNull, null], @param13=[System.DBNull, null], @param14=[DateTime, System.DateTime], @param15=[Int64, System.Int64], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[String, System.String]]
2019-08-16 15:34:09,781 [1] DEBUG - Statement Id: [DAO00205_GetTableColumns] PreparedStatement : [SELECT c.name AS COLUMN_NAME, t.name AS TABLE_NAME, d.definition AS COLUMN_DEFAULT, CAST(c.is_nullable AS char(1)) AS IS_NULLABLE              , dt.name AS DATA_TYPE, c.max_length AS CHARACTER_MAXIMUM_LENGTH, CAST(c.is_identity AS char(1)) AS IS_IDENTITY              , CHARACTER_SET_NAME = (case dt.name when 'nvarchar' then 'UNICODE' else NULL end), t2.name as PRIMARY_TABLE, c2.name as PRIMARY_COLUMN              , IS_PRIMARY = CASE WHEN i.column_id IS NULL THEN 0 ELSE 1 END              FROM sys.columns as c              inner join sys.tables as t on c.object_id = t.object_id              left join sys.default_constraints as d on d.object_id = c.default_object_id              inner join sys.types as dt on c.system_type_id = dt.system_type_id and c.user_type_id = dt.user_type_id              left join sys.foreign_key_columns as fk on fk.parent_object_id = c.object_id and c.column_id = fk.parent_column_id              left join sys.tables as t2 on t2.object_id = fk.referenced_object_id              left join sys.columns as c2 on c2.object_id = t2.object_id and c2.column_id = fk.referenced_column_id              left join sys.key_constraints as k on k.parent_object_id = t.object_id and k.type = 'PK'              left join sys.index_columns as i on i.object_id = t.object_id and i.index_id = k.unique_index_id and i.column_id = c.column_id              WHERE t.name = 'LST_DICTIONARY'              ORDER BY c.column_id]
2019-08-16 15:34:09,812 [1] DEBUG - Statement Id: [DAO00012_GetList] PreparedStatement : [select        DICTIONARY_ID,        DICTIONARY_CODE,        DICTIONARY_NAME,        ATTRIBUTE1,        ATTRIBUTE2,        DICTIONARY_NAME_EN        from LST_DICTIONARY        where LST_DICTIONARY.Enabled = '1'         AND           LST_DICTIONARY.DICTIONARY_TYPE_CODE = 'DM_Columns_Properties'                 order by LST_DICTIONARY.IDX]
2019-08-16 15:34:09,846 [1] DEBUG - Statement Id: [DAO00208_GetDataByCategory] PreparedStatement : [SELECT ROW_NUMBER() OVER(ORDER BY(SELECT 1)) AS PRIMARY_ID, DICTIONARY_ID, DICTIONARY_TYPE_ID, DICTIONARY_TYPE_CODE, DICTIONARY_CODE, DICTIONARY_NAME, DICTIONARY_NAME_EN, DICTIONARY_NAME_RU, PARENT_ID, IDX, ENABLED, LATIN_NAME, ATTRIBUTE1, ATTRIBUTE2, ATTRIBUTE3, ATTRIBUTE4              FROM LST_DICTIONARY               WHERE DICTIONARY_TYPE_ID = 37 AND DICTIONARY_TYPE_CODE = 'VPP_MucDichChungTu']
2019-08-16 15:34:09,889 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01']
2019-08-16 15:34:18,527 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 15:34:33,000 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2019-08-16 15:34:33,461 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-08-16 15:34:33,491 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-08-16 15:34:33,617 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 15:34:33,807 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-08-16 15:34:41,825 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2019-08-16 15:34:41,869 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-08-16 15:34:43,026 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-08-16 15:34:43,180 [21] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-08-16 15:34:43,720 [21] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2019-08-16 15:34:43,808 [21] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2019-08-16 15:34:43,890 [21] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2019-08-16 15:34:43,978 [21] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2019-08-16 15:34:44,071 [21] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2019-08-16 15:34:44,165 [21] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2019-08-16 15:34:44,238 [21] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2019-08-16 15:34:44,318 [21] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2019-08-16 15:34:44,431 [21] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2019-08-16 15:34:44,918 [21] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2019-08-16 15:34:44,953 [21] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2019-08-16 15:34:45,025 [21] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2019-08-16 15:34:45,062 [21] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2019-08-16 15:34:48,736 [21] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2019-08-16 15:34:48,824 [21] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 0 as PHAMVI_ID, 0 as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0         end                else        begin        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2019-08-16 15:34:52,875 [21] DEBUG - Statement Id: [DAO00320_GetList] PreparedStatement : [select M.*            from TM_MAU M            LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID            where            M.TAMNGUNG = '0'            and M.BENHVIEN_ID = 'HLU01'            order by M.TENMAU]
2019-08-16 15:34:52,942 [21] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2019-08-16 15:34:53,280 [21] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT          TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,          TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,          SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH          FROM TT_MAU_TONKHO TK          JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID          JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID          JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'          LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID          LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID          WHERE TK.SOLUONG > 0          GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,          TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2019-08-16 15:34:53,362 [21] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2019-08-16 15:34:53,396 [21] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct          TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,          TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,          TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH          from TM_MAU M          JOIN          (          select          A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO          from          (          select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO          from TT_MAU_TONKHO TK          JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID          inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID          left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'          where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0          ) A          )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'          LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID          LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2019-08-16 15:34:53,470 [21] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2019-08-16 15:34:54,362 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 15:34:54,556 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2019-08-16 15:34:54,734 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2019-08-16 15:34:54,761 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2019-08-16 15:34:54,883 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 15:34:55,013 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 15:34:55,097 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2019-08-16 15:34:55,097 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-08-16 15:34:55,097 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-08-16 15:34:55,124 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2019-08-16 15:34:55,124 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-08-16 15:34:55,124 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-08-16 15:34:55,191 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 15:34:55,347 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 15:34:56,183 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 15:34:56,269 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2019-08-16 15:34:56,485 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2019-08-16 15:35:07,372 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'STA06'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 15:35:07,684 [1] DEBUG - Statement Id: [DAO00401_INV001_GetDMNhanVien] PreparedStatement : [SELECT NHANVIEN_ID,TENNHANVIEN,NHANVIEN_ID AS NHANVIENNHAN_ID,TENNHANVIEN AS TENNHANVIENNHAN FROM [TM_NHANVIEN]        where BENHVIEN_ID = 'HLU01'        ORDER BY TENNHANVIEN]
2019-08-16 15:35:08,011 [1] DEBUG - Statement Id: [DAO00401_INV001_GetDMKHOVPP] PreparedStatement : [Select K.*,BB.SODU,BB.SODUDENNGAY,BB.KHOASO,BB.NGAYKHOA  From TM_KHO K        LEFT JOIN TM_INV_KHO BB ON K.MAKHO = BB.MAKHO        LEFT JOIN LST_DICTIONARY AA ON AA.DICTIONARY_ID = K.MODULE_ID        WHERE AA.DICTIONARY_CODE = 'KhoVPP']
2019-08-16 15:35:08,192 [1] DEBUG - Statement Id: [DAO00401_GetListMucDichChungTu] PreparedStatement : [SELECT DICTIONARY_ID, DICTIONARY_CODE, DICTIONARY_NAME        FROM LST_DICTIONARY        WHERE DICTIONARY_TYPE_CODE = 'VPP_MucDichChungTu'        AND ENABLED = '1']
2019-08-16 15:35:08,390 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
--------------------------------------------------------------------------------
2019-08-16 15:44:21,043 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2019-08-16 15:44:22,421 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-08-16 15:44:22,473 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-08-16 15:44:22,876 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 15:44:23,149 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-08-16 15:44:28,069 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2019-08-16 15:44:28,097 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-08-16 15:44:29,501 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-08-16 15:44:30,033 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-08-16 15:44:30,854 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2019-08-16 15:44:30,996 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2019-08-16 15:44:31,079 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2019-08-16 15:44:31,161 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2019-08-16 15:44:31,250 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2019-08-16 15:44:31,321 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2019-08-16 15:44:31,390 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2019-08-16 15:44:31,461 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2019-08-16 15:44:31,549 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2019-08-16 15:44:32,055 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2019-08-16 15:44:32,090 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2019-08-16 15:44:32,164 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2019-08-16 15:44:32,196 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2019-08-16 15:44:33,558 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2019-08-16 15:44:33,597 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 0 as PHAMVI_ID, 0 as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0         end                else        begin        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2019-08-16 15:44:35,644 [5] DEBUG - Statement Id: [DAO00320_GetList] PreparedStatement : [select M.*            from TM_MAU M            LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID            where            M.TAMNGUNG = '0'            and M.BENHVIEN_ID = 'HLU01'            order by M.TENMAU]
2019-08-16 15:44:35,755 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2019-08-16 15:44:35,793 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT          TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,          TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,          SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH          FROM TT_MAU_TONKHO TK          JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID          JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID          JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'          LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID          LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID          WHERE TK.SOLUONG > 0          GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,          TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2019-08-16 15:44:35,863 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2019-08-16 15:44:35,899 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct          TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,          TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,          TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH          from TM_MAU M          JOIN          (          select          A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO          from          (          select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO          from TT_MAU_TONKHO TK          JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID          inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID          left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'          where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0          ) A          )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'          LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID          LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2019-08-16 15:44:35,970 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2019-08-16 15:44:36,892 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 15:44:37,799 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2019-08-16 15:44:42,750 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2019-08-16 15:44:42,791 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2019-08-16 15:44:42,881 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 15:44:43,013 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 15:44:43,151 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2019-08-16 15:44:43,153 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-08-16 15:44:43,153 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-08-16 15:44:43,187 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2019-08-16 15:44:43,187 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-08-16 15:44:43,187 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-08-16 15:44:43,313 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 15:44:43,459 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 15:44:50,693 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 15:44:50,810 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2019-08-16 15:44:51,046 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2019-08-16 15:44:57,715 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'STA06'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 15:44:58,073 [1] DEBUG - Statement Id: [DAO00401_INV001_GetDMNhanVien] PreparedStatement : [SELECT NHANVIEN_ID,TENNHANVIEN,NHANVIEN_ID AS NHANVIENNHAN_ID,TENNHANVIEN AS TENNHANVIENNHAN FROM [TM_NHANVIEN]        where BENHVIEN_ID = 'HLU01'        ORDER BY TENNHANVIEN]
2019-08-16 15:44:58,484 [1] DEBUG - Statement Id: [DAO00401_INV001_GetDMKHOVPP] PreparedStatement : [Select K.*,BB.SODU,BB.SODUDENNGAY,BB.KHOASO,BB.NGAYKHOA  From TM_KHO K        LEFT JOIN TM_INV_KHO BB ON K.MAKHO = BB.MAKHO        LEFT JOIN LST_DICTIONARY AA ON AA.DICTIONARY_ID = K.MODULE_ID        WHERE AA.DICTIONARY_CODE = 'KhoVPP']
2019-08-16 15:44:58,685 [1] DEBUG - Statement Id: [DAO00401_GetListMucDichChungTu] PreparedStatement : [SELECT DICTIONARY_ID, DICTIONARY_CODE, DICTIONARY_NAME        FROM LST_DICTIONARY        WHERE DICTIONARY_TYPE_CODE = 'VPP_MucDichChungTu'        AND ENABLED = '1']
2019-08-16 15:44:59,599 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 15:45:09,215 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM98'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
--------------------------------------------------------------------------------
2019-08-16 15:46:42,422 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2019-08-16 15:46:42,716 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-08-16 15:46:42,755 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-08-16 15:46:43,108 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 15:46:43,320 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-08-16 15:46:48,752 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2019-08-16 15:46:48,782 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-08-16 15:46:50,289 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-08-16 15:46:50,400 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-08-16 15:46:51,255 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2019-08-16 15:46:51,387 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2019-08-16 15:46:51,459 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2019-08-16 15:46:51,535 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2019-08-16 15:46:51,619 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2019-08-16 15:46:51,698 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2019-08-16 15:46:51,792 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2019-08-16 15:46:51,868 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2019-08-16 15:46:51,940 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2019-08-16 15:46:52,447 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2019-08-16 15:46:52,496 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2019-08-16 15:46:52,578 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2019-08-16 15:46:52,652 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2019-08-16 15:46:53,501 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2019-08-16 15:46:53,536 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 0 as PHAMVI_ID, 0 as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0         end                else        begin        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2019-08-16 15:46:55,680 [5] DEBUG - Statement Id: [DAO00320_GetList] PreparedStatement : [select M.*            from TM_MAU M            LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID            where            M.TAMNGUNG = '0'            and M.BENHVIEN_ID = 'HLU01'            order by M.TENMAU]
2019-08-16 15:46:55,760 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2019-08-16 15:46:55,802 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT          TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,          TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,          SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH          FROM TT_MAU_TONKHO TK          JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID          JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID          JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'          LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID          LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID          WHERE TK.SOLUONG > 0          GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,          TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2019-08-16 15:46:55,875 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2019-08-16 15:46:55,914 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct          TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,          TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,          TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH          from TM_MAU M          JOIN          (          select          A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO          from          (          select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO          from TT_MAU_TONKHO TK          JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID          inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID          left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'          where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0          ) A          )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'          LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID          LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2019-08-16 15:46:55,981 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2019-08-16 15:46:56,978 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 15:46:58,264 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2019-08-16 15:47:03,992 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2019-08-16 15:47:04,026 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2019-08-16 15:47:04,729 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 15:47:04,911 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 15:47:05,536 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2019-08-16 15:47:05,539 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-08-16 15:47:05,539 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-08-16 15:47:05,569 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2019-08-16 15:47:05,569 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-08-16 15:47:05,569 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-08-16 15:47:05,721 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 15:47:05,982 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 15:47:15,571 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 15:47:15,665 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2019-08-16 15:47:16,020 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2019-08-16 15:48:55,250 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'STA06'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 15:48:55,656 [1] DEBUG - Statement Id: [DAO00401_INV001_GetDMNhanVien] PreparedStatement : [SELECT NHANVIEN_ID,TENNHANVIEN,NHANVIEN_ID AS NHANVIENNHAN_ID,TENNHANVIEN AS TENNHANVIENNHAN FROM [TM_NHANVIEN]        where BENHVIEN_ID = 'HLU01'        ORDER BY TENNHANVIEN]
2019-08-16 15:48:56,076 [1] DEBUG - Statement Id: [DAO00401_INV001_GetDMKHOVPP] PreparedStatement : [Select K.*,BB.SODU,BB.SODUDENNGAY,BB.KHOASO,BB.NGAYKHOA  From TM_KHO K        LEFT JOIN TM_INV_KHO BB ON K.MAKHO = BB.MAKHO        LEFT JOIN LST_DICTIONARY AA ON AA.DICTIONARY_ID = K.MODULE_ID        WHERE AA.DICTIONARY_CODE = 'KhoVPP']
2019-08-16 15:48:56,258 [1] DEBUG - Statement Id: [DAO00401_GetListMucDichChungTu] PreparedStatement : [SELECT DICTIONARY_ID, DICTIONARY_CODE, DICTIONARY_NAME        FROM LST_DICTIONARY        WHERE DICTIONARY_TYPE_CODE = 'VPP_MucDichChungTu'        AND ENABLED = '1']
2019-08-16 15:48:56,966 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
--------------------------------------------------------------------------------
2019-08-16 16:05:35,028 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2019-08-16 16:05:35,339 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-08-16 16:05:35,384 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-08-16 16:05:35,838 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 16:05:36,071 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-08-16 16:05:41,201 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2019-08-16 16:05:41,229 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-08-16 16:05:42,718 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-08-16 16:05:42,805 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-08-16 16:05:43,607 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2019-08-16 16:05:43,749 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2019-08-16 16:05:43,820 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2019-08-16 16:05:43,896 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2019-08-16 16:05:43,966 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2019-08-16 16:05:44,036 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2019-08-16 16:05:44,107 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2019-08-16 16:05:44,177 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2019-08-16 16:05:44,250 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2019-08-16 16:05:44,760 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2019-08-16 16:05:44,804 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2019-08-16 16:05:44,876 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2019-08-16 16:05:44,911 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2019-08-16 16:05:47,598 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2019-08-16 16:05:47,632 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 0 as PHAMVI_ID, 0 as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0         end                else        begin        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2019-08-16 16:05:49,980 [5] DEBUG - Statement Id: [DAO00320_GetList] PreparedStatement : [select M.*            from TM_MAU M            LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID            where            M.TAMNGUNG = '0'            and M.BENHVIEN_ID = 'HLU01'            order by M.TENMAU]
2019-08-16 16:05:50,045 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2019-08-16 16:05:50,091 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT          TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,          TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,          SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH          FROM TT_MAU_TONKHO TK          JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID          JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID          JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'          LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID          LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID          WHERE TK.SOLUONG > 0          GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,          TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2019-08-16 16:05:50,177 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2019-08-16 16:05:50,214 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct          TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,          TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,          TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH          from TM_MAU M          JOIN          (          select          A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO          from          (          select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO          from TT_MAU_TONKHO TK          JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID          inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID          left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'          where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0          ) A          )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'          LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID          LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2019-08-16 16:05:50,280 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2019-08-16 16:05:51,198 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 16:05:52,087 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2019-08-16 16:05:56,859 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2019-08-16 16:05:56,890 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2019-08-16 16:05:56,963 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 16:05:57,128 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 16:05:57,280 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2019-08-16 16:05:57,282 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-08-16 16:05:57,282 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-08-16 16:05:57,312 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2019-08-16 16:05:57,312 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-08-16 16:05:57,312 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-08-16 16:05:57,440 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 16:05:57,585 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 16:06:05,564 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 16:06:05,874 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2019-08-16 16:06:06,338 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2019-08-16 16:06:11,653 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'STA06'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 16:06:12,222 [1] DEBUG - Statement Id: [DAO00401_INV001_GetDMNhanVien] PreparedStatement : [SELECT NHANVIEN_ID,TENNHANVIEN,NHANVIEN_ID AS NHANVIENNHAN_ID,TENNHANVIEN AS TENNHANVIENNHAN FROM [TM_NHANVIEN]        where BENHVIEN_ID = 'HLU01'        ORDER BY TENNHANVIEN]
2019-08-16 16:06:12,813 [1] DEBUG - Statement Id: [DAO00401_INV001_GetDMKHOVPP] PreparedStatement : [Select K.*,BB.SODU,BB.SODUDENNGAY,BB.KHOASO,BB.NGAYKHOA  From TM_KHO K        LEFT JOIN TM_INV_KHO BB ON K.MAKHO = BB.MAKHO        LEFT JOIN LST_DICTIONARY AA ON AA.DICTIONARY_ID = K.MODULE_ID        WHERE AA.DICTIONARY_CODE = 'KhoVPP']
2019-08-16 16:06:13,233 [1] DEBUG - Statement Id: [DAO00401_GetListMucDichChungTu] PreparedStatement : [SELECT DICTIONARY_ID, DICTIONARY_CODE, DICTIONARY_NAME        FROM LST_DICTIONARY        WHERE DICTIONARY_TYPE_CODE = 'VPP_MucDichChungTu'        AND ENABLED = '1']
2019-08-16 16:06:14,237 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 16:06:16,279 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'STA07'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 16:06:16,554 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM98'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 16:06:17,115 [1] DEBUG - Statement Id: [DAO00401_INV001_ChungTuXuatSearch] PreparedStatement : [select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/16/2019 4:06:17 PM' AND '8/16/2019 4:06:17 PM'        AND CT.MAKHOXUAT = 'KCVPP'                   UNION          select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/16/2019 4:06:17 PM' AND '8/16/2019 4:06:17 PM'        AND CT.MAKHOXUAT = 'KCVPP']
2019-08-16 16:06:17,461 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatChiTiet_ChungTuID] PreparedStatement : [select CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        FROM TT_INV_CHUNGTUXUATCHITIET CTCT INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID        WHERE CTCT.BENHVIEN_ID = 'HLU01' AND CTCT.CHUNGTUXUAT_ID='6']
2019-08-16 16:06:19,204 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatChiTiet_ChungTuID] PreparedStatement : [select CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        FROM TT_INV_CHUNGTUXUATCHITIET CTCT INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID        WHERE CTCT.BENHVIEN_ID = 'HLU01' AND CTCT.CHUNGTUXUAT_ID='8']
2019-08-16 16:06:19,709 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatAll] PreparedStatement : [SELECT CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,      CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID,      CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,      TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA      FROM TT_INV_CHUNGTUXUAT CT INNER JOIN TT_INV_CHUNGTUXUATCHITIET CTCT ON CT.CHUNGTUXUAT_ID=CTCT.CHUNGTUXUAT_ID             INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID      where CT.BENHVIEN_ID = 'HLU01' AND CT.MACHUNGTU = 'X07190816153217'             ORDER BY TD.TENHANGHOA]
2019-08-16 16:06:20,213 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 16:06:29,398 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
--------------------------------------------------------------------------------
2019-08-16 16:10:05,428 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2019-08-16 16:10:05,774 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-08-16 16:10:05,819 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-08-16 16:10:06,438 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 16:10:06,651 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-08-16 16:10:12,492 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2019-08-16 16:10:12,550 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-08-16 16:10:14,112 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-08-16 16:10:14,204 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-08-16 16:10:15,001 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2019-08-16 16:10:15,138 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2019-08-16 16:10:15,231 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2019-08-16 16:10:15,330 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2019-08-16 16:10:15,415 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2019-08-16 16:10:15,500 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2019-08-16 16:10:15,569 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2019-08-16 16:10:15,676 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2019-08-16 16:10:15,748 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2019-08-16 16:10:16,251 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2019-08-16 16:10:16,291 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2019-08-16 16:10:16,713 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2019-08-16 16:10:16,747 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2019-08-16 16:10:20,197 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2019-08-16 16:10:20,229 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 0 as PHAMVI_ID, 0 as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0         end                else        begin        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2019-08-16 16:10:25,376 [5] DEBUG - Statement Id: [DAO00320_GetList] PreparedStatement : [select M.*            from TM_MAU M            LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID            where            M.TAMNGUNG = '0'            and M.BENHVIEN_ID = 'HLU01'            order by M.TENMAU]
2019-08-16 16:10:25,448 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2019-08-16 16:10:25,480 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT          TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,          TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,          SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH          FROM TT_MAU_TONKHO TK          JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID          JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID          JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'          LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID          LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID          WHERE TK.SOLUONG > 0          GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,          TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2019-08-16 16:10:25,574 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2019-08-16 16:10:25,610 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct          TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,          TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,          TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH          from TM_MAU M          JOIN          (          select          A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO          from          (          select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO          from TT_MAU_TONKHO TK          JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID          inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID          left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'          where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0          ) A          )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'          LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID          LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2019-08-16 16:10:25,679 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2019-08-16 16:10:26,621 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 16:10:27,560 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2019-08-16 16:10:33,037 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2019-08-16 16:10:33,067 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2019-08-16 16:10:33,173 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 16:10:33,309 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 16:10:33,518 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2019-08-16 16:10:33,520 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-08-16 16:10:33,520 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-08-16 16:10:33,627 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2019-08-16 16:10:33,627 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-08-16 16:10:33,627 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-08-16 16:10:33,780 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 16:10:33,951 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 16:10:41,638 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 16:10:42,014 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2019-08-16 16:10:42,350 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2019-08-16 16:10:51,614 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'STA06'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 16:10:52,014 [1] DEBUG - Statement Id: [DAO00401_INV001_GetDMNhanVien] PreparedStatement : [SELECT NHANVIEN_ID,TENNHANVIEN,NHANVIEN_ID AS NHANVIENNHAN_ID,TENNHANVIEN AS TENNHANVIENNHAN FROM [TM_NHANVIEN]        where BENHVIEN_ID = 'HLU01'        ORDER BY TENNHANVIEN]
2019-08-16 16:10:52,454 [1] DEBUG - Statement Id: [DAO00401_INV001_GetDMKHOVPP] PreparedStatement : [Select K.*,BB.SODU,BB.SODUDENNGAY,BB.KHOASO,BB.NGAYKHOA  From TM_KHO K        LEFT JOIN TM_INV_KHO BB ON K.MAKHO = BB.MAKHO        LEFT JOIN LST_DICTIONARY AA ON AA.DICTIONARY_ID = K.MODULE_ID        WHERE AA.DICTIONARY_CODE = 'KhoVPP']
2019-08-16 16:10:52,641 [1] DEBUG - Statement Id: [DAO00401_GetListMucDichChungTu] PreparedStatement : [SELECT DICTIONARY_ID, DICTIONARY_CODE, DICTIONARY_NAME        FROM LST_DICTIONARY        WHERE DICTIONARY_TYPE_CODE = 'VPP_MucDichChungTu'        AND ENABLED = '1']
2019-08-16 16:10:53,448 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 16:11:27,039 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 16:11:48,673 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 16:12:04,650 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 16:12:04,729 [1] DEBUG - Statement Id: [DAO00401_INV001_GetTonKho] PreparedStatement : [SELECT TKTH.HANGHOA_ID,TKTH.MAHANGHOA,TKTH.TENHANGHOA,HH.DONVITINH_ID,HH.TENDONVITINH,SUM(TKTH.SOLUONGTONDAU+TKTH.SOLUONGNHAP-TKTH.SOLUONGXUAT) AS SOLUONGTONCUOI        FROM TM_PUR_HANGHOA HH INNER JOIN TT_INV_TONKHOTONGHOP TKTH ON HH.ID = TKTH.HANGHOA_ID        where TKTH.BENHVIEN_ID = 'HLU01' AND TKTH.MAKHO = 'KCVPP' AND TKTH.MMYY='0819'        GROUP BY TKTH.HANGHOA_ID,TKTH.MAHANGHOA,TKTH.TENHANGHOA,HH.DONVITINH_ID,HH.TENDONVITINH]
2019-08-16 16:12:07,556 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraMaChungTuXuatTonTai] PreparedStatement : [select CT.IDCHUYEN        FROM TT_INV_CHUNGTUXUAT CT        where CT.MACHUNGTU = 'X21190816161207' AND CT.BENHVIEN_ID = 'HLU01'         AND         CT.MMYY IN(0819)]
2019-08-16 16:12:09,105 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuat] PreparedStatement : [INSERT INTO TT_INV_CHUNGTUXUAT      (MACHUNGTU,MMYY,NGAYCHUNGTU,MAKHOXUAT,TENKHOXUAT,PHONGBANNHAN_ID,TENPHONGBANNHAN,NHANVIENNHAN_ID,TENNHANVIENNHAN,GHICHU,PHIEUYEUCAU_ID,MAPHIEUYEUCAU,XUATKHOTHEO,TENNGUOITAO,BENHVIEN_ID,NGAYTAO,NGUOITAO_ID                , MUCDICHCHUNGTU_ID                , MUCDICHCHUNGTU_CODE             )      VALUES ( @param0 , @param1 , @param2 , @param3 , @param4 , @param5 , @param6 , @param7 , @param8 , @param9 , @param10 , @param11 , @param12 , @param13 , @param14 ,GETDATE(), @param15                 ,  @param16                 ,  @param17              )      SELECT SCOPE_IDENTITY()]
2019-08-16 16:12:09,105 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuat] Parameters: [@param0=[MACHUNGTU,X21190816161207], @param1=[MMYY,0819], @param2=[NGAYCHUNGTU,8/16/2019 4:10:53 PM], @param3=[MAKHOXUAT,KCVPP], @param4=[TENKHOXUAT,Kho chính VPP], @param5=[PHONGBANNHAN_ID,null], @param6=[TENPHONGBANNHAN,null], @param7=[NHANVIENNHAN_ID,2], @param8=[TENNHANVIENNHAN,Bùi Cao Kháng], @param9=[GHICHU,xuất khác test], @param10=[PHIEUYEUCAU_ID,null], @param11=[MAPHIEUYEUCAU,null], @param12=[XUATKHOTHEO,Hạn dùng], @param13=[TENNGUOITAO,Administrator], @param14=[BENHVIEN_ID,HLU01], @param15=[NGUOITAO_ID,1], @param16=[MUCDICHCHUNGTU_ID,11712], @param17=[MUCDICHCHUNGTU_CODE,X21]]
2019-08-16 16:12:09,105 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuat] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[DateTime, System.DateTime], @param3=[String, System.String], @param4=[String, System.String], @param5=[System.DBNull, null], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[String, System.String], @param9=[String, System.String], @param10=[System.DBNull, null], @param11=[System.DBNull, null], @param12=[String, System.String], @param13=[String, System.String], @param14=[String, System.String], @param15=[Int64, System.Int64], @param16=[Int64, System.Int64], @param17=[String, System.String]]
2019-08-16 16:12:09,606 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM98'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
--------------------------------------------------------------------------------
2019-08-16 16:23:46,023 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2019-08-16 16:23:46,307 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-08-16 16:23:46,409 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-08-16 16:23:46,825 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 16:23:47,099 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-08-16 16:23:53,519 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2019-08-16 16:23:53,549 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-08-16 16:23:55,038 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-08-16 16:23:55,122 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-08-16 16:23:56,191 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2019-08-16 16:23:56,433 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2019-08-16 16:23:56,583 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2019-08-16 16:23:56,670 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2019-08-16 16:23:56,814 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2019-08-16 16:23:57,005 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2019-08-16 16:23:57,116 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2019-08-16 16:23:57,227 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2019-08-16 16:23:57,348 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2019-08-16 16:23:58,000 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2019-08-16 16:23:58,114 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2019-08-16 16:23:58,202 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2019-08-16 16:23:58,284 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2019-08-16 16:24:03,376 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2019-08-16 16:24:03,461 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 0 as PHAMVI_ID, 0 as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0         end                else        begin        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2019-08-16 16:24:10,922 [5] DEBUG - Statement Id: [DAO00320_GetList] PreparedStatement : [select M.*            from TM_MAU M            LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID            where            M.TAMNGUNG = '0'            and M.BENHVIEN_ID = 'HLU01'            order by M.TENMAU]
2019-08-16 16:24:11,051 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2019-08-16 16:24:11,103 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT          TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,          TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,          SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH          FROM TT_MAU_TONKHO TK          JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID          JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID          JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'          LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID          LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID          WHERE TK.SOLUONG > 0          GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,          TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2019-08-16 16:24:11,670 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2019-08-16 16:24:11,711 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct          TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,          TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,          TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH          from TM_MAU M          JOIN          (          select          A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO          from          (          select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO          from TT_MAU_TONKHO TK          JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID          inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID          left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'          where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0          ) A          )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'          LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID          LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2019-08-16 16:24:11,798 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2019-08-16 16:24:12,784 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 16:24:13,929 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
--------------------------------------------------------------------------------
2019-08-16 16:28:15,959 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2019-08-16 16:28:16,231 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-08-16 16:28:16,271 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-08-16 16:28:16,906 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 16:28:17,137 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-08-16 16:28:23,679 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2019-08-16 16:28:23,708 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-08-16 16:28:25,162 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-08-16 16:28:25,257 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-08-16 16:28:26,083 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2019-08-16 16:28:26,224 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2019-08-16 16:28:26,304 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2019-08-16 16:28:26,379 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2019-08-16 16:28:26,453 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2019-08-16 16:28:26,532 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2019-08-16 16:28:26,602 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2019-08-16 16:28:26,689 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2019-08-16 16:28:26,775 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2019-08-16 16:28:27,294 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2019-08-16 16:28:27,351 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2019-08-16 16:28:27,425 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2019-08-16 16:28:27,458 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2019-08-16 16:28:28,285 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2019-08-16 16:28:28,322 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 0 as PHAMVI_ID, 0 as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0         end                else        begin        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2019-08-16 16:28:30,660 [5] DEBUG - Statement Id: [DAO00320_GetList] PreparedStatement : [select M.*            from TM_MAU M            LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID            where            M.TAMNGUNG = '0'            and M.BENHVIEN_ID = 'HLU01'            order by M.TENMAU]
2019-08-16 16:28:30,730 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2019-08-16 16:28:30,769 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT          TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,          TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,          SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH          FROM TT_MAU_TONKHO TK          JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID          JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID          JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'          LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID          LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID          WHERE TK.SOLUONG > 0          GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,          TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2019-08-16 16:28:30,862 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2019-08-16 16:28:30,896 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct          TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,          TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,          TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH          from TM_MAU M          JOIN          (          select          A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO          from          (          select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO          from TT_MAU_TONKHO TK          JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID          inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID          left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'          where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0          ) A          )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'          LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID          LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2019-08-16 16:28:31,024 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2019-08-16 16:28:31,949 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 16:28:32,812 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2019-08-16 16:28:37,499 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2019-08-16 16:28:37,530 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2019-08-16 16:28:37,612 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 16:28:38,066 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 16:28:38,269 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2019-08-16 16:28:38,272 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-08-16 16:28:38,272 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-08-16 16:28:38,307 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2019-08-16 16:28:38,307 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-08-16 16:28:38,307 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-08-16 16:28:38,460 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 16:28:38,661 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 16:28:46,200 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 16:28:46,304 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2019-08-16 16:28:46,616 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2019-08-16 16:28:52,385 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'STA06'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 16:28:52,737 [1] DEBUG - Statement Id: [DAO00401_INV001_GetDMNhanVien] PreparedStatement : [SELECT NHANVIEN_ID,TENNHANVIEN,NHANVIEN_ID AS NHANVIENNHAN_ID,TENNHANVIEN AS TENNHANVIENNHAN FROM [TM_NHANVIEN]        where BENHVIEN_ID = 'HLU01'        ORDER BY TENNHANVIEN]
2019-08-16 16:28:53,132 [1] DEBUG - Statement Id: [DAO00401_INV001_GetDMKHOVPP] PreparedStatement : [Select K.*,BB.SODU,BB.SODUDENNGAY,BB.KHOASO,BB.NGAYKHOA  From TM_KHO K        LEFT JOIN TM_INV_KHO BB ON K.MAKHO = BB.MAKHO        LEFT JOIN LST_DICTIONARY AA ON AA.DICTIONARY_ID = K.MODULE_ID        WHERE AA.DICTIONARY_CODE = 'KhoVPP']
2019-08-16 16:28:53,318 [1] DEBUG - Statement Id: [DAO00401_GetListMucDichChungTu] PreparedStatement : [SELECT DICTIONARY_ID, DICTIONARY_CODE, DICTIONARY_NAME        FROM LST_DICTIONARY        WHERE DICTIONARY_TYPE_CODE = 'VPP_MucDichChungTu'        AND ENABLED = '1']
2019-08-16 16:28:54,224 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 16:29:18,060 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'STA05'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 16:29:18,407 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM98'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 16:29:18,916 [1] DEBUG - Statement Id: [DAO00401_INV001_PhieuYeuCauSearch] PreparedStatement : [select YC.PHIEUYEUCAU_ID,YC.MAPHIEUYEUCAU,YC.MMYY,YC.NGAYLAP,YC.PHONGBAN_ID,YC.TENPHONGBAN,YC.MAKHOXUAT,YC.TENKHOXUAT,YC.GHICHU,YC.TENNGUOITAO,YC.TENNGUOICAPNHAT,YC.BENHVIEN_ID,YC.NGAYTAO,YC.NGUOITAO_ID,YC.NGAYCAPNHAT,YC.NGUOICAPNHAT_ID        FROM TT_INV_PHIEUYEUCAU YC        WHERE YC.BENHVIEN_ID = 'HLU01' AND YC.NGAYLAP BETWEEN '7/16/2019 4:29:18 PM' AND '8/16/2019 4:29:18 PM'         AND           YC.CHUNGTUXUAT_ID IS NULL         AND           YC.MAKHOXUAT = 'KCVPP']
2019-08-16 16:29:34,707 [1] DEBUG - Statement Id: [DAO00401_INV001_PhieuYeuCauSearch] PreparedStatement : [select YC.PHIEUYEUCAU_ID,YC.MAPHIEUYEUCAU,YC.MMYY,YC.NGAYLAP,YC.PHONGBAN_ID,YC.TENPHONGBAN,YC.MAKHOXUAT,YC.TENKHOXUAT,YC.GHICHU,YC.TENNGUOITAO,YC.TENNGUOICAPNHAT,YC.BENHVIEN_ID,YC.NGAYTAO,YC.NGUOITAO_ID,YC.NGAYCAPNHAT,YC.NGUOICAPNHAT_ID        FROM TT_INV_PHIEUYEUCAU YC        WHERE YC.BENHVIEN_ID = 'HLU01' AND YC.NGAYLAP BETWEEN '5/1/2019 12:00:00 AM' AND '8/16/2019 4:29:18 PM'         AND           YC.CHUNGTUXUAT_ID IS NULL         AND           YC.MAKHOXUAT = 'KCVPP']
2019-08-16 16:29:36,294 [1] DEBUG - Statement Id: [DAO00401_INV001_GetPhieuYeuCauChiTiet_PhieuYeuCauID] PreparedStatement : [select YCCT.PHIEUYEUCAUCHITIET_ID,YCCT.HANGHOA_ID,YCCT.MAHANGHOA,YCCT.TENHANGHOA,YCCT.DONVITINH_ID,YCCT.TENDONVITINH,YCCT.SOLUONGYEUCAU,YCCT.SOLUONGDAXUAT        FROM TT_INV_PHIEUYEUCAUCHITIET YCCT        WHERE YCCT.BENHVIEN_ID = 'HLU01' AND YCCT.PHIEUYEUCAU_ID='27']
2019-08-16 16:29:36,763 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChiTietYC_MaPhieuYeuCau] PreparedStatement : [select YC.PHIEUYEUCAU_ID,YC.MAPHIEUYEUCAU,YC.MMYY,YC.NGAYLAP,YC.PHONGBAN_ID AS PHONGBANNHAN_ID,YC.TENPHONGBAN AS TENPHONGBANNHAN,YC.MAKHOXUAT,YC.TENKHOXUAT,        YCCT.PHIEUYEUCAUCHITIET_ID,YCCT.HANGHOA_ID,YCCT.MAHANGHOA,YCCT.TENHANGHOA,YCCT.DONVITINH_ID,YCCT.TENDONVITINH,YCCT.SOLUONGYEUCAU,YCCT.SOLUONGYEUCAU AS SOLUONGXUAT, NULL AS DONGIA,NULL AS LOSX,NULL AS HANDUNG,        TKTH.SOLUONGTONCUOI        FROM TT_INV_PHIEUYEUCAU YC INNER JOIN TT_INV_PHIEUYEUCAUCHITIET YCCT ON YC.PHIEUYEUCAU_ID=YCCT.PHIEUYEUCAU_ID        LEFT JOIN (SELECT (SOLUONGTONDAU+SOLUONGNHAP-SOLUONGXUAT) AS SOLUONGTONCUOI, HANGHOA_ID,MAKHO        FROM TT_INV_TONKHOTONGHOP WHERE BENHVIEN_ID='HLU01' AND MMYY='0819'        ) TKTH ON YCCT.HANGHOA_ID = TKTH.HANGHOA_ID AND YC.MAKHOXUAT = TKTH.MAKHO        WHERE YC.MAPHIEUYEUCAU='YC65190528140928' AND YC.BENHVIEN_ID = 'HLU01']
2019-08-16 16:29:45,589 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 16:29:52,200 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 16:30:01,913 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 16:31:07,864 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 16:31:07,993 [1] DEBUG - Statement Id: [DAO00401_INV001_GetTonKho] PreparedStatement : [SELECT TKTH.HANGHOA_ID,TKTH.MAHANGHOA,TKTH.TENHANGHOA,HH.DONVITINH_ID,HH.TENDONVITINH,SUM(TKTH.SOLUONGTONDAU+TKTH.SOLUONGNHAP-TKTH.SOLUONGXUAT) AS SOLUONGTONCUOI        FROM TM_PUR_HANGHOA HH INNER JOIN TT_INV_TONKHOTONGHOP TKTH ON HH.ID = TKTH.HANGHOA_ID        where TKTH.BENHVIEN_ID = 'HLU01' AND TKTH.MAKHO = 'KCVPP' AND TKTH.MMYY='0819'        GROUP BY TKTH.HANGHOA_ID,TKTH.MAHANGHOA,TKTH.TENHANGHOA,HH.DONVITINH_ID,HH.TENDONVITINH]
2019-08-16 16:31:10,286 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraMaChungTuXuatTonTai] PreparedStatement : [select CT.IDCHUYEN        FROM TT_INV_CHUNGTUXUAT CT        where CT.MACHUNGTU = 'X07190816163110' AND CT.BENHVIEN_ID = 'HLU01'         AND         CT.MMYY IN(0819)]
2019-08-16 16:31:11,207 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuat] PreparedStatement : [INSERT INTO TT_INV_CHUNGTUXUAT      (MACHUNGTU,MMYY,NGAYCHUNGTU,MAKHOXUAT,TENKHOXUAT,PHONGBANNHAN_ID,TENPHONGBANNHAN,NHANVIENNHAN_ID,TENNHANVIENNHAN,GHICHU,PHIEUYEUCAU_ID,MAPHIEUYEUCAU,XUATKHOTHEO,TENNGUOITAO,BENHVIEN_ID,NGAYTAO,NGUOITAO_ID                , MUCDICHCHUNGTU_ID                , MUCDICHCHUNGTU_CODE             )      VALUES ( @param0 , @param1 , @param2 , @param3 , @param4 , @param5 , @param6 , @param7 , @param8 , @param9 , @param10 , @param11 , @param12 , @param13 , @param14 ,GETDATE(), @param15                 ,  @param16                 ,  @param17              )      SELECT SCOPE_IDENTITY()]
2019-08-16 16:31:11,208 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuat] Parameters: [@param0=[MACHUNGTU,X07190816163110], @param1=[MMYY,0819], @param2=[NGAYCHUNGTU,8/16/2019 4:29:36 PM], @param3=[MAKHOXUAT,KCVPP], @param4=[TENKHOXUAT,Kho chính VPP], @param5=[PHONGBANNHAN_ID,65], @param6=[TENPHONGBANNHAN,Phòng khám sản (D.226)], @param7=[NHANVIENNHAN_ID,185], @param8=[TENNHANVIENNHAN,Bùi Hữu Dũng], @param9=[GHICHU,null], @param10=[PHIEUYEUCAU_ID,27], @param11=[MAPHIEUYEUCAU,YC65190528140928], @param12=[XUATKHOTHEO,Hạn dùng], @param13=[TENNGUOITAO,Administrator], @param14=[BENHVIEN_ID,HLU01], @param15=[NGUOITAO_ID,1], @param16=[MUCDICHCHUNGTU_ID,6994], @param17=[MUCDICHCHUNGTU_CODE,X07]]
2019-08-16 16:31:11,208 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuat] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[DateTime, System.DateTime], @param3=[String, System.String], @param4=[String, System.String], @param5=[Int64, System.Int64], @param6=[String, System.String], @param7=[Int64, System.Int64], @param8=[String, System.String], @param9=[System.DBNull, null], @param10=[Int64, System.Int64], @param11=[String, System.String], @param12=[String, System.String], @param13=[String, System.String], @param14=[String, System.String], @param15=[Int64, System.Int64], @param16=[Int64, System.Int64], @param17=[String, System.String]]
2019-08-16 16:31:12,002 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdChungTuXuatID_PhieuYeuCau] PreparedStatement : [UPDATE TT_INV_PHIEUYEUCAU SET CHUNGTUXUAT_ID =  @param0  WHERE PHIEUYEUCAU_ID = '27' AND BENHVIEN_ID = 'HLU01']
2019-08-16 16:31:12,002 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdChungTuXuatID_PhieuYeuCau] Parameters: [@param0=[CHUNGTUXUAT_ID,10]]
2019-08-16 16:31:12,002 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdChungTuXuatID_PhieuYeuCau] Types: [@param0=[Int64, System.Int64]]
2019-08-16 16:31:12,044 [1] DEBUG - Statement Id: [DAO00401_INV001_GetTonKhoChiTiet] PreparedStatement : [SELECT TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.DONGIA AS DONGIATRUOCVAT,TD.DONGIASAUVAT AS DONGIA,CASE WHEN TD.HANDUNG IS NULL THEN DATEADD(YEAR,999, GETDATE()) ELSE TD.HANDUNG END AS HANDUNG ,TD.NGAYTAO,        SUM(TKCT.SOLUONGTONDAU+TKCT.SOLUONGNHAP-TKCT.SOLUONGXUAT) AS SOLUONGTONCUOI        FROM TM_PUR_HANGHOA HH INNER JOIN TT_INV_THEODOI TD ON HH.ID = TD.HANGHOA_ID        INNER JOIN TT_INV_TONKHOCHITIET TKCT ON TD.THEODOI_ID = TKCT.THEODOI_ID        where TKCT.BENHVIEN_ID = 'HLU01' AND TKCT.MAKHO = 'KCVPP' AND TKCT.MMYY='0819'        GROUP BY TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.DONGIA,TD.DONGIASAUVAT,TD.HANDUNG,TD.NGAYTAO        ORDER BY TD.NGAYTAO]
2019-08-16 16:31:12,142 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuatChiTiet] PreparedStatement : [INSERT INTO TT_INV_CHUNGTUXUATCHITIET(CHUNGTUXUAT_ID,MMYY,THEODOI_ID,SOLUONGYEUCAU,SOLUONGXUAT,THANHTIEN,GHICHU,PHIEUYEUCAUCHITIET_ID,TENNGUOITAO,BENHVIEN_ID,NGAYTAO,NGUOITAO_ID)       VALUES( @param0 , @param1 , @param2 , @param3 , @param4 , @param5 , @param6 , @param7 , @param8 , @param9 ,GETDATE(), @param10 )        SELECT SCOPE_IDENTITY()]
2019-08-16 16:31:12,143 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuatChiTiet] Parameters: [@param0=[CHUNGTUXUAT_ID,10], @param1=[MMYY,0819], @param2=[THEODOI_ID,982], @param3=[SOLUONGYEUCAU,1000], @param4=[SOLUONGXUAT,1000], @param5=[THANHTIEN,0.0000], @param6=[CT_GHICHU,null], @param7=[PHIEUYEUCAUCHITIET_ID,62], @param8=[TENNGUOITAO,null], @param9=[BENHVIEN_ID,HLU01], @param10=[NGUOITAO_ID,null]]
2019-08-16 16:31:12,143 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuatChiTiet] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String], @param2=[Int32, System.Int32], @param3=[Double, System.Double], @param4=[Decimal, System.Decimal], @param5=[Decimal, System.Decimal], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[String, System.String], @param10=[System.DBNull, null]]
2019-08-16 16:31:12,196 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLDaXuat_PhieuYeuCauChiTietID] PreparedStatement : [UPDATE TT_INV_PHIEUYEUCAUCHITIET        SET SOLUONGDAXUAT= @param0         WHERE PHIEUYEUCAUCHITIET_ID = '62' AND BENHVIEN_ID = 'HLU01']
2019-08-16 16:31:12,196 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLDaXuat_PhieuYeuCauChiTietID] Parameters: [@param0=[SOLUONGXUAT,1000]]
2019-08-16 16:31:12,196 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLDaXuat_PhieuYeuCauChiTietID] Types: [@param0=[Decimal, System.Decimal]]
2019-08-16 16:31:12,247 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLXuatTonKho] PreparedStatement : [UPDATE TT_INV_TONKHOCHITIET SET SOLUONGXUAT=0 WHERE MMYY='0819' AND MAKHO IN('KCVPP');        MERGE TT_INV_TONKHOCHITIET AS X USING        (SELECT QQ.MMYY, QQ.MAKHO,QQ.TENKHO,QQ.THEODOI_ID,SUM(QQ.SOLUONGXUAT) AS SOLUONGXUAT FROM (        SELECT '0819' AS MMYY, A.MAKHOXUAT AS MAKHO,A.TENKHOXUAT AS TENKHO,B.THEODOI_ID,B.SOLUONGXUAT,C.NGAYTAO,C.NGUOITAO_ID        FROM TT_INV_CHUNGTUXUAT A INNER JOIN TT_INV_CHUNGTUXUATCHITIET B ON A.CHUNGTUXUAT_ID=B.CHUNGTUXUAT_ID AND A.MMYY='0819'        INNER JOIN TT_INV_THEODOI C ON B.THEODOI_ID=C.THEODOI_ID        WHERE A.MMYY='0819' AND A.BENHVIEN_ID='HLU01' AND A.MAKHOXUAT IN('KCVPP')        UNION ALL        SELECT '0819' AS MMYY, A.MAKHO,A.TENKHO,B.THEODOI_ID,B.SOLUONG AS SOLUONGXUAT,C.NGAYTAO,C.NGUOITAO_ID        FROM TT_INV_CHUNGTUTANGGIAM A INNER JOIN TT_INV_CHUNGTUTANGGIAMCHITIET B ON A.CHUNGTUTANGGIAM_ID=B.CHUNGTUTANGGIAM_ID AND A.MMYY='0819' AND A.LOAI='giam'        INNER JOIN TT_INV_THEODOI C ON B.THEODOI_ID=C.THEODOI_ID        WHERE A.MMYY='0819' AND A.LOAI='giam' AND A.BENHVIEN_ID='HLU01' AND A.MAKHO IN('KCVPP')) QQ        GROUP BY QQ.MMYY, QQ.MAKHO,QQ.TENKHO,QQ.THEODOI_ID) AS Y        ON (X.MMYY=Y.MMYY AND X.MAKHO=Y.MAKHO AND X.THEODOI_ID=Y.THEODOI_ID)        WHEN MATCHED THEN UPDATE SET X.SOLUONGXUAT=Y.SOLUONGXUAT        WHEN NOT MATCHED THEN                INSERT (MMYY,MAKHO,TENKHO,THEODOI_ID,SOLUONGXUAT,BENHVIEN_ID,NGAYTAO,NGUOITAO_ID) VALUES        ('0819',Y.MAKHO,Y.TENKHO,Y.THEODOI_ID,Y.SOLUONGXUAT, @param0 ,GETDATE(), '');          UPDATE TT_INV_TONKHOTONGHOP SET SOLUONGTONDAU=0,SOLUONGNHAP=0,SOLUONGXUAT=0 WHERE MMYY='0819' AND MAKHO IN('KCVPP');        MERGE TT_INV_TONKHOTONGHOP AS X USING        (SELECT '0819' AS MMYY,A.MAKHO,A.TENKHO,B.HANGHOA_ID,B.MAHANGHOA,HH.TEN,SUM(A.SOLUONGTONDAU) AS SOLUONGTONDAU,SUM(A.SOLUONGNHAP) AS SOLUONGNHAP,SUM(A.SOLUONGXUAT) AS SOLUONGXUAT        FROM TT_INV_TONKHOCHITIET A INNER JOIN TT_INV_THEODOI B ON A.THEODOI_ID=B.THEODOI_ID AND A.MMYY='0819'        JOIN TM_PUR_HANGHOA HH on HH.ID = B.HANGHOA_ID        WHERE A.MMYY='0819' AND A.BENHVIEN_ID='HLU01' AND A.MAKHO IN('KCVPP')        GROUP BY A.MAKHO,A.TENKHO,B.HANGHOA_ID,B.MAHANGHOA,HH.TEN) AS Y        ON (X.MMYY=Y.MMYY AND X.MAKHO=Y.MAKHO AND X.HANGHOA_ID=Y.HANGHOA_ID)          WHEN MATCHED THEN UPDATE SET X.SOLUONGTONDAU=Y.SOLUONGTONDAU, X.SOLUONGNHAP=Y.SOLUONGNHAP,X.SOLUONGXUAT=Y.SOLUONGXUAT        WHEN NOT MATCHED THEN                INSERT (MMYY,MAKHO,TENKHO,HANGHOA_ID,MAHANGHOA,TENHANGHOA,SOLUONGTONDAU,SOLUONGNHAP,SOLUONGXUAT,BENHVIEN_ID,NGAYTAO)        VALUES ('0819',Y.MAKHO,Y.TENKHO,Y.HANGHOA_ID,Y.MAHANGHOA,Y.TEN,Y.SOLUONGTONDAU,Y.SOLUONGNHAP,Y.SOLUONGXUAT, @param0 ,GETDATE());          DELETE FROM TT_INV_TONKHOCHITIET WHERE SOLUONGTONDAU=0 AND SOLUONGNHAP=0 AND SOLUONGXUAT=0;        DELETE FROM TT_INV_TONKHOTONGHOP WHERE SOLUONGTONDAU=0 AND SOLUONGNHAP=0 AND SOLUONGXUAT=0;]
2019-08-16 16:31:12,247 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLXuatTonKho] Parameters: [@param0=[BENHVIEN_ID,HLU01]]
2019-08-16 16:31:12,247 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLXuatTonKho] Types: [@param0=[String, System.String]]
2019-08-16 16:31:12,304 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdateTrangThaiPO_NhapKho] PreparedStatement : [UPDATE TT_PUR_CHUNGTU SET STATE_CODE =  @param0 , STATE_NAME =  @param1  WHERE MACHUNGTU = 'YC65190528140928' AND PROCESS_CODE = 'PO']
2019-08-16 16:31:12,304 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdateTrangThaiPO_NhapKho] Parameters: [@param0=[STATE_CODE,9], @param1=[STATE_NAME,Đã xuất kho]]
2019-08-16 16:31:12,304 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdateTrangThaiPO_NhapKho] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2019-08-16 16:31:12,478 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatAll] PreparedStatement : [SELECT CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,      CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID,      CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,      TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA      FROM TT_INV_CHUNGTUXUAT CT INNER JOIN TT_INV_CHUNGTUXUATCHITIET CTCT ON CT.CHUNGTUXUAT_ID=CTCT.CHUNGTUXUAT_ID             INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID      where CT.BENHVIEN_ID = 'HLU01' AND CT.MACHUNGTU = 'X07190816163110'             ORDER BY TD.TENHANGHOA]
2019-08-16 16:31:12,532 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 16:31:22,525 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 16:31:44,497 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 16:31:58,913 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 16:32:12,944 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 16:32:12,988 [1] DEBUG - Statement Id: [DAO00401_INV001_GetTonKho] PreparedStatement : [SELECT TKTH.HANGHOA_ID,TKTH.MAHANGHOA,TKTH.TENHANGHOA,HH.DONVITINH_ID,HH.TENDONVITINH,SUM(TKTH.SOLUONGTONDAU+TKTH.SOLUONGNHAP-TKTH.SOLUONGXUAT) AS SOLUONGTONCUOI        FROM TM_PUR_HANGHOA HH INNER JOIN TT_INV_TONKHOTONGHOP TKTH ON HH.ID = TKTH.HANGHOA_ID        where TKTH.BENHVIEN_ID = 'HLU01' AND TKTH.MAKHO = 'KCVPP' AND TKTH.MMYY='0819'        GROUP BY TKTH.HANGHOA_ID,TKTH.MAHANGHOA,TKTH.TENHANGHOA,HH.DONVITINH_ID,HH.TENDONVITINH]
2019-08-16 16:32:47,713 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 16:32:47,752 [1] DEBUG - Statement Id: [DAO00401_INV001_GetTonKho] PreparedStatement : [SELECT TKTH.HANGHOA_ID,TKTH.MAHANGHOA,TKTH.TENHANGHOA,HH.DONVITINH_ID,HH.TENDONVITINH,SUM(TKTH.SOLUONGTONDAU+TKTH.SOLUONGNHAP-TKTH.SOLUONGXUAT) AS SOLUONGTONCUOI        FROM TM_PUR_HANGHOA HH INNER JOIN TT_INV_TONKHOTONGHOP TKTH ON HH.ID = TKTH.HANGHOA_ID        where TKTH.BENHVIEN_ID = 'HLU01' AND TKTH.MAKHO = 'KCVPP' AND TKTH.MMYY='0819'        GROUP BY TKTH.HANGHOA_ID,TKTH.MAHANGHOA,TKTH.TENHANGHOA,HH.DONVITINH_ID,HH.TENDONVITINH]
2019-08-16 16:32:49,709 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraMaChungTuXuatTonTai] PreparedStatement : [select CT.IDCHUYEN        FROM TT_INV_CHUNGTUXUAT CT        where CT.MACHUNGTU = 'X21190816163249' AND CT.BENHVIEN_ID = 'HLU01'         AND         CT.MMYY IN(0819)]
2019-08-16 16:32:50,718 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuat] PreparedStatement : [INSERT INTO TT_INV_CHUNGTUXUAT      (MACHUNGTU,MMYY,NGAYCHUNGTU,MAKHOXUAT,TENKHOXUAT,PHONGBANNHAN_ID,TENPHONGBANNHAN,NHANVIENNHAN_ID,TENNHANVIENNHAN,GHICHU,PHIEUYEUCAU_ID,MAPHIEUYEUCAU,XUATKHOTHEO,TENNGUOITAO,BENHVIEN_ID,NGAYTAO,NGUOITAO_ID                , MUCDICHCHUNGTU_ID                , MUCDICHCHUNGTU_CODE             )      VALUES ( @param0 , @param1 , @param2 , @param3 , @param4 , @param5 , @param6 , @param7 , @param8 , @param9 , @param10 , @param11 , @param12 , @param13 , @param14 ,GETDATE(), @param15                 ,  @param16                 ,  @param17              )      SELECT SCOPE_IDENTITY()]
2019-08-16 16:32:50,718 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuat] Parameters: [@param0=[MACHUNGTU,X21190816163249], @param1=[MMYY,0819], @param2=[NGAYCHUNGTU,8/16/2019 4:31:22 PM], @param3=[MAKHOXUAT,KCVPP], @param4=[TENKHOXUAT,Kho chính VPP], @param5=[PHONGBANNHAN_ID,50], @param6=[TENPHONGBANNHAN,Phòng Kế Hoạch tổng hợp], @param7=[NHANVIENNHAN_ID,360], @param8=[TENNHANVIENNHAN,Bùi Thị Huyền], @param9=[GHICHU,xuất khác test], @param10=[PHIEUYEUCAU_ID,null], @param11=[MAPHIEUYEUCAU,null], @param12=[XUATKHOTHEO,Hạn dùng], @param13=[TENNGUOITAO,Administrator], @param14=[BENHVIEN_ID,HLU01], @param15=[NGUOITAO_ID,1], @param16=[MUCDICHCHUNGTU_ID,11712], @param17=[MUCDICHCHUNGTU_CODE,X21]]
2019-08-16 16:32:50,718 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuat] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[DateTime, System.DateTime], @param3=[String, System.String], @param4=[String, System.String], @param5=[Int64, System.Int64], @param6=[String, System.String], @param7=[Int64, System.Int64], @param8=[String, System.String], @param9=[String, System.String], @param10=[System.DBNull, null], @param11=[System.DBNull, null], @param12=[String, System.String], @param13=[String, System.String], @param14=[String, System.String], @param15=[Int64, System.Int64], @param16=[Int64, System.Int64], @param17=[String, System.String]]
2019-08-16 16:32:51,590 [1] DEBUG - Statement Id: [DAO00401_INV001_GetTonKhoChiTiet] PreparedStatement : [SELECT TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.DONGIA AS DONGIATRUOCVAT,TD.DONGIASAUVAT AS DONGIA,CASE WHEN TD.HANDUNG IS NULL THEN DATEADD(YEAR,999, GETDATE()) ELSE TD.HANDUNG END AS HANDUNG ,TD.NGAYTAO,        SUM(TKCT.SOLUONGTONDAU+TKCT.SOLUONGNHAP-TKCT.SOLUONGXUAT) AS SOLUONGTONCUOI        FROM TM_PUR_HANGHOA HH INNER JOIN TT_INV_THEODOI TD ON HH.ID = TD.HANGHOA_ID        INNER JOIN TT_INV_TONKHOCHITIET TKCT ON TD.THEODOI_ID = TKCT.THEODOI_ID        where TKCT.BENHVIEN_ID = 'HLU01' AND TKCT.MAKHO = 'KCVPP' AND TKCT.MMYY='0819'        GROUP BY TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.DONGIA,TD.DONGIASAUVAT,TD.HANDUNG,TD.NGAYTAO        ORDER BY TD.NGAYTAO]
2019-08-16 16:32:51,669 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuatChiTiet] PreparedStatement : [INSERT INTO TT_INV_CHUNGTUXUATCHITIET(CHUNGTUXUAT_ID,MMYY,THEODOI_ID,SOLUONGYEUCAU,SOLUONGXUAT,THANHTIEN,GHICHU,PHIEUYEUCAUCHITIET_ID,TENNGUOITAO,BENHVIEN_ID,NGAYTAO,NGUOITAO_ID)       VALUES( @param0 , @param1 , @param2 , @param3 , @param4 , @param5 , @param6 , @param7 , @param8 , @param9 ,GETDATE(), @param10 )        SELECT SCOPE_IDENTITY()]
2019-08-16 16:32:51,669 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuatChiTiet] Parameters: [@param0=[CHUNGTUXUAT_ID,11], @param1=[MMYY,0819], @param2=[THEODOI_ID,60], @param3=[SOLUONGYEUCAU,null], @param4=[SOLUONGXUAT,5], @param5=[THANHTIEN,3750.0000], @param6=[CT_GHICHU,null], @param7=[PHIEUYEUCAUCHITIET_ID,null], @param8=[TENNGUOITAO,Administrator], @param9=[BENHVIEN_ID,HLU01], @param10=[NGUOITAO_ID,1]]
2019-08-16 16:32:51,669 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuatChiTiet] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String], @param2=[Int32, System.Int32], @param3=[System.DBNull, null], @param4=[Decimal, System.Decimal], @param5=[Decimal, System.Decimal], @param6=[System.DBNull, null], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[String, System.String], @param10=[Int64, System.Int64]]
2019-08-16 16:32:51,703 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLDaXuat_PhieuYeuCauChiTietID] PreparedStatement : [UPDATE TT_INV_PHIEUYEUCAUCHITIET        SET SOLUONGDAXUAT= @param0         WHERE PHIEUYEUCAUCHITIET_ID = '' AND BENHVIEN_ID = 'HLU01']
2019-08-16 16:32:51,703 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLDaXuat_PhieuYeuCauChiTietID] Parameters: [@param0=[SOLUONGXUAT,5]]
2019-08-16 16:32:51,703 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLDaXuat_PhieuYeuCauChiTietID] Types: [@param0=[Decimal, System.Decimal]]
2019-08-16 16:32:51,733 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLXuatTonKho] PreparedStatement : [UPDATE TT_INV_TONKHOCHITIET SET SOLUONGXUAT=0 WHERE MMYY='0819' AND MAKHO IN('KCVPP');        MERGE TT_INV_TONKHOCHITIET AS X USING        (SELECT QQ.MMYY, QQ.MAKHO,QQ.TENKHO,QQ.THEODOI_ID,SUM(QQ.SOLUONGXUAT) AS SOLUONGXUAT FROM (        SELECT '0819' AS MMYY, A.MAKHOXUAT AS MAKHO,A.TENKHOXUAT AS TENKHO,B.THEODOI_ID,B.SOLUONGXUAT,C.NGAYTAO,C.NGUOITAO_ID        FROM TT_INV_CHUNGTUXUAT A INNER JOIN TT_INV_CHUNGTUXUATCHITIET B ON A.CHUNGTUXUAT_ID=B.CHUNGTUXUAT_ID AND A.MMYY='0819'        INNER JOIN TT_INV_THEODOI C ON B.THEODOI_ID=C.THEODOI_ID        WHERE A.MMYY='0819' AND A.BENHVIEN_ID='HLU01' AND A.MAKHOXUAT IN('KCVPP')        UNION ALL        SELECT '0819' AS MMYY, A.MAKHO,A.TENKHO,B.THEODOI_ID,B.SOLUONG AS SOLUONGXUAT,C.NGAYTAO,C.NGUOITAO_ID        FROM TT_INV_CHUNGTUTANGGIAM A INNER JOIN TT_INV_CHUNGTUTANGGIAMCHITIET B ON A.CHUNGTUTANGGIAM_ID=B.CHUNGTUTANGGIAM_ID AND A.MMYY='0819' AND A.LOAI='giam'        INNER JOIN TT_INV_THEODOI C ON B.THEODOI_ID=C.THEODOI_ID        WHERE A.MMYY='0819' AND A.LOAI='giam' AND A.BENHVIEN_ID='HLU01' AND A.MAKHO IN('KCVPP')) QQ        GROUP BY QQ.MMYY, QQ.MAKHO,QQ.TENKHO,QQ.THEODOI_ID) AS Y        ON (X.MMYY=Y.MMYY AND X.MAKHO=Y.MAKHO AND X.THEODOI_ID=Y.THEODOI_ID)        WHEN MATCHED THEN UPDATE SET X.SOLUONGXUAT=Y.SOLUONGXUAT        WHEN NOT MATCHED THEN                INSERT (MMYY,MAKHO,TENKHO,THEODOI_ID,SOLUONGXUAT,BENHVIEN_ID,NGAYTAO,NGUOITAO_ID) VALUES        ('0819',Y.MAKHO,Y.TENKHO,Y.THEODOI_ID,Y.SOLUONGXUAT, @param0 ,GETDATE(), '');          UPDATE TT_INV_TONKHOTONGHOP SET SOLUONGTONDAU=0,SOLUONGNHAP=0,SOLUONGXUAT=0 WHERE MMYY='0819' AND MAKHO IN('KCVPP');        MERGE TT_INV_TONKHOTONGHOP AS X USING        (SELECT '0819' AS MMYY,A.MAKHO,A.TENKHO,B.HANGHOA_ID,B.MAHANGHOA,HH.TEN,SUM(A.SOLUONGTONDAU) AS SOLUONGTONDAU,SUM(A.SOLUONGNHAP) AS SOLUONGNHAP,SUM(A.SOLUONGXUAT) AS SOLUONGXUAT        FROM TT_INV_TONKHOCHITIET A INNER JOIN TT_INV_THEODOI B ON A.THEODOI_ID=B.THEODOI_ID AND A.MMYY='0819'        JOIN TM_PUR_HANGHOA HH on HH.ID = B.HANGHOA_ID        WHERE A.MMYY='0819' AND A.BENHVIEN_ID='HLU01' AND A.MAKHO IN('KCVPP')        GROUP BY A.MAKHO,A.TENKHO,B.HANGHOA_ID,B.MAHANGHOA,HH.TEN) AS Y        ON (X.MMYY=Y.MMYY AND X.MAKHO=Y.MAKHO AND X.HANGHOA_ID=Y.HANGHOA_ID)          WHEN MATCHED THEN UPDATE SET X.SOLUONGTONDAU=Y.SOLUONGTONDAU, X.SOLUONGNHAP=Y.SOLUONGNHAP,X.SOLUONGXUAT=Y.SOLUONGXUAT        WHEN NOT MATCHED THEN                INSERT (MMYY,MAKHO,TENKHO,HANGHOA_ID,MAHANGHOA,TENHANGHOA,SOLUONGTONDAU,SOLUONGNHAP,SOLUONGXUAT,BENHVIEN_ID,NGAYTAO)        VALUES ('0819',Y.MAKHO,Y.TENKHO,Y.HANGHOA_ID,Y.MAHANGHOA,Y.TEN,Y.SOLUONGTONDAU,Y.SOLUONGNHAP,Y.SOLUONGXUAT, @param0 ,GETDATE());          DELETE FROM TT_INV_TONKHOCHITIET WHERE SOLUONGTONDAU=0 AND SOLUONGNHAP=0 AND SOLUONGXUAT=0;        DELETE FROM TT_INV_TONKHOTONGHOP WHERE SOLUONGTONDAU=0 AND SOLUONGNHAP=0 AND SOLUONGXUAT=0;]
2019-08-16 16:32:51,734 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLXuatTonKho] Parameters: [@param0=[BENHVIEN_ID,HLU01]]
2019-08-16 16:32:51,734 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLXuatTonKho] Types: [@param0=[String, System.String]]
2019-08-16 16:32:51,846 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdateTrangThaiPO_NhapKho] PreparedStatement : [UPDATE TT_PUR_CHUNGTU SET STATE_CODE =  @param0 , STATE_NAME =  @param1  WHERE MACHUNGTU = '' AND PROCESS_CODE = 'PO']
2019-08-16 16:32:51,846 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdateTrangThaiPO_NhapKho] Parameters: [@param0=[STATE_CODE,9], @param1=[STATE_NAME,Đã xuất kho]]
2019-08-16 16:32:51,846 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdateTrangThaiPO_NhapKho] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2019-08-16 16:32:51,949 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatAll] PreparedStatement : [SELECT CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,      CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID,      CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,      TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA      FROM TT_INV_CHUNGTUXUAT CT INNER JOIN TT_INV_CHUNGTUXUATCHITIET CTCT ON CT.CHUNGTUXUAT_ID=CTCT.CHUNGTUXUAT_ID             INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID      where CT.BENHVIEN_ID = 'HLU01' AND CT.MACHUNGTU = 'X21190816163249'             ORDER BY TD.TENHANGHOA]
2019-08-16 16:32:52,017 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 16:33:07,122 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'STA07'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 16:33:07,366 [1] DEBUG - Statement Id: [DAO00401_INV001_ChungTuXuatSearch] PreparedStatement : [select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/16/2019 4:33:07 PM' AND '8/16/2019 4:33:07 PM'        AND CT.MAKHOXUAT = 'KCVPP'                   UNION          select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/16/2019 4:33:07 PM' AND '8/16/2019 4:33:07 PM'        AND CT.MAKHOXUAT = 'KCVPP']
2019-08-16 16:33:07,516 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatChiTiet_ChungTuID] PreparedStatement : [select CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        FROM TT_INV_CHUNGTUXUATCHITIET CTCT INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID        WHERE CTCT.BENHVIEN_ID = 'HLU01' AND CTCT.CHUNGTUXUAT_ID='6']
2019-08-16 16:33:11,061 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatChiTiet_ChungTuID] PreparedStatement : [select CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        FROM TT_INV_CHUNGTUXUATCHITIET CTCT INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID        WHERE CTCT.BENHVIEN_ID = 'HLU01' AND CTCT.CHUNGTUXUAT_ID='11']
2019-08-16 16:33:15,812 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatChiTiet_ChungTuID] PreparedStatement : [select CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        FROM TT_INV_CHUNGTUXUATCHITIET CTCT INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID        WHERE CTCT.BENHVIEN_ID = 'HLU01' AND CTCT.CHUNGTUXUAT_ID='10']
2019-08-16 16:33:17,234 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatAll] PreparedStatement : [SELECT CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,      CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID,      CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,      TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA      FROM TT_INV_CHUNGTUXUAT CT INNER JOIN TT_INV_CHUNGTUXUATCHITIET CTCT ON CT.CHUNGTUXUAT_ID=CTCT.CHUNGTUXUAT_ID             INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID      where CT.BENHVIEN_ID = 'HLU01' AND CT.MACHUNGTU = 'X07190816163110'             ORDER BY TD.TENHANGHOA]
2019-08-16 16:33:17,434 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 16:33:20,515 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatChiTiet_ChungTuID] PreparedStatement : [select CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        FROM TT_INV_CHUNGTUXUATCHITIET CTCT INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID        WHERE CTCT.BENHVIEN_ID = 'HLU01' AND CTCT.CHUNGTUXUAT_ID='6']
2019-08-16 16:33:20,556 [1] DEBUG - Statement Id: [DAO00401_INV001_ChungTuXuatSearch] PreparedStatement : [select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/16/2019 4:33:20 PM' AND '8/16/2019 4:33:20 PM'        AND CT.MAKHOXUAT = 'KCVPP'                   UNION          select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/16/2019 4:33:20 PM' AND '8/16/2019 4:33:20 PM'        AND CT.MAKHOXUAT = 'KCVPP']
2019-08-16 16:33:22,056 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatChiTiet_ChungTuID] PreparedStatement : [select CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        FROM TT_INV_CHUNGTUXUATCHITIET CTCT INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID        WHERE CTCT.BENHVIEN_ID = 'HLU01' AND CTCT.CHUNGTUXUAT_ID='11']
2019-08-16 16:33:23,459 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatAll] PreparedStatement : [SELECT CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,      CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID,      CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,      TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA      FROM TT_INV_CHUNGTUXUAT CT INNER JOIN TT_INV_CHUNGTUXUATCHITIET CTCT ON CT.CHUNGTUXUAT_ID=CTCT.CHUNGTUXUAT_ID             INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID      where CT.BENHVIEN_ID = 'HLU01' AND CT.MACHUNGTU = 'X21190816163249'             ORDER BY TD.TENHANGHOA]
2019-08-16 16:33:23,677 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 16:33:26,363 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatChiTiet_ChungTuID] PreparedStatement : [select CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        FROM TT_INV_CHUNGTUXUATCHITIET CTCT INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID        WHERE CTCT.BENHVIEN_ID = 'HLU01' AND CTCT.CHUNGTUXUAT_ID='6']
2019-08-16 16:33:26,397 [1] DEBUG - Statement Id: [DAO00401_INV001_ChungTuXuatSearch] PreparedStatement : [select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/16/2019 4:33:26 PM' AND '8/16/2019 4:33:26 PM'        AND CT.MAKHOXUAT = 'KCVPP'                   UNION          select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/16/2019 4:33:26 PM' AND '8/16/2019 4:33:26 PM'        AND CT.MAKHOXUAT = 'KCVPP']
2019-08-16 16:33:28,054 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatChiTiet_ChungTuID] PreparedStatement : [select CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        FROM TT_INV_CHUNGTUXUATCHITIET CTCT INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID        WHERE CTCT.BENHVIEN_ID = 'HLU01' AND CTCT.CHUNGTUXUAT_ID='10']
2019-08-16 16:33:29,377 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatAll] PreparedStatement : [SELECT CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,      CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID,      CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,      TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA      FROM TT_INV_CHUNGTUXUAT CT INNER JOIN TT_INV_CHUNGTUXUATCHITIET CTCT ON CT.CHUNGTUXUAT_ID=CTCT.CHUNGTUXUAT_ID             INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID      where CT.BENHVIEN_ID = 'HLU01' AND CT.MACHUNGTU = 'X07190816163110'             ORDER BY TD.TENHANGHOA]
2019-08-16 16:33:29,600 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 16:50:32,188 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatChiTiet_ChungTuID] PreparedStatement : [select CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        FROM TT_INV_CHUNGTUXUATCHITIET CTCT INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID        WHERE CTCT.BENHVIEN_ID = 'HLU01' AND CTCT.CHUNGTUXUAT_ID='6']
2019-08-16 16:50:32,328 [1] DEBUG - Statement Id: [DAO00401_INV001_ChungTuXuatSearch] PreparedStatement : [select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/16/2019 4:50:32 PM' AND '8/16/2019 4:50:32 PM'        AND CT.MAKHOXUAT = 'KCVPP'                   UNION          select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/16/2019 4:50:32 PM' AND '8/16/2019 4:50:32 PM'        AND CT.MAKHOXUAT = 'KCVPP']
2019-08-16 16:50:33,539 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatChiTiet_ChungTuID] PreparedStatement : [select CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        FROM TT_INV_CHUNGTUXUATCHITIET CTCT INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID        WHERE CTCT.BENHVIEN_ID = 'HLU01' AND CTCT.CHUNGTUXUAT_ID='11']
2019-08-16 16:50:33,872 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatAll] PreparedStatement : [SELECT CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,      CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID,      CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,      TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA      FROM TT_INV_CHUNGTUXUAT CT INNER JOIN TT_INV_CHUNGTUXUATCHITIET CTCT ON CT.CHUNGTUXUAT_ID=CTCT.CHUNGTUXUAT_ID             INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID      where CT.BENHVIEN_ID = 'HLU01' AND CT.MACHUNGTU = 'X21190816163249'             ORDER BY TD.TENHANGHOA]
2019-08-16 16:50:34,105 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 17:02:30,006 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatChiTiet_ChungTuID] PreparedStatement : [select CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        FROM TT_INV_CHUNGTUXUATCHITIET CTCT INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID        WHERE CTCT.BENHVIEN_ID = 'HLU01' AND CTCT.CHUNGTUXUAT_ID='6']
2019-08-16 17:02:30,156 [1] DEBUG - Statement Id: [DAO00401_INV001_ChungTuXuatSearch] PreparedStatement : [select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/16/2019 5:02:30 PM' AND '8/16/2019 5:02:30 PM'        AND CT.MAKHOXUAT = 'KCVPP'                   UNION          select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/16/2019 5:02:30 PM' AND '8/16/2019 5:02:30 PM'        AND CT.MAKHOXUAT = 'KCVPP']
2019-08-16 17:05:12,524 [1] DEBUG - Statement Id: [DAO00401_INV001_ChungTuXuatSearch] PreparedStatement : [select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/16/2019 5:02:30 PM' AND '8/16/2019 5:02:30 PM'        AND CT.MAKHOXUAT = 'KCVPP'         AND           AND (CT.MACHUNGTU LIKE '%221' OR CT.MAPHIEUYEUCAU LIKE '%221')                   UNION          select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/16/2019 5:02:30 PM' AND '8/16/2019 5:02:30 PM'        AND CT.MAKHOXUAT = 'KCVPP'         AND           AND (CT.MACHUNGTU LIKE '%221%' OR CT.MAPHIEUYEUCAU LIKE '%221%')]
2019-08-16 17:05:20,117 [1] DEBUG - Statement Id: [DAO00401_INV001_ChungTuXuatSearch] PreparedStatement : [select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/16/2019 5:02:30 PM' AND '8/16/2019 5:02:30 PM'        AND CT.MAKHOXUAT = 'KCVPP'         AND           AND (CT.MACHUNGTU LIKE '%221' OR CT.MAPHIEUYEUCAU LIKE '%221')                   UNION          select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/16/2019 5:02:30 PM' AND '8/16/2019 5:02:30 PM'        AND CT.MAKHOXUAT = 'KCVPP'         AND           AND (CT.MACHUNGTU LIKE '%221%' OR CT.MAPHIEUYEUCAU LIKE '%221%')]
--------------------------------------------------------------------------------
2019-08-16 17:11:34,299 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2019-08-16 17:11:34,591 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-08-16 17:11:34,630 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-08-16 17:11:35,045 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 17:11:35,256 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-08-16 17:11:47,704 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2019-08-16 17:11:47,731 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-08-16 17:11:49,401 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-08-16 17:11:49,490 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-08-16 17:11:50,281 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2019-08-16 17:11:50,430 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2019-08-16 17:11:50,510 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2019-08-16 17:11:50,590 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2019-08-16 17:11:50,669 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2019-08-16 17:11:50,745 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2019-08-16 17:11:50,815 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2019-08-16 17:11:50,886 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2019-08-16 17:11:50,959 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2019-08-16 17:11:51,470 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2019-08-16 17:11:51,506 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2019-08-16 17:11:51,595 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2019-08-16 17:11:51,627 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2019-08-16 17:11:52,525 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2019-08-16 17:11:52,561 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 0 as PHAMVI_ID, 0 as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0         end                else        begin        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2019-08-16 17:11:56,369 [5] DEBUG - Statement Id: [DAO00320_GetList] PreparedStatement : [select M.*            from TM_MAU M            LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID            where            M.TAMNGUNG = '0'            and M.BENHVIEN_ID = 'HLU01'            order by M.TENMAU]
2019-08-16 17:11:56,431 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2019-08-16 17:11:56,466 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT          TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,          TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,          SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH          FROM TT_MAU_TONKHO TK          JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID          JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID          JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'          LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID          LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID          WHERE TK.SOLUONG > 0          GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,          TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2019-08-16 17:11:56,540 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2019-08-16 17:11:56,578 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct          TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,          TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,          TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH          from TM_MAU M          JOIN          (          select          A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO          from          (          select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO          from TT_MAU_TONKHO TK          JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID          inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID          left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'          where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0          ) A          )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'          LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID          LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2019-08-16 17:11:56,671 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2019-08-16 17:11:57,593 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 17:11:58,520 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2019-08-16 17:12:03,203 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2019-08-16 17:12:03,233 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2019-08-16 17:12:03,306 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 17:12:03,434 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 17:12:03,568 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2019-08-16 17:12:03,570 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-08-16 17:12:03,570 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-08-16 17:12:03,605 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2019-08-16 17:12:03,605 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-08-16 17:12:03,605 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-08-16 17:12:03,730 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 17:12:03,890 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 17:12:11,182 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 17:12:11,275 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2019-08-16 17:12:11,534 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2019-08-16 17:12:20,519 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'STA06'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 17:12:20,878 [1] DEBUG - Statement Id: [DAO00401_INV001_GetDMNhanVien] PreparedStatement : [SELECT NHANVIEN_ID,TENNHANVIEN,NHANVIEN_ID AS NHANVIENNHAN_ID,TENNHANVIEN AS TENNHANVIENNHAN FROM [TM_NHANVIEN]        where BENHVIEN_ID = 'HLU01'        ORDER BY TENNHANVIEN]
2019-08-16 17:12:21,243 [1] DEBUG - Statement Id: [DAO00401_INV001_GetDMKHOVPP] PreparedStatement : [Select K.*,BB.SODU,BB.SODUDENNGAY,BB.KHOASO,BB.NGAYKHOA  From TM_KHO K        LEFT JOIN TM_INV_KHO BB ON K.MAKHO = BB.MAKHO        LEFT JOIN LST_DICTIONARY AA ON AA.DICTIONARY_ID = K.MODULE_ID        WHERE AA.DICTIONARY_CODE = 'KhoVPP']
2019-08-16 17:12:21,430 [1] DEBUG - Statement Id: [DAO00401_GetListMucDichChungTu] PreparedStatement : [SELECT DICTIONARY_ID, DICTIONARY_CODE, DICTIONARY_NAME        FROM LST_DICTIONARY        WHERE DICTIONARY_TYPE_CODE = 'VPP_MucDichChungTu'        AND ENABLED = '1']
2019-08-16 17:12:22,292 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 17:12:25,924 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'STA07'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 17:12:26,085 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM98'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 17:12:26,553 [1] DEBUG - Statement Id: [DAO00401_INV001_ChungTuXuatSearch] PreparedStatement : [select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/16/2019 5:12:26 PM' AND '8/16/2019 5:12:26 PM'        AND CT.MAKHOXUAT = 'KCVPP'                   UNION          select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/16/2019 5:12:26 PM' AND '8/16/2019 5:12:26 PM'        AND CT.MAKHOXUAT = 'KCVPP']
2019-08-16 17:12:26,874 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatChiTiet_ChungTuID] PreparedStatement : [select CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        FROM TT_INV_CHUNGTUXUATCHITIET CTCT INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID        WHERE CTCT.BENHVIEN_ID = 'HLU01' AND CTCT.CHUNGTUXUAT_ID='6']
2019-08-16 17:12:30,180 [1] DEBUG - Statement Id: [DAO00401_INV001_ChungTuXuatSearch] PreparedStatement : [select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/16/2019 5:12:26 PM' AND '8/16/2019 5:12:26 PM'        AND CT.MAKHOXUAT = 'KCVPP'         AND            (CT.MACHUNGTU LIKE '%221' OR CT.MAPHIEUYEUCAU LIKE '%221')                   UNION          select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/16/2019 5:12:26 PM' AND '8/16/2019 5:12:26 PM'        AND CT.MAKHOXUAT = 'KCVPP'         AND            (CT.MACHUNGTU LIKE '%221%' OR CT.MAPHIEUYEUCAU LIKE '%221%')]
2019-08-16 17:12:34,838 [1] DEBUG - Statement Id: [DAO00401_INV001_ChungTuXuatSearch] PreparedStatement : [select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/1/2019 12:00:00 AM' AND '8/16/2019 5:12:26 PM'        AND CT.MAKHOXUAT = 'KCVPP'         AND            (CT.MACHUNGTU LIKE '%221' OR CT.MAPHIEUYEUCAU LIKE '%221')                   UNION          select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/1/2019 12:00:00 AM' AND '8/16/2019 5:12:26 PM'        AND CT.MAKHOXUAT = 'KCVPP'         AND            (CT.MACHUNGTU LIKE '%221%' OR CT.MAPHIEUYEUCAU LIKE '%221%')]
2019-08-16 17:12:39,620 [1] DEBUG - Statement Id: [DAO00401_INV001_ChungTuXuatSearch] PreparedStatement : [select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/1/2019 12:00:00 AM' AND '8/16/2019 5:12:26 PM'        AND CT.MAKHOXUAT = 'KCVPP'                   UNION          select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/1/2019 12:00:00 AM' AND '8/16/2019 5:12:26 PM'        AND CT.MAKHOXUAT = 'KCVPP']
2019-08-16 17:14:26,500 [1] DEBUG - Statement Id: [DAO00401_INV001_ChungTuXuatSearch] PreparedStatement : [select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/1/2019 12:00:00 AM' AND '8/16/2019 5:12:26 PM'        AND CT.MAKHOXUAT = 'KCVPP'         AND            (CT.MACHUNGTU LIKE '%336' OR CT.MAPHIEUYEUCAU LIKE '%336')                   UNION          select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/1/2019 12:00:00 AM' AND '8/16/2019 5:12:26 PM'        AND CT.MAKHOXUAT = 'KCVPP'         AND            (CT.MACHUNGTU LIKE '%336%' OR CT.MAPHIEUYEUCAU LIKE '%336%')]
2019-08-16 17:14:35,108 [1] DEBUG - Statement Id: [DAO00401_INV001_ChungTuXuatSearch] PreparedStatement : [select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/1/2019 12:00:00 AM' AND '8/16/2019 5:12:26 PM'        AND CT.MAKHOXUAT = 'KCVPP'         AND            (CT.MACHUNGTU LIKE '%211' OR CT.MAPHIEUYEUCAU LIKE '%211')                   UNION          select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/1/2019 12:00:00 AM' AND '8/16/2019 5:12:26 PM'        AND CT.MAKHOXUAT = 'KCVPP'         AND            (CT.MACHUNGTU LIKE '%211%' OR CT.MAPHIEUYEUCAU LIKE '%211%')]
2019-08-16 17:14:43,567 [1] DEBUG - Statement Id: [DAO00401_INV001_ChungTuXuatSearch] PreparedStatement : [select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/1/2019 12:00:00 AM' AND '8/16/2019 5:12:26 PM'        AND CT.MAKHOXUAT = 'KCVPP'         AND            (CT.MACHUNGTU LIKE '%211' OR CT.MAPHIEUYEUCAU LIKE '%211')                   UNION          select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/1/2019 12:00:00 AM' AND '8/16/2019 5:12:26 PM'        AND CT.MAKHOXUAT = 'KCVPP'         AND            (CT.MACHUNGTU LIKE '%211%' OR CT.MAPHIEUYEUCAU LIKE '%211%')]
2019-08-16 17:14:50,676 [1] DEBUG - Statement Id: [DAO00401_INV001_ChungTuXuatSearch] PreparedStatement : [select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/1/2019 12:00:00 AM' AND '8/16/2019 5:12:26 PM'        AND CT.MAKHOXUAT = 'KCVPP'         AND            (CT.MACHUNGTU LIKE '%49' OR CT.MAPHIEUYEUCAU LIKE '%49')                   UNION          select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/1/2019 12:00:00 AM' AND '8/16/2019 5:12:26 PM'        AND CT.MAKHOXUAT = 'KCVPP'         AND            (CT.MACHUNGTU LIKE '%49%' OR CT.MAPHIEUYEUCAU LIKE '%49%')]
2019-08-16 17:14:59,588 [1] DEBUG - Statement Id: [DAO00401_INV001_ChungTuXuatSearch] PreparedStatement : [select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/1/2019 12:00:00 AM' AND '8/16/2019 5:12:26 PM'        AND CT.MAKHOXUAT = 'KCVPP'                   UNION          select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/1/2019 12:00:00 AM' AND '8/16/2019 5:12:26 PM'        AND CT.MAKHOXUAT = 'KCVPP']
2019-08-16 17:15:00,558 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatChiTiet_ChungTuID] PreparedStatement : [select CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        FROM TT_INV_CHUNGTUXUATCHITIET CTCT INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID        WHERE CTCT.BENHVIEN_ID = 'HLU01' AND CTCT.CHUNGTUXUAT_ID='11']
2019-08-16 17:15:00,867 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatAll] PreparedStatement : [SELECT CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID,        CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        , CT.MUCDICHCHUNGTU_ID, CT.MUCDICHCHUNGTU_CODE        FROM TT_INV_CHUNGTUXUAT CT INNER JOIN TT_INV_CHUNGTUXUATCHITIET CTCT ON CT.CHUNGTUXUAT_ID=CTCT.CHUNGTUXUAT_ID               INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID      where CT.BENHVIEN_ID = 'HLU01' AND CT.MACHUNGTU = 'X21190816163249'             ORDER BY TD.TENHANGHOA]
2019-08-16 17:15:01,371 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 17:15:20,399 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatChiTiet_ChungTuID] PreparedStatement : [select CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        FROM TT_INV_CHUNGTUXUATCHITIET CTCT INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID        WHERE CTCT.BENHVIEN_ID = 'HLU01' AND CTCT.CHUNGTUXUAT_ID='6']
2019-08-16 17:15:20,438 [1] DEBUG - Statement Id: [DAO00401_INV001_ChungTuXuatSearch] PreparedStatement : [select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/16/2019 5:15:20 PM' AND '8/16/2019 5:15:20 PM'        AND CT.MAKHOXUAT = 'KCVPP'                   UNION          select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/16/2019 5:15:20 PM' AND '8/16/2019 5:15:20 PM'        AND CT.MAKHOXUAT = 'KCVPP']
2019-08-16 17:15:26,118 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatChiTiet_ChungTuID] PreparedStatement : [select CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        FROM TT_INV_CHUNGTUXUATCHITIET CTCT INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID        WHERE CTCT.BENHVIEN_ID = 'HLU01' AND CTCT.CHUNGTUXUAT_ID='10']
2019-08-16 17:15:27,870 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatChiTiet_ChungTuID] PreparedStatement : [select CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        FROM TT_INV_CHUNGTUXUATCHITIET CTCT INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID        WHERE CTCT.BENHVIEN_ID = 'HLU01' AND CTCT.CHUNGTUXUAT_ID='11']
2019-08-16 17:15:40,439 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatAll] PreparedStatement : [SELECT CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID,        CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        , CT.MUCDICHCHUNGTU_ID, CT.MUCDICHCHUNGTU_CODE        FROM TT_INV_CHUNGTUXUAT CT INNER JOIN TT_INV_CHUNGTUXUATCHITIET CTCT ON CT.CHUNGTUXUAT_ID=CTCT.CHUNGTUXUAT_ID               INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID      where CT.BENHVIEN_ID = 'HLU01' AND CT.MACHUNGTU = 'X21190816163249'             ORDER BY TD.TENHANGHOA]
--------------------------------------------------------------------------------
2019-08-16 17:17:06,333 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2019-08-16 17:17:06,617 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-08-16 17:17:06,661 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-08-16 17:17:07,051 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 17:17:07,300 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-08-16 17:17:42,772 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2019-08-16 17:17:42,807 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-08-16 17:17:44,360 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-08-16 17:17:44,798 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-08-16 17:17:45,626 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2019-08-16 17:17:45,784 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2019-08-16 17:17:45,869 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2019-08-16 17:17:45,945 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2019-08-16 17:17:46,023 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2019-08-16 17:17:46,091 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2019-08-16 17:17:46,159 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2019-08-16 17:17:46,234 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2019-08-16 17:17:46,307 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2019-08-16 17:17:46,808 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2019-08-16 17:17:46,846 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2019-08-16 17:17:46,917 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2019-08-16 17:17:46,949 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2019-08-16 17:17:47,841 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2019-08-16 17:17:47,878 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 0 as PHAMVI_ID, 0 as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0         end                else        begin        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2019-08-16 17:17:50,265 [5] DEBUG - Statement Id: [DAO00320_GetList] PreparedStatement : [select M.*            from TM_MAU M            LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID            where            M.TAMNGUNG = '0'            and M.BENHVIEN_ID = 'HLU01'            order by M.TENMAU]
2019-08-16 17:17:50,333 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2019-08-16 17:17:50,367 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT          TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,          TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,          SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH          FROM TT_MAU_TONKHO TK          JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID          JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID          JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'          LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID          LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID          WHERE TK.SOLUONG > 0          GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,          TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2019-08-16 17:17:50,440 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2019-08-16 17:17:50,476 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct          TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,          TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,          TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH          from TM_MAU M          JOIN          (          select          A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO          from          (          select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO          from TT_MAU_TONKHO TK          JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID          inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID          left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'          where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0          ) A          )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'          LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID          LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2019-08-16 17:17:50,556 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2019-08-16 17:17:51,505 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 17:17:52,352 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2019-08-16 17:17:57,408 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2019-08-16 17:17:57,448 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2019-08-16 17:17:57,558 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 17:17:57,684 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 17:17:57,813 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2019-08-16 17:17:57,815 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-08-16 17:17:57,815 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-08-16 17:17:57,852 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2019-08-16 17:17:57,852 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-08-16 17:17:57,852 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-08-16 17:17:57,999 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 17:17:58,142 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 17:18:04,942 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 17:18:05,034 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2019-08-16 17:18:05,385 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2019-08-16 17:18:18,838 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'STA06'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 17:18:19,193 [1] DEBUG - Statement Id: [DAO00401_INV001_GetDMNhanVien] PreparedStatement : [SELECT NHANVIEN_ID,TENNHANVIEN,NHANVIEN_ID AS NHANVIENNHAN_ID,TENNHANVIEN AS TENNHANVIENNHAN FROM [TM_NHANVIEN]        where BENHVIEN_ID = 'HLU01'        ORDER BY TENNHANVIEN]
2019-08-16 17:18:19,577 [1] DEBUG - Statement Id: [DAO00401_INV001_GetDMKHOVPP] PreparedStatement : [Select K.*,BB.SODU,BB.SODUDENNGAY,BB.KHOASO,BB.NGAYKHOA  From TM_KHO K        LEFT JOIN TM_INV_KHO BB ON K.MAKHO = BB.MAKHO        LEFT JOIN LST_DICTIONARY AA ON AA.DICTIONARY_ID = K.MODULE_ID        WHERE AA.DICTIONARY_CODE = 'KhoVPP']
2019-08-16 17:18:19,781 [1] DEBUG - Statement Id: [DAO00401_GetListMucDichChungTu] PreparedStatement : [SELECT DICTIONARY_ID, DICTIONARY_CODE, DICTIONARY_NAME        FROM LST_DICTIONARY        WHERE DICTIONARY_TYPE_CODE = 'VPP_MucDichChungTu'        AND ENABLED = '1']
2019-08-16 17:18:20,641 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 17:18:23,581 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'STA07'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 17:18:23,749 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM98'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 17:18:24,217 [1] DEBUG - Statement Id: [DAO00401_INV001_ChungTuXuatSearch] PreparedStatement : [select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/16/2019 5:18:24 PM' AND '8/16/2019 5:18:24 PM'        AND CT.MAKHOXUAT = 'KCVPP'                   UNION          select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/16/2019 5:18:24 PM' AND '8/16/2019 5:18:24 PM'        AND CT.MAKHOXUAT = 'KCVPP']
2019-08-16 17:18:24,648 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatChiTiet_ChungTuID] PreparedStatement : [select CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        FROM TT_INV_CHUNGTUXUATCHITIET CTCT INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID        WHERE CTCT.BENHVIEN_ID = 'HLU01' AND CTCT.CHUNGTUXUAT_ID='6']
2019-08-16 17:18:25,771 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatChiTiet_ChungTuID] PreparedStatement : [select CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        FROM TT_INV_CHUNGTUXUATCHITIET CTCT INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID        WHERE CTCT.BENHVIEN_ID = 'HLU01' AND CTCT.CHUNGTUXUAT_ID='11']
2019-08-16 17:18:29,447 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatAll] PreparedStatement : [SELECT CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID,        CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        , CT.MUCDICHCHUNGTU_ID, CT.MUCDICHCHUNGTU_CODE        FROM TT_INV_CHUNGTUXUAT CT INNER JOIN TT_INV_CHUNGTUXUATCHITIET CTCT ON CT.CHUNGTUXUAT_ID=CTCT.CHUNGTUXUAT_ID               INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID      where CT.BENHVIEN_ID = 'HLU01' AND CT.MACHUNGTU = 'X21190816163249'             ORDER BY TD.TENHANGHOA]
--------------------------------------------------------------------------------
2019-08-16 17:21:07,669 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2019-08-16 17:21:07,956 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-08-16 17:21:07,994 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-08-16 17:21:08,431 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 17:21:09,002 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-08-16 17:21:23,155 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2019-08-16 17:21:23,183 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-08-16 17:21:24,671 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-08-16 17:21:24,753 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-08-16 17:21:25,540 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2019-08-16 17:21:25,684 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2019-08-16 17:21:25,758 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2019-08-16 17:21:25,832 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2019-08-16 17:21:25,902 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2019-08-16 17:21:25,983 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2019-08-16 17:21:26,056 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2019-08-16 17:21:26,224 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2019-08-16 17:21:26,296 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2019-08-16 17:21:26,808 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2019-08-16 17:21:26,844 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2019-08-16 17:21:26,916 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2019-08-16 17:21:26,950 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2019-08-16 17:21:27,707 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2019-08-16 17:21:27,783 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 0 as PHAMVI_ID, 0 as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0         end                else        begin        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2019-08-16 17:21:30,894 [5] DEBUG - Statement Id: [DAO00320_GetList] PreparedStatement : [select M.*            from TM_MAU M            LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID            where            M.TAMNGUNG = '0'            and M.BENHVIEN_ID = 'HLU01'            order by M.TENMAU]
2019-08-16 17:21:30,962 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2019-08-16 17:21:31,005 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT          TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,          TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,          SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH          FROM TT_MAU_TONKHO TK          JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID          JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID          JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'          LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID          LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID          WHERE TK.SOLUONG > 0          GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,          TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2019-08-16 17:21:31,097 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2019-08-16 17:21:31,130 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct          TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,          TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,          TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH          from TM_MAU M          JOIN          (          select          A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO          from          (          select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO          from TT_MAU_TONKHO TK          JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID          inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID          left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'          where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0          ) A          )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'          LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID          LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2019-08-16 17:21:31,201 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2019-08-16 17:21:32,136 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 17:21:33,024 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2019-08-16 17:21:37,758 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2019-08-16 17:21:37,788 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2019-08-16 17:21:37,872 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 17:21:37,996 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 17:21:38,162 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2019-08-16 17:21:38,164 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-08-16 17:21:38,164 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-08-16 17:21:38,196 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2019-08-16 17:21:38,197 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-08-16 17:21:38,197 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-08-16 17:21:38,335 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 17:21:38,505 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 17:21:46,160 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 17:21:46,320 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2019-08-16 17:21:46,583 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2019-08-16 17:21:55,203 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'STA06'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 17:21:55,522 [1] DEBUG - Statement Id: [DAO00401_INV001_GetDMNhanVien] PreparedStatement : [SELECT NHANVIEN_ID,TENNHANVIEN,NHANVIEN_ID AS NHANVIENNHAN_ID,TENNHANVIEN AS TENNHANVIENNHAN FROM [TM_NHANVIEN]        where BENHVIEN_ID = 'HLU01'        ORDER BY TENNHANVIEN]
2019-08-16 17:21:55,971 [1] DEBUG - Statement Id: [DAO00401_INV001_GetDMKHOVPP] PreparedStatement : [Select K.*,BB.SODU,BB.SODUDENNGAY,BB.KHOASO,BB.NGAYKHOA  From TM_KHO K        LEFT JOIN TM_INV_KHO BB ON K.MAKHO = BB.MAKHO        LEFT JOIN LST_DICTIONARY AA ON AA.DICTIONARY_ID = K.MODULE_ID        WHERE AA.DICTIONARY_CODE = 'KhoVPP']
2019-08-16 17:21:56,179 [1] DEBUG - Statement Id: [DAO00401_GetListMucDichChungTu] PreparedStatement : [SELECT DICTIONARY_ID, DICTIONARY_CODE, DICTIONARY_NAME        FROM LST_DICTIONARY        WHERE DICTIONARY_TYPE_CODE = 'VPP_MucDichChungTu'        AND ENABLED = '1']
2019-08-16 17:21:57,031 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 17:21:58,859 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'STA07'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 17:21:59,012 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM98'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 17:21:59,464 [1] DEBUG - Statement Id: [DAO00401_INV001_ChungTuXuatSearch] PreparedStatement : [select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/16/2019 5:21:59 PM' AND '8/16/2019 5:21:59 PM'        AND CT.MAKHOXUAT = 'KCVPP'                   UNION          select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/16/2019 5:21:59 PM' AND '8/16/2019 5:21:59 PM'        AND CT.MAKHOXUAT = 'KCVPP']
2019-08-16 17:21:59,787 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatChiTiet_ChungTuID] PreparedStatement : [select CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        FROM TT_INV_CHUNGTUXUATCHITIET CTCT INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID        WHERE CTCT.BENHVIEN_ID = 'HLU01' AND CTCT.CHUNGTUXUAT_ID='6']
2019-08-16 17:22:01,317 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatChiTiet_ChungTuID] PreparedStatement : [select CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        FROM TT_INV_CHUNGTUXUATCHITIET CTCT INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID        WHERE CTCT.BENHVIEN_ID = 'HLU01' AND CTCT.CHUNGTUXUAT_ID='11']
2019-08-16 17:22:03,043 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatAll] PreparedStatement : [SELECT CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID,        CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        , CT.MUCDICHCHUNGTU_ID, CT.MUCDICHCHUNGTU_CODE        FROM TT_INV_CHUNGTUXUAT CT INNER JOIN TT_INV_CHUNGTUXUATCHITIET CTCT ON CT.CHUNGTUXUAT_ID=CTCT.CHUNGTUXUAT_ID               INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID      where CT.BENHVIEN_ID = 'HLU01' AND CT.MACHUNGTU = 'X21190816163249'             ORDER BY TD.TENHANGHOA]
2019-08-16 17:22:03,725 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 17:22:07,596 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatChiTiet_ChungTuID] PreparedStatement : [select CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        FROM TT_INV_CHUNGTUXUATCHITIET CTCT INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID        WHERE CTCT.BENHVIEN_ID = 'HLU01' AND CTCT.CHUNGTUXUAT_ID='6']
2019-08-16 17:22:07,631 [1] DEBUG - Statement Id: [DAO00401_INV001_ChungTuXuatSearch] PreparedStatement : [select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/16/2019 5:22:07 PM' AND '8/16/2019 5:22:07 PM'        AND CT.MAKHOXUAT = 'KCVPP'                   UNION          select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/16/2019 5:22:07 PM' AND '8/16/2019 5:22:07 PM'        AND CT.MAKHOXUAT = 'KCVPP']
2019-08-16 17:22:08,655 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatChiTiet_ChungTuID] PreparedStatement : [select CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        FROM TT_INV_CHUNGTUXUATCHITIET CTCT INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID        WHERE CTCT.BENHVIEN_ID = 'HLU01' AND CTCT.CHUNGTUXUAT_ID='11']
2019-08-16 17:22:12,480 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatAll] PreparedStatement : [SELECT CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID,        CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        , CT.MUCDICHCHUNGTU_ID, CT.MUCDICHCHUNGTU_CODE        FROM TT_INV_CHUNGTUXUAT CT INNER JOIN TT_INV_CHUNGTUXUATCHITIET CTCT ON CT.CHUNGTUXUAT_ID=CTCT.CHUNGTUXUAT_ID               INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID      where CT.BENHVIEN_ID = 'HLU01' AND CT.MACHUNGTU = 'X21190816163249'             ORDER BY TD.TENHANGHOA]
--------------------------------------------------------------------------------
2019-08-16 17:23:06,842 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2019-08-16 17:23:07,126 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-08-16 17:23:07,167 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-08-16 17:23:07,530 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 17:23:07,796 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-08-16 17:23:14,033 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2019-08-16 17:23:14,060 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-08-16 17:23:15,545 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-08-16 17:23:15,627 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-08-16 17:23:16,428 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2019-08-16 17:23:16,564 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2019-08-16 17:23:16,640 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2019-08-16 17:23:16,720 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2019-08-16 17:23:16,800 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2019-08-16 17:23:16,875 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2019-08-16 17:23:16,947 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2019-08-16 17:23:17,019 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2019-08-16 17:23:17,121 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2019-08-16 17:23:17,641 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2019-08-16 17:23:17,685 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2019-08-16 17:23:18,207 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2019-08-16 17:23:18,246 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2019-08-16 17:23:19,206 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2019-08-16 17:23:19,488 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 0 as PHAMVI_ID, 0 as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0         end                else        begin        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2019-08-16 17:23:21,743 [5] DEBUG - Statement Id: [DAO00320_GetList] PreparedStatement : [select M.*            from TM_MAU M            LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID            where            M.TAMNGUNG = '0'            and M.BENHVIEN_ID = 'HLU01'            order by M.TENMAU]
2019-08-16 17:23:21,819 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2019-08-16 17:23:21,865 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT          TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,          TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,          SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH          FROM TT_MAU_TONKHO TK          JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID          JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID          JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'          LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID          LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID          WHERE TK.SOLUONG > 0          GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,          TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2019-08-16 17:23:21,935 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2019-08-16 17:23:21,973 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct          TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,          TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,          TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH          from TM_MAU M          JOIN          (          select          A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO          from          (          select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO          from TT_MAU_TONKHO TK          JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID          inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID          left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'          where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0          ) A          )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'          LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID          LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2019-08-16 17:23:22,053 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2019-08-16 17:23:22,986 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 17:23:23,959 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2019-08-16 17:23:29,336 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2019-08-16 17:23:29,408 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2019-08-16 17:23:29,486 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 17:23:29,623 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 17:23:29,772 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2019-08-16 17:23:29,775 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-08-16 17:23:29,775 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-08-16 17:23:29,805 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2019-08-16 17:23:29,805 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-08-16 17:23:29,805 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-08-16 17:23:29,930 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 17:23:30,077 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 17:23:37,510 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 17:23:37,601 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2019-08-16 17:23:37,849 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2019-08-16 17:23:45,808 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'STA06'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 17:23:46,188 [1] DEBUG - Statement Id: [DAO00401_INV001_GetDMNhanVien] PreparedStatement : [SELECT NHANVIEN_ID,TENNHANVIEN,NHANVIEN_ID AS NHANVIENNHAN_ID,TENNHANVIEN AS TENNHANVIENNHAN FROM [TM_NHANVIEN]        where BENHVIEN_ID = 'HLU01'        ORDER BY TENNHANVIEN]
2019-08-16 17:23:46,550 [1] DEBUG - Statement Id: [DAO00401_INV001_GetDMKHOVPP] PreparedStatement : [Select K.*,BB.SODU,BB.SODUDENNGAY,BB.KHOASO,BB.NGAYKHOA  From TM_KHO K        LEFT JOIN TM_INV_KHO BB ON K.MAKHO = BB.MAKHO        LEFT JOIN LST_DICTIONARY AA ON AA.DICTIONARY_ID = K.MODULE_ID        WHERE AA.DICTIONARY_CODE = 'KhoVPP']
2019-08-16 17:23:46,791 [1] DEBUG - Statement Id: [DAO00401_GetListMucDichChungTu] PreparedStatement : [SELECT DICTIONARY_ID, DICTIONARY_CODE, DICTIONARY_NAME        FROM LST_DICTIONARY        WHERE DICTIONARY_TYPE_CODE = 'VPP_MucDichChungTu'        AND ENABLED = '1']
2019-08-16 17:23:47,799 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 17:23:49,774 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'STA07'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 17:23:49,916 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM98'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 17:23:50,398 [1] DEBUG - Statement Id: [DAO00401_INV001_ChungTuXuatSearch] PreparedStatement : [select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/16/2019 5:23:50 PM' AND '8/16/2019 5:23:50 PM'        AND CT.MAKHOXUAT = 'KCVPP'                   UNION          select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/16/2019 5:23:50 PM' AND '8/16/2019 5:23:50 PM'        AND CT.MAKHOXUAT = 'KCVPP']
2019-08-16 17:23:50,738 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatChiTiet_ChungTuID] PreparedStatement : [select CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        FROM TT_INV_CHUNGTUXUATCHITIET CTCT INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID        WHERE CTCT.BENHVIEN_ID = 'HLU01' AND CTCT.CHUNGTUXUAT_ID='6']
2019-08-16 17:23:52,011 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatChiTiet_ChungTuID] PreparedStatement : [select CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        FROM TT_INV_CHUNGTUXUATCHITIET CTCT INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID        WHERE CTCT.BENHVIEN_ID = 'HLU01' AND CTCT.CHUNGTUXUAT_ID='11']
2019-08-16 17:23:55,523 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatAll] PreparedStatement : [SELECT CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID,        CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        , CT.MUCDICHCHUNGTU_ID, CT.MUCDICHCHUNGTU_CODE        FROM TT_INV_CHUNGTUXUAT CT INNER JOIN TT_INV_CHUNGTUXUATCHITIET CTCT ON CT.CHUNGTUXUAT_ID=CTCT.CHUNGTUXUAT_ID               INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID      where CT.BENHVIEN_ID = 'HLU01' AND CT.MACHUNGTU = 'X21190816163249'             ORDER BY TD.TENHANGHOA]
2019-08-16 17:24:23,263 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 17:24:27,442 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatChiTiet_ChungTuID] PreparedStatement : [select CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        FROM TT_INV_CHUNGTUXUATCHITIET CTCT INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID        WHERE CTCT.BENHVIEN_ID = 'HLU01' AND CTCT.CHUNGTUXUAT_ID='6']
2019-08-16 17:24:27,475 [1] DEBUG - Statement Id: [DAO00401_INV001_ChungTuXuatSearch] PreparedStatement : [select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/16/2019 5:24:27 PM' AND '8/16/2019 5:24:27 PM'        AND CT.MAKHOXUAT = 'KCVPP'                   UNION          select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/16/2019 5:24:27 PM' AND '8/16/2019 5:24:27 PM'        AND CT.MAKHOXUAT = 'KCVPP']
2019-08-16 17:24:28,440 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatChiTiet_ChungTuID] PreparedStatement : [select CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        FROM TT_INV_CHUNGTUXUATCHITIET CTCT INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID        WHERE CTCT.BENHVIEN_ID = 'HLU01' AND CTCT.CHUNGTUXUAT_ID='7']
2019-08-16 17:24:30,177 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatAll] PreparedStatement : [SELECT CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID,        CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        , CT.MUCDICHCHUNGTU_ID, CT.MUCDICHCHUNGTU_CODE        FROM TT_INV_CHUNGTUXUAT CT INNER JOIN TT_INV_CHUNGTUXUATCHITIET CTCT ON CT.CHUNGTUXUAT_ID=CTCT.CHUNGTUXUAT_ID               INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID      where CT.BENHVIEN_ID = 'HLU01' AND CT.MACHUNGTU = 'X190816150712'             ORDER BY TD.TENHANGHOA]
2019-08-16 17:24:30,667 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 17:24:35,540 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatChiTiet_ChungTuID] PreparedStatement : [select CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        FROM TT_INV_CHUNGTUXUATCHITIET CTCT INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID        WHERE CTCT.BENHVIEN_ID = 'HLU01' AND CTCT.CHUNGTUXUAT_ID='6']
2019-08-16 17:24:35,578 [1] DEBUG - Statement Id: [DAO00401_INV001_ChungTuXuatSearch] PreparedStatement : [select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/16/2019 5:24:35 PM' AND '8/16/2019 5:24:35 PM'        AND CT.MAKHOXUAT = 'KCVPP'                   UNION          select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/16/2019 5:24:35 PM' AND '8/16/2019 5:24:35 PM'        AND CT.MAKHOXUAT = 'KCVPP']
2019-08-16 17:24:36,557 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatChiTiet_ChungTuID] PreparedStatement : [select CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        FROM TT_INV_CHUNGTUXUATCHITIET CTCT INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID        WHERE CTCT.BENHVIEN_ID = 'HLU01' AND CTCT.CHUNGTUXUAT_ID='10']
2019-08-16 17:24:40,171 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatAll] PreparedStatement : [SELECT CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID,        CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        , CT.MUCDICHCHUNGTU_ID, CT.MUCDICHCHUNGTU_CODE        FROM TT_INV_CHUNGTUXUAT CT INNER JOIN TT_INV_CHUNGTUXUATCHITIET CTCT ON CT.CHUNGTUXUAT_ID=CTCT.CHUNGTUXUAT_ID               INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID      where CT.BENHVIEN_ID = 'HLU01' AND CT.MACHUNGTU = 'X07190816163110'             ORDER BY TD.TENHANGHOA]
2019-08-16 17:24:40,655 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 17:25:10,658 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatChiTiet_ChungTuID] PreparedStatement : [select CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        FROM TT_INV_CHUNGTUXUATCHITIET CTCT INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID        WHERE CTCT.BENHVIEN_ID = 'HLU01' AND CTCT.CHUNGTUXUAT_ID='6']
2019-08-16 17:25:10,692 [1] DEBUG - Statement Id: [DAO00401_INV001_ChungTuXuatSearch] PreparedStatement : [select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/16/2019 5:25:10 PM' AND '8/16/2019 5:25:10 PM'        AND CT.MAKHOXUAT = 'KCVPP'                   UNION          select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/16/2019 5:25:10 PM' AND '8/16/2019 5:25:10 PM'        AND CT.MAKHOXUAT = 'KCVPP']
2019-08-16 17:25:11,773 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatChiTiet_ChungTuID] PreparedStatement : [select CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        FROM TT_INV_CHUNGTUXUATCHITIET CTCT INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID        WHERE CTCT.BENHVIEN_ID = 'HLU01' AND CTCT.CHUNGTUXUAT_ID='11']
2019-08-16 17:25:13,418 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatAll] PreparedStatement : [SELECT CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID,        CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        , CT.MUCDICHCHUNGTU_ID, CT.MUCDICHCHUNGTU_CODE        FROM TT_INV_CHUNGTUXUAT CT INNER JOIN TT_INV_CHUNGTUXUATCHITIET CTCT ON CT.CHUNGTUXUAT_ID=CTCT.CHUNGTUXUAT_ID               INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID      where CT.BENHVIEN_ID = 'HLU01' AND CT.MACHUNGTU = 'X21190816163249'             ORDER BY TD.TENHANGHOA]
2019-08-16 17:25:13,887 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
--------------------------------------------------------------------------------
2019-08-16 17:30:30,419 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2019-08-16 17:30:31,411 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-08-16 17:30:31,463 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-08-16 17:30:31,847 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 17:30:32,138 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-08-16 17:31:25,036 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2019-08-16 17:31:25,064 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-08-16 17:31:26,539 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-08-16 17:31:26,700 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-08-16 17:31:27,464 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2019-08-16 17:31:27,602 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2019-08-16 17:31:27,675 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2019-08-16 17:31:27,745 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2019-08-16 17:31:28,074 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2019-08-16 17:31:28,146 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2019-08-16 17:31:28,224 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2019-08-16 17:31:28,296 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2019-08-16 17:31:28,378 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2019-08-16 17:31:28,882 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2019-08-16 17:31:29,275 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2019-08-16 17:31:29,364 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2019-08-16 17:31:29,479 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2019-08-16 17:31:30,250 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2019-08-16 17:31:30,299 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 0 as PHAMVI_ID, 0 as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0         end                else        begin        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2019-08-16 17:31:32,314 [5] DEBUG - Statement Id: [DAO00320_GetList] PreparedStatement : [select M.*            from TM_MAU M            LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID            where            M.TAMNGUNG = '0'            and M.BENHVIEN_ID = 'HLU01'            order by M.TENMAU]
2019-08-16 17:31:32,394 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2019-08-16 17:31:32,427 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT          TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,          TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,          SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH          FROM TT_MAU_TONKHO TK          JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID          JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID          JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'          LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID          LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID          WHERE TK.SOLUONG > 0          GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,          TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2019-08-16 17:31:32,493 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2019-08-16 17:31:32,556 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct          TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,          TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,          TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH          from TM_MAU M          JOIN          (          select          A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO          from          (          select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO          from TT_MAU_TONKHO TK          JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID          inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID          left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'          where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0          ) A          )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'          LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID          LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2019-08-16 17:31:32,622 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2019-08-16 17:31:33,542 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 17:31:34,346 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2019-08-16 17:31:38,163 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2019-08-16 17:31:38,191 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2019-08-16 17:31:38,261 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 17:31:38,388 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 17:31:38,512 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2019-08-16 17:31:38,515 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-08-16 17:31:38,515 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-08-16 17:31:38,545 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2019-08-16 17:31:38,545 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-08-16 17:31:38,545 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-08-16 17:31:38,675 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 17:31:38,847 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 17:31:46,599 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 17:31:46,705 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2019-08-16 17:31:46,991 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2019-08-16 17:32:01,791 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'STA06'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 17:32:02,138 [1] DEBUG - Statement Id: [DAO00401_INV001_GetDMNhanVien] PreparedStatement : [SELECT NHANVIEN_ID,TENNHANVIEN,NHANVIEN_ID AS NHANVIENNHAN_ID,TENNHANVIEN AS TENNHANVIENNHAN FROM [TM_NHANVIEN]        where BENHVIEN_ID = 'HLU01'        ORDER BY TENNHANVIEN]
2019-08-16 17:32:02,524 [1] DEBUG - Statement Id: [DAO00401_INV001_GetDMKHOVPP] PreparedStatement : [Select K.*,BB.SODU,BB.SODUDENNGAY,BB.KHOASO,BB.NGAYKHOA  From TM_KHO K        LEFT JOIN TM_INV_KHO BB ON K.MAKHO = BB.MAKHO        LEFT JOIN LST_DICTIONARY AA ON AA.DICTIONARY_ID = K.MODULE_ID        WHERE AA.DICTIONARY_CODE = 'KhoVPP']
2019-08-16 17:32:02,720 [1] DEBUG - Statement Id: [DAO00401_GetListMucDichChungTu] PreparedStatement : [SELECT DICTIONARY_ID, DICTIONARY_CODE, DICTIONARY_NAME        FROM LST_DICTIONARY        WHERE DICTIONARY_TYPE_CODE = 'VPP_MucDichChungTu'        AND ENABLED = '1']
2019-08-16 17:32:03,479 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 17:32:05,968 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'STA07'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 17:32:06,118 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM98'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 17:32:06,566 [1] DEBUG - Statement Id: [DAO00401_INV001_ChungTuXuatSearch] PreparedStatement : [select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/16/2019 5:32:06 PM' AND '8/16/2019 5:32:06 PM'        AND CT.MAKHOXUAT = 'KCVPP'                   UNION          select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/16/2019 5:32:06 PM' AND '8/16/2019 5:32:06 PM'        AND CT.MAKHOXUAT = 'KCVPP']
2019-08-16 17:32:06,863 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatChiTiet_ChungTuID] PreparedStatement : [select CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        FROM TT_INV_CHUNGTUXUATCHITIET CTCT INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID        WHERE CTCT.BENHVIEN_ID = 'HLU01' AND CTCT.CHUNGTUXUAT_ID='6']
2019-08-16 17:32:08,628 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatChiTiet_ChungTuID] PreparedStatement : [select CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        FROM TT_INV_CHUNGTUXUATCHITIET CTCT INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID        WHERE CTCT.BENHVIEN_ID = 'HLU01' AND CTCT.CHUNGTUXUAT_ID='11']
2019-08-16 17:32:11,624 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatAll] PreparedStatement : [SELECT CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID,        CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        , CT.MUCDICHCHUNGTU_ID, CT.MUCDICHCHUNGTU_CODE        FROM TT_INV_CHUNGTUXUAT CT INNER JOIN TT_INV_CHUNGTUXUATCHITIET CTCT ON CT.CHUNGTUXUAT_ID=CTCT.CHUNGTUXUAT_ID               INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID      where CT.BENHVIEN_ID = 'HLU01' AND CT.MACHUNGTU = 'X21190816163249'             ORDER BY TD.TENHANGHOA]
2019-08-16 17:32:12,224 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 17:33:15,672 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatChiTiet_ChungTuID] PreparedStatement : [select CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        FROM TT_INV_CHUNGTUXUATCHITIET CTCT INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID        WHERE CTCT.BENHVIEN_ID = 'HLU01' AND CTCT.CHUNGTUXUAT_ID='6']
2019-08-16 17:33:15,705 [1] DEBUG - Statement Id: [DAO00401_INV001_ChungTuXuatSearch] PreparedStatement : [select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/16/2019 5:33:15 PM' AND '8/16/2019 5:33:15 PM'        AND CT.MAKHOXUAT = 'KCVPP'                   UNION          select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/16/2019 5:33:15 PM' AND '8/16/2019 5:33:15 PM'        AND CT.MAKHOXUAT = 'KCVPP']
2019-08-16 17:33:17,217 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatChiTiet_ChungTuID] PreparedStatement : [select CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        FROM TT_INV_CHUNGTUXUATCHITIET CTCT INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID        WHERE CTCT.BENHVIEN_ID = 'HLU01' AND CTCT.CHUNGTUXUAT_ID='10']
2019-08-16 17:33:17,545 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatAll] PreparedStatement : [SELECT CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID,        CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        , CT.MUCDICHCHUNGTU_ID, CT.MUCDICHCHUNGTU_CODE        FROM TT_INV_CHUNGTUXUAT CT INNER JOIN TT_INV_CHUNGTUXUATCHITIET CTCT ON CT.CHUNGTUXUAT_ID=CTCT.CHUNGTUXUAT_ID               INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID      where CT.BENHVIEN_ID = 'HLU01' AND CT.MACHUNGTU = 'X07190816163110'             ORDER BY TD.TENHANGHOA]
2019-08-16 17:33:18,095 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 17:33:32,525 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatChiTiet_ChungTuID] PreparedStatement : [select CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        FROM TT_INV_CHUNGTUXUATCHITIET CTCT INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID        WHERE CTCT.BENHVIEN_ID = 'HLU01' AND CTCT.CHUNGTUXUAT_ID='6']
2019-08-16 17:33:32,583 [1] DEBUG - Statement Id: [DAO00401_INV001_ChungTuXuatSearch] PreparedStatement : [select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/16/2019 5:33:32 PM' AND '8/16/2019 5:33:32 PM'        AND CT.MAKHOXUAT = 'KCVPP'                   UNION          select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/16/2019 5:33:32 PM' AND '8/16/2019 5:33:32 PM'        AND CT.MAKHOXUAT = 'KCVPP']
2019-08-16 17:33:33,879 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatChiTiet_ChungTuID] PreparedStatement : [select CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        FROM TT_INV_CHUNGTUXUATCHITIET CTCT INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID        WHERE CTCT.BENHVIEN_ID = 'HLU01' AND CTCT.CHUNGTUXUAT_ID='11']
2019-08-16 17:33:34,284 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatAll] PreparedStatement : [SELECT CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID,        CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        , CT.MUCDICHCHUNGTU_ID, CT.MUCDICHCHUNGTU_CODE        FROM TT_INV_CHUNGTUXUAT CT INNER JOIN TT_INV_CHUNGTUXUATCHITIET CTCT ON CT.CHUNGTUXUAT_ID=CTCT.CHUNGTUXUAT_ID               INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID      where CT.BENHVIEN_ID = 'HLU01' AND CT.MACHUNGTU = 'X21190816163249'             ORDER BY TD.TENHANGHOA]
2019-08-16 17:33:34,745 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 17:34:16,203 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatChiTiet_ChungTuID] PreparedStatement : [select CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        FROM TT_INV_CHUNGTUXUATCHITIET CTCT INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID        WHERE CTCT.BENHVIEN_ID = 'HLU01' AND CTCT.CHUNGTUXUAT_ID='6']
2019-08-16 17:34:16,235 [1] DEBUG - Statement Id: [DAO00401_INV001_ChungTuXuatSearch] PreparedStatement : [select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/16/2019 5:34:16 PM' AND '8/16/2019 5:34:16 PM'        AND CT.MAKHOXUAT = 'KCVPP'                   UNION          select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/16/2019 5:34:16 PM' AND '8/16/2019 5:34:16 PM'        AND CT.MAKHOXUAT = 'KCVPP']
2019-08-16 17:34:17,479 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatChiTiet_ChungTuID] PreparedStatement : [select CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        FROM TT_INV_CHUNGTUXUATCHITIET CTCT INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID        WHERE CTCT.BENHVIEN_ID = 'HLU01' AND CTCT.CHUNGTUXUAT_ID='10']
2019-08-16 17:34:17,829 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatAll] PreparedStatement : [SELECT CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID,        CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        , CT.MUCDICHCHUNGTU_ID, CT.MUCDICHCHUNGTU_CODE        FROM TT_INV_CHUNGTUXUAT CT INNER JOIN TT_INV_CHUNGTUXUATCHITIET CTCT ON CT.CHUNGTUXUAT_ID=CTCT.CHUNGTUXUAT_ID               INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID      where CT.BENHVIEN_ID = 'HLU01' AND CT.MACHUNGTU = 'X07190816163110'             ORDER BY TD.TENHANGHOA]
2019-08-16 17:34:18,386 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 17:34:29,193 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatChiTiet_ChungTuID] PreparedStatement : [select CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        FROM TT_INV_CHUNGTUXUATCHITIET CTCT INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID        WHERE CTCT.BENHVIEN_ID = 'HLU01' AND CTCT.CHUNGTUXUAT_ID='6']
2019-08-16 17:34:29,224 [1] DEBUG - Statement Id: [DAO00401_INV001_ChungTuXuatSearch] PreparedStatement : [select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/16/2019 5:34:29 PM' AND '8/16/2019 5:34:29 PM'        AND CT.MAKHOXUAT = 'KCVPP'                   UNION          select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/16/2019 5:34:29 PM' AND '8/16/2019 5:34:29 PM'        AND CT.MAKHOXUAT = 'KCVPP']
2019-08-16 17:34:30,679 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatChiTiet_ChungTuID] PreparedStatement : [select CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        FROM TT_INV_CHUNGTUXUATCHITIET CTCT INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID        WHERE CTCT.BENHVIEN_ID = 'HLU01' AND CTCT.CHUNGTUXUAT_ID='11']
2019-08-16 17:34:31,020 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatAll] PreparedStatement : [SELECT CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID,        CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        , CT.MUCDICHCHUNGTU_ID, CT.MUCDICHCHUNGTU_CODE        FROM TT_INV_CHUNGTUXUAT CT INNER JOIN TT_INV_CHUNGTUXUATCHITIET CTCT ON CT.CHUNGTUXUAT_ID=CTCT.CHUNGTUXUAT_ID               INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID      where CT.BENHVIEN_ID = 'HLU01' AND CT.MACHUNGTU = 'X21190816163249'             ORDER BY TD.TENHANGHOA]
2019-08-16 17:34:31,481 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
--------------------------------------------------------------------------------
2019-08-16 17:57:27,661 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2019-08-16 17:57:27,940 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-08-16 17:57:27,975 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-08-16 17:57:28,534 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 17:57:28,824 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-08-16 17:57:52,301 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2019-08-16 17:57:52,329 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-08-16 17:57:55,290 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-08-16 17:57:55,452 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-08-16 17:57:56,423 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2019-08-16 17:57:56,665 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2019-08-16 17:57:56,826 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2019-08-16 17:57:56,906 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2019-08-16 17:57:56,981 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2019-08-16 17:57:57,055 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2019-08-16 17:57:57,132 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2019-08-16 17:57:57,204 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2019-08-16 17:57:57,279 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2019-08-16 17:57:57,788 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2019-08-16 17:57:57,831 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2019-08-16 17:57:57,923 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2019-08-16 17:57:57,954 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2019-08-16 17:57:58,823 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2019-08-16 17:57:58,884 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 0 as PHAMVI_ID, 0 as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0         end                else        begin        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2019-08-16 17:58:00,864 [5] DEBUG - Statement Id: [DAO00320_GetList] PreparedStatement : [select M.*            from TM_MAU M            LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID            where            M.TAMNGUNG = '0'            and M.BENHVIEN_ID = 'HLU01'            order by M.TENMAU]
2019-08-16 17:58:00,930 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2019-08-16 17:58:00,990 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT          TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,          TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,          SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH          FROM TT_MAU_TONKHO TK          JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID          JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID          JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'          LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID          LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID          WHERE TK.SOLUONG > 0          GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,          TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2019-08-16 17:58:01,085 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2019-08-16 17:58:01,184 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct          TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,          TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,          TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH          from TM_MAU M          JOIN          (          select          A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO          from          (          select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO          from TT_MAU_TONKHO TK          JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID          inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID          left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'          where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0          ) A          )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'          LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID          LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2019-08-16 17:58:01,314 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2019-08-16 17:58:02,255 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 17:58:03,695 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2019-08-16 17:58:09,128 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2019-08-16 17:58:09,420 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2019-08-16 17:58:10,210 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 17:58:10,334 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 17:58:10,548 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2019-08-16 17:58:10,549 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-08-16 17:58:10,549 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-08-16 17:58:10,577 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2019-08-16 17:58:10,578 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-08-16 17:58:10,578 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-08-16 17:58:10,722 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 17:58:10,924 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 17:58:20,225 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 17:58:20,325 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2019-08-16 17:58:20,715 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2019-08-16 17:58:26,784 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'STA06'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 17:58:27,167 [1] DEBUG - Statement Id: [DAO00401_INV001_GetDMNhanVien] PreparedStatement : [SELECT NHANVIEN_ID,TENNHANVIEN,NHANVIEN_ID AS NHANVIENNHAN_ID,TENNHANVIEN AS TENNHANVIENNHAN FROM [TM_NHANVIEN]        where BENHVIEN_ID = 'HLU01'        ORDER BY TENNHANVIEN]
2019-08-16 17:58:27,573 [1] DEBUG - Statement Id: [DAO00401_INV001_GetDMKHOVPP] PreparedStatement : [Select K.*,BB.SODU,BB.SODUDENNGAY,BB.KHOASO,BB.NGAYKHOA  From TM_KHO K        LEFT JOIN TM_INV_KHO BB ON K.MAKHO = BB.MAKHO        LEFT JOIN LST_DICTIONARY AA ON AA.DICTIONARY_ID = K.MODULE_ID        WHERE AA.DICTIONARY_CODE = 'KhoVPP']
2019-08-16 17:58:27,753 [1] DEBUG - Statement Id: [DAO00401_GetListMucDichChungTu] PreparedStatement : [SELECT DICTIONARY_ID, DICTIONARY_CODE, DICTIONARY_NAME        FROM LST_DICTIONARY        WHERE DICTIONARY_TYPE_CODE = 'VPP_MucDichChungTu'        AND ENABLED = '1']
2019-08-16 17:58:28,497 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 17:58:31,190 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'STA05'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 17:58:31,367 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM98'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 17:58:31,817 [1] DEBUG - Statement Id: [DAO00401_INV001_PhieuYeuCauSearch] PreparedStatement : [select YC.PHIEUYEUCAU_ID,YC.MAPHIEUYEUCAU,YC.MMYY,YC.NGAYLAP,YC.PHONGBAN_ID,YC.TENPHONGBAN,YC.MAKHOXUAT,YC.TENKHOXUAT,YC.GHICHU,YC.TENNGUOITAO,YC.TENNGUOICAPNHAT,YC.BENHVIEN_ID,YC.NGAYTAO,YC.NGUOITAO_ID,YC.NGAYCAPNHAT,YC.NGUOICAPNHAT_ID        FROM TT_INV_PHIEUYEUCAU YC        WHERE YC.BENHVIEN_ID = 'HLU01' AND YC.NGAYLAP BETWEEN '7/16/2019 5:58:31 PM' AND '8/16/2019 5:58:31 PM'         AND           YC.CHUNGTUXUAT_ID IS NULL         AND           YC.MAKHOXUAT = 'KCVPP']
2019-08-16 17:58:36,601 [1] DEBUG - Statement Id: [DAO00401_INV001_PhieuYeuCauSearch] PreparedStatement : [select YC.PHIEUYEUCAU_ID,YC.MAPHIEUYEUCAU,YC.MMYY,YC.NGAYLAP,YC.PHONGBAN_ID,YC.TENPHONGBAN,YC.MAKHOXUAT,YC.TENKHOXUAT,YC.GHICHU,YC.TENNGUOITAO,YC.TENNGUOICAPNHAT,YC.BENHVIEN_ID,YC.NGAYTAO,YC.NGUOITAO_ID,YC.NGAYCAPNHAT,YC.NGUOICAPNHAT_ID        FROM TT_INV_PHIEUYEUCAU YC        WHERE YC.BENHVIEN_ID = 'HLU01' AND YC.NGAYLAP BETWEEN '5/1/2019 12:00:00 AM' AND '8/16/2019 5:58:31 PM'         AND           YC.CHUNGTUXUAT_ID IS NULL         AND           YC.MAKHOXUAT = 'KCVPP']
2019-08-16 17:58:53,193 [1] DEBUG - Statement Id: [DAO00401_INV001_GetPhieuYeuCauChiTiet_PhieuYeuCauID] PreparedStatement : [select YCCT.PHIEUYEUCAUCHITIET_ID,YCCT.HANGHOA_ID,YCCT.MAHANGHOA,YCCT.TENHANGHOA,YCCT.DONVITINH_ID,YCCT.TENDONVITINH,YCCT.SOLUONGYEUCAU,YCCT.SOLUONGDAXUAT        FROM TT_INV_PHIEUYEUCAUCHITIET YCCT        WHERE YCCT.BENHVIEN_ID = 'HLU01' AND YCCT.PHIEUYEUCAU_ID='28']
2019-08-16 17:58:53,494 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChiTietYC_MaPhieuYeuCau] PreparedStatement : [select YC.PHIEUYEUCAU_ID,YC.MAPHIEUYEUCAU,YC.MMYY,YC.NGAYLAP,YC.PHONGBAN_ID AS PHONGBANNHAN_ID,YC.TENPHONGBAN AS TENPHONGBANNHAN,YC.MAKHOXUAT,YC.TENKHOXUAT,        YCCT.PHIEUYEUCAUCHITIET_ID,YCCT.HANGHOA_ID,YCCT.MAHANGHOA,YCCT.TENHANGHOA,YCCT.DONVITINH_ID,YCCT.TENDONVITINH,YCCT.SOLUONGYEUCAU,YCCT.SOLUONGYEUCAU AS SOLUONGXUAT, NULL AS DONGIA,NULL AS LOSX,NULL AS HANDUNG,        TKTH.SOLUONGTONCUOI        FROM TT_INV_PHIEUYEUCAU YC INNER JOIN TT_INV_PHIEUYEUCAUCHITIET YCCT ON YC.PHIEUYEUCAU_ID=YCCT.PHIEUYEUCAU_ID        LEFT JOIN (SELECT (SOLUONGTONDAU+SOLUONGNHAP-SOLUONGXUAT) AS SOLUONGTONCUOI, HANGHOA_ID,MAKHO        FROM TT_INV_TONKHOTONGHOP WHERE BENHVIEN_ID='HLU01' AND MMYY='0819'        ) TKTH ON YCCT.HANGHOA_ID = TKTH.HANGHOA_ID AND YC.MAKHOXUAT = TKTH.MAKHO        WHERE YC.MAPHIEUYEUCAU='YC50190530103214' AND YC.BENHVIEN_ID = 'HLU01']
--------------------------------------------------------------------------------
2019-08-16 18:03:11,007 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2019-08-16 18:03:11,466 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-08-16 18:03:11,514 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-08-16 18:03:11,941 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 18:03:12,200 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-08-16 18:03:17,841 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2019-08-16 18:03:17,871 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-08-16 18:03:19,490 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-08-16 18:03:19,575 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-08-16 18:03:20,401 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2019-08-16 18:03:20,635 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2019-08-16 18:03:20,740 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2019-08-16 18:03:20,821 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2019-08-16 18:03:20,899 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2019-08-16 18:03:20,987 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2019-08-16 18:03:21,064 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2019-08-16 18:03:21,145 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2019-08-16 18:03:21,230 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2019-08-16 18:03:21,766 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2019-08-16 18:03:21,820 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2019-08-16 18:03:22,038 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2019-08-16 18:03:22,119 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2019-08-16 18:03:23,809 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2019-08-16 18:03:23,844 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 0 as PHAMVI_ID, 0 as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0         end                else        begin        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2019-08-16 18:03:26,181 [5] DEBUG - Statement Id: [DAO00320_GetList] PreparedStatement : [select M.*            from TM_MAU M            LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID            where            M.TAMNGUNG = '0'            and M.BENHVIEN_ID = 'HLU01'            order by M.TENMAU]
2019-08-16 18:03:26,258 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2019-08-16 18:03:26,296 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT          TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,          TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,          SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH          FROM TT_MAU_TONKHO TK          JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID          JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID          JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'          LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID          LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID          WHERE TK.SOLUONG > 0          GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,          TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2019-08-16 18:03:26,380 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2019-08-16 18:03:26,411 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct          TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,          TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,          TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH          from TM_MAU M          JOIN          (          select          A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO          from          (          select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO          from TT_MAU_TONKHO TK          JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID          inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID          left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'          where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0          ) A          )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'          LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID          LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2019-08-16 18:03:26,474 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2019-08-16 18:03:27,406 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 18:03:28,311 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2019-08-16 18:03:32,778 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2019-08-16 18:03:32,808 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2019-08-16 18:03:32,891 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 18:03:33,268 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 18:03:33,397 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2019-08-16 18:03:33,399 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-08-16 18:03:33,399 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-08-16 18:03:33,427 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2019-08-16 18:03:33,427 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-08-16 18:03:33,427 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-08-16 18:03:33,564 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 18:03:33,730 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 18:03:41,711 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 18:03:41,801 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2019-08-16 18:03:42,049 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2019-08-16 18:03:47,866 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'STA06'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 18:03:48,199 [1] DEBUG - Statement Id: [DAO00401_INV001_GetDMNhanVien] PreparedStatement : [SELECT NHANVIEN_ID,TENNHANVIEN,NHANVIEN_ID AS NHANVIENNHAN_ID,TENNHANVIEN AS TENNHANVIENNHAN FROM [TM_NHANVIEN]        where BENHVIEN_ID = 'HLU01'        ORDER BY TENNHANVIEN]
2019-08-16 18:03:48,559 [1] DEBUG - Statement Id: [DAO00401_INV001_GetDMKHOVPP] PreparedStatement : [Select K.*,BB.SODU,BB.SODUDENNGAY,BB.KHOASO,BB.NGAYKHOA  From TM_KHO K        LEFT JOIN TM_INV_KHO BB ON K.MAKHO = BB.MAKHO        LEFT JOIN LST_DICTIONARY AA ON AA.DICTIONARY_ID = K.MODULE_ID        WHERE AA.DICTIONARY_CODE = 'KhoVPP']
2019-08-16 18:03:48,738 [1] DEBUG - Statement Id: [DAO00401_GetListMucDichChungTu] PreparedStatement : [SELECT DICTIONARY_ID, DICTIONARY_CODE, DICTIONARY_NAME        FROM LST_DICTIONARY        WHERE DICTIONARY_TYPE_CODE = 'VPP_MucDichChungTu'        AND ENABLED = '1']
2019-08-16 18:03:49,517 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 18:03:51,801 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'STA05'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 18:03:51,978 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM98'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 18:03:52,442 [1] DEBUG - Statement Id: [DAO00401_INV001_PhieuYeuCauSearch] PreparedStatement : [select YC.PHIEUYEUCAU_ID,YC.MAPHIEUYEUCAU,YC.MMYY,YC.NGAYLAP,YC.PHONGBAN_ID,YC.TENPHONGBAN,YC.MAKHOXUAT,YC.TENKHOXUAT,YC.GHICHU,YC.TENNGUOITAO,YC.TENNGUOICAPNHAT,YC.BENHVIEN_ID,YC.NGAYTAO,YC.NGUOITAO_ID,YC.NGAYCAPNHAT,YC.NGUOICAPNHAT_ID        FROM TT_INV_PHIEUYEUCAU YC        WHERE YC.BENHVIEN_ID = 'HLU01' AND YC.NGAYLAP BETWEEN '7/16/2019 6:03:52 PM' AND '8/16/2019 6:03:52 PM'         AND           YC.CHUNGTUXUAT_ID IS NULL         AND           YC.MAKHOXUAT = 'KCVPP']
2019-08-16 18:03:56,989 [1] DEBUG - Statement Id: [DAO00401_INV001_PhieuYeuCauSearch] PreparedStatement : [select YC.PHIEUYEUCAU_ID,YC.MAPHIEUYEUCAU,YC.MMYY,YC.NGAYLAP,YC.PHONGBAN_ID,YC.TENPHONGBAN,YC.MAKHOXUAT,YC.TENKHOXUAT,YC.GHICHU,YC.TENNGUOITAO,YC.TENNGUOICAPNHAT,YC.BENHVIEN_ID,YC.NGAYTAO,YC.NGUOITAO_ID,YC.NGAYCAPNHAT,YC.NGUOICAPNHAT_ID        FROM TT_INV_PHIEUYEUCAU YC        WHERE YC.BENHVIEN_ID = 'HLU01' AND YC.NGAYLAP BETWEEN '5/1/2019 12:00:00 AM' AND '8/16/2019 6:03:52 PM'         AND           YC.CHUNGTUXUAT_ID IS NULL         AND           YC.MAKHOXUAT = 'KCVPP']
2019-08-16 18:03:57,991 [1] DEBUG - Statement Id: [DAO00401_INV001_GetPhieuYeuCauChiTiet_PhieuYeuCauID] PreparedStatement : [select YCCT.PHIEUYEUCAUCHITIET_ID,YCCT.HANGHOA_ID,YCCT.MAHANGHOA,YCCT.TENHANGHOA,YCCT.DONVITINH_ID,YCCT.TENDONVITINH,YCCT.SOLUONGYEUCAU,YCCT.SOLUONGDAXUAT        FROM TT_INV_PHIEUYEUCAUCHITIET YCCT        WHERE YCCT.BENHVIEN_ID = 'HLU01' AND YCCT.PHIEUYEUCAU_ID='28']
2019-08-16 18:03:58,288 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChiTietYC_MaPhieuYeuCau] PreparedStatement : [select YC.PHIEUYEUCAU_ID,YC.MAPHIEUYEUCAU,YC.MMYY,YC.NGAYLAP,YC.PHONGBAN_ID AS PHONGBANNHAN_ID,YC.TENPHONGBAN AS TENPHONGBANNHAN,YC.MAKHOXUAT,YC.TENKHOXUAT,        YCCT.PHIEUYEUCAUCHITIET_ID,YCCT.HANGHOA_ID,YCCT.MAHANGHOA,YCCT.TENHANGHOA,YCCT.DONVITINH_ID,YCCT.TENDONVITINH,YCCT.SOLUONGYEUCAU,YCCT.SOLUONGYEUCAU AS SOLUONGXUAT, NULL AS DONGIA,NULL AS LOSX,NULL AS HANDUNG,        TKTH.SOLUONGTONCUOI        FROM TT_INV_PHIEUYEUCAU YC INNER JOIN TT_INV_PHIEUYEUCAUCHITIET YCCT ON YC.PHIEUYEUCAU_ID=YCCT.PHIEUYEUCAU_ID        LEFT JOIN (SELECT (SOLUONGTONDAU+SOLUONGNHAP-SOLUONGXUAT) AS SOLUONGTONCUOI, HANGHOA_ID,MAKHO        FROM TT_INV_TONKHOTONGHOP WHERE BENHVIEN_ID='HLU01' AND MMYY='0819'        ) TKTH ON YCCT.HANGHOA_ID = TKTH.HANGHOA_ID AND YC.MAKHOXUAT = TKTH.MAKHO        WHERE YC.MAPHIEUYEUCAU='YC50190530103214' AND YC.BENHVIEN_ID = 'HLU01']
2019-08-16 18:04:34,394 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 18:04:34,465 [1] DEBUG - Statement Id: [DAO00401_INV001_GetTonKho] PreparedStatement : [SELECT TKTH.HANGHOA_ID,TKTH.MAHANGHOA,TKTH.TENHANGHOA,HH.DONVITINH_ID,HH.TENDONVITINH,SUM(TKTH.SOLUONGTONDAU+TKTH.SOLUONGNHAP-TKTH.SOLUONGXUAT) AS SOLUONGTONCUOI        FROM TM_PUR_HANGHOA HH INNER JOIN TT_INV_TONKHOTONGHOP TKTH ON HH.ID = TKTH.HANGHOA_ID        where TKTH.BENHVIEN_ID = 'HLU01' AND TKTH.MAKHO = 'KCVPP' AND TKTH.MMYY='0819'        GROUP BY TKTH.HANGHOA_ID,TKTH.MAHANGHOA,TKTH.TENHANGHOA,HH.DONVITINH_ID,HH.TENDONVITINH]
2019-08-16 18:04:36,369 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraMaChungTuXuatTonTai] PreparedStatement : [select CT.IDCHUYEN        FROM TT_INV_CHUNGTUXUAT CT        where CT.MACHUNGTU = 'X21190816180436' AND CT.BENHVIEN_ID = 'HLU01'         AND         CT.MMYY IN(0819)]
2019-08-16 18:04:37,579 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuat] PreparedStatement : [INSERT INTO TT_INV_CHUNGTUXUAT      (MACHUNGTU,MMYY,NGAYCHUNGTU,MAKHOXUAT,TENKHOXUAT,PHONGBANNHAN_ID,TENPHONGBANNHAN,NHANVIENNHAN_ID,TENNHANVIENNHAN,GHICHU,PHIEUYEUCAU_ID,MAPHIEUYEUCAU,XUATKHOTHEO,TENNGUOITAO,BENHVIEN_ID,NGAYTAO,NGUOITAO_ID                , MUCDICHCHUNGTU_ID                , MUCDICHCHUNGTU_CODE             )      VALUES ( @param0 , @param1 , @param2 , @param3 , @param4 , @param5 , @param6 , @param7 , @param8 , @param9 , @param10 , @param11 , @param12 , @param13 , @param14 ,GETDATE(), @param15                 ,  @param16                 ,  @param17              )      SELECT SCOPE_IDENTITY()]
2019-08-16 18:04:37,579 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuat] Parameters: [@param0=[MACHUNGTU,X21190816180436], @param1=[MMYY,0819], @param2=[NGAYCHUNGTU,8/16/2019 6:03:58 PM], @param3=[MAKHOXUAT,KCVPP], @param4=[TENKHOXUAT,Kho chính VPP], @param5=[PHONGBANNHAN_ID,50], @param6=[TENPHONGBANNHAN,Phòng Kế Hoạch tổng hợp], @param7=[NHANVIENNHAN_ID,48], @param8=[TENNHANVIENNHAN,Bùi Hoàng Hải], @param9=[GHICHU,sdsdf], @param10=[PHIEUYEUCAU_ID,28], @param11=[MAPHIEUYEUCAU,YC50190530103214], @param12=[XUATKHOTHEO,Hạn dùng], @param13=[TENNGUOITAO,Administrator], @param14=[BENHVIEN_ID,HLU01], @param15=[NGUOITAO_ID,1], @param16=[MUCDICHCHUNGTU_ID,11712], @param17=[MUCDICHCHUNGTU_CODE,X21]]
2019-08-16 18:04:37,579 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuat] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[DateTime, System.DateTime], @param3=[String, System.String], @param4=[String, System.String], @param5=[Int64, System.Int64], @param6=[String, System.String], @param7=[Int64, System.Int64], @param8=[String, System.String], @param9=[String, System.String], @param10=[Int64, System.Int64], @param11=[String, System.String], @param12=[String, System.String], @param13=[String, System.String], @param14=[String, System.String], @param15=[Int64, System.Int64], @param16=[Int64, System.Int64], @param17=[String, System.String]]
2019-08-16 18:04:43,511 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdChungTuXuatID_PhieuYeuCau] PreparedStatement : [UPDATE TT_INV_PHIEUYEUCAU SET CHUNGTUXUAT_ID =  @param0  WHERE PHIEUYEUCAU_ID = '28' AND BENHVIEN_ID = 'HLU01']
2019-08-16 18:04:43,511 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdChungTuXuatID_PhieuYeuCau] Parameters: [@param0=[CHUNGTUXUAT_ID,12]]
2019-08-16 18:04:43,511 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdChungTuXuatID_PhieuYeuCau] Types: [@param0=[Int64, System.Int64]]
2019-08-16 18:04:43,540 [1] DEBUG - Statement Id: [DAO00401_INV001_GetTonKhoChiTiet] PreparedStatement : [SELECT TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.DONGIA AS DONGIATRUOCVAT,TD.DONGIASAUVAT AS DONGIA,CASE WHEN TD.HANDUNG IS NULL THEN DATEADD(YEAR,999, GETDATE()) ELSE TD.HANDUNG END AS HANDUNG ,TD.NGAYTAO,        SUM(TKCT.SOLUONGTONDAU+TKCT.SOLUONGNHAP-TKCT.SOLUONGXUAT) AS SOLUONGTONCUOI        FROM TM_PUR_HANGHOA HH INNER JOIN TT_INV_THEODOI TD ON HH.ID = TD.HANGHOA_ID        INNER JOIN TT_INV_TONKHOCHITIET TKCT ON TD.THEODOI_ID = TKCT.THEODOI_ID        where TKCT.BENHVIEN_ID = 'HLU01' AND TKCT.MAKHO = 'KCVPP' AND TKCT.MMYY='0819'        GROUP BY TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.DONGIA,TD.DONGIASAUVAT,TD.HANDUNG,TD.NGAYTAO        ORDER BY TD.NGAYTAO]
2019-08-16 18:04:43,739 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuatChiTiet] PreparedStatement : [INSERT INTO TT_INV_CHUNGTUXUATCHITIET(CHUNGTUXUAT_ID,MMYY,THEODOI_ID,SOLUONGYEUCAU,SOLUONGXUAT,THANHTIEN,GHICHU,PHIEUYEUCAUCHITIET_ID,TENNGUOITAO,BENHVIEN_ID,NGAYTAO,NGUOITAO_ID)       VALUES( @param0 , @param1 , @param2 , @param3 , @param4 , @param5 , @param6 , @param7 , @param8 , @param9 ,GETDATE(), @param10 )        SELECT SCOPE_IDENTITY()]
2019-08-16 18:04:43,739 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuatChiTiet] Parameters: [@param0=[CHUNGTUXUAT_ID,12], @param1=[MMYY,0819], @param2=[THEODOI_ID,969], @param3=[SOLUONGYEUCAU,1], @param4=[SOLUONGXUAT,1], @param5=[THANHTIEN,0.0000], @param6=[CT_GHICHU,null], @param7=[PHIEUYEUCAUCHITIET_ID,63], @param8=[TENNGUOITAO,null], @param9=[BENHVIEN_ID,HLU01], @param10=[NGUOITAO_ID,null]]
2019-08-16 18:04:43,739 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuatChiTiet] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String], @param2=[Int32, System.Int32], @param3=[Double, System.Double], @param4=[Decimal, System.Decimal], @param5=[Decimal, System.Decimal], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[String, System.String], @param10=[System.DBNull, null]]
2019-08-16 18:04:43,773 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLDaXuat_PhieuYeuCauChiTietID] PreparedStatement : [UPDATE TT_INV_PHIEUYEUCAUCHITIET        SET SOLUONGDAXUAT= @param0         WHERE PHIEUYEUCAUCHITIET_ID = '63' AND BENHVIEN_ID = 'HLU01']
2019-08-16 18:04:43,774 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLDaXuat_PhieuYeuCauChiTietID] Parameters: [@param0=[SOLUONGXUAT,1]]
2019-08-16 18:04:43,774 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLDaXuat_PhieuYeuCauChiTietID] Types: [@param0=[Decimal, System.Decimal]]
2019-08-16 18:04:43,802 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuatChiTiet] PreparedStatement : [INSERT INTO TT_INV_CHUNGTUXUATCHITIET(CHUNGTUXUAT_ID,MMYY,THEODOI_ID,SOLUONGYEUCAU,SOLUONGXUAT,THANHTIEN,GHICHU,PHIEUYEUCAUCHITIET_ID,TENNGUOITAO,BENHVIEN_ID,NGAYTAO,NGUOITAO_ID)       VALUES( @param0 , @param1 , @param2 , @param3 , @param4 , @param5 , @param6 , @param7 , @param8 , @param9 ,GETDATE(), @param10 )        SELECT SCOPE_IDENTITY()]
2019-08-16 18:04:43,803 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuatChiTiet] Parameters: [@param0=[CHUNGTUXUAT_ID,12], @param1=[MMYY,0819], @param2=[THEODOI_ID,8], @param3=[SOLUONGYEUCAU,1], @param4=[SOLUONGXUAT,1], @param5=[THANHTIEN,32200.0000], @param6=[CT_GHICHU,null], @param7=[PHIEUYEUCAUCHITIET_ID,64], @param8=[TENNGUOITAO,null], @param9=[BENHVIEN_ID,HLU01], @param10=[NGUOITAO_ID,null]]
2019-08-16 18:04:43,803 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuatChiTiet] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String], @param2=[Int32, System.Int32], @param3=[Double, System.Double], @param4=[Decimal, System.Decimal], @param5=[Decimal, System.Decimal], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[String, System.String], @param10=[System.DBNull, null]]
2019-08-16 18:04:43,834 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLDaXuat_PhieuYeuCauChiTietID] PreparedStatement : [UPDATE TT_INV_PHIEUYEUCAUCHITIET        SET SOLUONGDAXUAT= @param0         WHERE PHIEUYEUCAUCHITIET_ID = '64' AND BENHVIEN_ID = 'HLU01']
2019-08-16 18:04:43,834 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLDaXuat_PhieuYeuCauChiTietID] Parameters: [@param0=[SOLUONGXUAT,1]]
2019-08-16 18:04:43,834 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLDaXuat_PhieuYeuCauChiTietID] Types: [@param0=[Decimal, System.Decimal]]
2019-08-16 18:04:43,862 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuatChiTiet] PreparedStatement : [INSERT INTO TT_INV_CHUNGTUXUATCHITIET(CHUNGTUXUAT_ID,MMYY,THEODOI_ID,SOLUONGYEUCAU,SOLUONGXUAT,THANHTIEN,GHICHU,PHIEUYEUCAUCHITIET_ID,TENNGUOITAO,BENHVIEN_ID,NGAYTAO,NGUOITAO_ID)       VALUES( @param0 , @param1 , @param2 , @param3 , @param4 , @param5 , @param6 , @param7 , @param8 , @param9 ,GETDATE(), @param10 )        SELECT SCOPE_IDENTITY()]
2019-08-16 18:04:43,862 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuatChiTiet] Parameters: [@param0=[CHUNGTUXUAT_ID,12], @param1=[MMYY,0819], @param2=[THEODOI_ID,80], @param3=[SOLUONGYEUCAU,10], @param4=[SOLUONGXUAT,10], @param5=[THANHTIEN,30000.0000], @param6=[CT_GHICHU,null], @param7=[PHIEUYEUCAUCHITIET_ID,65], @param8=[TENNGUOITAO,null], @param9=[BENHVIEN_ID,HLU01], @param10=[NGUOITAO_ID,null]]
2019-08-16 18:04:43,862 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuatChiTiet] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String], @param2=[Int32, System.Int32], @param3=[Double, System.Double], @param4=[Decimal, System.Decimal], @param5=[Decimal, System.Decimal], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[String, System.String], @param10=[System.DBNull, null]]
2019-08-16 18:04:43,894 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLDaXuat_PhieuYeuCauChiTietID] PreparedStatement : [UPDATE TT_INV_PHIEUYEUCAUCHITIET        SET SOLUONGDAXUAT= @param0         WHERE PHIEUYEUCAUCHITIET_ID = '65' AND BENHVIEN_ID = 'HLU01']
2019-08-16 18:04:43,894 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLDaXuat_PhieuYeuCauChiTietID] Parameters: [@param0=[SOLUONGXUAT,10]]
2019-08-16 18:04:43,894 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLDaXuat_PhieuYeuCauChiTietID] Types: [@param0=[Decimal, System.Decimal]]
2019-08-16 18:04:43,923 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLXuatTonKho] PreparedStatement : [UPDATE TT_INV_TONKHOCHITIET SET SOLUONGXUAT=0 WHERE MMYY='0819' AND MAKHO IN('KCVPP');        MERGE TT_INV_TONKHOCHITIET AS X USING        (SELECT QQ.MMYY, QQ.MAKHO,QQ.TENKHO,QQ.THEODOI_ID,SUM(QQ.SOLUONGXUAT) AS SOLUONGXUAT FROM (        SELECT '0819' AS MMYY, A.MAKHOXUAT AS MAKHO,A.TENKHOXUAT AS TENKHO,B.THEODOI_ID,B.SOLUONGXUAT,C.NGAYTAO,C.NGUOITAO_ID        FROM TT_INV_CHUNGTUXUAT A INNER JOIN TT_INV_CHUNGTUXUATCHITIET B ON A.CHUNGTUXUAT_ID=B.CHUNGTUXUAT_ID AND A.MMYY='0819'        INNER JOIN TT_INV_THEODOI C ON B.THEODOI_ID=C.THEODOI_ID        WHERE A.MMYY='0819' AND A.BENHVIEN_ID='HLU01' AND A.MAKHOXUAT IN('KCVPP')        UNION ALL        SELECT '0819' AS MMYY, A.MAKHO,A.TENKHO,B.THEODOI_ID,B.SOLUONG AS SOLUONGXUAT,C.NGAYTAO,C.NGUOITAO_ID        FROM TT_INV_CHUNGTUTANGGIAM A INNER JOIN TT_INV_CHUNGTUTANGGIAMCHITIET B ON A.CHUNGTUTANGGIAM_ID=B.CHUNGTUTANGGIAM_ID AND A.MMYY='0819' AND A.LOAI='giam'        INNER JOIN TT_INV_THEODOI C ON B.THEODOI_ID=C.THEODOI_ID        WHERE A.MMYY='0819' AND A.LOAI='giam' AND A.BENHVIEN_ID='HLU01' AND A.MAKHO IN('KCVPP')) QQ        GROUP BY QQ.MMYY, QQ.MAKHO,QQ.TENKHO,QQ.THEODOI_ID) AS Y        ON (X.MMYY=Y.MMYY AND X.MAKHO=Y.MAKHO AND X.THEODOI_ID=Y.THEODOI_ID)        WHEN MATCHED THEN UPDATE SET X.SOLUONGXUAT=Y.SOLUONGXUAT        WHEN NOT MATCHED THEN                INSERT (MMYY,MAKHO,TENKHO,THEODOI_ID,SOLUONGXUAT,BENHVIEN_ID,NGAYTAO,NGUOITAO_ID) VALUES        ('0819',Y.MAKHO,Y.TENKHO,Y.THEODOI_ID,Y.SOLUONGXUAT, @param0 ,GETDATE(), '');          UPDATE TT_INV_TONKHOTONGHOP SET SOLUONGTONDAU=0,SOLUONGNHAP=0,SOLUONGXUAT=0 WHERE MMYY='0819' AND MAKHO IN('KCVPP');        MERGE TT_INV_TONKHOTONGHOP AS X USING        (SELECT '0819' AS MMYY,A.MAKHO,A.TENKHO,B.HANGHOA_ID,B.MAHANGHOA,HH.TEN,SUM(A.SOLUONGTONDAU) AS SOLUONGTONDAU,SUM(A.SOLUONGNHAP) AS SOLUONGNHAP,SUM(A.SOLUONGXUAT) AS SOLUONGXUAT        FROM TT_INV_TONKHOCHITIET A INNER JOIN TT_INV_THEODOI B ON A.THEODOI_ID=B.THEODOI_ID AND A.MMYY='0819'        JOIN TM_PUR_HANGHOA HH on HH.ID = B.HANGHOA_ID        WHERE A.MMYY='0819' AND A.BENHVIEN_ID='HLU01' AND A.MAKHO IN('KCVPP')        GROUP BY A.MAKHO,A.TENKHO,B.HANGHOA_ID,B.MAHANGHOA,HH.TEN) AS Y        ON (X.MMYY=Y.MMYY AND X.MAKHO=Y.MAKHO AND X.HANGHOA_ID=Y.HANGHOA_ID)          WHEN MATCHED THEN UPDATE SET X.SOLUONGTONDAU=Y.SOLUONGTONDAU, X.SOLUONGNHAP=Y.SOLUONGNHAP,X.SOLUONGXUAT=Y.SOLUONGXUAT        WHEN NOT MATCHED THEN                INSERT (MMYY,MAKHO,TENKHO,HANGHOA_ID,MAHANGHOA,TENHANGHOA,SOLUONGTONDAU,SOLUONGNHAP,SOLUONGXUAT,BENHVIEN_ID,NGAYTAO)        VALUES ('0819',Y.MAKHO,Y.TENKHO,Y.HANGHOA_ID,Y.MAHANGHOA,Y.TEN,Y.SOLUONGTONDAU,Y.SOLUONGNHAP,Y.SOLUONGXUAT, @param0 ,GETDATE());          DELETE FROM TT_INV_TONKHOCHITIET WHERE SOLUONGTONDAU=0 AND SOLUONGNHAP=0 AND SOLUONGXUAT=0;        DELETE FROM TT_INV_TONKHOTONGHOP WHERE SOLUONGTONDAU=0 AND SOLUONGNHAP=0 AND SOLUONGXUAT=0;]
2019-08-16 18:04:43,923 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLXuatTonKho] Parameters: [@param0=[BENHVIEN_ID,HLU01]]
2019-08-16 18:04:43,923 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLXuatTonKho] Types: [@param0=[String, System.String]]
2019-08-16 18:04:43,970 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdateTrangThaiPO_NhapKho] PreparedStatement : [UPDATE TT_PUR_CHUNGTU SET STATE_CODE =  @param0 , STATE_NAME =  @param1  WHERE MACHUNGTU = 'YC50190530103214' AND PROCESS_CODE = 'PO']
2019-08-16 18:04:43,970 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdateTrangThaiPO_NhapKho] Parameters: [@param0=[STATE_CODE,9], @param1=[STATE_NAME,Đã xuất kho]]
2019-08-16 18:04:43,970 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdateTrangThaiPO_NhapKho] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2019-08-16 18:04:44,579 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatAll] PreparedStatement : [SELECT CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID,        CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        , CT.MUCDICHCHUNGTU_ID, CT.MUCDICHCHUNGTU_CODE        FROM TT_INV_CHUNGTUXUAT CT INNER JOIN TT_INV_CHUNGTUXUATCHITIET CTCT ON CT.CHUNGTUXUAT_ID=CTCT.CHUNGTUXUAT_ID               INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID      where CT.BENHVIEN_ID = 'HLU01' AND CT.MACHUNGTU = 'X21190816180436'             ORDER BY TD.TENHANGHOA]
2019-08-16 18:04:44,628 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 18:05:00,878 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 18:05:03,491 [1] DEBUG - Statement Id: [DAO00401_INV001_GetPhieuYeuCauChiTiet_PhieuYeuCauID] PreparedStatement : [select YCCT.PHIEUYEUCAUCHITIET_ID,YCCT.HANGHOA_ID,YCCT.MAHANGHOA,YCCT.TENHANGHOA,YCCT.DONVITINH_ID,YCCT.TENDONVITINH,YCCT.SOLUONGYEUCAU,YCCT.SOLUONGDAXUAT        FROM TT_INV_PHIEUYEUCAUCHITIET YCCT        WHERE YCCT.BENHVIEN_ID = 'HLU01' AND YCCT.PHIEUYEUCAU_ID='23']
2019-08-16 18:05:03,527 [1] DEBUG - Statement Id: [DAO00401_INV001_PhieuYeuCauSearch] PreparedStatement : [select YC.PHIEUYEUCAU_ID,YC.MAPHIEUYEUCAU,YC.MMYY,YC.NGAYLAP,YC.PHONGBAN_ID,YC.TENPHONGBAN,YC.MAKHOXUAT,YC.TENKHOXUAT,YC.GHICHU,YC.TENNGUOITAO,YC.TENNGUOICAPNHAT,YC.BENHVIEN_ID,YC.NGAYTAO,YC.NGUOITAO_ID,YC.NGAYCAPNHAT,YC.NGUOICAPNHAT_ID        FROM TT_INV_PHIEUYEUCAU YC        WHERE YC.BENHVIEN_ID = 'HLU01' AND YC.NGAYLAP BETWEEN '7/16/2019 6:05:03 PM' AND '8/16/2019 6:05:03 PM'         AND           YC.CHUNGTUXUAT_ID IS NULL         AND           YC.MAKHOXUAT = 'KCVPP']
2019-08-16 18:05:08,621 [1] DEBUG - Statement Id: [DAO00401_INV001_PhieuYeuCauSearch] PreparedStatement : [select YC.PHIEUYEUCAU_ID,YC.MAPHIEUYEUCAU,YC.MMYY,YC.NGAYLAP,YC.PHONGBAN_ID,YC.TENPHONGBAN,YC.MAKHOXUAT,YC.TENKHOXUAT,YC.GHICHU,YC.TENNGUOITAO,YC.TENNGUOICAPNHAT,YC.BENHVIEN_ID,YC.NGAYTAO,YC.NGUOITAO_ID,YC.NGAYCAPNHAT,YC.NGUOICAPNHAT_ID        FROM TT_INV_PHIEUYEUCAU YC        WHERE YC.BENHVIEN_ID = 'HLU01' AND YC.NGAYLAP BETWEEN '4/1/2019 12:00:00 AM' AND '8/16/2019 6:05:03 PM'         AND           YC.CHUNGTUXUAT_ID IS NULL         AND           YC.MAKHOXUAT = 'KCVPP']
2019-08-16 18:05:09,356 [1] DEBUG - Statement Id: [DAO00401_INV001_GetPhieuYeuCauChiTiet_PhieuYeuCauID] PreparedStatement : [select YCCT.PHIEUYEUCAUCHITIET_ID,YCCT.HANGHOA_ID,YCCT.MAHANGHOA,YCCT.TENHANGHOA,YCCT.DONVITINH_ID,YCCT.TENDONVITINH,YCCT.SOLUONGYEUCAU,YCCT.SOLUONGDAXUAT        FROM TT_INV_PHIEUYEUCAUCHITIET YCCT        WHERE YCCT.BENHVIEN_ID = 'HLU01' AND YCCT.PHIEUYEUCAU_ID='29']
2019-08-16 18:05:09,664 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChiTietYC_MaPhieuYeuCau] PreparedStatement : [select YC.PHIEUYEUCAU_ID,YC.MAPHIEUYEUCAU,YC.MMYY,YC.NGAYLAP,YC.PHONGBAN_ID AS PHONGBANNHAN_ID,YC.TENPHONGBAN AS TENPHONGBANNHAN,YC.MAKHOXUAT,YC.TENKHOXUAT,        YCCT.PHIEUYEUCAUCHITIET_ID,YCCT.HANGHOA_ID,YCCT.MAHANGHOA,YCCT.TENHANGHOA,YCCT.DONVITINH_ID,YCCT.TENDONVITINH,YCCT.SOLUONGYEUCAU,YCCT.SOLUONGYEUCAU AS SOLUONGXUAT, NULL AS DONGIA,NULL AS LOSX,NULL AS HANDUNG,        TKTH.SOLUONGTONCUOI        FROM TT_INV_PHIEUYEUCAU YC INNER JOIN TT_INV_PHIEUYEUCAUCHITIET YCCT ON YC.PHIEUYEUCAU_ID=YCCT.PHIEUYEUCAU_ID        LEFT JOIN (SELECT (SOLUONGTONDAU+SOLUONGNHAP-SOLUONGXUAT) AS SOLUONGTONCUOI, HANGHOA_ID,MAKHO        FROM TT_INV_TONKHOTONGHOP WHERE BENHVIEN_ID='HLU01' AND MMYY='0819'        ) TKTH ON YCCT.HANGHOA_ID = TKTH.HANGHOA_ID AND YC.MAKHOXUAT = TKTH.MAKHO        WHERE YC.MAPHIEUYEUCAU='YC2190530105709' AND YC.BENHVIEN_ID = 'HLU01']
2019-08-16 18:05:12,086 [1] DEBUG - Statement Id: [DAO00401_INV001_GetPhieuYeuCauChiTiet_PhieuYeuCauID] PreparedStatement : [select YCCT.PHIEUYEUCAUCHITIET_ID,YCCT.HANGHOA_ID,YCCT.MAHANGHOA,YCCT.TENHANGHOA,YCCT.DONVITINH_ID,YCCT.TENDONVITINH,YCCT.SOLUONGYEUCAU,YCCT.SOLUONGDAXUAT        FROM TT_INV_PHIEUYEUCAUCHITIET YCCT        WHERE YCCT.BENHVIEN_ID = 'HLU01' AND YCCT.PHIEUYEUCAU_ID='23']
2019-08-16 18:05:12,120 [1] DEBUG - Statement Id: [DAO00401_INV001_PhieuYeuCauSearch] PreparedStatement : [select YC.PHIEUYEUCAU_ID,YC.MAPHIEUYEUCAU,YC.MMYY,YC.NGAYLAP,YC.PHONGBAN_ID,YC.TENPHONGBAN,YC.MAKHOXUAT,YC.TENKHOXUAT,YC.GHICHU,YC.TENNGUOITAO,YC.TENNGUOICAPNHAT,YC.BENHVIEN_ID,YC.NGAYTAO,YC.NGUOITAO_ID,YC.NGAYCAPNHAT,YC.NGUOICAPNHAT_ID        FROM TT_INV_PHIEUYEUCAU YC        WHERE YC.BENHVIEN_ID = 'HLU01' AND YC.NGAYLAP BETWEEN '7/16/2019 6:05:12 PM' AND '8/16/2019 6:05:12 PM'         AND           YC.CHUNGTUXUAT_ID IS NULL         AND           YC.MAKHOXUAT = 'KCVPP']
2019-08-16 18:05:16,972 [1] DEBUG - Statement Id: [DAO00401_INV001_PhieuYeuCauSearch] PreparedStatement : [select YC.PHIEUYEUCAU_ID,YC.MAPHIEUYEUCAU,YC.MMYY,YC.NGAYLAP,YC.PHONGBAN_ID,YC.TENPHONGBAN,YC.MAKHOXUAT,YC.TENKHOXUAT,YC.GHICHU,YC.TENNGUOITAO,YC.TENNGUOICAPNHAT,YC.BENHVIEN_ID,YC.NGAYTAO,YC.NGUOITAO_ID,YC.NGAYCAPNHAT,YC.NGUOICAPNHAT_ID        FROM TT_INV_PHIEUYEUCAU YC        WHERE YC.BENHVIEN_ID = 'HLU01' AND YC.NGAYLAP BETWEEN '5/1/2019 12:00:00 AM' AND '8/16/2019 6:05:12 PM'         AND           YC.CHUNGTUXUAT_ID IS NULL         AND           YC.MAKHOXUAT = 'KCVPP']
2019-08-16 18:05:18,022 [1] DEBUG - Statement Id: [DAO00401_INV001_GetPhieuYeuCauChiTiet_PhieuYeuCauID] PreparedStatement : [select YCCT.PHIEUYEUCAUCHITIET_ID,YCCT.HANGHOA_ID,YCCT.MAHANGHOA,YCCT.TENHANGHOA,YCCT.DONVITINH_ID,YCCT.TENDONVITINH,YCCT.SOLUONGYEUCAU,YCCT.SOLUONGDAXUAT        FROM TT_INV_PHIEUYEUCAUCHITIET YCCT        WHERE YCCT.BENHVIEN_ID = 'HLU01' AND YCCT.PHIEUYEUCAU_ID='23']
2019-08-16 18:05:18,663 [1] DEBUG - Statement Id: [DAO00401_INV001_GetPhieuYeuCauChiTiet_PhieuYeuCauID] PreparedStatement : [select YCCT.PHIEUYEUCAUCHITIET_ID,YCCT.HANGHOA_ID,YCCT.MAHANGHOA,YCCT.TENHANGHOA,YCCT.DONVITINH_ID,YCCT.TENDONVITINH,YCCT.SOLUONGYEUCAU,YCCT.SOLUONGDAXUAT        FROM TT_INV_PHIEUYEUCAUCHITIET YCCT        WHERE YCCT.BENHVIEN_ID = 'HLU01' AND YCCT.PHIEUYEUCAU_ID='29']
2019-08-16 18:05:19,646 [1] DEBUG - Statement Id: [DAO00401_INV001_GetPhieuYeuCauChiTiet_PhieuYeuCauID] PreparedStatement : [select YCCT.PHIEUYEUCAUCHITIET_ID,YCCT.HANGHOA_ID,YCCT.MAHANGHOA,YCCT.TENHANGHOA,YCCT.DONVITINH_ID,YCCT.TENDONVITINH,YCCT.SOLUONGYEUCAU,YCCT.SOLUONGDAXUAT        FROM TT_INV_PHIEUYEUCAUCHITIET YCCT        WHERE YCCT.BENHVIEN_ID = 'HLU01' AND YCCT.PHIEUYEUCAU_ID='30']
2019-08-16 18:05:20,543 [1] DEBUG - Statement Id: [DAO00401_INV001_GetPhieuYeuCauChiTiet_PhieuYeuCauID] PreparedStatement : [select YCCT.PHIEUYEUCAUCHITIET_ID,YCCT.HANGHOA_ID,YCCT.MAHANGHOA,YCCT.TENHANGHOA,YCCT.DONVITINH_ID,YCCT.TENDONVITINH,YCCT.SOLUONGYEUCAU,YCCT.SOLUONGDAXUAT        FROM TT_INV_PHIEUYEUCAUCHITIET YCCT        WHERE YCCT.BENHVIEN_ID = 'HLU01' AND YCCT.PHIEUYEUCAU_ID='32']
2019-08-16 18:05:22,437 [1] DEBUG - Statement Id: [DAO00401_INV001_GetPhieuYeuCauChiTiet_PhieuYeuCauID] PreparedStatement : [select YCCT.PHIEUYEUCAUCHITIET_ID,YCCT.HANGHOA_ID,YCCT.MAHANGHOA,YCCT.TENHANGHOA,YCCT.DONVITINH_ID,YCCT.TENDONVITINH,YCCT.SOLUONGYEUCAU,YCCT.SOLUONGDAXUAT        FROM TT_INV_PHIEUYEUCAUCHITIET YCCT        WHERE YCCT.BENHVIEN_ID = 'HLU01' AND YCCT.PHIEUYEUCAU_ID='35']
2019-08-16 18:05:23,552 [1] DEBUG - Statement Id: [DAO00401_INV001_GetPhieuYeuCauChiTiet_PhieuYeuCauID] PreparedStatement : [select YCCT.PHIEUYEUCAUCHITIET_ID,YCCT.HANGHOA_ID,YCCT.MAHANGHOA,YCCT.TENHANGHOA,YCCT.DONVITINH_ID,YCCT.TENDONVITINH,YCCT.SOLUONGYEUCAU,YCCT.SOLUONGDAXUAT        FROM TT_INV_PHIEUYEUCAUCHITIET YCCT        WHERE YCCT.BENHVIEN_ID = 'HLU01' AND YCCT.PHIEUYEUCAU_ID='38']
2019-08-16 18:05:24,701 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChiTietYC_MaPhieuYeuCau] PreparedStatement : [select YC.PHIEUYEUCAU_ID,YC.MAPHIEUYEUCAU,YC.MMYY,YC.NGAYLAP,YC.PHONGBAN_ID AS PHONGBANNHAN_ID,YC.TENPHONGBAN AS TENPHONGBANNHAN,YC.MAKHOXUAT,YC.TENKHOXUAT,        YCCT.PHIEUYEUCAUCHITIET_ID,YCCT.HANGHOA_ID,YCCT.MAHANGHOA,YCCT.TENHANGHOA,YCCT.DONVITINH_ID,YCCT.TENDONVITINH,YCCT.SOLUONGYEUCAU,YCCT.SOLUONGYEUCAU AS SOLUONGXUAT, NULL AS DONGIA,NULL AS LOSX,NULL AS HANDUNG,        TKTH.SOLUONGTONCUOI        FROM TT_INV_PHIEUYEUCAU YC INNER JOIN TT_INV_PHIEUYEUCAUCHITIET YCCT ON YC.PHIEUYEUCAU_ID=YCCT.PHIEUYEUCAU_ID        LEFT JOIN (SELECT (SOLUONGTONDAU+SOLUONGNHAP-SOLUONGXUAT) AS SOLUONGTONCUOI, HANGHOA_ID,MAKHO        FROM TT_INV_TONKHOTONGHOP WHERE BENHVIEN_ID='HLU01' AND MMYY='0819'        ) TKTH ON YCCT.HANGHOA_ID = TKTH.HANGHOA_ID AND YC.MAKHOXUAT = TKTH.MAKHO        WHERE YC.MAPHIEUYEUCAU='YC53190604080935' AND YC.BENHVIEN_ID = 'HLU01']
2019-08-16 18:05:33,051 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 18:05:33,086 [1] DEBUG - Statement Id: [DAO00401_INV001_GetTonKho] PreparedStatement : [SELECT TKTH.HANGHOA_ID,TKTH.MAHANGHOA,TKTH.TENHANGHOA,HH.DONVITINH_ID,HH.TENDONVITINH,SUM(TKTH.SOLUONGTONDAU+TKTH.SOLUONGNHAP-TKTH.SOLUONGXUAT) AS SOLUONGTONCUOI        FROM TM_PUR_HANGHOA HH INNER JOIN TT_INV_TONKHOTONGHOP TKTH ON HH.ID = TKTH.HANGHOA_ID        where TKTH.BENHVIEN_ID = 'HLU01' AND TKTH.MAKHO = 'KCVPP' AND TKTH.MMYY='0819'        GROUP BY TKTH.HANGHOA_ID,TKTH.MAHANGHOA,TKTH.TENHANGHOA,HH.DONVITINH_ID,HH.TENDONVITINH]
--------------------------------------------------------------------------------
2019-08-16 18:07:27,136 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2019-08-16 18:07:27,382 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-08-16 18:07:27,421 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-08-16 18:07:27,789 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 18:07:28,017 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-08-16 18:07:33,193 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2019-08-16 18:07:33,220 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-08-16 18:07:34,906 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-08-16 18:07:34,988 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-08-16 18:07:35,765 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2019-08-16 18:07:35,908 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2019-08-16 18:07:35,981 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2019-08-16 18:07:36,052 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2019-08-16 18:07:36,124 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2019-08-16 18:07:36,199 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2019-08-16 18:07:36,266 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2019-08-16 18:07:36,335 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2019-08-16 18:07:36,405 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2019-08-16 18:07:36,905 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2019-08-16 18:07:36,938 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2019-08-16 18:07:37,011 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2019-08-16 18:07:37,043 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2019-08-16 18:07:37,761 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2019-08-16 18:07:37,799 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 0 as PHAMVI_ID, 0 as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0         end                else        begin        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2019-08-16 18:07:39,782 [5] DEBUG - Statement Id: [DAO00320_GetList] PreparedStatement : [select M.*            from TM_MAU M            LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID            where            M.TAMNGUNG = '0'            and M.BENHVIEN_ID = 'HLU01'            order by M.TENMAU]
2019-08-16 18:07:39,843 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2019-08-16 18:07:39,875 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT          TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,          TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,          SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH          FROM TT_MAU_TONKHO TK          JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID          JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID          JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'          LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID          LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID          WHERE TK.SOLUONG > 0          GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,          TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2019-08-16 18:07:39,948 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2019-08-16 18:07:39,981 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct          TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,          TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,          TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH          from TM_MAU M          JOIN          (          select          A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO          from          (          select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO          from TT_MAU_TONKHO TK          JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID          inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID          left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'          where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0          ) A          )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'          LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID          LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2019-08-16 18:07:40,061 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2019-08-16 18:07:40,989 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 18:07:41,900 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2019-08-16 18:07:46,487 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2019-08-16 18:07:46,515 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2019-08-16 18:07:46,589 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 18:07:46,705 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 18:07:46,837 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2019-08-16 18:07:46,839 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-08-16 18:07:46,839 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-08-16 18:07:46,867 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2019-08-16 18:07:46,868 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-08-16 18:07:46,868 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-08-16 18:07:46,983 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 18:07:47,126 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 18:07:54,540 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 18:07:54,624 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2019-08-16 18:07:54,860 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2019-08-16 18:08:03,518 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'STA06'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 18:08:03,839 [1] DEBUG - Statement Id: [DAO00401_INV001_GetDMNhanVien] PreparedStatement : [SELECT NHANVIEN_ID,TENNHANVIEN,NHANVIEN_ID AS NHANVIENNHAN_ID,TENNHANVIEN AS TENNHANVIENNHAN FROM [TM_NHANVIEN]        where BENHVIEN_ID = 'HLU01'        ORDER BY TENNHANVIEN]
2019-08-16 18:08:04,224 [1] DEBUG - Statement Id: [DAO00401_INV001_GetDMKHOVPP] PreparedStatement : [Select K.*,BB.SODU,BB.SODUDENNGAY,BB.KHOASO,BB.NGAYKHOA  From TM_KHO K        LEFT JOIN TM_INV_KHO BB ON K.MAKHO = BB.MAKHO        LEFT JOIN LST_DICTIONARY AA ON AA.DICTIONARY_ID = K.MODULE_ID        WHERE AA.DICTIONARY_CODE = 'KhoVPP']
2019-08-16 18:08:04,418 [1] DEBUG - Statement Id: [DAO00401_GetListMucDichChungTu] PreparedStatement : [SELECT DICTIONARY_ID, DICTIONARY_CODE, DICTIONARY_NAME        FROM LST_DICTIONARY        WHERE DICTIONARY_TYPE_CODE = 'VPP_MucDichChungTu'        AND ENABLED = '1']
2019-08-16 18:08:05,303 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 18:08:07,321 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'STA05'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 18:08:07,790 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM98'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 18:08:08,315 [1] DEBUG - Statement Id: [DAO00401_INV001_PhieuYeuCauSearch] PreparedStatement : [select YC.PHIEUYEUCAU_ID,YC.MAPHIEUYEUCAU,YC.MMYY,YC.NGAYLAP,YC.PHONGBAN_ID,YC.TENPHONGBAN,YC.MAKHOXUAT,YC.TENKHOXUAT,YC.GHICHU,YC.TENNGUOITAO,YC.TENNGUOICAPNHAT,YC.BENHVIEN_ID,YC.NGAYTAO,YC.NGUOITAO_ID,YC.NGAYCAPNHAT,YC.NGUOICAPNHAT_ID        FROM TT_INV_PHIEUYEUCAU YC        WHERE YC.BENHVIEN_ID = 'HLU01' AND YC.NGAYLAP BETWEEN '7/16/2019 6:08:08 PM' AND '8/16/2019 6:08:08 PM'         AND           YC.CHUNGTUXUAT_ID IS NULL         AND           YC.MAKHOXUAT = 'KCVPP']
2019-08-16 18:08:13,509 [1] DEBUG - Statement Id: [DAO00401_INV001_PhieuYeuCauSearch] PreparedStatement : [select YC.PHIEUYEUCAU_ID,YC.MAPHIEUYEUCAU,YC.MMYY,YC.NGAYLAP,YC.PHONGBAN_ID,YC.TENPHONGBAN,YC.MAKHOXUAT,YC.TENKHOXUAT,YC.GHICHU,YC.TENNGUOITAO,YC.TENNGUOICAPNHAT,YC.BENHVIEN_ID,YC.NGAYTAO,YC.NGUOITAO_ID,YC.NGAYCAPNHAT,YC.NGUOICAPNHAT_ID        FROM TT_INV_PHIEUYEUCAU YC        WHERE YC.BENHVIEN_ID = 'HLU01' AND YC.NGAYLAP BETWEEN '5/1/2019 12:00:00 AM' AND '8/16/2019 6:08:08 PM'         AND           YC.CHUNGTUXUAT_ID IS NULL         AND           YC.MAKHOXUAT = 'KCVPP']
2019-08-16 18:08:14,570 [1] DEBUG - Statement Id: [DAO00401_INV001_GetPhieuYeuCauChiTiet_PhieuYeuCauID] PreparedStatement : [select YCCT.PHIEUYEUCAUCHITIET_ID,YCCT.HANGHOA_ID,YCCT.MAHANGHOA,YCCT.TENHANGHOA,YCCT.DONVITINH_ID,YCCT.TENDONVITINH,YCCT.SOLUONGYEUCAU,YCCT.SOLUONGDAXUAT        FROM TT_INV_PHIEUYEUCAUCHITIET YCCT        WHERE YCCT.BENHVIEN_ID = 'HLU01' AND YCCT.PHIEUYEUCAU_ID='35']
2019-08-16 18:08:15,174 [1] DEBUG - Statement Id: [DAO00401_INV001_GetPhieuYeuCauChiTiet_PhieuYeuCauID] PreparedStatement : [select YCCT.PHIEUYEUCAUCHITIET_ID,YCCT.HANGHOA_ID,YCCT.MAHANGHOA,YCCT.TENHANGHOA,YCCT.DONVITINH_ID,YCCT.TENDONVITINH,YCCT.SOLUONGYEUCAU,YCCT.SOLUONGDAXUAT        FROM TT_INV_PHIEUYEUCAUCHITIET YCCT        WHERE YCCT.BENHVIEN_ID = 'HLU01' AND YCCT.PHIEUYEUCAU_ID='32']
2019-08-16 18:08:16,645 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChiTietYC_MaPhieuYeuCau] PreparedStatement : [select YC.PHIEUYEUCAU_ID,YC.MAPHIEUYEUCAU,YC.MMYY,YC.NGAYLAP,YC.PHONGBAN_ID AS PHONGBANNHAN_ID,YC.TENPHONGBAN AS TENPHONGBANNHAN,YC.MAKHOXUAT,YC.TENKHOXUAT,        YCCT.PHIEUYEUCAUCHITIET_ID,YCCT.HANGHOA_ID,YCCT.MAHANGHOA,YCCT.TENHANGHOA,YCCT.DONVITINH_ID,YCCT.TENDONVITINH,YCCT.SOLUONGYEUCAU,YCCT.SOLUONGYEUCAU AS SOLUONGXUAT, NULL AS DONGIA,NULL AS LOSX,NULL AS HANDUNG,        TKTH.SOLUONGTONCUOI        FROM TT_INV_PHIEUYEUCAU YC INNER JOIN TT_INV_PHIEUYEUCAUCHITIET YCCT ON YC.PHIEUYEUCAU_ID=YCCT.PHIEUYEUCAU_ID        LEFT JOIN (SELECT (SOLUONGTONDAU+SOLUONGNHAP-SOLUONGXUAT) AS SOLUONGTONCUOI, HANGHOA_ID,MAKHO        FROM TT_INV_TONKHOTONGHOP WHERE BENHVIEN_ID='HLU01' AND MMYY='0819'        ) TKTH ON YCCT.HANGHOA_ID = TKTH.HANGHOA_ID AND YC.MAKHOXUAT = TKTH.MAKHO        WHERE YC.MAPHIEUYEUCAU='YC5190531102725' AND YC.BENHVIEN_ID = 'HLU01']
2019-08-16 18:08:26,673 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 18:08:40,908 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 18:08:40,950 [1] DEBUG - Statement Id: [DAO00401_INV001_GetTonKho] PreparedStatement : [SELECT TKTH.HANGHOA_ID,TKTH.MAHANGHOA,TKTH.TENHANGHOA,HH.DONVITINH_ID,HH.TENDONVITINH,SUM(TKTH.SOLUONGTONDAU+TKTH.SOLUONGNHAP-TKTH.SOLUONGXUAT) AS SOLUONGTONCUOI        FROM TM_PUR_HANGHOA HH INNER JOIN TT_INV_TONKHOTONGHOP TKTH ON HH.ID = TKTH.HANGHOA_ID        where TKTH.BENHVIEN_ID = 'HLU01' AND TKTH.MAKHO = 'KCVPP' AND TKTH.MMYY='0819'        GROUP BY TKTH.HANGHOA_ID,TKTH.MAHANGHOA,TKTH.TENHANGHOA,HH.DONVITINH_ID,HH.TENDONVITINH]
2019-08-16 18:08:42,234 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraMaChungTuXuatTonTai] PreparedStatement : [select CT.IDCHUYEN        FROM TT_INV_CHUNGTUXUAT CT        where CT.MACHUNGTU = 'X07190816180842' AND CT.BENHVIEN_ID = 'HLU01'         AND         CT.MMYY IN(0819)]
2019-08-16 18:08:43,183 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuat] PreparedStatement : [INSERT INTO TT_INV_CHUNGTUXUAT      (MACHUNGTU,MMYY,NGAYCHUNGTU,MAKHOXUAT,TENKHOXUAT,PHONGBANNHAN_ID,TENPHONGBANNHAN,NHANVIENNHAN_ID,TENNHANVIENNHAN,GHICHU,PHIEUYEUCAU_ID,MAPHIEUYEUCAU,XUATKHOTHEO,TENNGUOITAO,BENHVIEN_ID,NGAYTAO,NGUOITAO_ID                , MUCDICHCHUNGTU_ID                , MUCDICHCHUNGTU_CODE             )      VALUES ( @param0 , @param1 , @param2 , @param3 , @param4 , @param5 , @param6 , @param7 , @param8 , @param9 , @param10 , @param11 , @param12 , @param13 , @param14 ,GETDATE(), @param15                 ,  @param16                 ,  @param17              )      SELECT SCOPE_IDENTITY()]
2019-08-16 18:08:43,183 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuat] Parameters: [@param0=[MACHUNGTU,X07190816180842], @param1=[MMYY,0819], @param2=[NGAYCHUNGTU,8/16/2019 6:08:16 PM], @param3=[MAKHOXUAT,KCVPP], @param4=[TENKHOXUAT,Kho chính VPP], @param5=[PHONGBANNHAN_ID,5], @param6=[TENPHONGBANNHAN,Khoa Nội Tiêu hóa -Hô hấp- Nội tiết], @param7=[NHANVIENNHAN_ID,509], @param8=[TENNHANVIENNHAN,Bùi Khánh Linh], @param9=[GHICHU,zcsdf], @param10=[PHIEUYEUCAU_ID,32], @param11=[MAPHIEUYEUCAU,YC5190531102725], @param12=[XUATKHOTHEO,Hạn dùng], @param13=[TENNGUOITAO,Administrator], @param14=[BENHVIEN_ID,HLU01], @param15=[NGUOITAO_ID,1], @param16=[MUCDICHCHUNGTU_ID,6994], @param17=[MUCDICHCHUNGTU_CODE,X07]]
2019-08-16 18:08:43,183 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuat] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[DateTime, System.DateTime], @param3=[String, System.String], @param4=[String, System.String], @param5=[Int64, System.Int64], @param6=[String, System.String], @param7=[Int64, System.Int64], @param8=[String, System.String], @param9=[String, System.String], @param10=[Int64, System.Int64], @param11=[String, System.String], @param12=[String, System.String], @param13=[String, System.String], @param14=[String, System.String], @param15=[Int64, System.Int64], @param16=[Int64, System.Int64], @param17=[String, System.String]]
2019-08-16 18:08:44,115 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdChungTuXuatID_PhieuYeuCau] PreparedStatement : [UPDATE TT_INV_PHIEUYEUCAU SET CHUNGTUXUAT_ID =  @param0  WHERE PHIEUYEUCAU_ID = '32' AND BENHVIEN_ID = 'HLU01']
2019-08-16 18:08:44,115 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdChungTuXuatID_PhieuYeuCau] Parameters: [@param0=[CHUNGTUXUAT_ID,13]]
2019-08-16 18:08:44,115 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdChungTuXuatID_PhieuYeuCau] Types: [@param0=[Int64, System.Int64]]
2019-08-16 18:08:44,147 [1] DEBUG - Statement Id: [DAO00401_INV001_GetTonKhoChiTiet] PreparedStatement : [SELECT TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.DONGIA AS DONGIATRUOCVAT,TD.DONGIASAUVAT AS DONGIA,CASE WHEN TD.HANDUNG IS NULL THEN DATEADD(YEAR,999, GETDATE()) ELSE TD.HANDUNG END AS HANDUNG ,TD.NGAYTAO,        SUM(TKCT.SOLUONGTONDAU+TKCT.SOLUONGNHAP-TKCT.SOLUONGXUAT) AS SOLUONGTONCUOI        FROM TM_PUR_HANGHOA HH INNER JOIN TT_INV_THEODOI TD ON HH.ID = TD.HANGHOA_ID        INNER JOIN TT_INV_TONKHOCHITIET TKCT ON TD.THEODOI_ID = TKCT.THEODOI_ID        where TKCT.BENHVIEN_ID = 'HLU01' AND TKCT.MAKHO = 'KCVPP' AND TKCT.MMYY='0819'        GROUP BY TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.DONGIA,TD.DONGIASAUVAT,TD.HANDUNG,TD.NGAYTAO        ORDER BY TD.NGAYTAO]
2019-08-16 18:08:44,186 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuatChiTiet] PreparedStatement : [INSERT INTO TT_INV_CHUNGTUXUATCHITIET(CHUNGTUXUAT_ID,MMYY,THEODOI_ID,SOLUONGYEUCAU,SOLUONGXUAT,THANHTIEN,GHICHU,PHIEUYEUCAUCHITIET_ID,TENNGUOITAO,BENHVIEN_ID,NGAYTAO,NGUOITAO_ID)       VALUES( @param0 , @param1 , @param2 , @param3 , @param4 , @param5 , @param6 , @param7 , @param8 , @param9 ,GETDATE(), @param10 )        SELECT SCOPE_IDENTITY()]
2019-08-16 18:08:44,186 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuatChiTiet] Parameters: [@param0=[CHUNGTUXUAT_ID,13], @param1=[MMYY,0819], @param2=[THEODOI_ID,993], @param3=[SOLUONGYEUCAU,200], @param4=[SOLUONGXUAT,200], @param5=[THANHTIEN,0.0000], @param6=[CT_GHICHU,null], @param7=[PHIEUYEUCAUCHITIET_ID,123], @param8=[TENNGUOITAO,null], @param9=[BENHVIEN_ID,HLU01], @param10=[NGUOITAO_ID,null]]
2019-08-16 18:08:44,187 [1] DEBUG - Statement Id: [DAO00401_INV001_AddChungTuXuatChiTiet] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String], @param2=[Int32, System.Int32], @param3=[Double, System.Double], @param4=[Decimal, System.Decimal], @param5=[Decimal, System.Decimal], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[System.DBNull, null], @param9=[String, System.String], @param10=[System.DBNull, null]]
2019-08-16 18:08:44,233 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLDaXuat_PhieuYeuCauChiTietID] PreparedStatement : [UPDATE TT_INV_PHIEUYEUCAUCHITIET        SET SOLUONGDAXUAT= @param0         WHERE PHIEUYEUCAUCHITIET_ID = '123' AND BENHVIEN_ID = 'HLU01']
2019-08-16 18:08:44,233 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLDaXuat_PhieuYeuCauChiTietID] Parameters: [@param0=[SOLUONGXUAT,200]]
2019-08-16 18:08:44,233 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLDaXuat_PhieuYeuCauChiTietID] Types: [@param0=[Decimal, System.Decimal]]
2019-08-16 18:08:44,262 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLXuatTonKho] PreparedStatement : [UPDATE TT_INV_TONKHOCHITIET SET SOLUONGXUAT=0 WHERE MMYY='0819' AND MAKHO IN('KCVPP');        MERGE TT_INV_TONKHOCHITIET AS X USING        (SELECT QQ.MMYY, QQ.MAKHO,QQ.TENKHO,QQ.THEODOI_ID,SUM(QQ.SOLUONGXUAT) AS SOLUONGXUAT FROM (        SELECT '0819' AS MMYY, A.MAKHOXUAT AS MAKHO,A.TENKHOXUAT AS TENKHO,B.THEODOI_ID,B.SOLUONGXUAT,C.NGAYTAO,C.NGUOITAO_ID        FROM TT_INV_CHUNGTUXUAT A INNER JOIN TT_INV_CHUNGTUXUATCHITIET B ON A.CHUNGTUXUAT_ID=B.CHUNGTUXUAT_ID AND A.MMYY='0819'        INNER JOIN TT_INV_THEODOI C ON B.THEODOI_ID=C.THEODOI_ID        WHERE A.MMYY='0819' AND A.BENHVIEN_ID='HLU01' AND A.MAKHOXUAT IN('KCVPP')        UNION ALL        SELECT '0819' AS MMYY, A.MAKHO,A.TENKHO,B.THEODOI_ID,B.SOLUONG AS SOLUONGXUAT,C.NGAYTAO,C.NGUOITAO_ID        FROM TT_INV_CHUNGTUTANGGIAM A INNER JOIN TT_INV_CHUNGTUTANGGIAMCHITIET B ON A.CHUNGTUTANGGIAM_ID=B.CHUNGTUTANGGIAM_ID AND A.MMYY='0819' AND A.LOAI='giam'        INNER JOIN TT_INV_THEODOI C ON B.THEODOI_ID=C.THEODOI_ID        WHERE A.MMYY='0819' AND A.LOAI='giam' AND A.BENHVIEN_ID='HLU01' AND A.MAKHO IN('KCVPP')) QQ        GROUP BY QQ.MMYY, QQ.MAKHO,QQ.TENKHO,QQ.THEODOI_ID) AS Y        ON (X.MMYY=Y.MMYY AND X.MAKHO=Y.MAKHO AND X.THEODOI_ID=Y.THEODOI_ID)        WHEN MATCHED THEN UPDATE SET X.SOLUONGXUAT=Y.SOLUONGXUAT        WHEN NOT MATCHED THEN                INSERT (MMYY,MAKHO,TENKHO,THEODOI_ID,SOLUONGXUAT,BENHVIEN_ID,NGAYTAO,NGUOITAO_ID) VALUES        ('0819',Y.MAKHO,Y.TENKHO,Y.THEODOI_ID,Y.SOLUONGXUAT, @param0 ,GETDATE(), '');          UPDATE TT_INV_TONKHOTONGHOP SET SOLUONGTONDAU=0,SOLUONGNHAP=0,SOLUONGXUAT=0 WHERE MMYY='0819' AND MAKHO IN('KCVPP');        MERGE TT_INV_TONKHOTONGHOP AS X USING        (SELECT '0819' AS MMYY,A.MAKHO,A.TENKHO,B.HANGHOA_ID,B.MAHANGHOA,HH.TEN,SUM(A.SOLUONGTONDAU) AS SOLUONGTONDAU,SUM(A.SOLUONGNHAP) AS SOLUONGNHAP,SUM(A.SOLUONGXUAT) AS SOLUONGXUAT        FROM TT_INV_TONKHOCHITIET A INNER JOIN TT_INV_THEODOI B ON A.THEODOI_ID=B.THEODOI_ID AND A.MMYY='0819'        JOIN TM_PUR_HANGHOA HH on HH.ID = B.HANGHOA_ID        WHERE A.MMYY='0819' AND A.BENHVIEN_ID='HLU01' AND A.MAKHO IN('KCVPP')        GROUP BY A.MAKHO,A.TENKHO,B.HANGHOA_ID,B.MAHANGHOA,HH.TEN) AS Y        ON (X.MMYY=Y.MMYY AND X.MAKHO=Y.MAKHO AND X.HANGHOA_ID=Y.HANGHOA_ID)          WHEN MATCHED THEN UPDATE SET X.SOLUONGTONDAU=Y.SOLUONGTONDAU, X.SOLUONGNHAP=Y.SOLUONGNHAP,X.SOLUONGXUAT=Y.SOLUONGXUAT        WHEN NOT MATCHED THEN                INSERT (MMYY,MAKHO,TENKHO,HANGHOA_ID,MAHANGHOA,TENHANGHOA,SOLUONGTONDAU,SOLUONGNHAP,SOLUONGXUAT,BENHVIEN_ID,NGAYTAO)        VALUES ('0819',Y.MAKHO,Y.TENKHO,Y.HANGHOA_ID,Y.MAHANGHOA,Y.TEN,Y.SOLUONGTONDAU,Y.SOLUONGNHAP,Y.SOLUONGXUAT, @param0 ,GETDATE());          DELETE FROM TT_INV_TONKHOCHITIET WHERE SOLUONGTONDAU=0 AND SOLUONGNHAP=0 AND SOLUONGXUAT=0;        DELETE FROM TT_INV_TONKHOTONGHOP WHERE SOLUONGTONDAU=0 AND SOLUONGNHAP=0 AND SOLUONGXUAT=0;]
2019-08-16 18:08:44,262 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLXuatTonKho] Parameters: [@param0=[BENHVIEN_ID,HLU01]]
2019-08-16 18:08:44,262 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdSLXuatTonKho] Types: [@param0=[String, System.String]]
2019-08-16 18:08:44,334 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdateTrangThaiPO_NhapKho] PreparedStatement : [UPDATE TT_PUR_CHUNGTU SET STATE_CODE =  @param0 , STATE_NAME =  @param1  WHERE MACHUNGTU = 'YC5190531102725' AND PROCESS_CODE = 'PO']
2019-08-16 18:08:44,334 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdateTrangThaiPO_NhapKho] Parameters: [@param0=[STATE_CODE,9], @param1=[STATE_NAME,Đã xuất kho]]
2019-08-16 18:08:44,334 [1] DEBUG - Statement Id: [DAO00401_INV001_UpdateTrangThaiPO_NhapKho] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2019-08-16 18:08:44,466 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatAll] PreparedStatement : [SELECT CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID,        CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        , CT.MUCDICHCHUNGTU_ID, CT.MUCDICHCHUNGTU_CODE        FROM TT_INV_CHUNGTUXUAT CT INNER JOIN TT_INV_CHUNGTUXUATCHITIET CTCT ON CT.CHUNGTUXUAT_ID=CTCT.CHUNGTUXUAT_ID               INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID      where CT.BENHVIEN_ID = 'HLU01' AND CT.MACHUNGTU = 'X07190816180842'             ORDER BY TD.TENHANGHOA]
2019-08-16 18:08:44,516 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 18:08:53,160 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'STA07'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-08-16 18:08:53,365 [1] DEBUG - Statement Id: [DAO00401_INV001_ChungTuXuatSearch] PreparedStatement : [select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/16/2019 6:08:53 PM' AND '8/16/2019 6:08:53 PM'        AND CT.MAKHOXUAT = 'KCVPP'                   UNION          select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/16/2019 6:08:53 PM' AND '8/16/2019 6:08:53 PM'        AND CT.MAKHOXUAT = 'KCVPP']
2019-08-16 18:08:53,511 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatChiTiet_ChungTuID] PreparedStatement : [select CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        FROM TT_INV_CHUNGTUXUATCHITIET CTCT INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID        WHERE CTCT.BENHVIEN_ID = 'HLU01' AND CTCT.CHUNGTUXUAT_ID='6']
2019-08-16 18:08:55,384 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatChiTiet_ChungTuID] PreparedStatement : [select CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        FROM TT_INV_CHUNGTUXUATCHITIET CTCT INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID        WHERE CTCT.BENHVIEN_ID = 'HLU01' AND CTCT.CHUNGTUXUAT_ID='13']
2019-08-16 18:08:55,721 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatAll] PreparedStatement : [SELECT CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID,        CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        , CT.MUCDICHCHUNGTU_ID, CT.MUCDICHCHUNGTU_CODE        FROM TT_INV_CHUNGTUXUAT CT INNER JOIN TT_INV_CHUNGTUXUATCHITIET CTCT ON CT.CHUNGTUXUAT_ID=CTCT.CHUNGTUXUAT_ID               INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID      where CT.BENHVIEN_ID = 'HLU01' AND CT.MACHUNGTU = 'X07190816180842'             ORDER BY TD.TENHANGHOA]
2019-08-16 18:08:55,819 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 18:08:57,433 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatChiTiet_ChungTuID] PreparedStatement : [select CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        FROM TT_INV_CHUNGTUXUATCHITIET CTCT INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID        WHERE CTCT.BENHVIEN_ID = 'HLU01' AND CTCT.CHUNGTUXUAT_ID='6']
2019-08-16 18:08:57,469 [1] DEBUG - Statement Id: [DAO00401_INV001_ChungTuXuatSearch] PreparedStatement : [select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/16/2019 6:08:57 PM' AND '8/16/2019 6:08:57 PM'        AND CT.MAKHOXUAT = 'KCVPP'                   UNION          select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/16/2019 6:08:57 PM' AND '8/16/2019 6:08:57 PM'        AND CT.MAKHOXUAT = 'KCVPP']
2019-08-16 18:08:59,023 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatChiTiet_ChungTuID] PreparedStatement : [select CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        FROM TT_INV_CHUNGTUXUATCHITIET CTCT INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID        WHERE CTCT.BENHVIEN_ID = 'HLU01' AND CTCT.CHUNGTUXUAT_ID='12']
2019-08-16 18:08:59,376 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatAll] PreparedStatement : [SELECT CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID,        CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        , CT.MUCDICHCHUNGTU_ID, CT.MUCDICHCHUNGTU_CODE        FROM TT_INV_CHUNGTUXUAT CT INNER JOIN TT_INV_CHUNGTUXUATCHITIET CTCT ON CT.CHUNGTUXUAT_ID=CTCT.CHUNGTUXUAT_ID               INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID      where CT.BENHVIEN_ID = 'HLU01' AND CT.MACHUNGTU = 'X21190816180436'             ORDER BY TD.TENHANGHOA]
2019-08-16 18:08:59,597 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 18:09:04,989 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatChiTiet_ChungTuID] PreparedStatement : [select CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        FROM TT_INV_CHUNGTUXUATCHITIET CTCT INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID        WHERE CTCT.BENHVIEN_ID = 'HLU01' AND CTCT.CHUNGTUXUAT_ID='6']
2019-08-16 18:09:05,023 [1] DEBUG - Statement Id: [DAO00401_INV001_ChungTuXuatSearch] PreparedStatement : [select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/16/2019 6:09:05 PM' AND '8/16/2019 6:09:05 PM'        AND CT.MAKHOXUAT = 'KCVPP'                   UNION          select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/16/2019 6:09:05 PM' AND '8/16/2019 6:09:05 PM'        AND CT.MAKHOXUAT = 'KCVPP']
2019-08-16 18:09:06,623 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatChiTiet_ChungTuID] PreparedStatement : [select CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        FROM TT_INV_CHUNGTUXUATCHITIET CTCT INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID        WHERE CTCT.BENHVIEN_ID = 'HLU01' AND CTCT.CHUNGTUXUAT_ID='13']
2019-08-16 18:09:06,967 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatAll] PreparedStatement : [SELECT CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID,        CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        , CT.MUCDICHCHUNGTU_ID, CT.MUCDICHCHUNGTU_CODE        FROM TT_INV_CHUNGTUXUAT CT INNER JOIN TT_INV_CHUNGTUXUATCHITIET CTCT ON CT.CHUNGTUXUAT_ID=CTCT.CHUNGTUXUAT_ID               INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID      where CT.BENHVIEN_ID = 'HLU01' AND CT.MACHUNGTU = 'X07190816180842'             ORDER BY TD.TENHANGHOA]
2019-08-16 18:09:07,186 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
2019-08-16 18:09:08,627 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatChiTiet_ChungTuID] PreparedStatement : [select CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        FROM TT_INV_CHUNGTUXUATCHITIET CTCT INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID        WHERE CTCT.BENHVIEN_ID = 'HLU01' AND CTCT.CHUNGTUXUAT_ID='6']
2019-08-16 18:09:08,662 [1] DEBUG - Statement Id: [DAO00401_INV001_ChungTuXuatSearch] PreparedStatement : [select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/16/2019 6:09:08 PM' AND '8/16/2019 6:09:08 PM'        AND CT.MAKHOXUAT = 'KCVPP'                   UNION          select CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID        FROM TT_INV_CHUNGTUXUAT CT        WHERE CT.BENHVIEN_ID = 'HLU01' AND CT.NGAYCHUNGTU BETWEEN '7/16/2019 6:09:08 PM' AND '8/16/2019 6:09:08 PM'        AND CT.MAKHOXUAT = 'KCVPP']
2019-08-16 18:09:10,431 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatChiTiet_ChungTuID] PreparedStatement : [select CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        FROM TT_INV_CHUNGTUXUATCHITIET CTCT INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID        WHERE CTCT.BENHVIEN_ID = 'HLU01' AND CTCT.CHUNGTUXUAT_ID='11']
2019-08-16 18:09:10,772 [1] DEBUG - Statement Id: [DAO00401_INV001_GetChungTuXuatAll] PreparedStatement : [SELECT CT.CHUNGTUXUAT_ID,CT.MACHUNGTU,CT.MMYY,CT.NGAYCHUNGTU,CT.MAKHOXUAT,CT.TENKHOXUAT,CT.PHONGBANNHAN_ID,CT.TENPHONGBANNHAN,CT.NHANVIENNHAN_ID,CT.TENNHANVIENNHAN,        CT.GHICHU,CT.PHIEUYEUCAU_ID,CT.MAPHIEUYEUCAU,CT.XUATKHOTHEO,CT.TENNGUOITAO,CT.TENNGUOICAPNHAT,CT.IDCHUYEN,CT.BENHVIEN_ID,CT.NGAYTAO,CT.NGUOITAO_ID,CT.NGAYCAPNHAT,CT.NGUOICAPNHAT_ID,        CTCT.SOLUONGYEUCAU,CTCT.SOLUONGXUAT,CTCT.THANHTIEN,CTCT.GHICHU AS CT_GHICHU,CTCT.PHIEUYEUCAUCHITIET_ID,        TD.THEODOI_ID,TD.HANGHOA_ID,TD.MAHANGHOA,TD.TENHANGHOA,TD.DONVITINH_ID,TD.TENDONVITINH,TD.HANDUNG,TD.LOSX,TD.DONGIASAUVAT AS DONGIA        , CT.MUCDICHCHUNGTU_ID, CT.MUCDICHCHUNGTU_CODE        FROM TT_INV_CHUNGTUXUAT CT INNER JOIN TT_INV_CHUNGTUXUATCHITIET CTCT ON CT.CHUNGTUXUAT_ID=CTCT.CHUNGTUXUAT_ID               INNER JOIN TT_INV_THEODOI TD ON CTCT.THEODOI_ID=TD.THEODOI_ID      where CT.BENHVIEN_ID = 'HLU01' AND CT.MACHUNGTU = 'X21190816163249'             ORDER BY TD.TENHANGHOA]
2019-08-16 18:09:10,985 [1] DEBUG - Statement Id: [DAO00401_INV001_KiemTraKhoaSoMMYY] PreparedStatement : [select KHOASO FROM TT_INV_KHOASO WHERE MMYY = '0819' AND MAKHO = 'KCVPP' AND BENHVIEN_ID = 'HLU01']
