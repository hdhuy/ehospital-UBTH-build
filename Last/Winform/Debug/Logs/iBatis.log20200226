--------------------------------------------------------------------------------
2020-02-26 09:49:43,648 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2020-02-26 09:49:44,009 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2020-02-26 09:49:44,044 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2020-02-26 09:49:45,164 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 09:49:45,701 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2020-02-26 09:50:02,724 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2020-02-26 09:50:02,749 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2020-02-26 09:50:09,221 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2020-02-26 09:50:09,365 [6] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2020-02-26 09:50:11,010 [6] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2020-02-26 09:50:11,478 [6] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2020-02-26 09:50:11,704 [6] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2020-02-26 09:50:11,810 [6] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2020-02-26 09:50:11,880 [6] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2020-02-26 09:50:11,958 [6] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2020-02-26 09:50:12,038 [6] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2020-02-26 09:50:12,173 [6] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2020-02-26 09:50:12,347 [6] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2020-02-26 09:50:12,946 [6] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2020-02-26 09:50:12,977 [6] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2020-02-26 09:50:13,052 [6] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2020-02-26 09:50:13,105 [6] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2020-02-26 09:50:13,967 [6] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2020-02-26 09:50:14,029 [6] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @NGUONDUOC_MACDINH varchar(5) = '0';        declare @TOAMUANGOAI int = 0;        select @NGUONDUOC_MACDINH = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'PHA_NGUONDUOC'        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + @NGUONDUOC_MACDINH as DUOC_KEY, 0 as PHAMVI_ID, @NGUONDUOC_MACDINH as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end        else        begin                select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (        select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID)        B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (        select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID)        A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2020-02-26 09:50:15,472 [6] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2020-02-26 09:50:15,503 [6] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,        SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH        FROM TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID        WHERE TK.SOLUONG > 0        GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2020-02-26 09:50:15,598 [6] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2020-02-26 09:50:15,631 [6] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,        TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,        TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH        from TM_MAU M        JOIN        (        select        A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO        from        (        select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO        from TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'        where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0        ) A        )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2020-02-26 09:50:15,768 [6] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2020-02-26 09:50:16,799 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 09:50:19,264 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2020-02-26 09:50:32,208 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2020-02-26 09:50:32,259 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2020-02-26 09:50:32,386 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 09:50:32,689 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 09:50:33,074 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2020-02-26 09:50:33,076 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2020-02-26 09:50:33,076 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2020-02-26 09:50:33,154 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2020-02-26 09:50:33,155 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2020-02-26 09:50:33,155 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2020-02-26 09:50:33,655 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 09:50:33,965 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 09:50:53,597 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 09:50:53,750 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2020-02-26 09:50:54,184 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2020-02-26 09:52:54,866 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'OPD23'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 09:52:56,578 [1] DEBUG - Statement Id: [DAO00019_DanhSachPhauThuatThuThuat] PreparedStatement : [declare @TenBenhVien nvarchar(500)        declare @ManhomDSA varchar(10);        set @TenBenhVien = (select VALUE from TM_SYS_APPSETTINGS where CODE = 'APP_BENHVIEN_TEN')        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        select * from(        select ROW_NUMBER() OVER(order by NGAYGIOYEUCAU) as ROWNUMBER, *        from        (SELECT distinct        COUNT(*) OVER() as TOTALROWS,        N'Mã người bệnh: ' + bn.MAYTE + ' - ' + N'Tên người bệnh: ' + bn.TENBENHNHAN + ' - ' + N'Số bệnh án: ' + ISNULL(BA.SOBENHAN,'') + ' - ' + N'Sinh ngày: ' + isnull(Convert(varchar(10),bn.NGAYSINH,103),bn.NAMSINH) + ' - ' + N'Giới tính: ' + GD.DESCRIPTION as GROUPNAME,        bn.MAYTE, bn.TENBENHNHAN, bn.NAMSINH, bn.NGAYSINH as TUOI, ISNULL(CONVERT(VARCHAR(10), bn.NGAYSINH, 103),CAST(bn.NAMSINH AS varchar)) as NGAYSINH, bn.DIACHILIENLAC as DIACHI, bn.GIOITINH, GD.DESCRIPTION as TENGIOITINH,        tn.DOITUONG_ID, tn.THOIGIANTIEPNHAN, tn.BENHNHAN_ID, tn.TIEPNHAN_ID, tn.TRAITUYEN, tn.SOTIEPNHAN        , dv.DICHVU_ID, dv.NOITHUCHIEN_ID, isnull(dv.NGAYTAO, dv.NGAYCAPNHAT) as THOIGIANDKDICHVU        , dv.KHAN, dv.NOIYEUCAU_ID, dv.NGAYGIOYEUCAU, dv.BACSICHIDINH_ID, dv.DONVIGIOITHIEU_ID        , dv.NGUOIGIOITHIEU_ID, dv.TRANGTHAI_WFL, tn.NOIGIOITHIEU_ID        , dv.DVYEUCAU_ID, dv.MARIS, dv.TRANGTHAI as TRANGTHAICODE, B.TENNHOMDICHVU, dv.SOPHIEUYEUCAU, dv.KHAMBENH_NGOAITRU_ID, dv.NGUOICAPNHAT_ID, dv.NGAYCAPNHAT,        CASE        WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU        WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02'        ELSE Left(B.MANHOMDICHVU,2) END AS MANHOMDICHVU, B.MANHOMDICHVU as MANHOMDICHVUCHITIET, tn.TRANGTHAI as TRANGTHAI_TIEPNHAN,        'False' as DAKHAM,        vp.DATHANHTOAN, vp.DONGIA_DOANHTHU, BA.SOBENHAN, dv.CHANDOAN        , a.TENDICHVU, nth.TENPHONGBAN as TENPHONGKHAM, nyc.TENPHONGBAN as TENKHOACHIDINH        , bscd.TENNHANVIEN as TENBACSICHIDINH        , 0 as GUINGOAI        , 0 as VTYT        , 0 as CLSKETQUA_ID          ,             '' SOPHIEUPHAUTHUAT                   FROM TT_DVYEUCAU (NOLOCK) dv        inner join TT_TIEPNHAN (NOLOCK) tn on dv.TIEPNHAN_ID = tn.TIEPNHAN_ID        inner join TT_BENHNHAN (NOLOCK) bn on tn.BENHNHAN_ID = bn.BENHNHAN_ID        inner join TM_DICHVU A on A.DICHVU_ID = dv.DICHVU_ID        inner join TM_PHONGBAN nth on nth.PHONGBAN_ID = dv.NOITHUCHIEN_ID        left join TM_NHANVIEN bscd on bscd.NHANVIEN_ID = dv.BACSICHIDINH_ID        inner join TM_PHONGBAN nyc on nyc.PHONGBAN_ID = dv.NOIYEUCAU_ID        inner join TM_NHOMDICHVU B on B.NHOMDICHVU_ID = A.NHOMDICHVU_ID        inner join TT_VIENPHI (NOLOCK) VP on VP.TIEPNHAN_ID = tn.TIEPNHAN_ID and VP.DICHVU_ID = dv.DICHVU_ID and VP.REF_ID = dv.DVYEUCAU_ID        left join TT_NOITRU_BENHAN (NOLOCK) BA on BA.TIEPNHAN_ID = tn.TIEPNHAN_ID AND dv.BENHAN_ID = BA.BENHAN_ID        inner join TM_GENDER GD on GD.ID = bn.GIOITINH                 where        dv.DICHVU_ID IS NOT NULL        and tn.BENHVIEN_ID = 'HLU01'        and HUYYEUCAU = 0        and dv.NGAYHENCLS is NULL                       and dv.TRANGTHAI = 'CHUAKETQUA'           and           dv.NGAYYEUCAU >= '2/26/2020 12:00:00 AM'         and           dv.NGAYYEUCAU <= '2/26/2020 12:00:00 AM'         and           dv.NOITHUCHIEN_ID = 25         and           (CASE          WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU          WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2)          END) in (05)         and           tn.TRANGTHAI IN ('DATIEPNHAN','NOITRU','CAPCUU', 'HOANTHANH')         and           (vp.DATHANHTOAN = '1'  or vp.DONGIA_DOANHTHU = '0' OR TN.SUDUNG_BHTN='1' OR TN.BAOLANH_VIENPHI='1'  OR tn.TRANGTHAI IN ('NOITRU','CAPCUU','NGOAITRU') or dv.HOPDONG_BENHNHAN_ID is not null or vp.BENHNHAN_PHAITHANHTOAN >= 0)                 ) data1) lst                    where          lst.ROWNUMBER between 1 and 20                 order by NGAYGIOYEUCAU asc]
2020-02-26 09:53:03,428 [1] DEBUG - Statement Id: [DAO00217_GetEmployeeAll] PreparedStatement : [select * from TM_NHANVIEN]
2020-02-26 09:53:12,780 [1] DEBUG - Statement Id: [DAO00019_DanhSachPhauThuatThuThuat] PreparedStatement : [declare @TenBenhVien nvarchar(500)        declare @ManhomDSA varchar(10);        set @TenBenhVien = (select VALUE from TM_SYS_APPSETTINGS where CODE = 'APP_BENHVIEN_TEN')        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        select * from(        select ROW_NUMBER() OVER(order by NGAYGIOYEUCAU) as ROWNUMBER, *        from        (SELECT distinct        COUNT(*) OVER() as TOTALROWS,        N'Mã người bệnh: ' + bn.MAYTE + ' - ' + N'Tên người bệnh: ' + bn.TENBENHNHAN + ' - ' + N'Số bệnh án: ' + ISNULL(BA.SOBENHAN,'') + ' - ' + N'Sinh ngày: ' + isnull(Convert(varchar(10),bn.NGAYSINH,103),bn.NAMSINH) + ' - ' + N'Giới tính: ' + GD.DESCRIPTION as GROUPNAME,        bn.MAYTE, bn.TENBENHNHAN, bn.NAMSINH, bn.NGAYSINH as TUOI, ISNULL(CONVERT(VARCHAR(10), bn.NGAYSINH, 103),CAST(bn.NAMSINH AS varchar)) as NGAYSINH, bn.DIACHILIENLAC as DIACHI, bn.GIOITINH, GD.DESCRIPTION as TENGIOITINH,        tn.DOITUONG_ID, tn.THOIGIANTIEPNHAN, tn.BENHNHAN_ID, tn.TIEPNHAN_ID, tn.TRAITUYEN, tn.SOTIEPNHAN        , dv.DICHVU_ID, dv.NOITHUCHIEN_ID, isnull(dv.NGAYTAO, dv.NGAYCAPNHAT) as THOIGIANDKDICHVU        , dv.KHAN, dv.NOIYEUCAU_ID, dv.NGAYGIOYEUCAU, dv.BACSICHIDINH_ID, dv.DONVIGIOITHIEU_ID        , dv.NGUOIGIOITHIEU_ID, dv.TRANGTHAI_WFL, tn.NOIGIOITHIEU_ID        , dv.DVYEUCAU_ID, dv.MARIS, dv.TRANGTHAI as TRANGTHAICODE, B.TENNHOMDICHVU, dv.SOPHIEUYEUCAU, dv.KHAMBENH_NGOAITRU_ID, dv.NGUOICAPNHAT_ID, dv.NGAYCAPNHAT,        CASE        WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU        WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02'        ELSE Left(B.MANHOMDICHVU,2) END AS MANHOMDICHVU, B.MANHOMDICHVU as MANHOMDICHVUCHITIET, tn.TRANGTHAI as TRANGTHAI_TIEPNHAN,        'False' as DAKHAM,        vp.DATHANHTOAN, vp.DONGIA_DOANHTHU, BA.SOBENHAN, dv.CHANDOAN        , a.TENDICHVU, nth.TENPHONGBAN as TENPHONGKHAM, nyc.TENPHONGBAN as TENKHOACHIDINH        , bscd.TENNHANVIEN as TENBACSICHIDINH        , 0 as GUINGOAI        , 0 as VTYT        , 0 as CLSKETQUA_ID          ,             '' SOPHIEUPHAUTHUAT                   FROM TT_DVYEUCAU (NOLOCK) dv        inner join TT_TIEPNHAN (NOLOCK) tn on dv.TIEPNHAN_ID = tn.TIEPNHAN_ID        inner join TT_BENHNHAN (NOLOCK) bn on tn.BENHNHAN_ID = bn.BENHNHAN_ID        inner join TM_DICHVU A on A.DICHVU_ID = dv.DICHVU_ID        inner join TM_PHONGBAN nth on nth.PHONGBAN_ID = dv.NOITHUCHIEN_ID        left join TM_NHANVIEN bscd on bscd.NHANVIEN_ID = dv.BACSICHIDINH_ID        inner join TM_PHONGBAN nyc on nyc.PHONGBAN_ID = dv.NOIYEUCAU_ID        inner join TM_NHOMDICHVU B on B.NHOMDICHVU_ID = A.NHOMDICHVU_ID        inner join TT_VIENPHI (NOLOCK) VP on VP.TIEPNHAN_ID = tn.TIEPNHAN_ID and VP.DICHVU_ID = dv.DICHVU_ID and VP.REF_ID = dv.DVYEUCAU_ID        left join TT_NOITRU_BENHAN (NOLOCK) BA on BA.TIEPNHAN_ID = tn.TIEPNHAN_ID AND dv.BENHAN_ID = BA.BENHAN_ID        inner join TM_GENDER GD on GD.ID = bn.GIOITINH                 where        dv.DICHVU_ID IS NOT NULL        and tn.BENHVIEN_ID = 'HLU01'        and HUYYEUCAU = 0        and dv.NGAYHENCLS is NULL                       and dv.TRANGTHAI = 'CHUAKETQUA'           and           dv.NGAYYEUCAU >= '9/1/2019 12:00:00 AM'         and           dv.NGAYYEUCAU <= '2/26/2020 12:00:00 AM'         and           dv.NOITHUCHIEN_ID = 25         and           (CASE          WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU          WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2)          END) in (05)         and           tn.TRANGTHAI IN ('DATIEPNHAN','NOITRU','CAPCUU', 'HOANTHANH')         and           (vp.DATHANHTOAN = '1'  or vp.DONGIA_DOANHTHU = '0' OR TN.SUDUNG_BHTN='1' OR TN.BAOLANH_VIENPHI='1'  OR tn.TRANGTHAI IN ('NOITRU','CAPCUU','NGOAITRU') or dv.HOPDONG_BENHNHAN_ID is not null or vp.BENHNHAN_PHAITHANHTOAN >= 0)                 ) data1) lst                    where          lst.ROWNUMBER between 1 and 20                 order by NGAYGIOYEUCAU asc]
2020-02-26 09:53:17,367 [1] DEBUG - Statement Id: [DAO00000_GetNhomDoiTuong] PreparedStatement : [SELECT DOITUONG_ID              ,[TENDOITUONG]              ,[NHOMDICHVU]              ,[TYLE_VUOT_LCB]              ,[GIOIHAN_VUOT_LCB]              ,[GIOIHAN_VUOT_DVKTC]              ,[TYLE_THUOC_UT]              ,[CPVC]              ,[CHIPHINGOAI_BHYT]              ,[NGANSACH_TL]              ,[MIENGIAM_TL]              ,[TAITRO_TL]              ,[BHTN_TL]              FROM [dbo].[TM_DOITUONG]]
2020-02-26 09:53:19,685 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'ORM04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 09:53:19,912 [1] DEBUG - Statement Id: [DAO00012_GetList] PreparedStatement : [select        DICTIONARY_ID,        DICTIONARY_CODE,        DICTIONARY_NAME,        ATTRIBUTE1,        ATTRIBUTE2,        DICTIONARY_NAME_EN,        DICTIONARY_TYPE_CODE        from LST_DICTIONARY        where LST_DICTIONARY.Enabled = '1'         AND           LST_DICTIONARY.DICTIONARY_TYPE_CODE = 'NguonBenh'                 order by LST_DICTIONARY.IDX]
2020-02-26 09:53:20,215 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'ORM05'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 09:53:20,404 [1] DEBUG - Statement Id: [DAO00012_GetList] PreparedStatement : [select        DICTIONARY_ID,        DICTIONARY_CODE,        DICTIONARY_NAME,        ATTRIBUTE1,        ATTRIBUTE2,        DICTIONARY_NAME_EN,        DICTIONARY_TYPE_CODE        from LST_DICTIONARY        where LST_DICTIONARY.Enabled = '1'         AND           LST_DICTIONARY.DICTIONARY_TYPE_CODE = 'PhuongPhapGayMe'                 order by LST_DICTIONARY.IDX]
2020-02-26 09:53:21,292 [1] DEBUG - Statement Id: [DAO00012_GetList] PreparedStatement : [select        DICTIONARY_ID,        DICTIONARY_CODE,        DICTIONARY_NAME,        ATTRIBUTE1,        ATTRIBUTE2,        DICTIONARY_NAME_EN,        DICTIONARY_TYPE_CODE        from LST_DICTIONARY        where LST_DICTIONARY.Enabled = '1'         AND           LST_DICTIONARY.DICTIONARY_TYPE_CODE = 'TuVongPhauThuat'                 order by LST_DICTIONARY.IDX]
2020-02-26 09:53:21,560 [1] DEBUG - Statement Id: [DAO00012_GetList] PreparedStatement : [select        DICTIONARY_ID,        DICTIONARY_CODE,        DICTIONARY_NAME,        ATTRIBUTE1,        ATTRIBUTE2,        DICTIONARY_NAME_EN,        DICTIONARY_TYPE_CODE        from LST_DICTIONARY        where LST_DICTIONARY.Enabled = '1'         AND           LST_DICTIONARY.DICTIONARY_TYPE_CODE = 'CheDo_PT_TT'                 order by LST_DICTIONARY.IDX]
2020-02-26 09:53:21,835 [1] DEBUG - Statement Id: [DAO00012_GetList] PreparedStatement : [select        DICTIONARY_ID,        DICTIONARY_CODE,        DICTIONARY_NAME,        ATTRIBUTE1,        ATTRIBUTE2,        DICTIONARY_NAME_EN,        DICTIONARY_TYPE_CODE        from LST_DICTIONARY        where LST_DICTIONARY.Enabled = '1'         AND           LST_DICTIONARY.DICTIONARY_TYPE_CODE = 'TaiBienPhauThuat'                 order by LST_DICTIONARY.IDX]
2020-02-26 09:53:21,950 [1] DEBUG - Statement Id: [DAO00047_GetList] PreparedStatement : [select *              from TM_LOAIPHAUTHUAT              where TAMNGUNG = '0' and BENHVIEN_ID = 'HLU01'              order by STT]
2020-02-26 09:53:22,393 [1] DEBUG - Statement Id: [DAO00019_ThongTinBenhNhanTiepNhan] PreparedStatement : [select distinct A.SOTIEPNHAN, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        B.*, A.SOBHYT        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'        where                    A.TIEPNHAN_ID = '62735'                 and A.BENHVIEN_ID = 'HLU01']
2020-02-26 09:53:22,837 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_GetList] PreparedStatement : [select *              from TT_PHAUTHUAT               where                             TT_PHAUTHUAT.LOAI = 'P'                       and                           TT_PHAUTHUAT.TIEPNHAN_ID = 62735                       and                           TT_PHAUTHUAT.BENHVIEN_ID = 'HLU01'                                     order by PHAUTHUAT_ID DESC]
2020-02-26 09:53:23,120 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '62735'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2020-02-26 09:53:23,454 [1] DEBUG - Statement Id: [DAO00048_GetBenhNhanByBenhNhanID] PreparedStatement : [SELECT *              FROM              TT_BENHNHAN               where                             BENHNHAN_ID = '47768']
2020-02-26 09:53:23,512 [1] DEBUG - Statement Id: [DAO00000_GetDoiTuongIsBHYT] PreparedStatement : [select * from TM_DOITUONG Where DOITUONG_ID = 1 and MADOITUONG like '%BHYT%']
2020-02-26 09:53:24,084 [1] DEBUG - Statement Id: [DAO00041_GetList] PreparedStatement : [declare @ManhomDSA varchar(10);            declare @PhanLoaiNhomDV varchar(20) = '05';            select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'            if (@ManhomDSA is not null and '05' in (select * from STRING_SPLIT('05', ',')))             set @PhanLoaiNhomDV += ',' + @ManhomDSA              select * from            (select dv.*, ndv.LOAIDICHVU_ID, ndv.MANHOMDICHVU, ndv.TENNHOMDICHVU as TENNHOMDICHVU,            ndv.TENKHONGDAU as TENNDVKHONGDAU, ndv.TENNHOMDICHVU_EN, ndv.TENNHOMDICHVU_RU,            CASE            WHEN @ManhomDSA is not null and ndv.MANHOMDICHVU in (@ManhomDSA) THEN ndv.MANHOMDICHVU            WHEN Left(ndv.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(ndv.MANHOMDICHVU,2)            END AS PHANLOAI_MANHOMDICHVU            from TM_DICHVU dv            left join TM_NHOMDICHVU ndv on dv.NHOMDICHVU_ID = ndv.NHOMDICHVU_ID                           where ndv.TAMNGUNG = '0' and dv.TAMNGUNG = '0' and dv.BENHVIEN_ID = 'HLU01') as tbl                 where                         PHANLOAI_MANHOMDICHVU in (select * from STRING_SPLIT(@PhanLoaiNhomDV,','))]
2020-02-26 09:53:25,536 [1] DEBUG - Statement Id: [DAO00048_GetDICHVUYCByTiepNhanID] PreparedStatement : [SELECT DISTINCT D.HOPDONG_ID, D.HOPDONG_BENHNHAN_ID, D.DVYEUCAU_ID, D.DICHVU_ID, D.SOPHIEUYEUCAU, D.NGAYGIOYEUCAU, D.NOITHUCHIEN_ID, P.LOAIPHAUTHUAT, L.STT AS STT_LOAIPHAUTHUAT            FROM            TT_DVYEUCAU AS D            left join TM_PHANLOAIPHAUTHUAT AS P ON D.DICHVU_ID = P.DICHVU_ID            left join TM_LOAIPHAUTHUAT AS L ON L.LOAIPHAUTHUAT = P.LOAIPHAUTHUAT            where            not exists (select DVYEUCAU_ID from TT_PHAUTHUAT_YEUCAU where D.DVYEUCAU_ID = DVYEUCAU_ID)               and                       exists                      (select DICHVU_ID from TM_DICHVU                      where D.DICHVU_ID = DICHVU_ID and                      exists                      (select NHOMDICHVU_ID from TM_NHOMDICHVU                      where TM_DICHVU.NHOMDICHVU_ID = NHOMDICHVU_ID and left(MANHOMDICHVU,2) in (05)                      )                                             )                     and                           D.TIEPNHAN_ID = '62735']
2020-02-26 09:53:26,185 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '62735'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2020-02-26 09:53:27,131 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN190904.0000153']
2020-02-26 09:53:27,761 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"3832","DVYEUCAU_ID":"506219"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"3832","DVYEUCAU_ID":"506219"}' order by ID desc)        order by A.ID desc]
2020-02-26 09:53:45,795 [1] DEBUG - Statement Id: [DAO00048_GetDICHVUYCByTiepNhanID] PreparedStatement : [SELECT DISTINCT D.HOPDONG_ID, D.HOPDONG_BENHNHAN_ID, D.DVYEUCAU_ID, D.DICHVU_ID, D.SOPHIEUYEUCAU, D.NGAYGIOYEUCAU, D.NOITHUCHIEN_ID, P.LOAIPHAUTHUAT, L.STT AS STT_LOAIPHAUTHUAT            FROM            TT_DVYEUCAU AS D            left join TM_PHANLOAIPHAUTHUAT AS P ON D.DICHVU_ID = P.DICHVU_ID            left join TM_LOAIPHAUTHUAT AS L ON L.LOAIPHAUTHUAT = P.LOAIPHAUTHUAT            where            not exists (select DVYEUCAU_ID from TT_PHAUTHUAT_YEUCAU where D.DVYEUCAU_ID = DVYEUCAU_ID)               and                       exists                      (select DICHVU_ID from TM_DICHVU                      where D.DICHVU_ID = DICHVU_ID and                      exists                      (select NHOMDICHVU_ID from TM_NHOMDICHVU                      where TM_DICHVU.NHOMDICHVU_ID = NHOMDICHVU_ID and left(MANHOMDICHVU,2) in (05)                      )                                             )                     and                           D.TIEPNHAN_ID = '62735']
2020-02-26 09:53:45,968 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '62735'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2020-02-26 09:53:46,042 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN190904.0000153']
2020-02-26 09:53:46,067 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"3832","DVYEUCAU_ID":"506219"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"3832","DVYEUCAU_ID":"506219"}' order by ID desc)        order by A.ID desc]
2020-02-26 09:53:53,620 [1] DEBUG - Statement Id: [DAO00019_ThongTinBenhNhanTiepNhan] PreparedStatement : [select distinct A.SOTIEPNHAN, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        B.*, A.SOBHYT        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'        where                    A.TIEPNHAN_ID = '74759'                 and A.BENHVIEN_ID = 'HLU01']
2020-02-26 09:53:53,829 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_GetList] PreparedStatement : [select *              from TT_PHAUTHUAT               where                             TT_PHAUTHUAT.LOAI = 'P'                       and                           TT_PHAUTHUAT.TIEPNHAN_ID = 74759                       and                           TT_PHAUTHUAT.BENHVIEN_ID = 'HLU01'                                     order by PHAUTHUAT_ID DESC]
2020-02-26 09:53:53,928 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '74759'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2020-02-26 09:53:54,033 [1] DEBUG - Statement Id: [DAO00048_GetBenhNhanByBenhNhanID] PreparedStatement : [SELECT *              FROM              TT_BENHNHAN               where                             BENHNHAN_ID = '55283']
2020-02-26 09:53:54,059 [1] DEBUG - Statement Id: [DAO00000_GetDoiTuongIsBHYT] PreparedStatement : [select * from TM_DOITUONG Where DOITUONG_ID = 4 and MADOITUONG like '%BHYT%']
2020-02-26 09:53:54,429 [1] DEBUG - Statement Id: [DAO00048_GetDICHVUYCByTiepNhanID] PreparedStatement : [SELECT DISTINCT D.HOPDONG_ID, D.HOPDONG_BENHNHAN_ID, D.DVYEUCAU_ID, D.DICHVU_ID, D.SOPHIEUYEUCAU, D.NGAYGIOYEUCAU, D.NOITHUCHIEN_ID, P.LOAIPHAUTHUAT, L.STT AS STT_LOAIPHAUTHUAT            FROM            TT_DVYEUCAU AS D            left join TM_PHANLOAIPHAUTHUAT AS P ON D.DICHVU_ID = P.DICHVU_ID            left join TM_LOAIPHAUTHUAT AS L ON L.LOAIPHAUTHUAT = P.LOAIPHAUTHUAT            where            not exists (select DVYEUCAU_ID from TT_PHAUTHUAT_YEUCAU where D.DVYEUCAU_ID = DVYEUCAU_ID)               and                       exists                      (select DICHVU_ID from TM_DICHVU                      where D.DICHVU_ID = DICHVU_ID and                      exists                      (select NHOMDICHVU_ID from TM_NHOMDICHVU                      where TM_DICHVU.NHOMDICHVU_ID = NHOMDICHVU_ID and left(MANHOMDICHVU,2) in (05)                      )                                             )                     and                           D.TIEPNHAN_ID = '74759']
2020-02-26 09:53:54,541 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '74759'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2020-02-26 09:53:54,615 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN191005.0000263']
2020-02-26 09:53:54,661 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"3176","DVYEUCAU_ID":"624036"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"3176","DVYEUCAU_ID":"624036"}' order by ID desc)        order by A.ID desc]
2020-02-26 09:54:00,375 [1] DEBUG - Statement Id: [DAO00019_DanhSachPhauThuatThuThuat] PreparedStatement : [declare @TenBenhVien nvarchar(500)        declare @ManhomDSA varchar(10);        set @TenBenhVien = (select VALUE from TM_SYS_APPSETTINGS where CODE = 'APP_BENHVIEN_TEN')        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        select * from(        select ROW_NUMBER() OVER(order by NGAYGIOYEUCAU) as ROWNUMBER, *        from        (SELECT distinct        COUNT(*) OVER() as TOTALROWS,        N'Mã người bệnh: ' + bn.MAYTE + ' - ' + N'Tên người bệnh: ' + bn.TENBENHNHAN + ' - ' + N'Số bệnh án: ' + ISNULL(BA.SOBENHAN,'') + ' - ' + N'Sinh ngày: ' + isnull(Convert(varchar(10),bn.NGAYSINH,103),bn.NAMSINH) + ' - ' + N'Giới tính: ' + GD.DESCRIPTION as GROUPNAME,        bn.MAYTE, bn.TENBENHNHAN, bn.NAMSINH, bn.NGAYSINH as TUOI, ISNULL(CONVERT(VARCHAR(10), bn.NGAYSINH, 103),CAST(bn.NAMSINH AS varchar)) as NGAYSINH, bn.DIACHILIENLAC as DIACHI, bn.GIOITINH, GD.DESCRIPTION as TENGIOITINH,        tn.DOITUONG_ID, tn.THOIGIANTIEPNHAN, tn.BENHNHAN_ID, tn.TIEPNHAN_ID, tn.TRAITUYEN, tn.SOTIEPNHAN        , dv.DICHVU_ID, dv.NOITHUCHIEN_ID, isnull(dv.NGAYTAO, dv.NGAYCAPNHAT) as THOIGIANDKDICHVU        , dv.KHAN, dv.NOIYEUCAU_ID, dv.NGAYGIOYEUCAU, dv.BACSICHIDINH_ID, dv.DONVIGIOITHIEU_ID        , dv.NGUOIGIOITHIEU_ID, dv.TRANGTHAI_WFL, tn.NOIGIOITHIEU_ID        , dv.DVYEUCAU_ID, dv.MARIS, dv.TRANGTHAI as TRANGTHAICODE, B.TENNHOMDICHVU, dv.SOPHIEUYEUCAU, dv.KHAMBENH_NGOAITRU_ID, dv.NGUOICAPNHAT_ID, dv.NGAYCAPNHAT,        CASE        WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU        WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02'        ELSE Left(B.MANHOMDICHVU,2) END AS MANHOMDICHVU, B.MANHOMDICHVU as MANHOMDICHVUCHITIET, tn.TRANGTHAI as TRANGTHAI_TIEPNHAN,        'False' as DAKHAM,        vp.DATHANHTOAN, vp.DONGIA_DOANHTHU, BA.SOBENHAN, dv.CHANDOAN        , a.TENDICHVU, nth.TENPHONGBAN as TENPHONGKHAM, nyc.TENPHONGBAN as TENKHOACHIDINH        , bscd.TENNHANVIEN as TENBACSICHIDINH        , 0 as GUINGOAI        , 0 as VTYT        , 0 as CLSKETQUA_ID          ,             '' SOPHIEUPHAUTHUAT                   FROM TT_DVYEUCAU (NOLOCK) dv        inner join TT_TIEPNHAN (NOLOCK) tn on dv.TIEPNHAN_ID = tn.TIEPNHAN_ID        inner join TT_BENHNHAN (NOLOCK) bn on tn.BENHNHAN_ID = bn.BENHNHAN_ID        inner join TM_DICHVU A on A.DICHVU_ID = dv.DICHVU_ID        inner join TM_PHONGBAN nth on nth.PHONGBAN_ID = dv.NOITHUCHIEN_ID        left join TM_NHANVIEN bscd on bscd.NHANVIEN_ID = dv.BACSICHIDINH_ID        inner join TM_PHONGBAN nyc on nyc.PHONGBAN_ID = dv.NOIYEUCAU_ID        inner join TM_NHOMDICHVU B on B.NHOMDICHVU_ID = A.NHOMDICHVU_ID        inner join TT_VIENPHI (NOLOCK) VP on VP.TIEPNHAN_ID = tn.TIEPNHAN_ID and VP.DICHVU_ID = dv.DICHVU_ID and VP.REF_ID = dv.DVYEUCAU_ID        left join TT_NOITRU_BENHAN (NOLOCK) BA on BA.TIEPNHAN_ID = tn.TIEPNHAN_ID AND dv.BENHAN_ID = BA.BENHAN_ID        inner join TM_GENDER GD on GD.ID = bn.GIOITINH                 where        dv.DICHVU_ID IS NOT NULL        and tn.BENHVIEN_ID = 'HLU01'        and HUYYEUCAU = 0        and dv.NGAYHENCLS is NULL                       and dv.TRANGTHAI = 'CHUAKETQUA'           and           dv.NGAYYEUCAU >= '9/1/2019 12:00:00 AM'         and           dv.NGAYYEUCAU <= '2/26/2020 12:00:00 AM'         and           dv.NOITHUCHIEN_ID = 25         and           (CASE          WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU          WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2)          END) in (05)         and           tn.TRANGTHAI IN ('DATIEPNHAN','NOITRU','CAPCUU', 'HOANTHANH')         and           (vp.DATHANHTOAN = '1'  or vp.DONGIA_DOANHTHU = '0' OR TN.SUDUNG_BHTN='1' OR TN.BAOLANH_VIENPHI='1'  OR tn.TRANGTHAI IN ('NOITRU','CAPCUU','NGOAITRU') or dv.HOPDONG_BENHNHAN_ID is not null or vp.BENHNHAN_PHAITHANHTOAN >= 0)                 ) data1) lst                    where          lst.ROWNUMBER between 41 and 60                 order by NGAYGIOYEUCAU asc]
2020-02-26 09:54:03,528 [1] DEBUG - Statement Id: [DAO00019_ThongTinBenhNhanTiepNhan] PreparedStatement : [select distinct A.SOTIEPNHAN, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        B.*, A.SOBHYT        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'        where                    A.TIEPNHAN_ID = '107022'                 and A.BENHVIEN_ID = 'HLU01']
2020-02-26 09:54:03,629 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_GetList] PreparedStatement : [select *              from TT_PHAUTHUAT               where                             TT_PHAUTHUAT.LOAI = 'P'                       and                           TT_PHAUTHUAT.TIEPNHAN_ID = 107022                       and                           TT_PHAUTHUAT.BENHVIEN_ID = 'HLU01'                                     order by PHAUTHUAT_ID DESC]
2020-02-26 09:54:03,704 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '107022'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2020-02-26 09:54:04,257 [1] DEBUG - Statement Id: [DAO00048_GetBenhNhanByBenhNhanID] PreparedStatement : [SELECT *              FROM              TT_BENHNHAN               where                             BENHNHAN_ID = '71705']
2020-02-26 09:54:04,285 [1] DEBUG - Statement Id: [DAO00000_GetDoiTuongIsBHYT] PreparedStatement : [select * from TM_DOITUONG Where DOITUONG_ID = 1 and MADOITUONG like '%BHYT%']
2020-02-26 09:54:04,476 [1] DEBUG - Statement Id: [DAO00048_GetDICHVUYCByTiepNhanID] PreparedStatement : [SELECT DISTINCT D.HOPDONG_ID, D.HOPDONG_BENHNHAN_ID, D.DVYEUCAU_ID, D.DICHVU_ID, D.SOPHIEUYEUCAU, D.NGAYGIOYEUCAU, D.NOITHUCHIEN_ID, P.LOAIPHAUTHUAT, L.STT AS STT_LOAIPHAUTHUAT            FROM            TT_DVYEUCAU AS D            left join TM_PHANLOAIPHAUTHUAT AS P ON D.DICHVU_ID = P.DICHVU_ID            left join TM_LOAIPHAUTHUAT AS L ON L.LOAIPHAUTHUAT = P.LOAIPHAUTHUAT            where            not exists (select DVYEUCAU_ID from TT_PHAUTHUAT_YEUCAU where D.DVYEUCAU_ID = DVYEUCAU_ID)               and                       exists                      (select DICHVU_ID from TM_DICHVU                      where D.DICHVU_ID = DICHVU_ID and                      exists                      (select NHOMDICHVU_ID from TM_NHOMDICHVU                      where TM_DICHVU.NHOMDICHVU_ID = NHOMDICHVU_ID and left(MANHOMDICHVU,2) in (05)                      )                                             )                     and                           D.TIEPNHAN_ID = '107022']
2020-02-26 09:54:04,915 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '107022'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2020-02-26 09:54:05,222 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN200102.0000093']
2020-02-26 09:54:05,326 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"1317","DVYEUCAU_ID":"988687"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"1317","DVYEUCAU_ID":"988687"}' order by ID desc)        order by A.ID desc]
2020-02-26 09:54:05,656 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM60'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 09:54:05,797 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM98'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 09:54:10,119 [1] DEBUG - Statement Id: [DAO00048_GetDVYeuCauByDVYeuCauID] PreparedStatement : [SELECT A.*, B.NGAYGIOYEUCAU, C.TENDICHVU, D.TENNHOMDICHVU, D.NHOMDICHVU_ID            FROM TT_VIENPHI A            left join TT_DVYEUCAU B on A.REF_ID = B.DVYEUCAU_ID            inner join TM_DICHVU C on C.DICHVU_ID = B.DICHVU_ID            inner join TM_NHOMDICHVU D on D.NHOMDICHVU_ID = C.NHOMDICHVU_ID            WHERE            A.REF_ID IN (988687)            and A.REF_TABLE='TT_DVYEUCAU'            AND A.TIEPNHAN_ID = 107022]
2020-02-26 09:54:10,209 [1] DEBUG - Statement Id: [DAO00041_GetList] PreparedStatement : [declare @ManhomDSA varchar(10);            declare @PhanLoaiNhomDV varchar(20) = '05, 06';            select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'            if (@ManhomDSA is not null and '05' in (select * from STRING_SPLIT('05, 06', ',')))             set @PhanLoaiNhomDV += ',' + @ManhomDSA              select * from            (select dv.*, ndv.LOAIDICHVU_ID, ndv.MANHOMDICHVU, ndv.TENNHOMDICHVU as TENNHOMDICHVU,            ndv.TENKHONGDAU as TENNDVKHONGDAU, ndv.TENNHOMDICHVU_EN, ndv.TENNHOMDICHVU_RU,            CASE            WHEN @ManhomDSA is not null and ndv.MANHOMDICHVU in (@ManhomDSA) THEN ndv.MANHOMDICHVU            WHEN Left(ndv.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(ndv.MANHOMDICHVU,2)            END AS PHANLOAI_MANHOMDICHVU            from TM_DICHVU dv            left join TM_NHOMDICHVU ndv on dv.NHOMDICHVU_ID = ndv.NHOMDICHVU_ID                           where ndv.TAMNGUNG = '0' and dv.TAMNGUNG = '0' and dv.BENHVIEN_ID = 'HLU01') as tbl                 where                         PHANLOAI_MANHOMDICHVU in (select * from STRING_SPLIT(@PhanLoaiNhomDV,','))]
2020-02-26 09:54:52,132 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'ORM06'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 09:54:53,752 [1] DEBUG - Statement Id: [DAO00051_GetMauTuongTrinh] PreparedStatement : [select *            from TM_TUDIENKETQUA            where BENHVIEN_ID = 'HLU01'              and                 (NGUOITAO_ID = '1' OR SUDUNGCHUNG = '1')                and DICHVU_ID in  (                        @param0                   )               ORDER BY TENNOIDUNG]
2020-02-26 09:54:53,753 [1] DEBUG - Statement Id: [DAO00051_GetMauTuongTrinh] Parameters: [@param0=[LSTDICHVU_ID[0],1317]]
2020-02-26 09:54:53,754 [1] DEBUG - Statement Id: [DAO00051_GetMauTuongTrinh] Types: [@param0=[Int64, System.Int64]]
2020-02-26 09:58:15,214 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '107022'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2020-02-26 09:58:17,552 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'ORM07'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 09:58:17,868 [1] DEBUG - Statement Id: [DAO00012_GetList] PreparedStatement : [select        DICTIONARY_ID,        DICTIONARY_CODE,        DICTIONARY_NAME,        ATTRIBUTE1,        ATTRIBUTE2,        DICTIONARY_NAME_EN,        DICTIONARY_TYPE_CODE        from LST_DICTIONARY        where LST_DICTIONARY.Enabled = '1'         AND           LST_DICTIONARY.DICTIONARY_TYPE_CODE = 'KipMo_VaiTro'                 order by LST_DICTIONARY.IDX]
2020-02-26 09:58:25,501 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '107022'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2020-02-26 09:58:42,277 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '107022'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2020-02-26 09:58:42,365 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '107022'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2020-02-26 09:58:42,519 [1] DEBUG - Statement Id: [DAO00014_GetPatientStatus] PreparedStatement : [select        CASE        when tn.TRANGTHAI = 'HOANTHANH' Then tn.TRANGTHAI        WHEN xncp.XACNHANCHIPHI_ID is not null THEN 'XACNHANCHIPHI'        WHEN (tn.KHOADULIEU = '1') THEN 'KHOADULIEU'        ELSE tn.TRANGTHAI        END        as TRANGTHAI        from TT_TIEPNHAN tn        left join TT_XACNHANCHIPHI xncp on tn.TIEPNHAN_ID = xncp.TIEPNHAN_ID        where tn.TIEPNHAN_ID = '107022'        and tn.BENHVIEN_ID = 'HLU01']
2020-02-26 09:58:42,830 [1] DEBUG - Statement Id: [DAO00048_GetTrangThaiTruocKhiLuu_TuongTrinh] PreparedStatement : [SELECT PHAUTHUAT_YEUCAU_ID FROM TT_PHAUTHUAT_YEUCAU PTYC              WHERE BENHVIEN_ID ='HLU01'                and DVYEUCAU_ID in  (                        @param0                   )]
2020-02-26 09:58:42,830 [1] DEBUG - Statement Id: [DAO00048_GetTrangThaiTruocKhiLuu_TuongTrinh] Parameters: [@param0=[LISTDVYEUCAU_ID[0],988687]]
2020-02-26 09:58:42,830 [1] DEBUG - Statement Id: [DAO00048_GetTrangThaiTruocKhiLuu_TuongTrinh] Types: [@param0=[Int64, System.Int64]]
2020-02-26 09:59:22,071 [1] DEBUG - Statement Id: [DAO00050_GetDetail] PreparedStatement : [select *              from LST_KEYDATA_DICHVU               where                             LST_KEYDATA_DICHVU.KEYTYPE = 'SOPHIEUYEUCAUCLS'                       and                           LST_KEYDATA_DICHVU.KEYYEAR = '2020'                       and                           LST_KEYDATA_DICHVU.KEYMONTH = '0'                       and                           LST_KEYDATA_DICHVU.KEYDAY = '0'                       and                           LST_KEYDATA_DICHVU.SEGMENT_1 = '0621'                       and                           LST_KEYDATA_DICHVU.SEGMENT_2 = '0'                       and                           LST_KEYDATA_DICHVU.SEGMENT_3 = '0'                                     order by KEYTYPE]
2020-02-26 09:59:22,430 [1] DEBUG - Statement Id: [DAO00050_Update] PreparedStatement : [update LST_KEYDATA_DICHVU set              KEYVALUE =  @param0               where              KEYTYPE = 'SOPHIEUYEUCAUCLS'              AND KEYYEAR = '2020'              AND KEYMONTH = '0'              AND KEYDAY = '0'              AND SEGMENT_1 = '0621'              AND SEGMENT_2 = '0'              AND SEGMENT_3 = '0']
2020-02-26 09:59:22,430 [1] DEBUG - Statement Id: [DAO00050_Update] Parameters: [@param0=[KEYVALUE,00985]]
2020-02-26 09:59:22,430 [1] DEBUG - Statement Id: [DAO00050_Update] Types: [@param0=[String, System.String]]
2020-02-26 09:59:22,464 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_Add] PreparedStatement : [insert into TT_PHAUTHUAT (            SOPHIEUPHAUTHUAT            , LOAI            , BENHAN_ID            , LUUTRU_ID            , TIEPNHAN_ID            , PHONGBANTHUCHIEN_ID            , NGAYTHUCHIEN            , THOIGIANBATDAU            , THOIGIANKETTHUC            , ICD_VAOKHOA            , ICD_VAOKHOA_MOTA            , ICD_TRUOCPHAUTHUAT            , ICD_TRUOCPHAUTHUAT_MOTA            , ICD_SAUPHAUTHUAT            , ICD_SAUPHAUTHUAT_MOTA            , NHOMDICHVU_ID            , DICHVU_ID            , PHUONGPHAPVOCAM_ID            , TAIBIEN_ID            , CHEDO_ID            , TUVONG_ID            , TRINHTUTHUCHIEN            , MOTA            , KETQUA            , BENHNHANBENNGOAI            , NGUONBENH_ID            , LOAIPHAUTHUAT            , DANLUU            , NGAYRUT            , NGAYCATCHI            , KHAC            , SOLANMOLAI            , LYDOMOLAI            , CANTHIEPPHAUTHUAT            , TUDIENKETQUA_ID            , PHONGBANCHIDINH_ID            , PPMO_ID            , THOIGIANGAYME            , KHOADULIEU            , NGUOIKHOA_ID            , TENNGUOIKHOA            , NGAYKHOADULIEU            , THOIGIANKHOADULIEU            , NGAYTAO            , NGUOITAO_ID            , NGAYCAPNHAT            , NGUOICAPNHAT_ID            , BENHVIEN_ID                         , TRINHTUTHUCHIEN_TEXT            ) values (             @param0             ,  @param1             ,  @param2             ,  @param3             ,  @param4             ,  @param5             ,  @param6             ,  @param7             ,  @param8             ,  @param9             ,  @param10             ,  @param11             ,  @param12             ,  @param13             ,  @param14             ,  @param15             ,  @param16             ,  @param17             ,  @param18             ,  @param19             ,  @param20             ,  @param21             ,  @param22             ,  @param23             ,  @param24             ,  @param25             ,  @param26             ,  @param27             ,  @param28             ,  @param29             ,  @param30             ,  @param31             ,  @param32             ,  @param33             ,  @param34             ,  @param35             ,  @param36             ,  @param37             ,  @param38             ,  @param39             ,  @param40             ,  @param41             ,  @param42             ,  @param43             ,  @param44             ,  @param45             ,  @param46             ,  @param47                          ,  @param48             )            SELECT SCOPE_IDENTITY()]
2020-02-26 09:59:22,465 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_Add] Parameters: [@param0=[SOPHIEUPHAUTHUAT,20.P.00985], @param1=[LOAI,P], @param2=[BENHAN_ID,null], @param3=[LUUTRU_ID,null], @param4=[TIEPNHAN_ID,107022], @param5=[PHONGBANTHUCHIEN_ID,25], @param6=[NGAYTHUCHIEN,2/26/2020 9:59:22 AM], @param7=[THOIGIANBATDAU,2/26/2020 9:58:00 AM], @param8=[THOIGIANKETTHUC,2/26/2020 10:58:00 AM], @param9=[ICD_VAOKHOA,J20], @param10=[ICD_VAOKHOA_MOTA,Viêm phế quản cấp], @param11=[ICD_TRUOCPHAUTHUAT,J20], @param12=[ICD_TRUOCPHAUTHUAT_MOTA,Viêm phế quản cấp], @param13=[ICD_SAUPHAUTHUAT,J20], @param14=[ICD_SAUPHAUTHUAT_MOTA,Viêm phế quản cấp], @param15=[NHOMDICHVU_ID,null], @param16=[DICHVU_ID,null], @param17=[PHUONGPHAPVOCAM_ID,null], @param18=[TAIBIEN_ID,522], @param19=[CHEDO_ID,5190], @param20=[TUVONG_ID,null], @param21=[TRINHTUTHUCHIEN,<body>
	<div style="text-align:left;text-indent:0pt;margin:0pt 0pt 0pt 0pt;"><span style="color:#000000;background-color:transparent;font-family:Times New Roman;font-size:12pt;font-weight:normal;font-style:normal;">-Tư thế bệnh nh&acirc;n: Ngồi</span></div><div style="text-align:left;text-indent:0pt;margin:0pt 0pt 0pt 0pt;"><span style="color:#000000;background-color:transparent;font-family:Times New Roman;font-size:12pt;font-weight:normal;font-style:normal;">-Si&ecirc;u &acirc;m dịch m&agrave;ng phổi phải nhiều</span></div><div style="text-align:left;text-indent:0pt;margin:0pt 0pt 0pt 0pt;"><span style="color:#000000;background-color:transparent;font-family:Times New Roman;font-size:12pt;font-weight:normal;font-style:normal;">-X&aacute;c định vị tr&iacute; chọc, KLS 7-8 đường n&aacute;ch sau phải</span></div><div style="text-align:left;text-indent:0pt;margin:0pt 0pt 0pt 0pt;"><span style="color:#000000;background-color:transparent;font-family:Times New Roman;font-size:12pt;font-weight:normal;font-style:normal;">-S&aacute;t khuẩn rộng</span></div><div style="text-align:left;text-indent:0pt;margin:0pt 0pt 0pt 0pt;"><span style="color:#000000;background-color:transparent;font-family:Times New Roman;font-size:12pt;font-weight:normal;font-style:normal;">-Chọc kim luồn h&uacute;t ra dịch dễ, kết nối d&acirc;y truyền dịch.</span></div><div style="text-align:left;text-indent:0pt;margin:0pt 0pt 0pt 0pt;"><span style="color:#000000;background-color:transparent;font-family:Times New Roman;font-size:12pt;font-weight:normal;font-style:normal;">-Dẫn lưu được được 1000ml dịch m&agrave;u v&agrave;ng chanh</span></div><div style="text-align:left;text-indent:0pt;margin:0pt 0pt 0pt 0pt;"><span style="color:#000000;background-color:transparent;font-family:Times New Roman;font-size:12pt;font-weight:normal;font-style:normal;">-Thủ thuật thuận lợi, an to&agrave;n.</span></div></body>
], @param22=[MOTA,null], @param23=[KETQUA,null], @param24=[BENHNHANBENNGOAI,null], @param25=[NGUONBENH_ID,745], @param26=[LOAIPHAUTHUAT,PTH], @param27=[DANLUU,null], @param28=[NGAYRUT,null], @param29=[NGAYCATCHI,null], @param30=[KHAC,null], @param31=[SOLANMOLAI,1], @param32=[LYDOMOLAI,null], @param33=[CANTHIEPPHAUTHUAT,null], @param34=[TUDIENKETQUA_ID,null], @param35=[PHONGBANCHIDINH_ID,null], @param36=[PPMO_ID,null], @param37=[THOIGIANGAYME,null], @param38=[KHOADULIEU,0], @param39=[NGUOIKHOA_ID,null], @param40=[TENNGUOIKHOA,null], @param41=[NGAYKHOADULIEU,null], @param42=[THOIGIANKHOADULIEU,null], @param43=[NGAYTAO,2/26/2020 9:59:22 AM], @param44=[NGUOITAO_ID,1], @param45=[NGAYCAPNHAT,2/26/2020 9:59:22 AM], @param46=[NGUOICAPNHAT_ID,1], @param47=[BENHVIEN_ID,HLU01], @param48=[TRINHTUTHUCHIEN_TEXT,null]]
2020-02-26 09:59:22,465 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_Add] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[System.DBNull, null], @param3=[System.DBNull, null], @param4=[Int64, System.Int64], @param5=[Int64, System.Int64], @param6=[DateTime, System.DateTime], @param7=[DateTime, System.DateTime], @param8=[DateTime, System.DateTime], @param9=[String, System.String], @param10=[String, System.String], @param11=[String, System.String], @param12=[String, System.String], @param13=[String, System.String], @param14=[String, System.String], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Int64, System.Int64], @param19=[Int64, System.Int64], @param20=[System.DBNull, null], @param21=[String, System.String], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[Int64, System.Int64], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[Int64, System.Int64], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[System.DBNull, null], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[DateTime, System.DateTime], @param44=[Int64, System.Int64], @param45=[DateTime, System.DateTime], @param46=[Int64, System.Int64], @param47=[String, System.String], @param48=[System.DBNull, null]]
2020-02-26 09:59:22,651 [1] DEBUG - Statement Id: [DAO00087_GetServiceParams] PreparedStatement : [select CODE, VALUE              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01']
2020-02-26 09:59:22,831 [1] DEBUG - Statement Id: [DAO00049_KiemtraloaiDV] PreparedStatement : [select DICHVU_ID AS HA, '' AS XN, '' as TDCN, '' as TT, '' as KB from TM_DICHVU            left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = TM_DICHVU.NHOMDICHVU_ID            where DICHVU_ID = '1317' and left(ndv.MANHOMDICHVU, 2) = '02'            union            select  '' as HA, DICHVU_ID AS XN, '' as TDCN, '' as TT, '' as KB from TM_DICHVU            left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = TM_DICHVU.NHOMDICHVU_ID            where DICHVU_ID = '1317' and left(ndv.MANHOMDICHVU, 2) = '01'            union            select  '' as HA, '' AS XN, DICHVU_ID as TDCN, '' as TT, '' as KB from TM_DICHVU            left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = TM_DICHVU.NHOMDICHVU_ID            where DICHVU_ID = '1317' and left(ndv.MANHOMDICHVU, 2) = '03'            union            select  '' as HA, '' AS XN, '' as TDCN, DICHVU_ID as TT, '' as KB from TM_DICHVU            left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = TM_DICHVU.NHOMDICHVU_ID            where DICHVU_ID = '1317' and left(ndv.MANHOMDICHVU, 2) = '05'            union            select  '' as HA, '' AS XN, '' as TDCN, DICHVU_ID as TT, '' as KB from TM_DICHVU            left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = TM_DICHVU.NHOMDICHVU_ID            where DICHVU_ID = '1317' and left(ndv.MANHOMDICHVU, 2) = '06'            union            select  '' as HA, '' AS XN, '' as TDCN, '' as TT, DICHVU_ID as KB from TM_DICHVU            left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = TM_DICHVU.NHOMDICHVU_ID            where DICHVU_ID = '1317' and left(ndv.MANHOMDICHVU, 2) = '04']
2020-02-26 09:59:22,889 [1] DEBUG - Statement Id: [DAO00009_GetThutiensauDVThuthuat] PreparedStatement : [select A.THUTIENSAU, B.SOTIEPNHAN, A.DICHVU_ID, A.DVYEUCAU_ID        from TT_DVYEUCAU A        inner join TT_TIEPNHAN B on B.TIEPNHAN_ID = A.TIEPNHAN_ID        where        A.DVYEUCAU_ID = '988687']
2020-02-26 09:59:22,922 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN200102.0000093']
2020-02-26 09:59:22,951 [1] DEBUG - Statement Id: [DAOWF001_Kiemtrathongtindayeucaudacochua] PreparedStatement : [select * from TT_REQUEST        where        PARA = '{"HOSPITAL_ID":"HLU01","SOTIEPNHAN":"TN200102.0000093"}'        AND ISACTIVE = '1']
2020-02-26 09:59:23,330 [1] DEBUG - Statement Id: [DAOWF001_Kiemtrathongtindichvudayeucau] PreparedStatement : [select top 1 * from TT_REQUEST_SERVICE        where        PARA = '{"DICHVU_ID":"1317","DVYEUCAU_ID":"988687"}'                AND ISACTIVE = '1' order by ID desc]
2020-02-26 09:59:23,398 [1] DEBUG - Statement Id: [DAOWF001_KiemtrathongtinchitietDichvuYeucau] PreparedStatement : [select * from TT_REQUEST_SERVICE_DETAIL        where        REQUEST_SERVICE_ID = '555993']
2020-02-26 09:59:23,454 [1] DEBUG - Statement Id: [DAOWF001_Laythongtinwithstatecode] PreparedStatement : [select A.*, B.STATUS_CODE from        TM_STATE_ACTION A        left join TM_STATE B on B.STATE_CODE = A.NEXT_STATE_CODE and A.PROCESS_CODE = B.PROCESS_CODE        where        A.CURR_STATE_CODE = '1     '        AND A.PROCESS_CODE = 'P01'        Order By ORDER_ID ASC]
2020-02-26 09:59:23,540 [1] DEBUG - Statement Id: [DAOWF003_Update] PreparedStatement : [update TT_REQUEST_SERVICE set        CURR_STATE_CODE =  @param0                   , ISACTIVE =  @param1                     , ISCOMPLETE =  @param2                        where        ID = '555993']
2020-02-26 09:59:23,540 [1] DEBUG - Statement Id: [DAOWF003_Update] Parameters: [@param0=[CURR_STATE_CODE,2], @param1=[ISACTIVE,1], @param2=[ISCOMPLETE,0]]
2020-02-26 09:59:23,540 [1] DEBUG - Statement Id: [DAOWF003_Update] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[String, System.String]]
2020-02-26 09:59:23,601 [1] DEBUG - Statement Id: [DAOWF005_Add] PreparedStatement : [insert into TT_REQUEST_SERVICE_DETAIL (        REQUEST_ID        ,REQUEST_SERVICE_ID        , OLD_STATE_CODE        , CURR_STATE_CODE        ) values (         @param0         , @param1         ,  @param2         ,  @param3         )        SELECT SCOPE_IDENTITY()]
2020-02-26 09:59:23,601 [1] DEBUG - Statement Id: [DAOWF005_Add] Parameters: [@param0=[REQUEST_ID,111800], @param1=[REQUEST_SERVICE_ID,555993], @param2=[OLD_STATE_CODE,1     ], @param3=[CURR_STATE_CODE,2]]
2020-02-26 09:59:23,601 [1] DEBUG - Statement Id: [DAOWF005_Add] Types: [@param0=[String, System.String], @param1=[Int32, System.Int32], @param2=[String, System.String], @param3=[String, System.String]]
2020-02-26 09:59:23,646 [1] DEBUG - Statement Id: [DAOWF005_Add_History] PreparedStatement : [insert into TT_REQUEST_SERVICE_HISTORY (        REQUEST_ID        ,REQUEST_SERVICE_ID        , OLD_STATE_CODE        , CURR_STATE_CODE        ) values (         @param0         , @param1         ,  @param2         ,  @param3         )]
2020-02-26 09:59:23,646 [1] DEBUG - Statement Id: [DAOWF005_Add_History] Parameters: [@param0=[REQUEST_ID,111800], @param1=[REQUEST_SERVICE_ID,555993], @param2=[OLD_STATE_CODE,1     ], @param3=[CURR_STATE_CODE,2]]
2020-02-26 09:59:23,646 [1] DEBUG - Statement Id: [DAOWF005_Add_History] Types: [@param0=[String, System.String], @param1=[Int32, System.Int32], @param2=[String, System.String], @param3=[String, System.String]]
2020-02-26 09:59:23,705 [1] DEBUG - Statement Id: [DAO00009_TT_DVYEUCAU_Update] PreparedStatement : [Update TT_DVYEUCAU set TRANGTHAI_WFL = 'HOANTAT' where DVYEUCAU_ID = '988687']
2020-02-26 09:59:23,730 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_YEUCAU_Add] PreparedStatement : [insert into TT_PHAUTHUAT_YEUCAU (              PHAUTHUAT_ID              , DVYEUCAU_ID              , NHOMDICHVU_ID              , DICHVU_ID              , LOAIGIA_ID              , THANHTIEN_DOANHTHU              , BHYT_THANHTIEN_CHITRA              , BENHNHAN_PHAITHANHTOAN              , BENHVIEN_ID              ) values (               @param0               ,  @param1               ,  @param2               ,  @param3               ,  @param4               ,  @param5               ,  @param6               ,  @param7               ,  @param8               )]
2020-02-26 09:59:23,730 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_YEUCAU_Add] Parameters: [@param0=[PHAUTHUAT_ID,68087], @param1=[DVYEUCAU_ID,988687], @param2=[NHOMDICHVU_ID,26], @param3=[DICHVU_ID,1317], @param4=[LOAIGIA_ID,3], @param5=[THANHTIEN_DOANHTHU,1240000], @param6=[BHYT_THANHTIEN_CHITRA,0], @param7=[BENHNHAN_PHAITHANHTOAN,1240000], @param8=[BENHVIEN_ID,HLU01]]
2020-02-26 09:59:23,730 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_YEUCAU_Add] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64], @param2=[Int64, System.Int64], @param3=[Int64, System.Int64], @param4=[Int64, System.Int64], @param5=[Double, System.Double], @param6=[Double, System.Double], @param7=[Double, System.Double], @param8=[String, System.String]]
2020-02-26 09:59:23,762 [1] DEBUG - Statement Id: [DAO00048_UpdateDVYeuCauVienPhi] PreparedStatement : [update  TT_VIENPHI              set DATHUCHIEN = '1',              NGUOICAPNHAT_ID =  @param0 ,              NGAYCAPNHAT =  @param1               where              VIENPHI_ID =  @param2]
2020-02-26 09:59:23,762 [1] DEBUG - Statement Id: [DAO00048_UpdateDVYeuCauVienPhi] Parameters: [@param0=[NGUOICAPNHAT_ID,1], @param1=[NGAYCAPNHAT,2/26/2020 9:59:23 AM], @param2=[VIENPHI_ID,3108804]]
2020-02-26 09:59:23,762 [1] DEBUG - Statement Id: [DAO00048_UpdateDVYeuCauVienPhi] Types: [@param0=[Int64, System.Int64], @param1=[DateTime, System.DateTime], @param2=[Int64, System.Int64]]
2020-02-26 09:59:23,800 [1] DEBUG - Statement Id: [DAO00048_UpdateDVYeuCau] PreparedStatement : [update  TT_DVYEUCAU              set TRANGTHAI =  @param0 ,              NGUOICAPNHAT_ID =  @param1 ,              NGAYCAPNHAT =  @param2               where              DVYEUCAU_ID =  @param3]
2020-02-26 09:59:23,800 [1] DEBUG - Statement Id: [DAO00048_UpdateDVYeuCau] Parameters: [@param0=[TRANGTHAI,CHOXACNHAN], @param1=[NGUOICAPNHAT_ID,1], @param2=[NGAYCAPNHAT,2/26/2020 9:59:23 AM], @param3=[DVYEUCAU_ID,988687]]
2020-02-26 09:59:23,800 [1] DEBUG - Statement Id: [DAO00048_UpdateDVYeuCau] Types: [@param0=[String, System.String], @param1=[Int64, System.Int64], @param2=[DateTime, System.DateTime], @param3=[Int64, System.Int64]]
2020-02-26 09:59:23,832 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_PPVOCAM_Add] PreparedStatement : [insert into TT_PHAUTHUAT_PPVOCAM (              PHAUTHUAT_ID,              PPVOCAM_ID,              BENHVIEN_ID)              values (               @param0 ,               @param1 ,               @param2 )]
2020-02-26 09:59:23,832 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_PPVOCAM_Add] Parameters: [@param0=[PHAUTHUAT_ID,68087], @param1=[PPVOCAM_ID,516], @param2=[BENHVIEN_ID,HLU01]]
2020-02-26 09:59:23,832 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_PPVOCAM_Add] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64], @param2=[String, System.String]]
2020-02-26 09:59:23,934 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_EKIP_Add] PreparedStatement : [insert into TT_PHAUTHUAT_EKIP (              PHAUTHUAT_ID                ,                       NHANVIEN_ID                   ,                       VAITRO_ID                                 , PTVC_ID              , PPT1_ID              , PPT2_ID              , GMC_ID              , GMP_ID              , DCVT_ID              , DCVN_ID              , BSHC_ID              , BSTC_ID              , BENHVIEN_ID              ) values (               @param0                 ,                        @param1                    ,                        @param2                                  ,  @param3               ,  @param4               ,  @param5               ,  @param6               ,  @param7               ,  @param8               ,  @param9               ,  @param10               ,  @param11               ,  @param12               )]
2020-02-26 09:59:23,934 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_EKIP_Add] Parameters: [@param0=[PHAUTHUAT_ID,68087], @param1=[NHANVIEN_ID,34], @param2=[VAITRO_ID,748], @param3=[PTVC_ID,null], @param4=[PPT1_ID,null], @param5=[PPT2_ID,null], @param6=[GMC_ID,null], @param7=[GMP_ID,null], @param8=[DCVT_ID,null], @param9=[DCVN_ID,null], @param10=[BSHC_ID,null], @param11=[BSTC_ID,null], @param12=[BENHVIEN_ID,HLU01]]
2020-02-26 09:59:23,934 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_EKIP_Add] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[System.DBNull, null], @param5=[System.DBNull, null], @param6=[System.DBNull, null], @param7=[System.DBNull, null], @param8=[System.DBNull, null], @param9=[System.DBNull, null], @param10=[System.DBNull, null], @param11=[System.DBNull, null], @param12=[String, System.String]]
2020-02-26 09:59:24,171 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_GetList] PreparedStatement : [select *              from TT_PHAUTHUAT               where                             TT_PHAUTHUAT.LOAI = 'P'                       and                           TT_PHAUTHUAT.TIEPNHAN_ID = 107022                       and                           TT_PHAUTHUAT.BENHVIEN_ID = 'HLU01'                                     order by PHAUTHUAT_ID DESC]
2020-02-26 09:59:24,277 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_GetDetail] PreparedStatement : [select PT.*, TN.BENHNHAN_ID              from              TT_PHAUTHUAT PT, TT_TIEPNHAN TN              where              PT.TIEPNHAN_ID = TN.TIEPNHAN_ID              AND PHAUTHUAT_ID  = 68087]
2020-02-26 09:59:24,317 [1] DEBUG - Statement Id: [DAO00048_CheckDVPhauThuatBHYT] PreparedStatement : [select count(0) from TT_VIENPHI          where REF_TABLE = 'TT_DVYEUCAU' and REF_ID = (select top 1 DVYEUCAU_ID from TT_PHAUTHUAT_YEUCAU where PHAUTHUAT_ID =  @param0 )          and TIEPNHAN_ID =  @param1  and BHYT_DONGIA > 0]
2020-02-26 09:59:24,318 [1] DEBUG - Statement Id: [DAO00048_CheckDVPhauThuatBHYT] Parameters: [@param0=[PHAUTHUAT_ID,68087], @param1=[TIEPNHAN_ID,107022]]
2020-02-26 09:59:24,318 [1] DEBUG - Statement Id: [DAO00048_CheckDVPhauThuatBHYT] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64]]
2020-02-26 09:59:24,379 [1] DEBUG - Statement Id: [DAO00116_File_GetList] PreparedStatement : [select *              from TT_FILE_DINHKEM               where                             TT_FILE_DINHKEM.REF_TABLE = 'TT_PHAUTHUAT'                       and                           TT_FILE_DINHKEM.REF_ID = '68087'                       and                           TT_FILE_DINHKEM.BENHVIEN_ID = 'HLU01'                                     order by FILE_ID]
2020-02-26 09:59:24,471 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_EKIP_GetDetail] PreparedStatement : [select *              from TT_PHAUTHUAT_EKIP              where PHAUTHUAT_ID  = 68087]
2020-02-26 09:59:36,141 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '107022'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2020-02-26 09:59:36,344 [1] DEBUG - Statement Id: [DAO00014_GetORMServiceStatus] PreparedStatement : [select dvyc.TRANGTHAI, pt.NGUOIKHOA_ID, pt.NGUOITAO_ID        from TT_PHAUTHUAT pt        left join TT_PHAUTHUAT_YEUCAU ptyc on ptyc.PHAUTHUAT_ID = pt.PHAUTHUAT_ID        left join (select * from TT_DVYEUCAU where exists (select DVYEUCAU_ID from TT_PHAUTHUAT where TT_DVYEUCAU.DVYEUCAU_ID = DVYEUCAU_ID and PHAUTHUAT_ID = '68087')) dvyc        on ptyc.DVYEUCAU_ID = dvyc.DVYEUCAU_ID        where pt.PHAUTHUAT_ID = '68087']
2020-02-26 09:59:36,445 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '107022'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2020-02-26 09:59:36,521 [1] DEBUG - Statement Id: [DAO00014_GetPatientStatus] PreparedStatement : [select        CASE        when tn.TRANGTHAI = 'HOANTHANH' Then tn.TRANGTHAI        WHEN xncp.XACNHANCHIPHI_ID is not null THEN 'XACNHANCHIPHI'        WHEN (tn.KHOADULIEU = '1') THEN 'KHOADULIEU'        ELSE tn.TRANGTHAI        END        as TRANGTHAI        from TT_TIEPNHAN tn        left join TT_XACNHANCHIPHI xncp on tn.TIEPNHAN_ID = xncp.TIEPNHAN_ID        where tn.TIEPNHAN_ID = '107022'        and tn.BENHVIEN_ID = 'HLU01']
2020-02-26 09:59:36,596 [1] DEBUG - Statement Id: [DAO00048_GetTrangThaiTruocKhiXoa_TuongTrinh] PreparedStatement : [IF 'LUU'='XOA'              BEGIN              IF EXISTS              (              SELECT PHAUTHUAT_VTYT_ID              FROM TT_PHAUTHUAT_VTYT WHERE PHAUTHUAT_ID='68087' AND BENHVIEN_ID='HLU01'              )              BEGIN              SELECT -1 AS RESULT              END              ELSE              BEGIN              IF EXISTS ( SELECT PHAUTHUAT_ID FROM TT_PHAUTHUAT WHERE PHAUTHUAT_ID='68087' AND BENHVIEN_ID='HLU01' AND KHOADULIEU='1' )              BEGIN              SELECT -2 AS RESULT, NGUOIKHOA_ID   FROM TT_PHAUTHUAT WHERE PHAUTHUAT_ID='68087' AND BENHVIEN_ID='HLU01' AND KHOADULIEU='1'              END              ELSE              BEGIN              IF NOT EXISTS (SELECT PHAUTHUAT_ID FROM TT_PHAUTHUAT WHERE PHAUTHUAT_ID='68087' AND BENHVIEN_ID='HLU01')              BEGIN              SELECT -3 AS RESULT              END              ELSE              BEGIN              SELECT 1 AS RESULT              END              END              END              END              ELSE IF 'LUU'='LUU'              BEGIN              IF EXISTS ( SELECT PHAUTHUAT_ID FROM TT_PHAUTHUAT WHERE PHAUTHUAT_ID='68087' AND BENHVIEN_ID='HLU01' AND KHOADULIEU='1' )              BEGIN              SELECT -2 AS RESULT              END              ELSE              BEGIN              SELECT 1 AS RESULT              END              END              ELSE              BEGIN              SELECT 10 AS RESULT              END]
2020-02-26 09:59:52,321 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_Update] PreparedStatement : [update TT_PHAUTHUAT set              SOPHIEUPHAUTHUAT =  @param0               , LOAI =  @param1               , BENHAN_ID =  @param2               , LUUTRU_ID =  @param3               , TIEPNHAN_ID =  @param4               , PHONGBANTHUCHIEN_ID =  @param5               , NGAYTHUCHIEN =  @param6               , THOIGIANBATDAU =  @param7               , THOIGIANKETTHUC =  @param8               , ICD_VAOKHOA =  @param9               , ICD_VAOKHOA_MOTA =  @param10               , ICD_TRUOCPHAUTHUAT =  @param11               , ICD_TRUOCPHAUTHUAT_MOTA =  @param12               , ICD_SAUPHAUTHUAT =  @param13               , ICD_SAUPHAUTHUAT_MOTA =  @param14               , NHOMDICHVU_ID =  @param15               , DICHVU_ID =  @param16               , PHUONGPHAPVOCAM_ID =  @param17               , TAIBIEN_ID =  @param18               , CHEDO_ID =  @param19               , TUVONG_ID =  @param20               , TRINHTUTHUCHIEN =  @param21               , MOTA =  @param22               , KETQUA =  @param23               , BENHNHANBENNGOAI =  @param24               , NGUONBENH_ID =  @param25               , LOAIPHAUTHUAT =  @param26               , DANLUU =  @param27               , NGAYRUT =  @param28               , NGAYCATCHI =  @param29               , KHAC =  @param30               , SOLANMOLAI =  @param31               , LYDOMOLAI =  @param32               , CANTHIEPPHAUTHUAT =  @param33               , TUDIENKETQUA_ID =  @param34               , PHONGBANCHIDINH_ID =  @param35               , PPMO_ID =  @param36               , THOIGIANGAYME =  @param37               , KHOADULIEU =  @param38               , NGUOIKHOA_ID =  @param39               , TENNGUOIKHOA =  @param40               , NGAYKHOADULIEU =  @param41               , THOIGIANKHOADULIEU =  @param42                            , NGAYCAPNHAT =  @param43             , NGUOICAPNHAT_ID =  @param44             , BENHVIEN_ID =  @param45              ,               PHUONGPHAPPTTT =  @param46                          , TRINHTUTHUCHIEN_TEXT =  @param47             where            PHAUTHUAT_ID = 68087]
2020-02-26 09:59:52,322 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_Update] Parameters: [@param0=[SOPHIEUPHAUTHUAT,20.P.00985], @param1=[LOAI,P], @param2=[BENHAN_ID,null], @param3=[LUUTRU_ID,null], @param4=[TIEPNHAN_ID,107022], @param5=[PHONGBANTHUCHIEN_ID,25], @param6=[NGAYTHUCHIEN,2/26/2020 9:59:52 AM], @param7=[THOIGIANBATDAU,2/26/2020 9:58:00 AM], @param8=[THOIGIANKETTHUC,2/26/2020 10:58:00 AM], @param9=[ICD_VAOKHOA,J20], @param10=[ICD_VAOKHOA_MOTA,Viêm phế quản cấp], @param11=[ICD_TRUOCPHAUTHUAT,J20], @param12=[ICD_TRUOCPHAUTHUAT_MOTA,Viêm phế quản cấp], @param13=[ICD_SAUPHAUTHUAT,J20], @param14=[ICD_SAUPHAUTHUAT_MOTA,Viêm phế quản cấp], @param15=[NHOMDICHVU_ID,null], @param16=[DICHVU_ID,null], @param17=[PHUONGPHAPVOCAM_ID,null], @param18=[TAIBIEN_ID,522], @param19=[CHEDO_ID,5190], @param20=[TUVONG_ID,null], @param21=[TRINHTUTHUCHIEN,<body>
	<div style="text-align:left;text-indent:0pt;margin:0pt 0pt 0pt 0pt;"><span style="color:#000000;background-color:transparent;font-family:Times New Roman;font-size:12pt;font-weight:normal;font-style:normal;">-Tư thế bệnh nh&acirc;n: Ngồi</span></div><div style="text-align:left;text-indent:0pt;margin:0pt 0pt 0pt 0pt;"><span style="color:#000000;background-color:transparent;font-family:Times New Roman;font-size:12pt;font-weight:normal;font-style:normal;">-Si&ecirc;u &acirc;m dịch m&agrave;ng phổi phải nhiều</span></div><div style="text-align:left;text-indent:0pt;margin:0pt 0pt 0pt 0pt;"><span style="color:#000000;background-color:transparent;font-family:Times New Roman;font-size:12pt;font-weight:normal;font-style:normal;">-X&aacute;c định vị tr&iacute; chọc, KLS 7-8 đường n&aacute;ch sau phải</span></div><div style="text-align:left;text-indent:0pt;margin:0pt 0pt 0pt 0pt;"><span style="color:#000000;background-color:transparent;font-family:Times New Roman;font-size:12pt;font-weight:normal;font-style:normal;">-S&aacute;t khuẩn rộng</span></div><div style="text-align:left;text-indent:0pt;margin:0pt 0pt 0pt 0pt;"><span style="color:#000000;background-color:transparent;font-family:Times New Roman;font-size:12pt;font-weight:normal;font-style:normal;">-Chọc kim luồn h&uacute;t ra dịch dễ, kết nối d&acirc;y truyền dịch.</span></div><div style="text-align:left;text-indent:0pt;margin:0pt 0pt 0pt 0pt;"><span style="color:#000000;background-color:transparent;font-family:Times New Roman;font-size:12pt;font-weight:normal;font-style:normal;">-Dẫn lưu được được 1000ml dịch m&agrave;u v&agrave;ng chanh</span></div><div style="text-align:left;text-indent:0pt;margin:0pt 0pt 0pt 0pt;"><span style="color:#000000;background-color:transparent;font-family:Times New Roman;font-size:12pt;font-weight:normal;font-style:normal;">-Thủ thuật thuận lợi, an to&agrave;n.</span></div></body>
], @param22=[MOTA,null], @param23=[KETQUA,null], @param24=[BENHNHANBENNGOAI,null], @param25=[NGUONBENH_ID,745], @param26=[LOAIPHAUTHUAT,PTH], @param27=[DANLUU,null], @param28=[NGAYRUT,null], @param29=[NGAYCATCHI,null], @param30=[KHAC,null], @param31=[SOLANMOLAI,1], @param32=[LYDOMOLAI,null], @param33=[CANTHIEPPHAUTHUAT,null], @param34=[TUDIENKETQUA_ID,null], @param35=[PHONGBANCHIDINH_ID,null], @param36=[PPMO_ID,null], @param37=[THOIGIANGAYME,null], @param38=[KHOADULIEU,0], @param39=[NGUOIKHOA_ID,null], @param40=[TENNGUOIKHOA,null], @param41=[NGAYKHOADULIEU,null], @param42=[THOIGIANKHOADULIEU,null], @param43=[NGAYCAPNHAT,2/26/2020 9:59:52 AM], @param44=[NGUOICAPNHAT_ID,1], @param45=[BENHVIEN_ID,HLU01], @param46=[PHUONGPHAPPTTT,null], @param47=[TRINHTUTHUCHIEN_TEXT,-Tư thế bệnh nhân: Ngồi
-Siêu âm dịch màng phổi phải nhiều
-Xác định vị trí chọc, KLS 7-8 đường nách sau phải
-Sát khuẩn rộng
-Chọc kim luồn hút ra dịch dễ, kết nối dây truyền dịch.
-Dẫn lưu được được 1000ml dịch màu vàng chanh
-Thủ thuật thuận lợi, an toàn.]]
2020-02-26 09:59:52,322 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_Update] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[System.DBNull, null], @param3=[System.DBNull, null], @param4=[Int64, System.Int64], @param5=[Int64, System.Int64], @param6=[DateTime, System.DateTime], @param7=[DateTime, System.DateTime], @param8=[DateTime, System.DateTime], @param9=[String, System.String], @param10=[String, System.String], @param11=[String, System.String], @param12=[String, System.String], @param13=[String, System.String], @param14=[String, System.String], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Int64, System.Int64], @param19=[Int64, System.Int64], @param20=[System.DBNull, null], @param21=[String, System.String], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[Int64, System.Int64], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[Int64, System.Int64], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[System.DBNull, null], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[DateTime, System.DateTime], @param44=[Int64, System.Int64], @param45=[String, System.String], @param46=[System.DBNull, null], @param47=[String, System.String]]
2020-02-26 09:59:52,551 [1] DEBUG - Statement Id: [DAO00049_KiemtraloaiDV] PreparedStatement : [select DICHVU_ID AS HA, '' AS XN, '' as TDCN, '' as TT, '' as KB from TM_DICHVU            left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = TM_DICHVU.NHOMDICHVU_ID            where DICHVU_ID = '' and left(ndv.MANHOMDICHVU, 2) = '02'            union            select  '' as HA, DICHVU_ID AS XN, '' as TDCN, '' as TT, '' as KB from TM_DICHVU            left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = TM_DICHVU.NHOMDICHVU_ID            where DICHVU_ID = '' and left(ndv.MANHOMDICHVU, 2) = '01'            union            select  '' as HA, '' AS XN, DICHVU_ID as TDCN, '' as TT, '' as KB from TM_DICHVU            left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = TM_DICHVU.NHOMDICHVU_ID            where DICHVU_ID = '' and left(ndv.MANHOMDICHVU, 2) = '03'            union            select  '' as HA, '' AS XN, '' as TDCN, DICHVU_ID as TT, '' as KB from TM_DICHVU            left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = TM_DICHVU.NHOMDICHVU_ID            where DICHVU_ID = '' and left(ndv.MANHOMDICHVU, 2) = '05'            union            select  '' as HA, '' AS XN, '' as TDCN, DICHVU_ID as TT, '' as KB from TM_DICHVU            left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = TM_DICHVU.NHOMDICHVU_ID            where DICHVU_ID = '' and left(ndv.MANHOMDICHVU, 2) = '06'            union            select  '' as HA, '' AS XN, '' as TDCN, '' as TT, DICHVU_ID as KB from TM_DICHVU            left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = TM_DICHVU.NHOMDICHVU_ID            where DICHVU_ID = '' and left(ndv.MANHOMDICHVU, 2) = '04']
2020-02-26 09:59:52,614 [1] DEBUG - Statement Id: [DAO00009_GetThutiensauDVThuthuatPhauThuat] PreparedStatement : [select A.THUTIENSAU, B.SOTIEPNHAN, A.DICHVU_ID, A.DVYEUCAU_ID        from TT_DVYEUCAU A        inner join TT_TIEPNHAN B on B.TIEPNHAN_ID = A.TIEPNHAN_ID        inner join TT_PHAUTHUAT_YEUCAU C on C.DVYEUCAU_ID = A.DVYEUCAU_ID        where C.PHAUTHUAT_ID =  '68087']
2020-02-26 09:59:52,812 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN200102.0000093']
2020-02-26 09:59:52,843 [1] DEBUG - Statement Id: [DAOWF001_Kiemtrathongtindayeucaureturn] PreparedStatement : [select * from TT_REQUEST        where        PARA = '{"HOSPITAL_ID":"HLU01","SOTIEPNHAN":"TN200102.0000093"}']
2020-02-26 09:59:52,939 [1] DEBUG - Statement Id: [DAOWF001_Kiemtrathongtindichvudayeucaureturn] PreparedStatement : [select top 1 * from TT_REQUEST_SERVICE        where        PARA = '{"DICHVU_ID":"1317","DVYEUCAU_ID":"988687"}'  order by ID desc]
2020-02-26 09:59:53,130 [1] DEBUG - Statement Id: [DAOWF005_ReturnStateCuaDichVuYeuCau] PreparedStatement : [declare        @Detail_Id int,        @CurentState char(8),        @OldState char(8)          select top 1 @Detail_Id = ID, @CurentState = OLD_STATE_CODE, @OldState = CURR_STATE_CODE from TT_REQUEST_SERVICE_DETAIL        where        REQUEST_ID = '111800'        AND REQUEST_SERVICE_ID = '555993'        order by ID desc;          update TT_REQUEST_SERVICE set CURR_STATE_CODE = @CurentState, ISACTIVE = 1, ISCOMPLETE = 0 where ID = '555993';        delete from TT_REQUEST_SERVICE_DETAIL where ID = @Detail_Id;        insert into TT_REQUEST_SERVICE_HISTORY        (REQUEST_ID,REQUEST_SERVICE_ID, OLD_STATE_CODE, CURR_STATE_CODE) values ('111800','555993',@OldState, @CurentState);        select top 1 A.*, B.STATUS_CODE from TT_REQUEST_SERVICE A        left join TM_STATE B on A.CURR_STATE_CODE = B.STATE_CODE and A.PROCESS_CODE = B.PROCESS_CODE        where A.ID = '555993';]
2020-02-26 09:59:53,196 [1] DEBUG - Statement Id: [DAO00009_TT_DVYEUCAU_Update] PreparedStatement : [Update TT_DVYEUCAU set TRANGTHAI_WFL = 'CHUAKETQUA' where DVYEUCAU_ID = '988687']
2020-02-26 09:59:53,241 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_YEUCAU_DeleteP] PreparedStatement : [delete from TT_PHAUTHUAT_YEUCAU             where                     TT_PHAUTHUAT_YEUCAU.PHAUTHUAT_ID = '68087']
2020-02-26 09:59:53,348 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_PPVOCAM_DeleteP] PreparedStatement : [delete from TT_PHAUTHUAT_PPVOCAM              where PHAUTHUAT_ID = '68087']
2020-02-26 09:59:53,389 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_IMAGES_DeleteP] PreparedStatement : [delete from TT_PHAUTHUAT_IMAGES               where                             TT_PHAUTHUAT_IMAGES.PHAUTHUAT_ID = '68087']
2020-02-26 09:59:53,460 [1] DEBUG - Statement Id: [DAO00049_KiemtraloaiDV] PreparedStatement : [select DICHVU_ID AS HA, '' AS XN, '' as TDCN, '' as TT, '' as KB from TM_DICHVU            left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = TM_DICHVU.NHOMDICHVU_ID            where DICHVU_ID = '1317' and left(ndv.MANHOMDICHVU, 2) = '02'            union            select  '' as HA, DICHVU_ID AS XN, '' as TDCN, '' as TT, '' as KB from TM_DICHVU            left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = TM_DICHVU.NHOMDICHVU_ID            where DICHVU_ID = '1317' and left(ndv.MANHOMDICHVU, 2) = '01'            union            select  '' as HA, '' AS XN, DICHVU_ID as TDCN, '' as TT, '' as KB from TM_DICHVU            left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = TM_DICHVU.NHOMDICHVU_ID            where DICHVU_ID = '1317' and left(ndv.MANHOMDICHVU, 2) = '03'            union            select  '' as HA, '' AS XN, '' as TDCN, DICHVU_ID as TT, '' as KB from TM_DICHVU            left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = TM_DICHVU.NHOMDICHVU_ID            where DICHVU_ID = '1317' and left(ndv.MANHOMDICHVU, 2) = '05'            union            select  '' as HA, '' AS XN, '' as TDCN, DICHVU_ID as TT, '' as KB from TM_DICHVU            left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = TM_DICHVU.NHOMDICHVU_ID            where DICHVU_ID = '1317' and left(ndv.MANHOMDICHVU, 2) = '06'            union            select  '' as HA, '' AS XN, '' as TDCN, '' as TT, DICHVU_ID as KB from TM_DICHVU            left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = TM_DICHVU.NHOMDICHVU_ID            where DICHVU_ID = '1317' and left(ndv.MANHOMDICHVU, 2) = '04']
2020-02-26 09:59:53,493 [1] DEBUG - Statement Id: [DAO00009_GetThutiensauDVThuthuat] PreparedStatement : [select A.THUTIENSAU, B.SOTIEPNHAN, A.DICHVU_ID, A.DVYEUCAU_ID        from TT_DVYEUCAU A        inner join TT_TIEPNHAN B on B.TIEPNHAN_ID = A.TIEPNHAN_ID        where        A.DVYEUCAU_ID = '988687']
2020-02-26 09:59:53,521 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN200102.0000093']
2020-02-26 09:59:53,556 [1] DEBUG - Statement Id: [DAOWF001_Kiemtrathongtindayeucaudacochua] PreparedStatement : [select * from TT_REQUEST        where        PARA = '{"HOSPITAL_ID":"HLU01","SOTIEPNHAN":"TN200102.0000093"}'        AND ISACTIVE = '1']
2020-02-26 09:59:53,658 [1] DEBUG - Statement Id: [DAOWF001_Kiemtrathongtindichvudayeucau] PreparedStatement : [select top 1 * from TT_REQUEST_SERVICE        where        PARA = '{"DICHVU_ID":"1317","DVYEUCAU_ID":"988687"}'                AND ISACTIVE = '1' order by ID desc]
2020-02-26 09:59:53,689 [1] DEBUG - Statement Id: [DAOWF001_KiemtrathongtinchitietDichvuYeucau] PreparedStatement : [select * from TT_REQUEST_SERVICE_DETAIL        where        REQUEST_SERVICE_ID = '555993']
2020-02-26 09:59:53,739 [1] DEBUG - Statement Id: [DAOWF001_Laythongtinwithstatecode] PreparedStatement : [select A.*, B.STATUS_CODE from        TM_STATE_ACTION A        left join TM_STATE B on B.STATE_CODE = A.NEXT_STATE_CODE and A.PROCESS_CODE = B.PROCESS_CODE        where        A.CURR_STATE_CODE = '1     '        AND A.PROCESS_CODE = 'P01'        Order By ORDER_ID ASC]
2020-02-26 09:59:53,765 [1] DEBUG - Statement Id: [DAOWF003_Update] PreparedStatement : [update TT_REQUEST_SERVICE set        CURR_STATE_CODE =  @param0                   , ISACTIVE =  @param1                     , ISCOMPLETE =  @param2                        where        ID = '555993']
2020-02-26 09:59:53,765 [1] DEBUG - Statement Id: [DAOWF003_Update] Parameters: [@param0=[CURR_STATE_CODE,2], @param1=[ISACTIVE,1], @param2=[ISCOMPLETE,0]]
2020-02-26 09:59:53,765 [1] DEBUG - Statement Id: [DAOWF003_Update] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[String, System.String]]
2020-02-26 09:59:53,789 [1] DEBUG - Statement Id: [DAOWF005_Add] PreparedStatement : [insert into TT_REQUEST_SERVICE_DETAIL (        REQUEST_ID        ,REQUEST_SERVICE_ID        , OLD_STATE_CODE        , CURR_STATE_CODE        ) values (         @param0         , @param1         ,  @param2         ,  @param3         )        SELECT SCOPE_IDENTITY()]
2020-02-26 09:59:53,789 [1] DEBUG - Statement Id: [DAOWF005_Add] Parameters: [@param0=[REQUEST_ID,111800], @param1=[REQUEST_SERVICE_ID,555993], @param2=[OLD_STATE_CODE,1     ], @param3=[CURR_STATE_CODE,2]]
2020-02-26 09:59:53,789 [1] DEBUG - Statement Id: [DAOWF005_Add] Types: [@param0=[String, System.String], @param1=[Int32, System.Int32], @param2=[String, System.String], @param3=[String, System.String]]
2020-02-26 09:59:53,877 [1] DEBUG - Statement Id: [DAOWF005_Add_History] PreparedStatement : [insert into TT_REQUEST_SERVICE_HISTORY (        REQUEST_ID        ,REQUEST_SERVICE_ID        , OLD_STATE_CODE        , CURR_STATE_CODE        ) values (         @param0         , @param1         ,  @param2         ,  @param3         )]
2020-02-26 09:59:53,877 [1] DEBUG - Statement Id: [DAOWF005_Add_History] Parameters: [@param0=[REQUEST_ID,111800], @param1=[REQUEST_SERVICE_ID,555993], @param2=[OLD_STATE_CODE,1     ], @param3=[CURR_STATE_CODE,2]]
2020-02-26 09:59:53,877 [1] DEBUG - Statement Id: [DAOWF005_Add_History] Types: [@param0=[String, System.String], @param1=[Int32, System.Int32], @param2=[String, System.String], @param3=[String, System.String]]
2020-02-26 09:59:53,917 [1] DEBUG - Statement Id: [DAO00009_TT_DVYEUCAU_Update] PreparedStatement : [Update TT_DVYEUCAU set TRANGTHAI_WFL = 'HOANTAT' where DVYEUCAU_ID = '988687']
2020-02-26 09:59:53,972 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_YEUCAU_Add] PreparedStatement : [insert into TT_PHAUTHUAT_YEUCAU (              PHAUTHUAT_ID              , DVYEUCAU_ID              , NHOMDICHVU_ID              , DICHVU_ID              , LOAIGIA_ID              , THANHTIEN_DOANHTHU              , BHYT_THANHTIEN_CHITRA              , BENHNHAN_PHAITHANHTOAN              , BENHVIEN_ID              ) values (               @param0               ,  @param1               ,  @param2               ,  @param3               ,  @param4               ,  @param5               ,  @param6               ,  @param7               ,  @param8               )]
2020-02-26 09:59:53,972 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_YEUCAU_Add] Parameters: [@param0=[PHAUTHUAT_ID,68087], @param1=[DVYEUCAU_ID,988687], @param2=[NHOMDICHVU_ID,26], @param3=[DICHVU_ID,1317], @param4=[LOAIGIA_ID,3], @param5=[THANHTIEN_DOANHTHU,1240000], @param6=[BHYT_THANHTIEN_CHITRA,0], @param7=[BENHNHAN_PHAITHANHTOAN,1240000], @param8=[BENHVIEN_ID,HLU01]]
2020-02-26 09:59:53,972 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_YEUCAU_Add] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64], @param2=[Int64, System.Int64], @param3=[Int64, System.Int64], @param4=[Int64, System.Int64], @param5=[Double, System.Double], @param6=[Double, System.Double], @param7=[Double, System.Double], @param8=[String, System.String]]
2020-02-26 09:59:54,020 [1] DEBUG - Statement Id: [DAO00048_UpdateDVYeuCauVienPhi] PreparedStatement : [update  TT_VIENPHI              set DATHUCHIEN = '1',              NGUOICAPNHAT_ID =  @param0 ,              NGAYCAPNHAT =  @param1               where              VIENPHI_ID =  @param2]
2020-02-26 09:59:54,020 [1] DEBUG - Statement Id: [DAO00048_UpdateDVYeuCauVienPhi] Parameters: [@param0=[NGUOICAPNHAT_ID,1], @param1=[NGAYCAPNHAT,2/26/2020 9:59:54 AM], @param2=[VIENPHI_ID,3108804]]
2020-02-26 09:59:54,020 [1] DEBUG - Statement Id: [DAO00048_UpdateDVYeuCauVienPhi] Types: [@param0=[Int64, System.Int64], @param1=[DateTime, System.DateTime], @param2=[Int64, System.Int64]]
2020-02-26 09:59:54,045 [1] DEBUG - Statement Id: [DAO00048_UpdateDVYeuCau] PreparedStatement : [update  TT_DVYEUCAU              set TRANGTHAI =  @param0 ,              NGUOICAPNHAT_ID =  @param1 ,              NGAYCAPNHAT =  @param2               where              DVYEUCAU_ID =  @param3]
2020-02-26 09:59:54,046 [1] DEBUG - Statement Id: [DAO00048_UpdateDVYeuCau] Parameters: [@param0=[TRANGTHAI,CHOXACNHAN], @param1=[NGUOICAPNHAT_ID,1], @param2=[NGAYCAPNHAT,2/26/2020 9:59:54 AM], @param3=[DVYEUCAU_ID,988687]]
2020-02-26 09:59:54,046 [1] DEBUG - Statement Id: [DAO00048_UpdateDVYeuCau] Types: [@param0=[String, System.String], @param1=[Int64, System.Int64], @param2=[DateTime, System.DateTime], @param3=[Int64, System.Int64]]
2020-02-26 09:59:54,071 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_PPVOCAM_Add] PreparedStatement : [insert into TT_PHAUTHUAT_PPVOCAM (              PHAUTHUAT_ID,              PPVOCAM_ID,              BENHVIEN_ID)              values (               @param0 ,               @param1 ,               @param2 )]
2020-02-26 09:59:54,072 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_PPVOCAM_Add] Parameters: [@param0=[PHAUTHUAT_ID,68087], @param1=[PPVOCAM_ID,516], @param2=[BENHVIEN_ID,HLU01]]
2020-02-26 09:59:54,072 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_PPVOCAM_Add] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64], @param2=[String, System.String]]
2020-02-26 09:59:54,160 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_GetDetail] PreparedStatement : [select PT.*, TN.BENHNHAN_ID              from              TT_PHAUTHUAT PT, TT_TIEPNHAN TN              where              PT.TIEPNHAN_ID = TN.TIEPNHAN_ID              AND PHAUTHUAT_ID  = 68087]
2020-02-26 09:59:54,327 [1] DEBUG - Statement Id: [DAO00048_CheckDVPhauThuatBHYT] PreparedStatement : [select count(0) from TT_VIENPHI          where REF_TABLE = 'TT_DVYEUCAU' and REF_ID = (select top 1 DVYEUCAU_ID from TT_PHAUTHUAT_YEUCAU where PHAUTHUAT_ID =  @param0 )          and TIEPNHAN_ID =  @param1  and BHYT_DONGIA > 0]
2020-02-26 09:59:54,327 [1] DEBUG - Statement Id: [DAO00048_CheckDVPhauThuatBHYT] Parameters: [@param0=[PHAUTHUAT_ID,68087], @param1=[TIEPNHAN_ID,107022]]
2020-02-26 09:59:54,327 [1] DEBUG - Statement Id: [DAO00048_CheckDVPhauThuatBHYT] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64]]
2020-02-26 09:59:54,399 [1] DEBUG - Statement Id: [DAO00116_File_GetList] PreparedStatement : [select *              from TT_FILE_DINHKEM               where                             TT_FILE_DINHKEM.REF_TABLE = 'TT_PHAUTHUAT'                       and                           TT_FILE_DINHKEM.REF_ID = '68087'                       and                           TT_FILE_DINHKEM.BENHVIEN_ID = 'HLU01'                                     order by FILE_ID]
2020-02-26 09:59:54,494 [1] DEBUG - Statement Id: [DAO00051_GetMauTuongTrinh] PreparedStatement : [select *            from TM_TUDIENKETQUA            where BENHVIEN_ID = 'HLU01'              and                 (NGUOITAO_ID = '1' OR SUDUNGCHUNG = '1')                and DICHVU_ID in  (                        @param0                   )               ORDER BY TENNOIDUNG]
2020-02-26 09:59:54,494 [1] DEBUG - Statement Id: [DAO00051_GetMauTuongTrinh] Parameters: [@param0=[LSTDICHVU_ID[0],1317]]
2020-02-26 09:59:54,494 [1] DEBUG - Statement Id: [DAO00051_GetMauTuongTrinh] Types: [@param0=[Int64, System.Int64]]
2020-02-26 09:59:54,544 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_GetDetail] PreparedStatement : [select PT.*, TN.BENHNHAN_ID              from              TT_PHAUTHUAT PT, TT_TIEPNHAN TN              where              PT.TIEPNHAN_ID = TN.TIEPNHAN_ID              AND PHAUTHUAT_ID  = 68087]
2020-02-26 09:59:54,580 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_IMAGES_GetList] PreparedStatement : [select *              from TT_PHAUTHUAT_IMAGES               where                             TT_PHAUTHUAT_IMAGES.PHAUTHUAT_ID = '68087'                       and                           TT_PHAUTHUAT_IMAGES.BENHVIEN_ID = 'HLU01'                                     order by IMAGES_ID]
2020-02-26 10:00:00,606 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_YEUCAU_GetList] PreparedStatement : [SELECT YC.[PHAUTHUAT_YEUCAU_ID]              ,YC.[PHAUTHUAT_ID]              ,YC.[DVYEUCAU_ID]              ,YC.[NHOMDICHVU_ID]              ,YC.[DICHVU_ID]              ,YC.[LOAIGIA_ID]              ,VP.[BHYT_THANHTIEN_CHITRA]              ,VP.[BENHNHAN_PHAITHANHTOAN]              ,VP.[THANHTIEN_DOANHTHU]              ,YC.[BENHVIEN_ID]              ,DVYC.NGAYGIOYEUCAU              ,DV.TENDICHVU              ,NDV.TENNHOMDICHVU              FROM [TT_PHAUTHUAT_YEUCAU] YC              INNER JOIN TT_VIENPHI VP ON YC.DVYEUCAU_ID= VP.REF_ID AND VP.REF_TABLE ='TT_DVYEUCAU'              INNER JOIN TT_DVYEUCAU DVYC ON DVYC.DVYEUCAU_ID = YC.DVYEUCAU_ID              INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = DVYC.DICHVU_ID              INNER JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID               where                             YC.PHAUTHUAT_ID = '68087'                       and                           YC.BENHVIEN_ID = 'HLU01'                                     order by PHAUTHUAT_YEUCAU_ID]
2020-02-26 10:00:00,666 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_PPVOCAM_GetDetail] PreparedStatement : [select *              from TT_PHAUTHUAT_PPVOCAM              where PHAUTHUAT_ID  = 68087]
2020-02-26 10:00:00,828 [1] DEBUG - Statement Id: [DAO00019_ThongTinBenhNhanTiepNhan] PreparedStatement : [select distinct A.SOTIEPNHAN, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        B.*, A.SOBHYT        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'        where                    A.TIEPNHAN_ID = '105640'                 and A.BENHVIEN_ID = 'HLU01']
2020-02-26 10:00:00,930 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_GetList] PreparedStatement : [select *              from TT_PHAUTHUAT               where                             TT_PHAUTHUAT.LOAI = 'P'                       and                           TT_PHAUTHUAT.TIEPNHAN_ID = 105640                       and                           TT_PHAUTHUAT.BENHVIEN_ID = 'HLU01'                                     order by PHAUTHUAT_ID DESC]
2020-02-26 10:00:01,000 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '105640'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2020-02-26 10:00:01,346 [1] DEBUG - Statement Id: [DAO00048_GetBenhNhanByBenhNhanID] PreparedStatement : [SELECT *              FROM              TT_BENHNHAN               where                             BENHNHAN_ID = '73393']
2020-02-26 10:00:01,373 [1] DEBUG - Statement Id: [DAO00000_GetDoiTuongIsBHYT] PreparedStatement : [select * from TM_DOITUONG Where DOITUONG_ID = 4 and MADOITUONG like '%BHYT%']
2020-02-26 10:00:01,707 [1] DEBUG - Statement Id: [DAO00048_GetDICHVUYCByTiepNhanID] PreparedStatement : [SELECT DISTINCT D.HOPDONG_ID, D.HOPDONG_BENHNHAN_ID, D.DVYEUCAU_ID, D.DICHVU_ID, D.SOPHIEUYEUCAU, D.NGAYGIOYEUCAU, D.NOITHUCHIEN_ID, P.LOAIPHAUTHUAT, L.STT AS STT_LOAIPHAUTHUAT            FROM            TT_DVYEUCAU AS D            left join TM_PHANLOAIPHAUTHUAT AS P ON D.DICHVU_ID = P.DICHVU_ID            left join TM_LOAIPHAUTHUAT AS L ON L.LOAIPHAUTHUAT = P.LOAIPHAUTHUAT            where            not exists (select DVYEUCAU_ID from TT_PHAUTHUAT_YEUCAU where D.DVYEUCAU_ID = DVYEUCAU_ID)               and                       exists                      (select DICHVU_ID from TM_DICHVU                      where D.DICHVU_ID = DICHVU_ID and                      exists                      (select NHOMDICHVU_ID from TM_NHOMDICHVU                      where TM_DICHVU.NHOMDICHVU_ID = NHOMDICHVU_ID and left(MANHOMDICHVU,2) in (05)                      )                                             )                     and                           D.TIEPNHAN_ID = '105640']
2020-02-26 10:00:01,863 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '105640'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2020-02-26 10:00:01,942 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN191230.0000046']
2020-02-26 10:00:02,010 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"3832","DVYEUCAU_ID":"975219"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"3832","DVYEUCAU_ID":"975219"}' order by ID desc)        order by A.ID desc]
2020-02-26 10:00:03,902 [1] DEBUG - Statement Id: [DAO00048_GetDVYeuCauByDVYeuCauID] PreparedStatement : [SELECT A.*, B.NGAYGIOYEUCAU, C.TENDICHVU, D.TENNHOMDICHVU, D.NHOMDICHVU_ID            FROM TT_VIENPHI A            left join TT_DVYEUCAU B on A.REF_ID = B.DVYEUCAU_ID            inner join TM_DICHVU C on C.DICHVU_ID = B.DICHVU_ID            inner join TM_NHOMDICHVU D on D.NHOMDICHVU_ID = C.NHOMDICHVU_ID            WHERE            A.REF_ID IN (975219)            and A.REF_TABLE='TT_DVYEUCAU'            AND A.TIEPNHAN_ID = 105640]
2020-02-26 10:00:14,793 [1] DEBUG - Statement Id: [DAO00051_GetMauTuongTrinh] PreparedStatement : [select *            from TM_TUDIENKETQUA            where BENHVIEN_ID = 'HLU01'              and                 (NGUOITAO_ID = '1' OR SUDUNGCHUNG = '1')                and DICHVU_ID in  (                        @param0                   )               ORDER BY TENNOIDUNG]
2020-02-26 10:00:14,793 [1] DEBUG - Statement Id: [DAO00051_GetMauTuongTrinh] Parameters: [@param0=[LSTDICHVU_ID[0],3832]]
2020-02-26 10:00:14,793 [1] DEBUG - Statement Id: [DAO00051_GetMauTuongTrinh] Types: [@param0=[Int64, System.Int64]]
2020-02-26 10:00:41,237 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '105640'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2020-02-26 10:00:41,314 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '105640'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2020-02-26 10:00:41,390 [1] DEBUG - Statement Id: [DAO00014_GetPatientStatus] PreparedStatement : [select        CASE        when tn.TRANGTHAI = 'HOANTHANH' Then tn.TRANGTHAI        WHEN xncp.XACNHANCHIPHI_ID is not null THEN 'XACNHANCHIPHI'        WHEN (tn.KHOADULIEU = '1') THEN 'KHOADULIEU'        ELSE tn.TRANGTHAI        END        as TRANGTHAI        from TT_TIEPNHAN tn        left join TT_XACNHANCHIPHI xncp on tn.TIEPNHAN_ID = xncp.TIEPNHAN_ID        where tn.TIEPNHAN_ID = '105640'        and tn.BENHVIEN_ID = 'HLU01']
2020-02-26 10:00:53,744 [1] DEBUG - Statement Id: [DAO00019_ThongTinBenhNhanTiepNhan] PreparedStatement : [select distinct A.SOTIEPNHAN, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        B.*, A.SOBHYT        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'        where                    A.TIEPNHAN_ID = '99533'                 and A.BENHVIEN_ID = 'HLU01']
2020-02-26 10:00:53,947 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_GetList] PreparedStatement : [select *              from TT_PHAUTHUAT               where                             TT_PHAUTHUAT.LOAI = 'P'                       and                           TT_PHAUTHUAT.TIEPNHAN_ID = 99533                       and                           TT_PHAUTHUAT.BENHVIEN_ID = 'HLU01'                                     order by PHAUTHUAT_ID DESC]
2020-02-26 10:00:54,010 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '99533'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2020-02-26 10:00:54,123 [1] DEBUG - Statement Id: [DAO00048_GetBenhNhanByBenhNhanID] PreparedStatement : [SELECT *              FROM              TT_BENHNHAN               where                             BENHNHAN_ID = '69991']
2020-02-26 10:00:54,153 [1] DEBUG - Statement Id: [DAO00000_GetDoiTuongIsBHYT] PreparedStatement : [select * from TM_DOITUONG Where DOITUONG_ID = 1 and MADOITUONG like '%BHYT%']
2020-02-26 10:00:54,342 [1] DEBUG - Statement Id: [DAO00048_GetDICHVUYCByTiepNhanID] PreparedStatement : [SELECT DISTINCT D.HOPDONG_ID, D.HOPDONG_BENHNHAN_ID, D.DVYEUCAU_ID, D.DICHVU_ID, D.SOPHIEUYEUCAU, D.NGAYGIOYEUCAU, D.NOITHUCHIEN_ID, P.LOAIPHAUTHUAT, L.STT AS STT_LOAIPHAUTHUAT            FROM            TT_DVYEUCAU AS D            left join TM_PHANLOAIPHAUTHUAT AS P ON D.DICHVU_ID = P.DICHVU_ID            left join TM_LOAIPHAUTHUAT AS L ON L.LOAIPHAUTHUAT = P.LOAIPHAUTHUAT            where            not exists (select DVYEUCAU_ID from TT_PHAUTHUAT_YEUCAU where D.DVYEUCAU_ID = DVYEUCAU_ID)               and                       exists                      (select DICHVU_ID from TM_DICHVU                      where D.DICHVU_ID = DICHVU_ID and                      exists                      (select NHOMDICHVU_ID from TM_NHOMDICHVU                      where TM_DICHVU.NHOMDICHVU_ID = NHOMDICHVU_ID and left(MANHOMDICHVU,2) in (05)                      )                                             )                     and                           D.TIEPNHAN_ID = '99533']
2020-02-26 10:00:54,473 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '99533'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2020-02-26 10:00:54,549 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN191213.0000035']
2020-02-26 10:00:54,702 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"3284","DVYEUCAU_ID":"902957"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"3284","DVYEUCAU_ID":"902957"}' order by ID desc)        order by A.ID desc]
2020-02-26 10:00:56,557 [1] DEBUG - Statement Id: [DAO00048_GetDVYeuCauByDVYeuCauID] PreparedStatement : [SELECT A.*, B.NGAYGIOYEUCAU, C.TENDICHVU, D.TENNHOMDICHVU, D.NHOMDICHVU_ID            FROM TT_VIENPHI A            left join TT_DVYEUCAU B on A.REF_ID = B.DVYEUCAU_ID            inner join TM_DICHVU C on C.DICHVU_ID = B.DICHVU_ID            inner join TM_NHOMDICHVU D on D.NHOMDICHVU_ID = C.NHOMDICHVU_ID            WHERE            A.REF_ID IN (902957)            and A.REF_TABLE='TT_DVYEUCAU'            AND A.TIEPNHAN_ID = 99533]
2020-02-26 10:01:06,045 [1] DEBUG - Statement Id: [DAO00051_GetMauTuongTrinh] PreparedStatement : [select *            from TM_TUDIENKETQUA            where BENHVIEN_ID = 'HLU01'              and                 (NGUOITAO_ID = '1' OR SUDUNGCHUNG = '1')                and DICHVU_ID in  (                        @param0                   )               ORDER BY TENNOIDUNG]
2020-02-26 10:01:06,045 [1] DEBUG - Statement Id: [DAO00051_GetMauTuongTrinh] Parameters: [@param0=[LSTDICHVU_ID[0],3284]]
2020-02-26 10:01:06,045 [1] DEBUG - Statement Id: [DAO00051_GetMauTuongTrinh] Types: [@param0=[Int64, System.Int64]]
2020-02-26 10:01:22,349 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '99533'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2020-02-26 10:01:29,014 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '99533'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2020-02-26 10:01:29,182 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '99533'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2020-02-26 10:01:29,256 [1] DEBUG - Statement Id: [DAO00014_GetPatientStatus] PreparedStatement : [select        CASE        when tn.TRANGTHAI = 'HOANTHANH' Then tn.TRANGTHAI        WHEN xncp.XACNHANCHIPHI_ID is not null THEN 'XACNHANCHIPHI'        WHEN (tn.KHOADULIEU = '1') THEN 'KHOADULIEU'        ELSE tn.TRANGTHAI        END        as TRANGTHAI        from TT_TIEPNHAN tn        left join TT_XACNHANCHIPHI xncp on tn.TIEPNHAN_ID = xncp.TIEPNHAN_ID        where tn.TIEPNHAN_ID = '99533'        and tn.BENHVIEN_ID = 'HLU01']
2020-02-26 10:01:29,484 [1] DEBUG - Statement Id: [DAO00048_GetTrangThaiTruocKhiLuu_TuongTrinh] PreparedStatement : [SELECT PHAUTHUAT_YEUCAU_ID FROM TT_PHAUTHUAT_YEUCAU PTYC              WHERE BENHVIEN_ID ='HLU01'                and DVYEUCAU_ID in  (                        @param0                   )]
2020-02-26 10:01:29,484 [1] DEBUG - Statement Id: [DAO00048_GetTrangThaiTruocKhiLuu_TuongTrinh] Parameters: [@param0=[LISTDVYEUCAU_ID[0],902957]]
2020-02-26 10:01:29,484 [1] DEBUG - Statement Id: [DAO00048_GetTrangThaiTruocKhiLuu_TuongTrinh] Types: [@param0=[Int64, System.Int64]]
--------------------------------------------------------------------------------
2020-02-26 10:36:54,606 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2020-02-26 10:36:55,019 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2020-02-26 10:36:55,055 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2020-02-26 10:36:55,454 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 10:36:55,725 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2020-02-26 10:37:02,701 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2020-02-26 10:37:02,727 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2020-02-26 10:37:04,427 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2020-02-26 10:37:04,505 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2020-02-26 10:37:05,378 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2020-02-26 10:37:05,551 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2020-02-26 10:37:05,632 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2020-02-26 10:37:05,734 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2020-02-26 10:37:05,950 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2020-02-26 10:37:06,151 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2020-02-26 10:37:06,222 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2020-02-26 10:37:06,298 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2020-02-26 10:37:06,387 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2020-02-26 10:37:07,064 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2020-02-26 10:37:07,094 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2020-02-26 10:37:07,178 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2020-02-26 10:37:07,212 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2020-02-26 10:37:07,842 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2020-02-26 10:37:07,875 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @NGUONDUOC_MACDINH varchar(5) = '0';        declare @TOAMUANGOAI int = 0;        select @NGUONDUOC_MACDINH = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'PHA_NGUONDUOC'        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + @NGUONDUOC_MACDINH as DUOC_KEY, 0 as PHAMVI_ID, @NGUONDUOC_MACDINH as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end        else        begin                select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (        select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID)        B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (        select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID)        A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2020-02-26 10:37:09,326 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2020-02-26 10:37:09,424 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,        SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH        FROM TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID        WHERE TK.SOLUONG > 0        GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2020-02-26 10:37:09,507 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2020-02-26 10:37:09,545 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,        TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,        TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH        from TM_MAU M        JOIN        (        select        A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO        from        (        select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO        from TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'        where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0        ) A        )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2020-02-26 10:37:09,638 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2020-02-26 10:37:10,568 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 10:37:11,637 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2020-02-26 10:37:17,807 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2020-02-26 10:37:17,835 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2020-02-26 10:37:17,920 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 10:37:18,040 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 10:37:18,178 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2020-02-26 10:37:18,180 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2020-02-26 10:37:18,180 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2020-02-26 10:37:18,208 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2020-02-26 10:37:18,208 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2020-02-26 10:37:18,208 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2020-02-26 10:37:18,372 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 10:37:18,528 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 10:37:28,369 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 10:37:28,517 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2020-02-26 10:37:28,796 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2020-02-26 10:37:36,704 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'OPD23'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 10:37:38,241 [1] DEBUG - Statement Id: [DAO00019_DanhSachPhauThuatThuThuat] PreparedStatement : [declare @TenBenhVien nvarchar(500)        declare @ManhomDSA varchar(10);        set @TenBenhVien = (select VALUE from TM_SYS_APPSETTINGS where CODE = 'APP_BENHVIEN_TEN')        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        select * from(        select ROW_NUMBER() OVER(order by NGAYGIOYEUCAU) as ROWNUMBER, *        from        (SELECT distinct        COUNT(*) OVER() as TOTALROWS,        N'Mã người bệnh: ' + bn.MAYTE + ' - ' + N'Tên người bệnh: ' + bn.TENBENHNHAN + ' - ' + N'Số bệnh án: ' + ISNULL(BA.SOBENHAN,'') + ' - ' + N'Sinh ngày: ' + isnull(Convert(varchar(10),bn.NGAYSINH,103),bn.NAMSINH) + ' - ' + N'Giới tính: ' + GD.DESCRIPTION as GROUPNAME,        bn.MAYTE, bn.TENBENHNHAN, bn.NAMSINH, bn.NGAYSINH as TUOI, ISNULL(CONVERT(VARCHAR(10), bn.NGAYSINH, 103),CAST(bn.NAMSINH AS varchar)) as NGAYSINH, bn.DIACHILIENLAC as DIACHI, bn.GIOITINH, GD.DESCRIPTION as TENGIOITINH,        tn.DOITUONG_ID, tn.THOIGIANTIEPNHAN, tn.BENHNHAN_ID, tn.TIEPNHAN_ID, tn.TRAITUYEN, tn.SOTIEPNHAN        , dv.DICHVU_ID, dv.NOITHUCHIEN_ID, isnull(dv.NGAYTAO, dv.NGAYCAPNHAT) as THOIGIANDKDICHVU        , dv.KHAN, dv.NOIYEUCAU_ID, dv.NGAYGIOYEUCAU, dv.BACSICHIDINH_ID, dv.DONVIGIOITHIEU_ID        , dv.NGUOIGIOITHIEU_ID, dv.TRANGTHAI_WFL, tn.NOIGIOITHIEU_ID        , dv.DVYEUCAU_ID, dv.MARIS, dv.TRANGTHAI as TRANGTHAICODE, B.TENNHOMDICHVU, dv.SOPHIEUYEUCAU, dv.KHAMBENH_NGOAITRU_ID, dv.NGUOICAPNHAT_ID, dv.NGAYCAPNHAT,        CASE        WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU        WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02'        ELSE Left(B.MANHOMDICHVU,2) END AS MANHOMDICHVU, B.MANHOMDICHVU as MANHOMDICHVUCHITIET, tn.TRANGTHAI as TRANGTHAI_TIEPNHAN,        'False' as DAKHAM,        vp.DATHANHTOAN, vp.DONGIA_DOANHTHU, BA.SOBENHAN, dv.CHANDOAN        , a.TENDICHVU, nth.TENPHONGBAN as TENPHONGKHAM, nyc.TENPHONGBAN as TENKHOACHIDINH        , bscd.TENNHANVIEN as TENBACSICHIDINH        , 0 as GUINGOAI        , 0 as VTYT        , 0 as CLSKETQUA_ID          ,             '' SOPHIEUPHAUTHUAT                   FROM TT_DVYEUCAU (NOLOCK) dv        inner join TT_TIEPNHAN (NOLOCK) tn on dv.TIEPNHAN_ID = tn.TIEPNHAN_ID        inner join TT_BENHNHAN (NOLOCK) bn on tn.BENHNHAN_ID = bn.BENHNHAN_ID        inner join TM_DICHVU A on A.DICHVU_ID = dv.DICHVU_ID        inner join TM_PHONGBAN nth on nth.PHONGBAN_ID = dv.NOITHUCHIEN_ID        left join TM_NHANVIEN bscd on bscd.NHANVIEN_ID = dv.BACSICHIDINH_ID        inner join TM_PHONGBAN nyc on nyc.PHONGBAN_ID = dv.NOIYEUCAU_ID        inner join TM_NHOMDICHVU B on B.NHOMDICHVU_ID = A.NHOMDICHVU_ID        inner join TT_VIENPHI (NOLOCK) VP on VP.TIEPNHAN_ID = tn.TIEPNHAN_ID and VP.DICHVU_ID = dv.DICHVU_ID and VP.REF_ID = dv.DVYEUCAU_ID        left join TT_NOITRU_BENHAN (NOLOCK) BA on BA.TIEPNHAN_ID = tn.TIEPNHAN_ID AND dv.BENHAN_ID = BA.BENHAN_ID        inner join TM_GENDER GD on GD.ID = bn.GIOITINH                 where        dv.DICHVU_ID IS NOT NULL        and tn.BENHVIEN_ID = 'HLU01'        and HUYYEUCAU = 0        and dv.NGAYHENCLS is NULL                       and dv.TRANGTHAI = 'CHUAKETQUA'           and           dv.NGAYYEUCAU >= '2/26/2020 12:00:00 AM'         and           dv.NGAYYEUCAU <= '2/26/2020 12:00:00 AM'         and           dv.NOITHUCHIEN_ID = 25         and           (CASE          WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU          WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2)          END) in (05)         and           tn.TRANGTHAI IN ('DATIEPNHAN','NOITRU','CAPCUU', 'HOANTHANH')         and           (vp.DATHANHTOAN = '1'  or vp.DONGIA_DOANHTHU = '0' OR TN.SUDUNG_BHTN='1' OR TN.BAOLANH_VIENPHI='1'  OR tn.TRANGTHAI IN ('NOITRU','CAPCUU','NGOAITRU') or dv.HOPDONG_BENHNHAN_ID is not null or vp.BENHNHAN_PHAITHANHTOAN >= 0)                 ) data1) lst                    where          lst.ROWNUMBER between 1 and 20                 order by NGAYGIOYEUCAU asc]
2020-02-26 10:37:38,926 [1] DEBUG - Statement Id: [DAO00217_GetEmployeeAll] PreparedStatement : [select * from TM_NHANVIEN]
2020-02-26 10:37:49,670 [1] DEBUG - Statement Id: [DAO00019_DanhSachPhauThuatThuThuat] PreparedStatement : [declare @TenBenhVien nvarchar(500)        declare @ManhomDSA varchar(10);        set @TenBenhVien = (select VALUE from TM_SYS_APPSETTINGS where CODE = 'APP_BENHVIEN_TEN')        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        select * from(        select ROW_NUMBER() OVER(order by NGAYGIOYEUCAU) as ROWNUMBER, *        from        (SELECT distinct        COUNT(*) OVER() as TOTALROWS,        N'Mã người bệnh: ' + bn.MAYTE + ' - ' + N'Tên người bệnh: ' + bn.TENBENHNHAN + ' - ' + N'Số bệnh án: ' + ISNULL(BA.SOBENHAN,'') + ' - ' + N'Sinh ngày: ' + isnull(Convert(varchar(10),bn.NGAYSINH,103),bn.NAMSINH) + ' - ' + N'Giới tính: ' + GD.DESCRIPTION as GROUPNAME,        bn.MAYTE, bn.TENBENHNHAN, bn.NAMSINH, bn.NGAYSINH as TUOI, ISNULL(CONVERT(VARCHAR(10), bn.NGAYSINH, 103),CAST(bn.NAMSINH AS varchar)) as NGAYSINH, bn.DIACHILIENLAC as DIACHI, bn.GIOITINH, GD.DESCRIPTION as TENGIOITINH,        tn.DOITUONG_ID, tn.THOIGIANTIEPNHAN, tn.BENHNHAN_ID, tn.TIEPNHAN_ID, tn.TRAITUYEN, tn.SOTIEPNHAN        , dv.DICHVU_ID, dv.NOITHUCHIEN_ID, isnull(dv.NGAYTAO, dv.NGAYCAPNHAT) as THOIGIANDKDICHVU        , dv.KHAN, dv.NOIYEUCAU_ID, dv.NGAYGIOYEUCAU, dv.BACSICHIDINH_ID, dv.DONVIGIOITHIEU_ID        , dv.NGUOIGIOITHIEU_ID, dv.TRANGTHAI_WFL, tn.NOIGIOITHIEU_ID        , dv.DVYEUCAU_ID, dv.MARIS, dv.TRANGTHAI as TRANGTHAICODE, B.TENNHOMDICHVU, dv.SOPHIEUYEUCAU, dv.KHAMBENH_NGOAITRU_ID, dv.NGUOICAPNHAT_ID, dv.NGAYCAPNHAT,        CASE        WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU        WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02'        ELSE Left(B.MANHOMDICHVU,2) END AS MANHOMDICHVU, B.MANHOMDICHVU as MANHOMDICHVUCHITIET, tn.TRANGTHAI as TRANGTHAI_TIEPNHAN,        'False' as DAKHAM,        vp.DATHANHTOAN, vp.DONGIA_DOANHTHU, BA.SOBENHAN, dv.CHANDOAN        , a.TENDICHVU, nth.TENPHONGBAN as TENPHONGKHAM, nyc.TENPHONGBAN as TENKHOACHIDINH        , bscd.TENNHANVIEN as TENBACSICHIDINH        , 0 as GUINGOAI        , 0 as VTYT        , 0 as CLSKETQUA_ID          ,             '' SOPHIEUPHAUTHUAT                   FROM TT_DVYEUCAU (NOLOCK) dv        inner join TT_TIEPNHAN (NOLOCK) tn on dv.TIEPNHAN_ID = tn.TIEPNHAN_ID        inner join TT_BENHNHAN (NOLOCK) bn on tn.BENHNHAN_ID = bn.BENHNHAN_ID        inner join TM_DICHVU A on A.DICHVU_ID = dv.DICHVU_ID        inner join TM_PHONGBAN nth on nth.PHONGBAN_ID = dv.NOITHUCHIEN_ID        left join TM_NHANVIEN bscd on bscd.NHANVIEN_ID = dv.BACSICHIDINH_ID        inner join TM_PHONGBAN nyc on nyc.PHONGBAN_ID = dv.NOIYEUCAU_ID        inner join TM_NHOMDICHVU B on B.NHOMDICHVU_ID = A.NHOMDICHVU_ID        inner join TT_VIENPHI (NOLOCK) VP on VP.TIEPNHAN_ID = tn.TIEPNHAN_ID and VP.DICHVU_ID = dv.DICHVU_ID and VP.REF_ID = dv.DVYEUCAU_ID        left join TT_NOITRU_BENHAN (NOLOCK) BA on BA.TIEPNHAN_ID = tn.TIEPNHAN_ID AND dv.BENHAN_ID = BA.BENHAN_ID        inner join TM_GENDER GD on GD.ID = bn.GIOITINH                 where        dv.DICHVU_ID IS NOT NULL        and tn.BENHVIEN_ID = 'HLU01'        and HUYYEUCAU = 0        and dv.NGAYHENCLS is NULL                       and dv.TRANGTHAI = 'CHUAKETQUA'           and           dv.NGAYYEUCAU >= '11/1/2019 12:00:00 AM'         and           dv.NGAYYEUCAU <= '2/26/2020 12:00:00 AM'         and           dv.NOITHUCHIEN_ID = 25         and           (CASE          WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU          WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2)          END) in (05)         and           tn.TRANGTHAI IN ('DATIEPNHAN','NOITRU','CAPCUU', 'HOANTHANH')         and           (vp.DATHANHTOAN = '1'  or vp.DONGIA_DOANHTHU = '0' OR TN.SUDUNG_BHTN='1' OR TN.BAOLANH_VIENPHI='1'  OR tn.TRANGTHAI IN ('NOITRU','CAPCUU','NGOAITRU') or dv.HOPDONG_BENHNHAN_ID is not null or vp.BENHNHAN_PHAITHANHTOAN >= 0)                 ) data1) lst                    where          lst.ROWNUMBER between 1 and 20                 order by NGAYGIOYEUCAU asc]
2020-02-26 10:37:51,335 [1] DEBUG - Statement Id: [DAO00000_GetNhomDoiTuong] PreparedStatement : [SELECT DOITUONG_ID              ,[TENDOITUONG]              ,[NHOMDICHVU]              ,[TYLE_VUOT_LCB]              ,[GIOIHAN_VUOT_LCB]              ,[GIOIHAN_VUOT_DVKTC]              ,[TYLE_THUOC_UT]              ,[CPVC]              ,[CHIPHINGOAI_BHYT]              ,[NGANSACH_TL]              ,[MIENGIAM_TL]              ,[TAITRO_TL]              ,[BHTN_TL]              FROM [dbo].[TM_DOITUONG]]
2020-02-26 10:37:55,845 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'ORM04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 10:37:56,329 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'ORM05'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 10:37:56,839 [1] DEBUG - Statement Id: [DAO00019_ThongTinBenhNhanTiepNhan] PreparedStatement : [select distinct A.SOTIEPNHAN, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        B.*, A.SOBHYT        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'        where                    A.TIEPNHAN_ID = '105640'                 and A.BENHVIEN_ID = 'HLU01']
2020-02-26 10:37:57,242 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_GetList] PreparedStatement : [select *              from TT_PHAUTHUAT               where                             TT_PHAUTHUAT.LOAI = 'P'                       and                           TT_PHAUTHUAT.TIEPNHAN_ID = 105640                       and                           TT_PHAUTHUAT.BENHVIEN_ID = 'HLU01'                                     order by PHAUTHUAT_ID DESC]
2020-02-26 10:37:57,370 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '105640'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2020-02-26 10:37:57,599 [1] DEBUG - Statement Id: [DAO00048_GetBenhNhanByBenhNhanID] PreparedStatement : [SELECT *              FROM              TT_BENHNHAN               where                             BENHNHAN_ID = '73393']
2020-02-26 10:37:57,627 [1] DEBUG - Statement Id: [DAO00000_GetDoiTuongIsBHYT] PreparedStatement : [select * from TM_DOITUONG Where DOITUONG_ID = 4 and MADOITUONG like '%BHYT%']
2020-02-26 10:37:58,242 [1] DEBUG - Statement Id: [DAO00048_GetDICHVUYCByTiepNhanID] PreparedStatement : [SELECT DISTINCT D.HOPDONG_ID, D.HOPDONG_BENHNHAN_ID, D.DVYEUCAU_ID, D.DICHVU_ID, D.SOPHIEUYEUCAU, D.NGAYGIOYEUCAU, D.NOITHUCHIEN_ID, P.LOAIPHAUTHUAT, L.STT AS STT_LOAIPHAUTHUAT            FROM            TT_DVYEUCAU AS D            left join TM_PHANLOAIPHAUTHUAT AS P ON D.DICHVU_ID = P.DICHVU_ID            left join TM_LOAIPHAUTHUAT AS L ON L.LOAIPHAUTHUAT = P.LOAIPHAUTHUAT            where            not exists (select DVYEUCAU_ID from TT_PHAUTHUAT_YEUCAU where D.DVYEUCAU_ID = DVYEUCAU_ID)               and                       exists                      (select DICHVU_ID from TM_DICHVU                      where D.DICHVU_ID = DICHVU_ID and                      exists                      (select NHOMDICHVU_ID from TM_NHOMDICHVU                      where TM_DICHVU.NHOMDICHVU_ID = NHOMDICHVU_ID and left(MANHOMDICHVU,2) in (05)                      )                                             )                     and                           D.TIEPNHAN_ID = '105640']
2020-02-26 10:37:58,297 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '105640'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2020-02-26 10:37:58,429 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN191230.0000046']
2020-02-26 10:37:58,508 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"3832","DVYEUCAU_ID":"975219"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"3832","DVYEUCAU_ID":"975219"}' order by ID desc)        order by A.ID desc]
2020-02-26 10:37:58,641 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM60'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 10:37:58,801 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM98'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 10:38:03,364 [1] DEBUG - Statement Id: [DAO00019_ThongTinBenhNhanTiepNhan] PreparedStatement : [select distinct A.SOTIEPNHAN, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        B.*, A.SOBHYT        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'        where                    A.TIEPNHAN_ID = '99533'                 and A.BENHVIEN_ID = 'HLU01']
2020-02-26 10:38:03,452 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_GetList] PreparedStatement : [select *              from TT_PHAUTHUAT               where                             TT_PHAUTHUAT.LOAI = 'P'                       and                           TT_PHAUTHUAT.TIEPNHAN_ID = 99533                       and                           TT_PHAUTHUAT.BENHVIEN_ID = 'HLU01'                                     order by PHAUTHUAT_ID DESC]
2020-02-26 10:38:03,524 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '99533'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2020-02-26 10:38:03,614 [1] DEBUG - Statement Id: [DAO00048_GetBenhNhanByBenhNhanID] PreparedStatement : [SELECT *              FROM              TT_BENHNHAN               where                             BENHNHAN_ID = '69991']
2020-02-26 10:38:03,640 [1] DEBUG - Statement Id: [DAO00000_GetDoiTuongIsBHYT] PreparedStatement : [select * from TM_DOITUONG Where DOITUONG_ID = 1 and MADOITUONG like '%BHYT%']
2020-02-26 10:38:03,860 [1] DEBUG - Statement Id: [DAO00048_GetDICHVUYCByTiepNhanID] PreparedStatement : [SELECT DISTINCT D.HOPDONG_ID, D.HOPDONG_BENHNHAN_ID, D.DVYEUCAU_ID, D.DICHVU_ID, D.SOPHIEUYEUCAU, D.NGAYGIOYEUCAU, D.NOITHUCHIEN_ID, P.LOAIPHAUTHUAT, L.STT AS STT_LOAIPHAUTHUAT            FROM            TT_DVYEUCAU AS D            left join TM_PHANLOAIPHAUTHUAT AS P ON D.DICHVU_ID = P.DICHVU_ID            left join TM_LOAIPHAUTHUAT AS L ON L.LOAIPHAUTHUAT = P.LOAIPHAUTHUAT            where            not exists (select DVYEUCAU_ID from TT_PHAUTHUAT_YEUCAU where D.DVYEUCAU_ID = DVYEUCAU_ID)               and                       exists                      (select DICHVU_ID from TM_DICHVU                      where D.DICHVU_ID = DICHVU_ID and                      exists                      (select NHOMDICHVU_ID from TM_NHOMDICHVU                      where TM_DICHVU.NHOMDICHVU_ID = NHOMDICHVU_ID and left(MANHOMDICHVU,2) in (05)                      )                                             )                     and                           D.TIEPNHAN_ID = '99533']
2020-02-26 10:38:03,898 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '99533'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2020-02-26 10:38:03,975 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN191213.0000035']
2020-02-26 10:38:03,999 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"3284","DVYEUCAU_ID":"902957"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"3284","DVYEUCAU_ID":"902957"}' order by ID desc)        order by A.ID desc]
2020-02-26 10:38:05,550 [1] DEBUG - Statement Id: [DAO00048_GetDVYeuCauByDVYeuCauID] PreparedStatement : [SELECT A.*, B.NGAYGIOYEUCAU, C.TENDICHVU, D.TENNHOMDICHVU, D.NHOMDICHVU_ID            FROM TT_VIENPHI A            left join TT_DVYEUCAU B on A.REF_ID = B.DVYEUCAU_ID            inner join TM_DICHVU C on C.DICHVU_ID = B.DICHVU_ID            inner join TM_NHOMDICHVU D on D.NHOMDICHVU_ID = C.NHOMDICHVU_ID            WHERE            A.REF_ID IN (902957)            and A.REF_TABLE='TT_DVYEUCAU'            AND A.TIEPNHAN_ID = 99533]
2020-02-26 10:38:18,434 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'ORM06'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 10:38:19,812 [1] DEBUG - Statement Id: [DAO00051_GetMauTuongTrinh] PreparedStatement : [select *            from TM_TUDIENKETQUA            where BENHVIEN_ID = 'HLU01'              and                 (NGUOITAO_ID = '1' OR SUDUNGCHUNG = '1')                and DICHVU_ID in  (                        @param0                   )               ORDER BY TENNOIDUNG]
2020-02-26 10:38:19,814 [1] DEBUG - Statement Id: [DAO00051_GetMauTuongTrinh] Parameters: [@param0=[LSTDICHVU_ID[0],3284]]
2020-02-26 10:38:19,814 [1] DEBUG - Statement Id: [DAO00051_GetMauTuongTrinh] Types: [@param0=[Int64, System.Int64]]
2020-02-26 10:38:33,761 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'ORM07'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 10:38:53,477 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '99533'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2020-02-26 10:38:53,563 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '99533'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2020-02-26 10:38:53,637 [1] DEBUG - Statement Id: [DAO00014_GetPatientStatus] PreparedStatement : [select        CASE        when tn.TRANGTHAI = 'HOANTHANH' Then tn.TRANGTHAI        WHEN xncp.XACNHANCHIPHI_ID is not null THEN 'XACNHANCHIPHI'        WHEN (tn.KHOADULIEU = '1') THEN 'KHOADULIEU'        ELSE tn.TRANGTHAI        END        as TRANGTHAI        from TT_TIEPNHAN tn        left join TT_XACNHANCHIPHI xncp on tn.TIEPNHAN_ID = xncp.TIEPNHAN_ID        where tn.TIEPNHAN_ID = '99533'        and tn.BENHVIEN_ID = 'HLU01']
2020-02-26 10:38:53,722 [1] DEBUG - Statement Id: [DAO00048_GetTrangThaiTruocKhiLuu_TuongTrinh] PreparedStatement : [SELECT PHAUTHUAT_YEUCAU_ID FROM TT_PHAUTHUAT_YEUCAU PTYC              WHERE BENHVIEN_ID ='HLU01'                and DVYEUCAU_ID in  (                        @param0                   )]
2020-02-26 10:38:53,723 [1] DEBUG - Statement Id: [DAO00048_GetTrangThaiTruocKhiLuu_TuongTrinh] Parameters: [@param0=[LISTDVYEUCAU_ID[0],902957]]
2020-02-26 10:38:53,723 [1] DEBUG - Statement Id: [DAO00048_GetTrangThaiTruocKhiLuu_TuongTrinh] Types: [@param0=[Int64, System.Int64]]
2020-02-26 10:39:47,053 [1] DEBUG - Statement Id: [DAO00050_GetDetail] PreparedStatement : [select *              from LST_KEYDATA_DICHVU               where                             LST_KEYDATA_DICHVU.KEYTYPE = 'SOPHIEUYEUCAUCLS'                       and                           LST_KEYDATA_DICHVU.KEYYEAR = '2020'                       and                           LST_KEYDATA_DICHVU.KEYMONTH = '0'                       and                           LST_KEYDATA_DICHVU.KEYDAY = '0'                       and                           LST_KEYDATA_DICHVU.SEGMENT_1 = '0621'                       and                           LST_KEYDATA_DICHVU.SEGMENT_2 = '0'                       and                           LST_KEYDATA_DICHVU.SEGMENT_3 = '0'                                     order by KEYTYPE]
2020-02-26 10:39:47,109 [1] DEBUG - Statement Id: [DAO00050_Update] PreparedStatement : [update LST_KEYDATA_DICHVU set              KEYVALUE =  @param0               where              KEYTYPE = 'SOPHIEUYEUCAUCLS'              AND KEYYEAR = '2020'              AND KEYMONTH = '0'              AND KEYDAY = '0'              AND SEGMENT_1 = '0621'              AND SEGMENT_2 = '0'              AND SEGMENT_3 = '0']
2020-02-26 10:39:47,109 [1] DEBUG - Statement Id: [DAO00050_Update] Parameters: [@param0=[KEYVALUE,00986]]
2020-02-26 10:39:47,109 [1] DEBUG - Statement Id: [DAO00050_Update] Types: [@param0=[String, System.String]]
2020-02-26 10:39:47,139 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_Add] PreparedStatement : [insert into TT_PHAUTHUAT (            SOPHIEUPHAUTHUAT            , LOAI            , BENHAN_ID            , LUUTRU_ID            , TIEPNHAN_ID            , PHONGBANTHUCHIEN_ID            , NGAYTHUCHIEN            , THOIGIANBATDAU            , THOIGIANKETTHUC            , ICD_VAOKHOA            , ICD_VAOKHOA_MOTA            , ICD_TRUOCPHAUTHUAT            , ICD_TRUOCPHAUTHUAT_MOTA            , ICD_SAUPHAUTHUAT            , ICD_SAUPHAUTHUAT_MOTA            , NHOMDICHVU_ID            , DICHVU_ID            , PHUONGPHAPVOCAM_ID            , TAIBIEN_ID            , CHEDO_ID            , TUVONG_ID            , TRINHTUTHUCHIEN            , MOTA            , KETQUA            , BENHNHANBENNGOAI            , NGUONBENH_ID            , LOAIPHAUTHUAT            , DANLUU            , NGAYRUT            , NGAYCATCHI            , KHAC            , SOLANMOLAI            , LYDOMOLAI            , CANTHIEPPHAUTHUAT            , TUDIENKETQUA_ID            , PHONGBANCHIDINH_ID            , PPMO_ID            , THOIGIANGAYME            , KHOADULIEU            , NGUOIKHOA_ID            , TENNGUOIKHOA            , NGAYKHOADULIEU            , THOIGIANKHOADULIEU            , NGAYTAO            , NGUOITAO_ID            , NGAYCAPNHAT            , NGUOICAPNHAT_ID            , BENHVIEN_ID                         , TRINHTUTHUCHIEN_TEXT            ) values (             @param0             ,  @param1             ,  @param2             ,  @param3             ,  @param4             ,  @param5             ,  @param6             ,  @param7             ,  @param8             ,  @param9             ,  @param10             ,  @param11             ,  @param12             ,  @param13             ,  @param14             ,  @param15             ,  @param16             ,  @param17             ,  @param18             ,  @param19             ,  @param20             ,  @param21             ,  @param22             ,  @param23             ,  @param24             ,  @param25             ,  @param26             ,  @param27             ,  @param28             ,  @param29             ,  @param30             ,  @param31             ,  @param32             ,  @param33             ,  @param34             ,  @param35             ,  @param36             ,  @param37             ,  @param38             ,  @param39             ,  @param40             ,  @param41             ,  @param42             ,  @param43             ,  @param44             ,  @param45             ,  @param46             ,  @param47                          ,  @param48             )            SELECT SCOPE_IDENTITY()]
2020-02-26 10:39:47,139 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_Add] Parameters: [@param0=[SOPHIEUPHAUTHUAT,20.P.00986], @param1=[LOAI,P], @param2=[BENHAN_ID,null], @param3=[LUUTRU_ID,null], @param4=[TIEPNHAN_ID,99533], @param5=[PHONGBANTHUCHIEN_ID,25], @param6=[NGAYTHUCHIEN,2/26/2020 10:39:47 AM], @param7=[THOIGIANBATDAU,2/26/2020 10:38:00 AM], @param8=[THOIGIANKETTHUC,2/26/2020 10:50:00 AM], @param9=[ICD_VAOKHOA,J20], @param10=[ICD_VAOKHOA_MOTA,Viêm phế quản cấp], @param11=[ICD_TRUOCPHAUTHUAT,J20], @param12=[ICD_TRUOCPHAUTHUAT_MOTA,Viêm phế quản cấp], @param13=[ICD_SAUPHAUTHUAT,J20], @param14=[ICD_SAUPHAUTHUAT_MOTA,Viêm phế quản cấp], @param15=[NHOMDICHVU_ID,null], @param16=[DICHVU_ID,null], @param17=[PHUONGPHAPVOCAM_ID,null], @param18=[TAIBIEN_ID,null], @param19=[CHEDO_ID,5190], @param20=[TUVONG_ID,null], @param21=[TRINHTUTHUCHIEN,<body>
	<div style="text-align:left;text-indent:0pt;margin:0pt 0pt 0pt 0pt;"><span style="color:#000000;background-color:transparent;font-family:Times New Roman;font-size:12pt;font-weight:normal;font-style:normal;">asfsfwefw </span></div><div style="text-align:left;text-indent:0pt;margin:0pt 0pt 0pt 0pt;"><span style="color:#000000;background-color:transparent;font-family:Times New Roman;font-size:12pt;font-weight:normal;font-style:normal;">qwefrwer</span></div><div style="text-align:left;text-indent:0pt;margin:0pt 0pt 0pt 0pt;"><span style="color:#000000;background-color:transparent;font-family:Times New Roman;font-size:12pt;font-weight:normal;font-style:normal;">wr ẻ r .</span></div><div style="text-align:left;text-indent:0pt;margin:0pt 0pt 0pt 0pt;"><span style="color:#000000;background-color:transparent;font-family:Times New Roman;font-size:12pt;font-weight:normal;font-style:normal;">wweee</span></div></body>
], @param22=[MOTA,null], @param23=[KETQUA,null], @param24=[BENHNHANBENNGOAI,null], @param25=[NGUONBENH_ID,745], @param26=[LOAIPHAUTHUAT,PTH], @param27=[DANLUU,null], @param28=[NGAYRUT,null], @param29=[NGAYCATCHI,null], @param30=[KHAC,null], @param31=[SOLANMOLAI,null], @param32=[LYDOMOLAI,null], @param33=[CANTHIEPPHAUTHUAT,null], @param34=[TUDIENKETQUA_ID,null], @param35=[PHONGBANCHIDINH_ID,null], @param36=[PPMO_ID,null], @param37=[THOIGIANGAYME,null], @param38=[KHOADULIEU,0], @param39=[NGUOIKHOA_ID,null], @param40=[TENNGUOIKHOA,null], @param41=[NGAYKHOADULIEU,null], @param42=[THOIGIANKHOADULIEU,null], @param43=[NGAYTAO,2/26/2020 10:39:47 AM], @param44=[NGUOITAO_ID,1], @param45=[NGAYCAPNHAT,2/26/2020 10:39:47 AM], @param46=[NGUOICAPNHAT_ID,1], @param47=[BENHVIEN_ID,HLU01], @param48=[TRINHTUTHUCHIEN_TEXT,null]]
2020-02-26 10:39:47,140 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_Add] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[System.DBNull, null], @param3=[System.DBNull, null], @param4=[Int64, System.Int64], @param5=[Int64, System.Int64], @param6=[DateTime, System.DateTime], @param7=[DateTime, System.DateTime], @param8=[DateTime, System.DateTime], @param9=[String, System.String], @param10=[String, System.String], @param11=[String, System.String], @param12=[String, System.String], @param13=[String, System.String], @param14=[String, System.String], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[Int64, System.Int64], @param20=[System.DBNull, null], @param21=[String, System.String], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[Int64, System.Int64], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[System.DBNull, null], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[DateTime, System.DateTime], @param44=[Int64, System.Int64], @param45=[DateTime, System.DateTime], @param46=[Int64, System.Int64], @param47=[String, System.String], @param48=[System.DBNull, null]]
2020-02-26 10:39:47,179 [1] DEBUG - Statement Id: [DAO00087_GetServiceParams] PreparedStatement : [select CODE, VALUE              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01']
2020-02-26 10:39:47,270 [1] DEBUG - Statement Id: [DAO00049_KiemtraloaiDV] PreparedStatement : [select DICHVU_ID AS HA, '' AS XN, '' as TDCN, '' as TT, '' as KB from TM_DICHVU            left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = TM_DICHVU.NHOMDICHVU_ID            where DICHVU_ID = '3284' and left(ndv.MANHOMDICHVU, 2) = '02'            union            select  '' as HA, DICHVU_ID AS XN, '' as TDCN, '' as TT, '' as KB from TM_DICHVU            left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = TM_DICHVU.NHOMDICHVU_ID            where DICHVU_ID = '3284' and left(ndv.MANHOMDICHVU, 2) = '01'            union            select  '' as HA, '' AS XN, DICHVU_ID as TDCN, '' as TT, '' as KB from TM_DICHVU            left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = TM_DICHVU.NHOMDICHVU_ID            where DICHVU_ID = '3284' and left(ndv.MANHOMDICHVU, 2) = '03'            union            select  '' as HA, '' AS XN, '' as TDCN, DICHVU_ID as TT, '' as KB from TM_DICHVU            left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = TM_DICHVU.NHOMDICHVU_ID            where DICHVU_ID = '3284' and left(ndv.MANHOMDICHVU, 2) = '05'            union            select  '' as HA, '' AS XN, '' as TDCN, DICHVU_ID as TT, '' as KB from TM_DICHVU            left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = TM_DICHVU.NHOMDICHVU_ID            where DICHVU_ID = '3284' and left(ndv.MANHOMDICHVU, 2) = '06'            union            select  '' as HA, '' AS XN, '' as TDCN, '' as TT, DICHVU_ID as KB from TM_DICHVU            left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = TM_DICHVU.NHOMDICHVU_ID            where DICHVU_ID = '3284' and left(ndv.MANHOMDICHVU, 2) = '04']
2020-02-26 10:39:47,326 [1] DEBUG - Statement Id: [DAO00009_GetThutiensauDVThuthuat] PreparedStatement : [select A.THUTIENSAU, B.SOTIEPNHAN, A.DICHVU_ID, A.DVYEUCAU_ID        from TT_DVYEUCAU A        inner join TT_TIEPNHAN B on B.TIEPNHAN_ID = A.TIEPNHAN_ID        where        A.DVYEUCAU_ID = '902957']
2020-02-26 10:39:47,358 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN191213.0000035']
2020-02-26 10:39:47,386 [1] DEBUG - Statement Id: [DAOWF001_Kiemtrathongtindayeucaudacochua] PreparedStatement : [select * from TT_REQUEST        where        PARA = '{"HOSPITAL_ID":"HLU01","SOTIEPNHAN":"TN191213.0000035"}'        AND ISACTIVE = '1']
2020-02-26 10:39:47,491 [1] DEBUG - Statement Id: [DAOWF001_Kiemtrathongtindichvudayeucau] PreparedStatement : [select top 1 * from TT_REQUEST_SERVICE        where        PARA = '{"DICHVU_ID":"3284","DVYEUCAU_ID":"902957"}'                AND ISACTIVE = '1' order by ID desc]
2020-02-26 10:39:47,615 [1] DEBUG - Statement Id: [DAOWF001_KiemtrathongtinchitietDichvuYeucau] PreparedStatement : [select * from TT_REQUEST_SERVICE_DETAIL        where        REQUEST_SERVICE_ID = '518845']
2020-02-26 10:39:47,788 [1] DEBUG - Statement Id: [DAOWF001_Laythongtinwithstatecode] PreparedStatement : [select A.*, B.STATUS_CODE from        TM_STATE_ACTION A        left join TM_STATE B on B.STATE_CODE = A.NEXT_STATE_CODE and A.PROCESS_CODE = B.PROCESS_CODE        where        A.CURR_STATE_CODE = '1     '        AND A.PROCESS_CODE = 'P01'        Order By ORDER_ID ASC]
2020-02-26 10:39:47,837 [1] DEBUG - Statement Id: [DAOWF003_Update] PreparedStatement : [update TT_REQUEST_SERVICE set        CURR_STATE_CODE =  @param0                   , ISACTIVE =  @param1                     , ISCOMPLETE =  @param2                        where        ID = '518845']
2020-02-26 10:39:47,837 [1] DEBUG - Statement Id: [DAOWF003_Update] Parameters: [@param0=[CURR_STATE_CODE,2], @param1=[ISACTIVE,1], @param2=[ISCOMPLETE,0]]
2020-02-26 10:39:47,837 [1] DEBUG - Statement Id: [DAOWF003_Update] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[String, System.String]]
2020-02-26 10:39:48,099 [1] DEBUG - Statement Id: [DAOWF005_Add] PreparedStatement : [insert into TT_REQUEST_SERVICE_DETAIL (        REQUEST_ID        ,REQUEST_SERVICE_ID        , OLD_STATE_CODE        , CURR_STATE_CODE        ) values (         @param0         , @param1         ,  @param2         ,  @param3         )        SELECT SCOPE_IDENTITY()]
2020-02-26 10:39:48,099 [1] DEBUG - Statement Id: [DAOWF005_Add] Parameters: [@param0=[REQUEST_ID,104032], @param1=[REQUEST_SERVICE_ID,518845], @param2=[OLD_STATE_CODE,1     ], @param3=[CURR_STATE_CODE,2]]
2020-02-26 10:39:48,099 [1] DEBUG - Statement Id: [DAOWF005_Add] Types: [@param0=[String, System.String], @param1=[Int32, System.Int32], @param2=[String, System.String], @param3=[String, System.String]]
2020-02-26 10:39:48,627 [1] DEBUG - Statement Id: [DAOWF005_Add_History] PreparedStatement : [insert into TT_REQUEST_SERVICE_HISTORY (        REQUEST_ID        ,REQUEST_SERVICE_ID        , OLD_STATE_CODE        , CURR_STATE_CODE        ) values (         @param0         , @param1         ,  @param2         ,  @param3         )]
2020-02-26 10:39:48,627 [1] DEBUG - Statement Id: [DAOWF005_Add_History] Parameters: [@param0=[REQUEST_ID,104032], @param1=[REQUEST_SERVICE_ID,518845], @param2=[OLD_STATE_CODE,1     ], @param3=[CURR_STATE_CODE,2]]
2020-02-26 10:39:48,627 [1] DEBUG - Statement Id: [DAOWF005_Add_History] Types: [@param0=[String, System.String], @param1=[Int32, System.Int32], @param2=[String, System.String], @param3=[String, System.String]]
2020-02-26 10:39:48,657 [1] DEBUG - Statement Id: [DAO00009_TT_DVYEUCAU_Update] PreparedStatement : [Update TT_DVYEUCAU set TRANGTHAI_WFL = 'HOANTAT' where DVYEUCAU_ID = '902957']
2020-02-26 10:39:48,683 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_YEUCAU_Add] PreparedStatement : [insert into TT_PHAUTHUAT_YEUCAU (              PHAUTHUAT_ID              , DVYEUCAU_ID              , NHOMDICHVU_ID              , DICHVU_ID              , LOAIGIA_ID              , THANHTIEN_DOANHTHU              , BHYT_THANHTIEN_CHITRA              , BENHNHAN_PHAITHANHTOAN              , BENHVIEN_ID              ) values (               @param0               ,  @param1               ,  @param2               ,  @param3               ,  @param4               ,  @param5               ,  @param6               ,  @param7               ,  @param8               )]
2020-02-26 10:39:48,683 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_YEUCAU_Add] Parameters: [@param0=[PHAUTHUAT_ID,68088], @param1=[DVYEUCAU_ID,902957], @param2=[NHOMDICHVU_ID,27], @param3=[DICHVU_ID,3284], @param4=[LOAIGIA_ID,3], @param5=[THANHTIEN_DOANHTHU,70000], @param6=[BHYT_THANHTIEN_CHITRA,0], @param7=[BENHNHAN_PHAITHANHTOAN,70000], @param8=[BENHVIEN_ID,HLU01]]
2020-02-26 10:39:48,683 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_YEUCAU_Add] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64], @param2=[Int64, System.Int64], @param3=[Int64, System.Int64], @param4=[Int64, System.Int64], @param5=[Double, System.Double], @param6=[Double, System.Double], @param7=[Double, System.Double], @param8=[String, System.String]]
2020-02-26 10:39:48,709 [1] DEBUG - Statement Id: [DAO00048_UpdateDVYeuCauVienPhi] PreparedStatement : [update  TT_VIENPHI              set DATHUCHIEN = '1',              NGUOICAPNHAT_ID =  @param0 ,              NGAYCAPNHAT =  @param1               where              VIENPHI_ID =  @param2]
2020-02-26 10:39:48,709 [1] DEBUG - Statement Id: [DAO00048_UpdateDVYeuCauVienPhi] Parameters: [@param0=[NGUOICAPNHAT_ID,1], @param1=[NGAYCAPNHAT,2/26/2020 10:39:48 AM], @param2=[VIENPHI_ID,2851611]]
2020-02-26 10:39:48,709 [1] DEBUG - Statement Id: [DAO00048_UpdateDVYeuCauVienPhi] Types: [@param0=[Int64, System.Int64], @param1=[DateTime, System.DateTime], @param2=[Int64, System.Int64]]
2020-02-26 10:39:48,734 [1] DEBUG - Statement Id: [DAO00048_UpdateDVYeuCau] PreparedStatement : [update  TT_DVYEUCAU              set TRANGTHAI =  @param0 ,              NGUOICAPNHAT_ID =  @param1 ,              NGAYCAPNHAT =  @param2               where              DVYEUCAU_ID =  @param3]
2020-02-26 10:39:48,734 [1] DEBUG - Statement Id: [DAO00048_UpdateDVYeuCau] Parameters: [@param0=[TRANGTHAI,CHOXACNHAN], @param1=[NGUOICAPNHAT_ID,1], @param2=[NGAYCAPNHAT,2/26/2020 10:39:48 AM], @param3=[DVYEUCAU_ID,902957]]
2020-02-26 10:39:48,734 [1] DEBUG - Statement Id: [DAO00048_UpdateDVYeuCau] Types: [@param0=[String, System.String], @param1=[Int64, System.Int64], @param2=[DateTime, System.DateTime], @param3=[Int64, System.Int64]]
2020-02-26 10:39:48,762 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_PPVOCAM_Add] PreparedStatement : [insert into TT_PHAUTHUAT_PPVOCAM (              PHAUTHUAT_ID,              PPVOCAM_ID,              BENHVIEN_ID)              values (               @param0 ,               @param1 ,               @param2 )]
2020-02-26 10:39:48,762 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_PPVOCAM_Add] Parameters: [@param0=[PHAUTHUAT_ID,68088], @param1=[PPVOCAM_ID,516], @param2=[BENHVIEN_ID,HLU01]]
2020-02-26 10:39:48,762 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_PPVOCAM_Add] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64], @param2=[String, System.String]]
2020-02-26 10:39:48,804 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_EKIP_Add] PreparedStatement : [insert into TT_PHAUTHUAT_EKIP (              PHAUTHUAT_ID                ,                       NHANVIEN_ID                   ,                       VAITRO_ID                                 , PTVC_ID              , PPT1_ID              , PPT2_ID              , GMC_ID              , GMP_ID              , DCVT_ID              , DCVN_ID              , BSHC_ID              , BSTC_ID              , BENHVIEN_ID              ) values (               @param0                 ,                        @param1                    ,                        @param2                                  ,  @param3               ,  @param4               ,  @param5               ,  @param6               ,  @param7               ,  @param8               ,  @param9               ,  @param10               ,  @param11               ,  @param12               )]
2020-02-26 10:39:48,804 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_EKIP_Add] Parameters: [@param0=[PHAUTHUAT_ID,68088], @param1=[NHANVIEN_ID,34], @param2=[VAITRO_ID,748], @param3=[PTVC_ID,null], @param4=[PPT1_ID,null], @param5=[PPT2_ID,null], @param6=[GMC_ID,null], @param7=[GMP_ID,null], @param8=[DCVT_ID,null], @param9=[DCVN_ID,null], @param10=[BSHC_ID,null], @param11=[BSTC_ID,null], @param12=[BENHVIEN_ID,HLU01]]
2020-02-26 10:39:48,804 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_EKIP_Add] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[System.DBNull, null], @param5=[System.DBNull, null], @param6=[System.DBNull, null], @param7=[System.DBNull, null], @param8=[System.DBNull, null], @param9=[System.DBNull, null], @param10=[System.DBNull, null], @param11=[System.DBNull, null], @param12=[String, System.String]]
2020-02-26 10:39:48,957 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_GetList] PreparedStatement : [select *              from TT_PHAUTHUAT               where                             TT_PHAUTHUAT.LOAI = 'P'                       and                           TT_PHAUTHUAT.TIEPNHAN_ID = 99533                       and                           TT_PHAUTHUAT.BENHVIEN_ID = 'HLU01'                                     order by PHAUTHUAT_ID DESC]
2020-02-26 10:39:49,052 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_GetDetail] PreparedStatement : [select PT.*, TN.BENHNHAN_ID              from              TT_PHAUTHUAT PT, TT_TIEPNHAN TN              where              PT.TIEPNHAN_ID = TN.TIEPNHAN_ID              AND PHAUTHUAT_ID  = 68088]
2020-02-26 10:39:49,092 [1] DEBUG - Statement Id: [DAO00048_CheckDVPhauThuatBHYT] PreparedStatement : [select count(0) from TT_VIENPHI          where REF_TABLE = 'TT_DVYEUCAU' and REF_ID = (select top 1 DVYEUCAU_ID from TT_PHAUTHUAT_YEUCAU where PHAUTHUAT_ID =  @param0 )          and TIEPNHAN_ID =  @param1  and BHYT_DONGIA > 0]
2020-02-26 10:39:49,092 [1] DEBUG - Statement Id: [DAO00048_CheckDVPhauThuatBHYT] Parameters: [@param0=[PHAUTHUAT_ID,68088], @param1=[TIEPNHAN_ID,99533]]
2020-02-26 10:39:49,092 [1] DEBUG - Statement Id: [DAO00048_CheckDVPhauThuatBHYT] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64]]
2020-02-26 10:39:49,136 [1] DEBUG - Statement Id: [DAO00116_File_GetList] PreparedStatement : [select *              from TT_FILE_DINHKEM               where                             TT_FILE_DINHKEM.REF_TABLE = 'TT_PHAUTHUAT'                       and                           TT_FILE_DINHKEM.REF_ID = '68088'                       and                           TT_FILE_DINHKEM.BENHVIEN_ID = 'HLU01'                                     order by FILE_ID]
2020-02-26 10:39:49,350 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_EKIP_GetDetail] PreparedStatement : [select *              from TT_PHAUTHUAT_EKIP              where PHAUTHUAT_ID  = 68088]
2020-02-26 10:39:54,885 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '99533'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2020-02-26 10:39:54,967 [1] DEBUG - Statement Id: [DAO00014_GetORMServiceStatus] PreparedStatement : [select dvyc.TRANGTHAI, pt.NGUOIKHOA_ID, pt.NGUOITAO_ID        from TT_PHAUTHUAT pt        left join TT_PHAUTHUAT_YEUCAU ptyc on ptyc.PHAUTHUAT_ID = pt.PHAUTHUAT_ID        left join (select * from TT_DVYEUCAU where exists (select DVYEUCAU_ID from TT_PHAUTHUAT where TT_DVYEUCAU.DVYEUCAU_ID = DVYEUCAU_ID and PHAUTHUAT_ID = '68088')) dvyc        on ptyc.DVYEUCAU_ID = dvyc.DVYEUCAU_ID        where pt.PHAUTHUAT_ID = '68088']
2020-02-26 10:39:55,053 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '99533'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2020-02-26 10:39:55,127 [1] DEBUG - Statement Id: [DAO00014_GetPatientStatus] PreparedStatement : [select        CASE        when tn.TRANGTHAI = 'HOANTHANH' Then tn.TRANGTHAI        WHEN xncp.XACNHANCHIPHI_ID is not null THEN 'XACNHANCHIPHI'        WHEN (tn.KHOADULIEU = '1') THEN 'KHOADULIEU'        ELSE tn.TRANGTHAI        END        as TRANGTHAI        from TT_TIEPNHAN tn        left join TT_XACNHANCHIPHI xncp on tn.TIEPNHAN_ID = xncp.TIEPNHAN_ID        where tn.TIEPNHAN_ID = '99533'        and tn.BENHVIEN_ID = 'HLU01']
2020-02-26 10:39:55,200 [1] DEBUG - Statement Id: [DAO00048_GetTrangThaiTruocKhiXoa_TuongTrinh] PreparedStatement : [IF 'LUU'='XOA'              BEGIN              IF EXISTS              (              SELECT PHAUTHUAT_VTYT_ID              FROM TT_PHAUTHUAT_VTYT WHERE PHAUTHUAT_ID='68088' AND BENHVIEN_ID='HLU01'              )              BEGIN              SELECT -1 AS RESULT              END              ELSE              BEGIN              IF EXISTS ( SELECT PHAUTHUAT_ID FROM TT_PHAUTHUAT WHERE PHAUTHUAT_ID='68088' AND BENHVIEN_ID='HLU01' AND KHOADULIEU='1' )              BEGIN              SELECT -2 AS RESULT, NGUOIKHOA_ID   FROM TT_PHAUTHUAT WHERE PHAUTHUAT_ID='68088' AND BENHVIEN_ID='HLU01' AND KHOADULIEU='1'              END              ELSE              BEGIN              IF NOT EXISTS (SELECT PHAUTHUAT_ID FROM TT_PHAUTHUAT WHERE PHAUTHUAT_ID='68088' AND BENHVIEN_ID='HLU01')              BEGIN              SELECT -3 AS RESULT              END              ELSE              BEGIN              SELECT 1 AS RESULT              END              END              END              END              ELSE IF 'LUU'='LUU'              BEGIN              IF EXISTS ( SELECT PHAUTHUAT_ID FROM TT_PHAUTHUAT WHERE PHAUTHUAT_ID='68088' AND BENHVIEN_ID='HLU01' AND KHOADULIEU='1' )              BEGIN              SELECT -2 AS RESULT              END              ELSE              BEGIN              SELECT 1 AS RESULT              END              END              ELSE              BEGIN              SELECT 10 AS RESULT              END]
2020-02-26 10:40:18,344 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_Update] PreparedStatement : [update TT_PHAUTHUAT set              SOPHIEUPHAUTHUAT =  @param0               , LOAI =  @param1               , BENHAN_ID =  @param2               , LUUTRU_ID =  @param3               , TIEPNHAN_ID =  @param4               , PHONGBANTHUCHIEN_ID =  @param5               , NGAYTHUCHIEN =  @param6               , THOIGIANBATDAU =  @param7               , THOIGIANKETTHUC =  @param8               , ICD_VAOKHOA =  @param9               , ICD_VAOKHOA_MOTA =  @param10               , ICD_TRUOCPHAUTHUAT =  @param11               , ICD_TRUOCPHAUTHUAT_MOTA =  @param12               , ICD_SAUPHAUTHUAT =  @param13               , ICD_SAUPHAUTHUAT_MOTA =  @param14               , NHOMDICHVU_ID =  @param15               , DICHVU_ID =  @param16               , PHUONGPHAPVOCAM_ID =  @param17               , TAIBIEN_ID =  @param18               , CHEDO_ID =  @param19               , TUVONG_ID =  @param20               , TRINHTUTHUCHIEN =  @param21               , MOTA =  @param22               , KETQUA =  @param23               , BENHNHANBENNGOAI =  @param24               , NGUONBENH_ID =  @param25               , LOAIPHAUTHUAT =  @param26               , DANLUU =  @param27               , NGAYRUT =  @param28               , NGAYCATCHI =  @param29               , KHAC =  @param30               , SOLANMOLAI =  @param31               , LYDOMOLAI =  @param32               , CANTHIEPPHAUTHUAT =  @param33               , TUDIENKETQUA_ID =  @param34               , PHONGBANCHIDINH_ID =  @param35               , PPMO_ID =  @param36               , THOIGIANGAYME =  @param37               , KHOADULIEU =  @param38               , NGUOIKHOA_ID =  @param39               , TENNGUOIKHOA =  @param40               , NGAYKHOADULIEU =  @param41               , THOIGIANKHOADULIEU =  @param42                            , NGAYCAPNHAT =  @param43             , NGUOICAPNHAT_ID =  @param44             , BENHVIEN_ID =  @param45              ,               PHUONGPHAPPTTT =  @param46                          , TRINHTUTHUCHIEN_TEXT =  @param47             where            PHAUTHUAT_ID = 68088]
2020-02-26 10:40:18,344 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_Update] Parameters: [@param0=[SOPHIEUPHAUTHUAT,20.P.00986], @param1=[LOAI,P], @param2=[BENHAN_ID,null], @param3=[LUUTRU_ID,null], @param4=[TIEPNHAN_ID,99533], @param5=[PHONGBANTHUCHIEN_ID,25], @param6=[NGAYTHUCHIEN,2/26/2020 10:40:18 AM], @param7=[THOIGIANBATDAU,2/26/2020 10:38:00 AM], @param8=[THOIGIANKETTHUC,2/26/2020 10:50:00 AM], @param9=[ICD_VAOKHOA,J20], @param10=[ICD_VAOKHOA_MOTA,Viêm phế quản cấp], @param11=[ICD_TRUOCPHAUTHUAT,J20], @param12=[ICD_TRUOCPHAUTHUAT_MOTA,Viêm phế quản cấp], @param13=[ICD_SAUPHAUTHUAT,J20], @param14=[ICD_SAUPHAUTHUAT_MOTA,Viêm phế quản cấp], @param15=[NHOMDICHVU_ID,null], @param16=[DICHVU_ID,null], @param17=[PHUONGPHAPVOCAM_ID,null], @param18=[TAIBIEN_ID,null], @param19=[CHEDO_ID,5190], @param20=[TUVONG_ID,null], @param21=[TRINHTUTHUCHIEN,<body>
	<div style="text-align:left;text-indent:0pt;margin:0pt 0pt 0pt 0pt;"><span style="color:#000000;background-color:transparent;font-family:Times New Roman;font-size:12pt;font-weight:normal;font-style:normal;">asfsfwefw </span></div><div style="text-align:left;text-indent:0pt;margin:0pt 0pt 0pt 0pt;"><span style="color:#000000;background-color:transparent;font-family:Times New Roman;font-size:12pt;font-weight:normal;font-style:normal;">qwefrwer</span></div><div style="text-align:left;text-indent:0pt;margin:0pt 0pt 0pt 0pt;"><span style="color:#000000;background-color:transparent;font-family:Times New Roman;font-size:12pt;font-weight:normal;font-style:normal;">wr ẻ r .</span></div><div style="text-align:left;text-indent:0pt;margin:0pt 0pt 0pt 0pt;"><span style="color:#000000;background-color:transparent;font-family:Times New Roman;font-size:12pt;font-weight:normal;font-style:normal;">wweee</span></div></body>
], @param22=[MOTA,null], @param23=[KETQUA,null], @param24=[BENHNHANBENNGOAI,null], @param25=[NGUONBENH_ID,745], @param26=[LOAIPHAUTHUAT,PTH], @param27=[DANLUU,null], @param28=[NGAYRUT,null], @param29=[NGAYCATCHI,null], @param30=[KHAC,null], @param31=[SOLANMOLAI,null], @param32=[LYDOMOLAI,null], @param33=[CANTHIEPPHAUTHUAT,null], @param34=[TUDIENKETQUA_ID,null], @param35=[PHONGBANCHIDINH_ID,null], @param36=[PPMO_ID,null], @param37=[THOIGIANGAYME,null], @param38=[KHOADULIEU,0], @param39=[NGUOIKHOA_ID,null], @param40=[TENNGUOIKHOA,null], @param41=[NGAYKHOADULIEU,null], @param42=[THOIGIANKHOADULIEU,null], @param43=[NGAYCAPNHAT,2/26/2020 10:40:18 AM], @param44=[NGUOICAPNHAT_ID,1], @param45=[BENHVIEN_ID,HLU01], @param46=[PHUONGPHAPPTTT,null], @param47=[TRINHTUTHUCHIEN_TEXT,asfsfwefw 
qwefrwer
wr ẻ r .
wweee]]
2020-02-26 10:40:18,344 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_Update] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[System.DBNull, null], @param3=[System.DBNull, null], @param4=[Int64, System.Int64], @param5=[Int64, System.Int64], @param6=[DateTime, System.DateTime], @param7=[DateTime, System.DateTime], @param8=[DateTime, System.DateTime], @param9=[String, System.String], @param10=[String, System.String], @param11=[String, System.String], @param12=[String, System.String], @param13=[String, System.String], @param14=[String, System.String], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[Int64, System.Int64], @param20=[System.DBNull, null], @param21=[String, System.String], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[Int64, System.Int64], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[System.DBNull, null], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[DateTime, System.DateTime], @param44=[Int64, System.Int64], @param45=[String, System.String], @param46=[System.DBNull, null], @param47=[String, System.String]]
2020-02-26 10:40:18,417 [1] DEBUG - Statement Id: [DAO00049_KiemtraloaiDV] PreparedStatement : [select DICHVU_ID AS HA, '' AS XN, '' as TDCN, '' as TT, '' as KB from TM_DICHVU            left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = TM_DICHVU.NHOMDICHVU_ID            where DICHVU_ID = '' and left(ndv.MANHOMDICHVU, 2) = '02'            union            select  '' as HA, DICHVU_ID AS XN, '' as TDCN, '' as TT, '' as KB from TM_DICHVU            left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = TM_DICHVU.NHOMDICHVU_ID            where DICHVU_ID = '' and left(ndv.MANHOMDICHVU, 2) = '01'            union            select  '' as HA, '' AS XN, DICHVU_ID as TDCN, '' as TT, '' as KB from TM_DICHVU            left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = TM_DICHVU.NHOMDICHVU_ID            where DICHVU_ID = '' and left(ndv.MANHOMDICHVU, 2) = '03'            union            select  '' as HA, '' AS XN, '' as TDCN, DICHVU_ID as TT, '' as KB from TM_DICHVU            left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = TM_DICHVU.NHOMDICHVU_ID            where DICHVU_ID = '' and left(ndv.MANHOMDICHVU, 2) = '05'            union            select  '' as HA, '' AS XN, '' as TDCN, DICHVU_ID as TT, '' as KB from TM_DICHVU            left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = TM_DICHVU.NHOMDICHVU_ID            where DICHVU_ID = '' and left(ndv.MANHOMDICHVU, 2) = '06'            union            select  '' as HA, '' AS XN, '' as TDCN, '' as TT, DICHVU_ID as KB from TM_DICHVU            left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = TM_DICHVU.NHOMDICHVU_ID            where DICHVU_ID = '' and left(ndv.MANHOMDICHVU, 2) = '04']
2020-02-26 10:40:18,558 [1] DEBUG - Statement Id: [DAO00009_GetThutiensauDVThuthuatPhauThuat] PreparedStatement : [select A.THUTIENSAU, B.SOTIEPNHAN, A.DICHVU_ID, A.DVYEUCAU_ID        from TT_DVYEUCAU A        inner join TT_TIEPNHAN B on B.TIEPNHAN_ID = A.TIEPNHAN_ID        inner join TT_PHAUTHUAT_YEUCAU C on C.DVYEUCAU_ID = A.DVYEUCAU_ID        where C.PHAUTHUAT_ID =  '68088']
2020-02-26 10:40:18,604 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN191213.0000035']
2020-02-26 10:40:18,628 [1] DEBUG - Statement Id: [DAOWF001_Kiemtrathongtindayeucaureturn] PreparedStatement : [select * from TT_REQUEST        where        PARA = '{"HOSPITAL_ID":"HLU01","SOTIEPNHAN":"TN191213.0000035"}']
2020-02-26 10:40:18,729 [1] DEBUG - Statement Id: [DAOWF001_Kiemtrathongtindichvudayeucaureturn] PreparedStatement : [select top 1 * from TT_REQUEST_SERVICE        where        PARA = '{"DICHVU_ID":"3284","DVYEUCAU_ID":"902957"}'  order by ID desc]
2020-02-26 10:40:18,770 [1] DEBUG - Statement Id: [DAOWF005_ReturnStateCuaDichVuYeuCau] PreparedStatement : [declare        @Detail_Id int,        @CurentState char(8),        @OldState char(8)          select top 1 @Detail_Id = ID, @CurentState = OLD_STATE_CODE, @OldState = CURR_STATE_CODE from TT_REQUEST_SERVICE_DETAIL        where        REQUEST_ID = '104032'        AND REQUEST_SERVICE_ID = '518845'        order by ID desc;          update TT_REQUEST_SERVICE set CURR_STATE_CODE = @CurentState, ISACTIVE = 1, ISCOMPLETE = 0 where ID = '518845';        delete from TT_REQUEST_SERVICE_DETAIL where ID = @Detail_Id;        insert into TT_REQUEST_SERVICE_HISTORY        (REQUEST_ID,REQUEST_SERVICE_ID, OLD_STATE_CODE, CURR_STATE_CODE) values ('104032','518845',@OldState, @CurentState);        select top 1 A.*, B.STATUS_CODE from TT_REQUEST_SERVICE A        left join TM_STATE B on A.CURR_STATE_CODE = B.STATE_CODE and A.PROCESS_CODE = B.PROCESS_CODE        where A.ID = '518845';]
2020-02-26 10:40:18,919 [1] DEBUG - Statement Id: [DAO00009_TT_DVYEUCAU_Update] PreparedStatement : [Update TT_DVYEUCAU set TRANGTHAI_WFL = 'CHUAKETQUA' where DVYEUCAU_ID = '902957']
2020-02-26 10:40:18,945 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_YEUCAU_DeleteP] PreparedStatement : [delete from TT_PHAUTHUAT_YEUCAU             where                     TT_PHAUTHUAT_YEUCAU.PHAUTHUAT_ID = '68088']
2020-02-26 10:40:19,026 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_PPVOCAM_DeleteP] PreparedStatement : [delete from TT_PHAUTHUAT_PPVOCAM              where PHAUTHUAT_ID = '68088']
2020-02-26 10:40:19,059 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_IMAGES_DeleteP] PreparedStatement : [delete from TT_PHAUTHUAT_IMAGES               where                             TT_PHAUTHUAT_IMAGES.PHAUTHUAT_ID = '68088']
2020-02-26 10:40:19,083 [1] DEBUG - Statement Id: [DAO00049_KiemtraloaiDV] PreparedStatement : [select DICHVU_ID AS HA, '' AS XN, '' as TDCN, '' as TT, '' as KB from TM_DICHVU            left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = TM_DICHVU.NHOMDICHVU_ID            where DICHVU_ID = '3284' and left(ndv.MANHOMDICHVU, 2) = '02'            union            select  '' as HA, DICHVU_ID AS XN, '' as TDCN, '' as TT, '' as KB from TM_DICHVU            left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = TM_DICHVU.NHOMDICHVU_ID            where DICHVU_ID = '3284' and left(ndv.MANHOMDICHVU, 2) = '01'            union            select  '' as HA, '' AS XN, DICHVU_ID as TDCN, '' as TT, '' as KB from TM_DICHVU            left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = TM_DICHVU.NHOMDICHVU_ID            where DICHVU_ID = '3284' and left(ndv.MANHOMDICHVU, 2) = '03'            union            select  '' as HA, '' AS XN, '' as TDCN, DICHVU_ID as TT, '' as KB from TM_DICHVU            left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = TM_DICHVU.NHOMDICHVU_ID            where DICHVU_ID = '3284' and left(ndv.MANHOMDICHVU, 2) = '05'            union            select  '' as HA, '' AS XN, '' as TDCN, DICHVU_ID as TT, '' as KB from TM_DICHVU            left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = TM_DICHVU.NHOMDICHVU_ID            where DICHVU_ID = '3284' and left(ndv.MANHOMDICHVU, 2) = '06'            union            select  '' as HA, '' AS XN, '' as TDCN, '' as TT, DICHVU_ID as KB from TM_DICHVU            left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = TM_DICHVU.NHOMDICHVU_ID            where DICHVU_ID = '3284' and left(ndv.MANHOMDICHVU, 2) = '04']
2020-02-26 10:40:19,108 [1] DEBUG - Statement Id: [DAO00009_GetThutiensauDVThuthuat] PreparedStatement : [select A.THUTIENSAU, B.SOTIEPNHAN, A.DICHVU_ID, A.DVYEUCAU_ID        from TT_DVYEUCAU A        inner join TT_TIEPNHAN B on B.TIEPNHAN_ID = A.TIEPNHAN_ID        where        A.DVYEUCAU_ID = '902957']
2020-02-26 10:40:19,133 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN191213.0000035']
2020-02-26 10:40:19,197 [1] DEBUG - Statement Id: [DAOWF001_Kiemtrathongtindayeucaudacochua] PreparedStatement : [select * from TT_REQUEST        where        PARA = '{"HOSPITAL_ID":"HLU01","SOTIEPNHAN":"TN191213.0000035"}'        AND ISACTIVE = '1']
2020-02-26 10:40:19,332 [1] DEBUG - Statement Id: [DAOWF001_Kiemtrathongtindichvudayeucau] PreparedStatement : [select top 1 * from TT_REQUEST_SERVICE        where        PARA = '{"DICHVU_ID":"3284","DVYEUCAU_ID":"902957"}'                AND ISACTIVE = '1' order by ID desc]
2020-02-26 10:40:19,369 [1] DEBUG - Statement Id: [DAOWF001_KiemtrathongtinchitietDichvuYeucau] PreparedStatement : [select * from TT_REQUEST_SERVICE_DETAIL        where        REQUEST_SERVICE_ID = '518845']
2020-02-26 10:40:19,392 [1] DEBUG - Statement Id: [DAOWF001_Laythongtinwithstatecode] PreparedStatement : [select A.*, B.STATUS_CODE from        TM_STATE_ACTION A        left join TM_STATE B on B.STATE_CODE = A.NEXT_STATE_CODE and A.PROCESS_CODE = B.PROCESS_CODE        where        A.CURR_STATE_CODE = '1     '        AND A.PROCESS_CODE = 'P01'        Order By ORDER_ID ASC]
2020-02-26 10:40:19,415 [1] DEBUG - Statement Id: [DAOWF003_Update] PreparedStatement : [update TT_REQUEST_SERVICE set        CURR_STATE_CODE =  @param0                   , ISACTIVE =  @param1                     , ISCOMPLETE =  @param2                        where        ID = '518845']
2020-02-26 10:40:19,415 [1] DEBUG - Statement Id: [DAOWF003_Update] Parameters: [@param0=[CURR_STATE_CODE,2], @param1=[ISACTIVE,1], @param2=[ISCOMPLETE,0]]
2020-02-26 10:40:19,415 [1] DEBUG - Statement Id: [DAOWF003_Update] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[String, System.String]]
2020-02-26 10:40:19,449 [1] DEBUG - Statement Id: [DAOWF005_Add] PreparedStatement : [insert into TT_REQUEST_SERVICE_DETAIL (        REQUEST_ID        ,REQUEST_SERVICE_ID        , OLD_STATE_CODE        , CURR_STATE_CODE        ) values (         @param0         , @param1         ,  @param2         ,  @param3         )        SELECT SCOPE_IDENTITY()]
2020-02-26 10:40:19,449 [1] DEBUG - Statement Id: [DAOWF005_Add] Parameters: [@param0=[REQUEST_ID,104032], @param1=[REQUEST_SERVICE_ID,518845], @param2=[OLD_STATE_CODE,1     ], @param3=[CURR_STATE_CODE,2]]
2020-02-26 10:40:19,450 [1] DEBUG - Statement Id: [DAOWF005_Add] Types: [@param0=[String, System.String], @param1=[Int32, System.Int32], @param2=[String, System.String], @param3=[String, System.String]]
2020-02-26 10:40:19,473 [1] DEBUG - Statement Id: [DAOWF005_Add_History] PreparedStatement : [insert into TT_REQUEST_SERVICE_HISTORY (        REQUEST_ID        ,REQUEST_SERVICE_ID        , OLD_STATE_CODE        , CURR_STATE_CODE        ) values (         @param0         , @param1         ,  @param2         ,  @param3         )]
2020-02-26 10:40:19,473 [1] DEBUG - Statement Id: [DAOWF005_Add_History] Parameters: [@param0=[REQUEST_ID,104032], @param1=[REQUEST_SERVICE_ID,518845], @param2=[OLD_STATE_CODE,1     ], @param3=[CURR_STATE_CODE,2]]
2020-02-26 10:40:19,473 [1] DEBUG - Statement Id: [DAOWF005_Add_History] Types: [@param0=[String, System.String], @param1=[Int32, System.Int32], @param2=[String, System.String], @param3=[String, System.String]]
2020-02-26 10:40:19,497 [1] DEBUG - Statement Id: [DAO00009_TT_DVYEUCAU_Update] PreparedStatement : [Update TT_DVYEUCAU set TRANGTHAI_WFL = 'HOANTAT' where DVYEUCAU_ID = '902957']
2020-02-26 10:40:19,521 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_YEUCAU_Add] PreparedStatement : [insert into TT_PHAUTHUAT_YEUCAU (              PHAUTHUAT_ID              , DVYEUCAU_ID              , NHOMDICHVU_ID              , DICHVU_ID              , LOAIGIA_ID              , THANHTIEN_DOANHTHU              , BHYT_THANHTIEN_CHITRA              , BENHNHAN_PHAITHANHTOAN              , BENHVIEN_ID              ) values (               @param0               ,  @param1               ,  @param2               ,  @param3               ,  @param4               ,  @param5               ,  @param6               ,  @param7               ,  @param8               )]
2020-02-26 10:40:19,521 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_YEUCAU_Add] Parameters: [@param0=[PHAUTHUAT_ID,68088], @param1=[DVYEUCAU_ID,902957], @param2=[NHOMDICHVU_ID,27], @param3=[DICHVU_ID,3284], @param4=[LOAIGIA_ID,3], @param5=[THANHTIEN_DOANHTHU,70000], @param6=[BHYT_THANHTIEN_CHITRA,0], @param7=[BENHNHAN_PHAITHANHTOAN,70000], @param8=[BENHVIEN_ID,HLU01]]
2020-02-26 10:40:19,521 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_YEUCAU_Add] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64], @param2=[Int64, System.Int64], @param3=[Int64, System.Int64], @param4=[Int64, System.Int64], @param5=[Double, System.Double], @param6=[Double, System.Double], @param7=[Double, System.Double], @param8=[String, System.String]]
2020-02-26 10:40:19,548 [1] DEBUG - Statement Id: [DAO00048_UpdateDVYeuCauVienPhi] PreparedStatement : [update  TT_VIENPHI              set DATHUCHIEN = '1',              NGUOICAPNHAT_ID =  @param0 ,              NGAYCAPNHAT =  @param1               where              VIENPHI_ID =  @param2]
2020-02-26 10:40:19,548 [1] DEBUG - Statement Id: [DAO00048_UpdateDVYeuCauVienPhi] Parameters: [@param0=[NGUOICAPNHAT_ID,1], @param1=[NGAYCAPNHAT,2/26/2020 10:40:19 AM], @param2=[VIENPHI_ID,2851611]]
2020-02-26 10:40:19,548 [1] DEBUG - Statement Id: [DAO00048_UpdateDVYeuCauVienPhi] Types: [@param0=[Int64, System.Int64], @param1=[DateTime, System.DateTime], @param2=[Int64, System.Int64]]
2020-02-26 10:40:19,573 [1] DEBUG - Statement Id: [DAO00048_UpdateDVYeuCau] PreparedStatement : [update  TT_DVYEUCAU              set TRANGTHAI =  @param0 ,              NGUOICAPNHAT_ID =  @param1 ,              NGAYCAPNHAT =  @param2               where              DVYEUCAU_ID =  @param3]
2020-02-26 10:40:19,573 [1] DEBUG - Statement Id: [DAO00048_UpdateDVYeuCau] Parameters: [@param0=[TRANGTHAI,CHOXACNHAN], @param1=[NGUOICAPNHAT_ID,1], @param2=[NGAYCAPNHAT,2/26/2020 10:40:19 AM], @param3=[DVYEUCAU_ID,902957]]
2020-02-26 10:40:19,573 [1] DEBUG - Statement Id: [DAO00048_UpdateDVYeuCau] Types: [@param0=[String, System.String], @param1=[Int64, System.Int64], @param2=[DateTime, System.DateTime], @param3=[Int64, System.Int64]]
2020-02-26 10:40:19,598 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_PPVOCAM_Add] PreparedStatement : [insert into TT_PHAUTHUAT_PPVOCAM (              PHAUTHUAT_ID,              PPVOCAM_ID,              BENHVIEN_ID)              values (               @param0 ,               @param1 ,               @param2 )]
2020-02-26 10:40:19,598 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_PPVOCAM_Add] Parameters: [@param0=[PHAUTHUAT_ID,68088], @param1=[PPVOCAM_ID,516], @param2=[BENHVIEN_ID,HLU01]]
2020-02-26 10:40:19,598 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_PPVOCAM_Add] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64], @param2=[String, System.String]]
2020-02-26 10:40:19,647 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_GetDetail] PreparedStatement : [select PT.*, TN.BENHNHAN_ID              from              TT_PHAUTHUAT PT, TT_TIEPNHAN TN              where              PT.TIEPNHAN_ID = TN.TIEPNHAN_ID              AND PHAUTHUAT_ID  = 68088]
2020-02-26 10:40:19,729 [1] DEBUG - Statement Id: [DAO00048_CheckDVPhauThuatBHYT] PreparedStatement : [select count(0) from TT_VIENPHI          where REF_TABLE = 'TT_DVYEUCAU' and REF_ID = (select top 1 DVYEUCAU_ID from TT_PHAUTHUAT_YEUCAU where PHAUTHUAT_ID =  @param0 )          and TIEPNHAN_ID =  @param1  and BHYT_DONGIA > 0]
2020-02-26 10:40:19,729 [1] DEBUG - Statement Id: [DAO00048_CheckDVPhauThuatBHYT] Parameters: [@param0=[PHAUTHUAT_ID,68088], @param1=[TIEPNHAN_ID,99533]]
2020-02-26 10:40:19,729 [1] DEBUG - Statement Id: [DAO00048_CheckDVPhauThuatBHYT] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64]]
2020-02-26 10:40:19,768 [1] DEBUG - Statement Id: [DAO00116_File_GetList] PreparedStatement : [select *              from TT_FILE_DINHKEM               where                             TT_FILE_DINHKEM.REF_TABLE = 'TT_PHAUTHUAT'                       and                           TT_FILE_DINHKEM.REF_ID = '68088'                       and                           TT_FILE_DINHKEM.BENHVIEN_ID = 'HLU01'                                     order by FILE_ID]
2020-02-26 10:40:19,872 [1] DEBUG - Statement Id: [DAO00051_GetMauTuongTrinh] PreparedStatement : [select *            from TM_TUDIENKETQUA            where BENHVIEN_ID = 'HLU01'              and                 (NGUOITAO_ID = '1' OR SUDUNGCHUNG = '1')                and DICHVU_ID in  (                        @param0                   )               ORDER BY TENNOIDUNG]
2020-02-26 10:40:19,872 [1] DEBUG - Statement Id: [DAO00051_GetMauTuongTrinh] Parameters: [@param0=[LSTDICHVU_ID[0],3284]]
2020-02-26 10:40:19,872 [1] DEBUG - Statement Id: [DAO00051_GetMauTuongTrinh] Types: [@param0=[Int64, System.Int64]]
2020-02-26 10:40:19,907 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_GetDetail] PreparedStatement : [select PT.*, TN.BENHNHAN_ID              from              TT_PHAUTHUAT PT, TT_TIEPNHAN TN              where              PT.TIEPNHAN_ID = TN.TIEPNHAN_ID              AND PHAUTHUAT_ID  = 68088]
2020-02-26 10:40:19,951 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_IMAGES_GetList] PreparedStatement : [select *              from TT_PHAUTHUAT_IMAGES               where                             TT_PHAUTHUAT_IMAGES.PHAUTHUAT_ID = '68088'                       and                           TT_PHAUTHUAT_IMAGES.BENHVIEN_ID = 'HLU01'                                     order by IMAGES_ID]
2020-02-26 10:40:23,701 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_YEUCAU_GetList] PreparedStatement : [SELECT YC.[PHAUTHUAT_YEUCAU_ID]              ,YC.[PHAUTHUAT_ID]              ,YC.[DVYEUCAU_ID]              ,YC.[NHOMDICHVU_ID]              ,YC.[DICHVU_ID]              ,YC.[LOAIGIA_ID]              ,VP.[BHYT_THANHTIEN_CHITRA]              ,VP.[BENHNHAN_PHAITHANHTOAN]              ,VP.[THANHTIEN_DOANHTHU]              ,YC.[BENHVIEN_ID]              ,DVYC.NGAYGIOYEUCAU              ,DV.TENDICHVU              ,NDV.TENNHOMDICHVU              FROM [TT_PHAUTHUAT_YEUCAU] YC              INNER JOIN TT_VIENPHI VP ON YC.DVYEUCAU_ID= VP.REF_ID AND VP.REF_TABLE ='TT_DVYEUCAU'              INNER JOIN TT_DVYEUCAU DVYC ON DVYC.DVYEUCAU_ID = YC.DVYEUCAU_ID              INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = DVYC.DICHVU_ID              INNER JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID               where                             YC.PHAUTHUAT_ID = '68088'                       and                           YC.BENHVIEN_ID = 'HLU01'                                     order by PHAUTHUAT_YEUCAU_ID]
2020-02-26 10:40:23,759 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_PPVOCAM_GetDetail] PreparedStatement : [select *              from TT_PHAUTHUAT_PPVOCAM              where PHAUTHUAT_ID  = 68088]
2020-02-26 10:40:23,907 [1] DEBUG - Statement Id: [DAO00019_ThongTinBenhNhanTiepNhan] PreparedStatement : [select distinct A.SOTIEPNHAN, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        B.*, A.SOBHYT        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'        where                    A.TIEPNHAN_ID = '329'                 and A.BENHVIEN_ID = 'HLU01']
2020-02-26 10:40:24,173 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_GetList] PreparedStatement : [select *              from TT_PHAUTHUAT               where                             TT_PHAUTHUAT.LOAI = 'P'                       and                           TT_PHAUTHUAT.TIEPNHAN_ID = 329                       and                           TT_PHAUTHUAT.BENHVIEN_ID = 'HLU01'                                     order by PHAUTHUAT_ID DESC]
2020-02-26 10:40:24,236 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '329'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2020-02-26 10:40:24,318 [1] DEBUG - Statement Id: [DAO00048_GetBenhNhanByBenhNhanID] PreparedStatement : [SELECT *              FROM              TT_BENHNHAN               where                             BENHNHAN_ID = '326']
2020-02-26 10:40:24,346 [1] DEBUG - Statement Id: [DAO00000_GetDoiTuongIsBHYT] PreparedStatement : [select * from TM_DOITUONG Where DOITUONG_ID = 6 and MADOITUONG like '%BHYT%']
2020-02-26 10:40:24,561 [1] DEBUG - Statement Id: [DAO00048_GetDICHVUYCByTiepNhanID] PreparedStatement : [SELECT DISTINCT D.HOPDONG_ID, D.HOPDONG_BENHNHAN_ID, D.DVYEUCAU_ID, D.DICHVU_ID, D.SOPHIEUYEUCAU, D.NGAYGIOYEUCAU, D.NOITHUCHIEN_ID, P.LOAIPHAUTHUAT, L.STT AS STT_LOAIPHAUTHUAT            FROM            TT_DVYEUCAU AS D            left join TM_PHANLOAIPHAUTHUAT AS P ON D.DICHVU_ID = P.DICHVU_ID            left join TM_LOAIPHAUTHUAT AS L ON L.LOAIPHAUTHUAT = P.LOAIPHAUTHUAT            where            not exists (select DVYEUCAU_ID from TT_PHAUTHUAT_YEUCAU where D.DVYEUCAU_ID = DVYEUCAU_ID)               and                       exists                      (select DICHVU_ID from TM_DICHVU                      where D.DICHVU_ID = DICHVU_ID and                      exists                      (select NHOMDICHVU_ID from TM_NHOMDICHVU                      where TM_DICHVU.NHOMDICHVU_ID = NHOMDICHVU_ID and left(MANHOMDICHVU,2) in (05)                      )                                             )                     and                           D.TIEPNHAN_ID = '329']
2020-02-26 10:40:24,752 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '329'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2020-02-26 10:40:28,951 [1] DEBUG - Statement Id: [DAO00048_GetDVYeuCauByDVYeuCauID] PreparedStatement : [SELECT A.*, B.NGAYGIOYEUCAU, C.TENDICHVU, D.TENNHOMDICHVU, D.NHOMDICHVU_ID            FROM TT_VIENPHI A            left join TT_DVYEUCAU B on A.REF_ID = B.DVYEUCAU_ID            inner join TM_DICHVU C on C.DICHVU_ID = B.DICHVU_ID            inner join TM_NHOMDICHVU D on D.NHOMDICHVU_ID = C.NHOMDICHVU_ID            WHERE            A.REF_ID IN (22759)            and A.REF_TABLE='TT_DVYEUCAU'            AND A.TIEPNHAN_ID = 329]
2020-02-26 10:40:52,791 [1] DEBUG - Statement Id: [DAO00051_GetMauTuongTrinh] PreparedStatement : [select *            from TM_TUDIENKETQUA            where BENHVIEN_ID = 'HLU01'              and                 (NGUOITAO_ID = '1' OR SUDUNGCHUNG = '1')                and DICHVU_ID in  (                        @param0                   )               ORDER BY TENNOIDUNG]
2020-02-26 10:40:52,791 [1] DEBUG - Statement Id: [DAO00051_GetMauTuongTrinh] Parameters: [@param0=[LSTDICHVU_ID[0],5121]]
2020-02-26 10:40:52,791 [1] DEBUG - Statement Id: [DAO00051_GetMauTuongTrinh] Types: [@param0=[Int64, System.Int64]]
2020-02-26 10:41:03,772 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '329'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2020-02-26 10:41:03,879 [1] DEBUG - Statement Id: [DAO00014_GetInPatientStatus] PreparedStatement : [select TRANGTHAI, isnull(KHOACHUYENDEN_ID, KHOAVAO_ID) as KHOAHIENTAI from TT_NOITRU_BENHAN        where        TIEPNHAN_ID = '329'        and BENHVIEN_ID = 'HLU01'         and           BENHAN_ID = '40']
2020-02-26 10:41:14,483 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '329'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2020-02-26 10:41:14,557 [1] DEBUG - Statement Id: [DAO00014_GetInPatientStatus] PreparedStatement : [select TRANGTHAI, isnull(KHOACHUYENDEN_ID, KHOAVAO_ID) as KHOAHIENTAI from TT_NOITRU_BENHAN        where        TIEPNHAN_ID = '329'        and BENHVIEN_ID = 'HLU01'         and           BENHAN_ID = '40']
2020-02-26 10:41:14,633 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '329'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2020-02-26 10:41:14,723 [1] DEBUG - Statement Id: [DAO00014_GetInPatientStatus] PreparedStatement : [select TRANGTHAI, isnull(KHOACHUYENDEN_ID, KHOAVAO_ID) as KHOAHIENTAI from TT_NOITRU_BENHAN        where        TIEPNHAN_ID = '329'        and BENHVIEN_ID = 'HLU01'         and           BENHAN_ID = '40']
2020-02-26 10:41:14,880 [1] DEBUG - Statement Id: [DAO00048_GetTrangThaiTruocKhiLuu_TuongTrinh] PreparedStatement : [SELECT PHAUTHUAT_YEUCAU_ID FROM TT_PHAUTHUAT_YEUCAU PTYC              WHERE BENHVIEN_ID ='HLU01'                and DVYEUCAU_ID in  (                        @param0                   )]
2020-02-26 10:41:14,881 [1] DEBUG - Statement Id: [DAO00048_GetTrangThaiTruocKhiLuu_TuongTrinh] Parameters: [@param0=[LISTDVYEUCAU_ID[0],22759]]
2020-02-26 10:41:14,881 [1] DEBUG - Statement Id: [DAO00048_GetTrangThaiTruocKhiLuu_TuongTrinh] Types: [@param0=[Int64, System.Int64]]
--------------------------------------------------------------------------------
2020-02-26 10:43:42,000 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2020-02-26 10:43:42,346 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2020-02-26 10:43:42,382 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2020-02-26 10:43:42,865 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 10:43:43,148 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2020-02-26 10:43:48,219 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2020-02-26 10:43:48,246 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2020-02-26 10:43:50,031 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2020-02-26 10:43:50,207 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2020-02-26 10:43:51,005 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2020-02-26 10:43:51,209 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2020-02-26 10:43:51,300 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2020-02-26 10:43:51,366 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2020-02-26 10:43:51,440 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2020-02-26 10:43:51,512 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2020-02-26 10:43:51,580 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2020-02-26 10:43:51,654 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2020-02-26 10:43:51,724 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2020-02-26 10:43:52,367 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2020-02-26 10:43:52,400 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2020-02-26 10:43:52,475 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2020-02-26 10:43:52,626 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2020-02-26 10:43:53,309 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2020-02-26 10:43:53,429 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @NGUONDUOC_MACDINH varchar(5) = '0';        declare @TOAMUANGOAI int = 0;        select @NGUONDUOC_MACDINH = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'PHA_NGUONDUOC'        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + @NGUONDUOC_MACDINH as DUOC_KEY, 0 as PHAMVI_ID, @NGUONDUOC_MACDINH as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end        else        begin                select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (        select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID)        B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (        select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID)        A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2020-02-26 10:43:54,776 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2020-02-26 10:43:54,866 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,        SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH        FROM TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID        WHERE TK.SOLUONG > 0        GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2020-02-26 10:43:55,032 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2020-02-26 10:43:55,065 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,        TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,        TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH        from TM_MAU M        JOIN        (        select        A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO        from        (        select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO        from TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'        where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0        ) A        )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2020-02-26 10:43:55,300 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2020-02-26 10:43:56,278 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 10:43:57,151 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2020-02-26 10:44:04,094 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2020-02-26 10:44:04,122 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2020-02-26 10:44:04,204 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 10:44:04,337 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 10:44:04,485 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2020-02-26 10:44:04,488 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2020-02-26 10:44:04,488 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2020-02-26 10:44:04,519 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2020-02-26 10:44:04,519 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2020-02-26 10:44:04,519 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2020-02-26 10:44:04,698 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 10:44:04,888 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 10:44:18,731 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 10:44:18,831 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2020-02-26 10:44:19,286 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2020-02-26 10:46:13,174 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'OPD23'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 10:46:14,364 [1] DEBUG - Statement Id: [DAO00019_DanhSachPhauThuatThuThuat] PreparedStatement : [declare @TenBenhVien nvarchar(500)        declare @ManhomDSA varchar(10);        set @TenBenhVien = (select VALUE from TM_SYS_APPSETTINGS where CODE = 'APP_BENHVIEN_TEN')        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        select * from(        select ROW_NUMBER() OVER(order by NGAYGIOYEUCAU) as ROWNUMBER, *        from        (SELECT distinct        COUNT(*) OVER() as TOTALROWS,        N'Mã người bệnh: ' + bn.MAYTE + ' - ' + N'Tên người bệnh: ' + bn.TENBENHNHAN + ' - ' + N'Số bệnh án: ' + ISNULL(BA.SOBENHAN,'') + ' - ' + N'Sinh ngày: ' + isnull(Convert(varchar(10),bn.NGAYSINH,103),bn.NAMSINH) + ' - ' + N'Giới tính: ' + GD.DESCRIPTION as GROUPNAME,        bn.MAYTE, bn.TENBENHNHAN, bn.NAMSINH, bn.NGAYSINH as TUOI, ISNULL(CONVERT(VARCHAR(10), bn.NGAYSINH, 103),CAST(bn.NAMSINH AS varchar)) as NGAYSINH, bn.DIACHILIENLAC as DIACHI, bn.GIOITINH, GD.DESCRIPTION as TENGIOITINH,        tn.DOITUONG_ID, tn.THOIGIANTIEPNHAN, tn.BENHNHAN_ID, tn.TIEPNHAN_ID, tn.TRAITUYEN, tn.SOTIEPNHAN        , dv.DICHVU_ID, dv.NOITHUCHIEN_ID, isnull(dv.NGAYTAO, dv.NGAYCAPNHAT) as THOIGIANDKDICHVU        , dv.KHAN, dv.NOIYEUCAU_ID, dv.NGAYGIOYEUCAU, dv.BACSICHIDINH_ID, dv.DONVIGIOITHIEU_ID        , dv.NGUOIGIOITHIEU_ID, dv.TRANGTHAI_WFL, tn.NOIGIOITHIEU_ID        , dv.DVYEUCAU_ID, dv.MARIS, dv.TRANGTHAI as TRANGTHAICODE, B.TENNHOMDICHVU, dv.SOPHIEUYEUCAU, dv.KHAMBENH_NGOAITRU_ID, dv.NGUOICAPNHAT_ID, dv.NGAYCAPNHAT,        CASE        WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU        WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02'        ELSE Left(B.MANHOMDICHVU,2) END AS MANHOMDICHVU, B.MANHOMDICHVU as MANHOMDICHVUCHITIET, tn.TRANGTHAI as TRANGTHAI_TIEPNHAN,        'False' as DAKHAM,        vp.DATHANHTOAN, vp.DONGIA_DOANHTHU, BA.SOBENHAN, dv.CHANDOAN        , a.TENDICHVU, nth.TENPHONGBAN as TENPHONGKHAM, nyc.TENPHONGBAN as TENKHOACHIDINH        , bscd.TENNHANVIEN as TENBACSICHIDINH        , 0 as GUINGOAI        , 0 as VTYT        , 0 as CLSKETQUA_ID          ,             '' SOPHIEUPHAUTHUAT                   FROM TT_DVYEUCAU (NOLOCK) dv        inner join TT_TIEPNHAN (NOLOCK) tn on dv.TIEPNHAN_ID = tn.TIEPNHAN_ID        inner join TT_BENHNHAN (NOLOCK) bn on tn.BENHNHAN_ID = bn.BENHNHAN_ID        inner join TM_DICHVU A on A.DICHVU_ID = dv.DICHVU_ID        inner join TM_PHONGBAN nth on nth.PHONGBAN_ID = dv.NOITHUCHIEN_ID        left join TM_NHANVIEN bscd on bscd.NHANVIEN_ID = dv.BACSICHIDINH_ID        inner join TM_PHONGBAN nyc on nyc.PHONGBAN_ID = dv.NOIYEUCAU_ID        inner join TM_NHOMDICHVU B on B.NHOMDICHVU_ID = A.NHOMDICHVU_ID        inner join TT_VIENPHI (NOLOCK) VP on VP.TIEPNHAN_ID = tn.TIEPNHAN_ID and VP.DICHVU_ID = dv.DICHVU_ID and VP.REF_ID = dv.DVYEUCAU_ID        left join TT_NOITRU_BENHAN (NOLOCK) BA on BA.TIEPNHAN_ID = tn.TIEPNHAN_ID AND dv.BENHAN_ID = BA.BENHAN_ID        inner join TM_GENDER GD on GD.ID = bn.GIOITINH                 where        dv.DICHVU_ID IS NOT NULL        and tn.BENHVIEN_ID = 'HLU01'        and HUYYEUCAU = 0        and dv.NGAYHENCLS is NULL                       and dv.TRANGTHAI = 'CHUAKETQUA'           and           dv.NGAYYEUCAU >= '2/26/2020 12:00:00 AM'         and           dv.NGAYYEUCAU <= '2/26/2020 12:00:00 AM'         and           dv.NOITHUCHIEN_ID = 25         and           (CASE          WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU          WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2)          END) in (05)         and           tn.TRANGTHAI IN ('DATIEPNHAN','NOITRU','CAPCUU', 'HOANTHANH')         and           (vp.DATHANHTOAN = '1'  or vp.DONGIA_DOANHTHU = '0' OR TN.SUDUNG_BHTN='1' OR TN.BAOLANH_VIENPHI='1'  OR tn.TRANGTHAI IN ('NOITRU','CAPCUU','NGOAITRU') or dv.HOPDONG_BENHNHAN_ID is not null or vp.BENHNHAN_PHAITHANHTOAN >= 0)                 ) data1) lst                    where          lst.ROWNUMBER between 1 and 20                 order by NGAYGIOYEUCAU asc]
2020-02-26 10:46:14,811 [1] DEBUG - Statement Id: [DAO00217_GetEmployeeAll] PreparedStatement : [select * from TM_NHANVIEN]
2020-02-26 10:46:20,662 [1] DEBUG - Statement Id: [DAO00019_DanhSachPhauThuatThuThuat] PreparedStatement : [declare @TenBenhVien nvarchar(500)        declare @ManhomDSA varchar(10);        set @TenBenhVien = (select VALUE from TM_SYS_APPSETTINGS where CODE = 'APP_BENHVIEN_TEN')        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        select * from(        select ROW_NUMBER() OVER(order by NGAYGIOYEUCAU) as ROWNUMBER, *        from        (SELECT distinct        COUNT(*) OVER() as TOTALROWS,        N'Mã người bệnh: ' + bn.MAYTE + ' - ' + N'Tên người bệnh: ' + bn.TENBENHNHAN + ' - ' + N'Số bệnh án: ' + ISNULL(BA.SOBENHAN,'') + ' - ' + N'Sinh ngày: ' + isnull(Convert(varchar(10),bn.NGAYSINH,103),bn.NAMSINH) + ' - ' + N'Giới tính: ' + GD.DESCRIPTION as GROUPNAME,        bn.MAYTE, bn.TENBENHNHAN, bn.NAMSINH, bn.NGAYSINH as TUOI, ISNULL(CONVERT(VARCHAR(10), bn.NGAYSINH, 103),CAST(bn.NAMSINH AS varchar)) as NGAYSINH, bn.DIACHILIENLAC as DIACHI, bn.GIOITINH, GD.DESCRIPTION as TENGIOITINH,        tn.DOITUONG_ID, tn.THOIGIANTIEPNHAN, tn.BENHNHAN_ID, tn.TIEPNHAN_ID, tn.TRAITUYEN, tn.SOTIEPNHAN        , dv.DICHVU_ID, dv.NOITHUCHIEN_ID, isnull(dv.NGAYTAO, dv.NGAYCAPNHAT) as THOIGIANDKDICHVU        , dv.KHAN, dv.NOIYEUCAU_ID, dv.NGAYGIOYEUCAU, dv.BACSICHIDINH_ID, dv.DONVIGIOITHIEU_ID        , dv.NGUOIGIOITHIEU_ID, dv.TRANGTHAI_WFL, tn.NOIGIOITHIEU_ID        , dv.DVYEUCAU_ID, dv.MARIS, dv.TRANGTHAI as TRANGTHAICODE, B.TENNHOMDICHVU, dv.SOPHIEUYEUCAU, dv.KHAMBENH_NGOAITRU_ID, dv.NGUOICAPNHAT_ID, dv.NGAYCAPNHAT,        CASE        WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU        WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02'        ELSE Left(B.MANHOMDICHVU,2) END AS MANHOMDICHVU, B.MANHOMDICHVU as MANHOMDICHVUCHITIET, tn.TRANGTHAI as TRANGTHAI_TIEPNHAN,        'False' as DAKHAM,        vp.DATHANHTOAN, vp.DONGIA_DOANHTHU, BA.SOBENHAN, dv.CHANDOAN        , a.TENDICHVU, nth.TENPHONGBAN as TENPHONGKHAM, nyc.TENPHONGBAN as TENKHOACHIDINH        , bscd.TENNHANVIEN as TENBACSICHIDINH        , 0 as GUINGOAI        , 0 as VTYT        , 0 as CLSKETQUA_ID          ,             '' SOPHIEUPHAUTHUAT                   FROM TT_DVYEUCAU (NOLOCK) dv        inner join TT_TIEPNHAN (NOLOCK) tn on dv.TIEPNHAN_ID = tn.TIEPNHAN_ID        inner join TT_BENHNHAN (NOLOCK) bn on tn.BENHNHAN_ID = bn.BENHNHAN_ID        inner join TM_DICHVU A on A.DICHVU_ID = dv.DICHVU_ID        inner join TM_PHONGBAN nth on nth.PHONGBAN_ID = dv.NOITHUCHIEN_ID        left join TM_NHANVIEN bscd on bscd.NHANVIEN_ID = dv.BACSICHIDINH_ID        inner join TM_PHONGBAN nyc on nyc.PHONGBAN_ID = dv.NOIYEUCAU_ID        inner join TM_NHOMDICHVU B on B.NHOMDICHVU_ID = A.NHOMDICHVU_ID        inner join TT_VIENPHI (NOLOCK) VP on VP.TIEPNHAN_ID = tn.TIEPNHAN_ID and VP.DICHVU_ID = dv.DICHVU_ID and VP.REF_ID = dv.DVYEUCAU_ID        left join TT_NOITRU_BENHAN (NOLOCK) BA on BA.TIEPNHAN_ID = tn.TIEPNHAN_ID AND dv.BENHAN_ID = BA.BENHAN_ID        inner join TM_GENDER GD on GD.ID = bn.GIOITINH                 where        dv.DICHVU_ID IS NOT NULL        and tn.BENHVIEN_ID = 'HLU01'        and HUYYEUCAU = 0        and dv.NGAYHENCLS is NULL                       and dv.TRANGTHAI = 'CHUAKETQUA'           and           dv.NGAYYEUCAU >= '11/1/2019 12:00:00 AM'         and           dv.NGAYYEUCAU <= '2/26/2020 12:00:00 AM'         and           dv.NOITHUCHIEN_ID = 25         and           (CASE          WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU          WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2)          END) in (05)         and           tn.TRANGTHAI IN ('DATIEPNHAN','NOITRU','CAPCUU', 'HOANTHANH')         and           (vp.DATHANHTOAN = '1'  or vp.DONGIA_DOANHTHU = '0' OR TN.SUDUNG_BHTN='1' OR TN.BAOLANH_VIENPHI='1'  OR tn.TRANGTHAI IN ('NOITRU','CAPCUU','NGOAITRU') or dv.HOPDONG_BENHNHAN_ID is not null or vp.BENHNHAN_PHAITHANHTOAN >= 0)                 ) data1) lst                    where          lst.ROWNUMBER between 1 and 20                 order by NGAYGIOYEUCAU asc]
2020-02-26 10:46:20,937 [1] DEBUG - Statement Id: [DAO00000_GetNhomDoiTuong] PreparedStatement : [SELECT DOITUONG_ID              ,[TENDOITUONG]              ,[NHOMDICHVU]              ,[TYLE_VUOT_LCB]              ,[GIOIHAN_VUOT_LCB]              ,[GIOIHAN_VUOT_DVKTC]              ,[TYLE_THUOC_UT]              ,[CPVC]              ,[CHIPHINGOAI_BHYT]              ,[NGANSACH_TL]              ,[MIENGIAM_TL]              ,[TAITRO_TL]              ,[BHTN_TL]              FROM [dbo].[TM_DOITUONG]]
2020-02-26 10:46:23,208 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'ORM04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 10:46:23,721 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'ORM05'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 10:46:24,244 [1] DEBUG - Statement Id: [DAO00019_ThongTinBenhNhanTiepNhan] PreparedStatement : [select distinct A.SOTIEPNHAN, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        B.*, A.SOBHYT        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'        where                    A.TIEPNHAN_ID = '329'                 and A.BENHVIEN_ID = 'HLU01']
2020-02-26 10:46:24,519 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_GetList] PreparedStatement : [select *              from TT_PHAUTHUAT               where                             TT_PHAUTHUAT.LOAI = 'P'                       and                           TT_PHAUTHUAT.TIEPNHAN_ID = 329                       and                           TT_PHAUTHUAT.BENHVIEN_ID = 'HLU01'                                     order by PHAUTHUAT_ID DESC]
2020-02-26 10:46:24,682 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '329'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2020-02-26 10:46:24,800 [1] DEBUG - Statement Id: [DAO00048_GetBenhNhanByBenhNhanID] PreparedStatement : [SELECT *              FROM              TT_BENHNHAN               where                             BENHNHAN_ID = '326']
2020-02-26 10:46:24,994 [1] DEBUG - Statement Id: [DAO00000_GetDoiTuongIsBHYT] PreparedStatement : [select * from TM_DOITUONG Where DOITUONG_ID = 6 and MADOITUONG like '%BHYT%']
2020-02-26 10:46:25,424 [1] DEBUG - Statement Id: [DAO00048_GetDICHVUYCByTiepNhanID] PreparedStatement : [SELECT DISTINCT D.HOPDONG_ID, D.HOPDONG_BENHNHAN_ID, D.DVYEUCAU_ID, D.DICHVU_ID, D.SOPHIEUYEUCAU, D.NGAYGIOYEUCAU, D.NOITHUCHIEN_ID, P.LOAIPHAUTHUAT, L.STT AS STT_LOAIPHAUTHUAT            FROM            TT_DVYEUCAU AS D            left join TM_PHANLOAIPHAUTHUAT AS P ON D.DICHVU_ID = P.DICHVU_ID            left join TM_LOAIPHAUTHUAT AS L ON L.LOAIPHAUTHUAT = P.LOAIPHAUTHUAT            where            not exists (select DVYEUCAU_ID from TT_PHAUTHUAT_YEUCAU where D.DVYEUCAU_ID = DVYEUCAU_ID)               and                       exists                      (select DICHVU_ID from TM_DICHVU                      where D.DICHVU_ID = DICHVU_ID and                      exists                      (select NHOMDICHVU_ID from TM_NHOMDICHVU                      where TM_DICHVU.NHOMDICHVU_ID = NHOMDICHVU_ID and left(MANHOMDICHVU,2) in (05)                      )                                             )                     and                           D.TIEPNHAN_ID = '329']
2020-02-26 10:46:25,488 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '329'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2020-02-26 10:46:25,680 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM60'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 10:46:25,808 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM98'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 10:46:35,957 [1] DEBUG - Statement Id: [DAO00048_GetDVYeuCauByDVYeuCauID] PreparedStatement : [SELECT A.*, B.NGAYGIOYEUCAU, C.TENDICHVU, D.TENNHOMDICHVU, D.NHOMDICHVU_ID            FROM TT_VIENPHI A            left join TT_DVYEUCAU B on A.REF_ID = B.DVYEUCAU_ID            inner join TM_DICHVU C on C.DICHVU_ID = B.DICHVU_ID            inner join TM_NHOMDICHVU D on D.NHOMDICHVU_ID = C.NHOMDICHVU_ID            WHERE            A.REF_ID IN (22759)            and A.REF_TABLE='TT_DVYEUCAU'            AND A.TIEPNHAN_ID = 329]
2020-02-26 10:46:54,110 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'ORM06'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 10:46:55,472 [1] DEBUG - Statement Id: [DAO00051_GetMauTuongTrinh] PreparedStatement : [select *            from TM_TUDIENKETQUA            where BENHVIEN_ID = 'HLU01'              and                 (NGUOITAO_ID = '1' OR SUDUNGCHUNG = '1')                and DICHVU_ID in  (                        @param0                   )               ORDER BY TENNOIDUNG]
2020-02-26 10:46:55,473 [1] DEBUG - Statement Id: [DAO00051_GetMauTuongTrinh] Parameters: [@param0=[LSTDICHVU_ID[0],5121]]
2020-02-26 10:46:55,474 [1] DEBUG - Statement Id: [DAO00051_GetMauTuongTrinh] Types: [@param0=[Int64, System.Int64]]
2020-02-26 10:47:12,236 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'ORM07'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 10:47:23,251 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '329'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2020-02-26 10:47:23,365 [1] DEBUG - Statement Id: [DAO00014_GetInPatientStatus] PreparedStatement : [select TRANGTHAI, isnull(KHOACHUYENDEN_ID, KHOAVAO_ID) as KHOAHIENTAI from TT_NOITRU_BENHAN        where        TIEPNHAN_ID = '329'        and BENHVIEN_ID = 'HLU01'         and           BENHAN_ID = '40']
2020-02-26 10:47:23,473 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '329'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2020-02-26 10:47:23,710 [1] DEBUG - Statement Id: [DAO00014_GetInPatientStatus] PreparedStatement : [select TRANGTHAI, isnull(KHOACHUYENDEN_ID, KHOAVAO_ID) as KHOAHIENTAI from TT_NOITRU_BENHAN        where        TIEPNHAN_ID = '329'        and BENHVIEN_ID = 'HLU01'         and           BENHAN_ID = '40']
2020-02-26 10:47:23,829 [1] DEBUG - Statement Id: [DAO00048_GetTrangThaiTruocKhiLuu_TuongTrinh] PreparedStatement : [SELECT PHAUTHUAT_YEUCAU_ID FROM TT_PHAUTHUAT_YEUCAU PTYC              WHERE BENHVIEN_ID ='HLU01'                and DVYEUCAU_ID in  (                        @param0                   )]
2020-02-26 10:47:23,830 [1] DEBUG - Statement Id: [DAO00048_GetTrangThaiTruocKhiLuu_TuongTrinh] Parameters: [@param0=[LISTDVYEUCAU_ID[0],22759]]
2020-02-26 10:47:23,830 [1] DEBUG - Statement Id: [DAO00048_GetTrangThaiTruocKhiLuu_TuongTrinh] Types: [@param0=[Int64, System.Int64]]
--------------------------------------------------------------------------------
2020-02-26 13:59:01,705 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2020-02-26 13:59:02,302 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2020-02-26 13:59:02,342 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2020-02-26 13:59:03,755 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 13:59:04,276 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2020-02-26 14:01:26,767 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2020-02-26 14:01:26,790 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2020-02-26 14:01:29,599 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2020-02-26 14:01:29,674 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2020-02-26 14:01:30,629 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2020-02-26 14:01:30,844 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2020-02-26 14:01:30,914 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2020-02-26 14:01:30,983 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2020-02-26 14:01:31,051 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2020-02-26 14:01:31,125 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2020-02-26 14:01:31,194 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2020-02-26 14:01:31,264 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2020-02-26 14:01:31,329 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2020-02-26 14:01:31,843 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2020-02-26 14:01:31,876 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2020-02-26 14:01:31,947 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2020-02-26 14:01:31,977 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2020-02-26 14:01:32,655 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2020-02-26 14:01:32,684 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @NGUONDUOC_MACDINH varchar(5) = '0';        declare @TOAMUANGOAI int = 0;        select @NGUONDUOC_MACDINH = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'PHA_NGUONDUOC'        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + @NGUONDUOC_MACDINH as DUOC_KEY, 0 as PHAMVI_ID, @NGUONDUOC_MACDINH as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end        else        begin                select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (        select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID)        B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (        select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID)        A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2020-02-26 14:01:34,205 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2020-02-26 14:01:34,240 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,        SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH        FROM TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID        WHERE TK.SOLUONG > 0        GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2020-02-26 14:01:34,319 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2020-02-26 14:01:34,391 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,        TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,        TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH        from TM_MAU M        JOIN        (        select        A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO        from        (        select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO        from TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'        where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0        ) A        )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2020-02-26 14:01:34,494 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2020-02-26 14:01:35,527 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 14:01:36,761 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2020-02-26 14:01:42,272 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2020-02-26 14:01:42,300 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2020-02-26 14:01:42,378 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 14:01:42,480 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 14:01:42,776 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2020-02-26 14:01:42,778 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2020-02-26 14:01:42,778 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2020-02-26 14:01:42,804 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2020-02-26 14:01:42,804 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2020-02-26 14:01:42,804 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2020-02-26 14:01:42,942 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 14:01:43,177 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 14:01:52,874 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 14:01:52,965 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2020-02-26 14:01:53,241 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2020-02-26 14:02:28,562 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'OPD23'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 14:02:30,069 [1] DEBUG - Statement Id: [DAO00019_DanhSachPhauThuatThuThuat] PreparedStatement : [declare @TenBenhVien nvarchar(500)        declare @ManhomDSA varchar(10);        set @TenBenhVien = (select VALUE from TM_SYS_APPSETTINGS where CODE = 'APP_BENHVIEN_TEN')        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        select * from(        select ROW_NUMBER() OVER(order by NGAYGIOYEUCAU) as ROWNUMBER, *        from        (SELECT distinct        COUNT(*) OVER() as TOTALROWS,        N'Mã người bệnh: ' + bn.MAYTE + ' - ' + N'Tên người bệnh: ' + bn.TENBENHNHAN + ' - ' + N'Số bệnh án: ' + ISNULL(BA.SOBENHAN,'') + ' - ' + N'Sinh ngày: ' + isnull(Convert(varchar(10),bn.NGAYSINH,103),bn.NAMSINH) + ' - ' + N'Giới tính: ' + GD.DESCRIPTION as GROUPNAME,        bn.MAYTE, bn.TENBENHNHAN, bn.NAMSINH, bn.NGAYSINH as TUOI, ISNULL(CONVERT(VARCHAR(10), bn.NGAYSINH, 103),CAST(bn.NAMSINH AS varchar)) as NGAYSINH, bn.DIACHILIENLAC as DIACHI, bn.GIOITINH, GD.DESCRIPTION as TENGIOITINH,        tn.DOITUONG_ID, tn.THOIGIANTIEPNHAN, tn.BENHNHAN_ID, tn.TIEPNHAN_ID, tn.TRAITUYEN, tn.SOTIEPNHAN        , dv.DICHVU_ID, dv.NOITHUCHIEN_ID, isnull(dv.NGAYTAO, dv.NGAYCAPNHAT) as THOIGIANDKDICHVU        , dv.KHAN, dv.NOIYEUCAU_ID, dv.NGAYGIOYEUCAU, dv.BACSICHIDINH_ID, dv.DONVIGIOITHIEU_ID        , dv.NGUOIGIOITHIEU_ID, dv.TRANGTHAI_WFL, tn.NOIGIOITHIEU_ID        , dv.DVYEUCAU_ID, dv.MARIS, dv.TRANGTHAI as TRANGTHAICODE, B.TENNHOMDICHVU, dv.SOPHIEUYEUCAU, dv.KHAMBENH_NGOAITRU_ID, dv.NGUOICAPNHAT_ID, dv.NGAYCAPNHAT,        CASE        WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU        WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02'        ELSE Left(B.MANHOMDICHVU,2) END AS MANHOMDICHVU, B.MANHOMDICHVU as MANHOMDICHVUCHITIET, tn.TRANGTHAI as TRANGTHAI_TIEPNHAN,        'False' as DAKHAM,        vp.DATHANHTOAN, vp.DONGIA_DOANHTHU, BA.SOBENHAN, dv.CHANDOAN        , a.TENDICHVU, nth.TENPHONGBAN as TENPHONGKHAM, nyc.TENPHONGBAN as TENKHOACHIDINH        , bscd.TENNHANVIEN as TENBACSICHIDINH        , 0 as GUINGOAI        , 0 as VTYT        , 0 as CLSKETQUA_ID          ,             '' SOPHIEUPHAUTHUAT                   FROM TT_DVYEUCAU (NOLOCK) dv        inner join TT_TIEPNHAN (NOLOCK) tn on dv.TIEPNHAN_ID = tn.TIEPNHAN_ID        inner join TT_BENHNHAN (NOLOCK) bn on tn.BENHNHAN_ID = bn.BENHNHAN_ID        inner join TM_DICHVU A on A.DICHVU_ID = dv.DICHVU_ID        inner join TM_PHONGBAN nth on nth.PHONGBAN_ID = dv.NOITHUCHIEN_ID        left join TM_NHANVIEN bscd on bscd.NHANVIEN_ID = dv.BACSICHIDINH_ID        inner join TM_PHONGBAN nyc on nyc.PHONGBAN_ID = dv.NOIYEUCAU_ID        inner join TM_NHOMDICHVU B on B.NHOMDICHVU_ID = A.NHOMDICHVU_ID        inner join TT_VIENPHI (NOLOCK) VP on VP.TIEPNHAN_ID = tn.TIEPNHAN_ID and VP.DICHVU_ID = dv.DICHVU_ID and VP.REF_ID = dv.DVYEUCAU_ID        left join TT_NOITRU_BENHAN (NOLOCK) BA on BA.TIEPNHAN_ID = tn.TIEPNHAN_ID AND dv.BENHAN_ID = BA.BENHAN_ID        inner join TM_GENDER GD on GD.ID = bn.GIOITINH                 where        dv.DICHVU_ID IS NOT NULL        and tn.BENHVIEN_ID = 'HLU01'        and HUYYEUCAU = 0        and dv.NGAYHENCLS is NULL                       and dv.TRANGTHAI = 'CHUAKETQUA'           and           dv.NGAYYEUCAU >= '2/26/2020 12:00:00 AM'         and           dv.NGAYYEUCAU <= '2/26/2020 12:00:00 AM'         and           dv.NOITHUCHIEN_ID = 25         and           (CASE          WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU          WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2)          END) in (05)         and           tn.TRANGTHAI IN ('DATIEPNHAN','NOITRU','CAPCUU', 'HOANTHANH')         and           (vp.DATHANHTOAN = '1'  or vp.DONGIA_DOANHTHU = '0' OR TN.SUDUNG_BHTN='1' OR TN.BAOLANH_VIENPHI='1'  OR tn.TRANGTHAI IN ('NOITRU','CAPCUU','NGOAITRU') or dv.HOPDONG_BENHNHAN_ID is not null or vp.BENHNHAN_PHAITHANHTOAN >= 0)                 ) data1) lst                    where          lst.ROWNUMBER between 1 and 20                 order by NGAYGIOYEUCAU asc]
2020-02-26 14:02:30,629 [1] DEBUG - Statement Id: [DAO00217_GetEmployeeAll] PreparedStatement : [select * from TM_NHANVIEN]
2020-02-26 14:02:36,590 [1] DEBUG - Statement Id: [DAO00019_DanhSachPhauThuatThuThuat] PreparedStatement : [declare @TenBenhVien nvarchar(500)        declare @ManhomDSA varchar(10);        set @TenBenhVien = (select VALUE from TM_SYS_APPSETTINGS where CODE = 'APP_BENHVIEN_TEN')        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        select * from(        select ROW_NUMBER() OVER(order by NGAYGIOYEUCAU) as ROWNUMBER, *        from        (SELECT distinct        COUNT(*) OVER() as TOTALROWS,        N'Mã người bệnh: ' + bn.MAYTE + ' - ' + N'Tên người bệnh: ' + bn.TENBENHNHAN + ' - ' + N'Số bệnh án: ' + ISNULL(BA.SOBENHAN,'') + ' - ' + N'Sinh ngày: ' + isnull(Convert(varchar(10),bn.NGAYSINH,103),bn.NAMSINH) + ' - ' + N'Giới tính: ' + GD.DESCRIPTION as GROUPNAME,        bn.MAYTE, bn.TENBENHNHAN, bn.NAMSINH, bn.NGAYSINH as TUOI, ISNULL(CONVERT(VARCHAR(10), bn.NGAYSINH, 103),CAST(bn.NAMSINH AS varchar)) as NGAYSINH, bn.DIACHILIENLAC as DIACHI, bn.GIOITINH, GD.DESCRIPTION as TENGIOITINH,        tn.DOITUONG_ID, tn.THOIGIANTIEPNHAN, tn.BENHNHAN_ID, tn.TIEPNHAN_ID, tn.TRAITUYEN, tn.SOTIEPNHAN        , dv.DICHVU_ID, dv.NOITHUCHIEN_ID, isnull(dv.NGAYTAO, dv.NGAYCAPNHAT) as THOIGIANDKDICHVU        , dv.KHAN, dv.NOIYEUCAU_ID, dv.NGAYGIOYEUCAU, dv.BACSICHIDINH_ID, dv.DONVIGIOITHIEU_ID        , dv.NGUOIGIOITHIEU_ID, dv.TRANGTHAI_WFL, tn.NOIGIOITHIEU_ID        , dv.DVYEUCAU_ID, dv.MARIS, dv.TRANGTHAI as TRANGTHAICODE, B.TENNHOMDICHVU, dv.SOPHIEUYEUCAU, dv.KHAMBENH_NGOAITRU_ID, dv.NGUOICAPNHAT_ID, dv.NGAYCAPNHAT,        CASE        WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU        WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02'        ELSE Left(B.MANHOMDICHVU,2) END AS MANHOMDICHVU, B.MANHOMDICHVU as MANHOMDICHVUCHITIET, tn.TRANGTHAI as TRANGTHAI_TIEPNHAN,        'False' as DAKHAM,        vp.DATHANHTOAN, vp.DONGIA_DOANHTHU, BA.SOBENHAN, dv.CHANDOAN        , a.TENDICHVU, nth.TENPHONGBAN as TENPHONGKHAM, nyc.TENPHONGBAN as TENKHOACHIDINH        , bscd.TENNHANVIEN as TENBACSICHIDINH        , 0 as GUINGOAI        , 0 as VTYT        , 0 as CLSKETQUA_ID          ,             '' SOPHIEUPHAUTHUAT                   FROM TT_DVYEUCAU (NOLOCK) dv        inner join TT_TIEPNHAN (NOLOCK) tn on dv.TIEPNHAN_ID = tn.TIEPNHAN_ID        inner join TT_BENHNHAN (NOLOCK) bn on tn.BENHNHAN_ID = bn.BENHNHAN_ID        inner join TM_DICHVU A on A.DICHVU_ID = dv.DICHVU_ID        inner join TM_PHONGBAN nth on nth.PHONGBAN_ID = dv.NOITHUCHIEN_ID        left join TM_NHANVIEN bscd on bscd.NHANVIEN_ID = dv.BACSICHIDINH_ID        inner join TM_PHONGBAN nyc on nyc.PHONGBAN_ID = dv.NOIYEUCAU_ID        inner join TM_NHOMDICHVU B on B.NHOMDICHVU_ID = A.NHOMDICHVU_ID        inner join TT_VIENPHI (NOLOCK) VP on VP.TIEPNHAN_ID = tn.TIEPNHAN_ID and VP.DICHVU_ID = dv.DICHVU_ID and VP.REF_ID = dv.DVYEUCAU_ID        left join TT_NOITRU_BENHAN (NOLOCK) BA on BA.TIEPNHAN_ID = tn.TIEPNHAN_ID AND dv.BENHAN_ID = BA.BENHAN_ID        inner join TM_GENDER GD on GD.ID = bn.GIOITINH                 where        dv.DICHVU_ID IS NOT NULL        and tn.BENHVIEN_ID = 'HLU01'        and HUYYEUCAU = 0        and dv.NGAYHENCLS is NULL                       and dv.TRANGTHAI = 'CHUAKETQUA'           and           dv.NGAYYEUCAU >= '11/1/2019 12:00:00 AM'         and           dv.NGAYYEUCAU <= '2/26/2020 12:00:00 AM'         and           dv.NOITHUCHIEN_ID = 25         and           (CASE          WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU          WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2)          END) in (05)         and           tn.TRANGTHAI IN ('DATIEPNHAN','NOITRU','CAPCUU', 'HOANTHANH')         and           (vp.DATHANHTOAN = '1'  or vp.DONGIA_DOANHTHU = '0' OR TN.SUDUNG_BHTN='1' OR TN.BAOLANH_VIENPHI='1'  OR tn.TRANGTHAI IN ('NOITRU','CAPCUU','NGOAITRU') or dv.HOPDONG_BENHNHAN_ID is not null or vp.BENHNHAN_PHAITHANHTOAN >= 0)                 ) data1) lst                    where          lst.ROWNUMBER between 1 and 20                 order by NGAYGIOYEUCAU asc]
2020-02-26 14:02:36,887 [1] DEBUG - Statement Id: [DAO00000_GetNhomDoiTuong] PreparedStatement : [SELECT DOITUONG_ID              ,[TENDOITUONG]              ,[NHOMDICHVU]              ,[TYLE_VUOT_LCB]              ,[GIOIHAN_VUOT_LCB]              ,[GIOIHAN_VUOT_DVKTC]              ,[TYLE_THUOC_UT]              ,[CPVC]              ,[CHIPHINGOAI_BHYT]              ,[NGANSACH_TL]              ,[MIENGIAM_TL]              ,[TAITRO_TL]              ,[BHTN_TL]              FROM [dbo].[TM_DOITUONG]]
2020-02-26 14:02:38,998 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'ORM04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 14:02:39,361 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'ORM05'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 14:02:39,970 [1] DEBUG - Statement Id: [DAO00019_ThongTinBenhNhanTiepNhan] PreparedStatement : [select distinct A.SOTIEPNHAN, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        B.*, A.SOBHYT        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'        where                    A.TIEPNHAN_ID = '329'                 and A.BENHVIEN_ID = 'HLU01']
2020-02-26 14:02:40,285 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_GetList] PreparedStatement : [select *              from TT_PHAUTHUAT               where                             TT_PHAUTHUAT.LOAI = 'P'                       and                           TT_PHAUTHUAT.TIEPNHAN_ID = 329                       and                           TT_PHAUTHUAT.BENHVIEN_ID = 'HLU01'                                     order by PHAUTHUAT_ID DESC]
2020-02-26 14:02:40,614 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '329'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2020-02-26 14:02:40,710 [1] DEBUG - Statement Id: [DAO00048_GetBenhNhanByBenhNhanID] PreparedStatement : [SELECT *              FROM              TT_BENHNHAN               where                             BENHNHAN_ID = '326']
2020-02-26 14:02:40,752 [1] DEBUG - Statement Id: [DAO00000_GetDoiTuongIsBHYT] PreparedStatement : [select * from TM_DOITUONG Where DOITUONG_ID = 6 and MADOITUONG like '%BHYT%']
2020-02-26 14:02:41,204 [1] DEBUG - Statement Id: [DAO00048_GetDICHVUYCByTiepNhanID] PreparedStatement : [SELECT DISTINCT D.HOPDONG_ID, D.HOPDONG_BENHNHAN_ID, D.DVYEUCAU_ID, D.DICHVU_ID, D.SOPHIEUYEUCAU, D.NGAYGIOYEUCAU, D.NOITHUCHIEN_ID, P.LOAIPHAUTHUAT, L.STT AS STT_LOAIPHAUTHUAT            FROM            TT_DVYEUCAU AS D            left join TM_PHANLOAIPHAUTHUAT AS P ON D.DICHVU_ID = P.DICHVU_ID            left join TM_LOAIPHAUTHUAT AS L ON L.LOAIPHAUTHUAT = P.LOAIPHAUTHUAT            where            not exists (select DVYEUCAU_ID from TT_PHAUTHUAT_YEUCAU where D.DVYEUCAU_ID = DVYEUCAU_ID)               and                       exists                      (select DICHVU_ID from TM_DICHVU                      where D.DICHVU_ID = DICHVU_ID and                      exists                      (select NHOMDICHVU_ID from TM_NHOMDICHVU                      where TM_DICHVU.NHOMDICHVU_ID = NHOMDICHVU_ID and left(MANHOMDICHVU,2) in (05)                      )                                             )                     and                           D.TIEPNHAN_ID = '329']
2020-02-26 14:02:41,266 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '329'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2020-02-26 14:02:41,428 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM60'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 14:02:41,688 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM98'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 14:02:55,101 [1] DEBUG - Statement Id: [DAO00048_GetDVYeuCauByDVYeuCauID] PreparedStatement : [SELECT A.*, B.NGAYGIOYEUCAU, C.TENDICHVU, D.TENNHOMDICHVU, D.NHOMDICHVU_ID            FROM TT_VIENPHI A            left join TT_DVYEUCAU B on A.REF_ID = B.DVYEUCAU_ID            inner join TM_DICHVU C on C.DICHVU_ID = B.DICHVU_ID            inner join TM_NHOMDICHVU D on D.NHOMDICHVU_ID = C.NHOMDICHVU_ID            WHERE            A.REF_ID IN (22759)            and A.REF_TABLE='TT_DVYEUCAU'            AND A.TIEPNHAN_ID = 329]
2020-02-26 14:03:22,843 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'CLS01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 14:03:24,168 [1] DEBUG - Statement Id: [DAO00211_CLS01_GetNhomTuDien] PreparedStatement : [SELECT * FROM TM_TUDIENKETQUA_NHOM WHERE TAMNGUNG = '0' AND BENHVIEN_ID ='HLU01']
2020-02-26 14:03:36,171 [1] DEBUG - Statement Id: [DAO00210_CLS01_GetListDV] PreparedStatement : [DECLARE @x int, @y int;          SET @x = 100000000;          SET @y = 200000000;          WITH DichvuRec AS          (          SELECT D.DICHVU_ID AS CATEGORY_ID, D.MADICHVU AS CATEGORY_CODE, D.TENDICHVU AS CATEGORY_NAME, (ND.CAP + 1) AS FOLDER_LEVEL, ISNULL(D.CAPTREN_ID,D.NHOMDICHVU_ID + @x) AS PARENT_ID, '0' AS IS_FOLDER, d.TAMNGUNG          FROM TM_DICHVU AS D          INNER JOIN TM_NHOMDICHVU AS ND ON D.NHOMDICHVU_ID = ND.NHOMDICHVU_ID          WHERE D.CAP = 1 AND D.CAPTREN_ID IS NULL AND D.BENHVIEN_ID = 'HLU01' AND D.TAMNGUNG = '0'          UNION ALL          SELECT D.DICHVU_ID AS CATEGORY_ID, D.MADICHVU AS CATEGORY_CODE, D.TENDICHVU AS CATEGORY_NAME, (DR.FOLDER_LEVEL + 1) AS FOLDER_LEVEL, D.CAPTREN_ID AS PARENT_ID, '0' AS IS_FOLDER, d.TAMNGUNG          FROM DichvuRec AS DR          INNER JOIN TM_DICHVU AS D ON D.CAPTREN_ID = DR.CATEGORY_ID AND D.BENHVIEN_ID = 'HLU01'          )          , NhomdichvuRec AS          (          SELECT (ND.NHOMDICHVU_ID + @x) AS CATEGORY_ID, ND.MANHOMDICHVU AS CATEGORY_CODE, ND.TENNHOMDICHVU AS CATEGORY_NAME, ND.CAP AS FOLDER_LEVEL, ISNULL(ND.CAPTREN_ID,ND.LOAIDICHVU_ID + @y) AS PARENT_ID, '1' AS IS_FOLDER, null as TAMNGUNG          FROM TM_NHOMDICHVU AS ND WHERE ND.CAP = 1 AND ND.CAPTREN_ID IS NULL AND ND.BENHVIEN_ID = 'HLU01'          UNION ALL          SELECT (ND.NHOMDICHVU_ID + @x) AS CATEGORY_ID, ND.MANHOMDICHVU AS CATEGORY_CODE, ND.TENNHOMDICHVU AS CATEGORY_NAME, ND.CAP AS FOLDER_LEVEL, (ND.CAPTREN_ID + @x) AS PARENT_ID, '1' AS IS_FOLDER, null as TAMNGUNG          FROM NhomdichvuRec AS DR          INNER JOIN TM_NHOMDICHVU AS ND ON (ND.CAPTREN_ID + @x) = DR.CATEGORY_ID AND ND.BENHVIEN_ID = 'HLU01'          )          SELECT * FROM DichvuRec          UNION ALL          SELECT * FROM NhomdichvuRec          UNION ALL          SELECT (LD.LOAIDICHVU_ID + @y) AS CATEGORY_ID, LD.MALOAIDICHVU AS CATEGORY_CODE, LD.TENLOAIDICHVU AS CATEGORY_NAME, 0 AS FOLDER_LEVEL, 0 AS PARENT_ID, '1' AS IS_FOLDER, null as TAMNGUNG          FROM TM_LOAIDICHVU AS LD          WHERE LD.BENHVIEN_ID = 'HLU01'          ORDER BY CATEGORY_NAME, CATEGORY_ID]
2020-02-26 14:05:49,843 [1] DEBUG - Statement Id: [DAO00211_CLS01_GetTuDienByDichVu] PreparedStatement : [SELECT * FROM TM_TUDIENKETQUA WHERE TAMNGUNG = '0' AND BENHVIEN_ID ='HLU01' AND DICHVU_ID = '5121']
2020-02-26 14:06:47,776 [1] DEBUG - Statement Id: [DAO00211_CLS01_Add] PreparedStatement : [insert into TM_TUDIENKETQUA (              MASO              , NHOMTUDIEN_ID              , DICHVU_ID              , TENNOIDUNG              , KYTHUAT              , KETQUA              , KETQUA_TEXT              , KETLUAN              , USER_NAME              , USER_FULLNAME              , LANGUAGE_ID              , SUDUNGCHUNG              , TAMNGUNG              , ATTRIBUTE1              , ATTRIBUTE2              , ATTRIBUTE3              , ATTRIBUTE4              , NGAYTAO              , NGUOITAO_ID              , NGAYCAPNHAT              , NGUOICAPNHAT_ID              , NHOMDICHVU_ID              , BENHVIEN_ID              ) values (               @param0               ,  @param1               ,  @param2               ,  @param3               ,  @param4               ,  @param5               ,  @param6               ,  @param7               ,  @param8               ,  @param9               ,  @param10               ,  @param11               ,  @param12               ,  @param13               ,  @param14               ,  @param15               ,  @param16               ,  @param17               ,  @param18               ,  @param19               ,  @param20               ,  @param21               ,  @param22               )              SELECT SCOPE_IDENTITY()]
2020-02-26 14:06:47,776 [1] DEBUG - Statement Id: [DAO00211_CLS01_Add] Parameters: [@param0=[MASO,HA001], @param1=[NHOMTUDIEN_ID,4], @param2=[DICHVU_ID,5121], @param3=[TENNOIDUNG,PT nội soi cắt ruột thừa], @param4=[KYTHUAT,test], @param5=[KETQUA,<body>
	<div style="text-align:left;text-indent:0pt;margin:0pt 0pt 0pt 0pt;"><span style="color:#000000;background-color:transparent;font-family:Times New Roman;font-size:12pt;font-weight:normal;font-style:normal;">test 1</span></div><div style="text-align:left;text-indent:0pt;margin:0pt 0pt 0pt 0pt;"><span style="color:#000000;background-color:transparent;font-family:Times New Roman;font-size:12pt;font-weight:normal;font-style:normal;">test 2</span></div><div style="text-align:left;text-indent:0pt;margin:0pt 0pt 0pt 0pt;"><span style="color:#000000;background-color:transparent;font-family:Times New Roman;font-size:12pt;font-weight:normal;font-style:normal;">- test 3</span></div><div style="text-align:left;text-indent:0pt;margin:0pt 0pt 0pt 0pt;"><span style="color:#000000;background-color:transparent;font-family:Times New Roman;font-size:12pt;font-weight:normal;font-style:normal;">test 4</span></div></body>
], @param6=[KETQUA_TEXT,null], @param7=[KETLUAN,test], @param8=[USER_NAME,admin], @param9=[USER_FULLNAME,Administrator], @param10=[LANGUAGE_ID,null], @param11=[SUDUNGCHUNG,False], @param12=[TAMNGUNG,0], @param13=[ATTRIBUTE1,null], @param14=[ATTRIBUTE2,null], @param15=[ATTRIBUTE3,null], @param16=[ATTRIBUTE4,null], @param17=[NGAYTAO,2/26/2020 2:06:47 PM], @param18=[NGUOITAO_ID,1], @param19=[NGAYCAPNHAT,2/26/2020 2:06:47 PM], @param20=[NGUOICAPNHAT_ID,1], @param21=[NHOMDICHVU_ID,null], @param22=[BENHVIEN_ID,HLU01]]
2020-02-26 14:06:47,776 [1] DEBUG - Statement Id: [DAO00211_CLS01_Add] Types: [@param0=[String, System.String], @param1=[Int64, System.Int64], @param2=[Int64, System.Int64], @param3=[String, System.String], @param4=[String, System.String], @param5=[String, System.String], @param6=[System.DBNull, null], @param7=[String, System.String], @param8=[String, System.String], @param9=[String, System.String], @param10=[System.DBNull, null], @param11=[Boolean, System.Boolean], @param12=[String, System.String], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[DateTime, System.DateTime], @param18=[Int64, System.Int64], @param19=[DateTime, System.DateTime], @param20=[Int64, System.Int64], @param21=[System.DBNull, null], @param22=[String, System.String]]
2020-02-26 14:06:48,367 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01']
2020-02-26 14:06:48,404 [1] DEBUG - Statement Id: [DAO00211_CLS01_GetTuDienByDichVu] PreparedStatement : [SELECT * FROM TM_TUDIENKETQUA WHERE TAMNGUNG = '0' AND BENHVIEN_ID ='HLU01' AND DICHVU_ID = '5121']
2020-02-26 14:07:09,137 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'ORM06'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 14:07:10,282 [1] DEBUG - Statement Id: [DAO00051_GetMauTuongTrinh] PreparedStatement : [select *            from TM_TUDIENKETQUA            where BENHVIEN_ID = 'HLU01'              and                 (NGUOITAO_ID = '1' OR SUDUNGCHUNG = '1')                and DICHVU_ID in  (                        @param0                   )               ORDER BY TENNOIDUNG]
2020-02-26 14:07:10,283 [1] DEBUG - Statement Id: [DAO00051_GetMauTuongTrinh] Parameters: [@param0=[LSTDICHVU_ID[0],5121]]
2020-02-26 14:07:10,283 [1] DEBUG - Statement Id: [DAO00051_GetMauTuongTrinh] Types: [@param0=[Int64, System.Int64]]
2020-02-26 14:07:17,909 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'ORM07'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 14:07:27,820 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '329'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2020-02-26 14:07:31,060 [1] DEBUG - Statement Id: [DAO00014_GetInPatientStatus] PreparedStatement : [select TRANGTHAI, isnull(KHOACHUYENDEN_ID, KHOAVAO_ID) as KHOAHIENTAI from TT_NOITRU_BENHAN        where        TIEPNHAN_ID = '329'        and BENHVIEN_ID = 'HLU01'         and           BENHAN_ID = '40']
2020-02-26 14:07:40,595 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '329'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2020-02-26 14:07:44,036 [1] DEBUG - Statement Id: [DAO00014_GetInPatientStatus] PreparedStatement : [select TRANGTHAI, isnull(KHOACHUYENDEN_ID, KHOAVAO_ID) as KHOAHIENTAI from TT_NOITRU_BENHAN        where        TIEPNHAN_ID = '329'        and BENHVIEN_ID = 'HLU01'         and           BENHAN_ID = '40']
2020-02-26 14:07:44,247 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '329'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2020-02-26 14:07:44,414 [1] DEBUG - Statement Id: [DAO00014_GetInPatientStatus] PreparedStatement : [select TRANGTHAI, isnull(KHOACHUYENDEN_ID, KHOAVAO_ID) as KHOAHIENTAI from TT_NOITRU_BENHAN        where        TIEPNHAN_ID = '329'        and BENHVIEN_ID = 'HLU01'         and           BENHAN_ID = '40']
2020-02-26 14:07:44,502 [1] DEBUG - Statement Id: [DAO00048_GetTrangThaiTruocKhiLuu_TuongTrinh] PreparedStatement : [SELECT PHAUTHUAT_YEUCAU_ID FROM TT_PHAUTHUAT_YEUCAU PTYC              WHERE BENHVIEN_ID ='HLU01'                and DVYEUCAU_ID in  (                        @param0                   )]
2020-02-26 14:07:44,502 [1] DEBUG - Statement Id: [DAO00048_GetTrangThaiTruocKhiLuu_TuongTrinh] Parameters: [@param0=[LISTDVYEUCAU_ID[0],22759]]
2020-02-26 14:07:44,502 [1] DEBUG - Statement Id: [DAO00048_GetTrangThaiTruocKhiLuu_TuongTrinh] Types: [@param0=[Int64, System.Int64]]
2020-02-26 14:08:11,645 [1] DEBUG - Statement Id: [DAO00050_GetDetail] PreparedStatement : [select *              from LST_KEYDATA_DICHVU               where                             LST_KEYDATA_DICHVU.KEYTYPE = 'SOPHIEUYEUCAUCLS'                       and                           LST_KEYDATA_DICHVU.KEYYEAR = '2020'                       and                           LST_KEYDATA_DICHVU.KEYMONTH = '0'                       and                           LST_KEYDATA_DICHVU.KEYDAY = '0'                       and                           LST_KEYDATA_DICHVU.SEGMENT_1 = '0621'                       and                           LST_KEYDATA_DICHVU.SEGMENT_2 = '0'                       and                           LST_KEYDATA_DICHVU.SEGMENT_3 = '0'                                     order by KEYTYPE]
2020-02-26 14:08:11,731 [1] DEBUG - Statement Id: [DAO00050_Update] PreparedStatement : [update LST_KEYDATA_DICHVU set              KEYVALUE =  @param0               where              KEYTYPE = 'SOPHIEUYEUCAUCLS'              AND KEYYEAR = '2020'              AND KEYMONTH = '0'              AND KEYDAY = '0'              AND SEGMENT_1 = '0621'              AND SEGMENT_2 = '0'              AND SEGMENT_3 = '0']
2020-02-26 14:08:11,731 [1] DEBUG - Statement Id: [DAO00050_Update] Parameters: [@param0=[KEYVALUE,00987]]
2020-02-26 14:08:11,731 [1] DEBUG - Statement Id: [DAO00050_Update] Types: [@param0=[String, System.String]]
2020-02-26 14:08:11,756 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_Add] PreparedStatement : [insert into TT_PHAUTHUAT (            SOPHIEUPHAUTHUAT            , LOAI            , BENHAN_ID            , LUUTRU_ID            , TIEPNHAN_ID            , PHONGBANTHUCHIEN_ID            , NGAYTHUCHIEN            , THOIGIANBATDAU            , THOIGIANKETTHUC            , ICD_VAOKHOA            , ICD_VAOKHOA_MOTA            , ICD_TRUOCPHAUTHUAT            , ICD_TRUOCPHAUTHUAT_MOTA            , ICD_SAUPHAUTHUAT            , ICD_SAUPHAUTHUAT_MOTA            , NHOMDICHVU_ID            , DICHVU_ID            , PHUONGPHAPVOCAM_ID            , TAIBIEN_ID            , CHEDO_ID            , TUVONG_ID            , TRINHTUTHUCHIEN            , MOTA            , KETQUA            , BENHNHANBENNGOAI            , NGUONBENH_ID            , LOAIPHAUTHUAT            , DANLUU            , NGAYRUT            , NGAYCATCHI            , KHAC            , SOLANMOLAI            , LYDOMOLAI            , CANTHIEPPHAUTHUAT            , TUDIENKETQUA_ID            , PHONGBANCHIDINH_ID            , PPMO_ID            , THOIGIANGAYME            , KHOADULIEU            , NGUOIKHOA_ID            , TENNGUOIKHOA            , NGAYKHOADULIEU            , THOIGIANKHOADULIEU            , NGAYTAO            , NGUOITAO_ID            , NGAYCAPNHAT            , NGUOICAPNHAT_ID            , BENHVIEN_ID                         , TRINHTUTHUCHIEN_TEXT            ) values (             @param0             ,  @param1             ,  @param2             ,  @param3             ,  @param4             ,  @param5             ,  @param6             ,  @param7             ,  @param8             ,  @param9             ,  @param10             ,  @param11             ,  @param12             ,  @param13             ,  @param14             ,  @param15             ,  @param16             ,  @param17             ,  @param18             ,  @param19             ,  @param20             ,  @param21             ,  @param22             ,  @param23             ,  @param24             ,  @param25             ,  @param26             ,  @param27             ,  @param28             ,  @param29             ,  @param30             ,  @param31             ,  @param32             ,  @param33             ,  @param34             ,  @param35             ,  @param36             ,  @param37             ,  @param38             ,  @param39             ,  @param40             ,  @param41             ,  @param42             ,  @param43             ,  @param44             ,  @param45             ,  @param46             ,  @param47                          ,  @param48             )            SELECT SCOPE_IDENTITY()]
2020-02-26 14:08:11,756 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_Add] Parameters: [@param0=[SOPHIEUPHAUTHUAT,20.P.00987], @param1=[LOAI,P], @param2=[BENHAN_ID,40], @param3=[LUUTRU_ID,null], @param4=[TIEPNHAN_ID,329], @param5=[PHONGBANTHUCHIEN_ID,25], @param6=[NGAYTHUCHIEN,2/26/2020 2:08:11 PM], @param7=[THOIGIANBATDAU,2/26/2020 2:07:00 PM], @param8=[THOIGIANKETTHUC,2/26/2020 2:30:00 PM], @param9=[ICD_VAOKHOA,J20], @param10=[ICD_VAOKHOA_MOTA,Viêm phế quản cấp], @param11=[ICD_TRUOCPHAUTHUAT,J20], @param12=[ICD_TRUOCPHAUTHUAT_MOTA,Viêm phế quản cấp], @param13=[ICD_SAUPHAUTHUAT,J20], @param14=[ICD_SAUPHAUTHUAT_MOTA,Viêm phế quản cấp], @param15=[NHOMDICHVU_ID,null], @param16=[DICHVU_ID,null], @param17=[PHUONGPHAPVOCAM_ID,null], @param18=[TAIBIEN_ID,null], @param19=[CHEDO_ID,5190], @param20=[TUVONG_ID,null], @param21=[TRINHTUTHUCHIEN,<body>
	<div style="text-align:left;text-indent:0pt;margin:0pt 0pt 0pt 0pt;"><span style="color:#000000;background-color:transparent;font-family:Times New Roman;font-size:12pt;font-weight:normal;font-style:normal;">test 1</span></div><div style="text-align:left;text-indent:0pt;margin:0pt 0pt 0pt 0pt;"><span style="color:#000000;background-color:transparent;font-family:Times New Roman;font-size:12pt;font-weight:normal;font-style:normal;">test 2</span></div><div style="text-align:left;text-indent:0pt;margin:0pt 0pt 0pt 0pt;"><span style="color:#000000;background-color:transparent;font-family:Times New Roman;font-size:12pt;font-weight:normal;font-style:normal;">- test 3</span></div><div style="text-align:left;text-indent:0pt;margin:0pt 0pt 0pt 0pt;"><span style="color:#000000;background-color:transparent;font-family:Times New Roman;font-size:12pt;font-weight:normal;font-style:normal;">test 4</span></div></body>
], @param22=[MOTA,test], @param23=[KETQUA,null], @param24=[BENHNHANBENNGOAI,null], @param25=[NGUONBENH_ID,745], @param26=[LOAIPHAUTHUAT,PTH], @param27=[DANLUU,null], @param28=[NGAYRUT,null], @param29=[NGAYCATCHI,null], @param30=[KHAC,null], @param31=[SOLANMOLAI,null], @param32=[LYDOMOLAI,null], @param33=[CANTHIEPPHAUTHUAT,null], @param34=[TUDIENKETQUA_ID,2515], @param35=[PHONGBANCHIDINH_ID,null], @param36=[PPMO_ID,null], @param37=[THOIGIANGAYME,null], @param38=[KHOADULIEU,0], @param39=[NGUOIKHOA_ID,null], @param40=[TENNGUOIKHOA,null], @param41=[NGAYKHOADULIEU,null], @param42=[THOIGIANKHOADULIEU,null], @param43=[NGAYTAO,2/26/2020 2:08:11 PM], @param44=[NGUOITAO_ID,1], @param45=[NGAYCAPNHAT,2/26/2020 2:08:11 PM], @param46=[NGUOICAPNHAT_ID,1], @param47=[BENHVIEN_ID,HLU01], @param48=[TRINHTUTHUCHIEN_TEXT,test 1
test 2
- test 3
test 4]]
2020-02-26 14:08:11,756 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_Add] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int64, System.Int64], @param5=[Int64, System.Int64], @param6=[DateTime, System.DateTime], @param7=[DateTime, System.DateTime], @param8=[DateTime, System.DateTime], @param9=[String, System.String], @param10=[String, System.String], @param11=[String, System.String], @param12=[String, System.String], @param13=[String, System.String], @param14=[String, System.String], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[Int64, System.Int64], @param20=[System.DBNull, null], @param21=[String, System.String], @param22=[String, System.String], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[Int64, System.Int64], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[Int64, System.Int64], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[System.DBNull, null], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[DateTime, System.DateTime], @param44=[Int64, System.Int64], @param45=[DateTime, System.DateTime], @param46=[Int64, System.Int64], @param47=[String, System.String], @param48=[String, System.String]]
2020-02-26 14:08:11,790 [1] DEBUG - Statement Id: [DAO00087_GetServiceParams] PreparedStatement : [select CODE, VALUE              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01']
2020-02-26 14:08:11,875 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_YEUCAU_Add] PreparedStatement : [insert into TT_PHAUTHUAT_YEUCAU (              PHAUTHUAT_ID              , DVYEUCAU_ID              , NHOMDICHVU_ID              , DICHVU_ID              , LOAIGIA_ID              , THANHTIEN_DOANHTHU              , BHYT_THANHTIEN_CHITRA              , BENHNHAN_PHAITHANHTOAN              , BENHVIEN_ID              ) values (               @param0               ,  @param1               ,  @param2               ,  @param3               ,  @param4               ,  @param5               ,  @param6               ,  @param7               ,  @param8               )]
2020-02-26 14:08:11,875 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_YEUCAU_Add] Parameters: [@param0=[PHAUTHUAT_ID,68089], @param1=[DVYEUCAU_ID,22759], @param2=[NHOMDICHVU_ID,26], @param3=[DICHVU_ID,5121], @param4=[LOAIGIA_ID,1], @param5=[THANHTIEN_DOANHTHU,4000000], @param6=[BHYT_THANHTIEN_CHITRA,2534000], @param7=[BENHNHAN_PHAITHANHTOAN,1466000], @param8=[BENHVIEN_ID,HLU01]]
2020-02-26 14:08:11,875 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_YEUCAU_Add] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64], @param2=[Int64, System.Int64], @param3=[Int64, System.Int64], @param4=[Int64, System.Int64], @param5=[Double, System.Double], @param6=[Double, System.Double], @param7=[Double, System.Double], @param8=[String, System.String]]
2020-02-26 14:08:11,900 [1] DEBUG - Statement Id: [DAO00048_UpdateDVYeuCauVienPhi] PreparedStatement : [update  TT_VIENPHI              set DATHUCHIEN = '1',              NGUOICAPNHAT_ID =  @param0 ,              NGAYCAPNHAT =  @param1               where              VIENPHI_ID =  @param2]
2020-02-26 14:08:11,900 [1] DEBUG - Statement Id: [DAO00048_UpdateDVYeuCauVienPhi] Parameters: [@param0=[NGUOICAPNHAT_ID,1], @param1=[NGAYCAPNHAT,2/26/2020 2:08:11 PM], @param2=[VIENPHI_ID,68000]]
2020-02-26 14:08:11,900 [1] DEBUG - Statement Id: [DAO00048_UpdateDVYeuCauVienPhi] Types: [@param0=[Int64, System.Int64], @param1=[DateTime, System.DateTime], @param2=[Int64, System.Int64]]
2020-02-26 14:08:11,926 [1] DEBUG - Statement Id: [DAO00048_UpdateDVYeuCau] PreparedStatement : [update  TT_DVYEUCAU              set TRANGTHAI =  @param0 ,              NGUOICAPNHAT_ID =  @param1 ,              NGAYCAPNHAT =  @param2               where              DVYEUCAU_ID =  @param3]
2020-02-26 14:08:11,926 [1] DEBUG - Statement Id: [DAO00048_UpdateDVYeuCau] Parameters: [@param0=[TRANGTHAI,CHOXACNHAN], @param1=[NGUOICAPNHAT_ID,1], @param2=[NGAYCAPNHAT,2/26/2020 2:08:11 PM], @param3=[DVYEUCAU_ID,22759]]
2020-02-26 14:08:11,926 [1] DEBUG - Statement Id: [DAO00048_UpdateDVYeuCau] Types: [@param0=[String, System.String], @param1=[Int64, System.Int64], @param2=[DateTime, System.DateTime], @param3=[Int64, System.Int64]]
2020-02-26 14:08:11,950 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_PPVOCAM_Add] PreparedStatement : [insert into TT_PHAUTHUAT_PPVOCAM (              PHAUTHUAT_ID,              PPVOCAM_ID,              BENHVIEN_ID)              values (               @param0 ,               @param1 ,               @param2 )]
2020-02-26 14:08:11,951 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_PPVOCAM_Add] Parameters: [@param0=[PHAUTHUAT_ID,68089], @param1=[PPVOCAM_ID,516], @param2=[BENHVIEN_ID,HLU01]]
2020-02-26 14:08:11,951 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_PPVOCAM_Add] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64], @param2=[String, System.String]]
2020-02-26 14:08:11,985 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_EKIP_Add] PreparedStatement : [insert into TT_PHAUTHUAT_EKIP (              PHAUTHUAT_ID                ,                       NHANVIEN_ID                   ,                       VAITRO_ID                                 , PTVC_ID              , PPT1_ID              , PPT2_ID              , GMC_ID              , GMP_ID              , DCVT_ID              , DCVN_ID              , BSHC_ID              , BSTC_ID              , BENHVIEN_ID              ) values (               @param0                 ,                        @param1                    ,                        @param2                                  ,  @param3               ,  @param4               ,  @param5               ,  @param6               ,  @param7               ,  @param8               ,  @param9               ,  @param10               ,  @param11               ,  @param12               )]
2020-02-26 14:08:11,985 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_EKIP_Add] Parameters: [@param0=[PHAUTHUAT_ID,68089], @param1=[NHANVIEN_ID,34], @param2=[VAITRO_ID,748], @param3=[PTVC_ID,null], @param4=[PPT1_ID,null], @param5=[PPT2_ID,null], @param6=[GMC_ID,null], @param7=[GMP_ID,null], @param8=[DCVT_ID,null], @param9=[DCVN_ID,null], @param10=[BSHC_ID,null], @param11=[BSTC_ID,null], @param12=[BENHVIEN_ID,HLU01]]
2020-02-26 14:08:11,985 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_EKIP_Add] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[System.DBNull, null], @param5=[System.DBNull, null], @param6=[System.DBNull, null], @param7=[System.DBNull, null], @param8=[System.DBNull, null], @param9=[System.DBNull, null], @param10=[System.DBNull, null], @param11=[System.DBNull, null], @param12=[String, System.String]]
2020-02-26 14:08:12,297 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_GetList] PreparedStatement : [select *              from TT_PHAUTHUAT               where                             TT_PHAUTHUAT.LOAI = 'P'                       and                           TT_PHAUTHUAT.TIEPNHAN_ID = 329                       and                           TT_PHAUTHUAT.BENHVIEN_ID = 'HLU01'                                     order by PHAUTHUAT_ID DESC]
2020-02-26 14:08:12,390 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_GetDetail] PreparedStatement : [select PT.*, TN.BENHNHAN_ID              from              TT_PHAUTHUAT PT, TT_TIEPNHAN TN              where              PT.TIEPNHAN_ID = TN.TIEPNHAN_ID              AND PHAUTHUAT_ID  = 68089]
2020-02-26 14:08:12,428 [1] DEBUG - Statement Id: [DAO00048_CheckDVPhauThuatBHYT] PreparedStatement : [select count(0) from TT_VIENPHI          where REF_TABLE = 'TT_DVYEUCAU' and REF_ID = (select top 1 DVYEUCAU_ID from TT_PHAUTHUAT_YEUCAU where PHAUTHUAT_ID =  @param0 )          and TIEPNHAN_ID =  @param1  and BHYT_DONGIA > 0]
2020-02-26 14:08:12,428 [1] DEBUG - Statement Id: [DAO00048_CheckDVPhauThuatBHYT] Parameters: [@param0=[PHAUTHUAT_ID,68089], @param1=[TIEPNHAN_ID,329]]
2020-02-26 14:08:12,428 [1] DEBUG - Statement Id: [DAO00048_CheckDVPhauThuatBHYT] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64]]
2020-02-26 14:08:12,470 [1] DEBUG - Statement Id: [DAO00116_File_GetList] PreparedStatement : [select *              from TT_FILE_DINHKEM               where                             TT_FILE_DINHKEM.REF_TABLE = 'TT_PHAUTHUAT'                       and                           TT_FILE_DINHKEM.REF_ID = '68089'                       and                           TT_FILE_DINHKEM.BENHVIEN_ID = 'HLU01'                                     order by FILE_ID]
2020-02-26 14:08:12,539 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_EKIP_GetDetail] PreparedStatement : [select *              from TT_PHAUTHUAT_EKIP              where PHAUTHUAT_ID  = 68089]
2020-02-26 14:08:32,054 [1] DEBUG - Statement Id: [DAO00019_DanhSachPhauThuatThuThuat] PreparedStatement : [declare @TenBenhVien nvarchar(500)        declare @ManhomDSA varchar(10);        set @TenBenhVien = (select VALUE from TM_SYS_APPSETTINGS where CODE = 'APP_BENHVIEN_TEN')        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        select * from(        select ROW_NUMBER() OVER(order by NGAYGIOYEUCAU) as ROWNUMBER, *        from        (SELECT distinct        COUNT(*) OVER() as TOTALROWS,        N'Mã người bệnh: ' + bn.MAYTE + ' - ' + N'Tên người bệnh: ' + bn.TENBENHNHAN + ' - ' + N'Số bệnh án: ' + ISNULL(BA.SOBENHAN,'') + ' - ' + N'Sinh ngày: ' + isnull(Convert(varchar(10),bn.NGAYSINH,103),bn.NAMSINH) + ' - ' + N'Giới tính: ' + GD.DESCRIPTION as GROUPNAME,        bn.MAYTE, bn.TENBENHNHAN, bn.NAMSINH, bn.NGAYSINH as TUOI, ISNULL(CONVERT(VARCHAR(10), bn.NGAYSINH, 103),CAST(bn.NAMSINH AS varchar)) as NGAYSINH, bn.DIACHILIENLAC as DIACHI, bn.GIOITINH, GD.DESCRIPTION as TENGIOITINH,        tn.DOITUONG_ID, tn.THOIGIANTIEPNHAN, tn.BENHNHAN_ID, tn.TIEPNHAN_ID, tn.TRAITUYEN, tn.SOTIEPNHAN        , dv.DICHVU_ID, dv.NOITHUCHIEN_ID, isnull(dv.NGAYTAO, dv.NGAYCAPNHAT) as THOIGIANDKDICHVU        , dv.KHAN, dv.NOIYEUCAU_ID, dv.NGAYGIOYEUCAU, dv.BACSICHIDINH_ID, dv.DONVIGIOITHIEU_ID        , dv.NGUOIGIOITHIEU_ID, dv.TRANGTHAI_WFL, tn.NOIGIOITHIEU_ID        , dv.DVYEUCAU_ID, dv.MARIS, dv.TRANGTHAI as TRANGTHAICODE, B.TENNHOMDICHVU, dv.SOPHIEUYEUCAU, dv.KHAMBENH_NGOAITRU_ID, dv.NGUOICAPNHAT_ID, dv.NGAYCAPNHAT,        CASE        WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU        WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02'        ELSE Left(B.MANHOMDICHVU,2) END AS MANHOMDICHVU, B.MANHOMDICHVU as MANHOMDICHVUCHITIET, tn.TRANGTHAI as TRANGTHAI_TIEPNHAN,        'False' as DAKHAM,        vp.DATHANHTOAN, vp.DONGIA_DOANHTHU, BA.SOBENHAN, dv.CHANDOAN        , a.TENDICHVU, nth.TENPHONGBAN as TENPHONGKHAM, nyc.TENPHONGBAN as TENKHOACHIDINH        , bscd.TENNHANVIEN as TENBACSICHIDINH        , 0 as GUINGOAI        , 0 as VTYT        , 0 as CLSKETQUA_ID          ,             '' SOPHIEUPHAUTHUAT                   FROM TT_DVYEUCAU (NOLOCK) dv        inner join TT_TIEPNHAN (NOLOCK) tn on dv.TIEPNHAN_ID = tn.TIEPNHAN_ID        inner join TT_BENHNHAN (NOLOCK) bn on tn.BENHNHAN_ID = bn.BENHNHAN_ID        inner join TM_DICHVU A on A.DICHVU_ID = dv.DICHVU_ID        inner join TM_PHONGBAN nth on nth.PHONGBAN_ID = dv.NOITHUCHIEN_ID        left join TM_NHANVIEN bscd on bscd.NHANVIEN_ID = dv.BACSICHIDINH_ID        inner join TM_PHONGBAN nyc on nyc.PHONGBAN_ID = dv.NOIYEUCAU_ID        inner join TM_NHOMDICHVU B on B.NHOMDICHVU_ID = A.NHOMDICHVU_ID        inner join TT_VIENPHI (NOLOCK) VP on VP.TIEPNHAN_ID = tn.TIEPNHAN_ID and VP.DICHVU_ID = dv.DICHVU_ID and VP.REF_ID = dv.DVYEUCAU_ID        left join TT_NOITRU_BENHAN (NOLOCK) BA on BA.TIEPNHAN_ID = tn.TIEPNHAN_ID AND dv.BENHAN_ID = BA.BENHAN_ID        inner join TM_GENDER GD on GD.ID = bn.GIOITINH                 where        dv.DICHVU_ID IS NOT NULL        and tn.BENHVIEN_ID = 'HLU01'        and HUYYEUCAU = 0        and dv.NGAYHENCLS is NULL                       and dv.TRANGTHAI = 'CHUAKETQUA'           and           dv.NGAYYEUCAU >= '11/1/2019 12:00:00 AM'         and           dv.NGAYYEUCAU <= '2/26/2020 12:00:00 AM'         and           dv.NOITHUCHIEN_ID = 25         and           (CASE          WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU          WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2)          END) in (05)         and           tn.TRANGTHAI IN ('DATIEPNHAN','NOITRU','CAPCUU', 'HOANTHANH')         and           (vp.DATHANHTOAN = '1'  or vp.DONGIA_DOANHTHU = '0' OR TN.SUDUNG_BHTN='1' OR TN.BAOLANH_VIENPHI='1'  OR tn.TRANGTHAI IN ('NOITRU','CAPCUU','NGOAITRU') or dv.HOPDONG_BENHNHAN_ID is not null or vp.BENHNHAN_PHAITHANHTOAN >= 0)                 ) data1) lst                    where          lst.ROWNUMBER between 1 and 20                 order by NGAYGIOYEUCAU asc]
2020-02-26 14:08:35,781 [1] DEBUG - Statement Id: [DAO00019_DanhSachPhauThuatThuThuat] PreparedStatement : [declare @TenBenhVien nvarchar(500)        declare @ManhomDSA varchar(10);        set @TenBenhVien = (select VALUE from TM_SYS_APPSETTINGS where CODE = 'APP_BENHVIEN_TEN')        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        select * from(        select ROW_NUMBER() OVER(order by NGAYGIOYEUCAU) as ROWNUMBER, *        from        (SELECT distinct        COUNT(*) OVER() as TOTALROWS,        N'Mã người bệnh: ' + bn.MAYTE + ' - ' + N'Tên người bệnh: ' + bn.TENBENHNHAN + ' - ' + N'Số bệnh án: ' + ISNULL(BA.SOBENHAN,'') + ' - ' + N'Sinh ngày: ' + isnull(Convert(varchar(10),bn.NGAYSINH,103),bn.NAMSINH) + ' - ' + N'Giới tính: ' + GD.DESCRIPTION as GROUPNAME,        bn.MAYTE, bn.TENBENHNHAN, bn.NAMSINH, bn.NGAYSINH as TUOI, ISNULL(CONVERT(VARCHAR(10), bn.NGAYSINH, 103),CAST(bn.NAMSINH AS varchar)) as NGAYSINH, bn.DIACHILIENLAC as DIACHI, bn.GIOITINH, GD.DESCRIPTION as TENGIOITINH,        tn.DOITUONG_ID, tn.THOIGIANTIEPNHAN, tn.BENHNHAN_ID, tn.TIEPNHAN_ID, tn.TRAITUYEN, tn.SOTIEPNHAN        , dv.DICHVU_ID, dv.NOITHUCHIEN_ID, isnull(dv.NGAYTAO, dv.NGAYCAPNHAT) as THOIGIANDKDICHVU        , dv.KHAN, dv.NOIYEUCAU_ID, dv.NGAYGIOYEUCAU, dv.BACSICHIDINH_ID, dv.DONVIGIOITHIEU_ID        , dv.NGUOIGIOITHIEU_ID, dv.TRANGTHAI_WFL, tn.NOIGIOITHIEU_ID        , dv.DVYEUCAU_ID, dv.MARIS, dv.TRANGTHAI as TRANGTHAICODE, B.TENNHOMDICHVU, dv.SOPHIEUYEUCAU, dv.KHAMBENH_NGOAITRU_ID, dv.NGUOICAPNHAT_ID, dv.NGAYCAPNHAT,        CASE        WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU        WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02'        ELSE Left(B.MANHOMDICHVU,2) END AS MANHOMDICHVU, B.MANHOMDICHVU as MANHOMDICHVUCHITIET, tn.TRANGTHAI as TRANGTHAI_TIEPNHAN,        'False' as DAKHAM,        vp.DATHANHTOAN, vp.DONGIA_DOANHTHU, BA.SOBENHAN, dv.CHANDOAN        , a.TENDICHVU, nth.TENPHONGBAN as TENPHONGKHAM, nyc.TENPHONGBAN as TENKHOACHIDINH        , bscd.TENNHANVIEN as TENBACSICHIDINH        , 0 as GUINGOAI        , 0 as VTYT        , 0 as CLSKETQUA_ID          ,             '' SOPHIEUPHAUTHUAT                   FROM TT_DVYEUCAU (NOLOCK) dv        inner join TT_TIEPNHAN (NOLOCK) tn on dv.TIEPNHAN_ID = tn.TIEPNHAN_ID        inner join TT_BENHNHAN (NOLOCK) bn on tn.BENHNHAN_ID = bn.BENHNHAN_ID        inner join TM_DICHVU A on A.DICHVU_ID = dv.DICHVU_ID        inner join TM_PHONGBAN nth on nth.PHONGBAN_ID = dv.NOITHUCHIEN_ID        left join TM_NHANVIEN bscd on bscd.NHANVIEN_ID = dv.BACSICHIDINH_ID        inner join TM_PHONGBAN nyc on nyc.PHONGBAN_ID = dv.NOIYEUCAU_ID        inner join TM_NHOMDICHVU B on B.NHOMDICHVU_ID = A.NHOMDICHVU_ID        inner join TT_VIENPHI (NOLOCK) VP on VP.TIEPNHAN_ID = tn.TIEPNHAN_ID and VP.DICHVU_ID = dv.DICHVU_ID and VP.REF_ID = dv.DVYEUCAU_ID        left join TT_NOITRU_BENHAN (NOLOCK) BA on BA.TIEPNHAN_ID = tn.TIEPNHAN_ID AND dv.BENHAN_ID = BA.BENHAN_ID        inner join TM_GENDER GD on GD.ID = bn.GIOITINH                 where        dv.DICHVU_ID IS NOT NULL        and tn.BENHVIEN_ID = 'HLU01'        and HUYYEUCAU = 0        and dv.NGAYHENCLS is NULL                       and dv.TRANGTHAI = 'CHUAKETQUA'           and           dv.NGAYYEUCAU >= '11/1/2019 12:00:00 AM'         and           dv.NGAYYEUCAU <= '2/26/2020 12:00:00 AM'         and           dv.NOITHUCHIEN_ID = 25         and           (CASE          WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU          WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2)          END) in (05)         and           tn.TRANGTHAI IN ('DATIEPNHAN','NOITRU','CAPCUU', 'HOANTHANH')         and           (vp.DATHANHTOAN = '1'  or vp.DONGIA_DOANHTHU = '0' OR TN.SUDUNG_BHTN='1' OR TN.BAOLANH_VIENPHI='1'  OR tn.TRANGTHAI IN ('NOITRU','CAPCUU','NGOAITRU') or dv.HOPDONG_BENHNHAN_ID is not null or vp.BENHNHAN_PHAITHANHTOAN >= 0)                 ) data1) lst                    where          lst.ROWNUMBER between 1 and 20                 order by NGAYGIOYEUCAU asc]
2020-02-26 14:08:38,346 [1] DEBUG - Statement Id: [DAO00019_DanhSachPhauThuatThuThuat] PreparedStatement : [declare @TenBenhVien nvarchar(500)        declare @ManhomDSA varchar(10);        set @TenBenhVien = (select VALUE from TM_SYS_APPSETTINGS where CODE = 'APP_BENHVIEN_TEN')        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        select * from(        select ROW_NUMBER() OVER(order by NGAYGIOYEUCAU) as ROWNUMBER, *        from        (SELECT distinct        COUNT(*) OVER() as TOTALROWS,        N'Mã người bệnh: ' + bn.MAYTE + ' - ' + N'Tên người bệnh: ' + bn.TENBENHNHAN + ' - ' + N'Số bệnh án: ' + ISNULL(BA.SOBENHAN,'') + ' - ' + N'Sinh ngày: ' + isnull(Convert(varchar(10),bn.NGAYSINH,103),bn.NAMSINH) + ' - ' + N'Giới tính: ' + GD.DESCRIPTION as GROUPNAME,        bn.MAYTE, bn.TENBENHNHAN, bn.NAMSINH, bn.NGAYSINH as TUOI, ISNULL(CONVERT(VARCHAR(10), bn.NGAYSINH, 103),CAST(bn.NAMSINH AS varchar)) as NGAYSINH, bn.DIACHILIENLAC as DIACHI, bn.GIOITINH, GD.DESCRIPTION as TENGIOITINH,        tn.DOITUONG_ID, tn.THOIGIANTIEPNHAN, tn.BENHNHAN_ID, tn.TIEPNHAN_ID, tn.TRAITUYEN, tn.SOTIEPNHAN        , dv.DICHVU_ID, dv.NOITHUCHIEN_ID, isnull(dv.NGAYTAO, dv.NGAYCAPNHAT) as THOIGIANDKDICHVU        , dv.KHAN, dv.NOIYEUCAU_ID, dv.NGAYGIOYEUCAU, dv.BACSICHIDINH_ID, dv.DONVIGIOITHIEU_ID        , dv.NGUOIGIOITHIEU_ID, dv.TRANGTHAI_WFL, tn.NOIGIOITHIEU_ID        , dv.DVYEUCAU_ID, dv.MARIS, dv.TRANGTHAI as TRANGTHAICODE, B.TENNHOMDICHVU, dv.SOPHIEUYEUCAU, dv.KHAMBENH_NGOAITRU_ID, dv.NGUOICAPNHAT_ID, dv.NGAYCAPNHAT,        CASE        WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU        WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02'        ELSE Left(B.MANHOMDICHVU,2) END AS MANHOMDICHVU, B.MANHOMDICHVU as MANHOMDICHVUCHITIET, tn.TRANGTHAI as TRANGTHAI_TIEPNHAN,        'True' as DAKHAM,        vp.DATHANHTOAN, vp.DONGIA_DOANHTHU, BA.SOBENHAN, dv.CHANDOAN        , a.TENDICHVU, nth.TENPHONGBAN as TENPHONGKHAM, nyc.TENPHONGBAN as TENKHOACHIDINH        , bscd.TENNHANVIEN as TENBACSICHIDINH        , 0 as GUINGOAI        , 0 as VTYT        , 0 as CLSKETQUA_ID          ,             pt.PHAUTHUAT_ID, pt.NGAYTHUCHIEN , pt.THOIGIANKHOADULIEU, pt.NGUOIKHOA_ID            , pt.TENNGUOIKHOA as TENNGUOIDUYET, pt.SOPHIEUPHAUTHUAT, pt.THOIGIANBATDAU, pt.THOIGIANKETTHUC                   FROM TT_DVYEUCAU (NOLOCK) dv        inner join TT_TIEPNHAN (NOLOCK) tn on dv.TIEPNHAN_ID = tn.TIEPNHAN_ID        inner join TT_BENHNHAN (NOLOCK) bn on tn.BENHNHAN_ID = bn.BENHNHAN_ID        inner join TM_DICHVU A on A.DICHVU_ID = dv.DICHVU_ID        inner join TM_PHONGBAN nth on nth.PHONGBAN_ID = dv.NOITHUCHIEN_ID        left join TM_NHANVIEN bscd on bscd.NHANVIEN_ID = dv.BACSICHIDINH_ID        inner join TM_PHONGBAN nyc on nyc.PHONGBAN_ID = dv.NOIYEUCAU_ID        inner join TM_NHOMDICHVU B on B.NHOMDICHVU_ID = A.NHOMDICHVU_ID        inner join TT_VIENPHI (NOLOCK) VP on VP.TIEPNHAN_ID = tn.TIEPNHAN_ID and VP.DICHVU_ID = dv.DICHVU_ID and VP.REF_ID = dv.DVYEUCAU_ID        left join TT_NOITRU_BENHAN (NOLOCK) BA on BA.TIEPNHAN_ID = tn.TIEPNHAN_ID AND dv.BENHAN_ID = BA.BENHAN_ID        inner join TM_GENDER GD on GD.ID = bn.GIOITINH                       inner join TT_PHAUTHUAT_YEUCAU (NOLOCK) ptyc on ptyc.DVYEUCAU_ID = dv.DVYEUCAU_ID            inner join TT_PHAUTHUAT (NOLOCK) pt on pt.PHAUTHUAT_ID = ptyc.PHAUTHUAT_ID            left join TM_PHONGBAN pt_pb on pt_pb.PHONGBAN_ID = pt.PHONGBANTHUCHIEN_ID                   where        dv.DICHVU_ID IS NOT NULL        and tn.BENHVIEN_ID = 'HLU01'        and HUYYEUCAU = 0        and dv.NGAYHENCLS is NULL                       and dv.TRANGTHAI IN ('CHOXACNHAN','HOANTAT')           and           dv.NGAYYEUCAU >= '11/1/2019 12:00:00 AM'         and           dv.NGAYYEUCAU <= '2/26/2020 12:00:00 AM'         and           dv.NOITHUCHIEN_ID = 25         and           (CASE          WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU          WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2)          END) in (05)         and           tn.TRANGTHAI IN ('DATIEPNHAN','NOITRU','CAPCUU', 'HOANTHANH')         and           (vp.DATHANHTOAN = '1'  or vp.DONGIA_DOANHTHU = '0' OR TN.SUDUNG_BHTN='1' OR TN.BAOLANH_VIENPHI='1'  OR tn.TRANGTHAI IN ('NOITRU','CAPCUU','NGOAITRU') or dv.HOPDONG_BENHNHAN_ID is not null or vp.BENHNHAN_PHAITHANHTOAN >= 0)                 ) data1) lst                    where          lst.ROWNUMBER between 1 and 20                 order by NGAYGIOYEUCAU asc]
2020-02-26 14:09:59,732 [1] DEBUG - Statement Id: [DAO00019_DanhSachPhauThuatThuThuat] PreparedStatement : [declare @TenBenhVien nvarchar(500)        declare @ManhomDSA varchar(10);        set @TenBenhVien = (select VALUE from TM_SYS_APPSETTINGS where CODE = 'APP_BENHVIEN_TEN')        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        select * from(        select ROW_NUMBER() OVER(order by NGAYGIOYEUCAU) as ROWNUMBER, *        from        (SELECT distinct        COUNT(*) OVER() as TOTALROWS,        N'Mã người bệnh: ' + bn.MAYTE + ' - ' + N'Tên người bệnh: ' + bn.TENBENHNHAN + ' - ' + N'Số bệnh án: ' + ISNULL(BA.SOBENHAN,'') + ' - ' + N'Sinh ngày: ' + isnull(Convert(varchar(10),bn.NGAYSINH,103),bn.NAMSINH) + ' - ' + N'Giới tính: ' + GD.DESCRIPTION as GROUPNAME,        bn.MAYTE, bn.TENBENHNHAN, bn.NAMSINH, bn.NGAYSINH as TUOI, ISNULL(CONVERT(VARCHAR(10), bn.NGAYSINH, 103),CAST(bn.NAMSINH AS varchar)) as NGAYSINH, bn.DIACHILIENLAC as DIACHI, bn.GIOITINH, GD.DESCRIPTION as TENGIOITINH,        tn.DOITUONG_ID, tn.THOIGIANTIEPNHAN, tn.BENHNHAN_ID, tn.TIEPNHAN_ID, tn.TRAITUYEN, tn.SOTIEPNHAN        , dv.DICHVU_ID, dv.NOITHUCHIEN_ID, isnull(dv.NGAYTAO, dv.NGAYCAPNHAT) as THOIGIANDKDICHVU        , dv.KHAN, dv.NOIYEUCAU_ID, dv.NGAYGIOYEUCAU, dv.BACSICHIDINH_ID, dv.DONVIGIOITHIEU_ID        , dv.NGUOIGIOITHIEU_ID, dv.TRANGTHAI_WFL, tn.NOIGIOITHIEU_ID        , dv.DVYEUCAU_ID, dv.MARIS, dv.TRANGTHAI as TRANGTHAICODE, B.TENNHOMDICHVU, dv.SOPHIEUYEUCAU, dv.KHAMBENH_NGOAITRU_ID, dv.NGUOICAPNHAT_ID, dv.NGAYCAPNHAT,        CASE        WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU        WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02'        ELSE Left(B.MANHOMDICHVU,2) END AS MANHOMDICHVU, B.MANHOMDICHVU as MANHOMDICHVUCHITIET, tn.TRANGTHAI as TRANGTHAI_TIEPNHAN,        'True' as DAKHAM,        vp.DATHANHTOAN, vp.DONGIA_DOANHTHU, BA.SOBENHAN, dv.CHANDOAN        , a.TENDICHVU, nth.TENPHONGBAN as TENPHONGKHAM, nyc.TENPHONGBAN as TENKHOACHIDINH        , bscd.TENNHANVIEN as TENBACSICHIDINH        , 0 as GUINGOAI        , 0 as VTYT        , 0 as CLSKETQUA_ID          ,             pt.PHAUTHUAT_ID, pt.NGAYTHUCHIEN , pt.THOIGIANKHOADULIEU, pt.NGUOIKHOA_ID            , pt.TENNGUOIKHOA as TENNGUOIDUYET, pt.SOPHIEUPHAUTHUAT, pt.THOIGIANBATDAU, pt.THOIGIANKETTHUC                   FROM TT_DVYEUCAU (NOLOCK) dv        inner join TT_TIEPNHAN (NOLOCK) tn on dv.TIEPNHAN_ID = tn.TIEPNHAN_ID        inner join TT_BENHNHAN (NOLOCK) bn on tn.BENHNHAN_ID = bn.BENHNHAN_ID        inner join TM_DICHVU A on A.DICHVU_ID = dv.DICHVU_ID        inner join TM_PHONGBAN nth on nth.PHONGBAN_ID = dv.NOITHUCHIEN_ID        left join TM_NHANVIEN bscd on bscd.NHANVIEN_ID = dv.BACSICHIDINH_ID        inner join TM_PHONGBAN nyc on nyc.PHONGBAN_ID = dv.NOIYEUCAU_ID        inner join TM_NHOMDICHVU B on B.NHOMDICHVU_ID = A.NHOMDICHVU_ID        inner join TT_VIENPHI (NOLOCK) VP on VP.TIEPNHAN_ID = tn.TIEPNHAN_ID and VP.DICHVU_ID = dv.DICHVU_ID and VP.REF_ID = dv.DVYEUCAU_ID        left join TT_NOITRU_BENHAN (NOLOCK) BA on BA.TIEPNHAN_ID = tn.TIEPNHAN_ID AND dv.BENHAN_ID = BA.BENHAN_ID        inner join TM_GENDER GD on GD.ID = bn.GIOITINH                       inner join TT_PHAUTHUAT_YEUCAU (NOLOCK) ptyc on ptyc.DVYEUCAU_ID = dv.DVYEUCAU_ID            inner join TT_PHAUTHUAT (NOLOCK) pt on pt.PHAUTHUAT_ID = ptyc.PHAUTHUAT_ID            left join TM_PHONGBAN pt_pb on pt_pb.PHONGBAN_ID = pt.PHONGBANTHUCHIEN_ID                   where        dv.DICHVU_ID IS NOT NULL        and tn.BENHVIEN_ID = 'HLU01'        and HUYYEUCAU = 0        and dv.NGAYHENCLS is NULL                       and dv.TRANGTHAI IN ('CHOXACNHAN','HOANTAT')           and           dv.NGAYYEUCAU >= '11/1/2019 12:00:00 AM'         and           dv.NGAYYEUCAU <= '2/26/2020 12:00:00 AM'         and           dv.NOITHUCHIEN_ID = 25         and           (CASE          WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU          WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2)          END) in (05)         and           tn.TRANGTHAI IN ('DATIEPNHAN','NOITRU','CAPCUU', 'HOANTHANH')         and           (vp.DATHANHTOAN = '1'  or vp.DONGIA_DOANHTHU = '0' OR TN.SUDUNG_BHTN='1' OR TN.BAOLANH_VIENPHI='1'  OR tn.TRANGTHAI IN ('NOITRU','CAPCUU','NGOAITRU') or dv.HOPDONG_BENHNHAN_ID is not null or vp.BENHNHAN_PHAITHANHTOAN >= 0)                 ) data1) lst                    where          lst.ROWNUMBER between 741 and 760                 order by NGAYGIOYEUCAU asc]
2020-02-26 14:10:13,316 [1] DEBUG - Statement Id: [DAO00019_DanhSachPhauThuatThuThuat] PreparedStatement : [declare @TenBenhVien nvarchar(500)        declare @ManhomDSA varchar(10);        set @TenBenhVien = (select VALUE from TM_SYS_APPSETTINGS where CODE = 'APP_BENHVIEN_TEN')        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        select * from(        select ROW_NUMBER() OVER(order by NGAYGIOYEUCAU) as ROWNUMBER, *        from        (SELECT distinct        COUNT(*) OVER() as TOTALROWS,        N'Mã người bệnh: ' + bn.MAYTE + ' - ' + N'Tên người bệnh: ' + bn.TENBENHNHAN + ' - ' + N'Số bệnh án: ' + ISNULL(BA.SOBENHAN,'') + ' - ' + N'Sinh ngày: ' + isnull(Convert(varchar(10),bn.NGAYSINH,103),bn.NAMSINH) + ' - ' + N'Giới tính: ' + GD.DESCRIPTION as GROUPNAME,        bn.MAYTE, bn.TENBENHNHAN, bn.NAMSINH, bn.NGAYSINH as TUOI, ISNULL(CONVERT(VARCHAR(10), bn.NGAYSINH, 103),CAST(bn.NAMSINH AS varchar)) as NGAYSINH, bn.DIACHILIENLAC as DIACHI, bn.GIOITINH, GD.DESCRIPTION as TENGIOITINH,        tn.DOITUONG_ID, tn.THOIGIANTIEPNHAN, tn.BENHNHAN_ID, tn.TIEPNHAN_ID, tn.TRAITUYEN, tn.SOTIEPNHAN        , dv.DICHVU_ID, dv.NOITHUCHIEN_ID, isnull(dv.NGAYTAO, dv.NGAYCAPNHAT) as THOIGIANDKDICHVU        , dv.KHAN, dv.NOIYEUCAU_ID, dv.NGAYGIOYEUCAU, dv.BACSICHIDINH_ID, dv.DONVIGIOITHIEU_ID        , dv.NGUOIGIOITHIEU_ID, dv.TRANGTHAI_WFL, tn.NOIGIOITHIEU_ID        , dv.DVYEUCAU_ID, dv.MARIS, dv.TRANGTHAI as TRANGTHAICODE, B.TENNHOMDICHVU, dv.SOPHIEUYEUCAU, dv.KHAMBENH_NGOAITRU_ID, dv.NGUOICAPNHAT_ID, dv.NGAYCAPNHAT,        CASE        WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU        WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02'        ELSE Left(B.MANHOMDICHVU,2) END AS MANHOMDICHVU, B.MANHOMDICHVU as MANHOMDICHVUCHITIET, tn.TRANGTHAI as TRANGTHAI_TIEPNHAN,        'True' as DAKHAM,        vp.DATHANHTOAN, vp.DONGIA_DOANHTHU, BA.SOBENHAN, dv.CHANDOAN        , a.TENDICHVU, nth.TENPHONGBAN as TENPHONGKHAM, nyc.TENPHONGBAN as TENKHOACHIDINH        , bscd.TENNHANVIEN as TENBACSICHIDINH        , 0 as GUINGOAI        , 0 as VTYT        , 0 as CLSKETQUA_ID          ,             pt.PHAUTHUAT_ID, pt.NGAYTHUCHIEN , pt.THOIGIANKHOADULIEU, pt.NGUOIKHOA_ID            , pt.TENNGUOIKHOA as TENNGUOIDUYET, pt.SOPHIEUPHAUTHUAT, pt.THOIGIANBATDAU, pt.THOIGIANKETTHUC                   FROM TT_DVYEUCAU (NOLOCK) dv        inner join TT_TIEPNHAN (NOLOCK) tn on dv.TIEPNHAN_ID = tn.TIEPNHAN_ID        inner join TT_BENHNHAN (NOLOCK) bn on tn.BENHNHAN_ID = bn.BENHNHAN_ID        inner join TM_DICHVU A on A.DICHVU_ID = dv.DICHVU_ID        inner join TM_PHONGBAN nth on nth.PHONGBAN_ID = dv.NOITHUCHIEN_ID        left join TM_NHANVIEN bscd on bscd.NHANVIEN_ID = dv.BACSICHIDINH_ID        inner join TM_PHONGBAN nyc on nyc.PHONGBAN_ID = dv.NOIYEUCAU_ID        inner join TM_NHOMDICHVU B on B.NHOMDICHVU_ID = A.NHOMDICHVU_ID        inner join TT_VIENPHI (NOLOCK) VP on VP.TIEPNHAN_ID = tn.TIEPNHAN_ID and VP.DICHVU_ID = dv.DICHVU_ID and VP.REF_ID = dv.DVYEUCAU_ID        left join TT_NOITRU_BENHAN (NOLOCK) BA on BA.TIEPNHAN_ID = tn.TIEPNHAN_ID AND dv.BENHAN_ID = BA.BENHAN_ID        inner join TM_GENDER GD on GD.ID = bn.GIOITINH                       inner join TT_PHAUTHUAT_YEUCAU (NOLOCK) ptyc on ptyc.DVYEUCAU_ID = dv.DVYEUCAU_ID            inner join TT_PHAUTHUAT (NOLOCK) pt on pt.PHAUTHUAT_ID = ptyc.PHAUTHUAT_ID            left join TM_PHONGBAN pt_pb on pt_pb.PHONGBAN_ID = pt.PHONGBANTHUCHIEN_ID                   where        dv.DICHVU_ID IS NOT NULL        and tn.BENHVIEN_ID = 'HLU01'        and HUYYEUCAU = 0        and dv.NGAYHENCLS is NULL                       and dv.TRANGTHAI IN ('CHOXACNHAN','HOANTAT')           and           dv.NGAYYEUCAU >= '11/1/2019 12:00:00 AM'         and           dv.NGAYYEUCAU <= '2/26/2020 12:00:00 AM'         and           dv.NOITHUCHIEN_ID = 25         and           (bn.TENBENHNHAN like '%' +  @param0  + '%' or bn.MAYTE like '%' +  @param0  + '%')         and           (CASE          WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU          WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2)          END) in (05)         and           tn.TRANGTHAI IN ('DATIEPNHAN','NOITRU','CAPCUU', 'HOANTHANH')         and           (vp.DATHANHTOAN = '1'  or vp.DONGIA_DOANHTHU = '0' OR TN.SUDUNG_BHTN='1' OR TN.BAOLANH_VIENPHI='1'  OR tn.TRANGTHAI IN ('NOITRU','CAPCUU','NGOAITRU') or dv.HOPDONG_BENHNHAN_ID is not null or vp.BENHNHAN_PHAITHANHTOAN >= 0)                 ) data1) lst                    where          lst.ROWNUMBER between 1 and 20                 order by NGAYGIOYEUCAU asc]
2020-02-26 14:10:13,317 [1] DEBUG - Statement Id: [DAO00019_DanhSachPhauThuatThuThuat] Parameters: [@param0=[TENBENHNHAN,Tố]]
2020-02-26 14:10:13,317 [1] DEBUG - Statement Id: [DAO00019_DanhSachPhauThuatThuThuat] Types: [@param0=[String, System.String]]
2020-02-26 14:10:19,253 [1] DEBUG - Statement Id: [DAO00019_DanhSachPhauThuatThuThuat] PreparedStatement : [declare @TenBenhVien nvarchar(500)        declare @ManhomDSA varchar(10);        set @TenBenhVien = (select VALUE from TM_SYS_APPSETTINGS where CODE = 'APP_BENHVIEN_TEN')        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        select * from(        select ROW_NUMBER() OVER(order by NGAYGIOYEUCAU) as ROWNUMBER, *        from        (SELECT distinct        COUNT(*) OVER() as TOTALROWS,        N'Mã người bệnh: ' + bn.MAYTE + ' - ' + N'Tên người bệnh: ' + bn.TENBENHNHAN + ' - ' + N'Số bệnh án: ' + ISNULL(BA.SOBENHAN,'') + ' - ' + N'Sinh ngày: ' + isnull(Convert(varchar(10),bn.NGAYSINH,103),bn.NAMSINH) + ' - ' + N'Giới tính: ' + GD.DESCRIPTION as GROUPNAME,        bn.MAYTE, bn.TENBENHNHAN, bn.NAMSINH, bn.NGAYSINH as TUOI, ISNULL(CONVERT(VARCHAR(10), bn.NGAYSINH, 103),CAST(bn.NAMSINH AS varchar)) as NGAYSINH, bn.DIACHILIENLAC as DIACHI, bn.GIOITINH, GD.DESCRIPTION as TENGIOITINH,        tn.DOITUONG_ID, tn.THOIGIANTIEPNHAN, tn.BENHNHAN_ID, tn.TIEPNHAN_ID, tn.TRAITUYEN, tn.SOTIEPNHAN        , dv.DICHVU_ID, dv.NOITHUCHIEN_ID, isnull(dv.NGAYTAO, dv.NGAYCAPNHAT) as THOIGIANDKDICHVU        , dv.KHAN, dv.NOIYEUCAU_ID, dv.NGAYGIOYEUCAU, dv.BACSICHIDINH_ID, dv.DONVIGIOITHIEU_ID        , dv.NGUOIGIOITHIEU_ID, dv.TRANGTHAI_WFL, tn.NOIGIOITHIEU_ID        , dv.DVYEUCAU_ID, dv.MARIS, dv.TRANGTHAI as TRANGTHAICODE, B.TENNHOMDICHVU, dv.SOPHIEUYEUCAU, dv.KHAMBENH_NGOAITRU_ID, dv.NGUOICAPNHAT_ID, dv.NGAYCAPNHAT,        CASE        WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU        WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02'        ELSE Left(B.MANHOMDICHVU,2) END AS MANHOMDICHVU, B.MANHOMDICHVU as MANHOMDICHVUCHITIET, tn.TRANGTHAI as TRANGTHAI_TIEPNHAN,        'True' as DAKHAM,        vp.DATHANHTOAN, vp.DONGIA_DOANHTHU, BA.SOBENHAN, dv.CHANDOAN        , a.TENDICHVU, nth.TENPHONGBAN as TENPHONGKHAM, nyc.TENPHONGBAN as TENKHOACHIDINH        , bscd.TENNHANVIEN as TENBACSICHIDINH        , 0 as GUINGOAI        , 0 as VTYT        , 0 as CLSKETQUA_ID          ,             pt.PHAUTHUAT_ID, pt.NGAYTHUCHIEN , pt.THOIGIANKHOADULIEU, pt.NGUOIKHOA_ID            , pt.TENNGUOIKHOA as TENNGUOIDUYET, pt.SOPHIEUPHAUTHUAT, pt.THOIGIANBATDAU, pt.THOIGIANKETTHUC                   FROM TT_DVYEUCAU (NOLOCK) dv        inner join TT_TIEPNHAN (NOLOCK) tn on dv.TIEPNHAN_ID = tn.TIEPNHAN_ID        inner join TT_BENHNHAN (NOLOCK) bn on tn.BENHNHAN_ID = bn.BENHNHAN_ID        inner join TM_DICHVU A on A.DICHVU_ID = dv.DICHVU_ID        inner join TM_PHONGBAN nth on nth.PHONGBAN_ID = dv.NOITHUCHIEN_ID        left join TM_NHANVIEN bscd on bscd.NHANVIEN_ID = dv.BACSICHIDINH_ID        inner join TM_PHONGBAN nyc on nyc.PHONGBAN_ID = dv.NOIYEUCAU_ID        inner join TM_NHOMDICHVU B on B.NHOMDICHVU_ID = A.NHOMDICHVU_ID        inner join TT_VIENPHI (NOLOCK) VP on VP.TIEPNHAN_ID = tn.TIEPNHAN_ID and VP.DICHVU_ID = dv.DICHVU_ID and VP.REF_ID = dv.DVYEUCAU_ID        left join TT_NOITRU_BENHAN (NOLOCK) BA on BA.TIEPNHAN_ID = tn.TIEPNHAN_ID AND dv.BENHAN_ID = BA.BENHAN_ID        inner join TM_GENDER GD on GD.ID = bn.GIOITINH                       inner join TT_PHAUTHUAT_YEUCAU (NOLOCK) ptyc on ptyc.DVYEUCAU_ID = dv.DVYEUCAU_ID            inner join TT_PHAUTHUAT (NOLOCK) pt on pt.PHAUTHUAT_ID = ptyc.PHAUTHUAT_ID            left join TM_PHONGBAN pt_pb on pt_pb.PHONGBAN_ID = pt.PHONGBANTHUCHIEN_ID                   where        dv.DICHVU_ID IS NOT NULL        and tn.BENHVIEN_ID = 'HLU01'        and HUYYEUCAU = 0        and dv.NGAYHENCLS is NULL                       and dv.TRANGTHAI IN ('CHOXACNHAN','HOANTAT')           and           dv.NGAYYEUCAU >= '11/1/2019 12:00:00 AM'         and           dv.NGAYYEUCAU <= '2/26/2020 12:00:00 AM'         and           dv.NOITHUCHIEN_ID = 25         and           (bn.TENBENHNHAN like '%' +  @param0  + '%' or bn.MAYTE like '%' +  @param0  + '%')         and           (CASE          WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU          WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2)          END) in (05)         and           tn.TRANGTHAI IN ('DATIEPNHAN','NOITRU','CAPCUU', 'HOANTHANH')         and           (vp.DATHANHTOAN = '1'  or vp.DONGIA_DOANHTHU = '0' OR TN.SUDUNG_BHTN='1' OR TN.BAOLANH_VIENPHI='1'  OR tn.TRANGTHAI IN ('NOITRU','CAPCUU','NGOAITRU') or dv.HOPDONG_BENHNHAN_ID is not null or vp.BENHNHAN_PHAITHANHTOAN >= 0)                 ) data1) lst                    where          lst.ROWNUMBER between 21 and 40                 order by NGAYGIOYEUCAU asc]
2020-02-26 14:10:19,253 [1] DEBUG - Statement Id: [DAO00019_DanhSachPhauThuatThuThuat] Parameters: [@param0=[TENBENHNHAN,Tố]]
2020-02-26 14:10:19,253 [1] DEBUG - Statement Id: [DAO00019_DanhSachPhauThuatThuThuat] Types: [@param0=[String, System.String]]
2020-02-26 14:10:22,188 [1] DEBUG - Statement Id: [DAO00019_DanhSachPhauThuatThuThuat] PreparedStatement : [declare @TenBenhVien nvarchar(500)        declare @ManhomDSA varchar(10);        set @TenBenhVien = (select VALUE from TM_SYS_APPSETTINGS where CODE = 'APP_BENHVIEN_TEN')        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        select * from(        select ROW_NUMBER() OVER(order by NGAYGIOYEUCAU) as ROWNUMBER, *        from        (SELECT distinct        COUNT(*) OVER() as TOTALROWS,        N'Mã người bệnh: ' + bn.MAYTE + ' - ' + N'Tên người bệnh: ' + bn.TENBENHNHAN + ' - ' + N'Số bệnh án: ' + ISNULL(BA.SOBENHAN,'') + ' - ' + N'Sinh ngày: ' + isnull(Convert(varchar(10),bn.NGAYSINH,103),bn.NAMSINH) + ' - ' + N'Giới tính: ' + GD.DESCRIPTION as GROUPNAME,        bn.MAYTE, bn.TENBENHNHAN, bn.NAMSINH, bn.NGAYSINH as TUOI, ISNULL(CONVERT(VARCHAR(10), bn.NGAYSINH, 103),CAST(bn.NAMSINH AS varchar)) as NGAYSINH, bn.DIACHILIENLAC as DIACHI, bn.GIOITINH, GD.DESCRIPTION as TENGIOITINH,        tn.DOITUONG_ID, tn.THOIGIANTIEPNHAN, tn.BENHNHAN_ID, tn.TIEPNHAN_ID, tn.TRAITUYEN, tn.SOTIEPNHAN        , dv.DICHVU_ID, dv.NOITHUCHIEN_ID, isnull(dv.NGAYTAO, dv.NGAYCAPNHAT) as THOIGIANDKDICHVU        , dv.KHAN, dv.NOIYEUCAU_ID, dv.NGAYGIOYEUCAU, dv.BACSICHIDINH_ID, dv.DONVIGIOITHIEU_ID        , dv.NGUOIGIOITHIEU_ID, dv.TRANGTHAI_WFL, tn.NOIGIOITHIEU_ID        , dv.DVYEUCAU_ID, dv.MARIS, dv.TRANGTHAI as TRANGTHAICODE, B.TENNHOMDICHVU, dv.SOPHIEUYEUCAU, dv.KHAMBENH_NGOAITRU_ID, dv.NGUOICAPNHAT_ID, dv.NGAYCAPNHAT,        CASE        WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU        WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02'        ELSE Left(B.MANHOMDICHVU,2) END AS MANHOMDICHVU, B.MANHOMDICHVU as MANHOMDICHVUCHITIET, tn.TRANGTHAI as TRANGTHAI_TIEPNHAN,        'True' as DAKHAM,        vp.DATHANHTOAN, vp.DONGIA_DOANHTHU, BA.SOBENHAN, dv.CHANDOAN        , a.TENDICHVU, nth.TENPHONGBAN as TENPHONGKHAM, nyc.TENPHONGBAN as TENKHOACHIDINH        , bscd.TENNHANVIEN as TENBACSICHIDINH        , 0 as GUINGOAI        , 0 as VTYT        , 0 as CLSKETQUA_ID          ,             pt.PHAUTHUAT_ID, pt.NGAYTHUCHIEN , pt.THOIGIANKHOADULIEU, pt.NGUOIKHOA_ID            , pt.TENNGUOIKHOA as TENNGUOIDUYET, pt.SOPHIEUPHAUTHUAT, pt.THOIGIANBATDAU, pt.THOIGIANKETTHUC                   FROM TT_DVYEUCAU (NOLOCK) dv        inner join TT_TIEPNHAN (NOLOCK) tn on dv.TIEPNHAN_ID = tn.TIEPNHAN_ID        inner join TT_BENHNHAN (NOLOCK) bn on tn.BENHNHAN_ID = bn.BENHNHAN_ID        inner join TM_DICHVU A on A.DICHVU_ID = dv.DICHVU_ID        inner join TM_PHONGBAN nth on nth.PHONGBAN_ID = dv.NOITHUCHIEN_ID        left join TM_NHANVIEN bscd on bscd.NHANVIEN_ID = dv.BACSICHIDINH_ID        inner join TM_PHONGBAN nyc on nyc.PHONGBAN_ID = dv.NOIYEUCAU_ID        inner join TM_NHOMDICHVU B on B.NHOMDICHVU_ID = A.NHOMDICHVU_ID        inner join TT_VIENPHI (NOLOCK) VP on VP.TIEPNHAN_ID = tn.TIEPNHAN_ID and VP.DICHVU_ID = dv.DICHVU_ID and VP.REF_ID = dv.DVYEUCAU_ID        left join TT_NOITRU_BENHAN (NOLOCK) BA on BA.TIEPNHAN_ID = tn.TIEPNHAN_ID AND dv.BENHAN_ID = BA.BENHAN_ID        inner join TM_GENDER GD on GD.ID = bn.GIOITINH                       inner join TT_PHAUTHUAT_YEUCAU (NOLOCK) ptyc on ptyc.DVYEUCAU_ID = dv.DVYEUCAU_ID            inner join TT_PHAUTHUAT (NOLOCK) pt on pt.PHAUTHUAT_ID = ptyc.PHAUTHUAT_ID            left join TM_PHONGBAN pt_pb on pt_pb.PHONGBAN_ID = pt.PHONGBANTHUCHIEN_ID                   where        dv.DICHVU_ID IS NOT NULL        and tn.BENHVIEN_ID = 'HLU01'        and HUYYEUCAU = 0        and dv.NGAYHENCLS is NULL                       and dv.TRANGTHAI IN ('CHOXACNHAN','HOANTAT')           and           dv.NGAYYEUCAU >= '11/1/2019 12:00:00 AM'         and           dv.NGAYYEUCAU <= '2/26/2020 12:00:00 AM'         and           dv.NOITHUCHIEN_ID = 25         and           (bn.TENBENHNHAN like '%' +  @param0  + '%' or bn.MAYTE like '%' +  @param0  + '%')         and           (CASE          WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU          WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2)          END) in (05)         and           tn.TRANGTHAI IN ('DATIEPNHAN','NOITRU','CAPCUU', 'HOANTHANH')         and           (vp.DATHANHTOAN = '1'  or vp.DONGIA_DOANHTHU = '0' OR TN.SUDUNG_BHTN='1' OR TN.BAOLANH_VIENPHI='1'  OR tn.TRANGTHAI IN ('NOITRU','CAPCUU','NGOAITRU') or dv.HOPDONG_BENHNHAN_ID is not null or vp.BENHNHAN_PHAITHANHTOAN >= 0)                 ) data1) lst                    where          lst.ROWNUMBER between 1 and 20                 order by NGAYGIOYEUCAU asc]
2020-02-26 14:10:22,188 [1] DEBUG - Statement Id: [DAO00019_DanhSachPhauThuatThuThuat] Parameters: [@param0=[TENBENHNHAN,Tố]]
2020-02-26 14:10:22,188 [1] DEBUG - Statement Id: [DAO00019_DanhSachPhauThuatThuThuat] Types: [@param0=[String, System.String]]
2020-02-26 14:10:26,326 [1] DEBUG - Statement Id: [DAO00019_DanhSachPhauThuatThuThuat] PreparedStatement : [declare @TenBenhVien nvarchar(500)        declare @ManhomDSA varchar(10);        set @TenBenhVien = (select VALUE from TM_SYS_APPSETTINGS where CODE = 'APP_BENHVIEN_TEN')        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        select * from(        select ROW_NUMBER() OVER(order by NGAYGIOYEUCAU) as ROWNUMBER, *        from        (SELECT distinct        COUNT(*) OVER() as TOTALROWS,        N'Mã người bệnh: ' + bn.MAYTE + ' - ' + N'Tên người bệnh: ' + bn.TENBENHNHAN + ' - ' + N'Số bệnh án: ' + ISNULL(BA.SOBENHAN,'') + ' - ' + N'Sinh ngày: ' + isnull(Convert(varchar(10),bn.NGAYSINH,103),bn.NAMSINH) + ' - ' + N'Giới tính: ' + GD.DESCRIPTION as GROUPNAME,        bn.MAYTE, bn.TENBENHNHAN, bn.NAMSINH, bn.NGAYSINH as TUOI, ISNULL(CONVERT(VARCHAR(10), bn.NGAYSINH, 103),CAST(bn.NAMSINH AS varchar)) as NGAYSINH, bn.DIACHILIENLAC as DIACHI, bn.GIOITINH, GD.DESCRIPTION as TENGIOITINH,        tn.DOITUONG_ID, tn.THOIGIANTIEPNHAN, tn.BENHNHAN_ID, tn.TIEPNHAN_ID, tn.TRAITUYEN, tn.SOTIEPNHAN        , dv.DICHVU_ID, dv.NOITHUCHIEN_ID, isnull(dv.NGAYTAO, dv.NGAYCAPNHAT) as THOIGIANDKDICHVU        , dv.KHAN, dv.NOIYEUCAU_ID, dv.NGAYGIOYEUCAU, dv.BACSICHIDINH_ID, dv.DONVIGIOITHIEU_ID        , dv.NGUOIGIOITHIEU_ID, dv.TRANGTHAI_WFL, tn.NOIGIOITHIEU_ID        , dv.DVYEUCAU_ID, dv.MARIS, dv.TRANGTHAI as TRANGTHAICODE, B.TENNHOMDICHVU, dv.SOPHIEUYEUCAU, dv.KHAMBENH_NGOAITRU_ID, dv.NGUOICAPNHAT_ID, dv.NGAYCAPNHAT,        CASE        WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU        WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02'        ELSE Left(B.MANHOMDICHVU,2) END AS MANHOMDICHVU, B.MANHOMDICHVU as MANHOMDICHVUCHITIET, tn.TRANGTHAI as TRANGTHAI_TIEPNHAN,        'True' as DAKHAM,        vp.DATHANHTOAN, vp.DONGIA_DOANHTHU, BA.SOBENHAN, dv.CHANDOAN        , a.TENDICHVU, nth.TENPHONGBAN as TENPHONGKHAM, nyc.TENPHONGBAN as TENKHOACHIDINH        , bscd.TENNHANVIEN as TENBACSICHIDINH        , 0 as GUINGOAI        , 0 as VTYT        , 0 as CLSKETQUA_ID          ,             pt.PHAUTHUAT_ID, pt.NGAYTHUCHIEN , pt.THOIGIANKHOADULIEU, pt.NGUOIKHOA_ID            , pt.TENNGUOIKHOA as TENNGUOIDUYET, pt.SOPHIEUPHAUTHUAT, pt.THOIGIANBATDAU, pt.THOIGIANKETTHUC                   FROM TT_DVYEUCAU (NOLOCK) dv        inner join TT_TIEPNHAN (NOLOCK) tn on dv.TIEPNHAN_ID = tn.TIEPNHAN_ID        inner join TT_BENHNHAN (NOLOCK) bn on tn.BENHNHAN_ID = bn.BENHNHAN_ID        inner join TM_DICHVU A on A.DICHVU_ID = dv.DICHVU_ID        inner join TM_PHONGBAN nth on nth.PHONGBAN_ID = dv.NOITHUCHIEN_ID        left join TM_NHANVIEN bscd on bscd.NHANVIEN_ID = dv.BACSICHIDINH_ID        inner join TM_PHONGBAN nyc on nyc.PHONGBAN_ID = dv.NOIYEUCAU_ID        inner join TM_NHOMDICHVU B on B.NHOMDICHVU_ID = A.NHOMDICHVU_ID        inner join TT_VIENPHI (NOLOCK) VP on VP.TIEPNHAN_ID = tn.TIEPNHAN_ID and VP.DICHVU_ID = dv.DICHVU_ID and VP.REF_ID = dv.DVYEUCAU_ID        left join TT_NOITRU_BENHAN (NOLOCK) BA on BA.TIEPNHAN_ID = tn.TIEPNHAN_ID AND dv.BENHAN_ID = BA.BENHAN_ID        inner join TM_GENDER GD on GD.ID = bn.GIOITINH                       inner join TT_PHAUTHUAT_YEUCAU (NOLOCK) ptyc on ptyc.DVYEUCAU_ID = dv.DVYEUCAU_ID            inner join TT_PHAUTHUAT (NOLOCK) pt on pt.PHAUTHUAT_ID = ptyc.PHAUTHUAT_ID            left join TM_PHONGBAN pt_pb on pt_pb.PHONGBAN_ID = pt.PHONGBANTHUCHIEN_ID                   where        dv.DICHVU_ID IS NOT NULL        and tn.BENHVIEN_ID = 'HLU01'        and HUYYEUCAU = 0        and dv.NGAYHENCLS is NULL                       and dv.TRANGTHAI IN ('CHOXACNHAN','HOANTAT')           and           dv.NGAYYEUCAU >= '11/1/2019 12:00:00 AM'         and           dv.NGAYYEUCAU <= '2/26/2020 12:00:00 AM'         and           dv.NOITHUCHIEN_ID = 25         and           (bn.TENBENHNHAN like '%' +  @param0  + '%' or bn.MAYTE like '%' +  @param0  + '%')         and           (CASE          WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU          WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2)          END) in (05)         and           tn.TRANGTHAI IN ('DATIEPNHAN','NOITRU','CAPCUU', 'HOANTHANH')         and           (vp.DATHANHTOAN = '1'  or vp.DONGIA_DOANHTHU = '0' OR TN.SUDUNG_BHTN='1' OR TN.BAOLANH_VIENPHI='1'  OR tn.TRANGTHAI IN ('NOITRU','CAPCUU','NGOAITRU') or dv.HOPDONG_BENHNHAN_ID is not null or vp.BENHNHAN_PHAITHANHTOAN >= 0)                 ) data1) lst                    where          lst.ROWNUMBER between 1 and 20                 order by NGAYGIOYEUCAU asc]
2020-02-26 14:10:26,326 [1] DEBUG - Statement Id: [DAO00019_DanhSachPhauThuatThuThuat] Parameters: [@param0=[TENBENHNHAN,Tố]]
2020-02-26 14:10:26,326 [1] DEBUG - Statement Id: [DAO00019_DanhSachPhauThuatThuThuat] Types: [@param0=[String, System.String]]
2020-02-26 14:10:33,573 [1] DEBUG - Statement Id: [DAO00019_DanhSachPhauThuatThuThuat] PreparedStatement : [declare @TenBenhVien nvarchar(500)        declare @ManhomDSA varchar(10);        set @TenBenhVien = (select VALUE from TM_SYS_APPSETTINGS where CODE = 'APP_BENHVIEN_TEN')        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        select * from(        select ROW_NUMBER() OVER(order by NGAYGIOYEUCAU) as ROWNUMBER, *        from        (SELECT distinct        COUNT(*) OVER() as TOTALROWS,        N'Mã người bệnh: ' + bn.MAYTE + ' - ' + N'Tên người bệnh: ' + bn.TENBENHNHAN + ' - ' + N'Số bệnh án: ' + ISNULL(BA.SOBENHAN,'') + ' - ' + N'Sinh ngày: ' + isnull(Convert(varchar(10),bn.NGAYSINH,103),bn.NAMSINH) + ' - ' + N'Giới tính: ' + GD.DESCRIPTION as GROUPNAME,        bn.MAYTE, bn.TENBENHNHAN, bn.NAMSINH, bn.NGAYSINH as TUOI, ISNULL(CONVERT(VARCHAR(10), bn.NGAYSINH, 103),CAST(bn.NAMSINH AS varchar)) as NGAYSINH, bn.DIACHILIENLAC as DIACHI, bn.GIOITINH, GD.DESCRIPTION as TENGIOITINH,        tn.DOITUONG_ID, tn.THOIGIANTIEPNHAN, tn.BENHNHAN_ID, tn.TIEPNHAN_ID, tn.TRAITUYEN, tn.SOTIEPNHAN        , dv.DICHVU_ID, dv.NOITHUCHIEN_ID, isnull(dv.NGAYTAO, dv.NGAYCAPNHAT) as THOIGIANDKDICHVU        , dv.KHAN, dv.NOIYEUCAU_ID, dv.NGAYGIOYEUCAU, dv.BACSICHIDINH_ID, dv.DONVIGIOITHIEU_ID        , dv.NGUOIGIOITHIEU_ID, dv.TRANGTHAI_WFL, tn.NOIGIOITHIEU_ID        , dv.DVYEUCAU_ID, dv.MARIS, dv.TRANGTHAI as TRANGTHAICODE, B.TENNHOMDICHVU, dv.SOPHIEUYEUCAU, dv.KHAMBENH_NGOAITRU_ID, dv.NGUOICAPNHAT_ID, dv.NGAYCAPNHAT,        CASE        WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU        WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02'        ELSE Left(B.MANHOMDICHVU,2) END AS MANHOMDICHVU, B.MANHOMDICHVU as MANHOMDICHVUCHITIET, tn.TRANGTHAI as TRANGTHAI_TIEPNHAN,        'True' as DAKHAM,        vp.DATHANHTOAN, vp.DONGIA_DOANHTHU, BA.SOBENHAN, dv.CHANDOAN        , a.TENDICHVU, nth.TENPHONGBAN as TENPHONGKHAM, nyc.TENPHONGBAN as TENKHOACHIDINH        , bscd.TENNHANVIEN as TENBACSICHIDINH        , 0 as GUINGOAI        , 0 as VTYT        , 0 as CLSKETQUA_ID          ,             pt.PHAUTHUAT_ID, pt.NGAYTHUCHIEN , pt.THOIGIANKHOADULIEU, pt.NGUOIKHOA_ID            , pt.TENNGUOIKHOA as TENNGUOIDUYET, pt.SOPHIEUPHAUTHUAT, pt.THOIGIANBATDAU, pt.THOIGIANKETTHUC                   FROM TT_DVYEUCAU (NOLOCK) dv        inner join TT_TIEPNHAN (NOLOCK) tn on dv.TIEPNHAN_ID = tn.TIEPNHAN_ID        inner join TT_BENHNHAN (NOLOCK) bn on tn.BENHNHAN_ID = bn.BENHNHAN_ID        inner join TM_DICHVU A on A.DICHVU_ID = dv.DICHVU_ID        inner join TM_PHONGBAN nth on nth.PHONGBAN_ID = dv.NOITHUCHIEN_ID        left join TM_NHANVIEN bscd on bscd.NHANVIEN_ID = dv.BACSICHIDINH_ID        inner join TM_PHONGBAN nyc on nyc.PHONGBAN_ID = dv.NOIYEUCAU_ID        inner join TM_NHOMDICHVU B on B.NHOMDICHVU_ID = A.NHOMDICHVU_ID        inner join TT_VIENPHI (NOLOCK) VP on VP.TIEPNHAN_ID = tn.TIEPNHAN_ID and VP.DICHVU_ID = dv.DICHVU_ID and VP.REF_ID = dv.DVYEUCAU_ID        left join TT_NOITRU_BENHAN (NOLOCK) BA on BA.TIEPNHAN_ID = tn.TIEPNHAN_ID AND dv.BENHAN_ID = BA.BENHAN_ID        inner join TM_GENDER GD on GD.ID = bn.GIOITINH                       inner join TT_PHAUTHUAT_YEUCAU (NOLOCK) ptyc on ptyc.DVYEUCAU_ID = dv.DVYEUCAU_ID            inner join TT_PHAUTHUAT (NOLOCK) pt on pt.PHAUTHUAT_ID = ptyc.PHAUTHUAT_ID            left join TM_PHONGBAN pt_pb on pt_pb.PHONGBAN_ID = pt.PHONGBANTHUCHIEN_ID                   where        dv.DICHVU_ID IS NOT NULL        and tn.BENHVIEN_ID = 'HLU01'        and HUYYEUCAU = 0        and dv.NGAYHENCLS is NULL                       and dv.TRANGTHAI IN ('CHOXACNHAN','HOANTAT')           and           dv.NGAYYEUCAU >= '11/1/2019 12:00:00 AM'         and           dv.NGAYYEUCAU <= '2/26/2020 12:00:00 AM'         and           dv.NOITHUCHIEN_ID = 25         and           (bn.TENBENHNHAN like '%' +  @param0  + '%' or bn.MAYTE like '%' +  @param0  + '%')         and           (CASE          WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU          WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2)          END) in (05)         and           tn.TRANGTHAI IN ('DATIEPNHAN','NOITRU','CAPCUU', 'HOANTHANH')         and           (vp.DATHANHTOAN = '1'  or vp.DONGIA_DOANHTHU = '0' OR TN.SUDUNG_BHTN='1' OR TN.BAOLANH_VIENPHI='1'  OR tn.TRANGTHAI IN ('NOITRU','CAPCUU','NGOAITRU') or dv.HOPDONG_BENHNHAN_ID is not null or vp.BENHNHAN_PHAITHANHTOAN >= 0)                 ) data1) lst                    where          lst.ROWNUMBER between 1 and 20                 order by NGAYGIOYEUCAU asc]
2020-02-26 14:10:33,573 [1] DEBUG - Statement Id: [DAO00019_DanhSachPhauThuatThuThuat] Parameters: [@param0=[TENBENHNHAN,Trần Thị Tố]]
2020-02-26 14:10:33,573 [1] DEBUG - Statement Id: [DAO00019_DanhSachPhauThuatThuThuat] Types: [@param0=[String, System.String]]
2020-02-26 14:10:36,072 [1] DEBUG - Statement Id: [DAO00019_DanhSachPhauThuatThuThuat] PreparedStatement : [declare @TenBenhVien nvarchar(500)        declare @ManhomDSA varchar(10);        set @TenBenhVien = (select VALUE from TM_SYS_APPSETTINGS where CODE = 'APP_BENHVIEN_TEN')        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        select * from(        select ROW_NUMBER() OVER(order by NGAYGIOYEUCAU) as ROWNUMBER, *        from        (SELECT distinct        COUNT(*) OVER() as TOTALROWS,        N'Mã người bệnh: ' + bn.MAYTE + ' - ' + N'Tên người bệnh: ' + bn.TENBENHNHAN + ' - ' + N'Số bệnh án: ' + ISNULL(BA.SOBENHAN,'') + ' - ' + N'Sinh ngày: ' + isnull(Convert(varchar(10),bn.NGAYSINH,103),bn.NAMSINH) + ' - ' + N'Giới tính: ' + GD.DESCRIPTION as GROUPNAME,        bn.MAYTE, bn.TENBENHNHAN, bn.NAMSINH, bn.NGAYSINH as TUOI, ISNULL(CONVERT(VARCHAR(10), bn.NGAYSINH, 103),CAST(bn.NAMSINH AS varchar)) as NGAYSINH, bn.DIACHILIENLAC as DIACHI, bn.GIOITINH, GD.DESCRIPTION as TENGIOITINH,        tn.DOITUONG_ID, tn.THOIGIANTIEPNHAN, tn.BENHNHAN_ID, tn.TIEPNHAN_ID, tn.TRAITUYEN, tn.SOTIEPNHAN        , dv.DICHVU_ID, dv.NOITHUCHIEN_ID, isnull(dv.NGAYTAO, dv.NGAYCAPNHAT) as THOIGIANDKDICHVU        , dv.KHAN, dv.NOIYEUCAU_ID, dv.NGAYGIOYEUCAU, dv.BACSICHIDINH_ID, dv.DONVIGIOITHIEU_ID        , dv.NGUOIGIOITHIEU_ID, dv.TRANGTHAI_WFL, tn.NOIGIOITHIEU_ID        , dv.DVYEUCAU_ID, dv.MARIS, dv.TRANGTHAI as TRANGTHAICODE, B.TENNHOMDICHVU, dv.SOPHIEUYEUCAU, dv.KHAMBENH_NGOAITRU_ID, dv.NGUOICAPNHAT_ID, dv.NGAYCAPNHAT,        CASE        WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU        WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02'        ELSE Left(B.MANHOMDICHVU,2) END AS MANHOMDICHVU, B.MANHOMDICHVU as MANHOMDICHVUCHITIET, tn.TRANGTHAI as TRANGTHAI_TIEPNHAN,        'False' as DAKHAM,        vp.DATHANHTOAN, vp.DONGIA_DOANHTHU, BA.SOBENHAN, dv.CHANDOAN        , a.TENDICHVU, nth.TENPHONGBAN as TENPHONGKHAM, nyc.TENPHONGBAN as TENKHOACHIDINH        , bscd.TENNHANVIEN as TENBACSICHIDINH        , 0 as GUINGOAI        , 0 as VTYT        , 0 as CLSKETQUA_ID          ,             '' SOPHIEUPHAUTHUAT                   FROM TT_DVYEUCAU (NOLOCK) dv        inner join TT_TIEPNHAN (NOLOCK) tn on dv.TIEPNHAN_ID = tn.TIEPNHAN_ID        inner join TT_BENHNHAN (NOLOCK) bn on tn.BENHNHAN_ID = bn.BENHNHAN_ID        inner join TM_DICHVU A on A.DICHVU_ID = dv.DICHVU_ID        inner join TM_PHONGBAN nth on nth.PHONGBAN_ID = dv.NOITHUCHIEN_ID        left join TM_NHANVIEN bscd on bscd.NHANVIEN_ID = dv.BACSICHIDINH_ID        inner join TM_PHONGBAN nyc on nyc.PHONGBAN_ID = dv.NOIYEUCAU_ID        inner join TM_NHOMDICHVU B on B.NHOMDICHVU_ID = A.NHOMDICHVU_ID        inner join TT_VIENPHI (NOLOCK) VP on VP.TIEPNHAN_ID = tn.TIEPNHAN_ID and VP.DICHVU_ID = dv.DICHVU_ID and VP.REF_ID = dv.DVYEUCAU_ID        left join TT_NOITRU_BENHAN (NOLOCK) BA on BA.TIEPNHAN_ID = tn.TIEPNHAN_ID AND dv.BENHAN_ID = BA.BENHAN_ID        inner join TM_GENDER GD on GD.ID = bn.GIOITINH                 where        dv.DICHVU_ID IS NOT NULL        and tn.BENHVIEN_ID = 'HLU01'        and HUYYEUCAU = 0        and dv.NGAYHENCLS is NULL                       and dv.TRANGTHAI = 'CHUAKETQUA'           and           dv.NGAYYEUCAU >= '11/1/2019 12:00:00 AM'         and           dv.NGAYYEUCAU <= '2/26/2020 12:00:00 AM'         and           dv.NOITHUCHIEN_ID = 25         and           (bn.TENBENHNHAN like '%' +  @param0  + '%' or bn.MAYTE like '%' +  @param0  + '%')         and           (CASE          WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU          WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2)          END) in (05)         and           tn.TRANGTHAI IN ('DATIEPNHAN','NOITRU','CAPCUU', 'HOANTHANH')         and           (vp.DATHANHTOAN = '1'  or vp.DONGIA_DOANHTHU = '0' OR TN.SUDUNG_BHTN='1' OR TN.BAOLANH_VIENPHI='1'  OR tn.TRANGTHAI IN ('NOITRU','CAPCUU','NGOAITRU') or dv.HOPDONG_BENHNHAN_ID is not null or vp.BENHNHAN_PHAITHANHTOAN >= 0)                 ) data1) lst                    where          lst.ROWNUMBER between 1 and 20                 order by NGAYGIOYEUCAU asc]
2020-02-26 14:10:36,072 [1] DEBUG - Statement Id: [DAO00019_DanhSachPhauThuatThuThuat] Parameters: [@param0=[TENBENHNHAN,Trần Thị Tố]]
2020-02-26 14:10:36,072 [1] DEBUG - Statement Id: [DAO00019_DanhSachPhauThuatThuThuat] Types: [@param0=[String, System.String]]
2020-02-26 14:10:42,538 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_YEUCAU_GetList] PreparedStatement : [SELECT YC.[PHAUTHUAT_YEUCAU_ID]              ,YC.[PHAUTHUAT_ID]              ,YC.[DVYEUCAU_ID]              ,YC.[NHOMDICHVU_ID]              ,YC.[DICHVU_ID]              ,YC.[LOAIGIA_ID]              ,VP.[BHYT_THANHTIEN_CHITRA]              ,VP.[BENHNHAN_PHAITHANHTOAN]              ,VP.[THANHTIEN_DOANHTHU]              ,YC.[BENHVIEN_ID]              ,DVYC.NGAYGIOYEUCAU              ,DV.TENDICHVU              ,NDV.TENNHOMDICHVU              FROM [TT_PHAUTHUAT_YEUCAU] YC              INNER JOIN TT_VIENPHI VP ON YC.DVYEUCAU_ID= VP.REF_ID AND VP.REF_TABLE ='TT_DVYEUCAU'              INNER JOIN TT_DVYEUCAU DVYC ON DVYC.DVYEUCAU_ID = YC.DVYEUCAU_ID              INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = DVYC.DICHVU_ID              INNER JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID               where                             YC.PHAUTHUAT_ID = '68089'                       and                           YC.BENHVIEN_ID = 'HLU01'                                     order by PHAUTHUAT_YEUCAU_ID]
2020-02-26 14:10:42,599 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_PPVOCAM_GetDetail] PreparedStatement : [select *              from TT_PHAUTHUAT_PPVOCAM              where PHAUTHUAT_ID  = 68089]
2020-02-26 14:10:42,744 [1] DEBUG - Statement Id: [DAO00019_ThongTinBenhNhanTiepNhan] PreparedStatement : [select distinct A.SOTIEPNHAN, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        B.*, A.SOBHYT        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'        where                    A.TIEPNHAN_ID = '329'                 and A.BENHVIEN_ID = 'HLU01']
2020-02-26 14:10:42,832 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_GetList] PreparedStatement : [select *              from TT_PHAUTHUAT               where                             TT_PHAUTHUAT.LOAI = 'P'                       and                           TT_PHAUTHUAT.TIEPNHAN_ID = 329                       and                           TT_PHAUTHUAT.BENHVIEN_ID = 'HLU01'                                     order by PHAUTHUAT_ID DESC]
2020-02-26 14:10:42,902 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '329'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2020-02-26 14:10:42,977 [1] DEBUG - Statement Id: [DAO00048_GetBenhNhanByBenhNhanID] PreparedStatement : [SELECT *              FROM              TT_BENHNHAN               where                             BENHNHAN_ID = '326']
2020-02-26 14:10:43,002 [1] DEBUG - Statement Id: [DAO00000_GetDoiTuongIsBHYT] PreparedStatement : [select * from TM_DOITUONG Where DOITUONG_ID = 6 and MADOITUONG like '%BHYT%']
2020-02-26 14:10:43,235 [1] DEBUG - Statement Id: [DAO00048_GetDICHVUYCByTiepNhanID] PreparedStatement : [SELECT DISTINCT D.HOPDONG_ID, D.HOPDONG_BENHNHAN_ID, D.DVYEUCAU_ID, D.DICHVU_ID, D.SOPHIEUYEUCAU, D.NGAYGIOYEUCAU, D.NOITHUCHIEN_ID, P.LOAIPHAUTHUAT, L.STT AS STT_LOAIPHAUTHUAT            FROM            TT_DVYEUCAU AS D            left join TM_PHANLOAIPHAUTHUAT AS P ON D.DICHVU_ID = P.DICHVU_ID            left join TM_LOAIPHAUTHUAT AS L ON L.LOAIPHAUTHUAT = P.LOAIPHAUTHUAT            where            not exists (select DVYEUCAU_ID from TT_PHAUTHUAT_YEUCAU where D.DVYEUCAU_ID = DVYEUCAU_ID)               and                       exists                      (select DICHVU_ID from TM_DICHVU                      where D.DICHVU_ID = DICHVU_ID and                      exists                      (select NHOMDICHVU_ID from TM_NHOMDICHVU                      where TM_DICHVU.NHOMDICHVU_ID = NHOMDICHVU_ID and left(MANHOMDICHVU,2) in (05)                      )                                             )                     and                           D.TIEPNHAN_ID = '329']
2020-02-26 14:10:43,297 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '329'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2020-02-26 14:10:47,443 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_GetDetail] PreparedStatement : [select PT.*, TN.BENHNHAN_ID              from              TT_PHAUTHUAT PT, TT_TIEPNHAN TN              where              PT.TIEPNHAN_ID = TN.TIEPNHAN_ID              AND PHAUTHUAT_ID  = 68089]
2020-02-26 14:10:47,527 [1] DEBUG - Statement Id: [DAO00048_CheckDVPhauThuatBHYT] PreparedStatement : [select count(0) from TT_VIENPHI          where REF_TABLE = 'TT_DVYEUCAU' and REF_ID = (select top 1 DVYEUCAU_ID from TT_PHAUTHUAT_YEUCAU where PHAUTHUAT_ID =  @param0 )          and TIEPNHAN_ID =  @param1  and BHYT_DONGIA > 0]
2020-02-26 14:10:47,527 [1] DEBUG - Statement Id: [DAO00048_CheckDVPhauThuatBHYT] Parameters: [@param0=[PHAUTHUAT_ID,68089], @param1=[TIEPNHAN_ID,329]]
2020-02-26 14:10:47,527 [1] DEBUG - Statement Id: [DAO00048_CheckDVPhauThuatBHYT] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64]]
2020-02-26 14:10:47,575 [1] DEBUG - Statement Id: [DAO00116_File_GetList] PreparedStatement : [select *              from TT_FILE_DINHKEM               where                             TT_FILE_DINHKEM.REF_TABLE = 'TT_PHAUTHUAT'                       and                           TT_FILE_DINHKEM.REF_ID = '68089'                       and                           TT_FILE_DINHKEM.BENHVIEN_ID = 'HLU01'                                     order by FILE_ID]
2020-02-26 14:10:47,620 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_YEUCAU_GetList] PreparedStatement : [SELECT YC.[PHAUTHUAT_YEUCAU_ID]              ,YC.[PHAUTHUAT_ID]              ,YC.[DVYEUCAU_ID]              ,YC.[NHOMDICHVU_ID]              ,YC.[DICHVU_ID]              ,YC.[LOAIGIA_ID]              ,VP.[BHYT_THANHTIEN_CHITRA]              ,VP.[BENHNHAN_PHAITHANHTOAN]              ,VP.[THANHTIEN_DOANHTHU]              ,YC.[BENHVIEN_ID]              ,DVYC.NGAYGIOYEUCAU              ,DV.TENDICHVU              ,NDV.TENNHOMDICHVU              FROM [TT_PHAUTHUAT_YEUCAU] YC              INNER JOIN TT_VIENPHI VP ON YC.DVYEUCAU_ID= VP.REF_ID AND VP.REF_TABLE ='TT_DVYEUCAU'              INNER JOIN TT_DVYEUCAU DVYC ON DVYC.DVYEUCAU_ID = YC.DVYEUCAU_ID              INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = DVYC.DICHVU_ID              INNER JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID               where                             YC.PHAUTHUAT_ID = '68089'                       and                           YC.BENHVIEN_ID = 'HLU01'                                     order by PHAUTHUAT_YEUCAU_ID]
2020-02-26 14:10:47,691 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_PPVOCAM_GetDetail] PreparedStatement : [select *              from TT_PHAUTHUAT_PPVOCAM              where PHAUTHUAT_ID  = 68089]
2020-02-26 14:10:47,834 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_GetDetail] PreparedStatement : [select PT.*, TN.BENHNHAN_ID              from              TT_PHAUTHUAT PT, TT_TIEPNHAN TN              where              PT.TIEPNHAN_ID = TN.TIEPNHAN_ID              AND PHAUTHUAT_ID  = 68089]
2020-02-26 14:10:47,861 [1] DEBUG - Statement Id: [DAO00048_CheckDVPhauThuatBHYT] PreparedStatement : [select count(0) from TT_VIENPHI          where REF_TABLE = 'TT_DVYEUCAU' and REF_ID = (select top 1 DVYEUCAU_ID from TT_PHAUTHUAT_YEUCAU where PHAUTHUAT_ID =  @param0 )          and TIEPNHAN_ID =  @param1  and BHYT_DONGIA > 0]
2020-02-26 14:10:47,862 [1] DEBUG - Statement Id: [DAO00048_CheckDVPhauThuatBHYT] Parameters: [@param0=[PHAUTHUAT_ID,68089], @param1=[TIEPNHAN_ID,329]]
2020-02-26 14:10:47,862 [1] DEBUG - Statement Id: [DAO00048_CheckDVPhauThuatBHYT] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64]]
2020-02-26 14:10:47,904 [1] DEBUG - Statement Id: [DAO00116_File_GetList] PreparedStatement : [select *              from TT_FILE_DINHKEM               where                             TT_FILE_DINHKEM.REF_TABLE = 'TT_PHAUTHUAT'                       and                           TT_FILE_DINHKEM.REF_ID = '68089'                       and                           TT_FILE_DINHKEM.BENHVIEN_ID = 'HLU01'                                     order by FILE_ID]
2020-02-26 14:10:47,951 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_YEUCAU_GetList] PreparedStatement : [SELECT YC.[PHAUTHUAT_YEUCAU_ID]              ,YC.[PHAUTHUAT_ID]              ,YC.[DVYEUCAU_ID]              ,YC.[NHOMDICHVU_ID]              ,YC.[DICHVU_ID]              ,YC.[LOAIGIA_ID]              ,VP.[BHYT_THANHTIEN_CHITRA]              ,VP.[BENHNHAN_PHAITHANHTOAN]              ,VP.[THANHTIEN_DOANHTHU]              ,YC.[BENHVIEN_ID]              ,DVYC.NGAYGIOYEUCAU              ,DV.TENDICHVU              ,NDV.TENNHOMDICHVU              FROM [TT_PHAUTHUAT_YEUCAU] YC              INNER JOIN TT_VIENPHI VP ON YC.DVYEUCAU_ID= VP.REF_ID AND VP.REF_TABLE ='TT_DVYEUCAU'              INNER JOIN TT_DVYEUCAU DVYC ON DVYC.DVYEUCAU_ID = YC.DVYEUCAU_ID              INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = DVYC.DICHVU_ID              INNER JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID               where                             YC.PHAUTHUAT_ID = '68089'                       and                           YC.BENHVIEN_ID = 'HLU01'                                     order by PHAUTHUAT_YEUCAU_ID]
2020-02-26 14:10:48,051 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_PPVOCAM_GetDetail] PreparedStatement : [select *              from TT_PHAUTHUAT_PPVOCAM              where PHAUTHUAT_ID  = 68089]
2020-02-26 14:10:52,257 [1] DEBUG - Statement Id: [DAO00051_GetMauTuongTrinh] PreparedStatement : [select *            from TM_TUDIENKETQUA            where BENHVIEN_ID = 'HLU01'              and                 (NGUOITAO_ID = '1' OR SUDUNGCHUNG = '1')                and DICHVU_ID in  (                        @param0                   )               ORDER BY TENNOIDUNG]
2020-02-26 14:10:52,257 [1] DEBUG - Statement Id: [DAO00051_GetMauTuongTrinh] Parameters: [@param0=[LSTDICHVU_ID[0],5121]]
2020-02-26 14:10:52,257 [1] DEBUG - Statement Id: [DAO00051_GetMauTuongTrinh] Types: [@param0=[Int64, System.Int64]]
2020-02-26 14:10:52,298 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_GetDetail] PreparedStatement : [select PT.*, TN.BENHNHAN_ID              from              TT_PHAUTHUAT PT, TT_TIEPNHAN TN              where              PT.TIEPNHAN_ID = TN.TIEPNHAN_ID              AND PHAUTHUAT_ID  = 68089]
2020-02-26 14:10:52,344 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_IMAGES_GetList] PreparedStatement : [select *              from TT_PHAUTHUAT_IMAGES               where                             TT_PHAUTHUAT_IMAGES.PHAUTHUAT_ID = '68089'                       and                           TT_PHAUTHUAT_IMAGES.BENHVIEN_ID = 'HLU01'                                     order by IMAGES_ID]
2020-02-26 14:11:11,827 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '329'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2020-02-26 14:11:11,904 [1] DEBUG - Statement Id: [DAO00014_GetInPatientStatus] PreparedStatement : [select TRANGTHAI, isnull(KHOACHUYENDEN_ID, KHOAVAO_ID) as KHOAHIENTAI from TT_NOITRU_BENHAN        where        TIEPNHAN_ID = '329'        and BENHVIEN_ID = 'HLU01'         and           BENHAN_ID = '40']
2020-02-26 14:11:11,979 [1] DEBUG - Statement Id: [DAO00014_GetORMServiceStatus] PreparedStatement : [select dvyc.TRANGTHAI, pt.NGUOIKHOA_ID, pt.NGUOITAO_ID        from TT_PHAUTHUAT pt        left join TT_PHAUTHUAT_YEUCAU ptyc on ptyc.PHAUTHUAT_ID = pt.PHAUTHUAT_ID        left join (select * from TT_DVYEUCAU where exists (select DVYEUCAU_ID from TT_PHAUTHUAT where TT_DVYEUCAU.DVYEUCAU_ID = DVYEUCAU_ID and PHAUTHUAT_ID = '68089')) dvyc        on ptyc.DVYEUCAU_ID = dvyc.DVYEUCAU_ID        where pt.PHAUTHUAT_ID = '68089']
2020-02-26 14:11:15,004 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_EKIP_GetDetail] PreparedStatement : [select *              from TT_PHAUTHUAT_EKIP              where PHAUTHUAT_ID  = 68089]
2020-02-26 14:11:16,578 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '329'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2020-02-26 14:11:16,652 [1] DEBUG - Statement Id: [DAO00014_GetInPatientStatus] PreparedStatement : [select TRANGTHAI, isnull(KHOACHUYENDEN_ID, KHOAVAO_ID) as KHOAHIENTAI from TT_NOITRU_BENHAN        where        TIEPNHAN_ID = '329'        and BENHVIEN_ID = 'HLU01'         and           BENHAN_ID = '40']
2020-02-26 14:11:16,725 [1] DEBUG - Statement Id: [DAO00014_GetORMServiceStatus] PreparedStatement : [select dvyc.TRANGTHAI, pt.NGUOIKHOA_ID, pt.NGUOITAO_ID        from TT_PHAUTHUAT pt        left join TT_PHAUTHUAT_YEUCAU ptyc on ptyc.PHAUTHUAT_ID = pt.PHAUTHUAT_ID        left join (select * from TT_DVYEUCAU where exists (select DVYEUCAU_ID from TT_PHAUTHUAT where TT_DVYEUCAU.DVYEUCAU_ID = DVYEUCAU_ID and PHAUTHUAT_ID = '68089')) dvyc        on ptyc.DVYEUCAU_ID = dvyc.DVYEUCAU_ID        where pt.PHAUTHUAT_ID = '68089']
2020-02-26 14:11:16,810 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '329'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2020-02-26 14:11:16,886 [1] DEBUG - Statement Id: [DAO00014_GetInPatientStatus] PreparedStatement : [select TRANGTHAI, isnull(KHOACHUYENDEN_ID, KHOAVAO_ID) as KHOAHIENTAI from TT_NOITRU_BENHAN        where        TIEPNHAN_ID = '329'        and BENHVIEN_ID = 'HLU01'         and           BENHAN_ID = '40']
2020-02-26 14:11:18,668 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_Update] PreparedStatement : [update TT_PHAUTHUAT set              SOPHIEUPHAUTHUAT =  @param0               , LOAI =  @param1               , BENHAN_ID =  @param2               , LUUTRU_ID =  @param3               , TIEPNHAN_ID =  @param4               , PHONGBANTHUCHIEN_ID =  @param5               , NGAYTHUCHIEN =  @param6               , THOIGIANBATDAU =  @param7               , THOIGIANKETTHUC =  @param8               , ICD_VAOKHOA =  @param9               , ICD_VAOKHOA_MOTA =  @param10               , ICD_TRUOCPHAUTHUAT =  @param11               , ICD_TRUOCPHAUTHUAT_MOTA =  @param12               , ICD_SAUPHAUTHUAT =  @param13               , ICD_SAUPHAUTHUAT_MOTA =  @param14               , NHOMDICHVU_ID =  @param15               , DICHVU_ID =  @param16               , PHUONGPHAPVOCAM_ID =  @param17               , TAIBIEN_ID =  @param18               , CHEDO_ID =  @param19               , TUVONG_ID =  @param20               , TRINHTUTHUCHIEN =  @param21               , MOTA =  @param22               , KETQUA =  @param23               , BENHNHANBENNGOAI =  @param24               , NGUONBENH_ID =  @param25               , LOAIPHAUTHUAT =  @param26               , DANLUU =  @param27               , NGAYRUT =  @param28               , NGAYCATCHI =  @param29               , KHAC =  @param30               , SOLANMOLAI =  @param31               , LYDOMOLAI =  @param32               , CANTHIEPPHAUTHUAT =  @param33               , TUDIENKETQUA_ID =  @param34               , PHONGBANCHIDINH_ID =  @param35               , PPMO_ID =  @param36               , THOIGIANGAYME =  @param37               , KHOADULIEU =  @param38               , NGUOIKHOA_ID =  @param39               , TENNGUOIKHOA =  @param40               , NGAYKHOADULIEU =  @param41               , THOIGIANKHOADULIEU =  @param42                            , NGAYCAPNHAT =  @param43             , NGUOICAPNHAT_ID =  @param44             , BENHVIEN_ID =  @param45              ,               PHUONGPHAPPTTT =  @param46                          , TRINHTUTHUCHIEN_TEXT =  @param47             where            PHAUTHUAT_ID = 68089]
2020-02-26 14:11:18,668 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_Update] Parameters: [@param0=[SOPHIEUPHAUTHUAT,20.P.00987], @param1=[LOAI,P], @param2=[BENHAN_ID,40], @param3=[LUUTRU_ID,null], @param4=[TIEPNHAN_ID,329], @param5=[PHONGBANTHUCHIEN_ID,25], @param6=[NGAYTHUCHIEN,2/26/2020 2:11:18 PM], @param7=[THOIGIANBATDAU,2/26/2020 2:07:00 PM], @param8=[THOIGIANKETTHUC,2/26/2020 2:30:00 PM], @param9=[ICD_VAOKHOA,J20], @param10=[ICD_VAOKHOA_MOTA,Viêm phế quản cấp], @param11=[ICD_TRUOCPHAUTHUAT,J20], @param12=[ICD_TRUOCPHAUTHUAT_MOTA,Viêm phế quản cấp], @param13=[ICD_SAUPHAUTHUAT,J20], @param14=[ICD_SAUPHAUTHUAT_MOTA,Viêm phế quản cấp], @param15=[NHOMDICHVU_ID,null], @param16=[DICHVU_ID,null], @param17=[PHUONGPHAPVOCAM_ID,null], @param18=[TAIBIEN_ID,null], @param19=[CHEDO_ID,5190], @param20=[TUVONG_ID,null], @param21=[TRINHTUTHUCHIEN,<body>
	<div style="text-align:left;text-indent:0pt;margin:0pt 0pt 0pt 0pt;"><span style="color:#000000;background-color:transparent;font-family:Times New Roman;font-size:12pt;font-weight:normal;font-style:normal;">test 1</span></div><div style="text-align:left;text-indent:0pt;margin:0pt 0pt 0pt 0pt;"><span style="color:#000000;background-color:transparent;font-family:Times New Roman;font-size:12pt;font-weight:normal;font-style:normal;">test 2</span></div><div style="text-align:left;text-indent:0pt;margin:0pt 0pt 0pt 0pt;"><span style="color:#000000;background-color:transparent;font-family:Times New Roman;font-size:12pt;font-weight:normal;font-style:normal;">- test 3</span></div><div style="text-align:left;text-indent:0pt;margin:0pt 0pt 0pt 0pt;"><span style="color:#000000;background-color:transparent;font-family:Times New Roman;font-size:12pt;font-weight:normal;font-style:normal;">test 4</span></div><div style="text-align:left;text-indent:0pt;margin:0pt 0pt 0pt 0pt;"><span style="color:#000000;background-color:transparent;font-family:Times New Roman;font-size:12pt;font-weight:normal;font-style:normal;">test th&ecirc;m tại sao kh&ocirc;ng lưu được</span></div></body>
], @param22=[MOTA,test], @param23=[KETQUA,null], @param24=[BENHNHANBENNGOAI,null], @param25=[NGUONBENH_ID,745], @param26=[LOAIPHAUTHUAT,PTH], @param27=[DANLUU,null], @param28=[NGAYRUT,null], @param29=[NGAYCATCHI,null], @param30=[KHAC,null], @param31=[SOLANMOLAI,null], @param32=[LYDOMOLAI,null], @param33=[CANTHIEPPHAUTHUAT,null], @param34=[TUDIENKETQUA_ID,2515], @param35=[PHONGBANCHIDINH_ID,null], @param36=[PPMO_ID,null], @param37=[THOIGIANGAYME,null], @param38=[KHOADULIEU,0], @param39=[NGUOIKHOA_ID,null], @param40=[TENNGUOIKHOA,null], @param41=[NGAYKHOADULIEU,null], @param42=[THOIGIANKHOADULIEU,null], @param43=[NGAYCAPNHAT,2/26/2020 2:11:18 PM], @param44=[NGUOICAPNHAT_ID,1], @param45=[BENHVIEN_ID,HLU01], @param46=[PHUONGPHAPPTTT,null], @param47=[TRINHTUTHUCHIEN_TEXT,test 1
test 2
- test 3
test 4
test thêm tại sao không lưu được]]
2020-02-26 14:11:18,668 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_Update] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int64, System.Int64], @param5=[Int64, System.Int64], @param6=[DateTime, System.DateTime], @param7=[DateTime, System.DateTime], @param8=[DateTime, System.DateTime], @param9=[String, System.String], @param10=[String, System.String], @param11=[String, System.String], @param12=[String, System.String], @param13=[String, System.String], @param14=[String, System.String], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[Int64, System.Int64], @param20=[System.DBNull, null], @param21=[String, System.String], @param22=[String, System.String], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[Int64, System.Int64], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[Int64, System.Int64], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[System.DBNull, null], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[DateTime, System.DateTime], @param44=[Int64, System.Int64], @param45=[String, System.String], @param46=[System.DBNull, null], @param47=[String, System.String]]
2020-02-26 14:11:18,737 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_YEUCAU_DeleteP] PreparedStatement : [delete from TT_PHAUTHUAT_YEUCAU             where                     TT_PHAUTHUAT_YEUCAU.PHAUTHUAT_ID = '68089']
2020-02-26 14:11:18,821 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_PPVOCAM_DeleteP] PreparedStatement : [delete from TT_PHAUTHUAT_PPVOCAM              where PHAUTHUAT_ID = '68089']
2020-02-26 14:11:18,849 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_YEUCAU_Add] PreparedStatement : [insert into TT_PHAUTHUAT_YEUCAU (              PHAUTHUAT_ID              , DVYEUCAU_ID              , NHOMDICHVU_ID              , DICHVU_ID              , LOAIGIA_ID              , THANHTIEN_DOANHTHU              , BHYT_THANHTIEN_CHITRA              , BENHNHAN_PHAITHANHTOAN              , BENHVIEN_ID              ) values (               @param0               ,  @param1               ,  @param2               ,  @param3               ,  @param4               ,  @param5               ,  @param6               ,  @param7               ,  @param8               )]
2020-02-26 14:11:18,849 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_YEUCAU_Add] Parameters: [@param0=[PHAUTHUAT_ID,68089], @param1=[DVYEUCAU_ID,22759], @param2=[NHOMDICHVU_ID,26], @param3=[DICHVU_ID,5121], @param4=[LOAIGIA_ID,1], @param5=[THANHTIEN_DOANHTHU,4000000], @param6=[BHYT_THANHTIEN_CHITRA,2534000], @param7=[BENHNHAN_PHAITHANHTOAN,1466000], @param8=[BENHVIEN_ID,HLU01]]
2020-02-26 14:11:18,849 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_YEUCAU_Add] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64], @param2=[Int64, System.Int64], @param3=[Int64, System.Int64], @param4=[Int64, System.Int64], @param5=[Double, System.Double], @param6=[Double, System.Double], @param7=[Double, System.Double], @param8=[String, System.String]]
2020-02-26 14:11:18,876 [1] DEBUG - Statement Id: [DAO00048_UpdateDVYeuCauVienPhi] PreparedStatement : [update  TT_VIENPHI              set DATHUCHIEN = '1',              NGUOICAPNHAT_ID =  @param0 ,              NGAYCAPNHAT =  @param1               where              VIENPHI_ID =  @param2]
2020-02-26 14:11:18,876 [1] DEBUG - Statement Id: [DAO00048_UpdateDVYeuCauVienPhi] Parameters: [@param0=[NGUOICAPNHAT_ID,1], @param1=[NGAYCAPNHAT,2/26/2020 2:11:18 PM], @param2=[VIENPHI_ID,0]]
2020-02-26 14:11:18,876 [1] DEBUG - Statement Id: [DAO00048_UpdateDVYeuCauVienPhi] Types: [@param0=[Int64, System.Int64], @param1=[DateTime, System.DateTime], @param2=[Int64, System.Int64]]
2020-02-26 14:11:18,903 [1] DEBUG - Statement Id: [DAO00048_UpdateDVYeuCau] PreparedStatement : [update  TT_DVYEUCAU              set TRANGTHAI =  @param0 ,              NGUOICAPNHAT_ID =  @param1 ,              NGAYCAPNHAT =  @param2               where              DVYEUCAU_ID =  @param3]
2020-02-26 14:11:18,903 [1] DEBUG - Statement Id: [DAO00048_UpdateDVYeuCau] Parameters: [@param0=[TRANGTHAI,CHOXACNHAN], @param1=[NGUOICAPNHAT_ID,1], @param2=[NGAYCAPNHAT,2/26/2020 2:11:18 PM], @param3=[DVYEUCAU_ID,22759]]
2020-02-26 14:11:18,903 [1] DEBUG - Statement Id: [DAO00048_UpdateDVYeuCau] Types: [@param0=[String, System.String], @param1=[Int64, System.Int64], @param2=[DateTime, System.DateTime], @param3=[Int64, System.Int64]]
2020-02-26 14:11:18,928 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_PPVOCAM_Add] PreparedStatement : [insert into TT_PHAUTHUAT_PPVOCAM (              PHAUTHUAT_ID,              PPVOCAM_ID,              BENHVIEN_ID)              values (               @param0 ,               @param1 ,               @param2 )]
2020-02-26 14:11:18,928 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_PPVOCAM_Add] Parameters: [@param0=[PHAUTHUAT_ID,68089], @param1=[PPVOCAM_ID,516], @param2=[BENHVIEN_ID,HLU01]]
2020-02-26 14:11:18,928 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_PPVOCAM_Add] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64], @param2=[String, System.String]]
2020-02-26 14:11:18,953 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_EKIP_DeleteP] PreparedStatement : [delete from TT_PHAUTHUAT_EKIP               where                             TT_PHAUTHUAT_EKIP.PHAUTHUAT_ID = '68089']
2020-02-26 14:11:19,263 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_EKIP_Add] PreparedStatement : [insert into TT_PHAUTHUAT_EKIP (              PHAUTHUAT_ID                ,                       NHANVIEN_ID                   ,                       VAITRO_ID                                 , PTVC_ID              , PPT1_ID              , PPT2_ID              , GMC_ID              , GMP_ID              , DCVT_ID              , DCVN_ID              , BSHC_ID              , BSTC_ID              , BENHVIEN_ID              ) values (               @param0                 ,                        @param1                    ,                        @param2                                  ,  @param3               ,  @param4               ,  @param5               ,  @param6               ,  @param7               ,  @param8               ,  @param9               ,  @param10               ,  @param11               ,  @param12               )]
2020-02-26 14:11:19,263 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_EKIP_Add] Parameters: [@param0=[PHAUTHUAT_ID,68089], @param1=[NHANVIEN_ID,34], @param2=[VAITRO_ID,748], @param3=[PTVC_ID,null], @param4=[PPT1_ID,null], @param5=[PPT2_ID,null], @param6=[GMC_ID,null], @param7=[GMP_ID,null], @param8=[DCVT_ID,null], @param9=[DCVN_ID,null], @param10=[BSHC_ID,null], @param11=[BSTC_ID,null], @param12=[BENHVIEN_ID,HLU01]]
2020-02-26 14:11:19,263 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_EKIP_Add] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[System.DBNull, null], @param5=[System.DBNull, null], @param6=[System.DBNull, null], @param7=[System.DBNull, null], @param8=[System.DBNull, null], @param9=[System.DBNull, null], @param10=[System.DBNull, null], @param11=[System.DBNull, null], @param12=[String, System.String]]
2020-02-26 14:11:19,332 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_GetDetail] PreparedStatement : [select PT.*, TN.BENHNHAN_ID              from              TT_PHAUTHUAT PT, TT_TIEPNHAN TN              where              PT.TIEPNHAN_ID = TN.TIEPNHAN_ID              AND PHAUTHUAT_ID  = 68089]
2020-02-26 14:11:19,362 [1] DEBUG - Statement Id: [DAO00048_CheckDVPhauThuatBHYT] PreparedStatement : [select count(0) from TT_VIENPHI          where REF_TABLE = 'TT_DVYEUCAU' and REF_ID = (select top 1 DVYEUCAU_ID from TT_PHAUTHUAT_YEUCAU where PHAUTHUAT_ID =  @param0 )          and TIEPNHAN_ID =  @param1  and BHYT_DONGIA > 0]
2020-02-26 14:11:19,362 [1] DEBUG - Statement Id: [DAO00048_CheckDVPhauThuatBHYT] Parameters: [@param0=[PHAUTHUAT_ID,68089], @param1=[TIEPNHAN_ID,329]]
2020-02-26 14:11:19,362 [1] DEBUG - Statement Id: [DAO00048_CheckDVPhauThuatBHYT] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64]]
2020-02-26 14:11:19,400 [1] DEBUG - Statement Id: [DAO00116_File_GetList] PreparedStatement : [select *              from TT_FILE_DINHKEM               where                             TT_FILE_DINHKEM.REF_TABLE = 'TT_PHAUTHUAT'                       and                           TT_FILE_DINHKEM.REF_ID = '68089'                       and                           TT_FILE_DINHKEM.BENHVIEN_ID = 'HLU01'                                     order by FILE_ID]
2020-02-26 14:11:19,481 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_EKIP_GetDetail] PreparedStatement : [select *              from TT_PHAUTHUAT_EKIP              where PHAUTHUAT_ID  = 68089]
2020-02-26 14:11:50,350 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_YEUCAU_GetList] PreparedStatement : [SELECT YC.[PHAUTHUAT_YEUCAU_ID]              ,YC.[PHAUTHUAT_ID]              ,YC.[DVYEUCAU_ID]              ,YC.[NHOMDICHVU_ID]              ,YC.[DICHVU_ID]              ,YC.[LOAIGIA_ID]              ,VP.[BHYT_THANHTIEN_CHITRA]              ,VP.[BENHNHAN_PHAITHANHTOAN]              ,VP.[THANHTIEN_DOANHTHU]              ,YC.[BENHVIEN_ID]              ,DVYC.NGAYGIOYEUCAU              ,DV.TENDICHVU              ,NDV.TENNHOMDICHVU              FROM [TT_PHAUTHUAT_YEUCAU] YC              INNER JOIN TT_VIENPHI VP ON YC.DVYEUCAU_ID= VP.REF_ID AND VP.REF_TABLE ='TT_DVYEUCAU'              INNER JOIN TT_DVYEUCAU DVYC ON DVYC.DVYEUCAU_ID = YC.DVYEUCAU_ID              INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = DVYC.DICHVU_ID              INNER JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID               where                             YC.PHAUTHUAT_ID = '68089'                       and                           YC.BENHVIEN_ID = 'HLU01'                                     order by PHAUTHUAT_YEUCAU_ID]
2020-02-26 14:11:50,388 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_PPVOCAM_GetDetail] PreparedStatement : [select *              from TT_PHAUTHUAT_PPVOCAM              where PHAUTHUAT_ID  = 68089]
2020-02-26 14:11:50,478 [1] DEBUG - Statement Id: [DAO00019_ThongTinBenhNhanTiepNhan] PreparedStatement : [select distinct A.SOTIEPNHAN, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        B.*, A.SOBHYT        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'        where                    A.TIEPNHAN_ID = '329'                 and A.BENHVIEN_ID = 'HLU01']
2020-02-26 14:11:50,673 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_GetList] PreparedStatement : [select *              from TT_PHAUTHUAT               where                             TT_PHAUTHUAT.LOAI = 'P'                       and                           TT_PHAUTHUAT.TIEPNHAN_ID = 329                       and                           TT_PHAUTHUAT.BENHVIEN_ID = 'HLU01'                                     order by PHAUTHUAT_ID DESC]
2020-02-26 14:11:50,739 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '329'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2020-02-26 14:11:50,812 [1] DEBUG - Statement Id: [DAO00048_GetBenhNhanByBenhNhanID] PreparedStatement : [SELECT *              FROM              TT_BENHNHAN               where                             BENHNHAN_ID = '326']
2020-02-26 14:11:50,836 [1] DEBUG - Statement Id: [DAO00000_GetDoiTuongIsBHYT] PreparedStatement : [select * from TM_DOITUONG Where DOITUONG_ID = 6 and MADOITUONG like '%BHYT%']
2020-02-26 14:11:51,223 [1] DEBUG - Statement Id: [DAO00048_GetDICHVUYCByTiepNhanID] PreparedStatement : [SELECT DISTINCT D.HOPDONG_ID, D.HOPDONG_BENHNHAN_ID, D.DVYEUCAU_ID, D.DICHVU_ID, D.SOPHIEUYEUCAU, D.NGAYGIOYEUCAU, D.NOITHUCHIEN_ID, P.LOAIPHAUTHUAT, L.STT AS STT_LOAIPHAUTHUAT            FROM            TT_DVYEUCAU AS D            left join TM_PHANLOAIPHAUTHUAT AS P ON D.DICHVU_ID = P.DICHVU_ID            left join TM_LOAIPHAUTHUAT AS L ON L.LOAIPHAUTHUAT = P.LOAIPHAUTHUAT            where            not exists (select DVYEUCAU_ID from TT_PHAUTHUAT_YEUCAU where D.DVYEUCAU_ID = DVYEUCAU_ID)               and                       exists                      (select DICHVU_ID from TM_DICHVU                      where D.DICHVU_ID = DICHVU_ID and                      exists                      (select NHOMDICHVU_ID from TM_NHOMDICHVU                      where TM_DICHVU.NHOMDICHVU_ID = NHOMDICHVU_ID and left(MANHOMDICHVU,2) in (05)                      )                                             )                     and                           D.TIEPNHAN_ID = '329']
2020-02-26 14:11:51,277 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '329'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2020-02-26 14:11:54,336 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_GetDetail] PreparedStatement : [select PT.*, TN.BENHNHAN_ID              from              TT_PHAUTHUAT PT, TT_TIEPNHAN TN              where              PT.TIEPNHAN_ID = TN.TIEPNHAN_ID              AND PHAUTHUAT_ID  = 68089]
2020-02-26 14:11:54,425 [1] DEBUG - Statement Id: [DAO00048_CheckDVPhauThuatBHYT] PreparedStatement : [select count(0) from TT_VIENPHI          where REF_TABLE = 'TT_DVYEUCAU' and REF_ID = (select top 1 DVYEUCAU_ID from TT_PHAUTHUAT_YEUCAU where PHAUTHUAT_ID =  @param0 )          and TIEPNHAN_ID =  @param1  and BHYT_DONGIA > 0]
2020-02-26 14:11:54,425 [1] DEBUG - Statement Id: [DAO00048_CheckDVPhauThuatBHYT] Parameters: [@param0=[PHAUTHUAT_ID,68089], @param1=[TIEPNHAN_ID,329]]
2020-02-26 14:11:54,425 [1] DEBUG - Statement Id: [DAO00048_CheckDVPhauThuatBHYT] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64]]
2020-02-26 14:11:54,460 [1] DEBUG - Statement Id: [DAO00116_File_GetList] PreparedStatement : [select *              from TT_FILE_DINHKEM               where                             TT_FILE_DINHKEM.REF_TABLE = 'TT_PHAUTHUAT'                       and                           TT_FILE_DINHKEM.REF_ID = '68089'                       and                           TT_FILE_DINHKEM.BENHVIEN_ID = 'HLU01'                                     order by FILE_ID]
2020-02-26 14:11:54,508 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_YEUCAU_GetList] PreparedStatement : [SELECT YC.[PHAUTHUAT_YEUCAU_ID]              ,YC.[PHAUTHUAT_ID]              ,YC.[DVYEUCAU_ID]              ,YC.[NHOMDICHVU_ID]              ,YC.[DICHVU_ID]              ,YC.[LOAIGIA_ID]              ,VP.[BHYT_THANHTIEN_CHITRA]              ,VP.[BENHNHAN_PHAITHANHTOAN]              ,VP.[THANHTIEN_DOANHTHU]              ,YC.[BENHVIEN_ID]              ,DVYC.NGAYGIOYEUCAU              ,DV.TENDICHVU              ,NDV.TENNHOMDICHVU              FROM [TT_PHAUTHUAT_YEUCAU] YC              INNER JOIN TT_VIENPHI VP ON YC.DVYEUCAU_ID= VP.REF_ID AND VP.REF_TABLE ='TT_DVYEUCAU'              INNER JOIN TT_DVYEUCAU DVYC ON DVYC.DVYEUCAU_ID = YC.DVYEUCAU_ID              INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = DVYC.DICHVU_ID              INNER JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID               where                             YC.PHAUTHUAT_ID = '68089'                       and                           YC.BENHVIEN_ID = 'HLU01'                                     order by PHAUTHUAT_YEUCAU_ID]
2020-02-26 14:11:54,542 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_PPVOCAM_GetDetail] PreparedStatement : [select *              from TT_PHAUTHUAT_PPVOCAM              where PHAUTHUAT_ID  = 68089]
2020-02-26 14:11:54,631 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_GetDetail] PreparedStatement : [select PT.*, TN.BENHNHAN_ID              from              TT_PHAUTHUAT PT, TT_TIEPNHAN TN              where              PT.TIEPNHAN_ID = TN.TIEPNHAN_ID              AND PHAUTHUAT_ID  = 68089]
2020-02-26 14:11:54,658 [1] DEBUG - Statement Id: [DAO00048_CheckDVPhauThuatBHYT] PreparedStatement : [select count(0) from TT_VIENPHI          where REF_TABLE = 'TT_DVYEUCAU' and REF_ID = (select top 1 DVYEUCAU_ID from TT_PHAUTHUAT_YEUCAU where PHAUTHUAT_ID =  @param0 )          and TIEPNHAN_ID =  @param1  and BHYT_DONGIA > 0]
2020-02-26 14:11:54,658 [1] DEBUG - Statement Id: [DAO00048_CheckDVPhauThuatBHYT] Parameters: [@param0=[PHAUTHUAT_ID,68089], @param1=[TIEPNHAN_ID,329]]
2020-02-26 14:11:54,658 [1] DEBUG - Statement Id: [DAO00048_CheckDVPhauThuatBHYT] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64]]
2020-02-26 14:11:54,695 [1] DEBUG - Statement Id: [DAO00116_File_GetList] PreparedStatement : [select *              from TT_FILE_DINHKEM               where                             TT_FILE_DINHKEM.REF_TABLE = 'TT_PHAUTHUAT'                       and                           TT_FILE_DINHKEM.REF_ID = '68089'                       and                           TT_FILE_DINHKEM.BENHVIEN_ID = 'HLU01'                                     order by FILE_ID]
2020-02-26 14:11:54,745 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_YEUCAU_GetList] PreparedStatement : [SELECT YC.[PHAUTHUAT_YEUCAU_ID]              ,YC.[PHAUTHUAT_ID]              ,YC.[DVYEUCAU_ID]              ,YC.[NHOMDICHVU_ID]              ,YC.[DICHVU_ID]              ,YC.[LOAIGIA_ID]              ,VP.[BHYT_THANHTIEN_CHITRA]              ,VP.[BENHNHAN_PHAITHANHTOAN]              ,VP.[THANHTIEN_DOANHTHU]              ,YC.[BENHVIEN_ID]              ,DVYC.NGAYGIOYEUCAU              ,DV.TENDICHVU              ,NDV.TENNHOMDICHVU              FROM [TT_PHAUTHUAT_YEUCAU] YC              INNER JOIN TT_VIENPHI VP ON YC.DVYEUCAU_ID= VP.REF_ID AND VP.REF_TABLE ='TT_DVYEUCAU'              INNER JOIN TT_DVYEUCAU DVYC ON DVYC.DVYEUCAU_ID = YC.DVYEUCAU_ID              INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = DVYC.DICHVU_ID              INNER JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID               where                             YC.PHAUTHUAT_ID = '68089'                       and                           YC.BENHVIEN_ID = 'HLU01'                                     order by PHAUTHUAT_YEUCAU_ID]
2020-02-26 14:11:54,778 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_PPVOCAM_GetDetail] PreparedStatement : [select *              from TT_PHAUTHUAT_PPVOCAM              where PHAUTHUAT_ID  = 68089]
2020-02-26 14:11:56,197 [1] DEBUG - Statement Id: [DAO00051_GetMauTuongTrinh] PreparedStatement : [select *            from TM_TUDIENKETQUA            where BENHVIEN_ID = 'HLU01'              and                 (NGUOITAO_ID = '1' OR SUDUNGCHUNG = '1')                and DICHVU_ID in  (                        @param0                   )               ORDER BY TENNOIDUNG]
2020-02-26 14:11:56,197 [1] DEBUG - Statement Id: [DAO00051_GetMauTuongTrinh] Parameters: [@param0=[LSTDICHVU_ID[0],5121]]
2020-02-26 14:11:56,197 [1] DEBUG - Statement Id: [DAO00051_GetMauTuongTrinh] Types: [@param0=[Int64, System.Int64]]
2020-02-26 14:11:56,242 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_GetDetail] PreparedStatement : [select PT.*, TN.BENHNHAN_ID              from              TT_PHAUTHUAT PT, TT_TIEPNHAN TN              where              PT.TIEPNHAN_ID = TN.TIEPNHAN_ID              AND PHAUTHUAT_ID  = 68089]
2020-02-26 14:11:56,298 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_IMAGES_GetList] PreparedStatement : [select *              from TT_PHAUTHUAT_IMAGES               where                             TT_PHAUTHUAT_IMAGES.PHAUTHUAT_ID = '68089'                       and                           TT_PHAUTHUAT_IMAGES.BENHVIEN_ID = 'HLU01'                                     order by IMAGES_ID]
2020-02-26 14:13:30,024 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_YEUCAU_GetList] PreparedStatement : [SELECT YC.[PHAUTHUAT_YEUCAU_ID]              ,YC.[PHAUTHUAT_ID]              ,YC.[DVYEUCAU_ID]              ,YC.[NHOMDICHVU_ID]              ,YC.[DICHVU_ID]              ,YC.[LOAIGIA_ID]              ,VP.[BHYT_THANHTIEN_CHITRA]              ,VP.[BENHNHAN_PHAITHANHTOAN]              ,VP.[THANHTIEN_DOANHTHU]              ,YC.[BENHVIEN_ID]              ,DVYC.NGAYGIOYEUCAU              ,DV.TENDICHVU              ,NDV.TENNHOMDICHVU              FROM [TT_PHAUTHUAT_YEUCAU] YC              INNER JOIN TT_VIENPHI VP ON YC.DVYEUCAU_ID= VP.REF_ID AND VP.REF_TABLE ='TT_DVYEUCAU'              INNER JOIN TT_DVYEUCAU DVYC ON DVYC.DVYEUCAU_ID = YC.DVYEUCAU_ID              INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = DVYC.DICHVU_ID              INNER JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID               where                             YC.PHAUTHUAT_ID = '68089'                       and                           YC.BENHVIEN_ID = 'HLU01'                                     order by PHAUTHUAT_YEUCAU_ID]
2020-02-26 14:13:30,072 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_PPVOCAM_GetDetail] PreparedStatement : [select *              from TT_PHAUTHUAT_PPVOCAM              where PHAUTHUAT_ID  = 68089]
2020-02-26 14:13:30,209 [1] DEBUG - Statement Id: [DAO00019_ThongTinBenhNhanTiepNhan] PreparedStatement : [select distinct A.SOTIEPNHAN, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        B.*, A.SOBHYT        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'        where                    A.TIEPNHAN_ID = '329'                 and A.BENHVIEN_ID = 'HLU01']
2020-02-26 14:13:30,295 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_GetList] PreparedStatement : [select *              from TT_PHAUTHUAT               where                             TT_PHAUTHUAT.LOAI = 'P'                       and                           TT_PHAUTHUAT.TIEPNHAN_ID = 329                       and                           TT_PHAUTHUAT.BENHVIEN_ID = 'HLU01'                                     order by PHAUTHUAT_ID DESC]
2020-02-26 14:13:30,354 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '329'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2020-02-26 14:13:30,433 [1] DEBUG - Statement Id: [DAO00048_GetBenhNhanByBenhNhanID] PreparedStatement : [SELECT *              FROM              TT_BENHNHAN               where                             BENHNHAN_ID = '326']
2020-02-26 14:13:30,459 [1] DEBUG - Statement Id: [DAO00000_GetDoiTuongIsBHYT] PreparedStatement : [select * from TM_DOITUONG Where DOITUONG_ID = 6 and MADOITUONG like '%BHYT%']
2020-02-26 14:13:30,744 [1] DEBUG - Statement Id: [DAO00048_GetDICHVUYCByTiepNhanID] PreparedStatement : [SELECT DISTINCT D.HOPDONG_ID, D.HOPDONG_BENHNHAN_ID, D.DVYEUCAU_ID, D.DICHVU_ID, D.SOPHIEUYEUCAU, D.NGAYGIOYEUCAU, D.NOITHUCHIEN_ID, P.LOAIPHAUTHUAT, L.STT AS STT_LOAIPHAUTHUAT            FROM            TT_DVYEUCAU AS D            left join TM_PHANLOAIPHAUTHUAT AS P ON D.DICHVU_ID = P.DICHVU_ID            left join TM_LOAIPHAUTHUAT AS L ON L.LOAIPHAUTHUAT = P.LOAIPHAUTHUAT            where            not exists (select DVYEUCAU_ID from TT_PHAUTHUAT_YEUCAU where D.DVYEUCAU_ID = DVYEUCAU_ID)               and                       exists                      (select DICHVU_ID from TM_DICHVU                      where D.DICHVU_ID = DICHVU_ID and                      exists                      (select NHOMDICHVU_ID from TM_NHOMDICHVU                      where TM_DICHVU.NHOMDICHVU_ID = NHOMDICHVU_ID and left(MANHOMDICHVU,2) in (05)                      )                                             )                     and                           D.TIEPNHAN_ID = '329']
2020-02-26 14:13:30,828 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '329'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2020-02-26 14:13:34,520 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_GetDetail] PreparedStatement : [select PT.*, TN.BENHNHAN_ID              from              TT_PHAUTHUAT PT, TT_TIEPNHAN TN              where              PT.TIEPNHAN_ID = TN.TIEPNHAN_ID              AND PHAUTHUAT_ID  = 68089]
2020-02-26 14:13:34,811 [1] DEBUG - Statement Id: [DAO00048_CheckDVPhauThuatBHYT] PreparedStatement : [select count(0) from TT_VIENPHI          where REF_TABLE = 'TT_DVYEUCAU' and REF_ID = (select top 1 DVYEUCAU_ID from TT_PHAUTHUAT_YEUCAU where PHAUTHUAT_ID =  @param0 )          and TIEPNHAN_ID =  @param1  and BHYT_DONGIA > 0]
2020-02-26 14:13:34,812 [1] DEBUG - Statement Id: [DAO00048_CheckDVPhauThuatBHYT] Parameters: [@param0=[PHAUTHUAT_ID,68089], @param1=[TIEPNHAN_ID,329]]
2020-02-26 14:13:34,812 [1] DEBUG - Statement Id: [DAO00048_CheckDVPhauThuatBHYT] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64]]
2020-02-26 14:13:34,846 [1] DEBUG - Statement Id: [DAO00116_File_GetList] PreparedStatement : [select *              from TT_FILE_DINHKEM               where                             TT_FILE_DINHKEM.REF_TABLE = 'TT_PHAUTHUAT'                       and                           TT_FILE_DINHKEM.REF_ID = '68089'                       and                           TT_FILE_DINHKEM.BENHVIEN_ID = 'HLU01'                                     order by FILE_ID]
2020-02-26 14:13:34,908 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_YEUCAU_GetList] PreparedStatement : [SELECT YC.[PHAUTHUAT_YEUCAU_ID]              ,YC.[PHAUTHUAT_ID]              ,YC.[DVYEUCAU_ID]              ,YC.[NHOMDICHVU_ID]              ,YC.[DICHVU_ID]              ,YC.[LOAIGIA_ID]              ,VP.[BHYT_THANHTIEN_CHITRA]              ,VP.[BENHNHAN_PHAITHANHTOAN]              ,VP.[THANHTIEN_DOANHTHU]              ,YC.[BENHVIEN_ID]              ,DVYC.NGAYGIOYEUCAU              ,DV.TENDICHVU              ,NDV.TENNHOMDICHVU              FROM [TT_PHAUTHUAT_YEUCAU] YC              INNER JOIN TT_VIENPHI VP ON YC.DVYEUCAU_ID= VP.REF_ID AND VP.REF_TABLE ='TT_DVYEUCAU'              INNER JOIN TT_DVYEUCAU DVYC ON DVYC.DVYEUCAU_ID = YC.DVYEUCAU_ID              INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = DVYC.DICHVU_ID              INNER JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID               where                             YC.PHAUTHUAT_ID = '68089'                       and                           YC.BENHVIEN_ID = 'HLU01'                                     order by PHAUTHUAT_YEUCAU_ID]
2020-02-26 14:13:34,943 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_PPVOCAM_GetDetail] PreparedStatement : [select *              from TT_PHAUTHUAT_PPVOCAM              where PHAUTHUAT_ID  = 68089]
2020-02-26 14:13:35,026 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_GetDetail] PreparedStatement : [select PT.*, TN.BENHNHAN_ID              from              TT_PHAUTHUAT PT, TT_TIEPNHAN TN              where              PT.TIEPNHAN_ID = TN.TIEPNHAN_ID              AND PHAUTHUAT_ID  = 68089]
2020-02-26 14:13:35,097 [1] DEBUG - Statement Id: [DAO00048_CheckDVPhauThuatBHYT] PreparedStatement : [select count(0) from TT_VIENPHI          where REF_TABLE = 'TT_DVYEUCAU' and REF_ID = (select top 1 DVYEUCAU_ID from TT_PHAUTHUAT_YEUCAU where PHAUTHUAT_ID =  @param0 )          and TIEPNHAN_ID =  @param1  and BHYT_DONGIA > 0]
2020-02-26 14:13:35,097 [1] DEBUG - Statement Id: [DAO00048_CheckDVPhauThuatBHYT] Parameters: [@param0=[PHAUTHUAT_ID,68089], @param1=[TIEPNHAN_ID,329]]
2020-02-26 14:13:35,097 [1] DEBUG - Statement Id: [DAO00048_CheckDVPhauThuatBHYT] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64]]
2020-02-26 14:13:35,133 [1] DEBUG - Statement Id: [DAO00116_File_GetList] PreparedStatement : [select *              from TT_FILE_DINHKEM               where                             TT_FILE_DINHKEM.REF_TABLE = 'TT_PHAUTHUAT'                       and                           TT_FILE_DINHKEM.REF_ID = '68089'                       and                           TT_FILE_DINHKEM.BENHVIEN_ID = 'HLU01'                                     order by FILE_ID]
2020-02-26 14:13:35,188 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_YEUCAU_GetList] PreparedStatement : [SELECT YC.[PHAUTHUAT_YEUCAU_ID]              ,YC.[PHAUTHUAT_ID]              ,YC.[DVYEUCAU_ID]              ,YC.[NHOMDICHVU_ID]              ,YC.[DICHVU_ID]              ,YC.[LOAIGIA_ID]              ,VP.[BHYT_THANHTIEN_CHITRA]              ,VP.[BENHNHAN_PHAITHANHTOAN]              ,VP.[THANHTIEN_DOANHTHU]              ,YC.[BENHVIEN_ID]              ,DVYC.NGAYGIOYEUCAU              ,DV.TENDICHVU              ,NDV.TENNHOMDICHVU              FROM [TT_PHAUTHUAT_YEUCAU] YC              INNER JOIN TT_VIENPHI VP ON YC.DVYEUCAU_ID= VP.REF_ID AND VP.REF_TABLE ='TT_DVYEUCAU'              INNER JOIN TT_DVYEUCAU DVYC ON DVYC.DVYEUCAU_ID = YC.DVYEUCAU_ID              INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = DVYC.DICHVU_ID              INNER JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID               where                             YC.PHAUTHUAT_ID = '68089'                       and                           YC.BENHVIEN_ID = 'HLU01'                                     order by PHAUTHUAT_YEUCAU_ID]
2020-02-26 14:13:35,221 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_PPVOCAM_GetDetail] PreparedStatement : [select *              from TT_PHAUTHUAT_PPVOCAM              where PHAUTHUAT_ID  = 68089]
2020-02-26 14:13:37,332 [1] DEBUG - Statement Id: [DAO00051_GetMauTuongTrinh] PreparedStatement : [select *            from TM_TUDIENKETQUA            where BENHVIEN_ID = 'HLU01'              and                 (NGUOITAO_ID = '1' OR SUDUNGCHUNG = '1')                and DICHVU_ID in  (                        @param0                   )               ORDER BY TENNOIDUNG]
2020-02-26 14:13:37,332 [1] DEBUG - Statement Id: [DAO00051_GetMauTuongTrinh] Parameters: [@param0=[LSTDICHVU_ID[0],5121]]
2020-02-26 14:13:37,332 [1] DEBUG - Statement Id: [DAO00051_GetMauTuongTrinh] Types: [@param0=[Int64, System.Int64]]
2020-02-26 14:14:09,262 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_GetDetail] PreparedStatement : [select PT.*, TN.BENHNHAN_ID              from              TT_PHAUTHUAT PT, TT_TIEPNHAN TN              where              PT.TIEPNHAN_ID = TN.TIEPNHAN_ID              AND PHAUTHUAT_ID  = 68089]
2020-02-26 14:14:14,371 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_IMAGES_GetList] PreparedStatement : [select *              from TT_PHAUTHUAT_IMAGES               where                             TT_PHAUTHUAT_IMAGES.PHAUTHUAT_ID = '68089'                       and                           TT_PHAUTHUAT_IMAGES.BENHVIEN_ID = 'HLU01'                                     order by IMAGES_ID]
--------------------------------------------------------------------------------
2020-02-26 14:25:14,096 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2020-02-26 14:25:14,339 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2020-02-26 14:25:14,436 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2020-02-26 14:25:14,900 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 14:25:15,333 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2020-02-26 14:25:22,320 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2020-02-26 14:25:22,346 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2020-02-26 14:25:23,917 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2020-02-26 14:25:24,145 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2020-02-26 14:25:24,963 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2020-02-26 14:25:25,145 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2020-02-26 14:25:25,242 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2020-02-26 14:25:25,321 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2020-02-26 14:25:25,484 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2020-02-26 14:25:25,566 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2020-02-26 14:25:25,634 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2020-02-26 14:25:25,706 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2020-02-26 14:25:25,786 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2020-02-26 14:25:26,435 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2020-02-26 14:25:26,467 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2020-02-26 14:25:26,536 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2020-02-26 14:25:26,564 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2020-02-26 14:25:29,861 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2020-02-26 14:25:29,895 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @NGUONDUOC_MACDINH varchar(5) = '0';        declare @TOAMUANGOAI int = 0;        select @NGUONDUOC_MACDINH = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'PHA_NGUONDUOC'        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + @NGUONDUOC_MACDINH as DUOC_KEY, 0 as PHAMVI_ID, @NGUONDUOC_MACDINH as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end        else        begin                select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (        select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID)        B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (        select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID)        A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2020-02-26 14:25:31,524 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2020-02-26 14:25:31,554 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,        SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH        FROM TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID        WHERE TK.SOLUONG > 0        GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2020-02-26 14:25:32,530 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2020-02-26 14:25:32,636 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,        TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,        TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH        from TM_MAU M        JOIN        (        select        A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO        from        (        select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO        from TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'        where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0        ) A        )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2020-02-26 14:25:32,790 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2020-02-26 14:25:33,799 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 14:25:34,530 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2020-02-26 14:25:39,603 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2020-02-26 14:25:39,719 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2020-02-26 14:25:39,812 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 14:25:40,029 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 14:25:40,146 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2020-02-26 14:25:40,148 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2020-02-26 14:25:40,148 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2020-02-26 14:25:40,190 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2020-02-26 14:25:40,190 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2020-02-26 14:25:40,190 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2020-02-26 14:25:40,453 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 14:25:40,611 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 14:25:49,385 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 14:25:49,467 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2020-02-26 14:25:49,879 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2020-02-26 14:26:30,800 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'OPD23'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 14:26:32,105 [1] DEBUG - Statement Id: [DAO00019_DanhSachPhauThuatThuThuat] PreparedStatement : [declare @TenBenhVien nvarchar(500)        declare @ManhomDSA varchar(10);        set @TenBenhVien = (select VALUE from TM_SYS_APPSETTINGS where CODE = 'APP_BENHVIEN_TEN')        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        select * from(        select ROW_NUMBER() OVER(order by NGAYGIOYEUCAU) as ROWNUMBER, *        from        (SELECT distinct        COUNT(*) OVER() as TOTALROWS,        N'Mã người bệnh: ' + bn.MAYTE + ' - ' + N'Tên người bệnh: ' + bn.TENBENHNHAN + ' - ' + N'Số bệnh án: ' + ISNULL(BA.SOBENHAN,'') + ' - ' + N'Sinh ngày: ' + isnull(Convert(varchar(10),bn.NGAYSINH,103),bn.NAMSINH) + ' - ' + N'Giới tính: ' + GD.DESCRIPTION as GROUPNAME,        bn.MAYTE, bn.TENBENHNHAN, bn.NAMSINH, bn.NGAYSINH as TUOI, ISNULL(CONVERT(VARCHAR(10), bn.NGAYSINH, 103),CAST(bn.NAMSINH AS varchar)) as NGAYSINH, bn.DIACHILIENLAC as DIACHI, bn.GIOITINH, GD.DESCRIPTION as TENGIOITINH,        tn.DOITUONG_ID, tn.THOIGIANTIEPNHAN, tn.BENHNHAN_ID, tn.TIEPNHAN_ID, tn.TRAITUYEN, tn.SOTIEPNHAN        , dv.DICHVU_ID, dv.NOITHUCHIEN_ID, isnull(dv.NGAYTAO, dv.NGAYCAPNHAT) as THOIGIANDKDICHVU        , dv.KHAN, dv.NOIYEUCAU_ID, dv.NGAYGIOYEUCAU, dv.BACSICHIDINH_ID, dv.DONVIGIOITHIEU_ID        , dv.NGUOIGIOITHIEU_ID, dv.TRANGTHAI_WFL, tn.NOIGIOITHIEU_ID        , dv.DVYEUCAU_ID, dv.MARIS, dv.TRANGTHAI as TRANGTHAICODE, B.TENNHOMDICHVU, dv.SOPHIEUYEUCAU, dv.KHAMBENH_NGOAITRU_ID, dv.NGUOICAPNHAT_ID, dv.NGAYCAPNHAT,        CASE        WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU        WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02'        ELSE Left(B.MANHOMDICHVU,2) END AS MANHOMDICHVU, B.MANHOMDICHVU as MANHOMDICHVUCHITIET, tn.TRANGTHAI as TRANGTHAI_TIEPNHAN,        'False' as DAKHAM,        vp.DATHANHTOAN, vp.DONGIA_DOANHTHU, BA.SOBENHAN, dv.CHANDOAN        , a.TENDICHVU, nth.TENPHONGBAN as TENPHONGKHAM, nyc.TENPHONGBAN as TENKHOACHIDINH        , bscd.TENNHANVIEN as TENBACSICHIDINH        , 0 as GUINGOAI        , 0 as VTYT        , 0 as CLSKETQUA_ID          ,             '' SOPHIEUPHAUTHUAT                   FROM TT_DVYEUCAU (NOLOCK) dv        inner join TT_TIEPNHAN (NOLOCK) tn on dv.TIEPNHAN_ID = tn.TIEPNHAN_ID        inner join TT_BENHNHAN (NOLOCK) bn on tn.BENHNHAN_ID = bn.BENHNHAN_ID        inner join TM_DICHVU A on A.DICHVU_ID = dv.DICHVU_ID        inner join TM_PHONGBAN nth on nth.PHONGBAN_ID = dv.NOITHUCHIEN_ID        left join TM_NHANVIEN bscd on bscd.NHANVIEN_ID = dv.BACSICHIDINH_ID        inner join TM_PHONGBAN nyc on nyc.PHONGBAN_ID = dv.NOIYEUCAU_ID        inner join TM_NHOMDICHVU B on B.NHOMDICHVU_ID = A.NHOMDICHVU_ID        inner join TT_VIENPHI (NOLOCK) VP on VP.TIEPNHAN_ID = tn.TIEPNHAN_ID and VP.DICHVU_ID = dv.DICHVU_ID and VP.REF_ID = dv.DVYEUCAU_ID        left join TT_NOITRU_BENHAN (NOLOCK) BA on BA.TIEPNHAN_ID = tn.TIEPNHAN_ID AND dv.BENHAN_ID = BA.BENHAN_ID        inner join TM_GENDER GD on GD.ID = bn.GIOITINH                 where        dv.DICHVU_ID IS NOT NULL        and tn.BENHVIEN_ID = 'HLU01'        and HUYYEUCAU = 0        and dv.NGAYHENCLS is NULL                       and dv.TRANGTHAI = 'CHUAKETQUA'           and           dv.NGAYYEUCAU >= '2/26/2020 12:00:00 AM'         and           dv.NGAYYEUCAU <= '2/26/2020 12:00:00 AM'         and           dv.NOITHUCHIEN_ID = 25         and           (CASE          WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU          WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2)          END) in (05)         and           tn.TRANGTHAI IN ('DATIEPNHAN','NOITRU','CAPCUU', 'HOANTHANH')         and           (vp.DATHANHTOAN = '1'  or vp.DONGIA_DOANHTHU = '0' OR TN.SUDUNG_BHTN='1' OR TN.BAOLANH_VIENPHI='1'  OR tn.TRANGTHAI IN ('NOITRU','CAPCUU','NGOAITRU') or dv.HOPDONG_BENHNHAN_ID is not null or vp.BENHNHAN_PHAITHANHTOAN >= 0)                 ) data1) lst                    where          lst.ROWNUMBER between 1 and 20                 order by NGAYGIOYEUCAU asc]
2020-02-26 14:27:26,873 [1] DEBUG - Statement Id: [DAO00217_GetEmployeeAll] PreparedStatement : [select * from TM_NHANVIEN]
2020-02-26 14:27:36,039 [1] DEBUG - Statement Id: [DAO00019_DanhSachPhauThuatThuThuat] PreparedStatement : [declare @TenBenhVien nvarchar(500)        declare @ManhomDSA varchar(10);        set @TenBenhVien = (select VALUE from TM_SYS_APPSETTINGS where CODE = 'APP_BENHVIEN_TEN')        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        select * from(        select ROW_NUMBER() OVER(order by NGAYGIOYEUCAU) as ROWNUMBER, *        from        (SELECT distinct        COUNT(*) OVER() as TOTALROWS,        N'Mã người bệnh: ' + bn.MAYTE + ' - ' + N'Tên người bệnh: ' + bn.TENBENHNHAN + ' - ' + N'Số bệnh án: ' + ISNULL(BA.SOBENHAN,'') + ' - ' + N'Sinh ngày: ' + isnull(Convert(varchar(10),bn.NGAYSINH,103),bn.NAMSINH) + ' - ' + N'Giới tính: ' + GD.DESCRIPTION as GROUPNAME,        bn.MAYTE, bn.TENBENHNHAN, bn.NAMSINH, bn.NGAYSINH as TUOI, ISNULL(CONVERT(VARCHAR(10), bn.NGAYSINH, 103),CAST(bn.NAMSINH AS varchar)) as NGAYSINH, bn.DIACHILIENLAC as DIACHI, bn.GIOITINH, GD.DESCRIPTION as TENGIOITINH,        tn.DOITUONG_ID, tn.THOIGIANTIEPNHAN, tn.BENHNHAN_ID, tn.TIEPNHAN_ID, tn.TRAITUYEN, tn.SOTIEPNHAN        , dv.DICHVU_ID, dv.NOITHUCHIEN_ID, isnull(dv.NGAYTAO, dv.NGAYCAPNHAT) as THOIGIANDKDICHVU        , dv.KHAN, dv.NOIYEUCAU_ID, dv.NGAYGIOYEUCAU, dv.BACSICHIDINH_ID, dv.DONVIGIOITHIEU_ID        , dv.NGUOIGIOITHIEU_ID, dv.TRANGTHAI_WFL, tn.NOIGIOITHIEU_ID        , dv.DVYEUCAU_ID, dv.MARIS, dv.TRANGTHAI as TRANGTHAICODE, B.TENNHOMDICHVU, dv.SOPHIEUYEUCAU, dv.KHAMBENH_NGOAITRU_ID, dv.NGUOICAPNHAT_ID, dv.NGAYCAPNHAT,        CASE        WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU        WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02'        ELSE Left(B.MANHOMDICHVU,2) END AS MANHOMDICHVU, B.MANHOMDICHVU as MANHOMDICHVUCHITIET, tn.TRANGTHAI as TRANGTHAI_TIEPNHAN,        'False' as DAKHAM,        vp.DATHANHTOAN, vp.DONGIA_DOANHTHU, BA.SOBENHAN, dv.CHANDOAN        , a.TENDICHVU, nth.TENPHONGBAN as TENPHONGKHAM, nyc.TENPHONGBAN as TENKHOACHIDINH        , bscd.TENNHANVIEN as TENBACSICHIDINH        , 0 as GUINGOAI        , 0 as VTYT        , 0 as CLSKETQUA_ID          ,             '' SOPHIEUPHAUTHUAT                   FROM TT_DVYEUCAU (NOLOCK) dv        inner join TT_TIEPNHAN (NOLOCK) tn on dv.TIEPNHAN_ID = tn.TIEPNHAN_ID        inner join TT_BENHNHAN (NOLOCK) bn on tn.BENHNHAN_ID = bn.BENHNHAN_ID        inner join TM_DICHVU A on A.DICHVU_ID = dv.DICHVU_ID        inner join TM_PHONGBAN nth on nth.PHONGBAN_ID = dv.NOITHUCHIEN_ID        left join TM_NHANVIEN bscd on bscd.NHANVIEN_ID = dv.BACSICHIDINH_ID        inner join TM_PHONGBAN nyc on nyc.PHONGBAN_ID = dv.NOIYEUCAU_ID        inner join TM_NHOMDICHVU B on B.NHOMDICHVU_ID = A.NHOMDICHVU_ID        inner join TT_VIENPHI (NOLOCK) VP on VP.TIEPNHAN_ID = tn.TIEPNHAN_ID and VP.DICHVU_ID = dv.DICHVU_ID and VP.REF_ID = dv.DVYEUCAU_ID        left join TT_NOITRU_BENHAN (NOLOCK) BA on BA.TIEPNHAN_ID = tn.TIEPNHAN_ID AND dv.BENHAN_ID = BA.BENHAN_ID        inner join TM_GENDER GD on GD.ID = bn.GIOITINH                 where        dv.DICHVU_ID IS NOT NULL        and tn.BENHVIEN_ID = 'HLU01'        and HUYYEUCAU = 0        and dv.NGAYHENCLS is NULL                       and dv.TRANGTHAI = 'CHUAKETQUA'           and           dv.NGAYYEUCAU >= '11/1/2019 12:00:00 AM'         and           dv.NGAYYEUCAU <= '2/26/2020 12:00:00 AM'         and           dv.NOITHUCHIEN_ID = 25         and           (CASE          WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU          WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2)          END) in (05)         and           tn.TRANGTHAI IN ('DATIEPNHAN','NOITRU','CAPCUU', 'HOANTHANH')         and           (vp.DATHANHTOAN = '1'  or vp.DONGIA_DOANHTHU = '0' OR TN.SUDUNG_BHTN='1' OR TN.BAOLANH_VIENPHI='1'  OR tn.TRANGTHAI IN ('NOITRU','CAPCUU','NGOAITRU') or dv.HOPDONG_BENHNHAN_ID is not null or vp.BENHNHAN_PHAITHANHTOAN >= 0)                 ) data1) lst                    where          lst.ROWNUMBER between 1 and 20                 order by NGAYGIOYEUCAU asc]
2020-02-26 14:27:37,070 [1] DEBUG - Statement Id: [DAO00000_GetNhomDoiTuong] PreparedStatement : [SELECT DOITUONG_ID              ,[TENDOITUONG]              ,[NHOMDICHVU]              ,[TYLE_VUOT_LCB]              ,[GIOIHAN_VUOT_LCB]              ,[GIOIHAN_VUOT_DVKTC]              ,[TYLE_THUOC_UT]              ,[CPVC]              ,[CHIPHINGOAI_BHYT]              ,[NGANSACH_TL]              ,[MIENGIAM_TL]              ,[TAITRO_TL]              ,[BHTN_TL]              FROM [dbo].[TM_DOITUONG]]
2020-02-26 14:28:01,272 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'ORM04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 14:28:01,722 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'ORM05'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 14:28:02,245 [1] DEBUG - Statement Id: [DAO00019_ThongTinBenhNhanTiepNhan] PreparedStatement : [select distinct A.SOTIEPNHAN, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        B.*, A.SOBHYT        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'        where                    A.TIEPNHAN_ID = '329'                 and A.BENHVIEN_ID = 'HLU01']
2020-02-26 14:28:02,778 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_GetList] PreparedStatement : [select *              from TT_PHAUTHUAT               where                             TT_PHAUTHUAT.LOAI = 'P'                       and                           TT_PHAUTHUAT.TIEPNHAN_ID = 329                       and                           TT_PHAUTHUAT.BENHVIEN_ID = 'HLU01'                                     order by PHAUTHUAT_ID DESC]
2020-02-26 14:28:02,978 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '329'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2020-02-26 14:28:03,167 [1] DEBUG - Statement Id: [DAO00048_GetBenhNhanByBenhNhanID] PreparedStatement : [SELECT *              FROM              TT_BENHNHAN               where                             BENHNHAN_ID = '326']
2020-02-26 14:28:03,198 [1] DEBUG - Statement Id: [DAO00000_GetDoiTuongIsBHYT] PreparedStatement : [select * from TM_DOITUONG Where DOITUONG_ID = 6 and MADOITUONG like '%BHYT%']
2020-02-26 14:28:03,646 [1] DEBUG - Statement Id: [DAO00048_GetDICHVUYCByTiepNhanID] PreparedStatement : [SELECT DISTINCT D.HOPDONG_ID, D.HOPDONG_BENHNHAN_ID, D.DVYEUCAU_ID, D.DICHVU_ID, D.SOPHIEUYEUCAU, D.NGAYGIOYEUCAU, D.NOITHUCHIEN_ID, P.LOAIPHAUTHUAT, L.STT AS STT_LOAIPHAUTHUAT            FROM            TT_DVYEUCAU AS D            left join TM_PHANLOAIPHAUTHUAT AS P ON D.DICHVU_ID = P.DICHVU_ID            left join TM_LOAIPHAUTHUAT AS L ON L.LOAIPHAUTHUAT = P.LOAIPHAUTHUAT            where            not exists (select DVYEUCAU_ID from TT_PHAUTHUAT_YEUCAU where D.DVYEUCAU_ID = DVYEUCAU_ID)               and                       exists                      (select DICHVU_ID from TM_DICHVU                      where D.DICHVU_ID = DICHVU_ID and                      exists                      (select NHOMDICHVU_ID from TM_NHOMDICHVU                      where TM_DICHVU.NHOMDICHVU_ID = NHOMDICHVU_ID and left(MANHOMDICHVU,2) in (05)                      )                                             )                     and                           D.TIEPNHAN_ID = '329']
2020-02-26 14:28:03,692 [1] DEBUG - Statement Id: [DAO00066_GetBENHAN_TIEPNHAN] PreparedStatement : [select top 1 *        from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '329'  and BENHVIEN_ID = 'HLU01'        order by NGAYTAO desc]
2020-02-26 14:28:03,873 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM60'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 14:28:03,994 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM98'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 14:28:09,111 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_GetDetail] PreparedStatement : [select PT.*, TN.BENHNHAN_ID              from              TT_PHAUTHUAT PT, TT_TIEPNHAN TN              where              PT.TIEPNHAN_ID = TN.TIEPNHAN_ID              AND PHAUTHUAT_ID  = 68089]
2020-02-26 14:28:09,212 [1] DEBUG - Statement Id: [DAO00048_CheckDVPhauThuatBHYT] PreparedStatement : [select count(0) from TT_VIENPHI          where REF_TABLE = 'TT_DVYEUCAU' and REF_ID = (select top 1 DVYEUCAU_ID from TT_PHAUTHUAT_YEUCAU where PHAUTHUAT_ID =  @param0 )          and TIEPNHAN_ID =  @param1  and BHYT_DONGIA > 0]
2020-02-26 14:28:09,212 [1] DEBUG - Statement Id: [DAO00048_CheckDVPhauThuatBHYT] Parameters: [@param0=[PHAUTHUAT_ID,68089], @param1=[TIEPNHAN_ID,329]]
2020-02-26 14:28:09,212 [1] DEBUG - Statement Id: [DAO00048_CheckDVPhauThuatBHYT] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64]]
2020-02-26 14:28:09,337 [1] DEBUG - Statement Id: [DAO00116_File_GetList] PreparedStatement : [select *              from TT_FILE_DINHKEM               where                             TT_FILE_DINHKEM.REF_TABLE = 'TT_PHAUTHUAT'                       and                           TT_FILE_DINHKEM.REF_ID = '68089'                       and                           TT_FILE_DINHKEM.BENHVIEN_ID = 'HLU01'                                     order by FILE_ID]
2020-02-26 14:28:09,454 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_YEUCAU_GetList] PreparedStatement : [SELECT YC.[PHAUTHUAT_YEUCAU_ID]              ,YC.[PHAUTHUAT_ID]              ,YC.[DVYEUCAU_ID]              ,YC.[NHOMDICHVU_ID]              ,YC.[DICHVU_ID]              ,YC.[LOAIGIA_ID]              ,VP.[BHYT_THANHTIEN_CHITRA]              ,VP.[BENHNHAN_PHAITHANHTOAN]              ,VP.[THANHTIEN_DOANHTHU]              ,YC.[BENHVIEN_ID]              ,DVYC.NGAYGIOYEUCAU              ,DV.TENDICHVU              ,NDV.TENNHOMDICHVU              FROM [TT_PHAUTHUAT_YEUCAU] YC              INNER JOIN TT_VIENPHI VP ON YC.DVYEUCAU_ID= VP.REF_ID AND VP.REF_TABLE ='TT_DVYEUCAU'              INNER JOIN TT_DVYEUCAU DVYC ON DVYC.DVYEUCAU_ID = YC.DVYEUCAU_ID              INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = DVYC.DICHVU_ID              INNER JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID               where                             YC.PHAUTHUAT_ID = '68089'                       and                           YC.BENHVIEN_ID = 'HLU01'                                     order by PHAUTHUAT_YEUCAU_ID]
2020-02-26 14:28:09,586 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_PPVOCAM_GetDetail] PreparedStatement : [select *              from TT_PHAUTHUAT_PPVOCAM              where PHAUTHUAT_ID  = 68089]
2020-02-26 14:28:09,685 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_GetDetail] PreparedStatement : [select PT.*, TN.BENHNHAN_ID              from              TT_PHAUTHUAT PT, TT_TIEPNHAN TN              where              PT.TIEPNHAN_ID = TN.TIEPNHAN_ID              AND PHAUTHUAT_ID  = 68089]
2020-02-26 14:28:09,790 [1] DEBUG - Statement Id: [DAO00048_CheckDVPhauThuatBHYT] PreparedStatement : [select count(0) from TT_VIENPHI          where REF_TABLE = 'TT_DVYEUCAU' and REF_ID = (select top 1 DVYEUCAU_ID from TT_PHAUTHUAT_YEUCAU where PHAUTHUAT_ID =  @param0 )          and TIEPNHAN_ID =  @param1  and BHYT_DONGIA > 0]
2020-02-26 14:28:09,790 [1] DEBUG - Statement Id: [DAO00048_CheckDVPhauThuatBHYT] Parameters: [@param0=[PHAUTHUAT_ID,68089], @param1=[TIEPNHAN_ID,329]]
2020-02-26 14:28:09,790 [1] DEBUG - Statement Id: [DAO00048_CheckDVPhauThuatBHYT] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64]]
2020-02-26 14:28:09,834 [1] DEBUG - Statement Id: [DAO00116_File_GetList] PreparedStatement : [select *              from TT_FILE_DINHKEM               where                             TT_FILE_DINHKEM.REF_TABLE = 'TT_PHAUTHUAT'                       and                           TT_FILE_DINHKEM.REF_ID = '68089'                       and                           TT_FILE_DINHKEM.BENHVIEN_ID = 'HLU01'                                     order by FILE_ID]
2020-02-26 14:28:09,884 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_YEUCAU_GetList] PreparedStatement : [SELECT YC.[PHAUTHUAT_YEUCAU_ID]              ,YC.[PHAUTHUAT_ID]              ,YC.[DVYEUCAU_ID]              ,YC.[NHOMDICHVU_ID]              ,YC.[DICHVU_ID]              ,YC.[LOAIGIA_ID]              ,VP.[BHYT_THANHTIEN_CHITRA]              ,VP.[BENHNHAN_PHAITHANHTOAN]              ,VP.[THANHTIEN_DOANHTHU]              ,YC.[BENHVIEN_ID]              ,DVYC.NGAYGIOYEUCAU              ,DV.TENDICHVU              ,NDV.TENNHOMDICHVU              FROM [TT_PHAUTHUAT_YEUCAU] YC              INNER JOIN TT_VIENPHI VP ON YC.DVYEUCAU_ID= VP.REF_ID AND VP.REF_TABLE ='TT_DVYEUCAU'              INNER JOIN TT_DVYEUCAU DVYC ON DVYC.DVYEUCAU_ID = YC.DVYEUCAU_ID              INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = DVYC.DICHVU_ID              INNER JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID               where                             YC.PHAUTHUAT_ID = '68089'                       and                           YC.BENHVIEN_ID = 'HLU01'                                     order by PHAUTHUAT_YEUCAU_ID]
2020-02-26 14:28:09,918 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_PPVOCAM_GetDetail] PreparedStatement : [select *              from TT_PHAUTHUAT_PPVOCAM              where PHAUTHUAT_ID  = 68089]
2020-02-26 14:28:11,107 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'ORM07'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 14:28:11,723 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_EKIP_GetDetail] PreparedStatement : [select *              from TT_PHAUTHUAT_EKIP              where PHAUTHUAT_ID  = 68089]
2020-02-26 14:28:14,226 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'ORM06'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 14:28:15,797 [1] DEBUG - Statement Id: [DAO00051_GetMauTuongTrinh] PreparedStatement : [select *            from TM_TUDIENKETQUA            where BENHVIEN_ID = 'HLU01'              and                 (NGUOITAO_ID = '1' OR SUDUNGCHUNG = '1')                and DICHVU_ID in  (                        @param0                   )               ORDER BY TENNOIDUNG]
2020-02-26 14:28:15,799 [1] DEBUG - Statement Id: [DAO00051_GetMauTuongTrinh] Parameters: [@param0=[LSTDICHVU_ID[0],5121]]
2020-02-26 14:28:15,799 [1] DEBUG - Statement Id: [DAO00051_GetMauTuongTrinh] Types: [@param0=[Int64, System.Int64]]
2020-02-26 14:28:15,833 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_GetDetail] PreparedStatement : [select PT.*, TN.BENHNHAN_ID              from              TT_PHAUTHUAT PT, TT_TIEPNHAN TN              where              PT.TIEPNHAN_ID = TN.TIEPNHAN_ID              AND PHAUTHUAT_ID  = 68089]
2020-02-26 14:28:15,863 [1] DEBUG - Statement Id: [DAO00048_TT_PHAUTHUAT_IMAGES_GetList] PreparedStatement : [select *              from TT_PHAUTHUAT_IMAGES               where                             TT_PHAUTHUAT_IMAGES.PHAUTHUAT_ID = '68089'                       and                           TT_PHAUTHUAT_IMAGES.BENHVIEN_ID = 'HLU01'                                     order by IMAGES_ID]
--------------------------------------------------------------------------------
2020-02-26 14:33:51,950 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2020-02-26 14:33:52,252 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2020-02-26 14:33:52,287 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2020-02-26 14:33:52,669 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 14:33:52,882 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2020-02-26 14:34:13,564 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2020-02-26 14:34:13,681 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2020-02-26 14:34:15,418 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2020-02-26 14:34:15,766 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2020-02-26 14:34:16,621 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2020-02-26 14:34:16,865 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2020-02-26 14:34:16,936 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2020-02-26 14:34:17,010 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2020-02-26 14:34:17,080 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2020-02-26 14:34:17,172 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2020-02-26 14:34:17,240 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2020-02-26 14:34:17,307 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2020-02-26 14:34:17,390 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2020-02-26 14:34:17,903 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2020-02-26 14:34:17,980 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2020-02-26 14:34:18,058 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2020-02-26 14:34:18,113 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2020-02-26 14:34:21,074 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2020-02-26 14:34:21,258 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @NGUONDUOC_MACDINH varchar(5) = '0';        declare @TOAMUANGOAI int = 0;        select @NGUONDUOC_MACDINH = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'PHA_NGUONDUOC'        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + @NGUONDUOC_MACDINH as DUOC_KEY, 0 as PHAMVI_ID, @NGUONDUOC_MACDINH as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end        else        begin                select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (        select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID)        B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (        select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID)        A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2020-02-26 14:34:22,848 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2020-02-26 14:34:22,877 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,        SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH        FROM TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID        WHERE TK.SOLUONG > 0        GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2020-02-26 14:34:22,971 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2020-02-26 14:34:23,001 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,        TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,        TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH        from TM_MAU M        JOIN        (        select        A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO        from        (        select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO        from TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'        where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0        ) A        )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2020-02-26 14:34:23,095 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2020-02-26 14:34:24,005 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 14:34:24,861 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2020-02-26 14:34:29,703 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2020-02-26 14:34:29,793 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2020-02-26 14:34:29,944 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 14:34:30,155 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 14:34:30,276 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2020-02-26 14:34:30,277 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2020-02-26 14:34:30,277 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2020-02-26 14:34:30,305 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2020-02-26 14:34:30,305 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2020-02-26 14:34:30,305 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2020-02-26 14:34:30,438 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 14:34:30,592 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 14:34:42,732 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 14:34:42,821 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2020-02-26 14:34:43,305 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2020-02-26 14:34:53,994 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'IPD02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 14:34:54,443 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'IPD40'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 14:34:54,783 [1] DEBUG - Statement Id: [DAO00069_GetCountDanhSachNoiTru] PreparedStatement : [select count(A.SOBENHAN) as TOTALROWS        from TT_NOITRU_BENHAN A        inner join TT_TIEPNHAN B on B.TIEPNHAN_ID = A.TIEPNHAN_ID and (B.TRANGTHAI = 'NOITRU' or B.TRANGTHAI = 'HOANTHANH')        inner join TT_BENHNHAN C on C.BENHNHAN_ID = B.BENHNHAN_ID        left join TT_NOITRU_LUUTRU D on D.BENHAN_ID = A.BENHAN_ID        and D.LUUTRU_ID = ( select top 1 LUUTRU_ID from TT_NOITRU_LUUTRU where BENHAN_ID = A.BENHAN_ID order by BENHAN_ID desc)        left join TT_NOITRU_XACNHAN E on E.BENHAN_ID = A.BENHAN_ID        left join TT_NOITRU_LUUTRUCHITIET F on D.LUUTRU_ID = F.LUUTRU_ID and F.LUUTRUCHITIET_CURRENT = '1'        and F.LUUTRUCHITIET_ID in (select top 1 LUUTRUCHITIET_ID from TT_NOITRU_LUUTRUCHITIET where LUUTRU_ID = D.LUUTRU_ID order by LUUTRUCHITIET_ID desc)        where        A.KHOACHUYENDEN_ID is not null  and        (E.TRANGTHAI = 'DAXACNHAN' OR E.TRANGTHAI = 'HUYXACNHAN')         and           cast(A.NGAYVAOKHOA as date) <= cast('2/26/2020 12:00:00 AM' as date)                 and B.BENHVIEN_ID = 'HLU01' and A.KHOACHUYENDEN_ID = '25'          AND             A.TRANGTHAI in ('DANGDIEUTRI')]
2020-02-26 14:34:56,872 [1] DEBUG - Statement Id: [DAO00069_GetDanhSachNoiTru] PreparedStatement : [select * from        (        SELECT ROW_NUMBER() OVER(order by B.SOTIEPNHAN) as ROWNUMBER,          A.SOBENHAN, A.BENHAN_ID, A.SOLUUTRU                 , E.NOILAP_ID as KHOAVAO_ID        , A.TRANGTHAI, IsNull(A.BACSIDIEUTRI_ID, E.BACSICHIDINH_ID) as BACSIDIEUTRI_ID,        B.TIEPNHAN_ID, B.SOTIEPNHAN, B.SOBHYT as SOTHE, B.DOITUONG_ID, A.NGAYVAOKHOA as NGAYCAPCUU, A.THOIGIANVAOKHOA as THOIGIANCAPCUU,        C.TENBENHNHAN, C.NGAYSINH, C.NAMSINH, C.BENHNHAN_ID, C.MAYTE, F.GIUONGBENH_ID, A.THOIGIANRAVIEN    , DIACHITHUONGTRU, DANTOC_ID        ,BENHVIEN_STT_ID                from TT_NOITRU_BENHAN A        inner join TT_TIEPNHAN B on B.TIEPNHAN_ID = A.TIEPNHAN_ID and (B.TRANGTHAI = 'NOITRU' or B.TRANGTHAI = 'HOANTHANH')        inner join TT_BENHNHAN C on C.BENHNHAN_ID = B.BENHNHAN_ID        left join TT_NOITRU_LUUTRU D on D.BENHAN_ID = A.BENHAN_ID        and D.LUUTRU_ID = ( select top 1 LUUTRU_ID from TT_NOITRU_LUUTRU where BENHAN_ID = A.BENHAN_ID order by LUUTRU_ID desc)        left join TT_NOITRU_XACNHAN E on E.BENHAN_ID = A.BENHAN_ID        left join TT_NOITRU_LUUTRUCHITIET F on D.LUUTRU_ID = F.LUUTRU_ID and F.LUUTRUCHITIET_CURRENT = '1'        and F.LUUTRUCHITIET_ID in (select top 1 LUUTRUCHITIET_ID from TT_NOITRU_LUUTRUCHITIET where LUUTRU_ID = D.LUUTRU_ID order by LUUTRUCHITIET_ID desc)        left join (select MABENHVIEN, BENHVIEN_STT_ID from TM_BENHVIEN) H on SUBSTRING(B.SOBHYT, 16, 5)=H.MABENHVIEN        where        A.KHOACHUYENDEN_ID is not null  and        (E.TRANGTHAI = 'DAXACNHAN' OR E.TRANGTHAI = 'HUYXACNHAN')         and           cast(A.NGAYVAOKHOA as date) <= cast('2/26/2020 12:00:00 AM' as date)                 and B.BENHVIEN_ID = 'HLU01' and A.KHOACHUYENDEN_ID = '25'          AND             A.TRANGTHAI in ('DANGDIEUTRI')                   ) lst        where        lst.ROWNUMBER between 1 and 20        order by lst.SOTIEPNHAN]
2020-02-26 14:35:01,751 [1] DEBUG - Statement Id: [DAO00069_GetCountDanhSachNoiTru] PreparedStatement : [select count(A.SOBENHAN) as TOTALROWS        from TT_NOITRU_BENHAN A        inner join TT_TIEPNHAN B on B.TIEPNHAN_ID = A.TIEPNHAN_ID and (B.TRANGTHAI = 'NOITRU' or B.TRANGTHAI = 'HOANTHANH')        inner join TT_BENHNHAN C on C.BENHNHAN_ID = B.BENHNHAN_ID        left join TT_NOITRU_LUUTRU D on D.BENHAN_ID = A.BENHAN_ID        and D.LUUTRU_ID = ( select top 1 LUUTRU_ID from TT_NOITRU_LUUTRU where BENHAN_ID = A.BENHAN_ID order by BENHAN_ID desc)        left join TT_NOITRU_XACNHAN E on E.BENHAN_ID = A.BENHAN_ID        left join TT_NOITRU_LUUTRUCHITIET F on D.LUUTRU_ID = F.LUUTRU_ID and F.LUUTRUCHITIET_CURRENT = '1'        and F.LUUTRUCHITIET_ID in (select top 1 LUUTRUCHITIET_ID from TT_NOITRU_LUUTRUCHITIET where LUUTRU_ID = D.LUUTRU_ID order by LUUTRUCHITIET_ID desc)        where        A.KHOACHUYENDEN_ID is not null  and        (E.TRANGTHAI = 'DAXACNHAN' OR E.TRANGTHAI = 'HUYXACNHAN')         and           cast(A.NGAYVAOKHOA as date) <= cast('2/26/2020 12:00:00 AM' as date)                 and B.BENHVIEN_ID = 'HLU01' and A.KHOACHUYENDEN_ID = '25'          AND             A.TRANGTHAI in ('DANGDIEUTRI')]
2020-02-26 14:35:01,887 [1] DEBUG - Statement Id: [DAO00069_GetDanhSachNoiTru] PreparedStatement : [select * from        (        SELECT ROW_NUMBER() OVER(order by B.SOTIEPNHAN) as ROWNUMBER,          A.SOBENHAN, A.BENHAN_ID, A.SOLUUTRU                 , E.NOILAP_ID as KHOAVAO_ID        , A.TRANGTHAI, IsNull(A.BACSIDIEUTRI_ID, E.BACSICHIDINH_ID) as BACSIDIEUTRI_ID,        B.TIEPNHAN_ID, B.SOTIEPNHAN, B.SOBHYT as SOTHE, B.DOITUONG_ID, A.NGAYVAOKHOA as NGAYCAPCUU, A.THOIGIANVAOKHOA as THOIGIANCAPCUU,        C.TENBENHNHAN, C.NGAYSINH, C.NAMSINH, C.BENHNHAN_ID, C.MAYTE, F.GIUONGBENH_ID, A.THOIGIANRAVIEN    , DIACHITHUONGTRU, DANTOC_ID        ,BENHVIEN_STT_ID                from TT_NOITRU_BENHAN A        inner join TT_TIEPNHAN B on B.TIEPNHAN_ID = A.TIEPNHAN_ID and (B.TRANGTHAI = 'NOITRU' or B.TRANGTHAI = 'HOANTHANH')        inner join TT_BENHNHAN C on C.BENHNHAN_ID = B.BENHNHAN_ID        left join TT_NOITRU_LUUTRU D on D.BENHAN_ID = A.BENHAN_ID        and D.LUUTRU_ID = ( select top 1 LUUTRU_ID from TT_NOITRU_LUUTRU where BENHAN_ID = A.BENHAN_ID order by LUUTRU_ID desc)        left join TT_NOITRU_XACNHAN E on E.BENHAN_ID = A.BENHAN_ID        left join TT_NOITRU_LUUTRUCHITIET F on D.LUUTRU_ID = F.LUUTRU_ID and F.LUUTRUCHITIET_CURRENT = '1'        and F.LUUTRUCHITIET_ID in (select top 1 LUUTRUCHITIET_ID from TT_NOITRU_LUUTRUCHITIET where LUUTRU_ID = D.LUUTRU_ID order by LUUTRUCHITIET_ID desc)        left join (select MABENHVIEN, BENHVIEN_STT_ID from TM_BENHVIEN) H on SUBSTRING(B.SOBHYT, 16, 5)=H.MABENHVIEN        where        A.KHOACHUYENDEN_ID is not null  and        (E.TRANGTHAI = 'DAXACNHAN' OR E.TRANGTHAI = 'HUYXACNHAN')         and           cast(A.NGAYVAOKHOA as date) <= cast('2/26/2020 12:00:00 AM' as date)                 and B.BENHVIEN_ID = 'HLU01' and A.KHOACHUYENDEN_ID = '25'          AND             A.TRANGTHAI in ('DANGDIEUTRI')                   ) lst        where        lst.ROWNUMBER between 1 and 20        order by lst.SOTIEPNHAN]
2020-02-26 14:35:19,528 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM31'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 14:35:19,686 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'IPD03'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 14:35:21,193 [1] DEBUG - Statement Id: [DAO00080_KiemtraBenhAnDaThanhToan] PreparedStatement : [select DAXACNHANDOANHTHU        from TT_NOITRU_BENHAN where        BENHAN_ID = '24642'        and BENHVIEN_ID = 'HLU01'        Order By BENHAN_ID Desc]
2020-02-26 14:35:21,282 [1] DEBUG - Statement Id: [DAO00061_GetBenhAnDetailByID] PreparedStatement : [select A.*, B.NOIGIOITHIEU_ID, C.KHOADIEUTRI_ID, A.ICD_BENHCHINH AS ICD_BENHCHINH_BAK, A.CDRAVIEN_CHINH AS CHANDOANRAVIEN1, B.THOIGIANTIEPNHAN        , A.CDRAVIEN_CHINH AS CHANDOANRAVIEN_BAK        from TT_NOITRU_BENHAN A        left join TT_TIEPNHAN B on B.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TT_NOITRU_NHAPVIEN C on C.TIEPNHAN_ID = B.TIEPNHAN_ID        where A.BENHAN_ID = '24642']
2020-02-26 14:35:23,234 [1] DEBUG - Statement Id: [DAO00087_GetServiceParams] PreparedStatement : [select CODE, VALUE              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01']
2020-02-26 14:35:23,316 [1] DEBUG - Statement Id: [DAO00080_GetNoiTruLuuTruBenhAn] PreparedStatement : [select *        from TT_NOITRU_LUUTRU where        BENHAN_ID = '24642'        and BENHVIEN_ID = 'HLU01'        Order By LUUTRU_ID ASC]
2020-02-26 14:35:23,456 [1] DEBUG - Statement Id: [DAO00080_GetGiuongBenhCuaBenhAn] PreparedStatement : [select *        from TT_NOITRU_GIUONGBENH where        BENHAN_ID =  @param0]
2020-02-26 14:35:23,456 [1] DEBUG - Statement Id: [DAO00080_GetGiuongBenhCuaBenhAn] Parameters: [@param0=[BENHAN_ID,24642]]
2020-02-26 14:35:23,456 [1] DEBUG - Statement Id: [DAO00080_GetGiuongBenhCuaBenhAn] Types: [@param0=[Int64, System.Int64]]
2020-02-26 14:35:23,597 [1] DEBUG - Statement Id: [DAO00013_GetDetailP] PreparedStatement : [select *        from TT_BENHNHAN         WHERE              TT_BENHNHAN.MAYTE  = '190040528']
2020-02-26 14:35:23,722 [1] DEBUG - Statement Id: [DAO00061_GetBenhAnDetailByID] PreparedStatement : [select A.*, B.NOIGIOITHIEU_ID, C.KHOADIEUTRI_ID, A.ICD_BENHCHINH AS ICD_BENHCHINH_BAK, A.CDRAVIEN_CHINH AS CHANDOANRAVIEN1, B.THOIGIANTIEPNHAN        , A.CDRAVIEN_CHINH AS CHANDOANRAVIEN_BAK        from TT_NOITRU_BENHAN A        left join TT_TIEPNHAN B on B.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TT_NOITRU_NHAPVIEN C on C.TIEPNHAN_ID = B.TIEPNHAN_ID        where A.BENHAN_ID = '24642']
2020-02-26 14:35:24,042 [1] DEBUG - Statement Id: [DAO00080_GetNoiTruBenhAnChiTiet] PreparedStatement : [select *        from TT_NOITRU_BENHAN_CHITIET where        BENHAN_ID = '24642'        and BENHVIEN_ID = 'HLU01'        Order By BENHANCHITIET_ID DESC]
2020-02-26 14:35:26,896 [1] DEBUG - Statement Id: [DAO00080_GetNoiTruLuuTruBenhAn] PreparedStatement : [select *        from TT_NOITRU_LUUTRU where        BENHAN_ID = '24642'        and BENHVIEN_ID = 'HLU01'        Order By LUUTRU_ID ASC]
2020-02-26 14:35:26,928 [1] DEBUG - Statement Id: [DAO00080_GetGiuongBenhCuaBenhAn] PreparedStatement : [select *        from TT_NOITRU_GIUONGBENH where        BENHAN_ID =  @param0]
2020-02-26 14:35:26,929 [1] DEBUG - Statement Id: [DAO00080_GetGiuongBenhCuaBenhAn] Parameters: [@param0=[BENHAN_ID,24642]]
2020-02-26 14:35:26,929 [1] DEBUG - Statement Id: [DAO00080_GetGiuongBenhCuaBenhAn] Types: [@param0=[Int64, System.Int64]]
2020-02-26 14:35:27,034 [1] DEBUG - Statement Id: [DAO00067_laytrangthaibenhannoitru] PreparedStatement : [select isnull(TRANGTHAI, '') TRANGTHAI from TT_NOITRU_BENHAN where BENHAN_ID =  @param0]
2020-02-26 14:35:27,034 [1] DEBUG - Statement Id: [DAO00067_laytrangthaibenhannoitru] Parameters: [@param0=[BENHAN_ID,24642]]
2020-02-26 14:35:27,034 [1] DEBUG - Statement Id: [DAO00067_laytrangthaibenhannoitru] Types: [@param0=[Int64, System.Int64]]
2020-02-26 14:35:27,182 [1] DEBUG - Statement Id: [DAO00067_DeleteVienPhi_Noref] PreparedStatement : [delete from TT_VIENPHI where TIEPNHAN_ID = 107181 and (REF_ID is null or REF_ID = 0)         and           BENHAN_ID = '24642'                 delete TT_DUOC_TONKHO_BOOK_NOITRU where REF_TABLE = 'TT_NOITRU_TOATHUOC' and (REF_ID is null or REF_ID = 0)        delete TT_DUOC_TONKHO_BOOK_NGOAITRU where REF_ID is null or REF_ID = 0]
2020-02-26 14:35:27,739 [1] DEBUG - Statement Id: [DAO00067_UpdateBenhanIdVienPhi] PreparedStatement : [update TT_VIENPHI          set BENHAN_ID =  @param0           from (select TOATHUOC_ID from TT_NOITRU_TOATHUOC where TIEPNHAN_ID =  @param1 ) nttt          where REF_TABLE = 'TT_NOITRU_TOATHUOC' and REF_ID = nttt.TOATHUOC_ID and isnull(BENHAN_ID, 0) = 0          and TIEPNHAN_ID =  @param1             update TT_VIENPHI          set TT_VIENPHI.BENHAN_ID =  @param0           from (select DVYEUCAU_ID, BENHAN_ID from TT_DVYEUCAU where TIEPNHAN_ID =  @param1 ) nttt          where TT_VIENPHI.REF_TABLE = 'TT_DVYEUCAU' and TT_VIENPHI.REF_ID = nttt.DVYEUCAU_ID          and isnull(TT_VIENPHI.BENHAN_ID, 0) = 0 and isnull(nttt.BENHAN_ID, 0) > 0          and TT_VIENPHI.TIEPNHAN_ID =  @param1]
2020-02-26 14:35:27,739 [1] DEBUG - Statement Id: [DAO00067_UpdateBenhanIdVienPhi] Parameters: [@param0=[BENHAN_ID,24642], @param1=[TIEPNHAN_ID,107181]]
2020-02-26 14:35:27,739 [1] DEBUG - Statement Id: [DAO00067_UpdateBenhanIdVienPhi] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64]]
2020-02-26 14:35:27,847 [1] DEBUG - Statement Id: [DAO00064_GetlistTT_TIEPNHAN_SOTHEBHYT] PreparedStatement : [select stbhyt.*, ba.SOBENHAN,        tn.SOTIEPNHAN, tn.LOAITHANHVIEN_ID, tn.THE_ID, tn.THANHVIEN_ID,        tn.SUDUNG_BHTN, tn.BAOLANH_VIENPHI, tn.VIP, tn.NGUOINUOCNGOAI        from TT_TIEPNHAN_SOTHEBHYT stbhyt        left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = stbhyt.TIEPNHAN_ID        left join TT_NOITRU_BENHAN ba on ba.TIEPNHAN_ID = stbhyt.TIEPNHAN_ID        where        stbhyt.TIEPNHAN_ID = '107181' and isnull(stbhyt.KHONGSUDUNG, '0') = '0'         and           ba.BENHAN_ID = '24642']
2020-02-26 14:35:33,718 [1] DEBUG - Statement Id: [DAO00064_GetListVienPhiByTiepNnan] PreparedStatement : [select distinct        B.DOITUONG_ID, B.NGAYMIENDONGCHITRA, B.BENHNHAN_ID as TIEPNHAN_BENHNHAN_ID, B.TRAITUYEN,        B.BHYTTREN3NAM as TREN3NAM, B.BHYTTREN5NAM as TREN5NAM, B.SOTIEPNHAN, B.SOBENHAN,        B.LOAITHANHVIEN_ID, B.SUDUNG_BHTN, B.THE_ID, B.THANHVIEN_ID, B.BAOLANH_VIENPHI, B.VIP, B.NGUOINUOCNGOAI,        C.GIATRIMIENGIAM as GIATRIMIENGIAM, D.GIATRIMIENGIAM as GIATRIMIENGIAM_BHTN, E.GIATRIMIENGIAM as GIATRIMIENGIAM_THANHVIEN,        F.GIATRIMIENGIAM as GIATRIMIENGIAM_CONGTY, DVYC.THE_ID as DVDUNGTHE, DVYC.TRANGTHAI as TRANGTHAIDICHVU, ndv.MANHOMDICHVU,        A.* from TT_VIENPHI A        left join        (select B.*, C.SOBENHAN, C.BENHAN_ID        from TT_TIEPNHAN B        left join TT_NOITRU_BENHAN C on B.TIEPNHAN_ID = C.TIEPNHAN_ID         and           C.BENHAN_ID = '24642'                 where B.TIEPNHAN_ID = '107181') B on B.TIEPNHAN_ID = A.TIEPNHAN_ID        left join (select sum(GIATRIMIENGIAM) as GIATRIMIENGIAM, VIENPHI_ID, REF_TABLE        from TT_MIENGIAM_CHITIET        where REF_TABLE = 'TT_MIENGIAM'        and exists (select MIENGIAM_ID from TT_MIENGIAM where TT_MIENGIAM_CHITIET.MIENGIAM_ID = MIENGIAM_ID and TINHTRANG = 1 and TIEPNHAN_ID = '107181')        group by VIENPHI_ID, REF_TABLE) C on C.REF_TABLE = 'TT_MIENGIAM' and C.VIENPHI_ID = A.VIENPHI_ID        left join (select sum(GIATRIMIENGIAM) as GIATRIMIENGIAM, VIENPHI_ID, REF_TABLE        from TT_MIENGIAM_CHITIET        where REF_TABLE = 'TT_MIENGIAM_BHTN'        and exists (select MIENGIAM_BHTN_ID from TT_MIENGIAM_BHTN where TT_MIENGIAM_CHITIET.MIENGIAM_ID = MIENGIAM_BHTN_ID and  TINHTRANG = 1 and TIEPNHAN_ID = '107181')        group by VIENPHI_ID, REF_TABLE) D on D.REF_TABLE = 'TT_MIENGIAM_BHTN' and D.VIENPHI_ID = A.VIENPHI_ID        left join (select sum(GIATRIMIENGIAM) as GIATRIMIENGIAM, VIENPHI_ID, REF_TABLE        from TT_MIENGIAM_CHITIET        where REF_TABLE = 'TT_MIENGIAM_THANHVIEN'        and exists (select MIENGIAM_THANHVIEN_ID from TT_MIENGIAM_THANHVIEN where TT_MIENGIAM_CHITIET.MIENGIAM_ID = MIENGIAM_THANHVIEN_ID and TINHTRANG = 1 and TIEPNHAN_ID = '107181')        group by VIENPHI_ID, REF_TABLE) E on E.REF_TABLE = 'TT_MIENGIAM_THANHVIEN' and E.VIENPHI_ID = A.VIENPHI_ID        left join (select sum(GIATRIMIENGIAM) as GIATRIMIENGIAM, VIENPHI_ID, REF_TABLE        from TT_MIENGIAM_CHITIET        where REF_TABLE = 'TT_MIENGIAM_CONGTY'        and exists (select MIENGIAM_CONGTY_ID from TT_MIENGIAM_CONGTY where TT_MIENGIAM_CHITIET.MIENGIAM_ID = MIENGIAM_CONGTY_ID and TINHTRANG = 1 and TIEPNHAN_ID = '107181')        group by VIENPHI_ID, REF_TABLE) F on F.REF_TABLE = 'TT_MIENGIAM_CONGTY' and F.VIENPHI_ID = A.VIENPHI_ID        left join TT_DVYEUCAU DVYC on DVYC.DVYEUCAU_ID = A.REF_ID and A.REF_TABLE = 'TT_DVYEUCAU'        left join TM_DICHVU DV on DVYC.DICHVU_ID = DV.DICHVU_ID and A.REF_TABLE = 'TT_DVYEUCAU'        left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = DV.NHOMDICHVU_ID and A.REF_TABLE = 'TT_DVYEUCAU'        where        A.TIEPNHAN_ID = '107181' and ((DVYC.HUYYEUCAU = '0' and A.DICHVU_ID is not null)        or A.DUOC_ID is not null or A.REF_TABLE = 'TT_NUT_XACNHANSUATAN_CHITIET')        and A.ACTIVE = '1'         and           A.BENHAN_ID = '24642'                 and A.BENHVIEN_ID = 'HLU01'        order by A.VIENPHI_ID]
2020-02-26 14:35:34,626 [1] DEBUG - Statement Id: [DAO00006_GetListDuocTyle] PreparedStatement : [select DUOC_ID, DOITUONG_ID, (TYLE/100) as TYLE, DONGIA MUCTRAN_THANHTOAN from TM_DOITUONG_GIADUOC_TYLE            where            BENHVIEN_ID = 'HLU01'            and DOITUONG_ID = '4']
2020-02-26 14:35:34,674 [1] DEBUG - Statement Id: [DAO00027_GetListTuongTrinhDichVuPhauThuatCuaTiepNhan] PreparedStatement : [declare @ManhomDSA varchar(10);        declare @PhanLoaiNhomDV varchar(20) = '05';        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        if (@ManhomDSA is not null) set @PhanLoaiNhomDV += ',' + @ManhomDSA        select distinct ptyc.*        from TT_PHAUTHUAT_YEUCAU ptyc        inner join TM_DICHVU dv on dv.DICHVU_ID = ptyc.DICHVU_ID        inner join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID        inner join TT_PHAUTHUAT pt on pt.PHAUTHUAT_ID = ptyc.PHAUTHUAT_ID        where        pt.TIEPNHAN_ID = 107181        and (left(ndv.MANHOMDICHVU, 2) in (select * from STRING_SPLIT(@PhanLoaiNhomDV,',')) or ndv.MANHOMDICHVU in (select * from STRING_SPLIT(@PhanLoaiNhomDV,',')))]
2020-02-26 14:35:34,780 [1] DEBUG - Statement Id: [DAO00027_GetListTuongTrinhVTYTPhauThuatCuaTiepNhan] PreparedStatement : [select distinct ptvt.*        from TT_PHAUTHUAT_VTYT ptvt        inner join TT_PHAUTHUAT pt on pt.PHAUTHUAT_ID = ptvt.PHAUTHUAT_ID        inner join TM_DUOC d on d.DUOC_ID = ptvt.DUOC_ID        inner join TM_LOAIDUOC ld on ld.LOAIVATTU_ID = 'V' and ld.LOAIDUOC_ID = d.LOAIDUOC_ID        where pt.TIEPNHAN_ID = 107181        order by ptvt.PHAUTHUAT_VTYT_ID asc]
2020-02-26 14:35:34,931 [1] DEBUG - Statement Id: [DAO00006_GetList] PreparedStatement : [select dv.*, loaiDV.MALOAIDICHVU, captren.NHOMDICHVU_ID as NHOMDICHVU_CAPTREN_ID, captren.TENNHOMDICHVU as NHOMDICHVU_CAPTREN,              nhom_dv.TENNHOMDICHVU as TENNHOMDICHVU, nhom_dv.MANHOMDICHVU,              case when dv.ATTRIBUTE5 is null then 'TT' else 'KTC' end as LOAI_CHIPHI              from TM_DICHVU as dv              left join TM_NHOMDICHVU as nhom_dv on nhom_dv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID and nhom_dv.BENHVIEN_ID = 'HLU01'              left join TM_NHOMDICHVU as captren on nhom_dv.CAPTREN_ID = captren.NHOMDICHVU_ID and captren.BENHVIEN_ID = 'HLU01'              left join TM_LOAIDICHVU loaiDV on nhom_dv.LOAIDICHVU_ID = loaiDV.LOAIDICHVU_ID and loaiDV.BENHVIEN_ID = 'HLU01'              where nhom_dv.TAMNGUNG = '0' and dv.BENHVIEN_ID = 'HLU01'              and dv.TAMNGUNG = '0'               AND                   loaiDV.MALOAIDICHVU = 'KhamBenh']
2020-02-26 14:35:35,029 [1] DEBUG - Statement Id: [DAO00027_GetDichvuYCBHYTTyle] PreparedStatement : [select DVYEUCAU_ID from TT_DVYEUCAU        where TIEPNHAN_ID = 107181 and isnull(BHYT_TYLETHANHTOAN_ID, 0) > 0]
2020-02-26 14:35:35,260 [1] DEBUG - Statement Id: [DAO00023_UpdateNhieuVP] PreparedStatement : [declare @jsonVienPhi nvarchar(max) = N'[{"VIENPHI_ID":3109614,"TIEPNHAN_ID":107181,"DICHVU_ID":5440,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":34500.0000,"THANHTIEN_DOANHTHU":34500.00,"BHYT_TL":0.8000,"BHYT_DONGIA":34500.0000,"BHYT_THANHTIEN":34500.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":27600.0,"BHYT_THANHTIEN_CHITRA":27600.00,"BENHNHAN_PHAITHANHTOAN":6900.00,"GIATRI_HOADON":6900.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3109615,"TIEPNHAN_ID":107181,"DICHVU_ID":5554,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":5000.0000,"THANHTIEN_DOANHTHU":5000.00,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":5000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110619,"TIEPNHAN_ID":107181,"DICHVU_ID":4022,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":43900.0000,"THANHTIEN_DOANHTHU":43900.00,"BHYT_TL":0.8000,"BHYT_DONGIA":43900.0000,"BHYT_THANHTIEN":43900.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":35120.0,"BHYT_THANHTIEN_CHITRA":35120.00,"BENHNHAN_PHAITHANHTOAN":8780.00,"GIATRI_HOADON":8780.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110620,"TIEPNHAN_ID":107181,"DICHVU_ID":4422,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":32800.0000,"THANHTIEN_DOANHTHU":32800.00,"BHYT_TL":0.8000,"BHYT_DONGIA":32800.0000,"BHYT_THANHTIEN":32800.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":26240.0,"BHYT_THANHTIEN_CHITRA":26240.00,"BENHNHAN_PHAITHANHTOAN":6560.00,"GIATRI_HOADON":6560.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110621,"TIEPNHAN_ID":107181,"DICHVU_ID":4451,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":63500.0000,"THANHTIEN_DOANHTHU":63500.00,"BHYT_TL":0.8000,"BHYT_DONGIA":63500.0000,"BHYT_THANHTIEN":63500.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":50800.0,"BHYT_THANHTIEN_CHITRA":50800.00,"BENHNHAN_PHAITHANHTOAN":12700.00,"GIATRI_HOADON":12700.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110622,"TIEPNHAN_ID":107181,"DICHVU_ID":4454,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":40400.0000,"THANHTIEN_DOANHTHU":40400.00,"BHYT_TL":0.8000,"BHYT_DONGIA":40400.0000,"BHYT_THANHTIEN":40400.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":32320.0,"BHYT_THANHTIEN_CHITRA":32320.00,"BENHNHAN_PHAITHANHTOAN":8080.00,"GIATRI_HOADON":8080.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110623,"TIEPNHAN_ID":107181,"DICHVU_ID":4523,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":40400.0000,"THANHTIEN_DOANHTHU":40400.00,"BHYT_TL":0.8000,"BHYT_DONGIA":40400.0000,"BHYT_THANHTIEN":40400.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":32320.0,"BHYT_THANHTIEN_CHITRA":32320.00,"BENHNHAN_PHAITHANHTOAN":8080.00,"GIATRI_HOADON":8080.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110624,"TIEPNHAN_ID":107181,"DICHVU_ID":4596,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":39100.0000,"THANHTIEN_DOANHTHU":39100.00,"BHYT_TL":0.8000,"BHYT_DONGIA":39100.0000,"BHYT_THANHTIEN":39100.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":31280.0,"BHYT_THANHTIEN_CHITRA":31280.00,"BENHNHAN_PHAITHANHTOAN":7820.00,"GIATRI_HOADON":7820.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110626,"TIEPNHAN_ID":107181,"DICHVU_ID":4642,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":21500.0000,"THANHTIEN_DOANHTHU":21500.00,"BHYT_TL":0.8000,"BHYT_DONGIA":21500.0000,"BHYT_THANHTIEN":21500.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":17200.0,"BHYT_THANHTIEN_CHITRA":17200.00,"BENHNHAN_PHAITHANHTOAN":4300.00,"GIATRI_HOADON":4300.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110628,"TIEPNHAN_ID":107181,"DICHVU_ID":4681,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":21500.0000,"THANHTIEN_DOANHTHU":21500.00,"BHYT_TL":0.8000,"BHYT_DONGIA":21500.0000,"BHYT_THANHTIEN":21500.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":17200.0,"BHYT_THANHTIEN_CHITRA":17200.00,"BENHNHAN_PHAITHANHTOAN":4300.00,"GIATRI_HOADON":4300.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110629,"TIEPNHAN_ID":107181,"DICHVU_ID":4722,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":21500.0000,"THANHTIEN_DOANHTHU":21500.00,"BHYT_TL":0.8000,"BHYT_DONGIA":21500.0000,"BHYT_THANHTIEN":21500.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":17200.0,"BHYT_THANHTIEN_CHITRA":17200.00,"BENHNHAN_PHAITHANHTOAN":4300.00,"GIATRI_HOADON":4300.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110630,"TIEPNHAN_ID":107181,"DICHVU_ID":4747,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":27400.0000,"THANHTIEN_DOANHTHU":27400.00,"BHYT_TL":0.8000,"BHYT_DONGIA":27400.0000,"BHYT_THANHTIEN":27400.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":21920.0,"BHYT_THANHTIEN_CHITRA":21920.00,"BENHNHAN_PHAITHANHTOAN":5480.00,"GIATRI_HOADON":5480.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110631,"TIEPNHAN_ID":107181,"DICHVU_ID":4832,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":70000.0000,"THANHTIEN_DOANHTHU":70000.00,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":70000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":70000.0000,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":70000.0000,"GIATRI_BENHNHAN_DATHANHTOAN":70000.0000,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110632,"TIEPNHAN_ID":107181,"DICHVU_ID":4873,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":70000.0000,"THANHTIEN_DOANHTHU":70000.00,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":70000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":70000.0000,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":70000.0000,"GIATRI_BENHNHAN_DATHANHTOAN":70000.0000,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119342,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":5.0000,"DONGIA_DOANHTHU":4000.0000,"THANHTIEN_DOANHTHU":20000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":20000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119500,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":2.0000,"DONGIA_DOANHTHU":8715.0000,"THANHTIEN_DOANHTHU":17430.00,"BHYT_TL":0.8000,"BHYT_DONGIA":8715.0000,"BHYT_THANHTIEN":17430.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":6972.0,"BHYT_THANHTIEN_CHITRA":13944.00,"BENHNHAN_PHAITHANHTOAN":3486.00,"GIATRI_HOADON":3486.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119501,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":8925.0000,"THANHTIEN_DOANHTHU":8925.00,"BHYT_TL":0.8000,"BHYT_DONGIA":8925.0000,"BHYT_THANHTIEN":8925.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":7140.0,"BHYT_THANHTIEN_CHITRA":7140.00,"BENHNHAN_PHAITHANHTOAN":1785.00,"GIATRI_HOADON":1785.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119502,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":2.0000,"DONGIA_DOANHTHU":27990.0000,"THANHTIEN_DOANHTHU":55980.00,"BHYT_TL":0.8000,"BHYT_DONGIA":27990.0000,"BHYT_THANHTIEN":55980.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":22392.0,"BHYT_THANHTIEN_CHITRA":44784.00,"BENHNHAN_PHAITHANHTOAN":11196.00,"GIATRI_HOADON":11196.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119503,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":8925.0000,"THANHTIEN_DOANHTHU":8925.00,"BHYT_TL":0.8000,"BHYT_DONGIA":8925.0000,"BHYT_THANHTIEN":8925.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":7140.0,"BHYT_THANHTIEN_CHITRA":7140.00,"BENHNHAN_PHAITHANHTOAN":1785.00,"GIATRI_HOADON":1785.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119504,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":2.0000,"DONGIA_DOANHTHU":8295.0000,"THANHTIEN_DOANHTHU":16590.00,"BHYT_TL":0.8000,"BHYT_DONGIA":8295.0000,"BHYT_THANHTIEN":16590.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":6636.0,"BHYT_THANHTIEN_CHITRA":13272.00,"BENHNHAN_PHAITHANHTOAN":3318.00,"GIATRI_HOADON":3318.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119505,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":458000.0000,"THANHTIEN_DOANHTHU":458000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":398036.0000,"BHYT_THANHTIEN":398036.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":318428.8,"BHYT_THANHTIEN_CHITRA":318428.80,"BENHNHAN_PHAITHANHTOAN":139571.20,"GIATRI_HOADON":79607.20,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119506,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":50400.0000,"THANHTIEN_DOANHTHU":50400.00,"BHYT_TL":0.8000,"BHYT_DONGIA":50400.0000,"BHYT_THANHTIEN":50400.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":40320.0,"BHYT_THANHTIEN_CHITRA":40320.00,"BENHNHAN_PHAITHANHTOAN":10080.00,"GIATRI_HOADON":10080.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119530,"TIEPNHAN_ID":107181,"DICHVU_ID":5363,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":10000.0000,"THANHTIEN_DOANHTHU":10000.00,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119531,"TIEPNHAN_ID":107181,"DICHVU_ID":5588,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":2400.0000,"THANHTIEN_DOANHTHU":2400.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119532,"TIEPNHAN_ID":107181,"DICHVU_ID":477,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":110000.0000,"THANHTIEN_DOANHTHU":110000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119533,"TIEPNHAN_ID":107181,"DICHVU_ID":5602,"BENHAN_ID":24642,"SOLUONG":0.5000,"DONGIA_DOANHTHU":200000.0000,"THANHTIEN_DOANHTHU":100000.00,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":100000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119535,"TIEPNHAN_ID":107181,"DICHVU_ID":3161,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":2945000.0000,"THANHTIEN_DOANHTHU":2945000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":2945000.0000,"BHYT_THANHTIEN":2945000.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":2356000.0,"BHYT_THANHTIEN_CHITRA":2356000.00,"BENHNHAN_PHAITHANHTOAN":589000.00,"GIATRI_HOADON":589000.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119536,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":0.2500,"DONGIA_DOANHTHU":25000.0000,"THANHTIEN_DOANHTHU":6250.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119537,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":2.0000,"DONGIA_DOANHTHU":1700.0000,"THANHTIEN_DOANHTHU":3400.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119538,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":3.0000,"DONGIA_DOANHTHU":1000.0000,"THANHTIEN_DOANHTHU":3000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119539,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":3.0000,"DONGIA_DOANHTHU":2000.0000,"THANHTIEN_DOANHTHU":6000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119540,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":4000.0000,"THANHTIEN_DOANHTHU":4000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119541,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":3000.0000,"THANHTIEN_DOANHTHU":3000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119542,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":100.0000,"DONGIA_DOANHTHU":50.0000,"THANHTIEN_DOANHTHU":5000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119543,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":150000.0000,"THANHTIEN_DOANHTHU":150000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119544,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":160000.0000,"THANHTIEN_DOANHTHU":160000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119545,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":20.0000,"DONGIA_DOANHTHU":3000.0000,"THANHTIEN_DOANHTHU":60000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119546,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":20.0000,"DONGIA_DOANHTHU":6000.0000,"THANHTIEN_DOANHTHU":120000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119547,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":5.0000,"DONGIA_DOANHTHU":4000.0000,"THANHTIEN_DOANHTHU":20000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119548,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":10.0000,"DONGIA_DOANHTHU":8000.0000,"THANHTIEN_DOANHTHU":80000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119549,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":2.0000,"DONGIA_DOANHTHU":500.0000,"THANHTIEN_DOANHTHU":1000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119550,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":10000.0000,"THANHTIEN_DOANHTHU":10000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119551,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":45000.0000,"THANHTIEN_DOANHTHU":45000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119552,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":35000.0000,"THANHTIEN_DOANHTHU":35000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119553,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":10000.0000,"THANHTIEN_DOANHTHU":10000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119554,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":20000.0000,"THANHTIEN_DOANHTHU":20000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119555,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":6500.0000,"THANHTIEN_DOANHTHU":6500.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119556,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":0.5000,"DONGIA_DOANHTHU":16000.0000,"THANHTIEN_DOANHTHU":8000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119557,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":0.2500,"DONGIA_DOANHTHU":100000.0000,"THANHTIEN_DOANHTHU":25000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119558,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":2.0000,"DONGIA_DOANHTHU":10000.0000,"THANHTIEN_DOANHTHU":20000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119559,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":60000.0000,"THANHTIEN_DOANHTHU":60000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119560,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":2.0000,"DONGIA_DOANHTHU":13500.0000,"THANHTIEN_DOANHTHU":27000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119561,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":6000.0000,"THANHTIEN_DOANHTHU":6000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null}]';        begin        UPDATE TT_VIENPHI        SET        SOLUONG = json.SOLUONG,        DONGIA_DOANHTHU = json.DONGIA_DOANHTHU,        THANHTIEN_DOANHTHU = json.THANHTIEN_DOANHTHU,        BHYT_TL = json.BHYT_TL,        BHYT_DONGIA = json.BHYT_DONGIA,        BHYT_THANHTIEN = json.BHYT_THANHTIEN,        BHYT_DONGIA_CONGKHAM_DAU = json.BHYT_DONGIA_CONGKHAM_DAU,        BHYT_CONGKHAM_DAU_TYLE = json.BHYT_CONGKHAM_DAU_TYLE,        BHYT_DONGIA_CHITRA = json.BHYT_DONGIA_CHITRA,        BHYT_THANHTIEN_CHITRA = json.BHYT_THANHTIEN_CHITRA,        BENHNHAN_PHAITHANHTOAN = json.BENHNHAN_PHAITHANHTOAN,        GIATRI_HOADON = json.GIATRI_HOADON,        GIATRI_BIENLAI = json.GIATRI_BIENLAI,        DATHUCHIEN = json.DATHUCHIEN,        DICHVU_TL = json.DICHVU_TL,        BHYT_DONGIA_DONGCT_DAU = json.BHYT_DONGIA_DONGCT_DAU,        SOLONHAP_ID = json.SOLONHAP_ID,        DUOC_TYLE = json.DUOC_TYLE,        DUOC_MUCTRAN_THANHTOAN = json.DUOC_MUCTRAN_THANHTOAN,        NGAYCAPNHAT = GETDATE()        FROM OPENJSON (@jsonVienPhi)        WITH (        VIENPHI_ID int,        SOLUONG numeric(25, 4),        DONGIA_DOANHTHU numeric(25, 4),        THANHTIEN_DOANHTHU numeric(25, 4),        BHYT_TL numeric(25, 4),        BHYT_DONGIA numeric(25, 4),        BHYT_THANHTIEN numeric(25, 4),        BHYT_DONGIA_CONGKHAM_DAU numeric(25, 4),        BHYT_CONGKHAM_DAU_TYLE numeric(25, 4),        BHYT_DONGIA_CHITRA numeric(25, 4),        BHYT_THANHTIEN_CHITRA numeric(25, 4),        BENHNHAN_PHAITHANHTOAN numeric(25, 4),        GIATRI_HOADON numeric(25, 4),        GIATRI_BIENLAI numeric(25, 4),        DATHUCHIEN char(1),        KHONGTHUTIEN char(1),        BHYTDONGTIEN char(1),        DICHVU_TL numeric(25, 4),        BHYT_DONGIA_DONGCT_DAU numeric(25, 4),        SOLONHAP_ID int,        DUOC_TYLE numeric(25, 4),        DUOC_MUCTRAN_THANHTOAN numeric(25, 4))  json        WHERE TT_VIENPHI.VIENPHI_ID = json.VIENPHI_ID and json.DONGIA_DOANHTHU > 0                  insert into TT_TINH_VIENPHI_LOG        SELECT json.VIENPHI_ID, json.TIEPNHAN_ID, json.BENHAN_ID, json.SOLUONG, json.BHYT_TL, json.DONGIA_DOANHTHU,        json.THANHTIEN_DOANHTHU, json.BHYT_DONGIA, json.BHYT_THANHTIEN, json.BHYT_DONGIA_CHITRA, json.BHYT_THANHTIEN_CHITRA, json.BENHNHAN_PHAITHANHTOAN,        json.SOBHYT_HUONG_ID, json.SOBHYT, GETDATE(), -1, 'HLU01'        FROM OPENJSON(@jsonVienPhi)        WITH (        VIENPHI_ID int,        TIEPNHAN_ID int,        BENHAN_ID int,        SOLUONG numeric(25, 4),        DONGIA_DOANHTHU numeric(25, 4),        THANHTIEN_DOANHTHU numeric(25, 4),        BHYT_TL numeric(25, 4),        BHYT_DONGIA numeric(25, 4),        BHYT_THANHTIEN numeric(25, 4),        BHYT_DONGIA_CHITRA numeric(25, 4),        BHYT_THANHTIEN_CHITRA numeric(25, 4),        BENHNHAN_PHAITHANHTOAN numeric(25, 4),        SOBHYT_HUONG_ID int,        SOBHYT nvarchar(30)) json        end]
2020-02-26 14:35:35,502 [1] DEBUG - Statement Id: [DAO00067_UpdateDataVienPhiDongiaBHYT] PreparedStatement : [update TT_VIENPHI          set BHYT_DONGIA_CHITRA = 0, BHYT_THANHTIEN = 0, BHYT_THANHTIEN_CHITRA = 0          where          TIEPNHAN_ID = 107181 and BHYT_DONGIA = 0          and (BHYT_DONGIA_CHITRA > 0 or BHYT_THANHTIEN > 0 or BHYT_THANHTIEN_CHITRA > 0)]
2020-02-26 14:35:35,527 [1] DEBUG - Statement Id: [DAO00067_CapnhatDataVienphiKhiHuyThanhtoanHoadon] PreparedStatement : [update TT_VIENPHI        set TT_VIENPHI.HOADON_ID = hdct.HOADON_ID, TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN = TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN + hdct.GIATRI_BENHNHAN_DATHANHTOAN        from (select CT.HOADON_ID, CT.VIENPHI_ID, CT.GIATRI_BENHNHAN_DATHANHTOAN        from TT_HOADON_CHITIET_NGOAITRU CT        join TT_HOADON HD on HD.HOADON_ID = CT.HOADON_ID        join TT_VIENPHI vp on vp.VIENPHI_ID = ct.VIENPHI_ID        where HD.DATHANHTOAN = 1 and HD.HUYHOADON = 0 and HD.HOANTRA = 0 and vp.TIEPNHAN_ID =  @param0 ) hdct        where        TT_VIENPHI.VIENPHI_ID = hdct.VIENPHI_ID and TT_VIENPHI.HOADON_ID is null and isnull(TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN,0) = 0        and TT_VIENPHI.TIEPNHAN_ID =  @param0           update TT_VIENPHI        set TT_VIENPHI.HOADON_ID = null, TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN = TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN - hdct.GIATRI_BENHNHAN_DATHANHTOAN,        TT_VIENPHI.DATHANHTOAN = '0'        from (select CT.HOADON_ID, CT.VIENPHI_ID, CT.GIATRI_BENHNHAN_DATHANHTOAN        from TT_HOADON_CHITIET_NGOAITRU CT        join TT_HOADON HD on HD.HOADON_ID = CT.HOADON_ID        join TT_VIENPHI vp on vp.VIENPHI_ID = ct.VIENPHI_ID and vp.HOADON_ID = ct.HOADON_ID        where HD.DATHANHTOAN = 0 and (HD.HUYHOADON = 1 or HD.HOANTRA = 1) and vp.TIEPNHAN_ID =  @param0 ) hdct        where        TT_VIENPHI.VIENPHI_ID = hdct.VIENPHI_ID and TT_VIENPHI.HOADON_ID = hdct.HOADON_ID        and TT_VIENPHI.TIEPNHAN_ID =  @param0]
2020-02-26 14:35:35,527 [1] DEBUG - Statement Id: [DAO00067_CapnhatDataVienphiKhiHuyThanhtoanHoadon] Parameters: [@param0=[TIEPNHAN_ID,107181]]
2020-02-26 14:35:35,527 [1] DEBUG - Statement Id: [DAO00067_CapnhatDataVienphiKhiHuyThanhtoanHoadon] Types: [@param0=[Int64, System.Int64]]
2020-02-26 14:35:37,863 [1] DEBUG - Statement Id: [DAO00305_GetListLoaiBenhAn] PreparedStatement : [select        DICTIONARY_ID as LOAIBENHAN_ID        , DICTIONARY_NAME as TENLOAIBENHAN        , DICTIONARY_NAME_EN        , DICTIONARY_CODE        , DICTIONARY_NAME        from LST_DICTIONARY        where LST_DICTIONARY.Enabled = '1' and DICTIONARY_TYPE_CODE = 'LoaiBenhAn'        order by LST_DICTIONARY.IDX]
2020-02-26 14:35:54,637 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'IPD60'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 14:35:55,968 [1] DEBUG - Statement Id: [DAO00040_LayListToaMau] PreparedStatement : [select A.*, dc.TENDUOCDAYDU, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ld.MALOAIDUOC, dd.DICTIONARY_NAME DUONGDUNG, dc.TAMNGUNG            from TT_TOATHUOCMAU A            left join TM_DUOC dc on A.DUOC_ID = dc.DUOC_ID            left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID            left join (select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE like 'DuongDung') dd on dd.DICTIONARY_ID = dc.DUONGDUNG_ID            where (1=1)]
2020-02-26 14:35:59,090 [1] DEBUG - Statement Id: [DAO00040_LayListToaMau] PreparedStatement : [select A.*, dc.TENDUOCDAYDU, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ld.MALOAIDUOC, dd.DICTIONARY_NAME DUONGDUNG, dc.TAMNGUNG            from TT_TOATHUOCMAU A            left join TM_DUOC dc on A.DUOC_ID = dc.DUOC_ID            left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID            left join (select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE like 'DuongDung') dd on dd.DICTIONARY_ID = dc.DUONGDUNG_ID            where (1=1)]
2020-02-26 14:36:02,995 [1] DEBUG - Statement Id: [DAO00017_GetLoaiGiaByDoiTuongId] PreparedStatement : [select dtlg.DOUUTIEN, dtlg.DOITUONG_ID, lg.LOAIGIA_ID, lg.TENLOAIGIA, lg.MALOAIGIA              from TM_LOAIGIA lg              left join TM_DOITUONG_LOAIGIA dtlg              on lg.LOAIGIA_ID = dtlg.LOAIGIA_ID and dtlg.BENHVIEN_ID = 'HLU01'              where lg.TAMNGUNG = 0 and lg.BENHVIEN_ID = 'HLU01'                             order by dtlg.DOUUTIEN]
2020-02-26 14:36:03,379 [1] DEBUG - Statement Id: [DAO00063_GetListKhoThuocPhongBanPhamvi] PreparedStatement : [select distinct dpv.*        from TM_DUOC_PHAMVISD_MAPPING dmap        left join TM_DUOC_PHAMVISUDUNG dpv on dpv.PHAMVI_ID = dmap.PHAMVI_ID        where dmap.KHODUOC_ID in (select KHODUOC_ID from TM_PHONGBAN_KHODUOC where PHONGBAN_ID = '25')]
2020-02-26 14:36:04,220 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1027']
2020-02-26 14:36:04,278 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1030']
2020-02-26 14:36:05,263 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1032']
2020-02-26 14:36:05,290 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1057']
2020-02-26 14:36:05,375 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1027']
2020-02-26 14:36:05,405 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1030']
2020-02-26 14:36:05,438 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1032']
2020-02-26 14:36:05,469 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1057']
2020-02-26 14:36:05,495 [1] DEBUG - Statement Id: [DAO00063_GetListPhamviTuKhoThuocVaPhongBan] PreparedStatement : [select distinct dpv.*, dmap.KHODUOC_ID        from TM_DUOC_PHAMVISD_MAPPING dmap        left join TM_DUOC_PHAMVISUDUNG dpv on dpv.PHAMVI_ID = dmap.PHAMVI_ID and dpv.TAMNGUNG != '1'        where dmap.KHODUOC_ID in (select KHODUOC_ID from TM_PHONGBAN_KHODUOC where PHONGBAN_ID = '25')        and dmap.KHODUOC_ID = '29' and dpv.MAPHAMVI is not null]
2020-02-26 14:36:05,620 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 999999999 as SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        where  @param0  = 0        union all        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end        else        begin        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO        group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end]
2020-02-26 14:36:05,620 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Parameters: [@param0=[PHAMVI_ID,1027]]
2020-02-26 14:36:05,620 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Types: [@param0=[Int64, System.Int64]]
2020-02-26 14:36:07,025 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 999999999 as SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        where  @param0  = 0        union all        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end        else        begin        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO        group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end]
2020-02-26 14:36:07,025 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Parameters: [@param0=[PHAMVI_ID,1027]]
2020-02-26 14:36:07,025 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Types: [@param0=[Int64, System.Int64]]
2020-02-26 14:36:09,487 [1] DEBUG - Statement Id: [DAO00096_GetList] PreparedStatement : [select *        from TM_DUOC_THANHPHANHOATCHAT        where BENHVIEN_ID = 'HLU01']
2020-02-26 14:36:09,632 [1] DEBUG - Statement Id: [DAO00040_LayListToaMau] PreparedStatement : [select A.*, dc.TENDUOCDAYDU, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ld.MALOAIDUOC, dd.DICTIONARY_NAME DUONGDUNG, dc.TAMNGUNG            from TT_TOATHUOCMAU A            left join TM_DUOC dc on A.DUOC_ID = dc.DUOC_ID            left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID            left join (select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE like 'DuongDung') dd on dd.DICTIONARY_ID = dc.DUONGDUNG_ID            where (1=1)]
2020-02-26 14:36:17,490 [1] DEBUG - Statement Id: [DAO00063_GetListKhoThuocPhongBanPhamvi] PreparedStatement : [select distinct dpv.*        from TM_DUOC_PHAMVISD_MAPPING dmap        left join TM_DUOC_PHAMVISUDUNG dpv on dpv.PHAMVI_ID = dmap.PHAMVI_ID        where dmap.KHODUOC_ID in (select KHODUOC_ID from TM_PHONGBAN_KHODUOC where PHONGBAN_ID = '25')]
2020-02-26 14:36:17,650 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1027']
2020-02-26 14:36:17,806 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1030']
2020-02-26 14:36:17,829 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1032']
2020-02-26 14:36:17,853 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1057']
2020-02-26 14:36:17,885 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1027']
2020-02-26 14:36:17,908 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1030']
2020-02-26 14:36:17,932 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1032']
2020-02-26 14:36:17,959 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1057']
2020-02-26 14:36:17,982 [1] DEBUG - Statement Id: [DAO00063_GetListPhamviTuKhoThuocVaPhongBan] PreparedStatement : [select distinct dpv.*, dmap.KHODUOC_ID        from TM_DUOC_PHAMVISD_MAPPING dmap        left join TM_DUOC_PHAMVISUDUNG dpv on dpv.PHAMVI_ID = dmap.PHAMVI_ID and dpv.TAMNGUNG != '1'        where dmap.KHODUOC_ID in (select KHODUOC_ID from TM_PHONGBAN_KHODUOC where PHONGBAN_ID = '25')        and dmap.KHODUOC_ID = '29' and dpv.MAPHAMVI is not null]
2020-02-26 14:36:18,020 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 999999999 as SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        where  @param0  = 0        union all        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end        else        begin        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO        group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end]
2020-02-26 14:36:18,020 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Parameters: [@param0=[PHAMVI_ID,1027]]
2020-02-26 14:36:18,020 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Types: [@param0=[Int64, System.Int64]]
2020-02-26 14:36:18,142 [1] DEBUG - Statement Id: [DAO00063_Getlist_Thuoc_Tamngung] PreparedStatement : [select DUOC_ID FROM TM_DUOC where TAMNGUNG = '1']
2020-02-26 14:36:18,259 [1] DEBUG - Statement Id: [DAO00061_GetLuuTruIDByBenhAnID] PreparedStatement : [select lt.LUUTRU_ID, ba.BACSIDIEUTRI_ID as BACSIDIEUTRICHINH_ID        from TT_NOITRU_LUUTRU lt        left join TT_NOITRU_BENHAN ba on lt.BENHAN_ID = ba.BENHAN_ID        where lt.BENHAN_ID = '24642']
2020-02-26 14:36:18,296 [1] DEBUG - Statement Id: [DAO00061_GetChanDoanBenhAnID] PreparedStatement : [DECLARE @ICDPHU NVARCHAR(2000)=''        DECLARE @LISTICDPHU NVARCHAR(200)        DECLARE @CHANDOANRAVIEN NVARCHAR(500)        DECLARE @LISTICDPHUVAOKHOA NVARCHAR(50)        DECLARE @ICDPHUVAOKHOA NVARCHAR(500)=''        DECLARE @ICDKHAMBENH NVARCHAR(500) = (SELECT ICD.TENICD + '('+ISNULL(ICD.MAICD,'')+')'        FROM TT_NOITRU_BENHAN BA INNER JOIN TM_ICD ICD        ON BA.ICD_KHAMBENH = ICD.ICD_ID WHERE BA.BENHAN_ID =  @param0 )        DECLARE @ICDCHINH NVARCHAR(500) = (SELECT ICD.TENICD + '('+ISNULL(ICD.MAICD,'')+')'        FROM TT_NOITRU_BENHAN BA INNER JOIN TM_ICD ICD        ON BA.ICD_BENHCHINH = ICD.ICD_ID WHERE BA.BENHAN_ID =  @param0 )        SELECT @CHANDOANRAVIEN = BA.CHANDOANRAVIEN, @LISTICDPHU = BA.ICD_BENHPHU, @LISTICDPHUVAOKHOA = BA.ICD_PHU_VAOKHOA        FROM TT_NOITRU_BENHAN BA WHERE BA.BENHAN_ID =  @param0         SELECT @ICDPHU = @ICDPHU + ISNULL(TENICD, '') +'(' +ISNULL(MAICD,'')+ '); ' FROM TM_ICD WHERE MAICD IN (SELECT S FROM SplitString(@LISTICDPHU,';'))        SELECT @ICDPHUVAOKHOA = @ICDPHUVAOKHOA + ISNULL(TENICD, '') +'(' +ISNULL(MAICD,'')+ '); ' FROM TM_ICD WHERE MAICD IN (SELECT S FROM SplitString(@LISTICDPHUVAOKHOA,';'))        SELECT ICD_KHAMBENH, CHANDOANKHAMBENH, CHANDOANVAOKHOA, CHANDOANRAVIEN, CHANDOANKHAC                , CASE        WHEN LEN(ISNULL(BA.CDRAVIEN_PHU,'')) > 0 AND LEN(ISNULL(BA.CDRAVIEN_CHINH,'')) > 0 THEN ISNULL(BA.CDRAVIEN_CHINH,'') + '; ' + ISNULL(BA.CDRAVIEN_PHU,'')        WHEN LEN(ISNULL(BA.CDRAVIEN_PHU,'')) > 0 AND LEN(ISNULL(BA.CDRAVIEN_CHINH,'')) <= 0  THEN BA.CDRAVIEN_PHU        WHEN LEN(ISNULL(BA.CDRAVIEN_PHU,'')) <= 0 AND LEN(ISNULL(BA.CDRAVIEN_CHINH,'')) > 0 THEN BA.CDRAVIEN_CHINH        ELSE NULL END AS CHANDOANNOITRU        ,CASE WHEN @ICDKHAMBENH IS NULL AND (@CHANDOANRAVIEN IS NULL OR @CHANDOANRAVIEN = '') THEN ''        ELSE ISNULL(@ICDKHAMBENH, '') + '; ' + ISNULL(@CHANDOANRAVIEN, '') END        AS CHANDOANCAPCUU        , @ICDPHUVAOKHOA AS CHANDOANPHUVAOKHOA        FROM TT_NOITRU_BENHAN BA LEFT JOIN TM_ICD ICD ON BA.ICD_KHAMBENH = ICD.ICD_ID        WHERE BENHAN_ID =  @param0]
2020-02-26 14:36:18,296 [1] DEBUG - Statement Id: [DAO00061_GetChanDoanBenhAnID] Parameters: [@param0=[BENHAN_ID,24642]]
2020-02-26 14:36:18,296 [1] DEBUG - Statement Id: [DAO00061_GetChanDoanBenhAnID] Types: [@param0=[Int64, System.Int64]]
2020-02-26 14:36:18,526 [1] DEBUG - Statement Id: [DAO00000_GetDoiTuongIsBHYT] PreparedStatement : [select * from TM_DOITUONG Where DOITUONG_ID = 4 and MADOITUONG like '%BHYT%']
2020-02-26 14:36:18,821 [1] DEBUG - Statement Id: [DAO00068_GetLastedSinhHieuInfo] PreparedStatement : [select top (1) *, CHISOBMI as BMI              from TT_NGOAITRU_KHAMBENH_SINHHIEU              where BENHNHAN_ID = '20633'              order by KHAMBENH_SINHHIEU_ID desc]
2020-02-26 14:36:18,878 [1] DEBUG - Statement Id: [DAO00013_GetTienSuBenh] PreparedStatement : [select TIENSUBENH, TIENSUDIUNG        from TT_BENHNHAN        where TT_BENHNHAN.BENHNHAN_ID  = '20633']
2020-02-26 14:36:19,171 [1] DEBUG - Statement Id: [DAO00095_GetTTDiUngThuoc] PreparedStatement : [select *              from TT_BENHNHAN_DIUNG_THUOC              where BENHNHAN_ID = '20633'              and BENHVIEN_ID = 'HLU01']
2020-02-26 14:36:19,221 [1] DEBUG - Statement Id: [DAO00062_GetKhamBenhByTiepNhanID] PreparedStatement : [select *        from TT_NOITRU_KHAMBENH        where BENHAN_ID in        (select BENHAN_ID from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '107181')        and ISYLENHVTYT = '0'         and           BENHAN_ID = '24642'                 order by THOIGIANKHAM desc]
2020-02-26 14:36:19,676 [1] DEBUG - Statement Id: [DAO00063_GetTrangThaiYLenhTheoTiepnhanId] PreparedStatement : [select tt.CHUNGTU_ID, tt.PHIEULINH_ID, tt.TRANGTHAI, pl.DUYET as DUYETPHIEULINH,        ct.CHUNGTU_ID as CHUNGTUXUATNOIBO_ID, ct.LOAICHUNGTU, tt.KHAMBENH_ID, tt.DUOC_ID, tt.SOLUONG        from TT_NOITRU_TOATHUOC tt        left join TT_DUOC_PHIEULINH pl on tt.PHIEULINH_ID = pl.CHUNGTU_ID        left join TT_DUOC_CHUNGTU ct on pl.CHUNGTU_ID = ct.PHIEULINH_ID        where tt.TIEPNHAN_ID = '107181'        and (tt.PHIEULINH_ID is not null or tt.CHUNGTU_ID is not null or (tt.TRANGTHAI = 'DADUYET'))        order by tt.CHUNGTU_ID DESC]
2020-02-26 14:36:20,364 [1] DEBUG - Statement Id: [DAO00063_GetDanhsachTrathuocTheoBenhanId] PreparedStatement : [select A.KHAMBENH_ID, B.TOATHUOC_ID, B.DUOC_ID, SUM(B.SOLUONG) SOLUONG        from TT_NOITRU_TRATHUOC A        left join TT_NOITRU_TRATHUOC_CHITIET B on A.TRATHUOC_ID = B.TRATHUOC_ID        where A.BENHAN_ID = '24642'         group by A.KHAMBENH_ID, B.TOATHUOC_ID, B.DUOC_ID]
2020-02-26 14:36:20,835 [1] DEBUG - Statement Id: [DAO00014_GetInPatientStatus] PreparedStatement : [select TRANGTHAI, isnull(KHOACHUYENDEN_ID, KHOAVAO_ID) as KHOAHIENTAI from TT_NOITRU_BENHAN        where        TIEPNHAN_ID = '107181'        and BENHVIEN_ID = 'HLU01'         and           BENHAN_ID = '24642']
2020-02-26 14:36:47,345 [1] DEBUG - Statement Id: [DAO00030_Get_DuocCanhBaoICD_ByBenhAn_ID] PreparedStatement : [select A.*          from TM_DUOC_CANHBAO_ICD A          inner join TM_DUOC_HOATCHAT B on B.HOATCHAT_ID = A.HOATCHAT_ID          inner join TM_DUOC_THANHPHANHOATCHAT C on C.HOATCHAT_ID = B.HOATCHAT_ID          inner join TM_DUOC D on D.DUOC_ID = C.DUOC_ID          inner join TT_NOITRU_BENHAN BA on (BA.ICD_VAOKHOA = A.ICD_ID or BA.ICD_KHAMBENH = A.ICD_ID or BA.ICD_BENHCHINH = A.ICD_ID or BA.ICDRAVIEN_CHINH = A.ICD_ID          or A.MAICD in (select part from fnSplit(BA.ICD_BENHPHU, ';'))           or A.MAICD in (select part from fnSplit(BA.ICDRAVIEN_PHU, ';'))          or A.MAICD in (select part from fnSplit(BA.ICD_PHU_VAOKHOA, ';'))) and BA.BENHAN_ID = 24642          where C.DUOC_ID = 1030          and A.TAMNGUNG = '0'          and A.BENHVIEN_ID = 'HLU01']
2020-02-26 14:36:47,930 [1] DEBUG - Statement Id: [DAO00013_GetTienSuBenh] PreparedStatement : [select TIENSUBENH, TIENSUDIUNG        from TT_BENHNHAN        where TT_BENHNHAN.BENHNHAN_ID  = '20633']
2020-02-26 14:36:48,071 [1] DEBUG - Statement Id: [DAO00095_GetTTDiUngThuoc] PreparedStatement : [select *              from TT_BENHNHAN_DIUNG_THUOC              where BENHNHAN_ID = '20633'              and BENHVIEN_ID = 'HLU01']
2020-02-26 14:36:48,254 [1] DEBUG - Statement Id: [DAO00096_GetList] PreparedStatement : [select *        from TM_DUOC_THANHPHANHOATCHAT        where BENHVIEN_ID = 'HLU01']
2020-02-26 14:36:48,297 [1] DEBUG - Statement Id: [DAO00013_GetTienSuBenh] PreparedStatement : [select TIENSUBENH, TIENSUDIUNG        from TT_BENHNHAN        where TT_BENHNHAN.BENHNHAN_ID  = '20633']
2020-02-26 14:36:48,653 [1] DEBUG - Statement Id: [DAO00095_GetTTDiUngThuoc] PreparedStatement : [select *              from TT_BENHNHAN_DIUNG_THUOC              where BENHNHAN_ID = '20633'              and BENHVIEN_ID = 'HLU01']
2020-02-26 14:36:48,700 [1] DEBUG - Statement Id: [DAO00016_GetTTDuocCanhBao] PreparedStatement : [select *        from TM_DUOC_CANHBAO         where                 DUOC_ID = '1030'             and               BENHVIEN_ID = 'HLU01'                     order by DUOC_CANHBAO_ID]
2020-02-26 14:36:52,266 [1] DEBUG - Statement Id: [DAO00000_GetCHECK_DOITUONG_BHYT] PreparedStatement : [select count(*) as DOITUONG_BHYT FROM TM_DOITUONG A            WHERE A.DOITUONG_ID = '4' and A.BENHVIEN_ID = 'HLU01' and MADOITUONG like '%BHYT%']
2020-02-26 14:37:06,262 [1] DEBUG - Statement Id: [DAO00000_GetLOAIGIATHUOC_NOI_NGOAI_VIEN] PreparedStatement : [SELECT LOAIGIA_ID              FROM TM_LOAIGIA              WHERE MALOAIGIA = 'GiaThuoc_NoiVien' and BENHVIEN_ID = 'HLU01']
2020-02-26 14:37:32,621 [1] DEBUG - Statement Id: [DAO00000_GetDUOC_DONGIADOANHTHU_NOIVIEN] PreparedStatement : [declare @doanhthuKhongHT numeric(24,2);          declare @doanhthu numeric(24,2);          declare @hotro numeric(24,2);          declare @bhyt char(1);          select top 1 @doanhthuKhongHT = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0 and GIAHOTRO != '1'          order by dtlg.DOUUTIEN asc          select top 1 @doanhthu = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0           order by dtlg.DOUUTIEN asc          select top 1 @hotro = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0  and GIAHOTRO = '1'          order by dtlg.DOUUTIEN asc          select top 1 @bhyt = BHYT from TM_DUOC where DUOC_ID = 1030          select ISNULL(@doanhthu,0.0) DONGIA_DOANHTHU, ISNULL(@hotro, 0.0) DONGIA_KHAC, ISNULL(@doanhthuKhongHT, 0.0) DONGIA_KHONGHT, isnull(@bhyt, '0') BHYT]
2020-02-26 14:38:26,504 [1] DEBUG - Statement Id: [DAO00000_GetDuocBHYT] PreparedStatement : [select count(*) BHYT FROM TM_DUOC A WHERE A.DUOC_ID = '1030' and BHYT = '1']
2020-02-26 14:38:27,906 [1] DEBUG - Statement Id: [DAO00000_GetCHECK_DOITUONG_BHYT] PreparedStatement : [select count(*) as DOITUONG_BHYT FROM TM_DOITUONG A            WHERE A.DOITUONG_ID = '4' and A.BENHVIEN_ID = 'HLU01' and MADOITUONG like '%BHYT%']
2020-02-26 14:38:29,132 [1] DEBUG - Statement Id: [DAO00000_GetLOAIGIATHUOC_NOI_NGOAI_VIEN] PreparedStatement : [SELECT LOAIGIA_ID              FROM TM_LOAIGIA              WHERE MALOAIGIA = 'GiaThuoc_NoiVien' and BENHVIEN_ID = 'HLU01']
2020-02-26 14:38:29,156 [1] DEBUG - Statement Id: [DAO00000_GetDUOC_DONGIADOANHTHU_NOIVIEN] PreparedStatement : [declare @doanhthuKhongHT numeric(24,2);          declare @doanhthu numeric(24,2);          declare @hotro numeric(24,2);          declare @bhyt char(1);          select top 1 @doanhthuKhongHT = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0 and GIAHOTRO != '1'          order by dtlg.DOUUTIEN asc          select top 1 @doanhthu = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0           order by dtlg.DOUUTIEN asc          select top 1 @hotro = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0  and GIAHOTRO = '1'          order by dtlg.DOUUTIEN asc          select top 1 @bhyt = BHYT from TM_DUOC where DUOC_ID = 1030          select ISNULL(@doanhthu,0.0) DONGIA_DOANHTHU, ISNULL(@hotro, 0.0) DONGIA_KHAC, ISNULL(@doanhthuKhongHT, 0.0) DONGIA_KHONGHT, isnull(@bhyt, '0') BHYT]
2020-02-26 14:38:29,360 [1] DEBUG - Statement Id: [DAO00000_GetDuocBHYT] PreparedStatement : [select count(*) BHYT FROM TM_DUOC A WHERE A.DUOC_ID = '1030' and BHYT = '1']
2020-02-26 14:38:33,660 [1] DEBUG - Statement Id: [DAO00062_GetThongTinNhapVienCuaBenhNhan] PreparedStatement : [select top 1 ba.THOIGIANVAOKHOA THOIGIANVAO        from TT_NOITRU_BENHAN ba        where ba.BENHAN_ID =  @param0]
2020-02-26 14:38:33,660 [1] DEBUG - Statement Id: [DAO00062_GetThongTinNhapVienCuaBenhNhan] Parameters: [@param0=[BENHAN_ID,24642]]
2020-02-26 14:38:33,660 [1] DEBUG - Statement Id: [DAO00062_GetThongTinNhapVienCuaBenhNhan] Types: [@param0=[Int64, System.Int64]]
2020-02-26 14:38:43,937 [1] DEBUG - Statement Id: [DAO00014_GetInPatientStatus] PreparedStatement : [select TRANGTHAI, isnull(KHOACHUYENDEN_ID, KHOAVAO_ID) as KHOAHIENTAI from TT_NOITRU_BENHAN        where        TIEPNHAN_ID = '107181'        and BENHVIEN_ID = 'HLU01'         and           BENHAN_ID = '24642']
--------------------------------------------------------------------------------
2020-02-26 14:40:02,606 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2020-02-26 14:40:05,555 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2020-02-26 14:40:05,593 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2020-02-26 14:40:06,347 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 14:40:29,523 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2020-02-26 14:43:09,880 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2020-02-26 14:43:09,910 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2020-02-26 14:43:11,204 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2020-02-26 14:43:11,393 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2020-02-26 14:43:12,154 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2020-02-26 14:43:12,273 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2020-02-26 14:43:12,341 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2020-02-26 14:43:12,407 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2020-02-26 14:43:12,471 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2020-02-26 14:43:12,535 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2020-02-26 14:43:12,682 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2020-02-26 14:43:12,748 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2020-02-26 14:43:12,811 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2020-02-26 14:43:13,320 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2020-02-26 14:43:13,418 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2020-02-26 14:43:13,494 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2020-02-26 14:43:13,522 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2020-02-26 14:43:14,126 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2020-02-26 14:43:14,155 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @NGUONDUOC_MACDINH varchar(5) = '0';        declare @TOAMUANGOAI int = 0;        select @NGUONDUOC_MACDINH = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'PHA_NGUONDUOC'        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + @NGUONDUOC_MACDINH as DUOC_KEY, 0 as PHAMVI_ID, @NGUONDUOC_MACDINH as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end        else        begin                select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (        select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID)        B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (        select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID)        A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2020-02-26 14:43:15,707 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2020-02-26 14:43:15,740 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,        SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH        FROM TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID        WHERE TK.SOLUONG > 0        GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2020-02-26 14:43:15,831 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2020-02-26 14:43:15,860 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,        TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,        TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH        from TM_MAU M        JOIN        (        select        A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO        from        (        select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO        from TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'        where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0        ) A        )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2020-02-26 14:43:15,946 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2020-02-26 14:43:16,882 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 14:43:17,752 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2020-02-26 14:43:22,697 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2020-02-26 14:43:22,725 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2020-02-26 14:43:22,797 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 14:43:22,894 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 14:43:23,018 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2020-02-26 14:43:23,020 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2020-02-26 14:43:23,020 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2020-02-26 14:43:23,047 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2020-02-26 14:43:23,047 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2020-02-26 14:43:23,047 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2020-02-26 14:43:23,212 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 14:43:23,358 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 14:43:30,853 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 14:43:30,932 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2020-02-26 14:43:31,261 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2020-02-26 14:43:44,462 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'IPD02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 14:43:44,831 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'IPD40'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 14:43:44,981 [1] DEBUG - Statement Id: [DAO00069_GetCountDanhSachNoiTru] PreparedStatement : [select count(A.SOBENHAN) as TOTALROWS        from TT_NOITRU_BENHAN A        inner join TT_TIEPNHAN B on B.TIEPNHAN_ID = A.TIEPNHAN_ID and (B.TRANGTHAI = 'NOITRU' or B.TRANGTHAI = 'HOANTHANH')        inner join TT_BENHNHAN C on C.BENHNHAN_ID = B.BENHNHAN_ID        left join TT_NOITRU_LUUTRU D on D.BENHAN_ID = A.BENHAN_ID        and D.LUUTRU_ID = ( select top 1 LUUTRU_ID from TT_NOITRU_LUUTRU where BENHAN_ID = A.BENHAN_ID order by BENHAN_ID desc)        left join TT_NOITRU_XACNHAN E on E.BENHAN_ID = A.BENHAN_ID        left join TT_NOITRU_LUUTRUCHITIET F on D.LUUTRU_ID = F.LUUTRU_ID and F.LUUTRUCHITIET_CURRENT = '1'        and F.LUUTRUCHITIET_ID in (select top 1 LUUTRUCHITIET_ID from TT_NOITRU_LUUTRUCHITIET where LUUTRU_ID = D.LUUTRU_ID order by LUUTRUCHITIET_ID desc)        where        A.KHOACHUYENDEN_ID is not null  and        (E.TRANGTHAI = 'DAXACNHAN' OR E.TRANGTHAI = 'HUYXACNHAN')         and           cast(A.NGAYVAOKHOA as date) <= cast('2/26/2020 12:00:00 AM' as date)                 and B.BENHVIEN_ID = 'HLU01' and A.KHOACHUYENDEN_ID = '25'          AND             A.TRANGTHAI in ('DANGDIEUTRI')]
2020-02-26 14:43:45,130 [1] DEBUG - Statement Id: [DAO00069_GetDanhSachNoiTru] PreparedStatement : [select * from        (        SELECT ROW_NUMBER() OVER(order by B.SOTIEPNHAN) as ROWNUMBER,          A.SOBENHAN, A.BENHAN_ID, A.SOLUUTRU                 , E.NOILAP_ID as KHOAVAO_ID        , A.TRANGTHAI, IsNull(A.BACSIDIEUTRI_ID, E.BACSICHIDINH_ID) as BACSIDIEUTRI_ID,        B.TIEPNHAN_ID, B.SOTIEPNHAN, B.SOBHYT as SOTHE, B.DOITUONG_ID, A.NGAYVAOKHOA as NGAYCAPCUU, A.THOIGIANVAOKHOA as THOIGIANCAPCUU,        C.TENBENHNHAN, C.NGAYSINH, C.NAMSINH, C.BENHNHAN_ID, C.MAYTE, F.GIUONGBENH_ID, A.THOIGIANRAVIEN    , DIACHITHUONGTRU, DANTOC_ID        ,BENHVIEN_STT_ID                from TT_NOITRU_BENHAN A        inner join TT_TIEPNHAN B on B.TIEPNHAN_ID = A.TIEPNHAN_ID and (B.TRANGTHAI = 'NOITRU' or B.TRANGTHAI = 'HOANTHANH')        inner join TT_BENHNHAN C on C.BENHNHAN_ID = B.BENHNHAN_ID        left join TT_NOITRU_LUUTRU D on D.BENHAN_ID = A.BENHAN_ID        and D.LUUTRU_ID = ( select top 1 LUUTRU_ID from TT_NOITRU_LUUTRU where BENHAN_ID = A.BENHAN_ID order by LUUTRU_ID desc)        left join TT_NOITRU_XACNHAN E on E.BENHAN_ID = A.BENHAN_ID        left join TT_NOITRU_LUUTRUCHITIET F on D.LUUTRU_ID = F.LUUTRU_ID and F.LUUTRUCHITIET_CURRENT = '1'        and F.LUUTRUCHITIET_ID in (select top 1 LUUTRUCHITIET_ID from TT_NOITRU_LUUTRUCHITIET where LUUTRU_ID = D.LUUTRU_ID order by LUUTRUCHITIET_ID desc)        left join (select MABENHVIEN, BENHVIEN_STT_ID from TM_BENHVIEN) H on SUBSTRING(B.SOBHYT, 16, 5)=H.MABENHVIEN        where        A.KHOACHUYENDEN_ID is not null  and        (E.TRANGTHAI = 'DAXACNHAN' OR E.TRANGTHAI = 'HUYXACNHAN')         and           cast(A.NGAYVAOKHOA as date) <= cast('2/26/2020 12:00:00 AM' as date)                 and B.BENHVIEN_ID = 'HLU01' and A.KHOACHUYENDEN_ID = '25'          AND             A.TRANGTHAI in ('DANGDIEUTRI')                   ) lst        where        lst.ROWNUMBER between 1 and 20        order by lst.SOTIEPNHAN]
2020-02-26 14:43:46,194 [1] DEBUG - Statement Id: [DAO00069_GetCountDanhSachNoiTru] PreparedStatement : [select count(A.SOBENHAN) as TOTALROWS        from TT_NOITRU_BENHAN A        inner join TT_TIEPNHAN B on B.TIEPNHAN_ID = A.TIEPNHAN_ID and (B.TRANGTHAI = 'NOITRU' or B.TRANGTHAI = 'HOANTHANH')        inner join TT_BENHNHAN C on C.BENHNHAN_ID = B.BENHNHAN_ID        left join TT_NOITRU_LUUTRU D on D.BENHAN_ID = A.BENHAN_ID        and D.LUUTRU_ID = ( select top 1 LUUTRU_ID from TT_NOITRU_LUUTRU where BENHAN_ID = A.BENHAN_ID order by BENHAN_ID desc)        left join TT_NOITRU_XACNHAN E on E.BENHAN_ID = A.BENHAN_ID        left join TT_NOITRU_LUUTRUCHITIET F on D.LUUTRU_ID = F.LUUTRU_ID and F.LUUTRUCHITIET_CURRENT = '1'        and F.LUUTRUCHITIET_ID in (select top 1 LUUTRUCHITIET_ID from TT_NOITRU_LUUTRUCHITIET where LUUTRU_ID = D.LUUTRU_ID order by LUUTRUCHITIET_ID desc)        where        A.KHOACHUYENDEN_ID is not null  and        (E.TRANGTHAI = 'DAXACNHAN' OR E.TRANGTHAI = 'HUYXACNHAN')         and           cast(A.NGAYVAOKHOA as date) <= cast('2/26/2020 12:00:00 AM' as date)                 and B.BENHVIEN_ID = 'HLU01' and A.KHOACHUYENDEN_ID = '25'          AND             A.TRANGTHAI in ('DANGDIEUTRI')]
2020-02-26 14:43:46,288 [1] DEBUG - Statement Id: [DAO00069_GetDanhSachNoiTru] PreparedStatement : [select * from        (        SELECT ROW_NUMBER() OVER(order by B.SOTIEPNHAN) as ROWNUMBER,          A.SOBENHAN, A.BENHAN_ID, A.SOLUUTRU                 , E.NOILAP_ID as KHOAVAO_ID        , A.TRANGTHAI, IsNull(A.BACSIDIEUTRI_ID, E.BACSICHIDINH_ID) as BACSIDIEUTRI_ID,        B.TIEPNHAN_ID, B.SOTIEPNHAN, B.SOBHYT as SOTHE, B.DOITUONG_ID, A.NGAYVAOKHOA as NGAYCAPCUU, A.THOIGIANVAOKHOA as THOIGIANCAPCUU,        C.TENBENHNHAN, C.NGAYSINH, C.NAMSINH, C.BENHNHAN_ID, C.MAYTE, F.GIUONGBENH_ID, A.THOIGIANRAVIEN    , DIACHITHUONGTRU, DANTOC_ID        ,BENHVIEN_STT_ID                from TT_NOITRU_BENHAN A        inner join TT_TIEPNHAN B on B.TIEPNHAN_ID = A.TIEPNHAN_ID and (B.TRANGTHAI = 'NOITRU' or B.TRANGTHAI = 'HOANTHANH')        inner join TT_BENHNHAN C on C.BENHNHAN_ID = B.BENHNHAN_ID        left join TT_NOITRU_LUUTRU D on D.BENHAN_ID = A.BENHAN_ID        and D.LUUTRU_ID = ( select top 1 LUUTRU_ID from TT_NOITRU_LUUTRU where BENHAN_ID = A.BENHAN_ID order by LUUTRU_ID desc)        left join TT_NOITRU_XACNHAN E on E.BENHAN_ID = A.BENHAN_ID        left join TT_NOITRU_LUUTRUCHITIET F on D.LUUTRU_ID = F.LUUTRU_ID and F.LUUTRUCHITIET_CURRENT = '1'        and F.LUUTRUCHITIET_ID in (select top 1 LUUTRUCHITIET_ID from TT_NOITRU_LUUTRUCHITIET where LUUTRU_ID = D.LUUTRU_ID order by LUUTRUCHITIET_ID desc)        left join (select MABENHVIEN, BENHVIEN_STT_ID from TM_BENHVIEN) H on SUBSTRING(B.SOBHYT, 16, 5)=H.MABENHVIEN        where        A.KHOACHUYENDEN_ID is not null  and        (E.TRANGTHAI = 'DAXACNHAN' OR E.TRANGTHAI = 'HUYXACNHAN')         and           cast(A.NGAYVAOKHOA as date) <= cast('2/26/2020 12:00:00 AM' as date)                 and B.BENHVIEN_ID = 'HLU01' and A.KHOACHUYENDEN_ID = '25'          AND             A.TRANGTHAI in ('DANGDIEUTRI')                   ) lst        where        lst.ROWNUMBER between 1 and 20        order by lst.SOTIEPNHAN]
2020-02-26 14:43:48,600 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM31'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 14:43:48,803 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'IPD03'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 14:43:50,163 [1] DEBUG - Statement Id: [DAO00080_KiemtraBenhAnDaThanhToan] PreparedStatement : [select DAXACNHANDOANHTHU        from TT_NOITRU_BENHAN where        BENHAN_ID = '24642'        and BENHVIEN_ID = 'HLU01'        Order By BENHAN_ID Desc]
2020-02-26 14:43:50,272 [1] DEBUG - Statement Id: [DAO00061_GetBenhAnDetailByID] PreparedStatement : [select A.*, B.NOIGIOITHIEU_ID, C.KHOADIEUTRI_ID, A.ICD_BENHCHINH AS ICD_BENHCHINH_BAK, A.CDRAVIEN_CHINH AS CHANDOANRAVIEN1, B.THOIGIANTIEPNHAN        , A.CDRAVIEN_CHINH AS CHANDOANRAVIEN_BAK        from TT_NOITRU_BENHAN A        left join TT_TIEPNHAN B on B.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TT_NOITRU_NHAPVIEN C on C.TIEPNHAN_ID = B.TIEPNHAN_ID        where A.BENHAN_ID = '24642']
2020-02-26 14:43:50,329 [1] DEBUG - Statement Id: [DAO00087_GetServiceParams] PreparedStatement : [select CODE, VALUE              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01']
2020-02-26 14:43:50,387 [1] DEBUG - Statement Id: [DAO00080_GetNoiTruLuuTruBenhAn] PreparedStatement : [select *        from TT_NOITRU_LUUTRU where        BENHAN_ID = '24642'        and BENHVIEN_ID = 'HLU01'        Order By LUUTRU_ID ASC]
2020-02-26 14:43:50,431 [1] DEBUG - Statement Id: [DAO00080_GetGiuongBenhCuaBenhAn] PreparedStatement : [select *        from TT_NOITRU_GIUONGBENH where        BENHAN_ID =  @param0]
2020-02-26 14:43:50,431 [1] DEBUG - Statement Id: [DAO00080_GetGiuongBenhCuaBenhAn] Parameters: [@param0=[BENHAN_ID,24642]]
2020-02-26 14:43:50,431 [1] DEBUG - Statement Id: [DAO00080_GetGiuongBenhCuaBenhAn] Types: [@param0=[Int64, System.Int64]]
2020-02-26 14:43:50,624 [1] DEBUG - Statement Id: [DAO00013_GetDetailP] PreparedStatement : [select *        from TT_BENHNHAN         WHERE              TT_BENHNHAN.MAYTE  = '190040528']
2020-02-26 14:43:50,699 [1] DEBUG - Statement Id: [DAO00061_GetBenhAnDetailByID] PreparedStatement : [select A.*, B.NOIGIOITHIEU_ID, C.KHOADIEUTRI_ID, A.ICD_BENHCHINH AS ICD_BENHCHINH_BAK, A.CDRAVIEN_CHINH AS CHANDOANRAVIEN1, B.THOIGIANTIEPNHAN        , A.CDRAVIEN_CHINH AS CHANDOANRAVIEN_BAK        from TT_NOITRU_BENHAN A        left join TT_TIEPNHAN B on B.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TT_NOITRU_NHAPVIEN C on C.TIEPNHAN_ID = B.TIEPNHAN_ID        where A.BENHAN_ID = '24642']
2020-02-26 14:43:50,980 [1] DEBUG - Statement Id: [DAO00080_GetNoiTruBenhAnChiTiet] PreparedStatement : [select *        from TT_NOITRU_BENHAN_CHITIET where        BENHAN_ID = '24642'        and BENHVIEN_ID = 'HLU01'        Order By BENHANCHITIET_ID DESC]
2020-02-26 14:43:51,068 [1] DEBUG - Statement Id: [DAO00080_GetNoiTruLuuTruBenhAn] PreparedStatement : [select *        from TT_NOITRU_LUUTRU where        BENHAN_ID = '24642'        and BENHVIEN_ID = 'HLU01'        Order By LUUTRU_ID ASC]
2020-02-26 14:43:51,123 [1] DEBUG - Statement Id: [DAO00080_GetGiuongBenhCuaBenhAn] PreparedStatement : [select *        from TT_NOITRU_GIUONGBENH where        BENHAN_ID =  @param0]
2020-02-26 14:43:51,123 [1] DEBUG - Statement Id: [DAO00080_GetGiuongBenhCuaBenhAn] Parameters: [@param0=[BENHAN_ID,24642]]
2020-02-26 14:43:51,123 [1] DEBUG - Statement Id: [DAO00080_GetGiuongBenhCuaBenhAn] Types: [@param0=[Int64, System.Int64]]
2020-02-26 14:43:51,259 [1] DEBUG - Statement Id: [DAO00067_laytrangthaibenhannoitru] PreparedStatement : [select isnull(TRANGTHAI, '') TRANGTHAI from TT_NOITRU_BENHAN where BENHAN_ID =  @param0]
2020-02-26 14:43:51,259 [1] DEBUG - Statement Id: [DAO00067_laytrangthaibenhannoitru] Parameters: [@param0=[BENHAN_ID,24642]]
2020-02-26 14:43:51,259 [1] DEBUG - Statement Id: [DAO00067_laytrangthaibenhannoitru] Types: [@param0=[Int64, System.Int64]]
2020-02-26 14:43:51,283 [1] DEBUG - Statement Id: [DAO00067_DeleteVienPhi_Noref] PreparedStatement : [delete from TT_VIENPHI where TIEPNHAN_ID = 107181 and (REF_ID is null or REF_ID = 0)         and           BENHAN_ID = '24642'                 delete TT_DUOC_TONKHO_BOOK_NOITRU where REF_TABLE = 'TT_NOITRU_TOATHUOC' and (REF_ID is null or REF_ID = 0)        delete TT_DUOC_TONKHO_BOOK_NGOAITRU where REF_ID is null or REF_ID = 0]
2020-02-26 14:43:51,459 [1] DEBUG - Statement Id: [DAO00067_UpdateBenhanIdVienPhi] PreparedStatement : [update TT_VIENPHI          set BENHAN_ID =  @param0           from (select TOATHUOC_ID from TT_NOITRU_TOATHUOC where TIEPNHAN_ID =  @param1 ) nttt          where REF_TABLE = 'TT_NOITRU_TOATHUOC' and REF_ID = nttt.TOATHUOC_ID and isnull(BENHAN_ID, 0) = 0          and TIEPNHAN_ID =  @param1             update TT_VIENPHI          set TT_VIENPHI.BENHAN_ID =  @param0           from (select DVYEUCAU_ID, BENHAN_ID from TT_DVYEUCAU where TIEPNHAN_ID =  @param1 ) nttt          where TT_VIENPHI.REF_TABLE = 'TT_DVYEUCAU' and TT_VIENPHI.REF_ID = nttt.DVYEUCAU_ID          and isnull(TT_VIENPHI.BENHAN_ID, 0) = 0 and isnull(nttt.BENHAN_ID, 0) > 0          and TT_VIENPHI.TIEPNHAN_ID =  @param1]
2020-02-26 14:43:51,460 [1] DEBUG - Statement Id: [DAO00067_UpdateBenhanIdVienPhi] Parameters: [@param0=[BENHAN_ID,24642], @param1=[TIEPNHAN_ID,107181]]
2020-02-26 14:43:51,460 [1] DEBUG - Statement Id: [DAO00067_UpdateBenhanIdVienPhi] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64]]
2020-02-26 14:43:51,488 [1] DEBUG - Statement Id: [DAO00064_GetlistTT_TIEPNHAN_SOTHEBHYT] PreparedStatement : [select stbhyt.*, ba.SOBENHAN,        tn.SOTIEPNHAN, tn.LOAITHANHVIEN_ID, tn.THE_ID, tn.THANHVIEN_ID,        tn.SUDUNG_BHTN, tn.BAOLANH_VIENPHI, tn.VIP, tn.NGUOINUOCNGOAI        from TT_TIEPNHAN_SOTHEBHYT stbhyt        left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = stbhyt.TIEPNHAN_ID        left join TT_NOITRU_BENHAN ba on ba.TIEPNHAN_ID = stbhyt.TIEPNHAN_ID        where        stbhyt.TIEPNHAN_ID = '107181' and isnull(stbhyt.KHONGSUDUNG, '0') = '0'         and           ba.BENHAN_ID = '24642']
2020-02-26 14:43:51,529 [1] DEBUG - Statement Id: [DAO00064_GetListVienPhiByTiepNnan] PreparedStatement : [select distinct        B.DOITUONG_ID, B.NGAYMIENDONGCHITRA, B.BENHNHAN_ID as TIEPNHAN_BENHNHAN_ID, B.TRAITUYEN,        B.BHYTTREN3NAM as TREN3NAM, B.BHYTTREN5NAM as TREN5NAM, B.SOTIEPNHAN, B.SOBENHAN,        B.LOAITHANHVIEN_ID, B.SUDUNG_BHTN, B.THE_ID, B.THANHVIEN_ID, B.BAOLANH_VIENPHI, B.VIP, B.NGUOINUOCNGOAI,        C.GIATRIMIENGIAM as GIATRIMIENGIAM, D.GIATRIMIENGIAM as GIATRIMIENGIAM_BHTN, E.GIATRIMIENGIAM as GIATRIMIENGIAM_THANHVIEN,        F.GIATRIMIENGIAM as GIATRIMIENGIAM_CONGTY, DVYC.THE_ID as DVDUNGTHE, DVYC.TRANGTHAI as TRANGTHAIDICHVU, ndv.MANHOMDICHVU,        A.* from TT_VIENPHI A        left join        (select B.*, C.SOBENHAN, C.BENHAN_ID        from TT_TIEPNHAN B        left join TT_NOITRU_BENHAN C on B.TIEPNHAN_ID = C.TIEPNHAN_ID         and           C.BENHAN_ID = '24642'                 where B.TIEPNHAN_ID = '107181') B on B.TIEPNHAN_ID = A.TIEPNHAN_ID        left join (select sum(GIATRIMIENGIAM) as GIATRIMIENGIAM, VIENPHI_ID, REF_TABLE        from TT_MIENGIAM_CHITIET        where REF_TABLE = 'TT_MIENGIAM'        and exists (select MIENGIAM_ID from TT_MIENGIAM where TT_MIENGIAM_CHITIET.MIENGIAM_ID = MIENGIAM_ID and TINHTRANG = 1 and TIEPNHAN_ID = '107181')        group by VIENPHI_ID, REF_TABLE) C on C.REF_TABLE = 'TT_MIENGIAM' and C.VIENPHI_ID = A.VIENPHI_ID        left join (select sum(GIATRIMIENGIAM) as GIATRIMIENGIAM, VIENPHI_ID, REF_TABLE        from TT_MIENGIAM_CHITIET        where REF_TABLE = 'TT_MIENGIAM_BHTN'        and exists (select MIENGIAM_BHTN_ID from TT_MIENGIAM_BHTN where TT_MIENGIAM_CHITIET.MIENGIAM_ID = MIENGIAM_BHTN_ID and  TINHTRANG = 1 and TIEPNHAN_ID = '107181')        group by VIENPHI_ID, REF_TABLE) D on D.REF_TABLE = 'TT_MIENGIAM_BHTN' and D.VIENPHI_ID = A.VIENPHI_ID        left join (select sum(GIATRIMIENGIAM) as GIATRIMIENGIAM, VIENPHI_ID, REF_TABLE        from TT_MIENGIAM_CHITIET        where REF_TABLE = 'TT_MIENGIAM_THANHVIEN'        and exists (select MIENGIAM_THANHVIEN_ID from TT_MIENGIAM_THANHVIEN where TT_MIENGIAM_CHITIET.MIENGIAM_ID = MIENGIAM_THANHVIEN_ID and TINHTRANG = 1 and TIEPNHAN_ID = '107181')        group by VIENPHI_ID, REF_TABLE) E on E.REF_TABLE = 'TT_MIENGIAM_THANHVIEN' and E.VIENPHI_ID = A.VIENPHI_ID        left join (select sum(GIATRIMIENGIAM) as GIATRIMIENGIAM, VIENPHI_ID, REF_TABLE        from TT_MIENGIAM_CHITIET        where REF_TABLE = 'TT_MIENGIAM_CONGTY'        and exists (select MIENGIAM_CONGTY_ID from TT_MIENGIAM_CONGTY where TT_MIENGIAM_CHITIET.MIENGIAM_ID = MIENGIAM_CONGTY_ID and TINHTRANG = 1 and TIEPNHAN_ID = '107181')        group by VIENPHI_ID, REF_TABLE) F on F.REF_TABLE = 'TT_MIENGIAM_CONGTY' and F.VIENPHI_ID = A.VIENPHI_ID        left join TT_DVYEUCAU DVYC on DVYC.DVYEUCAU_ID = A.REF_ID and A.REF_TABLE = 'TT_DVYEUCAU'        left join TM_DICHVU DV on DVYC.DICHVU_ID = DV.DICHVU_ID and A.REF_TABLE = 'TT_DVYEUCAU'        left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = DV.NHOMDICHVU_ID and A.REF_TABLE = 'TT_DVYEUCAU'        where        A.TIEPNHAN_ID = '107181' and ((DVYC.HUYYEUCAU = '0' and A.DICHVU_ID is not null)        or A.DUOC_ID is not null or A.REF_TABLE = 'TT_NUT_XACNHANSUATAN_CHITIET')        and A.ACTIVE = '1'         and           A.BENHAN_ID = '24642'                 and A.BENHVIEN_ID = 'HLU01'        order by A.VIENPHI_ID]
2020-02-26 14:43:51,582 [1] DEBUG - Statement Id: [DAO00006_GetListDuocTyle] PreparedStatement : [select DUOC_ID, DOITUONG_ID, (TYLE/100) as TYLE, DONGIA MUCTRAN_THANHTOAN from TM_DOITUONG_GIADUOC_TYLE            where            BENHVIEN_ID = 'HLU01'            and DOITUONG_ID = '4']
2020-02-26 14:43:51,607 [1] DEBUG - Statement Id: [DAO00027_GetListTuongTrinhDichVuPhauThuatCuaTiepNhan] PreparedStatement : [declare @ManhomDSA varchar(10);        declare @PhanLoaiNhomDV varchar(20) = '05';        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        if (@ManhomDSA is not null) set @PhanLoaiNhomDV += ',' + @ManhomDSA        select distinct ptyc.*        from TT_PHAUTHUAT_YEUCAU ptyc        inner join TM_DICHVU dv on dv.DICHVU_ID = ptyc.DICHVU_ID        inner join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID        inner join TT_PHAUTHUAT pt on pt.PHAUTHUAT_ID = ptyc.PHAUTHUAT_ID        where        pt.TIEPNHAN_ID = 107181        and (left(ndv.MANHOMDICHVU, 2) in (select * from STRING_SPLIT(@PhanLoaiNhomDV,',')) or ndv.MANHOMDICHVU in (select * from STRING_SPLIT(@PhanLoaiNhomDV,',')))]
2020-02-26 14:43:51,681 [1] DEBUG - Statement Id: [DAO00027_GetListTuongTrinhVTYTPhauThuatCuaTiepNhan] PreparedStatement : [select distinct ptvt.*        from TT_PHAUTHUAT_VTYT ptvt        inner join TT_PHAUTHUAT pt on pt.PHAUTHUAT_ID = ptvt.PHAUTHUAT_ID        inner join TM_DUOC d on d.DUOC_ID = ptvt.DUOC_ID        inner join TM_LOAIDUOC ld on ld.LOAIVATTU_ID = 'V' and ld.LOAIDUOC_ID = d.LOAIDUOC_ID        where pt.TIEPNHAN_ID = 107181        order by ptvt.PHAUTHUAT_VTYT_ID asc]
2020-02-26 14:43:51,721 [1] DEBUG - Statement Id: [DAO00006_GetList] PreparedStatement : [select dv.*, loaiDV.MALOAIDICHVU, captren.NHOMDICHVU_ID as NHOMDICHVU_CAPTREN_ID, captren.TENNHOMDICHVU as NHOMDICHVU_CAPTREN,              nhom_dv.TENNHOMDICHVU as TENNHOMDICHVU, nhom_dv.MANHOMDICHVU,              case when dv.ATTRIBUTE5 is null then 'TT' else 'KTC' end as LOAI_CHIPHI              from TM_DICHVU as dv              left join TM_NHOMDICHVU as nhom_dv on nhom_dv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID and nhom_dv.BENHVIEN_ID = 'HLU01'              left join TM_NHOMDICHVU as captren on nhom_dv.CAPTREN_ID = captren.NHOMDICHVU_ID and captren.BENHVIEN_ID = 'HLU01'              left join TM_LOAIDICHVU loaiDV on nhom_dv.LOAIDICHVU_ID = loaiDV.LOAIDICHVU_ID and loaiDV.BENHVIEN_ID = 'HLU01'              where nhom_dv.TAMNGUNG = '0' and dv.BENHVIEN_ID = 'HLU01'              and dv.TAMNGUNG = '0'               AND                   loaiDV.MALOAIDICHVU = 'KhamBenh']
2020-02-26 14:43:51,911 [1] DEBUG - Statement Id: [DAO00027_GetDichvuYCBHYTTyle] PreparedStatement : [select DVYEUCAU_ID from TT_DVYEUCAU        where TIEPNHAN_ID = 107181 and isnull(BHYT_TYLETHANHTOAN_ID, 0) > 0]
2020-02-26 14:43:52,125 [1] DEBUG - Statement Id: [DAO00023_UpdateNhieuVP] PreparedStatement : [declare @jsonVienPhi nvarchar(max) = N'[{"VIENPHI_ID":3109614,"TIEPNHAN_ID":107181,"DICHVU_ID":5440,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":34500.0000,"THANHTIEN_DOANHTHU":34500.00,"BHYT_TL":0.8000,"BHYT_DONGIA":34500.0000,"BHYT_THANHTIEN":34500.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":27600.0,"BHYT_THANHTIEN_CHITRA":27600.00,"BENHNHAN_PHAITHANHTOAN":6900.00,"GIATRI_HOADON":6900.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3109615,"TIEPNHAN_ID":107181,"DICHVU_ID":5554,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":5000.0000,"THANHTIEN_DOANHTHU":5000.00,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":5000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110619,"TIEPNHAN_ID":107181,"DICHVU_ID":4022,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":43900.0000,"THANHTIEN_DOANHTHU":43900.00,"BHYT_TL":0.8000,"BHYT_DONGIA":43900.0000,"BHYT_THANHTIEN":43900.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":35120.0,"BHYT_THANHTIEN_CHITRA":35120.00,"BENHNHAN_PHAITHANHTOAN":8780.00,"GIATRI_HOADON":8780.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110620,"TIEPNHAN_ID":107181,"DICHVU_ID":4422,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":32800.0000,"THANHTIEN_DOANHTHU":32800.00,"BHYT_TL":0.8000,"BHYT_DONGIA":32800.0000,"BHYT_THANHTIEN":32800.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":26240.0,"BHYT_THANHTIEN_CHITRA":26240.00,"BENHNHAN_PHAITHANHTOAN":6560.00,"GIATRI_HOADON":6560.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110621,"TIEPNHAN_ID":107181,"DICHVU_ID":4451,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":63500.0000,"THANHTIEN_DOANHTHU":63500.00,"BHYT_TL":0.8000,"BHYT_DONGIA":63500.0000,"BHYT_THANHTIEN":63500.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":50800.0,"BHYT_THANHTIEN_CHITRA":50800.00,"BENHNHAN_PHAITHANHTOAN":12700.00,"GIATRI_HOADON":12700.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110622,"TIEPNHAN_ID":107181,"DICHVU_ID":4454,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":40400.0000,"THANHTIEN_DOANHTHU":40400.00,"BHYT_TL":0.8000,"BHYT_DONGIA":40400.0000,"BHYT_THANHTIEN":40400.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":32320.0,"BHYT_THANHTIEN_CHITRA":32320.00,"BENHNHAN_PHAITHANHTOAN":8080.00,"GIATRI_HOADON":8080.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110623,"TIEPNHAN_ID":107181,"DICHVU_ID":4523,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":40400.0000,"THANHTIEN_DOANHTHU":40400.00,"BHYT_TL":0.8000,"BHYT_DONGIA":40400.0000,"BHYT_THANHTIEN":40400.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":32320.0,"BHYT_THANHTIEN_CHITRA":32320.00,"BENHNHAN_PHAITHANHTOAN":8080.00,"GIATRI_HOADON":8080.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110624,"TIEPNHAN_ID":107181,"DICHVU_ID":4596,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":39100.0000,"THANHTIEN_DOANHTHU":39100.00,"BHYT_TL":0.8000,"BHYT_DONGIA":39100.0000,"BHYT_THANHTIEN":39100.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":31280.0,"BHYT_THANHTIEN_CHITRA":31280.00,"BENHNHAN_PHAITHANHTOAN":7820.00,"GIATRI_HOADON":7820.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110626,"TIEPNHAN_ID":107181,"DICHVU_ID":4642,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":21500.0000,"THANHTIEN_DOANHTHU":21500.00,"BHYT_TL":0.8000,"BHYT_DONGIA":21500.0000,"BHYT_THANHTIEN":21500.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":17200.0,"BHYT_THANHTIEN_CHITRA":17200.00,"BENHNHAN_PHAITHANHTOAN":4300.00,"GIATRI_HOADON":4300.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110628,"TIEPNHAN_ID":107181,"DICHVU_ID":4681,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":21500.0000,"THANHTIEN_DOANHTHU":21500.00,"BHYT_TL":0.8000,"BHYT_DONGIA":21500.0000,"BHYT_THANHTIEN":21500.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":17200.0,"BHYT_THANHTIEN_CHITRA":17200.00,"BENHNHAN_PHAITHANHTOAN":4300.00,"GIATRI_HOADON":4300.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110629,"TIEPNHAN_ID":107181,"DICHVU_ID":4722,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":21500.0000,"THANHTIEN_DOANHTHU":21500.00,"BHYT_TL":0.8000,"BHYT_DONGIA":21500.0000,"BHYT_THANHTIEN":21500.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":17200.0,"BHYT_THANHTIEN_CHITRA":17200.00,"BENHNHAN_PHAITHANHTOAN":4300.00,"GIATRI_HOADON":4300.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110630,"TIEPNHAN_ID":107181,"DICHVU_ID":4747,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":27400.0000,"THANHTIEN_DOANHTHU":27400.00,"BHYT_TL":0.8000,"BHYT_DONGIA":27400.0000,"BHYT_THANHTIEN":27400.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":21920.0,"BHYT_THANHTIEN_CHITRA":21920.00,"BENHNHAN_PHAITHANHTOAN":5480.00,"GIATRI_HOADON":5480.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110631,"TIEPNHAN_ID":107181,"DICHVU_ID":4832,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":70000.0000,"THANHTIEN_DOANHTHU":70000.00,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":70000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":70000.0000,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":70000.0000,"GIATRI_BENHNHAN_DATHANHTOAN":70000.0000,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110632,"TIEPNHAN_ID":107181,"DICHVU_ID":4873,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":70000.0000,"THANHTIEN_DOANHTHU":70000.00,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":70000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":70000.0000,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":70000.0000,"GIATRI_BENHNHAN_DATHANHTOAN":70000.0000,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119342,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":5.0000,"DONGIA_DOANHTHU":4000.0000,"THANHTIEN_DOANHTHU":20000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":20000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119500,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":2.0000,"DONGIA_DOANHTHU":8715.0000,"THANHTIEN_DOANHTHU":17430.00,"BHYT_TL":0.8000,"BHYT_DONGIA":8715.0000,"BHYT_THANHTIEN":17430.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":6972.0,"BHYT_THANHTIEN_CHITRA":13944.00,"BENHNHAN_PHAITHANHTOAN":3486.00,"GIATRI_HOADON":3486.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119501,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":8925.0000,"THANHTIEN_DOANHTHU":8925.00,"BHYT_TL":0.8000,"BHYT_DONGIA":8925.0000,"BHYT_THANHTIEN":8925.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":7140.0,"BHYT_THANHTIEN_CHITRA":7140.00,"BENHNHAN_PHAITHANHTOAN":1785.00,"GIATRI_HOADON":1785.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119502,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":2.0000,"DONGIA_DOANHTHU":27990.0000,"THANHTIEN_DOANHTHU":55980.00,"BHYT_TL":0.8000,"BHYT_DONGIA":27990.0000,"BHYT_THANHTIEN":55980.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":22392.0,"BHYT_THANHTIEN_CHITRA":44784.00,"BENHNHAN_PHAITHANHTOAN":11196.00,"GIATRI_HOADON":11196.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119503,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":8925.0000,"THANHTIEN_DOANHTHU":8925.00,"BHYT_TL":0.8000,"BHYT_DONGIA":8925.0000,"BHYT_THANHTIEN":8925.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":7140.0,"BHYT_THANHTIEN_CHITRA":7140.00,"BENHNHAN_PHAITHANHTOAN":1785.00,"GIATRI_HOADON":1785.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119504,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":2.0000,"DONGIA_DOANHTHU":8295.0000,"THANHTIEN_DOANHTHU":16590.00,"BHYT_TL":0.8000,"BHYT_DONGIA":8295.0000,"BHYT_THANHTIEN":16590.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":6636.0,"BHYT_THANHTIEN_CHITRA":13272.00,"BENHNHAN_PHAITHANHTOAN":3318.00,"GIATRI_HOADON":3318.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119505,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":458000.0000,"THANHTIEN_DOANHTHU":458000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":398036.0000,"BHYT_THANHTIEN":398036.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":318428.8,"BHYT_THANHTIEN_CHITRA":318428.80,"BENHNHAN_PHAITHANHTOAN":139571.20,"GIATRI_HOADON":79607.20,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119506,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":50400.0000,"THANHTIEN_DOANHTHU":50400.00,"BHYT_TL":0.8000,"BHYT_DONGIA":50400.0000,"BHYT_THANHTIEN":50400.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":40320.0,"BHYT_THANHTIEN_CHITRA":40320.00,"BENHNHAN_PHAITHANHTOAN":10080.00,"GIATRI_HOADON":10080.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119530,"TIEPNHAN_ID":107181,"DICHVU_ID":5363,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":10000.0000,"THANHTIEN_DOANHTHU":10000.00,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119531,"TIEPNHAN_ID":107181,"DICHVU_ID":5588,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":2400.0000,"THANHTIEN_DOANHTHU":2400.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119532,"TIEPNHAN_ID":107181,"DICHVU_ID":477,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":110000.0000,"THANHTIEN_DOANHTHU":110000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119533,"TIEPNHAN_ID":107181,"DICHVU_ID":5602,"BENHAN_ID":24642,"SOLUONG":0.5000,"DONGIA_DOANHTHU":200000.0000,"THANHTIEN_DOANHTHU":100000.00,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":100000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119535,"TIEPNHAN_ID":107181,"DICHVU_ID":3161,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":2945000.0000,"THANHTIEN_DOANHTHU":2945000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":2945000.0000,"BHYT_THANHTIEN":2945000.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":2356000.0,"BHYT_THANHTIEN_CHITRA":2356000.00,"BENHNHAN_PHAITHANHTOAN":589000.00,"GIATRI_HOADON":589000.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119536,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":0.2500,"DONGIA_DOANHTHU":25000.0000,"THANHTIEN_DOANHTHU":6250.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119537,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":2.0000,"DONGIA_DOANHTHU":1700.0000,"THANHTIEN_DOANHTHU":3400.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119538,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":3.0000,"DONGIA_DOANHTHU":1000.0000,"THANHTIEN_DOANHTHU":3000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119539,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":3.0000,"DONGIA_DOANHTHU":2000.0000,"THANHTIEN_DOANHTHU":6000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119540,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":4000.0000,"THANHTIEN_DOANHTHU":4000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119541,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":3000.0000,"THANHTIEN_DOANHTHU":3000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119542,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":100.0000,"DONGIA_DOANHTHU":50.0000,"THANHTIEN_DOANHTHU":5000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119543,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":150000.0000,"THANHTIEN_DOANHTHU":150000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119544,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":160000.0000,"THANHTIEN_DOANHTHU":160000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119545,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":20.0000,"DONGIA_DOANHTHU":3000.0000,"THANHTIEN_DOANHTHU":60000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119546,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":20.0000,"DONGIA_DOANHTHU":6000.0000,"THANHTIEN_DOANHTHU":120000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119547,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":5.0000,"DONGIA_DOANHTHU":4000.0000,"THANHTIEN_DOANHTHU":20000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119548,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":10.0000,"DONGIA_DOANHTHU":8000.0000,"THANHTIEN_DOANHTHU":80000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119549,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":2.0000,"DONGIA_DOANHTHU":500.0000,"THANHTIEN_DOANHTHU":1000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119550,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":10000.0000,"THANHTIEN_DOANHTHU":10000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119551,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":45000.0000,"THANHTIEN_DOANHTHU":45000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119552,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":35000.0000,"THANHTIEN_DOANHTHU":35000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119553,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":10000.0000,"THANHTIEN_DOANHTHU":10000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119554,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":20000.0000,"THANHTIEN_DOANHTHU":20000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119555,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":6500.0000,"THANHTIEN_DOANHTHU":6500.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119556,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":0.5000,"DONGIA_DOANHTHU":16000.0000,"THANHTIEN_DOANHTHU":8000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119557,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":0.2500,"DONGIA_DOANHTHU":100000.0000,"THANHTIEN_DOANHTHU":25000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119558,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":2.0000,"DONGIA_DOANHTHU":10000.0000,"THANHTIEN_DOANHTHU":20000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119559,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":60000.0000,"THANHTIEN_DOANHTHU":60000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119560,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":2.0000,"DONGIA_DOANHTHU":13500.0000,"THANHTIEN_DOANHTHU":27000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119561,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":6000.0000,"THANHTIEN_DOANHTHU":6000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null}]';        begin        UPDATE TT_VIENPHI        SET        SOLUONG = json.SOLUONG,        DONGIA_DOANHTHU = json.DONGIA_DOANHTHU,        THANHTIEN_DOANHTHU = json.THANHTIEN_DOANHTHU,        BHYT_TL = json.BHYT_TL,        BHYT_DONGIA = json.BHYT_DONGIA,        BHYT_THANHTIEN = json.BHYT_THANHTIEN,        BHYT_DONGIA_CONGKHAM_DAU = json.BHYT_DONGIA_CONGKHAM_DAU,        BHYT_CONGKHAM_DAU_TYLE = json.BHYT_CONGKHAM_DAU_TYLE,        BHYT_DONGIA_CHITRA = json.BHYT_DONGIA_CHITRA,        BHYT_THANHTIEN_CHITRA = json.BHYT_THANHTIEN_CHITRA,        BENHNHAN_PHAITHANHTOAN = json.BENHNHAN_PHAITHANHTOAN,        GIATRI_HOADON = json.GIATRI_HOADON,        GIATRI_BIENLAI = json.GIATRI_BIENLAI,        DATHUCHIEN = json.DATHUCHIEN,        DICHVU_TL = json.DICHVU_TL,        BHYT_DONGIA_DONGCT_DAU = json.BHYT_DONGIA_DONGCT_DAU,        SOLONHAP_ID = json.SOLONHAP_ID,        DUOC_TYLE = json.DUOC_TYLE,        DUOC_MUCTRAN_THANHTOAN = json.DUOC_MUCTRAN_THANHTOAN,        NGAYCAPNHAT = GETDATE()        FROM OPENJSON (@jsonVienPhi)        WITH (        VIENPHI_ID int,        SOLUONG numeric(25, 4),        DONGIA_DOANHTHU numeric(25, 4),        THANHTIEN_DOANHTHU numeric(25, 4),        BHYT_TL numeric(25, 4),        BHYT_DONGIA numeric(25, 4),        BHYT_THANHTIEN numeric(25, 4),        BHYT_DONGIA_CONGKHAM_DAU numeric(25, 4),        BHYT_CONGKHAM_DAU_TYLE numeric(25, 4),        BHYT_DONGIA_CHITRA numeric(25, 4),        BHYT_THANHTIEN_CHITRA numeric(25, 4),        BENHNHAN_PHAITHANHTOAN numeric(25, 4),        GIATRI_HOADON numeric(25, 4),        GIATRI_BIENLAI numeric(25, 4),        DATHUCHIEN char(1),        KHONGTHUTIEN char(1),        BHYTDONGTIEN char(1),        DICHVU_TL numeric(25, 4),        BHYT_DONGIA_DONGCT_DAU numeric(25, 4),        SOLONHAP_ID int,        DUOC_TYLE numeric(25, 4),        DUOC_MUCTRAN_THANHTOAN numeric(25, 4))  json        WHERE TT_VIENPHI.VIENPHI_ID = json.VIENPHI_ID and json.DONGIA_DOANHTHU > 0                  insert into TT_TINH_VIENPHI_LOG        SELECT json.VIENPHI_ID, json.TIEPNHAN_ID, json.BENHAN_ID, json.SOLUONG, json.BHYT_TL, json.DONGIA_DOANHTHU,        json.THANHTIEN_DOANHTHU, json.BHYT_DONGIA, json.BHYT_THANHTIEN, json.BHYT_DONGIA_CHITRA, json.BHYT_THANHTIEN_CHITRA, json.BENHNHAN_PHAITHANHTOAN,        json.SOBHYT_HUONG_ID, json.SOBHYT, GETDATE(), -1, 'HLU01'        FROM OPENJSON(@jsonVienPhi)        WITH (        VIENPHI_ID int,        TIEPNHAN_ID int,        BENHAN_ID int,        SOLUONG numeric(25, 4),        DONGIA_DOANHTHU numeric(25, 4),        THANHTIEN_DOANHTHU numeric(25, 4),        BHYT_TL numeric(25, 4),        BHYT_DONGIA numeric(25, 4),        BHYT_THANHTIEN numeric(25, 4),        BHYT_DONGIA_CHITRA numeric(25, 4),        BHYT_THANHTIEN_CHITRA numeric(25, 4),        BENHNHAN_PHAITHANHTOAN numeric(25, 4),        SOBHYT_HUONG_ID int,        SOBHYT nvarchar(30)) json        end]
2020-02-26 14:43:52,283 [1] DEBUG - Statement Id: [DAO00067_UpdateDataVienPhiDongiaBHYT] PreparedStatement : [update TT_VIENPHI          set BHYT_DONGIA_CHITRA = 0, BHYT_THANHTIEN = 0, BHYT_THANHTIEN_CHITRA = 0          where          TIEPNHAN_ID = 107181 and BHYT_DONGIA = 0          and (BHYT_DONGIA_CHITRA > 0 or BHYT_THANHTIEN > 0 or BHYT_THANHTIEN_CHITRA > 0)]
2020-02-26 14:43:52,308 [1] DEBUG - Statement Id: [DAO00067_CapnhatDataVienphiKhiHuyThanhtoanHoadon] PreparedStatement : [update TT_VIENPHI        set TT_VIENPHI.HOADON_ID = hdct.HOADON_ID, TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN = TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN + hdct.GIATRI_BENHNHAN_DATHANHTOAN        from (select CT.HOADON_ID, CT.VIENPHI_ID, CT.GIATRI_BENHNHAN_DATHANHTOAN        from TT_HOADON_CHITIET_NGOAITRU CT        join TT_HOADON HD on HD.HOADON_ID = CT.HOADON_ID        join TT_VIENPHI vp on vp.VIENPHI_ID = ct.VIENPHI_ID        where HD.DATHANHTOAN = 1 and HD.HUYHOADON = 0 and HD.HOANTRA = 0 and vp.TIEPNHAN_ID =  @param0 ) hdct        where        TT_VIENPHI.VIENPHI_ID = hdct.VIENPHI_ID and TT_VIENPHI.HOADON_ID is null and isnull(TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN,0) = 0        and TT_VIENPHI.TIEPNHAN_ID =  @param0           update TT_VIENPHI        set TT_VIENPHI.HOADON_ID = null, TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN = TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN - hdct.GIATRI_BENHNHAN_DATHANHTOAN,        TT_VIENPHI.DATHANHTOAN = '0'        from (select CT.HOADON_ID, CT.VIENPHI_ID, CT.GIATRI_BENHNHAN_DATHANHTOAN        from TT_HOADON_CHITIET_NGOAITRU CT        join TT_HOADON HD on HD.HOADON_ID = CT.HOADON_ID        join TT_VIENPHI vp on vp.VIENPHI_ID = ct.VIENPHI_ID and vp.HOADON_ID = ct.HOADON_ID        where HD.DATHANHTOAN = 0 and (HD.HUYHOADON = 1 or HD.HOANTRA = 1) and vp.TIEPNHAN_ID =  @param0 ) hdct        where        TT_VIENPHI.VIENPHI_ID = hdct.VIENPHI_ID and TT_VIENPHI.HOADON_ID = hdct.HOADON_ID        and TT_VIENPHI.TIEPNHAN_ID =  @param0]
2020-02-26 14:43:52,308 [1] DEBUG - Statement Id: [DAO00067_CapnhatDataVienphiKhiHuyThanhtoanHoadon] Parameters: [@param0=[TIEPNHAN_ID,107181]]
2020-02-26 14:43:52,308 [1] DEBUG - Statement Id: [DAO00067_CapnhatDataVienphiKhiHuyThanhtoanHoadon] Types: [@param0=[Int64, System.Int64]]
2020-02-26 14:43:53,542 [1] DEBUG - Statement Id: [DAO00305_GetListLoaiBenhAn] PreparedStatement : [select        DICTIONARY_ID as LOAIBENHAN_ID        , DICTIONARY_NAME as TENLOAIBENHAN        , DICTIONARY_NAME_EN        , DICTIONARY_CODE        , DICTIONARY_NAME        from LST_DICTIONARY        where LST_DICTIONARY.Enabled = '1' and DICTIONARY_TYPE_CODE = 'LoaiBenhAn'        order by LST_DICTIONARY.IDX]
2020-02-26 14:43:57,449 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'IPD60'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 14:43:58,134 [1] DEBUG - Statement Id: [DAO00040_LayListToaMau] PreparedStatement : [select A.*, dc.TENDUOCDAYDU, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ld.MALOAIDUOC, dd.DICTIONARY_NAME DUONGDUNG, dc.TAMNGUNG            from TT_TOATHUOCMAU A            left join TM_DUOC dc on A.DUOC_ID = dc.DUOC_ID            left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID            left join (select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE like 'DuongDung') dd on dd.DICTIONARY_ID = dc.DUONGDUNG_ID            where (1=1)]
2020-02-26 14:43:59,838 [1] DEBUG - Statement Id: [DAO00040_LayListToaMau] PreparedStatement : [select A.*, dc.TENDUOCDAYDU, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ld.MALOAIDUOC, dd.DICTIONARY_NAME DUONGDUNG, dc.TAMNGUNG            from TT_TOATHUOCMAU A            left join TM_DUOC dc on A.DUOC_ID = dc.DUOC_ID            left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID            left join (select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE like 'DuongDung') dd on dd.DICTIONARY_ID = dc.DUONGDUNG_ID            where (1=1)]
2020-02-26 14:44:01,789 [1] DEBUG - Statement Id: [DAO00017_GetLoaiGiaByDoiTuongId] PreparedStatement : [select dtlg.DOUUTIEN, dtlg.DOITUONG_ID, lg.LOAIGIA_ID, lg.TENLOAIGIA, lg.MALOAIGIA              from TM_LOAIGIA lg              left join TM_DOITUONG_LOAIGIA dtlg              on lg.LOAIGIA_ID = dtlg.LOAIGIA_ID and dtlg.BENHVIEN_ID = 'HLU01'              where lg.TAMNGUNG = 0 and lg.BENHVIEN_ID = 'HLU01'                             order by dtlg.DOUUTIEN]
2020-02-26 14:44:01,826 [1] DEBUG - Statement Id: [DAO00063_GetListKhoThuocPhongBanPhamvi] PreparedStatement : [select distinct dpv.*        from TM_DUOC_PHAMVISD_MAPPING dmap        left join TM_DUOC_PHAMVISUDUNG dpv on dpv.PHAMVI_ID = dmap.PHAMVI_ID        where dmap.KHODUOC_ID in (select KHODUOC_ID from TM_PHONGBAN_KHODUOC where PHONGBAN_ID = '25')]
2020-02-26 14:44:01,854 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1027']
2020-02-26 14:44:01,878 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1030']
2020-02-26 14:44:01,901 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1032']
2020-02-26 14:44:01,926 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1057']
2020-02-26 14:44:01,961 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1027']
2020-02-26 14:44:01,986 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1030']
2020-02-26 14:44:02,011 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1032']
2020-02-26 14:44:02,037 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1057']
2020-02-26 14:44:02,061 [1] DEBUG - Statement Id: [DAO00063_GetListPhamviTuKhoThuocVaPhongBan] PreparedStatement : [select distinct dpv.*, dmap.KHODUOC_ID        from TM_DUOC_PHAMVISD_MAPPING dmap        left join TM_DUOC_PHAMVISUDUNG dpv on dpv.PHAMVI_ID = dmap.PHAMVI_ID and dpv.TAMNGUNG != '1'        where dmap.KHODUOC_ID in (select KHODUOC_ID from TM_PHONGBAN_KHODUOC where PHONGBAN_ID = '25')        and dmap.KHODUOC_ID = '29' and dpv.MAPHAMVI is not null]
2020-02-26 14:44:02,115 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 999999999 as SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        where  @param0  = 0        union all        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end        else        begin        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO        group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end]
2020-02-26 14:44:02,115 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Parameters: [@param0=[PHAMVI_ID,1027]]
2020-02-26 14:44:02,115 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Types: [@param0=[Int64, System.Int64]]
2020-02-26 14:44:02,320 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 999999999 as SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        where  @param0  = 0        union all        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end        else        begin        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO        group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end]
2020-02-26 14:44:02,320 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Parameters: [@param0=[PHAMVI_ID,1027]]
2020-02-26 14:44:02,320 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Types: [@param0=[Int64, System.Int64]]
2020-02-26 14:44:02,495 [1] DEBUG - Statement Id: [DAO00096_GetList] PreparedStatement : [select *        from TM_DUOC_THANHPHANHOATCHAT        where BENHVIEN_ID = 'HLU01']
2020-02-26 14:44:02,576 [1] DEBUG - Statement Id: [DAO00040_LayListToaMau] PreparedStatement : [select A.*, dc.TENDUOCDAYDU, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ld.MALOAIDUOC, dd.DICTIONARY_NAME DUONGDUNG, dc.TAMNGUNG            from TT_TOATHUOCMAU A            left join TM_DUOC dc on A.DUOC_ID = dc.DUOC_ID            left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID            left join (select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE like 'DuongDung') dd on dd.DICTIONARY_ID = dc.DUONGDUNG_ID            where (1=1)]
2020-02-26 14:44:04,553 [1] DEBUG - Statement Id: [DAO00063_GetListKhoThuocPhongBanPhamvi] PreparedStatement : [select distinct dpv.*        from TM_DUOC_PHAMVISD_MAPPING dmap        left join TM_DUOC_PHAMVISUDUNG dpv on dpv.PHAMVI_ID = dmap.PHAMVI_ID        where dmap.KHODUOC_ID in (select KHODUOC_ID from TM_PHONGBAN_KHODUOC where PHONGBAN_ID = '25')]
2020-02-26 14:44:04,578 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1027']
2020-02-26 14:44:04,601 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1030']
2020-02-26 14:44:04,629 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1032']
2020-02-26 14:44:04,654 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1057']
2020-02-26 14:44:04,685 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1027']
2020-02-26 14:44:04,709 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1030']
2020-02-26 14:44:04,732 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1032']
2020-02-26 14:44:04,756 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1057']
2020-02-26 14:44:04,782 [1] DEBUG - Statement Id: [DAO00063_GetListPhamviTuKhoThuocVaPhongBan] PreparedStatement : [select distinct dpv.*, dmap.KHODUOC_ID        from TM_DUOC_PHAMVISD_MAPPING dmap        left join TM_DUOC_PHAMVISUDUNG dpv on dpv.PHAMVI_ID = dmap.PHAMVI_ID and dpv.TAMNGUNG != '1'        where dmap.KHODUOC_ID in (select KHODUOC_ID from TM_PHONGBAN_KHODUOC where PHONGBAN_ID = '25')        and dmap.KHODUOC_ID = '29' and dpv.MAPHAMVI is not null]
2020-02-26 14:44:04,818 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 999999999 as SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        where  @param0  = 0        union all        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end        else        begin        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO        group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end]
2020-02-26 14:44:04,818 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Parameters: [@param0=[PHAMVI_ID,1027]]
2020-02-26 14:44:04,819 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Types: [@param0=[Int64, System.Int64]]
2020-02-26 14:44:04,901 [1] DEBUG - Statement Id: [DAO00063_Getlist_Thuoc_Tamngung] PreparedStatement : [select DUOC_ID FROM TM_DUOC where TAMNGUNG = '1']
2020-02-26 14:44:04,946 [1] DEBUG - Statement Id: [DAO00061_GetLuuTruIDByBenhAnID] PreparedStatement : [select lt.LUUTRU_ID, ba.BACSIDIEUTRI_ID as BACSIDIEUTRICHINH_ID        from TT_NOITRU_LUUTRU lt        left join TT_NOITRU_BENHAN ba on lt.BENHAN_ID = ba.BENHAN_ID        where lt.BENHAN_ID = '24642']
2020-02-26 14:44:04,978 [1] DEBUG - Statement Id: [DAO00061_GetChanDoanBenhAnID] PreparedStatement : [DECLARE @ICDPHU NVARCHAR(2000)=''        DECLARE @LISTICDPHU NVARCHAR(200)        DECLARE @CHANDOANRAVIEN NVARCHAR(500)        DECLARE @LISTICDPHUVAOKHOA NVARCHAR(50)        DECLARE @ICDPHUVAOKHOA NVARCHAR(500)=''        DECLARE @ICDKHAMBENH NVARCHAR(500) = (SELECT ICD.TENICD + '('+ISNULL(ICD.MAICD,'')+')'        FROM TT_NOITRU_BENHAN BA INNER JOIN TM_ICD ICD        ON BA.ICD_KHAMBENH = ICD.ICD_ID WHERE BA.BENHAN_ID =  @param0 )        DECLARE @ICDCHINH NVARCHAR(500) = (SELECT ICD.TENICD + '('+ISNULL(ICD.MAICD,'')+')'        FROM TT_NOITRU_BENHAN BA INNER JOIN TM_ICD ICD        ON BA.ICD_BENHCHINH = ICD.ICD_ID WHERE BA.BENHAN_ID =  @param0 )        SELECT @CHANDOANRAVIEN = BA.CHANDOANRAVIEN, @LISTICDPHU = BA.ICD_BENHPHU, @LISTICDPHUVAOKHOA = BA.ICD_PHU_VAOKHOA        FROM TT_NOITRU_BENHAN BA WHERE BA.BENHAN_ID =  @param0         SELECT @ICDPHU = @ICDPHU + ISNULL(TENICD, '') +'(' +ISNULL(MAICD,'')+ '); ' FROM TM_ICD WHERE MAICD IN (SELECT S FROM SplitString(@LISTICDPHU,';'))        SELECT @ICDPHUVAOKHOA = @ICDPHUVAOKHOA + ISNULL(TENICD, '') +'(' +ISNULL(MAICD,'')+ '); ' FROM TM_ICD WHERE MAICD IN (SELECT S FROM SplitString(@LISTICDPHUVAOKHOA,';'))        SELECT ICD_KHAMBENH, CHANDOANKHAMBENH, CHANDOANVAOKHOA, CHANDOANRAVIEN, CHANDOANKHAC                , CASE        WHEN LEN(ISNULL(BA.CDRAVIEN_PHU,'')) > 0 AND LEN(ISNULL(BA.CDRAVIEN_CHINH,'')) > 0 THEN ISNULL(BA.CDRAVIEN_CHINH,'') + '; ' + ISNULL(BA.CDRAVIEN_PHU,'')        WHEN LEN(ISNULL(BA.CDRAVIEN_PHU,'')) > 0 AND LEN(ISNULL(BA.CDRAVIEN_CHINH,'')) <= 0  THEN BA.CDRAVIEN_PHU        WHEN LEN(ISNULL(BA.CDRAVIEN_PHU,'')) <= 0 AND LEN(ISNULL(BA.CDRAVIEN_CHINH,'')) > 0 THEN BA.CDRAVIEN_CHINH        ELSE NULL END AS CHANDOANNOITRU        ,CASE WHEN @ICDKHAMBENH IS NULL AND (@CHANDOANRAVIEN IS NULL OR @CHANDOANRAVIEN = '') THEN ''        ELSE ISNULL(@ICDKHAMBENH, '') + '; ' + ISNULL(@CHANDOANRAVIEN, '') END        AS CHANDOANCAPCUU        , @ICDPHUVAOKHOA AS CHANDOANPHUVAOKHOA        FROM TT_NOITRU_BENHAN BA LEFT JOIN TM_ICD ICD ON BA.ICD_KHAMBENH = ICD.ICD_ID        WHERE BENHAN_ID =  @param0]
2020-02-26 14:44:04,978 [1] DEBUG - Statement Id: [DAO00061_GetChanDoanBenhAnID] Parameters: [@param0=[BENHAN_ID,24642]]
2020-02-26 14:44:04,978 [1] DEBUG - Statement Id: [DAO00061_GetChanDoanBenhAnID] Types: [@param0=[Int64, System.Int64]]
2020-02-26 14:44:05,028 [1] DEBUG - Statement Id: [DAO00000_GetDoiTuongIsBHYT] PreparedStatement : [select * from TM_DOITUONG Where DOITUONG_ID = 4 and MADOITUONG like '%BHYT%']
2020-02-26 14:44:05,130 [1] DEBUG - Statement Id: [DAO00068_GetLastedSinhHieuInfo] PreparedStatement : [select top (1) *, CHISOBMI as BMI              from TT_NGOAITRU_KHAMBENH_SINHHIEU              where BENHNHAN_ID = '20633'              order by KHAMBENH_SINHHIEU_ID desc]
2020-02-26 14:44:05,157 [1] DEBUG - Statement Id: [DAO00013_GetTienSuBenh] PreparedStatement : [select TIENSUBENH, TIENSUDIUNG        from TT_BENHNHAN        where TT_BENHNHAN.BENHNHAN_ID  = '20633']
2020-02-26 14:44:05,278 [1] DEBUG - Statement Id: [DAO00095_GetTTDiUngThuoc] PreparedStatement : [select *              from TT_BENHNHAN_DIUNG_THUOC              where BENHNHAN_ID = '20633'              and BENHVIEN_ID = 'HLU01']
2020-02-26 14:44:05,306 [1] DEBUG - Statement Id: [DAO00062_GetKhamBenhByTiepNhanID] PreparedStatement : [select *        from TT_NOITRU_KHAMBENH        where BENHAN_ID in        (select BENHAN_ID from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '107181')        and ISYLENHVTYT = '0'         and           BENHAN_ID = '24642'                 order by THOIGIANKHAM desc]
2020-02-26 14:44:05,332 [1] DEBUG - Statement Id: [DAO00063_GetTrangThaiYLenhTheoTiepnhanId] PreparedStatement : [select tt.CHUNGTU_ID, tt.PHIEULINH_ID, tt.TRANGTHAI, pl.DUYET as DUYETPHIEULINH,        ct.CHUNGTU_ID as CHUNGTUXUATNOIBO_ID, ct.LOAICHUNGTU, tt.KHAMBENH_ID, tt.DUOC_ID, tt.SOLUONG        from TT_NOITRU_TOATHUOC tt        left join TT_DUOC_PHIEULINH pl on tt.PHIEULINH_ID = pl.CHUNGTU_ID        left join TT_DUOC_CHUNGTU ct on pl.CHUNGTU_ID = ct.PHIEULINH_ID        where tt.TIEPNHAN_ID = '107181'        and (tt.PHIEULINH_ID is not null or tt.CHUNGTU_ID is not null or (tt.TRANGTHAI = 'DADUYET'))        order by tt.CHUNGTU_ID DESC]
2020-02-26 14:44:05,358 [1] DEBUG - Statement Id: [DAO00063_GetDanhsachTrathuocTheoBenhanId] PreparedStatement : [select A.KHAMBENH_ID, B.TOATHUOC_ID, B.DUOC_ID, SUM(B.SOLUONG) SOLUONG        from TT_NOITRU_TRATHUOC A        left join TT_NOITRU_TRATHUOC_CHITIET B on A.TRATHUOC_ID = B.TRATHUOC_ID        where A.BENHAN_ID = '24642'         group by A.KHAMBENH_ID, B.TOATHUOC_ID, B.DUOC_ID]
2020-02-26 14:44:05,403 [1] DEBUG - Statement Id: [DAO00014_GetInPatientStatus] PreparedStatement : [select TRANGTHAI, isnull(KHOACHUYENDEN_ID, KHOAVAO_ID) as KHOAHIENTAI from TT_NOITRU_BENHAN        where        TIEPNHAN_ID = '107181'        and BENHVIEN_ID = 'HLU01'         and           BENHAN_ID = '24642']
2020-02-26 14:44:29,141 [1] DEBUG - Statement Id: [DAO00030_Get_DuocCanhBaoICD_ByBenhAn_ID] PreparedStatement : [select A.*          from TM_DUOC_CANHBAO_ICD A          inner join TM_DUOC_HOATCHAT B on B.HOATCHAT_ID = A.HOATCHAT_ID          inner join TM_DUOC_THANHPHANHOATCHAT C on C.HOATCHAT_ID = B.HOATCHAT_ID          inner join TM_DUOC D on D.DUOC_ID = C.DUOC_ID          inner join TT_NOITRU_BENHAN BA on (BA.ICD_VAOKHOA = A.ICD_ID or BA.ICD_KHAMBENH = A.ICD_ID or BA.ICD_BENHCHINH = A.ICD_ID or BA.ICDRAVIEN_CHINH = A.ICD_ID          or A.MAICD in (select part from fnSplit(BA.ICD_BENHPHU, ';'))           or A.MAICD in (select part from fnSplit(BA.ICDRAVIEN_PHU, ';'))          or A.MAICD in (select part from fnSplit(BA.ICD_PHU_VAOKHOA, ';'))) and BA.BENHAN_ID = 24642          where C.DUOC_ID = 1030          and A.TAMNGUNG = '0'          and A.BENHVIEN_ID = 'HLU01']
2020-02-26 14:44:30,273 [1] DEBUG - Statement Id: [DAO00013_GetTienSuBenh] PreparedStatement : [select TIENSUBENH, TIENSUDIUNG        from TT_BENHNHAN        where TT_BENHNHAN.BENHNHAN_ID  = '20633']
2020-02-26 14:44:30,300 [1] DEBUG - Statement Id: [DAO00095_GetTTDiUngThuoc] PreparedStatement : [select *              from TT_BENHNHAN_DIUNG_THUOC              where BENHNHAN_ID = '20633'              and BENHVIEN_ID = 'HLU01']
2020-02-26 14:44:30,332 [1] DEBUG - Statement Id: [DAO00096_GetList] PreparedStatement : [select *        from TM_DUOC_THANHPHANHOATCHAT        where BENHVIEN_ID = 'HLU01']
2020-02-26 14:44:30,450 [1] DEBUG - Statement Id: [DAO00013_GetTienSuBenh] PreparedStatement : [select TIENSUBENH, TIENSUDIUNG        from TT_BENHNHAN        where TT_BENHNHAN.BENHNHAN_ID  = '20633']
2020-02-26 14:44:30,481 [1] DEBUG - Statement Id: [DAO00095_GetTTDiUngThuoc] PreparedStatement : [select *              from TT_BENHNHAN_DIUNG_THUOC              where BENHNHAN_ID = '20633'              and BENHVIEN_ID = 'HLU01']
2020-02-26 14:44:30,512 [1] DEBUG - Statement Id: [DAO00016_GetTTDuocCanhBao] PreparedStatement : [select *        from TM_DUOC_CANHBAO         where                 DUOC_ID = '1030'             and               BENHVIEN_ID = 'HLU01'                     order by DUOC_CANHBAO_ID]
2020-02-26 14:44:35,281 [1] DEBUG - Statement Id: [DAO00000_GetCHECK_DOITUONG_BHYT] PreparedStatement : [select count(*) as DOITUONG_BHYT FROM TM_DOITUONG A            WHERE A.DOITUONG_ID = '4' and A.BENHVIEN_ID = 'HLU01' and MADOITUONG like '%BHYT%']
2020-02-26 14:44:43,942 [1] DEBUG - Statement Id: [DAO00000_GetLOAIGIATHUOC_NOI_NGOAI_VIEN] PreparedStatement : [SELECT LOAIGIA_ID              FROM TM_LOAIGIA              WHERE MALOAIGIA = 'GiaThuoc_NoiVien' and BENHVIEN_ID = 'HLU01']
2020-02-26 14:47:00,068 [1] DEBUG - Statement Id: [DAO00000_GetDUOC_DONGIADOANHTHU_NOIVIEN] PreparedStatement : [declare @doanhthuKhongHT numeric(24,2);          declare @doanhthu numeric(24,2);          declare @hotro numeric(24,2);          declare @bhyt char(1);          select top 1 @doanhthuKhongHT = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0 and GIAHOTRO != '1'          order by dtlg.DOUUTIEN asc          select top 1 @doanhthu = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0           order by dtlg.DOUUTIEN asc          select top 1 @hotro = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0  and GIAHOTRO = '1'          order by dtlg.DOUUTIEN asc          select top 1 @bhyt = BHYT from TM_DUOC where DUOC_ID = 1030          select ISNULL(@doanhthu,0.0) DONGIA_DOANHTHU, ISNULL(@hotro, 0.0) DONGIA_KHAC, ISNULL(@doanhthuKhongHT, 0.0) DONGIA_KHONGHT, isnull(@bhyt, '0') BHYT]
2020-02-26 14:47:23,510 [1] DEBUG - Statement Id: [DAO00000_GetDuocBHYT] PreparedStatement : [select count(*) BHYT FROM TM_DUOC A WHERE A.DUOC_ID = '1030' and BHYT = '1']
2020-02-26 14:47:25,767 [1] DEBUG - Statement Id: [DAO00000_GetCHECK_DOITUONG_BHYT] PreparedStatement : [select count(*) as DOITUONG_BHYT FROM TM_DOITUONG A            WHERE A.DOITUONG_ID = '4' and A.BENHVIEN_ID = 'HLU01' and MADOITUONG like '%BHYT%']
2020-02-26 14:47:28,904 [1] DEBUG - Statement Id: [DAO00000_GetLOAIGIATHUOC_NOI_NGOAI_VIEN] PreparedStatement : [SELECT LOAIGIA_ID              FROM TM_LOAIGIA              WHERE MALOAIGIA = 'GiaThuoc_NoiVien' and BENHVIEN_ID = 'HLU01']
2020-02-26 14:47:28,929 [1] DEBUG - Statement Id: [DAO00000_GetDUOC_DONGIADOANHTHU_NOIVIEN] PreparedStatement : [declare @doanhthuKhongHT numeric(24,2);          declare @doanhthu numeric(24,2);          declare @hotro numeric(24,2);          declare @bhyt char(1);          select top 1 @doanhthuKhongHT = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0 and GIAHOTRO != '1'          order by dtlg.DOUUTIEN asc          select top 1 @doanhthu = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0           order by dtlg.DOUUTIEN asc          select top 1 @hotro = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0  and GIAHOTRO = '1'          order by dtlg.DOUUTIEN asc          select top 1 @bhyt = BHYT from TM_DUOC where DUOC_ID = 1030          select ISNULL(@doanhthu,0.0) DONGIA_DOANHTHU, ISNULL(@hotro, 0.0) DONGIA_KHAC, ISNULL(@doanhthuKhongHT, 0.0) DONGIA_KHONGHT, isnull(@bhyt, '0') BHYT]
2020-02-26 14:47:29,025 [1] DEBUG - Statement Id: [DAO00000_GetDuocBHYT] PreparedStatement : [select count(*) BHYT FROM TM_DUOC A WHERE A.DUOC_ID = '1030' and BHYT = '1']
2020-02-26 14:48:15,360 [1] DEBUG - Statement Id: [DAO00062_GetDetail] PreparedStatement : [select *        from TT_NOITRU_KHAMBENH        where KHAMBENH_ID  = '320477']
2020-02-26 14:48:15,451 [1] DEBUG - Statement Id: [DAO00063_GetToaThuocByKhamBenhID] PreparedStatement : [select distinct a.*, b.SOLUONG as SOLUONGTAMNGUNG,        pl.MACHUNGTU as SOPHIEULINH, ct.MACHUNGTU as SOCHUNGTU        ,vp.BHYT_DONGIA, vp.BHYT_THANHTIEN, vp.BHYT_DONGIA_CHITRA, vp.BHYT_THANHTIEN_CHITRA,        vp.THANHTIEN_DOANHTHU, vp.DONGIA_DOANHTHU, dc.TENDUOCDAYDU, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, dc.DONVITINH        , d.TAMNGUNG        from TT_NOITRU_TOATHUOC a        left join TT_NOITRU_TRATHUOC_CHITIET b on a.TOATHUOC_ID = b.TOATHUOC_ID        left join TT_DUOC_PHIEULINH pl on pl.CHUNGTU_ID = a.PHIEULINH_ID        left join TT_DUOC_CHUNGTU ct on ct.CHUNGTU_ID = a.CHUNGTU_ID        left join TM_DUOC dc on a.DUOC_ID = dc.DUOC_ID        left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID        inner join TM_DUOC d on d.DUOC_ID = a.DUOC_ID        left join (select max(BHYT_DONGIA) BHYT_DONGIA, Max(BHYT_THANHTIEN) BHYT_THANHTIEN, max(BHYT_DONGIA_CHITRA) BHYT_DONGIA_CHITRA,        max(BHYT_THANHTIEN_CHITRA) BHYT_THANHTIEN_CHITRA, max(THANHTIEN_DOANHTHU) THANHTIEN_DOANHTHU, max(DONGIA_DOANHTHU) DONGIA_DOANHTHU,        KHAMBENH_ID, REF_ID, REF_TABLE, DUOC_ID from TT_VIENPHI where KHAMBENH_ID = '320477' and REF_TABLE = 'TT_NOITRU_TOATHUOC'  group by KHAMBENH_ID, REF_ID, REF_TABLE, DUOC_ID)        vp on vp.REF_ID = a.TOATHUOC_ID and vp.REF_TABLE = 'TT_NOITRU_TOATHUOC' and vp.DUOC_ID = a.DUOC_ID        where a.KHAMBENH_ID  = '320477' and a.BENHVIEN_ID = 'HLU01']
2020-02-26 14:48:15,953 [1] DEBUG - Statement Id: [DAO00040_LayListToaMau] PreparedStatement : [select A.*, dc.TENDUOCDAYDU, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ld.MALOAIDUOC, dd.DICTIONARY_NAME DUONGDUNG, dc.TAMNGUNG            from TT_TOATHUOCMAU A            left join TM_DUOC dc on A.DUOC_ID = dc.DUOC_ID            left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID            left join (select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE like 'DuongDung') dd on dd.DICTIONARY_ID = dc.DUONGDUNG_ID            where (1=1)]
2020-02-26 14:48:20,868 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1027']
2020-02-26 14:48:21,512 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1030']
2020-02-26 14:48:21,594 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1032']
2020-02-26 14:48:21,618 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1057']
2020-02-26 14:48:21,643 [1] DEBUG - Statement Id: [DAO00063_GetListPhamviTuKhoThuocVaPhongBan] PreparedStatement : [select distinct dpv.*, dmap.KHODUOC_ID        from TM_DUOC_PHAMVISD_MAPPING dmap        left join TM_DUOC_PHAMVISUDUNG dpv on dpv.PHAMVI_ID = dmap.PHAMVI_ID and dpv.TAMNGUNG != '1'        where dmap.KHODUOC_ID in (select KHODUOC_ID from TM_PHONGBAN_KHODUOC where PHONGBAN_ID = '25')        and dmap.KHODUOC_ID = '29' and dpv.MAPHAMVI is not null]
2020-02-26 14:48:21,692 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 999999999 as SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        where  @param0  = 0        union all        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end        else        begin        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO        group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end]
2020-02-26 14:48:21,692 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Parameters: [@param0=[PHAMVI_ID,1027]]
2020-02-26 14:48:21,692 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Types: [@param0=[Int64, System.Int64]]
2020-02-26 14:48:22,062 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 999999999 as SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        where  @param0  = 0        union all        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end        else        begin        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO        group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end]
2020-02-26 14:48:22,063 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Parameters: [@param0=[PHAMVI_ID,1027]]
2020-02-26 14:48:22,063 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Types: [@param0=[Int64, System.Int64]]
2020-02-26 14:48:35,176 [1] DEBUG - Statement Id: [DAO00062_GetDetail] PreparedStatement : [select *        from TT_NOITRU_KHAMBENH        where KHAMBENH_ID  = '319833']
2020-02-26 14:48:37,949 [1] DEBUG - Statement Id: [DAO00063_GetToaThuocByKhamBenhID] PreparedStatement : [select distinct a.*, b.SOLUONG as SOLUONGTAMNGUNG,        pl.MACHUNGTU as SOPHIEULINH, ct.MACHUNGTU as SOCHUNGTU        ,vp.BHYT_DONGIA, vp.BHYT_THANHTIEN, vp.BHYT_DONGIA_CHITRA, vp.BHYT_THANHTIEN_CHITRA,        vp.THANHTIEN_DOANHTHU, vp.DONGIA_DOANHTHU, dc.TENDUOCDAYDU, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, dc.DONVITINH        , d.TAMNGUNG        from TT_NOITRU_TOATHUOC a        left join TT_NOITRU_TRATHUOC_CHITIET b on a.TOATHUOC_ID = b.TOATHUOC_ID        left join TT_DUOC_PHIEULINH pl on pl.CHUNGTU_ID = a.PHIEULINH_ID        left join TT_DUOC_CHUNGTU ct on ct.CHUNGTU_ID = a.CHUNGTU_ID        left join TM_DUOC dc on a.DUOC_ID = dc.DUOC_ID        left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID        inner join TM_DUOC d on d.DUOC_ID = a.DUOC_ID        left join (select max(BHYT_DONGIA) BHYT_DONGIA, Max(BHYT_THANHTIEN) BHYT_THANHTIEN, max(BHYT_DONGIA_CHITRA) BHYT_DONGIA_CHITRA,        max(BHYT_THANHTIEN_CHITRA) BHYT_THANHTIEN_CHITRA, max(THANHTIEN_DOANHTHU) THANHTIEN_DOANHTHU, max(DONGIA_DOANHTHU) DONGIA_DOANHTHU,        KHAMBENH_ID, REF_ID, REF_TABLE, DUOC_ID from TT_VIENPHI where KHAMBENH_ID = '319833' and REF_TABLE = 'TT_NOITRU_TOATHUOC'  group by KHAMBENH_ID, REF_ID, REF_TABLE, DUOC_ID)        vp on vp.REF_ID = a.TOATHUOC_ID and vp.REF_TABLE = 'TT_NOITRU_TOATHUOC' and vp.DUOC_ID = a.DUOC_ID        where a.KHAMBENH_ID  = '319833' and a.BENHVIEN_ID = 'HLU01']
2020-02-26 14:48:38,196 [1] DEBUG - Statement Id: [DAO00040_LayListToaMau] PreparedStatement : [select A.*, dc.TENDUOCDAYDU, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ld.MALOAIDUOC, dd.DICTIONARY_NAME DUONGDUNG, dc.TAMNGUNG            from TT_TOATHUOCMAU A            left join TM_DUOC dc on A.DUOC_ID = dc.DUOC_ID            left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID            left join (select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE like 'DuongDung') dd on dd.DICTIONARY_ID = dc.DUONGDUNG_ID            where (1=1)]
2020-02-26 14:48:40,707 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1027']
2020-02-26 14:48:40,813 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1030']
2020-02-26 14:48:40,870 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1032']
2020-02-26 14:48:40,898 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1057']
2020-02-26 14:48:40,922 [1] DEBUG - Statement Id: [DAO00063_GetListPhamviTuKhoThuocVaPhongBan] PreparedStatement : [select distinct dpv.*, dmap.KHODUOC_ID        from TM_DUOC_PHAMVISD_MAPPING dmap        left join TM_DUOC_PHAMVISUDUNG dpv on dpv.PHAMVI_ID = dmap.PHAMVI_ID and dpv.TAMNGUNG != '1'        where dmap.KHODUOC_ID in (select KHODUOC_ID from TM_PHONGBAN_KHODUOC where PHONGBAN_ID = '25')        and dmap.KHODUOC_ID = '29' and dpv.MAPHAMVI is not null]
2020-02-26 14:48:40,975 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 999999999 as SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        where  @param0  = 0        union all        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end        else        begin        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO        group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end]
2020-02-26 14:48:40,975 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Parameters: [@param0=[PHAMVI_ID,1027]]
2020-02-26 14:48:40,975 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Types: [@param0=[Int64, System.Int64]]
2020-02-26 14:48:41,171 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 999999999 as SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        where  @param0  = 0        union all        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end        else        begin        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO        group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end]
2020-02-26 14:48:41,171 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Parameters: [@param0=[PHAMVI_ID,1027]]
2020-02-26 14:48:41,171 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Types: [@param0=[Int64, System.Int64]]
2020-02-26 14:48:46,147 [1] DEBUG - Statement Id: [DAO00040_LayListToaMau] PreparedStatement : [select A.*, dc.TENDUOCDAYDU, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ld.MALOAIDUOC, dd.DICTIONARY_NAME DUONGDUNG, dc.TAMNGUNG            from TT_TOATHUOCMAU A            left join TM_DUOC dc on A.DUOC_ID = dc.DUOC_ID            left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID            left join (select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE like 'DuongDung') dd on dd.DICTIONARY_ID = dc.DUONGDUNG_ID            where (1=1)]
2020-02-26 14:48:48,552 [1] DEBUG - Statement Id: [DAO00063_GetListKhoThuocPhongBanPhamvi] PreparedStatement : [select distinct dpv.*        from TM_DUOC_PHAMVISD_MAPPING dmap        left join TM_DUOC_PHAMVISUDUNG dpv on dpv.PHAMVI_ID = dmap.PHAMVI_ID        where dmap.KHODUOC_ID in (select KHODUOC_ID from TM_PHONGBAN_KHODUOC where PHONGBAN_ID = '25')]
2020-02-26 14:48:48,581 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1027']
2020-02-26 14:48:48,605 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1030']
2020-02-26 14:48:48,629 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1032']
2020-02-26 14:48:48,653 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1057']
2020-02-26 14:48:48,689 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1027']
2020-02-26 14:48:49,138 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1030']
2020-02-26 14:48:49,163 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1032']
2020-02-26 14:48:49,194 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1057']
2020-02-26 14:48:49,218 [1] DEBUG - Statement Id: [DAO00063_GetListPhamviTuKhoThuocVaPhongBan] PreparedStatement : [select distinct dpv.*, dmap.KHODUOC_ID        from TM_DUOC_PHAMVISD_MAPPING dmap        left join TM_DUOC_PHAMVISUDUNG dpv on dpv.PHAMVI_ID = dmap.PHAMVI_ID and dpv.TAMNGUNG != '1'        where dmap.KHODUOC_ID in (select KHODUOC_ID from TM_PHONGBAN_KHODUOC where PHONGBAN_ID = '25')        and dmap.KHODUOC_ID = '29' and dpv.MAPHAMVI is not null]
2020-02-26 14:48:49,260 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 999999999 as SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        where  @param0  = 0        union all        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end        else        begin        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO        group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end]
2020-02-26 14:48:49,261 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Parameters: [@param0=[PHAMVI_ID,1027]]
2020-02-26 14:48:49,261 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Types: [@param0=[Int64, System.Int64]]
2020-02-26 14:48:49,421 [1] DEBUG - Statement Id: [DAO00061_GetLuuTruIDByBenhAnID] PreparedStatement : [select lt.LUUTRU_ID, ba.BACSIDIEUTRI_ID as BACSIDIEUTRICHINH_ID        from TT_NOITRU_LUUTRU lt        left join TT_NOITRU_BENHAN ba on lt.BENHAN_ID = ba.BENHAN_ID        where lt.BENHAN_ID = '24642']
2020-02-26 14:48:49,453 [1] DEBUG - Statement Id: [DAO00061_GetChanDoanBenhAnID] PreparedStatement : [DECLARE @ICDPHU NVARCHAR(2000)=''        DECLARE @LISTICDPHU NVARCHAR(200)        DECLARE @CHANDOANRAVIEN NVARCHAR(500)        DECLARE @LISTICDPHUVAOKHOA NVARCHAR(50)        DECLARE @ICDPHUVAOKHOA NVARCHAR(500)=''        DECLARE @ICDKHAMBENH NVARCHAR(500) = (SELECT ICD.TENICD + '('+ISNULL(ICD.MAICD,'')+')'        FROM TT_NOITRU_BENHAN BA INNER JOIN TM_ICD ICD        ON BA.ICD_KHAMBENH = ICD.ICD_ID WHERE BA.BENHAN_ID =  @param0 )        DECLARE @ICDCHINH NVARCHAR(500) = (SELECT ICD.TENICD + '('+ISNULL(ICD.MAICD,'')+')'        FROM TT_NOITRU_BENHAN BA INNER JOIN TM_ICD ICD        ON BA.ICD_BENHCHINH = ICD.ICD_ID WHERE BA.BENHAN_ID =  @param0 )        SELECT @CHANDOANRAVIEN = BA.CHANDOANRAVIEN, @LISTICDPHU = BA.ICD_BENHPHU, @LISTICDPHUVAOKHOA = BA.ICD_PHU_VAOKHOA        FROM TT_NOITRU_BENHAN BA WHERE BA.BENHAN_ID =  @param0         SELECT @ICDPHU = @ICDPHU + ISNULL(TENICD, '') +'(' +ISNULL(MAICD,'')+ '); ' FROM TM_ICD WHERE MAICD IN (SELECT S FROM SplitString(@LISTICDPHU,';'))        SELECT @ICDPHUVAOKHOA = @ICDPHUVAOKHOA + ISNULL(TENICD, '') +'(' +ISNULL(MAICD,'')+ '); ' FROM TM_ICD WHERE MAICD IN (SELECT S FROM SplitString(@LISTICDPHUVAOKHOA,';'))        SELECT ICD_KHAMBENH, CHANDOANKHAMBENH, CHANDOANVAOKHOA, CHANDOANRAVIEN, CHANDOANKHAC                , CASE        WHEN LEN(ISNULL(BA.CDRAVIEN_PHU,'')) > 0 AND LEN(ISNULL(BA.CDRAVIEN_CHINH,'')) > 0 THEN ISNULL(BA.CDRAVIEN_CHINH,'') + '; ' + ISNULL(BA.CDRAVIEN_PHU,'')        WHEN LEN(ISNULL(BA.CDRAVIEN_PHU,'')) > 0 AND LEN(ISNULL(BA.CDRAVIEN_CHINH,'')) <= 0  THEN BA.CDRAVIEN_PHU        WHEN LEN(ISNULL(BA.CDRAVIEN_PHU,'')) <= 0 AND LEN(ISNULL(BA.CDRAVIEN_CHINH,'')) > 0 THEN BA.CDRAVIEN_CHINH        ELSE NULL END AS CHANDOANNOITRU        ,CASE WHEN @ICDKHAMBENH IS NULL AND (@CHANDOANRAVIEN IS NULL OR @CHANDOANRAVIEN = '') THEN ''        ELSE ISNULL(@ICDKHAMBENH, '') + '; ' + ISNULL(@CHANDOANRAVIEN, '') END        AS CHANDOANCAPCUU        , @ICDPHUVAOKHOA AS CHANDOANPHUVAOKHOA        FROM TT_NOITRU_BENHAN BA LEFT JOIN TM_ICD ICD ON BA.ICD_KHAMBENH = ICD.ICD_ID        WHERE BENHAN_ID =  @param0]
2020-02-26 14:48:49,453 [1] DEBUG - Statement Id: [DAO00061_GetChanDoanBenhAnID] Parameters: [@param0=[BENHAN_ID,24642]]
2020-02-26 14:48:49,453 [1] DEBUG - Statement Id: [DAO00061_GetChanDoanBenhAnID] Types: [@param0=[Int64, System.Int64]]
2020-02-26 14:49:03,985 [1] DEBUG - Statement Id: [DAO00030_Get_DuocCanhBaoICD_ByBenhAn_ID] PreparedStatement : [select A.*          from TM_DUOC_CANHBAO_ICD A          inner join TM_DUOC_HOATCHAT B on B.HOATCHAT_ID = A.HOATCHAT_ID          inner join TM_DUOC_THANHPHANHOATCHAT C on C.HOATCHAT_ID = B.HOATCHAT_ID          inner join TM_DUOC D on D.DUOC_ID = C.DUOC_ID          inner join TT_NOITRU_BENHAN BA on (BA.ICD_VAOKHOA = A.ICD_ID or BA.ICD_KHAMBENH = A.ICD_ID or BA.ICD_BENHCHINH = A.ICD_ID or BA.ICDRAVIEN_CHINH = A.ICD_ID          or A.MAICD in (select part from fnSplit(BA.ICD_BENHPHU, ';'))           or A.MAICD in (select part from fnSplit(BA.ICDRAVIEN_PHU, ';'))          or A.MAICD in (select part from fnSplit(BA.ICD_PHU_VAOKHOA, ';'))) and BA.BENHAN_ID = 24642          where C.DUOC_ID = 1030          and A.TAMNGUNG = '0'          and A.BENHVIEN_ID = 'HLU01']
2020-02-26 14:49:05,986 [1] DEBUG - Statement Id: [DAO00013_GetTienSuBenh] PreparedStatement : [select TIENSUBENH, TIENSUDIUNG        from TT_BENHNHAN        where TT_BENHNHAN.BENHNHAN_ID  = '20633']
2020-02-26 14:49:08,469 [1] DEBUG - Statement Id: [DAO00095_GetTTDiUngThuoc] PreparedStatement : [select *              from TT_BENHNHAN_DIUNG_THUOC              where BENHNHAN_ID = '20633'              and BENHVIEN_ID = 'HLU01']
2020-02-26 14:49:12,890 [1] DEBUG - Statement Id: [DAO00096_GetList] PreparedStatement : [select *        from TM_DUOC_THANHPHANHOATCHAT        where BENHVIEN_ID = 'HLU01']
2020-02-26 14:49:14,282 [1] DEBUG - Statement Id: [DAO00013_GetTienSuBenh] PreparedStatement : [select TIENSUBENH, TIENSUDIUNG        from TT_BENHNHAN        where TT_BENHNHAN.BENHNHAN_ID  = '20633']
2020-02-26 14:49:14,307 [1] DEBUG - Statement Id: [DAO00095_GetTTDiUngThuoc] PreparedStatement : [select *              from TT_BENHNHAN_DIUNG_THUOC              where BENHNHAN_ID = '20633'              and BENHVIEN_ID = 'HLU01']
2020-02-26 14:49:14,332 [1] DEBUG - Statement Id: [DAO00016_GetTTDuocCanhBao] PreparedStatement : [select *        from TM_DUOC_CANHBAO         where                 DUOC_ID = '1030'             and               BENHVIEN_ID = 'HLU01'                     order by DUOC_CANHBAO_ID]
2020-02-26 14:49:16,006 [1] DEBUG - Statement Id: [DAO00000_GetCHECK_DOITUONG_BHYT] PreparedStatement : [select count(*) as DOITUONG_BHYT FROM TM_DOITUONG A            WHERE A.DOITUONG_ID = '4' and A.BENHVIEN_ID = 'HLU01' and MADOITUONG like '%BHYT%']
2020-02-26 14:49:17,014 [1] DEBUG - Statement Id: [DAO00000_GetLOAIGIATHUOC_NOI_NGOAI_VIEN] PreparedStatement : [SELECT LOAIGIA_ID              FROM TM_LOAIGIA              WHERE MALOAIGIA = 'GiaThuoc_NoiVien' and BENHVIEN_ID = 'HLU01']
2020-02-26 14:49:17,048 [1] DEBUG - Statement Id: [DAO00000_GetDUOC_DONGIADOANHTHU_NOIVIEN] PreparedStatement : [declare @doanhthuKhongHT numeric(24,2);          declare @doanhthu numeric(24,2);          declare @hotro numeric(24,2);          declare @bhyt char(1);          select top 1 @doanhthuKhongHT = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0 and GIAHOTRO != '1'          order by dtlg.DOUUTIEN asc          select top 1 @doanhthu = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0           order by dtlg.DOUUTIEN asc          select top 1 @hotro = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0  and GIAHOTRO = '1'          order by dtlg.DOUUTIEN asc          select top 1 @bhyt = BHYT from TM_DUOC where DUOC_ID = 1030          select ISNULL(@doanhthu,0.0) DONGIA_DOANHTHU, ISNULL(@hotro, 0.0) DONGIA_KHAC, ISNULL(@doanhthuKhongHT, 0.0) DONGIA_KHONGHT, isnull(@bhyt, '0') BHYT]
2020-02-26 14:49:17,076 [1] DEBUG - Statement Id: [DAO00000_GetDuocBHYT] PreparedStatement : [select count(*) BHYT FROM TM_DUOC A WHERE A.DUOC_ID = '1030' and BHYT = '1']
2020-02-26 14:49:18,176 [1] DEBUG - Statement Id: [DAO00000_GetCHECK_DOITUONG_BHYT] PreparedStatement : [select count(*) as DOITUONG_BHYT FROM TM_DOITUONG A            WHERE A.DOITUONG_ID = '4' and A.BENHVIEN_ID = 'HLU01' and MADOITUONG like '%BHYT%']
2020-02-26 14:49:19,391 [1] DEBUG - Statement Id: [DAO00000_GetLOAIGIATHUOC_NOI_NGOAI_VIEN] PreparedStatement : [SELECT LOAIGIA_ID              FROM TM_LOAIGIA              WHERE MALOAIGIA = 'GiaThuoc_NoiVien' and BENHVIEN_ID = 'HLU01']
2020-02-26 14:49:19,416 [1] DEBUG - Statement Id: [DAO00000_GetDUOC_DONGIADOANHTHU_NOIVIEN] PreparedStatement : [declare @doanhthuKhongHT numeric(24,2);          declare @doanhthu numeric(24,2);          declare @hotro numeric(24,2);          declare @bhyt char(1);          select top 1 @doanhthuKhongHT = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0 and GIAHOTRO != '1'          order by dtlg.DOUUTIEN asc          select top 1 @doanhthu = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0           order by dtlg.DOUUTIEN asc          select top 1 @hotro = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0  and GIAHOTRO = '1'          order by dtlg.DOUUTIEN asc          select top 1 @bhyt = BHYT from TM_DUOC where DUOC_ID = 1030          select ISNULL(@doanhthu,0.0) DONGIA_DOANHTHU, ISNULL(@hotro, 0.0) DONGIA_KHAC, ISNULL(@doanhthuKhongHT, 0.0) DONGIA_KHONGHT, isnull(@bhyt, '0') BHYT]
2020-02-26 14:49:19,443 [1] DEBUG - Statement Id: [DAO00000_GetDuocBHYT] PreparedStatement : [select count(*) BHYT FROM TM_DUOC A WHERE A.DUOC_ID = '1030' and BHYT = '1']
2020-02-26 14:49:38,121 [1] DEBUG - Statement Id: [DAO00030_Get_DuocCanhBaoICD_ByBenhAn_ID] PreparedStatement : [select A.*          from TM_DUOC_CANHBAO_ICD A          inner join TM_DUOC_HOATCHAT B on B.HOATCHAT_ID = A.HOATCHAT_ID          inner join TM_DUOC_THANHPHANHOATCHAT C on C.HOATCHAT_ID = B.HOATCHAT_ID          inner join TM_DUOC D on D.DUOC_ID = C.DUOC_ID          inner join TT_NOITRU_BENHAN BA on (BA.ICD_VAOKHOA = A.ICD_ID or BA.ICD_KHAMBENH = A.ICD_ID or BA.ICD_BENHCHINH = A.ICD_ID or BA.ICDRAVIEN_CHINH = A.ICD_ID          or A.MAICD in (select part from fnSplit(BA.ICD_BENHPHU, ';'))           or A.MAICD in (select part from fnSplit(BA.ICDRAVIEN_PHU, ';'))          or A.MAICD in (select part from fnSplit(BA.ICD_PHU_VAOKHOA, ';'))) and BA.BENHAN_ID = 24642          where C.DUOC_ID = 1030          and A.TAMNGUNG = '0'          and A.BENHVIEN_ID = 'HLU01']
2020-02-26 14:49:43,206 [1] DEBUG - Statement Id: [DAO00013_GetTienSuBenh] PreparedStatement : [select TIENSUBENH, TIENSUDIUNG        from TT_BENHNHAN        where TT_BENHNHAN.BENHNHAN_ID  = '20633']
2020-02-26 14:49:43,235 [1] DEBUG - Statement Id: [DAO00095_GetTTDiUngThuoc] PreparedStatement : [select *              from TT_BENHNHAN_DIUNG_THUOC              where BENHNHAN_ID = '20633'              and BENHVIEN_ID = 'HLU01']
2020-02-26 14:49:43,265 [1] DEBUG - Statement Id: [DAO00096_GetList] PreparedStatement : [select *        from TM_DUOC_THANHPHANHOATCHAT        where BENHVIEN_ID = 'HLU01']
2020-02-26 14:49:43,396 [1] DEBUG - Statement Id: [DAO00013_GetTienSuBenh] PreparedStatement : [select TIENSUBENH, TIENSUDIUNG        from TT_BENHNHAN        where TT_BENHNHAN.BENHNHAN_ID  = '20633']
2020-02-26 14:49:43,713 [1] DEBUG - Statement Id: [DAO00095_GetTTDiUngThuoc] PreparedStatement : [select *              from TT_BENHNHAN_DIUNG_THUOC              where BENHNHAN_ID = '20633'              and BENHVIEN_ID = 'HLU01']
2020-02-26 14:49:49,960 [1] DEBUG - Statement Id: [DAO00016_GetTTDuocCanhBao] PreparedStatement : [select *        from TM_DUOC_CANHBAO         where                 DUOC_ID = '1030'             and               BENHVIEN_ID = 'HLU01'                     order by DUOC_CANHBAO_ID]
2020-02-26 14:50:19,250 [1] DEBUG - Statement Id: [DAO00000_GetCHECK_DOITUONG_BHYT] PreparedStatement : [select count(*) as DOITUONG_BHYT FROM TM_DOITUONG A            WHERE A.DOITUONG_ID = '4' and A.BENHVIEN_ID = 'HLU01' and MADOITUONG like '%BHYT%']
2020-02-26 14:50:21,576 [1] DEBUG - Statement Id: [DAO00000_GetLOAIGIATHUOC_NOI_NGOAI_VIEN] PreparedStatement : [SELECT LOAIGIA_ID              FROM TM_LOAIGIA              WHERE MALOAIGIA = 'GiaThuoc_NoiVien' and BENHVIEN_ID = 'HLU01']
2020-02-26 14:50:21,600 [1] DEBUG - Statement Id: [DAO00000_GetDUOC_DONGIADOANHTHU_NOIVIEN] PreparedStatement : [declare @doanhthuKhongHT numeric(24,2);          declare @doanhthu numeric(24,2);          declare @hotro numeric(24,2);          declare @bhyt char(1);          select top 1 @doanhthuKhongHT = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0 and GIAHOTRO != '1'          order by dtlg.DOUUTIEN asc          select top 1 @doanhthu = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0           order by dtlg.DOUUTIEN asc          select top 1 @hotro = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0  and GIAHOTRO = '1'          order by dtlg.DOUUTIEN asc          select top 1 @bhyt = BHYT from TM_DUOC where DUOC_ID = 1030          select ISNULL(@doanhthu,0.0) DONGIA_DOANHTHU, ISNULL(@hotro, 0.0) DONGIA_KHAC, ISNULL(@doanhthuKhongHT, 0.0) DONGIA_KHONGHT, isnull(@bhyt, '0') BHYT]
2020-02-26 14:50:21,696 [1] DEBUG - Statement Id: [DAO00000_GetDuocBHYT] PreparedStatement : [select count(*) BHYT FROM TM_DUOC A WHERE A.DUOC_ID = '1030' and BHYT = '1']
2020-02-26 14:51:38,817 [1] DEBUG - Statement Id: [DAO00000_GetCHECK_DOITUONG_BHYT] PreparedStatement : [select count(*) as DOITUONG_BHYT FROM TM_DOITUONG A            WHERE A.DOITUONG_ID = '4' and A.BENHVIEN_ID = 'HLU01' and MADOITUONG like '%BHYT%']
2020-02-26 14:51:44,879 [1] DEBUG - Statement Id: [DAO00000_GetLOAIGIATHUOC_NOI_NGOAI_VIEN] PreparedStatement : [SELECT LOAIGIA_ID              FROM TM_LOAIGIA              WHERE MALOAIGIA = 'GiaThuoc_NoiVien' and BENHVIEN_ID = 'HLU01']
2020-02-26 14:51:47,385 [1] DEBUG - Statement Id: [DAO00000_GetDUOC_DONGIADOANHTHU_NOIVIEN] PreparedStatement : [declare @doanhthuKhongHT numeric(24,2);          declare @doanhthu numeric(24,2);          declare @hotro numeric(24,2);          declare @bhyt char(1);          select top 1 @doanhthuKhongHT = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0 and GIAHOTRO != '1'          order by dtlg.DOUUTIEN asc          select top 1 @doanhthu = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0           order by dtlg.DOUUTIEN asc          select top 1 @hotro = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0  and GIAHOTRO = '1'          order by dtlg.DOUUTIEN asc          select top 1 @bhyt = BHYT from TM_DUOC where DUOC_ID = 1030          select ISNULL(@doanhthu,0.0) DONGIA_DOANHTHU, ISNULL(@hotro, 0.0) DONGIA_KHAC, ISNULL(@doanhthuKhongHT, 0.0) DONGIA_KHONGHT, isnull(@bhyt, '0') BHYT]
2020-02-26 14:51:47,411 [1] DEBUG - Statement Id: [DAO00000_GetDuocBHYT] PreparedStatement : [select count(*) BHYT FROM TM_DUOC A WHERE A.DUOC_ID = '1030' and BHYT = '1']
2020-02-26 14:55:03,884 [1] DEBUG - Statement Id: [DAO00062_GetThongTinNhapVienCuaBenhNhan] PreparedStatement : [select top 1 ba.THOIGIANVAOKHOA THOIGIANVAO        from TT_NOITRU_BENHAN ba        where ba.BENHAN_ID =  @param0]
2020-02-26 14:55:03,885 [1] DEBUG - Statement Id: [DAO00062_GetThongTinNhapVienCuaBenhNhan] Parameters: [@param0=[BENHAN_ID,24642]]
2020-02-26 14:55:03,885 [1] DEBUG - Statement Id: [DAO00062_GetThongTinNhapVienCuaBenhNhan] Types: [@param0=[Int64, System.Int64]]
2020-02-26 14:55:03,918 [1] DEBUG - Statement Id: [DAO00014_GetInPatientStatus] PreparedStatement : [select TRANGTHAI, isnull(KHOACHUYENDEN_ID, KHOAVAO_ID) as KHOAHIENTAI from TT_NOITRU_BENHAN        where        TIEPNHAN_ID = '107181'        and BENHVIEN_ID = 'HLU01'         and           BENHAN_ID = '24642']
2020-02-26 14:57:42,520 [1] DEBUG - Statement Id: [DAO00030_Get_DuocCanhBaoICD_ByBenhAn_ID] PreparedStatement : [select A.*          from TM_DUOC_CANHBAO_ICD A          inner join TM_DUOC_HOATCHAT B on B.HOATCHAT_ID = A.HOATCHAT_ID          inner join TM_DUOC_THANHPHANHOATCHAT C on C.HOATCHAT_ID = B.HOATCHAT_ID          inner join TM_DUOC D on D.DUOC_ID = C.DUOC_ID          inner join TT_NOITRU_BENHAN BA on (BA.ICD_VAOKHOA = A.ICD_ID or BA.ICD_KHAMBENH = A.ICD_ID or BA.ICD_BENHCHINH = A.ICD_ID or BA.ICDRAVIEN_CHINH = A.ICD_ID          or A.MAICD in (select part from fnSplit(BA.ICD_BENHPHU, ';'))           or A.MAICD in (select part from fnSplit(BA.ICDRAVIEN_PHU, ';'))          or A.MAICD in (select part from fnSplit(BA.ICD_PHU_VAOKHOA, ';'))) and BA.BENHAN_ID = 24642          where C.DUOC_ID = 1030          and A.TAMNGUNG = '0'          and A.BENHVIEN_ID = 'HLU01']
2020-02-26 14:57:42,548 [1] DEBUG - Statement Id: [DAO00013_GetTienSuBenh] PreparedStatement : [select TIENSUBENH, TIENSUDIUNG        from TT_BENHNHAN        where TT_BENHNHAN.BENHNHAN_ID  = '20633']
2020-02-26 14:57:42,571 [1] DEBUG - Statement Id: [DAO00095_GetTTDiUngThuoc] PreparedStatement : [select *              from TT_BENHNHAN_DIUNG_THUOC              where BENHNHAN_ID = '20633'              and BENHVIEN_ID = 'HLU01']
2020-02-26 14:57:42,595 [1] DEBUG - Statement Id: [DAO00096_GetList] PreparedStatement : [select *        from TM_DUOC_THANHPHANHOATCHAT        where BENHVIEN_ID = 'HLU01']
2020-02-26 14:57:42,648 [1] DEBUG - Statement Id: [DAO00013_GetTienSuBenh] PreparedStatement : [select TIENSUBENH, TIENSUDIUNG        from TT_BENHNHAN        where TT_BENHNHAN.BENHNHAN_ID  = '20633']
2020-02-26 14:57:42,671 [1] DEBUG - Statement Id: [DAO00095_GetTTDiUngThuoc] PreparedStatement : [select *              from TT_BENHNHAN_DIUNG_THUOC              where BENHNHAN_ID = '20633'              and BENHVIEN_ID = 'HLU01']
2020-02-26 14:57:42,695 [1] DEBUG - Statement Id: [DAO00016_GetTTDuocCanhBao] PreparedStatement : [select *        from TM_DUOC_CANHBAO         where                 DUOC_ID = '1030'             and               BENHVIEN_ID = 'HLU01'                     order by DUOC_CANHBAO_ID]
2020-02-26 14:57:50,345 [1] DEBUG - Statement Id: [DAO00000_GetCHECK_DOITUONG_BHYT] PreparedStatement : [select count(*) as DOITUONG_BHYT FROM TM_DOITUONG A            WHERE A.DOITUONG_ID = '4' and A.BENHVIEN_ID = 'HLU01' and MADOITUONG like '%BHYT%']
2020-02-26 14:57:52,274 [1] DEBUG - Statement Id: [DAO00000_GetLOAIGIATHUOC_NOI_NGOAI_VIEN] PreparedStatement : [SELECT LOAIGIA_ID              FROM TM_LOAIGIA              WHERE MALOAIGIA = 'GiaThuoc_NoiVien' and BENHVIEN_ID = 'HLU01']
2020-02-26 14:57:53,405 [1] DEBUG - Statement Id: [DAO00000_GetDUOC_DONGIADOANHTHU_NOIVIEN] PreparedStatement : [declare @doanhthuKhongHT numeric(24,2);          declare @doanhthu numeric(24,2);          declare @hotro numeric(24,2);          declare @bhyt char(1);          select top 1 @doanhthuKhongHT = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0 and GIAHOTRO != '1'          order by dtlg.DOUUTIEN asc          select top 1 @doanhthu = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0           order by dtlg.DOUUTIEN asc          select top 1 @hotro = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0  and GIAHOTRO = '1'          order by dtlg.DOUUTIEN asc          select top 1 @bhyt = BHYT from TM_DUOC where DUOC_ID = 1030          select ISNULL(@doanhthu,0.0) DONGIA_DOANHTHU, ISNULL(@hotro, 0.0) DONGIA_KHAC, ISNULL(@doanhthuKhongHT, 0.0) DONGIA_KHONGHT, isnull(@bhyt, '0') BHYT]
2020-02-26 14:57:53,543 [1] DEBUG - Statement Id: [DAO00000_GetDuocBHYT] PreparedStatement : [select count(*) BHYT FROM TM_DUOC A WHERE A.DUOC_ID = '1030' and BHYT = '1']
2020-02-26 14:58:12,085 [1] DEBUG - Statement Id: [DAO00062_GetDetail] PreparedStatement : [select *        from TT_NOITRU_KHAMBENH        where KHAMBENH_ID  = '320477']
2020-02-26 14:58:12,175 [1] DEBUG - Statement Id: [DAO00063_GetToaThuocByKhamBenhID] PreparedStatement : [select distinct a.*, b.SOLUONG as SOLUONGTAMNGUNG,        pl.MACHUNGTU as SOPHIEULINH, ct.MACHUNGTU as SOCHUNGTU        ,vp.BHYT_DONGIA, vp.BHYT_THANHTIEN, vp.BHYT_DONGIA_CHITRA, vp.BHYT_THANHTIEN_CHITRA,        vp.THANHTIEN_DOANHTHU, vp.DONGIA_DOANHTHU, dc.TENDUOCDAYDU, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, dc.DONVITINH        , d.TAMNGUNG        from TT_NOITRU_TOATHUOC a        left join TT_NOITRU_TRATHUOC_CHITIET b on a.TOATHUOC_ID = b.TOATHUOC_ID        left join TT_DUOC_PHIEULINH pl on pl.CHUNGTU_ID = a.PHIEULINH_ID        left join TT_DUOC_CHUNGTU ct on ct.CHUNGTU_ID = a.CHUNGTU_ID        left join TM_DUOC dc on a.DUOC_ID = dc.DUOC_ID        left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID        inner join TM_DUOC d on d.DUOC_ID = a.DUOC_ID        left join (select max(BHYT_DONGIA) BHYT_DONGIA, Max(BHYT_THANHTIEN) BHYT_THANHTIEN, max(BHYT_DONGIA_CHITRA) BHYT_DONGIA_CHITRA,        max(BHYT_THANHTIEN_CHITRA) BHYT_THANHTIEN_CHITRA, max(THANHTIEN_DOANHTHU) THANHTIEN_DOANHTHU, max(DONGIA_DOANHTHU) DONGIA_DOANHTHU,        KHAMBENH_ID, REF_ID, REF_TABLE, DUOC_ID from TT_VIENPHI where KHAMBENH_ID = '320477' and REF_TABLE = 'TT_NOITRU_TOATHUOC'  group by KHAMBENH_ID, REF_ID, REF_TABLE, DUOC_ID)        vp on vp.REF_ID = a.TOATHUOC_ID and vp.REF_TABLE = 'TT_NOITRU_TOATHUOC' and vp.DUOC_ID = a.DUOC_ID        where a.KHAMBENH_ID  = '320477' and a.BENHVIEN_ID = 'HLU01']
2020-02-26 14:58:12,230 [1] DEBUG - Statement Id: [DAO00040_LayListToaMau] PreparedStatement : [select A.*, dc.TENDUOCDAYDU, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ld.MALOAIDUOC, dd.DICTIONARY_NAME DUONGDUNG, dc.TAMNGUNG            from TT_TOATHUOCMAU A            left join TM_DUOC dc on A.DUOC_ID = dc.DUOC_ID            left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID            left join (select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE like 'DuongDung') dd on dd.DICTIONARY_ID = dc.DUONGDUNG_ID            where (1=1)]
2020-02-26 14:58:15,108 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1027']
2020-02-26 14:58:15,132 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1030']
2020-02-26 14:58:15,156 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1032']
2020-02-26 14:58:15,182 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1057']
2020-02-26 14:58:15,207 [1] DEBUG - Statement Id: [DAO00063_GetListPhamviTuKhoThuocVaPhongBan] PreparedStatement : [select distinct dpv.*, dmap.KHODUOC_ID        from TM_DUOC_PHAMVISD_MAPPING dmap        left join TM_DUOC_PHAMVISUDUNG dpv on dpv.PHAMVI_ID = dmap.PHAMVI_ID and dpv.TAMNGUNG != '1'        where dmap.KHODUOC_ID in (select KHODUOC_ID from TM_PHONGBAN_KHODUOC where PHONGBAN_ID = '25')        and dmap.KHODUOC_ID = '29' and dpv.MAPHAMVI is not null]
2020-02-26 14:58:15,253 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 999999999 as SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        where  @param0  = 0        union all        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end        else        begin        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO        group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end]
2020-02-26 14:58:15,253 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Parameters: [@param0=[PHAMVI_ID,1027]]
2020-02-26 14:58:15,253 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Types: [@param0=[Int64, System.Int64]]
2020-02-26 14:58:15,358 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 999999999 as SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        where  @param0  = 0        union all        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end        else        begin        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO        group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end]
2020-02-26 14:58:15,358 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Parameters: [@param0=[PHAMVI_ID,1027]]
2020-02-26 14:58:15,358 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Types: [@param0=[Int64, System.Int64]]
2020-02-26 14:58:17,768 [1] DEBUG - Statement Id: [DAO00040_LayListToaMau] PreparedStatement : [select A.*, dc.TENDUOCDAYDU, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ld.MALOAIDUOC, dd.DICTIONARY_NAME DUONGDUNG, dc.TAMNGUNG            from TT_TOATHUOCMAU A            left join TM_DUOC dc on A.DUOC_ID = dc.DUOC_ID            left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID            left join (select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE like 'DuongDung') dd on dd.DICTIONARY_ID = dc.DUONGDUNG_ID            where (1=1)]
2020-02-26 14:58:20,000 [1] DEBUG - Statement Id: [DAO00063_GetListKhoThuocPhongBanPhamvi] PreparedStatement : [select distinct dpv.*        from TM_DUOC_PHAMVISD_MAPPING dmap        left join TM_DUOC_PHAMVISUDUNG dpv on dpv.PHAMVI_ID = dmap.PHAMVI_ID        where dmap.KHODUOC_ID in (select KHODUOC_ID from TM_PHONGBAN_KHODUOC where PHONGBAN_ID = '25')]
2020-02-26 14:58:20,025 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1027']
2020-02-26 14:58:20,049 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1030']
2020-02-26 14:58:20,073 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1032']
2020-02-26 14:58:20,097 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1057']
2020-02-26 14:58:20,141 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1027']
2020-02-26 14:58:20,165 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1030']
2020-02-26 14:58:20,190 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1032']
2020-02-26 14:58:20,215 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1057']
2020-02-26 14:58:20,239 [1] DEBUG - Statement Id: [DAO00063_GetListPhamviTuKhoThuocVaPhongBan] PreparedStatement : [select distinct dpv.*, dmap.KHODUOC_ID        from TM_DUOC_PHAMVISD_MAPPING dmap        left join TM_DUOC_PHAMVISUDUNG dpv on dpv.PHAMVI_ID = dmap.PHAMVI_ID and dpv.TAMNGUNG != '1'        where dmap.KHODUOC_ID in (select KHODUOC_ID from TM_PHONGBAN_KHODUOC where PHONGBAN_ID = '25')        and dmap.KHODUOC_ID = '29' and dpv.MAPHAMVI is not null]
2020-02-26 14:58:20,290 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 999999999 as SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        where  @param0  = 0        union all        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end        else        begin        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO        group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end]
2020-02-26 14:58:20,291 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Parameters: [@param0=[PHAMVI_ID,1027]]
2020-02-26 14:58:20,291 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Types: [@param0=[Int64, System.Int64]]
2020-02-26 14:58:23,009 [1] DEBUG - Statement Id: [DAO00040_LayListToaMau] PreparedStatement : [select A.*, dc.TENDUOCDAYDU, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ld.MALOAIDUOC, dd.DICTIONARY_NAME DUONGDUNG, dc.TAMNGUNG            from TT_TOATHUOCMAU A            left join TM_DUOC dc on A.DUOC_ID = dc.DUOC_ID            left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID            left join (select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE like 'DuongDung') dd on dd.DICTIONARY_ID = dc.DUONGDUNG_ID            where (1=1)]
2020-02-26 14:58:25,495 [1] DEBUG - Statement Id: [DAO00063_GetListKhoThuocPhongBanPhamvi] PreparedStatement : [select distinct dpv.*        from TM_DUOC_PHAMVISD_MAPPING dmap        left join TM_DUOC_PHAMVISUDUNG dpv on dpv.PHAMVI_ID = dmap.PHAMVI_ID        where dmap.KHODUOC_ID in (select KHODUOC_ID from TM_PHONGBAN_KHODUOC where PHONGBAN_ID = '25')]
2020-02-26 14:58:25,521 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1027']
2020-02-26 14:58:25,546 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1030']
2020-02-26 14:58:25,572 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1032']
2020-02-26 14:58:25,598 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1057']
2020-02-26 14:58:25,637 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1027']
2020-02-26 14:58:25,663 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1030']
2020-02-26 14:58:25,687 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1032']
2020-02-26 14:58:25,711 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1057']
2020-02-26 14:58:25,736 [1] DEBUG - Statement Id: [DAO00063_GetListPhamviTuKhoThuocVaPhongBan] PreparedStatement : [select distinct dpv.*, dmap.KHODUOC_ID        from TM_DUOC_PHAMVISD_MAPPING dmap        left join TM_DUOC_PHAMVISUDUNG dpv on dpv.PHAMVI_ID = dmap.PHAMVI_ID and dpv.TAMNGUNG != '1'        where dmap.KHODUOC_ID in (select KHODUOC_ID from TM_PHONGBAN_KHODUOC where PHONGBAN_ID = '25')        and dmap.KHODUOC_ID = '29' and dpv.MAPHAMVI is not null]
2020-02-26 14:58:25,780 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 999999999 as SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        where  @param0  = 0        union all        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end        else        begin        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO        group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end]
2020-02-26 14:58:25,780 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Parameters: [@param0=[PHAMVI_ID,1027]]
2020-02-26 14:58:25,780 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Types: [@param0=[Int64, System.Int64]]
2020-02-26 14:58:25,853 [1] DEBUG - Statement Id: [DAO00063_Getlist_Thuoc_Tamngung] PreparedStatement : [select DUOC_ID FROM TM_DUOC where TAMNGUNG = '1']
2020-02-26 14:58:25,883 [1] DEBUG - Statement Id: [DAO00061_GetLuuTruIDByBenhAnID] PreparedStatement : [select lt.LUUTRU_ID, ba.BACSIDIEUTRI_ID as BACSIDIEUTRICHINH_ID        from TT_NOITRU_LUUTRU lt        left join TT_NOITRU_BENHAN ba on lt.BENHAN_ID = ba.BENHAN_ID        where lt.BENHAN_ID = '24642']
2020-02-26 14:58:25,914 [1] DEBUG - Statement Id: [DAO00061_GetChanDoanBenhAnID] PreparedStatement : [DECLARE @ICDPHU NVARCHAR(2000)=''        DECLARE @LISTICDPHU NVARCHAR(200)        DECLARE @CHANDOANRAVIEN NVARCHAR(500)        DECLARE @LISTICDPHUVAOKHOA NVARCHAR(50)        DECLARE @ICDPHUVAOKHOA NVARCHAR(500)=''        DECLARE @ICDKHAMBENH NVARCHAR(500) = (SELECT ICD.TENICD + '('+ISNULL(ICD.MAICD,'')+')'        FROM TT_NOITRU_BENHAN BA INNER JOIN TM_ICD ICD        ON BA.ICD_KHAMBENH = ICD.ICD_ID WHERE BA.BENHAN_ID =  @param0 )        DECLARE @ICDCHINH NVARCHAR(500) = (SELECT ICD.TENICD + '('+ISNULL(ICD.MAICD,'')+')'        FROM TT_NOITRU_BENHAN BA INNER JOIN TM_ICD ICD        ON BA.ICD_BENHCHINH = ICD.ICD_ID WHERE BA.BENHAN_ID =  @param0 )        SELECT @CHANDOANRAVIEN = BA.CHANDOANRAVIEN, @LISTICDPHU = BA.ICD_BENHPHU, @LISTICDPHUVAOKHOA = BA.ICD_PHU_VAOKHOA        FROM TT_NOITRU_BENHAN BA WHERE BA.BENHAN_ID =  @param0         SELECT @ICDPHU = @ICDPHU + ISNULL(TENICD, '') +'(' +ISNULL(MAICD,'')+ '); ' FROM TM_ICD WHERE MAICD IN (SELECT S FROM SplitString(@LISTICDPHU,';'))        SELECT @ICDPHUVAOKHOA = @ICDPHUVAOKHOA + ISNULL(TENICD, '') +'(' +ISNULL(MAICD,'')+ '); ' FROM TM_ICD WHERE MAICD IN (SELECT S FROM SplitString(@LISTICDPHUVAOKHOA,';'))        SELECT ICD_KHAMBENH, CHANDOANKHAMBENH, CHANDOANVAOKHOA, CHANDOANRAVIEN, CHANDOANKHAC                , CASE        WHEN LEN(ISNULL(BA.CDRAVIEN_PHU,'')) > 0 AND LEN(ISNULL(BA.CDRAVIEN_CHINH,'')) > 0 THEN ISNULL(BA.CDRAVIEN_CHINH,'') + '; ' + ISNULL(BA.CDRAVIEN_PHU,'')        WHEN LEN(ISNULL(BA.CDRAVIEN_PHU,'')) > 0 AND LEN(ISNULL(BA.CDRAVIEN_CHINH,'')) <= 0  THEN BA.CDRAVIEN_PHU        WHEN LEN(ISNULL(BA.CDRAVIEN_PHU,'')) <= 0 AND LEN(ISNULL(BA.CDRAVIEN_CHINH,'')) > 0 THEN BA.CDRAVIEN_CHINH        ELSE NULL END AS CHANDOANNOITRU        ,CASE WHEN @ICDKHAMBENH IS NULL AND (@CHANDOANRAVIEN IS NULL OR @CHANDOANRAVIEN = '') THEN ''        ELSE ISNULL(@ICDKHAMBENH, '') + '; ' + ISNULL(@CHANDOANRAVIEN, '') END        AS CHANDOANCAPCUU        , @ICDPHUVAOKHOA AS CHANDOANPHUVAOKHOA        FROM TT_NOITRU_BENHAN BA LEFT JOIN TM_ICD ICD ON BA.ICD_KHAMBENH = ICD.ICD_ID        WHERE BENHAN_ID =  @param0]
2020-02-26 14:58:25,914 [1] DEBUG - Statement Id: [DAO00061_GetChanDoanBenhAnID] Parameters: [@param0=[BENHAN_ID,24642]]
2020-02-26 14:58:25,914 [1] DEBUG - Statement Id: [DAO00061_GetChanDoanBenhAnID] Types: [@param0=[Int64, System.Int64]]
2020-02-26 14:58:25,955 [1] DEBUG - Statement Id: [DAO00000_GetDoiTuongIsBHYT] PreparedStatement : [select * from TM_DOITUONG Where DOITUONG_ID = 4 and MADOITUONG like '%BHYT%']
2020-02-26 14:58:26,027 [1] DEBUG - Statement Id: [DAO00068_GetLastedSinhHieuInfo] PreparedStatement : [select top (1) *, CHISOBMI as BMI              from TT_NGOAITRU_KHAMBENH_SINHHIEU              where BENHNHAN_ID = '20633'              order by KHAMBENH_SINHHIEU_ID desc]
2020-02-26 14:58:26,054 [1] DEBUG - Statement Id: [DAO00013_GetTienSuBenh] PreparedStatement : [select TIENSUBENH, TIENSUDIUNG        from TT_BENHNHAN        where TT_BENHNHAN.BENHNHAN_ID  = '20633']
2020-02-26 14:58:26,078 [1] DEBUG - Statement Id: [DAO00095_GetTTDiUngThuoc] PreparedStatement : [select *              from TT_BENHNHAN_DIUNG_THUOC              where BENHNHAN_ID = '20633'              and BENHVIEN_ID = 'HLU01']
2020-02-26 14:58:26,102 [1] DEBUG - Statement Id: [DAO00062_GetKhamBenhByTiepNhanID] PreparedStatement : [select *        from TT_NOITRU_KHAMBENH        where BENHAN_ID in        (select BENHAN_ID from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '107181')        and ISYLENHVTYT = '0'         and           BENHAN_ID = '24642'                 order by THOIGIANKHAM desc]
2020-02-26 14:58:26,128 [1] DEBUG - Statement Id: [DAO00063_GetTrangThaiYLenhTheoTiepnhanId] PreparedStatement : [select tt.CHUNGTU_ID, tt.PHIEULINH_ID, tt.TRANGTHAI, pl.DUYET as DUYETPHIEULINH,        ct.CHUNGTU_ID as CHUNGTUXUATNOIBO_ID, ct.LOAICHUNGTU, tt.KHAMBENH_ID, tt.DUOC_ID, tt.SOLUONG        from TT_NOITRU_TOATHUOC tt        left join TT_DUOC_PHIEULINH pl on tt.PHIEULINH_ID = pl.CHUNGTU_ID        left join TT_DUOC_CHUNGTU ct on pl.CHUNGTU_ID = ct.PHIEULINH_ID        where tt.TIEPNHAN_ID = '107181'        and (tt.PHIEULINH_ID is not null or tt.CHUNGTU_ID is not null or (tt.TRANGTHAI = 'DADUYET'))        order by tt.CHUNGTU_ID DESC]
2020-02-26 14:58:26,154 [1] DEBUG - Statement Id: [DAO00063_GetDanhsachTrathuocTheoBenhanId] PreparedStatement : [select A.KHAMBENH_ID, B.TOATHUOC_ID, B.DUOC_ID, SUM(B.SOLUONG) SOLUONG        from TT_NOITRU_TRATHUOC A        left join TT_NOITRU_TRATHUOC_CHITIET B on A.TRATHUOC_ID = B.TRATHUOC_ID        where A.BENHAN_ID = '24642'         group by A.KHAMBENH_ID, B.TOATHUOC_ID, B.DUOC_ID]
2020-02-26 14:58:26,200 [1] DEBUG - Statement Id: [DAO00014_GetInPatientStatus] PreparedStatement : [select TRANGTHAI, isnull(KHOACHUYENDEN_ID, KHOAVAO_ID) as KHOAHIENTAI from TT_NOITRU_BENHAN        where        TIEPNHAN_ID = '107181'        and BENHVIEN_ID = 'HLU01'         and           BENHAN_ID = '24642']
2020-02-26 14:58:36,322 [1] DEBUG - Statement Id: [DAO00062_GetDetail] PreparedStatement : [select *        from TT_NOITRU_KHAMBENH        where KHAMBENH_ID  = '319833']
2020-02-26 14:58:36,346 [1] DEBUG - Statement Id: [DAO00063_GetToaThuocByKhamBenhID] PreparedStatement : [select distinct a.*, b.SOLUONG as SOLUONGTAMNGUNG,        pl.MACHUNGTU as SOPHIEULINH, ct.MACHUNGTU as SOCHUNGTU        ,vp.BHYT_DONGIA, vp.BHYT_THANHTIEN, vp.BHYT_DONGIA_CHITRA, vp.BHYT_THANHTIEN_CHITRA,        vp.THANHTIEN_DOANHTHU, vp.DONGIA_DOANHTHU, dc.TENDUOCDAYDU, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, dc.DONVITINH        , d.TAMNGUNG        from TT_NOITRU_TOATHUOC a        left join TT_NOITRU_TRATHUOC_CHITIET b on a.TOATHUOC_ID = b.TOATHUOC_ID        left join TT_DUOC_PHIEULINH pl on pl.CHUNGTU_ID = a.PHIEULINH_ID        left join TT_DUOC_CHUNGTU ct on ct.CHUNGTU_ID = a.CHUNGTU_ID        left join TM_DUOC dc on a.DUOC_ID = dc.DUOC_ID        left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID        inner join TM_DUOC d on d.DUOC_ID = a.DUOC_ID        left join (select max(BHYT_DONGIA) BHYT_DONGIA, Max(BHYT_THANHTIEN) BHYT_THANHTIEN, max(BHYT_DONGIA_CHITRA) BHYT_DONGIA_CHITRA,        max(BHYT_THANHTIEN_CHITRA) BHYT_THANHTIEN_CHITRA, max(THANHTIEN_DOANHTHU) THANHTIEN_DOANHTHU, max(DONGIA_DOANHTHU) DONGIA_DOANHTHU,        KHAMBENH_ID, REF_ID, REF_TABLE, DUOC_ID from TT_VIENPHI where KHAMBENH_ID = '319833' and REF_TABLE = 'TT_NOITRU_TOATHUOC'  group by KHAMBENH_ID, REF_ID, REF_TABLE, DUOC_ID)        vp on vp.REF_ID = a.TOATHUOC_ID and vp.REF_TABLE = 'TT_NOITRU_TOATHUOC' and vp.DUOC_ID = a.DUOC_ID        where a.KHAMBENH_ID  = '319833' and a.BENHVIEN_ID = 'HLU01']
2020-02-26 14:58:36,402 [1] DEBUG - Statement Id: [DAO00040_LayListToaMau] PreparedStatement : [select A.*, dc.TENDUOCDAYDU, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ld.MALOAIDUOC, dd.DICTIONARY_NAME DUONGDUNG, dc.TAMNGUNG            from TT_TOATHUOCMAU A            left join TM_DUOC dc on A.DUOC_ID = dc.DUOC_ID            left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID            left join (select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE like 'DuongDung') dd on dd.DICTIONARY_ID = dc.DUONGDUNG_ID            where (1=1)]
2020-02-26 14:58:38,520 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1027']
2020-02-26 14:58:38,545 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1030']
2020-02-26 14:58:38,568 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1032']
2020-02-26 14:58:38,593 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1057']
2020-02-26 14:58:38,616 [1] DEBUG - Statement Id: [DAO00063_GetListPhamviTuKhoThuocVaPhongBan] PreparedStatement : [select distinct dpv.*, dmap.KHODUOC_ID        from TM_DUOC_PHAMVISD_MAPPING dmap        left join TM_DUOC_PHAMVISUDUNG dpv on dpv.PHAMVI_ID = dmap.PHAMVI_ID and dpv.TAMNGUNG != '1'        where dmap.KHODUOC_ID in (select KHODUOC_ID from TM_PHONGBAN_KHODUOC where PHONGBAN_ID = '25')        and dmap.KHODUOC_ID = '29' and dpv.MAPHAMVI is not null]
2020-02-26 14:58:38,676 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 999999999 as SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        where  @param0  = 0        union all        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end        else        begin        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO        group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end]
2020-02-26 14:58:38,677 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Parameters: [@param0=[PHAMVI_ID,1027]]
2020-02-26 14:58:38,677 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Types: [@param0=[Int64, System.Int64]]
2020-02-26 14:58:38,751 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 999999999 as SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        where  @param0  = 0        union all        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end        else        begin        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO        group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end]
2020-02-26 14:58:38,751 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Parameters: [@param0=[PHAMVI_ID,1027]]
2020-02-26 14:58:38,751 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Types: [@param0=[Int64, System.Int64]]
2020-02-26 14:58:45,753 [1] DEBUG - Statement Id: [DAO00062_GetDetail] PreparedStatement : [select *        from TT_NOITRU_KHAMBENH        where KHAMBENH_ID  = '320477']
2020-02-26 14:58:45,781 [1] DEBUG - Statement Id: [DAO00063_GetToaThuocByKhamBenhID] PreparedStatement : [select distinct a.*, b.SOLUONG as SOLUONGTAMNGUNG,        pl.MACHUNGTU as SOPHIEULINH, ct.MACHUNGTU as SOCHUNGTU        ,vp.BHYT_DONGIA, vp.BHYT_THANHTIEN, vp.BHYT_DONGIA_CHITRA, vp.BHYT_THANHTIEN_CHITRA,        vp.THANHTIEN_DOANHTHU, vp.DONGIA_DOANHTHU, dc.TENDUOCDAYDU, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, dc.DONVITINH        , d.TAMNGUNG        from TT_NOITRU_TOATHUOC a        left join TT_NOITRU_TRATHUOC_CHITIET b on a.TOATHUOC_ID = b.TOATHUOC_ID        left join TT_DUOC_PHIEULINH pl on pl.CHUNGTU_ID = a.PHIEULINH_ID        left join TT_DUOC_CHUNGTU ct on ct.CHUNGTU_ID = a.CHUNGTU_ID        left join TM_DUOC dc on a.DUOC_ID = dc.DUOC_ID        left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID        inner join TM_DUOC d on d.DUOC_ID = a.DUOC_ID        left join (select max(BHYT_DONGIA) BHYT_DONGIA, Max(BHYT_THANHTIEN) BHYT_THANHTIEN, max(BHYT_DONGIA_CHITRA) BHYT_DONGIA_CHITRA,        max(BHYT_THANHTIEN_CHITRA) BHYT_THANHTIEN_CHITRA, max(THANHTIEN_DOANHTHU) THANHTIEN_DOANHTHU, max(DONGIA_DOANHTHU) DONGIA_DOANHTHU,        KHAMBENH_ID, REF_ID, REF_TABLE, DUOC_ID from TT_VIENPHI where KHAMBENH_ID = '320477' and REF_TABLE = 'TT_NOITRU_TOATHUOC'  group by KHAMBENH_ID, REF_ID, REF_TABLE, DUOC_ID)        vp on vp.REF_ID = a.TOATHUOC_ID and vp.REF_TABLE = 'TT_NOITRU_TOATHUOC' and vp.DUOC_ID = a.DUOC_ID        where a.KHAMBENH_ID  = '320477' and a.BENHVIEN_ID = 'HLU01']
2020-02-26 14:58:45,830 [1] DEBUG - Statement Id: [DAO00040_LayListToaMau] PreparedStatement : [select A.*, dc.TENDUOCDAYDU, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ld.MALOAIDUOC, dd.DICTIONARY_NAME DUONGDUNG, dc.TAMNGUNG            from TT_TOATHUOCMAU A            left join TM_DUOC dc on A.DUOC_ID = dc.DUOC_ID            left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID            left join (select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE like 'DuongDung') dd on dd.DICTIONARY_ID = dc.DUONGDUNG_ID            where (1=1)]
2020-02-26 14:58:47,941 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1027']
2020-02-26 14:58:47,965 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1030']
2020-02-26 14:58:47,989 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1032']
2020-02-26 14:58:48,014 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1057']
2020-02-26 14:58:48,038 [1] DEBUG - Statement Id: [DAO00063_GetListPhamviTuKhoThuocVaPhongBan] PreparedStatement : [select distinct dpv.*, dmap.KHODUOC_ID        from TM_DUOC_PHAMVISD_MAPPING dmap        left join TM_DUOC_PHAMVISUDUNG dpv on dpv.PHAMVI_ID = dmap.PHAMVI_ID and dpv.TAMNGUNG != '1'        where dmap.KHODUOC_ID in (select KHODUOC_ID from TM_PHONGBAN_KHODUOC where PHONGBAN_ID = '25')        and dmap.KHODUOC_ID = '29' and dpv.MAPHAMVI is not null]
2020-02-26 14:58:48,079 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 999999999 as SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        where  @param0  = 0        union all        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end        else        begin        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO        group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end]
2020-02-26 14:58:48,079 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Parameters: [@param0=[PHAMVI_ID,1027]]
2020-02-26 14:58:48,080 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Types: [@param0=[Int64, System.Int64]]
2020-02-26 14:58:48,168 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 999999999 as SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        where  @param0  = 0        union all        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end        else        begin        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO        group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end]
2020-02-26 14:58:48,168 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Parameters: [@param0=[PHAMVI_ID,1027]]
2020-02-26 14:58:48,168 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Types: [@param0=[Int64, System.Int64]]
2020-02-26 14:58:55,636 [1] DEBUG - Statement Id: [DAO00040_LayListToaMau] PreparedStatement : [select A.*, dc.TENDUOCDAYDU, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ld.MALOAIDUOC, dd.DICTIONARY_NAME DUONGDUNG, dc.TAMNGUNG            from TT_TOATHUOCMAU A            left join TM_DUOC dc on A.DUOC_ID = dc.DUOC_ID            left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID            left join (select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE like 'DuongDung') dd on dd.DICTIONARY_ID = dc.DUONGDUNG_ID            where (1=1)]
2020-02-26 14:58:57,597 [1] DEBUG - Statement Id: [DAO00063_GetListKhoThuocPhongBanPhamvi] PreparedStatement : [select distinct dpv.*        from TM_DUOC_PHAMVISD_MAPPING dmap        left join TM_DUOC_PHAMVISUDUNG dpv on dpv.PHAMVI_ID = dmap.PHAMVI_ID        where dmap.KHODUOC_ID in (select KHODUOC_ID from TM_PHONGBAN_KHODUOC where PHONGBAN_ID = '25')]
2020-02-26 14:58:57,626 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1027']
2020-02-26 14:58:57,651 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1030']
2020-02-26 14:58:57,675 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1032']
2020-02-26 14:58:57,706 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1057']
2020-02-26 14:58:57,757 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1027']
2020-02-26 14:58:57,794 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1030']
2020-02-26 14:58:57,854 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1032']
2020-02-26 14:58:57,885 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1057']
2020-02-26 14:58:57,914 [1] DEBUG - Statement Id: [DAO00063_GetListPhamviTuKhoThuocVaPhongBan] PreparedStatement : [select distinct dpv.*, dmap.KHODUOC_ID        from TM_DUOC_PHAMVISD_MAPPING dmap        left join TM_DUOC_PHAMVISUDUNG dpv on dpv.PHAMVI_ID = dmap.PHAMVI_ID and dpv.TAMNGUNG != '1'        where dmap.KHODUOC_ID in (select KHODUOC_ID from TM_PHONGBAN_KHODUOC where PHONGBAN_ID = '25')        and dmap.KHODUOC_ID = '29' and dpv.MAPHAMVI is not null]
2020-02-26 14:58:57,976 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 999999999 as SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        where  @param0  = 0        union all        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end        else        begin        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO        group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end]
2020-02-26 14:58:57,976 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Parameters: [@param0=[PHAMVI_ID,1027]]
2020-02-26 14:58:57,976 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Types: [@param0=[Int64, System.Int64]]
2020-02-26 14:59:00,620 [1] DEBUG - Statement Id: [DAO00040_LayListToaMau] PreparedStatement : [select A.*, dc.TENDUOCDAYDU, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ld.MALOAIDUOC, dd.DICTIONARY_NAME DUONGDUNG, dc.TAMNGUNG            from TT_TOATHUOCMAU A            left join TM_DUOC dc on A.DUOC_ID = dc.DUOC_ID            left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID            left join (select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE like 'DuongDung') dd on dd.DICTIONARY_ID = dc.DUONGDUNG_ID            where (1=1)]
2020-02-26 14:59:02,652 [1] DEBUG - Statement Id: [DAO00063_GetListKhoThuocPhongBanPhamvi] PreparedStatement : [select distinct dpv.*        from TM_DUOC_PHAMVISD_MAPPING dmap        left join TM_DUOC_PHAMVISUDUNG dpv on dpv.PHAMVI_ID = dmap.PHAMVI_ID        where dmap.KHODUOC_ID in (select KHODUOC_ID from TM_PHONGBAN_KHODUOC where PHONGBAN_ID = '25')]
2020-02-26 14:59:02,678 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1027']
2020-02-26 14:59:02,702 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1030']
2020-02-26 14:59:02,726 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1032']
2020-02-26 14:59:02,749 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1057']
2020-02-26 14:59:02,792 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1027']
2020-02-26 14:59:02,816 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1030']
2020-02-26 14:59:02,841 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1032']
2020-02-26 14:59:02,865 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1057']
2020-02-26 14:59:02,889 [1] DEBUG - Statement Id: [DAO00063_GetListPhamviTuKhoThuocVaPhongBan] PreparedStatement : [select distinct dpv.*, dmap.KHODUOC_ID        from TM_DUOC_PHAMVISD_MAPPING dmap        left join TM_DUOC_PHAMVISUDUNG dpv on dpv.PHAMVI_ID = dmap.PHAMVI_ID and dpv.TAMNGUNG != '1'        where dmap.KHODUOC_ID in (select KHODUOC_ID from TM_PHONGBAN_KHODUOC where PHONGBAN_ID = '25')        and dmap.KHODUOC_ID = '29' and dpv.MAPHAMVI is not null]
2020-02-26 14:59:02,931 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 999999999 as SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        where  @param0  = 0        union all        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end        else        begin        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO        group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end]
2020-02-26 14:59:02,931 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Parameters: [@param0=[PHAMVI_ID,1027]]
2020-02-26 14:59:02,931 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Types: [@param0=[Int64, System.Int64]]
2020-02-26 14:59:02,995 [1] DEBUG - Statement Id: [DAO00063_Getlist_Thuoc_Tamngung] PreparedStatement : [select DUOC_ID FROM TM_DUOC where TAMNGUNG = '1']
2020-02-26 14:59:03,023 [1] DEBUG - Statement Id: [DAO00061_GetLuuTruIDByBenhAnID] PreparedStatement : [select lt.LUUTRU_ID, ba.BACSIDIEUTRI_ID as BACSIDIEUTRICHINH_ID        from TT_NOITRU_LUUTRU lt        left join TT_NOITRU_BENHAN ba on lt.BENHAN_ID = ba.BENHAN_ID        where lt.BENHAN_ID = '24642']
2020-02-26 14:59:03,051 [1] DEBUG - Statement Id: [DAO00061_GetChanDoanBenhAnID] PreparedStatement : [DECLARE @ICDPHU NVARCHAR(2000)=''        DECLARE @LISTICDPHU NVARCHAR(200)        DECLARE @CHANDOANRAVIEN NVARCHAR(500)        DECLARE @LISTICDPHUVAOKHOA NVARCHAR(50)        DECLARE @ICDPHUVAOKHOA NVARCHAR(500)=''        DECLARE @ICDKHAMBENH NVARCHAR(500) = (SELECT ICD.TENICD + '('+ISNULL(ICD.MAICD,'')+')'        FROM TT_NOITRU_BENHAN BA INNER JOIN TM_ICD ICD        ON BA.ICD_KHAMBENH = ICD.ICD_ID WHERE BA.BENHAN_ID =  @param0 )        DECLARE @ICDCHINH NVARCHAR(500) = (SELECT ICD.TENICD + '('+ISNULL(ICD.MAICD,'')+')'        FROM TT_NOITRU_BENHAN BA INNER JOIN TM_ICD ICD        ON BA.ICD_BENHCHINH = ICD.ICD_ID WHERE BA.BENHAN_ID =  @param0 )        SELECT @CHANDOANRAVIEN = BA.CHANDOANRAVIEN, @LISTICDPHU = BA.ICD_BENHPHU, @LISTICDPHUVAOKHOA = BA.ICD_PHU_VAOKHOA        FROM TT_NOITRU_BENHAN BA WHERE BA.BENHAN_ID =  @param0         SELECT @ICDPHU = @ICDPHU + ISNULL(TENICD, '') +'(' +ISNULL(MAICD,'')+ '); ' FROM TM_ICD WHERE MAICD IN (SELECT S FROM SplitString(@LISTICDPHU,';'))        SELECT @ICDPHUVAOKHOA = @ICDPHUVAOKHOA + ISNULL(TENICD, '') +'(' +ISNULL(MAICD,'')+ '); ' FROM TM_ICD WHERE MAICD IN (SELECT S FROM SplitString(@LISTICDPHUVAOKHOA,';'))        SELECT ICD_KHAMBENH, CHANDOANKHAMBENH, CHANDOANVAOKHOA, CHANDOANRAVIEN, CHANDOANKHAC                , CASE        WHEN LEN(ISNULL(BA.CDRAVIEN_PHU,'')) > 0 AND LEN(ISNULL(BA.CDRAVIEN_CHINH,'')) > 0 THEN ISNULL(BA.CDRAVIEN_CHINH,'') + '; ' + ISNULL(BA.CDRAVIEN_PHU,'')        WHEN LEN(ISNULL(BA.CDRAVIEN_PHU,'')) > 0 AND LEN(ISNULL(BA.CDRAVIEN_CHINH,'')) <= 0  THEN BA.CDRAVIEN_PHU        WHEN LEN(ISNULL(BA.CDRAVIEN_PHU,'')) <= 0 AND LEN(ISNULL(BA.CDRAVIEN_CHINH,'')) > 0 THEN BA.CDRAVIEN_CHINH        ELSE NULL END AS CHANDOANNOITRU        ,CASE WHEN @ICDKHAMBENH IS NULL AND (@CHANDOANRAVIEN IS NULL OR @CHANDOANRAVIEN = '') THEN ''        ELSE ISNULL(@ICDKHAMBENH, '') + '; ' + ISNULL(@CHANDOANRAVIEN, '') END        AS CHANDOANCAPCUU        , @ICDPHUVAOKHOA AS CHANDOANPHUVAOKHOA        FROM TT_NOITRU_BENHAN BA LEFT JOIN TM_ICD ICD ON BA.ICD_KHAMBENH = ICD.ICD_ID        WHERE BENHAN_ID =  @param0]
2020-02-26 14:59:03,051 [1] DEBUG - Statement Id: [DAO00061_GetChanDoanBenhAnID] Parameters: [@param0=[BENHAN_ID,24642]]
2020-02-26 14:59:03,051 [1] DEBUG - Statement Id: [DAO00061_GetChanDoanBenhAnID] Types: [@param0=[Int64, System.Int64]]
2020-02-26 14:59:03,095 [1] DEBUG - Statement Id: [DAO00000_GetDoiTuongIsBHYT] PreparedStatement : [select * from TM_DOITUONG Where DOITUONG_ID = 4 and MADOITUONG like '%BHYT%']
2020-02-26 14:59:03,167 [1] DEBUG - Statement Id: [DAO00068_GetLastedSinhHieuInfo] PreparedStatement : [select top (1) *, CHISOBMI as BMI              from TT_NGOAITRU_KHAMBENH_SINHHIEU              where BENHNHAN_ID = '20633'              order by KHAMBENH_SINHHIEU_ID desc]
2020-02-26 14:59:03,192 [1] DEBUG - Statement Id: [DAO00013_GetTienSuBenh] PreparedStatement : [select TIENSUBENH, TIENSUDIUNG        from TT_BENHNHAN        where TT_BENHNHAN.BENHNHAN_ID  = '20633']
2020-02-26 14:59:03,216 [1] DEBUG - Statement Id: [DAO00095_GetTTDiUngThuoc] PreparedStatement : [select *              from TT_BENHNHAN_DIUNG_THUOC              where BENHNHAN_ID = '20633'              and BENHVIEN_ID = 'HLU01']
2020-02-26 14:59:03,241 [1] DEBUG - Statement Id: [DAO00062_GetKhamBenhByTiepNhanID] PreparedStatement : [select *        from TT_NOITRU_KHAMBENH        where BENHAN_ID in        (select BENHAN_ID from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '107181')        and ISYLENHVTYT = '0'         and           BENHAN_ID = '24642'                 order by THOIGIANKHAM desc]
2020-02-26 14:59:03,269 [1] DEBUG - Statement Id: [DAO00063_GetTrangThaiYLenhTheoTiepnhanId] PreparedStatement : [select tt.CHUNGTU_ID, tt.PHIEULINH_ID, tt.TRANGTHAI, pl.DUYET as DUYETPHIEULINH,        ct.CHUNGTU_ID as CHUNGTUXUATNOIBO_ID, ct.LOAICHUNGTU, tt.KHAMBENH_ID, tt.DUOC_ID, tt.SOLUONG        from TT_NOITRU_TOATHUOC tt        left join TT_DUOC_PHIEULINH pl on tt.PHIEULINH_ID = pl.CHUNGTU_ID        left join TT_DUOC_CHUNGTU ct on pl.CHUNGTU_ID = ct.PHIEULINH_ID        where tt.TIEPNHAN_ID = '107181'        and (tt.PHIEULINH_ID is not null or tt.CHUNGTU_ID is not null or (tt.TRANGTHAI = 'DADUYET'))        order by tt.CHUNGTU_ID DESC]
2020-02-26 14:59:03,295 [1] DEBUG - Statement Id: [DAO00063_GetDanhsachTrathuocTheoBenhanId] PreparedStatement : [select A.KHAMBENH_ID, B.TOATHUOC_ID, B.DUOC_ID, SUM(B.SOLUONG) SOLUONG        from TT_NOITRU_TRATHUOC A        left join TT_NOITRU_TRATHUOC_CHITIET B on A.TRATHUOC_ID = B.TRATHUOC_ID        where A.BENHAN_ID = '24642'         group by A.KHAMBENH_ID, B.TOATHUOC_ID, B.DUOC_ID]
2020-02-26 14:59:03,351 [1] DEBUG - Statement Id: [DAO00014_GetInPatientStatus] PreparedStatement : [select TRANGTHAI, isnull(KHOACHUYENDEN_ID, KHOAVAO_ID) as KHOAHIENTAI from TT_NOITRU_BENHAN        where        TIEPNHAN_ID = '107181'        and BENHVIEN_ID = 'HLU01'         and           BENHAN_ID = '24642']
2020-02-26 14:59:05,642 [1] DEBUG - Statement Id: [DAO00040_LayListToaMau] PreparedStatement : [select A.*, dc.TENDUOCDAYDU, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ld.MALOAIDUOC, dd.DICTIONARY_NAME DUONGDUNG, dc.TAMNGUNG            from TT_TOATHUOCMAU A            left join TM_DUOC dc on A.DUOC_ID = dc.DUOC_ID            left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID            left join (select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE like 'DuongDung') dd on dd.DICTIONARY_ID = dc.DUONGDUNG_ID            where (1=1)]
2020-02-26 14:59:07,702 [1] DEBUG - Statement Id: [DAO00063_GetListKhoThuocPhongBanPhamvi] PreparedStatement : [select distinct dpv.*        from TM_DUOC_PHAMVISD_MAPPING dmap        left join TM_DUOC_PHAMVISUDUNG dpv on dpv.PHAMVI_ID = dmap.PHAMVI_ID        where dmap.KHODUOC_ID in (select KHODUOC_ID from TM_PHONGBAN_KHODUOC where PHONGBAN_ID = '25')]
2020-02-26 14:59:07,727 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1027']
2020-02-26 14:59:07,751 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1030']
2020-02-26 14:59:07,775 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1032']
2020-02-26 14:59:07,799 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1057']
2020-02-26 14:59:07,841 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1027']
2020-02-26 14:59:07,865 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1030']
2020-02-26 14:59:07,889 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1032']
2020-02-26 14:59:07,915 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1057']
2020-02-26 14:59:07,939 [1] DEBUG - Statement Id: [DAO00063_GetListPhamviTuKhoThuocVaPhongBan] PreparedStatement : [select distinct dpv.*, dmap.KHODUOC_ID        from TM_DUOC_PHAMVISD_MAPPING dmap        left join TM_DUOC_PHAMVISUDUNG dpv on dpv.PHAMVI_ID = dmap.PHAMVI_ID and dpv.TAMNGUNG != '1'        where dmap.KHODUOC_ID in (select KHODUOC_ID from TM_PHONGBAN_KHODUOC where PHONGBAN_ID = '25')        and dmap.KHODUOC_ID = '29' and dpv.MAPHAMVI is not null]
2020-02-26 14:59:08,002 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 999999999 as SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        where  @param0  = 0        union all        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end        else        begin        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO        group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end]
2020-02-26 14:59:08,002 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Parameters: [@param0=[PHAMVI_ID,1027]]
2020-02-26 14:59:08,002 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Types: [@param0=[Int64, System.Int64]]
2020-02-26 14:59:08,135 [1] DEBUG - Statement Id: [DAO00061_GetLuuTruIDByBenhAnID] PreparedStatement : [select lt.LUUTRU_ID, ba.BACSIDIEUTRI_ID as BACSIDIEUTRICHINH_ID        from TT_NOITRU_LUUTRU lt        left join TT_NOITRU_BENHAN ba on lt.BENHAN_ID = ba.BENHAN_ID        where lt.BENHAN_ID = '24642']
2020-02-26 14:59:08,165 [1] DEBUG - Statement Id: [DAO00061_GetChanDoanBenhAnID] PreparedStatement : [DECLARE @ICDPHU NVARCHAR(2000)=''        DECLARE @LISTICDPHU NVARCHAR(200)        DECLARE @CHANDOANRAVIEN NVARCHAR(500)        DECLARE @LISTICDPHUVAOKHOA NVARCHAR(50)        DECLARE @ICDPHUVAOKHOA NVARCHAR(500)=''        DECLARE @ICDKHAMBENH NVARCHAR(500) = (SELECT ICD.TENICD + '('+ISNULL(ICD.MAICD,'')+')'        FROM TT_NOITRU_BENHAN BA INNER JOIN TM_ICD ICD        ON BA.ICD_KHAMBENH = ICD.ICD_ID WHERE BA.BENHAN_ID =  @param0 )        DECLARE @ICDCHINH NVARCHAR(500) = (SELECT ICD.TENICD + '('+ISNULL(ICD.MAICD,'')+')'        FROM TT_NOITRU_BENHAN BA INNER JOIN TM_ICD ICD        ON BA.ICD_BENHCHINH = ICD.ICD_ID WHERE BA.BENHAN_ID =  @param0 )        SELECT @CHANDOANRAVIEN = BA.CHANDOANRAVIEN, @LISTICDPHU = BA.ICD_BENHPHU, @LISTICDPHUVAOKHOA = BA.ICD_PHU_VAOKHOA        FROM TT_NOITRU_BENHAN BA WHERE BA.BENHAN_ID =  @param0         SELECT @ICDPHU = @ICDPHU + ISNULL(TENICD, '') +'(' +ISNULL(MAICD,'')+ '); ' FROM TM_ICD WHERE MAICD IN (SELECT S FROM SplitString(@LISTICDPHU,';'))        SELECT @ICDPHUVAOKHOA = @ICDPHUVAOKHOA + ISNULL(TENICD, '') +'(' +ISNULL(MAICD,'')+ '); ' FROM TM_ICD WHERE MAICD IN (SELECT S FROM SplitString(@LISTICDPHUVAOKHOA,';'))        SELECT ICD_KHAMBENH, CHANDOANKHAMBENH, CHANDOANVAOKHOA, CHANDOANRAVIEN, CHANDOANKHAC                , CASE        WHEN LEN(ISNULL(BA.CDRAVIEN_PHU,'')) > 0 AND LEN(ISNULL(BA.CDRAVIEN_CHINH,'')) > 0 THEN ISNULL(BA.CDRAVIEN_CHINH,'') + '; ' + ISNULL(BA.CDRAVIEN_PHU,'')        WHEN LEN(ISNULL(BA.CDRAVIEN_PHU,'')) > 0 AND LEN(ISNULL(BA.CDRAVIEN_CHINH,'')) <= 0  THEN BA.CDRAVIEN_PHU        WHEN LEN(ISNULL(BA.CDRAVIEN_PHU,'')) <= 0 AND LEN(ISNULL(BA.CDRAVIEN_CHINH,'')) > 0 THEN BA.CDRAVIEN_CHINH        ELSE NULL END AS CHANDOANNOITRU        ,CASE WHEN @ICDKHAMBENH IS NULL AND (@CHANDOANRAVIEN IS NULL OR @CHANDOANRAVIEN = '') THEN ''        ELSE ISNULL(@ICDKHAMBENH, '') + '; ' + ISNULL(@CHANDOANRAVIEN, '') END        AS CHANDOANCAPCUU        , @ICDPHUVAOKHOA AS CHANDOANPHUVAOKHOA        FROM TT_NOITRU_BENHAN BA LEFT JOIN TM_ICD ICD ON BA.ICD_KHAMBENH = ICD.ICD_ID        WHERE BENHAN_ID =  @param0]
2020-02-26 14:59:08,165 [1] DEBUG - Statement Id: [DAO00061_GetChanDoanBenhAnID] Parameters: [@param0=[BENHAN_ID,24642]]
2020-02-26 14:59:08,165 [1] DEBUG - Statement Id: [DAO00061_GetChanDoanBenhAnID] Types: [@param0=[Int64, System.Int64]]
2020-02-26 14:59:25,160 [1] DEBUG - Statement Id: [DAO00030_Get_DuocCanhBaoICD_ByBenhAn_ID] PreparedStatement : [select A.*          from TM_DUOC_CANHBAO_ICD A          inner join TM_DUOC_HOATCHAT B on B.HOATCHAT_ID = A.HOATCHAT_ID          inner join TM_DUOC_THANHPHANHOATCHAT C on C.HOATCHAT_ID = B.HOATCHAT_ID          inner join TM_DUOC D on D.DUOC_ID = C.DUOC_ID          inner join TT_NOITRU_BENHAN BA on (BA.ICD_VAOKHOA = A.ICD_ID or BA.ICD_KHAMBENH = A.ICD_ID or BA.ICD_BENHCHINH = A.ICD_ID or BA.ICDRAVIEN_CHINH = A.ICD_ID          or A.MAICD in (select part from fnSplit(BA.ICD_BENHPHU, ';'))           or A.MAICD in (select part from fnSplit(BA.ICDRAVIEN_PHU, ';'))          or A.MAICD in (select part from fnSplit(BA.ICD_PHU_VAOKHOA, ';'))) and BA.BENHAN_ID = 24642          where C.DUOC_ID = 1030          and A.TAMNGUNG = '0'          and A.BENHVIEN_ID = 'HLU01']
2020-02-26 14:59:25,188 [1] DEBUG - Statement Id: [DAO00013_GetTienSuBenh] PreparedStatement : [select TIENSUBENH, TIENSUDIUNG        from TT_BENHNHAN        where TT_BENHNHAN.BENHNHAN_ID  = '20633']
2020-02-26 14:59:25,213 [1] DEBUG - Statement Id: [DAO00095_GetTTDiUngThuoc] PreparedStatement : [select *              from TT_BENHNHAN_DIUNG_THUOC              where BENHNHAN_ID = '20633'              and BENHVIEN_ID = 'HLU01']
2020-02-26 14:59:25,237 [1] DEBUG - Statement Id: [DAO00096_GetList] PreparedStatement : [select *        from TM_DUOC_THANHPHANHOATCHAT        where BENHVIEN_ID = 'HLU01']
2020-02-26 14:59:25,264 [1] DEBUG - Statement Id: [DAO00013_GetTienSuBenh] PreparedStatement : [select TIENSUBENH, TIENSUDIUNG        from TT_BENHNHAN        where TT_BENHNHAN.BENHNHAN_ID  = '20633']
2020-02-26 14:59:25,288 [1] DEBUG - Statement Id: [DAO00095_GetTTDiUngThuoc] PreparedStatement : [select *              from TT_BENHNHAN_DIUNG_THUOC              where BENHNHAN_ID = '20633'              and BENHVIEN_ID = 'HLU01']
2020-02-26 14:59:25,312 [1] DEBUG - Statement Id: [DAO00016_GetTTDuocCanhBao] PreparedStatement : [select *        from TM_DUOC_CANHBAO         where                 DUOC_ID = '1030'             and               BENHVIEN_ID = 'HLU01'                     order by DUOC_CANHBAO_ID]
2020-02-26 14:59:55,562 [1] DEBUG - Statement Id: [DAO00000_GetCHECK_DOITUONG_BHYT] PreparedStatement : [select count(*) as DOITUONG_BHYT FROM TM_DOITUONG A            WHERE A.DOITUONG_ID = '4' and A.BENHVIEN_ID = 'HLU01' and MADOITUONG like '%BHYT%']
2020-02-26 14:59:57,886 [1] DEBUG - Statement Id: [DAO00000_GetLOAIGIATHUOC_NOI_NGOAI_VIEN] PreparedStatement : [SELECT LOAIGIA_ID              FROM TM_LOAIGIA              WHERE MALOAIGIA = 'GiaThuoc_NoiVien' and BENHVIEN_ID = 'HLU01']
2020-02-26 14:59:57,911 [1] DEBUG - Statement Id: [DAO00000_GetDUOC_DONGIADOANHTHU_NOIVIEN] PreparedStatement : [declare @doanhthuKhongHT numeric(24,2);          declare @doanhthu numeric(24,2);          declare @hotro numeric(24,2);          declare @bhyt char(1);          select top 1 @doanhthuKhongHT = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0 and GIAHOTRO != '1'          order by dtlg.DOUUTIEN asc          select top 1 @doanhthu = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0           order by dtlg.DOUUTIEN asc          select top 1 @hotro = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0  and GIAHOTRO = '1'          order by dtlg.DOUUTIEN asc          select top 1 @bhyt = BHYT from TM_DUOC where DUOC_ID = 1030          select ISNULL(@doanhthu,0.0) DONGIA_DOANHTHU, ISNULL(@hotro, 0.0) DONGIA_KHAC, ISNULL(@doanhthuKhongHT, 0.0) DONGIA_KHONGHT, isnull(@bhyt, '0') BHYT]
2020-02-26 14:59:58,491 [1] DEBUG - Statement Id: [DAO00000_GetDuocBHYT] PreparedStatement : [select count(*) BHYT FROM TM_DUOC A WHERE A.DUOC_ID = '1030' and BHYT = '1']
2020-02-26 15:02:18,899 [1] DEBUG - Statement Id: [DAO00000_GetCHECK_DOITUONG_BHYT] PreparedStatement : [select count(*) as DOITUONG_BHYT FROM TM_DOITUONG A            WHERE A.DOITUONG_ID = '4' and A.BENHVIEN_ID = 'HLU01' and MADOITUONG like '%BHYT%']
2020-02-26 15:02:20,723 [1] DEBUG - Statement Id: [DAO00000_GetLOAIGIATHUOC_NOI_NGOAI_VIEN] PreparedStatement : [SELECT LOAIGIA_ID              FROM TM_LOAIGIA              WHERE MALOAIGIA = 'GiaThuoc_NoiVien' and BENHVIEN_ID = 'HLU01']
2020-02-26 15:02:20,749 [1] DEBUG - Statement Id: [DAO00000_GetDUOC_DONGIADOANHTHU_NOIVIEN] PreparedStatement : [declare @doanhthuKhongHT numeric(24,2);          declare @doanhthu numeric(24,2);          declare @hotro numeric(24,2);          declare @bhyt char(1);          select top 1 @doanhthuKhongHT = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0 and GIAHOTRO != '1'          order by dtlg.DOUUTIEN asc          select top 1 @doanhthu = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0           order by dtlg.DOUUTIEN asc          select top 1 @hotro = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0  and GIAHOTRO = '1'          order by dtlg.DOUUTIEN asc          select top 1 @bhyt = BHYT from TM_DUOC where DUOC_ID = 1030          select ISNULL(@doanhthu,0.0) DONGIA_DOANHTHU, ISNULL(@hotro, 0.0) DONGIA_KHAC, ISNULL(@doanhthuKhongHT, 0.0) DONGIA_KHONGHT, isnull(@bhyt, '0') BHYT]
2020-02-26 15:02:20,779 [1] DEBUG - Statement Id: [DAO00000_GetDuocBHYT] PreparedStatement : [select count(*) BHYT FROM TM_DUOC A WHERE A.DUOC_ID = '1030' and BHYT = '1']
2020-02-26 15:02:33,888 [1] DEBUG - Statement Id: [DAO00030_Get_DuocCanhBaoICD_ByBenhAn_ID] PreparedStatement : [select A.*          from TM_DUOC_CANHBAO_ICD A          inner join TM_DUOC_HOATCHAT B on B.HOATCHAT_ID = A.HOATCHAT_ID          inner join TM_DUOC_THANHPHANHOATCHAT C on C.HOATCHAT_ID = B.HOATCHAT_ID          inner join TM_DUOC D on D.DUOC_ID = C.DUOC_ID          inner join TT_NOITRU_BENHAN BA on (BA.ICD_VAOKHOA = A.ICD_ID or BA.ICD_KHAMBENH = A.ICD_ID or BA.ICD_BENHCHINH = A.ICD_ID or BA.ICDRAVIEN_CHINH = A.ICD_ID          or A.MAICD in (select part from fnSplit(BA.ICD_BENHPHU, ';'))           or A.MAICD in (select part from fnSplit(BA.ICDRAVIEN_PHU, ';'))          or A.MAICD in (select part from fnSplit(BA.ICD_PHU_VAOKHOA, ';'))) and BA.BENHAN_ID = 24642          where C.DUOC_ID = 1030          and A.TAMNGUNG = '0'          and A.BENHVIEN_ID = 'HLU01']
2020-02-26 15:02:33,998 [1] DEBUG - Statement Id: [DAO00013_GetTienSuBenh] PreparedStatement : [select TIENSUBENH, TIENSUDIUNG        from TT_BENHNHAN        where TT_BENHNHAN.BENHNHAN_ID  = '20633']
2020-02-26 15:02:34,023 [1] DEBUG - Statement Id: [DAO00095_GetTTDiUngThuoc] PreparedStatement : [select *              from TT_BENHNHAN_DIUNG_THUOC              where BENHNHAN_ID = '20633'              and BENHVIEN_ID = 'HLU01']
2020-02-26 15:02:34,054 [1] DEBUG - Statement Id: [DAO00096_GetList] PreparedStatement : [select *        from TM_DUOC_THANHPHANHOATCHAT        where BENHVIEN_ID = 'HLU01']
2020-02-26 15:02:34,136 [1] DEBUG - Statement Id: [DAO00013_GetTienSuBenh] PreparedStatement : [select TIENSUBENH, TIENSUDIUNG        from TT_BENHNHAN        where TT_BENHNHAN.BENHNHAN_ID  = '20633']
2020-02-26 15:02:34,161 [1] DEBUG - Statement Id: [DAO00095_GetTTDiUngThuoc] PreparedStatement : [select *              from TT_BENHNHAN_DIUNG_THUOC              where BENHNHAN_ID = '20633'              and BENHVIEN_ID = 'HLU01']
2020-02-26 15:02:34,185 [1] DEBUG - Statement Id: [DAO00016_GetTTDuocCanhBao] PreparedStatement : [select *        from TM_DUOC_CANHBAO         where                 DUOC_ID = '1030'             and               BENHVIEN_ID = 'HLU01'                     order by DUOC_CANHBAO_ID]
2020-02-26 15:03:28,138 [1] DEBUG - Statement Id: [DAO00000_GetCHECK_DOITUONG_BHYT] PreparedStatement : [select count(*) as DOITUONG_BHYT FROM TM_DOITUONG A            WHERE A.DOITUONG_ID = '4' and A.BENHVIEN_ID = 'HLU01' and MADOITUONG like '%BHYT%']
2020-02-26 15:03:33,432 [1] DEBUG - Statement Id: [DAO00000_GetLOAIGIATHUOC_NOI_NGOAI_VIEN] PreparedStatement : [SELECT LOAIGIA_ID              FROM TM_LOAIGIA              WHERE MALOAIGIA = 'GiaThuoc_NoiVien' and BENHVIEN_ID = 'HLU01']
2020-02-26 15:03:47,939 [1] DEBUG - Statement Id: [DAO00000_GetDUOC_DONGIADOANHTHU_NOIVIEN] PreparedStatement : [declare @doanhthuKhongHT numeric(24,2);          declare @doanhthu numeric(24,2);          declare @hotro numeric(24,2);          declare @bhyt char(1);          select top 1 @doanhthuKhongHT = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0 and GIAHOTRO != '1'          order by dtlg.DOUUTIEN asc          select top 1 @doanhthu = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0           order by dtlg.DOUUTIEN asc          select top 1 @hotro = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0  and GIAHOTRO = '1'          order by dtlg.DOUUTIEN asc          select top 1 @bhyt = BHYT from TM_DUOC where DUOC_ID = 1030          select ISNULL(@doanhthu,0.0) DONGIA_DOANHTHU, ISNULL(@hotro, 0.0) DONGIA_KHAC, ISNULL(@doanhthuKhongHT, 0.0) DONGIA_KHONGHT, isnull(@bhyt, '0') BHYT]
2020-02-26 15:04:19,594 [1] DEBUG - Statement Id: [DAO00000_GetDuocBHYT] PreparedStatement : [select count(*) BHYT FROM TM_DUOC A WHERE A.DUOC_ID = '1030' and BHYT = '1']
2020-02-26 15:04:28,557 [1] DEBUG - Statement Id: [DAO00000_GetCHECK_DOITUONG_BHYT] PreparedStatement : [select count(*) as DOITUONG_BHYT FROM TM_DOITUONG A            WHERE A.DOITUONG_ID = '4' and A.BENHVIEN_ID = 'HLU01' and MADOITUONG like '%BHYT%']
2020-02-26 15:04:32,970 [1] DEBUG - Statement Id: [DAO00000_GetLOAIGIATHUOC_NOI_NGOAI_VIEN] PreparedStatement : [SELECT LOAIGIA_ID              FROM TM_LOAIGIA              WHERE MALOAIGIA = 'GiaThuoc_NoiVien' and BENHVIEN_ID = 'HLU01']
2020-02-26 15:04:37,741 [1] DEBUG - Statement Id: [DAO00000_GetDUOC_DONGIADOANHTHU_NOIVIEN] PreparedStatement : [declare @doanhthuKhongHT numeric(24,2);          declare @doanhthu numeric(24,2);          declare @hotro numeric(24,2);          declare @bhyt char(1);          select top 1 @doanhthuKhongHT = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0 and GIAHOTRO != '1'          order by dtlg.DOUUTIEN asc          select top 1 @doanhthu = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0           order by dtlg.DOUUTIEN asc          select top 1 @hotro = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0  and GIAHOTRO = '1'          order by dtlg.DOUUTIEN asc          select top 1 @bhyt = BHYT from TM_DUOC where DUOC_ID = 1030          select ISNULL(@doanhthu,0.0) DONGIA_DOANHTHU, ISNULL(@hotro, 0.0) DONGIA_KHAC, ISNULL(@doanhthuKhongHT, 0.0) DONGIA_KHONGHT, isnull(@bhyt, '0') BHYT]
2020-02-26 15:04:39,196 [1] DEBUG - Statement Id: [DAO00000_GetDuocBHYT] PreparedStatement : [select count(*) BHYT FROM TM_DUOC A WHERE A.DUOC_ID = '1030' and BHYT = '1']
2020-02-26 15:12:30,144 [1] DEBUG - Statement Id: [DAO00030_Get_DuocCanhBaoICD_ByBenhAn_ID] PreparedStatement : [select A.*          from TM_DUOC_CANHBAO_ICD A          inner join TM_DUOC_HOATCHAT B on B.HOATCHAT_ID = A.HOATCHAT_ID          inner join TM_DUOC_THANHPHANHOATCHAT C on C.HOATCHAT_ID = B.HOATCHAT_ID          inner join TM_DUOC D on D.DUOC_ID = C.DUOC_ID          inner join TT_NOITRU_BENHAN BA on (BA.ICD_VAOKHOA = A.ICD_ID or BA.ICD_KHAMBENH = A.ICD_ID or BA.ICD_BENHCHINH = A.ICD_ID or BA.ICDRAVIEN_CHINH = A.ICD_ID          or A.MAICD in (select part from fnSplit(BA.ICD_BENHPHU, ';'))           or A.MAICD in (select part from fnSplit(BA.ICDRAVIEN_PHU, ';'))          or A.MAICD in (select part from fnSplit(BA.ICD_PHU_VAOKHOA, ';'))) and BA.BENHAN_ID = 24642          where C.DUOC_ID = 1030          and A.TAMNGUNG = '0'          and A.BENHVIEN_ID = 'HLU01']
2020-02-26 15:12:30,300 [1] DEBUG - Statement Id: [DAO00013_GetTienSuBenh] PreparedStatement : [select TIENSUBENH, TIENSUDIUNG        from TT_BENHNHAN        where TT_BENHNHAN.BENHNHAN_ID  = '20633']
2020-02-26 15:12:30,323 [1] DEBUG - Statement Id: [DAO00095_GetTTDiUngThuoc] PreparedStatement : [select *              from TT_BENHNHAN_DIUNG_THUOC              where BENHNHAN_ID = '20633'              and BENHVIEN_ID = 'HLU01']
2020-02-26 15:12:30,346 [1] DEBUG - Statement Id: [DAO00096_GetList] PreparedStatement : [select *        from TM_DUOC_THANHPHANHOATCHAT        where BENHVIEN_ID = 'HLU01']
2020-02-26 15:12:30,373 [1] DEBUG - Statement Id: [DAO00013_GetTienSuBenh] PreparedStatement : [select TIENSUBENH, TIENSUDIUNG        from TT_BENHNHAN        where TT_BENHNHAN.BENHNHAN_ID  = '20633']
2020-02-26 15:12:30,397 [1] DEBUG - Statement Id: [DAO00095_GetTTDiUngThuoc] PreparedStatement : [select *              from TT_BENHNHAN_DIUNG_THUOC              where BENHNHAN_ID = '20633'              and BENHVIEN_ID = 'HLU01']
2020-02-26 15:12:30,423 [1] DEBUG - Statement Id: [DAO00016_GetTTDuocCanhBao] PreparedStatement : [select *        from TM_DUOC_CANHBAO         where                 DUOC_ID = '1030'             and               BENHVIEN_ID = 'HLU01'                     order by DUOC_CANHBAO_ID]
2020-02-26 15:12:39,179 [1] DEBUG - Statement Id: [DAO00000_GetCHECK_DOITUONG_BHYT] PreparedStatement : [select count(*) as DOITUONG_BHYT FROM TM_DOITUONG A            WHERE A.DOITUONG_ID = '4' and A.BENHVIEN_ID = 'HLU01' and MADOITUONG like '%BHYT%']
2020-02-26 15:12:40,451 [1] DEBUG - Statement Id: [DAO00000_GetLOAIGIATHUOC_NOI_NGOAI_VIEN] PreparedStatement : [SELECT LOAIGIA_ID              FROM TM_LOAIGIA              WHERE MALOAIGIA = 'GiaThuoc_NoiVien' and BENHVIEN_ID = 'HLU01']
2020-02-26 15:12:40,475 [1] DEBUG - Statement Id: [DAO00000_GetDUOC_DONGIADOANHTHU_NOIVIEN] PreparedStatement : [declare @doanhthuKhongHT numeric(24,2);          declare @doanhthu numeric(24,2);          declare @hotro numeric(24,2);          declare @bhyt char(1);          select top 1 @doanhthuKhongHT = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0 and GIAHOTRO != '1'          order by dtlg.DOUUTIEN asc          select top 1 @doanhthu = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0           order by dtlg.DOUUTIEN asc          select top 1 @hotro = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0  and GIAHOTRO = '1'          order by dtlg.DOUUTIEN asc          select top 1 @bhyt = BHYT from TM_DUOC where DUOC_ID = 1030          select ISNULL(@doanhthu,0.0) DONGIA_DOANHTHU, ISNULL(@hotro, 0.0) DONGIA_KHAC, ISNULL(@doanhthuKhongHT, 0.0) DONGIA_KHONGHT, isnull(@bhyt, '0') BHYT]
2020-02-26 15:12:40,500 [1] DEBUG - Statement Id: [DAO00000_GetDuocBHYT] PreparedStatement : [select count(*) BHYT FROM TM_DUOC A WHERE A.DUOC_ID = '1030' and BHYT = '1']
2020-02-26 15:12:53,215 [1] DEBUG - Statement Id: [DAO00030_Get_DuocCanhBaoICD_ByBenhAn_ID] PreparedStatement : [select A.*          from TM_DUOC_CANHBAO_ICD A          inner join TM_DUOC_HOATCHAT B on B.HOATCHAT_ID = A.HOATCHAT_ID          inner join TM_DUOC_THANHPHANHOATCHAT C on C.HOATCHAT_ID = B.HOATCHAT_ID          inner join TM_DUOC D on D.DUOC_ID = C.DUOC_ID          inner join TT_NOITRU_BENHAN BA on (BA.ICD_VAOKHOA = A.ICD_ID or BA.ICD_KHAMBENH = A.ICD_ID or BA.ICD_BENHCHINH = A.ICD_ID or BA.ICDRAVIEN_CHINH = A.ICD_ID          or A.MAICD in (select part from fnSplit(BA.ICD_BENHPHU, ';'))           or A.MAICD in (select part from fnSplit(BA.ICDRAVIEN_PHU, ';'))          or A.MAICD in (select part from fnSplit(BA.ICD_PHU_VAOKHOA, ';'))) and BA.BENHAN_ID = 24642          where C.DUOC_ID = 1030          and A.TAMNGUNG = '0'          and A.BENHVIEN_ID = 'HLU01']
2020-02-26 15:12:53,243 [1] DEBUG - Statement Id: [DAO00013_GetTienSuBenh] PreparedStatement : [select TIENSUBENH, TIENSUDIUNG        from TT_BENHNHAN        where TT_BENHNHAN.BENHNHAN_ID  = '20633']
2020-02-26 15:12:53,266 [1] DEBUG - Statement Id: [DAO00095_GetTTDiUngThuoc] PreparedStatement : [select *              from TT_BENHNHAN_DIUNG_THUOC              where BENHNHAN_ID = '20633'              and BENHVIEN_ID = 'HLU01']
2020-02-26 15:12:53,289 [1] DEBUG - Statement Id: [DAO00096_GetList] PreparedStatement : [select *        from TM_DUOC_THANHPHANHOATCHAT        where BENHVIEN_ID = 'HLU01']
2020-02-26 15:12:53,326 [1] DEBUG - Statement Id: [DAO00013_GetTienSuBenh] PreparedStatement : [select TIENSUBENH, TIENSUDIUNG        from TT_BENHNHAN        where TT_BENHNHAN.BENHNHAN_ID  = '20633']
2020-02-26 15:12:53,350 [1] DEBUG - Statement Id: [DAO00095_GetTTDiUngThuoc] PreparedStatement : [select *              from TT_BENHNHAN_DIUNG_THUOC              where BENHNHAN_ID = '20633'              and BENHVIEN_ID = 'HLU01']
2020-02-26 15:12:53,374 [1] DEBUG - Statement Id: [DAO00016_GetTTDuocCanhBao] PreparedStatement : [select *        from TM_DUOC_CANHBAO         where                 DUOC_ID = '1030'             and               BENHVIEN_ID = 'HLU01'                     order by DUOC_CANHBAO_ID]
2020-02-26 15:12:57,014 [1] DEBUG - Statement Id: [DAO00000_GetCHECK_DOITUONG_BHYT] PreparedStatement : [select count(*) as DOITUONG_BHYT FROM TM_DOITUONG A            WHERE A.DOITUONG_ID = '4' and A.BENHVIEN_ID = 'HLU01' and MADOITUONG like '%BHYT%']
2020-02-26 15:12:58,022 [1] DEBUG - Statement Id: [DAO00000_GetLOAIGIATHUOC_NOI_NGOAI_VIEN] PreparedStatement : [SELECT LOAIGIA_ID              FROM TM_LOAIGIA              WHERE MALOAIGIA = 'GiaThuoc_NoiVien' and BENHVIEN_ID = 'HLU01']
2020-02-26 15:12:58,046 [1] DEBUG - Statement Id: [DAO00000_GetDUOC_DONGIADOANHTHU_NOIVIEN] PreparedStatement : [declare @doanhthuKhongHT numeric(24,2);          declare @doanhthu numeric(24,2);          declare @hotro numeric(24,2);          declare @bhyt char(1);          select top 1 @doanhthuKhongHT = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0 and GIAHOTRO != '1'          order by dtlg.DOUUTIEN asc          select top 1 @doanhthu = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0           order by dtlg.DOUUTIEN asc          select top 1 @hotro = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0  and GIAHOTRO = '1'          order by dtlg.DOUUTIEN asc          select top 1 @bhyt = BHYT from TM_DUOC where DUOC_ID = 1030          select ISNULL(@doanhthu,0.0) DONGIA_DOANHTHU, ISNULL(@hotro, 0.0) DONGIA_KHAC, ISNULL(@doanhthuKhongHT, 0.0) DONGIA_KHONGHT, isnull(@bhyt, '0') BHYT]
2020-02-26 15:12:58,077 [1] DEBUG - Statement Id: [DAO00000_GetDuocBHYT] PreparedStatement : [select count(*) BHYT FROM TM_DUOC A WHERE A.DUOC_ID = '1030' and BHYT = '1']
2020-02-26 15:13:03,613 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM98'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 15:13:13,711 [1] DEBUG - Statement Id: [DAO00030_Get_DuocCanhBaoICD_ByBenhAn_ID] PreparedStatement : [select A.*          from TM_DUOC_CANHBAO_ICD A          inner join TM_DUOC_HOATCHAT B on B.HOATCHAT_ID = A.HOATCHAT_ID          inner join TM_DUOC_THANHPHANHOATCHAT C on C.HOATCHAT_ID = B.HOATCHAT_ID          inner join TM_DUOC D on D.DUOC_ID = C.DUOC_ID          inner join TT_NOITRU_BENHAN BA on (BA.ICD_VAOKHOA = A.ICD_ID or BA.ICD_KHAMBENH = A.ICD_ID or BA.ICD_BENHCHINH = A.ICD_ID or BA.ICDRAVIEN_CHINH = A.ICD_ID          or A.MAICD in (select part from fnSplit(BA.ICD_BENHPHU, ';'))           or A.MAICD in (select part from fnSplit(BA.ICDRAVIEN_PHU, ';'))          or A.MAICD in (select part from fnSplit(BA.ICD_PHU_VAOKHOA, ';'))) and BA.BENHAN_ID = 24642          where C.DUOC_ID = 1030          and A.TAMNGUNG = '0'          and A.BENHVIEN_ID = 'HLU01']
2020-02-26 15:13:13,785 [1] DEBUG - Statement Id: [DAO00013_GetTienSuBenh] PreparedStatement : [select TIENSUBENH, TIENSUDIUNG        from TT_BENHNHAN        where TT_BENHNHAN.BENHNHAN_ID  = '20633']
2020-02-26 15:13:13,808 [1] DEBUG - Statement Id: [DAO00095_GetTTDiUngThuoc] PreparedStatement : [select *              from TT_BENHNHAN_DIUNG_THUOC              where BENHNHAN_ID = '20633'              and BENHVIEN_ID = 'HLU01']
2020-02-26 15:13:13,831 [1] DEBUG - Statement Id: [DAO00096_GetList] PreparedStatement : [select *        from TM_DUOC_THANHPHANHOATCHAT        where BENHVIEN_ID = 'HLU01']
2020-02-26 15:13:13,863 [1] DEBUG - Statement Id: [DAO00013_GetTienSuBenh] PreparedStatement : [select TIENSUBENH, TIENSUDIUNG        from TT_BENHNHAN        where TT_BENHNHAN.BENHNHAN_ID  = '20633']
2020-02-26 15:13:13,886 [1] DEBUG - Statement Id: [DAO00095_GetTTDiUngThuoc] PreparedStatement : [select *              from TT_BENHNHAN_DIUNG_THUOC              where BENHNHAN_ID = '20633'              and BENHVIEN_ID = 'HLU01']
2020-02-26 15:13:13,909 [1] DEBUG - Statement Id: [DAO00016_GetTTDuocCanhBao] PreparedStatement : [select *        from TM_DUOC_CANHBAO         where                 DUOC_ID = '1030'             and               BENHVIEN_ID = 'HLU01'                     order by DUOC_CANHBAO_ID]
2020-02-26 15:13:18,798 [1] DEBUG - Statement Id: [DAO00000_GetCHECK_DOITUONG_BHYT] PreparedStatement : [select count(*) as DOITUONG_BHYT FROM TM_DOITUONG A            WHERE A.DOITUONG_ID = '4' and A.BENHVIEN_ID = 'HLU01' and MADOITUONG like '%BHYT%']
2020-02-26 15:13:19,868 [1] DEBUG - Statement Id: [DAO00000_GetLOAIGIATHUOC_NOI_NGOAI_VIEN] PreparedStatement : [SELECT LOAIGIA_ID              FROM TM_LOAIGIA              WHERE MALOAIGIA = 'GiaThuoc_NoiVien' and BENHVIEN_ID = 'HLU01']
2020-02-26 15:13:19,892 [1] DEBUG - Statement Id: [DAO00000_GetDUOC_DONGIADOANHTHU_NOIVIEN] PreparedStatement : [declare @doanhthuKhongHT numeric(24,2);          declare @doanhthu numeric(24,2);          declare @hotro numeric(24,2);          declare @bhyt char(1);          select top 1 @doanhthuKhongHT = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0 and GIAHOTRO != '1'          order by dtlg.DOUUTIEN asc          select top 1 @doanhthu = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0           order by dtlg.DOUUTIEN asc          select top 1 @hotro = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0  and GIAHOTRO = '1'          order by dtlg.DOUUTIEN asc          select top 1 @bhyt = BHYT from TM_DUOC where DUOC_ID = 1030          select ISNULL(@doanhthu,0.0) DONGIA_DOANHTHU, ISNULL(@hotro, 0.0) DONGIA_KHAC, ISNULL(@doanhthuKhongHT, 0.0) DONGIA_KHONGHT, isnull(@bhyt, '0') BHYT]
2020-02-26 15:13:19,917 [1] DEBUG - Statement Id: [DAO00000_GetDuocBHYT] PreparedStatement : [select count(*) BHYT FROM TM_DUOC A WHERE A.DUOC_ID = '1030' and BHYT = '1']
2020-02-26 15:14:11,114 [1] DEBUG - Statement Id: [DAO00000_GetCHECK_DOITUONG_BHYT] PreparedStatement : [select count(*) as DOITUONG_BHYT FROM TM_DOITUONG A            WHERE A.DOITUONG_ID = '4' and A.BENHVIEN_ID = 'HLU01' and MADOITUONG like '%BHYT%']
2020-02-26 15:14:12,423 [1] DEBUG - Statement Id: [DAO00000_GetLOAIGIATHUOC_NOI_NGOAI_VIEN] PreparedStatement : [SELECT LOAIGIA_ID              FROM TM_LOAIGIA              WHERE MALOAIGIA = 'GiaThuoc_NoiVien' and BENHVIEN_ID = 'HLU01']
2020-02-26 15:14:12,446 [1] DEBUG - Statement Id: [DAO00000_GetDUOC_DONGIADOANHTHU_NOIVIEN] PreparedStatement : [declare @doanhthuKhongHT numeric(24,2);          declare @doanhthu numeric(24,2);          declare @hotro numeric(24,2);          declare @bhyt char(1);          select top 1 @doanhthuKhongHT = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0 and GIAHOTRO != '1'          order by dtlg.DOUUTIEN asc          select top 1 @doanhthu = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0           order by dtlg.DOUUTIEN asc          select top 1 @hotro = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0  and GIAHOTRO = '1'          order by dtlg.DOUUTIEN asc          select top 1 @bhyt = BHYT from TM_DUOC where DUOC_ID = 1030          select ISNULL(@doanhthu,0.0) DONGIA_DOANHTHU, ISNULL(@hotro, 0.0) DONGIA_KHAC, ISNULL(@doanhthuKhongHT, 0.0) DONGIA_KHONGHT, isnull(@bhyt, '0') BHYT]
2020-02-26 15:14:12,473 [1] DEBUG - Statement Id: [DAO00000_GetDuocBHYT] PreparedStatement : [select count(*) BHYT FROM TM_DUOC A WHERE A.DUOC_ID = '1030' and BHYT = '1']
2020-02-26 15:14:18,903 [1] DEBUG - Statement Id: [DAO00062_GetThongTinNhapVienCuaBenhNhan] PreparedStatement : [select top 1 ba.THOIGIANVAOKHOA THOIGIANVAO        from TT_NOITRU_BENHAN ba        where ba.BENHAN_ID =  @param0]
2020-02-26 15:14:18,903 [1] DEBUG - Statement Id: [DAO00062_GetThongTinNhapVienCuaBenhNhan] Parameters: [@param0=[BENHAN_ID,24642]]
2020-02-26 15:14:18,903 [1] DEBUG - Statement Id: [DAO00062_GetThongTinNhapVienCuaBenhNhan] Types: [@param0=[Int64, System.Int64]]
2020-02-26 15:14:18,926 [1] DEBUG - Statement Id: [DAO00014_GetInPatientStatus] PreparedStatement : [select TRANGTHAI, isnull(KHOACHUYENDEN_ID, KHOAVAO_ID) as KHOAHIENTAI from TT_NOITRU_BENHAN        where        TIEPNHAN_ID = '107181'        and BENHVIEN_ID = 'HLU01'         and           BENHAN_ID = '24642']
2020-02-26 15:15:15,238 [1] DEBUG - Statement Id: [DAO00000_GetCHECK_DOITUONG_BHYT] PreparedStatement : [select count(*) as DOITUONG_BHYT FROM TM_DOITUONG A            WHERE A.DOITUONG_ID = '4' and A.BENHVIEN_ID = 'HLU01' and MADOITUONG like '%BHYT%']
2020-02-26 15:15:16,453 [1] DEBUG - Statement Id: [DAO00000_GetLOAIGIATHUOC_NOI_NGOAI_VIEN] PreparedStatement : [SELECT LOAIGIA_ID              FROM TM_LOAIGIA              WHERE MALOAIGIA = 'GiaThuoc_NoiVien' and BENHVIEN_ID = 'HLU01']
2020-02-26 15:15:16,477 [1] DEBUG - Statement Id: [DAO00000_GetDUOC_DONGIADOANHTHU_NOIVIEN] PreparedStatement : [declare @doanhthuKhongHT numeric(24,2);          declare @doanhthu numeric(24,2);          declare @hotro numeric(24,2);          declare @bhyt char(1);          select top 1 @doanhthuKhongHT = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0 and GIAHOTRO != '1'          order by dtlg.DOUUTIEN asc          select top 1 @doanhthu = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0           order by dtlg.DOUUTIEN asc          select top 1 @hotro = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0  and GIAHOTRO = '1'          order by dtlg.DOUUTIEN asc          select top 1 @bhyt = BHYT from TM_DUOC where DUOC_ID = 1030          select ISNULL(@doanhthu,0.0) DONGIA_DOANHTHU, ISNULL(@hotro, 0.0) DONGIA_KHAC, ISNULL(@doanhthuKhongHT, 0.0) DONGIA_KHONGHT, isnull(@bhyt, '0') BHYT]
2020-02-26 15:15:16,502 [1] DEBUG - Statement Id: [DAO00000_GetDuocBHYT] PreparedStatement : [select count(*) BHYT FROM TM_DUOC A WHERE A.DUOC_ID = '1030' and BHYT = '1']
2020-02-26 15:15:44,126 [1] DEBUG - Statement Id: [DAO00000_GetCHECK_DOITUONG_BHYT] PreparedStatement : [select count(*) as DOITUONG_BHYT FROM TM_DOITUONG A            WHERE A.DOITUONG_ID = '4' and A.BENHVIEN_ID = 'HLU01' and MADOITUONG like '%BHYT%']
2020-02-26 15:15:53,086 [1] DEBUG - Statement Id: [DAO00000_GetLOAIGIATHUOC_NOI_NGOAI_VIEN] PreparedStatement : [SELECT LOAIGIA_ID              FROM TM_LOAIGIA              WHERE MALOAIGIA = 'GiaThuoc_NoiVien' and BENHVIEN_ID = 'HLU01']
2020-02-26 15:15:53,109 [1] DEBUG - Statement Id: [DAO00000_GetDUOC_DONGIADOANHTHU_NOIVIEN] PreparedStatement : [declare @doanhthuKhongHT numeric(24,2);          declare @doanhthu numeric(24,2);          declare @hotro numeric(24,2);          declare @bhyt char(1);          select top 1 @doanhthuKhongHT = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0 and GIAHOTRO != '1'          order by dtlg.DOUUTIEN asc          select top 1 @doanhthu = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0           order by dtlg.DOUUTIEN asc          select top 1 @hotro = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0  and GIAHOTRO = '1'          order by dtlg.DOUUTIEN asc          select top 1 @bhyt = BHYT from TM_DUOC where DUOC_ID = 1030          select ISNULL(@doanhthu,0.0) DONGIA_DOANHTHU, ISNULL(@hotro, 0.0) DONGIA_KHAC, ISNULL(@doanhthuKhongHT, 0.0) DONGIA_KHONGHT, isnull(@bhyt, '0') BHYT]
2020-02-26 15:15:56,663 [1] DEBUG - Statement Id: [DAO00000_GetDuocBHYT] PreparedStatement : [select count(*) BHYT FROM TM_DUOC A WHERE A.DUOC_ID = '1030' and BHYT = '1']
2020-02-26 15:15:58,772 [1] DEBUG - Statement Id: [DAO00030_GetKhoDuocByPhamVi] PreparedStatement : [SELECT DISTINCT mp.KHODUOC_ID, lk.DICTIONARY_CODE as LOAIKHO          FROM TM_DUOC_PHAMVISD_MAPPING mp          INNER JOIN TM_KHODUOC kd on kd.KHODUOC_ID = mp.KHODUOC_ID          INNER JOIN LST_DICTIONARY lk on lk.DICTIONARY_ID = kd.LOAIKHO_ID          WHERE          mp.PHAMVI_ID = 1027          AND mp.BENHVIEN_ID ='HLU01'          AND mp.TAMNGUNG = '0']
2020-02-26 15:15:58,941 [1] DEBUG - Statement Id: [DAO00063_KiemtraSoluongDuocXuat] PreparedStatement : [select A.TONKHO, isnull(B.BOOK_NGOAI,0) BOOK_NGOAI, isnull(D.BOOK_NOI,0) BOOK_NOI, isnull(C.BOOK_NOI_THUOC,0) BOOK_NOI_THUOC, (A.TONKHO - isnull(B.BOOK_NGOAI,0) - isnull(D.BOOK_NOI,0)) TONKHO_BOOK        from(        select SUM(tk.SOLUONG) TONKHO, tk.DUOC_ID, sd.PHAMVI_ID, tk.NGUONDUOC_ID from TT_DUOC_TONKHO tk        inner join TM_DUOC_PHAMVISD_MAPPING sd on sd.KHODUOC_ID = tk.KHODUOC_ID        where sd.PHAMVI_ID  = '1027' and tk.DUOC_ID = '1030' and tk.NGUONDUOC_ID = '1'        group by tk.DUOC_ID, sd.PHAMVI_ID, tk.NGUONDUOC_ID) A        left join (        select SUM(SOLUONG) BOOK_NGOAI,DUOC_ID, PHAMVI_ID, NGUONHANG_ID from TT_DUOC_TONKHO_BOOK_NGOAITRU        where PHAMVI_ID  = '1027' and DUOC_ID = '1030' and NGUONHANG_ID = '1' and TRANGTHAI = 'HIEULUC'  and SOLUONG > 0        group by DUOC_ID, PHAMVI_ID, NGUONHANG_ID) B on A.DUOC_ID = B.DUOC_ID and A.PHAMVI_ID = B.PHAMVI_ID and A.NGUONDUOC_ID = B.NGUONHANG_ID        left join (        select SUM(SOLUONG) BOOK_NOI_THUOC,DUOC_ID, PHAMVI_ID, NGUONHANG_ID from TT_DUOC_TONKHO_BOOK_NOITRU        where PHAMVI_ID  = '1027' and DUOC_ID = '1030' and NGUONHANG_ID = '1' and REF_ID = '' and REF_TABLE = 'TT_NOITRU_TOATHUOC' and TRANGTHAI = 'HIEULUC' and SOLUONG > 0        group by DUOC_ID, PHAMVI_ID, NGUONHANG_ID) C on A.DUOC_ID = C.DUOC_ID and A.PHAMVI_ID = C.PHAMVI_ID and A.NGUONDUOC_ID = C.NGUONHANG_ID        left join (        select SUM(SOLUONG) BOOK_NOI,DUOC_ID, PHAMVI_ID, NGUONHANG_ID from TT_DUOC_TONKHO_BOOK_NOITRU        where PHAMVI_ID  = '1027' and DUOC_ID = '1030' and NGUONHANG_ID = '1' and TRANGTHAI = 'HIEULUC'  and SOLUONG > 0        group by DUOC_ID, PHAMVI_ID, NGUONHANG_ID) D on A.DUOC_ID = D.DUOC_ID and A.PHAMVI_ID = D.PHAMVI_ID and A.NGUONDUOC_ID = D.NGUONHANG_ID]
2020-02-26 15:15:58,965 [1] DEBUG - Statement Id: [DAO00063_KiemtraSoluongDuocXuat] PreparedStatement : [select A.TONKHO, isnull(B.BOOK_NGOAI,0) BOOK_NGOAI, isnull(D.BOOK_NOI,0) BOOK_NOI, isnull(C.BOOK_NOI_THUOC,0) BOOK_NOI_THUOC, (A.TONKHO - isnull(B.BOOK_NGOAI,0) - isnull(D.BOOK_NOI,0)) TONKHO_BOOK        from(        select SUM(tk.SOLUONG) TONKHO, tk.DUOC_ID, sd.PHAMVI_ID, tk.NGUONDUOC_ID from TT_DUOC_TONKHO tk        inner join TM_DUOC_PHAMVISD_MAPPING sd on sd.KHODUOC_ID = tk.KHODUOC_ID        where sd.PHAMVI_ID  = '1027' and tk.DUOC_ID = '1030' and tk.NGUONDUOC_ID = '1'        group by tk.DUOC_ID, sd.PHAMVI_ID, tk.NGUONDUOC_ID) A        left join (        select SUM(SOLUONG) BOOK_NGOAI,DUOC_ID, PHAMVI_ID, NGUONHANG_ID from TT_DUOC_TONKHO_BOOK_NGOAITRU        where PHAMVI_ID  = '1027' and DUOC_ID = '1030' and NGUONHANG_ID = '1' and TRANGTHAI = 'HIEULUC'  and SOLUONG > 0        group by DUOC_ID, PHAMVI_ID, NGUONHANG_ID) B on A.DUOC_ID = B.DUOC_ID and A.PHAMVI_ID = B.PHAMVI_ID and A.NGUONDUOC_ID = B.NGUONHANG_ID        left join (        select SUM(SOLUONG) BOOK_NOI_THUOC,DUOC_ID, PHAMVI_ID, NGUONHANG_ID from TT_DUOC_TONKHO_BOOK_NOITRU        where PHAMVI_ID  = '1027' and DUOC_ID = '1030' and NGUONHANG_ID = '1' and REF_ID = '' and REF_TABLE = 'TT_NOITRU_TOATHUOC' and TRANGTHAI = 'HIEULUC' and SOLUONG > 0        group by DUOC_ID, PHAMVI_ID, NGUONHANG_ID) C on A.DUOC_ID = C.DUOC_ID and A.PHAMVI_ID = C.PHAMVI_ID and A.NGUONDUOC_ID = C.NGUONHANG_ID        left join (        select SUM(SOLUONG) BOOK_NOI,DUOC_ID, PHAMVI_ID, NGUONHANG_ID from TT_DUOC_TONKHO_BOOK_NOITRU        where PHAMVI_ID  = '1027' and DUOC_ID = '1030' and NGUONHANG_ID = '1' and TRANGTHAI = 'HIEULUC'  and SOLUONG > 0        group by DUOC_ID, PHAMVI_ID, NGUONHANG_ID) D on A.DUOC_ID = D.DUOC_ID and A.PHAMVI_ID = D.PHAMVI_ID and A.NGUONDUOC_ID = D.NGUONHANG_ID]
2020-02-26 15:15:58,993 [1] DEBUG - Statement Id: [DAOLOG01_LockBegin] PreparedStatement : [INSERT into TT_LOG_UPDATE ( REF_TABLE , REF_ID , BENHVIEN_ID )         values ( @param0 ,  @param1 ,  @param2 );]
2020-02-26 15:15:58,993 [1] DEBUG - Statement Id: [DAOLOG01_LockBegin] Parameters: [@param0=[REF_TABLE,TT_NOITRU_KHAMBENH], @param1=[REF_ID,24642], @param2=[BENHVIEN_ID,HLU01]]
2020-02-26 15:15:58,993 [1] DEBUG - Statement Id: [DAOLOG01_LockBegin] Types: [@param0=[String, System.String], @param1=[Int64, System.Int64], @param2=[String, System.String]]
2020-02-26 15:15:59,081 [1] DEBUG - Statement Id: [DAO00026_GEN_EXAM_KEY] PreparedStatement : [select max(KEYVALUE) KEYVALUE              from LST_KEYDATA_TOATHUOC               where                             LST_KEYDATA_TOATHUOC.KEYTYPE = 'SOTHUTUTOA_NOITRU'                       and                           LST_KEYDATA_TOATHUOC.KEYYEAR = '2020'                       and                           LST_KEYDATA_TOATHUOC.KEYMONTH = '2'                       and                           LST_KEYDATA_TOATHUOC.KEYDAY = '26']
2020-02-26 15:15:59,169 [1] DEBUG - Statement Id: [DAO00026_Add] PreparedStatement : [IF EXISTS (select KEYTYPE from LST_KEYDATA_TOATHUOC where KEYTYPE = 'SOTHUTUTOA_NOITRU' AND KEYYEAR = '2020' AND KEYMONTH = '2' AND KEYDAY = '26')            BEGIN            update LST_KEYDATA_TOATHUOC set            KEYVALUE =  @param0             where            KEYTYPE = 'SOTHUTUTOA_NOITRU'            AND KEYYEAR = '2020'            AND KEYMONTH = '2'            AND KEYDAY = '26'            AND SEGMENT_1 = '0'            AND SEGMENT_2 = '0'            AND SEGMENT_3 = '0'            END            ELSE            BEGIN            insert into LST_KEYDATA_TOATHUOC (            KEYTYPE            , KEYYEAR            , KEYMONTH            , KEYDAY            , SEGMENT_1            , SEGMENT_2            , SEGMENT_3            , KEYVALUE            , BENHVIEN_ID            ) values (             @param1             ,  @param2             ,  @param3             ,  @param4             ,  @param5             ,  @param6             ,  @param7             ,  @param0             ,  @param8             )            END]
2020-02-26 15:15:59,169 [1] DEBUG - Statement Id: [DAO00026_Add] Parameters: [@param0=[KEYVALUE,0001], @param1=[KEYTYPE,SOTHUTUTOA_NOITRU], @param2=[KEYYEAR,2020], @param3=[KEYMONTH,2], @param4=[KEYDAY,26], @param5=[SEGMENT_1,0], @param6=[SEGMENT_2,0], @param7=[SEGMENT_3,0], @param8=[BENHVIEN_ID,HLU01]]
2020-02-26 15:15:59,169 [1] DEBUG - Statement Id: [DAO00026_Add] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[Int32, System.Int32], @param3=[Int32, System.Int32], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[String, System.String], @param7=[String, System.String], @param8=[String, System.String]]
2020-02-26 15:15:59,224 [1] DEBUG - Statement Id: [DAO00062_Add] PreparedStatement : [insert into TT_NOITRU_KHAMBENH (        BENHAN_ID        , LUUTRU_ID        , LANKHAM        , NGAYKHAM        , THOIGIANKHAM        , BACSIKHAM_ID        , PHONGBAN_ID        , DIEUDUONG_ID        , CAPHOLY_ID        , DOITUONG_ID        , PHATDO_DIEUTRI_ID        , DINHBENH        , DIENBIEN        , LOIDAN        , CHEDOANUONG_ID        , CHEDOCHAMSOC_ID        , PHANCAPCHAMSOC_ID        , CHUNGTUPHATTHUOC_ID        , KHODUOC_ID        , NOINHANTHUOC_ID        , LOAITOATHUOC        , THUOCDACTRI        , NGAYTAIKHAM        , SONGAYHENTAIKHAM        , RAVIEN        , ISTHUOCBV              , ISYLENHVTYT        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYCAPNHAT        , NGUOICAPNHAT_ID         ,           GHICHU_KHAMBENH         ,           GHICHU         ,           CHEDODINHDUONG         ,           MATOAMAU                 ) values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31          ,            @param32          ,            @param33          ,           @param34          ,            @param35                  )]
2020-02-26 15:15:59,225 [1] DEBUG - Statement Id: [DAO00062_Add] Parameters: [@param0=[BENHAN_ID,24642], @param1=[LUUTRU_ID,39529], @param2=[LANKHAM,1], @param3=[NGAYKHAM,2/26/2020 12:00:00 AM], @param4=[THOIGIANKHAM,2/26/2020 2:59:05 PM], @param5=[BACSIKHAM_ID,1], @param6=[PHONGBAN_ID,25], @param7=[DIEUDUONG_ID,null], @param8=[CAPHOLY_ID,null], @param9=[DOITUONG_ID,4], @param10=[PHATDO_DIEUTRI_ID,null], @param11=[DINHBENH,Theo dõi thai bình thường(Z34)], @param12=[DIENBIEN, sdfsd], @param13=[LOIDAN,null], @param14=[CHEDOANUONG_ID,null], @param15=[CHEDOCHAMSOC_ID,null], @param16=[PHANCAPCHAMSOC_ID,8588], @param17=[CHUNGTUPHATTHUOC_ID,null], @param18=[KHODUOC_ID,29], @param19=[NOINHANTHUOC_ID,null], @param20=[LOAITOATHUOC,YL], @param21=[THUOCDACTRI,0], @param22=[NGAYTAIKHAM,null], @param23=[SONGAYHENTAIKHAM,null], @param24=[RAVIEN,0], @param25=[ISTHUOCBV,1], @param26=[ISYLENHVTYT,0], @param27=[BENHVIEN_ID,HLU01], @param28=[NGAYTAO,2/26/2020 3:15:59 PM], @param29=[NGUOITAO_ID,1], @param30=[NGAYCAPNHAT,2/26/2020 3:15:59 PM], @param31=[NGUOICAPNHAT_ID,1], @param32=[GHICHU_KHAMBENH,null], @param33=[GHICHU_DICHVU,null], @param34=[CHEDODINHDUONG,null], @param35=[MATOAMAU,null]]
2020-02-26 15:15:59,225 [1] DEBUG - Statement Id: [DAO00062_Add] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64], @param2=[Int64, System.Int64], @param3=[DateTime, System.DateTime], @param4=[DateTime, System.DateTime], @param5=[Int64, System.Int64], @param6=[String, System.String], @param7=[System.DBNull, null], @param8=[System.DBNull, null], @param9=[Int64, System.Int64], @param10=[System.DBNull, null], @param11=[String, System.String], @param12=[String, System.String], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[Int64, System.Int64], @param19=[System.DBNull, null], @param20=[String, System.String], @param21=[String, System.String], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[String, System.String], @param28=[DateTime, System.DateTime], @param29=[Int64, System.Int64], @param30=[DateTime, System.DateTime], @param31=[Int64, System.Int64], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null]]
2020-02-26 15:15:59,447 [1] DEBUG - Statement Id: [DAO00062_Add.SelectKey] PreparedStatement : [SELECT @@IDENTITY as value]
2020-02-26 15:15:59,480 [1] DEBUG - Statement Id: [DAO00062_GetKhoThuocCosoKhongCoso] PreparedStatement : [select distinct kd.KHODUOC_ID, lst.DICTIONARY_CODE  LOAIKHO from TM_KHODUOC kd        left join TM_PHONGBAN_KHODUOC pbkd        on kd.KHODUOC_ID = pbkd.KHODUOC_ID        and kd.BENHVIEN_ID = pbkd.BENHVIEN_ID        left join LST_DICTIONARY lst on lst.DICTIONARY_ID = kd.LOAIKHO_ID        where lst.DICTIONARY_CODE = 'Coso']
2020-02-26 15:15:59,509 [1] DEBUG - Statement Id: [DAO00062_GetAllPhamviKhoDuoc] PreparedStatement : [select distinct dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        left join TM_DUOC_PHAMVISUDUNG dpv on dpv.PHAMVI_ID = dmap.PHAMVI_ID]
2020-02-26 15:15:59,532 [1] DEBUG - Statement Id: [DAO00023_GetSOBHYT_HUONG_ID] PreparedStatement : [select isnull(MAX(SOBHYT_HUONG_ID),0) SOBHYT_HUONG_ID        from TT_TIEPNHAN_SOTHEBHYT        where TIEPNHAN_ID = '107181']
2020-02-26 15:16:33,608 [1] DEBUG - Statement Id: [DAO00000_GetCHECK_DOITUONG_BHYT] PreparedStatement : [select count(*) as DOITUONG_BHYT FROM TM_DOITUONG A            WHERE A.DOITUONG_ID = '4' and A.BENHVIEN_ID = 'HLU01' and MADOITUONG like '%BHYT%']
2020-02-26 15:16:35,075 [1] DEBUG - Statement Id: [DAO00000_GetLOAIGIATHUOC_NOI_NGOAI_VIEN] PreparedStatement : [SELECT LOAIGIA_ID              FROM TM_LOAIGIA              WHERE MALOAIGIA = 'GiaThuoc_NoiVien' and BENHVIEN_ID = 'HLU01']
2020-02-26 15:16:35,102 [1] DEBUG - Statement Id: [DAO00000_GetDUOC_DONGIADOANHTHU_NOIVIEN] PreparedStatement : [declare @doanhthuKhongHT numeric(24,2);          declare @doanhthu numeric(24,2);          declare @hotro numeric(24,2);          declare @bhyt char(1);          select top 1 @doanhthuKhongHT = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0 and GIAHOTRO != '1'          order by dtlg.DOUUTIEN asc          select top 1 @doanhthu = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0           order by dtlg.DOUUTIEN asc          select top 1 @hotro = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0  and GIAHOTRO = '1'          order by dtlg.DOUUTIEN asc          select top 1 @bhyt = BHYT from TM_DUOC where DUOC_ID = 1030          select ISNULL(@doanhthu,0.0) DONGIA_DOANHTHU, ISNULL(@hotro, 0.0) DONGIA_KHAC, ISNULL(@doanhthuKhongHT, 0.0) DONGIA_KHONGHT, isnull(@bhyt, '0') BHYT]
2020-02-26 15:16:41,100 [1] DEBUG - Statement Id: [DAO00000_GetDuocBHYT] PreparedStatement : [select count(*) BHYT FROM TM_DUOC A WHERE A.DUOC_ID = '1030' and BHYT = '1']
2020-02-26 15:16:59,282 [1] DEBUG - Statement Id: [DAO00000_GetCHECK_DOITUONG_BHYT] PreparedStatement : [select count(*) as DOITUONG_BHYT FROM TM_DOITUONG A            WHERE A.DOITUONG_ID = '4' and A.BENHVIEN_ID = 'HLU01' and MADOITUONG like '%BHYT%']
2020-02-26 15:17:00,788 [1] DEBUG - Statement Id: [DAO00000_GetLOAIGIATHUOC_NOI_NGOAI_VIEN] PreparedStatement : [SELECT LOAIGIA_ID              FROM TM_LOAIGIA              WHERE MALOAIGIA = 'GiaThuoc_NoiVien' and BENHVIEN_ID = 'HLU01']
2020-02-26 15:17:00,812 [1] DEBUG - Statement Id: [DAO00000_GetDUOC_DONGIADOANHTHU_NOIVIEN] PreparedStatement : [declare @doanhthuKhongHT numeric(24,2);          declare @doanhthu numeric(24,2);          declare @hotro numeric(24,2);          declare @bhyt char(1);          select top 1 @doanhthuKhongHT = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0 and GIAHOTRO != '1'          order by dtlg.DOUUTIEN asc          select top 1 @doanhthu = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0           order by dtlg.DOUUTIEN asc          select top 1 @hotro = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0  and GIAHOTRO = '1'          order by dtlg.DOUUTIEN asc          select top 1 @bhyt = BHYT from TM_DUOC where DUOC_ID = 1030          select ISNULL(@doanhthu,0.0) DONGIA_DOANHTHU, ISNULL(@hotro, 0.0) DONGIA_KHAC, ISNULL(@doanhthuKhongHT, 0.0) DONGIA_KHONGHT, isnull(@bhyt, '0') BHYT]
2020-02-26 15:17:15,557 [1] DEBUG - Statement Id: [DAO00000_GetDuocBHYT] PreparedStatement : [select count(*) BHYT FROM TM_DUOC A WHERE A.DUOC_ID = '1030' and BHYT = '1']
2020-02-26 15:17:39,468 [1] DEBUG - Statement Id: [DAO00063_Add_YLenhThuoc] PreparedStatement : [declare @jsonVienPhi nvarchar(max);        set @jsonVienPhi = N'{        "DATA": [{"TRATHUOCCHITIET_ID":null,"DALAPPHIEULINH":false,"DAPHATSINHCHUNGTU":false,"DANHAPNOIBO":false,"DAXUATNOIBO":false,"UID":"ba1c1ec1-18a5-426e-bb67-421b111304d8","TOATHUOC_ID":null,"CLSKETQUA_ID":null,"VTYT_ID":null,"SOTHUTUTOA":"2002260001","MACHUNGTU":null,"KHAMBENH_ID":320498,"TIEPNHAN_ID":107181,"BENHNHAN_ID":20633,"DUOC_ID":1030,"SOLUONG":1.0,"SONGAY":1.0,"SOLANTRENNGAY":null,"SOLUONGTRENLAN":null,"SOLUONG_BUOISANG":null,"SOLUONG_BUOITRUA":null,"SOLUONG_BUOICHIEU":null,"SOLUONG_BUOITOI":null,"DUONGDUNG_ID":911,"GHICHU":"","NGUONDUOC_ID":1,"KHOSUDUNG_ID":null,"NGUONDUOC":null,"NGUONHANG_ID":1,"PHIEULINH_ID":null,"CHUNGTU_ID":null,"CHUNGTUTONGHOP_ID":null,"PHONGBANRATOA_ID":"25","PHONGBAN_ID":null,"NGUONLAYTHUOC":"D","COSO":"0","KHOPHAT_ID":1,"PHAMVI_ID":1027,"PHATTHUOCTAIQUAY":"0","ISUPDATED":false,"THOIGIANSUDUNG":null,"NGAYSUDUNG":null,"THOIGIANKHAM":null,"SOLUONGTAMNGUNG":0.0,"MUANGOAI":"0","YEUCAU":null,"PHOIHOP":null,"PHACHE":null,"ISVTYT":false,"ISHOACHAT":false,"TINHTIEN":"0","MIENPHI":"0","TRANGTHAI":"CHUAXUAT","HUYTOATHUOC":"0","BENHVIEN_ID":"HLU01","NGAYTAO":null,"NGUOITAO_ID":1,"NGAYCAPNHAT":null,"NGUOICAPNHAT_ID":1,"BHYTDONGTIEN":"0","KHONGTHUTIEN":"0","SOCHUNGTU":null,"SOPHIEULINH":null,"MATOATHUOC":null,"LOAITOATHUOC":null,"LOAIVATTU_ID":"T","TENTOATHUOC":null,"DIENGIAI":null,"TAMNGUNG":false,"DUOC_BHYT":true,"VIENPHI":{"VIENPHI_ID":0,"TIEPNHAN_ID":107181,"BENHNHAN_ID":null,"BENHAN_ID":24642,"KHAMBENH_ID":null,"REF_ID":null,"REF_TABLE":"TT_NOITRU_TOATHUOC","DICHVU_ID":null,"DUOC_ID":1030,"LOAI_CHIPHI":"TT","LOAIGIA_ID":null,"SOLUONG":0.0,"DONGIA_DOANHTHU":600.00,"THANHTIEN_DOANHTHU":600.00,"BHYT_TL":null,"BHYT_DONGIA":600.00,"BHYT_THANHTIEN":600.00,"BHYT_DONGIA_CHITRA":600.00,"BHYT_THANHTIEN_CHITRA":600.00,"BENHNHAN_PHAITHANHTOAN":0.00,"GIATRI_HOADON":null,"GIATRI_HOADON_DATHANHTOAN":null,"GIATRI_BIENLAI":null,"GIATRI_BIENLAI_DATHANHTOAN":null,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"GIATRI_THATTHU":null,"MIENGIAM_TL":null,"MIENGIAM_GIATRI":null,"NGANSACH_TL":null,"NGANSACH_GIATRI":null,"TAITRO_TL":null,"TAITRO_GIATRI":null,"BHTN_TL":null,"BHTN_DONGIA":null,"BHTN_THANHTIEN":null,"BHTN_DONGIA_CHITRA":null,"BHTN_THANHTIEN_CHITRA":null,"DUOCPHEPTHUCHIEN":null,"HUY":false,"DATHANHTOAN":false,"DATHUCHIEN":false,"KHONGTHUTIEN":false,"BHYTDONGTIEN":false,"HOADON_ID":null,"ACTIVE":null,"BENHVIEN_ID":"HLU01","NGUOITAO_ID":null,"NGAYTAO":null,"NGUOICAPNHAT_ID":null,"NGAYCAPNHAT":null,"TREN3NAM":false,"TREN5NAM":false},"STT":1,"KHOTAO_ID":"29","DONVITINH":null,"DUONGDUNG":"Tiêm","DAXUAT":false,"DATHANHTOAN":false,"BENHAN_ID":24642,"DAHOANTRA":0,"SLDAXUAT":0.0,"SLDATAMNGUNG":0.0,"CHUNGTUTRA_ID":null,"CHUNGTUCHITIET_ID":null,"NGUOICAPNHAT":null,"BHYT_DONGIA":null,"BHYT_THANHTIEN":null,"BHYT_DONGIA_CHITRA":null,"BHYT_THANHTIEN_CHITRA":null,"DONGIA_DOANHTHU":600.0,"THANHTIEN_DOANHTHU":600.0,"BookedSoLuong":0.0,"KHODUOC_ID":1,"CHUYENKHOA_ID":"25","DOTDIEUTRI_ID":null,"DOITUONG_HUONG_ID":4,"SOBHYT_HUONG_ID":111518},{"TRATHUOCCHITIET_ID":null,"DALAPPHIEULINH":false,"DAPHATSINHCHUNGTU":false,"DANHAPNOIBO":false,"DAXUATNOIBO":false,"UID":"432965e9-91da-4cbe-be45-191750bde0c7","TOATHUOC_ID":null,"CLSKETQUA_ID":null,"VTYT_ID":null,"SOTHUTUTOA":"2002260001","MACHUNGTU":null,"KHAMBENH_ID":320498,"TIEPNHAN_ID":107181,"BENHNHAN_ID":20633,"DUOC_ID":1030,"SOLUONG":1.0,"SONGAY":1.0,"SOLANTRENNGAY":null,"SOLUONGTRENLAN":null,"SOLUONG_BUOISANG":null,"SOLUONG_BUOITRUA":null,"SOLUONG_BUOICHIEU":null,"SOLUONG_BUOITOI":null,"DUONGDUNG_ID":911,"GHICHU":"","NGUONDUOC_ID":1,"KHOSUDUNG_ID":null,"NGUONDUOC":null,"NGUONHANG_ID":1,"PHIEULINH_ID":null,"CHUNGTU_ID":null,"CHUNGTUTONGHOP_ID":null,"PHONGBANRATOA_ID":"25","PHONGBAN_ID":null,"NGUONLAYTHUOC":"D","COSO":"0","KHOPHAT_ID":1,"PHAMVI_ID":1027,"PHATTHUOCTAIQUAY":"0","ISUPDATED":false,"THOIGIANSUDUNG":null,"NGAYSUDUNG":null,"THOIGIANKHAM":null,"SOLUONGTAMNGUNG":0.0,"MUANGOAI":"0","YEUCAU":null,"PHOIHOP":null,"PHACHE":null,"ISVTYT":false,"ISHOACHAT":false,"TINHTIEN":"0","MIENPHI":"0","TRANGTHAI":"CHUAXUAT","HUYTOATHUOC":"0","BENHVIEN_ID":"HLU01","NGAYTAO":null,"NGUOITAO_ID":1,"NGAYCAPNHAT":null,"NGUOICAPNHAT_ID":1,"BHYTDONGTIEN":"1","KHONGTHUTIEN":"0","SOCHUNGTU":null,"SOPHIEULINH":null,"MATOATHUOC":null,"LOAITOATHUOC":null,"LOAIVATTU_ID":"T","TENTOATHUOC":null,"DIENGIAI":null,"TAMNGUNG":false,"DUOC_BHYT":true,"VIENPHI":{"VIENPHI_ID":0,"TIEPNHAN_ID":107181,"BENHNHAN_ID":null,"BENHAN_ID":24642,"KHAMBENH_ID":null,"REF_ID":null,"REF_TABLE":"TT_NOITRU_TOATHUOC","DICHVU_ID":null,"DUOC_ID":1030,"LOAI_CHIPHI":"TT","LOAIGIA_ID":null,"SOLUONG":0.0,"DONGIA_DOANHTHU":1000.00,"THANHTIEN_DOANHTHU":1000.00,"BHYT_TL":null,"BHYT_DONGIA":0,"BHYT_THANHTIEN":0,"BHYT_DONGIA_CHITRA":0,"BHYT_THANHTIEN_CHITRA":0,"BENHNHAN_PHAITHANHTOAN":1000.00,"GIATRI_HOADON":null,"GIATRI_HOADON_DATHANHTOAN":null,"GIATRI_BIENLAI":null,"GIATRI_BIENLAI_DATHANHTOAN":null,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"GIATRI_THATTHU":null,"MIENGIAM_TL":null,"MIENGIAM_GIATRI":null,"NGANSACH_TL":null,"NGANSACH_GIATRI":null,"TAITRO_TL":null,"TAITRO_GIATRI":null,"BHTN_TL":null,"BHTN_DONGIA":null,"BHTN_THANHTIEN":null,"BHTN_DONGIA_CHITRA":null,"BHTN_THANHTIEN_CHITRA":null,"DUOCPHEPTHUCHIEN":null,"HUY":false,"DATHANHTOAN":false,"DATHUCHIEN":false,"KHONGTHUTIEN":false,"BHYTDONGTIEN":true,"HOADON_ID":null,"ACTIVE":null,"BENHVIEN_ID":"HLU01","NGUOITAO_ID":null,"NGAYTAO":null,"NGUOICAPNHAT_ID":null,"NGAYCAPNHAT":null,"TREN3NAM":false,"TREN5NAM":false},"STT":2,"KHOTAO_ID":"29","DONVITINH":null,"DUONGDUNG":"Tiêm","DAXUAT":false,"DATHANHTOAN":false,"BENHAN_ID":24642,"DAHOANTRA":0,"SLDAXUAT":0.0,"SLDATAMNGUNG":0.0,"CHUNGTUTRA_ID":null,"CHUNGTUCHITIET_ID":null,"NGUOICAPNHAT":null,"BHYT_DONGIA":null,"BHYT_THANHTIEN":null,"BHYT_DONGIA_CHITRA":null,"BHYT_THANHTIEN_CHITRA":null,"DONGIA_DOANHTHU":600.0,"THANHTIEN_DOANHTHU":600.0,"BookedSoLuong":0.0,"KHODUOC_ID":1,"CHUYENKHOA_ID":"25","DOTDIEUTRI_ID":null,"DOITUONG_HUONG_ID":4,"SOBHYT_HUONG_ID":111518}]        }';          declare @TOATHUOC_ID int;        declare @SOTHUTUTOA varchar(10);        declare @KHAMBENH_ID int;        declare @TIEPNHAN_ID int;        declare @BENHNHAN_ID int;        declare @NGUONDUOC_ID int;        declare @DUOC_ID int;        declare @SOLUONG numeric(18, 4);        declare @SONGAY numeric(4, 2);        declare @SOLANTRENNGAY numeric(4, 2);        declare @SOLUONGTRENLAN numeric(18, 4);        declare @SOLUONG_BUOISANG numeric(18, 4);        declare @SOLUONG_BUOITRUA numeric(18, 4);        declare @SOLUONG_BUOICHIEU numeric(18, 4);        declare @SOLUONG_BUOITOI numeric(18, 4);        declare @DUONGDUNG_ID int;        declare @COSO char(1);        declare @KHOTAO_ID int;        declare @KHOPHAT_ID int;        declare @GHICHU nvarchar(max);        declare @PHIEULINH_ID int;        declare @CHUNGTU_ID int;        declare @PHONGBANRATOA_ID int;        declare @NGUONLAYTHUOC char(1);        declare @VTYT char(1);        declare @PHATTHUOCTAIQUAY char(1);        declare @MUANGOAI char(1);        declare @TINHTIEN char(1);        declare @MIENPHI char(1);        declare @BHYTDONGTIEN char(1);        declare @KHONGTHUTIEN char(1);        declare @HUYTOATHUOC char(1);        declare @TRANGTHAI varchar(20);        declare @BENHVIEN_ID varchar(10);        declare @NGAYTAO datetime;        declare @NGUOITAO_ID int;        declare @NGAYCAPNHAT datetime;        declare @NGUOICAPNHAT_ID int;        declare @PHAMVI_ID int;        declare @CHEDODINHDUONG nvarchar(max);          declare @VIENPHI nvarchar(max);        declare @BENHAN_ID int =  @param0 ;        declare @DOTDIEUTRI_ID int;        declare @DONGIA_DOANHTHU numeric(25, 4);        declare @THANHTIEN_DOANHTHU numeric(25, 4);        declare @BHYT_DONGIA numeric(25, 4);        declare @BHYT_THANHTIEN numeric(25, 4);        declare @BHYT_DONGIA_CHITRA numeric(25, 4);        declare @BHYT_THANHTIEN_CHITRA numeric(25, 4);        declare @BENHNHAN_PHAITHANHTOAN numeric(25, 4);        declare @DOITUONG_HUONG_ID numeric(25, 4);        declare @SOBHYT_HUONG_ID numeric(25, 4);          declare @iTotal int =  @param1 ;        declare @icnt int = 0;        WHILE @iTotal > @icnt        BEGIN        declare @dyn_sql nvarchar(1000) = 'select @data = json_query(@json_dyn, ''' + CHAR(36) +'.DATA[' + cast(@icnt as varchar(10)) + ']'');'        declare @jsondatamax nvarchar(max);          exec sp_executesql @dyn_sql        , N'@json_dyn nvarchar(max), @data nvarchar(max) OUTPUT'        , @json_dyn = @jsonVienPhi        , @data = @jsondatamax OUTPUT          select        @SOTHUTUTOA =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.SOTHUTUTOA'),        @KHAMBENH_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.KHAMBENH_ID'),        @TIEPNHAN_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.TIEPNHAN_ID'),        @BENHNHAN_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.BENHNHAN_ID'),        @NGUONDUOC_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.NGUONDUOC_ID'),        @DUOC_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.DUOC_ID'),        @SOLUONG =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.SOLUONG'),        @SONGAY =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.SONGAY'),        @SOLANTRENNGAY =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.SOLANTRENNGAY'),        @SOLUONGTRENLAN =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.SOLUONGTRENLAN'),        @SOLUONG_BUOISANG =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.SOLUONG_BUOISANG'),        @SOLUONG_BUOITRUA =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.SOLUONG_BUOITRUA'),        @SOLUONG_BUOICHIEU =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.SOLUONG_BUOICHIEU'),        @SOLUONG_BUOITOI =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.SOLUONG_BUOITOI'),        @DUONGDUNG_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.DUONGDUNG_ID'),        @COSO =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.COSO'),        @KHOTAO_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.KHOTAO_ID'),        @KHOPHAT_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.KHOPHAT_ID'),        @GHICHU =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.GHICHU'),        @PHIEULINH_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.PHIEULINH_ID'),        @CHUNGTU_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.CHUNGTU_ID'),        @PHONGBANRATOA_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.PHONGBANRATOA_ID'),        @NGUONLAYTHUOC =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.NGUONLAYTHUOC'),        @VTYT =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.VTYT'),        @PHATTHUOCTAIQUAY =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.PHATTHUOCTAIQUAY'),        @MUANGOAI =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.MUANGOAI'),        @TINHTIEN =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.TINHTIEN'),        @MIENPHI =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.MIENPHI'),        @BHYTDONGTIEN =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.BHYTDONGTIEN'),        @KHONGTHUTIEN =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.KHONGTHUTIEN'),        @HUYTOATHUOC =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.HUYTOATHUOC'),        @TRANGTHAI =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.TRANGTHAI'),        @BENHVIEN_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.BENHVIEN_ID'),        @NGAYTAO =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.NGAYTAO'),        @NGUOITAO_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.NGUOITAO_ID'),        @NGAYCAPNHAT =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.NGAYCAPNHAT'),        @NGUOICAPNHAT_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.NGUOICAPNHAT_ID'),        @PHAMVI_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.PHAMVI_ID'),        @CHEDODINHDUONG =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.CHEDODINHDUONG'),        @DOTDIEUTRI_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.DOTDIEUTRI_ID'),        @DOITUONG_HUONG_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.DOITUONG_HUONG_ID'),        @SOBHYT_HUONG_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.SOBHYT_HUONG_ID'),                  @DONGIA_DOANHTHU =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.VIENPHI.DONGIA_DOANHTHU'),        @THANHTIEN_DOANHTHU =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.VIENPHI.THANHTIEN_DOANHTHU'),        @BHYT_DONGIA =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.VIENPHI.BHYT_DONGIA'),        @BHYT_THANHTIEN =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.VIENPHI.BHYT_THANHTIEN'),        @BHYT_DONGIA_CHITRA =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.VIENPHI.BHYT_DONGIA_CHITRA'),        @BHYT_THANHTIEN_CHITRA =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.VIENPHI.BHYT_THANHTIEN_CHITRA'),        @BENHNHAN_PHAITHANHTOAN =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.VIENPHI.BENHNHAN_PHAITHANHTOAN')          insert into TT_NOITRU_TOATHUOC        ([SOTHUTUTOA],[KHAMBENH_ID],[TIEPNHAN_ID],[BENHNHAN_ID],[NGUONDUOC_ID]        ,[DUOC_ID],[SOLUONG],[SONGAY],[SOLANTRENNGAY],[SOLUONGTRENLAN],[SOLUONG_BUOISANG],[SOLUONG_BUOITRUA],[SOLUONG_BUOICHIEU]        ,[SOLUONG_BUOITOI],[DUONGDUNG_ID],[COSO],[KHOTAO_ID],[KHOPHAT_ID],[GHICHU],[PHIEULINH_ID],[CHUNGTU_ID],[PHONGBANRATOA_ID]        ,[NGUONLAYTHUOC],[VTYT],[PHATTHUOCTAIQUAY],[MUANGOAI],[TINHTIEN],[MIENPHI],[BHYTDONGTIEN],[KHONGTHUTIEN],[HUYTOATHUOC]        ,[TRANGTHAI],[BENHVIEN_ID],[NGAYTAO],[NGUOITAO_ID],[NGAYCAPNHAT],[NGUOICAPNHAT_ID],[PHAMVI_ID],[CHEDODINHDUONG])        VALUES        (@SOTHUTUTOA,@KHAMBENH_ID,@TIEPNHAN_ID,@BENHNHAN_ID,@NGUONDUOC_ID        ,@DUOC_ID,@SOLUONG,@SONGAY,@SOLANTRENNGAY,@SOLUONGTRENLAN,@SOLUONG_BUOISANG,@SOLUONG_BUOITRUA,@SOLUONG_BUOICHIEU        ,@SOLUONG_BUOITOI,@DUONGDUNG_ID,@COSO,@KHOTAO_ID,@KHOPHAT_ID,@GHICHU,@PHIEULINH_ID,@CHUNGTU_ID,@PHONGBANRATOA_ID        ,@NGUONLAYTHUOC,@VTYT,@PHATTHUOCTAIQUAY,@MUANGOAI,@TINHTIEN,@MIENPHI,@BHYTDONGTIEN,@KHONGTHUTIEN,@HUYTOATHUOC        ,@TRANGTHAI,@BENHVIEN_ID,GETDATE(),@NGUOITAO_ID,GETDATE(),@NGUOICAPNHAT_ID,@PHAMVI_ID,@CHEDODINHDUONG)                set @TOATHUOC_ID = SCOPE_IDENTITY()                  INSERT INTO TT_VIENPHI        ([TIEPNHAN_ID],[BENHAN_ID]        ,[DOTDIEUTRI_ID],[BENHNHAN_ID],[KHAMBENH_ID],[REF_ID],[REF_TABLE],[DICHVU_ID],[DUOC_ID],[LOAI_CHIPHI]        ,[SOLUONG],[DONGIA_DOANHTHU],[THANHTIEN_DOANHTHU],[BHYT_DONGIA],[BHYT_THANHTIEN],[HUY],[DATHANHTOAN]        ,[DATHUCHIEN],[KHONGTHUTIEN],[BHYTDONGTIEN],[BENHVIEN_ID],[NGUOITAO_ID],[NGAYTAO],[NGUOICAPNHAT_ID],        [NGAYCAPNHAT], [DOITUONG_HUONG_ID], [SOBHYT_HUONG_ID], [BHYT_DONGIA_CHITRA], [BHYT_THANHTIEN_CHITRA], [BENHNHAN_PHAITHANHTOAN])        VALUES        (@TIEPNHAN_ID,@BENHAN_ID        ,@DOTDIEUTRI_ID,@BENHNHAN_ID,@KHAMBENH_ID,@TOATHUOC_ID,'TT_NOITRU_TOATHUOC',null,@DUOC_ID,'TT'        ,@SOLUONG,@DONGIA_DOANHTHU,@THANHTIEN_DOANHTHU,@BHYT_DONGIA,@BHYT_THANHTIEN,'0','0'        ,'0',@KHONGTHUTIEN,@BHYTDONGTIEN,@BENHVIEN_ID,@NGUOITAO_ID,GETDATE(),@NGUOICAPNHAT_ID,GETDATE(), @DOITUONG_HUONG_ID, @SOBHYT_HUONG_ID        ,@BHYT_DONGIA_CHITRA, @BHYT_THANHTIEN_CHITRA, @BENHNHAN_PHAITHANHTOAN)                  insert into TT_DUOC_TONKHO_BOOK_NOITRU        ([REF_TABLE],[REF_ID],[PHAMVI_ID],[KHODUOC_ID],[DUOC_ID],[SOLUONG],[NGUONHANG_ID],[CHUYENKHOA_ID]        ,[GHICHU],[BENHVIEN_ID],[NGAYTAO],[NGUOITAO_ID],[NGAYCAPNHAT],[NGUOICAPNHAT_ID], [TRANGTHAI], [NGAYHIEULUC])        VALUES        ('TT_NOITRU_TOATHUOC',@TOATHUOC_ID,@PHAMVI_ID,@KHOPHAT_ID,@DUOC_ID,@SOLUONG,@NGUONDUOC_ID,@PHONGBANRATOA_ID        ,@GHICHU,@BENHVIEN_ID,GETDATE(),@NGUOITAO_ID,GETDATE(),@NGUOICAPNHAT_ID, 'HIEULUC', GETDATE())          set @icnt = @icnt + 1;        END        select @TOATHUOC_ID]
2020-02-26 15:17:39,469 [1] DEBUG - Statement Id: [DAO00063_Add_YLenhThuoc] Parameters: [@param0=[BENHAN_ID,24642], @param1=[TOTAL_RECORD,2]]
2020-02-26 15:17:39,469 [1] DEBUG - Statement Id: [DAO00063_Add_YLenhThuoc] Types: [@param0=[Int64, System.Int64], @param1=[Int32, System.Int32]]
2020-02-26 15:17:40,822 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis] PreparedStatement : [declare @NGUONDUOC_MACDINH varchar(5) = '0';        declare @TOAMUANGOAI int = 0;        select @NGUONDUOC_MACDINH = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'PHA_NGUONDUOC'        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + @NGUONDUOC_MACDINH as DUOC_KEY, 0 as PHAMVI_ID, @NGUONDUOC_MACDINH as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        where d.DUOC_ID in (1030,1030)        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id        from TT_DUOC_TONKHO  where DUOC_ID in (1030,1030) group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY'  and DUOC_ID in (1030,1030)        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and DUOC_ID in (1030,1030)        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where  d.BENHVIEN_ID = 'HLU01' and d.DUOC_ID in (1030,1030)        end        else        begin        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (        select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id        from TT_DUOC_TONKHO  where DUOC_ID in (1030,1030)        group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (        select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID        from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY' and DUOC_ID in (1030,1030)        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (        select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID        from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY' and DUOC_ID in (1030,1030)        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where  d.BENHVIEN_ID = 'HLU01' and d.DUOC_ID in (1030,1030)        end]
2020-02-26 15:17:42,604 [1] DEBUG - Statement Id: [DAOLOG01_LockEnd] PreparedStatement : [DELETE TT_LOG_UPDATE        where REF_TABLE = 'TT_NOITRU_KHAMBENH' and REF_ID = '24642' and BENHVIEN_ID = 'HLU01']
2020-02-26 15:17:42,628 [1] DEBUG - Statement Id: [DAO00067_UpdateThuocNoiVienPhi_Noref] PreparedStatement : [update TT_VIENPHI          set SOLUONG = (TraThuoc.SOLUONG - TraThuoc.SOLUONG_NGUNG)          from (select distinct nttt.SOLUONG, ttct.TOATHUOC_ID, ttct.DUOC_ID , ttct.SOLUONG SOLUONG_NGUNG          from TT_NOITRU_TRATHUOC_CHITIET ttct          left join TT_NOITRU_TRATHUOC tt on tt.TRATHUOC_ID = ttct.TRATHUOC_ID          left join TT_NOITRU_TOATHUOC nttt on nttt.TOATHUOC_ID = ttct.TOATHUOC_ID          where tt.BENHAN_ID =  @param0 ) TraThuoc          where TT_VIENPHI.REF_ID = TraThuoc.TOATHUOC_ID and TT_VIENPHI.DUOC_ID = TraThuoc.DUOC_ID          and TT_VIENPHI.REF_TABLE = 'TT_NOITRU_TOATHUOC' and TT_VIENPHI.BENHAN_ID =  @param0           and TT_VIENPHI.SOLUONG > (TraThuoc.SOLUONG - TraThuoc.SOLUONG_NGUNG)                     update TT_VIENPHI set SOLUONG = 0, THANHTIEN_DOANHTHU = 0, BHYT_THANHTIEN = 0, BHYT_THANHTIEN_CHITRA = 0          , GIATRI_BENHNHAN_DATHANHTOAN = 0, BENHNHAN_PHAITHANHTOAN = 0          where REF_TABLE = 'TT_NOITRU_TOATHUOC'          and TIEPNHAN_ID =  @param1           and KHAMBENH_ID not in (select KHAMBENH_ID from TT_NOITRU_TOATHUOC where TIEPNHAN_ID =  @param1 )          and HOADON_ID is null and BENHAN_ID =  @param0]
2020-02-26 15:17:42,628 [1] DEBUG - Statement Id: [DAO00067_UpdateThuocNoiVienPhi_Noref] Parameters: [@param0=[BENHAN_ID,24642], @param1=[TIEPNHAN_ID,107181]]
2020-02-26 15:17:42,628 [1] DEBUG - Statement Id: [DAO00067_UpdateThuocNoiVienPhi_Noref] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64]]
2020-02-26 15:17:42,763 [1] DEBUG - Statement Id: [DAO00062_GetDetail] PreparedStatement : [select *        from TT_NOITRU_KHAMBENH        where KHAMBENH_ID  = '320498']
2020-02-26 15:17:42,786 [1] DEBUG - Statement Id: [DAO00063_GetToaThuocByKhamBenhID] PreparedStatement : [select distinct a.*, b.SOLUONG as SOLUONGTAMNGUNG,        pl.MACHUNGTU as SOPHIEULINH, ct.MACHUNGTU as SOCHUNGTU        ,vp.BHYT_DONGIA, vp.BHYT_THANHTIEN, vp.BHYT_DONGIA_CHITRA, vp.BHYT_THANHTIEN_CHITRA,        vp.THANHTIEN_DOANHTHU, vp.DONGIA_DOANHTHU, dc.TENDUOCDAYDU, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, dc.DONVITINH        , d.TAMNGUNG        from TT_NOITRU_TOATHUOC a        left join TT_NOITRU_TRATHUOC_CHITIET b on a.TOATHUOC_ID = b.TOATHUOC_ID        left join TT_DUOC_PHIEULINH pl on pl.CHUNGTU_ID = a.PHIEULINH_ID        left join TT_DUOC_CHUNGTU ct on ct.CHUNGTU_ID = a.CHUNGTU_ID        left join TM_DUOC dc on a.DUOC_ID = dc.DUOC_ID        left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID        inner join TM_DUOC d on d.DUOC_ID = a.DUOC_ID        left join (select max(BHYT_DONGIA) BHYT_DONGIA, Max(BHYT_THANHTIEN) BHYT_THANHTIEN, max(BHYT_DONGIA_CHITRA) BHYT_DONGIA_CHITRA,        max(BHYT_THANHTIEN_CHITRA) BHYT_THANHTIEN_CHITRA, max(THANHTIEN_DOANHTHU) THANHTIEN_DOANHTHU, max(DONGIA_DOANHTHU) DONGIA_DOANHTHU,        KHAMBENH_ID, REF_ID, REF_TABLE, DUOC_ID from TT_VIENPHI where KHAMBENH_ID = '320498' and REF_TABLE = 'TT_NOITRU_TOATHUOC'  group by KHAMBENH_ID, REF_ID, REF_TABLE, DUOC_ID)        vp on vp.REF_ID = a.TOATHUOC_ID and vp.REF_TABLE = 'TT_NOITRU_TOATHUOC' and vp.DUOC_ID = a.DUOC_ID        where a.KHAMBENH_ID  = '320498' and a.BENHVIEN_ID = 'HLU01']
2020-02-26 15:17:42,964 [1] DEBUG - Statement Id: [DAO00040_LayListToaMau] PreparedStatement : [select A.*, dc.TENDUOCDAYDU, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ld.MALOAIDUOC, dd.DICTIONARY_NAME DUONGDUNG, dc.TAMNGUNG            from TT_TOATHUOCMAU A            left join TM_DUOC dc on A.DUOC_ID = dc.DUOC_ID            left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID            left join (select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE like 'DuongDung') dd on dd.DICTIONARY_ID = dc.DUONGDUNG_ID            where (1=1)]
2020-02-26 15:17:45,013 [1] DEBUG - Statement Id: [DAO00020_GetDanhsachVPCuaToaThuoc] PreparedStatement : [select * from TT_VIENPHI where        BENHAN_ID = 24642 and REF_TABLE = 'TT_NOITRU_TOATHUOC']
--------------------------------------------------------------------------------
2020-02-26 15:35:25,370 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2020-02-26 15:35:25,623 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2020-02-26 15:35:25,666 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2020-02-26 15:35:26,081 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 15:35:26,302 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2020-02-26 15:35:43,837 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2020-02-26 15:35:43,864 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2020-02-26 15:35:45,673 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2020-02-26 15:35:45,757 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2020-02-26 15:35:46,696 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2020-02-26 15:35:46,850 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2020-02-26 15:35:46,919 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2020-02-26 15:35:46,992 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2020-02-26 15:35:47,064 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2020-02-26 15:35:47,135 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2020-02-26 15:35:47,314 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2020-02-26 15:35:47,388 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2020-02-26 15:35:47,460 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2020-02-26 15:35:47,980 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2020-02-26 15:35:48,029 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2020-02-26 15:35:48,126 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2020-02-26 15:35:48,175 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2020-02-26 15:35:49,337 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2020-02-26 15:35:49,366 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @NGUONDUOC_MACDINH varchar(5) = '0';        declare @TOAMUANGOAI int = 0;        select @NGUONDUOC_MACDINH = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'PHA_NGUONDUOC'        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + @NGUONDUOC_MACDINH as DUOC_KEY, 0 as PHAMVI_ID, @NGUONDUOC_MACDINH as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end        else        begin                select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (        select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID)        B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (        select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID)        A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2020-02-26 15:35:51,095 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2020-02-26 15:35:51,150 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,        SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH        FROM TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID        WHERE TK.SOLUONG > 0        GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2020-02-26 15:35:51,292 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2020-02-26 15:35:51,384 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,        TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,        TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH        from TM_MAU M        JOIN        (        select        A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO        from        (        select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO        from TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'        where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0        ) A        )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2020-02-26 15:35:51,523 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2020-02-26 15:35:52,665 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 15:35:53,454 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2020-02-26 15:35:58,479 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2020-02-26 15:35:58,533 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2020-02-26 15:35:58,615 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 15:35:58,743 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 15:35:58,875 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2020-02-26 15:35:58,877 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2020-02-26 15:35:58,877 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2020-02-26 15:35:58,934 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2020-02-26 15:35:58,934 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2020-02-26 15:35:58,934 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2020-02-26 15:35:59,087 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 15:35:59,410 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 15:36:11,686 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 15:36:11,776 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2020-02-26 15:36:12,195 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2020-02-26 15:37:09,576 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'IPD02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 15:37:10,044 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'IPD40'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 15:37:10,190 [1] DEBUG - Statement Id: [DAO00069_GetCountDanhSachNoiTru] PreparedStatement : [select count(A.SOBENHAN) as TOTALROWS        from TT_NOITRU_BENHAN A        inner join TT_TIEPNHAN B on B.TIEPNHAN_ID = A.TIEPNHAN_ID and (B.TRANGTHAI = 'NOITRU' or B.TRANGTHAI = 'HOANTHANH')        inner join TT_BENHNHAN C on C.BENHNHAN_ID = B.BENHNHAN_ID        left join TT_NOITRU_LUUTRU D on D.BENHAN_ID = A.BENHAN_ID        and D.LUUTRU_ID = ( select top 1 LUUTRU_ID from TT_NOITRU_LUUTRU where BENHAN_ID = A.BENHAN_ID order by BENHAN_ID desc)        left join TT_NOITRU_XACNHAN E on E.BENHAN_ID = A.BENHAN_ID        left join TT_NOITRU_LUUTRUCHITIET F on D.LUUTRU_ID = F.LUUTRU_ID and F.LUUTRUCHITIET_CURRENT = '1'        and F.LUUTRUCHITIET_ID in (select top 1 LUUTRUCHITIET_ID from TT_NOITRU_LUUTRUCHITIET where LUUTRU_ID = D.LUUTRU_ID order by LUUTRUCHITIET_ID desc)        where        A.KHOACHUYENDEN_ID is not null  and        (E.TRANGTHAI = 'DAXACNHAN' OR E.TRANGTHAI = 'HUYXACNHAN')         and           cast(A.NGAYVAOKHOA as date) <= cast('2/26/2020 12:00:00 AM' as date)                 and B.BENHVIEN_ID = 'HLU01' and A.KHOACHUYENDEN_ID = '25'          AND             A.TRANGTHAI in ('DANGDIEUTRI')]
2020-02-26 15:37:10,328 [1] DEBUG - Statement Id: [DAO00069_GetDanhSachNoiTru] PreparedStatement : [select * from        (        SELECT ROW_NUMBER() OVER(order by B.SOTIEPNHAN) as ROWNUMBER,          A.SOBENHAN, A.BENHAN_ID, A.SOLUUTRU                 , E.NOILAP_ID as KHOAVAO_ID        , A.TRANGTHAI, IsNull(A.BACSIDIEUTRI_ID, E.BACSICHIDINH_ID) as BACSIDIEUTRI_ID,        B.TIEPNHAN_ID, B.SOTIEPNHAN, B.SOBHYT as SOTHE, B.DOITUONG_ID, A.NGAYVAOKHOA as NGAYCAPCUU, A.THOIGIANVAOKHOA as THOIGIANCAPCUU,        C.TENBENHNHAN, C.NGAYSINH, C.NAMSINH, C.BENHNHAN_ID, C.MAYTE, F.GIUONGBENH_ID, A.THOIGIANRAVIEN    , DIACHITHUONGTRU, DANTOC_ID        ,BENHVIEN_STT_ID                from TT_NOITRU_BENHAN A        inner join TT_TIEPNHAN B on B.TIEPNHAN_ID = A.TIEPNHAN_ID and (B.TRANGTHAI = 'NOITRU' or B.TRANGTHAI = 'HOANTHANH')        inner join TT_BENHNHAN C on C.BENHNHAN_ID = B.BENHNHAN_ID        left join TT_NOITRU_LUUTRU D on D.BENHAN_ID = A.BENHAN_ID        and D.LUUTRU_ID = ( select top 1 LUUTRU_ID from TT_NOITRU_LUUTRU where BENHAN_ID = A.BENHAN_ID order by LUUTRU_ID desc)        left join TT_NOITRU_XACNHAN E on E.BENHAN_ID = A.BENHAN_ID        left join TT_NOITRU_LUUTRUCHITIET F on D.LUUTRU_ID = F.LUUTRU_ID and F.LUUTRUCHITIET_CURRENT = '1'        and F.LUUTRUCHITIET_ID in (select top 1 LUUTRUCHITIET_ID from TT_NOITRU_LUUTRUCHITIET where LUUTRU_ID = D.LUUTRU_ID order by LUUTRUCHITIET_ID desc)        left join (select MABENHVIEN, BENHVIEN_STT_ID from TM_BENHVIEN) H on SUBSTRING(B.SOBHYT, 16, 5)=H.MABENHVIEN        where        A.KHOACHUYENDEN_ID is not null  and        (E.TRANGTHAI = 'DAXACNHAN' OR E.TRANGTHAI = 'HUYXACNHAN')         and           cast(A.NGAYVAOKHOA as date) <= cast('2/26/2020 12:00:00 AM' as date)                 and B.BENHVIEN_ID = 'HLU01' and A.KHOACHUYENDEN_ID = '25'          AND             A.TRANGTHAI in ('DANGDIEUTRI')                   ) lst        where        lst.ROWNUMBER between 1 and 20        order by lst.SOTIEPNHAN]
2020-02-26 15:37:11,500 [1] DEBUG - Statement Id: [DAO00069_GetCountDanhSachNoiTru] PreparedStatement : [select count(A.SOBENHAN) as TOTALROWS        from TT_NOITRU_BENHAN A        inner join TT_TIEPNHAN B on B.TIEPNHAN_ID = A.TIEPNHAN_ID and (B.TRANGTHAI = 'NOITRU' or B.TRANGTHAI = 'HOANTHANH')        inner join TT_BENHNHAN C on C.BENHNHAN_ID = B.BENHNHAN_ID        left join TT_NOITRU_LUUTRU D on D.BENHAN_ID = A.BENHAN_ID        and D.LUUTRU_ID = ( select top 1 LUUTRU_ID from TT_NOITRU_LUUTRU where BENHAN_ID = A.BENHAN_ID order by BENHAN_ID desc)        left join TT_NOITRU_XACNHAN E on E.BENHAN_ID = A.BENHAN_ID        left join TT_NOITRU_LUUTRUCHITIET F on D.LUUTRU_ID = F.LUUTRU_ID and F.LUUTRUCHITIET_CURRENT = '1'        and F.LUUTRUCHITIET_ID in (select top 1 LUUTRUCHITIET_ID from TT_NOITRU_LUUTRUCHITIET where LUUTRU_ID = D.LUUTRU_ID order by LUUTRUCHITIET_ID desc)        where        A.KHOACHUYENDEN_ID is not null  and        (E.TRANGTHAI = 'DAXACNHAN' OR E.TRANGTHAI = 'HUYXACNHAN')         and           cast(A.NGAYVAOKHOA as date) <= cast('2/26/2020 12:00:00 AM' as date)                 and B.BENHVIEN_ID = 'HLU01' and A.KHOACHUYENDEN_ID = '25'          AND             A.TRANGTHAI in ('DANGDIEUTRI')]
2020-02-26 15:37:11,597 [1] DEBUG - Statement Id: [DAO00069_GetDanhSachNoiTru] PreparedStatement : [select * from        (        SELECT ROW_NUMBER() OVER(order by B.SOTIEPNHAN) as ROWNUMBER,          A.SOBENHAN, A.BENHAN_ID, A.SOLUUTRU                 , E.NOILAP_ID as KHOAVAO_ID        , A.TRANGTHAI, IsNull(A.BACSIDIEUTRI_ID, E.BACSICHIDINH_ID) as BACSIDIEUTRI_ID,        B.TIEPNHAN_ID, B.SOTIEPNHAN, B.SOBHYT as SOTHE, B.DOITUONG_ID, A.NGAYVAOKHOA as NGAYCAPCUU, A.THOIGIANVAOKHOA as THOIGIANCAPCUU,        C.TENBENHNHAN, C.NGAYSINH, C.NAMSINH, C.BENHNHAN_ID, C.MAYTE, F.GIUONGBENH_ID, A.THOIGIANRAVIEN    , DIACHITHUONGTRU, DANTOC_ID        ,BENHVIEN_STT_ID                from TT_NOITRU_BENHAN A        inner join TT_TIEPNHAN B on B.TIEPNHAN_ID = A.TIEPNHAN_ID and (B.TRANGTHAI = 'NOITRU' or B.TRANGTHAI = 'HOANTHANH')        inner join TT_BENHNHAN C on C.BENHNHAN_ID = B.BENHNHAN_ID        left join TT_NOITRU_LUUTRU D on D.BENHAN_ID = A.BENHAN_ID        and D.LUUTRU_ID = ( select top 1 LUUTRU_ID from TT_NOITRU_LUUTRU where BENHAN_ID = A.BENHAN_ID order by LUUTRU_ID desc)        left join TT_NOITRU_XACNHAN E on E.BENHAN_ID = A.BENHAN_ID        left join TT_NOITRU_LUUTRUCHITIET F on D.LUUTRU_ID = F.LUUTRU_ID and F.LUUTRUCHITIET_CURRENT = '1'        and F.LUUTRUCHITIET_ID in (select top 1 LUUTRUCHITIET_ID from TT_NOITRU_LUUTRUCHITIET where LUUTRU_ID = D.LUUTRU_ID order by LUUTRUCHITIET_ID desc)        left join (select MABENHVIEN, BENHVIEN_STT_ID from TM_BENHVIEN) H on SUBSTRING(B.SOBHYT, 16, 5)=H.MABENHVIEN        where        A.KHOACHUYENDEN_ID is not null  and        (E.TRANGTHAI = 'DAXACNHAN' OR E.TRANGTHAI = 'HUYXACNHAN')         and           cast(A.NGAYVAOKHOA as date) <= cast('2/26/2020 12:00:00 AM' as date)                 and B.BENHVIEN_ID = 'HLU01' and A.KHOACHUYENDEN_ID = '25'          AND             A.TRANGTHAI in ('DANGDIEUTRI')                   ) lst        where        lst.ROWNUMBER between 1 and 20        order by lst.SOTIEPNHAN]
2020-02-26 15:38:31,196 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM31'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 15:38:31,342 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'IPD03'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 15:38:32,919 [1] DEBUG - Statement Id: [DAO00080_KiemtraBenhAnDaThanhToan] PreparedStatement : [select DAXACNHANDOANHTHU        from TT_NOITRU_BENHAN where        BENHAN_ID = '24642'        and BENHVIEN_ID = 'HLU01'        Order By BENHAN_ID Desc]
2020-02-26 15:38:33,030 [1] DEBUG - Statement Id: [DAO00061_GetBenhAnDetailByID] PreparedStatement : [select A.*, B.NOIGIOITHIEU_ID, C.KHOADIEUTRI_ID, A.ICD_BENHCHINH AS ICD_BENHCHINH_BAK, A.CDRAVIEN_CHINH AS CHANDOANRAVIEN1, B.THOIGIANTIEPNHAN        , A.CDRAVIEN_CHINH AS CHANDOANRAVIEN_BAK        from TT_NOITRU_BENHAN A        left join TT_TIEPNHAN B on B.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TT_NOITRU_NHAPVIEN C on C.TIEPNHAN_ID = B.TIEPNHAN_ID        where A.BENHAN_ID = '24642']
2020-02-26 15:38:33,088 [1] DEBUG - Statement Id: [DAO00087_GetServiceParams] PreparedStatement : [select CODE, VALUE              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01']
2020-02-26 15:38:33,143 [1] DEBUG - Statement Id: [DAO00080_GetNoiTruLuuTruBenhAn] PreparedStatement : [select *        from TT_NOITRU_LUUTRU where        BENHAN_ID = '24642'        and BENHVIEN_ID = 'HLU01'        Order By LUUTRU_ID ASC]
2020-02-26 15:38:33,199 [1] DEBUG - Statement Id: [DAO00080_GetGiuongBenhCuaBenhAn] PreparedStatement : [select *        from TT_NOITRU_GIUONGBENH where        BENHAN_ID =  @param0]
2020-02-26 15:38:33,199 [1] DEBUG - Statement Id: [DAO00080_GetGiuongBenhCuaBenhAn] Parameters: [@param0=[BENHAN_ID,24642]]
2020-02-26 15:38:33,199 [1] DEBUG - Statement Id: [DAO00080_GetGiuongBenhCuaBenhAn] Types: [@param0=[Int64, System.Int64]]
2020-02-26 15:38:33,271 [1] DEBUG - Statement Id: [DAO00013_GetDetailP] PreparedStatement : [select *        from TT_BENHNHAN         WHERE              TT_BENHNHAN.MAYTE  = '190040528']
2020-02-26 15:38:33,479 [1] DEBUG - Statement Id: [DAO00061_GetBenhAnDetailByID] PreparedStatement : [select A.*, B.NOIGIOITHIEU_ID, C.KHOADIEUTRI_ID, A.ICD_BENHCHINH AS ICD_BENHCHINH_BAK, A.CDRAVIEN_CHINH AS CHANDOANRAVIEN1, B.THOIGIANTIEPNHAN        , A.CDRAVIEN_CHINH AS CHANDOANRAVIEN_BAK        from TT_NOITRU_BENHAN A        left join TT_TIEPNHAN B on B.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TT_NOITRU_NHAPVIEN C on C.TIEPNHAN_ID = B.TIEPNHAN_ID        where A.BENHAN_ID = '24642']
2020-02-26 15:38:33,585 [1] DEBUG - Statement Id: [DAO00080_GetNoiTruBenhAnChiTiet] PreparedStatement : [select *        from TT_NOITRU_BENHAN_CHITIET where        BENHAN_ID = '24642'        and BENHVIEN_ID = 'HLU01'        Order By BENHANCHITIET_ID DESC]
2020-02-26 15:38:33,674 [1] DEBUG - Statement Id: [DAO00080_GetNoiTruLuuTruBenhAn] PreparedStatement : [select *        from TT_NOITRU_LUUTRU where        BENHAN_ID = '24642'        and BENHVIEN_ID = 'HLU01'        Order By LUUTRU_ID ASC]
2020-02-26 15:38:33,710 [1] DEBUG - Statement Id: [DAO00080_GetGiuongBenhCuaBenhAn] PreparedStatement : [select *        from TT_NOITRU_GIUONGBENH where        BENHAN_ID =  @param0]
2020-02-26 15:38:33,710 [1] DEBUG - Statement Id: [DAO00080_GetGiuongBenhCuaBenhAn] Parameters: [@param0=[BENHAN_ID,24642]]
2020-02-26 15:38:33,710 [1] DEBUG - Statement Id: [DAO00080_GetGiuongBenhCuaBenhAn] Types: [@param0=[Int64, System.Int64]]
2020-02-26 15:38:33,797 [1] DEBUG - Statement Id: [DAO00067_laytrangthaibenhannoitru] PreparedStatement : [select isnull(TRANGTHAI, '') TRANGTHAI from TT_NOITRU_BENHAN where BENHAN_ID =  @param0]
2020-02-26 15:38:33,798 [1] DEBUG - Statement Id: [DAO00067_laytrangthaibenhannoitru] Parameters: [@param0=[BENHAN_ID,24642]]
2020-02-26 15:38:33,798 [1] DEBUG - Statement Id: [DAO00067_laytrangthaibenhannoitru] Types: [@param0=[Int64, System.Int64]]
2020-02-26 15:38:33,836 [1] DEBUG - Statement Id: [DAO00067_DeleteVienPhi_Noref] PreparedStatement : [delete from TT_VIENPHI where TIEPNHAN_ID = 107181 and (REF_ID is null or REF_ID = 0)         and           BENHAN_ID = '24642'                 delete TT_DUOC_TONKHO_BOOK_NOITRU where REF_TABLE = 'TT_NOITRU_TOATHUOC' and (REF_ID is null or REF_ID = 0)        delete TT_DUOC_TONKHO_BOOK_NGOAITRU where REF_ID is null or REF_ID = 0]
2020-02-26 15:38:33,861 [1] DEBUG - Statement Id: [DAO00067_UpdateBenhanIdVienPhi] PreparedStatement : [update TT_VIENPHI          set BENHAN_ID =  @param0           from (select TOATHUOC_ID from TT_NOITRU_TOATHUOC where TIEPNHAN_ID =  @param1 ) nttt          where REF_TABLE = 'TT_NOITRU_TOATHUOC' and REF_ID = nttt.TOATHUOC_ID and isnull(BENHAN_ID, 0) = 0          and TIEPNHAN_ID =  @param1             update TT_VIENPHI          set TT_VIENPHI.BENHAN_ID =  @param0           from (select DVYEUCAU_ID, BENHAN_ID from TT_DVYEUCAU where TIEPNHAN_ID =  @param1 ) nttt          where TT_VIENPHI.REF_TABLE = 'TT_DVYEUCAU' and TT_VIENPHI.REF_ID = nttt.DVYEUCAU_ID          and isnull(TT_VIENPHI.BENHAN_ID, 0) = 0 and isnull(nttt.BENHAN_ID, 0) > 0          and TT_VIENPHI.TIEPNHAN_ID =  @param1]
2020-02-26 15:38:33,861 [1] DEBUG - Statement Id: [DAO00067_UpdateBenhanIdVienPhi] Parameters: [@param0=[BENHAN_ID,24642], @param1=[TIEPNHAN_ID,107181]]
2020-02-26 15:38:33,861 [1] DEBUG - Statement Id: [DAO00067_UpdateBenhanIdVienPhi] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64]]
2020-02-26 15:38:33,888 [1] DEBUG - Statement Id: [DAO00064_GetlistTT_TIEPNHAN_SOTHEBHYT] PreparedStatement : [select stbhyt.*, ba.SOBENHAN,        tn.SOTIEPNHAN, tn.LOAITHANHVIEN_ID, tn.THE_ID, tn.THANHVIEN_ID,        tn.SUDUNG_BHTN, tn.BAOLANH_VIENPHI, tn.VIP, tn.NGUOINUOCNGOAI        from TT_TIEPNHAN_SOTHEBHYT stbhyt        left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = stbhyt.TIEPNHAN_ID        left join TT_NOITRU_BENHAN ba on ba.TIEPNHAN_ID = stbhyt.TIEPNHAN_ID        where        stbhyt.TIEPNHAN_ID = '107181' and isnull(stbhyt.KHONGSUDUNG, '0') = '0'         and           ba.BENHAN_ID = '24642']
2020-02-26 15:38:33,931 [1] DEBUG - Statement Id: [DAO00064_GetListVienPhiByTiepNnan] PreparedStatement : [select distinct        B.DOITUONG_ID, B.NGAYMIENDONGCHITRA, B.BENHNHAN_ID as TIEPNHAN_BENHNHAN_ID, B.TRAITUYEN,        B.BHYTTREN3NAM as TREN3NAM, B.BHYTTREN5NAM as TREN5NAM, B.SOTIEPNHAN, B.SOBENHAN,        B.LOAITHANHVIEN_ID, B.SUDUNG_BHTN, B.THE_ID, B.THANHVIEN_ID, B.BAOLANH_VIENPHI, B.VIP, B.NGUOINUOCNGOAI,        C.GIATRIMIENGIAM as GIATRIMIENGIAM, D.GIATRIMIENGIAM as GIATRIMIENGIAM_BHTN, E.GIATRIMIENGIAM as GIATRIMIENGIAM_THANHVIEN,        F.GIATRIMIENGIAM as GIATRIMIENGIAM_CONGTY, DVYC.THE_ID as DVDUNGTHE, DVYC.TRANGTHAI as TRANGTHAIDICHVU, ndv.MANHOMDICHVU,        A.* from TT_VIENPHI A        left join        (select B.*, C.SOBENHAN, C.BENHAN_ID        from TT_TIEPNHAN B        left join TT_NOITRU_BENHAN C on B.TIEPNHAN_ID = C.TIEPNHAN_ID         and           C.BENHAN_ID = '24642'                 where B.TIEPNHAN_ID = '107181') B on B.TIEPNHAN_ID = A.TIEPNHAN_ID        left join (select sum(GIATRIMIENGIAM) as GIATRIMIENGIAM, VIENPHI_ID, REF_TABLE        from TT_MIENGIAM_CHITIET        where REF_TABLE = 'TT_MIENGIAM'        and exists (select MIENGIAM_ID from TT_MIENGIAM where TT_MIENGIAM_CHITIET.MIENGIAM_ID = MIENGIAM_ID and TINHTRANG = 1 and TIEPNHAN_ID = '107181')        group by VIENPHI_ID, REF_TABLE) C on C.REF_TABLE = 'TT_MIENGIAM' and C.VIENPHI_ID = A.VIENPHI_ID        left join (select sum(GIATRIMIENGIAM) as GIATRIMIENGIAM, VIENPHI_ID, REF_TABLE        from TT_MIENGIAM_CHITIET        where REF_TABLE = 'TT_MIENGIAM_BHTN'        and exists (select MIENGIAM_BHTN_ID from TT_MIENGIAM_BHTN where TT_MIENGIAM_CHITIET.MIENGIAM_ID = MIENGIAM_BHTN_ID and  TINHTRANG = 1 and TIEPNHAN_ID = '107181')        group by VIENPHI_ID, REF_TABLE) D on D.REF_TABLE = 'TT_MIENGIAM_BHTN' and D.VIENPHI_ID = A.VIENPHI_ID        left join (select sum(GIATRIMIENGIAM) as GIATRIMIENGIAM, VIENPHI_ID, REF_TABLE        from TT_MIENGIAM_CHITIET        where REF_TABLE = 'TT_MIENGIAM_THANHVIEN'        and exists (select MIENGIAM_THANHVIEN_ID from TT_MIENGIAM_THANHVIEN where TT_MIENGIAM_CHITIET.MIENGIAM_ID = MIENGIAM_THANHVIEN_ID and TINHTRANG = 1 and TIEPNHAN_ID = '107181')        group by VIENPHI_ID, REF_TABLE) E on E.REF_TABLE = 'TT_MIENGIAM_THANHVIEN' and E.VIENPHI_ID = A.VIENPHI_ID        left join (select sum(GIATRIMIENGIAM) as GIATRIMIENGIAM, VIENPHI_ID, REF_TABLE        from TT_MIENGIAM_CHITIET        where REF_TABLE = 'TT_MIENGIAM_CONGTY'        and exists (select MIENGIAM_CONGTY_ID from TT_MIENGIAM_CONGTY where TT_MIENGIAM_CHITIET.MIENGIAM_ID = MIENGIAM_CONGTY_ID and TINHTRANG = 1 and TIEPNHAN_ID = '107181')        group by VIENPHI_ID, REF_TABLE) F on F.REF_TABLE = 'TT_MIENGIAM_CONGTY' and F.VIENPHI_ID = A.VIENPHI_ID        left join TT_DVYEUCAU DVYC on DVYC.DVYEUCAU_ID = A.REF_ID and A.REF_TABLE = 'TT_DVYEUCAU'        left join TM_DICHVU DV on DVYC.DICHVU_ID = DV.DICHVU_ID and A.REF_TABLE = 'TT_DVYEUCAU'        left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = DV.NHOMDICHVU_ID and A.REF_TABLE = 'TT_DVYEUCAU'        where        A.TIEPNHAN_ID = '107181' and ((DVYC.HUYYEUCAU = '0' and A.DICHVU_ID is not null)        or A.DUOC_ID is not null or A.REF_TABLE = 'TT_NUT_XACNHANSUATAN_CHITIET')        and A.ACTIVE = '1'         and           A.BENHAN_ID = '24642'                 and A.BENHVIEN_ID = 'HLU01'        order by A.VIENPHI_ID]
2020-02-26 15:38:33,991 [1] DEBUG - Statement Id: [DAO00006_GetListDuocTyle] PreparedStatement : [select DUOC_ID, DOITUONG_ID, (TYLE/100) as TYLE, DONGIA MUCTRAN_THANHTOAN from TM_DOITUONG_GIADUOC_TYLE            where            BENHVIEN_ID = 'HLU01'            and DOITUONG_ID = '4']
2020-02-26 15:38:34,015 [1] DEBUG - Statement Id: [DAO00027_GetListTuongTrinhDichVuPhauThuatCuaTiepNhan] PreparedStatement : [declare @ManhomDSA varchar(10);        declare @PhanLoaiNhomDV varchar(20) = '05';        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        if (@ManhomDSA is not null) set @PhanLoaiNhomDV += ',' + @ManhomDSA        select distinct ptyc.*        from TT_PHAUTHUAT_YEUCAU ptyc        inner join TM_DICHVU dv on dv.DICHVU_ID = ptyc.DICHVU_ID        inner join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID        inner join TT_PHAUTHUAT pt on pt.PHAUTHUAT_ID = ptyc.PHAUTHUAT_ID        where        pt.TIEPNHAN_ID = 107181        and (left(ndv.MANHOMDICHVU, 2) in (select * from STRING_SPLIT(@PhanLoaiNhomDV,',')) or ndv.MANHOMDICHVU in (select * from STRING_SPLIT(@PhanLoaiNhomDV,',')))]
2020-02-26 15:38:34,090 [1] DEBUG - Statement Id: [DAO00027_GetListTuongTrinhVTYTPhauThuatCuaTiepNhan] PreparedStatement : [select distinct ptvt.*        from TT_PHAUTHUAT_VTYT ptvt        inner join TT_PHAUTHUAT pt on pt.PHAUTHUAT_ID = ptvt.PHAUTHUAT_ID        inner join TM_DUOC d on d.DUOC_ID = ptvt.DUOC_ID        inner join TM_LOAIDUOC ld on ld.LOAIVATTU_ID = 'V' and ld.LOAIDUOC_ID = d.LOAIDUOC_ID        where pt.TIEPNHAN_ID = 107181        order by ptvt.PHAUTHUAT_VTYT_ID asc]
2020-02-26 15:38:34,125 [1] DEBUG - Statement Id: [DAO00006_GetList] PreparedStatement : [select dv.*, loaiDV.MALOAIDICHVU, captren.NHOMDICHVU_ID as NHOMDICHVU_CAPTREN_ID, captren.TENNHOMDICHVU as NHOMDICHVU_CAPTREN,              nhom_dv.TENNHOMDICHVU as TENNHOMDICHVU, nhom_dv.MANHOMDICHVU,              case when dv.ATTRIBUTE5 is null then 'TT' else 'KTC' end as LOAI_CHIPHI              from TM_DICHVU as dv              left join TM_NHOMDICHVU as nhom_dv on nhom_dv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID and nhom_dv.BENHVIEN_ID = 'HLU01'              left join TM_NHOMDICHVU as captren on nhom_dv.CAPTREN_ID = captren.NHOMDICHVU_ID and captren.BENHVIEN_ID = 'HLU01'              left join TM_LOAIDICHVU loaiDV on nhom_dv.LOAIDICHVU_ID = loaiDV.LOAIDICHVU_ID and loaiDV.BENHVIEN_ID = 'HLU01'              where nhom_dv.TAMNGUNG = '0' and dv.BENHVIEN_ID = 'HLU01'              and dv.TAMNGUNG = '0'               AND                   loaiDV.MALOAIDICHVU = 'KhamBenh']
2020-02-26 15:38:34,184 [1] DEBUG - Statement Id: [DAO00027_GetDichvuYCBHYTTyle] PreparedStatement : [select DVYEUCAU_ID from TT_DVYEUCAU        where TIEPNHAN_ID = 107181 and isnull(BHYT_TYLETHANHTOAN_ID, 0) > 0]
2020-02-26 15:38:34,453 [1] DEBUG - Statement Id: [DAO00023_UpdateNhieuVP] PreparedStatement : [declare @jsonVienPhi nvarchar(max) = N'[{"VIENPHI_ID":3109614,"TIEPNHAN_ID":107181,"DICHVU_ID":5440,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":34500.0000,"THANHTIEN_DOANHTHU":34500.00,"BHYT_TL":0.8000,"BHYT_DONGIA":34500.0000,"BHYT_THANHTIEN":34500.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":27600.0,"BHYT_THANHTIEN_CHITRA":27600.00,"BENHNHAN_PHAITHANHTOAN":6900.00,"GIATRI_HOADON":6900.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3109615,"TIEPNHAN_ID":107181,"DICHVU_ID":5554,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":5000.0000,"THANHTIEN_DOANHTHU":5000.00,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":5000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110619,"TIEPNHAN_ID":107181,"DICHVU_ID":4022,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":43900.0000,"THANHTIEN_DOANHTHU":43900.00,"BHYT_TL":0.8000,"BHYT_DONGIA":43900.0000,"BHYT_THANHTIEN":43900.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":35120.0,"BHYT_THANHTIEN_CHITRA":35120.00,"BENHNHAN_PHAITHANHTOAN":8780.00,"GIATRI_HOADON":8780.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110620,"TIEPNHAN_ID":107181,"DICHVU_ID":4422,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":32800.0000,"THANHTIEN_DOANHTHU":32800.00,"BHYT_TL":0.8000,"BHYT_DONGIA":32800.0000,"BHYT_THANHTIEN":32800.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":26240.0,"BHYT_THANHTIEN_CHITRA":26240.00,"BENHNHAN_PHAITHANHTOAN":6560.00,"GIATRI_HOADON":6560.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110621,"TIEPNHAN_ID":107181,"DICHVU_ID":4451,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":63500.0000,"THANHTIEN_DOANHTHU":63500.00,"BHYT_TL":0.8000,"BHYT_DONGIA":63500.0000,"BHYT_THANHTIEN":63500.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":50800.0,"BHYT_THANHTIEN_CHITRA":50800.00,"BENHNHAN_PHAITHANHTOAN":12700.00,"GIATRI_HOADON":12700.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110622,"TIEPNHAN_ID":107181,"DICHVU_ID":4454,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":40400.0000,"THANHTIEN_DOANHTHU":40400.00,"BHYT_TL":0.8000,"BHYT_DONGIA":40400.0000,"BHYT_THANHTIEN":40400.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":32320.0,"BHYT_THANHTIEN_CHITRA":32320.00,"BENHNHAN_PHAITHANHTOAN":8080.00,"GIATRI_HOADON":8080.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110623,"TIEPNHAN_ID":107181,"DICHVU_ID":4523,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":40400.0000,"THANHTIEN_DOANHTHU":40400.00,"BHYT_TL":0.8000,"BHYT_DONGIA":40400.0000,"BHYT_THANHTIEN":40400.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":32320.0,"BHYT_THANHTIEN_CHITRA":32320.00,"BENHNHAN_PHAITHANHTOAN":8080.00,"GIATRI_HOADON":8080.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110624,"TIEPNHAN_ID":107181,"DICHVU_ID":4596,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":39100.0000,"THANHTIEN_DOANHTHU":39100.00,"BHYT_TL":0.8000,"BHYT_DONGIA":39100.0000,"BHYT_THANHTIEN":39100.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":31280.0,"BHYT_THANHTIEN_CHITRA":31280.00,"BENHNHAN_PHAITHANHTOAN":7820.00,"GIATRI_HOADON":7820.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110626,"TIEPNHAN_ID":107181,"DICHVU_ID":4642,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":21500.0000,"THANHTIEN_DOANHTHU":21500.00,"BHYT_TL":0.8000,"BHYT_DONGIA":21500.0000,"BHYT_THANHTIEN":21500.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":17200.0,"BHYT_THANHTIEN_CHITRA":17200.00,"BENHNHAN_PHAITHANHTOAN":4300.00,"GIATRI_HOADON":4300.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110628,"TIEPNHAN_ID":107181,"DICHVU_ID":4681,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":21500.0000,"THANHTIEN_DOANHTHU":21500.00,"BHYT_TL":0.8000,"BHYT_DONGIA":21500.0000,"BHYT_THANHTIEN":21500.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":17200.0,"BHYT_THANHTIEN_CHITRA":17200.00,"BENHNHAN_PHAITHANHTOAN":4300.00,"GIATRI_HOADON":4300.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110629,"TIEPNHAN_ID":107181,"DICHVU_ID":4722,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":21500.0000,"THANHTIEN_DOANHTHU":21500.00,"BHYT_TL":0.8000,"BHYT_DONGIA":21500.0000,"BHYT_THANHTIEN":21500.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":17200.0,"BHYT_THANHTIEN_CHITRA":17200.00,"BENHNHAN_PHAITHANHTOAN":4300.00,"GIATRI_HOADON":4300.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110630,"TIEPNHAN_ID":107181,"DICHVU_ID":4747,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":27400.0000,"THANHTIEN_DOANHTHU":27400.00,"BHYT_TL":0.8000,"BHYT_DONGIA":27400.0000,"BHYT_THANHTIEN":27400.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":21920.0,"BHYT_THANHTIEN_CHITRA":21920.00,"BENHNHAN_PHAITHANHTOAN":5480.00,"GIATRI_HOADON":5480.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110631,"TIEPNHAN_ID":107181,"DICHVU_ID":4832,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":70000.0000,"THANHTIEN_DOANHTHU":70000.00,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":70000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":70000.0000,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":70000.0000,"GIATRI_BENHNHAN_DATHANHTOAN":70000.0000,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110632,"TIEPNHAN_ID":107181,"DICHVU_ID":4873,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":70000.0000,"THANHTIEN_DOANHTHU":70000.00,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":70000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":70000.0000,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":70000.0000,"GIATRI_BENHNHAN_DATHANHTOAN":70000.0000,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119342,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":5.0000,"DONGIA_DOANHTHU":4000.0000,"THANHTIEN_DOANHTHU":20000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":20000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119500,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":2.0000,"DONGIA_DOANHTHU":8715.0000,"THANHTIEN_DOANHTHU":17430.00,"BHYT_TL":0.8000,"BHYT_DONGIA":8715.0000,"BHYT_THANHTIEN":17430.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":6972.0,"BHYT_THANHTIEN_CHITRA":13944.00,"BENHNHAN_PHAITHANHTOAN":3486.00,"GIATRI_HOADON":3486.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119501,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":8925.0000,"THANHTIEN_DOANHTHU":8925.00,"BHYT_TL":0.8000,"BHYT_DONGIA":8925.0000,"BHYT_THANHTIEN":8925.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":7140.0,"BHYT_THANHTIEN_CHITRA":7140.00,"BENHNHAN_PHAITHANHTOAN":1785.00,"GIATRI_HOADON":1785.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119502,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":2.0000,"DONGIA_DOANHTHU":27990.0000,"THANHTIEN_DOANHTHU":55980.00,"BHYT_TL":0.8000,"BHYT_DONGIA":27990.0000,"BHYT_THANHTIEN":55980.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":22392.0,"BHYT_THANHTIEN_CHITRA":44784.00,"BENHNHAN_PHAITHANHTOAN":11196.00,"GIATRI_HOADON":11196.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119503,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":8925.0000,"THANHTIEN_DOANHTHU":8925.00,"BHYT_TL":0.8000,"BHYT_DONGIA":8925.0000,"BHYT_THANHTIEN":8925.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":7140.0,"BHYT_THANHTIEN_CHITRA":7140.00,"BENHNHAN_PHAITHANHTOAN":1785.00,"GIATRI_HOADON":1785.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119504,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":2.0000,"DONGIA_DOANHTHU":8295.0000,"THANHTIEN_DOANHTHU":16590.00,"BHYT_TL":0.8000,"BHYT_DONGIA":8295.0000,"BHYT_THANHTIEN":16590.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":6636.0,"BHYT_THANHTIEN_CHITRA":13272.00,"BENHNHAN_PHAITHANHTOAN":3318.00,"GIATRI_HOADON":3318.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119505,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":458000.0000,"THANHTIEN_DOANHTHU":458000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":398036.0000,"BHYT_THANHTIEN":398036.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":318428.8,"BHYT_THANHTIEN_CHITRA":318428.80,"BENHNHAN_PHAITHANHTOAN":139571.20,"GIATRI_HOADON":79607.20,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119506,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":50400.0000,"THANHTIEN_DOANHTHU":50400.00,"BHYT_TL":0.8000,"BHYT_DONGIA":50400.0000,"BHYT_THANHTIEN":50400.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":40320.0,"BHYT_THANHTIEN_CHITRA":40320.00,"BENHNHAN_PHAITHANHTOAN":10080.00,"GIATRI_HOADON":10080.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119530,"TIEPNHAN_ID":107181,"DICHVU_ID":5363,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":10000.0000,"THANHTIEN_DOANHTHU":10000.00,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119531,"TIEPNHAN_ID":107181,"DICHVU_ID":5588,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":2400.0000,"THANHTIEN_DOANHTHU":2400.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119532,"TIEPNHAN_ID":107181,"DICHVU_ID":477,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":110000.0000,"THANHTIEN_DOANHTHU":110000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119533,"TIEPNHAN_ID":107181,"DICHVU_ID":5602,"BENHAN_ID":24642,"SOLUONG":0.5000,"DONGIA_DOANHTHU":200000.0000,"THANHTIEN_DOANHTHU":100000.00,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":100000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119535,"TIEPNHAN_ID":107181,"DICHVU_ID":3161,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":2945000.0000,"THANHTIEN_DOANHTHU":2945000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":2945000.0000,"BHYT_THANHTIEN":2945000.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":2356000.0,"BHYT_THANHTIEN_CHITRA":2356000.00,"BENHNHAN_PHAITHANHTOAN":589000.00,"GIATRI_HOADON":589000.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119536,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":0.2500,"DONGIA_DOANHTHU":25000.0000,"THANHTIEN_DOANHTHU":6250.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119537,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":2.0000,"DONGIA_DOANHTHU":1700.0000,"THANHTIEN_DOANHTHU":3400.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119538,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":3.0000,"DONGIA_DOANHTHU":1000.0000,"THANHTIEN_DOANHTHU":3000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119539,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":3.0000,"DONGIA_DOANHTHU":2000.0000,"THANHTIEN_DOANHTHU":6000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119540,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":4000.0000,"THANHTIEN_DOANHTHU":4000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119541,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":3000.0000,"THANHTIEN_DOANHTHU":3000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119542,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":100.0000,"DONGIA_DOANHTHU":50.0000,"THANHTIEN_DOANHTHU":5000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119543,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":150000.0000,"THANHTIEN_DOANHTHU":150000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119544,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":160000.0000,"THANHTIEN_DOANHTHU":160000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119545,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":20.0000,"DONGIA_DOANHTHU":3000.0000,"THANHTIEN_DOANHTHU":60000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119546,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":20.0000,"DONGIA_DOANHTHU":6000.0000,"THANHTIEN_DOANHTHU":120000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119547,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":5.0000,"DONGIA_DOANHTHU":4000.0000,"THANHTIEN_DOANHTHU":20000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119548,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":10.0000,"DONGIA_DOANHTHU":8000.0000,"THANHTIEN_DOANHTHU":80000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119549,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":2.0000,"DONGIA_DOANHTHU":500.0000,"THANHTIEN_DOANHTHU":1000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119550,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":10000.0000,"THANHTIEN_DOANHTHU":10000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119551,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":45000.0000,"THANHTIEN_DOANHTHU":45000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119552,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":35000.0000,"THANHTIEN_DOANHTHU":35000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119553,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":10000.0000,"THANHTIEN_DOANHTHU":10000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119554,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":20000.0000,"THANHTIEN_DOANHTHU":20000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119555,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":6500.0000,"THANHTIEN_DOANHTHU":6500.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119556,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":0.5000,"DONGIA_DOANHTHU":16000.0000,"THANHTIEN_DOANHTHU":8000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119557,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":0.2500,"DONGIA_DOANHTHU":100000.0000,"THANHTIEN_DOANHTHU":25000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119558,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":2.0000,"DONGIA_DOANHTHU":10000.0000,"THANHTIEN_DOANHTHU":20000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119559,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":60000.0000,"THANHTIEN_DOANHTHU":60000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119560,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":2.0000,"DONGIA_DOANHTHU":13500.0000,"THANHTIEN_DOANHTHU":27000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119561,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":6000.0000,"THANHTIEN_DOANHTHU":6000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119645,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":600.0000,"THANHTIEN_DOANHTHU":600.00,"BHYT_TL":0.8000,"BHYT_DONGIA":600.0000,"BHYT_THANHTIEN":600.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":480.0,"BHYT_THANHTIEN_CHITRA":480.00,"BENHNHAN_PHAITHANHTOAN":120.00,"GIATRI_HOADON":120.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":0.0,"DUOC_TYLE":0.0000},{"VIENPHI_ID":3119646,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":1000.0000,"THANHTIEN_DOANHTHU":1000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":1000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"1","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":0.0,"DUOC_TYLE":0.0000}]';        begin        UPDATE TT_VIENPHI        SET        SOLUONG = json.SOLUONG,        DONGIA_DOANHTHU = json.DONGIA_DOANHTHU,        THANHTIEN_DOANHTHU = json.THANHTIEN_DOANHTHU,        BHYT_TL = json.BHYT_TL,        BHYT_DONGIA = json.BHYT_DONGIA,        BHYT_THANHTIEN = json.BHYT_THANHTIEN,        BHYT_DONGIA_CONGKHAM_DAU = json.BHYT_DONGIA_CONGKHAM_DAU,        BHYT_CONGKHAM_DAU_TYLE = json.BHYT_CONGKHAM_DAU_TYLE,        BHYT_DONGIA_CHITRA = json.BHYT_DONGIA_CHITRA,        BHYT_THANHTIEN_CHITRA = json.BHYT_THANHTIEN_CHITRA,        BENHNHAN_PHAITHANHTOAN = json.BENHNHAN_PHAITHANHTOAN,        GIATRI_HOADON = json.GIATRI_HOADON,        GIATRI_BIENLAI = json.GIATRI_BIENLAI,        DATHUCHIEN = json.DATHUCHIEN,        DICHVU_TL = json.DICHVU_TL,        BHYT_DONGIA_DONGCT_DAU = json.BHYT_DONGIA_DONGCT_DAU,        SOLONHAP_ID = json.SOLONHAP_ID,        DUOC_TYLE = json.DUOC_TYLE,        DUOC_MUCTRAN_THANHTOAN = json.DUOC_MUCTRAN_THANHTOAN,        NGAYCAPNHAT = GETDATE()        FROM OPENJSON (@jsonVienPhi)        WITH (        VIENPHI_ID int,        SOLUONG numeric(25, 4),        DONGIA_DOANHTHU numeric(25, 4),        THANHTIEN_DOANHTHU numeric(25, 4),        BHYT_TL numeric(25, 4),        BHYT_DONGIA numeric(25, 4),        BHYT_THANHTIEN numeric(25, 4),        BHYT_DONGIA_CONGKHAM_DAU numeric(25, 4),        BHYT_CONGKHAM_DAU_TYLE numeric(25, 4),        BHYT_DONGIA_CHITRA numeric(25, 4),        BHYT_THANHTIEN_CHITRA numeric(25, 4),        BENHNHAN_PHAITHANHTOAN numeric(25, 4),        GIATRI_HOADON numeric(25, 4),        GIATRI_BIENLAI numeric(25, 4),        DATHUCHIEN char(1),        KHONGTHUTIEN char(1),        BHYTDONGTIEN char(1),        DICHVU_TL numeric(25, 4),        BHYT_DONGIA_DONGCT_DAU numeric(25, 4),        SOLONHAP_ID int,        DUOC_TYLE numeric(25, 4),        DUOC_MUCTRAN_THANHTOAN numeric(25, 4))  json        WHERE TT_VIENPHI.VIENPHI_ID = json.VIENPHI_ID and json.DONGIA_DOANHTHU > 0                  insert into TT_TINH_VIENPHI_LOG        SELECT json.VIENPHI_ID, json.TIEPNHAN_ID, json.BENHAN_ID, json.SOLUONG, json.BHYT_TL, json.DONGIA_DOANHTHU,        json.THANHTIEN_DOANHTHU, json.BHYT_DONGIA, json.BHYT_THANHTIEN, json.BHYT_DONGIA_CHITRA, json.BHYT_THANHTIEN_CHITRA, json.BENHNHAN_PHAITHANHTOAN,        json.SOBHYT_HUONG_ID, json.SOBHYT, GETDATE(), -1, 'HLU01'        FROM OPENJSON(@jsonVienPhi)        WITH (        VIENPHI_ID int,        TIEPNHAN_ID int,        BENHAN_ID int,        SOLUONG numeric(25, 4),        DONGIA_DOANHTHU numeric(25, 4),        THANHTIEN_DOANHTHU numeric(25, 4),        BHYT_TL numeric(25, 4),        BHYT_DONGIA numeric(25, 4),        BHYT_THANHTIEN numeric(25, 4),        BHYT_DONGIA_CHITRA numeric(25, 4),        BHYT_THANHTIEN_CHITRA numeric(25, 4),        BENHNHAN_PHAITHANHTOAN numeric(25, 4),        SOBHYT_HUONG_ID int,        SOBHYT nvarchar(30)) json        end]
2020-02-26 15:38:34,633 [1] DEBUG - Statement Id: [DAO00067_UpdateDataVienPhiDongiaBHYT] PreparedStatement : [update TT_VIENPHI          set BHYT_DONGIA_CHITRA = 0, BHYT_THANHTIEN = 0, BHYT_THANHTIEN_CHITRA = 0          where          TIEPNHAN_ID = 107181 and BHYT_DONGIA = 0          and (BHYT_DONGIA_CHITRA > 0 or BHYT_THANHTIEN > 0 or BHYT_THANHTIEN_CHITRA > 0)]
2020-02-26 15:38:34,657 [1] DEBUG - Statement Id: [DAO00067_CapnhatDataVienphiKhiHuyThanhtoanHoadon] PreparedStatement : [update TT_VIENPHI        set TT_VIENPHI.HOADON_ID = hdct.HOADON_ID, TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN = TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN + hdct.GIATRI_BENHNHAN_DATHANHTOAN        from (select CT.HOADON_ID, CT.VIENPHI_ID, CT.GIATRI_BENHNHAN_DATHANHTOAN        from TT_HOADON_CHITIET_NGOAITRU CT        join TT_HOADON HD on HD.HOADON_ID = CT.HOADON_ID        join TT_VIENPHI vp on vp.VIENPHI_ID = ct.VIENPHI_ID        where HD.DATHANHTOAN = 1 and HD.HUYHOADON = 0 and HD.HOANTRA = 0 and vp.TIEPNHAN_ID =  @param0 ) hdct        where        TT_VIENPHI.VIENPHI_ID = hdct.VIENPHI_ID and TT_VIENPHI.HOADON_ID is null and isnull(TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN,0) = 0        and TT_VIENPHI.TIEPNHAN_ID =  @param0           update TT_VIENPHI        set TT_VIENPHI.HOADON_ID = null, TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN = TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN - hdct.GIATRI_BENHNHAN_DATHANHTOAN,        TT_VIENPHI.DATHANHTOAN = '0'        from (select CT.HOADON_ID, CT.VIENPHI_ID, CT.GIATRI_BENHNHAN_DATHANHTOAN        from TT_HOADON_CHITIET_NGOAITRU CT        join TT_HOADON HD on HD.HOADON_ID = CT.HOADON_ID        join TT_VIENPHI vp on vp.VIENPHI_ID = ct.VIENPHI_ID and vp.HOADON_ID = ct.HOADON_ID        where HD.DATHANHTOAN = 0 and (HD.HUYHOADON = 1 or HD.HOANTRA = 1) and vp.TIEPNHAN_ID =  @param0 ) hdct        where        TT_VIENPHI.VIENPHI_ID = hdct.VIENPHI_ID and TT_VIENPHI.HOADON_ID = hdct.HOADON_ID        and TT_VIENPHI.TIEPNHAN_ID =  @param0]
2020-02-26 15:38:34,657 [1] DEBUG - Statement Id: [DAO00067_CapnhatDataVienphiKhiHuyThanhtoanHoadon] Parameters: [@param0=[TIEPNHAN_ID,107181]]
2020-02-26 15:38:34,657 [1] DEBUG - Statement Id: [DAO00067_CapnhatDataVienphiKhiHuyThanhtoanHoadon] Types: [@param0=[Int64, System.Int64]]
2020-02-26 15:38:35,737 [1] DEBUG - Statement Id: [DAO00305_GetListLoaiBenhAn] PreparedStatement : [select        DICTIONARY_ID as LOAIBENHAN_ID        , DICTIONARY_NAME as TENLOAIBENHAN        , DICTIONARY_NAME_EN        , DICTIONARY_CODE        , DICTIONARY_NAME        from LST_DICTIONARY        where LST_DICTIONARY.Enabled = '1' and DICTIONARY_TYPE_CODE = 'LoaiBenhAn'        order by LST_DICTIONARY.IDX]
2020-02-26 15:38:39,767 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'IPD60'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 15:38:40,436 [1] DEBUG - Statement Id: [DAO00040_LayListToaMau] PreparedStatement : [select A.*, dc.TENDUOCDAYDU, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ld.MALOAIDUOC, dd.DICTIONARY_NAME DUONGDUNG, dc.TAMNGUNG            from TT_TOATHUOCMAU A            left join TM_DUOC dc on A.DUOC_ID = dc.DUOC_ID            left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID            left join (select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE like 'DuongDung') dd on dd.DICTIONARY_ID = dc.DUONGDUNG_ID            where (1=1)]
2020-02-26 15:38:42,285 [1] DEBUG - Statement Id: [DAO00040_LayListToaMau] PreparedStatement : [select A.*, dc.TENDUOCDAYDU, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ld.MALOAIDUOC, dd.DICTIONARY_NAME DUONGDUNG, dc.TAMNGUNG            from TT_TOATHUOCMAU A            left join TM_DUOC dc on A.DUOC_ID = dc.DUOC_ID            left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID            left join (select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE like 'DuongDung') dd on dd.DICTIONARY_ID = dc.DUONGDUNG_ID            where (1=1)]
2020-02-26 15:38:44,196 [1] DEBUG - Statement Id: [DAO00017_GetLoaiGiaByDoiTuongId] PreparedStatement : [select dtlg.DOUUTIEN, dtlg.DOITUONG_ID, lg.LOAIGIA_ID, lg.TENLOAIGIA, lg.MALOAIGIA              from TM_LOAIGIA lg              left join TM_DOITUONG_LOAIGIA dtlg              on lg.LOAIGIA_ID = dtlg.LOAIGIA_ID and dtlg.BENHVIEN_ID = 'HLU01'              where lg.TAMNGUNG = 0 and lg.BENHVIEN_ID = 'HLU01'                             order by dtlg.DOUUTIEN]
2020-02-26 15:38:44,232 [1] DEBUG - Statement Id: [DAO00063_GetListKhoThuocPhongBanPhamvi] PreparedStatement : [select distinct dpv.*        from TM_DUOC_PHAMVISD_MAPPING dmap        left join TM_DUOC_PHAMVISUDUNG dpv on dpv.PHAMVI_ID = dmap.PHAMVI_ID        where dmap.KHODUOC_ID in (select KHODUOC_ID from TM_PHONGBAN_KHODUOC where PHONGBAN_ID = '25')]
2020-02-26 15:38:44,376 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1027']
2020-02-26 15:38:44,401 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1030']
2020-02-26 15:38:44,426 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1032']
2020-02-26 15:38:44,451 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1057']
2020-02-26 15:38:44,484 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1027']
2020-02-26 15:38:44,510 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1030']
2020-02-26 15:38:44,538 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1032']
2020-02-26 15:38:44,572 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1057']
2020-02-26 15:38:44,610 [1] DEBUG - Statement Id: [DAO00063_GetListPhamviTuKhoThuocVaPhongBan] PreparedStatement : [select distinct dpv.*, dmap.KHODUOC_ID        from TM_DUOC_PHAMVISD_MAPPING dmap        left join TM_DUOC_PHAMVISUDUNG dpv on dpv.PHAMVI_ID = dmap.PHAMVI_ID and dpv.TAMNGUNG != '1'        where dmap.KHODUOC_ID in (select KHODUOC_ID from TM_PHONGBAN_KHODUOC where PHONGBAN_ID = '25')        and dmap.KHODUOC_ID = '29' and dpv.MAPHAMVI is not null]
2020-02-26 15:38:44,683 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 999999999 as SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        where  @param0  = 0        union all        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end        else        begin        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO        group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end]
2020-02-26 15:38:44,684 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Parameters: [@param0=[PHAMVI_ID,1027]]
2020-02-26 15:38:44,684 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Types: [@param0=[Int64, System.Int64]]
2020-02-26 15:38:44,778 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 999999999 as SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        where  @param0  = 0        union all        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end        else        begin        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO        group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end]
2020-02-26 15:38:44,778 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Parameters: [@param0=[PHAMVI_ID,1027]]
2020-02-26 15:38:44,778 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Types: [@param0=[Int64, System.Int64]]
2020-02-26 15:38:45,064 [1] DEBUG - Statement Id: [DAO00096_GetList] PreparedStatement : [select *        from TM_DUOC_THANHPHANHOATCHAT        where BENHVIEN_ID = 'HLU01']
2020-02-26 15:38:45,265 [1] DEBUG - Statement Id: [DAO00040_LayListToaMau] PreparedStatement : [select A.*, dc.TENDUOCDAYDU, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ld.MALOAIDUOC, dd.DICTIONARY_NAME DUONGDUNG, dc.TAMNGUNG            from TT_TOATHUOCMAU A            left join TM_DUOC dc on A.DUOC_ID = dc.DUOC_ID            left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID            left join (select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE like 'DuongDung') dd on dd.DICTIONARY_ID = dc.DUONGDUNG_ID            where (1=1)]
2020-02-26 15:38:47,225 [1] DEBUG - Statement Id: [DAO00063_GetListKhoThuocPhongBanPhamvi] PreparedStatement : [select distinct dpv.*        from TM_DUOC_PHAMVISD_MAPPING dmap        left join TM_DUOC_PHAMVISUDUNG dpv on dpv.PHAMVI_ID = dmap.PHAMVI_ID        where dmap.KHODUOC_ID in (select KHODUOC_ID from TM_PHONGBAN_KHODUOC where PHONGBAN_ID = '25')]
2020-02-26 15:38:47,250 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1027']
2020-02-26 15:38:47,274 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1030']
2020-02-26 15:38:47,298 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1032']
2020-02-26 15:38:47,321 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1057']
2020-02-26 15:38:47,353 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1027']
2020-02-26 15:38:47,377 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1030']
2020-02-26 15:38:47,401 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1032']
2020-02-26 15:38:47,425 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1057']
2020-02-26 15:38:47,448 [1] DEBUG - Statement Id: [DAO00063_GetListPhamviTuKhoThuocVaPhongBan] PreparedStatement : [select distinct dpv.*, dmap.KHODUOC_ID        from TM_DUOC_PHAMVISD_MAPPING dmap        left join TM_DUOC_PHAMVISUDUNG dpv on dpv.PHAMVI_ID = dmap.PHAMVI_ID and dpv.TAMNGUNG != '1'        where dmap.KHODUOC_ID in (select KHODUOC_ID from TM_PHONGBAN_KHODUOC where PHONGBAN_ID = '25')        and dmap.KHODUOC_ID = '29' and dpv.MAPHAMVI is not null]
2020-02-26 15:38:47,497 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 999999999 as SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        where  @param0  = 0        union all        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end        else        begin        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO        group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end]
2020-02-26 15:38:47,498 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Parameters: [@param0=[PHAMVI_ID,1027]]
2020-02-26 15:38:47,498 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Types: [@param0=[Int64, System.Int64]]
2020-02-26 15:38:47,773 [1] DEBUG - Statement Id: [DAO00063_Getlist_Thuoc_Tamngung] PreparedStatement : [select DUOC_ID FROM TM_DUOC where TAMNGUNG = '1']
2020-02-26 15:38:47,808 [1] DEBUG - Statement Id: [DAO00061_GetLuuTruIDByBenhAnID] PreparedStatement : [select lt.LUUTRU_ID, ba.BACSIDIEUTRI_ID as BACSIDIEUTRICHINH_ID        from TT_NOITRU_LUUTRU lt        left join TT_NOITRU_BENHAN ba on lt.BENHAN_ID = ba.BENHAN_ID        where lt.BENHAN_ID = '24642']
2020-02-26 15:38:47,841 [1] DEBUG - Statement Id: [DAO00061_GetChanDoanBenhAnID] PreparedStatement : [DECLARE @ICDPHU NVARCHAR(2000)=''        DECLARE @LISTICDPHU NVARCHAR(200)        DECLARE @CHANDOANRAVIEN NVARCHAR(500)        DECLARE @LISTICDPHUVAOKHOA NVARCHAR(50)        DECLARE @ICDPHUVAOKHOA NVARCHAR(500)=''        DECLARE @ICDKHAMBENH NVARCHAR(500) = (SELECT ICD.TENICD + '('+ISNULL(ICD.MAICD,'')+')'        FROM TT_NOITRU_BENHAN BA INNER JOIN TM_ICD ICD        ON BA.ICD_KHAMBENH = ICD.ICD_ID WHERE BA.BENHAN_ID =  @param0 )        DECLARE @ICDCHINH NVARCHAR(500) = (SELECT ICD.TENICD + '('+ISNULL(ICD.MAICD,'')+')'        FROM TT_NOITRU_BENHAN BA INNER JOIN TM_ICD ICD        ON BA.ICD_BENHCHINH = ICD.ICD_ID WHERE BA.BENHAN_ID =  @param0 )        SELECT @CHANDOANRAVIEN = BA.CHANDOANRAVIEN, @LISTICDPHU = BA.ICD_BENHPHU, @LISTICDPHUVAOKHOA = BA.ICD_PHU_VAOKHOA        FROM TT_NOITRU_BENHAN BA WHERE BA.BENHAN_ID =  @param0         SELECT @ICDPHU = @ICDPHU + ISNULL(TENICD, '') +'(' +ISNULL(MAICD,'')+ '); ' FROM TM_ICD WHERE MAICD IN (SELECT S FROM SplitString(@LISTICDPHU,';'))        SELECT @ICDPHUVAOKHOA = @ICDPHUVAOKHOA + ISNULL(TENICD, '') +'(' +ISNULL(MAICD,'')+ '); ' FROM TM_ICD WHERE MAICD IN (SELECT S FROM SplitString(@LISTICDPHUVAOKHOA,';'))        SELECT ICD_KHAMBENH, CHANDOANKHAMBENH, CHANDOANVAOKHOA, CHANDOANRAVIEN, CHANDOANKHAC                , CASE        WHEN LEN(ISNULL(BA.CDRAVIEN_PHU,'')) > 0 AND LEN(ISNULL(BA.CDRAVIEN_CHINH,'')) > 0 THEN ISNULL(BA.CDRAVIEN_CHINH,'') + '; ' + ISNULL(BA.CDRAVIEN_PHU,'')        WHEN LEN(ISNULL(BA.CDRAVIEN_PHU,'')) > 0 AND LEN(ISNULL(BA.CDRAVIEN_CHINH,'')) <= 0  THEN BA.CDRAVIEN_PHU        WHEN LEN(ISNULL(BA.CDRAVIEN_PHU,'')) <= 0 AND LEN(ISNULL(BA.CDRAVIEN_CHINH,'')) > 0 THEN BA.CDRAVIEN_CHINH        ELSE NULL END AS CHANDOANNOITRU        ,CASE WHEN @ICDKHAMBENH IS NULL AND (@CHANDOANRAVIEN IS NULL OR @CHANDOANRAVIEN = '') THEN ''        ELSE ISNULL(@ICDKHAMBENH, '') + '; ' + ISNULL(@CHANDOANRAVIEN, '') END        AS CHANDOANCAPCUU        , @ICDPHUVAOKHOA AS CHANDOANPHUVAOKHOA        FROM TT_NOITRU_BENHAN BA LEFT JOIN TM_ICD ICD ON BA.ICD_KHAMBENH = ICD.ICD_ID        WHERE BENHAN_ID =  @param0]
2020-02-26 15:38:47,841 [1] DEBUG - Statement Id: [DAO00061_GetChanDoanBenhAnID] Parameters: [@param0=[BENHAN_ID,24642]]
2020-02-26 15:38:47,841 [1] DEBUG - Statement Id: [DAO00061_GetChanDoanBenhAnID] Types: [@param0=[Int64, System.Int64]]
2020-02-26 15:38:47,904 [1] DEBUG - Statement Id: [DAO00000_GetDoiTuongIsBHYT] PreparedStatement : [select * from TM_DOITUONG Where DOITUONG_ID = 4 and MADOITUONG like '%BHYT%']
2020-02-26 15:38:47,988 [1] DEBUG - Statement Id: [DAO00068_GetLastedSinhHieuInfo] PreparedStatement : [select top (1) *, CHISOBMI as BMI              from TT_NGOAITRU_KHAMBENH_SINHHIEU              where BENHNHAN_ID = '20633'              order by KHAMBENH_SINHHIEU_ID desc]
2020-02-26 15:38:48,015 [1] DEBUG - Statement Id: [DAO00013_GetTienSuBenh] PreparedStatement : [select TIENSUBENH, TIENSUDIUNG        from TT_BENHNHAN        where TT_BENHNHAN.BENHNHAN_ID  = '20633']
2020-02-26 15:38:48,142 [1] DEBUG - Statement Id: [DAO00095_GetTTDiUngThuoc] PreparedStatement : [select *              from TT_BENHNHAN_DIUNG_THUOC              where BENHNHAN_ID = '20633'              and BENHVIEN_ID = 'HLU01']
2020-02-26 15:38:48,170 [1] DEBUG - Statement Id: [DAO00062_GetKhamBenhByTiepNhanID] PreparedStatement : [select *        from TT_NOITRU_KHAMBENH        where BENHAN_ID in        (select BENHAN_ID from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '107181')        and ISYLENHVTYT = '0'         and           BENHAN_ID = '24642'                 order by THOIGIANKHAM desc]
2020-02-26 15:38:48,200 [1] DEBUG - Statement Id: [DAO00063_GetTrangThaiYLenhTheoTiepnhanId] PreparedStatement : [select tt.CHUNGTU_ID, tt.PHIEULINH_ID, tt.TRANGTHAI, pl.DUYET as DUYETPHIEULINH,        ct.CHUNGTU_ID as CHUNGTUXUATNOIBO_ID, ct.LOAICHUNGTU, tt.KHAMBENH_ID, tt.DUOC_ID, tt.SOLUONG        from TT_NOITRU_TOATHUOC tt        left join TT_DUOC_PHIEULINH pl on tt.PHIEULINH_ID = pl.CHUNGTU_ID        left join TT_DUOC_CHUNGTU ct on pl.CHUNGTU_ID = ct.PHIEULINH_ID        where tt.TIEPNHAN_ID = '107181'        and (tt.PHIEULINH_ID is not null or tt.CHUNGTU_ID is not null or (tt.TRANGTHAI = 'DADUYET'))        order by tt.CHUNGTU_ID DESC]
2020-02-26 15:38:48,228 [1] DEBUG - Statement Id: [DAO00063_GetDanhsachTrathuocTheoBenhanId] PreparedStatement : [select A.KHAMBENH_ID, B.TOATHUOC_ID, B.DUOC_ID, SUM(B.SOLUONG) SOLUONG        from TT_NOITRU_TRATHUOC A        left join TT_NOITRU_TRATHUOC_CHITIET B on A.TRATHUOC_ID = B.TRATHUOC_ID        where A.BENHAN_ID = '24642'         group by A.KHAMBENH_ID, B.TOATHUOC_ID, B.DUOC_ID]
2020-02-26 15:38:48,286 [1] DEBUG - Statement Id: [DAO00014_GetInPatientStatus] PreparedStatement : [select TRANGTHAI, isnull(KHOACHUYENDEN_ID, KHOAVAO_ID) as KHOAHIENTAI from TT_NOITRU_BENHAN        where        TIEPNHAN_ID = '107181'        and BENHVIEN_ID = 'HLU01'         and           BENHAN_ID = '24642']
2020-02-26 15:39:10,349 [1] DEBUG - Statement Id: [DAO00030_Get_DuocCanhBaoICD_ByBenhAn_ID] PreparedStatement : [select A.*          from TM_DUOC_CANHBAO_ICD A          inner join TM_DUOC_HOATCHAT B on B.HOATCHAT_ID = A.HOATCHAT_ID          inner join TM_DUOC_THANHPHANHOATCHAT C on C.HOATCHAT_ID = B.HOATCHAT_ID          inner join TM_DUOC D on D.DUOC_ID = C.DUOC_ID          inner join TT_NOITRU_BENHAN BA on (BA.ICD_VAOKHOA = A.ICD_ID or BA.ICD_KHAMBENH = A.ICD_ID or BA.ICD_BENHCHINH = A.ICD_ID or BA.ICDRAVIEN_CHINH = A.ICD_ID          or A.MAICD in (select part from fnSplit(BA.ICD_BENHPHU, ';'))           or A.MAICD in (select part from fnSplit(BA.ICDRAVIEN_PHU, ';'))          or A.MAICD in (select part from fnSplit(BA.ICD_PHU_VAOKHOA, ';'))) and BA.BENHAN_ID = 24642          where C.DUOC_ID = 1030          and A.TAMNGUNG = '0'          and A.BENHVIEN_ID = 'HLU01']
2020-02-26 15:39:10,384 [1] DEBUG - Statement Id: [DAO00013_GetTienSuBenh] PreparedStatement : [select TIENSUBENH, TIENSUDIUNG        from TT_BENHNHAN        where TT_BENHNHAN.BENHNHAN_ID  = '20633']
2020-02-26 15:39:10,414 [1] DEBUG - Statement Id: [DAO00095_GetTTDiUngThuoc] PreparedStatement : [select *              from TT_BENHNHAN_DIUNG_THUOC              where BENHNHAN_ID = '20633'              and BENHVIEN_ID = 'HLU01']
2020-02-26 15:39:10,440 [1] DEBUG - Statement Id: [DAO00096_GetList] PreparedStatement : [select *        from TM_DUOC_THANHPHANHOATCHAT        where BENHVIEN_ID = 'HLU01']
2020-02-26 15:39:10,624 [1] DEBUG - Statement Id: [DAO00013_GetTienSuBenh] PreparedStatement : [select TIENSUBENH, TIENSUDIUNG        from TT_BENHNHAN        where TT_BENHNHAN.BENHNHAN_ID  = '20633']
2020-02-26 15:39:10,784 [1] DEBUG - Statement Id: [DAO00095_GetTTDiUngThuoc] PreparedStatement : [select *              from TT_BENHNHAN_DIUNG_THUOC              where BENHNHAN_ID = '20633'              and BENHVIEN_ID = 'HLU01']
2020-02-26 15:39:10,813 [1] DEBUG - Statement Id: [DAO00016_GetTTDuocCanhBao] PreparedStatement : [select *        from TM_DUOC_CANHBAO         where                 DUOC_ID = '1030'             and               BENHVIEN_ID = 'HLU01'                     order by DUOC_CANHBAO_ID]
2020-02-26 15:39:14,328 [1] DEBUG - Statement Id: [DAO00000_GetCHECK_DOITUONG_BHYT] PreparedStatement : [select count(*) as DOITUONG_BHYT FROM TM_DOITUONG A            WHERE A.DOITUONG_ID = '4' and A.BENHVIEN_ID = 'HLU01' and MADOITUONG like '%BHYT%']
2020-02-26 15:39:18,381 [1] DEBUG - Statement Id: [DAO00000_GetLOAIGIATHUOC_NOI_NGOAI_VIEN] PreparedStatement : [SELECT LOAIGIA_ID              FROM TM_LOAIGIA              WHERE MALOAIGIA = 'GiaThuoc_NoiVien' and BENHVIEN_ID = 'HLU01']
2020-02-26 15:39:18,528 [1] DEBUG - Statement Id: [DAO00000_GetDUOC_DONGIADOANHTHU_NOIVIEN] PreparedStatement : [declare @doanhthuKhongHT numeric(24,2);          declare @doanhthu numeric(24,2);          declare @hotro numeric(24,2);          declare @bhyt char(1);          declare @loaigia_id int, @loaigiakhonght_id int            select top 1 @doanhthuKhongHT = dg.DONGIA, @loaigiakhonght_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0 and GIAHOTRO != '1'          order by dtlg.DOUUTIEN asc          select top 1 @doanhthu = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0           order by dtlg.DOUUTIEN asc          select top 1 @hotro = dg.DONGIA, @loaigia_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0  and GIAHOTRO = '1'          order by dtlg.DOUUTIEN asc          select top 1 @bhyt = BHYT from TM_DUOC where DUOC_ID = 1030          select ISNULL(@doanhthu,0.0) DONGIA_DOANHTHU, ISNULL(@hotro, 0.0) DONGIA_KHAC, ISNULL(@doanhthuKhongHT, 0.0) DONGIA_KHONGHT, isnull(@bhyt, '0') BHYT, ISNULL(@loaigia_id, 0) as LOAIGIA_ID, ISNULL(@loaigiakhonght_id, 0) as LOAIGIAKHONGHT_ID]
2020-02-26 15:39:28,034 [1] DEBUG - Statement Id: [DAO00000_GetDuocBHYT] PreparedStatement : [select count(*) BHYT FROM TM_DUOC A WHERE A.DUOC_ID = '1030' and BHYT = '1']
2020-02-26 15:39:33,682 [1] DEBUG - Statement Id: [DAO00000_GetCHECK_DOITUONG_BHYT] PreparedStatement : [select count(*) as DOITUONG_BHYT FROM TM_DOITUONG A            WHERE A.DOITUONG_ID = '4' and A.BENHVIEN_ID = 'HLU01' and MADOITUONG like '%BHYT%']
2020-02-26 15:39:33,707 [1] DEBUG - Statement Id: [DAO00000_GetLOAIGIATHUOC_NOI_NGOAI_VIEN] PreparedStatement : [SELECT LOAIGIA_ID              FROM TM_LOAIGIA              WHERE MALOAIGIA = 'GiaThuoc_NoiVien' and BENHVIEN_ID = 'HLU01']
2020-02-26 15:39:35,664 [1] DEBUG - Statement Id: [DAO00000_GetDUOC_DONGIADOANHTHU_NOIVIEN] PreparedStatement : [declare @doanhthuKhongHT numeric(24,2);          declare @doanhthu numeric(24,2);          declare @hotro numeric(24,2);          declare @bhyt char(1);          declare @loaigia_id int, @loaigiakhonght_id int            select top 1 @doanhthuKhongHT = dg.DONGIA, @loaigiakhonght_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0 and GIAHOTRO != '1'          order by dtlg.DOUUTIEN asc          select top 1 @doanhthu = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0           order by dtlg.DOUUTIEN asc          select top 1 @hotro = dg.DONGIA, @loaigia_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0  and GIAHOTRO = '1'          order by dtlg.DOUUTIEN asc          select top 1 @bhyt = BHYT from TM_DUOC where DUOC_ID = 1030          select ISNULL(@doanhthu,0.0) DONGIA_DOANHTHU, ISNULL(@hotro, 0.0) DONGIA_KHAC, ISNULL(@doanhthuKhongHT, 0.0) DONGIA_KHONGHT, isnull(@bhyt, '0') BHYT, ISNULL(@loaigia_id, 0) as LOAIGIA_ID, ISNULL(@loaigiakhonght_id, 0) as LOAIGIAKHONGHT_ID]
2020-02-26 15:39:36,907 [1] DEBUG - Statement Id: [DAO00000_GetDuocBHYT] PreparedStatement : [select count(*) BHYT FROM TM_DUOC A WHERE A.DUOC_ID = '1030' and BHYT = '1']
2020-02-26 15:39:46,885 [1] DEBUG - Statement Id: [DAO00030_Get_DuocCanhBaoICD_ByBenhAn_ID] PreparedStatement : [select A.*          from TM_DUOC_CANHBAO_ICD A          inner join TM_DUOC_HOATCHAT B on B.HOATCHAT_ID = A.HOATCHAT_ID          inner join TM_DUOC_THANHPHANHOATCHAT C on C.HOATCHAT_ID = B.HOATCHAT_ID          inner join TM_DUOC D on D.DUOC_ID = C.DUOC_ID          inner join TT_NOITRU_BENHAN BA on (BA.ICD_VAOKHOA = A.ICD_ID or BA.ICD_KHAMBENH = A.ICD_ID or BA.ICD_BENHCHINH = A.ICD_ID or BA.ICDRAVIEN_CHINH = A.ICD_ID          or A.MAICD in (select part from fnSplit(BA.ICD_BENHPHU, ';'))           or A.MAICD in (select part from fnSplit(BA.ICDRAVIEN_PHU, ';'))          or A.MAICD in (select part from fnSplit(BA.ICD_PHU_VAOKHOA, ';'))) and BA.BENHAN_ID = 24642          where C.DUOC_ID = 1030          and A.TAMNGUNG = '0'          and A.BENHVIEN_ID = 'HLU01']
2020-02-26 15:39:46,940 [1] DEBUG - Statement Id: [DAO00013_GetTienSuBenh] PreparedStatement : [select TIENSUBENH, TIENSUDIUNG        from TT_BENHNHAN        where TT_BENHNHAN.BENHNHAN_ID  = '20633']
2020-02-26 15:39:46,973 [1] DEBUG - Statement Id: [DAO00095_GetTTDiUngThuoc] PreparedStatement : [select *              from TT_BENHNHAN_DIUNG_THUOC              where BENHNHAN_ID = '20633'              and BENHVIEN_ID = 'HLU01']
2020-02-26 15:39:47,012 [1] DEBUG - Statement Id: [DAO00096_GetList] PreparedStatement : [select *        from TM_DUOC_THANHPHANHOATCHAT        where BENHVIEN_ID = 'HLU01']
2020-02-26 15:39:47,055 [1] DEBUG - Statement Id: [DAO00013_GetTienSuBenh] PreparedStatement : [select TIENSUBENH, TIENSUDIUNG        from TT_BENHNHAN        where TT_BENHNHAN.BENHNHAN_ID  = '20633']
2020-02-26 15:39:47,093 [1] DEBUG - Statement Id: [DAO00095_GetTTDiUngThuoc] PreparedStatement : [select *              from TT_BENHNHAN_DIUNG_THUOC              where BENHNHAN_ID = '20633'              and BENHVIEN_ID = 'HLU01']
2020-02-26 15:39:47,131 [1] DEBUG - Statement Id: [DAO00016_GetTTDuocCanhBao] PreparedStatement : [select *        from TM_DUOC_CANHBAO         where                 DUOC_ID = '1030'             and               BENHVIEN_ID = 'HLU01'                     order by DUOC_CANHBAO_ID]
2020-02-26 15:39:49,878 [1] DEBUG - Statement Id: [DAO00000_GetCHECK_DOITUONG_BHYT] PreparedStatement : [select count(*) as DOITUONG_BHYT FROM TM_DOITUONG A            WHERE A.DOITUONG_ID = '4' and A.BENHVIEN_ID = 'HLU01' and MADOITUONG like '%BHYT%']
2020-02-26 15:39:49,918 [1] DEBUG - Statement Id: [DAO00000_GetLOAIGIATHUOC_NOI_NGOAI_VIEN] PreparedStatement : [SELECT LOAIGIA_ID              FROM TM_LOAIGIA              WHERE MALOAIGIA = 'GiaThuoc_NoiVien' and BENHVIEN_ID = 'HLU01']
2020-02-26 15:39:51,127 [1] DEBUG - Statement Id: [DAO00000_GetDUOC_DONGIADOANHTHU_NOIVIEN] PreparedStatement : [declare @doanhthuKhongHT numeric(24,2);          declare @doanhthu numeric(24,2);          declare @hotro numeric(24,2);          declare @bhyt char(1);          declare @loaigia_id int, @loaigiakhonght_id int            select top 1 @doanhthuKhongHT = dg.DONGIA, @loaigiakhonght_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0 and GIAHOTRO != '1'          order by dtlg.DOUUTIEN asc          select top 1 @doanhthu = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0           order by dtlg.DOUUTIEN asc          select top 1 @hotro = dg.DONGIA, @loaigia_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0  and GIAHOTRO = '1'          order by dtlg.DOUUTIEN asc          select top 1 @bhyt = BHYT from TM_DUOC where DUOC_ID = 1030          select ISNULL(@doanhthu,0.0) DONGIA_DOANHTHU, ISNULL(@hotro, 0.0) DONGIA_KHAC, ISNULL(@doanhthuKhongHT, 0.0) DONGIA_KHONGHT, isnull(@bhyt, '0') BHYT, ISNULL(@loaigia_id, 0) as LOAIGIA_ID, ISNULL(@loaigiakhonght_id, 0) as LOAIGIAKHONGHT_ID]
2020-02-26 15:39:52,148 [1] DEBUG - Statement Id: [DAO00000_GetDuocBHYT] PreparedStatement : [select count(*) BHYT FROM TM_DUOC A WHERE A.DUOC_ID = '1030' and BHYT = '1']
2020-02-26 15:39:53,262 [1] DEBUG - Statement Id: [DAO00000_GetCHECK_DOITUONG_BHYT] PreparedStatement : [select count(*) as DOITUONG_BHYT FROM TM_DOITUONG A            WHERE A.DOITUONG_ID = '4' and A.BENHVIEN_ID = 'HLU01' and MADOITUONG like '%BHYT%']
2020-02-26 15:39:53,295 [1] DEBUG - Statement Id: [DAO00000_GetLOAIGIATHUOC_NOI_NGOAI_VIEN] PreparedStatement : [SELECT LOAIGIA_ID              FROM TM_LOAIGIA              WHERE MALOAIGIA = 'GiaThuoc_NoiVien' and BENHVIEN_ID = 'HLU01']
2020-02-26 15:39:54,307 [1] DEBUG - Statement Id: [DAO00000_GetDUOC_DONGIADOANHTHU_NOIVIEN] PreparedStatement : [declare @doanhthuKhongHT numeric(24,2);          declare @doanhthu numeric(24,2);          declare @hotro numeric(24,2);          declare @bhyt char(1);          declare @loaigia_id int, @loaigiakhonght_id int            select top 1 @doanhthuKhongHT = dg.DONGIA, @loaigiakhonght_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0 and GIAHOTRO != '1'          order by dtlg.DOUUTIEN asc          select top 1 @doanhthu = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0           order by dtlg.DOUUTIEN asc          select top 1 @hotro = dg.DONGIA, @loaigia_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0  and GIAHOTRO = '1'          order by dtlg.DOUUTIEN asc          select top 1 @bhyt = BHYT from TM_DUOC where DUOC_ID = 1030          select ISNULL(@doanhthu,0.0) DONGIA_DOANHTHU, ISNULL(@hotro, 0.0) DONGIA_KHAC, ISNULL(@doanhthuKhongHT, 0.0) DONGIA_KHONGHT, isnull(@bhyt, '0') BHYT, ISNULL(@loaigia_id, 0) as LOAIGIA_ID, ISNULL(@loaigiakhonght_id, 0) as LOAIGIAKHONGHT_ID]
2020-02-26 15:39:55,422 [1] DEBUG - Statement Id: [DAO00000_GetDuocBHYT] PreparedStatement : [select count(*) BHYT FROM TM_DUOC A WHERE A.DUOC_ID = '1030' and BHYT = '1']
2020-02-26 15:40:03,152 [1] DEBUG - Statement Id: [DAO00062_GetThongTinNhapVienCuaBenhNhan] PreparedStatement : [select top 1 ba.THOIGIANVAOKHOA THOIGIANVAO        from TT_NOITRU_BENHAN ba        where ba.BENHAN_ID =  @param0]
2020-02-26 15:40:03,152 [1] DEBUG - Statement Id: [DAO00062_GetThongTinNhapVienCuaBenhNhan] Parameters: [@param0=[BENHAN_ID,24642]]
2020-02-26 15:40:03,152 [1] DEBUG - Statement Id: [DAO00062_GetThongTinNhapVienCuaBenhNhan] Types: [@param0=[Int64, System.Int64]]
2020-02-26 15:40:03,186 [1] DEBUG - Statement Id: [DAO00014_GetInPatientStatus] PreparedStatement : [select TRANGTHAI, isnull(KHOACHUYENDEN_ID, KHOAVAO_ID) as KHOAHIENTAI from TT_NOITRU_BENHAN        where        TIEPNHAN_ID = '107181'        and BENHVIEN_ID = 'HLU01'         and           BENHAN_ID = '24642']
2020-02-26 15:40:12,056 [1] DEBUG - Statement Id: [DAO00000_GetCHECK_DOITUONG_BHYT] PreparedStatement : [select count(*) as DOITUONG_BHYT FROM TM_DOITUONG A            WHERE A.DOITUONG_ID = '4' and A.BENHVIEN_ID = 'HLU01' and MADOITUONG like '%BHYT%']
2020-02-26 15:40:12,185 [1] DEBUG - Statement Id: [DAO00000_GetLOAIGIATHUOC_NOI_NGOAI_VIEN] PreparedStatement : [SELECT LOAIGIA_ID              FROM TM_LOAIGIA              WHERE MALOAIGIA = 'GiaThuoc_NoiVien' and BENHVIEN_ID = 'HLU01']
2020-02-26 15:40:21,827 [1] DEBUG - Statement Id: [DAO00000_GetDUOC_DONGIADOANHTHU_NOIVIEN] PreparedStatement : [declare @doanhthuKhongHT numeric(24,2);          declare @doanhthu numeric(24,2);          declare @hotro numeric(24,2);          declare @bhyt char(1);          declare @loaigia_id int, @loaigiakhonght_id int            select top 1 @doanhthuKhongHT = dg.DONGIA, @loaigiakhonght_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0 and GIAHOTRO != '1'          order by dtlg.DOUUTIEN asc          select top 1 @doanhthu = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0           order by dtlg.DOUUTIEN asc          select top 1 @hotro = dg.DONGIA, @loaigia_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0  and GIAHOTRO = '1'          order by dtlg.DOUUTIEN asc          select top 1 @bhyt = BHYT from TM_DUOC where DUOC_ID = 1030          select ISNULL(@doanhthu,0.0) DONGIA_DOANHTHU, ISNULL(@hotro, 0.0) DONGIA_KHAC, ISNULL(@doanhthuKhongHT, 0.0) DONGIA_KHONGHT, isnull(@bhyt, '0') BHYT, ISNULL(@loaigia_id, 0) as LOAIGIA_ID, ISNULL(@loaigiakhonght_id, 0) as LOAIGIAKHONGHT_ID]
2020-02-26 15:40:51,987 [1] DEBUG - Statement Id: [DAO00000_GetDuocBHYT] PreparedStatement : [select count(*) BHYT FROM TM_DUOC A WHERE A.DUOC_ID = '1030' and BHYT = '1']
2020-02-26 15:40:55,611 [1] DEBUG - Statement Id: [DAO00000_GetCHECK_DOITUONG_BHYT] PreparedStatement : [select count(*) as DOITUONG_BHYT FROM TM_DOITUONG A            WHERE A.DOITUONG_ID = '4' and A.BENHVIEN_ID = 'HLU01' and MADOITUONG like '%BHYT%']
2020-02-26 15:40:55,775 [1] DEBUG - Statement Id: [DAO00000_GetLOAIGIATHUOC_NOI_NGOAI_VIEN] PreparedStatement : [SELECT LOAIGIA_ID              FROM TM_LOAIGIA              WHERE MALOAIGIA = 'GiaThuoc_NoiVien' and BENHVIEN_ID = 'HLU01']
2020-02-26 15:40:57,017 [1] DEBUG - Statement Id: [DAO00000_GetDUOC_DONGIADOANHTHU_NOIVIEN] PreparedStatement : [declare @doanhthuKhongHT numeric(24,2);          declare @doanhthu numeric(24,2);          declare @hotro numeric(24,2);          declare @bhyt char(1);          declare @loaigia_id int, @loaigiakhonght_id int            select top 1 @doanhthuKhongHT = dg.DONGIA, @loaigiakhonght_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0 and GIAHOTRO != '1'          order by dtlg.DOUUTIEN asc          select top 1 @doanhthu = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0           order by dtlg.DOUUTIEN asc          select top 1 @hotro = dg.DONGIA, @loaigia_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0  and GIAHOTRO = '1'          order by dtlg.DOUUTIEN asc          select top 1 @bhyt = BHYT from TM_DUOC where DUOC_ID = 1030          select ISNULL(@doanhthu,0.0) DONGIA_DOANHTHU, ISNULL(@hotro, 0.0) DONGIA_KHAC, ISNULL(@doanhthuKhongHT, 0.0) DONGIA_KHONGHT, isnull(@bhyt, '0') BHYT, ISNULL(@loaigia_id, 0) as LOAIGIA_ID, ISNULL(@loaigiakhonght_id, 0) as LOAIGIAKHONGHT_ID]
2020-02-26 15:40:58,105 [1] DEBUG - Statement Id: [DAO00000_GetDuocBHYT] PreparedStatement : [select count(*) BHYT FROM TM_DUOC A WHERE A.DUOC_ID = '1030' and BHYT = '1']
2020-02-26 15:40:59,368 [1] DEBUG - Statement Id: [DAO00030_GetKhoDuocByPhamVi] PreparedStatement : [SELECT DISTINCT mp.KHODUOC_ID, lk.DICTIONARY_CODE as LOAIKHO          FROM TM_DUOC_PHAMVISD_MAPPING mp          INNER JOIN TM_KHODUOC kd on kd.KHODUOC_ID = mp.KHODUOC_ID          INNER JOIN LST_DICTIONARY lk on lk.DICTIONARY_ID = kd.LOAIKHO_ID          WHERE          mp.PHAMVI_ID = 1027          AND mp.BENHVIEN_ID ='HLU01'          AND mp.TAMNGUNG = '0']
2020-02-26 15:40:59,458 [1] DEBUG - Statement Id: [DAO00063_KiemtraSoluongDuocXuat] PreparedStatement : [select A.TONKHO, isnull(B.BOOK_NGOAI,0) BOOK_NGOAI, isnull(D.BOOK_NOI,0) BOOK_NOI, isnull(C.BOOK_NOI_THUOC,0) BOOK_NOI_THUOC, (A.TONKHO - isnull(B.BOOK_NGOAI,0) - isnull(D.BOOK_NOI,0)) TONKHO_BOOK        from(        select SUM(tk.SOLUONG) TONKHO, tk.DUOC_ID, sd.PHAMVI_ID, tk.NGUONDUOC_ID from TT_DUOC_TONKHO tk        inner join TM_DUOC_PHAMVISD_MAPPING sd on sd.KHODUOC_ID = tk.KHODUOC_ID        where sd.PHAMVI_ID  = '1027' and tk.DUOC_ID = '1030' and tk.NGUONDUOC_ID = '1'        group by tk.DUOC_ID, sd.PHAMVI_ID, tk.NGUONDUOC_ID) A        left join (        select SUM(SOLUONG) BOOK_NGOAI,DUOC_ID, PHAMVI_ID, NGUONHANG_ID from TT_DUOC_TONKHO_BOOK_NGOAITRU        where PHAMVI_ID  = '1027' and DUOC_ID = '1030' and NGUONHANG_ID = '1' and TRANGTHAI = 'HIEULUC'  and SOLUONG > 0        group by DUOC_ID, PHAMVI_ID, NGUONHANG_ID) B on A.DUOC_ID = B.DUOC_ID and A.PHAMVI_ID = B.PHAMVI_ID and A.NGUONDUOC_ID = B.NGUONHANG_ID        left join (        select SUM(SOLUONG) BOOK_NOI_THUOC,DUOC_ID, PHAMVI_ID, NGUONHANG_ID from TT_DUOC_TONKHO_BOOK_NOITRU        where PHAMVI_ID  = '1027' and DUOC_ID = '1030' and NGUONHANG_ID = '1' and REF_ID = '' and REF_TABLE = 'TT_NOITRU_TOATHUOC' and TRANGTHAI = 'HIEULUC' and SOLUONG > 0        group by DUOC_ID, PHAMVI_ID, NGUONHANG_ID) C on A.DUOC_ID = C.DUOC_ID and A.PHAMVI_ID = C.PHAMVI_ID and A.NGUONDUOC_ID = C.NGUONHANG_ID        left join (        select SUM(SOLUONG) BOOK_NOI,DUOC_ID, PHAMVI_ID, NGUONHANG_ID from TT_DUOC_TONKHO_BOOK_NOITRU        where PHAMVI_ID  = '1027' and DUOC_ID = '1030' and NGUONHANG_ID = '1' and TRANGTHAI = 'HIEULUC'  and SOLUONG > 0        group by DUOC_ID, PHAMVI_ID, NGUONHANG_ID) D on A.DUOC_ID = D.DUOC_ID and A.PHAMVI_ID = D.PHAMVI_ID and A.NGUONDUOC_ID = D.NGUONHANG_ID]
2020-02-26 15:40:59,492 [1] DEBUG - Statement Id: [DAO00063_KiemtraSoluongDuocXuat] PreparedStatement : [select A.TONKHO, isnull(B.BOOK_NGOAI,0) BOOK_NGOAI, isnull(D.BOOK_NOI,0) BOOK_NOI, isnull(C.BOOK_NOI_THUOC,0) BOOK_NOI_THUOC, (A.TONKHO - isnull(B.BOOK_NGOAI,0) - isnull(D.BOOK_NOI,0)) TONKHO_BOOK        from(        select SUM(tk.SOLUONG) TONKHO, tk.DUOC_ID, sd.PHAMVI_ID, tk.NGUONDUOC_ID from TT_DUOC_TONKHO tk        inner join TM_DUOC_PHAMVISD_MAPPING sd on sd.KHODUOC_ID = tk.KHODUOC_ID        where sd.PHAMVI_ID  = '1027' and tk.DUOC_ID = '1030' and tk.NGUONDUOC_ID = '1'        group by tk.DUOC_ID, sd.PHAMVI_ID, tk.NGUONDUOC_ID) A        left join (        select SUM(SOLUONG) BOOK_NGOAI,DUOC_ID, PHAMVI_ID, NGUONHANG_ID from TT_DUOC_TONKHO_BOOK_NGOAITRU        where PHAMVI_ID  = '1027' and DUOC_ID = '1030' and NGUONHANG_ID = '1' and TRANGTHAI = 'HIEULUC'  and SOLUONG > 0        group by DUOC_ID, PHAMVI_ID, NGUONHANG_ID) B on A.DUOC_ID = B.DUOC_ID and A.PHAMVI_ID = B.PHAMVI_ID and A.NGUONDUOC_ID = B.NGUONHANG_ID        left join (        select SUM(SOLUONG) BOOK_NOI_THUOC,DUOC_ID, PHAMVI_ID, NGUONHANG_ID from TT_DUOC_TONKHO_BOOK_NOITRU        where PHAMVI_ID  = '1027' and DUOC_ID = '1030' and NGUONHANG_ID = '1' and REF_ID = '' and REF_TABLE = 'TT_NOITRU_TOATHUOC' and TRANGTHAI = 'HIEULUC' and SOLUONG > 0        group by DUOC_ID, PHAMVI_ID, NGUONHANG_ID) C on A.DUOC_ID = C.DUOC_ID and A.PHAMVI_ID = C.PHAMVI_ID and A.NGUONDUOC_ID = C.NGUONHANG_ID        left join (        select SUM(SOLUONG) BOOK_NOI,DUOC_ID, PHAMVI_ID, NGUONHANG_ID from TT_DUOC_TONKHO_BOOK_NOITRU        where PHAMVI_ID  = '1027' and DUOC_ID = '1030' and NGUONHANG_ID = '1' and TRANGTHAI = 'HIEULUC'  and SOLUONG > 0        group by DUOC_ID, PHAMVI_ID, NGUONHANG_ID) D on A.DUOC_ID = D.DUOC_ID and A.PHAMVI_ID = D.PHAMVI_ID and A.NGUONDUOC_ID = D.NGUONHANG_ID]
2020-02-26 15:40:59,690 [1] DEBUG - Statement Id: [DAOLOG01_LockBegin] PreparedStatement : [INSERT into TT_LOG_UPDATE ( REF_TABLE , REF_ID , BENHVIEN_ID )         values ( @param0 ,  @param1 ,  @param2 );]
2020-02-26 15:40:59,690 [1] DEBUG - Statement Id: [DAOLOG01_LockBegin] Parameters: [@param0=[REF_TABLE,TT_NOITRU_KHAMBENH], @param1=[REF_ID,24642], @param2=[BENHVIEN_ID,HLU01]]
2020-02-26 15:40:59,690 [1] DEBUG - Statement Id: [DAOLOG01_LockBegin] Types: [@param0=[String, System.String], @param1=[Int64, System.Int64], @param2=[String, System.String]]
2020-02-26 15:40:59,739 [1] DEBUG - Statement Id: [DAO00026_GEN_EXAM_KEY] PreparedStatement : [select max(KEYVALUE) KEYVALUE              from LST_KEYDATA_TOATHUOC               where                             LST_KEYDATA_TOATHUOC.KEYTYPE = 'SOTHUTUTOA_NOITRU'                       and                           LST_KEYDATA_TOATHUOC.KEYYEAR = '2020'                       and                           LST_KEYDATA_TOATHUOC.KEYMONTH = '2'                       and                           LST_KEYDATA_TOATHUOC.KEYDAY = '26']
2020-02-26 15:40:59,863 [1] DEBUG - Statement Id: [DAO00026_Update] PreparedStatement : [IF EXISTS (select KEYTYPE from LST_KEYDATA_TOATHUOC where KEYTYPE = 'SOTHUTUTOA_NOITRU' AND KEYYEAR = '2020' AND KEYMONTH = '2' AND KEYDAY = '26')            BEGIN            update LST_KEYDATA_TOATHUOC set            KEYVALUE =  @param0             where            KEYTYPE = 'SOTHUTUTOA_NOITRU'            AND KEYYEAR = '2020'            AND KEYMONTH = '2'            AND KEYDAY = '26'            AND SEGMENT_1 = '0'            AND SEGMENT_2 = '0'            AND SEGMENT_3 = '0'            END            ELSE            BEGIN            insert into LST_KEYDATA_TOATHUOC (            KEYTYPE            , KEYYEAR            , KEYMONTH            , KEYDAY            , SEGMENT_1            , SEGMENT_2            , SEGMENT_3            , KEYVALUE            ) values (             @param1             ,  @param2             ,  @param3             ,  @param4             ,  @param5             ,  @param6             ,  @param7             ,  @param0             )            END]
2020-02-26 15:40:59,864 [1] DEBUG - Statement Id: [DAO00026_Update] Parameters: [@param0=[KEYVALUE,0002], @param1=[KEYTYPE,SOTHUTUTOA_NOITRU], @param2=[KEYYEAR,2020], @param3=[KEYMONTH,2], @param4=[KEYDAY,26], @param5=[SEGMENT_1,0], @param6=[SEGMENT_2,0], @param7=[SEGMENT_3,0]]
2020-02-26 15:40:59,864 [1] DEBUG - Statement Id: [DAO00026_Update] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[Int32, System.Int32], @param3=[Int32, System.Int32], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[String, System.String], @param7=[String, System.String]]
2020-02-26 15:41:00,043 [1] DEBUG - Statement Id: [DAO00062_Add] PreparedStatement : [insert into TT_NOITRU_KHAMBENH (        BENHAN_ID        , LUUTRU_ID        , LANKHAM        , NGAYKHAM        , THOIGIANKHAM        , BACSIKHAM_ID        , PHONGBAN_ID        , DIEUDUONG_ID        , CAPHOLY_ID        , DOITUONG_ID        , PHATDO_DIEUTRI_ID        , DINHBENH        , DIENBIEN        , LOIDAN        , CHEDOANUONG_ID        , CHEDOCHAMSOC_ID        , PHANCAPCHAMSOC_ID        , CHUNGTUPHATTHUOC_ID        , KHODUOC_ID        , NOINHANTHUOC_ID        , LOAITOATHUOC        , THUOCDACTRI        , NGAYTAIKHAM        , SONGAYHENTAIKHAM        , RAVIEN        , ISTHUOCBV              , ISYLENHVTYT        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYCAPNHAT        , NGUOICAPNHAT_ID         ,           GHICHU_KHAMBENH         ,           GHICHU         ,           CHEDODINHDUONG         ,           MATOAMAU                 ) values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31          ,            @param32          ,            @param33          ,           @param34          ,            @param35                  )]
2020-02-26 15:41:00,043 [1] DEBUG - Statement Id: [DAO00062_Add] Parameters: [@param0=[BENHAN_ID,24642], @param1=[LUUTRU_ID,39529], @param2=[LANKHAM,1], @param3=[NGAYKHAM,2/26/2020 12:00:00 AM], @param4=[THOIGIANKHAM,2/26/2020 3:38:45 PM], @param5=[BACSIKHAM_ID,1], @param6=[PHONGBAN_ID,25], @param7=[DIEUDUONG_ID,null], @param8=[CAPHOLY_ID,null], @param9=[DOITUONG_ID,4], @param10=[PHATDO_DIEUTRI_ID,null], @param11=[DINHBENH,Theo dõi thai bình thường(Z34)], @param12=[DIENBIEN,sdss], @param13=[LOIDAN,null], @param14=[CHEDOANUONG_ID,null], @param15=[CHEDOCHAMSOC_ID,null], @param16=[PHANCAPCHAMSOC_ID,8588], @param17=[CHUNGTUPHATTHUOC_ID,null], @param18=[KHODUOC_ID,null], @param19=[NOINHANTHUOC_ID,null], @param20=[LOAITOATHUOC,YL], @param21=[THUOCDACTRI,0], @param22=[NGAYTAIKHAM,null], @param23=[SONGAYHENTAIKHAM,null], @param24=[RAVIEN,0], @param25=[ISTHUOCBV,1], @param26=[ISYLENHVTYT,0], @param27=[BENHVIEN_ID,HLU01], @param28=[NGAYTAO,2/26/2020 3:41:00 PM], @param29=[NGUOITAO_ID,1], @param30=[NGAYCAPNHAT,2/26/2020 3:41:00 PM], @param31=[NGUOICAPNHAT_ID,1], @param32=[GHICHU_KHAMBENH,null], @param33=[GHICHU_DICHVU,null], @param34=[CHEDODINHDUONG,null], @param35=[MATOAMAU,null]]
2020-02-26 15:41:00,043 [1] DEBUG - Statement Id: [DAO00062_Add] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64], @param2=[Int64, System.Int64], @param3=[DateTime, System.DateTime], @param4=[DateTime, System.DateTime], @param5=[Int64, System.Int64], @param6=[String, System.String], @param7=[System.DBNull, null], @param8=[System.DBNull, null], @param9=[Int64, System.Int64], @param10=[System.DBNull, null], @param11=[String, System.String], @param12=[String, System.String], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[String, System.String], @param21=[String, System.String], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[String, System.String], @param28=[DateTime, System.DateTime], @param29=[Int64, System.Int64], @param30=[DateTime, System.DateTime], @param31=[Int64, System.Int64], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null]]
2020-02-26 15:41:00,287 [1] DEBUG - Statement Id: [DAO00062_Add.SelectKey] PreparedStatement : [SELECT @@IDENTITY as value]
2020-02-26 15:41:00,325 [1] DEBUG - Statement Id: [DAO00062_GetKhoThuocCosoKhongCoso] PreparedStatement : [select distinct kd.KHODUOC_ID, lst.DICTIONARY_CODE  LOAIKHO from TM_KHODUOC kd        left join TM_PHONGBAN_KHODUOC pbkd        on kd.KHODUOC_ID = pbkd.KHODUOC_ID        and kd.BENHVIEN_ID = pbkd.BENHVIEN_ID        left join LST_DICTIONARY lst on lst.DICTIONARY_ID = kd.LOAIKHO_ID        where lst.DICTIONARY_CODE = 'Coso']
2020-02-26 15:41:00,355 [1] DEBUG - Statement Id: [DAO00062_GetAllPhamviKhoDuoc] PreparedStatement : [select distinct dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        left join TM_DUOC_PHAMVISUDUNG dpv on dpv.PHAMVI_ID = dmap.PHAMVI_ID]
2020-02-26 15:41:00,394 [1] DEBUG - Statement Id: [DAO00023_GetSOBHYT_HUONG_ID] PreparedStatement : [select isnull(MAX(SOBHYT_HUONG_ID),0) SOBHYT_HUONG_ID        from TT_TIEPNHAN_SOTHEBHYT        where TIEPNHAN_ID = '107181']
2020-02-26 15:41:02,240 [1] DEBUG - Statement Id: [DAO00000_GetCHECK_DOITUONG_BHYT] PreparedStatement : [select count(*) as DOITUONG_BHYT FROM TM_DOITUONG A            WHERE A.DOITUONG_ID = '4' and A.BENHVIEN_ID = 'HLU01' and MADOITUONG like '%BHYT%']
2020-02-26 15:41:02,265 [1] DEBUG - Statement Id: [DAO00000_GetLOAIGIATHUOC_NOI_NGOAI_VIEN] PreparedStatement : [SELECT LOAIGIA_ID              FROM TM_LOAIGIA              WHERE MALOAIGIA = 'GiaThuoc_NoiVien' and BENHVIEN_ID = 'HLU01']
2020-02-26 15:41:03,349 [1] DEBUG - Statement Id: [DAO00000_GetDUOC_DONGIADOANHTHU_NOIVIEN] PreparedStatement : [declare @doanhthuKhongHT numeric(24,2);          declare @doanhthu numeric(24,2);          declare @hotro numeric(24,2);          declare @bhyt char(1);          declare @loaigia_id int, @loaigiakhonght_id int            select top 1 @doanhthuKhongHT = dg.DONGIA, @loaigiakhonght_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0 and GIAHOTRO != '1'          order by dtlg.DOUUTIEN asc          select top 1 @doanhthu = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0           order by dtlg.DOUUTIEN asc          select top 1 @hotro = dg.DONGIA, @loaigia_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0  and GIAHOTRO = '1'          order by dtlg.DOUUTIEN asc          select top 1 @bhyt = BHYT from TM_DUOC where DUOC_ID = 1030          select ISNULL(@doanhthu,0.0) DONGIA_DOANHTHU, ISNULL(@hotro, 0.0) DONGIA_KHAC, ISNULL(@doanhthuKhongHT, 0.0) DONGIA_KHONGHT, isnull(@bhyt, '0') BHYT, ISNULL(@loaigia_id, 0) as LOAIGIA_ID, ISNULL(@loaigiakhonght_id, 0) as LOAIGIAKHONGHT_ID]
2020-02-26 15:41:04,439 [1] DEBUG - Statement Id: [DAO00000_GetDuocBHYT] PreparedStatement : [select count(*) BHYT FROM TM_DUOC A WHERE A.DUOC_ID = '1030' and BHYT = '1']
2020-02-26 15:41:06,623 [1] DEBUG - Statement Id: [DAO00000_GetCHECK_DOITUONG_BHYT] PreparedStatement : [select count(*) as DOITUONG_BHYT FROM TM_DOITUONG A            WHERE A.DOITUONG_ID = '4' and A.BENHVIEN_ID = 'HLU01' and MADOITUONG like '%BHYT%']
2020-02-26 15:41:06,687 [1] DEBUG - Statement Id: [DAO00000_GetLOAIGIATHUOC_NOI_NGOAI_VIEN] PreparedStatement : [SELECT LOAIGIA_ID              FROM TM_LOAIGIA              WHERE MALOAIGIA = 'GiaThuoc_NoiVien' and BENHVIEN_ID = 'HLU01']
2020-02-26 15:41:07,789 [1] DEBUG - Statement Id: [DAO00000_GetDUOC_DONGIADOANHTHU_NOIVIEN] PreparedStatement : [declare @doanhthuKhongHT numeric(24,2);          declare @doanhthu numeric(24,2);          declare @hotro numeric(24,2);          declare @bhyt char(1);          declare @loaigia_id int, @loaigiakhonght_id int            select top 1 @doanhthuKhongHT = dg.DONGIA, @loaigiakhonght_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0 and GIAHOTRO != '1'          order by dtlg.DOUUTIEN asc          select top 1 @doanhthu = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0           order by dtlg.DOUUTIEN asc          select top 1 @hotro = dg.DONGIA, @loaigia_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0  and GIAHOTRO = '1'          order by dtlg.DOUUTIEN asc          select top 1 @bhyt = BHYT from TM_DUOC where DUOC_ID = 1030          select ISNULL(@doanhthu,0.0) DONGIA_DOANHTHU, ISNULL(@hotro, 0.0) DONGIA_KHAC, ISNULL(@doanhthuKhongHT, 0.0) DONGIA_KHONGHT, isnull(@bhyt, '0') BHYT, ISNULL(@loaigia_id, 0) as LOAIGIA_ID, ISNULL(@loaigiakhonght_id, 0) as LOAIGIAKHONGHT_ID]
2020-02-26 15:41:08,823 [1] DEBUG - Statement Id: [DAO00000_GetDuocBHYT] PreparedStatement : [select count(*) BHYT FROM TM_DUOC A WHERE A.DUOC_ID = '1030' and BHYT = '1']
2020-02-26 15:41:09,832 [1] DEBUG - Statement Id: [DAO00063_Add_YLenhThuoc] PreparedStatement : [declare @jsonVienPhi nvarchar(max);        set @jsonVienPhi = N'{        "DATA": [{"TRATHUOCCHITIET_ID":null,"DALAPPHIEULINH":false,"DAPHATSINHCHUNGTU":false,"DANHAPNOIBO":false,"DAXUATNOIBO":false,"UID":"704b9942-1e6f-40a1-ac57-1dbc5a90c113","TOATHUOC_ID":null,"CLSKETQUA_ID":null,"VTYT_ID":null,"SOTHUTUTOA":"2002260002","MACHUNGTU":null,"KHAMBENH_ID":320499,"TIEPNHAN_ID":107181,"BENHNHAN_ID":20633,"DUOC_ID":1030,"SOLUONG":1.0,"SONGAY":1.0,"SOLANTRENNGAY":null,"SOLUONGTRENLAN":null,"SOLUONG_BUOISANG":null,"SOLUONG_BUOITRUA":null,"SOLUONG_BUOICHIEU":null,"SOLUONG_BUOITOI":null,"DUONGDUNG_ID":911,"GHICHU":"","NGUONDUOC_ID":1,"KHOSUDUNG_ID":null,"NGUONDUOC":null,"NGUONHANG_ID":1,"PHIEULINH_ID":null,"CHUNGTU_ID":null,"CHUNGTUTONGHOP_ID":null,"PHONGBANRATOA_ID":"25","PHONGBAN_ID":null,"NGUONLAYTHUOC":"D","COSO":"0","KHOPHAT_ID":1,"PHAMVI_ID":1027,"PHATTHUOCTAIQUAY":"0","ISUPDATED":false,"THOIGIANSUDUNG":null,"NGAYSUDUNG":null,"THOIGIANKHAM":null,"SOLUONGTAMNGUNG":0.0,"MUANGOAI":"0","YEUCAU":null,"PHOIHOP":null,"PHACHE":null,"ISVTYT":false,"ISHOACHAT":false,"TINHTIEN":"0","MIENPHI":"0","TRANGTHAI":"CHUAXUAT","HUYTOATHUOC":"0","BENHVIEN_ID":"HLU01","NGAYTAO":null,"NGUOITAO_ID":1,"NGAYCAPNHAT":null,"NGUOICAPNHAT_ID":1,"BHYTDONGTIEN":"0","KHONGTHUTIEN":"0","SOCHUNGTU":null,"SOPHIEULINH":null,"MATOATHUOC":null,"LOAITOATHUOC":null,"LOAIVATTU_ID":"T","TENTOATHUOC":null,"DIENGIAI":null,"TAMNGUNG":false,"DUOC_BHYT":true,"VIENPHI":{"VIENPHI_ID":0,"TIEPNHAN_ID":107181,"BENHNHAN_ID":null,"BENHAN_ID":24642,"KHAMBENH_ID":null,"REF_ID":null,"REF_TABLE":"TT_NOITRU_TOATHUOC","DICHVU_ID":null,"DUOC_ID":1030,"LOAI_CHIPHI":"TT","LOAIGIA_ID":null,"SOLUONG":0.0,"DONGIA_DOANHTHU":600.00,"THANHTIEN_DOANHTHU":600.00,"BHYT_TL":null,"BHYT_DONGIA":600.00,"BHYT_THANHTIEN":600.00,"BHYT_DONGIA_CHITRA":600.00,"BHYT_THANHTIEN_CHITRA":600.00,"BENHNHAN_PHAITHANHTOAN":0.00,"GIATRI_HOADON":null,"GIATRI_HOADON_DATHANHTOAN":null,"GIATRI_BIENLAI":null,"GIATRI_BIENLAI_DATHANHTOAN":null,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"GIATRI_THATTHU":null,"MIENGIAM_TL":null,"MIENGIAM_GIATRI":null,"NGANSACH_TL":null,"NGANSACH_GIATRI":null,"TAITRO_TL":null,"TAITRO_GIATRI":null,"BHTN_TL":null,"BHTN_DONGIA":null,"BHTN_THANHTIEN":null,"BHTN_DONGIA_CHITRA":null,"BHTN_THANHTIEN_CHITRA":null,"DUOCPHEPTHUCHIEN":null,"HUY":false,"DATHANHTOAN":false,"DATHUCHIEN":false,"KHONGTHUTIEN":false,"BHYTDONGTIEN":false,"HOADON_ID":null,"ACTIVE":null,"BENHVIEN_ID":"HLU01","NGUOITAO_ID":null,"NGAYTAO":null,"NGUOICAPNHAT_ID":null,"NGAYCAPNHAT":null,"TREN3NAM":false,"TREN5NAM":false},"STT":1,"KHOTAO_ID":"29","DONVITINH":null,"DUONGDUNG":"Tiêm","DAXUAT":false,"DATHANHTOAN":false,"BENHAN_ID":24642,"DAHOANTRA":0,"SLDAXUAT":0.0,"SLDATAMNGUNG":0.0,"CHUNGTUTRA_ID":null,"CHUNGTUCHITIET_ID":null,"NGUOICAPNHAT":null,"BHYT_DONGIA":null,"BHYT_THANHTIEN":null,"BHYT_DONGIA_CHITRA":null,"BHYT_THANHTIEN_CHITRA":null,"DONGIA_DOANHTHU":600.0,"THANHTIEN_DOANHTHU":600.0,"BookedSoLuong":0.0,"KHODUOC_ID":1,"CHUYENKHOA_ID":"25","DOTDIEUTRI_ID":null,"DOITUONG_HUONG_ID":4,"SOBHYT_HUONG_ID":111518},{"TRATHUOCCHITIET_ID":null,"DALAPPHIEULINH":false,"DAPHATSINHCHUNGTU":false,"DANHAPNOIBO":false,"DAXUATNOIBO":false,"UID":"0463a22e-8578-44b1-ae09-2d36de3a7abb","TOATHUOC_ID":null,"CLSKETQUA_ID":null,"VTYT_ID":null,"SOTHUTUTOA":"2002260002","MACHUNGTU":null,"KHAMBENH_ID":320499,"TIEPNHAN_ID":107181,"BENHNHAN_ID":20633,"DUOC_ID":1030,"SOLUONG":1.0,"SONGAY":1.0,"SOLANTRENNGAY":null,"SOLUONGTRENLAN":null,"SOLUONG_BUOISANG":null,"SOLUONG_BUOITRUA":null,"SOLUONG_BUOICHIEU":null,"SOLUONG_BUOITOI":null,"DUONGDUNG_ID":911,"GHICHU":"","NGUONDUOC_ID":1,"KHOSUDUNG_ID":null,"NGUONDUOC":null,"NGUONHANG_ID":1,"PHIEULINH_ID":null,"CHUNGTU_ID":null,"CHUNGTUTONGHOP_ID":null,"PHONGBANRATOA_ID":"25","PHONGBAN_ID":null,"NGUONLAYTHUOC":"D","COSO":"0","KHOPHAT_ID":1,"PHAMVI_ID":1027,"PHATTHUOCTAIQUAY":"0","ISUPDATED":false,"THOIGIANSUDUNG":null,"NGAYSUDUNG":null,"THOIGIANKHAM":null,"SOLUONGTAMNGUNG":0.0,"MUANGOAI":"0","YEUCAU":null,"PHOIHOP":null,"PHACHE":null,"ISVTYT":false,"ISHOACHAT":false,"TINHTIEN":"0","MIENPHI":"0","TRANGTHAI":"CHUAXUAT","HUYTOATHUOC":"0","BENHVIEN_ID":"HLU01","NGAYTAO":null,"NGUOITAO_ID":1,"NGAYCAPNHAT":null,"NGUOICAPNHAT_ID":1,"BHYTDONGTIEN":"1","KHONGTHUTIEN":"0","SOCHUNGTU":null,"SOPHIEULINH":null,"MATOATHUOC":null,"LOAITOATHUOC":null,"LOAIVATTU_ID":"T","TENTOATHUOC":null,"DIENGIAI":null,"TAMNGUNG":false,"DUOC_BHYT":true,"VIENPHI":{"VIENPHI_ID":0,"TIEPNHAN_ID":107181,"BENHNHAN_ID":null,"BENHAN_ID":24642,"KHAMBENH_ID":null,"REF_ID":null,"REF_TABLE":"TT_NOITRU_TOATHUOC","DICHVU_ID":null,"DUOC_ID":1030,"LOAI_CHIPHI":"TT","LOAIGIA_ID":null,"SOLUONG":0.0,"DONGIA_DOANHTHU":1000.00,"THANHTIEN_DOANHTHU":1000.00,"BHYT_TL":null,"BHYT_DONGIA":0,"BHYT_THANHTIEN":0,"BHYT_DONGIA_CHITRA":0,"BHYT_THANHTIEN_CHITRA":0,"BENHNHAN_PHAITHANHTOAN":1000.00,"GIATRI_HOADON":null,"GIATRI_HOADON_DATHANHTOAN":null,"GIATRI_BIENLAI":null,"GIATRI_BIENLAI_DATHANHTOAN":null,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"GIATRI_THATTHU":null,"MIENGIAM_TL":null,"MIENGIAM_GIATRI":null,"NGANSACH_TL":null,"NGANSACH_GIATRI":null,"TAITRO_TL":null,"TAITRO_GIATRI":null,"BHTN_TL":null,"BHTN_DONGIA":null,"BHTN_THANHTIEN":null,"BHTN_DONGIA_CHITRA":null,"BHTN_THANHTIEN_CHITRA":null,"DUOCPHEPTHUCHIEN":null,"HUY":false,"DATHANHTOAN":false,"DATHUCHIEN":false,"KHONGTHUTIEN":false,"BHYTDONGTIEN":true,"HOADON_ID":null,"ACTIVE":null,"BENHVIEN_ID":"HLU01","NGUOITAO_ID":null,"NGAYTAO":null,"NGUOICAPNHAT_ID":null,"NGAYCAPNHAT":null,"TREN3NAM":false,"TREN5NAM":false},"STT":2,"KHOTAO_ID":"29","DONVITINH":null,"DUONGDUNG":"Tiêm","DAXUAT":false,"DATHANHTOAN":false,"BENHAN_ID":24642,"DAHOANTRA":0,"SLDAXUAT":0.0,"SLDATAMNGUNG":0.0,"CHUNGTUTRA_ID":null,"CHUNGTUCHITIET_ID":null,"NGUOICAPNHAT":null,"BHYT_DONGIA":null,"BHYT_THANHTIEN":null,"BHYT_DONGIA_CHITRA":null,"BHYT_THANHTIEN_CHITRA":null,"DONGIA_DOANHTHU":600.0,"THANHTIEN_DOANHTHU":600.0,"BookedSoLuong":0.0,"KHODUOC_ID":1,"CHUYENKHOA_ID":"25","DOTDIEUTRI_ID":null,"DOITUONG_HUONG_ID":4,"SOBHYT_HUONG_ID":111518}]        }';          declare @TOATHUOC_ID int;        declare @SOTHUTUTOA varchar(10);        declare @KHAMBENH_ID int;        declare @TIEPNHAN_ID int;        declare @BENHNHAN_ID int;        declare @NGUONDUOC_ID int;        declare @DUOC_ID int;        declare @SOLUONG numeric(18, 4);        declare @SONGAY numeric(4, 2);        declare @SOLANTRENNGAY numeric(4, 2);        declare @SOLUONGTRENLAN numeric(18, 4);        declare @SOLUONG_BUOISANG numeric(18, 4);        declare @SOLUONG_BUOITRUA numeric(18, 4);        declare @SOLUONG_BUOICHIEU numeric(18, 4);        declare @SOLUONG_BUOITOI numeric(18, 4);        declare @DUONGDUNG_ID int;        declare @COSO char(1);        declare @KHOTAO_ID int;        declare @KHOPHAT_ID int;        declare @GHICHU nvarchar(max);        declare @PHIEULINH_ID int;        declare @CHUNGTU_ID int;        declare @PHONGBANRATOA_ID int;        declare @NGUONLAYTHUOC char(1);        declare @VTYT char(1);        declare @PHATTHUOCTAIQUAY char(1);        declare @MUANGOAI char(1);        declare @TINHTIEN char(1);        declare @MIENPHI char(1);        declare @BHYTDONGTIEN char(1);        declare @KHONGTHUTIEN char(1);        declare @HUYTOATHUOC char(1);        declare @TRANGTHAI varchar(20);        declare @BENHVIEN_ID varchar(10);        declare @NGAYTAO datetime;        declare @NGUOITAO_ID int;        declare @NGAYCAPNHAT datetime;        declare @NGUOICAPNHAT_ID int;        declare @PHAMVI_ID int;        declare @CHEDODINHDUONG nvarchar(max);          declare @VIENPHI nvarchar(max);        declare @BENHAN_ID int =  @param0 ;        declare @DOTDIEUTRI_ID int;        declare @DONGIA_DOANHTHU numeric(25, 4);        declare @THANHTIEN_DOANHTHU numeric(25, 4);        declare @BHYT_DONGIA numeric(25, 4);        declare @BHYT_THANHTIEN numeric(25, 4);        declare @BHYT_DONGIA_CHITRA numeric(25, 4);        declare @BHYT_THANHTIEN_CHITRA numeric(25, 4);        declare @BENHNHAN_PHAITHANHTOAN numeric(25, 4);        declare @DOITUONG_HUONG_ID numeric(25, 4);        declare @SOBHYT_HUONG_ID numeric(25, 4);          declare @iTotal int =  @param1 ;        declare @icnt int = 0;        WHILE @iTotal > @icnt        BEGIN        declare @dyn_sql nvarchar(1000) = 'select @data = json_query(@json_dyn, ''' + CHAR(36) +'.DATA[' + cast(@icnt as varchar(10)) + ']'');'        declare @jsondatamax nvarchar(max);          exec sp_executesql @dyn_sql        , N'@json_dyn nvarchar(max), @data nvarchar(max) OUTPUT'        , @json_dyn = @jsonVienPhi        , @data = @jsondatamax OUTPUT          select        @SOTHUTUTOA =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.SOTHUTUTOA'),        @KHAMBENH_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.KHAMBENH_ID'),        @TIEPNHAN_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.TIEPNHAN_ID'),        @BENHNHAN_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.BENHNHAN_ID'),        @NGUONDUOC_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.NGUONDUOC_ID'),        @DUOC_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.DUOC_ID'),        @SOLUONG =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.SOLUONG'),        @SONGAY =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.SONGAY'),        @SOLANTRENNGAY =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.SOLANTRENNGAY'),        @SOLUONGTRENLAN =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.SOLUONGTRENLAN'),        @SOLUONG_BUOISANG =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.SOLUONG_BUOISANG'),        @SOLUONG_BUOITRUA =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.SOLUONG_BUOITRUA'),        @SOLUONG_BUOICHIEU =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.SOLUONG_BUOICHIEU'),        @SOLUONG_BUOITOI =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.SOLUONG_BUOITOI'),        @DUONGDUNG_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.DUONGDUNG_ID'),        @COSO =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.COSO'),        @KHOTAO_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.KHOTAO_ID'),        @KHOPHAT_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.KHOPHAT_ID'),        @GHICHU =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.GHICHU'),        @PHIEULINH_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.PHIEULINH_ID'),        @CHUNGTU_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.CHUNGTU_ID'),        @PHONGBANRATOA_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.PHONGBANRATOA_ID'),        @NGUONLAYTHUOC =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.NGUONLAYTHUOC'),        @VTYT =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.VTYT'),        @PHATTHUOCTAIQUAY =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.PHATTHUOCTAIQUAY'),        @MUANGOAI =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.MUANGOAI'),        @TINHTIEN =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.TINHTIEN'),        @MIENPHI =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.MIENPHI'),        @BHYTDONGTIEN =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.BHYTDONGTIEN'),        @KHONGTHUTIEN =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.KHONGTHUTIEN'),        @HUYTOATHUOC =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.HUYTOATHUOC'),        @TRANGTHAI =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.TRANGTHAI'),        @BENHVIEN_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.BENHVIEN_ID'),        @NGAYTAO =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.NGAYTAO'),        @NGUOITAO_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.NGUOITAO_ID'),        @NGAYCAPNHAT =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.NGAYCAPNHAT'),        @NGUOICAPNHAT_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.NGUOICAPNHAT_ID'),        @PHAMVI_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.PHAMVI_ID'),        @CHEDODINHDUONG =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.CHEDODINHDUONG'),        @DOTDIEUTRI_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.DOTDIEUTRI_ID'),        @DOITUONG_HUONG_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.DOITUONG_HUONG_ID'),        @SOBHYT_HUONG_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.SOBHYT_HUONG_ID'),                  @DONGIA_DOANHTHU =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.VIENPHI.DONGIA_DOANHTHU'),        @THANHTIEN_DOANHTHU =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.VIENPHI.THANHTIEN_DOANHTHU'),        @BHYT_DONGIA =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.VIENPHI.BHYT_DONGIA'),        @BHYT_THANHTIEN =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.VIENPHI.BHYT_THANHTIEN'),        @BHYT_DONGIA_CHITRA =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.VIENPHI.BHYT_DONGIA_CHITRA'),        @BHYT_THANHTIEN_CHITRA =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.VIENPHI.BHYT_THANHTIEN_CHITRA'),        @BENHNHAN_PHAITHANHTOAN =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.VIENPHI.BENHNHAN_PHAITHANHTOAN')          insert into TT_NOITRU_TOATHUOC        ([SOTHUTUTOA],[KHAMBENH_ID],[TIEPNHAN_ID],[BENHNHAN_ID],[NGUONDUOC_ID]        ,[DUOC_ID],[SOLUONG],[SONGAY],[SOLANTRENNGAY],[SOLUONGTRENLAN],[SOLUONG_BUOISANG],[SOLUONG_BUOITRUA],[SOLUONG_BUOICHIEU]        ,[SOLUONG_BUOITOI],[DUONGDUNG_ID],[COSO],[KHOTAO_ID],[KHOPHAT_ID],[GHICHU],[PHIEULINH_ID],[CHUNGTU_ID],[PHONGBANRATOA_ID]        ,[NGUONLAYTHUOC],[VTYT],[PHATTHUOCTAIQUAY],[MUANGOAI],[TINHTIEN],[MIENPHI],[BHYTDONGTIEN],[KHONGTHUTIEN],[HUYTOATHUOC]        ,[TRANGTHAI],[BENHVIEN_ID],[NGAYTAO],[NGUOITAO_ID],[NGAYCAPNHAT],[NGUOICAPNHAT_ID],[PHAMVI_ID],[CHEDODINHDUONG])        VALUES        (@SOTHUTUTOA,@KHAMBENH_ID,@TIEPNHAN_ID,@BENHNHAN_ID,@NGUONDUOC_ID        ,@DUOC_ID,@SOLUONG,@SONGAY,@SOLANTRENNGAY,@SOLUONGTRENLAN,@SOLUONG_BUOISANG,@SOLUONG_BUOITRUA,@SOLUONG_BUOICHIEU        ,@SOLUONG_BUOITOI,@DUONGDUNG_ID,@COSO,@KHOTAO_ID,@KHOPHAT_ID,@GHICHU,@PHIEULINH_ID,@CHUNGTU_ID,@PHONGBANRATOA_ID        ,@NGUONLAYTHUOC,@VTYT,@PHATTHUOCTAIQUAY,@MUANGOAI,@TINHTIEN,@MIENPHI,@BHYTDONGTIEN,@KHONGTHUTIEN,@HUYTOATHUOC        ,@TRANGTHAI,@BENHVIEN_ID,GETDATE(),@NGUOITAO_ID,GETDATE(),@NGUOICAPNHAT_ID,@PHAMVI_ID,@CHEDODINHDUONG)                set @TOATHUOC_ID = SCOPE_IDENTITY()                  INSERT INTO TT_VIENPHI        ([TIEPNHAN_ID],[BENHAN_ID]        ,[DOTDIEUTRI_ID],[BENHNHAN_ID],[KHAMBENH_ID],[REF_ID],[REF_TABLE],[DICHVU_ID],[DUOC_ID],[LOAI_CHIPHI]        ,[SOLUONG],[DONGIA_DOANHTHU],[THANHTIEN_DOANHTHU],[BHYT_DONGIA],[BHYT_THANHTIEN],[HUY],[DATHANHTOAN]        ,[DATHUCHIEN],[KHONGTHUTIEN],[BHYTDONGTIEN],[BENHVIEN_ID],[NGUOITAO_ID],[NGAYTAO],[NGUOICAPNHAT_ID],        [NGAYCAPNHAT], [DOITUONG_HUONG_ID], [SOBHYT_HUONG_ID], [BHYT_DONGIA_CHITRA], [BHYT_THANHTIEN_CHITRA], [BENHNHAN_PHAITHANHTOAN])        VALUES        (@TIEPNHAN_ID,@BENHAN_ID        ,@DOTDIEUTRI_ID,@BENHNHAN_ID,@KHAMBENH_ID,@TOATHUOC_ID,'TT_NOITRU_TOATHUOC',null,@DUOC_ID,'TT'        ,@SOLUONG,@DONGIA_DOANHTHU,@THANHTIEN_DOANHTHU,@BHYT_DONGIA,@BHYT_THANHTIEN,'0','0'        ,'0',@KHONGTHUTIEN,@BHYTDONGTIEN,@BENHVIEN_ID,@NGUOITAO_ID,GETDATE(),@NGUOICAPNHAT_ID,GETDATE(), @DOITUONG_HUONG_ID, @SOBHYT_HUONG_ID        ,@BHYT_DONGIA_CHITRA, @BHYT_THANHTIEN_CHITRA, @BENHNHAN_PHAITHANHTOAN)                  insert into TT_DUOC_TONKHO_BOOK_NOITRU        ([REF_TABLE],[REF_ID],[PHAMVI_ID],[KHODUOC_ID],[DUOC_ID],[SOLUONG],[NGUONHANG_ID],[CHUYENKHOA_ID]        ,[GHICHU],[BENHVIEN_ID],[NGAYTAO],[NGUOITAO_ID],[NGAYCAPNHAT],[NGUOICAPNHAT_ID], [TRANGTHAI], [NGAYHIEULUC])        VALUES        ('TT_NOITRU_TOATHUOC',@TOATHUOC_ID,@PHAMVI_ID,@KHOPHAT_ID,@DUOC_ID,@SOLUONG,@NGUONDUOC_ID,@PHONGBANRATOA_ID        ,@GHICHU,@BENHVIEN_ID,GETDATE(),@NGUOITAO_ID,GETDATE(),@NGUOICAPNHAT_ID, 'HIEULUC', GETDATE())          set @icnt = @icnt + 1;        END        select @TOATHUOC_ID]
2020-02-26 15:41:09,833 [1] DEBUG - Statement Id: [DAO00063_Add_YLenhThuoc] Parameters: [@param0=[BENHAN_ID,24642], @param1=[TOTAL_RECORD,2]]
2020-02-26 15:41:09,833 [1] DEBUG - Statement Id: [DAO00063_Add_YLenhThuoc] Types: [@param0=[Int64, System.Int64], @param1=[Int32, System.Int32]]
2020-02-26 15:41:10,757 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis] PreparedStatement : [declare @NGUONDUOC_MACDINH varchar(5) = '0';        declare @TOAMUANGOAI int = 0;        select @NGUONDUOC_MACDINH = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'PHA_NGUONDUOC'        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + @NGUONDUOC_MACDINH as DUOC_KEY, 0 as PHAMVI_ID, @NGUONDUOC_MACDINH as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        where d.DUOC_ID in (1030,1030)        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id        from TT_DUOC_TONKHO  where DUOC_ID in (1030,1030) group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY'  and DUOC_ID in (1030,1030)        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and DUOC_ID in (1030,1030)        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where  d.BENHVIEN_ID = 'HLU01' and d.DUOC_ID in (1030,1030)        end        else        begin        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (        select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id        from TT_DUOC_TONKHO  where DUOC_ID in (1030,1030)        group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (        select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID        from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY' and DUOC_ID in (1030,1030)        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (        select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID        from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY' and DUOC_ID in (1030,1030)        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where  d.BENHVIEN_ID = 'HLU01' and d.DUOC_ID in (1030,1030)        end]
2020-02-26 15:41:10,855 [1] DEBUG - Statement Id: [DAOLOG01_LockEnd] PreparedStatement : [DELETE TT_LOG_UPDATE        where REF_TABLE = 'TT_NOITRU_KHAMBENH' and REF_ID = '24642' and BENHVIEN_ID = 'HLU01']
2020-02-26 15:41:10,884 [1] DEBUG - Statement Id: [DAO00067_UpdateThuocNoiVienPhi_Noref] PreparedStatement : [update TT_VIENPHI          set SOLUONG = (TraThuoc.SOLUONG - TraThuoc.SOLUONG_NGUNG)          from (select distinct nttt.SOLUONG, ttct.TOATHUOC_ID, ttct.DUOC_ID , ttct.SOLUONG SOLUONG_NGUNG          from TT_NOITRU_TRATHUOC_CHITIET ttct          left join TT_NOITRU_TRATHUOC tt on tt.TRATHUOC_ID = ttct.TRATHUOC_ID          left join TT_NOITRU_TOATHUOC nttt on nttt.TOATHUOC_ID = ttct.TOATHUOC_ID          where tt.BENHAN_ID =  @param0 ) TraThuoc          where TT_VIENPHI.REF_ID = TraThuoc.TOATHUOC_ID and TT_VIENPHI.DUOC_ID = TraThuoc.DUOC_ID          and TT_VIENPHI.REF_TABLE = 'TT_NOITRU_TOATHUOC' and TT_VIENPHI.BENHAN_ID =  @param0           and TT_VIENPHI.SOLUONG > (TraThuoc.SOLUONG - TraThuoc.SOLUONG_NGUNG)                     update TT_VIENPHI set SOLUONG = 0, THANHTIEN_DOANHTHU = 0, BHYT_THANHTIEN = 0, BHYT_THANHTIEN_CHITRA = 0          , GIATRI_BENHNHAN_DATHANHTOAN = 0, BENHNHAN_PHAITHANHTOAN = 0          where REF_TABLE = 'TT_NOITRU_TOATHUOC'          and TIEPNHAN_ID =  @param1           and KHAMBENH_ID not in (select KHAMBENH_ID from TT_NOITRU_TOATHUOC where TIEPNHAN_ID =  @param1 )          and HOADON_ID is null and BENHAN_ID =  @param0]
2020-02-26 15:41:10,884 [1] DEBUG - Statement Id: [DAO00067_UpdateThuocNoiVienPhi_Noref] Parameters: [@param0=[BENHAN_ID,24642], @param1=[TIEPNHAN_ID,107181]]
2020-02-26 15:41:10,884 [1] DEBUG - Statement Id: [DAO00067_UpdateThuocNoiVienPhi_Noref] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64]]
2020-02-26 15:41:10,988 [1] DEBUG - Statement Id: [DAO00062_GetDetail] PreparedStatement : [select *        from TT_NOITRU_KHAMBENH        where KHAMBENH_ID  = '320499']
2020-02-26 15:41:11,014 [1] DEBUG - Statement Id: [DAO00063_GetToaThuocByKhamBenhID] PreparedStatement : [select distinct a.*, b.SOLUONG as SOLUONGTAMNGUNG,        pl.MACHUNGTU as SOPHIEULINH, ct.MACHUNGTU as SOCHUNGTU        ,vp.BHYT_DONGIA, vp.BHYT_THANHTIEN, vp.BHYT_DONGIA_CHITRA, vp.BHYT_THANHTIEN_CHITRA,        vp.THANHTIEN_DOANHTHU, vp.DONGIA_DOANHTHU, dc.TENDUOCDAYDU, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, dc.DONVITINH        , d.TAMNGUNG        from TT_NOITRU_TOATHUOC a        left join TT_NOITRU_TRATHUOC_CHITIET b on a.TOATHUOC_ID = b.TOATHUOC_ID        left join TT_DUOC_PHIEULINH pl on pl.CHUNGTU_ID = a.PHIEULINH_ID        left join TT_DUOC_CHUNGTU ct on ct.CHUNGTU_ID = a.CHUNGTU_ID        left join TM_DUOC dc on a.DUOC_ID = dc.DUOC_ID        left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID        inner join TM_DUOC d on d.DUOC_ID = a.DUOC_ID        left join (select max(BHYT_DONGIA) BHYT_DONGIA, Max(BHYT_THANHTIEN) BHYT_THANHTIEN, max(BHYT_DONGIA_CHITRA) BHYT_DONGIA_CHITRA,        max(BHYT_THANHTIEN_CHITRA) BHYT_THANHTIEN_CHITRA, max(THANHTIEN_DOANHTHU) THANHTIEN_DOANHTHU, max(DONGIA_DOANHTHU) DONGIA_DOANHTHU,        KHAMBENH_ID, REF_ID, REF_TABLE, DUOC_ID from TT_VIENPHI where KHAMBENH_ID = '320499' and REF_TABLE = 'TT_NOITRU_TOATHUOC'  group by KHAMBENH_ID, REF_ID, REF_TABLE, DUOC_ID)        vp on vp.REF_ID = a.TOATHUOC_ID and vp.REF_TABLE = 'TT_NOITRU_TOATHUOC' and vp.DUOC_ID = a.DUOC_ID        where a.KHAMBENH_ID  = '320499' and a.BENHVIEN_ID = 'HLU01']
2020-02-26 15:41:11,155 [1] DEBUG - Statement Id: [DAO00040_LayListToaMau] PreparedStatement : [select A.*, dc.TENDUOCDAYDU, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ld.MALOAIDUOC, dd.DICTIONARY_NAME DUONGDUNG, dc.TAMNGUNG            from TT_TOATHUOCMAU A            left join TM_DUOC dc on A.DUOC_ID = dc.DUOC_ID            left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID            left join (select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE like 'DuongDung') dd on dd.DICTIONARY_ID = dc.DUONGDUNG_ID            where (1=1)]
2020-02-26 15:41:13,069 [1] DEBUG - Statement Id: [DAO00020_GetDanhsachVPCuaToaThuoc] PreparedStatement : [select * from TT_VIENPHI where        BENHAN_ID = 24642 and REF_TABLE = 'TT_NOITRU_TOATHUOC']
2020-02-26 15:41:27,413 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'BIL11'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 15:41:28,355 [1] DEBUG - Statement Id: [DAO00012_GetList] PreparedStatement : [select        DICTIONARY_ID,        DICTIONARY_CODE,        DICTIONARY_NAME,        ATTRIBUTE1,        ATTRIBUTE2,        DICTIONARY_NAME_EN,        DICTIONARY_TYPE_CODE        from LST_DICTIONARY        where LST_DICTIONARY.Enabled = '1'         AND           LST_DICTIONARY.DICTIONARY_TYPE_CODE = 'NguonBN'                 order by LST_DICTIONARY.IDX]
2020-02-26 15:41:28,891 [1] DEBUG - Statement Id: [DAO00101_GetListSuatAn] PreparedStatement : [SELECT        kP.KHAUPHANAN_ID,        kP.MAKHAUPHANAN,        kP.TENKHAUPHANAN,        LKP.LOAIKHAUPHANAN_ID,        LKP.MALOAIKHAUPHANAN,        LKP.TENLOAIKHAUPHANAN,        DG.DONGIA,        kP.HANGMUC_ID        FROM TM_NUT_KHAUPHANAN kP        INNER JOIN TM_NUT_LOAIKHAUPHANAN LKP ON  kP.LOAIKHAUPHANAN_ID = LKP.LOAIKHAUPHANAN_ID        INNER JOIN TM_NUT_KHAUPHANAN_DONGIA DG ON DG.KHAUPHANAN_ID = kP.KHAUPHANAN_ID        WHERE DG.DONGIA IS NOT NULL]
2020-02-26 15:41:30,890 [1] DEBUG - Statement Id: [DAO00014_GetInPatientStatus] PreparedStatement : [select TRANGTHAI, isnull(KHOACHUYENDEN_ID, KHOAVAO_ID) as KHOAHIENTAI from TT_NOITRU_BENHAN        where        TIEPNHAN_ID = '107181'        and BENHVIEN_ID = 'HLU01'         and           BENHAN_ID = '24642']
2020-02-26 15:41:31,217 [1] DEBUG - Statement Id: [DAO00024_TT_VIENPHI_GetList_DSDichVuChuaThuTien] PreparedStatement : [SELECT TOP 1 VIENPHI_ID              FROM TT_VIENPHI              WHERE              DATHANHTOAN = 0]
2020-02-26 15:41:31,242 [1] DEBUG - Statement Id: [DAO00067_laytrangthaibenhannoitru] PreparedStatement : [select isnull(TRANGTHAI, '') TRANGTHAI from TT_NOITRU_BENHAN where BENHAN_ID =  @param0]
2020-02-26 15:41:31,242 [1] DEBUG - Statement Id: [DAO00067_laytrangthaibenhannoitru] Parameters: [@param0=[BENHAN_ID,24642]]
2020-02-26 15:41:31,242 [1] DEBUG - Statement Id: [DAO00067_laytrangthaibenhannoitru] Types: [@param0=[Int64, System.Int64]]
2020-02-26 15:41:31,266 [1] DEBUG - Statement Id: [DAO00067_DeleteVienPhi_Noref] PreparedStatement : [delete from TT_VIENPHI where TIEPNHAN_ID = 107181 and (REF_ID is null or REF_ID = 0)         and           BENHAN_ID = '24642'                 delete TT_DUOC_TONKHO_BOOK_NOITRU where REF_TABLE = 'TT_NOITRU_TOATHUOC' and (REF_ID is null or REF_ID = 0)        delete TT_DUOC_TONKHO_BOOK_NGOAITRU where REF_ID is null or REF_ID = 0]
2020-02-26 15:41:31,295 [1] DEBUG - Statement Id: [DAO00067_UpdateBenhanIdVienPhi] PreparedStatement : [update TT_VIENPHI          set BENHAN_ID =  @param0           from (select TOATHUOC_ID from TT_NOITRU_TOATHUOC where TIEPNHAN_ID =  @param1 ) nttt          where REF_TABLE = 'TT_NOITRU_TOATHUOC' and REF_ID = nttt.TOATHUOC_ID and isnull(BENHAN_ID, 0) = 0          and TIEPNHAN_ID =  @param1             update TT_VIENPHI          set TT_VIENPHI.BENHAN_ID =  @param0           from (select DVYEUCAU_ID, BENHAN_ID from TT_DVYEUCAU where TIEPNHAN_ID =  @param1 ) nttt          where TT_VIENPHI.REF_TABLE = 'TT_DVYEUCAU' and TT_VIENPHI.REF_ID = nttt.DVYEUCAU_ID          and isnull(TT_VIENPHI.BENHAN_ID, 0) = 0 and isnull(nttt.BENHAN_ID, 0) > 0          and TT_VIENPHI.TIEPNHAN_ID =  @param1]
2020-02-26 15:41:31,295 [1] DEBUG - Statement Id: [DAO00067_UpdateBenhanIdVienPhi] Parameters: [@param0=[BENHAN_ID,24642], @param1=[TIEPNHAN_ID,107181]]
2020-02-26 15:41:31,295 [1] DEBUG - Statement Id: [DAO00067_UpdateBenhanIdVienPhi] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64]]
2020-02-26 15:41:31,321 [1] DEBUG - Statement Id: [DAO00064_GetlistTT_TIEPNHAN_SOTHEBHYT] PreparedStatement : [select stbhyt.*, ba.SOBENHAN,        tn.SOTIEPNHAN, tn.LOAITHANHVIEN_ID, tn.THE_ID, tn.THANHVIEN_ID,        tn.SUDUNG_BHTN, tn.BAOLANH_VIENPHI, tn.VIP, tn.NGUOINUOCNGOAI        from TT_TIEPNHAN_SOTHEBHYT stbhyt        left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = stbhyt.TIEPNHAN_ID        left join TT_NOITRU_BENHAN ba on ba.TIEPNHAN_ID = stbhyt.TIEPNHAN_ID        where        stbhyt.TIEPNHAN_ID = '107181' and isnull(stbhyt.KHONGSUDUNG, '0') = '0'         and           ba.BENHAN_ID = '24642']
2020-02-26 15:41:31,370 [1] DEBUG - Statement Id: [DAO00064_GetListVienPhiByTiepNnan] PreparedStatement : [select distinct        B.DOITUONG_ID, B.NGAYMIENDONGCHITRA, B.BENHNHAN_ID as TIEPNHAN_BENHNHAN_ID, B.TRAITUYEN,        B.BHYTTREN3NAM as TREN3NAM, B.BHYTTREN5NAM as TREN5NAM, B.SOTIEPNHAN, B.SOBENHAN,        B.LOAITHANHVIEN_ID, B.SUDUNG_BHTN, B.THE_ID, B.THANHVIEN_ID, B.BAOLANH_VIENPHI, B.VIP, B.NGUOINUOCNGOAI,        C.GIATRIMIENGIAM as GIATRIMIENGIAM, D.GIATRIMIENGIAM as GIATRIMIENGIAM_BHTN, E.GIATRIMIENGIAM as GIATRIMIENGIAM_THANHVIEN,        F.GIATRIMIENGIAM as GIATRIMIENGIAM_CONGTY, DVYC.THE_ID as DVDUNGTHE, DVYC.TRANGTHAI as TRANGTHAIDICHVU, ndv.MANHOMDICHVU,        A.* from TT_VIENPHI A        left join        (select B.*, C.SOBENHAN, C.BENHAN_ID        from TT_TIEPNHAN B        left join TT_NOITRU_BENHAN C on B.TIEPNHAN_ID = C.TIEPNHAN_ID         and           C.BENHAN_ID = '24642'                 where B.TIEPNHAN_ID = '107181') B on B.TIEPNHAN_ID = A.TIEPNHAN_ID        left join (select sum(GIATRIMIENGIAM) as GIATRIMIENGIAM, VIENPHI_ID, REF_TABLE        from TT_MIENGIAM_CHITIET        where REF_TABLE = 'TT_MIENGIAM'        and exists (select MIENGIAM_ID from TT_MIENGIAM where TT_MIENGIAM_CHITIET.MIENGIAM_ID = MIENGIAM_ID and TINHTRANG = 1 and TIEPNHAN_ID = '107181')        group by VIENPHI_ID, REF_TABLE) C on C.REF_TABLE = 'TT_MIENGIAM' and C.VIENPHI_ID = A.VIENPHI_ID        left join (select sum(GIATRIMIENGIAM) as GIATRIMIENGIAM, VIENPHI_ID, REF_TABLE        from TT_MIENGIAM_CHITIET        where REF_TABLE = 'TT_MIENGIAM_BHTN'        and exists (select MIENGIAM_BHTN_ID from TT_MIENGIAM_BHTN where TT_MIENGIAM_CHITIET.MIENGIAM_ID = MIENGIAM_BHTN_ID and  TINHTRANG = 1 and TIEPNHAN_ID = '107181')        group by VIENPHI_ID, REF_TABLE) D on D.REF_TABLE = 'TT_MIENGIAM_BHTN' and D.VIENPHI_ID = A.VIENPHI_ID        left join (select sum(GIATRIMIENGIAM) as GIATRIMIENGIAM, VIENPHI_ID, REF_TABLE        from TT_MIENGIAM_CHITIET        where REF_TABLE = 'TT_MIENGIAM_THANHVIEN'        and exists (select MIENGIAM_THANHVIEN_ID from TT_MIENGIAM_THANHVIEN where TT_MIENGIAM_CHITIET.MIENGIAM_ID = MIENGIAM_THANHVIEN_ID and TINHTRANG = 1 and TIEPNHAN_ID = '107181')        group by VIENPHI_ID, REF_TABLE) E on E.REF_TABLE = 'TT_MIENGIAM_THANHVIEN' and E.VIENPHI_ID = A.VIENPHI_ID        left join (select sum(GIATRIMIENGIAM) as GIATRIMIENGIAM, VIENPHI_ID, REF_TABLE        from TT_MIENGIAM_CHITIET        where REF_TABLE = 'TT_MIENGIAM_CONGTY'        and exists (select MIENGIAM_CONGTY_ID from TT_MIENGIAM_CONGTY where TT_MIENGIAM_CHITIET.MIENGIAM_ID = MIENGIAM_CONGTY_ID and TINHTRANG = 1 and TIEPNHAN_ID = '107181')        group by VIENPHI_ID, REF_TABLE) F on F.REF_TABLE = 'TT_MIENGIAM_CONGTY' and F.VIENPHI_ID = A.VIENPHI_ID        left join TT_DVYEUCAU DVYC on DVYC.DVYEUCAU_ID = A.REF_ID and A.REF_TABLE = 'TT_DVYEUCAU'        left join TM_DICHVU DV on DVYC.DICHVU_ID = DV.DICHVU_ID and A.REF_TABLE = 'TT_DVYEUCAU'        left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = DV.NHOMDICHVU_ID and A.REF_TABLE = 'TT_DVYEUCAU'        where        A.TIEPNHAN_ID = '107181' and ((DVYC.HUYYEUCAU = '0' and A.DICHVU_ID is not null)        or A.DUOC_ID is not null or A.REF_TABLE = 'TT_NUT_XACNHANSUATAN_CHITIET')        and A.ACTIVE = '1'         and           A.BENHAN_ID = '24642'                 and A.BENHVIEN_ID = 'HLU01'        order by A.VIENPHI_ID]
2020-02-26 15:41:31,413 [1] DEBUG - Statement Id: [DAO00006_GetListDuocTyle] PreparedStatement : [select DUOC_ID, DOITUONG_ID, (TYLE/100) as TYLE, DONGIA MUCTRAN_THANHTOAN from TM_DOITUONG_GIADUOC_TYLE            where            BENHVIEN_ID = 'HLU01'            and DOITUONG_ID = '4']
2020-02-26 15:41:31,437 [1] DEBUG - Statement Id: [DAO00027_GetListTuongTrinhDichVuPhauThuatCuaTiepNhan] PreparedStatement : [declare @ManhomDSA varchar(10);        declare @PhanLoaiNhomDV varchar(20) = '05';        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        if (@ManhomDSA is not null) set @PhanLoaiNhomDV += ',' + @ManhomDSA        select distinct ptyc.*        from TT_PHAUTHUAT_YEUCAU ptyc        inner join TM_DICHVU dv on dv.DICHVU_ID = ptyc.DICHVU_ID        inner join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID        inner join TT_PHAUTHUAT pt on pt.PHAUTHUAT_ID = ptyc.PHAUTHUAT_ID        where        pt.TIEPNHAN_ID = 107181        and (left(ndv.MANHOMDICHVU, 2) in (select * from STRING_SPLIT(@PhanLoaiNhomDV,',')) or ndv.MANHOMDICHVU in (select * from STRING_SPLIT(@PhanLoaiNhomDV,',')))]
2020-02-26 15:41:31,530 [1] DEBUG - Statement Id: [DAO00027_GetListTuongTrinhVTYTPhauThuatCuaTiepNhan] PreparedStatement : [select distinct ptvt.*        from TT_PHAUTHUAT_VTYT ptvt        inner join TT_PHAUTHUAT pt on pt.PHAUTHUAT_ID = ptvt.PHAUTHUAT_ID        inner join TM_DUOC d on d.DUOC_ID = ptvt.DUOC_ID        inner join TM_LOAIDUOC ld on ld.LOAIVATTU_ID = 'V' and ld.LOAIDUOC_ID = d.LOAIDUOC_ID        where pt.TIEPNHAN_ID = 107181        order by ptvt.PHAUTHUAT_VTYT_ID asc]
2020-02-26 15:41:31,571 [1] DEBUG - Statement Id: [DAO00006_GetList] PreparedStatement : [select dv.*, loaiDV.MALOAIDICHVU, captren.NHOMDICHVU_ID as NHOMDICHVU_CAPTREN_ID, captren.TENNHOMDICHVU as NHOMDICHVU_CAPTREN,              nhom_dv.TENNHOMDICHVU as TENNHOMDICHVU, nhom_dv.MANHOMDICHVU,              case when dv.ATTRIBUTE5 is null then 'TT' else 'KTC' end as LOAI_CHIPHI              from TM_DICHVU as dv              left join TM_NHOMDICHVU as nhom_dv on nhom_dv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID and nhom_dv.BENHVIEN_ID = 'HLU01'              left join TM_NHOMDICHVU as captren on nhom_dv.CAPTREN_ID = captren.NHOMDICHVU_ID and captren.BENHVIEN_ID = 'HLU01'              left join TM_LOAIDICHVU loaiDV on nhom_dv.LOAIDICHVU_ID = loaiDV.LOAIDICHVU_ID and loaiDV.BENHVIEN_ID = 'HLU01'              where nhom_dv.TAMNGUNG = '0' and dv.BENHVIEN_ID = 'HLU01'              and dv.TAMNGUNG = '0'               AND                   loaiDV.MALOAIDICHVU = 'KhamBenh']
2020-02-26 15:41:31,634 [1] DEBUG - Statement Id: [DAO00027_GetDichvuYCBHYTTyle] PreparedStatement : [select DVYEUCAU_ID from TT_DVYEUCAU        where TIEPNHAN_ID = 107181 and isnull(BHYT_TYLETHANHTOAN_ID, 0) > 0]
2020-02-26 15:41:31,794 [1] DEBUG - Statement Id: [DAO00023_UpdateNhieuVP] PreparedStatement : [declare @jsonVienPhi nvarchar(max) = N'[{"VIENPHI_ID":3109614,"TIEPNHAN_ID":107181,"DICHVU_ID":5440,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":34500.0000,"THANHTIEN_DOANHTHU":34500.00,"BHYT_TL":0.8000,"BHYT_DONGIA":34500.0000,"BHYT_THANHTIEN":34500.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":27600.0,"BHYT_THANHTIEN_CHITRA":27600.00,"BENHNHAN_PHAITHANHTOAN":6900.00,"GIATRI_HOADON":6900.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3109615,"TIEPNHAN_ID":107181,"DICHVU_ID":5554,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":5000.0000,"THANHTIEN_DOANHTHU":5000.00,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":5000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110619,"TIEPNHAN_ID":107181,"DICHVU_ID":4022,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":43900.0000,"THANHTIEN_DOANHTHU":43900.00,"BHYT_TL":0.8000,"BHYT_DONGIA":43900.0000,"BHYT_THANHTIEN":43900.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":35120.0,"BHYT_THANHTIEN_CHITRA":35120.00,"BENHNHAN_PHAITHANHTOAN":8780.00,"GIATRI_HOADON":8780.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110620,"TIEPNHAN_ID":107181,"DICHVU_ID":4422,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":32800.0000,"THANHTIEN_DOANHTHU":32800.00,"BHYT_TL":0.8000,"BHYT_DONGIA":32800.0000,"BHYT_THANHTIEN":32800.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":26240.0,"BHYT_THANHTIEN_CHITRA":26240.00,"BENHNHAN_PHAITHANHTOAN":6560.00,"GIATRI_HOADON":6560.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110621,"TIEPNHAN_ID":107181,"DICHVU_ID":4451,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":63500.0000,"THANHTIEN_DOANHTHU":63500.00,"BHYT_TL":0.8000,"BHYT_DONGIA":63500.0000,"BHYT_THANHTIEN":63500.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":50800.0,"BHYT_THANHTIEN_CHITRA":50800.00,"BENHNHAN_PHAITHANHTOAN":12700.00,"GIATRI_HOADON":12700.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110622,"TIEPNHAN_ID":107181,"DICHVU_ID":4454,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":40400.0000,"THANHTIEN_DOANHTHU":40400.00,"BHYT_TL":0.8000,"BHYT_DONGIA":40400.0000,"BHYT_THANHTIEN":40400.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":32320.0,"BHYT_THANHTIEN_CHITRA":32320.00,"BENHNHAN_PHAITHANHTOAN":8080.00,"GIATRI_HOADON":8080.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110623,"TIEPNHAN_ID":107181,"DICHVU_ID":4523,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":40400.0000,"THANHTIEN_DOANHTHU":40400.00,"BHYT_TL":0.8000,"BHYT_DONGIA":40400.0000,"BHYT_THANHTIEN":40400.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":32320.0,"BHYT_THANHTIEN_CHITRA":32320.00,"BENHNHAN_PHAITHANHTOAN":8080.00,"GIATRI_HOADON":8080.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110624,"TIEPNHAN_ID":107181,"DICHVU_ID":4596,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":39100.0000,"THANHTIEN_DOANHTHU":39100.00,"BHYT_TL":0.8000,"BHYT_DONGIA":39100.0000,"BHYT_THANHTIEN":39100.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":31280.0,"BHYT_THANHTIEN_CHITRA":31280.00,"BENHNHAN_PHAITHANHTOAN":7820.00,"GIATRI_HOADON":7820.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110626,"TIEPNHAN_ID":107181,"DICHVU_ID":4642,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":21500.0000,"THANHTIEN_DOANHTHU":21500.00,"BHYT_TL":0.8000,"BHYT_DONGIA":21500.0000,"BHYT_THANHTIEN":21500.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":17200.0,"BHYT_THANHTIEN_CHITRA":17200.00,"BENHNHAN_PHAITHANHTOAN":4300.00,"GIATRI_HOADON":4300.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110628,"TIEPNHAN_ID":107181,"DICHVU_ID":4681,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":21500.0000,"THANHTIEN_DOANHTHU":21500.00,"BHYT_TL":0.8000,"BHYT_DONGIA":21500.0000,"BHYT_THANHTIEN":21500.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":17200.0,"BHYT_THANHTIEN_CHITRA":17200.00,"BENHNHAN_PHAITHANHTOAN":4300.00,"GIATRI_HOADON":4300.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110629,"TIEPNHAN_ID":107181,"DICHVU_ID":4722,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":21500.0000,"THANHTIEN_DOANHTHU":21500.00,"BHYT_TL":0.8000,"BHYT_DONGIA":21500.0000,"BHYT_THANHTIEN":21500.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":17200.0,"BHYT_THANHTIEN_CHITRA":17200.00,"BENHNHAN_PHAITHANHTOAN":4300.00,"GIATRI_HOADON":4300.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110630,"TIEPNHAN_ID":107181,"DICHVU_ID":4747,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":27400.0000,"THANHTIEN_DOANHTHU":27400.00,"BHYT_TL":0.8000,"BHYT_DONGIA":27400.0000,"BHYT_THANHTIEN":27400.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":21920.0,"BHYT_THANHTIEN_CHITRA":21920.00,"BENHNHAN_PHAITHANHTOAN":5480.00,"GIATRI_HOADON":5480.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110631,"TIEPNHAN_ID":107181,"DICHVU_ID":4832,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":70000.0000,"THANHTIEN_DOANHTHU":70000.00,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":70000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":70000.0000,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":70000.0000,"GIATRI_BENHNHAN_DATHANHTOAN":70000.0000,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110632,"TIEPNHAN_ID":107181,"DICHVU_ID":4873,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":70000.0000,"THANHTIEN_DOANHTHU":70000.00,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":70000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":70000.0000,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":70000.0000,"GIATRI_BENHNHAN_DATHANHTOAN":70000.0000,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119342,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":5.0000,"DONGIA_DOANHTHU":4000.0000,"THANHTIEN_DOANHTHU":20000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":20000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119500,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":2.0000,"DONGIA_DOANHTHU":8715.0000,"THANHTIEN_DOANHTHU":17430.00,"BHYT_TL":0.8000,"BHYT_DONGIA":8715.0000,"BHYT_THANHTIEN":17430.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":6972.0,"BHYT_THANHTIEN_CHITRA":13944.00,"BENHNHAN_PHAITHANHTOAN":3486.00,"GIATRI_HOADON":3486.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119501,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":8925.0000,"THANHTIEN_DOANHTHU":8925.00,"BHYT_TL":0.8000,"BHYT_DONGIA":8925.0000,"BHYT_THANHTIEN":8925.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":7140.0,"BHYT_THANHTIEN_CHITRA":7140.00,"BENHNHAN_PHAITHANHTOAN":1785.00,"GIATRI_HOADON":1785.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119502,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":2.0000,"DONGIA_DOANHTHU":27990.0000,"THANHTIEN_DOANHTHU":55980.00,"BHYT_TL":0.8000,"BHYT_DONGIA":27990.0000,"BHYT_THANHTIEN":55980.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":22392.0,"BHYT_THANHTIEN_CHITRA":44784.00,"BENHNHAN_PHAITHANHTOAN":11196.00,"GIATRI_HOADON":11196.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119503,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":8925.0000,"THANHTIEN_DOANHTHU":8925.00,"BHYT_TL":0.8000,"BHYT_DONGIA":8925.0000,"BHYT_THANHTIEN":8925.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":7140.0,"BHYT_THANHTIEN_CHITRA":7140.00,"BENHNHAN_PHAITHANHTOAN":1785.00,"GIATRI_HOADON":1785.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119504,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":2.0000,"DONGIA_DOANHTHU":8295.0000,"THANHTIEN_DOANHTHU":16590.00,"BHYT_TL":0.8000,"BHYT_DONGIA":8295.0000,"BHYT_THANHTIEN":16590.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":6636.0,"BHYT_THANHTIEN_CHITRA":13272.00,"BENHNHAN_PHAITHANHTOAN":3318.00,"GIATRI_HOADON":3318.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119505,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":458000.0000,"THANHTIEN_DOANHTHU":458000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":398036.0000,"BHYT_THANHTIEN":398036.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":318428.8,"BHYT_THANHTIEN_CHITRA":318428.80,"BENHNHAN_PHAITHANHTOAN":139571.20,"GIATRI_HOADON":79607.20,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119506,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":50400.0000,"THANHTIEN_DOANHTHU":50400.00,"BHYT_TL":0.8000,"BHYT_DONGIA":50400.0000,"BHYT_THANHTIEN":50400.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":40320.0,"BHYT_THANHTIEN_CHITRA":40320.00,"BENHNHAN_PHAITHANHTOAN":10080.00,"GIATRI_HOADON":10080.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119530,"TIEPNHAN_ID":107181,"DICHVU_ID":5363,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":10000.0000,"THANHTIEN_DOANHTHU":10000.00,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119531,"TIEPNHAN_ID":107181,"DICHVU_ID":5588,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":2400.0000,"THANHTIEN_DOANHTHU":2400.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119532,"TIEPNHAN_ID":107181,"DICHVU_ID":477,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":110000.0000,"THANHTIEN_DOANHTHU":110000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119533,"TIEPNHAN_ID":107181,"DICHVU_ID":5602,"BENHAN_ID":24642,"SOLUONG":0.5000,"DONGIA_DOANHTHU":200000.0000,"THANHTIEN_DOANHTHU":100000.00,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":100000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119535,"TIEPNHAN_ID":107181,"DICHVU_ID":3161,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":2945000.0000,"THANHTIEN_DOANHTHU":2945000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":2945000.0000,"BHYT_THANHTIEN":2945000.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":2356000.0,"BHYT_THANHTIEN_CHITRA":2356000.00,"BENHNHAN_PHAITHANHTOAN":589000.00,"GIATRI_HOADON":589000.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119536,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":0.2500,"DONGIA_DOANHTHU":25000.0000,"THANHTIEN_DOANHTHU":6250.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119537,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":2.0000,"DONGIA_DOANHTHU":1700.0000,"THANHTIEN_DOANHTHU":3400.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119538,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":3.0000,"DONGIA_DOANHTHU":1000.0000,"THANHTIEN_DOANHTHU":3000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119539,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":3.0000,"DONGIA_DOANHTHU":2000.0000,"THANHTIEN_DOANHTHU":6000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119540,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":4000.0000,"THANHTIEN_DOANHTHU":4000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119541,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":3000.0000,"THANHTIEN_DOANHTHU":3000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119542,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":100.0000,"DONGIA_DOANHTHU":50.0000,"THANHTIEN_DOANHTHU":5000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119543,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":150000.0000,"THANHTIEN_DOANHTHU":150000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119544,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":160000.0000,"THANHTIEN_DOANHTHU":160000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119545,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":20.0000,"DONGIA_DOANHTHU":3000.0000,"THANHTIEN_DOANHTHU":60000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119546,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":20.0000,"DONGIA_DOANHTHU":6000.0000,"THANHTIEN_DOANHTHU":120000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119547,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":5.0000,"DONGIA_DOANHTHU":4000.0000,"THANHTIEN_DOANHTHU":20000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119548,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":10.0000,"DONGIA_DOANHTHU":8000.0000,"THANHTIEN_DOANHTHU":80000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119549,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":2.0000,"DONGIA_DOANHTHU":500.0000,"THANHTIEN_DOANHTHU":1000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119550,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":10000.0000,"THANHTIEN_DOANHTHU":10000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119551,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":45000.0000,"THANHTIEN_DOANHTHU":45000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119552,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":35000.0000,"THANHTIEN_DOANHTHU":35000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119553,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":10000.0000,"THANHTIEN_DOANHTHU":10000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119554,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":20000.0000,"THANHTIEN_DOANHTHU":20000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119555,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":6500.0000,"THANHTIEN_DOANHTHU":6500.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119556,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":0.5000,"DONGIA_DOANHTHU":16000.0000,"THANHTIEN_DOANHTHU":8000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119557,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":0.2500,"DONGIA_DOANHTHU":100000.0000,"THANHTIEN_DOANHTHU":25000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119558,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":2.0000,"DONGIA_DOANHTHU":10000.0000,"THANHTIEN_DOANHTHU":20000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119559,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":60000.0000,"THANHTIEN_DOANHTHU":60000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119560,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":2.0000,"DONGIA_DOANHTHU":13500.0000,"THANHTIEN_DOANHTHU":27000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119561,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":6000.0000,"THANHTIEN_DOANHTHU":6000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119645,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":600.0000,"THANHTIEN_DOANHTHU":600.00,"BHYT_TL":0.8000,"BHYT_DONGIA":600.0000,"BHYT_THANHTIEN":600.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":480.0,"BHYT_THANHTIEN_CHITRA":480.00,"BENHNHAN_PHAITHANHTOAN":120.00,"GIATRI_HOADON":120.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":0.0,"DUOC_TYLE":0.0000},{"VIENPHI_ID":3119646,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":1000.0000,"THANHTIEN_DOANHTHU":1000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":1000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"1","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":0.0,"DUOC_TYLE":0.0000},{"VIENPHI_ID":3119647,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":600.0000,"THANHTIEN_DOANHTHU":600.00,"BHYT_TL":0.8000,"BHYT_DONGIA":600.0000,"BHYT_THANHTIEN":600.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":480.0,"BHYT_THANHTIEN_CHITRA":480.00,"BENHNHAN_PHAITHANHTOAN":120.00,"GIATRI_HOADON":120.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":0.0,"DUOC_TYLE":0.0000},{"VIENPHI_ID":3119648,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":1000.0000,"THANHTIEN_DOANHTHU":1000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":1000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"1","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":0.0,"DUOC_TYLE":0.0000}]';        begin        UPDATE TT_VIENPHI        SET        SOLUONG = json.SOLUONG,        DONGIA_DOANHTHU = json.DONGIA_DOANHTHU,        THANHTIEN_DOANHTHU = json.THANHTIEN_DOANHTHU,        BHYT_TL = json.BHYT_TL,        BHYT_DONGIA = json.BHYT_DONGIA,        BHYT_THANHTIEN = json.BHYT_THANHTIEN,        BHYT_DONGIA_CONGKHAM_DAU = json.BHYT_DONGIA_CONGKHAM_DAU,        BHYT_CONGKHAM_DAU_TYLE = json.BHYT_CONGKHAM_DAU_TYLE,        BHYT_DONGIA_CHITRA = json.BHYT_DONGIA_CHITRA,        BHYT_THANHTIEN_CHITRA = json.BHYT_THANHTIEN_CHITRA,        BENHNHAN_PHAITHANHTOAN = json.BENHNHAN_PHAITHANHTOAN,        GIATRI_HOADON = json.GIATRI_HOADON,        GIATRI_BIENLAI = json.GIATRI_BIENLAI,        DATHUCHIEN = json.DATHUCHIEN,        DICHVU_TL = json.DICHVU_TL,        BHYT_DONGIA_DONGCT_DAU = json.BHYT_DONGIA_DONGCT_DAU,        SOLONHAP_ID = json.SOLONHAP_ID,        DUOC_TYLE = json.DUOC_TYLE,        DUOC_MUCTRAN_THANHTOAN = json.DUOC_MUCTRAN_THANHTOAN,        NGAYCAPNHAT = GETDATE()        FROM OPENJSON (@jsonVienPhi)        WITH (        VIENPHI_ID int,        SOLUONG numeric(25, 4),        DONGIA_DOANHTHU numeric(25, 4),        THANHTIEN_DOANHTHU numeric(25, 4),        BHYT_TL numeric(25, 4),        BHYT_DONGIA numeric(25, 4),        BHYT_THANHTIEN numeric(25, 4),        BHYT_DONGIA_CONGKHAM_DAU numeric(25, 4),        BHYT_CONGKHAM_DAU_TYLE numeric(25, 4),        BHYT_DONGIA_CHITRA numeric(25, 4),        BHYT_THANHTIEN_CHITRA numeric(25, 4),        BENHNHAN_PHAITHANHTOAN numeric(25, 4),        GIATRI_HOADON numeric(25, 4),        GIATRI_BIENLAI numeric(25, 4),        DATHUCHIEN char(1),        KHONGTHUTIEN char(1),        BHYTDONGTIEN char(1),        DICHVU_TL numeric(25, 4),        BHYT_DONGIA_DONGCT_DAU numeric(25, 4),        SOLONHAP_ID int,        DUOC_TYLE numeric(25, 4),        DUOC_MUCTRAN_THANHTOAN numeric(25, 4))  json        WHERE TT_VIENPHI.VIENPHI_ID = json.VIENPHI_ID and json.DONGIA_DOANHTHU > 0                  insert into TT_TINH_VIENPHI_LOG        SELECT json.VIENPHI_ID, json.TIEPNHAN_ID, json.BENHAN_ID, json.SOLUONG, json.BHYT_TL, json.DONGIA_DOANHTHU,        json.THANHTIEN_DOANHTHU, json.BHYT_DONGIA, json.BHYT_THANHTIEN, json.BHYT_DONGIA_CHITRA, json.BHYT_THANHTIEN_CHITRA, json.BENHNHAN_PHAITHANHTOAN,        json.SOBHYT_HUONG_ID, json.SOBHYT, GETDATE(), -1, 'HLU01'        FROM OPENJSON(@jsonVienPhi)        WITH (        VIENPHI_ID int,        TIEPNHAN_ID int,        BENHAN_ID int,        SOLUONG numeric(25, 4),        DONGIA_DOANHTHU numeric(25, 4),        THANHTIEN_DOANHTHU numeric(25, 4),        BHYT_TL numeric(25, 4),        BHYT_DONGIA numeric(25, 4),        BHYT_THANHTIEN numeric(25, 4),        BHYT_DONGIA_CHITRA numeric(25, 4),        BHYT_THANHTIEN_CHITRA numeric(25, 4),        BENHNHAN_PHAITHANHTOAN numeric(25, 4),        SOBHYT_HUONG_ID int,        SOBHYT nvarchar(30)) json        end]
2020-02-26 15:41:31,998 [1] DEBUG - Statement Id: [DAO00067_UpdateDataVienPhiDongiaBHYT] PreparedStatement : [update TT_VIENPHI          set BHYT_DONGIA_CHITRA = 0, BHYT_THANHTIEN = 0, BHYT_THANHTIEN_CHITRA = 0          where          TIEPNHAN_ID = 107181 and BHYT_DONGIA = 0          and (BHYT_DONGIA_CHITRA > 0 or BHYT_THANHTIEN > 0 or BHYT_THANHTIEN_CHITRA > 0)]
2020-02-26 15:41:32,024 [1] DEBUG - Statement Id: [DAO00067_CapnhatDataVienphiKhiHuyThanhtoanHoadon] PreparedStatement : [update TT_VIENPHI        set TT_VIENPHI.HOADON_ID = hdct.HOADON_ID, TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN = TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN + hdct.GIATRI_BENHNHAN_DATHANHTOAN        from (select CT.HOADON_ID, CT.VIENPHI_ID, CT.GIATRI_BENHNHAN_DATHANHTOAN        from TT_HOADON_CHITIET_NGOAITRU CT        join TT_HOADON HD on HD.HOADON_ID = CT.HOADON_ID        join TT_VIENPHI vp on vp.VIENPHI_ID = ct.VIENPHI_ID        where HD.DATHANHTOAN = 1 and HD.HUYHOADON = 0 and HD.HOANTRA = 0 and vp.TIEPNHAN_ID =  @param0 ) hdct        where        TT_VIENPHI.VIENPHI_ID = hdct.VIENPHI_ID and TT_VIENPHI.HOADON_ID is null and isnull(TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN,0) = 0        and TT_VIENPHI.TIEPNHAN_ID =  @param0           update TT_VIENPHI        set TT_VIENPHI.HOADON_ID = null, TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN = TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN - hdct.GIATRI_BENHNHAN_DATHANHTOAN,        TT_VIENPHI.DATHANHTOAN = '0'        from (select CT.HOADON_ID, CT.VIENPHI_ID, CT.GIATRI_BENHNHAN_DATHANHTOAN        from TT_HOADON_CHITIET_NGOAITRU CT        join TT_HOADON HD on HD.HOADON_ID = CT.HOADON_ID        join TT_VIENPHI vp on vp.VIENPHI_ID = ct.VIENPHI_ID and vp.HOADON_ID = ct.HOADON_ID        where HD.DATHANHTOAN = 0 and (HD.HUYHOADON = 1 or HD.HOANTRA = 1) and vp.TIEPNHAN_ID =  @param0 ) hdct        where        TT_VIENPHI.VIENPHI_ID = hdct.VIENPHI_ID and TT_VIENPHI.HOADON_ID = hdct.HOADON_ID        and TT_VIENPHI.TIEPNHAN_ID =  @param0]
2020-02-26 15:41:32,024 [1] DEBUG - Statement Id: [DAO00067_CapnhatDataVienphiKhiHuyThanhtoanHoadon] Parameters: [@param0=[TIEPNHAN_ID,107181]]
2020-02-26 15:41:32,024 [1] DEBUG - Statement Id: [DAO00067_CapnhatDataVienphiKhiHuyThanhtoanHoadon] Types: [@param0=[Int64, System.Int64]]
2020-02-26 15:41:32,077 [1] DEBUG - Statement Id: [DAO00000_GetDoiTuongIsBHYT] PreparedStatement : [select * from TM_DOITUONG Where DOITUONG_ID = 4 and MADOITUONG like '%BHYT%']
2020-02-26 15:41:32,156 [1] DEBUG - Statement Id: [DAO00064_GetDOITUONG] PreparedStatement : [SELECT TOP 1        DT.TENDOITUONG,        BHYT.SOTHE,        BHYT.NGAYHIEULUC,        BHYT.NGAYHETHIEULUC,        BHYT.BENHVIEN_KCB_ID AS MABENHVIEN,        BV.TENBENHVIEN,        BHYT.NGAYMIENDONGCHITRA,        BHYT.TREN5NAM          FROM TT_BENHNHAN_BHYT BHYT, TM_DOITUONG DT, TM_BENHVIEN BV        WHERE        DT.NHOMTHE LIKE '%' + LEFT(BHYT.SOTHE,3) + '%'        AND BHYT.BENHNHAN_ID = '20633'        AND BHYT.BENHVIEN_KCB_ID = BV.MABENHVIEN        ORDER BY BHYT.NGAYTAO DESC]
2020-02-26 15:41:33,744 [1] DEBUG - Statement Id: [DAO00064_GetNgayDangKyDichVu] PreparedStatement : [SELECT        DISTINCT CONVERT(date, NGAYTAO) as NGAYCHIPHI        FROM TT_VIENPHI        WHERE        TIEPNHAN_ID = '107181'         and           BENHAN_ID = '24642'                 ORDER BY NGAYCHIPHI]
2020-02-26 15:41:33,801 [1] DEBUG - Statement Id: [DAO00064_GetAllNgayYeucauDV] PreparedStatement : [SELECT        DISTINCT DVYEUCAU_ID, DICHVU_ID, CONVERT(date, NGAYYEUCAU) NGAYYEUCAU        FROM TT_DVYEUCAU        WHERE        TIEPNHAN_ID = '107181'         and           BENHAN_ID = '24642']
2020-02-26 15:41:34,175 [1] DEBUG - Statement Id: [DAO00064_GetAllNgayYeucauYlenh] PreparedStatement : [SELECT        DISTINCT A.TOATHUOC_ID, A.KHAMBENH_ID, A.DUOC_ID, CONVERT(date, B.THOIGIANKHAM) NGAYYEUCAU        FROM TT_NOITRU_TOATHUOC A        inner join TT_NOITRU_KHAMBENH B on B.KHAMBENH_ID = A.KHAMBENH_ID        WHERE        B.BENHAN_ID = '24642']
2020-02-26 15:41:34,243 [1] DEBUG - Statement Id: [DAO00063_AllGetTrangThaiThuocbyBenan_Id] PreparedStatement : [select A.CHUNGTU_ID, A.PHIEULINH_ID, A.HUYTOATHUOC, A.NGUOITAO_ID, A.TOATHUOC_ID        from TT_NOITRU_TOATHUOC A        inner join TT_NOITRU_KHAMBENH B on B.KHAMBENH_ID = A.KHAMBENH_ID        where B.BENHAN_ID  = '24642']
2020-02-26 15:41:34,279 [1] DEBUG - Statement Id: [DAO00064_TT_VIENPHI_GetList] PreparedStatement : [select distinct a.*, b.TINHTRANG AS TINHTRANG_MG, d.TINHTRANG_BHTN, e.TINHTRANG_MGCT        , b.MIENGIAMCHITIET_ID, b.GIATRIMIENGIAM, d.GIATRIMIENGIAM_BHTN, e.GIATRIMIENGIAM_CONGTY, e.GIATRIMIENGIAM_CONGTY as GIATRIMIENGIAM_CTCT, f.GIATRIMIENGIAM_THANHVIEN        , c.DVKEMTHEO, c.DVKEMTHEO_KHACEKIP, isnull(ttnt.PHONGBANRATOA_ID,c.NOIYEUCAU_ID) NOIYEUCAU_ID, c.NOITHUCHIEN_ID, c.DVYEUCAU_ID, c.HUYYEUCAU, c.DANGKY_ID,        isnull(dv.TENDICHVU, dc.TENDUOCDAYDU) NOIDUNG, isnull(dv.MADICHVU, dc.MADUOC) MADICHVU, dv.NORESULT, dc.DONVITINH, ld.MALOAIDUOC, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ndv.MANHOMDICHVU,        dv.BHYT DV_BHYT        from        (select VP.*, sbh.SOBHYT as SOBHYT_HUONG        from TT_VIENPHI VP        left join TT_TIEPNHAN_SOTHEBHYT sbh on sbh.SOBHYT_HUONG_ID = VP.SOBHYT_HUONG_ID        where        ((isnull(VP.GIATRI_BENHNHAN_DATHANHTOAN, 0) = 0 and isnull(VP.DATHANHTOAN, 0) = 0)        and VP.REF_TABLE != 'TT_MAU_CHUNGTU_CHITIET'                 )         and           VP.TIEPNHAN_ID = '107181'         and           VP.BENHAN_ID = '24642'         and           VP.BENHVIEN_ID = 'HLU01'                 )a left join                   (        select VIENPHI_ID, MG.TINHTRANG, MGCT.MIENGIAMCHITIET_ID, Sum(MGCT.GIATRIMIENGIAM) as GIATRIMIENGIAM        from TT_MIENGIAM MG INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_ID = MGCT.MIENGIAM_ID        where MG.TIEPNHAN_ID= '107181' and MGCT.REF_TABLE = 'TT_MIENGIAM'        group by VIENPHI_ID, MG.TINHTRANG, MGCT.MIENGIAMCHITIET_ID        )b        on a.VIENPHI_ID = b.VIENPHI_ID          left join(        select VIENPHI_ID, MG.TINHTRANG AS TINHTRANG_BHTN, SUM(MGCT.GIATRIMIENGIAM) as GIATRIMIENGIAM_BHTN        from TT_MIENGIAM_BHTN MG INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_BHTN_ID = MGCT.MIENGIAM_ID        where MG.TIEPNHAN_ID= '107181' and MGCT.REF_TABLE = 'TT_MIENGIAM_BHTN'        group by VIENPHI_ID, MG.TINHTRANG        )d        on a.VIENPHI_ID = d.VIENPHI_ID          left join(        select VIENPHI_ID, MG.TINHTRANG AS TINHTRANG_MGCT, Sum(MGCT.GIATRIMIENGIAM) as GIATRIMIENGIAM_CONGTY        from TT_MIENGIAM_CONGTY MG INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_CONGTY_ID = MGCT.MIENGIAM_ID        where MG.TIEPNHAN_ID= '107181' and MGCT.REF_TABLE = 'TT_MIENGIAM_CONGTY'        group by VIENPHI_ID, MG.TINHTRANG        )e        on a.VIENPHI_ID = e.VIENPHI_ID          left join(        select VIENPHI_ID, MG.TINHTRANG AS TINHTRANG_MGCT, Sum(MGCT.GIATRIMIENGIAM) as GIATRIMIENGIAM_THANHVIEN        from TT_MIENGIAM_THANHVIEN MG INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_THANHVIEN_ID = MGCT.MIENGIAM_ID        where MG.TIEPNHAN_ID= '107181' and MGCT.REF_TABLE = 'TT_MIENGIAM_THANHVIEN'        group by VIENPHI_ID, MG.TINHTRANG        )f        on a.VIENPHI_ID = f.VIENPHI_ID          left join        (        select DVYEUCAU_ID, TRANGTHAI, BHYTDONGTIEN, HUYYEUCAU, DVKEMTHEO, DVKEMTHEO_KHACEKIP, NOIYEUCAU_ID, NOITHUCHIEN_ID, DANGKY_ID from TT_DVYEUCAU        where TIEPNHAN_ID = '107181'        )c on c.DVYEUCAU_ID = a.REF_ID and a.REF_TABLE = 'TT_DVYEUCAU'        left join        (        select PHONGBANRATOA_ID, TOATHUOC_ID, 'TT_NOITRU_TOATHUOC' REF_TABLE  from TT_NOITRU_TOATHUOC where TIEPNHAN_ID  = '107181'        union        select PHONGBAN_ID as PHONGBANRATOA_ID, CLSKETQUA_VTYT_ID as TOATHUOC_ID, 'TT_CLSKETQUA_VTYT' REF_TABLE        from TT_CLSKETQUA_VTYT where exists (select DVYEUCAU_ID from TT_DVYEUCAU where TT_CLSKETQUA_VTYT.DVYEUCAU_ID = DVYEUCAU_ID and TIEPNHAN_ID  = '107181')        union        select PHONGBAN_ID as PHONGBANRATOA_ID, KHAMBENH_VTYT_ID as TOATHUOC_ID, 'TT_NGOAITRU_KHAMBENH_VTYT' REF_TABLE        from TT_NGOAITRU_KHAMBENH_VTYT where exists (select DVYEUCAU_ID from TT_DVYEUCAU where TT_NGOAITRU_KHAMBENH_VTYT.DVYEUCAU_ID = DVYEUCAU_ID and  TIEPNHAN_ID  = '107181')        union        select B.PHONGBANTHUCHIEN_ID as PHONGBANRATOA_ID, PHAUTHUAT_VTYT_ID as TOATHUOC_ID, 'TT_PHAUTHUAT_VTYT' REF_TABLE        from TT_PHAUTHUAT_VTYT A        left join TT_PHAUTHUAT B on A.PHAUTHUAT_ID = B.PHAUTHUAT_ID        where B.TIEPNHAN_ID  = '107181'        union        select B.PHONGBAN_ID as PHONGBANRATOA_ID, TOATHUOC_ID, 'TT_NGOAITRU_TOATHUOC' REF_TABLE        from TT_NGOAITRU_TOATHUOC A        left join TT_NGOAITRU_KHAMBENH B on A.KHAMBENH_ID = B.KHAMBENH_ID        where B.TIEPNHAN_ID  = '107181'        ) ttnt on ttnt.TOATHUOC_ID = a.REF_ID and a.REF_TABLE = ttnt.REF_TABLE        left join TM_DUOC dc on A.DUOC_ID = dc.DUOC_ID        left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID        left join TM_DICHVU dv on A.DICHVU_ID = dv.DICHVU_ID and A.REF_TABLE = 'TT_DVYEUCAU'        left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID        where        c.HUYYEUCAU = '0' or c.HUYYEUCAU is null]
2020-02-26 15:41:35,506 [1] DEBUG - Statement Id: [DAO00330_TT_VIENPHI_GetList] PreparedStatement : [select distinct a.*, b.TINHTRANG AS TINHTRANG_MG, d.TINHTRANG_BHTN, e.TINHTRANG_MGCT      , b.MIENGIAMCHITIET_ID, b.GIATRIMIENGIAM, d.GIATRIMIENGIAM_BHTN, e.GIATRIMIENGIAM_CONGTY, e.GIATRIMIENGIAM_CONGTY as GIATRIMIENGIAM_CTCT, f.GIATRIMIENGIAM_THANHVIEN      , NULL AS DVKEMTHEO, NULL AS DVKEMTHEO_KHACEKIP, ttnt.PHONGBANRATOA_ID NOIYEUCAU_ID, NULL AS NOITHUCHIEN_ID, NULL AS DVYEUCAU_ID, 0 AS HUYYEUCAU, NULL AS DANGKY_ID,      dc.TENMAU NOIDUNG, dc.MAMAU MADICHVU, NULL AS NORESULT, DVT.TENDONVITINH AS DONVITINH, ld.MALOAIMAU AS MALOAIDUOC, DC.BHYT AS DUOC_BHYT, 'M' AS LOAIVATTU_ID,NM.TENNHOMMAU AS MANHOMDICHVU      from      (select VP.*, sbh.SOBHYT as SOBHYT_HUONG      from TT_VIENPHI VP      left join TT_TIEPNHAN_SOTHEBHYT sbh on sbh.SOBHYT_HUONG_ID = VP.SOBHYT_HUONG_ID      where (VP.GIATRI_BENHNHAN_DATHANHTOAN = 0 or VP.GIATRI_BENHNHAN_DATHANHTOAN is null)       and             VP.TIEPNHAN_ID = '107181'           and           VP.BENHAN_ID = '24642'         and             VP.BENHVIEN_ID = 'HLU01'                   )a left join                       (      select VIENPHI_ID, MG.TINHTRANG, MGCT.MIENGIAMCHITIET_ID, MGCT.GIATRIMIENGIAM      from TT_MIENGIAM MG INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_ID = MGCT.MIENGIAM_ID      where      MG.TIEPNHAN_ID= '107181' and MGCT.REF_TABLE = 'TT_MIENGIAM'      )b      on a.VIENPHI_ID = b.VIENPHI_ID        left join(      select VIENPHI_ID, MG.TINHTRANG AS TINHTRANG_BHTN, MGCT.GIATRIMIENGIAM as GIATRIMIENGIAM_BHTN      from TT_MIENGIAM_BHTN MG INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_BHTN_ID = MGCT.MIENGIAM_ID      where      MG.TIEPNHAN_ID= '107181' and MGCT.REF_TABLE = 'TT_MIENGIAM_BHTN'      )d      on a.VIENPHI_ID = d.VIENPHI_ID        left join(      select VIENPHI_ID, MG.TINHTRANG AS TINHTRANG_MGCT, MGCT.GIATRIMIENGIAM as GIATRIMIENGIAM_CONGTY      from TT_MIENGIAM_CONGTY MG INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_CONGTY_ID = MGCT.MIENGIAM_ID      where      MG.TIEPNHAN_ID= '107181' and MGCT.REF_TABLE = 'TT_MIENGIAM_CONGTY'      )e      on a.VIENPHI_ID = e.VIENPHI_ID        left join(      select VIENPHI_ID, MG.TINHTRANG AS TINHTRANG_MGCT, MGCT.GIATRIMIENGIAM as GIATRIMIENGIAM_THANHVIEN      from TT_MIENGIAM_THANHVIEN MG INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_THANHVIEN_ID = MGCT.MIENGIAM_ID      where      MG.TIEPNHAN_ID= '107181' and MGCT.REF_TABLE = 'TT_MIENGIAM_THANHVIEN'      )f      on a.VIENPHI_ID = f.VIENPHI_ID      inner join      (      select DK.NOICHIDINH_ID as PHONGBANRATOA_ID, CT.CHUNGTUCHITIET_ID, 'TT_MAU_CHUNGTU_CHITIET' REF_TABLE      from TT_MAU_DANGKYMAU DK JOIN TT_MAU_DANGKYMAU_CHITIET DKCT ON DK.DANGKYMAU_ID = DKCT.DANGKYMAU_ID AND DK.TIEPNHAN_ID  = '107181'      INNER JOIN TT_MAU_CHUNGTU CTU ON DKCT.CHUNGTU_ID = CTU.CHUNGTU_ID AND CTU.CHUNGTULIENQUAN_ID IS NULL      JOIN TT_MAU_CHUNGTU_CHITIET CT ON CT.CHUNGTU_ID=CTU.CHUNGTU_ID      ) ttnt on ttnt.CHUNGTUCHITIET_ID = a.REF_ID and a.REF_TABLE = ttnt.REF_TABLE      left join TM_MAU dc on A.DUOC_ID = dc.MAU_ID      LEFT JOIN TM_MAU_DONVITINH DVT ON DC.DONVITINH_ID = DVT.DONVITINH_ID      left join TM_MAU_LOAIMAU ld on dc.LOAIMAU_ID = ld.LOAIMAU_ID      LEFT JOIN TM_MAU_NHOMMAU NM ON NM.NHOMMAU_ID = LD.NHOMMAU_ID]
2020-02-26 15:41:35,983 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN200102.0000252']
2020-02-26 15:41:36,144 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"5440","DVYEUCAU_ID":"988882"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"5440","DVYEUCAU_ID":"988882"}' order by ID desc)        order by A.ID desc]
2020-02-26 15:41:43,434 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN200102.0000252']
2020-02-26 15:41:43,458 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"5554","DVYEUCAU_ID":"988883"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"5554","DVYEUCAU_ID":"988883"}' order by ID desc)        order by A.ID desc]
2020-02-26 15:41:43,521 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN200102.0000252']
2020-02-26 15:41:43,546 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"4022","DVYEUCAU_ID":"989243"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"4022","DVYEUCAU_ID":"989243"}' order by ID desc)        order by A.ID desc]
2020-02-26 15:41:46,716 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN200102.0000252']
2020-02-26 15:41:46,739 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"4422","DVYEUCAU_ID":"989244"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"4422","DVYEUCAU_ID":"989244"}' order by ID desc)        order by A.ID desc]
2020-02-26 15:41:46,999 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN200102.0000252']
2020-02-26 15:41:47,131 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"4451","DVYEUCAU_ID":"989245"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"4451","DVYEUCAU_ID":"989245"}' order by ID desc)        order by A.ID desc]
2020-02-26 15:41:47,347 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN200102.0000252']
2020-02-26 15:41:47,372 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"4454","DVYEUCAU_ID":"989246"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"4454","DVYEUCAU_ID":"989246"}' order by ID desc)        order by A.ID desc]
2020-02-26 15:41:47,588 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN200102.0000252']
2020-02-26 15:41:47,613 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"4523","DVYEUCAU_ID":"989247"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"4523","DVYEUCAU_ID":"989247"}' order by ID desc)        order by A.ID desc]
2020-02-26 15:41:47,969 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN200102.0000252']
2020-02-26 15:41:48,041 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"4596","DVYEUCAU_ID":"989248"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"4596","DVYEUCAU_ID":"989248"}' order by ID desc)        order by A.ID desc]
2020-02-26 15:41:48,236 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN200102.0000252']
2020-02-26 15:41:48,261 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"4642","DVYEUCAU_ID":"989250"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"4642","DVYEUCAU_ID":"989250"}' order by ID desc)        order by A.ID desc]
2020-02-26 15:41:48,463 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN200102.0000252']
2020-02-26 15:41:48,630 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"4681","DVYEUCAU_ID":"989252"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"4681","DVYEUCAU_ID":"989252"}' order by ID desc)        order by A.ID desc]
2020-02-26 15:41:48,816 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN200102.0000252']
2020-02-26 15:41:48,841 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"4722","DVYEUCAU_ID":"989253"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"4722","DVYEUCAU_ID":"989253"}' order by ID desc)        order by A.ID desc]
2020-02-26 15:41:49,017 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN200102.0000252']
2020-02-26 15:41:49,041 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"4747","DVYEUCAU_ID":"989254"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"4747","DVYEUCAU_ID":"989254"}' order by ID desc)        order by A.ID desc]
2020-02-26 15:41:49,256 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN200102.0000252']
2020-02-26 15:41:49,306 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"5363","DVYEUCAU_ID":"992248"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"5363","DVYEUCAU_ID":"992248"}' order by ID desc)        order by A.ID desc]
2020-02-26 15:41:49,484 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN200102.0000252']
2020-02-26 15:41:49,646 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"5588","DVYEUCAU_ID":"992249"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"5588","DVYEUCAU_ID":"992249"}' order by ID desc)        order by A.ID desc]
2020-02-26 15:41:49,810 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN200102.0000252']
2020-02-26 15:41:49,834 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"477","DVYEUCAU_ID":"992250"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"477","DVYEUCAU_ID":"992250"}' order by ID desc)        order by A.ID desc]
2020-02-26 15:41:50,001 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN200102.0000252']
2020-02-26 15:41:50,025 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"5602","DVYEUCAU_ID":"992251"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"5602","DVYEUCAU_ID":"992251"}' order by ID desc)        order by A.ID desc]
2020-02-26 15:41:50,187 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN200102.0000252']
2020-02-26 15:41:50,211 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"3161","DVYEUCAU_ID":"992253"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"3161","DVYEUCAU_ID":"992253"}' order by ID desc)        order by A.ID desc]
2020-02-26 15:41:50,542 [1] DEBUG - Statement Id: [DAO00017_GetLoaiGiaDoiTuongDichVu] PreparedStatement : [select a.LOAIGIA_ID, a.TENLOAIGIA, a.MALOAIGIA, a.CAPTREN_ID, MIN(a.UUTIEN_NGUON) AS UUTIEN_NGUON          , MAX(a.DOUUTIEN) AS DOUUTIEN, MIN(ISNULL(a.GIAHOTRO,0)) AS GIAHOTRO          from(                        select distinct A.LOAIGIA_ID, C.TENLOAIGIA, C.MALOAIGIA, 0 as UUTIEN_NGUON, isnull(B.DOUUTIEN,0) as DOUUTIEN, B.GIAHOTRO, C.CAPTREN_ID            from TM_DOITUONG_GIADICHVU A            left join TM_DOITUONG_LOAIGIA B on A.LOAIGIA_ID = B.LOAIGIA_ID and A.DOITUONG_ID = B.DOITUONG_ID and B.BENHVIEN_ID = 'HLU01'            inner join TM_LOAIGIA C on A.LOAIGIA_ID = C.LOAIGIA_ID and C.BENHVIEN_ID = 'HLU01'            where A.DOITUONG_ID = '4'                            and C.CAPTREN_ID = (select LOAIGIA_ID from TM_LOAIGIA              where MALOAIGIA = 'GiaDichVu'              and BENHVIEN_ID = 'HLU01')                         and A.BENHVIEN_ID = 'HLU01'                     ) a          where a.DOUUTIEN != 0 and a.DOUUTIEN is not null          group by a.LOAIGIA_ID, a.TENLOAIGIA, a.MALOAIGIA, a.CAPTREN_ID          order by MAX(a.UUTIEN_NGUON) desc ,MAX(a.DOUUTIEN) asc]
2020-02-26 15:41:50,815 [1] DEBUG - Statement Id: [DAO00019_Get_TiepNhan_ThongtinChuyenVien] PreparedStatement : [select CHANDOANNGT, ICDNOIGIOITHIEU_ID, LYDOCHUYENVIEN_ID, NOIGIOITHIEU_ID, HINHTHUCCHUYENVIEN_ID, THOIGIANCHUYENTUYEN, SOCHUYENVIEN        from TT_TIEPNHAN        where TIEPNHAN_ID = '107181']
2020-02-26 15:41:50,841 [1] DEBUG - Statement Id: [DAO00019_GetBenhNhanThanhVien] PreparedStatement : [select A.*, B.TENTHETHANHVIEN, convert(varchar, A.NGAYHIEULUC, 103) as NGAYHIEULUCTHE, B.SOTIEN        from TT_CSKH_THANHVIEN_CAPTHE A        left join TM_CSKH_THETHANHVIEN B on B.THETHANHVIEN_ID = A.THETHANHVIEN_ID        where   THANHVIEN_ID in (        select THANHVIEN_ID from TT_CSKH_THANHVIEN        where (BENHNHAN_ID = '20633' and TAMNGUNG is null or TAMNGUNG = '0')        and (DAXOA is null or DAXOA = '0'))        and A.KICHHOAT = '1' and (A.TAMNGUNG = '0' or A.TAMNGUNG is null)                 and A.BENHVIEN_ID = 'HLU01'        order by THE_ID desc]
2020-02-26 15:41:50,890 [1] DEBUG - Statement Id: [DAO00019_GetBenhNhanThanhVien] PreparedStatement : [select A.*, B.TENTHETHANHVIEN, convert(varchar, A.NGAYHIEULUC, 103) as NGAYHIEULUCTHE, B.SOTIEN        from TT_CSKH_THANHVIEN_CAPTHE A        left join TM_CSKH_THETHANHVIEN B on B.THETHANHVIEN_ID = A.THETHANHVIEN_ID        where   THANHVIEN_ID in (        select THANHVIEN_ID from TT_CSKH_THANHVIEN        where (BENHNHAN_ID = '20633' and TAMNGUNG is null or TAMNGUNG = '0')        and (DAXOA is null or DAXOA = '0'))        and A.KICHHOAT = '1' and (A.TAMNGUNG = '0' or A.TAMNGUNG is null)                 and A.BENHVIEN_ID = 'HLU01'        order by THE_ID desc]
2020-02-26 15:43:41,588 [1] DEBUG - Statement Id: [DAO00017_GetLoaiGiaDoiTuongDichVu] PreparedStatement : [select a.LOAIGIA_ID, a.TENLOAIGIA, a.MALOAIGIA, a.CAPTREN_ID, MIN(a.UUTIEN_NGUON) AS UUTIEN_NGUON          , MAX(a.DOUUTIEN) AS DOUUTIEN, MIN(ISNULL(a.GIAHOTRO,0)) AS GIAHOTRO          from(                        select distinct A.LOAIGIA_ID, C.TENLOAIGIA, C.MALOAIGIA, 0 as UUTIEN_NGUON, isnull(B.DOUUTIEN,0) as DOUUTIEN, B.GIAHOTRO, C.CAPTREN_ID            from TM_DOITUONG_GIADICHVU A            left join TM_DOITUONG_LOAIGIA B on A.LOAIGIA_ID = B.LOAIGIA_ID and A.DOITUONG_ID = B.DOITUONG_ID and B.BENHVIEN_ID = 'HLU01'            inner join TM_LOAIGIA C on A.LOAIGIA_ID = C.LOAIGIA_ID and C.BENHVIEN_ID = 'HLU01'            where A.DOITUONG_ID = '4'                            and C.CAPTREN_ID = (select LOAIGIA_ID from TM_LOAIGIA              where MALOAIGIA = 'GiaDichVu'              and BENHVIEN_ID = 'HLU01')                         and A.BENHVIEN_ID = 'HLU01'                     ) a          where a.DOUUTIEN != 0 and a.DOUUTIEN is not null          group by a.LOAIGIA_ID, a.TENLOAIGIA, a.MALOAIGIA, a.CAPTREN_ID          order by MAX(a.UUTIEN_NGUON) desc ,MAX(a.DOUUTIEN) asc]
2020-02-26 15:43:43,215 [1] DEBUG - Statement Id: [DAO00017_GetLoaiGiaDoiTuongDichVu] PreparedStatement : [select a.LOAIGIA_ID, a.TENLOAIGIA, a.MALOAIGIA, a.CAPTREN_ID, MIN(a.UUTIEN_NGUON) AS UUTIEN_NGUON          , MAX(a.DOUUTIEN) AS DOUUTIEN, MIN(ISNULL(a.GIAHOTRO,0)) AS GIAHOTRO          from(                        select distinct A.LOAIGIA_ID, C.TENLOAIGIA, C.MALOAIGIA, 0 as UUTIEN_NGUON, isnull(B.DOUUTIEN,0) as DOUUTIEN, B.GIAHOTRO, C.CAPTREN_ID            from TM_DOITUONG_GIADICHVU A            left join TM_DOITUONG_LOAIGIA B on A.LOAIGIA_ID = B.LOAIGIA_ID and A.DOITUONG_ID = B.DOITUONG_ID and B.BENHVIEN_ID = 'HLU01'            inner join TM_LOAIGIA C on A.LOAIGIA_ID = C.LOAIGIA_ID and C.BENHVIEN_ID = 'HLU01'            where A.DOITUONG_ID = '4'                            and C.CAPTREN_ID = (select LOAIGIA_ID from TM_LOAIGIA              where MALOAIGIA = 'GiaDichVu'              and BENHVIEN_ID = 'HLU01')                         and A.BENHVIEN_ID = 'HLU01'                     ) a          where a.DOUUTIEN != 0 and a.DOUUTIEN is not null          group by a.LOAIGIA_ID, a.TENLOAIGIA, a.MALOAIGIA, a.CAPTREN_ID          order by MAX(a.UUTIEN_NGUON) desc ,MAX(a.DOUUTIEN) asc]
2020-02-26 15:43:43,366 [1] DEBUG - Statement Id: [DAO00017_GetLoaiGiaDuocByDoiTuongId] PreparedStatement : [select A.LOAIGIA_ID, C.TENLOAIGIA from TM_DOITUONG_LOAIGIA A          inner join TM_LOAIGIA C on A.LOAIGIA_ID = C.LOAIGIA_ID          where A.DOITUONG_ID = '4'          and C.CAPTREN_ID = (select LOAIGIA_ID from TM_LOAIGIA where MALOAIGIA = 'Giathuoc' and BENHVIEN_ID = 'HLU01')]
2020-02-26 15:43:56,548 [1] DEBUG - Statement Id: [DAO00017_GetLoaiGiaDoiTuongDichVu] PreparedStatement : [select a.LOAIGIA_ID, a.TENLOAIGIA, a.MALOAIGIA, a.CAPTREN_ID, MIN(a.UUTIEN_NGUON) AS UUTIEN_NGUON          , MAX(a.DOUUTIEN) AS DOUUTIEN, MIN(ISNULL(a.GIAHOTRO,0)) AS GIAHOTRO          from(                        select distinct A.LOAIGIA_ID, C.TENLOAIGIA, C.MALOAIGIA, 0 as UUTIEN_NGUON, isnull(B.DOUUTIEN,0) as DOUUTIEN, B.GIAHOTRO, C.CAPTREN_ID            from TM_DOITUONG_GIADICHVU A            left join TM_DOITUONG_LOAIGIA B on A.LOAIGIA_ID = B.LOAIGIA_ID and A.DOITUONG_ID = B.DOITUONG_ID and B.BENHVIEN_ID = 'HLU01'            inner join TM_LOAIGIA C on A.LOAIGIA_ID = C.LOAIGIA_ID and C.BENHVIEN_ID = 'HLU01'            where A.DOITUONG_ID = '4'                            and C.CAPTREN_ID = (select LOAIGIA_ID from TM_LOAIGIA              where MALOAIGIA = 'GiaDichVu'              and BENHVIEN_ID = 'HLU01')                         and A.BENHVIEN_ID = 'HLU01'                     ) a          where a.DOUUTIEN != 0 and a.DOUUTIEN is not null          group by a.LOAIGIA_ID, a.TENLOAIGIA, a.MALOAIGIA, a.CAPTREN_ID          order by MAX(a.UUTIEN_NGUON) desc ,MAX(a.DOUUTIEN) asc]
2020-02-26 15:43:57,585 [1] DEBUG - Statement Id: [DAO00017_GetLoaiGiaDuocByDoiTuongId] PreparedStatement : [select A.LOAIGIA_ID, C.TENLOAIGIA from TM_DOITUONG_LOAIGIA A          inner join TM_LOAIGIA C on A.LOAIGIA_ID = C.LOAIGIA_ID          where A.DOITUONG_ID = '4'          and C.CAPTREN_ID = (select LOAIGIA_ID from TM_LOAIGIA where MALOAIGIA = 'Giathuoc' and BENHVIEN_ID = 'HLU01')]
2020-02-26 15:44:06,957 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'PHA07'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 15:44:07,511 [1] DEBUG - Statement Id: [DAO00030_GetPhamViByKhoDuoc] PreparedStatement : [SELECT DISTINCT pv.PHAMVI_ID          FROM TM_DUOC_PHAMVISD_MAPPING mp          INNER JOIN TM_DUOC_PHAMVISUDUNG pv ON mp.PHAMVI_ID = pv.PHAMVI_ID          WHERE          mp.KHODUOC_ID IN (1)          AND mp.BENHVIEN_ID ='HLU01'          AND mp.TAMNGUNG = '0'          AND pv.TAMNGUNG = '0']
2020-02-26 15:44:07,551 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 999999999 as SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        where  @param0  = 0        union all        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end        else        begin        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO        group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end]
2020-02-26 15:44:07,552 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Parameters: [@param0=[PHAMVI_ID,1027]]
2020-02-26 15:44:07,552 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Types: [@param0=[Int64, System.Int64]]
2020-02-26 15:44:08,128 [1] DEBUG - Statement Id: [DAO00030_GetPhamViByKhoDuoc] PreparedStatement : [SELECT DISTINCT pv.PHAMVI_ID          FROM TM_DUOC_PHAMVISD_MAPPING mp          INNER JOIN TM_DUOC_PHAMVISUDUNG pv ON mp.PHAMVI_ID = pv.PHAMVI_ID          WHERE          mp.KHODUOC_ID IN (1)          AND mp.BENHVIEN_ID ='HLU01'          AND mp.TAMNGUNG = '0'          AND pv.TAMNGUNG = '0']
2020-02-26 15:44:08,155 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 999999999 as SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        where  @param0  = 0        union all        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end        else        begin        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO        group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end]
2020-02-26 15:44:08,156 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Parameters: [@param0=[PHAMVI_ID,1027]]
2020-02-26 15:44:08,156 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Types: [@param0=[Int64, System.Int64]]
2020-02-26 15:44:08,220 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 999999999 as SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        where  @param0  = 0        union all        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end        else        begin        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO        group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end]
2020-02-26 15:44:08,221 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Parameters: [@param0=[PHAMVI_ID,1027]]
2020-02-26 15:44:08,221 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Types: [@param0=[Int64, System.Int64]]
2020-02-26 15:44:40,615 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'PHA51'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 15:44:40,781 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM98'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 15:44:41,261 [1] DEBUG - Statement Id: [DAO00030_GetPhamViByKhoDuoc] PreparedStatement : [SELECT DISTINCT pv.PHAMVI_ID          FROM TM_DUOC_PHAMVISD_MAPPING mp          INNER JOIN TM_DUOC_PHAMVISUDUNG pv ON mp.PHAMVI_ID = pv.PHAMVI_ID          WHERE          mp.KHODUOC_ID IN (1)          AND mp.BENHVIEN_ID ='HLU01'          AND mp.TAMNGUNG = '0'          AND pv.TAMNGUNG = '0']
2020-02-26 15:44:41,287 [1] DEBUG - Statement Id: [DAO00030_LAPPHIEULINH_TOA_NOITRU] PreparedStatement : [declare @TuNgay datetime = CONVERT(date, '2/26/2020 12:00:00 AM')            declare @DenNgay datetime = CONVERT(date, DATEADD(day, 1, '2/26/2020 12:00:00 AM'))              SELECT            TT.KHAMBENH_ID,            TT.TOATHUOC_ID as TOATHUOC_ID,            TT.SOTHUTUTOA as REF_ID,            N'Người bệnh: ' + BN.MAYTE + ' - ' + BN.TENBENHNHAN            + CASE WHEN BN.GIOITINH = 1 THEN N' - Nam ' WHEN BN.GIOITINH = 2 THEN N' - Nữ ' END            + CASE WHEN BN.NGAYSINH IS NOT NULL THEN ' - ' + CONVERT(VARCHAR(10), BN.NGAYSINH, 103) ELSE ' - ' + CONVERT(VARCHAR(10), BN.NAMSINH) END            + CASE WHEN BA.SOBENHAN IS NOT NULL THEN N' - Mã bệnh án: ' + BA.SOBENHAN  ELSE N'' END            + CASE WHEN dt.TENDOITUONG IS NOT NULL THEN N' - ' + dt.TENDOITUONG  ELSE '' END            as BENHNHAN,            N'Y lệnh: ' + TT.SOTHUTUTOA + ' - ' + CONVERT(VARCHAR(10), KB.THOIGIANKHAM, 103) + ' - ' + CONVERT(VARCHAR(5), KB.THOIGIANKHAM, 108)  + N' - Người lập: ' + NV.TENNHANVIEN  AS YLENH,            TT.DUOC_ID,            D.TENDUOCDAYDU,            D.DONVITINH,            TT.SOLUONG as SOLUONGYEUCAU,            NLD.TENNHOMLOAIDUOC,            TT.KHOPHAT_ID,            TT.NGAYTAO,            'KHAMBENH' as LOAIPHIEU            FROM            TT_NOITRU_TOATHUOC TT            left join TT_BENHNHAN BN on TT.BENHNHAN_ID = BN.BENHNHAN_ID            left join TT_NOITRU_KHAMBENH KB on KB.KHAMBENH_ID = TT.KHAMBENH_ID            left join TT_NOITRU_BENHAN BA on BA.BENHAN_ID = KB.BENHAN_ID            left join TM_DOITUONG dt on BA.DOITUONG_ID = dt.DOITUONG_ID            left join TM_DUOC D on D.DUOC_ID = TT.DUOC_ID            left join TM_LOAIDUOC LD on LD.LOAIDUOC_ID = D.LOAIDUOC_ID            left join TM_NHOMLOAIDUOC NLD on NLD.NHOMLOAIDUOC_ID = LD.NHOMLOAIDUOC_ID            left join TM_NHANVIEN NV on TT.NGUOITAO_ID = NV.NHANVIEN_ID            WHERE            KB.NGAYKHAM >= @TuNgay AND KB.NGAYKHAM < @DenNgay             and             TT.PHAMVI_ID =1027             and             TT.KHOTAO_ID =29                          AND TT.COSO = 0            AND TT.PHONGBANRATOA_ID = 25            AND TT.PHIEULINH_ID is NULL            AND TT.BENHVIEN_ID = 'HLU01'            AND (BN.TENBENHNHAN like N'%%' OR BN.MAYTE like N'%%' OR BA.SOBENHAN  like N'%%' or D.TENDUOCDAYDU like N'%%')             and                 LD.LOAIVATTU_ID = 'T'             and               BA.TRANGTHAI = 'DANGDIEUTRI'             and               KB.RAVIEN = '0'                           order by NGAYTAO DESC]
2020-02-26 15:45:41,423 [1] DEBUG - Statement Id: [DAO00030_LAPPHIEULINH_KHAMBENH_VTYT] PreparedStatement : [declare @TuNgay datetime = CONVERT(date, '2/26/2020 12:00:00 AM')          declare @DenNgay datetime = CONVERT(date, DATEADD(day, 1, '2/26/2020 12:00:00 AM'))            SELECT          TT.KHAMBENH_ID,          TT.KHAMBENH_VTYT_ID as TOATHUOC_ID,          TT.KHAMBENH_ID as REF_ID,          N'Người bệnh: ' + BN.MAYTE + ' - ' + BN.TENBENHNHAN          + CASE WHEN BN.GIOITINH = 1 THEN N' - Nam ' WHEN BN.GIOITINH = 2 THEN N' - Nữ ' END          + CASE WHEN BN.NGAYSINH IS NOT NULL THEN ' - ' + CONVERT(VARCHAR(10), BN.NGAYSINH, 103) ELSE ' - ' + CONVERT(VARCHAR(10), BN.NAMSINH) END          + CASE WHEN TN.SOTIEPNHAN IS NOT NULL THEN N' - Số tiếp nhận: ' + TN.SOTIEPNHAN  ELSE N'' END          + CASE WHEN dt.TENDOITUONG IS NOT NULL THEN N' - ' + dt.TENDOITUONG  ELSE '' END          as BENHNHAN,          N'Y lệnh: ' + CAST(TT.KHAMBENH_VTYT_ID as nvarchar(10)) + ' - ' + CONVERT(VARCHAR(10), KB.THOIGIANKHAM, 103) + ' - ' + CONVERT(VARCHAR(5), KB.THOIGIANKHAM, 108)  + N' - Người lập: ' + NV.TENNHANVIEN  AS YLENH,          TT.DUOC_ID,          D.TENDUOCDAYDU,          D.DONVITINH,          TT.SOLUONG as SOLUONGYEUCAU,          NLD.TENNHOMLOAIDUOC,          TT.KHOTAO_ID KHOPHAT_ID,          TT.KHOSUDUNG_ID,          TT.NGAYTAO,          'TT_NGOAITRU_KHAMBENH_VTYT' as LOAIPHIEU          FROM          TT_NGOAITRU_KHAMBENH_VTYT TT          left join TT_NGOAITRU_KHAMBENH KB on KB.KHAMBENH_ID = TT.KHAMBENH_ID          left join TT_BENHNHAN BN on KB.BENHNHAN_ID = BN.BENHNHAN_ID          left join TT_TIEPNHAN TN on TN.TIEPNHAN_ID = KB.TIEPNHAN_ID          left join TM_DOITUONG dt on TN.DOITUONG_ID = dt.DOITUONG_ID          left join TM_DUOC D on D.DUOC_ID = TT.DUOC_ID          left join TM_LOAIDUOC LD on LD.LOAIDUOC_ID = D.LOAIDUOC_ID          left join TM_NHOMLOAIDUOC NLD on NLD.NHOMLOAIDUOC_ID = LD.NHOMLOAIDUOC_ID          left join TM_NHANVIEN NV on TT.NGUOITAO_ID = NV.NHANVIEN_ID          WHERE                  TT.NGAYSUDUNG >= @TuNgay AND TT.NGAYSUDUNG < @DenNgay           and             TT.PHAMVI_ID =1027           and             TT.COSO =0                     AND KB.PHONGBAN_ID = 25          AND TT.PHIEULINH_ID is NULL          AND (TN.TRANGTHAI NOT IN ('HOANTHANH') OR (0 = 1 AND TN.TRANGTHAI = 'HOANTHANH'))          AND TT.BENHVIEN_ID = 'HLU01'          AND (BN.TENBENHNHAN like N'%%' OR BN.MAYTE like N'%%' OR D.TENDUOCDAYDU like N'%%')           and             LD.LOAIVATTU_ID = 'T'                     order by NGAYTAO DESC]
2020-02-26 15:45:42,513 [1] DEBUG - Statement Id: [DAO00030_DUOCTONKHO_GetSoTonTheoDuoc] PreparedStatement : [SELECT              DUOC_ID,              SUM(SOLUONG) AS TONGTON              FROM              TT_DUOC_TONKHO              WHERE              KHODUOC_ID = '1'              and BENHVIEN_ID = 'HLU01'              and DUOC_ID IN (1030,1030,1030,1030)              GROUP BY DUOC_ID]
2020-02-26 15:45:46,649 [1] DEBUG - Statement Id: [DAO00030_DUOC_KiemTraTamNgung] PreparedStatement : [SELECT DUOC_ID,TAMNGUNG          FROM          TM_DUOC          WHERE          DUOC_ID IN (1030,1030,1030,1030)]
2020-02-26 15:45:46,705 [1] DEBUG - Statement Id: [DAO00030_LAPPHIEULINH_TONGHOPTUYLENH] PreparedStatement : [SELECT DISTINCT            TT.TOATHUOC_ID,            KB.KHAMBENH_ID AS MASTER_ID,            TT.SOTHUTUTOA,            LTRIM(TT.PHAMVI_ID) + '_' + LTRIM(TT.DUOC_ID) + '_' + LTRIM(TT.NGUONDUOC_ID) as DUOC_KEY,            TT.DUOC_ID,            D.TENDUOCDAYDU,            D.DONVITINH_ID,            D.DONVITINH,            TT.SOLUONG as SOLUONGYEUCAU,            LD.MALOAIDUOC,            NLD.TENNHOMLOAIDUOC,            TT.NGUONDUOC_ID AS NGUONHANG_ID,            TN.SOTIEPNHAN,            BN.TENBENHNHAN,            N'Người bệnh: ' + BN.MAYTE + ' - ' + BN.TENBENHNHAN + ' - ' + N'Thời gian Y lệnh: ' + CONVERT(VARCHAR(10), KB.THOIGIANKHAM, 103) + ' - ' + CONVERT(VARCHAR(5), KB.THOIGIANKHAM, 108) as BENHNHAN,            TT.NGAYTAO,            'TT_NOITRU_TOATHUOC' as LOAIPHIEU,            TT.NGAYCAPNHAT as REF_NGAYCAPNHAT            FROM            TT_NOITRU_TOATHUOC TT            left join TT_NOITRU_KHAMBENH KB on TT.KHAMBENH_ID = KB.KHAMBENH_ID            left join TT_NOITRU_BENHAN BA on  KB.BENHAN_ID = BA.BENHAN_ID            left join TT_BENHNHAN BN on  TT.BENHNHAN_ID = BN.BENHNHAN_ID            left join TT_TIEPNHAN TN on TT.TIEPNHAN_ID = TN.TIEPNHAN_ID            left join TM_DUOC D on D.DUOC_ID = TT.DUOC_ID            left join TM_LOAIDUOC LD on LD.LOAIDUOC_ID = D.LOAIDUOC_ID            left join TM_NHOMLOAIDUOC NLD on NLD.NHOMLOAIDUOC_ID = LD.NHOMLOAIDUOC_ID            WHERE            TT.BENHVIEN_ID = 'HLU01'            AND TT.PHIEULINH_ID is NULL            AND TT.TOATHUOC_ID IN (1886259,1886258,1886257,1886256)            AND TT.SOTHUTUTOA IN (2002260002,2002260002,2002260001,2002260001)              union all              SELECT DISTINCT            VT.PHAUTHUAT_VTYT_ID AS TOATHUOC_ID,            PT.PHAUTHUAT_ID AS MASTER_ID,            1 as SOTHUTUTOA,            LTRIM(VT.PHAMVI_ID) + '_' + LTRIM(VT.DUOC_ID) + '_' + LTRIM(VT.NGUONHANG_ID) as DUOC_KEY,            VT.DUOC_ID,            D.TENDUOCDAYDU,            D.DONVITINH_ID,            D.DONVITINH,            VT.SOLUONG as SOLUONGYEUCAU,            LD.MALOAIDUOC,            NLD.TENNHOMLOAIDUOC,            VT.NGUONHANG_ID,            TN.SOTIEPNHAN,            BN.TENBENHNHAN,            N'Người bệnh: ' + BN.MAYTE + ' - ' + BN.TENBENHNHAN + ' - '            + N'Thời gian ghi nhận: ' + CONVERT(VARCHAR(10), VT.NGAYTAO, 103) + ' - ' + CONVERT(VARCHAR(5), VT.NGAYTAO, 108) as BENHNHAN,            VT.NGAYTAO,            'TT_PHAUTHUAT_VTYT' as LOAIPHIEU,            VT.NGAYCAPNHAT as REF_NGAYCAPNHAT            FROM            TT_PHAUTHUAT_VTYT VT            left join TT_PHAUTHUAT PT on PT.PHAUTHUAT_ID = VT.PHAUTHUAT_ID            left join TT_PHAUTHUAT_EKIP EK on PT.PHAUTHUAT_ID = EK.PHAUTHUAT_ID            left join TT_TIEPNHAN TN on TN.TIEPNHAN_ID = PT.TIEPNHAN_ID            left join TT_BENHNHAN BN on BN.BENHNHAN_ID = TN.BENHNHAN_ID            left join TM_DUOC D on D.DUOC_ID = VT.DUOC_ID            left join TM_LOAIDUOC LD on LD.LOAIDUOC_ID = D.LOAIDUOC_ID            left join TM_NHOMLOAIDUOC NLD on NLD.NHOMLOAIDUOC_ID = LD.NHOMLOAIDUOC_ID            WHERE            VT.PHAUTHUAT_VTYT_ID IN (1886259,1886258,1886257,1886256)            AND PT.PHAUTHUAT_ID IN (2002260002,2002260002,2002260001,2002260001)            AND VT.BENHVIEN_ID = 'HLU01'              union all              SELECT DISTINCT            CLS.CLSKETQUA_VTYT_ID AS TOATHUOC_ID,            DV.DVYEUCAU_ID AS MASTER_ID,            0 as SOTHUTUTOA,            LTRIM(CLS.PHAMVI_ID) + '_' + LTRIM(CLS.DUOC_ID) + '_' + LTRIM(CLS.NGUONHANG_ID) as DUOC_KEY,            CLS.DUOC_ID,            D.TENDUOCDAYDU,            D.DONVITINH_ID,            D.DONVITINH,            CLS.SOLUONG as SOLUONGYEUCAU,            LD.MALOAIDUOC,            NLD.TENNHOMLOAIDUOC,            CLS.NGUONHANG_ID,            TN.SOTIEPNHAN,            BN.TENBENHNHAN,            N'Người bệnh: ' + BN.MAYTE + ' - ' + BN.TENBENHNHAN + ' - ' +            N'Thời gian ghi nhận: ' +  CONVERT(VARCHAR(10), cls.NGAYTAO, 103) + ' - ' + CONVERT(VARCHAR(5), cls.NGAYTAO, 108) AS BENHNHAN,            CLS.NGAYTAO,            'TT_CLSKETQUA_VTYT' as LOAIPHIEU,            CLS.NGAYCAPNHAT as REF_NGAYCAPNHAT            FROM            TT_CLSKETQUA_VTYT CLS            left join TT_CLSKETQUA KQ on KQ.CLSKETQUA_ID = CLS.CLSKETQUA_ID            left join TT_DVYEUCAU DV on DV.DVYEUCAU_ID = CLS.DVYEUCAU_ID            left join TT_BENHNHAN BN on DV.BENHNHAN_ID = BN.BENHNHAN_ID            left join TT_TIEPNHAN TN on TN.TIEPNHAN_ID = DV.TIEPNHAN_ID            left join TM_DUOC D on D.DUOC_ID = CLS.DUOC_ID            left join TM_LOAIDUOC LD on LD.LOAIDUOC_ID = D.LOAIDUOC_ID            left join TM_NHOMLOAIDUOC NLD on NLD.NHOMLOAIDUOC_ID = LD.NHOMLOAIDUOC_ID            WHERE            CLS.BENHVIEN_ID = 'HLU01'            AND CLS.CLSKETQUA_VTYT_ID IN (1886259,1886258,1886257,1886256)            AND DV.DVYEUCAU_ID IN (2002260002,2002260002,2002260001,2002260001)              UNION  ALL              SELECT DISTINCT            TT.KHAMBENH_VTYT_ID TOATHUOC_ID,            KB.KHAMBENH_ID AS MASTER_ID,            TT.KHAMBENH_VTYT_ID SOTHUTUTOA,            LTRIM(TT.PHAMVI_ID) + '_' + LTRIM(TT.DUOC_ID) + '_' + LTRIM(TT.NGUONHANG_ID) as DUOC_KEY,            TT.DUOC_ID,            D.TENDUOCDAYDU,            D.DONVITINH_ID,            D.DONVITINH,            TT.SOLUONG as SOLUONGYEUCAU,            LD.MALOAIDUOC,            NLD.TENNHOMLOAIDUOC,            TT.NGUONHANG_ID AS NGUONHANG_ID,            TN.SOTIEPNHAN,            BN.TENBENHNHAN,            N'Người bệnh: ' + BN.MAYTE + ' - ' + BN.TENBENHNHAN + ' - ' + N'Thời gian Y lệnh: ' + CONVERT(VARCHAR(10), KB.THOIGIANKHAM, 103) + ' - ' + CONVERT(VARCHAR(5), KB.THOIGIANKHAM, 108) as BENHNHAN,            TT.NGAYTAO,            'TT_NGOAITRU_KHAMBENH_VTYT' as LOAIPHIEU,            TT.NGAYCAPNHAT as REF_NGAYCAPNHAT            FROM            TT_NGOAITRU_KHAMBENH_VTYT TT            left join TT_NGOAITRU_KHAMBENH KB on KB.KHAMBENH_ID = TT.KHAMBENH_ID            left join TT_BENHNHAN BN on  KB.BENHNHAN_ID = BN.BENHNHAN_ID            left join TT_TIEPNHAN TN on KB.TIEPNHAN_ID = TN.TIEPNHAN_ID            left join TM_DUOC D on D.DUOC_ID = TT.DUOC_ID            left join TM_LOAIDUOC LD on LD.LOAIDUOC_ID = D.LOAIDUOC_ID            left join TM_NHOMLOAIDUOC NLD on NLD.NHOMLOAIDUOC_ID = LD.NHOMLOAIDUOC_ID              WHERE            TT.BENHVIEN_ID = 'HLU01'            AND TT.PHIEULINH_ID is NULL            AND TT.KHAMBENH_VTYT_ID IN (1886259,1886258,1886257,1886256)            AND KB.KHAMBENH_ID IN (2002260002,2002260002,2002260001,2002260001)              UNION ALL              SELECT DISTINCT            ctct.CHUNGTUCHITIET_ID TOATHUOC_ID,            ct.CHUNGTU_ID AS MASTER_ID,            ctct.CHUNGTUCHITIET_ID SOTHUTUTOA,            '1027' + '_' + LTRIM(ctct.DUOC_ID) + '_' + LTRIM(ctct.NGUONHANG_ID) as DUOC_KEY,            ctct.DUOC_ID,            D.TENDUOCDAYDU,            D.DONVITINH_ID,            D.DONVITINH,            ctct.SOLUONGDAXUAT as SOLUONGYEUCAU,            LD.MALOAIDUOC,                      ct.MACHUNGTU + ' - ' + CONVERT(VARCHAR(10), CT.NGAYCHUNGTU, 103) + ' - ' + CONVERT(VARCHAR(5), CT.NGAYCHUNGTU, 108)            + CASE WHEN NV.TENNHANVIEN IS NOT NULL THEN + N' - Người lập: ' +  NV.TENNHANVIEN ELSE '' END TENNHOMLOAIDUOC,            ctct.NGUONHANG_ID AS NGUONHANG_ID,            null SOTIEPNHAN,            null TENBENHNHAN,                      CASE WHEN ct.LYDOXUATSUDUNG_ID = 8295 THEN N'Xuất tiêu hao khoa phòng' WHEN ct.LYDOXUATSUDUNG_ID = 8312 THEN N'Xuất từ thiện' END AS BENHNHAN,            ctct.NGAYTAO,            'TT_DUOC_CHUNGTU' as LOAIPHIEU,            ctct.NGAYCAPNHAT as REF_NGAYCAPNHAT            FROM            TT_DUOC_CHUNGTU ct            inner join TT_DUOC_CHUNGTU_CHITIET ctct on ct.CHUNGTU_ID = ctct.CHUNGTU_ID            left join TM_DUOC D on D.DUOC_ID = ctct.DUOC_ID            left join TM_LOAIDUOC LD on LD.LOAIDUOC_ID = D.LOAIDUOC_ID            left join TM_NHOMLOAIDUOC NLD on NLD.NHOMLOAIDUOC_ID = LD.NHOMLOAIDUOC_ID            left join TM_NHANVIEN NV on CT.NGUOITAO_ID = NV.NHANVIEN_ID            WHERE            ct.BENHVIEN_ID = 'HLU01'            AND ct.PHIEULINH_ID is NULL            AND ctct.CHUNGTUCHITIET_ID IN (1886259,1886258,1886257,1886256)            AND ct.CHUNGTU_ID IN (2002260002,2002260002,2002260001,2002260001)]
2020-02-26 15:45:47,911 [1] DEBUG - Statement Id: [DAO00030_DUOCTONKHO_GetTonThucTe] PreparedStatement : [SELECT              SUM(SOLUONG) AS SOLUONG              FROM              TT_DUOC_TONKHO              WHERE              DUOC_ID = '1030'              AND KHODUOC_ID = '1'              and BENHVIEN_ID = 'HLU01']
2020-02-26 15:45:48,008 [1] DEBUG - Statement Id: [DAO00030_DUOCTONKHO_GetTonThucTe] PreparedStatement : [SELECT              SUM(SOLUONG) AS SOLUONG              FROM              TT_DUOC_TONKHO              WHERE              DUOC_ID = '1030'              AND KHODUOC_ID = '1'              and BENHVIEN_ID = 'HLU01']
2020-02-26 15:45:48,089 [1] DEBUG - Statement Id: [DAO00030_DUOCTONKHO_GetTonThucTe] PreparedStatement : [SELECT              SUM(SOLUONG) AS SOLUONG              FROM              TT_DUOC_TONKHO              WHERE              DUOC_ID = '1030'              AND KHODUOC_ID = '1'              and BENHVIEN_ID = 'HLU01']
2020-02-26 15:45:48,171 [1] DEBUG - Statement Id: [DAO00030_DUOCTONKHO_GetTonThucTe] PreparedStatement : [SELECT              SUM(SOLUONG) AS SOLUONG              FROM              TT_DUOC_TONKHO              WHERE              DUOC_ID = '1030'              AND KHODUOC_ID = '1'              and BENHVIEN_ID = 'HLU01']
2020-02-26 15:45:48,383 [1] DEBUG - Statement Id: [DAO00030_YLENH_NOITRU_NGAYCAPNHAT] PreparedStatement : [SELECT              TT.NGAYCAPNHAT              FROM              TT_NOITRU_TOATHUOC TT              inner join TM_DUOC D on D.DUOC_ID = TT.DUOC_ID              inner join TM_LOAIDUOC LD on LD.LOAIDUOC_ID = D.LOAIDUOC_ID              WHERE              tt.KHAMBENH_ID IN (320498,320498,320499,320499)              AND tt.BENHVIEN_ID = 'HLU01'                             order by NGAYCAPNHAT]
2020-02-26 15:45:50,041 [1] DEBUG - Statement Id: [DAO00030_DUOC_KiemTraTamNgung] PreparedStatement : [SELECT DUOC_ID,TAMNGUNG          FROM          TM_DUOC          WHERE          DUOC_ID IN (1030,1030,1030,1030)]
2020-02-26 15:45:50,066 [1] DEBUG - Statement Id: [DAO00030_YLENH_NOITRU_NGAYCAPNHAT] PreparedStatement : [SELECT              TT.NGAYCAPNHAT              FROM              TT_NOITRU_TOATHUOC TT              inner join TM_DUOC D on D.DUOC_ID = TT.DUOC_ID              inner join TM_LOAIDUOC LD on LD.LOAIDUOC_ID = D.LOAIDUOC_ID              WHERE              tt.KHAMBENH_ID IN (320498,320498,320499,320499)              AND tt.BENHVIEN_ID = 'HLU01'                             order by NGAYCAPNHAT]
2020-02-26 15:45:50,143 [1] DEBUG - Statement Id: [DAO00036_GetDetail] PreparedStatement : [select KEYTYPE, KEYYEAR, KEYMONTH, KEYDAY, SEGMENT_1, SEGMENT_2, SEGMENT_3, KEYVALUE              from LST_KEYDATA_DUOCPHAM as kd               WHERE                        kd.KEYTYPE = 'PHIEULINH'                   AND                       kd.KEYYEAR = '2020'                   AND                       kd.KEYMONTH = '0'                   AND                       kd.KEYDAY = '0'                   AND                       kd.SEGMENT_1 = 'CS_GMHS'                   AND                       kd.SEGMENT_2 = 'PL'                   AND                       kd.SEGMENT_3 = ' ']
2020-02-26 15:45:50,223 [1] DEBUG - Statement Id: [DAO00036_Update] PreparedStatement : [update LST_KEYDATA_DUOCPHAM set              KEYVALUE =  @param0               where              KEYTYPE = 'PHIEULINH'              AND KEYYEAR = '2020'              AND KEYMONTH = '0'              AND KEYDAY = '0'              AND SEGMENT_1 = 'CS_GMHS'              AND SEGMENT_2 = 'PL'              AND SEGMENT_3 = ' ']
2020-02-26 15:45:50,223 [1] DEBUG - Statement Id: [DAO00036_Update] Parameters: [@param0=[KEYVALUE,000013]]
2020-02-26 15:45:50,223 [1] DEBUG - Statement Id: [DAO00036_Update] Types: [@param0=[String, System.String]]
2020-02-26 15:45:50,293 [1] DEBUG - Statement Id: [DAO00030_DUOCPHIEULINH_Add] PreparedStatement : [insert into TT_DUOC_PHIEULINH (            MACHUNGTU            , SOCHUNGTU            , NGAYCHUNGTU            , LOAICHUNGTU            , MUCDICHCHUNGTU_ID            , KHOXUAT_ID            , NGUOIGIAO_ID            , NGUOIGIAO            , KHONHAP_ID            , NGUOINHAN_ID            , NGUOINHAN            , NGUOIKIEMTRA            , NGUOIDUYET            , KETOANTRUONG            , THUKHO            , SOSERI            , SOHOADON            , DIENGIAI            , GIATRI            , GIATRITHANHTOAN            , TYLEVAT            , GIATRIVAT            , THUESUAT            , GIATRITHUE            , TYLECHIETKHAU            , GIATRICHIETKHAU            , TIENTE_ID            , TYGIA            , SOCHUNGTUGOC            , NGAYCHUNGTUGOC            , NHACUNGCAP_ID            , HINHTHUCTHANHTOAN_ID            , NGUONDUOC_ID            , CHUNGTULIENQUAN_ID            , TOATHUOC_ID            , TOATHUOCNOITRU_ID            , BENHAN_ID            , DANHANTHUOC            , NGUOINHAP_ID            , NGAYNHAP            , TRANGTHAI            , PHIEULINH_ID            , DIENGIAINGHIEPVUPHATSINH            , TONGHOP_TUNGAY            , TONGHOP_DENNGAY            , COSO            , TONGHOP            , PHANLOAIPHIEULINH            , DUYET            , NGAYDUYET            , THOIGIANDUYET            , NGUOIDUYET_ID            , LYDO            , BENHVIEN_ID            , NGAYTAO            , NGUOITAO_ID            , NGAYCAPNHAT            , NGUOICAPNHAT_ID            ) values (             @param0             ,  @param1             ,  @param2             ,  @param3             ,  @param4             ,  @param5             ,  @param6             ,  @param7             ,  @param8             ,  @param9             ,  @param10             ,  @param11             ,  @param12             ,  @param13             ,  @param14             ,  @param15             ,  @param16             ,  @param17             ,  @param18             ,  @param19             ,  @param20             ,  @param21             ,  @param22             ,  @param23             ,  @param24             ,  @param25             ,  @param26             ,  @param27             ,  @param28             ,  @param29             ,  @param30             ,  @param31             ,  @param32             ,  @param33             ,  @param34             ,  @param35             ,  @param36             ,  @param37             ,  @param38             ,  @param39             ,  @param40             ,  @param41             ,  @param42             ,  @param43             ,  @param44             ,  @param45             ,  @param46             ,  @param47             ,  @param48             ,  @param49             ,  @param50             ,  @param51             ,  @param52             ,  @param53             , GETDATE()            ,  @param54             ,  @param55             ,  @param56             )            select SCOPE_identity() as value]
2020-02-26 15:45:50,293 [1] DEBUG - Statement Id: [DAO00030_DUOCPHIEULINH_Add] Parameters: [@param0=[MACHUNGTU,CS_GMHSPL20000013], @param1=[SOCHUNGTU,000013], @param2=[NGAYCHUNGTU,2/26/2020 3:45:50 PM], @param3=[LOAICHUNGTU,N], @param4=[MUCDICHCHUNGTU_ID,null], @param5=[KHOXUAT_ID,1], @param6=[NGUOIGIAO_ID,null], @param7=[NGUOIGIAO,null], @param8=[KHONHAP_ID,29], @param9=[NGUOINHAN_ID,1], @param10=[NGUOINHAN,null], @param11=[NGUOIKIEMTRA,null], @param12=[NGUOIDUYET,null], @param13=[KETOANTRUONG,null], @param14=[THUKHO,null], @param15=[SOSERI,null], @param16=[SOHOADON,null], @param17=[DIENGIAI,null], @param18=[GIATRI,null], @param19=[GIATRITHANHTOAN,null], @param20=[TYLEVAT,null], @param21=[GIATRIVAT,null], @param22=[THUESUAT,null], @param23=[GIATRITHUE,null], @param24=[TYLECHIETKHAU,null], @param25=[GIATRICHIETKHAU,null], @param26=[TIENTE_ID,null], @param27=[TYGIA,null], @param28=[SOCHUNGTUGOC,null], @param29=[NGAYCHUNGTUGOC,null], @param30=[NHACUNGCAP_ID,null], @param31=[HINHTHUCTHANHTOAN_ID,null], @param32=[NGUONDUOC_ID,1], @param33=[CHUNGTULIENQUAN_ID,null], @param34=[TOATHUOC_ID,null], @param35=[TOATHUOCNOITRU_ID,null], @param36=[BENHAN_ID,null], @param37=[DANHANTHUOC,0], @param38=[NGUOINHAP_ID,null], @param39=[NGAYNHAP,null], @param40=[TRANGTHAI,CHUADUYET], @param41=[PHIEULINH_ID,null], @param42=[DIENGIAINGHIEPVUPHATSINH,Xuất cho: ], @param43=[TONGHOP_TUNGAY,2/26/2020 12:00:00 AM], @param44=[TONGHOP_DENNGAY,2/26/2020 12:00:00 AM], @param45=[COSO,0], @param46=[TONGHOP,1], @param47=[PHANLOAIPHIEULINH,T], @param48=[DUYET,0], @param49=[NGAYDUYET,null], @param50=[THOIGIANDUYET,null], @param51=[NGUOIDUYET_ID,null], @param52=[LYDO,null], @param53=[BENHVIEN_ID,HLU01], @param54=[NGUOITAO_ID,1], @param55=[NGAYCAPNHAT,2/26/2020 3:45:50 PM], @param56=[NGUOICAPNHAT_ID,1]]
2020-02-26 15:45:50,293 [1] DEBUG - Statement Id: [DAO00030_DUOCPHIEULINH_Add] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[DateTime, System.DateTime], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[System.DBNull, null], @param8=[Int64, System.Int64], @param9=[Int64, System.Int64], @param10=[System.DBNull, null], @param11=[System.DBNull, null], @param12=[System.DBNull, null], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[System.DBNull, null], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[Int64, System.Int64], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[String, System.String], @param38=[System.DBNull, null], @param39=[System.DBNull, null], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[String, System.String], @param43=[DateTime, System.DateTime], @param44=[DateTime, System.DateTime], @param45=[String, System.String], @param46=[String, System.String], @param47=[String, System.String], @param48=[Int64, System.Int64], @param49=[System.DBNull, null], @param50=[System.DBNull, null], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[String, System.String], @param54=[Int64, System.Int64], @param55=[DateTime, System.DateTime], @param56=[Int64, System.Int64]]
2020-02-26 15:45:50,878 [1] DEBUG - Statement Id: [DAO00030_DUOCPHIEULINHCT_AddMulti] PreparedStatement : [SET XACT_ABORT ON            BEGIN TRANSACTION            BEGIN TRY              declare @json nvarchar(max) =  N'[{"CHUNGTUCHITIET_ID":0,"CHUNGTU_ID":48585,"DUOC_ID":1030,"DUOC_KEY":"1027_1030_1","SOLONHAP_ID":null,"SOKIEMSOAT":null,"SOVISA":null,"DONVITINH_ID":2,"SOLUONGYEUCAU":1.0,"SOLUONGYEUCAU_PRE":null,"SOLUONGTHUCTE":null,"SOLUONGDAXUAT":null,"TIENTE_ID":null,"TYGIA":null,"DONGIAMUA":null,"DONGIABAN":null,"DONGIAVON":null,"SOQUYEN":null,"SOHOADONVAT":null,"TYLEVAT":null,"GIATRIVAT":null,"MIENPHI":"0","LYDOMIENPHI_ID":null,"SOCHUNGTUKETOAN":null,"SOCHUNGTUTIENMAT":null,"TRANGTHAI":null,"DAPHATSINHPHIEUXUAT":"0","DAPHATSINHPHIEUHOANTRA":"0","NGUONHANG_ID":1,"CHUNGTUHOANTRA_LE_ID":null,"SOLUONGTHUCNHAN":null,"SOLUONGTONGHOPTHUCTE":1.0,"BENHVIEN_ID":"HLU01","NGAYTAO":"26/Feb/2020 15:45:50","NGUOITAO_ID":1,"NGAYCAPNHAT":null,"NGUOICAPNHAT_ID":null,"MADUOC":null,"TENDUOCDAYDU":null,"DONVITINH":"Ống","SOLUONGTON":2259.0,"SOLUONGTON_PRE":null,"TONGYEUCAU":null,"SOLUONGTHIEU":null,"NGUOIDUYET":null,"THOIGIANDUYET":null,"LYDO":null,"MACHUNGTU":null,"LOAIPHIEU":"TT_NOITRU_TOATHUOC","KHONHAP_ID":null,"TENBENHNHAN":"Lê Thị Ngọc","BENHNHAN":"Người bệnh: 190040528 - Lê Thị Ngọc - Thời gian Y lệnh: 26/02/2020 - 14:59","YLENH":"1886259,1886258,1886257,1886256","DUYET":false,"TENKHONHAP":null,"TOATHUOC_ID":1886256,"MASTER_ID":320498,"KHOPHAT_ID":1,"REF_TABLE":"TT_NOITRU_TOATHUOC","REF_ID":null,"REF_NGAYCAPNHAT":"2020-02-26T15:14:31.667","TOATHUOCNOITRU_ID":1886256,"STT":null,"LOAIVATTU_ID":null,"LOAIVATTU":null,"MALOAIDUOC":"L016","TENNHOMLOAIDUOC":null,"HIGHLIGHT":null,"SOLUONGTONLO":null,"SUASOLUONGTONGHOP":null},{"CHUNGTUCHITIET_ID":0,"CHUNGTU_ID":48585,"DUOC_ID":1030,"DUOC_KEY":"1027_1030_1","SOLONHAP_ID":null,"SOKIEMSOAT":null,"SOVISA":null,"DONVITINH_ID":2,"SOLUONGYEUCAU":1.0,"SOLUONGYEUCAU_PRE":null,"SOLUONGTHUCTE":null,"SOLUONGDAXUAT":null,"TIENTE_ID":null,"TYGIA":null,"DONGIAMUA":null,"DONGIABAN":null,"DONGIAVON":null,"SOQUYEN":null,"SOHOADONVAT":null,"TYLEVAT":null,"GIATRIVAT":null,"MIENPHI":"0","LYDOMIENPHI_ID":null,"SOCHUNGTUKETOAN":null,"SOCHUNGTUTIENMAT":null,"TRANGTHAI":null,"DAPHATSINHPHIEUXUAT":"0","DAPHATSINHPHIEUHOANTRA":"0","NGUONHANG_ID":1,"CHUNGTUHOANTRA_LE_ID":null,"SOLUONGTHUCNHAN":null,"SOLUONGTONGHOPTHUCTE":1.0,"BENHVIEN_ID":"HLU01","NGAYTAO":"26/Feb/2020 15:45:50","NGUOITAO_ID":1,"NGAYCAPNHAT":null,"NGUOICAPNHAT_ID":null,"MADUOC":null,"TENDUOCDAYDU":null,"DONVITINH":"Ống","SOLUONGTON":2259.0,"SOLUONGTON_PRE":null,"TONGYEUCAU":null,"SOLUONGTHIEU":null,"NGUOIDUYET":null,"THOIGIANDUYET":null,"LYDO":null,"MACHUNGTU":null,"LOAIPHIEU":"TT_NOITRU_TOATHUOC","KHONHAP_ID":null,"TENBENHNHAN":"Lê Thị Ngọc","BENHNHAN":"Người bệnh: 190040528 - Lê Thị Ngọc - Thời gian Y lệnh: 26/02/2020 - 14:59","YLENH":"1886259,1886258,1886257,1886256","DUYET":false,"TENKHONHAP":null,"TOATHUOC_ID":1886257,"MASTER_ID":320498,"KHOPHAT_ID":1,"REF_TABLE":"TT_NOITRU_TOATHUOC","REF_ID":null,"REF_NGAYCAPNHAT":"2020-02-26T15:14:32.87","TOATHUOCNOITRU_ID":1886257,"STT":null,"LOAIVATTU_ID":null,"LOAIVATTU":null,"MALOAIDUOC":"L016","TENNHOMLOAIDUOC":null,"HIGHLIGHT":null,"SOLUONGTONLO":null,"SUASOLUONGTONGHOP":null},{"CHUNGTUCHITIET_ID":0,"CHUNGTU_ID":48585,"DUOC_ID":1030,"DUOC_KEY":"1027_1030_1","SOLONHAP_ID":null,"SOKIEMSOAT":null,"SOVISA":null,"DONVITINH_ID":2,"SOLUONGYEUCAU":1.0,"SOLUONGYEUCAU_PRE":null,"SOLUONGTHUCTE":null,"SOLUONGDAXUAT":null,"TIENTE_ID":null,"TYGIA":null,"DONGIAMUA":null,"DONGIABAN":null,"DONGIAVON":null,"SOQUYEN":null,"SOHOADONVAT":null,"TYLEVAT":null,"GIATRIVAT":null,"MIENPHI":"0","LYDOMIENPHI_ID":null,"SOCHUNGTUKETOAN":null,"SOCHUNGTUTIENMAT":null,"TRANGTHAI":null,"DAPHATSINHPHIEUXUAT":"0","DAPHATSINHPHIEUHOANTRA":"0","NGUONHANG_ID":1,"CHUNGTUHOANTRA_LE_ID":null,"SOLUONGTHUCNHAN":null,"SOLUONGTONGHOPTHUCTE":1.0,"BENHVIEN_ID":"HLU01","NGAYTAO":"26/Feb/2020 15:45:50","NGUOITAO_ID":1,"NGAYCAPNHAT":null,"NGUOICAPNHAT_ID":null,"MADUOC":null,"TENDUOCDAYDU":null,"DONVITINH":"Ống","SOLUONGTON":2259.0,"SOLUONGTON_PRE":null,"TONGYEUCAU":null,"SOLUONGTHIEU":null,"NGUOIDUYET":null,"THOIGIANDUYET":null,"LYDO":null,"MACHUNGTU":null,"LOAIPHIEU":"TT_NOITRU_TOATHUOC","KHONHAP_ID":null,"TENBENHNHAN":"Lê Thị Ngọc","BENHNHAN":"Người bệnh: 190040528 - Lê Thị Ngọc - Thời gian Y lệnh: 26/02/2020 - 15:38","YLENH":"1886259,1886258,1886257,1886256","DUYET":false,"TENKHONHAP":null,"TOATHUOC_ID":1886258,"MASTER_ID":320499,"KHOPHAT_ID":1,"REF_TABLE":"TT_NOITRU_TOATHUOC","REF_ID":null,"REF_NGAYCAPNHAT":"2020-02-26T15:38:01.963","TOATHUOCNOITRU_ID":1886258,"STT":null,"LOAIVATTU_ID":null,"LOAIVATTU":null,"MALOAIDUOC":"L016","TENNHOMLOAIDUOC":null,"HIGHLIGHT":null,"SOLUONGTONLO":null,"SUASOLUONGTONGHOP":null},{"CHUNGTUCHITIET_ID":0,"CHUNGTU_ID":48585,"DUOC_ID":1030,"DUOC_KEY":"1027_1030_1","SOLONHAP_ID":null,"SOKIEMSOAT":null,"SOVISA":null,"DONVITINH_ID":2,"SOLUONGYEUCAU":1.0,"SOLUONGYEUCAU_PRE":null,"SOLUONGTHUCTE":null,"SOLUONGDAXUAT":null,"TIENTE_ID":null,"TYGIA":null,"DONGIAMUA":null,"DONGIABAN":null,"DONGIAVON":null,"SOQUYEN":null,"SOHOADONVAT":null,"TYLEVAT":null,"GIATRIVAT":null,"MIENPHI":"0","LYDOMIENPHI_ID":null,"SOCHUNGTUKETOAN":null,"SOCHUNGTUTIENMAT":null,"TRANGTHAI":null,"DAPHATSINHPHIEUXUAT":"0","DAPHATSINHPHIEUHOANTRA":"0","NGUONHANG_ID":1,"CHUNGTUHOANTRA_LE_ID":null,"SOLUONGTHUCNHAN":null,"SOLUONGTONGHOPTHUCTE":1.0,"BENHVIEN_ID":"HLU01","NGAYTAO":"26/Feb/2020 15:45:50","NGUOITAO_ID":1,"NGAYCAPNHAT":null,"NGUOICAPNHAT_ID":null,"MADUOC":null,"TENDUOCDAYDU":null,"DONVITINH":"Ống","SOLUONGTON":2259.0,"SOLUONGTON_PRE":null,"TONGYEUCAU":null,"SOLUONGTHIEU":null,"NGUOIDUYET":null,"THOIGIANDUYET":null,"LYDO":null,"MACHUNGTU":null,"LOAIPHIEU":"TT_NOITRU_TOATHUOC","KHONHAP_ID":null,"TENBENHNHAN":"Lê Thị Ngọc","BENHNHAN":"Người bệnh: 190040528 - Lê Thị Ngọc - Thời gian Y lệnh: 26/02/2020 - 15:38","YLENH":"1886259,1886258,1886257,1886256","DUYET":false,"TENKHONHAP":null,"TOATHUOC_ID":1886259,"MASTER_ID":320499,"KHOPHAT_ID":1,"REF_TABLE":"TT_NOITRU_TOATHUOC","REF_ID":null,"REF_NGAYCAPNHAT":"2020-02-26T15:38:02.79","TOATHUOCNOITRU_ID":1886259,"STT":null,"LOAIVATTU_ID":null,"LOAIVATTU":null,"MALOAIDUOC":"L016","TENNHOMLOAIDUOC":null,"HIGHLIGHT":null,"SOLUONGTONLO":null,"SUASOLUONGTONGHOP":null}]';              DELETE TT_DUOC_PHIEULINH_CHITIET WHERE CHUNGTU_ID =  @param0               INSERT INTO TT_DUOC_PHIEULINH_CHITIET            (            CHUNGTU_ID            , DUOC_ID            , DONVITINH_ID            , NGUONHANG_ID            , SOLUONGYEUCAU            , SOLUONGTONGHOPTHUCTE            , REF_TABLE            , TOATHUOCNOITRU_ID            , TENBENHNHAN            , BENHNHAN            , YLENH            , MASTER_ID            , DAPHATSINHPHIEUXUAT            , DAPHATSINHPHIEUHOANTRA            , MIENPHI            , BENHVIEN_ID            , NGAYTAO            , NGUOITAO_ID            )            SELECT * FROM OPENJSON(@json)            WITH (            CHUNGTU_ID int            , DUOC_ID int            , DONVITINH_ID int            , NGUONHANG_ID int            , SOLUONGYEUCAU numeric(25, 4)            , SOLUONGTONGHOPTHUCTE numeric(25, 4)            , REF_TABLE nvarchar(100)            , TOATHUOCNOITRU_ID int            , TENBENHNHAN nvarchar(100)            , BENHNHAN nvarchar(MAX)            , YLENH nvarchar(MAX)            , MASTER_ID int            , DAPHATSINHPHIEUXUAT char(1)            , DAPHATSINHPHIEUHOANTRA char(1)            , MIENPHI char(1)            , BENHVIEN_ID varchar(10)            , NGAYTAO datetime            , NGUOITAO_ID  int            )                                  UPDATE TT_NOITRU_TOATHUOC set PHIEULINH_ID = json.CHUNGTU_ID, NGAYCAPNHAT = getdate()                   FROM OPENJSON(@json)           WITH (CHUNGTU_ID int, TOATHUOCNOITRU_ID int, REF_TABLE nvarchar(100)) json           WHERE TT_NOITRU_TOATHUOC.TOATHUOC_ID = json.TOATHUOCNOITRU_ID and json.REF_TABLE = 'TT_NOITRU_TOATHUOC'                                           UPDATE  TT_PHAUTHUAT_VTYT set CHUNGTUTONGHOP_ID = json.CHUNGTU_ID, NGAYCAPNHAT = getdate()                   FROM OPENJSON(@json)           WITH (CHUNGTU_ID int, TOATHUOCNOITRU_ID int, REF_TABLE nvarchar(100)) json           WHERE TT_PHAUTHUAT_VTYT.PHAUTHUAT_VTYT_ID = json.TOATHUOCNOITRU_ID and json.REF_TABLE = 'TT_PHAUTHUAT_VTYT'                                                UPDATE TT_CLSKETQUA_VTYT set CHUNGTUTONGHOP_ID = json.CHUNGTU_ID, NGAYCAPNHAT = getdate()                   FROM OPENJSON(@json)           WITH (CHUNGTU_ID int, TOATHUOCNOITRU_ID int, REF_TABLE nvarchar(100)) json           WHERE TT_CLSKETQUA_VTYT.CLSKETQUA_VTYT_ID = json.TOATHUOCNOITRU_ID and json.REF_TABLE = 'TT_CLSKETQUA_VTYT'                                                UPDATE TT_NGOAITRU_KHAMBENH_VTYT set PHIEULINH_ID = json.CHUNGTU_ID, NGAYCAPNHAT = getdate()                   FROM OPENJSON(@json)           WITH (CHUNGTU_ID int, TOATHUOCNOITRU_ID int, REF_TABLE nvarchar(100)) json           WHERE TT_NGOAITRU_KHAMBENH_VTYT.KHAMBENH_VTYT_ID = json.TOATHUOCNOITRU_ID and json.REF_TABLE = 'TT_NGOAITRU_KHAMBENH_VTYT'                       COMMIT TRANSACTION          END TRY                    BEGIN CATCH          IF @@TRANCOUNT > 0          ROLLBACK TRANSACTION          END CATCH]
2020-02-26 15:45:50,878 [1] DEBUG - Statement Id: [DAO00030_DUOCPHIEULINHCT_AddMulti] Parameters: [@param0=[CHUNGTU_ID,null]]
2020-02-26 15:45:50,878 [1] DEBUG - Statement Id: [DAO00030_DUOCPHIEULINHCT_AddMulti] Types: [@param0=[System.DBNull, null]]
2020-02-26 15:45:51,623 [1] DEBUG - Statement Id: [DAO00030_DUOCPHIEULINH_GetList] PreparedStatement : [select *              from TT_DUOC_PHIEULINH               where                             TT_DUOC_PHIEULINH.CHUNGTU_ID = '48585'                                     order by CHUNGTU_ID]
2020-02-26 15:45:51,703 [1] DEBUG - Statement Id: [DAO00030_DUOCPHIEULINHCT_GetList] PreparedStatement : [select CT.*, NLD.TENNHOMLOAIDUOC, LD.MALOAIDUOC, D.TENDUOCDAYDU, D.DONVITINH, CT.TOATHUOCNOITRU_ID AS TOATHUOC_ID,            LTRIM(PL.KHOXUAT_ID) + '_' + LTRIM(ct.DUOC_ID) + '_' + LTRIM(ct.NGUONHANG_ID) as DUOC_KEY            from TT_DUOC_PHIEULINH_CHITIET CT            inner join TT_DUOC_PHIEULINH PL ON PL.CHUNGTU_ID = CT.CHUNGTU_ID            left join TM_DUOC D on D.DUOC_ID = CT.DUOC_ID            left join TM_LOAIDUOC LD on LD.LOAIDUOC_ID = D.LOAIDUOC_ID            left join TM_NHOMLOAIDUOC NLD on NLD.NHOMLOAIDUOC_ID = LD.NHOMLOAIDUOC_ID             where                             CT.CHUNGTU_ID = '48585'                                     order by CHUNGTUCHITIET_ID]
2020-02-26 15:45:51,988 [1] DEBUG - Statement Id: [DAO00030_YLENH_NOITRU_NGAYCAPNHAT] PreparedStatement : [SELECT              TT.NGAYCAPNHAT              FROM              TT_NOITRU_TOATHUOC TT              inner join TM_DUOC D on D.DUOC_ID = TT.DUOC_ID              inner join TM_LOAIDUOC LD on LD.LOAIDUOC_ID = D.LOAIDUOC_ID              WHERE              tt.KHAMBENH_ID IN (320498,320498,320499,320499,320498,320498,320499,320499)              AND tt.BENHVIEN_ID = 'HLU01'                             order by NGAYCAPNHAT]
2020-02-26 15:45:52,028 [1] DEBUG - Statement Id: [DAO00030_DUOCTONKHO_GetSoTonTheoDuoc] PreparedStatement : [SELECT              DUOC_ID,              SUM(SOLUONG) AS TONGTON              FROM              TT_DUOC_TONKHO              WHERE              KHODUOC_ID = '1'              and BENHVIEN_ID = 'HLU01'              and DUOC_ID IN (1030,1030)              GROUP BY DUOC_ID]
2020-02-26 15:53:11,894 [1] DEBUG - Statement Id: [DAO00030_GetMucDichChungTuID] PreparedStatement : [SELECT DICTIONARY_ID              FROM              LST_DICTIONARY              WHERE              DICTIONARY_TYPE_CODE = 'MucDichChungTu'              and DICTIONARY_CODE = 'X13']
2020-02-26 15:53:12,170 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'PHA22'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 15:53:12,650 [1] DEBUG - Statement Id: [DAO00030_GetMucDichChungTuID] PreparedStatement : [SELECT DICTIONARY_ID              FROM              LST_DICTIONARY              WHERE              DICTIONARY_TYPE_CODE = 'MucDichChungTu'              and DICTIONARY_CODE = 'X13']
2020-02-26 15:53:12,744 [1] DEBUG - Statement Id: [DAO00030_GetMucDichChungTuID] PreparedStatement : [SELECT DICTIONARY_ID              FROM              LST_DICTIONARY              WHERE              DICTIONARY_TYPE_CODE = 'MucDichChungTu'              and DICTIONARY_CODE = 'X13']
2020-02-26 15:53:13,071 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'PHA74'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 15:53:20,154 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'PHA73'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 15:53:20,372 [1] DEBUG - Statement Id: [DAO00030_XUATSUDUNG_TOANOITRU] PreparedStatement : [SELECT            N'Người bệnh: ' + BN.MAYTE + ' - ' + BN.TENBENHNHAN + ' - '  + N'Bệnh án: ' + BA.SOBENHAN  as BENHNHAN,            CASE WHEN BN.GIOITINH = 1 THEN 'Nam' WHEN BN.GIOITINH = 2 THEN N'Nữ'  END  AS GIOITINH ,            CASE WHEN BN.NGAYSINH IS NOT NULL THEN CONVERT(VARCHAR(10), BN.NGAYSINH, 103) ELSE CONVERT(VARCHAR(10), BN.NAMSINH) END as NGAYSINH,            CASE WHEN dt.TENDOITUONG IS NOT NULL THEN dt.TENDOITUONG  ELSE '' END as DOITUONG,            N'Y lệnh:' + TT.SOTHUTUTOA + ' - Ngày: ' + CONVERT(VARCHAR(10), KB.THOIGIANKHAM, 103) + ' - ' + CONVERT(VARCHAR(5), KB.THOIGIANKHAM, 108)            + CASE WHEN NV.TENNHANVIEN IS NOT NULL THEN + N' - Người lập: ' +  NV.TENNHANVIEN ELSE '' END            AS YLENH,            TT.TOATHUOC_ID,            TT.SOTHUTUTOA as REF_ID,            PL.MACHUNGTU,            TT.DUOC_ID,            d.MADUOC,            d.TENDUOCDAYDU,            d.DONVITINH,            TT.SOLUONG as SOLUONGYEUCAU,            trt.SOLUONG as SOLUONGTRA,            TT.NGAYTAO            FROM            TT_NOITRU_TOATHUOC TT            inner join TT_NOITRU_KHAMBENH KB on KB.KHAMBENH_ID = TT.KHAMBENH_ID            inner join TT_NOITRU_BENHAN BA on BA.BENHAN_ID = KB.BENHAN_ID            inner join TT_BENHNHAN BN on BA.BENHNHAN_ID = BN.BENHNHAN_ID            inner join TM_DUOC D on D.DUOC_ID = TT.DUOC_ID            inner join TM_LOAIDUOC LD on LD.LOAIDUOC_ID = D.LOAIDUOC_ID            left join TM_DOITUONG dt on BA.DOITUONG_ID = dt.DOITUONG_ID            left join TT_DUOC_PHIEULINH PL on PL.CHUNGTU_ID = TT.PHIEULINH_ID            left join TT_NOITRU_TRATHUOC_CHITIET trt on (trt.TOATHUOC_ID = TT.TOATHUOC_ID)            left join TM_NHANVIEN NV on TT.NGUOITAO_ID = NV.NHANVIEN_ID            WHERE            CONVERT(date, KB.THOIGIANKHAM) BETWEEN  CONVERT(date, '2/26/2020 12:00:00 AM')  AND  CONVERT(date, '2/26/2020 12:00:00 AM')            AND TT.CHUNGTU_ID is null            AND BA.TRANGTHAI = 'DANGDIEUTRI'            AND TT.PHONGBANRATOA_ID = '25'             and               TT.KHOTAO_ID = '29'                         AND (            (tt.COSO = '0'            AND tt.PHIEULINH_ID IS NOT NULL            AND tt.TOATHUOC_ID IN            (SELECT ctct.TOATHUOCNOITRU_ID FROM TT_DUOC_CHUNGTU_CHITIET ctct            inner join TT_DUOC_CHUNGTU ct on ct.CHUNGTU_ID = ctct.CHUNGTU_ID            and ct.MUCDICHCHUNGTU_CODE = 'N05'            and ct.KHONHAP_ID =  '29'            )            )            or            (tt.COSO = '1')            )            AND TT.BENHVIEN_ID = 'HLU01'            AND (BN.TENBENHNHAN like N'%%' OR BN.MAYTE like N'%%'  OR  BA.SOBENHAN  like N'%%'            or D.TENDUOCDAYDU like N'%%'            OR PL.MACHUNGTU like '%%'            )            AND LD.LOAIVATTU_ID = 'V'            order by NGAYTAO DESC]
2020-02-26 15:53:57,533 [1] DEBUG - Statement Id: [DAO00030_XUATSUDUNG_KHAMBENH_NGOAITRU_VTYT] PreparedStatement : [SELECT            N'Người bệnh: ' + BN.MAYTE + ' - ' + BN.TENBENHNHAN + ' - ' + N'Số TN: ' + TN.SOTIEPNHAN  as BENHNHAN,            CASE WHEN BN.GIOITINH = 1 THEN 'Nam' WHEN BN.GIOITINH = 2 THEN N'Nữ' END  AS GIOITINH ,            CASE WHEN BN.NGAYSINH IS NOT NULL THEN CONVERT(VARCHAR(10), BN.NGAYSINH, 103) ELSE CONVERT(VARCHAR(10), BN.NAMSINH) END as NGAYSINH,            CASE WHEN dt.TENDOITUONG IS NOT NULL THEN dt.TENDOITUONG  ELSE '' END as DOITUONG,            N'VTYT Ngoại trú ngày: ' + CONVERT(VARCHAR(10), VT.NGAYTAO, 103) + ' - ' + CONVERT(VARCHAR(5), VT.NGAYTAO, 108)            + CASE WHEN NV.TENNHANVIEN IS NOT NULL THEN + N' - Người lập: ' +  NV.TENNHANVIEN ELSE '' END            AS YLENH,            VT.KHAMBENH_VTYT_ID as TOATHUOC_ID,            DV.DVYEUCAU_ID as REF_ID,            PL.MACHUNGTU,            VT.DUOC_ID,            d.MADUOC,            d.TENDUOCDAYDU,            d.DONVITINH,            VT.SOLUONG as SOLUONGYEUCAU,            VT.NGAYTAO            FROM            TT_NGOAITRU_KHAMBENH_VTYT VT            inner join TT_DVYEUCAU DV on DV.DVYEUCAU_ID = VT.DVYEUCAU_ID            inner join TT_BENHNHAN BN on DV.BENHNHAN_ID = BN.BENHNHAN_ID            inner join TT_TIEPNHAN TN on TN.TIEPNHAN_ID = DV.TIEPNHAN_ID            left join TM_DOITUONG dt on TN.DOITUONG_ID = dt.DOITUONG_ID            left join TM_NHANVIEN NV on VT.NGUOITAO_ID = NV.NHANVIEN_ID            inner join TM_DUOC D on D.DUOC_ID = VT.DUOC_ID            inner join TM_LOAIDUOC LD on LD.LOAIDUOC_ID = D.LOAIDUOC_ID            left join TT_DUOC_PHIEULINH PL on PL.CHUNGTU_ID = VT.PHIEULINH_ID            WHERE            CONVERT(date, VT.NGAYTAO) BETWEEN  CONVERT(date, '2/26/2020 12:00:00 AM')  AND  CONVERT(date, '2/26/2020 12:00:00 AM')            AND VT.CHUNGTU_ID is null            AND VT.PHONGBAN_ID = '25'                          AND VT.BENHVIEN_ID = 'HLU01'              AND (BN.TENBENHNHAN like N'%%' OR BN.MAYTE like N'%%'              OR  TN.SOTIEPNHAN  like N'%%' or D.TENDUOCDAYDU like N'%%'              OR PL.MACHUNGTU like '%%'              )              AND LD.LOAIVATTU_ID = 'V'              order by NGAYTAO DESC]
2020-02-26 15:53:57,664 [1] DEBUG - Statement Id: [DAO00030_XUATSUDUNG_PTTT_VTYT] PreparedStatement : [SELECT            N'Người bệnh: ' + BN.MAYTE + ' - ' + BN.TENBENHNHAN + ' - '  + N'Số TN: ' + TN.SOTIEPNHAN  as BENHNHAN,            CASE WHEN BN.GIOITINH = 1 THEN 'Nam' WHEN BN.GIOITINH = 2 THEN N'Nữ' END  AS GIOITINH,            CASE WHEN BN.NGAYSINH IS NOT NULL THEN CONVERT(VARCHAR(10), BN.NGAYSINH, 103) ELSE CONVERT(VARCHAR(10), BN.NAMSINH) END as NGAYSINH,            CASE WHEN dt.TENDOITUONG IS NOT NULL THEN dt.TENDOITUONG  ELSE '' END as DOITUONG,            CASE            WHEN PT.LOAI = 'P'THEN N'Số phiếu Phẫu thuật: ' +  ISNULL(PT.SOPHIEUPHAUTHUAT,'')  + N' - Ngày: ' +  CONVERT(VARCHAR(10), ISNULL(VT.NGAYTAO,''), 103) + ' - ' + CONVERT(VARCHAR(5), ISNULL(VT.NGAYTAO,''), 108) + CASE WHEN NV.TENNHANVIEN IS NOT NULL THEN + N' - Người lập: ' +  NV.TENNHANVIEN ELSE '' END            ELSE N'Số phiếu Thủ thuật: ' +  ISNULL(PT.SOPHIEUPHAUTHUAT,'')  + N' - Ngày: ' +  CONVERT(VARCHAR(10), ISNULL(VT.NGAYTAO,''), 103) + ' - ' + CONVERT(VARCHAR(5), ISNULL(VT.NGAYTAO,''), 108) + CASE WHEN NV.TENNHANVIEN IS NOT NULL THEN + N' - Người lập: ' +  NV.TENNHANVIEN ELSE '' END            END  AS YLENH,            VT.PHAUTHUAT_VTYT_ID as TOATHUOC_ID,            VT.PHAUTHUAT_ID as REF_ID,            PL.MACHUNGTU,            VT.DUOC_ID,            d.MADUOC,            d.TENDUOCDAYDU,            d.DONVITINH,            VT.SOLUONG as SOLUONGYEUCAU,            VT.NGAYTAO            FROM            TT_PHAUTHUAT_VTYT VT            inner join TT_PHAUTHUAT PT on PT.PHAUTHUAT_ID = VT.PHAUTHUAT_ID            left join TT_TIEPNHAN TN on TN.TIEPNHAN_ID = PT.TIEPNHAN_ID            left join TT_BENHNHAN BN on BN.BENHNHAN_ID = TN.BENHNHAN_ID            left join TM_DOITUONG dt on TN.DOITUONG_ID = dt.DOITUONG_ID            left join TM_DUOC D on D.DUOC_ID = VT.DUOC_ID            left join TM_LOAIDUOC LD on LD.LOAIDUOC_ID = D.LOAIDUOC_ID            left join TM_NHANVIEN NV on VT.NGUOITAO_ID = NV.NHANVIEN_ID            left join TT_DUOC_PHIEULINH PL on PL.CHUNGTU_ID = VT.CHUNGTU_ID            WHERE            CONVERT(date, VT.NGAYTAO) BETWEEN  CONVERT(date, '2/26/2020 12:00:00 AM')  AND  CONVERT(date, '2/26/2020 12:00:00 AM')            AND VT.CHUNGTU_ID is null                          AND PT.PHONGBANTHUCHIEN_ID = '25'              AND VT.BENHVIEN_ID = 'HLU01'              AND (BN.TENBENHNHAN like N'%%' OR BN.MAYTE like N'%%' OR  TN.SOTIEPNHAN  like N'%%' or D.TENDUOCDAYDU like N'%%'              OR PL.MACHUNGTU like '%%'              )              AND LD.LOAIVATTU_ID = 'V'              order by NGAYTAO DESC]
2020-02-26 15:53:57,774 [1] DEBUG - Statement Id: [DAO00030_XUATSUDUNG_CLS_VTYT] PreparedStatement : [SELECT            N'Người bệnh: ' + BN.MAYTE + ' - ' + BN.TENBENHNHAN + ' - '  + N'Số TN: ' + TN.SOTIEPNHAN  as BENHNHAN,            CASE WHEN BN.GIOITINH = 1 THEN 'Nam' WHEN BN.GIOITINH = 2 THEN N'Nữ' END  AS GIOITINH,            CASE WHEN BN.NGAYSINH IS NOT NULL THEN CONVERT(VARCHAR(10), BN.NGAYSINH, 103) ELSE CONVERT(VARCHAR(10), BN.NAMSINH) END as NGAYSINH,            CASE WHEN dt.TENDOITUONG IS NOT NULL THEN dt.TENDOITUONG  ELSE '' END as DOITUONG,            N'Số phiếu CLS: ' +  ISNULL(DV.SOPHIEUYEUCAU,'')  + N' - Ngày: ' +  CONVERT(VARCHAR(10), ISNULL(CLS_VT.NGAYTAO,''), 103) + ' - ' + CONVERT(VARCHAR(5), ISNULL(CLS_VT.NGAYTAO,''), 108) + CASE WHEN NV.TENNHANVIEN IS NOT NULL THEN + N' - Người lập: ' +  NV.TENNHANVIEN ELSE '' END            AS YLENH,            CLS_VT.CLSKETQUA_VTYT_ID as TOATHUOC_ID,            DV.DVYEUCAU_ID as REF_ID,            PL.MACHUNGTU,            CLS_VT.DUOC_ID,            d.MADUOC,            d.TENDUOCDAYDU,            d.DONVITINH,            CLS_VT.SOLUONG as SOLUONGYEUCAU,            CLS_VT.NGAYTAO            FROM            TT_CLSKETQUA_VTYT CLS_VT            inner join TT_DVYEUCAU DV on DV.DVYEUCAU_ID = CLS_VT.DVYEUCAU_ID            left join TT_CLSKETQUA CLS on CLS.CLSKETQUA_ID = CLS_VT.CLSKETQUA_ID            left join TT_BENHNHAN BN on DV.BENHNHAN_ID = BN.BENHNHAN_ID            left join TT_TIEPNHAN TN on TN.TIEPNHAN_ID = DV.TIEPNHAN_ID            left join TM_PHONGBAN pb on pb.PHONGBAN_ID = CLS_VT.PHONGBAN_ID            left join TM_DOITUONG dt on dt.DOITUONG_ID = DV.DOITUONG_ID            left join TM_NHANVIEN NV on NV.NHANVIEN_ID = CLS_VT.NGUOITAO_ID            left join TM_DUOC D on D.DUOC_ID = CLS_VT.DUOC_ID            left join TM_LOAIDUOC LD on LD.LOAIDUOC_ID = D.LOAIDUOC_ID            left join TT_DUOC_PHIEULINH PL on PL.CHUNGTU_ID = CLS_VT.CHUNGTU_ID            WHERE            CONVERT(date, CLS_VT.NGAYTAO) BETWEEN  CONVERT(date, '2/26/2020 12:00:00 AM')  AND  CONVERT(date, '2/26/2020 12:00:00 AM')            AND CLS_VT.CHUNGTU_ID is null                          AND CLS_VT.PHONGBAN_ID = '25'              AND CLS_VT.BENHVIEN_ID = 'HLU01'              AND (BN.TENBENHNHAN like N'%%' OR BN.MAYTE like N'%%' OR  TN.SOTIEPNHAN  like N'%%' or D.TENDUOCDAYDU like N'%%'              OR PL.MACHUNGTU like '%%'              )              AND LD.LOAIVATTU_ID = 'V'              order by NGAYTAO DESC]
2020-02-26 15:54:03,500 [1] DEBUG - Statement Id: [DAO00030_XUATSUDUNG_TOANOITRU] PreparedStatement : [SELECT            N'Người bệnh: ' + BN.MAYTE + ' - ' + BN.TENBENHNHAN + ' - '  + N'Bệnh án: ' + BA.SOBENHAN  as BENHNHAN,            CASE WHEN BN.GIOITINH = 1 THEN 'Nam' WHEN BN.GIOITINH = 2 THEN N'Nữ'  END  AS GIOITINH ,            CASE WHEN BN.NGAYSINH IS NOT NULL THEN CONVERT(VARCHAR(10), BN.NGAYSINH, 103) ELSE CONVERT(VARCHAR(10), BN.NAMSINH) END as NGAYSINH,            CASE WHEN dt.TENDOITUONG IS NOT NULL THEN dt.TENDOITUONG  ELSE '' END as DOITUONG,            N'Y lệnh:' + TT.SOTHUTUTOA + ' - Ngày: ' + CONVERT(VARCHAR(10), KB.THOIGIANKHAM, 103) + ' - ' + CONVERT(VARCHAR(5), KB.THOIGIANKHAM, 108)            + CASE WHEN NV.TENNHANVIEN IS NOT NULL THEN + N' - Người lập: ' +  NV.TENNHANVIEN ELSE '' END            AS YLENH,            TT.TOATHUOC_ID,            TT.SOTHUTUTOA as REF_ID,            PL.MACHUNGTU,            TT.DUOC_ID,            d.MADUOC,            d.TENDUOCDAYDU,            d.DONVITINH,            TT.SOLUONG as SOLUONGYEUCAU,            trt.SOLUONG as SOLUONGTRA,            TT.NGAYTAO            FROM            TT_NOITRU_TOATHUOC TT            inner join TT_NOITRU_KHAMBENH KB on KB.KHAMBENH_ID = TT.KHAMBENH_ID            inner join TT_NOITRU_BENHAN BA on BA.BENHAN_ID = KB.BENHAN_ID            inner join TT_BENHNHAN BN on BA.BENHNHAN_ID = BN.BENHNHAN_ID            inner join TM_DUOC D on D.DUOC_ID = TT.DUOC_ID            inner join TM_LOAIDUOC LD on LD.LOAIDUOC_ID = D.LOAIDUOC_ID            left join TM_DOITUONG dt on BA.DOITUONG_ID = dt.DOITUONG_ID            left join TT_DUOC_PHIEULINH PL on PL.CHUNGTU_ID = TT.PHIEULINH_ID            left join TT_NOITRU_TRATHUOC_CHITIET trt on (trt.TOATHUOC_ID = TT.TOATHUOC_ID)            left join TM_NHANVIEN NV on TT.NGUOITAO_ID = NV.NHANVIEN_ID            WHERE            CONVERT(date, KB.THOIGIANKHAM) BETWEEN  CONVERT(date, '2/26/2020 12:00:00 AM')  AND  CONVERT(date, '2/26/2020 12:00:00 AM')            AND TT.CHUNGTU_ID is null            AND BA.TRANGTHAI = 'DANGDIEUTRI'            AND TT.PHONGBANRATOA_ID = '25'             and               TT.KHOTAO_ID = '29'                         AND (            (tt.COSO = '0'            AND tt.PHIEULINH_ID IS NOT NULL            AND tt.TOATHUOC_ID IN            (SELECT ctct.TOATHUOCNOITRU_ID FROM TT_DUOC_CHUNGTU_CHITIET ctct            inner join TT_DUOC_CHUNGTU ct on ct.CHUNGTU_ID = ctct.CHUNGTU_ID            and ct.MUCDICHCHUNGTU_CODE = 'N05'            and ct.KHONHAP_ID =  '29'            )            )            or            (tt.COSO = '1')            )            AND TT.BENHVIEN_ID = 'HLU01'            AND (BN.TENBENHNHAN like N'%%' OR BN.MAYTE like N'%%'  OR  BA.SOBENHAN  like N'%%'            or D.TENDUOCDAYDU like N'%%'            OR PL.MACHUNGTU like '%%'            )            AND LD.LOAIVATTU_ID = 'T'            order by NGAYTAO DESC]
2020-02-26 15:54:03,989 [1] DEBUG - Statement Id: [DAO00030_XUATSUDUNG_KHAMBENH_NGOAITRU_VTYT] PreparedStatement : [SELECT            N'Người bệnh: ' + BN.MAYTE + ' - ' + BN.TENBENHNHAN + ' - ' + N'Số TN: ' + TN.SOTIEPNHAN  as BENHNHAN,            CASE WHEN BN.GIOITINH = 1 THEN 'Nam' WHEN BN.GIOITINH = 2 THEN N'Nữ' END  AS GIOITINH ,            CASE WHEN BN.NGAYSINH IS NOT NULL THEN CONVERT(VARCHAR(10), BN.NGAYSINH, 103) ELSE CONVERT(VARCHAR(10), BN.NAMSINH) END as NGAYSINH,            CASE WHEN dt.TENDOITUONG IS NOT NULL THEN dt.TENDOITUONG  ELSE '' END as DOITUONG,            N'VTYT Ngoại trú ngày: ' + CONVERT(VARCHAR(10), VT.NGAYTAO, 103) + ' - ' + CONVERT(VARCHAR(5), VT.NGAYTAO, 108)            + CASE WHEN NV.TENNHANVIEN IS NOT NULL THEN + N' - Người lập: ' +  NV.TENNHANVIEN ELSE '' END            AS YLENH,            VT.KHAMBENH_VTYT_ID as TOATHUOC_ID,            DV.DVYEUCAU_ID as REF_ID,            PL.MACHUNGTU,            VT.DUOC_ID,            d.MADUOC,            d.TENDUOCDAYDU,            d.DONVITINH,            VT.SOLUONG as SOLUONGYEUCAU,            VT.NGAYTAO            FROM            TT_NGOAITRU_KHAMBENH_VTYT VT            inner join TT_DVYEUCAU DV on DV.DVYEUCAU_ID = VT.DVYEUCAU_ID            inner join TT_BENHNHAN BN on DV.BENHNHAN_ID = BN.BENHNHAN_ID            inner join TT_TIEPNHAN TN on TN.TIEPNHAN_ID = DV.TIEPNHAN_ID            left join TM_DOITUONG dt on TN.DOITUONG_ID = dt.DOITUONG_ID            left join TM_NHANVIEN NV on VT.NGUOITAO_ID = NV.NHANVIEN_ID            inner join TM_DUOC D on D.DUOC_ID = VT.DUOC_ID            inner join TM_LOAIDUOC LD on LD.LOAIDUOC_ID = D.LOAIDUOC_ID            left join TT_DUOC_PHIEULINH PL on PL.CHUNGTU_ID = VT.PHIEULINH_ID            WHERE            CONVERT(date, VT.NGAYTAO) BETWEEN  CONVERT(date, '2/26/2020 12:00:00 AM')  AND  CONVERT(date, '2/26/2020 12:00:00 AM')            AND VT.CHUNGTU_ID is null            AND VT.PHONGBAN_ID = '25'                          AND VT.BENHVIEN_ID = 'HLU01'              AND (BN.TENBENHNHAN like N'%%' OR BN.MAYTE like N'%%'              OR  TN.SOTIEPNHAN  like N'%%' or D.TENDUOCDAYDU like N'%%'              OR PL.MACHUNGTU like '%%'              )              AND LD.LOAIVATTU_ID = 'T'              order by NGAYTAO DESC]
2020-02-26 15:54:04,130 [1] DEBUG - Statement Id: [DAO00030_XUATSUDUNG_PTTT_VTYT] PreparedStatement : [SELECT            N'Người bệnh: ' + BN.MAYTE + ' - ' + BN.TENBENHNHAN + ' - '  + N'Số TN: ' + TN.SOTIEPNHAN  as BENHNHAN,            CASE WHEN BN.GIOITINH = 1 THEN 'Nam' WHEN BN.GIOITINH = 2 THEN N'Nữ' END  AS GIOITINH,            CASE WHEN BN.NGAYSINH IS NOT NULL THEN CONVERT(VARCHAR(10), BN.NGAYSINH, 103) ELSE CONVERT(VARCHAR(10), BN.NAMSINH) END as NGAYSINH,            CASE WHEN dt.TENDOITUONG IS NOT NULL THEN dt.TENDOITUONG  ELSE '' END as DOITUONG,            CASE            WHEN PT.LOAI = 'P'THEN N'Số phiếu Phẫu thuật: ' +  ISNULL(PT.SOPHIEUPHAUTHUAT,'')  + N' - Ngày: ' +  CONVERT(VARCHAR(10), ISNULL(VT.NGAYTAO,''), 103) + ' - ' + CONVERT(VARCHAR(5), ISNULL(VT.NGAYTAO,''), 108) + CASE WHEN NV.TENNHANVIEN IS NOT NULL THEN + N' - Người lập: ' +  NV.TENNHANVIEN ELSE '' END            ELSE N'Số phiếu Thủ thuật: ' +  ISNULL(PT.SOPHIEUPHAUTHUAT,'')  + N' - Ngày: ' +  CONVERT(VARCHAR(10), ISNULL(VT.NGAYTAO,''), 103) + ' - ' + CONVERT(VARCHAR(5), ISNULL(VT.NGAYTAO,''), 108) + CASE WHEN NV.TENNHANVIEN IS NOT NULL THEN + N' - Người lập: ' +  NV.TENNHANVIEN ELSE '' END            END  AS YLENH,            VT.PHAUTHUAT_VTYT_ID as TOATHUOC_ID,            VT.PHAUTHUAT_ID as REF_ID,            PL.MACHUNGTU,            VT.DUOC_ID,            d.MADUOC,            d.TENDUOCDAYDU,            d.DONVITINH,            VT.SOLUONG as SOLUONGYEUCAU,            VT.NGAYTAO            FROM            TT_PHAUTHUAT_VTYT VT            inner join TT_PHAUTHUAT PT on PT.PHAUTHUAT_ID = VT.PHAUTHUAT_ID            left join TT_TIEPNHAN TN on TN.TIEPNHAN_ID = PT.TIEPNHAN_ID            left join TT_BENHNHAN BN on BN.BENHNHAN_ID = TN.BENHNHAN_ID            left join TM_DOITUONG dt on TN.DOITUONG_ID = dt.DOITUONG_ID            left join TM_DUOC D on D.DUOC_ID = VT.DUOC_ID            left join TM_LOAIDUOC LD on LD.LOAIDUOC_ID = D.LOAIDUOC_ID            left join TM_NHANVIEN NV on VT.NGUOITAO_ID = NV.NHANVIEN_ID            left join TT_DUOC_PHIEULINH PL on PL.CHUNGTU_ID = VT.CHUNGTU_ID            WHERE            CONVERT(date, VT.NGAYTAO) BETWEEN  CONVERT(date, '2/26/2020 12:00:00 AM')  AND  CONVERT(date, '2/26/2020 12:00:00 AM')            AND VT.CHUNGTU_ID is null                          AND PT.PHONGBANTHUCHIEN_ID = '25'              AND VT.BENHVIEN_ID = 'HLU01'              AND (BN.TENBENHNHAN like N'%%' OR BN.MAYTE like N'%%' OR  TN.SOTIEPNHAN  like N'%%' or D.TENDUOCDAYDU like N'%%'              OR PL.MACHUNGTU like '%%'              )              AND LD.LOAIVATTU_ID = 'T'              order by NGAYTAO DESC]
2020-02-26 15:54:04,183 [1] DEBUG - Statement Id: [DAO00030_XUATSUDUNG_CLS_VTYT] PreparedStatement : [SELECT            N'Người bệnh: ' + BN.MAYTE + ' - ' + BN.TENBENHNHAN + ' - '  + N'Số TN: ' + TN.SOTIEPNHAN  as BENHNHAN,            CASE WHEN BN.GIOITINH = 1 THEN 'Nam' WHEN BN.GIOITINH = 2 THEN N'Nữ' END  AS GIOITINH,            CASE WHEN BN.NGAYSINH IS NOT NULL THEN CONVERT(VARCHAR(10), BN.NGAYSINH, 103) ELSE CONVERT(VARCHAR(10), BN.NAMSINH) END as NGAYSINH,            CASE WHEN dt.TENDOITUONG IS NOT NULL THEN dt.TENDOITUONG  ELSE '' END as DOITUONG,            N'Số phiếu CLS: ' +  ISNULL(DV.SOPHIEUYEUCAU,'')  + N' - Ngày: ' +  CONVERT(VARCHAR(10), ISNULL(CLS_VT.NGAYTAO,''), 103) + ' - ' + CONVERT(VARCHAR(5), ISNULL(CLS_VT.NGAYTAO,''), 108) + CASE WHEN NV.TENNHANVIEN IS NOT NULL THEN + N' - Người lập: ' +  NV.TENNHANVIEN ELSE '' END            AS YLENH,            CLS_VT.CLSKETQUA_VTYT_ID as TOATHUOC_ID,            DV.DVYEUCAU_ID as REF_ID,            PL.MACHUNGTU,            CLS_VT.DUOC_ID,            d.MADUOC,            d.TENDUOCDAYDU,            d.DONVITINH,            CLS_VT.SOLUONG as SOLUONGYEUCAU,            CLS_VT.NGAYTAO            FROM            TT_CLSKETQUA_VTYT CLS_VT            inner join TT_DVYEUCAU DV on DV.DVYEUCAU_ID = CLS_VT.DVYEUCAU_ID            left join TT_CLSKETQUA CLS on CLS.CLSKETQUA_ID = CLS_VT.CLSKETQUA_ID            left join TT_BENHNHAN BN on DV.BENHNHAN_ID = BN.BENHNHAN_ID            left join TT_TIEPNHAN TN on TN.TIEPNHAN_ID = DV.TIEPNHAN_ID            left join TM_PHONGBAN pb on pb.PHONGBAN_ID = CLS_VT.PHONGBAN_ID            left join TM_DOITUONG dt on dt.DOITUONG_ID = DV.DOITUONG_ID            left join TM_NHANVIEN NV on NV.NHANVIEN_ID = CLS_VT.NGUOITAO_ID            left join TM_DUOC D on D.DUOC_ID = CLS_VT.DUOC_ID            left join TM_LOAIDUOC LD on LD.LOAIDUOC_ID = D.LOAIDUOC_ID            left join TT_DUOC_PHIEULINH PL on PL.CHUNGTU_ID = CLS_VT.CHUNGTU_ID            WHERE            CONVERT(date, CLS_VT.NGAYTAO) BETWEEN  CONVERT(date, '2/26/2020 12:00:00 AM')  AND  CONVERT(date, '2/26/2020 12:00:00 AM')            AND CLS_VT.CHUNGTU_ID is null                          AND CLS_VT.PHONGBAN_ID = '25'              AND CLS_VT.BENHVIEN_ID = 'HLU01'              AND (BN.TENBENHNHAN like N'%%' OR BN.MAYTE like N'%%' OR  TN.SOTIEPNHAN  like N'%%' or D.TENDUOCDAYDU like N'%%'              OR PL.MACHUNGTU like '%%'              )              AND LD.LOAIVATTU_ID = 'T'              order by NGAYTAO DESC]
2020-02-26 15:54:08,011 [1] DEBUG - Statement Id: [DAO00030_Search_PhieuXuatSD] PreparedStatement : [SELECT DISTINCT phieuxuat.* FROM          (          select DISTINCT          CT.CHUNGTU_ID,          CT.SOCHUNGTU,          CT.MACHUNGTU,          CT.NGAYCHUNGTU,          CT.NGAYTAO,          CT.KHOXUAT_ID,          CT.NGUOIGIAO_ID,          CT.KHONHAP_ID,          CT.NGUOINHAN_ID,          PL.MACHUNGTU as MAPHIEULINH,          PL.NGAYCHUNGTU as NGAYPHIEULINH,          bn.MAYTE,          bn.TENBENHNHAN,          CONVERT(VARCHAR(10), KB.THOIGIANKHAM, 103) + ' - ' + CONVERT(VARCHAR(5), KB.THOIGIANKHAM, 108) as THOIGIANKHAM,          nl.TENNHANVIEN as NGUOILAP,          CT.DIENGIAI          from TT_DUOC_CHUNGTU CT          inner join TT_DUOC_CHUNGTU_CHITIET ctct on ct.CHUNGTU_ID = ctct.CHUNGTU_ID          inner join TT_NOITRU_TOATHUOC TT on ctct.TOATHUOCNOITRU_ID = TT.TOATHUOC_ID          inner join TT_NOITRU_KHAMBENH KB on kb.KHAMBENH_ID = TT.KHAMBENH_ID          inner join TT_BENHNHAN BN on TT.BENHNHAN_ID = BN.BENHNHAN_ID          left join TT_DUOC_PHIEULINH PL on PL.CHUNGTU_ID = CT.PHIEULINH_ID          left join TM_NHANVIEN nl on nl.NHANVIEN_ID = TT.NGUOITAO_ID           where                   CT.MUCDICHCHUNGTU_ID = '1060'               and                 CT.KHOXUAT_ID = '29'               and                 CONVERT(date, CT.NGAYCHUNGTU) BETWEEN CONVERT(date, '2/26/2020 12:00:00 AM')  and  CONVERT(date, '2/26/2020 12:00:00 AM')               and                 CT.BENHVIEN_ID = 'HLU01'                           UNION            select DISTINCT          CT.CHUNGTU_ID,          CT.SOCHUNGTU,          CT.MACHUNGTU,          CT.NGAYCHUNGTU,          CT.NGAYTAO,          CT.KHOXUAT_ID,          CT.NGUOIGIAO_ID,          CT.KHONHAP_ID,          CT.NGUOINHAN_ID,          PL.MACHUNGTU as MAPHIEULINH,          PL.NGAYCHUNGTU as NGAYPHIEULINH,          bn.MAYTE,          bn.TENBENHNHAN,          CONVERT(VARCHAR(10), KB.THOIGIANKHAM, 103) + ' - ' + CONVERT(VARCHAR(5), KB.THOIGIANKHAM, 108) as THOIGIANKHAM,          nl.TENNHANVIEN as NGUOILAP,          CT.DIENGIAI          from TT_DUOC_CHUNGTU CT          inner join TT_DUOC_CHUNGTU_CHITIET ctct on ct.CHUNGTU_ID = ctct.CHUNGTU_ID          inner join TT_NGOAITRU_KHAMBENH_VTYT vt on ctct.KHAMBENH_VTYT_ID = vt.KHAMBENH_VTYT_ID          inner join TT_NGOAITRU_KHAMBENH kb on kb.KHAMBENH_ID = vt.KHAMBENH_ID          inner join TT_BENHNHAN BN on bn.BENHNHAN_ID = kb.BENHNHAN_ID          left join TT_DUOC_PHIEULINH PL on PL.CHUNGTU_ID = CT.PHIEULINH_ID          left join TM_NHANVIEN nl on nl.NHANVIEN_ID = vt.NGUOITAO_ID           where                   CT.MUCDICHCHUNGTU_ID = '1060'               and                 CT.KHOXUAT_ID = '29'               and                 CONVERT(date, CT.NGAYCHUNGTU) BETWEEN CONVERT(date, '2/26/2020 12:00:00 AM')  and  CONVERT(date, '2/26/2020 12:00:00 AM')               and                 CT.BENHVIEN_ID = 'HLU01'                           UNION            select DISTINCT          CT.CHUNGTU_ID,          CT.SOCHUNGTU,          CT.MACHUNGTU,          CT.NGAYCHUNGTU,          CT.NGAYTAO,          CT.KHOXUAT_ID,          CT.NGUOIGIAO_ID,          CT.KHONHAP_ID,          CT.NGUOINHAN_ID,          PL.MACHUNGTU as MAPHIEULINH,          PL.NGAYCHUNGTU as NGAYPHIEULINH,          bn.MAYTE,          bn.TENBENHNHAN,          CONVERT(VARCHAR(10), pt.NGAYTHUCHIEN, 103) + ' - ' + CONVERT(VARCHAR(5), pt.NGAYTHUCHIEN, 108) as THOIGIANKHAM,          nl.TENNHANVIEN as NGUOILAP,          CT.DIENGIAI          from TT_DUOC_CHUNGTU CT          inner join TT_DUOC_CHUNGTU_CHITIET ctct on ct.CHUNGTU_ID = ctct.CHUNGTU_ID          inner join TT_PHAUTHUAT_VTYT vt on ctct.PHAUTHUAT_VTYT_ID = vt.PHAUTHUAT_VTYT_ID          inner join TT_PHAUTHUAT pt on pt.PHAUTHUAT_ID = vt.PHAUTHUAT_ID          inner join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = pt.TIEPNHAN_ID          inner join TT_BENHNHAN bn on bn.BENHNHAN_ID = tn.BENHNHAN_ID          left join TT_DUOC_PHIEULINH PL on PL.CHUNGTU_ID = CT.PHIEULINH_ID          left join TM_NHANVIEN nl on nl.NHANVIEN_ID = pt.NGUOITAO_ID           where                   CT.MUCDICHCHUNGTU_ID = '1060'               and                 CT.KHOXUAT_ID = '29'               and                 CONVERT(date, CT.NGAYCHUNGTU) BETWEEN CONVERT(date, '2/26/2020 12:00:00 AM')  and  CONVERT(date, '2/26/2020 12:00:00 AM')               and                 CT.BENHVIEN_ID = 'HLU01'                           UNION            select DISTINCT          CT.CHUNGTU_ID,          CT.SOCHUNGTU,          CT.MACHUNGTU,          CT.NGAYCHUNGTU,          CT.NGAYTAO,          CT.KHOXUAT_ID,          CT.NGUOIGIAO_ID,          CT.KHONHAP_ID,          CT.NGUOINHAN_ID,          PL.MACHUNGTU as MAPHIEULINH,          PL.NGAYCHUNGTU as NGAYPHIEULINH,          bn.MAYTE,          bn.TENBENHNHAN,          CONVERT(VARCHAR(10), cls.NGAYTAO, 103) + ' - ' + CONVERT(VARCHAR(5), cls.NGAYTAO, 108) as THOIGIANKHAM,          nl.TENNHANVIEN as NGUOILAP,          CT.DIENGIAI          from TT_DUOC_CHUNGTU CT          inner join TT_DUOC_CHUNGTU_CHITIET ctct on ct.CHUNGTU_ID = ctct.CHUNGTU_ID          inner join TT_CLSKETQUA_VTYT cls on ctct.CLSKETQUA_VTYT_ID = cls.CLSKETQUA_VTYT_ID          inner join TT_DVYEUCAU DV on DV.DVYEUCAU_ID = CLS.DVYEUCAU_ID          inner join TT_BENHNHAN bn on bn.BENHNHAN_ID = DV.BENHNHAN_ID          left join TT_DUOC_PHIEULINH PL on PL.CHUNGTU_ID = CT.PHIEULINH_ID          left join TM_NHANVIEN nl on nl.NHANVIEN_ID = cls.NGUOITAO_ID           where                   CT.MUCDICHCHUNGTU_ID = '1060'               and                 CT.KHOXUAT_ID = '29'               and                 CONVERT(date, CT.NGAYCHUNGTU) BETWEEN CONVERT(date, '2/26/2020 12:00:00 AM')  and  CONVERT(date, '2/26/2020 12:00:00 AM')               and                 CT.BENHVIEN_ID = 'HLU01'                           UNION            select DISTINCT          CT.CHUNGTU_ID,          CT.SOCHUNGTU,          CT.MACHUNGTU,          CT.NGAYCHUNGTU,          CT.NGAYTAO,          CT.KHOXUAT_ID,          CT.NGUOIGIAO_ID,          CT.KHONHAP_ID,          CT.NGUOINHAN_ID,          PL.MACHUNGTU as MAPHIEULINH,          PL.NGAYCHUNGTU as NGAYPHIEULINH,          null as MAYTE,          null as TENBENHNHAN,          null as THOIGIANKHAM,          nl.TENNHANVIEN as NGUOILAP,          CT.DIENGIAI          from TT_DUOC_CHUNGTU CT          inner join TT_DUOC_CHUNGTU_CHITIET ctct on ct.CHUNGTU_ID = ctct.CHUNGTU_ID          left join TT_DUOC_PHIEULINH PL on PL.CHUNGTU_ID = CT.PHIEULINH_ID          left join TM_NHANVIEN nl on nl.NHANVIEN_ID = ct.NGUOITAO_ID          WHERE (ctct.TOATHUOCNOITRU_ID IS NULL AND ctct.KHAMBENH_VTYT_ID IS NULL AND ctct.PHAUTHUAT_VTYT_ID IS NULL AND ctct.CLSKETQUA_VTYT_ID IS NULL)             and                 CT.MUCDICHCHUNGTU_ID = '1060'               and                 CT.KHOXUAT_ID = '29'               and                 CONVERT(date, CT.NGAYCHUNGTU) BETWEEN CONVERT(date, '2/26/2020 12:00:00 AM')  and  CONVERT(date, '2/26/2020 12:00:00 AM')               and                 CT.BENHVIEN_ID = 'HLU01'                         )PhieuXuat          ORDER BY PhieuXuat.CHUNGTU_ID desc]
2020-02-26 15:54:21,395 [1] DEBUG - Statement Id: [DAO00017_GetLoaiGiaDoiTuongDichVu] PreparedStatement : [select a.LOAIGIA_ID, a.TENLOAIGIA, a.MALOAIGIA, a.CAPTREN_ID, MIN(a.UUTIEN_NGUON) AS UUTIEN_NGUON          , MAX(a.DOUUTIEN) AS DOUUTIEN, MIN(ISNULL(a.GIAHOTRO,0)) AS GIAHOTRO          from(                        select distinct A.LOAIGIA_ID, C.TENLOAIGIA, C.MALOAIGIA, 0 as UUTIEN_NGUON, isnull(B.DOUUTIEN,0) as DOUUTIEN, B.GIAHOTRO, C.CAPTREN_ID            from TM_DOITUONG_GIADICHVU A            left join TM_DOITUONG_LOAIGIA B on A.LOAIGIA_ID = B.LOAIGIA_ID and A.DOITUONG_ID = B.DOITUONG_ID and B.BENHVIEN_ID = 'HLU01'            inner join TM_LOAIGIA C on A.LOAIGIA_ID = C.LOAIGIA_ID and C.BENHVIEN_ID = 'HLU01'            where A.DOITUONG_ID = '4'                            and C.CAPTREN_ID = (select LOAIGIA_ID from TM_LOAIGIA              where MALOAIGIA = 'GiaDichVu'              and BENHVIEN_ID = 'HLU01')                         and A.BENHVIEN_ID = 'HLU01'                     ) a          where a.DOUUTIEN != 0 and a.DOUUTIEN is not null          group by a.LOAIGIA_ID, a.TENLOAIGIA, a.MALOAIGIA, a.CAPTREN_ID          order by MAX(a.UUTIEN_NGUON) desc ,MAX(a.DOUUTIEN) asc]
2020-02-26 15:54:25,650 [1] DEBUG - Statement Id: [DAO00014_GetInPatientStatus] PreparedStatement : [select TRANGTHAI, isnull(KHOACHUYENDEN_ID, KHOAVAO_ID) as KHOAHIENTAI from TT_NOITRU_BENHAN        where        TIEPNHAN_ID = '107181'        and BENHVIEN_ID = 'HLU01'         and           BENHAN_ID = '24642']
2020-02-26 15:54:25,735 [1] DEBUG - Statement Id: [DAO00024_TT_VIENPHI_GetList_DSDichVuChuaThuTien] PreparedStatement : [SELECT TOP 1 VIENPHI_ID              FROM TT_VIENPHI              WHERE              DATHANHTOAN = 0]
2020-02-26 15:54:25,761 [1] DEBUG - Statement Id: [DAO00067_laytrangthaibenhannoitru] PreparedStatement : [select isnull(TRANGTHAI, '') TRANGTHAI from TT_NOITRU_BENHAN where BENHAN_ID =  @param0]
2020-02-26 15:54:25,761 [1] DEBUG - Statement Id: [DAO00067_laytrangthaibenhannoitru] Parameters: [@param0=[BENHAN_ID,24642]]
2020-02-26 15:54:25,761 [1] DEBUG - Statement Id: [DAO00067_laytrangthaibenhannoitru] Types: [@param0=[Int64, System.Int64]]
2020-02-26 15:54:25,787 [1] DEBUG - Statement Id: [DAO00067_DeleteVienPhi_Noref] PreparedStatement : [delete from TT_VIENPHI where TIEPNHAN_ID = 107181 and (REF_ID is null or REF_ID = 0)         and           BENHAN_ID = '24642'                 delete TT_DUOC_TONKHO_BOOK_NOITRU where REF_TABLE = 'TT_NOITRU_TOATHUOC' and (REF_ID is null or REF_ID = 0)        delete TT_DUOC_TONKHO_BOOK_NGOAITRU where REF_ID is null or REF_ID = 0]
2020-02-26 15:54:25,813 [1] DEBUG - Statement Id: [DAO00067_UpdateBenhanIdVienPhi] PreparedStatement : [update TT_VIENPHI          set BENHAN_ID =  @param0           from (select TOATHUOC_ID from TT_NOITRU_TOATHUOC where TIEPNHAN_ID =  @param1 ) nttt          where REF_TABLE = 'TT_NOITRU_TOATHUOC' and REF_ID = nttt.TOATHUOC_ID and isnull(BENHAN_ID, 0) = 0          and TIEPNHAN_ID =  @param1             update TT_VIENPHI          set TT_VIENPHI.BENHAN_ID =  @param0           from (select DVYEUCAU_ID, BENHAN_ID from TT_DVYEUCAU where TIEPNHAN_ID =  @param1 ) nttt          where TT_VIENPHI.REF_TABLE = 'TT_DVYEUCAU' and TT_VIENPHI.REF_ID = nttt.DVYEUCAU_ID          and isnull(TT_VIENPHI.BENHAN_ID, 0) = 0 and isnull(nttt.BENHAN_ID, 0) > 0          and TT_VIENPHI.TIEPNHAN_ID =  @param1]
2020-02-26 15:54:25,813 [1] DEBUG - Statement Id: [DAO00067_UpdateBenhanIdVienPhi] Parameters: [@param0=[BENHAN_ID,24642], @param1=[TIEPNHAN_ID,107181]]
2020-02-26 15:54:25,813 [1] DEBUG - Statement Id: [DAO00067_UpdateBenhanIdVienPhi] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64]]
2020-02-26 15:54:25,841 [1] DEBUG - Statement Id: [DAO00064_GetlistTT_TIEPNHAN_SOTHEBHYT] PreparedStatement : [select stbhyt.*, ba.SOBENHAN,        tn.SOTIEPNHAN, tn.LOAITHANHVIEN_ID, tn.THE_ID, tn.THANHVIEN_ID,        tn.SUDUNG_BHTN, tn.BAOLANH_VIENPHI, tn.VIP, tn.NGUOINUOCNGOAI        from TT_TIEPNHAN_SOTHEBHYT stbhyt        left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = stbhyt.TIEPNHAN_ID        left join TT_NOITRU_BENHAN ba on ba.TIEPNHAN_ID = stbhyt.TIEPNHAN_ID        where        stbhyt.TIEPNHAN_ID = '107181' and isnull(stbhyt.KHONGSUDUNG, '0') = '0'         and           ba.BENHAN_ID = '24642']
2020-02-26 15:54:25,891 [1] DEBUG - Statement Id: [DAO00064_GetListVienPhiByTiepNnan] PreparedStatement : [select distinct        B.DOITUONG_ID, B.NGAYMIENDONGCHITRA, B.BENHNHAN_ID as TIEPNHAN_BENHNHAN_ID, B.TRAITUYEN,        B.BHYTTREN3NAM as TREN3NAM, B.BHYTTREN5NAM as TREN5NAM, B.SOTIEPNHAN, B.SOBENHAN,        B.LOAITHANHVIEN_ID, B.SUDUNG_BHTN, B.THE_ID, B.THANHVIEN_ID, B.BAOLANH_VIENPHI, B.VIP, B.NGUOINUOCNGOAI,        C.GIATRIMIENGIAM as GIATRIMIENGIAM, D.GIATRIMIENGIAM as GIATRIMIENGIAM_BHTN, E.GIATRIMIENGIAM as GIATRIMIENGIAM_THANHVIEN,        F.GIATRIMIENGIAM as GIATRIMIENGIAM_CONGTY, DVYC.THE_ID as DVDUNGTHE, DVYC.TRANGTHAI as TRANGTHAIDICHVU, ndv.MANHOMDICHVU,        A.* from TT_VIENPHI A        left join        (select B.*, C.SOBENHAN, C.BENHAN_ID        from TT_TIEPNHAN B        left join TT_NOITRU_BENHAN C on B.TIEPNHAN_ID = C.TIEPNHAN_ID         and           C.BENHAN_ID = '24642'                 where B.TIEPNHAN_ID = '107181') B on B.TIEPNHAN_ID = A.TIEPNHAN_ID        left join (select sum(GIATRIMIENGIAM) as GIATRIMIENGIAM, VIENPHI_ID, REF_TABLE        from TT_MIENGIAM_CHITIET        where REF_TABLE = 'TT_MIENGIAM'        and exists (select MIENGIAM_ID from TT_MIENGIAM where TT_MIENGIAM_CHITIET.MIENGIAM_ID = MIENGIAM_ID and TINHTRANG = 1 and TIEPNHAN_ID = '107181')        group by VIENPHI_ID, REF_TABLE) C on C.REF_TABLE = 'TT_MIENGIAM' and C.VIENPHI_ID = A.VIENPHI_ID        left join (select sum(GIATRIMIENGIAM) as GIATRIMIENGIAM, VIENPHI_ID, REF_TABLE        from TT_MIENGIAM_CHITIET        where REF_TABLE = 'TT_MIENGIAM_BHTN'        and exists (select MIENGIAM_BHTN_ID from TT_MIENGIAM_BHTN where TT_MIENGIAM_CHITIET.MIENGIAM_ID = MIENGIAM_BHTN_ID and  TINHTRANG = 1 and TIEPNHAN_ID = '107181')        group by VIENPHI_ID, REF_TABLE) D on D.REF_TABLE = 'TT_MIENGIAM_BHTN' and D.VIENPHI_ID = A.VIENPHI_ID        left join (select sum(GIATRIMIENGIAM) as GIATRIMIENGIAM, VIENPHI_ID, REF_TABLE        from TT_MIENGIAM_CHITIET        where REF_TABLE = 'TT_MIENGIAM_THANHVIEN'        and exists (select MIENGIAM_THANHVIEN_ID from TT_MIENGIAM_THANHVIEN where TT_MIENGIAM_CHITIET.MIENGIAM_ID = MIENGIAM_THANHVIEN_ID and TINHTRANG = 1 and TIEPNHAN_ID = '107181')        group by VIENPHI_ID, REF_TABLE) E on E.REF_TABLE = 'TT_MIENGIAM_THANHVIEN' and E.VIENPHI_ID = A.VIENPHI_ID        left join (select sum(GIATRIMIENGIAM) as GIATRIMIENGIAM, VIENPHI_ID, REF_TABLE        from TT_MIENGIAM_CHITIET        where REF_TABLE = 'TT_MIENGIAM_CONGTY'        and exists (select MIENGIAM_CONGTY_ID from TT_MIENGIAM_CONGTY where TT_MIENGIAM_CHITIET.MIENGIAM_ID = MIENGIAM_CONGTY_ID and TINHTRANG = 1 and TIEPNHAN_ID = '107181')        group by VIENPHI_ID, REF_TABLE) F on F.REF_TABLE = 'TT_MIENGIAM_CONGTY' and F.VIENPHI_ID = A.VIENPHI_ID        left join TT_DVYEUCAU DVYC on DVYC.DVYEUCAU_ID = A.REF_ID and A.REF_TABLE = 'TT_DVYEUCAU'        left join TM_DICHVU DV on DVYC.DICHVU_ID = DV.DICHVU_ID and A.REF_TABLE = 'TT_DVYEUCAU'        left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = DV.NHOMDICHVU_ID and A.REF_TABLE = 'TT_DVYEUCAU'        where        A.TIEPNHAN_ID = '107181' and ((DVYC.HUYYEUCAU = '0' and A.DICHVU_ID is not null)        or A.DUOC_ID is not null or A.REF_TABLE = 'TT_NUT_XACNHANSUATAN_CHITIET')        and A.ACTIVE = '1'         and           A.BENHAN_ID = '24642'                 and A.BENHVIEN_ID = 'HLU01'        order by A.VIENPHI_ID]
2020-02-26 15:54:26,005 [1] DEBUG - Statement Id: [DAO00006_GetListDuocTyle] PreparedStatement : [select DUOC_ID, DOITUONG_ID, (TYLE/100) as TYLE, DONGIA MUCTRAN_THANHTOAN from TM_DOITUONG_GIADUOC_TYLE            where            BENHVIEN_ID = 'HLU01'            and DOITUONG_ID = '4']
2020-02-26 15:54:26,029 [1] DEBUG - Statement Id: [DAO00027_GetListTuongTrinhDichVuPhauThuatCuaTiepNhan] PreparedStatement : [declare @ManhomDSA varchar(10);        declare @PhanLoaiNhomDV varchar(20) = '05';        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        if (@ManhomDSA is not null) set @PhanLoaiNhomDV += ',' + @ManhomDSA        select distinct ptyc.*        from TT_PHAUTHUAT_YEUCAU ptyc        inner join TM_DICHVU dv on dv.DICHVU_ID = ptyc.DICHVU_ID        inner join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID        inner join TT_PHAUTHUAT pt on pt.PHAUTHUAT_ID = ptyc.PHAUTHUAT_ID        where        pt.TIEPNHAN_ID = 107181        and (left(ndv.MANHOMDICHVU, 2) in (select * from STRING_SPLIT(@PhanLoaiNhomDV,',')) or ndv.MANHOMDICHVU in (select * from STRING_SPLIT(@PhanLoaiNhomDV,',')))]
2020-02-26 15:54:26,127 [1] DEBUG - Statement Id: [DAO00027_GetListTuongTrinhVTYTPhauThuatCuaTiepNhan] PreparedStatement : [select distinct ptvt.*        from TT_PHAUTHUAT_VTYT ptvt        inner join TT_PHAUTHUAT pt on pt.PHAUTHUAT_ID = ptvt.PHAUTHUAT_ID        inner join TM_DUOC d on d.DUOC_ID = ptvt.DUOC_ID        inner join TM_LOAIDUOC ld on ld.LOAIVATTU_ID = 'V' and ld.LOAIDUOC_ID = d.LOAIDUOC_ID        where pt.TIEPNHAN_ID = 107181        order by ptvt.PHAUTHUAT_VTYT_ID asc]
2020-02-26 15:54:26,167 [1] DEBUG - Statement Id: [DAO00006_GetList] PreparedStatement : [select dv.*, loaiDV.MALOAIDICHVU, captren.NHOMDICHVU_ID as NHOMDICHVU_CAPTREN_ID, captren.TENNHOMDICHVU as NHOMDICHVU_CAPTREN,              nhom_dv.TENNHOMDICHVU as TENNHOMDICHVU, nhom_dv.MANHOMDICHVU,              case when dv.ATTRIBUTE5 is null then 'TT' else 'KTC' end as LOAI_CHIPHI              from TM_DICHVU as dv              left join TM_NHOMDICHVU as nhom_dv on nhom_dv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID and nhom_dv.BENHVIEN_ID = 'HLU01'              left join TM_NHOMDICHVU as captren on nhom_dv.CAPTREN_ID = captren.NHOMDICHVU_ID and captren.BENHVIEN_ID = 'HLU01'              left join TM_LOAIDICHVU loaiDV on nhom_dv.LOAIDICHVU_ID = loaiDV.LOAIDICHVU_ID and loaiDV.BENHVIEN_ID = 'HLU01'              where nhom_dv.TAMNGUNG = '0' and dv.BENHVIEN_ID = 'HLU01'              and dv.TAMNGUNG = '0'               AND                   loaiDV.MALOAIDICHVU = 'KhamBenh']
2020-02-26 15:54:26,225 [1] DEBUG - Statement Id: [DAO00027_GetDichvuYCBHYTTyle] PreparedStatement : [select DVYEUCAU_ID from TT_DVYEUCAU        where TIEPNHAN_ID = 107181 and isnull(BHYT_TYLETHANHTOAN_ID, 0) > 0]
2020-02-26 15:54:26,506 [1] DEBUG - Statement Id: [DAO00023_UpdateNhieuVP] PreparedStatement : [declare @jsonVienPhi nvarchar(max) = N'[{"VIENPHI_ID":3109614,"TIEPNHAN_ID":107181,"DICHVU_ID":5440,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":34500.0000,"THANHTIEN_DOANHTHU":34500.00,"BHYT_TL":0.8000,"BHYT_DONGIA":34500.0000,"BHYT_THANHTIEN":34500.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":27600.0,"BHYT_THANHTIEN_CHITRA":27600.00,"BENHNHAN_PHAITHANHTOAN":6900.00,"GIATRI_HOADON":6900.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3109615,"TIEPNHAN_ID":107181,"DICHVU_ID":5554,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":5000.0000,"THANHTIEN_DOANHTHU":5000.00,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":5000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110619,"TIEPNHAN_ID":107181,"DICHVU_ID":4022,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":43900.0000,"THANHTIEN_DOANHTHU":43900.00,"BHYT_TL":0.8000,"BHYT_DONGIA":43900.0000,"BHYT_THANHTIEN":43900.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":35120.0,"BHYT_THANHTIEN_CHITRA":35120.00,"BENHNHAN_PHAITHANHTOAN":8780.00,"GIATRI_HOADON":8780.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110620,"TIEPNHAN_ID":107181,"DICHVU_ID":4422,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":32800.0000,"THANHTIEN_DOANHTHU":32800.00,"BHYT_TL":0.8000,"BHYT_DONGIA":32800.0000,"BHYT_THANHTIEN":32800.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":26240.0,"BHYT_THANHTIEN_CHITRA":26240.00,"BENHNHAN_PHAITHANHTOAN":6560.00,"GIATRI_HOADON":6560.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110621,"TIEPNHAN_ID":107181,"DICHVU_ID":4451,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":63500.0000,"THANHTIEN_DOANHTHU":63500.00,"BHYT_TL":0.8000,"BHYT_DONGIA":63500.0000,"BHYT_THANHTIEN":63500.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":50800.0,"BHYT_THANHTIEN_CHITRA":50800.00,"BENHNHAN_PHAITHANHTOAN":12700.00,"GIATRI_HOADON":12700.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110622,"TIEPNHAN_ID":107181,"DICHVU_ID":4454,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":40400.0000,"THANHTIEN_DOANHTHU":40400.00,"BHYT_TL":0.8000,"BHYT_DONGIA":40400.0000,"BHYT_THANHTIEN":40400.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":32320.0,"BHYT_THANHTIEN_CHITRA":32320.00,"BENHNHAN_PHAITHANHTOAN":8080.00,"GIATRI_HOADON":8080.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110623,"TIEPNHAN_ID":107181,"DICHVU_ID":4523,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":40400.0000,"THANHTIEN_DOANHTHU":40400.00,"BHYT_TL":0.8000,"BHYT_DONGIA":40400.0000,"BHYT_THANHTIEN":40400.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":32320.0,"BHYT_THANHTIEN_CHITRA":32320.00,"BENHNHAN_PHAITHANHTOAN":8080.00,"GIATRI_HOADON":8080.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110624,"TIEPNHAN_ID":107181,"DICHVU_ID":4596,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":39100.0000,"THANHTIEN_DOANHTHU":39100.00,"BHYT_TL":0.8000,"BHYT_DONGIA":39100.0000,"BHYT_THANHTIEN":39100.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":31280.0,"BHYT_THANHTIEN_CHITRA":31280.00,"BENHNHAN_PHAITHANHTOAN":7820.00,"GIATRI_HOADON":7820.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110626,"TIEPNHAN_ID":107181,"DICHVU_ID":4642,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":21500.0000,"THANHTIEN_DOANHTHU":21500.00,"BHYT_TL":0.8000,"BHYT_DONGIA":21500.0000,"BHYT_THANHTIEN":21500.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":17200.0,"BHYT_THANHTIEN_CHITRA":17200.00,"BENHNHAN_PHAITHANHTOAN":4300.00,"GIATRI_HOADON":4300.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110628,"TIEPNHAN_ID":107181,"DICHVU_ID":4681,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":21500.0000,"THANHTIEN_DOANHTHU":21500.00,"BHYT_TL":0.8000,"BHYT_DONGIA":21500.0000,"BHYT_THANHTIEN":21500.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":17200.0,"BHYT_THANHTIEN_CHITRA":17200.00,"BENHNHAN_PHAITHANHTOAN":4300.00,"GIATRI_HOADON":4300.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110629,"TIEPNHAN_ID":107181,"DICHVU_ID":4722,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":21500.0000,"THANHTIEN_DOANHTHU":21500.00,"BHYT_TL":0.8000,"BHYT_DONGIA":21500.0000,"BHYT_THANHTIEN":21500.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":17200.0,"BHYT_THANHTIEN_CHITRA":17200.00,"BENHNHAN_PHAITHANHTOAN":4300.00,"GIATRI_HOADON":4300.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110630,"TIEPNHAN_ID":107181,"DICHVU_ID":4747,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":27400.0000,"THANHTIEN_DOANHTHU":27400.00,"BHYT_TL":0.8000,"BHYT_DONGIA":27400.0000,"BHYT_THANHTIEN":27400.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":21920.0,"BHYT_THANHTIEN_CHITRA":21920.00,"BENHNHAN_PHAITHANHTOAN":5480.00,"GIATRI_HOADON":5480.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110631,"TIEPNHAN_ID":107181,"DICHVU_ID":4832,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":70000.0000,"THANHTIEN_DOANHTHU":70000.00,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":70000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":70000.0000,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":70000.0000,"GIATRI_BENHNHAN_DATHANHTOAN":70000.0000,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110632,"TIEPNHAN_ID":107181,"DICHVU_ID":4873,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":70000.0000,"THANHTIEN_DOANHTHU":70000.00,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":70000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":70000.0000,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":70000.0000,"GIATRI_BENHNHAN_DATHANHTOAN":70000.0000,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119342,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":5.0000,"DONGIA_DOANHTHU":4000.0000,"THANHTIEN_DOANHTHU":20000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":20000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119500,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":2.0000,"DONGIA_DOANHTHU":8715.0000,"THANHTIEN_DOANHTHU":17430.00,"BHYT_TL":0.8000,"BHYT_DONGIA":8715.0000,"BHYT_THANHTIEN":17430.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":6972.0,"BHYT_THANHTIEN_CHITRA":13944.00,"BENHNHAN_PHAITHANHTOAN":3486.00,"GIATRI_HOADON":3486.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119501,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":8925.0000,"THANHTIEN_DOANHTHU":8925.00,"BHYT_TL":0.8000,"BHYT_DONGIA":8925.0000,"BHYT_THANHTIEN":8925.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":7140.0,"BHYT_THANHTIEN_CHITRA":7140.00,"BENHNHAN_PHAITHANHTOAN":1785.00,"GIATRI_HOADON":1785.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119502,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":2.0000,"DONGIA_DOANHTHU":27990.0000,"THANHTIEN_DOANHTHU":55980.00,"BHYT_TL":0.8000,"BHYT_DONGIA":27990.0000,"BHYT_THANHTIEN":55980.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":22392.0,"BHYT_THANHTIEN_CHITRA":44784.00,"BENHNHAN_PHAITHANHTOAN":11196.00,"GIATRI_HOADON":11196.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119503,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":8925.0000,"THANHTIEN_DOANHTHU":8925.00,"BHYT_TL":0.8000,"BHYT_DONGIA":8925.0000,"BHYT_THANHTIEN":8925.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":7140.0,"BHYT_THANHTIEN_CHITRA":7140.00,"BENHNHAN_PHAITHANHTOAN":1785.00,"GIATRI_HOADON":1785.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119504,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":2.0000,"DONGIA_DOANHTHU":8295.0000,"THANHTIEN_DOANHTHU":16590.00,"BHYT_TL":0.8000,"BHYT_DONGIA":8295.0000,"BHYT_THANHTIEN":16590.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":6636.0,"BHYT_THANHTIEN_CHITRA":13272.00,"BENHNHAN_PHAITHANHTOAN":3318.00,"GIATRI_HOADON":3318.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119505,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":458000.0000,"THANHTIEN_DOANHTHU":458000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":398036.0000,"BHYT_THANHTIEN":398036.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":318428.8,"BHYT_THANHTIEN_CHITRA":318428.80,"BENHNHAN_PHAITHANHTOAN":139571.20,"GIATRI_HOADON":79607.20,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119506,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":50400.0000,"THANHTIEN_DOANHTHU":50400.00,"BHYT_TL":0.8000,"BHYT_DONGIA":50400.0000,"BHYT_THANHTIEN":50400.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":40320.0,"BHYT_THANHTIEN_CHITRA":40320.00,"BENHNHAN_PHAITHANHTOAN":10080.00,"GIATRI_HOADON":10080.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119530,"TIEPNHAN_ID":107181,"DICHVU_ID":5363,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":10000.0000,"THANHTIEN_DOANHTHU":10000.00,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119531,"TIEPNHAN_ID":107181,"DICHVU_ID":5588,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":2400.0000,"THANHTIEN_DOANHTHU":2400.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119532,"TIEPNHAN_ID":107181,"DICHVU_ID":477,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":110000.0000,"THANHTIEN_DOANHTHU":110000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119533,"TIEPNHAN_ID":107181,"DICHVU_ID":5602,"BENHAN_ID":24642,"SOLUONG":0.5000,"DONGIA_DOANHTHU":200000.0000,"THANHTIEN_DOANHTHU":100000.00,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":100000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119535,"TIEPNHAN_ID":107181,"DICHVU_ID":3161,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":2945000.0000,"THANHTIEN_DOANHTHU":2945000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":2945000.0000,"BHYT_THANHTIEN":2945000.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":2356000.0,"BHYT_THANHTIEN_CHITRA":2356000.00,"BENHNHAN_PHAITHANHTOAN":589000.00,"GIATRI_HOADON":589000.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119536,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":0.2500,"DONGIA_DOANHTHU":25000.0000,"THANHTIEN_DOANHTHU":6250.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119537,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":2.0000,"DONGIA_DOANHTHU":1700.0000,"THANHTIEN_DOANHTHU":3400.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119538,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":3.0000,"DONGIA_DOANHTHU":1000.0000,"THANHTIEN_DOANHTHU":3000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119539,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":3.0000,"DONGIA_DOANHTHU":2000.0000,"THANHTIEN_DOANHTHU":6000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119540,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":4000.0000,"THANHTIEN_DOANHTHU":4000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119541,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":3000.0000,"THANHTIEN_DOANHTHU":3000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119542,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":100.0000,"DONGIA_DOANHTHU":50.0000,"THANHTIEN_DOANHTHU":5000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119543,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":150000.0000,"THANHTIEN_DOANHTHU":150000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119544,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":160000.0000,"THANHTIEN_DOANHTHU":160000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119545,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":20.0000,"DONGIA_DOANHTHU":3000.0000,"THANHTIEN_DOANHTHU":60000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119546,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":20.0000,"DONGIA_DOANHTHU":6000.0000,"THANHTIEN_DOANHTHU":120000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119547,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":5.0000,"DONGIA_DOANHTHU":4000.0000,"THANHTIEN_DOANHTHU":20000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119548,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":10.0000,"DONGIA_DOANHTHU":8000.0000,"THANHTIEN_DOANHTHU":80000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119549,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":2.0000,"DONGIA_DOANHTHU":500.0000,"THANHTIEN_DOANHTHU":1000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119550,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":10000.0000,"THANHTIEN_DOANHTHU":10000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119551,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":45000.0000,"THANHTIEN_DOANHTHU":45000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119552,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":35000.0000,"THANHTIEN_DOANHTHU":35000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119553,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":10000.0000,"THANHTIEN_DOANHTHU":10000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119554,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":20000.0000,"THANHTIEN_DOANHTHU":20000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119555,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":6500.0000,"THANHTIEN_DOANHTHU":6500.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119556,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":0.5000,"DONGIA_DOANHTHU":16000.0000,"THANHTIEN_DOANHTHU":8000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119557,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":0.2500,"DONGIA_DOANHTHU":100000.0000,"THANHTIEN_DOANHTHU":25000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119558,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":2.0000,"DONGIA_DOANHTHU":10000.0000,"THANHTIEN_DOANHTHU":20000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119559,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":60000.0000,"THANHTIEN_DOANHTHU":60000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119560,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":2.0000,"DONGIA_DOANHTHU":13500.0000,"THANHTIEN_DOANHTHU":27000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119561,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":6000.0000,"THANHTIEN_DOANHTHU":6000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119645,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":600.0000,"THANHTIEN_DOANHTHU":600.00,"BHYT_TL":0.8000,"BHYT_DONGIA":600.0000,"BHYT_THANHTIEN":600.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":480.0,"BHYT_THANHTIEN_CHITRA":480.00,"BENHNHAN_PHAITHANHTOAN":120.00,"GIATRI_HOADON":120.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":0.0,"DUOC_TYLE":0.0000},{"VIENPHI_ID":3119646,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":1000.0000,"THANHTIEN_DOANHTHU":1000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":1000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"1","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":0.0,"DUOC_TYLE":0.0000},{"VIENPHI_ID":3119647,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":600.0000,"THANHTIEN_DOANHTHU":600.00,"BHYT_TL":0.8000,"BHYT_DONGIA":600.0000,"BHYT_THANHTIEN":600.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":480.0,"BHYT_THANHTIEN_CHITRA":480.00,"BENHNHAN_PHAITHANHTOAN":120.00,"GIATRI_HOADON":120.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":0.0,"DUOC_TYLE":0.0000},{"VIENPHI_ID":3119648,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":1000.0000,"THANHTIEN_DOANHTHU":1000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":1000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"1","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":0.0,"DUOC_TYLE":0.0000}]';        begin        UPDATE TT_VIENPHI        SET        SOLUONG = json.SOLUONG,        DONGIA_DOANHTHU = json.DONGIA_DOANHTHU,        THANHTIEN_DOANHTHU = json.THANHTIEN_DOANHTHU,        BHYT_TL = json.BHYT_TL,        BHYT_DONGIA = json.BHYT_DONGIA,        BHYT_THANHTIEN = json.BHYT_THANHTIEN,        BHYT_DONGIA_CONGKHAM_DAU = json.BHYT_DONGIA_CONGKHAM_DAU,        BHYT_CONGKHAM_DAU_TYLE = json.BHYT_CONGKHAM_DAU_TYLE,        BHYT_DONGIA_CHITRA = json.BHYT_DONGIA_CHITRA,        BHYT_THANHTIEN_CHITRA = json.BHYT_THANHTIEN_CHITRA,        BENHNHAN_PHAITHANHTOAN = json.BENHNHAN_PHAITHANHTOAN,        GIATRI_HOADON = json.GIATRI_HOADON,        GIATRI_BIENLAI = json.GIATRI_BIENLAI,        DATHUCHIEN = json.DATHUCHIEN,        DICHVU_TL = json.DICHVU_TL,        BHYT_DONGIA_DONGCT_DAU = json.BHYT_DONGIA_DONGCT_DAU,        SOLONHAP_ID = json.SOLONHAP_ID,        DUOC_TYLE = json.DUOC_TYLE,        DUOC_MUCTRAN_THANHTOAN = json.DUOC_MUCTRAN_THANHTOAN,        NGAYCAPNHAT = GETDATE()        FROM OPENJSON (@jsonVienPhi)        WITH (        VIENPHI_ID int,        SOLUONG numeric(25, 4),        DONGIA_DOANHTHU numeric(25, 4),        THANHTIEN_DOANHTHU numeric(25, 4),        BHYT_TL numeric(25, 4),        BHYT_DONGIA numeric(25, 4),        BHYT_THANHTIEN numeric(25, 4),        BHYT_DONGIA_CONGKHAM_DAU numeric(25, 4),        BHYT_CONGKHAM_DAU_TYLE numeric(25, 4),        BHYT_DONGIA_CHITRA numeric(25, 4),        BHYT_THANHTIEN_CHITRA numeric(25, 4),        BENHNHAN_PHAITHANHTOAN numeric(25, 4),        GIATRI_HOADON numeric(25, 4),        GIATRI_BIENLAI numeric(25, 4),        DATHUCHIEN char(1),        KHONGTHUTIEN char(1),        BHYTDONGTIEN char(1),        DICHVU_TL numeric(25, 4),        BHYT_DONGIA_DONGCT_DAU numeric(25, 4),        SOLONHAP_ID int,        DUOC_TYLE numeric(25, 4),        DUOC_MUCTRAN_THANHTOAN numeric(25, 4))  json        WHERE TT_VIENPHI.VIENPHI_ID = json.VIENPHI_ID and json.DONGIA_DOANHTHU > 0                  insert into TT_TINH_VIENPHI_LOG        SELECT json.VIENPHI_ID, json.TIEPNHAN_ID, json.BENHAN_ID, json.SOLUONG, json.BHYT_TL, json.DONGIA_DOANHTHU,        json.THANHTIEN_DOANHTHU, json.BHYT_DONGIA, json.BHYT_THANHTIEN, json.BHYT_DONGIA_CHITRA, json.BHYT_THANHTIEN_CHITRA, json.BENHNHAN_PHAITHANHTOAN,        json.SOBHYT_HUONG_ID, json.SOBHYT, GETDATE(), -1, 'HLU01'        FROM OPENJSON(@jsonVienPhi)        WITH (        VIENPHI_ID int,        TIEPNHAN_ID int,        BENHAN_ID int,        SOLUONG numeric(25, 4),        DONGIA_DOANHTHU numeric(25, 4),        THANHTIEN_DOANHTHU numeric(25, 4),        BHYT_TL numeric(25, 4),        BHYT_DONGIA numeric(25, 4),        BHYT_THANHTIEN numeric(25, 4),        BHYT_DONGIA_CHITRA numeric(25, 4),        BHYT_THANHTIEN_CHITRA numeric(25, 4),        BENHNHAN_PHAITHANHTOAN numeric(25, 4),        SOBHYT_HUONG_ID int,        SOBHYT nvarchar(30)) json        end]
2020-02-26 15:54:26,814 [1] DEBUG - Statement Id: [DAO00067_UpdateDataVienPhiDongiaBHYT] PreparedStatement : [update TT_VIENPHI          set BHYT_DONGIA_CHITRA = 0, BHYT_THANHTIEN = 0, BHYT_THANHTIEN_CHITRA = 0          where          TIEPNHAN_ID = 107181 and BHYT_DONGIA = 0          and (BHYT_DONGIA_CHITRA > 0 or BHYT_THANHTIEN > 0 or BHYT_THANHTIEN_CHITRA > 0)]
2020-02-26 15:54:26,851 [1] DEBUG - Statement Id: [DAO00067_CapnhatDataVienphiKhiHuyThanhtoanHoadon] PreparedStatement : [update TT_VIENPHI        set TT_VIENPHI.HOADON_ID = hdct.HOADON_ID, TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN = TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN + hdct.GIATRI_BENHNHAN_DATHANHTOAN        from (select CT.HOADON_ID, CT.VIENPHI_ID, CT.GIATRI_BENHNHAN_DATHANHTOAN        from TT_HOADON_CHITIET_NGOAITRU CT        join TT_HOADON HD on HD.HOADON_ID = CT.HOADON_ID        join TT_VIENPHI vp on vp.VIENPHI_ID = ct.VIENPHI_ID        where HD.DATHANHTOAN = 1 and HD.HUYHOADON = 0 and HD.HOANTRA = 0 and vp.TIEPNHAN_ID =  @param0 ) hdct        where        TT_VIENPHI.VIENPHI_ID = hdct.VIENPHI_ID and TT_VIENPHI.HOADON_ID is null and isnull(TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN,0) = 0        and TT_VIENPHI.TIEPNHAN_ID =  @param0           update TT_VIENPHI        set TT_VIENPHI.HOADON_ID = null, TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN = TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN - hdct.GIATRI_BENHNHAN_DATHANHTOAN,        TT_VIENPHI.DATHANHTOAN = '0'        from (select CT.HOADON_ID, CT.VIENPHI_ID, CT.GIATRI_BENHNHAN_DATHANHTOAN        from TT_HOADON_CHITIET_NGOAITRU CT        join TT_HOADON HD on HD.HOADON_ID = CT.HOADON_ID        join TT_VIENPHI vp on vp.VIENPHI_ID = ct.VIENPHI_ID and vp.HOADON_ID = ct.HOADON_ID        where HD.DATHANHTOAN = 0 and (HD.HUYHOADON = 1 or HD.HOANTRA = 1) and vp.TIEPNHAN_ID =  @param0 ) hdct        where        TT_VIENPHI.VIENPHI_ID = hdct.VIENPHI_ID and TT_VIENPHI.HOADON_ID = hdct.HOADON_ID        and TT_VIENPHI.TIEPNHAN_ID =  @param0]
2020-02-26 15:54:26,851 [1] DEBUG - Statement Id: [DAO00067_CapnhatDataVienphiKhiHuyThanhtoanHoadon] Parameters: [@param0=[TIEPNHAN_ID,107181]]
2020-02-26 15:54:26,851 [1] DEBUG - Statement Id: [DAO00067_CapnhatDataVienphiKhiHuyThanhtoanHoadon] Types: [@param0=[Int64, System.Int64]]
2020-02-26 15:54:26,891 [1] DEBUG - Statement Id: [DAO00000_GetDoiTuongIsBHYT] PreparedStatement : [select * from TM_DOITUONG Where DOITUONG_ID = 4 and MADOITUONG like '%BHYT%']
2020-02-26 15:54:26,968 [1] DEBUG - Statement Id: [DAO00064_GetDOITUONG] PreparedStatement : [SELECT TOP 1        DT.TENDOITUONG,        BHYT.SOTHE,        BHYT.NGAYHIEULUC,        BHYT.NGAYHETHIEULUC,        BHYT.BENHVIEN_KCB_ID AS MABENHVIEN,        BV.TENBENHVIEN,        BHYT.NGAYMIENDONGCHITRA,        BHYT.TREN5NAM          FROM TT_BENHNHAN_BHYT BHYT, TM_DOITUONG DT, TM_BENHVIEN BV        WHERE        DT.NHOMTHE LIKE '%' + LEFT(BHYT.SOTHE,3) + '%'        AND BHYT.BENHNHAN_ID = '20633'        AND BHYT.BENHVIEN_KCB_ID = BV.MABENHVIEN        ORDER BY BHYT.NGAYTAO DESC]
2020-02-26 15:54:27,070 [1] DEBUG - Statement Id: [DAO00064_GetNgayDangKyDichVu] PreparedStatement : [SELECT        DISTINCT CONVERT(date, NGAYTAO) as NGAYCHIPHI        FROM TT_VIENPHI        WHERE        TIEPNHAN_ID = '107181'         and           BENHAN_ID = '24642'                 ORDER BY NGAYCHIPHI]
2020-02-26 15:54:27,096 [1] DEBUG - Statement Id: [DAO00064_GetAllNgayYeucauDV] PreparedStatement : [SELECT        DISTINCT DVYEUCAU_ID, DICHVU_ID, CONVERT(date, NGAYYEUCAU) NGAYYEUCAU        FROM TT_DVYEUCAU        WHERE        TIEPNHAN_ID = '107181'         and           BENHAN_ID = '24642']
2020-02-26 15:54:27,122 [1] DEBUG - Statement Id: [DAO00064_GetAllNgayYeucauYlenh] PreparedStatement : [SELECT        DISTINCT A.TOATHUOC_ID, A.KHAMBENH_ID, A.DUOC_ID, CONVERT(date, B.THOIGIANKHAM) NGAYYEUCAU        FROM TT_NOITRU_TOATHUOC A        inner join TT_NOITRU_KHAMBENH B on B.KHAMBENH_ID = A.KHAMBENH_ID        WHERE        B.BENHAN_ID = '24642']
2020-02-26 15:54:27,151 [1] DEBUG - Statement Id: [DAO00063_AllGetTrangThaiThuocbyBenan_Id] PreparedStatement : [select A.CHUNGTU_ID, A.PHIEULINH_ID, A.HUYTOATHUOC, A.NGUOITAO_ID, A.TOATHUOC_ID        from TT_NOITRU_TOATHUOC A        inner join TT_NOITRU_KHAMBENH B on B.KHAMBENH_ID = A.KHAMBENH_ID        where B.BENHAN_ID  = '24642']
2020-02-26 15:54:27,180 [1] DEBUG - Statement Id: [DAO00064_TT_VIENPHI_GetList] PreparedStatement : [select distinct a.*, b.TINHTRANG AS TINHTRANG_MG, d.TINHTRANG_BHTN, e.TINHTRANG_MGCT        , b.MIENGIAMCHITIET_ID, b.GIATRIMIENGIAM, d.GIATRIMIENGIAM_BHTN, e.GIATRIMIENGIAM_CONGTY, e.GIATRIMIENGIAM_CONGTY as GIATRIMIENGIAM_CTCT, f.GIATRIMIENGIAM_THANHVIEN        , c.DVKEMTHEO, c.DVKEMTHEO_KHACEKIP, isnull(ttnt.PHONGBANRATOA_ID,c.NOIYEUCAU_ID) NOIYEUCAU_ID, c.NOITHUCHIEN_ID, c.DVYEUCAU_ID, c.HUYYEUCAU, c.DANGKY_ID,        isnull(dv.TENDICHVU, dc.TENDUOCDAYDU) NOIDUNG, isnull(dv.MADICHVU, dc.MADUOC) MADICHVU, dv.NORESULT, dc.DONVITINH, ld.MALOAIDUOC, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ndv.MANHOMDICHVU,        dv.BHYT DV_BHYT        from        (select VP.*, sbh.SOBHYT as SOBHYT_HUONG        from TT_VIENPHI VP        left join TT_TIEPNHAN_SOTHEBHYT sbh on sbh.SOBHYT_HUONG_ID = VP.SOBHYT_HUONG_ID        where        ((isnull(VP.GIATRI_BENHNHAN_DATHANHTOAN, 0) = 0 and isnull(VP.DATHANHTOAN, 0) = 0)        and VP.REF_TABLE != 'TT_MAU_CHUNGTU_CHITIET'                 )         and           VP.TIEPNHAN_ID = '107181'         and           VP.BENHAN_ID = '24642'         and           VP.BENHVIEN_ID = 'HLU01'                 )a left join                   (        select VIENPHI_ID, MG.TINHTRANG, MGCT.MIENGIAMCHITIET_ID, Sum(MGCT.GIATRIMIENGIAM) as GIATRIMIENGIAM        from TT_MIENGIAM MG INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_ID = MGCT.MIENGIAM_ID        where MG.TIEPNHAN_ID= '107181' and MGCT.REF_TABLE = 'TT_MIENGIAM'        group by VIENPHI_ID, MG.TINHTRANG, MGCT.MIENGIAMCHITIET_ID        )b        on a.VIENPHI_ID = b.VIENPHI_ID          left join(        select VIENPHI_ID, MG.TINHTRANG AS TINHTRANG_BHTN, SUM(MGCT.GIATRIMIENGIAM) as GIATRIMIENGIAM_BHTN        from TT_MIENGIAM_BHTN MG INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_BHTN_ID = MGCT.MIENGIAM_ID        where MG.TIEPNHAN_ID= '107181' and MGCT.REF_TABLE = 'TT_MIENGIAM_BHTN'        group by VIENPHI_ID, MG.TINHTRANG        )d        on a.VIENPHI_ID = d.VIENPHI_ID          left join(        select VIENPHI_ID, MG.TINHTRANG AS TINHTRANG_MGCT, Sum(MGCT.GIATRIMIENGIAM) as GIATRIMIENGIAM_CONGTY        from TT_MIENGIAM_CONGTY MG INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_CONGTY_ID = MGCT.MIENGIAM_ID        where MG.TIEPNHAN_ID= '107181' and MGCT.REF_TABLE = 'TT_MIENGIAM_CONGTY'        group by VIENPHI_ID, MG.TINHTRANG        )e        on a.VIENPHI_ID = e.VIENPHI_ID          left join(        select VIENPHI_ID, MG.TINHTRANG AS TINHTRANG_MGCT, Sum(MGCT.GIATRIMIENGIAM) as GIATRIMIENGIAM_THANHVIEN        from TT_MIENGIAM_THANHVIEN MG INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_THANHVIEN_ID = MGCT.MIENGIAM_ID        where MG.TIEPNHAN_ID= '107181' and MGCT.REF_TABLE = 'TT_MIENGIAM_THANHVIEN'        group by VIENPHI_ID, MG.TINHTRANG        )f        on a.VIENPHI_ID = f.VIENPHI_ID          left join        (        select DVYEUCAU_ID, TRANGTHAI, BHYTDONGTIEN, HUYYEUCAU, DVKEMTHEO, DVKEMTHEO_KHACEKIP, NOIYEUCAU_ID, NOITHUCHIEN_ID, DANGKY_ID from TT_DVYEUCAU        where TIEPNHAN_ID = '107181'        )c on c.DVYEUCAU_ID = a.REF_ID and a.REF_TABLE = 'TT_DVYEUCAU'        left join        (        select PHONGBANRATOA_ID, TOATHUOC_ID, 'TT_NOITRU_TOATHUOC' REF_TABLE  from TT_NOITRU_TOATHUOC where TIEPNHAN_ID  = '107181'        union        select PHONGBAN_ID as PHONGBANRATOA_ID, CLSKETQUA_VTYT_ID as TOATHUOC_ID, 'TT_CLSKETQUA_VTYT' REF_TABLE        from TT_CLSKETQUA_VTYT where exists (select DVYEUCAU_ID from TT_DVYEUCAU where TT_CLSKETQUA_VTYT.DVYEUCAU_ID = DVYEUCAU_ID and TIEPNHAN_ID  = '107181')        union        select PHONGBAN_ID as PHONGBANRATOA_ID, KHAMBENH_VTYT_ID as TOATHUOC_ID, 'TT_NGOAITRU_KHAMBENH_VTYT' REF_TABLE        from TT_NGOAITRU_KHAMBENH_VTYT where exists (select DVYEUCAU_ID from TT_DVYEUCAU where TT_NGOAITRU_KHAMBENH_VTYT.DVYEUCAU_ID = DVYEUCAU_ID and  TIEPNHAN_ID  = '107181')        union        select B.PHONGBANTHUCHIEN_ID as PHONGBANRATOA_ID, PHAUTHUAT_VTYT_ID as TOATHUOC_ID, 'TT_PHAUTHUAT_VTYT' REF_TABLE        from TT_PHAUTHUAT_VTYT A        left join TT_PHAUTHUAT B on A.PHAUTHUAT_ID = B.PHAUTHUAT_ID        where B.TIEPNHAN_ID  = '107181'        union        select B.PHONGBAN_ID as PHONGBANRATOA_ID, TOATHUOC_ID, 'TT_NGOAITRU_TOATHUOC' REF_TABLE        from TT_NGOAITRU_TOATHUOC A        left join TT_NGOAITRU_KHAMBENH B on A.KHAMBENH_ID = B.KHAMBENH_ID        where B.TIEPNHAN_ID  = '107181'        ) ttnt on ttnt.TOATHUOC_ID = a.REF_ID and a.REF_TABLE = ttnt.REF_TABLE        left join TM_DUOC dc on A.DUOC_ID = dc.DUOC_ID        left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID        left join TM_DICHVU dv on A.DICHVU_ID = dv.DICHVU_ID and A.REF_TABLE = 'TT_DVYEUCAU'        left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID        where        c.HUYYEUCAU = '0' or c.HUYYEUCAU is null]
2020-02-26 15:54:27,236 [1] DEBUG - Statement Id: [DAO00330_TT_VIENPHI_GetList] PreparedStatement : [select distinct a.*, b.TINHTRANG AS TINHTRANG_MG, d.TINHTRANG_BHTN, e.TINHTRANG_MGCT      , b.MIENGIAMCHITIET_ID, b.GIATRIMIENGIAM, d.GIATRIMIENGIAM_BHTN, e.GIATRIMIENGIAM_CONGTY, e.GIATRIMIENGIAM_CONGTY as GIATRIMIENGIAM_CTCT, f.GIATRIMIENGIAM_THANHVIEN      , NULL AS DVKEMTHEO, NULL AS DVKEMTHEO_KHACEKIP, ttnt.PHONGBANRATOA_ID NOIYEUCAU_ID, NULL AS NOITHUCHIEN_ID, NULL AS DVYEUCAU_ID, 0 AS HUYYEUCAU, NULL AS DANGKY_ID,      dc.TENMAU NOIDUNG, dc.MAMAU MADICHVU, NULL AS NORESULT, DVT.TENDONVITINH AS DONVITINH, ld.MALOAIMAU AS MALOAIDUOC, DC.BHYT AS DUOC_BHYT, 'M' AS LOAIVATTU_ID,NM.TENNHOMMAU AS MANHOMDICHVU      from      (select VP.*, sbh.SOBHYT as SOBHYT_HUONG      from TT_VIENPHI VP      left join TT_TIEPNHAN_SOTHEBHYT sbh on sbh.SOBHYT_HUONG_ID = VP.SOBHYT_HUONG_ID      where (VP.GIATRI_BENHNHAN_DATHANHTOAN = 0 or VP.GIATRI_BENHNHAN_DATHANHTOAN is null)       and             VP.TIEPNHAN_ID = '107181'           and           VP.BENHAN_ID = '24642'         and             VP.BENHVIEN_ID = 'HLU01'                   )a left join                       (      select VIENPHI_ID, MG.TINHTRANG, MGCT.MIENGIAMCHITIET_ID, MGCT.GIATRIMIENGIAM      from TT_MIENGIAM MG INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_ID = MGCT.MIENGIAM_ID      where      MG.TIEPNHAN_ID= '107181' and MGCT.REF_TABLE = 'TT_MIENGIAM'      )b      on a.VIENPHI_ID = b.VIENPHI_ID        left join(      select VIENPHI_ID, MG.TINHTRANG AS TINHTRANG_BHTN, MGCT.GIATRIMIENGIAM as GIATRIMIENGIAM_BHTN      from TT_MIENGIAM_BHTN MG INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_BHTN_ID = MGCT.MIENGIAM_ID      where      MG.TIEPNHAN_ID= '107181' and MGCT.REF_TABLE = 'TT_MIENGIAM_BHTN'      )d      on a.VIENPHI_ID = d.VIENPHI_ID        left join(      select VIENPHI_ID, MG.TINHTRANG AS TINHTRANG_MGCT, MGCT.GIATRIMIENGIAM as GIATRIMIENGIAM_CONGTY      from TT_MIENGIAM_CONGTY MG INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_CONGTY_ID = MGCT.MIENGIAM_ID      where      MG.TIEPNHAN_ID= '107181' and MGCT.REF_TABLE = 'TT_MIENGIAM_CONGTY'      )e      on a.VIENPHI_ID = e.VIENPHI_ID        left join(      select VIENPHI_ID, MG.TINHTRANG AS TINHTRANG_MGCT, MGCT.GIATRIMIENGIAM as GIATRIMIENGIAM_THANHVIEN      from TT_MIENGIAM_THANHVIEN MG INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_THANHVIEN_ID = MGCT.MIENGIAM_ID      where      MG.TIEPNHAN_ID= '107181' and MGCT.REF_TABLE = 'TT_MIENGIAM_THANHVIEN'      )f      on a.VIENPHI_ID = f.VIENPHI_ID      inner join      (      select DK.NOICHIDINH_ID as PHONGBANRATOA_ID, CT.CHUNGTUCHITIET_ID, 'TT_MAU_CHUNGTU_CHITIET' REF_TABLE      from TT_MAU_DANGKYMAU DK JOIN TT_MAU_DANGKYMAU_CHITIET DKCT ON DK.DANGKYMAU_ID = DKCT.DANGKYMAU_ID AND DK.TIEPNHAN_ID  = '107181'      INNER JOIN TT_MAU_CHUNGTU CTU ON DKCT.CHUNGTU_ID = CTU.CHUNGTU_ID AND CTU.CHUNGTULIENQUAN_ID IS NULL      JOIN TT_MAU_CHUNGTU_CHITIET CT ON CT.CHUNGTU_ID=CTU.CHUNGTU_ID      ) ttnt on ttnt.CHUNGTUCHITIET_ID = a.REF_ID and a.REF_TABLE = ttnt.REF_TABLE      left join TM_MAU dc on A.DUOC_ID = dc.MAU_ID      LEFT JOIN TM_MAU_DONVITINH DVT ON DC.DONVITINH_ID = DVT.DONVITINH_ID      left join TM_MAU_LOAIMAU ld on dc.LOAIMAU_ID = ld.LOAIMAU_ID      LEFT JOIN TM_MAU_NHOMMAU NM ON NM.NHOMMAU_ID = LD.NHOMMAU_ID]
2020-02-26 15:54:27,278 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN200102.0000252']
2020-02-26 15:54:27,303 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"5440","DVYEUCAU_ID":"988882"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"5440","DVYEUCAU_ID":"988882"}' order by ID desc)        order by A.ID desc]
2020-02-26 15:54:27,515 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN200102.0000252']
2020-02-26 15:54:27,543 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"5554","DVYEUCAU_ID":"988883"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"5554","DVYEUCAU_ID":"988883"}' order by ID desc)        order by A.ID desc]
2020-02-26 15:54:27,577 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN200102.0000252']
2020-02-26 15:54:27,601 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"4022","DVYEUCAU_ID":"989243"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"4022","DVYEUCAU_ID":"989243"}' order by ID desc)        order by A.ID desc]
2020-02-26 15:54:27,852 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN200102.0000252']
2020-02-26 15:54:28,017 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"4422","DVYEUCAU_ID":"989244"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"4422","DVYEUCAU_ID":"989244"}' order by ID desc)        order by A.ID desc]
2020-02-26 15:54:28,192 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN200102.0000252']
2020-02-26 15:54:28,345 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"4451","DVYEUCAU_ID":"989245"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"4451","DVYEUCAU_ID":"989245"}' order by ID desc)        order by A.ID desc]
2020-02-26 15:54:28,492 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN200102.0000252']
2020-02-26 15:54:28,516 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"4454","DVYEUCAU_ID":"989246"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"4454","DVYEUCAU_ID":"989246"}' order by ID desc)        order by A.ID desc]
2020-02-26 15:54:28,684 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN200102.0000252']
2020-02-26 15:54:28,846 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"4523","DVYEUCAU_ID":"989247"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"4523","DVYEUCAU_ID":"989247"}' order by ID desc)        order by A.ID desc]
2020-02-26 15:54:28,992 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN200102.0000252']
2020-02-26 15:54:29,160 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"4596","DVYEUCAU_ID":"989248"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"4596","DVYEUCAU_ID":"989248"}' order by ID desc)        order by A.ID desc]
2020-02-26 15:54:29,307 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN200102.0000252']
2020-02-26 15:54:29,334 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"4642","DVYEUCAU_ID":"989250"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"4642","DVYEUCAU_ID":"989250"}' order by ID desc)        order by A.ID desc]
2020-02-26 15:54:29,479 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN200102.0000252']
2020-02-26 15:54:29,504 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"4681","DVYEUCAU_ID":"989252"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"4681","DVYEUCAU_ID":"989252"}' order by ID desc)        order by A.ID desc]
2020-02-26 15:54:29,657 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN200102.0000252']
2020-02-26 15:54:29,755 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"4722","DVYEUCAU_ID":"989253"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"4722","DVYEUCAU_ID":"989253"}' order by ID desc)        order by A.ID desc]
2020-02-26 15:54:29,901 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN200102.0000252']
2020-02-26 15:54:29,927 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"4747","DVYEUCAU_ID":"989254"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"4747","DVYEUCAU_ID":"989254"}' order by ID desc)        order by A.ID desc]
2020-02-26 15:54:30,116 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN200102.0000252']
2020-02-26 15:54:30,140 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"5363","DVYEUCAU_ID":"992248"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"5363","DVYEUCAU_ID":"992248"}' order by ID desc)        order by A.ID desc]
2020-02-26 15:54:30,383 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN200102.0000252']
2020-02-26 15:54:30,502 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"5588","DVYEUCAU_ID":"992249"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"5588","DVYEUCAU_ID":"992249"}' order by ID desc)        order by A.ID desc]
2020-02-26 15:54:30,869 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN200102.0000252']
2020-02-26 15:54:30,894 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"477","DVYEUCAU_ID":"992250"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"477","DVYEUCAU_ID":"992250"}' order by ID desc)        order by A.ID desc]
2020-02-26 15:54:31,111 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN200102.0000252']
2020-02-26 15:54:31,220 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"5602","DVYEUCAU_ID":"992251"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"5602","DVYEUCAU_ID":"992251"}' order by ID desc)        order by A.ID desc]
2020-02-26 15:54:31,418 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN200102.0000252']
2020-02-26 15:54:31,442 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"3161","DVYEUCAU_ID":"992253"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"3161","DVYEUCAU_ID":"992253"}' order by ID desc)        order by A.ID desc]
2020-02-26 15:54:31,843 [1] DEBUG - Statement Id: [DAO00017_GetLoaiGiaDoiTuongDichVu] PreparedStatement : [select a.LOAIGIA_ID, a.TENLOAIGIA, a.MALOAIGIA, a.CAPTREN_ID, MIN(a.UUTIEN_NGUON) AS UUTIEN_NGUON          , MAX(a.DOUUTIEN) AS DOUUTIEN, MIN(ISNULL(a.GIAHOTRO,0)) AS GIAHOTRO          from(                        select distinct A.LOAIGIA_ID, C.TENLOAIGIA, C.MALOAIGIA, 0 as UUTIEN_NGUON, isnull(B.DOUUTIEN,0) as DOUUTIEN, B.GIAHOTRO, C.CAPTREN_ID            from TM_DOITUONG_GIADICHVU A            left join TM_DOITUONG_LOAIGIA B on A.LOAIGIA_ID = B.LOAIGIA_ID and A.DOITUONG_ID = B.DOITUONG_ID and B.BENHVIEN_ID = 'HLU01'            inner join TM_LOAIGIA C on A.LOAIGIA_ID = C.LOAIGIA_ID and C.BENHVIEN_ID = 'HLU01'            where A.DOITUONG_ID = '4'                            and C.CAPTREN_ID = (select LOAIGIA_ID from TM_LOAIGIA              where MALOAIGIA = 'GiaDichVu'              and BENHVIEN_ID = 'HLU01')                         and A.BENHVIEN_ID = 'HLU01'                     ) a          where a.DOUUTIEN != 0 and a.DOUUTIEN is not null          group by a.LOAIGIA_ID, a.TENLOAIGIA, a.MALOAIGIA, a.CAPTREN_ID          order by MAX(a.UUTIEN_NGUON) desc ,MAX(a.DOUUTIEN) asc]
2020-02-26 15:54:32,085 [1] DEBUG - Statement Id: [DAO00019_Get_TiepNhan_ThongtinChuyenVien] PreparedStatement : [select CHANDOANNGT, ICDNOIGIOITHIEU_ID, LYDOCHUYENVIEN_ID, NOIGIOITHIEU_ID, HINHTHUCCHUYENVIEN_ID, THOIGIANCHUYENTUYEN, SOCHUYENVIEN        from TT_TIEPNHAN        where TIEPNHAN_ID = '107181']
2020-02-26 15:54:32,187 [1] DEBUG - Statement Id: [DAO00019_GetBenhNhanThanhVien] PreparedStatement : [select A.*, B.TENTHETHANHVIEN, convert(varchar, A.NGAYHIEULUC, 103) as NGAYHIEULUCTHE, B.SOTIEN        from TT_CSKH_THANHVIEN_CAPTHE A        left join TM_CSKH_THETHANHVIEN B on B.THETHANHVIEN_ID = A.THETHANHVIEN_ID        where   THANHVIEN_ID in (        select THANHVIEN_ID from TT_CSKH_THANHVIEN        where (BENHNHAN_ID = '20633' and TAMNGUNG is null or TAMNGUNG = '0')        and (DAXOA is null or DAXOA = '0'))        and A.KICHHOAT = '1' and (A.TAMNGUNG = '0' or A.TAMNGUNG is null)                 and A.BENHVIEN_ID = 'HLU01'        order by THE_ID desc]
2020-02-26 15:54:32,211 [1] DEBUG - Statement Id: [DAO00019_GetBenhNhanThanhVien] PreparedStatement : [select A.*, B.TENTHETHANHVIEN, convert(varchar, A.NGAYHIEULUC, 103) as NGAYHIEULUCTHE, B.SOTIEN        from TT_CSKH_THANHVIEN_CAPTHE A        left join TM_CSKH_THETHANHVIEN B on B.THETHANHVIEN_ID = A.THETHANHVIEN_ID        where   THANHVIEN_ID in (        select THANHVIEN_ID from TT_CSKH_THANHVIEN        where (BENHNHAN_ID = '20633' and TAMNGUNG is null or TAMNGUNG = '0')        and (DAXOA is null or DAXOA = '0'))        and A.KICHHOAT = '1' and (A.TAMNGUNG = '0' or A.TAMNGUNG is null)                 and A.BENHVIEN_ID = 'HLU01'        order by THE_ID desc]
2020-02-26 15:54:34,641 [1] DEBUG - Statement Id: [DAO00017_GetLoaiGiaDoiTuongDichVu] PreparedStatement : [select a.LOAIGIA_ID, a.TENLOAIGIA, a.MALOAIGIA, a.CAPTREN_ID, MIN(a.UUTIEN_NGUON) AS UUTIEN_NGUON          , MAX(a.DOUUTIEN) AS DOUUTIEN, MIN(ISNULL(a.GIAHOTRO,0)) AS GIAHOTRO          from(                        select distinct A.LOAIGIA_ID, C.TENLOAIGIA, C.MALOAIGIA, 0 as UUTIEN_NGUON, isnull(B.DOUUTIEN,0) as DOUUTIEN, B.GIAHOTRO, C.CAPTREN_ID            from TM_DOITUONG_GIADICHVU A            left join TM_DOITUONG_LOAIGIA B on A.LOAIGIA_ID = B.LOAIGIA_ID and A.DOITUONG_ID = B.DOITUONG_ID and B.BENHVIEN_ID = 'HLU01'            inner join TM_LOAIGIA C on A.LOAIGIA_ID = C.LOAIGIA_ID and C.BENHVIEN_ID = 'HLU01'            where A.DOITUONG_ID = '4'                            and C.CAPTREN_ID = (select LOAIGIA_ID from TM_LOAIGIA              where MALOAIGIA = 'GiaDichVu'              and BENHVIEN_ID = 'HLU01')                         and A.BENHVIEN_ID = 'HLU01'                     ) a          where a.DOUUTIEN != 0 and a.DOUUTIEN is not null          group by a.LOAIGIA_ID, a.TENLOAIGIA, a.MALOAIGIA, a.CAPTREN_ID          order by MAX(a.UUTIEN_NGUON) desc ,MAX(a.DOUUTIEN) asc]
2020-02-26 15:54:34,895 [1] DEBUG - Statement Id: [DAO00017_GetLoaiGiaDuocByDoiTuongId] PreparedStatement : [select A.LOAIGIA_ID, C.TENLOAIGIA from TM_DOITUONG_LOAIGIA A          inner join TM_LOAIGIA C on A.LOAIGIA_ID = C.LOAIGIA_ID          where A.DOITUONG_ID = '4'          and C.CAPTREN_ID = (select LOAIGIA_ID from TM_LOAIGIA where MALOAIGIA = 'Giathuoc' and BENHVIEN_ID = 'HLU01')]
2020-02-26 15:54:36,233 [1] DEBUG - Statement Id: [DAO00017_GetLoaiGiaDoiTuongDichVu] PreparedStatement : [select a.LOAIGIA_ID, a.TENLOAIGIA, a.MALOAIGIA, a.CAPTREN_ID, MIN(a.UUTIEN_NGUON) AS UUTIEN_NGUON          , MAX(a.DOUUTIEN) AS DOUUTIEN, MIN(ISNULL(a.GIAHOTRO,0)) AS GIAHOTRO          from(                        select distinct A.LOAIGIA_ID, C.TENLOAIGIA, C.MALOAIGIA, 0 as UUTIEN_NGUON, isnull(B.DOUUTIEN,0) as DOUUTIEN, B.GIAHOTRO, C.CAPTREN_ID            from TM_DOITUONG_GIADICHVU A            left join TM_DOITUONG_LOAIGIA B on A.LOAIGIA_ID = B.LOAIGIA_ID and A.DOITUONG_ID = B.DOITUONG_ID and B.BENHVIEN_ID = 'HLU01'            inner join TM_LOAIGIA C on A.LOAIGIA_ID = C.LOAIGIA_ID and C.BENHVIEN_ID = 'HLU01'            where A.DOITUONG_ID = '4'                            and C.CAPTREN_ID = (select LOAIGIA_ID from TM_LOAIGIA              where MALOAIGIA = 'GiaDichVu'              and BENHVIEN_ID = 'HLU01')                         and A.BENHVIEN_ID = 'HLU01'                     ) a          where a.DOUUTIEN != 0 and a.DOUUTIEN is not null          group by a.LOAIGIA_ID, a.TENLOAIGIA, a.MALOAIGIA, a.CAPTREN_ID          order by MAX(a.UUTIEN_NGUON) desc ,MAX(a.DOUUTIEN) asc]
2020-02-26 15:54:36,418 [1] DEBUG - Statement Id: [DAO00017_GetLoaiGiaDuocByDoiTuongId] PreparedStatement : [select A.LOAIGIA_ID, C.TENLOAIGIA from TM_DOITUONG_LOAIGIA A          inner join TM_LOAIGIA C on A.LOAIGIA_ID = C.LOAIGIA_ID          where A.DOITUONG_ID = '4'          and C.CAPTREN_ID = (select LOAIGIA_ID from TM_LOAIGIA where MALOAIGIA = 'Giathuoc' and BENHVIEN_ID = 'HLU01')]
2020-02-26 15:55:19,077 [1] DEBUG - Statement Id: [DAO00040_LayListToaMau] PreparedStatement : [select A.*, dc.TENDUOCDAYDU, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ld.MALOAIDUOC, dd.DICTIONARY_NAME DUONGDUNG, dc.TAMNGUNG            from TT_TOATHUOCMAU A            left join TM_DUOC dc on A.DUOC_ID = dc.DUOC_ID            left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID            left join (select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE like 'DuongDung') dd on dd.DICTIONARY_ID = dc.DUONGDUNG_ID            where (1=1)]
2020-02-26 15:55:21,266 [1] DEBUG - Statement Id: [DAO00063_GetListKhoThuocPhongBanPhamvi] PreparedStatement : [select distinct dpv.*        from TM_DUOC_PHAMVISD_MAPPING dmap        left join TM_DUOC_PHAMVISUDUNG dpv on dpv.PHAMVI_ID = dmap.PHAMVI_ID        where dmap.KHODUOC_ID in (select KHODUOC_ID from TM_PHONGBAN_KHODUOC where PHONGBAN_ID = '25')]
2020-02-26 15:55:21,292 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1027']
2020-02-26 15:55:21,317 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1030']
2020-02-26 15:55:21,341 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1032']
2020-02-26 15:55:21,366 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1057']
2020-02-26 15:55:21,550 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1027']
2020-02-26 15:55:21,580 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1030']
2020-02-26 15:55:21,697 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1032']
2020-02-26 15:55:21,723 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1057']
2020-02-26 15:55:21,748 [1] DEBUG - Statement Id: [DAO00063_GetListPhamviTuKhoThuocVaPhongBan] PreparedStatement : [select distinct dpv.*, dmap.KHODUOC_ID        from TM_DUOC_PHAMVISD_MAPPING dmap        left join TM_DUOC_PHAMVISUDUNG dpv on dpv.PHAMVI_ID = dmap.PHAMVI_ID and dpv.TAMNGUNG != '1'        where dmap.KHODUOC_ID in (select KHODUOC_ID from TM_PHONGBAN_KHODUOC where PHONGBAN_ID = '25')        and dmap.KHODUOC_ID = '29' and dpv.MAPHAMVI is not null]
2020-02-26 15:55:21,801 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 999999999 as SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        where  @param0  = 0        union all        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end        else        begin        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO        group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end]
2020-02-26 15:55:21,802 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Parameters: [@param0=[PHAMVI_ID,1027]]
2020-02-26 15:55:21,802 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Types: [@param0=[Int64, System.Int64]]
2020-02-26 15:55:22,049 [1] DEBUG - Statement Id: [DAO00061_GetLuuTruIDByBenhAnID] PreparedStatement : [select lt.LUUTRU_ID, ba.BACSIDIEUTRI_ID as BACSIDIEUTRICHINH_ID        from TT_NOITRU_LUUTRU lt        left join TT_NOITRU_BENHAN ba on lt.BENHAN_ID = ba.BENHAN_ID        where lt.BENHAN_ID = '24642']
2020-02-26 15:55:22,109 [1] DEBUG - Statement Id: [DAO00061_GetChanDoanBenhAnID] PreparedStatement : [DECLARE @ICDPHU NVARCHAR(2000)=''        DECLARE @LISTICDPHU NVARCHAR(200)        DECLARE @CHANDOANRAVIEN NVARCHAR(500)        DECLARE @LISTICDPHUVAOKHOA NVARCHAR(50)        DECLARE @ICDPHUVAOKHOA NVARCHAR(500)=''        DECLARE @ICDKHAMBENH NVARCHAR(500) = (SELECT ICD.TENICD + '('+ISNULL(ICD.MAICD,'')+')'        FROM TT_NOITRU_BENHAN BA INNER JOIN TM_ICD ICD        ON BA.ICD_KHAMBENH = ICD.ICD_ID WHERE BA.BENHAN_ID =  @param0 )        DECLARE @ICDCHINH NVARCHAR(500) = (SELECT ICD.TENICD + '('+ISNULL(ICD.MAICD,'')+')'        FROM TT_NOITRU_BENHAN BA INNER JOIN TM_ICD ICD        ON BA.ICD_BENHCHINH = ICD.ICD_ID WHERE BA.BENHAN_ID =  @param0 )        SELECT @CHANDOANRAVIEN = BA.CHANDOANRAVIEN, @LISTICDPHU = BA.ICD_BENHPHU, @LISTICDPHUVAOKHOA = BA.ICD_PHU_VAOKHOA        FROM TT_NOITRU_BENHAN BA WHERE BA.BENHAN_ID =  @param0         SELECT @ICDPHU = @ICDPHU + ISNULL(TENICD, '') +'(' +ISNULL(MAICD,'')+ '); ' FROM TM_ICD WHERE MAICD IN (SELECT S FROM SplitString(@LISTICDPHU,';'))        SELECT @ICDPHUVAOKHOA = @ICDPHUVAOKHOA + ISNULL(TENICD, '') +'(' +ISNULL(MAICD,'')+ '); ' FROM TM_ICD WHERE MAICD IN (SELECT S FROM SplitString(@LISTICDPHUVAOKHOA,';'))        SELECT ICD_KHAMBENH, CHANDOANKHAMBENH, CHANDOANVAOKHOA, CHANDOANRAVIEN, CHANDOANKHAC                , CASE        WHEN LEN(ISNULL(BA.CDRAVIEN_PHU,'')) > 0 AND LEN(ISNULL(BA.CDRAVIEN_CHINH,'')) > 0 THEN ISNULL(BA.CDRAVIEN_CHINH,'') + '; ' + ISNULL(BA.CDRAVIEN_PHU,'')        WHEN LEN(ISNULL(BA.CDRAVIEN_PHU,'')) > 0 AND LEN(ISNULL(BA.CDRAVIEN_CHINH,'')) <= 0  THEN BA.CDRAVIEN_PHU        WHEN LEN(ISNULL(BA.CDRAVIEN_PHU,'')) <= 0 AND LEN(ISNULL(BA.CDRAVIEN_CHINH,'')) > 0 THEN BA.CDRAVIEN_CHINH        ELSE NULL END AS CHANDOANNOITRU        ,CASE WHEN @ICDKHAMBENH IS NULL AND (@CHANDOANRAVIEN IS NULL OR @CHANDOANRAVIEN = '') THEN ''        ELSE ISNULL(@ICDKHAMBENH, '') + '; ' + ISNULL(@CHANDOANRAVIEN, '') END        AS CHANDOANCAPCUU        , @ICDPHUVAOKHOA AS CHANDOANPHUVAOKHOA        FROM TT_NOITRU_BENHAN BA LEFT JOIN TM_ICD ICD ON BA.ICD_KHAMBENH = ICD.ICD_ID        WHERE BENHAN_ID =  @param0]
2020-02-26 15:55:22,109 [1] DEBUG - Statement Id: [DAO00061_GetChanDoanBenhAnID] Parameters: [@param0=[BENHAN_ID,24642]]
2020-02-26 15:55:22,109 [1] DEBUG - Statement Id: [DAO00061_GetChanDoanBenhAnID] Types: [@param0=[Int64, System.Int64]]
2020-02-26 15:55:32,980 [1] DEBUG - Statement Id: [DAO00030_Get_DuocCanhBaoICD_ByBenhAn_ID] PreparedStatement : [select A.*          from TM_DUOC_CANHBAO_ICD A          inner join TM_DUOC_HOATCHAT B on B.HOATCHAT_ID = A.HOATCHAT_ID          inner join TM_DUOC_THANHPHANHOATCHAT C on C.HOATCHAT_ID = B.HOATCHAT_ID          inner join TM_DUOC D on D.DUOC_ID = C.DUOC_ID          inner join TT_NOITRU_BENHAN BA on (BA.ICD_VAOKHOA = A.ICD_ID or BA.ICD_KHAMBENH = A.ICD_ID or BA.ICD_BENHCHINH = A.ICD_ID or BA.ICDRAVIEN_CHINH = A.ICD_ID          or A.MAICD in (select part from fnSplit(BA.ICD_BENHPHU, ';'))           or A.MAICD in (select part from fnSplit(BA.ICDRAVIEN_PHU, ';'))          or A.MAICD in (select part from fnSplit(BA.ICD_PHU_VAOKHOA, ';'))) and BA.BENHAN_ID = 24642          where C.DUOC_ID = 1030          and A.TAMNGUNG = '0'          and A.BENHVIEN_ID = 'HLU01']
2020-02-26 15:55:33,057 [1] DEBUG - Statement Id: [DAO00013_GetTienSuBenh] PreparedStatement : [select TIENSUBENH, TIENSUDIUNG        from TT_BENHNHAN        where TT_BENHNHAN.BENHNHAN_ID  = '20633']
2020-02-26 15:55:33,081 [1] DEBUG - Statement Id: [DAO00095_GetTTDiUngThuoc] PreparedStatement : [select *              from TT_BENHNHAN_DIUNG_THUOC              where BENHNHAN_ID = '20633'              and BENHVIEN_ID = 'HLU01']
2020-02-26 15:55:33,107 [1] DEBUG - Statement Id: [DAO00096_GetList] PreparedStatement : [select *        from TM_DUOC_THANHPHANHOATCHAT        where BENHVIEN_ID = 'HLU01']
2020-02-26 15:55:33,145 [1] DEBUG - Statement Id: [DAO00013_GetTienSuBenh] PreparedStatement : [select TIENSUBENH, TIENSUDIUNG        from TT_BENHNHAN        where TT_BENHNHAN.BENHNHAN_ID  = '20633']
2020-02-26 15:55:33,170 [1] DEBUG - Statement Id: [DAO00095_GetTTDiUngThuoc] PreparedStatement : [select *              from TT_BENHNHAN_DIUNG_THUOC              where BENHNHAN_ID = '20633'              and BENHVIEN_ID = 'HLU01']
2020-02-26 15:55:33,194 [1] DEBUG - Statement Id: [DAO00016_GetTTDuocCanhBao] PreparedStatement : [select *        from TM_DUOC_CANHBAO         where                 DUOC_ID = '1030'             and               BENHVIEN_ID = 'HLU01'                     order by DUOC_CANHBAO_ID]
2020-02-26 15:55:36,672 [1] DEBUG - Statement Id: [DAO00000_GetCHECK_DOITUONG_BHYT] PreparedStatement : [select count(*) as DOITUONG_BHYT FROM TM_DOITUONG A            WHERE A.DOITUONG_ID = '4' and A.BENHVIEN_ID = 'HLU01' and MADOITUONG like '%BHYT%']
2020-02-26 15:55:36,697 [1] DEBUG - Statement Id: [DAO00000_GetLOAIGIATHUOC_NOI_NGOAI_VIEN] PreparedStatement : [SELECT LOAIGIA_ID              FROM TM_LOAIGIA              WHERE MALOAIGIA = 'GiaThuoc_NoiVien' and BENHVIEN_ID = 'HLU01']
2020-02-26 15:55:38,390 [1] DEBUG - Statement Id: [DAO00000_GetDUOC_DONGIADOANHTHU_NOIVIEN] PreparedStatement : [declare @doanhthuKhongHT numeric(24,2);          declare @doanhthu numeric(24,2);          declare @hotro numeric(24,2);          declare @bhyt char(1);          declare @loaigia_id int, @loaigiakhonght_id int            select top 1 @doanhthuKhongHT = dg.DONGIA, @loaigiakhonght_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0 and GIAHOTRO != '1'          order by dtlg.DOUUTIEN asc          select top 1 @doanhthu = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0           order by dtlg.DOUUTIEN asc          select top 1 @hotro = dg.DONGIA, @loaigia_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0  and GIAHOTRO = '1'          order by dtlg.DOUUTIEN asc          select top 1 @bhyt = BHYT from TM_DUOC where DUOC_ID = 1030          select ISNULL(@doanhthu,0.0) DONGIA_DOANHTHU, ISNULL(@hotro, 0.0) DONGIA_KHAC, ISNULL(@doanhthuKhongHT, 0.0) DONGIA_KHONGHT, isnull(@bhyt, '0') BHYT, ISNULL(@loaigia_id, 0) as LOAIGIA_ID, ISNULL(@loaigiakhonght_id, 0) as LOAIGIAKHONGHT_ID]
2020-02-26 15:55:39,601 [1] DEBUG - Statement Id: [DAO00000_GetDuocBHYT] PreparedStatement : [select count(*) BHYT FROM TM_DUOC A WHERE A.DUOC_ID = '1030' and BHYT = '1']
2020-02-26 15:55:47,352 [1] DEBUG - Statement Id: [DAO00000_GetCHECK_DOITUONG_BHYT] PreparedStatement : [select count(*) as DOITUONG_BHYT FROM TM_DOITUONG A            WHERE A.DOITUONG_ID = '4' and A.BENHVIEN_ID = 'HLU01' and MADOITUONG like '%BHYT%']
2020-02-26 15:55:47,451 [1] DEBUG - Statement Id: [DAO00000_GetLOAIGIATHUOC_NOI_NGOAI_VIEN] PreparedStatement : [SELECT LOAIGIA_ID              FROM TM_LOAIGIA              WHERE MALOAIGIA = 'GiaThuoc_NoiVien' and BENHVIEN_ID = 'HLU01']
2020-02-26 15:55:49,822 [1] DEBUG - Statement Id: [DAO00000_GetDUOC_DONGIADOANHTHU_NOIVIEN] PreparedStatement : [declare @doanhthuKhongHT numeric(24,2);          declare @doanhthu numeric(24,2);          declare @hotro numeric(24,2);          declare @bhyt char(1);          declare @loaigia_id int, @loaigiakhonght_id int            select top 1 @doanhthuKhongHT = dg.DONGIA, @loaigiakhonght_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0 and GIAHOTRO != '1'          order by dtlg.DOUUTIEN asc          select top 1 @doanhthu = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0           order by dtlg.DOUUTIEN asc          select top 1 @hotro = dg.DONGIA, @loaigia_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0  and GIAHOTRO = '1'          order by dtlg.DOUUTIEN asc          select top 1 @bhyt = BHYT from TM_DUOC where DUOC_ID = 1030          select ISNULL(@doanhthu,0.0) DONGIA_DOANHTHU, ISNULL(@hotro, 0.0) DONGIA_KHAC, ISNULL(@doanhthuKhongHT, 0.0) DONGIA_KHONGHT, isnull(@bhyt, '0') BHYT, ISNULL(@loaigia_id, 0) as LOAIGIA_ID, ISNULL(@loaigiakhonght_id, 0) as LOAIGIAKHONGHT_ID]
2020-02-26 15:55:53,387 [1] DEBUG - Statement Id: [DAO00000_GetDuocBHYT] PreparedStatement : [select count(*) BHYT FROM TM_DUOC A WHERE A.DUOC_ID = '1030' and BHYT = '1']
2020-02-26 15:56:04,892 [1] DEBUG - Statement Id: [DAO00030_Get_DuocCanhBaoICD_ByBenhAn_ID] PreparedStatement : [select A.*          from TM_DUOC_CANHBAO_ICD A          inner join TM_DUOC_HOATCHAT B on B.HOATCHAT_ID = A.HOATCHAT_ID          inner join TM_DUOC_THANHPHANHOATCHAT C on C.HOATCHAT_ID = B.HOATCHAT_ID          inner join TM_DUOC D on D.DUOC_ID = C.DUOC_ID          inner join TT_NOITRU_BENHAN BA on (BA.ICD_VAOKHOA = A.ICD_ID or BA.ICD_KHAMBENH = A.ICD_ID or BA.ICD_BENHCHINH = A.ICD_ID or BA.ICDRAVIEN_CHINH = A.ICD_ID          or A.MAICD in (select part from fnSplit(BA.ICD_BENHPHU, ';'))           or A.MAICD in (select part from fnSplit(BA.ICDRAVIEN_PHU, ';'))          or A.MAICD in (select part from fnSplit(BA.ICD_PHU_VAOKHOA, ';'))) and BA.BENHAN_ID = 24642          where C.DUOC_ID = 1030          and A.TAMNGUNG = '0'          and A.BENHVIEN_ID = 'HLU01']
2020-02-26 15:56:04,920 [1] DEBUG - Statement Id: [DAO00013_GetTienSuBenh] PreparedStatement : [select TIENSUBENH, TIENSUDIUNG        from TT_BENHNHAN        where TT_BENHNHAN.BENHNHAN_ID  = '20633']
2020-02-26 15:56:04,944 [1] DEBUG - Statement Id: [DAO00095_GetTTDiUngThuoc] PreparedStatement : [select *              from TT_BENHNHAN_DIUNG_THUOC              where BENHNHAN_ID = '20633'              and BENHVIEN_ID = 'HLU01']
2020-02-26 15:56:04,968 [1] DEBUG - Statement Id: [DAO00096_GetList] PreparedStatement : [select *        from TM_DUOC_THANHPHANHOATCHAT        where BENHVIEN_ID = 'HLU01']
2020-02-26 15:56:04,998 [1] DEBUG - Statement Id: [DAO00013_GetTienSuBenh] PreparedStatement : [select TIENSUBENH, TIENSUDIUNG        from TT_BENHNHAN        where TT_BENHNHAN.BENHNHAN_ID  = '20633']
2020-02-26 15:56:05,022 [1] DEBUG - Statement Id: [DAO00095_GetTTDiUngThuoc] PreparedStatement : [select *              from TT_BENHNHAN_DIUNG_THUOC              where BENHNHAN_ID = '20633'              and BENHVIEN_ID = 'HLU01']
2020-02-26 15:56:05,045 [1] DEBUG - Statement Id: [DAO00016_GetTTDuocCanhBao] PreparedStatement : [select *        from TM_DUOC_CANHBAO         where                 DUOC_ID = '1030'             and               BENHVIEN_ID = 'HLU01'                     order by DUOC_CANHBAO_ID]
2020-02-26 15:56:05,070 [1] DEBUG - Statement Id: [DAO00000_GetCHECK_DOITUONG_BHYT] PreparedStatement : [select count(*) as DOITUONG_BHYT FROM TM_DOITUONG A            WHERE A.DOITUONG_ID = '4' and A.BENHVIEN_ID = 'HLU01' and MADOITUONG like '%BHYT%']
2020-02-26 15:56:05,252 [1] DEBUG - Statement Id: [DAO00000_GetLOAIGIATHUOC_NOI_NGOAI_VIEN] PreparedStatement : [SELECT LOAIGIA_ID              FROM TM_LOAIGIA              WHERE MALOAIGIA = 'GiaThuoc_NoiVien' and BENHVIEN_ID = 'HLU01']
2020-02-26 15:56:06,413 [1] DEBUG - Statement Id: [DAO00000_GetDUOC_DONGIADOANHTHU_NOIVIEN] PreparedStatement : [declare @doanhthuKhongHT numeric(24,2);          declare @doanhthu numeric(24,2);          declare @hotro numeric(24,2);          declare @bhyt char(1);          declare @loaigia_id int, @loaigiakhonght_id int            select top 1 @doanhthuKhongHT = dg.DONGIA, @loaigiakhonght_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0 and GIAHOTRO != '1'          order by dtlg.DOUUTIEN asc          select top 1 @doanhthu = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0           order by dtlg.DOUUTIEN asc          select top 1 @hotro = dg.DONGIA, @loaigia_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0  and GIAHOTRO = '1'          order by dtlg.DOUUTIEN asc          select top 1 @bhyt = BHYT from TM_DUOC where DUOC_ID = 1030          select ISNULL(@doanhthu,0.0) DONGIA_DOANHTHU, ISNULL(@hotro, 0.0) DONGIA_KHAC, ISNULL(@doanhthuKhongHT, 0.0) DONGIA_KHONGHT, isnull(@bhyt, '0') BHYT, ISNULL(@loaigia_id, 0) as LOAIGIA_ID, ISNULL(@loaigiakhonght_id, 0) as LOAIGIAKHONGHT_ID]
2020-02-26 15:56:07,329 [1] DEBUG - Statement Id: [DAO00000_GetDuocBHYT] PreparedStatement : [select count(*) BHYT FROM TM_DUOC A WHERE A.DUOC_ID = '1030' and BHYT = '1']
2020-02-26 15:56:08,407 [1] DEBUG - Statement Id: [DAO00000_GetCHECK_DOITUONG_BHYT] PreparedStatement : [select count(*) as DOITUONG_BHYT FROM TM_DOITUONG A            WHERE A.DOITUONG_ID = '4' and A.BENHVIEN_ID = 'HLU01' and MADOITUONG like '%BHYT%']
2020-02-26 15:56:08,433 [1] DEBUG - Statement Id: [DAO00000_GetLOAIGIATHUOC_NOI_NGOAI_VIEN] PreparedStatement : [SELECT LOAIGIA_ID              FROM TM_LOAIGIA              WHERE MALOAIGIA = 'GiaThuoc_NoiVien' and BENHVIEN_ID = 'HLU01']
2020-02-26 15:56:09,432 [1] DEBUG - Statement Id: [DAO00000_GetDUOC_DONGIADOANHTHU_NOIVIEN] PreparedStatement : [declare @doanhthuKhongHT numeric(24,2);          declare @doanhthu numeric(24,2);          declare @hotro numeric(24,2);          declare @bhyt char(1);          declare @loaigia_id int, @loaigiakhonght_id int            select top 1 @doanhthuKhongHT = dg.DONGIA, @loaigiakhonght_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0 and GIAHOTRO != '1'          order by dtlg.DOUUTIEN asc          select top 1 @doanhthu = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0           order by dtlg.DOUUTIEN asc          select top 1 @hotro = dg.DONGIA, @loaigia_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0  and GIAHOTRO = '1'          order by dtlg.DOUUTIEN asc          select top 1 @bhyt = BHYT from TM_DUOC where DUOC_ID = 1030          select ISNULL(@doanhthu,0.0) DONGIA_DOANHTHU, ISNULL(@hotro, 0.0) DONGIA_KHAC, ISNULL(@doanhthuKhongHT, 0.0) DONGIA_KHONGHT, isnull(@bhyt, '0') BHYT, ISNULL(@loaigia_id, 0) as LOAIGIA_ID, ISNULL(@loaigiakhonght_id, 0) as LOAIGIAKHONGHT_ID]
2020-02-26 15:56:10,653 [1] DEBUG - Statement Id: [DAO00000_GetDuocBHYT] PreparedStatement : [select count(*) BHYT FROM TM_DUOC A WHERE A.DUOC_ID = '1030' and BHYT = '1']
--------------------------------------------------------------------------------
2020-02-26 16:04:37,975 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2020-02-26 16:04:38,367 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2020-02-26 16:04:38,401 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2020-02-26 16:04:38,965 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 16:04:39,221 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
--------------------------------------------------------------------------------
2020-02-26 16:06:02,249 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2020-02-26 16:06:02,627 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2020-02-26 16:06:02,669 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2020-02-26 16:06:03,170 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 16:06:03,470 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2020-02-26 16:06:09,536 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2020-02-26 16:06:09,585 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2020-02-26 16:06:11,283 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2020-02-26 16:06:11,390 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2020-02-26 16:06:12,236 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2020-02-26 16:06:12,430 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2020-02-26 16:06:12,510 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2020-02-26 16:06:12,581 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2020-02-26 16:06:12,650 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2020-02-26 16:06:12,718 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2020-02-26 16:06:12,785 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2020-02-26 16:06:12,863 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2020-02-26 16:06:12,997 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2020-02-26 16:06:13,531 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2020-02-26 16:06:13,563 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2020-02-26 16:06:13,642 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2020-02-26 16:06:13,790 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2020-02-26 16:06:14,370 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2020-02-26 16:06:14,398 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @NGUONDUOC_MACDINH varchar(5) = '0';        declare @TOAMUANGOAI int = 0;        select @NGUONDUOC_MACDINH = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'PHA_NGUONDUOC'        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + @NGUONDUOC_MACDINH as DUOC_KEY, 0 as PHAMVI_ID, @NGUONDUOC_MACDINH as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end        else        begin                select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (        select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID)        B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (        select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID)        A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2020-02-26 16:06:16,233 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2020-02-26 16:06:16,296 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,        SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH        FROM TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID        WHERE TK.SOLUONG > 0        GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2020-02-26 16:06:16,488 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2020-02-26 16:06:16,589 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,        TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,        TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH        from TM_MAU M        JOIN        (        select        A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO        from        (        select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO        from TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'        where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0        ) A        )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2020-02-26 16:06:16,713 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2020-02-26 16:06:17,647 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 16:06:18,422 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2020-02-26 16:06:23,526 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2020-02-26 16:06:23,706 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2020-02-26 16:06:23,795 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 16:06:23,917 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 16:06:24,083 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2020-02-26 16:06:24,085 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2020-02-26 16:06:24,085 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2020-02-26 16:06:24,118 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2020-02-26 16:06:24,118 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2020-02-26 16:06:24,118 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2020-02-26 16:06:24,263 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 16:06:24,417 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 16:06:36,313 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 16:06:36,416 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2020-02-26 16:06:38,178 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2020-02-26 16:07:23,452 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'IPD02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 16:07:23,902 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'IPD40'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 16:07:24,445 [1] DEBUG - Statement Id: [DAO00069_GetCountDanhSachNoiTru] PreparedStatement : [select count(A.SOBENHAN) as TOTALROWS        from TT_NOITRU_BENHAN A        inner join TT_TIEPNHAN B on B.TIEPNHAN_ID = A.TIEPNHAN_ID and (B.TRANGTHAI = 'NOITRU' or B.TRANGTHAI = 'HOANTHANH')        inner join TT_BENHNHAN C on C.BENHNHAN_ID = B.BENHNHAN_ID        left join TT_NOITRU_LUUTRU D on D.BENHAN_ID = A.BENHAN_ID        and D.LUUTRU_ID = ( select top 1 LUUTRU_ID from TT_NOITRU_LUUTRU where BENHAN_ID = A.BENHAN_ID order by BENHAN_ID desc)        left join TT_NOITRU_XACNHAN E on E.BENHAN_ID = A.BENHAN_ID        left join TT_NOITRU_LUUTRUCHITIET F on D.LUUTRU_ID = F.LUUTRU_ID and F.LUUTRUCHITIET_CURRENT = '1'        and F.LUUTRUCHITIET_ID in (select top 1 LUUTRUCHITIET_ID from TT_NOITRU_LUUTRUCHITIET where LUUTRU_ID = D.LUUTRU_ID order by LUUTRUCHITIET_ID desc)        where        A.KHOACHUYENDEN_ID is not null  and        (E.TRANGTHAI = 'DAXACNHAN' OR E.TRANGTHAI = 'HUYXACNHAN')         and           cast(A.NGAYVAOKHOA as date) <= cast('2/26/2020 12:00:00 AM' as date)                 and B.BENHVIEN_ID = 'HLU01' and A.KHOACHUYENDEN_ID = '25'          AND             A.TRANGTHAI in ('DANGDIEUTRI')]
2020-02-26 16:07:24,563 [1] DEBUG - Statement Id: [DAO00069_GetDanhSachNoiTru] PreparedStatement : [select * from        (        SELECT ROW_NUMBER() OVER(order by B.SOTIEPNHAN) as ROWNUMBER,          A.SOBENHAN, A.BENHAN_ID, A.SOLUUTRU                 , E.NOILAP_ID as KHOAVAO_ID        , A.TRANGTHAI, IsNull(A.BACSIDIEUTRI_ID, E.BACSICHIDINH_ID) as BACSIDIEUTRI_ID,        B.TIEPNHAN_ID, B.SOTIEPNHAN, B.SOBHYT as SOTHE, B.DOITUONG_ID, A.NGAYVAOKHOA as NGAYCAPCUU, A.THOIGIANVAOKHOA as THOIGIANCAPCUU,        C.TENBENHNHAN, C.NGAYSINH, C.NAMSINH, C.BENHNHAN_ID, C.MAYTE, F.GIUONGBENH_ID, A.THOIGIANRAVIEN    , DIACHITHUONGTRU, DANTOC_ID        ,BENHVIEN_STT_ID                from TT_NOITRU_BENHAN A        inner join TT_TIEPNHAN B on B.TIEPNHAN_ID = A.TIEPNHAN_ID and (B.TRANGTHAI = 'NOITRU' or B.TRANGTHAI = 'HOANTHANH')        inner join TT_BENHNHAN C on C.BENHNHAN_ID = B.BENHNHAN_ID        left join TT_NOITRU_LUUTRU D on D.BENHAN_ID = A.BENHAN_ID        and D.LUUTRU_ID = ( select top 1 LUUTRU_ID from TT_NOITRU_LUUTRU where BENHAN_ID = A.BENHAN_ID order by LUUTRU_ID desc)        left join TT_NOITRU_XACNHAN E on E.BENHAN_ID = A.BENHAN_ID        left join TT_NOITRU_LUUTRUCHITIET F on D.LUUTRU_ID = F.LUUTRU_ID and F.LUUTRUCHITIET_CURRENT = '1'        and F.LUUTRUCHITIET_ID in (select top 1 LUUTRUCHITIET_ID from TT_NOITRU_LUUTRUCHITIET where LUUTRU_ID = D.LUUTRU_ID order by LUUTRUCHITIET_ID desc)        left join (select MABENHVIEN, BENHVIEN_STT_ID from TM_BENHVIEN) H on SUBSTRING(B.SOBHYT, 16, 5)=H.MABENHVIEN        where        A.KHOACHUYENDEN_ID is not null  and        (E.TRANGTHAI = 'DAXACNHAN' OR E.TRANGTHAI = 'HUYXACNHAN')         and           cast(A.NGAYVAOKHOA as date) <= cast('2/26/2020 12:00:00 AM' as date)                 and B.BENHVIEN_ID = 'HLU01' and A.KHOACHUYENDEN_ID = '25'          AND             A.TRANGTHAI in ('DANGDIEUTRI')                   ) lst        where        lst.ROWNUMBER between 1 and 20        order by lst.SOTIEPNHAN]
2020-02-26 16:07:26,149 [1] DEBUG - Statement Id: [DAO00069_GetCountDanhSachNoiTru] PreparedStatement : [select count(A.SOBENHAN) as TOTALROWS        from TT_NOITRU_BENHAN A        inner join TT_TIEPNHAN B on B.TIEPNHAN_ID = A.TIEPNHAN_ID and (B.TRANGTHAI = 'NOITRU' or B.TRANGTHAI = 'HOANTHANH')        inner join TT_BENHNHAN C on C.BENHNHAN_ID = B.BENHNHAN_ID        left join TT_NOITRU_LUUTRU D on D.BENHAN_ID = A.BENHAN_ID        and D.LUUTRU_ID = ( select top 1 LUUTRU_ID from TT_NOITRU_LUUTRU where BENHAN_ID = A.BENHAN_ID order by BENHAN_ID desc)        left join TT_NOITRU_XACNHAN E on E.BENHAN_ID = A.BENHAN_ID        left join TT_NOITRU_LUUTRUCHITIET F on D.LUUTRU_ID = F.LUUTRU_ID and F.LUUTRUCHITIET_CURRENT = '1'        and F.LUUTRUCHITIET_ID in (select top 1 LUUTRUCHITIET_ID from TT_NOITRU_LUUTRUCHITIET where LUUTRU_ID = D.LUUTRU_ID order by LUUTRUCHITIET_ID desc)        where        A.KHOACHUYENDEN_ID is not null  and        (E.TRANGTHAI = 'DAXACNHAN' OR E.TRANGTHAI = 'HUYXACNHAN')         and           cast(A.NGAYVAOKHOA as date) <= cast('2/26/2020 12:00:00 AM' as date)                 and B.BENHVIEN_ID = 'HLU01' and A.KHOACHUYENDEN_ID = '25'          AND             A.TRANGTHAI in ('DANGDIEUTRI')]
2020-02-26 16:07:26,256 [1] DEBUG - Statement Id: [DAO00069_GetDanhSachNoiTru] PreparedStatement : [select * from        (        SELECT ROW_NUMBER() OVER(order by B.SOTIEPNHAN) as ROWNUMBER,          A.SOBENHAN, A.BENHAN_ID, A.SOLUUTRU                 , E.NOILAP_ID as KHOAVAO_ID        , A.TRANGTHAI, IsNull(A.BACSIDIEUTRI_ID, E.BACSICHIDINH_ID) as BACSIDIEUTRI_ID,        B.TIEPNHAN_ID, B.SOTIEPNHAN, B.SOBHYT as SOTHE, B.DOITUONG_ID, A.NGAYVAOKHOA as NGAYCAPCUU, A.THOIGIANVAOKHOA as THOIGIANCAPCUU,        C.TENBENHNHAN, C.NGAYSINH, C.NAMSINH, C.BENHNHAN_ID, C.MAYTE, F.GIUONGBENH_ID, A.THOIGIANRAVIEN    , DIACHITHUONGTRU, DANTOC_ID        ,BENHVIEN_STT_ID                from TT_NOITRU_BENHAN A        inner join TT_TIEPNHAN B on B.TIEPNHAN_ID = A.TIEPNHAN_ID and (B.TRANGTHAI = 'NOITRU' or B.TRANGTHAI = 'HOANTHANH')        inner join TT_BENHNHAN C on C.BENHNHAN_ID = B.BENHNHAN_ID        left join TT_NOITRU_LUUTRU D on D.BENHAN_ID = A.BENHAN_ID        and D.LUUTRU_ID = ( select top 1 LUUTRU_ID from TT_NOITRU_LUUTRU where BENHAN_ID = A.BENHAN_ID order by LUUTRU_ID desc)        left join TT_NOITRU_XACNHAN E on E.BENHAN_ID = A.BENHAN_ID        left join TT_NOITRU_LUUTRUCHITIET F on D.LUUTRU_ID = F.LUUTRU_ID and F.LUUTRUCHITIET_CURRENT = '1'        and F.LUUTRUCHITIET_ID in (select top 1 LUUTRUCHITIET_ID from TT_NOITRU_LUUTRUCHITIET where LUUTRU_ID = D.LUUTRU_ID order by LUUTRUCHITIET_ID desc)        left join (select MABENHVIEN, BENHVIEN_STT_ID from TM_BENHVIEN) H on SUBSTRING(B.SOBHYT, 16, 5)=H.MABENHVIEN        where        A.KHOACHUYENDEN_ID is not null  and        (E.TRANGTHAI = 'DAXACNHAN' OR E.TRANGTHAI = 'HUYXACNHAN')         and           cast(A.NGAYVAOKHOA as date) <= cast('2/26/2020 12:00:00 AM' as date)                 and B.BENHVIEN_ID = 'HLU01' and A.KHOACHUYENDEN_ID = '25'          AND             A.TRANGTHAI in ('DANGDIEUTRI')                   ) lst        where        lst.ROWNUMBER between 1 and 20        order by lst.SOTIEPNHAN]
2020-02-26 16:08:44,434 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM31'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 16:08:44,591 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'IPD03'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 16:08:45,985 [1] DEBUG - Statement Id: [DAO00080_KiemtraBenhAnDaThanhToan] PreparedStatement : [select DAXACNHANDOANHTHU        from TT_NOITRU_BENHAN where        BENHAN_ID = '24642'        and BENHVIEN_ID = 'HLU01'        Order By BENHAN_ID Desc]
2020-02-26 16:08:46,094 [1] DEBUG - Statement Id: [DAO00061_GetBenhAnDetailByID] PreparedStatement : [select A.*, B.NOIGIOITHIEU_ID, C.KHOADIEUTRI_ID, A.ICD_BENHCHINH AS ICD_BENHCHINH_BAK, A.CDRAVIEN_CHINH AS CHANDOANRAVIEN1, B.THOIGIANTIEPNHAN        , A.CDRAVIEN_CHINH AS CHANDOANRAVIEN_BAK        from TT_NOITRU_BENHAN A        left join TT_TIEPNHAN B on B.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TT_NOITRU_NHAPVIEN C on C.TIEPNHAN_ID = B.TIEPNHAN_ID        where A.BENHAN_ID = '24642']
2020-02-26 16:08:46,155 [1] DEBUG - Statement Id: [DAO00087_GetServiceParams] PreparedStatement : [select CODE, VALUE              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01']
2020-02-26 16:08:46,214 [1] DEBUG - Statement Id: [DAO00080_GetNoiTruLuuTruBenhAn] PreparedStatement : [select *        from TT_NOITRU_LUUTRU where        BENHAN_ID = '24642'        and BENHVIEN_ID = 'HLU01'        Order By LUUTRU_ID ASC]
2020-02-26 16:08:46,257 [1] DEBUG - Statement Id: [DAO00080_GetGiuongBenhCuaBenhAn] PreparedStatement : [select *        from TT_NOITRU_GIUONGBENH where        BENHAN_ID =  @param0]
2020-02-26 16:08:46,257 [1] DEBUG - Statement Id: [DAO00080_GetGiuongBenhCuaBenhAn] Parameters: [@param0=[BENHAN_ID,24642]]
2020-02-26 16:08:46,257 [1] DEBUG - Statement Id: [DAO00080_GetGiuongBenhCuaBenhAn] Types: [@param0=[Int64, System.Int64]]
2020-02-26 16:08:46,333 [1] DEBUG - Statement Id: [DAO00013_GetDetailP] PreparedStatement : [select *        from TT_BENHNHAN         WHERE              TT_BENHNHAN.MAYTE  = '190040528']
2020-02-26 16:08:46,406 [1] DEBUG - Statement Id: [DAO00061_GetBenhAnDetailByID] PreparedStatement : [select A.*, B.NOIGIOITHIEU_ID, C.KHOADIEUTRI_ID, A.ICD_BENHCHINH AS ICD_BENHCHINH_BAK, A.CDRAVIEN_CHINH AS CHANDOANRAVIEN1, B.THOIGIANTIEPNHAN        , A.CDRAVIEN_CHINH AS CHANDOANRAVIEN_BAK        from TT_NOITRU_BENHAN A        left join TT_TIEPNHAN B on B.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TT_NOITRU_NHAPVIEN C on C.TIEPNHAN_ID = B.TIEPNHAN_ID        where A.BENHAN_ID = '24642']
2020-02-26 16:08:46,523 [1] DEBUG - Statement Id: [DAO00080_GetNoiTruBenhAnChiTiet] PreparedStatement : [select *        from TT_NOITRU_BENHAN_CHITIET where        BENHAN_ID = '24642'        and BENHVIEN_ID = 'HLU01'        Order By BENHANCHITIET_ID DESC]
2020-02-26 16:08:46,607 [1] DEBUG - Statement Id: [DAO00080_GetNoiTruLuuTruBenhAn] PreparedStatement : [select *        from TT_NOITRU_LUUTRU where        BENHAN_ID = '24642'        and BENHVIEN_ID = 'HLU01'        Order By LUUTRU_ID ASC]
2020-02-26 16:08:46,642 [1] DEBUG - Statement Id: [DAO00080_GetGiuongBenhCuaBenhAn] PreparedStatement : [select *        from TT_NOITRU_GIUONGBENH where        BENHAN_ID =  @param0]
2020-02-26 16:08:46,643 [1] DEBUG - Statement Id: [DAO00080_GetGiuongBenhCuaBenhAn] Parameters: [@param0=[BENHAN_ID,24642]]
2020-02-26 16:08:46,643 [1] DEBUG - Statement Id: [DAO00080_GetGiuongBenhCuaBenhAn] Types: [@param0=[Int64, System.Int64]]
2020-02-26 16:08:46,780 [1] DEBUG - Statement Id: [DAO00067_laytrangthaibenhannoitru] PreparedStatement : [select isnull(TRANGTHAI, '') TRANGTHAI from TT_NOITRU_BENHAN where BENHAN_ID =  @param0]
2020-02-26 16:08:46,780 [1] DEBUG - Statement Id: [DAO00067_laytrangthaibenhannoitru] Parameters: [@param0=[BENHAN_ID,24642]]
2020-02-26 16:08:46,780 [1] DEBUG - Statement Id: [DAO00067_laytrangthaibenhannoitru] Types: [@param0=[Int64, System.Int64]]
2020-02-26 16:08:46,812 [1] DEBUG - Statement Id: [DAO00067_DeleteVienPhi_Noref] PreparedStatement : [delete from TT_VIENPHI where TIEPNHAN_ID = 107181 and (REF_ID is null or REF_ID = 0)         and           BENHAN_ID = '24642'                 delete TT_DUOC_TONKHO_BOOK_NOITRU where REF_TABLE = 'TT_NOITRU_TOATHUOC' and (REF_ID is null or REF_ID = 0)        delete TT_DUOC_TONKHO_BOOK_NGOAITRU where REF_ID is null or REF_ID = 0]
2020-02-26 16:08:46,836 [1] DEBUG - Statement Id: [DAO00067_UpdateBenhanIdVienPhi] PreparedStatement : [update TT_VIENPHI          set BENHAN_ID =  @param0           from (select TOATHUOC_ID from TT_NOITRU_TOATHUOC where TIEPNHAN_ID =  @param1 ) nttt          where REF_TABLE = 'TT_NOITRU_TOATHUOC' and REF_ID = nttt.TOATHUOC_ID and isnull(BENHAN_ID, 0) = 0          and TIEPNHAN_ID =  @param1             update TT_VIENPHI          set TT_VIENPHI.BENHAN_ID =  @param0           from (select DVYEUCAU_ID, BENHAN_ID from TT_DVYEUCAU where TIEPNHAN_ID =  @param1 ) nttt          where TT_VIENPHI.REF_TABLE = 'TT_DVYEUCAU' and TT_VIENPHI.REF_ID = nttt.DVYEUCAU_ID          and isnull(TT_VIENPHI.BENHAN_ID, 0) = 0 and isnull(nttt.BENHAN_ID, 0) > 0          and TT_VIENPHI.TIEPNHAN_ID =  @param1]
2020-02-26 16:08:46,836 [1] DEBUG - Statement Id: [DAO00067_UpdateBenhanIdVienPhi] Parameters: [@param0=[BENHAN_ID,24642], @param1=[TIEPNHAN_ID,107181]]
2020-02-26 16:08:46,836 [1] DEBUG - Statement Id: [DAO00067_UpdateBenhanIdVienPhi] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64]]
2020-02-26 16:08:46,865 [1] DEBUG - Statement Id: [DAO00064_GetlistTT_TIEPNHAN_SOTHEBHYT] PreparedStatement : [select stbhyt.*, ba.SOBENHAN,        tn.SOTIEPNHAN, tn.LOAITHANHVIEN_ID, tn.THE_ID, tn.THANHVIEN_ID,        tn.SUDUNG_BHTN, tn.BAOLANH_VIENPHI, tn.VIP, tn.NGUOINUOCNGOAI        from TT_TIEPNHAN_SOTHEBHYT stbhyt        left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = stbhyt.TIEPNHAN_ID        left join TT_NOITRU_BENHAN ba on ba.TIEPNHAN_ID = stbhyt.TIEPNHAN_ID        where        stbhyt.TIEPNHAN_ID = '107181' and isnull(stbhyt.KHONGSUDUNG, '0') = '0'         and           ba.BENHAN_ID = '24642']
2020-02-26 16:08:46,913 [1] DEBUG - Statement Id: [DAO00064_GetListVienPhiByTiepNnan] PreparedStatement : [select distinct        B.DOITUONG_ID, B.NGAYMIENDONGCHITRA, B.BENHNHAN_ID as TIEPNHAN_BENHNHAN_ID, B.TRAITUYEN,        B.BHYTTREN3NAM as TREN3NAM, B.BHYTTREN5NAM as TREN5NAM, B.SOTIEPNHAN, B.SOBENHAN,        B.LOAITHANHVIEN_ID, B.SUDUNG_BHTN, B.THE_ID, B.THANHVIEN_ID, B.BAOLANH_VIENPHI, B.VIP, B.NGUOINUOCNGOAI,        C.GIATRIMIENGIAM as GIATRIMIENGIAM, D.GIATRIMIENGIAM as GIATRIMIENGIAM_BHTN, E.GIATRIMIENGIAM as GIATRIMIENGIAM_THANHVIEN,        F.GIATRIMIENGIAM as GIATRIMIENGIAM_CONGTY, DVYC.THE_ID as DVDUNGTHE, DVYC.TRANGTHAI as TRANGTHAIDICHVU, ndv.MANHOMDICHVU,        A.* from TT_VIENPHI A        left join        (select B.*, C.SOBENHAN, C.BENHAN_ID        from TT_TIEPNHAN B        left join TT_NOITRU_BENHAN C on B.TIEPNHAN_ID = C.TIEPNHAN_ID         and           C.BENHAN_ID = '24642'                 where B.TIEPNHAN_ID = '107181') B on B.TIEPNHAN_ID = A.TIEPNHAN_ID        left join (select sum(GIATRIMIENGIAM) as GIATRIMIENGIAM, VIENPHI_ID, REF_TABLE        from TT_MIENGIAM_CHITIET        where REF_TABLE = 'TT_MIENGIAM'        and exists (select MIENGIAM_ID from TT_MIENGIAM where TT_MIENGIAM_CHITIET.MIENGIAM_ID = MIENGIAM_ID and TINHTRANG = 1 and TIEPNHAN_ID = '107181')        group by VIENPHI_ID, REF_TABLE) C on C.REF_TABLE = 'TT_MIENGIAM' and C.VIENPHI_ID = A.VIENPHI_ID        left join (select sum(GIATRIMIENGIAM) as GIATRIMIENGIAM, VIENPHI_ID, REF_TABLE        from TT_MIENGIAM_CHITIET        where REF_TABLE = 'TT_MIENGIAM_BHTN'        and exists (select MIENGIAM_BHTN_ID from TT_MIENGIAM_BHTN where TT_MIENGIAM_CHITIET.MIENGIAM_ID = MIENGIAM_BHTN_ID and  TINHTRANG = 1 and TIEPNHAN_ID = '107181')        group by VIENPHI_ID, REF_TABLE) D on D.REF_TABLE = 'TT_MIENGIAM_BHTN' and D.VIENPHI_ID = A.VIENPHI_ID        left join (select sum(GIATRIMIENGIAM) as GIATRIMIENGIAM, VIENPHI_ID, REF_TABLE        from TT_MIENGIAM_CHITIET        where REF_TABLE = 'TT_MIENGIAM_THANHVIEN'        and exists (select MIENGIAM_THANHVIEN_ID from TT_MIENGIAM_THANHVIEN where TT_MIENGIAM_CHITIET.MIENGIAM_ID = MIENGIAM_THANHVIEN_ID and TINHTRANG = 1 and TIEPNHAN_ID = '107181')        group by VIENPHI_ID, REF_TABLE) E on E.REF_TABLE = 'TT_MIENGIAM_THANHVIEN' and E.VIENPHI_ID = A.VIENPHI_ID        left join (select sum(GIATRIMIENGIAM) as GIATRIMIENGIAM, VIENPHI_ID, REF_TABLE        from TT_MIENGIAM_CHITIET        where REF_TABLE = 'TT_MIENGIAM_CONGTY'        and exists (select MIENGIAM_CONGTY_ID from TT_MIENGIAM_CONGTY where TT_MIENGIAM_CHITIET.MIENGIAM_ID = MIENGIAM_CONGTY_ID and TINHTRANG = 1 and TIEPNHAN_ID = '107181')        group by VIENPHI_ID, REF_TABLE) F on F.REF_TABLE = 'TT_MIENGIAM_CONGTY' and F.VIENPHI_ID = A.VIENPHI_ID        left join TT_DVYEUCAU DVYC on DVYC.DVYEUCAU_ID = A.REF_ID and A.REF_TABLE = 'TT_DVYEUCAU'        left join TM_DICHVU DV on DVYC.DICHVU_ID = DV.DICHVU_ID and A.REF_TABLE = 'TT_DVYEUCAU'        left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = DV.NHOMDICHVU_ID and A.REF_TABLE = 'TT_DVYEUCAU'        where        A.TIEPNHAN_ID = '107181' and ((DVYC.HUYYEUCAU = '0' and A.DICHVU_ID is not null)        or A.DUOC_ID is not null or A.REF_TABLE = 'TT_NUT_XACNHANSUATAN_CHITIET')        and A.ACTIVE = '1'         and           A.BENHAN_ID = '24642'                 and A.BENHVIEN_ID = 'HLU01'        order by A.VIENPHI_ID]
2020-02-26 16:08:46,969 [1] DEBUG - Statement Id: [DAO00006_GetListDuocTyle] PreparedStatement : [select DUOC_ID, DOITUONG_ID, (TYLE/100) as TYLE, DONGIA MUCTRAN_THANHTOAN from TM_DOITUONG_GIADUOC_TYLE            where            BENHVIEN_ID = 'HLU01'            and DOITUONG_ID = '4']
2020-02-26 16:08:46,994 [1] DEBUG - Statement Id: [DAO00027_GetListTuongTrinhDichVuPhauThuatCuaTiepNhan] PreparedStatement : [declare @ManhomDSA varchar(10);        declare @PhanLoaiNhomDV varchar(20) = '05';        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        if (@ManhomDSA is not null) set @PhanLoaiNhomDV += ',' + @ManhomDSA        select distinct ptyc.*        from TT_PHAUTHUAT_YEUCAU ptyc        inner join TM_DICHVU dv on dv.DICHVU_ID = ptyc.DICHVU_ID        inner join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID        inner join TT_PHAUTHUAT pt on pt.PHAUTHUAT_ID = ptyc.PHAUTHUAT_ID        where        pt.TIEPNHAN_ID = 107181        and (left(ndv.MANHOMDICHVU, 2) in (select * from STRING_SPLIT(@PhanLoaiNhomDV,',')) or ndv.MANHOMDICHVU in (select * from STRING_SPLIT(@PhanLoaiNhomDV,',')))]
2020-02-26 16:08:47,078 [1] DEBUG - Statement Id: [DAO00027_GetListTuongTrinhVTYTPhauThuatCuaTiepNhan] PreparedStatement : [select distinct ptvt.*        from TT_PHAUTHUAT_VTYT ptvt        inner join TT_PHAUTHUAT pt on pt.PHAUTHUAT_ID = ptvt.PHAUTHUAT_ID        inner join TM_DUOC d on d.DUOC_ID = ptvt.DUOC_ID        inner join TM_LOAIDUOC ld on ld.LOAIVATTU_ID = 'V' and ld.LOAIDUOC_ID = d.LOAIDUOC_ID        where pt.TIEPNHAN_ID = 107181        order by ptvt.PHAUTHUAT_VTYT_ID asc]
2020-02-26 16:08:47,126 [1] DEBUG - Statement Id: [DAO00006_GetList] PreparedStatement : [select dv.*, loaiDV.MALOAIDICHVU, captren.NHOMDICHVU_ID as NHOMDICHVU_CAPTREN_ID, captren.TENNHOMDICHVU as NHOMDICHVU_CAPTREN,              nhom_dv.TENNHOMDICHVU as TENNHOMDICHVU, nhom_dv.MANHOMDICHVU,              case when dv.ATTRIBUTE5 is null then 'TT' else 'KTC' end as LOAI_CHIPHI              from TM_DICHVU as dv              left join TM_NHOMDICHVU as nhom_dv on nhom_dv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID and nhom_dv.BENHVIEN_ID = 'HLU01'              left join TM_NHOMDICHVU as captren on nhom_dv.CAPTREN_ID = captren.NHOMDICHVU_ID and captren.BENHVIEN_ID = 'HLU01'              left join TM_LOAIDICHVU loaiDV on nhom_dv.LOAIDICHVU_ID = loaiDV.LOAIDICHVU_ID and loaiDV.BENHVIEN_ID = 'HLU01'              where nhom_dv.TAMNGUNG = '0' and dv.BENHVIEN_ID = 'HLU01'              and dv.TAMNGUNG = '0'               AND                   loaiDV.MALOAIDICHVU = 'KhamBenh']
2020-02-26 16:08:47,192 [1] DEBUG - Statement Id: [DAO00027_GetDichvuYCBHYTTyle] PreparedStatement : [select DVYEUCAU_ID from TT_DVYEUCAU        where TIEPNHAN_ID = 107181 and isnull(BHYT_TYLETHANHTOAN_ID, 0) > 0]
2020-02-26 16:08:47,432 [1] DEBUG - Statement Id: [DAO00023_UpdateNhieuVP] PreparedStatement : [declare @jsonVienPhi nvarchar(max) = N'[{"VIENPHI_ID":3109614,"TIEPNHAN_ID":107181,"DICHVU_ID":5440,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":34500.0000,"THANHTIEN_DOANHTHU":34500.00,"BHYT_TL":0.8000,"BHYT_DONGIA":34500.0000,"BHYT_THANHTIEN":34500.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":27600.0,"BHYT_THANHTIEN_CHITRA":27600.00,"BENHNHAN_PHAITHANHTOAN":6900.00,"GIATRI_HOADON":6900.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3109615,"TIEPNHAN_ID":107181,"DICHVU_ID":5554,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":5000.0000,"THANHTIEN_DOANHTHU":5000.00,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":5000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110619,"TIEPNHAN_ID":107181,"DICHVU_ID":4022,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":43900.0000,"THANHTIEN_DOANHTHU":43900.00,"BHYT_TL":0.8000,"BHYT_DONGIA":43900.0000,"BHYT_THANHTIEN":43900.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":35120.0,"BHYT_THANHTIEN_CHITRA":35120.00,"BENHNHAN_PHAITHANHTOAN":8780.00,"GIATRI_HOADON":8780.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110620,"TIEPNHAN_ID":107181,"DICHVU_ID":4422,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":32800.0000,"THANHTIEN_DOANHTHU":32800.00,"BHYT_TL":0.8000,"BHYT_DONGIA":32800.0000,"BHYT_THANHTIEN":32800.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":26240.0,"BHYT_THANHTIEN_CHITRA":26240.00,"BENHNHAN_PHAITHANHTOAN":6560.00,"GIATRI_HOADON":6560.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110621,"TIEPNHAN_ID":107181,"DICHVU_ID":4451,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":63500.0000,"THANHTIEN_DOANHTHU":63500.00,"BHYT_TL":0.8000,"BHYT_DONGIA":63500.0000,"BHYT_THANHTIEN":63500.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":50800.0,"BHYT_THANHTIEN_CHITRA":50800.00,"BENHNHAN_PHAITHANHTOAN":12700.00,"GIATRI_HOADON":12700.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110622,"TIEPNHAN_ID":107181,"DICHVU_ID":4454,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":40400.0000,"THANHTIEN_DOANHTHU":40400.00,"BHYT_TL":0.8000,"BHYT_DONGIA":40400.0000,"BHYT_THANHTIEN":40400.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":32320.0,"BHYT_THANHTIEN_CHITRA":32320.00,"BENHNHAN_PHAITHANHTOAN":8080.00,"GIATRI_HOADON":8080.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110623,"TIEPNHAN_ID":107181,"DICHVU_ID":4523,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":40400.0000,"THANHTIEN_DOANHTHU":40400.00,"BHYT_TL":0.8000,"BHYT_DONGIA":40400.0000,"BHYT_THANHTIEN":40400.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":32320.0,"BHYT_THANHTIEN_CHITRA":32320.00,"BENHNHAN_PHAITHANHTOAN":8080.00,"GIATRI_HOADON":8080.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110624,"TIEPNHAN_ID":107181,"DICHVU_ID":4596,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":39100.0000,"THANHTIEN_DOANHTHU":39100.00,"BHYT_TL":0.8000,"BHYT_DONGIA":39100.0000,"BHYT_THANHTIEN":39100.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":31280.0,"BHYT_THANHTIEN_CHITRA":31280.00,"BENHNHAN_PHAITHANHTOAN":7820.00,"GIATRI_HOADON":7820.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110626,"TIEPNHAN_ID":107181,"DICHVU_ID":4642,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":21500.0000,"THANHTIEN_DOANHTHU":21500.00,"BHYT_TL":0.8000,"BHYT_DONGIA":21500.0000,"BHYT_THANHTIEN":21500.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":17200.0,"BHYT_THANHTIEN_CHITRA":17200.00,"BENHNHAN_PHAITHANHTOAN":4300.00,"GIATRI_HOADON":4300.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110628,"TIEPNHAN_ID":107181,"DICHVU_ID":4681,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":21500.0000,"THANHTIEN_DOANHTHU":21500.00,"BHYT_TL":0.8000,"BHYT_DONGIA":21500.0000,"BHYT_THANHTIEN":21500.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":17200.0,"BHYT_THANHTIEN_CHITRA":17200.00,"BENHNHAN_PHAITHANHTOAN":4300.00,"GIATRI_HOADON":4300.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110629,"TIEPNHAN_ID":107181,"DICHVU_ID":4722,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":21500.0000,"THANHTIEN_DOANHTHU":21500.00,"BHYT_TL":0.8000,"BHYT_DONGIA":21500.0000,"BHYT_THANHTIEN":21500.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":17200.0,"BHYT_THANHTIEN_CHITRA":17200.00,"BENHNHAN_PHAITHANHTOAN":4300.00,"GIATRI_HOADON":4300.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110630,"TIEPNHAN_ID":107181,"DICHVU_ID":4747,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":27400.0000,"THANHTIEN_DOANHTHU":27400.00,"BHYT_TL":0.8000,"BHYT_DONGIA":27400.0000,"BHYT_THANHTIEN":27400.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":21920.0,"BHYT_THANHTIEN_CHITRA":21920.00,"BENHNHAN_PHAITHANHTOAN":5480.00,"GIATRI_HOADON":5480.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110631,"TIEPNHAN_ID":107181,"DICHVU_ID":4832,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":70000.0000,"THANHTIEN_DOANHTHU":70000.00,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":70000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":70000.0000,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":70000.0000,"GIATRI_BENHNHAN_DATHANHTOAN":70000.0000,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110632,"TIEPNHAN_ID":107181,"DICHVU_ID":4873,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":70000.0000,"THANHTIEN_DOANHTHU":70000.00,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":70000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":70000.0000,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":70000.0000,"GIATRI_BENHNHAN_DATHANHTOAN":70000.0000,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119342,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":5.0000,"DONGIA_DOANHTHU":4000.0000,"THANHTIEN_DOANHTHU":20000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":20000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119500,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":2.0000,"DONGIA_DOANHTHU":8715.0000,"THANHTIEN_DOANHTHU":17430.00,"BHYT_TL":0.8000,"BHYT_DONGIA":8715.0000,"BHYT_THANHTIEN":17430.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":6972.0,"BHYT_THANHTIEN_CHITRA":13944.00,"BENHNHAN_PHAITHANHTOAN":3486.00,"GIATRI_HOADON":3486.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119501,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":8925.0000,"THANHTIEN_DOANHTHU":8925.00,"BHYT_TL":0.8000,"BHYT_DONGIA":8925.0000,"BHYT_THANHTIEN":8925.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":7140.0,"BHYT_THANHTIEN_CHITRA":7140.00,"BENHNHAN_PHAITHANHTOAN":1785.00,"GIATRI_HOADON":1785.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119502,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":2.0000,"DONGIA_DOANHTHU":27990.0000,"THANHTIEN_DOANHTHU":55980.00,"BHYT_TL":0.8000,"BHYT_DONGIA":27990.0000,"BHYT_THANHTIEN":55980.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":22392.0,"BHYT_THANHTIEN_CHITRA":44784.00,"BENHNHAN_PHAITHANHTOAN":11196.00,"GIATRI_HOADON":11196.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119503,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":8925.0000,"THANHTIEN_DOANHTHU":8925.00,"BHYT_TL":0.8000,"BHYT_DONGIA":8925.0000,"BHYT_THANHTIEN":8925.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":7140.0,"BHYT_THANHTIEN_CHITRA":7140.00,"BENHNHAN_PHAITHANHTOAN":1785.00,"GIATRI_HOADON":1785.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119504,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":2.0000,"DONGIA_DOANHTHU":8295.0000,"THANHTIEN_DOANHTHU":16590.00,"BHYT_TL":0.8000,"BHYT_DONGIA":8295.0000,"BHYT_THANHTIEN":16590.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":6636.0,"BHYT_THANHTIEN_CHITRA":13272.00,"BENHNHAN_PHAITHANHTOAN":3318.00,"GIATRI_HOADON":3318.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119505,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":458000.0000,"THANHTIEN_DOANHTHU":458000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":398036.0000,"BHYT_THANHTIEN":398036.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":318428.8,"BHYT_THANHTIEN_CHITRA":318428.80,"BENHNHAN_PHAITHANHTOAN":139571.20,"GIATRI_HOADON":79607.20,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119506,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":50400.0000,"THANHTIEN_DOANHTHU":50400.00,"BHYT_TL":0.8000,"BHYT_DONGIA":50400.0000,"BHYT_THANHTIEN":50400.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":40320.0,"BHYT_THANHTIEN_CHITRA":40320.00,"BENHNHAN_PHAITHANHTOAN":10080.00,"GIATRI_HOADON":10080.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119530,"TIEPNHAN_ID":107181,"DICHVU_ID":5363,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":10000.0000,"THANHTIEN_DOANHTHU":10000.00,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119531,"TIEPNHAN_ID":107181,"DICHVU_ID":5588,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":2400.0000,"THANHTIEN_DOANHTHU":2400.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119532,"TIEPNHAN_ID":107181,"DICHVU_ID":477,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":110000.0000,"THANHTIEN_DOANHTHU":110000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119533,"TIEPNHAN_ID":107181,"DICHVU_ID":5602,"BENHAN_ID":24642,"SOLUONG":0.5000,"DONGIA_DOANHTHU":200000.0000,"THANHTIEN_DOANHTHU":100000.00,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":100000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119535,"TIEPNHAN_ID":107181,"DICHVU_ID":3161,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":2945000.0000,"THANHTIEN_DOANHTHU":2945000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":2945000.0000,"BHYT_THANHTIEN":2945000.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":2356000.0,"BHYT_THANHTIEN_CHITRA":2356000.00,"BENHNHAN_PHAITHANHTOAN":589000.00,"GIATRI_HOADON":589000.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119536,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":0.2500,"DONGIA_DOANHTHU":25000.0000,"THANHTIEN_DOANHTHU":6250.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119537,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":2.0000,"DONGIA_DOANHTHU":1700.0000,"THANHTIEN_DOANHTHU":3400.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119538,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":3.0000,"DONGIA_DOANHTHU":1000.0000,"THANHTIEN_DOANHTHU":3000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119539,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":3.0000,"DONGIA_DOANHTHU":2000.0000,"THANHTIEN_DOANHTHU":6000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119540,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":4000.0000,"THANHTIEN_DOANHTHU":4000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119541,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":3000.0000,"THANHTIEN_DOANHTHU":3000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119542,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":100.0000,"DONGIA_DOANHTHU":50.0000,"THANHTIEN_DOANHTHU":5000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119543,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":150000.0000,"THANHTIEN_DOANHTHU":150000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119544,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":160000.0000,"THANHTIEN_DOANHTHU":160000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119545,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":20.0000,"DONGIA_DOANHTHU":3000.0000,"THANHTIEN_DOANHTHU":60000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119546,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":20.0000,"DONGIA_DOANHTHU":6000.0000,"THANHTIEN_DOANHTHU":120000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119547,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":5.0000,"DONGIA_DOANHTHU":4000.0000,"THANHTIEN_DOANHTHU":20000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119548,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":10.0000,"DONGIA_DOANHTHU":8000.0000,"THANHTIEN_DOANHTHU":80000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119549,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":2.0000,"DONGIA_DOANHTHU":500.0000,"THANHTIEN_DOANHTHU":1000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119550,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":10000.0000,"THANHTIEN_DOANHTHU":10000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119551,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":45000.0000,"THANHTIEN_DOANHTHU":45000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119552,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":35000.0000,"THANHTIEN_DOANHTHU":35000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119553,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":10000.0000,"THANHTIEN_DOANHTHU":10000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119554,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":20000.0000,"THANHTIEN_DOANHTHU":20000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119555,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":6500.0000,"THANHTIEN_DOANHTHU":6500.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119556,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":0.5000,"DONGIA_DOANHTHU":16000.0000,"THANHTIEN_DOANHTHU":8000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119557,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":0.2500,"DONGIA_DOANHTHU":100000.0000,"THANHTIEN_DOANHTHU":25000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119558,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":2.0000,"DONGIA_DOANHTHU":10000.0000,"THANHTIEN_DOANHTHU":20000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119559,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":60000.0000,"THANHTIEN_DOANHTHU":60000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119560,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":2.0000,"DONGIA_DOANHTHU":13500.0000,"THANHTIEN_DOANHTHU":27000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119561,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":6000.0000,"THANHTIEN_DOANHTHU":6000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119645,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":600.0000,"THANHTIEN_DOANHTHU":600.00,"BHYT_TL":0.8000,"BHYT_DONGIA":600.0000,"BHYT_THANHTIEN":600.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":480.0,"BHYT_THANHTIEN_CHITRA":480.00,"BENHNHAN_PHAITHANHTOAN":120.00,"GIATRI_HOADON":120.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":0.0,"DUOC_TYLE":0.0000},{"VIENPHI_ID":3119646,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":1000.0000,"THANHTIEN_DOANHTHU":1000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":1000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"1","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":0.0,"DUOC_TYLE":0.0000},{"VIENPHI_ID":3119647,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":600.0000,"THANHTIEN_DOANHTHU":600.00,"BHYT_TL":0.8000,"BHYT_DONGIA":600.0000,"BHYT_THANHTIEN":600.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":480.0,"BHYT_THANHTIEN_CHITRA":480.00,"BENHNHAN_PHAITHANHTOAN":120.00,"GIATRI_HOADON":120.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":0.0,"DUOC_TYLE":0.0000},{"VIENPHI_ID":3119648,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":1000.0000,"THANHTIEN_DOANHTHU":1000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":1000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"1","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":0.0,"DUOC_TYLE":0.0000}]';        begin        UPDATE TT_VIENPHI        SET        SOLUONG = json.SOLUONG,        DONGIA_DOANHTHU = json.DONGIA_DOANHTHU,        THANHTIEN_DOANHTHU = json.THANHTIEN_DOANHTHU,        BHYT_TL = json.BHYT_TL,        BHYT_DONGIA = json.BHYT_DONGIA,        BHYT_THANHTIEN = json.BHYT_THANHTIEN,        BHYT_DONGIA_CONGKHAM_DAU = json.BHYT_DONGIA_CONGKHAM_DAU,        BHYT_CONGKHAM_DAU_TYLE = json.BHYT_CONGKHAM_DAU_TYLE,        BHYT_DONGIA_CHITRA = json.BHYT_DONGIA_CHITRA,        BHYT_THANHTIEN_CHITRA = json.BHYT_THANHTIEN_CHITRA,        BENHNHAN_PHAITHANHTOAN = json.BENHNHAN_PHAITHANHTOAN,        GIATRI_HOADON = json.GIATRI_HOADON,        GIATRI_BIENLAI = json.GIATRI_BIENLAI,        DATHUCHIEN = json.DATHUCHIEN,        DICHVU_TL = json.DICHVU_TL,        BHYT_DONGIA_DONGCT_DAU = json.BHYT_DONGIA_DONGCT_DAU,        SOLONHAP_ID = json.SOLONHAP_ID,        DUOC_TYLE = json.DUOC_TYLE,        DUOC_MUCTRAN_THANHTOAN = json.DUOC_MUCTRAN_THANHTOAN,        NGAYCAPNHAT = GETDATE()        FROM OPENJSON (@jsonVienPhi)        WITH (        VIENPHI_ID int,        SOLUONG numeric(25, 4),        DONGIA_DOANHTHU numeric(25, 4),        THANHTIEN_DOANHTHU numeric(25, 4),        BHYT_TL numeric(25, 4),        BHYT_DONGIA numeric(25, 4),        BHYT_THANHTIEN numeric(25, 4),        BHYT_DONGIA_CONGKHAM_DAU numeric(25, 4),        BHYT_CONGKHAM_DAU_TYLE numeric(25, 4),        BHYT_DONGIA_CHITRA numeric(25, 4),        BHYT_THANHTIEN_CHITRA numeric(25, 4),        BENHNHAN_PHAITHANHTOAN numeric(25, 4),        GIATRI_HOADON numeric(25, 4),        GIATRI_BIENLAI numeric(25, 4),        DATHUCHIEN char(1),        KHONGTHUTIEN char(1),        BHYTDONGTIEN char(1),        DICHVU_TL numeric(25, 4),        BHYT_DONGIA_DONGCT_DAU numeric(25, 4),        SOLONHAP_ID int,        DUOC_TYLE numeric(25, 4),        DUOC_MUCTRAN_THANHTOAN numeric(25, 4))  json        WHERE TT_VIENPHI.VIENPHI_ID = json.VIENPHI_ID and json.DONGIA_DOANHTHU > 0                  insert into TT_TINH_VIENPHI_LOG        SELECT json.VIENPHI_ID, json.TIEPNHAN_ID, json.BENHAN_ID, json.SOLUONG, json.BHYT_TL, json.DONGIA_DOANHTHU,        json.THANHTIEN_DOANHTHU, json.BHYT_DONGIA, json.BHYT_THANHTIEN, json.BHYT_DONGIA_CHITRA, json.BHYT_THANHTIEN_CHITRA, json.BENHNHAN_PHAITHANHTOAN,        json.SOBHYT_HUONG_ID, json.SOBHYT, GETDATE(), -1, 'HLU01'        FROM OPENJSON(@jsonVienPhi)        WITH (        VIENPHI_ID int,        TIEPNHAN_ID int,        BENHAN_ID int,        SOLUONG numeric(25, 4),        DONGIA_DOANHTHU numeric(25, 4),        THANHTIEN_DOANHTHU numeric(25, 4),        BHYT_TL numeric(25, 4),        BHYT_DONGIA numeric(25, 4),        BHYT_THANHTIEN numeric(25, 4),        BHYT_DONGIA_CHITRA numeric(25, 4),        BHYT_THANHTIEN_CHITRA numeric(25, 4),        BENHNHAN_PHAITHANHTOAN numeric(25, 4),        SOBHYT_HUONG_ID int,        SOBHYT nvarchar(30)) json        end]
2020-02-26 16:08:47,547 [1] DEBUG - Statement Id: [DAO00067_UpdateDataVienPhiDongiaBHYT] PreparedStatement : [update TT_VIENPHI          set BHYT_DONGIA_CHITRA = 0, BHYT_THANHTIEN = 0, BHYT_THANHTIEN_CHITRA = 0          where          TIEPNHAN_ID = 107181 and BHYT_DONGIA = 0          and (BHYT_DONGIA_CHITRA > 0 or BHYT_THANHTIEN > 0 or BHYT_THANHTIEN_CHITRA > 0)]
2020-02-26 16:08:47,572 [1] DEBUG - Statement Id: [DAO00067_CapnhatDataVienphiKhiHuyThanhtoanHoadon] PreparedStatement : [update TT_VIENPHI        set TT_VIENPHI.HOADON_ID = hdct.HOADON_ID, TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN = TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN + hdct.GIATRI_BENHNHAN_DATHANHTOAN        from (select CT.HOADON_ID, CT.VIENPHI_ID, CT.GIATRI_BENHNHAN_DATHANHTOAN        from TT_HOADON_CHITIET_NGOAITRU CT        join TT_HOADON HD on HD.HOADON_ID = CT.HOADON_ID        join TT_VIENPHI vp on vp.VIENPHI_ID = ct.VIENPHI_ID        where HD.DATHANHTOAN = 1 and HD.HUYHOADON = 0 and HD.HOANTRA = 0 and vp.TIEPNHAN_ID =  @param0 ) hdct        where        TT_VIENPHI.VIENPHI_ID = hdct.VIENPHI_ID and TT_VIENPHI.HOADON_ID is null and isnull(TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN,0) = 0        and TT_VIENPHI.TIEPNHAN_ID =  @param0           update TT_VIENPHI        set TT_VIENPHI.HOADON_ID = null, TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN = TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN - hdct.GIATRI_BENHNHAN_DATHANHTOAN,        TT_VIENPHI.DATHANHTOAN = '0'        from (select CT.HOADON_ID, CT.VIENPHI_ID, CT.GIATRI_BENHNHAN_DATHANHTOAN        from TT_HOADON_CHITIET_NGOAITRU CT        join TT_HOADON HD on HD.HOADON_ID = CT.HOADON_ID        join TT_VIENPHI vp on vp.VIENPHI_ID = ct.VIENPHI_ID and vp.HOADON_ID = ct.HOADON_ID        where HD.DATHANHTOAN = 0 and (HD.HUYHOADON = 1 or HD.HOANTRA = 1) and vp.TIEPNHAN_ID =  @param0 ) hdct        where        TT_VIENPHI.VIENPHI_ID = hdct.VIENPHI_ID and TT_VIENPHI.HOADON_ID = hdct.HOADON_ID        and TT_VIENPHI.TIEPNHAN_ID =  @param0]
2020-02-26 16:08:47,572 [1] DEBUG - Statement Id: [DAO00067_CapnhatDataVienphiKhiHuyThanhtoanHoadon] Parameters: [@param0=[TIEPNHAN_ID,107181]]
2020-02-26 16:08:47,572 [1] DEBUG - Statement Id: [DAO00067_CapnhatDataVienphiKhiHuyThanhtoanHoadon] Types: [@param0=[Int64, System.Int64]]
2020-02-26 16:08:48,676 [1] DEBUG - Statement Id: [DAO00305_GetListLoaiBenhAn] PreparedStatement : [select        DICTIONARY_ID as LOAIBENHAN_ID        , DICTIONARY_NAME as TENLOAIBENHAN        , DICTIONARY_NAME_EN        , DICTIONARY_CODE        , DICTIONARY_NAME        from LST_DICTIONARY        where LST_DICTIONARY.Enabled = '1' and DICTIONARY_TYPE_CODE = 'LoaiBenhAn'        order by LST_DICTIONARY.IDX]
2020-02-26 16:08:52,563 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'IPD60'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 16:08:53,318 [1] DEBUG - Statement Id: [DAO00040_LayListToaMau] PreparedStatement : [select A.*, dc.TENDUOCDAYDU, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ld.MALOAIDUOC, dd.DICTIONARY_NAME DUONGDUNG, dc.TAMNGUNG            from TT_TOATHUOCMAU A            left join TM_DUOC dc on A.DUOC_ID = dc.DUOC_ID            left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID            left join (select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE like 'DuongDung') dd on dd.DICTIONARY_ID = dc.DUONGDUNG_ID            where (1=1)]
2020-02-26 16:08:55,614 [1] DEBUG - Statement Id: [DAO00040_LayListToaMau] PreparedStatement : [select A.*, dc.TENDUOCDAYDU, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ld.MALOAIDUOC, dd.DICTIONARY_NAME DUONGDUNG, dc.TAMNGUNG            from TT_TOATHUOCMAU A            left join TM_DUOC dc on A.DUOC_ID = dc.DUOC_ID            left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID            left join (select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE like 'DuongDung') dd on dd.DICTIONARY_ID = dc.DUONGDUNG_ID            where (1=1)]
2020-02-26 16:08:57,914 [1] DEBUG - Statement Id: [DAO00017_GetLoaiGiaByDoiTuongId] PreparedStatement : [select dtlg.DOUUTIEN, dtlg.DOITUONG_ID, lg.LOAIGIA_ID, lg.TENLOAIGIA, lg.MALOAIGIA              from TM_LOAIGIA lg              left join TM_DOITUONG_LOAIGIA dtlg              on lg.LOAIGIA_ID = dtlg.LOAIGIA_ID and dtlg.BENHVIEN_ID = 'HLU01'              where lg.TAMNGUNG = 0 and lg.BENHVIEN_ID = 'HLU01'                             order by dtlg.DOUUTIEN]
2020-02-26 16:08:57,949 [1] DEBUG - Statement Id: [DAO00063_GetListKhoThuocPhongBanPhamvi] PreparedStatement : [select distinct dpv.*        from TM_DUOC_PHAMVISD_MAPPING dmap        left join TM_DUOC_PHAMVISUDUNG dpv on dpv.PHAMVI_ID = dmap.PHAMVI_ID        where dmap.KHODUOC_ID in (select KHODUOC_ID from TM_PHONGBAN_KHODUOC where PHONGBAN_ID = '25')]
2020-02-26 16:08:57,978 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1027']
2020-02-26 16:08:58,002 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1030']
2020-02-26 16:08:58,026 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1032']
2020-02-26 16:08:58,051 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1057']
2020-02-26 16:08:58,082 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1027']
2020-02-26 16:08:58,187 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1030']
2020-02-26 16:08:58,212 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1032']
2020-02-26 16:08:58,236 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1057']
2020-02-26 16:08:58,260 [1] DEBUG - Statement Id: [DAO00063_GetListPhamviTuKhoThuocVaPhongBan] PreparedStatement : [select distinct dpv.*, dmap.KHODUOC_ID        from TM_DUOC_PHAMVISD_MAPPING dmap        left join TM_DUOC_PHAMVISUDUNG dpv on dpv.PHAMVI_ID = dmap.PHAMVI_ID and dpv.TAMNGUNG != '1'        where dmap.KHODUOC_ID in (select KHODUOC_ID from TM_PHONGBAN_KHODUOC where PHONGBAN_ID = '25')        and dmap.KHODUOC_ID = '29' and dpv.MAPHAMVI is not null]
2020-02-26 16:08:58,312 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 999999999 as SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        where  @param0  = 0        union all        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end        else        begin        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO        group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end]
2020-02-26 16:08:58,312 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Parameters: [@param0=[PHAMVI_ID,1027]]
2020-02-26 16:08:58,312 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Types: [@param0=[Int64, System.Int64]]
2020-02-26 16:08:58,534 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 999999999 as SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        where  @param0  = 0        union all        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end        else        begin        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO        group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end]
2020-02-26 16:08:58,534 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Parameters: [@param0=[PHAMVI_ID,1027]]
2020-02-26 16:08:58,534 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Types: [@param0=[Int64, System.Int64]]
2020-02-26 16:08:58,814 [1] DEBUG - Statement Id: [DAO00096_GetList] PreparedStatement : [select *        from TM_DUOC_THANHPHANHOATCHAT        where BENHVIEN_ID = 'HLU01']
2020-02-26 16:08:58,954 [1] DEBUG - Statement Id: [DAO00040_LayListToaMau] PreparedStatement : [select A.*, dc.TENDUOCDAYDU, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ld.MALOAIDUOC, dd.DICTIONARY_NAME DUONGDUNG, dc.TAMNGUNG            from TT_TOATHUOCMAU A            left join TM_DUOC dc on A.DUOC_ID = dc.DUOC_ID            left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID            left join (select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE like 'DuongDung') dd on dd.DICTIONARY_ID = dc.DUONGDUNG_ID            where (1=1)]
2020-02-26 16:09:01,975 [1] DEBUG - Statement Id: [DAO00063_GetListKhoThuocPhongBanPhamvi] PreparedStatement : [select distinct dpv.*        from TM_DUOC_PHAMVISD_MAPPING dmap        left join TM_DUOC_PHAMVISUDUNG dpv on dpv.PHAMVI_ID = dmap.PHAMVI_ID        where dmap.KHODUOC_ID in (select KHODUOC_ID from TM_PHONGBAN_KHODUOC where PHONGBAN_ID = '25')]
2020-02-26 16:09:02,010 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1027']
2020-02-26 16:09:02,089 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1030']
2020-02-26 16:09:02,113 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1032']
2020-02-26 16:09:02,137 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1057']
2020-02-26 16:09:02,167 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1027']
2020-02-26 16:09:02,190 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1030']
2020-02-26 16:09:02,214 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1032']
2020-02-26 16:09:02,238 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1057']
2020-02-26 16:09:02,262 [1] DEBUG - Statement Id: [DAO00063_GetListPhamviTuKhoThuocVaPhongBan] PreparedStatement : [select distinct dpv.*, dmap.KHODUOC_ID        from TM_DUOC_PHAMVISD_MAPPING dmap        left join TM_DUOC_PHAMVISUDUNG dpv on dpv.PHAMVI_ID = dmap.PHAMVI_ID and dpv.TAMNGUNG != '1'        where dmap.KHODUOC_ID in (select KHODUOC_ID from TM_PHONGBAN_KHODUOC where PHONGBAN_ID = '25')        and dmap.KHODUOC_ID = '29' and dpv.MAPHAMVI is not null]
2020-02-26 16:09:02,300 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 999999999 as SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        where  @param0  = 0        union all        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end        else        begin        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO        group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end]
2020-02-26 16:09:02,300 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Parameters: [@param0=[PHAMVI_ID,1027]]
2020-02-26 16:09:02,300 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Types: [@param0=[Int64, System.Int64]]
2020-02-26 16:09:02,376 [1] DEBUG - Statement Id: [DAO00063_Getlist_Thuoc_Tamngung] PreparedStatement : [select DUOC_ID FROM TM_DUOC where TAMNGUNG = '1']
2020-02-26 16:09:02,413 [1] DEBUG - Statement Id: [DAO00061_GetLuuTruIDByBenhAnID] PreparedStatement : [select lt.LUUTRU_ID, ba.BACSIDIEUTRI_ID as BACSIDIEUTRICHINH_ID        from TT_NOITRU_LUUTRU lt        left join TT_NOITRU_BENHAN ba on lt.BENHAN_ID = ba.BENHAN_ID        where lt.BENHAN_ID = '24642']
2020-02-26 16:09:02,443 [1] DEBUG - Statement Id: [DAO00061_GetChanDoanBenhAnID] PreparedStatement : [DECLARE @ICDPHU NVARCHAR(2000)=''        DECLARE @LISTICDPHU NVARCHAR(200)        DECLARE @CHANDOANRAVIEN NVARCHAR(500)        DECLARE @LISTICDPHUVAOKHOA NVARCHAR(50)        DECLARE @ICDPHUVAOKHOA NVARCHAR(500)=''        DECLARE @ICDKHAMBENH NVARCHAR(500) = (SELECT ICD.TENICD + '('+ISNULL(ICD.MAICD,'')+')'        FROM TT_NOITRU_BENHAN BA INNER JOIN TM_ICD ICD        ON BA.ICD_KHAMBENH = ICD.ICD_ID WHERE BA.BENHAN_ID =  @param0 )        DECLARE @ICDCHINH NVARCHAR(500) = (SELECT ICD.TENICD + '('+ISNULL(ICD.MAICD,'')+')'        FROM TT_NOITRU_BENHAN BA INNER JOIN TM_ICD ICD        ON BA.ICD_BENHCHINH = ICD.ICD_ID WHERE BA.BENHAN_ID =  @param0 )        SELECT @CHANDOANRAVIEN = BA.CHANDOANRAVIEN, @LISTICDPHU = BA.ICD_BENHPHU, @LISTICDPHUVAOKHOA = BA.ICD_PHU_VAOKHOA        FROM TT_NOITRU_BENHAN BA WHERE BA.BENHAN_ID =  @param0         SELECT @ICDPHU = @ICDPHU + ISNULL(TENICD, '') +'(' +ISNULL(MAICD,'')+ '); ' FROM TM_ICD WHERE MAICD IN (SELECT S FROM SplitString(@LISTICDPHU,';'))        SELECT @ICDPHUVAOKHOA = @ICDPHUVAOKHOA + ISNULL(TENICD, '') +'(' +ISNULL(MAICD,'')+ '); ' FROM TM_ICD WHERE MAICD IN (SELECT S FROM SplitString(@LISTICDPHUVAOKHOA,';'))        SELECT ICD_KHAMBENH, CHANDOANKHAMBENH, CHANDOANVAOKHOA, CHANDOANRAVIEN, CHANDOANKHAC                , CASE        WHEN LEN(ISNULL(BA.CDRAVIEN_PHU,'')) > 0 AND LEN(ISNULL(BA.CDRAVIEN_CHINH,'')) > 0 THEN ISNULL(BA.CDRAVIEN_CHINH,'') + '; ' + ISNULL(BA.CDRAVIEN_PHU,'')        WHEN LEN(ISNULL(BA.CDRAVIEN_PHU,'')) > 0 AND LEN(ISNULL(BA.CDRAVIEN_CHINH,'')) <= 0  THEN BA.CDRAVIEN_PHU        WHEN LEN(ISNULL(BA.CDRAVIEN_PHU,'')) <= 0 AND LEN(ISNULL(BA.CDRAVIEN_CHINH,'')) > 0 THEN BA.CDRAVIEN_CHINH        ELSE NULL END AS CHANDOANNOITRU        ,CASE WHEN @ICDKHAMBENH IS NULL AND (@CHANDOANRAVIEN IS NULL OR @CHANDOANRAVIEN = '') THEN ''        ELSE ISNULL(@ICDKHAMBENH, '') + '; ' + ISNULL(@CHANDOANRAVIEN, '') END        AS CHANDOANCAPCUU        , @ICDPHUVAOKHOA AS CHANDOANPHUVAOKHOA        FROM TT_NOITRU_BENHAN BA LEFT JOIN TM_ICD ICD ON BA.ICD_KHAMBENH = ICD.ICD_ID        WHERE BENHAN_ID =  @param0]
2020-02-26 16:09:02,443 [1] DEBUG - Statement Id: [DAO00061_GetChanDoanBenhAnID] Parameters: [@param0=[BENHAN_ID,24642]]
2020-02-26 16:09:02,443 [1] DEBUG - Statement Id: [DAO00061_GetChanDoanBenhAnID] Types: [@param0=[Int64, System.Int64]]
2020-02-26 16:09:02,495 [1] DEBUG - Statement Id: [DAO00000_GetDoiTuongIsBHYT] PreparedStatement : [select * from TM_DOITUONG Where DOITUONG_ID = 4 and MADOITUONG like '%BHYT%']
2020-02-26 16:09:02,576 [1] DEBUG - Statement Id: [DAO00068_GetLastedSinhHieuInfo] PreparedStatement : [select top (1) *, CHISOBMI as BMI              from TT_NGOAITRU_KHAMBENH_SINHHIEU              where BENHNHAN_ID = '20633'              order by KHAMBENH_SINHHIEU_ID desc]
2020-02-26 16:09:02,603 [1] DEBUG - Statement Id: [DAO00013_GetTienSuBenh] PreparedStatement : [select TIENSUBENH, TIENSUDIUNG        from TT_BENHNHAN        where TT_BENHNHAN.BENHNHAN_ID  = '20633']
2020-02-26 16:09:02,721 [1] DEBUG - Statement Id: [DAO00095_GetTTDiUngThuoc] PreparedStatement : [select *              from TT_BENHNHAN_DIUNG_THUOC              where BENHNHAN_ID = '20633'              and BENHVIEN_ID = 'HLU01']
2020-02-26 16:09:02,750 [1] DEBUG - Statement Id: [DAO00062_GetKhamBenhByTiepNhanID] PreparedStatement : [select *        from TT_NOITRU_KHAMBENH        where BENHAN_ID in        (select BENHAN_ID from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '107181')        and ISYLENHVTYT = '0'         and           BENHAN_ID = '24642'                 order by THOIGIANKHAM desc]
2020-02-26 16:09:02,845 [1] DEBUG - Statement Id: [DAO00063_GetTrangThaiYLenhTheoTiepnhanId] PreparedStatement : [select tt.CHUNGTU_ID, tt.PHIEULINH_ID, tt.TRANGTHAI, pl.DUYET as DUYETPHIEULINH,        ct.CHUNGTU_ID as CHUNGTUXUATNOIBO_ID, ct.LOAICHUNGTU, tt.KHAMBENH_ID, tt.DUOC_ID, tt.SOLUONG        from TT_NOITRU_TOATHUOC tt        left join TT_DUOC_PHIEULINH pl on tt.PHIEULINH_ID = pl.CHUNGTU_ID        left join TT_DUOC_CHUNGTU ct on pl.CHUNGTU_ID = ct.PHIEULINH_ID        where tt.TIEPNHAN_ID = '107181'        and (tt.PHIEULINH_ID is not null or tt.CHUNGTU_ID is not null or (tt.TRANGTHAI = 'DADUYET'))        order by tt.CHUNGTU_ID DESC]
2020-02-26 16:09:02,939 [1] DEBUG - Statement Id: [DAO00063_GetDanhsachTrathuocTheoBenhanId] PreparedStatement : [select A.KHAMBENH_ID, B.TOATHUOC_ID, B.DUOC_ID, SUM(B.SOLUONG) SOLUONG        from TT_NOITRU_TRATHUOC A        left join TT_NOITRU_TRATHUOC_CHITIET B on A.TRATHUOC_ID = B.TRATHUOC_ID        where A.BENHAN_ID = '24642'         group by A.KHAMBENH_ID, B.TOATHUOC_ID, B.DUOC_ID]
2020-02-26 16:09:02,992 [1] DEBUG - Statement Id: [DAO00014_GetInPatientStatus] PreparedStatement : [select TRANGTHAI, isnull(KHOACHUYENDEN_ID, KHOAVAO_ID) as KHOAHIENTAI from TT_NOITRU_BENHAN        where        TIEPNHAN_ID = '107181'        and BENHVIEN_ID = 'HLU01'         and           BENHAN_ID = '24642']
2020-02-26 16:09:39,954 [1] DEBUG - Statement Id: [DAO00030_Get_DuocCanhBaoICD_ByBenhAn_ID] PreparedStatement : [select A.*          from TM_DUOC_CANHBAO_ICD A          inner join TM_DUOC_HOATCHAT B on B.HOATCHAT_ID = A.HOATCHAT_ID          inner join TM_DUOC_THANHPHANHOATCHAT C on C.HOATCHAT_ID = B.HOATCHAT_ID          inner join TM_DUOC D on D.DUOC_ID = C.DUOC_ID          inner join TT_NOITRU_BENHAN BA on (BA.ICD_VAOKHOA = A.ICD_ID or BA.ICD_KHAMBENH = A.ICD_ID or BA.ICD_BENHCHINH = A.ICD_ID or BA.ICDRAVIEN_CHINH = A.ICD_ID          or A.MAICD in (select part from fnSplit(BA.ICD_BENHPHU, ';'))           or A.MAICD in (select part from fnSplit(BA.ICDRAVIEN_PHU, ';'))          or A.MAICD in (select part from fnSplit(BA.ICD_PHU_VAOKHOA, ';'))) and BA.BENHAN_ID = 24642          where C.DUOC_ID = 1030          and A.TAMNGUNG = '0'          and A.BENHVIEN_ID = 'HLU01']
2020-02-26 16:09:40,067 [1] DEBUG - Statement Id: [DAO00013_GetTienSuBenh] PreparedStatement : [select TIENSUBENH, TIENSUDIUNG        from TT_BENHNHAN        where TT_BENHNHAN.BENHNHAN_ID  = '20633']
2020-02-26 16:09:40,091 [1] DEBUG - Statement Id: [DAO00095_GetTTDiUngThuoc] PreparedStatement : [select *              from TT_BENHNHAN_DIUNG_THUOC              where BENHNHAN_ID = '20633'              and BENHVIEN_ID = 'HLU01']
2020-02-26 16:09:40,116 [1] DEBUG - Statement Id: [DAO00096_GetList] PreparedStatement : [select *        from TM_DUOC_THANHPHANHOATCHAT        where BENHVIEN_ID = 'HLU01']
2020-02-26 16:09:40,154 [1] DEBUG - Statement Id: [DAO00013_GetTienSuBenh] PreparedStatement : [select TIENSUBENH, TIENSUDIUNG        from TT_BENHNHAN        where TT_BENHNHAN.BENHNHAN_ID  = '20633']
2020-02-26 16:09:40,177 [1] DEBUG - Statement Id: [DAO00095_GetTTDiUngThuoc] PreparedStatement : [select *              from TT_BENHNHAN_DIUNG_THUOC              where BENHNHAN_ID = '20633'              and BENHVIEN_ID = 'HLU01']
2020-02-26 16:09:40,205 [1] DEBUG - Statement Id: [DAO00016_GetTTDuocCanhBao] PreparedStatement : [select *        from TM_DUOC_CANHBAO         where                 DUOC_ID = '1030'             and               BENHVIEN_ID = 'HLU01'                     order by DUOC_CANHBAO_ID]
2020-02-26 16:09:40,242 [1] DEBUG - Statement Id: [DAO00000_GetCHECK_DOITUONG_BHYT] PreparedStatement : [select count(*) as DOITUONG_BHYT FROM TM_DOITUONG A            WHERE A.DOITUONG_ID = '4' and A.BENHVIEN_ID = 'HLU01' and MADOITUONG like '%BHYT%']
2020-02-26 16:09:40,271 [1] DEBUG - Statement Id: [DAO00000_GetLOAIGIATHUOC_NOI_NGOAI_VIEN] PreparedStatement : [SELECT LOAIGIA_ID              FROM TM_LOAIGIA              WHERE MALOAIGIA = 'GiaThuoc_NoiVien' and BENHVIEN_ID = 'HLU01']
2020-02-26 16:09:42,223 [1] DEBUG - Statement Id: [DAO00000_GetDUOC_DONGIADOANHTHU_NOIVIEN] PreparedStatement : [declare @doanhthuKhongHT numeric(24,2);          declare @doanhthu numeric(24,2);          declare @hotro numeric(24,2);          declare @bhyt char(1);          declare @loaigia_id int, @loaigiakhonght_id int            select top 1 @doanhthuKhongHT = dg.DONGIA, @loaigiakhonght_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0 and GIAHOTRO != '1'          order by dtlg.DOUUTIEN asc          select top 1 @doanhthu = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0           order by dtlg.DOUUTIEN asc          select top 1 @hotro = dg.DONGIA, @loaigia_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0  and GIAHOTRO = '1'          order by dtlg.DOUUTIEN asc          select top 1 @bhyt = BHYT from TM_DUOC where DUOC_ID = 1030          select ISNULL(@doanhthu,0.0) DONGIA_DOANHTHU, ISNULL(@hotro, 0.0) DONGIA_KHAC, ISNULL(@doanhthuKhongHT, 0.0) DONGIA_KHONGHT, isnull(@bhyt, '0') BHYT, ISNULL(@loaigia_id, 0) as LOAIGIA_ID, ISNULL(@loaigiakhonght_id, 0) as LOAIGIAKHONGHT_ID]
2020-02-26 16:09:43,966 [1] DEBUG - Statement Id: [DAO00000_GetDuocBHYT] PreparedStatement : [select count(*) BHYT FROM TM_DUOC A WHERE A.DUOC_ID = '1030' and BHYT = '1']
2020-02-26 16:09:45,189 [1] DEBUG - Statement Id: [DAO00000_GetCHECK_DOITUONG_BHYT] PreparedStatement : [select count(*) as DOITUONG_BHYT FROM TM_DOITUONG A            WHERE A.DOITUONG_ID = '4' and A.BENHVIEN_ID = 'HLU01' and MADOITUONG like '%BHYT%']
2020-02-26 16:09:45,279 [1] DEBUG - Statement Id: [DAO00000_GetLOAIGIATHUOC_NOI_NGOAI_VIEN] PreparedStatement : [SELECT LOAIGIA_ID              FROM TM_LOAIGIA              WHERE MALOAIGIA = 'GiaThuoc_NoiVien' and BENHVIEN_ID = 'HLU01']
2020-02-26 16:09:46,781 [1] DEBUG - Statement Id: [DAO00000_GetDUOC_DONGIADOANHTHU_NOIVIEN] PreparedStatement : [declare @doanhthuKhongHT numeric(24,2);          declare @doanhthu numeric(24,2);          declare @hotro numeric(24,2);          declare @bhyt char(1);          declare @loaigia_id int, @loaigiakhonght_id int            select top 1 @doanhthuKhongHT = dg.DONGIA, @loaigiakhonght_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0 and GIAHOTRO != '1'          order by dtlg.DOUUTIEN asc          select top 1 @doanhthu = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0           order by dtlg.DOUUTIEN asc          select top 1 @hotro = dg.DONGIA, @loaigia_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0  and GIAHOTRO = '1'          order by dtlg.DOUUTIEN asc          select top 1 @bhyt = BHYT from TM_DUOC where DUOC_ID = 1030          select ISNULL(@doanhthu,0.0) DONGIA_DOANHTHU, ISNULL(@hotro, 0.0) DONGIA_KHAC, ISNULL(@doanhthuKhongHT, 0.0) DONGIA_KHONGHT, isnull(@bhyt, '0') BHYT, ISNULL(@loaigia_id, 0) as LOAIGIA_ID, ISNULL(@loaigiakhonght_id, 0) as LOAIGIAKHONGHT_ID]
2020-02-26 16:09:48,919 [1] DEBUG - Statement Id: [DAO00000_GetDuocBHYT] PreparedStatement : [select count(*) BHYT FROM TM_DUOC A WHERE A.DUOC_ID = '1030' and BHYT = '1']
2020-02-26 16:09:58,396 [1] DEBUG - Statement Id: [DAO00030_Get_DuocCanhBaoICD_ByBenhAn_ID] PreparedStatement : [select A.*          from TM_DUOC_CANHBAO_ICD A          inner join TM_DUOC_HOATCHAT B on B.HOATCHAT_ID = A.HOATCHAT_ID          inner join TM_DUOC_THANHPHANHOATCHAT C on C.HOATCHAT_ID = B.HOATCHAT_ID          inner join TM_DUOC D on D.DUOC_ID = C.DUOC_ID          inner join TT_NOITRU_BENHAN BA on (BA.ICD_VAOKHOA = A.ICD_ID or BA.ICD_KHAMBENH = A.ICD_ID or BA.ICD_BENHCHINH = A.ICD_ID or BA.ICDRAVIEN_CHINH = A.ICD_ID          or A.MAICD in (select part from fnSplit(BA.ICD_BENHPHU, ';'))           or A.MAICD in (select part from fnSplit(BA.ICDRAVIEN_PHU, ';'))          or A.MAICD in (select part from fnSplit(BA.ICD_PHU_VAOKHOA, ';'))) and BA.BENHAN_ID = 24642          where C.DUOC_ID = 1030          and A.TAMNGUNG = '0'          and A.BENHVIEN_ID = 'HLU01']
2020-02-26 16:09:58,483 [1] DEBUG - Statement Id: [DAO00013_GetTienSuBenh] PreparedStatement : [select TIENSUBENH, TIENSUDIUNG        from TT_BENHNHAN        where TT_BENHNHAN.BENHNHAN_ID  = '20633']
2020-02-26 16:09:58,605 [1] DEBUG - Statement Id: [DAO00095_GetTTDiUngThuoc] PreparedStatement : [select *              from TT_BENHNHAN_DIUNG_THUOC              where BENHNHAN_ID = '20633'              and BENHVIEN_ID = 'HLU01']
2020-02-26 16:09:58,628 [1] DEBUG - Statement Id: [DAO00096_GetList] PreparedStatement : [select *        from TM_DUOC_THANHPHANHOATCHAT        where BENHVIEN_ID = 'HLU01']
2020-02-26 16:09:58,656 [1] DEBUG - Statement Id: [DAO00013_GetTienSuBenh] PreparedStatement : [select TIENSUBENH, TIENSUDIUNG        from TT_BENHNHAN        where TT_BENHNHAN.BENHNHAN_ID  = '20633']
2020-02-26 16:09:58,682 [1] DEBUG - Statement Id: [DAO00095_GetTTDiUngThuoc] PreparedStatement : [select *              from TT_BENHNHAN_DIUNG_THUOC              where BENHNHAN_ID = '20633'              and BENHVIEN_ID = 'HLU01']
2020-02-26 16:09:58,707 [1] DEBUG - Statement Id: [DAO00016_GetTTDuocCanhBao] PreparedStatement : [select *        from TM_DUOC_CANHBAO         where                 DUOC_ID = '1030'             and               BENHVIEN_ID = 'HLU01'                     order by DUOC_CANHBAO_ID]
2020-02-26 16:09:58,735 [1] DEBUG - Statement Id: [DAO00000_GetCHECK_DOITUONG_BHYT] PreparedStatement : [select count(*) as DOITUONG_BHYT FROM TM_DOITUONG A            WHERE A.DOITUONG_ID = '4' and A.BENHVIEN_ID = 'HLU01' and MADOITUONG like '%BHYT%']
2020-02-26 16:09:58,759 [1] DEBUG - Statement Id: [DAO00000_GetLOAIGIATHUOC_NOI_NGOAI_VIEN] PreparedStatement : [SELECT LOAIGIA_ID              FROM TM_LOAIGIA              WHERE MALOAIGIA = 'GiaThuoc_NoiVien' and BENHVIEN_ID = 'HLU01']
2020-02-26 16:09:59,524 [1] DEBUG - Statement Id: [DAO00000_GetDUOC_DONGIADOANHTHU_NOIVIEN] PreparedStatement : [declare @doanhthuKhongHT numeric(24,2);          declare @doanhthu numeric(24,2);          declare @hotro numeric(24,2);          declare @bhyt char(1);          declare @loaigia_id int, @loaigiakhonght_id int            select top 1 @doanhthuKhongHT = dg.DONGIA, @loaigiakhonght_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0 and GIAHOTRO != '1'          order by dtlg.DOUUTIEN asc          select top 1 @doanhthu = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0           order by dtlg.DOUUTIEN asc          select top 1 @hotro = dg.DONGIA, @loaigia_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0  and GIAHOTRO = '1'          order by dtlg.DOUUTIEN asc          select top 1 @bhyt = BHYT from TM_DUOC where DUOC_ID = 1030          select ISNULL(@doanhthu,0.0) DONGIA_DOANHTHU, ISNULL(@hotro, 0.0) DONGIA_KHAC, ISNULL(@doanhthuKhongHT, 0.0) DONGIA_KHONGHT, isnull(@bhyt, '0') BHYT, ISNULL(@loaigia_id, 0) as LOAIGIA_ID, ISNULL(@loaigiakhonght_id, 0) as LOAIGIAKHONGHT_ID]
2020-02-26 16:10:00,241 [1] DEBUG - Statement Id: [DAO00000_GetDuocBHYT] PreparedStatement : [select count(*) BHYT FROM TM_DUOC A WHERE A.DUOC_ID = '1030' and BHYT = '1']
2020-02-26 16:10:01,222 [1] DEBUG - Statement Id: [DAO00000_GetCHECK_DOITUONG_BHYT] PreparedStatement : [select count(*) as DOITUONG_BHYT FROM TM_DOITUONG A            WHERE A.DOITUONG_ID = '4' and A.BENHVIEN_ID = 'HLU01' and MADOITUONG like '%BHYT%']
2020-02-26 16:10:01,275 [1] DEBUG - Statement Id: [DAO00000_GetLOAIGIATHUOC_NOI_NGOAI_VIEN] PreparedStatement : [SELECT LOAIGIA_ID              FROM TM_LOAIGIA              WHERE MALOAIGIA = 'GiaThuoc_NoiVien' and BENHVIEN_ID = 'HLU01']
2020-02-26 16:10:02,443 [1] DEBUG - Statement Id: [DAO00000_GetDUOC_DONGIADOANHTHU_NOIVIEN] PreparedStatement : [declare @doanhthuKhongHT numeric(24,2);          declare @doanhthu numeric(24,2);          declare @hotro numeric(24,2);          declare @bhyt char(1);          declare @loaigia_id int, @loaigiakhonght_id int            select top 1 @doanhthuKhongHT = dg.DONGIA, @loaigiakhonght_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0 and GIAHOTRO != '1'          order by dtlg.DOUUTIEN asc          select top 1 @doanhthu = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0           order by dtlg.DOUUTIEN asc          select top 1 @hotro = dg.DONGIA, @loaigia_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0  and GIAHOTRO = '1'          order by dtlg.DOUUTIEN asc          select top 1 @bhyt = BHYT from TM_DUOC where DUOC_ID = 1030          select ISNULL(@doanhthu,0.0) DONGIA_DOANHTHU, ISNULL(@hotro, 0.0) DONGIA_KHAC, ISNULL(@doanhthuKhongHT, 0.0) DONGIA_KHONGHT, isnull(@bhyt, '0') BHYT, ISNULL(@loaigia_id, 0) as LOAIGIA_ID, ISNULL(@loaigiakhonght_id, 0) as LOAIGIAKHONGHT_ID]
2020-02-26 16:10:04,036 [1] DEBUG - Statement Id: [DAO00000_GetDuocBHYT] PreparedStatement : [select count(*) BHYT FROM TM_DUOC A WHERE A.DUOC_ID = '1030' and BHYT = '1']
2020-02-26 16:10:14,014 [1] DEBUG - Statement Id: [DAO00062_GetThongTinNhapVienCuaBenhNhan] PreparedStatement : [select top 1 ba.THOIGIANVAOKHOA THOIGIANVAO        from TT_NOITRU_BENHAN ba        where ba.BENHAN_ID =  @param0]
2020-02-26 16:10:14,014 [1] DEBUG - Statement Id: [DAO00062_GetThongTinNhapVienCuaBenhNhan] Parameters: [@param0=[BENHAN_ID,24642]]
2020-02-26 16:10:14,014 [1] DEBUG - Statement Id: [DAO00062_GetThongTinNhapVienCuaBenhNhan] Types: [@param0=[Int64, System.Int64]]
2020-02-26 16:10:14,049 [1] DEBUG - Statement Id: [DAO00014_GetInPatientStatus] PreparedStatement : [select TRANGTHAI, isnull(KHOACHUYENDEN_ID, KHOAVAO_ID) as KHOAHIENTAI from TT_NOITRU_BENHAN        where        TIEPNHAN_ID = '107181'        and BENHVIEN_ID = 'HLU01'         and           BENHAN_ID = '24642']
2020-02-26 16:10:16,058 [1] DEBUG - Statement Id: [DAO00000_GetCHECK_DOITUONG_BHYT] PreparedStatement : [select count(*) as DOITUONG_BHYT FROM TM_DOITUONG A            WHERE A.DOITUONG_ID = '4' and A.BENHVIEN_ID = 'HLU01' and MADOITUONG like '%BHYT%']
2020-02-26 16:10:16,088 [1] DEBUG - Statement Id: [DAO00000_GetLOAIGIATHUOC_NOI_NGOAI_VIEN] PreparedStatement : [SELECT LOAIGIA_ID              FROM TM_LOAIGIA              WHERE MALOAIGIA = 'GiaThuoc_NoiVien' and BENHVIEN_ID = 'HLU01']
2020-02-26 16:10:17,571 [1] DEBUG - Statement Id: [DAO00000_GetDUOC_DONGIADOANHTHU_NOIVIEN] PreparedStatement : [declare @doanhthuKhongHT numeric(24,2);          declare @doanhthu numeric(24,2);          declare @hotro numeric(24,2);          declare @bhyt char(1);          declare @loaigia_id int, @loaigiakhonght_id int            select top 1 @doanhthuKhongHT = dg.DONGIA, @loaigiakhonght_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0 and GIAHOTRO != '1'          order by dtlg.DOUUTIEN asc          select top 1 @doanhthu = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0           order by dtlg.DOUUTIEN asc          select top 1 @hotro = dg.DONGIA, @loaigia_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0  and GIAHOTRO = '1'          order by dtlg.DOUUTIEN asc          select top 1 @bhyt = BHYT from TM_DUOC where DUOC_ID = 1030          select ISNULL(@doanhthu,0.0) DONGIA_DOANHTHU, ISNULL(@hotro, 0.0) DONGIA_KHAC, ISNULL(@doanhthuKhongHT, 0.0) DONGIA_KHONGHT, isnull(@bhyt, '0') BHYT, ISNULL(@loaigia_id, 0) as LOAIGIA_ID, ISNULL(@loaigiakhonght_id, 0) as LOAIGIAKHONGHT_ID]
2020-02-26 16:10:19,442 [1] DEBUG - Statement Id: [DAO00000_GetDuocBHYT] PreparedStatement : [select count(*) BHYT FROM TM_DUOC A WHERE A.DUOC_ID = '1030' and BHYT = '1']
2020-02-26 16:10:23,616 [1] DEBUG - Statement Id: [DAO00000_GetCHECK_DOITUONG_BHYT] PreparedStatement : [select count(*) as DOITUONG_BHYT FROM TM_DOITUONG A            WHERE A.DOITUONG_ID = '4' and A.BENHVIEN_ID = 'HLU01' and MADOITUONG like '%BHYT%']
2020-02-26 16:10:23,640 [1] DEBUG - Statement Id: [DAO00000_GetLOAIGIATHUOC_NOI_NGOAI_VIEN] PreparedStatement : [SELECT LOAIGIA_ID              FROM TM_LOAIGIA              WHERE MALOAIGIA = 'GiaThuoc_NoiVien' and BENHVIEN_ID = 'HLU01']
2020-02-26 16:10:24,841 [1] DEBUG - Statement Id: [DAO00000_GetDUOC_DONGIADOANHTHU_NOIVIEN] PreparedStatement : [declare @doanhthuKhongHT numeric(24,2);          declare @doanhthu numeric(24,2);          declare @hotro numeric(24,2);          declare @bhyt char(1);          declare @loaigia_id int, @loaigiakhonght_id int            select top 1 @doanhthuKhongHT = dg.DONGIA, @loaigiakhonght_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0 and GIAHOTRO != '1'          order by dtlg.DOUUTIEN asc          select top 1 @doanhthu = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0           order by dtlg.DOUUTIEN asc          select top 1 @hotro = dg.DONGIA, @loaigia_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0  and GIAHOTRO = '1'          order by dtlg.DOUUTIEN asc          select top 1 @bhyt = BHYT from TM_DUOC where DUOC_ID = 1030          select ISNULL(@doanhthu,0.0) DONGIA_DOANHTHU, ISNULL(@hotro, 0.0) DONGIA_KHAC, ISNULL(@doanhthuKhongHT, 0.0) DONGIA_KHONGHT, isnull(@bhyt, '0') BHYT, ISNULL(@loaigia_id, 0) as LOAIGIA_ID, ISNULL(@loaigiakhonght_id, 0) as LOAIGIAKHONGHT_ID]
2020-02-26 16:10:26,108 [1] DEBUG - Statement Id: [DAO00000_GetDuocBHYT] PreparedStatement : [select count(*) BHYT FROM TM_DUOC A WHERE A.DUOC_ID = '1030' and BHYT = '1']
2020-02-26 16:10:27,980 [1] DEBUG - Statement Id: [DAO00030_GetKhoDuocByPhamVi] PreparedStatement : [SELECT DISTINCT mp.KHODUOC_ID, lk.DICTIONARY_CODE as LOAIKHO          FROM TM_DUOC_PHAMVISD_MAPPING mp          INNER JOIN TM_KHODUOC kd on kd.KHODUOC_ID = mp.KHODUOC_ID          INNER JOIN LST_DICTIONARY lk on lk.DICTIONARY_ID = kd.LOAIKHO_ID          WHERE          mp.PHAMVI_ID = 1027          AND mp.BENHVIEN_ID ='HLU01'          AND mp.TAMNGUNG = '0']
2020-02-26 16:10:28,069 [1] DEBUG - Statement Id: [DAO00063_KiemtraSoluongDuocXuat] PreparedStatement : [select A.TONKHO, isnull(B.BOOK_NGOAI,0) BOOK_NGOAI, isnull(D.BOOK_NOI,0) BOOK_NOI, isnull(C.BOOK_NOI_THUOC,0) BOOK_NOI_THUOC, (A.TONKHO - isnull(B.BOOK_NGOAI,0) - isnull(D.BOOK_NOI,0)) TONKHO_BOOK        from(        select SUM(tk.SOLUONG) TONKHO, tk.DUOC_ID, sd.PHAMVI_ID, tk.NGUONDUOC_ID from TT_DUOC_TONKHO tk        inner join TM_DUOC_PHAMVISD_MAPPING sd on sd.KHODUOC_ID = tk.KHODUOC_ID        where sd.PHAMVI_ID  = '1027' and tk.DUOC_ID = '1030' and tk.NGUONDUOC_ID = '1'        group by tk.DUOC_ID, sd.PHAMVI_ID, tk.NGUONDUOC_ID) A        left join (        select SUM(SOLUONG) BOOK_NGOAI,DUOC_ID, PHAMVI_ID, NGUONHANG_ID from TT_DUOC_TONKHO_BOOK_NGOAITRU        where PHAMVI_ID  = '1027' and DUOC_ID = '1030' and NGUONHANG_ID = '1' and TRANGTHAI = 'HIEULUC'  and SOLUONG > 0        group by DUOC_ID, PHAMVI_ID, NGUONHANG_ID) B on A.DUOC_ID = B.DUOC_ID and A.PHAMVI_ID = B.PHAMVI_ID and A.NGUONDUOC_ID = B.NGUONHANG_ID        left join (        select SUM(SOLUONG) BOOK_NOI_THUOC,DUOC_ID, PHAMVI_ID, NGUONHANG_ID from TT_DUOC_TONKHO_BOOK_NOITRU        where PHAMVI_ID  = '1027' and DUOC_ID = '1030' and NGUONHANG_ID = '1' and REF_ID = '' and REF_TABLE = 'TT_NOITRU_TOATHUOC' and TRANGTHAI = 'HIEULUC' and SOLUONG > 0        group by DUOC_ID, PHAMVI_ID, NGUONHANG_ID) C on A.DUOC_ID = C.DUOC_ID and A.PHAMVI_ID = C.PHAMVI_ID and A.NGUONDUOC_ID = C.NGUONHANG_ID        left join (        select SUM(SOLUONG) BOOK_NOI,DUOC_ID, PHAMVI_ID, NGUONHANG_ID from TT_DUOC_TONKHO_BOOK_NOITRU        where PHAMVI_ID  = '1027' and DUOC_ID = '1030' and NGUONHANG_ID = '1' and TRANGTHAI = 'HIEULUC'  and SOLUONG > 0        group by DUOC_ID, PHAMVI_ID, NGUONHANG_ID) D on A.DUOC_ID = D.DUOC_ID and A.PHAMVI_ID = D.PHAMVI_ID and A.NGUONDUOC_ID = D.NGUONHANG_ID]
2020-02-26 16:10:28,108 [1] DEBUG - Statement Id: [DAO00063_KiemtraSoluongDuocXuat] PreparedStatement : [select A.TONKHO, isnull(B.BOOK_NGOAI,0) BOOK_NGOAI, isnull(D.BOOK_NOI,0) BOOK_NOI, isnull(C.BOOK_NOI_THUOC,0) BOOK_NOI_THUOC, (A.TONKHO - isnull(B.BOOK_NGOAI,0) - isnull(D.BOOK_NOI,0)) TONKHO_BOOK        from(        select SUM(tk.SOLUONG) TONKHO, tk.DUOC_ID, sd.PHAMVI_ID, tk.NGUONDUOC_ID from TT_DUOC_TONKHO tk        inner join TM_DUOC_PHAMVISD_MAPPING sd on sd.KHODUOC_ID = tk.KHODUOC_ID        where sd.PHAMVI_ID  = '1027' and tk.DUOC_ID = '1030' and tk.NGUONDUOC_ID = '1'        group by tk.DUOC_ID, sd.PHAMVI_ID, tk.NGUONDUOC_ID) A        left join (        select SUM(SOLUONG) BOOK_NGOAI,DUOC_ID, PHAMVI_ID, NGUONHANG_ID from TT_DUOC_TONKHO_BOOK_NGOAITRU        where PHAMVI_ID  = '1027' and DUOC_ID = '1030' and NGUONHANG_ID = '1' and TRANGTHAI = 'HIEULUC'  and SOLUONG > 0        group by DUOC_ID, PHAMVI_ID, NGUONHANG_ID) B on A.DUOC_ID = B.DUOC_ID and A.PHAMVI_ID = B.PHAMVI_ID and A.NGUONDUOC_ID = B.NGUONHANG_ID        left join (        select SUM(SOLUONG) BOOK_NOI_THUOC,DUOC_ID, PHAMVI_ID, NGUONHANG_ID from TT_DUOC_TONKHO_BOOK_NOITRU        where PHAMVI_ID  = '1027' and DUOC_ID = '1030' and NGUONHANG_ID = '1' and REF_ID = '' and REF_TABLE = 'TT_NOITRU_TOATHUOC' and TRANGTHAI = 'HIEULUC' and SOLUONG > 0        group by DUOC_ID, PHAMVI_ID, NGUONHANG_ID) C on A.DUOC_ID = C.DUOC_ID and A.PHAMVI_ID = C.PHAMVI_ID and A.NGUONDUOC_ID = C.NGUONHANG_ID        left join (        select SUM(SOLUONG) BOOK_NOI,DUOC_ID, PHAMVI_ID, NGUONHANG_ID from TT_DUOC_TONKHO_BOOK_NOITRU        where PHAMVI_ID  = '1027' and DUOC_ID = '1030' and NGUONHANG_ID = '1' and TRANGTHAI = 'HIEULUC'  and SOLUONG > 0        group by DUOC_ID, PHAMVI_ID, NGUONHANG_ID) D on A.DUOC_ID = D.DUOC_ID and A.PHAMVI_ID = D.PHAMVI_ID and A.NGUONDUOC_ID = D.NGUONHANG_ID]
2020-02-26 16:10:28,140 [1] DEBUG - Statement Id: [DAOLOG01_LockBegin] PreparedStatement : [INSERT into TT_LOG_UPDATE ( REF_TABLE , REF_ID , BENHVIEN_ID )         values ( @param0 ,  @param1 ,  @param2 );]
2020-02-26 16:10:28,141 [1] DEBUG - Statement Id: [DAOLOG01_LockBegin] Parameters: [@param0=[REF_TABLE,TT_NOITRU_KHAMBENH], @param1=[REF_ID,24642], @param2=[BENHVIEN_ID,HLU01]]
2020-02-26 16:10:28,141 [1] DEBUG - Statement Id: [DAOLOG01_LockBegin] Types: [@param0=[String, System.String], @param1=[Int64, System.Int64], @param2=[String, System.String]]
2020-02-26 16:10:28,363 [1] DEBUG - Statement Id: [DAO00026_GEN_EXAM_KEY] PreparedStatement : [select max(KEYVALUE) KEYVALUE              from LST_KEYDATA_TOATHUOC               where                             LST_KEYDATA_TOATHUOC.KEYTYPE = 'SOTHUTUTOA_NOITRU'                       and                           LST_KEYDATA_TOATHUOC.KEYYEAR = '2020'                       and                           LST_KEYDATA_TOATHUOC.KEYMONTH = '2'                       and                           LST_KEYDATA_TOATHUOC.KEYDAY = '26']
2020-02-26 16:10:28,417 [1] DEBUG - Statement Id: [DAO00026_Update] PreparedStatement : [IF EXISTS (select KEYTYPE from LST_KEYDATA_TOATHUOC where KEYTYPE = 'SOTHUTUTOA_NOITRU' AND KEYYEAR = '2020' AND KEYMONTH = '2' AND KEYDAY = '26')            BEGIN            update LST_KEYDATA_TOATHUOC set            KEYVALUE =  @param0             where            KEYTYPE = 'SOTHUTUTOA_NOITRU'            AND KEYYEAR = '2020'            AND KEYMONTH = '2'            AND KEYDAY = '26'            AND SEGMENT_1 = '0'            AND SEGMENT_2 = '0'            AND SEGMENT_3 = '0'            END            ELSE            BEGIN            insert into LST_KEYDATA_TOATHUOC (            KEYTYPE            , KEYYEAR            , KEYMONTH            , KEYDAY            , SEGMENT_1            , SEGMENT_2            , SEGMENT_3            , KEYVALUE            ) values (             @param1             ,  @param2             ,  @param3             ,  @param4             ,  @param5             ,  @param6             ,  @param7             ,  @param0             )            END]
2020-02-26 16:10:28,418 [1] DEBUG - Statement Id: [DAO00026_Update] Parameters: [@param0=[KEYVALUE,0003], @param1=[KEYTYPE,SOTHUTUTOA_NOITRU], @param2=[KEYYEAR,2020], @param3=[KEYMONTH,2], @param4=[KEYDAY,26], @param5=[SEGMENT_1,0], @param6=[SEGMENT_2,0], @param7=[SEGMENT_3,0]]
2020-02-26 16:10:28,418 [1] DEBUG - Statement Id: [DAO00026_Update] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[Int32, System.Int32], @param3=[Int32, System.Int32], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[String, System.String], @param7=[String, System.String]]
2020-02-26 16:10:28,478 [1] DEBUG - Statement Id: [DAO00062_Add] PreparedStatement : [insert into TT_NOITRU_KHAMBENH (        BENHAN_ID        , LUUTRU_ID        , LANKHAM        , NGAYKHAM        , THOIGIANKHAM        , BACSIKHAM_ID        , PHONGBAN_ID        , DIEUDUONG_ID        , CAPHOLY_ID        , DOITUONG_ID        , PHATDO_DIEUTRI_ID        , DINHBENH        , DIENBIEN        , LOIDAN        , CHEDOANUONG_ID        , CHEDOCHAMSOC_ID        , PHANCAPCHAMSOC_ID        , CHUNGTUPHATTHUOC_ID        , KHODUOC_ID        , NOINHANTHUOC_ID        , LOAITOATHUOC        , THUOCDACTRI        , NGAYTAIKHAM        , SONGAYHENTAIKHAM        , RAVIEN        , ISTHUOCBV              , ISYLENHVTYT        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYCAPNHAT        , NGUOICAPNHAT_ID         ,           GHICHU_KHAMBENH         ,           GHICHU         ,           CHEDODINHDUONG         ,           MATOAMAU                 ) values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31          ,            @param32          ,            @param33          ,           @param34          ,            @param35                  )]
2020-02-26 16:10:28,478 [1] DEBUG - Statement Id: [DAO00062_Add] Parameters: [@param0=[BENHAN_ID,24642], @param1=[LUUTRU_ID,39529], @param2=[LANKHAM,1], @param3=[NGAYKHAM,2/26/2020 12:00:00 AM], @param4=[THOIGIANKHAM,2/26/2020 4:08:58 PM], @param5=[BACSIKHAM_ID,1], @param6=[PHONGBAN_ID,25], @param7=[DIEUDUONG_ID,null], @param8=[CAPHOLY_ID,null], @param9=[DOITUONG_ID,4], @param10=[PHATDO_DIEUTRI_ID,null], @param11=[DINHBENH,Theo dõi thai bình thường(Z34)], @param12=[DIENBIEN,ấdasd], @param13=[LOIDAN,null], @param14=[CHEDOANUONG_ID,null], @param15=[CHEDOCHAMSOC_ID,null], @param16=[PHANCAPCHAMSOC_ID,8588], @param17=[CHUNGTUPHATTHUOC_ID,null], @param18=[KHODUOC_ID,null], @param19=[NOINHANTHUOC_ID,null], @param20=[LOAITOATHUOC,YL], @param21=[THUOCDACTRI,0], @param22=[NGAYTAIKHAM,null], @param23=[SONGAYHENTAIKHAM,null], @param24=[RAVIEN,0], @param25=[ISTHUOCBV,1], @param26=[ISYLENHVTYT,0], @param27=[BENHVIEN_ID,HLU01], @param28=[NGAYTAO,2/26/2020 4:10:28 PM], @param29=[NGUOITAO_ID,1], @param30=[NGAYCAPNHAT,2/26/2020 4:10:28 PM], @param31=[NGUOICAPNHAT_ID,1], @param32=[GHICHU_KHAMBENH,null], @param33=[GHICHU_DICHVU,null], @param34=[CHEDODINHDUONG,null], @param35=[MATOAMAU,null]]
2020-02-26 16:10:28,478 [1] DEBUG - Statement Id: [DAO00062_Add] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64], @param2=[Int64, System.Int64], @param3=[DateTime, System.DateTime], @param4=[DateTime, System.DateTime], @param5=[Int64, System.Int64], @param6=[String, System.String], @param7=[System.DBNull, null], @param8=[System.DBNull, null], @param9=[Int64, System.Int64], @param10=[System.DBNull, null], @param11=[String, System.String], @param12=[String, System.String], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[String, System.String], @param21=[String, System.String], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[String, System.String], @param28=[DateTime, System.DateTime], @param29=[Int64, System.Int64], @param30=[DateTime, System.DateTime], @param31=[Int64, System.Int64], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null]]
2020-02-26 16:10:28,538 [1] DEBUG - Statement Id: [DAO00062_Add.SelectKey] PreparedStatement : [SELECT @@IDENTITY as value]
2020-02-26 16:10:28,575 [1] DEBUG - Statement Id: [DAO00062_GetKhoThuocCosoKhongCoso] PreparedStatement : [select distinct kd.KHODUOC_ID, lst.DICTIONARY_CODE  LOAIKHO from TM_KHODUOC kd        left join TM_PHONGBAN_KHODUOC pbkd        on kd.KHODUOC_ID = pbkd.KHODUOC_ID        and kd.BENHVIEN_ID = pbkd.BENHVIEN_ID        left join LST_DICTIONARY lst on lst.DICTIONARY_ID = kd.LOAIKHO_ID        where lst.DICTIONARY_CODE = 'Coso']
2020-02-26 16:10:28,601 [1] DEBUG - Statement Id: [DAO00062_GetAllPhamviKhoDuoc] PreparedStatement : [select distinct dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        left join TM_DUOC_PHAMVISUDUNG dpv on dpv.PHAMVI_ID = dmap.PHAMVI_ID]
2020-02-26 16:10:28,805 [1] DEBUG - Statement Id: [DAO00023_GetSOBHYT_HUONG_ID] PreparedStatement : [select isnull(MAX(SOBHYT_HUONG_ID),0) SOBHYT_HUONG_ID        from TT_TIEPNHAN_SOTHEBHYT        where TIEPNHAN_ID = '107181']
2020-02-26 16:10:31,646 [1] DEBUG - Statement Id: [DAO00000_GetCHECK_DOITUONG_BHYT] PreparedStatement : [select count(*) as DOITUONG_BHYT FROM TM_DOITUONG A            WHERE A.DOITUONG_ID = '4' and A.BENHVIEN_ID = 'HLU01' and MADOITUONG like '%BHYT%']
2020-02-26 16:10:31,673 [1] DEBUG - Statement Id: [DAO00000_GetLOAIGIATHUOC_NOI_NGOAI_VIEN] PreparedStatement : [SELECT LOAIGIA_ID              FROM TM_LOAIGIA              WHERE MALOAIGIA = 'GiaThuoc_NoiVien' and BENHVIEN_ID = 'HLU01']
2020-02-26 16:10:33,312 [1] DEBUG - Statement Id: [DAO00000_GetDUOC_DONGIADOANHTHU_NOIVIEN] PreparedStatement : [declare @doanhthuKhongHT numeric(24,2);          declare @doanhthu numeric(24,2);          declare @hotro numeric(24,2);          declare @bhyt char(1);          declare @loaigia_id int, @loaigiakhonght_id int            select top 1 @doanhthuKhongHT = dg.DONGIA, @loaigiakhonght_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0 and GIAHOTRO != '1'          order by dtlg.DOUUTIEN asc          select top 1 @doanhthu = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0           order by dtlg.DOUUTIEN asc          select top 1 @hotro = dg.DONGIA, @loaigia_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0  and GIAHOTRO = '1'          order by dtlg.DOUUTIEN asc          select top 1 @bhyt = BHYT from TM_DUOC where DUOC_ID = 1030          select ISNULL(@doanhthu,0.0) DONGIA_DOANHTHU, ISNULL(@hotro, 0.0) DONGIA_KHAC, ISNULL(@doanhthuKhongHT, 0.0) DONGIA_KHONGHT, isnull(@bhyt, '0') BHYT, ISNULL(@loaigia_id, 0) as LOAIGIA_ID, ISNULL(@loaigiakhonght_id, 0) as LOAIGIAKHONGHT_ID]
2020-02-26 16:10:34,534 [1] DEBUG - Statement Id: [DAO00000_GetDuocBHYT] PreparedStatement : [select count(*) BHYT FROM TM_DUOC A WHERE A.DUOC_ID = '1030' and BHYT = '1']
2020-02-26 16:10:51,820 [1] DEBUG - Statement Id: [DAO00000_GetCHECK_DOITUONG_BHYT] PreparedStatement : [select count(*) as DOITUONG_BHYT FROM TM_DOITUONG A            WHERE A.DOITUONG_ID = '4' and A.BENHVIEN_ID = 'HLU01' and MADOITUONG like '%BHYT%']
2020-02-26 16:10:51,844 [1] DEBUG - Statement Id: [DAO00000_GetLOAIGIATHUOC_NOI_NGOAI_VIEN] PreparedStatement : [SELECT LOAIGIA_ID              FROM TM_LOAIGIA              WHERE MALOAIGIA = 'GiaThuoc_NoiVien' and BENHVIEN_ID = 'HLU01']
2020-02-26 16:10:53,301 [1] DEBUG - Statement Id: [DAO00000_GetDUOC_DONGIADOANHTHU_NOIVIEN] PreparedStatement : [declare @doanhthuKhongHT numeric(24,2);          declare @doanhthu numeric(24,2);          declare @hotro numeric(24,2);          declare @bhyt char(1);          declare @loaigia_id int, @loaigiakhonght_id int            select top 1 @doanhthuKhongHT = dg.DONGIA, @loaigiakhonght_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0 and GIAHOTRO != '1'          order by dtlg.DOUUTIEN asc          select top 1 @doanhthu = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0           order by dtlg.DOUUTIEN asc          select top 1 @hotro = dg.DONGIA, @loaigia_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0  and GIAHOTRO = '1'          order by dtlg.DOUUTIEN asc          select top 1 @bhyt = BHYT from TM_DUOC where DUOC_ID = 1030          select ISNULL(@doanhthu,0.0) DONGIA_DOANHTHU, ISNULL(@hotro, 0.0) DONGIA_KHAC, ISNULL(@doanhthuKhongHT, 0.0) DONGIA_KHONGHT, isnull(@bhyt, '0') BHYT, ISNULL(@loaigia_id, 0) as LOAIGIA_ID, ISNULL(@loaigiakhonght_id, 0) as LOAIGIAKHONGHT_ID]
2020-02-26 16:10:54,498 [1] DEBUG - Statement Id: [DAO00000_GetDuocBHYT] PreparedStatement : [select count(*) BHYT FROM TM_DUOC A WHERE A.DUOC_ID = '1030' and BHYT = '1']
2020-02-26 16:11:16,471 [1] DEBUG - Statement Id: [DAO00063_Add_YLenhThuoc] PreparedStatement : [declare @jsonVienPhi nvarchar(max);        set @jsonVienPhi = N'{        "DATA": [{"TRATHUOCCHITIET_ID":null,"DALAPPHIEULINH":false,"DAPHATSINHCHUNGTU":false,"DANHAPNOIBO":false,"DAXUATNOIBO":false,"UID":"6e968d0a-f599-42c3-ae91-0b05475da5c9","TOATHUOC_ID":null,"CLSKETQUA_ID":null,"VTYT_ID":null,"SOTHUTUTOA":"2002260003","MACHUNGTU":null,"KHAMBENH_ID":320500,"TIEPNHAN_ID":107181,"BENHNHAN_ID":20633,"DUOC_ID":1030,"SOLUONG":1.0,"SONGAY":1.0,"SOLANTRENNGAY":null,"SOLUONGTRENLAN":null,"SOLUONG_BUOISANG":null,"SOLUONG_BUOITRUA":null,"SOLUONG_BUOICHIEU":null,"SOLUONG_BUOITOI":null,"DUONGDUNG_ID":911,"GHICHU":"","NGUONDUOC_ID":1,"KHOSUDUNG_ID":null,"NGUONDUOC":null,"NGUONHANG_ID":1,"PHIEULINH_ID":null,"CHUNGTU_ID":null,"CHUNGTUTONGHOP_ID":null,"PHONGBANRATOA_ID":"25","PHONGBAN_ID":null,"NGUONLAYTHUOC":"D","COSO":"0","KHOPHAT_ID":1,"PHAMVI_ID":1027,"PHATTHUOCTAIQUAY":"0","ISUPDATED":false,"THOIGIANSUDUNG":null,"NGAYSUDUNG":null,"THOIGIANKHAM":null,"SOLUONGTAMNGUNG":0.0,"MUANGOAI":"0","YEUCAU":null,"PHOIHOP":null,"PHACHE":null,"ISVTYT":false,"ISHOACHAT":false,"TINHTIEN":"0","MIENPHI":"0","TRANGTHAI":"CHUAXUAT","HUYTOATHUOC":"0","BENHVIEN_ID":"HLU01","NGAYTAO":null,"NGUOITAO_ID":1,"NGAYCAPNHAT":null,"NGUOICAPNHAT_ID":1,"BHYTDONGTIEN":"0","KHONGTHUTIEN":"0","SOCHUNGTU":null,"SOPHIEULINH":null,"MATOATHUOC":null,"LOAITOATHUOC":null,"LOAIVATTU_ID":"T","TENTOATHUOC":null,"DIENGIAI":null,"TAMNGUNG":false,"DUOC_BHYT":true,"VIENPHI":{"VIENPHI_ID":0,"TIEPNHAN_ID":107181,"BENHNHAN_ID":null,"BENHAN_ID":24642,"KHAMBENH_ID":null,"REF_ID":null,"REF_TABLE":"TT_NOITRU_TOATHUOC","DICHVU_ID":null,"DUOC_ID":1030,"LOAI_CHIPHI":"TT","LOAIGIA_ID":5,"SOLUONG":0.0,"DONGIA_DOANHTHU":600.00,"THANHTIEN_DOANHTHU":600.00,"BHYT_TL":null,"BHYT_DONGIA":600.00,"BHYT_THANHTIEN":600.00,"BHYT_DONGIA_CHITRA":600.00,"BHYT_THANHTIEN_CHITRA":600.00,"BENHNHAN_PHAITHANHTOAN":0.00,"GIATRI_HOADON":null,"GIATRI_HOADON_DATHANHTOAN":null,"GIATRI_BIENLAI":null,"GIATRI_BIENLAI_DATHANHTOAN":null,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"GIATRI_THATTHU":null,"MIENGIAM_TL":null,"MIENGIAM_GIATRI":null,"NGANSACH_TL":null,"NGANSACH_GIATRI":null,"TAITRO_TL":null,"TAITRO_GIATRI":null,"BHTN_TL":null,"BHTN_DONGIA":null,"BHTN_THANHTIEN":null,"BHTN_DONGIA_CHITRA":null,"BHTN_THANHTIEN_CHITRA":null,"DUOCPHEPTHUCHIEN":null,"HUY":false,"DATHANHTOAN":false,"DATHUCHIEN":false,"KHONGTHUTIEN":false,"BHYTDONGTIEN":false,"HOADON_ID":null,"ACTIVE":null,"BENHVIEN_ID":"HLU01","NGUOITAO_ID":null,"NGAYTAO":null,"NGUOICAPNHAT_ID":null,"NGAYCAPNHAT":null,"TREN3NAM":false,"TREN5NAM":false},"STT":1,"KHOTAO_ID":"29","DONVITINH":null,"DUONGDUNG":"Tiêm","DAXUAT":false,"DATHANHTOAN":false,"BENHAN_ID":24642,"DAHOANTRA":0,"SLDAXUAT":0.0,"SLDATAMNGUNG":0.0,"CHUNGTUTRA_ID":null,"CHUNGTUCHITIET_ID":null,"NGUOICAPNHAT":null,"BHYT_DONGIA":null,"BHYT_THANHTIEN":null,"BHYT_DONGIA_CHITRA":null,"BHYT_THANHTIEN_CHITRA":null,"DONGIA_DOANHTHU":600.0,"THANHTIEN_DOANHTHU":600.0,"BookedSoLuong":0.0,"KHODUOC_ID":1,"CHUYENKHOA_ID":"25","DOTDIEUTRI_ID":null,"DOITUONG_HUONG_ID":4,"SOBHYT_HUONG_ID":111518},{"TRATHUOCCHITIET_ID":null,"DALAPPHIEULINH":false,"DAPHATSINHCHUNGTU":false,"DANHAPNOIBO":false,"DAXUATNOIBO":false,"UID":"f30a7eb0-7364-4764-bd0d-6b3034052e0b","TOATHUOC_ID":null,"CLSKETQUA_ID":null,"VTYT_ID":null,"SOTHUTUTOA":"2002260003","MACHUNGTU":null,"KHAMBENH_ID":320500,"TIEPNHAN_ID":107181,"BENHNHAN_ID":20633,"DUOC_ID":1030,"SOLUONG":1.0,"SONGAY":1.0,"SOLANTRENNGAY":null,"SOLUONGTRENLAN":null,"SOLUONG_BUOISANG":null,"SOLUONG_BUOITRUA":null,"SOLUONG_BUOICHIEU":null,"SOLUONG_BUOITOI":null,"DUONGDUNG_ID":911,"GHICHU":"","NGUONDUOC_ID":1,"KHOSUDUNG_ID":null,"NGUONDUOC":null,"NGUONHANG_ID":1,"PHIEULINH_ID":null,"CHUNGTU_ID":null,"CHUNGTUTONGHOP_ID":null,"PHONGBANRATOA_ID":"25","PHONGBAN_ID":null,"NGUONLAYTHUOC":"D","COSO":"0","KHOPHAT_ID":1,"PHAMVI_ID":1027,"PHATTHUOCTAIQUAY":"0","ISUPDATED":false,"THOIGIANSUDUNG":null,"NGAYSUDUNG":null,"THOIGIANKHAM":null,"SOLUONGTAMNGUNG":0.0,"MUANGOAI":"0","YEUCAU":null,"PHOIHOP":null,"PHACHE":null,"ISVTYT":false,"ISHOACHAT":false,"TINHTIEN":"0","MIENPHI":"0","TRANGTHAI":"CHUAXUAT","HUYTOATHUOC":"0","BENHVIEN_ID":"HLU01","NGAYTAO":null,"NGUOITAO_ID":1,"NGAYCAPNHAT":null,"NGUOICAPNHAT_ID":1,"BHYTDONGTIEN":"1","KHONGTHUTIEN":"0","SOCHUNGTU":null,"SOPHIEULINH":null,"MATOATHUOC":null,"LOAITOATHUOC":null,"LOAIVATTU_ID":"T","TENTOATHUOC":null,"DIENGIAI":null,"TAMNGUNG":false,"DUOC_BHYT":true,"VIENPHI":{"VIENPHI_ID":0,"TIEPNHAN_ID":107181,"BENHNHAN_ID":null,"BENHAN_ID":24642,"KHAMBENH_ID":null,"REF_ID":null,"REF_TABLE":"TT_NOITRU_TOATHUOC","DICHVU_ID":null,"DUOC_ID":1030,"LOAI_CHIPHI":"TT","LOAIGIA_ID":7,"SOLUONG":0.0,"DONGIA_DOANHTHU":1000.00,"THANHTIEN_DOANHTHU":1000.00,"BHYT_TL":null,"BHYT_DONGIA":0,"BHYT_THANHTIEN":0,"BHYT_DONGIA_CHITRA":0,"BHYT_THANHTIEN_CHITRA":0,"BENHNHAN_PHAITHANHTOAN":1000.00,"GIATRI_HOADON":null,"GIATRI_HOADON_DATHANHTOAN":null,"GIATRI_BIENLAI":null,"GIATRI_BIENLAI_DATHANHTOAN":null,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"GIATRI_THATTHU":null,"MIENGIAM_TL":null,"MIENGIAM_GIATRI":null,"NGANSACH_TL":null,"NGANSACH_GIATRI":null,"TAITRO_TL":null,"TAITRO_GIATRI":null,"BHTN_TL":null,"BHTN_DONGIA":null,"BHTN_THANHTIEN":null,"BHTN_DONGIA_CHITRA":null,"BHTN_THANHTIEN_CHITRA":null,"DUOCPHEPTHUCHIEN":null,"HUY":false,"DATHANHTOAN":false,"DATHUCHIEN":false,"KHONGTHUTIEN":false,"BHYTDONGTIEN":true,"HOADON_ID":null,"ACTIVE":null,"BENHVIEN_ID":"HLU01","NGUOITAO_ID":null,"NGAYTAO":null,"NGUOICAPNHAT_ID":null,"NGAYCAPNHAT":null,"TREN3NAM":false,"TREN5NAM":false},"STT":2,"KHOTAO_ID":"29","DONVITINH":null,"DUONGDUNG":"Tiêm","DAXUAT":false,"DATHANHTOAN":false,"BENHAN_ID":24642,"DAHOANTRA":0,"SLDAXUAT":0.0,"SLDATAMNGUNG":0.0,"CHUNGTUTRA_ID":null,"CHUNGTUCHITIET_ID":null,"NGUOICAPNHAT":null,"BHYT_DONGIA":null,"BHYT_THANHTIEN":null,"BHYT_DONGIA_CHITRA":null,"BHYT_THANHTIEN_CHITRA":null,"DONGIA_DOANHTHU":600.0,"THANHTIEN_DOANHTHU":600.0,"BookedSoLuong":0.0,"KHODUOC_ID":1,"CHUYENKHOA_ID":"25","DOTDIEUTRI_ID":null,"DOITUONG_HUONG_ID":4,"SOBHYT_HUONG_ID":111518}]        }';          declare @TOATHUOC_ID int;        declare @SOTHUTUTOA varchar(10);        declare @KHAMBENH_ID int;        declare @TIEPNHAN_ID int;        declare @BENHNHAN_ID int;        declare @NGUONDUOC_ID int;        declare @DUOC_ID int;        declare @SOLUONG numeric(18, 4);        declare @SONGAY numeric(4, 2);        declare @SOLANTRENNGAY numeric(4, 2);        declare @SOLUONGTRENLAN numeric(18, 4);        declare @SOLUONG_BUOISANG numeric(18, 4);        declare @SOLUONG_BUOITRUA numeric(18, 4);        declare @SOLUONG_BUOICHIEU numeric(18, 4);        declare @SOLUONG_BUOITOI numeric(18, 4);        declare @DUONGDUNG_ID int;        declare @COSO char(1);        declare @KHOTAO_ID int;        declare @KHOPHAT_ID int;        declare @GHICHU nvarchar(max);        declare @PHIEULINH_ID int;        declare @CHUNGTU_ID int;        declare @PHONGBANRATOA_ID int;        declare @NGUONLAYTHUOC char(1);        declare @VTYT char(1);        declare @PHATTHUOCTAIQUAY char(1);        declare @MUANGOAI char(1);        declare @TINHTIEN char(1);        declare @MIENPHI char(1);        declare @BHYTDONGTIEN char(1);        declare @KHONGTHUTIEN char(1);        declare @HUYTOATHUOC char(1);        declare @TRANGTHAI varchar(20);        declare @BENHVIEN_ID varchar(10);        declare @NGAYTAO datetime;        declare @NGUOITAO_ID int;        declare @NGAYCAPNHAT datetime;        declare @NGUOICAPNHAT_ID int;        declare @PHAMVI_ID int;        declare @CHEDODINHDUONG nvarchar(max);          declare @VIENPHI nvarchar(max);        declare @BENHAN_ID int =  @param0 ;        declare @DOTDIEUTRI_ID int;        declare @DONGIA_DOANHTHU numeric(25, 4);        declare @THANHTIEN_DOANHTHU numeric(25, 4);        declare @BHYT_DONGIA numeric(25, 4);        declare @BHYT_THANHTIEN numeric(25, 4);        declare @BHYT_DONGIA_CHITRA numeric(25, 4);        declare @BHYT_THANHTIEN_CHITRA numeric(25, 4);        declare @BENHNHAN_PHAITHANHTOAN numeric(25, 4);        declare @DOITUONG_HUONG_ID numeric(25, 4);        declare @SOBHYT_HUONG_ID numeric(25, 4);          declare @iTotal int =  @param1 ;        declare @icnt int = 0;        WHILE @iTotal > @icnt        BEGIN        declare @dyn_sql nvarchar(1000) = 'select @data = json_query(@json_dyn, ''' + CHAR(36) +'.DATA[' + cast(@icnt as varchar(10)) + ']'');'        declare @jsondatamax nvarchar(max);          exec sp_executesql @dyn_sql        , N'@json_dyn nvarchar(max), @data nvarchar(max) OUTPUT'        , @json_dyn = @jsonVienPhi        , @data = @jsondatamax OUTPUT          select        @SOTHUTUTOA =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.SOTHUTUTOA'),        @KHAMBENH_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.KHAMBENH_ID'),        @TIEPNHAN_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.TIEPNHAN_ID'),        @BENHNHAN_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.BENHNHAN_ID'),        @NGUONDUOC_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.NGUONDUOC_ID'),        @DUOC_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.DUOC_ID'),        @SOLUONG =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.SOLUONG'),        @SONGAY =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.SONGAY'),        @SOLANTRENNGAY =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.SOLANTRENNGAY'),        @SOLUONGTRENLAN =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.SOLUONGTRENLAN'),        @SOLUONG_BUOISANG =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.SOLUONG_BUOISANG'),        @SOLUONG_BUOITRUA =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.SOLUONG_BUOITRUA'),        @SOLUONG_BUOICHIEU =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.SOLUONG_BUOICHIEU'),        @SOLUONG_BUOITOI =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.SOLUONG_BUOITOI'),        @DUONGDUNG_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.DUONGDUNG_ID'),        @COSO =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.COSO'),        @KHOTAO_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.KHOTAO_ID'),        @KHOPHAT_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.KHOPHAT_ID'),        @GHICHU =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.GHICHU'),        @PHIEULINH_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.PHIEULINH_ID'),        @CHUNGTU_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.CHUNGTU_ID'),        @PHONGBANRATOA_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.PHONGBANRATOA_ID'),        @NGUONLAYTHUOC =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.NGUONLAYTHUOC'),        @VTYT =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.VTYT'),        @PHATTHUOCTAIQUAY =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.PHATTHUOCTAIQUAY'),        @MUANGOAI =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.MUANGOAI'),        @TINHTIEN =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.TINHTIEN'),        @MIENPHI =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.MIENPHI'),        @BHYTDONGTIEN =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.BHYTDONGTIEN'),        @KHONGTHUTIEN =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.KHONGTHUTIEN'),        @HUYTOATHUOC =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.HUYTOATHUOC'),        @TRANGTHAI =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.TRANGTHAI'),        @BENHVIEN_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.BENHVIEN_ID'),        @NGAYTAO =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.NGAYTAO'),        @NGUOITAO_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.NGUOITAO_ID'),        @NGAYCAPNHAT =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.NGAYCAPNHAT'),        @NGUOICAPNHAT_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.NGUOICAPNHAT_ID'),        @PHAMVI_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.PHAMVI_ID'),        @CHEDODINHDUONG =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.CHEDODINHDUONG'),        @DOTDIEUTRI_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.DOTDIEUTRI_ID'),        @DOITUONG_HUONG_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.DOITUONG_HUONG_ID'),        @SOBHYT_HUONG_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.SOBHYT_HUONG_ID'),                  @DONGIA_DOANHTHU =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.VIENPHI.DONGIA_DOANHTHU'),        @THANHTIEN_DOANHTHU =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.VIENPHI.THANHTIEN_DOANHTHU'),        @BHYT_DONGIA =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.VIENPHI.BHYT_DONGIA'),        @BHYT_THANHTIEN =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.VIENPHI.BHYT_THANHTIEN'),        @BHYT_DONGIA_CHITRA =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.VIENPHI.BHYT_DONGIA_CHITRA'),        @BHYT_THANHTIEN_CHITRA =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.VIENPHI.BHYT_THANHTIEN_CHITRA'),        @BENHNHAN_PHAITHANHTOAN =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.VIENPHI.BENHNHAN_PHAITHANHTOAN')        @LOAIGIA_ID = JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.VIENPHI.LOAIGIA_ID')          insert into TT_NOITRU_TOATHUOC        ([SOTHUTUTOA],[KHAMBENH_ID],[TIEPNHAN_ID],[BENHNHAN_ID],[NGUONDUOC_ID]        ,[DUOC_ID],[SOLUONG],[SONGAY],[SOLANTRENNGAY],[SOLUONGTRENLAN],[SOLUONG_BUOISANG],[SOLUONG_BUOITRUA],[SOLUONG_BUOICHIEU]        ,[SOLUONG_BUOITOI],[DUONGDUNG_ID],[COSO],[KHOTAO_ID],[KHOPHAT_ID],[GHICHU],[PHIEULINH_ID],[CHUNGTU_ID],[PHONGBANRATOA_ID]        ,[NGUONLAYTHUOC],[VTYT],[PHATTHUOCTAIQUAY],[MUANGOAI],[TINHTIEN],[MIENPHI],[BHYTDONGTIEN],[KHONGTHUTIEN],[HUYTOATHUOC]        ,[TRANGTHAI],[BENHVIEN_ID],[NGAYTAO],[NGUOITAO_ID],[NGAYCAPNHAT],[NGUOICAPNHAT_ID],[PHAMVI_ID],[CHEDODINHDUONG])        VALUES        (@SOTHUTUTOA,@KHAMBENH_ID,@TIEPNHAN_ID,@BENHNHAN_ID,@NGUONDUOC_ID        ,@DUOC_ID,@SOLUONG,@SONGAY,@SOLANTRENNGAY,@SOLUONGTRENLAN,@SOLUONG_BUOISANG,@SOLUONG_BUOITRUA,@SOLUONG_BUOICHIEU        ,@SOLUONG_BUOITOI,@DUONGDUNG_ID,@COSO,@KHOTAO_ID,@KHOPHAT_ID,@GHICHU,@PHIEULINH_ID,@CHUNGTU_ID,@PHONGBANRATOA_ID        ,@NGUONLAYTHUOC,@VTYT,@PHATTHUOCTAIQUAY,@MUANGOAI,@TINHTIEN,@MIENPHI,@BHYTDONGTIEN,@KHONGTHUTIEN,@HUYTOATHUOC        ,@TRANGTHAI,@BENHVIEN_ID,GETDATE(),@NGUOITAO_ID,GETDATE(),@NGUOICAPNHAT_ID,@PHAMVI_ID,@CHEDODINHDUONG)                set @TOATHUOC_ID = SCOPE_IDENTITY()                  INSERT INTO TT_VIENPHI        ([TIEPNHAN_ID],[BENHAN_ID]        ,[DOTDIEUTRI_ID],[BENHNHAN_ID],[KHAMBENH_ID],[REF_ID],[REF_TABLE],[DICHVU_ID],[DUOC_ID],[LOAI_CHIPHI]        ,[SOLUONG],[DONGIA_DOANHTHU],[THANHTIEN_DOANHTHU],[BHYT_DONGIA],[BHYT_THANHTIEN],[HUY],[DATHANHTOAN]        ,[DATHUCHIEN],[KHONGTHUTIEN],[BHYTDONGTIEN],[BENHVIEN_ID],[NGUOITAO_ID],[NGAYTAO],[NGUOICAPNHAT_ID],        [NGAYCAPNHAT], [DOITUONG_HUONG_ID], [SOBHYT_HUONG_ID], [BHYT_DONGIA_CHITRA], [BHYT_THANHTIEN_CHITRA], [BENHNHAN_PHAITHANHTOAN], [LOAIGIA_ID])        VALUES        (@TIEPNHAN_ID,@BENHAN_ID        ,@DOTDIEUTRI_ID,@BENHNHAN_ID,@KHAMBENH_ID,@TOATHUOC_ID,'TT_NOITRU_TOATHUOC',null,@DUOC_ID,'TT'        ,@SOLUONG,@DONGIA_DOANHTHU,@THANHTIEN_DOANHTHU,@BHYT_DONGIA,@BHYT_THANHTIEN,'0','0'        ,'0',@KHONGTHUTIEN,@BHYTDONGTIEN,@BENHVIEN_ID,@NGUOITAO_ID,GETDATE(),@NGUOICAPNHAT_ID,GETDATE(), @DOITUONG_HUONG_ID, @SOBHYT_HUONG_ID        ,@BHYT_DONGIA_CHITRA, @BHYT_THANHTIEN_CHITRA, @BENHNHAN_PHAITHANHTOAN, @LOAIGIA_ID)                  insert into TT_DUOC_TONKHO_BOOK_NOITRU        ([REF_TABLE],[REF_ID],[PHAMVI_ID],[KHODUOC_ID],[DUOC_ID],[SOLUONG],[NGUONHANG_ID],[CHUYENKHOA_ID]        ,[GHICHU],[BENHVIEN_ID],[NGAYTAO],[NGUOITAO_ID],[NGAYCAPNHAT],[NGUOICAPNHAT_ID], [TRANGTHAI], [NGAYHIEULUC])        VALUES        ('TT_NOITRU_TOATHUOC',@TOATHUOC_ID,@PHAMVI_ID,@KHOPHAT_ID,@DUOC_ID,@SOLUONG,@NGUONDUOC_ID,@PHONGBANRATOA_ID        ,@GHICHU,@BENHVIEN_ID,GETDATE(),@NGUOITAO_ID,GETDATE(),@NGUOICAPNHAT_ID, 'HIEULUC', GETDATE())          set @icnt = @icnt + 1;        END        select @TOATHUOC_ID]
2020-02-26 16:11:16,471 [1] DEBUG - Statement Id: [DAO00063_Add_YLenhThuoc] Parameters: [@param0=[BENHAN_ID,24642], @param1=[TOTAL_RECORD,2]]
2020-02-26 16:11:16,471 [1] DEBUG - Statement Id: [DAO00063_Add_YLenhThuoc] Types: [@param0=[Int64, System.Int64], @param1=[Int32, System.Int32]]
2020-02-26 16:11:17,639 [1] DEBUG - Statement Id: [DAOLOG01_LockEnd] PreparedStatement : [DELETE TT_LOG_UPDATE        where REF_TABLE = 'TT_NOITRU_KHAMBENH' and REF_ID = '24642' and BENHVIEN_ID = 'HLU01']
2020-02-26 16:11:17,992 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM98'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
--------------------------------------------------------------------------------
2020-02-26 16:16:54,647 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2020-02-26 16:16:55,216 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2020-02-26 16:16:55,252 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2020-02-26 16:16:55,719 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 16:16:55,959 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2020-02-26 16:17:09,248 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2020-02-26 16:17:09,274 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2020-02-26 16:17:11,157 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2020-02-26 16:17:11,258 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2020-02-26 16:17:12,383 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2020-02-26 16:17:12,680 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2020-02-26 16:17:12,843 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2020-02-26 16:17:13,079 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2020-02-26 16:17:13,162 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2020-02-26 16:17:13,243 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2020-02-26 16:17:13,339 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2020-02-26 16:17:13,424 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2020-02-26 16:17:13,531 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2020-02-26 16:17:14,110 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2020-02-26 16:17:14,145 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2020-02-26 16:17:14,217 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2020-02-26 16:17:14,247 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2020-02-26 16:17:15,141 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2020-02-26 16:17:15,327 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @NGUONDUOC_MACDINH varchar(5) = '0';        declare @TOAMUANGOAI int = 0;        select @NGUONDUOC_MACDINH = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'PHA_NGUONDUOC'        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + @NGUONDUOC_MACDINH as DUOC_KEY, 0 as PHAMVI_ID, @NGUONDUOC_MACDINH as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end        else        begin                select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (        select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID)        B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (        select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID)        A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2020-02-26 16:17:16,779 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2020-02-26 16:17:16,811 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,        SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH        FROM TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID        WHERE TK.SOLUONG > 0        GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2020-02-26 16:17:16,897 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2020-02-26 16:17:16,950 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,        TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,        TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH        from TM_MAU M        JOIN        (        select        A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO        from        (        select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO        from TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'        where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0        ) A        )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2020-02-26 16:17:17,073 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2020-02-26 16:17:18,422 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 16:17:19,960 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2020-02-26 16:17:25,938 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2020-02-26 16:17:25,989 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2020-02-26 16:17:26,080 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 16:17:26,221 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 16:17:26,380 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2020-02-26 16:17:26,382 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2020-02-26 16:17:26,382 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2020-02-26 16:17:26,419 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2020-02-26 16:17:26,419 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2020-02-26 16:17:26,420 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2020-02-26 16:17:26,598 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 16:17:26,806 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 16:17:36,914 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 16:17:37,108 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2020-02-26 16:17:37,524 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2020-02-26 16:18:26,025 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'IPD02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 16:18:26,436 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'IPD40'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 16:18:26,689 [1] DEBUG - Statement Id: [DAO00069_GetCountDanhSachNoiTru] PreparedStatement : [select count(A.SOBENHAN) as TOTALROWS        from TT_NOITRU_BENHAN A        inner join TT_TIEPNHAN B on B.TIEPNHAN_ID = A.TIEPNHAN_ID and (B.TRANGTHAI = 'NOITRU' or B.TRANGTHAI = 'HOANTHANH')        inner join TT_BENHNHAN C on C.BENHNHAN_ID = B.BENHNHAN_ID        left join TT_NOITRU_LUUTRU D on D.BENHAN_ID = A.BENHAN_ID        and D.LUUTRU_ID = ( select top 1 LUUTRU_ID from TT_NOITRU_LUUTRU where BENHAN_ID = A.BENHAN_ID order by BENHAN_ID desc)        left join TT_NOITRU_XACNHAN E on E.BENHAN_ID = A.BENHAN_ID        left join TT_NOITRU_LUUTRUCHITIET F on D.LUUTRU_ID = F.LUUTRU_ID and F.LUUTRUCHITIET_CURRENT = '1'        and F.LUUTRUCHITIET_ID in (select top 1 LUUTRUCHITIET_ID from TT_NOITRU_LUUTRUCHITIET where LUUTRU_ID = D.LUUTRU_ID order by LUUTRUCHITIET_ID desc)        where        A.KHOACHUYENDEN_ID is not null  and        (E.TRANGTHAI = 'DAXACNHAN' OR E.TRANGTHAI = 'HUYXACNHAN')         and           cast(A.NGAYVAOKHOA as date) <= cast('2/26/2020 12:00:00 AM' as date)                 and B.BENHVIEN_ID = 'HLU01' and A.KHOACHUYENDEN_ID = '25'          AND             A.TRANGTHAI in ('DANGDIEUTRI')]
2020-02-26 16:18:26,791 [1] DEBUG - Statement Id: [DAO00069_GetDanhSachNoiTru] PreparedStatement : [select * from        (        SELECT ROW_NUMBER() OVER(order by B.SOTIEPNHAN) as ROWNUMBER,          A.SOBENHAN, A.BENHAN_ID, A.SOLUUTRU                 , E.NOILAP_ID as KHOAVAO_ID        , A.TRANGTHAI, IsNull(A.BACSIDIEUTRI_ID, E.BACSICHIDINH_ID) as BACSIDIEUTRI_ID,        B.TIEPNHAN_ID, B.SOTIEPNHAN, B.SOBHYT as SOTHE, B.DOITUONG_ID, A.NGAYVAOKHOA as NGAYCAPCUU, A.THOIGIANVAOKHOA as THOIGIANCAPCUU,        C.TENBENHNHAN, C.NGAYSINH, C.NAMSINH, C.BENHNHAN_ID, C.MAYTE, F.GIUONGBENH_ID, A.THOIGIANRAVIEN    , DIACHITHUONGTRU, DANTOC_ID        ,BENHVIEN_STT_ID                from TT_NOITRU_BENHAN A        inner join TT_TIEPNHAN B on B.TIEPNHAN_ID = A.TIEPNHAN_ID and (B.TRANGTHAI = 'NOITRU' or B.TRANGTHAI = 'HOANTHANH')        inner join TT_BENHNHAN C on C.BENHNHAN_ID = B.BENHNHAN_ID        left join TT_NOITRU_LUUTRU D on D.BENHAN_ID = A.BENHAN_ID        and D.LUUTRU_ID = ( select top 1 LUUTRU_ID from TT_NOITRU_LUUTRU where BENHAN_ID = A.BENHAN_ID order by LUUTRU_ID desc)        left join TT_NOITRU_XACNHAN E on E.BENHAN_ID = A.BENHAN_ID        left join TT_NOITRU_LUUTRUCHITIET F on D.LUUTRU_ID = F.LUUTRU_ID and F.LUUTRUCHITIET_CURRENT = '1'        and F.LUUTRUCHITIET_ID in (select top 1 LUUTRUCHITIET_ID from TT_NOITRU_LUUTRUCHITIET where LUUTRU_ID = D.LUUTRU_ID order by LUUTRUCHITIET_ID desc)        left join (select MABENHVIEN, BENHVIEN_STT_ID from TM_BENHVIEN) H on SUBSTRING(B.SOBHYT, 16, 5)=H.MABENHVIEN        where        A.KHOACHUYENDEN_ID is not null  and        (E.TRANGTHAI = 'DAXACNHAN' OR E.TRANGTHAI = 'HUYXACNHAN')         and           cast(A.NGAYVAOKHOA as date) <= cast('2/26/2020 12:00:00 AM' as date)                 and B.BENHVIEN_ID = 'HLU01' and A.KHOACHUYENDEN_ID = '25'          AND             A.TRANGTHAI in ('DANGDIEUTRI')                   ) lst        where        lst.ROWNUMBER between 1 and 20        order by lst.SOTIEPNHAN]
2020-02-26 16:18:28,062 [1] DEBUG - Statement Id: [DAO00069_GetCountDanhSachNoiTru] PreparedStatement : [select count(A.SOBENHAN) as TOTALROWS        from TT_NOITRU_BENHAN A        inner join TT_TIEPNHAN B on B.TIEPNHAN_ID = A.TIEPNHAN_ID and (B.TRANGTHAI = 'NOITRU' or B.TRANGTHAI = 'HOANTHANH')        inner join TT_BENHNHAN C on C.BENHNHAN_ID = B.BENHNHAN_ID        left join TT_NOITRU_LUUTRU D on D.BENHAN_ID = A.BENHAN_ID        and D.LUUTRU_ID = ( select top 1 LUUTRU_ID from TT_NOITRU_LUUTRU where BENHAN_ID = A.BENHAN_ID order by BENHAN_ID desc)        left join TT_NOITRU_XACNHAN E on E.BENHAN_ID = A.BENHAN_ID        left join TT_NOITRU_LUUTRUCHITIET F on D.LUUTRU_ID = F.LUUTRU_ID and F.LUUTRUCHITIET_CURRENT = '1'        and F.LUUTRUCHITIET_ID in (select top 1 LUUTRUCHITIET_ID from TT_NOITRU_LUUTRUCHITIET where LUUTRU_ID = D.LUUTRU_ID order by LUUTRUCHITIET_ID desc)        where        A.KHOACHUYENDEN_ID is not null  and        (E.TRANGTHAI = 'DAXACNHAN' OR E.TRANGTHAI = 'HUYXACNHAN')         and           cast(A.NGAYVAOKHOA as date) <= cast('2/26/2020 12:00:00 AM' as date)                 and B.BENHVIEN_ID = 'HLU01' and A.KHOACHUYENDEN_ID = '25'          AND             A.TRANGTHAI in ('DANGDIEUTRI')]
2020-02-26 16:18:28,189 [1] DEBUG - Statement Id: [DAO00069_GetDanhSachNoiTru] PreparedStatement : [select * from        (        SELECT ROW_NUMBER() OVER(order by B.SOTIEPNHAN) as ROWNUMBER,          A.SOBENHAN, A.BENHAN_ID, A.SOLUUTRU                 , E.NOILAP_ID as KHOAVAO_ID        , A.TRANGTHAI, IsNull(A.BACSIDIEUTRI_ID, E.BACSICHIDINH_ID) as BACSIDIEUTRI_ID,        B.TIEPNHAN_ID, B.SOTIEPNHAN, B.SOBHYT as SOTHE, B.DOITUONG_ID, A.NGAYVAOKHOA as NGAYCAPCUU, A.THOIGIANVAOKHOA as THOIGIANCAPCUU,        C.TENBENHNHAN, C.NGAYSINH, C.NAMSINH, C.BENHNHAN_ID, C.MAYTE, F.GIUONGBENH_ID, A.THOIGIANRAVIEN    , DIACHITHUONGTRU, DANTOC_ID        ,BENHVIEN_STT_ID                from TT_NOITRU_BENHAN A        inner join TT_TIEPNHAN B on B.TIEPNHAN_ID = A.TIEPNHAN_ID and (B.TRANGTHAI = 'NOITRU' or B.TRANGTHAI = 'HOANTHANH')        inner join TT_BENHNHAN C on C.BENHNHAN_ID = B.BENHNHAN_ID        left join TT_NOITRU_LUUTRU D on D.BENHAN_ID = A.BENHAN_ID        and D.LUUTRU_ID = ( select top 1 LUUTRU_ID from TT_NOITRU_LUUTRU where BENHAN_ID = A.BENHAN_ID order by LUUTRU_ID desc)        left join TT_NOITRU_XACNHAN E on E.BENHAN_ID = A.BENHAN_ID        left join TT_NOITRU_LUUTRUCHITIET F on D.LUUTRU_ID = F.LUUTRU_ID and F.LUUTRUCHITIET_CURRENT = '1'        and F.LUUTRUCHITIET_ID in (select top 1 LUUTRUCHITIET_ID from TT_NOITRU_LUUTRUCHITIET where LUUTRU_ID = D.LUUTRU_ID order by LUUTRUCHITIET_ID desc)        left join (select MABENHVIEN, BENHVIEN_STT_ID from TM_BENHVIEN) H on SUBSTRING(B.SOBHYT, 16, 5)=H.MABENHVIEN        where        A.KHOACHUYENDEN_ID is not null  and        (E.TRANGTHAI = 'DAXACNHAN' OR E.TRANGTHAI = 'HUYXACNHAN')         and           cast(A.NGAYVAOKHOA as date) <= cast('2/26/2020 12:00:00 AM' as date)                 and B.BENHVIEN_ID = 'HLU01' and A.KHOACHUYENDEN_ID = '25'          AND             A.TRANGTHAI in ('DANGDIEUTRI')                   ) lst        where        lst.ROWNUMBER between 1 and 20        order by lst.SOTIEPNHAN]
2020-02-26 16:18:30,779 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM31'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 16:18:30,947 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'IPD03'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 16:18:32,835 [1] DEBUG - Statement Id: [DAO00080_KiemtraBenhAnDaThanhToan] PreparedStatement : [select DAXACNHANDOANHTHU        from TT_NOITRU_BENHAN where        BENHAN_ID = '24642'        and BENHVIEN_ID = 'HLU01'        Order By BENHAN_ID Desc]
2020-02-26 16:18:32,956 [1] DEBUG - Statement Id: [DAO00061_GetBenhAnDetailByID] PreparedStatement : [select A.*, B.NOIGIOITHIEU_ID, C.KHOADIEUTRI_ID, A.ICD_BENHCHINH AS ICD_BENHCHINH_BAK, A.CDRAVIEN_CHINH AS CHANDOANRAVIEN1, B.THOIGIANTIEPNHAN        , A.CDRAVIEN_CHINH AS CHANDOANRAVIEN_BAK        from TT_NOITRU_BENHAN A        left join TT_TIEPNHAN B on B.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TT_NOITRU_NHAPVIEN C on C.TIEPNHAN_ID = B.TIEPNHAN_ID        where A.BENHAN_ID = '24642']
2020-02-26 16:18:33,029 [1] DEBUG - Statement Id: [DAO00087_GetServiceParams] PreparedStatement : [select CODE, VALUE              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01']
2020-02-26 16:18:33,098 [1] DEBUG - Statement Id: [DAO00080_GetNoiTruLuuTruBenhAn] PreparedStatement : [select *        from TT_NOITRU_LUUTRU where        BENHAN_ID = '24642'        and BENHVIEN_ID = 'HLU01'        Order By LUUTRU_ID ASC]
2020-02-26 16:18:33,171 [1] DEBUG - Statement Id: [DAO00080_GetGiuongBenhCuaBenhAn] PreparedStatement : [select *        from TT_NOITRU_GIUONGBENH where        BENHAN_ID =  @param0]
2020-02-26 16:18:33,172 [1] DEBUG - Statement Id: [DAO00080_GetGiuongBenhCuaBenhAn] Parameters: [@param0=[BENHAN_ID,24642]]
2020-02-26 16:18:33,172 [1] DEBUG - Statement Id: [DAO00080_GetGiuongBenhCuaBenhAn] Types: [@param0=[Int64, System.Int64]]
2020-02-26 16:18:33,251 [1] DEBUG - Statement Id: [DAO00013_GetDetailP] PreparedStatement : [select *        from TT_BENHNHAN         WHERE              TT_BENHNHAN.MAYTE  = '190040528']
2020-02-26 16:18:33,331 [1] DEBUG - Statement Id: [DAO00061_GetBenhAnDetailByID] PreparedStatement : [select A.*, B.NOIGIOITHIEU_ID, C.KHOADIEUTRI_ID, A.ICD_BENHCHINH AS ICD_BENHCHINH_BAK, A.CDRAVIEN_CHINH AS CHANDOANRAVIEN1, B.THOIGIANTIEPNHAN        , A.CDRAVIEN_CHINH AS CHANDOANRAVIEN_BAK        from TT_NOITRU_BENHAN A        left join TT_TIEPNHAN B on B.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TT_NOITRU_NHAPVIEN C on C.TIEPNHAN_ID = B.TIEPNHAN_ID        where A.BENHAN_ID = '24642']
2020-02-26 16:18:33,561 [1] DEBUG - Statement Id: [DAO00080_GetNoiTruBenhAnChiTiet] PreparedStatement : [select *        from TT_NOITRU_BENHAN_CHITIET where        BENHAN_ID = '24642'        and BENHVIEN_ID = 'HLU01'        Order By BENHANCHITIET_ID DESC]
2020-02-26 16:18:33,647 [1] DEBUG - Statement Id: [DAO00080_GetNoiTruLuuTruBenhAn] PreparedStatement : [select *        from TT_NOITRU_LUUTRU where        BENHAN_ID = '24642'        and BENHVIEN_ID = 'HLU01'        Order By LUUTRU_ID ASC]
2020-02-26 16:18:33,717 [1] DEBUG - Statement Id: [DAO00080_GetGiuongBenhCuaBenhAn] PreparedStatement : [select *        from TT_NOITRU_GIUONGBENH where        BENHAN_ID =  @param0]
2020-02-26 16:18:33,717 [1] DEBUG - Statement Id: [DAO00080_GetGiuongBenhCuaBenhAn] Parameters: [@param0=[BENHAN_ID,24642]]
2020-02-26 16:18:33,717 [1] DEBUG - Statement Id: [DAO00080_GetGiuongBenhCuaBenhAn] Types: [@param0=[Int64, System.Int64]]
2020-02-26 16:18:33,826 [1] DEBUG - Statement Id: [DAO00067_laytrangthaibenhannoitru] PreparedStatement : [select isnull(TRANGTHAI, '') TRANGTHAI from TT_NOITRU_BENHAN where BENHAN_ID =  @param0]
2020-02-26 16:18:33,827 [1] DEBUG - Statement Id: [DAO00067_laytrangthaibenhannoitru] Parameters: [@param0=[BENHAN_ID,24642]]
2020-02-26 16:18:33,827 [1] DEBUG - Statement Id: [DAO00067_laytrangthaibenhannoitru] Types: [@param0=[Int64, System.Int64]]
2020-02-26 16:18:33,855 [1] DEBUG - Statement Id: [DAO00067_DeleteVienPhi_Noref] PreparedStatement : [delete from TT_VIENPHI where TIEPNHAN_ID = 107181 and (REF_ID is null or REF_ID = 0)         and           BENHAN_ID = '24642'                 delete TT_DUOC_TONKHO_BOOK_NOITRU where REF_TABLE = 'TT_NOITRU_TOATHUOC' and (REF_ID is null or REF_ID = 0)        delete TT_DUOC_TONKHO_BOOK_NGOAITRU where REF_ID is null or REF_ID = 0]
2020-02-26 16:18:33,881 [1] DEBUG - Statement Id: [DAO00067_UpdateBenhanIdVienPhi] PreparedStatement : [update TT_VIENPHI          set BENHAN_ID =  @param0           from (select TOATHUOC_ID from TT_NOITRU_TOATHUOC where TIEPNHAN_ID =  @param1 ) nttt          where REF_TABLE = 'TT_NOITRU_TOATHUOC' and REF_ID = nttt.TOATHUOC_ID and isnull(BENHAN_ID, 0) = 0          and TIEPNHAN_ID =  @param1             update TT_VIENPHI          set TT_VIENPHI.BENHAN_ID =  @param0           from (select DVYEUCAU_ID, BENHAN_ID from TT_DVYEUCAU where TIEPNHAN_ID =  @param1 ) nttt          where TT_VIENPHI.REF_TABLE = 'TT_DVYEUCAU' and TT_VIENPHI.REF_ID = nttt.DVYEUCAU_ID          and isnull(TT_VIENPHI.BENHAN_ID, 0) = 0 and isnull(nttt.BENHAN_ID, 0) > 0          and TT_VIENPHI.TIEPNHAN_ID =  @param1]
2020-02-26 16:18:33,881 [1] DEBUG - Statement Id: [DAO00067_UpdateBenhanIdVienPhi] Parameters: [@param0=[BENHAN_ID,24642], @param1=[TIEPNHAN_ID,107181]]
2020-02-26 16:18:33,881 [1] DEBUG - Statement Id: [DAO00067_UpdateBenhanIdVienPhi] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64]]
2020-02-26 16:18:33,916 [1] DEBUG - Statement Id: [DAO00064_GetlistTT_TIEPNHAN_SOTHEBHYT] PreparedStatement : [select stbhyt.*, ba.SOBENHAN,        tn.SOTIEPNHAN, tn.LOAITHANHVIEN_ID, tn.THE_ID, tn.THANHVIEN_ID,        tn.SUDUNG_BHTN, tn.BAOLANH_VIENPHI, tn.VIP, tn.NGUOINUOCNGOAI        from TT_TIEPNHAN_SOTHEBHYT stbhyt        left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = stbhyt.TIEPNHAN_ID        left join TT_NOITRU_BENHAN ba on ba.TIEPNHAN_ID = stbhyt.TIEPNHAN_ID        where        stbhyt.TIEPNHAN_ID = '107181' and isnull(stbhyt.KHONGSUDUNG, '0') = '0'         and           ba.BENHAN_ID = '24642']
2020-02-26 16:18:33,956 [1] DEBUG - Statement Id: [DAO00064_GetListVienPhiByTiepNnan] PreparedStatement : [select distinct        B.DOITUONG_ID, B.NGAYMIENDONGCHITRA, B.BENHNHAN_ID as TIEPNHAN_BENHNHAN_ID, B.TRAITUYEN,        B.BHYTTREN3NAM as TREN3NAM, B.BHYTTREN5NAM as TREN5NAM, B.SOTIEPNHAN, B.SOBENHAN,        B.LOAITHANHVIEN_ID, B.SUDUNG_BHTN, B.THE_ID, B.THANHVIEN_ID, B.BAOLANH_VIENPHI, B.VIP, B.NGUOINUOCNGOAI,        C.GIATRIMIENGIAM as GIATRIMIENGIAM, D.GIATRIMIENGIAM as GIATRIMIENGIAM_BHTN, E.GIATRIMIENGIAM as GIATRIMIENGIAM_THANHVIEN,        F.GIATRIMIENGIAM as GIATRIMIENGIAM_CONGTY, DVYC.THE_ID as DVDUNGTHE, DVYC.TRANGTHAI as TRANGTHAIDICHVU, ndv.MANHOMDICHVU,        A.* from TT_VIENPHI A        left join        (select B.*, C.SOBENHAN, C.BENHAN_ID        from TT_TIEPNHAN B        left join TT_NOITRU_BENHAN C on B.TIEPNHAN_ID = C.TIEPNHAN_ID         and           C.BENHAN_ID = '24642'                 where B.TIEPNHAN_ID = '107181') B on B.TIEPNHAN_ID = A.TIEPNHAN_ID        left join (select sum(GIATRIMIENGIAM) as GIATRIMIENGIAM, VIENPHI_ID, REF_TABLE        from TT_MIENGIAM_CHITIET        where REF_TABLE = 'TT_MIENGIAM'        and exists (select MIENGIAM_ID from TT_MIENGIAM where TT_MIENGIAM_CHITIET.MIENGIAM_ID = MIENGIAM_ID and TINHTRANG = 1 and TIEPNHAN_ID = '107181')        group by VIENPHI_ID, REF_TABLE) C on C.REF_TABLE = 'TT_MIENGIAM' and C.VIENPHI_ID = A.VIENPHI_ID        left join (select sum(GIATRIMIENGIAM) as GIATRIMIENGIAM, VIENPHI_ID, REF_TABLE        from TT_MIENGIAM_CHITIET        where REF_TABLE = 'TT_MIENGIAM_BHTN'        and exists (select MIENGIAM_BHTN_ID from TT_MIENGIAM_BHTN where TT_MIENGIAM_CHITIET.MIENGIAM_ID = MIENGIAM_BHTN_ID and  TINHTRANG = 1 and TIEPNHAN_ID = '107181')        group by VIENPHI_ID, REF_TABLE) D on D.REF_TABLE = 'TT_MIENGIAM_BHTN' and D.VIENPHI_ID = A.VIENPHI_ID        left join (select sum(GIATRIMIENGIAM) as GIATRIMIENGIAM, VIENPHI_ID, REF_TABLE        from TT_MIENGIAM_CHITIET        where REF_TABLE = 'TT_MIENGIAM_THANHVIEN'        and exists (select MIENGIAM_THANHVIEN_ID from TT_MIENGIAM_THANHVIEN where TT_MIENGIAM_CHITIET.MIENGIAM_ID = MIENGIAM_THANHVIEN_ID and TINHTRANG = 1 and TIEPNHAN_ID = '107181')        group by VIENPHI_ID, REF_TABLE) E on E.REF_TABLE = 'TT_MIENGIAM_THANHVIEN' and E.VIENPHI_ID = A.VIENPHI_ID        left join (select sum(GIATRIMIENGIAM) as GIATRIMIENGIAM, VIENPHI_ID, REF_TABLE        from TT_MIENGIAM_CHITIET        where REF_TABLE = 'TT_MIENGIAM_CONGTY'        and exists (select MIENGIAM_CONGTY_ID from TT_MIENGIAM_CONGTY where TT_MIENGIAM_CHITIET.MIENGIAM_ID = MIENGIAM_CONGTY_ID and TINHTRANG = 1 and TIEPNHAN_ID = '107181')        group by VIENPHI_ID, REF_TABLE) F on F.REF_TABLE = 'TT_MIENGIAM_CONGTY' and F.VIENPHI_ID = A.VIENPHI_ID        left join TT_DVYEUCAU DVYC on DVYC.DVYEUCAU_ID = A.REF_ID and A.REF_TABLE = 'TT_DVYEUCAU'        left join TM_DICHVU DV on DVYC.DICHVU_ID = DV.DICHVU_ID and A.REF_TABLE = 'TT_DVYEUCAU'        left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = DV.NHOMDICHVU_ID and A.REF_TABLE = 'TT_DVYEUCAU'        where        A.TIEPNHAN_ID = '107181' and ((DVYC.HUYYEUCAU = '0' and A.DICHVU_ID is not null)        or A.DUOC_ID is not null or A.REF_TABLE = 'TT_NUT_XACNHANSUATAN_CHITIET')        and A.ACTIVE = '1'         and           A.BENHAN_ID = '24642'                 and A.BENHVIEN_ID = 'HLU01'        order by A.VIENPHI_ID]
2020-02-26 16:18:34,033 [1] DEBUG - Statement Id: [DAO00006_GetListDuocTyle] PreparedStatement : [select DUOC_ID, DOITUONG_ID, (TYLE/100) as TYLE, DONGIA MUCTRAN_THANHTOAN from TM_DOITUONG_GIADUOC_TYLE            where            BENHVIEN_ID = 'HLU01'            and DOITUONG_ID = '4']
2020-02-26 16:18:34,060 [1] DEBUG - Statement Id: [DAO00027_GetListTuongTrinhDichVuPhauThuatCuaTiepNhan] PreparedStatement : [declare @ManhomDSA varchar(10);        declare @PhanLoaiNhomDV varchar(20) = '05';        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        if (@ManhomDSA is not null) set @PhanLoaiNhomDV += ',' + @ManhomDSA        select distinct ptyc.*        from TT_PHAUTHUAT_YEUCAU ptyc        inner join TM_DICHVU dv on dv.DICHVU_ID = ptyc.DICHVU_ID        inner join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID        inner join TT_PHAUTHUAT pt on pt.PHAUTHUAT_ID = ptyc.PHAUTHUAT_ID        where        pt.TIEPNHAN_ID = 107181        and (left(ndv.MANHOMDICHVU, 2) in (select * from STRING_SPLIT(@PhanLoaiNhomDV,',')) or ndv.MANHOMDICHVU in (select * from STRING_SPLIT(@PhanLoaiNhomDV,',')))]
2020-02-26 16:18:34,174 [1] DEBUG - Statement Id: [DAO00027_GetListTuongTrinhVTYTPhauThuatCuaTiepNhan] PreparedStatement : [select distinct ptvt.*        from TT_PHAUTHUAT_VTYT ptvt        inner join TT_PHAUTHUAT pt on pt.PHAUTHUAT_ID = ptvt.PHAUTHUAT_ID        inner join TM_DUOC d on d.DUOC_ID = ptvt.DUOC_ID        inner join TM_LOAIDUOC ld on ld.LOAIVATTU_ID = 'V' and ld.LOAIDUOC_ID = d.LOAIDUOC_ID        where pt.TIEPNHAN_ID = 107181        order by ptvt.PHAUTHUAT_VTYT_ID asc]
2020-02-26 16:18:34,221 [1] DEBUG - Statement Id: [DAO00006_GetList] PreparedStatement : [select dv.*, loaiDV.MALOAIDICHVU, captren.NHOMDICHVU_ID as NHOMDICHVU_CAPTREN_ID, captren.TENNHOMDICHVU as NHOMDICHVU_CAPTREN,              nhom_dv.TENNHOMDICHVU as TENNHOMDICHVU, nhom_dv.MANHOMDICHVU,              case when dv.ATTRIBUTE5 is null then 'TT' else 'KTC' end as LOAI_CHIPHI              from TM_DICHVU as dv              left join TM_NHOMDICHVU as nhom_dv on nhom_dv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID and nhom_dv.BENHVIEN_ID = 'HLU01'              left join TM_NHOMDICHVU as captren on nhom_dv.CAPTREN_ID = captren.NHOMDICHVU_ID and captren.BENHVIEN_ID = 'HLU01'              left join TM_LOAIDICHVU loaiDV on nhom_dv.LOAIDICHVU_ID = loaiDV.LOAIDICHVU_ID and loaiDV.BENHVIEN_ID = 'HLU01'              where nhom_dv.TAMNGUNG = '0' and dv.BENHVIEN_ID = 'HLU01'              and dv.TAMNGUNG = '0'               AND                   loaiDV.MALOAIDICHVU = 'KhamBenh']
2020-02-26 16:18:34,303 [1] DEBUG - Statement Id: [DAO00027_GetDichvuYCBHYTTyle] PreparedStatement : [select DVYEUCAU_ID from TT_DVYEUCAU        where TIEPNHAN_ID = 107181 and isnull(BHYT_TYLETHANHTOAN_ID, 0) > 0]
2020-02-26 16:18:34,790 [1] DEBUG - Statement Id: [DAO00023_UpdateNhieuVP] PreparedStatement : [declare @jsonVienPhi nvarchar(max) = N'[{"VIENPHI_ID":3109614,"TIEPNHAN_ID":107181,"DICHVU_ID":5440,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":34500.0000,"THANHTIEN_DOANHTHU":34500.00,"BHYT_TL":0.8000,"BHYT_DONGIA":34500.0000,"BHYT_THANHTIEN":34500.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":27600.0,"BHYT_THANHTIEN_CHITRA":27600.00,"BENHNHAN_PHAITHANHTOAN":6900.00,"GIATRI_HOADON":6900.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3109615,"TIEPNHAN_ID":107181,"DICHVU_ID":5554,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":5000.0000,"THANHTIEN_DOANHTHU":5000.00,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":5000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110619,"TIEPNHAN_ID":107181,"DICHVU_ID":4022,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":43900.0000,"THANHTIEN_DOANHTHU":43900.00,"BHYT_TL":0.8000,"BHYT_DONGIA":43900.0000,"BHYT_THANHTIEN":43900.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":35120.0,"BHYT_THANHTIEN_CHITRA":35120.00,"BENHNHAN_PHAITHANHTOAN":8780.00,"GIATRI_HOADON":8780.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110620,"TIEPNHAN_ID":107181,"DICHVU_ID":4422,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":32800.0000,"THANHTIEN_DOANHTHU":32800.00,"BHYT_TL":0.8000,"BHYT_DONGIA":32800.0000,"BHYT_THANHTIEN":32800.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":26240.0,"BHYT_THANHTIEN_CHITRA":26240.00,"BENHNHAN_PHAITHANHTOAN":6560.00,"GIATRI_HOADON":6560.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110621,"TIEPNHAN_ID":107181,"DICHVU_ID":4451,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":63500.0000,"THANHTIEN_DOANHTHU":63500.00,"BHYT_TL":0.8000,"BHYT_DONGIA":63500.0000,"BHYT_THANHTIEN":63500.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":50800.0,"BHYT_THANHTIEN_CHITRA":50800.00,"BENHNHAN_PHAITHANHTOAN":12700.00,"GIATRI_HOADON":12700.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110622,"TIEPNHAN_ID":107181,"DICHVU_ID":4454,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":40400.0000,"THANHTIEN_DOANHTHU":40400.00,"BHYT_TL":0.8000,"BHYT_DONGIA":40400.0000,"BHYT_THANHTIEN":40400.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":32320.0,"BHYT_THANHTIEN_CHITRA":32320.00,"BENHNHAN_PHAITHANHTOAN":8080.00,"GIATRI_HOADON":8080.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110623,"TIEPNHAN_ID":107181,"DICHVU_ID":4523,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":40400.0000,"THANHTIEN_DOANHTHU":40400.00,"BHYT_TL":0.8000,"BHYT_DONGIA":40400.0000,"BHYT_THANHTIEN":40400.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":32320.0,"BHYT_THANHTIEN_CHITRA":32320.00,"BENHNHAN_PHAITHANHTOAN":8080.00,"GIATRI_HOADON":8080.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110624,"TIEPNHAN_ID":107181,"DICHVU_ID":4596,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":39100.0000,"THANHTIEN_DOANHTHU":39100.00,"BHYT_TL":0.8000,"BHYT_DONGIA":39100.0000,"BHYT_THANHTIEN":39100.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":31280.0,"BHYT_THANHTIEN_CHITRA":31280.00,"BENHNHAN_PHAITHANHTOAN":7820.00,"GIATRI_HOADON":7820.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110626,"TIEPNHAN_ID":107181,"DICHVU_ID":4642,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":21500.0000,"THANHTIEN_DOANHTHU":21500.00,"BHYT_TL":0.8000,"BHYT_DONGIA":21500.0000,"BHYT_THANHTIEN":21500.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":17200.0,"BHYT_THANHTIEN_CHITRA":17200.00,"BENHNHAN_PHAITHANHTOAN":4300.00,"GIATRI_HOADON":4300.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110628,"TIEPNHAN_ID":107181,"DICHVU_ID":4681,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":21500.0000,"THANHTIEN_DOANHTHU":21500.00,"BHYT_TL":0.8000,"BHYT_DONGIA":21500.0000,"BHYT_THANHTIEN":21500.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":17200.0,"BHYT_THANHTIEN_CHITRA":17200.00,"BENHNHAN_PHAITHANHTOAN":4300.00,"GIATRI_HOADON":4300.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110629,"TIEPNHAN_ID":107181,"DICHVU_ID":4722,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":21500.0000,"THANHTIEN_DOANHTHU":21500.00,"BHYT_TL":0.8000,"BHYT_DONGIA":21500.0000,"BHYT_THANHTIEN":21500.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":17200.0,"BHYT_THANHTIEN_CHITRA":17200.00,"BENHNHAN_PHAITHANHTOAN":4300.00,"GIATRI_HOADON":4300.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110630,"TIEPNHAN_ID":107181,"DICHVU_ID":4747,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":27400.0000,"THANHTIEN_DOANHTHU":27400.00,"BHYT_TL":0.8000,"BHYT_DONGIA":27400.0000,"BHYT_THANHTIEN":27400.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":21920.0,"BHYT_THANHTIEN_CHITRA":21920.00,"BENHNHAN_PHAITHANHTOAN":5480.00,"GIATRI_HOADON":5480.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110631,"TIEPNHAN_ID":107181,"DICHVU_ID":4832,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":70000.0000,"THANHTIEN_DOANHTHU":70000.00,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":70000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":70000.0000,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":70000.0000,"GIATRI_BENHNHAN_DATHANHTOAN":70000.0000,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110632,"TIEPNHAN_ID":107181,"DICHVU_ID":4873,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":70000.0000,"THANHTIEN_DOANHTHU":70000.00,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":70000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":70000.0000,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":70000.0000,"GIATRI_BENHNHAN_DATHANHTOAN":70000.0000,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119342,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":5.0000,"DONGIA_DOANHTHU":4000.0000,"THANHTIEN_DOANHTHU":20000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":20000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119500,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":2.0000,"DONGIA_DOANHTHU":8715.0000,"THANHTIEN_DOANHTHU":17430.00,"BHYT_TL":0.8000,"BHYT_DONGIA":8715.0000,"BHYT_THANHTIEN":17430.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":6972.0,"BHYT_THANHTIEN_CHITRA":13944.00,"BENHNHAN_PHAITHANHTOAN":3486.00,"GIATRI_HOADON":3486.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119501,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":8925.0000,"THANHTIEN_DOANHTHU":8925.00,"BHYT_TL":0.8000,"BHYT_DONGIA":8925.0000,"BHYT_THANHTIEN":8925.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":7140.0,"BHYT_THANHTIEN_CHITRA":7140.00,"BENHNHAN_PHAITHANHTOAN":1785.00,"GIATRI_HOADON":1785.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119502,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":2.0000,"DONGIA_DOANHTHU":27990.0000,"THANHTIEN_DOANHTHU":55980.00,"BHYT_TL":0.8000,"BHYT_DONGIA":27990.0000,"BHYT_THANHTIEN":55980.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":22392.0,"BHYT_THANHTIEN_CHITRA":44784.00,"BENHNHAN_PHAITHANHTOAN":11196.00,"GIATRI_HOADON":11196.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119503,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":8925.0000,"THANHTIEN_DOANHTHU":8925.00,"BHYT_TL":0.8000,"BHYT_DONGIA":8925.0000,"BHYT_THANHTIEN":8925.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":7140.0,"BHYT_THANHTIEN_CHITRA":7140.00,"BENHNHAN_PHAITHANHTOAN":1785.00,"GIATRI_HOADON":1785.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119504,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":2.0000,"DONGIA_DOANHTHU":8295.0000,"THANHTIEN_DOANHTHU":16590.00,"BHYT_TL":0.8000,"BHYT_DONGIA":8295.0000,"BHYT_THANHTIEN":16590.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":6636.0,"BHYT_THANHTIEN_CHITRA":13272.00,"BENHNHAN_PHAITHANHTOAN":3318.00,"GIATRI_HOADON":3318.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119505,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":458000.0000,"THANHTIEN_DOANHTHU":458000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":398036.0000,"BHYT_THANHTIEN":398036.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":318428.8,"BHYT_THANHTIEN_CHITRA":318428.80,"BENHNHAN_PHAITHANHTOAN":139571.20,"GIATRI_HOADON":79607.20,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119506,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":50400.0000,"THANHTIEN_DOANHTHU":50400.00,"BHYT_TL":0.8000,"BHYT_DONGIA":50400.0000,"BHYT_THANHTIEN":50400.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":40320.0,"BHYT_THANHTIEN_CHITRA":40320.00,"BENHNHAN_PHAITHANHTOAN":10080.00,"GIATRI_HOADON":10080.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119530,"TIEPNHAN_ID":107181,"DICHVU_ID":5363,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":10000.0000,"THANHTIEN_DOANHTHU":10000.00,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119531,"TIEPNHAN_ID":107181,"DICHVU_ID":5588,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":2400.0000,"THANHTIEN_DOANHTHU":2400.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119532,"TIEPNHAN_ID":107181,"DICHVU_ID":477,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":110000.0000,"THANHTIEN_DOANHTHU":110000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119533,"TIEPNHAN_ID":107181,"DICHVU_ID":5602,"BENHAN_ID":24642,"SOLUONG":0.5000,"DONGIA_DOANHTHU":200000.0000,"THANHTIEN_DOANHTHU":100000.00,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":100000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119535,"TIEPNHAN_ID":107181,"DICHVU_ID":3161,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":2945000.0000,"THANHTIEN_DOANHTHU":2945000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":2945000.0000,"BHYT_THANHTIEN":2945000.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":2356000.0,"BHYT_THANHTIEN_CHITRA":2356000.00,"BENHNHAN_PHAITHANHTOAN":589000.00,"GIATRI_HOADON":589000.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119536,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":0.2500,"DONGIA_DOANHTHU":25000.0000,"THANHTIEN_DOANHTHU":6250.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119537,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":2.0000,"DONGIA_DOANHTHU":1700.0000,"THANHTIEN_DOANHTHU":3400.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119538,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":3.0000,"DONGIA_DOANHTHU":1000.0000,"THANHTIEN_DOANHTHU":3000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119539,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":3.0000,"DONGIA_DOANHTHU":2000.0000,"THANHTIEN_DOANHTHU":6000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119540,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":4000.0000,"THANHTIEN_DOANHTHU":4000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119541,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":3000.0000,"THANHTIEN_DOANHTHU":3000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119542,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":100.0000,"DONGIA_DOANHTHU":50.0000,"THANHTIEN_DOANHTHU":5000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119543,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":150000.0000,"THANHTIEN_DOANHTHU":150000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119544,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":160000.0000,"THANHTIEN_DOANHTHU":160000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119545,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":20.0000,"DONGIA_DOANHTHU":3000.0000,"THANHTIEN_DOANHTHU":60000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119546,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":20.0000,"DONGIA_DOANHTHU":6000.0000,"THANHTIEN_DOANHTHU":120000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119547,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":5.0000,"DONGIA_DOANHTHU":4000.0000,"THANHTIEN_DOANHTHU":20000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119548,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":10.0000,"DONGIA_DOANHTHU":8000.0000,"THANHTIEN_DOANHTHU":80000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119549,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":2.0000,"DONGIA_DOANHTHU":500.0000,"THANHTIEN_DOANHTHU":1000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119550,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":10000.0000,"THANHTIEN_DOANHTHU":10000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119551,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":45000.0000,"THANHTIEN_DOANHTHU":45000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119552,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":35000.0000,"THANHTIEN_DOANHTHU":35000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119553,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":10000.0000,"THANHTIEN_DOANHTHU":10000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119554,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":20000.0000,"THANHTIEN_DOANHTHU":20000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119555,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":6500.0000,"THANHTIEN_DOANHTHU":6500.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119556,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":0.5000,"DONGIA_DOANHTHU":16000.0000,"THANHTIEN_DOANHTHU":8000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119557,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":0.2500,"DONGIA_DOANHTHU":100000.0000,"THANHTIEN_DOANHTHU":25000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119558,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":2.0000,"DONGIA_DOANHTHU":10000.0000,"THANHTIEN_DOANHTHU":20000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119559,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":60000.0000,"THANHTIEN_DOANHTHU":60000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119560,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":2.0000,"DONGIA_DOANHTHU":13500.0000,"THANHTIEN_DOANHTHU":27000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119561,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":6000.0000,"THANHTIEN_DOANHTHU":6000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119645,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":600.0000,"THANHTIEN_DOANHTHU":600.00,"BHYT_TL":0.8000,"BHYT_DONGIA":600.0000,"BHYT_THANHTIEN":600.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":480.0,"BHYT_THANHTIEN_CHITRA":480.00,"BENHNHAN_PHAITHANHTOAN":120.00,"GIATRI_HOADON":120.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":0.0,"DUOC_TYLE":0.0000},{"VIENPHI_ID":3119646,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":1000.0000,"THANHTIEN_DOANHTHU":1000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":1000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"1","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":0.0,"DUOC_TYLE":0.0000},{"VIENPHI_ID":3119647,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":600.0000,"THANHTIEN_DOANHTHU":600.00,"BHYT_TL":0.8000,"BHYT_DONGIA":600.0000,"BHYT_THANHTIEN":600.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":480.0,"BHYT_THANHTIEN_CHITRA":480.00,"BENHNHAN_PHAITHANHTOAN":120.00,"GIATRI_HOADON":120.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":0.0,"DUOC_TYLE":0.0000},{"VIENPHI_ID":3119648,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":1000.0000,"THANHTIEN_DOANHTHU":1000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":1000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"1","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":0.0,"DUOC_TYLE":0.0000}]';        begin        UPDATE TT_VIENPHI        SET        SOLUONG = json.SOLUONG,        DONGIA_DOANHTHU = json.DONGIA_DOANHTHU,        THANHTIEN_DOANHTHU = json.THANHTIEN_DOANHTHU,        BHYT_TL = json.BHYT_TL,        BHYT_DONGIA = json.BHYT_DONGIA,        BHYT_THANHTIEN = json.BHYT_THANHTIEN,        BHYT_DONGIA_CONGKHAM_DAU = json.BHYT_DONGIA_CONGKHAM_DAU,        BHYT_CONGKHAM_DAU_TYLE = json.BHYT_CONGKHAM_DAU_TYLE,        BHYT_DONGIA_CHITRA = json.BHYT_DONGIA_CHITRA,        BHYT_THANHTIEN_CHITRA = json.BHYT_THANHTIEN_CHITRA,        BENHNHAN_PHAITHANHTOAN = json.BENHNHAN_PHAITHANHTOAN,        GIATRI_HOADON = json.GIATRI_HOADON,        GIATRI_BIENLAI = json.GIATRI_BIENLAI,        DATHUCHIEN = json.DATHUCHIEN,        DICHVU_TL = json.DICHVU_TL,        BHYT_DONGIA_DONGCT_DAU = json.BHYT_DONGIA_DONGCT_DAU,        SOLONHAP_ID = json.SOLONHAP_ID,        DUOC_TYLE = json.DUOC_TYLE,        DUOC_MUCTRAN_THANHTOAN = json.DUOC_MUCTRAN_THANHTOAN,        NGAYCAPNHAT = GETDATE()        FROM OPENJSON (@jsonVienPhi)        WITH (        VIENPHI_ID int,        SOLUONG numeric(25, 4),        DONGIA_DOANHTHU numeric(25, 4),        THANHTIEN_DOANHTHU numeric(25, 4),        BHYT_TL numeric(25, 4),        BHYT_DONGIA numeric(25, 4),        BHYT_THANHTIEN numeric(25, 4),        BHYT_DONGIA_CONGKHAM_DAU numeric(25, 4),        BHYT_CONGKHAM_DAU_TYLE numeric(25, 4),        BHYT_DONGIA_CHITRA numeric(25, 4),        BHYT_THANHTIEN_CHITRA numeric(25, 4),        BENHNHAN_PHAITHANHTOAN numeric(25, 4),        GIATRI_HOADON numeric(25, 4),        GIATRI_BIENLAI numeric(25, 4),        DATHUCHIEN char(1),        KHONGTHUTIEN char(1),        BHYTDONGTIEN char(1),        DICHVU_TL numeric(25, 4),        BHYT_DONGIA_DONGCT_DAU numeric(25, 4),        SOLONHAP_ID int,        DUOC_TYLE numeric(25, 4),        DUOC_MUCTRAN_THANHTOAN numeric(25, 4))  json        WHERE TT_VIENPHI.VIENPHI_ID = json.VIENPHI_ID and json.DONGIA_DOANHTHU > 0                  insert into TT_TINH_VIENPHI_LOG        SELECT json.VIENPHI_ID, json.TIEPNHAN_ID, json.BENHAN_ID, json.SOLUONG, json.BHYT_TL, json.DONGIA_DOANHTHU,        json.THANHTIEN_DOANHTHU, json.BHYT_DONGIA, json.BHYT_THANHTIEN, json.BHYT_DONGIA_CHITRA, json.BHYT_THANHTIEN_CHITRA, json.BENHNHAN_PHAITHANHTOAN,        json.SOBHYT_HUONG_ID, json.SOBHYT, GETDATE(), -1, 'HLU01'        FROM OPENJSON(@jsonVienPhi)        WITH (        VIENPHI_ID int,        TIEPNHAN_ID int,        BENHAN_ID int,        SOLUONG numeric(25, 4),        DONGIA_DOANHTHU numeric(25, 4),        THANHTIEN_DOANHTHU numeric(25, 4),        BHYT_TL numeric(25, 4),        BHYT_DONGIA numeric(25, 4),        BHYT_THANHTIEN numeric(25, 4),        BHYT_DONGIA_CHITRA numeric(25, 4),        BHYT_THANHTIEN_CHITRA numeric(25, 4),        BENHNHAN_PHAITHANHTOAN numeric(25, 4),        SOBHYT_HUONG_ID int,        SOBHYT nvarchar(30)) json        end]
2020-02-26 16:18:34,932 [1] DEBUG - Statement Id: [DAO00067_UpdateDataVienPhiDongiaBHYT] PreparedStatement : [update TT_VIENPHI          set BHYT_DONGIA_CHITRA = 0, BHYT_THANHTIEN = 0, BHYT_THANHTIEN_CHITRA = 0          where          TIEPNHAN_ID = 107181 and BHYT_DONGIA = 0          and (BHYT_DONGIA_CHITRA > 0 or BHYT_THANHTIEN > 0 or BHYT_THANHTIEN_CHITRA > 0)]
2020-02-26 16:18:34,960 [1] DEBUG - Statement Id: [DAO00067_CapnhatDataVienphiKhiHuyThanhtoanHoadon] PreparedStatement : [update TT_VIENPHI        set TT_VIENPHI.HOADON_ID = hdct.HOADON_ID, TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN = TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN + hdct.GIATRI_BENHNHAN_DATHANHTOAN        from (select CT.HOADON_ID, CT.VIENPHI_ID, CT.GIATRI_BENHNHAN_DATHANHTOAN        from TT_HOADON_CHITIET_NGOAITRU CT        join TT_HOADON HD on HD.HOADON_ID = CT.HOADON_ID        join TT_VIENPHI vp on vp.VIENPHI_ID = ct.VIENPHI_ID        where HD.DATHANHTOAN = 1 and HD.HUYHOADON = 0 and HD.HOANTRA = 0 and vp.TIEPNHAN_ID =  @param0 ) hdct        where        TT_VIENPHI.VIENPHI_ID = hdct.VIENPHI_ID and TT_VIENPHI.HOADON_ID is null and isnull(TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN,0) = 0        and TT_VIENPHI.TIEPNHAN_ID =  @param0           update TT_VIENPHI        set TT_VIENPHI.HOADON_ID = null, TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN = TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN - hdct.GIATRI_BENHNHAN_DATHANHTOAN,        TT_VIENPHI.DATHANHTOAN = '0'        from (select CT.HOADON_ID, CT.VIENPHI_ID, CT.GIATRI_BENHNHAN_DATHANHTOAN        from TT_HOADON_CHITIET_NGOAITRU CT        join TT_HOADON HD on HD.HOADON_ID = CT.HOADON_ID        join TT_VIENPHI vp on vp.VIENPHI_ID = ct.VIENPHI_ID and vp.HOADON_ID = ct.HOADON_ID        where HD.DATHANHTOAN = 0 and (HD.HUYHOADON = 1 or HD.HOANTRA = 1) and vp.TIEPNHAN_ID =  @param0 ) hdct        where        TT_VIENPHI.VIENPHI_ID = hdct.VIENPHI_ID and TT_VIENPHI.HOADON_ID = hdct.HOADON_ID        and TT_VIENPHI.TIEPNHAN_ID =  @param0]
2020-02-26 16:18:34,960 [1] DEBUG - Statement Id: [DAO00067_CapnhatDataVienphiKhiHuyThanhtoanHoadon] Parameters: [@param0=[TIEPNHAN_ID,107181]]
2020-02-26 16:18:34,960 [1] DEBUG - Statement Id: [DAO00067_CapnhatDataVienphiKhiHuyThanhtoanHoadon] Types: [@param0=[Int64, System.Int64]]
2020-02-26 16:18:36,736 [1] DEBUG - Statement Id: [DAO00305_GetListLoaiBenhAn] PreparedStatement : [select        DICTIONARY_ID as LOAIBENHAN_ID        , DICTIONARY_NAME as TENLOAIBENHAN        , DICTIONARY_NAME_EN        , DICTIONARY_CODE        , DICTIONARY_NAME        from LST_DICTIONARY        where LST_DICTIONARY.Enabled = '1' and DICTIONARY_TYPE_CODE = 'LoaiBenhAn'        order by LST_DICTIONARY.IDX]
2020-02-26 16:18:40,129 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'IPD60'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 16:18:41,079 [1] DEBUG - Statement Id: [DAO00040_LayListToaMau] PreparedStatement : [select A.*, dc.TENDUOCDAYDU, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ld.MALOAIDUOC, dd.DICTIONARY_NAME DUONGDUNG, dc.TAMNGUNG            from TT_TOATHUOCMAU A            left join TM_DUOC dc on A.DUOC_ID = dc.DUOC_ID            left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID            left join (select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE like 'DuongDung') dd on dd.DICTIONARY_ID = dc.DUONGDUNG_ID            where (1=1)]
2020-02-26 16:18:43,924 [1] DEBUG - Statement Id: [DAO00040_LayListToaMau] PreparedStatement : [select A.*, dc.TENDUOCDAYDU, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ld.MALOAIDUOC, dd.DICTIONARY_NAME DUONGDUNG, dc.TAMNGUNG            from TT_TOATHUOCMAU A            left join TM_DUOC dc on A.DUOC_ID = dc.DUOC_ID            left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID            left join (select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE like 'DuongDung') dd on dd.DICTIONARY_ID = dc.DUONGDUNG_ID            where (1=1)]
2020-02-26 16:18:46,503 [1] DEBUG - Statement Id: [DAO00017_GetLoaiGiaByDoiTuongId] PreparedStatement : [select dtlg.DOUUTIEN, dtlg.DOITUONG_ID, lg.LOAIGIA_ID, lg.TENLOAIGIA, lg.MALOAIGIA              from TM_LOAIGIA lg              left join TM_DOITUONG_LOAIGIA dtlg              on lg.LOAIGIA_ID = dtlg.LOAIGIA_ID and dtlg.BENHVIEN_ID = 'HLU01'              where lg.TAMNGUNG = 0 and lg.BENHVIEN_ID = 'HLU01'                             order by dtlg.DOUUTIEN]
2020-02-26 16:18:46,542 [1] DEBUG - Statement Id: [DAO00063_GetListKhoThuocPhongBanPhamvi] PreparedStatement : [select distinct dpv.*        from TM_DUOC_PHAMVISD_MAPPING dmap        left join TM_DUOC_PHAMVISUDUNG dpv on dpv.PHAMVI_ID = dmap.PHAMVI_ID        where dmap.KHODUOC_ID in (select KHODUOC_ID from TM_PHONGBAN_KHODUOC where PHONGBAN_ID = '25')]
2020-02-26 16:18:46,576 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1027']
2020-02-26 16:18:46,602 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1030']
2020-02-26 16:18:46,626 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1032']
2020-02-26 16:18:46,659 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1057']
2020-02-26 16:18:46,694 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1027']
2020-02-26 16:18:46,719 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1030']
2020-02-26 16:18:46,744 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1032']
2020-02-26 16:18:46,768 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1057']
2020-02-26 16:18:46,792 [1] DEBUG - Statement Id: [DAO00063_GetListPhamviTuKhoThuocVaPhongBan] PreparedStatement : [select distinct dpv.*, dmap.KHODUOC_ID        from TM_DUOC_PHAMVISD_MAPPING dmap        left join TM_DUOC_PHAMVISUDUNG dpv on dpv.PHAMVI_ID = dmap.PHAMVI_ID and dpv.TAMNGUNG != '1'        where dmap.KHODUOC_ID in (select KHODUOC_ID from TM_PHONGBAN_KHODUOC where PHONGBAN_ID = '25')        and dmap.KHODUOC_ID = '29' and dpv.MAPHAMVI is not null]
2020-02-26 16:18:46,845 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 999999999 as SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        where  @param0  = 0        union all        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end        else        begin        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO        group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end]
2020-02-26 16:18:46,846 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Parameters: [@param0=[PHAMVI_ID,1027]]
2020-02-26 16:18:46,846 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Types: [@param0=[Int64, System.Int64]]
2020-02-26 16:18:46,918 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 999999999 as SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        where  @param0  = 0        union all        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end        else        begin        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO        group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end]
2020-02-26 16:18:46,919 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Parameters: [@param0=[PHAMVI_ID,1027]]
2020-02-26 16:18:46,919 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Types: [@param0=[Int64, System.Int64]]
2020-02-26 16:18:47,132 [1] DEBUG - Statement Id: [DAO00096_GetList] PreparedStatement : [select *        from TM_DUOC_THANHPHANHOATCHAT        where BENHVIEN_ID = 'HLU01']
2020-02-26 16:18:47,204 [1] DEBUG - Statement Id: [DAO00040_LayListToaMau] PreparedStatement : [select A.*, dc.TENDUOCDAYDU, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ld.MALOAIDUOC, dd.DICTIONARY_NAME DUONGDUNG, dc.TAMNGUNG            from TT_TOATHUOCMAU A            left join TM_DUOC dc on A.DUOC_ID = dc.DUOC_ID            left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID            left join (select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE like 'DuongDung') dd on dd.DICTIONARY_ID = dc.DUONGDUNG_ID            where (1=1)]
2020-02-26 16:18:49,728 [1] DEBUG - Statement Id: [DAO00063_GetListKhoThuocPhongBanPhamvi] PreparedStatement : [select distinct dpv.*        from TM_DUOC_PHAMVISD_MAPPING dmap        left join TM_DUOC_PHAMVISUDUNG dpv on dpv.PHAMVI_ID = dmap.PHAMVI_ID        where dmap.KHODUOC_ID in (select KHODUOC_ID from TM_PHONGBAN_KHODUOC where PHONGBAN_ID = '25')]
2020-02-26 16:18:49,756 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1027']
2020-02-26 16:18:49,781 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1030']
2020-02-26 16:18:49,806 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1032']
2020-02-26 16:18:49,833 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1057']
2020-02-26 16:18:49,864 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1027']
2020-02-26 16:18:49,889 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1030']
2020-02-26 16:18:49,913 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1032']
2020-02-26 16:18:50,113 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1057']
2020-02-26 16:18:50,176 [1] DEBUG - Statement Id: [DAO00063_GetListPhamviTuKhoThuocVaPhongBan] PreparedStatement : [select distinct dpv.*, dmap.KHODUOC_ID        from TM_DUOC_PHAMVISD_MAPPING dmap        left join TM_DUOC_PHAMVISUDUNG dpv on dpv.PHAMVI_ID = dmap.PHAMVI_ID and dpv.TAMNGUNG != '1'        where dmap.KHODUOC_ID in (select KHODUOC_ID from TM_PHONGBAN_KHODUOC where PHONGBAN_ID = '25')        and dmap.KHODUOC_ID = '29' and dpv.MAPHAMVI is not null]
2020-02-26 16:18:50,214 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 999999999 as SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        where  @param0  = 0        union all        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end        else        begin        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO        group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end]
2020-02-26 16:18:50,214 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Parameters: [@param0=[PHAMVI_ID,1027]]
2020-02-26 16:18:50,214 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Types: [@param0=[Int64, System.Int64]]
2020-02-26 16:18:50,375 [1] DEBUG - Statement Id: [DAO00063_Getlist_Thuoc_Tamngung] PreparedStatement : [select DUOC_ID FROM TM_DUOC where TAMNGUNG = '1']
2020-02-26 16:18:50,415 [1] DEBUG - Statement Id: [DAO00061_GetLuuTruIDByBenhAnID] PreparedStatement : [select lt.LUUTRU_ID, ba.BACSIDIEUTRI_ID as BACSIDIEUTRICHINH_ID        from TT_NOITRU_LUUTRU lt        left join TT_NOITRU_BENHAN ba on lt.BENHAN_ID = ba.BENHAN_ID        where lt.BENHAN_ID = '24642']
2020-02-26 16:18:50,540 [1] DEBUG - Statement Id: [DAO00061_GetChanDoanBenhAnID] PreparedStatement : [DECLARE @ICDPHU NVARCHAR(2000)=''        DECLARE @LISTICDPHU NVARCHAR(200)        DECLARE @CHANDOANRAVIEN NVARCHAR(500)        DECLARE @LISTICDPHUVAOKHOA NVARCHAR(50)        DECLARE @ICDPHUVAOKHOA NVARCHAR(500)=''        DECLARE @ICDKHAMBENH NVARCHAR(500) = (SELECT ICD.TENICD + '('+ISNULL(ICD.MAICD,'')+')'        FROM TT_NOITRU_BENHAN BA INNER JOIN TM_ICD ICD        ON BA.ICD_KHAMBENH = ICD.ICD_ID WHERE BA.BENHAN_ID =  @param0 )        DECLARE @ICDCHINH NVARCHAR(500) = (SELECT ICD.TENICD + '('+ISNULL(ICD.MAICD,'')+')'        FROM TT_NOITRU_BENHAN BA INNER JOIN TM_ICD ICD        ON BA.ICD_BENHCHINH = ICD.ICD_ID WHERE BA.BENHAN_ID =  @param0 )        SELECT @CHANDOANRAVIEN = BA.CHANDOANRAVIEN, @LISTICDPHU = BA.ICD_BENHPHU, @LISTICDPHUVAOKHOA = BA.ICD_PHU_VAOKHOA        FROM TT_NOITRU_BENHAN BA WHERE BA.BENHAN_ID =  @param0         SELECT @ICDPHU = @ICDPHU + ISNULL(TENICD, '') +'(' +ISNULL(MAICD,'')+ '); ' FROM TM_ICD WHERE MAICD IN (SELECT S FROM SplitString(@LISTICDPHU,';'))        SELECT @ICDPHUVAOKHOA = @ICDPHUVAOKHOA + ISNULL(TENICD, '') +'(' +ISNULL(MAICD,'')+ '); ' FROM TM_ICD WHERE MAICD IN (SELECT S FROM SplitString(@LISTICDPHUVAOKHOA,';'))        SELECT ICD_KHAMBENH, CHANDOANKHAMBENH, CHANDOANVAOKHOA, CHANDOANRAVIEN, CHANDOANKHAC                , CASE        WHEN LEN(ISNULL(BA.CDRAVIEN_PHU,'')) > 0 AND LEN(ISNULL(BA.CDRAVIEN_CHINH,'')) > 0 THEN ISNULL(BA.CDRAVIEN_CHINH,'') + '; ' + ISNULL(BA.CDRAVIEN_PHU,'')        WHEN LEN(ISNULL(BA.CDRAVIEN_PHU,'')) > 0 AND LEN(ISNULL(BA.CDRAVIEN_CHINH,'')) <= 0  THEN BA.CDRAVIEN_PHU        WHEN LEN(ISNULL(BA.CDRAVIEN_PHU,'')) <= 0 AND LEN(ISNULL(BA.CDRAVIEN_CHINH,'')) > 0 THEN BA.CDRAVIEN_CHINH        ELSE NULL END AS CHANDOANNOITRU        ,CASE WHEN @ICDKHAMBENH IS NULL AND (@CHANDOANRAVIEN IS NULL OR @CHANDOANRAVIEN = '') THEN ''        ELSE ISNULL(@ICDKHAMBENH, '') + '; ' + ISNULL(@CHANDOANRAVIEN, '') END        AS CHANDOANCAPCUU        , @ICDPHUVAOKHOA AS CHANDOANPHUVAOKHOA        FROM TT_NOITRU_BENHAN BA LEFT JOIN TM_ICD ICD ON BA.ICD_KHAMBENH = ICD.ICD_ID        WHERE BENHAN_ID =  @param0]
2020-02-26 16:18:50,540 [1] DEBUG - Statement Id: [DAO00061_GetChanDoanBenhAnID] Parameters: [@param0=[BENHAN_ID,24642]]
2020-02-26 16:18:50,540 [1] DEBUG - Statement Id: [DAO00061_GetChanDoanBenhAnID] Types: [@param0=[Int64, System.Int64]]
2020-02-26 16:18:50,583 [1] DEBUG - Statement Id: [DAO00000_GetDoiTuongIsBHYT] PreparedStatement : [select * from TM_DOITUONG Where DOITUONG_ID = 4 and MADOITUONG like '%BHYT%']
2020-02-26 16:18:50,662 [1] DEBUG - Statement Id: [DAO00068_GetLastedSinhHieuInfo] PreparedStatement : [select top (1) *, CHISOBMI as BMI              from TT_NGOAITRU_KHAMBENH_SINHHIEU              where BENHNHAN_ID = '20633'              order by KHAMBENH_SINHHIEU_ID desc]
2020-02-26 16:18:50,686 [1] DEBUG - Statement Id: [DAO00013_GetTienSuBenh] PreparedStatement : [select TIENSUBENH, TIENSUDIUNG        from TT_BENHNHAN        where TT_BENHNHAN.BENHNHAN_ID  = '20633']
2020-02-26 16:18:50,810 [1] DEBUG - Statement Id: [DAO00095_GetTTDiUngThuoc] PreparedStatement : [select *              from TT_BENHNHAN_DIUNG_THUOC              where BENHNHAN_ID = '20633'              and BENHVIEN_ID = 'HLU01']
2020-02-26 16:18:50,885 [1] DEBUG - Statement Id: [DAO00062_GetKhamBenhByTiepNhanID] PreparedStatement : [select *        from TT_NOITRU_KHAMBENH        where BENHAN_ID in        (select BENHAN_ID from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '107181')        and ISYLENHVTYT = '0'         and           BENHAN_ID = '24642'                 order by THOIGIANKHAM desc]
2020-02-26 16:18:50,917 [1] DEBUG - Statement Id: [DAO00063_GetTrangThaiYLenhTheoTiepnhanId] PreparedStatement : [select tt.CHUNGTU_ID, tt.PHIEULINH_ID, tt.TRANGTHAI, pl.DUYET as DUYETPHIEULINH,        ct.CHUNGTU_ID as CHUNGTUXUATNOIBO_ID, ct.LOAICHUNGTU, tt.KHAMBENH_ID, tt.DUOC_ID, tt.SOLUONG        from TT_NOITRU_TOATHUOC tt        left join TT_DUOC_PHIEULINH pl on tt.PHIEULINH_ID = pl.CHUNGTU_ID        left join TT_DUOC_CHUNGTU ct on pl.CHUNGTU_ID = ct.PHIEULINH_ID        where tt.TIEPNHAN_ID = '107181'        and (tt.PHIEULINH_ID is not null or tt.CHUNGTU_ID is not null or (tt.TRANGTHAI = 'DADUYET'))        order by tt.CHUNGTU_ID DESC]
2020-02-26 16:18:50,945 [1] DEBUG - Statement Id: [DAO00063_GetDanhsachTrathuocTheoBenhanId] PreparedStatement : [select A.KHAMBENH_ID, B.TOATHUOC_ID, B.DUOC_ID, SUM(B.SOLUONG) SOLUONG        from TT_NOITRU_TRATHUOC A        left join TT_NOITRU_TRATHUOC_CHITIET B on A.TRATHUOC_ID = B.TRATHUOC_ID        where A.BENHAN_ID = '24642'         group by A.KHAMBENH_ID, B.TOATHUOC_ID, B.DUOC_ID]
2020-02-26 16:18:51,157 [1] DEBUG - Statement Id: [DAO00014_GetInPatientStatus] PreparedStatement : [select TRANGTHAI, isnull(KHOACHUYENDEN_ID, KHOAVAO_ID) as KHOAHIENTAI from TT_NOITRU_BENHAN        where        TIEPNHAN_ID = '107181'        and BENHVIEN_ID = 'HLU01'         and           BENHAN_ID = '24642']
2020-02-26 16:19:09,207 [1] DEBUG - Statement Id: [DAO00030_Get_DuocCanhBaoICD_ByBenhAn_ID] PreparedStatement : [select A.*          from TM_DUOC_CANHBAO_ICD A          inner join TM_DUOC_HOATCHAT B on B.HOATCHAT_ID = A.HOATCHAT_ID          inner join TM_DUOC_THANHPHANHOATCHAT C on C.HOATCHAT_ID = B.HOATCHAT_ID          inner join TM_DUOC D on D.DUOC_ID = C.DUOC_ID          inner join TT_NOITRU_BENHAN BA on (BA.ICD_VAOKHOA = A.ICD_ID or BA.ICD_KHAMBENH = A.ICD_ID or BA.ICD_BENHCHINH = A.ICD_ID or BA.ICDRAVIEN_CHINH = A.ICD_ID          or A.MAICD in (select part from fnSplit(BA.ICD_BENHPHU, ';'))           or A.MAICD in (select part from fnSplit(BA.ICDRAVIEN_PHU, ';'))          or A.MAICD in (select part from fnSplit(BA.ICD_PHU_VAOKHOA, ';'))) and BA.BENHAN_ID = 24642          where C.DUOC_ID = 1030          and A.TAMNGUNG = '0'          and A.BENHVIEN_ID = 'HLU01']
2020-02-26 16:19:09,242 [1] DEBUG - Statement Id: [DAO00013_GetTienSuBenh] PreparedStatement : [select TIENSUBENH, TIENSUDIUNG        from TT_BENHNHAN        where TT_BENHNHAN.BENHNHAN_ID  = '20633']
2020-02-26 16:19:09,268 [1] DEBUG - Statement Id: [DAO00095_GetTTDiUngThuoc] PreparedStatement : [select *              from TT_BENHNHAN_DIUNG_THUOC              where BENHNHAN_ID = '20633'              and BENHVIEN_ID = 'HLU01']
2020-02-26 16:19:09,293 [1] DEBUG - Statement Id: [DAO00096_GetList] PreparedStatement : [select *        from TM_DUOC_THANHPHANHOATCHAT        where BENHVIEN_ID = 'HLU01']
2020-02-26 16:19:09,332 [1] DEBUG - Statement Id: [DAO00013_GetTienSuBenh] PreparedStatement : [select TIENSUBENH, TIENSUDIUNG        from TT_BENHNHAN        where TT_BENHNHAN.BENHNHAN_ID  = '20633']
2020-02-26 16:19:09,357 [1] DEBUG - Statement Id: [DAO00095_GetTTDiUngThuoc] PreparedStatement : [select *              from TT_BENHNHAN_DIUNG_THUOC              where BENHNHAN_ID = '20633'              and BENHVIEN_ID = 'HLU01']
2020-02-26 16:19:09,387 [1] DEBUG - Statement Id: [DAO00016_GetTTDuocCanhBao] PreparedStatement : [select *        from TM_DUOC_CANHBAO         where                 DUOC_ID = '1030'             and               BENHVIEN_ID = 'HLU01'                     order by DUOC_CANHBAO_ID]
2020-02-26 16:19:09,425 [1] DEBUG - Statement Id: [DAO00000_GetCHECK_DOITUONG_BHYT] PreparedStatement : [select count(*) as DOITUONG_BHYT FROM TM_DOITUONG A            WHERE A.DOITUONG_ID = '4' and A.BENHVIEN_ID = 'HLU01' and MADOITUONG like '%BHYT%']
2020-02-26 16:19:09,453 [1] DEBUG - Statement Id: [DAO00000_GetLOAIGIATHUOC_NOI_NGOAI_VIEN] PreparedStatement : [SELECT LOAIGIA_ID              FROM TM_LOAIGIA              WHERE MALOAIGIA = 'GiaThuoc_NoiVien' and BENHVIEN_ID = 'HLU01']
2020-02-26 16:19:11,076 [1] DEBUG - Statement Id: [DAO00000_GetDUOC_DONGIADOANHTHU_NOIVIEN] PreparedStatement : [declare @doanhthuKhongHT numeric(24,2);          declare @doanhthu numeric(24,2);          declare @hotro numeric(24,2);          declare @bhyt char(1);          declare @loaigia_id int, @loaigiakhonght_id int            select top 1 @doanhthuKhongHT = dg.DONGIA, @loaigiakhonght_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0 and GIAHOTRO != '1'          order by dtlg.DOUUTIEN asc          select top 1 @doanhthu = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0           order by dtlg.DOUUTIEN asc          select top 1 @hotro = dg.DONGIA, @loaigia_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0  and GIAHOTRO = '1'          order by dtlg.DOUUTIEN asc          select top 1 @bhyt = BHYT from TM_DUOC where DUOC_ID = 1030          select ISNULL(@doanhthu,0.0) DONGIA_DOANHTHU, ISNULL(@hotro, 0.0) DONGIA_KHAC, ISNULL(@doanhthuKhongHT, 0.0) DONGIA_KHONGHT, isnull(@bhyt, '0') BHYT, ISNULL(@loaigia_id, 0) as LOAIGIA_ID, ISNULL(@loaigiakhonght_id, 0) as LOAIGIAKHONGHT_ID]
2020-02-26 16:19:12,360 [1] DEBUG - Statement Id: [DAO00000_GetDuocBHYT] PreparedStatement : [select count(*) BHYT FROM TM_DUOC A WHERE A.DUOC_ID = '1030' and BHYT = '1']
2020-02-26 16:19:13,850 [1] DEBUG - Statement Id: [DAO00000_GetCHECK_DOITUONG_BHYT] PreparedStatement : [select count(*) as DOITUONG_BHYT FROM TM_DOITUONG A            WHERE A.DOITUONG_ID = '4' and A.BENHVIEN_ID = 'HLU01' and MADOITUONG like '%BHYT%']
2020-02-26 16:19:14,178 [1] DEBUG - Statement Id: [DAO00000_GetLOAIGIATHUOC_NOI_NGOAI_VIEN] PreparedStatement : [SELECT LOAIGIA_ID              FROM TM_LOAIGIA              WHERE MALOAIGIA = 'GiaThuoc_NoiVien' and BENHVIEN_ID = 'HLU01']
2020-02-26 16:19:15,589 [1] DEBUG - Statement Id: [DAO00000_GetDUOC_DONGIADOANHTHU_NOIVIEN] PreparedStatement : [declare @doanhthuKhongHT numeric(24,2);          declare @doanhthu numeric(24,2);          declare @hotro numeric(24,2);          declare @bhyt char(1);          declare @loaigia_id int, @loaigiakhonght_id int            select top 1 @doanhthuKhongHT = dg.DONGIA, @loaigiakhonght_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0 and GIAHOTRO != '1'          order by dtlg.DOUUTIEN asc          select top 1 @doanhthu = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0           order by dtlg.DOUUTIEN asc          select top 1 @hotro = dg.DONGIA, @loaigia_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0  and GIAHOTRO = '1'          order by dtlg.DOUUTIEN asc          select top 1 @bhyt = BHYT from TM_DUOC where DUOC_ID = 1030          select ISNULL(@doanhthu,0.0) DONGIA_DOANHTHU, ISNULL(@hotro, 0.0) DONGIA_KHAC, ISNULL(@doanhthuKhongHT, 0.0) DONGIA_KHONGHT, isnull(@bhyt, '0') BHYT, ISNULL(@loaigia_id, 0) as LOAIGIA_ID, ISNULL(@loaigiakhonght_id, 0) as LOAIGIAKHONGHT_ID]
2020-02-26 16:19:16,789 [1] DEBUG - Statement Id: [DAO00000_GetDuocBHYT] PreparedStatement : [select count(*) BHYT FROM TM_DUOC A WHERE A.DUOC_ID = '1030' and BHYT = '1']
2020-02-26 16:19:27,331 [1] DEBUG - Statement Id: [DAO00030_Get_DuocCanhBaoICD_ByBenhAn_ID] PreparedStatement : [select A.*          from TM_DUOC_CANHBAO_ICD A          inner join TM_DUOC_HOATCHAT B on B.HOATCHAT_ID = A.HOATCHAT_ID          inner join TM_DUOC_THANHPHANHOATCHAT C on C.HOATCHAT_ID = B.HOATCHAT_ID          inner join TM_DUOC D on D.DUOC_ID = C.DUOC_ID          inner join TT_NOITRU_BENHAN BA on (BA.ICD_VAOKHOA = A.ICD_ID or BA.ICD_KHAMBENH = A.ICD_ID or BA.ICD_BENHCHINH = A.ICD_ID or BA.ICDRAVIEN_CHINH = A.ICD_ID          or A.MAICD in (select part from fnSplit(BA.ICD_BENHPHU, ';'))           or A.MAICD in (select part from fnSplit(BA.ICDRAVIEN_PHU, ';'))          or A.MAICD in (select part from fnSplit(BA.ICD_PHU_VAOKHOA, ';'))) and BA.BENHAN_ID = 24642          where C.DUOC_ID = 1030          and A.TAMNGUNG = '0'          and A.BENHVIEN_ID = 'HLU01']
2020-02-26 16:19:27,372 [1] DEBUG - Statement Id: [DAO00013_GetTienSuBenh] PreparedStatement : [select TIENSUBENH, TIENSUDIUNG        from TT_BENHNHAN        where TT_BENHNHAN.BENHNHAN_ID  = '20633']
2020-02-26 16:19:27,398 [1] DEBUG - Statement Id: [DAO00095_GetTTDiUngThuoc] PreparedStatement : [select *              from TT_BENHNHAN_DIUNG_THUOC              where BENHNHAN_ID = '20633'              and BENHVIEN_ID = 'HLU01']
2020-02-26 16:19:27,421 [1] DEBUG - Statement Id: [DAO00096_GetList] PreparedStatement : [select *        from TM_DUOC_THANHPHANHOATCHAT        where BENHVIEN_ID = 'HLU01']
2020-02-26 16:19:27,457 [1] DEBUG - Statement Id: [DAO00013_GetTienSuBenh] PreparedStatement : [select TIENSUBENH, TIENSUDIUNG        from TT_BENHNHAN        where TT_BENHNHAN.BENHNHAN_ID  = '20633']
2020-02-26 16:19:27,481 [1] DEBUG - Statement Id: [DAO00095_GetTTDiUngThuoc] PreparedStatement : [select *              from TT_BENHNHAN_DIUNG_THUOC              where BENHNHAN_ID = '20633'              and BENHVIEN_ID = 'HLU01']
2020-02-26 16:19:27,504 [1] DEBUG - Statement Id: [DAO00016_GetTTDuocCanhBao] PreparedStatement : [select *        from TM_DUOC_CANHBAO         where                 DUOC_ID = '1030'             and               BENHVIEN_ID = 'HLU01'                     order by DUOC_CANHBAO_ID]
2020-02-26 16:19:27,536 [1] DEBUG - Statement Id: [DAO00000_GetCHECK_DOITUONG_BHYT] PreparedStatement : [select count(*) as DOITUONG_BHYT FROM TM_DOITUONG A            WHERE A.DOITUONG_ID = '4' and A.BENHVIEN_ID = 'HLU01' and MADOITUONG like '%BHYT%']
2020-02-26 16:19:27,558 [1] DEBUG - Statement Id: [DAO00000_GetLOAIGIATHUOC_NOI_NGOAI_VIEN] PreparedStatement : [SELECT LOAIGIA_ID              FROM TM_LOAIGIA              WHERE MALOAIGIA = 'GiaThuoc_NoiVien' and BENHVIEN_ID = 'HLU01']
2020-02-26 16:19:29,089 [1] DEBUG - Statement Id: [DAO00000_GetDUOC_DONGIADOANHTHU_NOIVIEN] PreparedStatement : [declare @doanhthuKhongHT numeric(24,2);          declare @doanhthu numeric(24,2);          declare @hotro numeric(24,2);          declare @bhyt char(1);          declare @loaigia_id int, @loaigiakhonght_id int            select top 1 @doanhthuKhongHT = dg.DONGIA, @loaigiakhonght_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0 and GIAHOTRO != '1'          order by dtlg.DOUUTIEN asc          select top 1 @doanhthu = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0           order by dtlg.DOUUTIEN asc          select top 1 @hotro = dg.DONGIA, @loaigia_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0  and GIAHOTRO = '1'          order by dtlg.DOUUTIEN asc          select top 1 @bhyt = BHYT from TM_DUOC where DUOC_ID = 1030          select ISNULL(@doanhthu,0.0) DONGIA_DOANHTHU, ISNULL(@hotro, 0.0) DONGIA_KHAC, ISNULL(@doanhthuKhongHT, 0.0) DONGIA_KHONGHT, isnull(@bhyt, '0') BHYT, ISNULL(@loaigia_id, 0) as LOAIGIA_ID, ISNULL(@loaigiakhonght_id, 0) as LOAIGIAKHONGHT_ID]
2020-02-26 16:19:30,390 [1] DEBUG - Statement Id: [DAO00000_GetDuocBHYT] PreparedStatement : [select count(*) BHYT FROM TM_DUOC A WHERE A.DUOC_ID = '1030' and BHYT = '1']
2020-02-26 16:19:31,419 [1] DEBUG - Statement Id: [DAO00000_GetCHECK_DOITUONG_BHYT] PreparedStatement : [select count(*) as DOITUONG_BHYT FROM TM_DOITUONG A            WHERE A.DOITUONG_ID = '4' and A.BENHVIEN_ID = 'HLU01' and MADOITUONG like '%BHYT%']
2020-02-26 16:19:31,445 [1] DEBUG - Statement Id: [DAO00000_GetLOAIGIATHUOC_NOI_NGOAI_VIEN] PreparedStatement : [SELECT LOAIGIA_ID              FROM TM_LOAIGIA              WHERE MALOAIGIA = 'GiaThuoc_NoiVien' and BENHVIEN_ID = 'HLU01']
2020-02-26 16:19:32,450 [1] DEBUG - Statement Id: [DAO00000_GetDUOC_DONGIADOANHTHU_NOIVIEN] PreparedStatement : [declare @doanhthuKhongHT numeric(24,2);          declare @doanhthu numeric(24,2);          declare @hotro numeric(24,2);          declare @bhyt char(1);          declare @loaigia_id int, @loaigiakhonght_id int            select top 1 @doanhthuKhongHT = dg.DONGIA, @loaigiakhonght_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0 and GIAHOTRO != '1'          order by dtlg.DOUUTIEN asc          select top 1 @doanhthu = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0           order by dtlg.DOUUTIEN asc          select top 1 @hotro = dg.DONGIA, @loaigia_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0  and GIAHOTRO = '1'          order by dtlg.DOUUTIEN asc          select top 1 @bhyt = BHYT from TM_DUOC where DUOC_ID = 1030          select ISNULL(@doanhthu,0.0) DONGIA_DOANHTHU, ISNULL(@hotro, 0.0) DONGIA_KHAC, ISNULL(@doanhthuKhongHT, 0.0) DONGIA_KHONGHT, isnull(@bhyt, '0') BHYT, ISNULL(@loaigia_id, 0) as LOAIGIA_ID, ISNULL(@loaigiakhonght_id, 0) as LOAIGIAKHONGHT_ID]
2020-02-26 16:19:33,925 [1] DEBUG - Statement Id: [DAO00000_GetDuocBHYT] PreparedStatement : [select count(*) BHYT FROM TM_DUOC A WHERE A.DUOC_ID = '1030' and BHYT = '1']
2020-02-26 16:19:57,283 [1] DEBUG - Statement Id: [DAO00030_Get_DuocCanhBaoICD_ByBenhAn_ID] PreparedStatement : [select A.*          from TM_DUOC_CANHBAO_ICD A          inner join TM_DUOC_HOATCHAT B on B.HOATCHAT_ID = A.HOATCHAT_ID          inner join TM_DUOC_THANHPHANHOATCHAT C on C.HOATCHAT_ID = B.HOATCHAT_ID          inner join TM_DUOC D on D.DUOC_ID = C.DUOC_ID          inner join TT_NOITRU_BENHAN BA on (BA.ICD_VAOKHOA = A.ICD_ID or BA.ICD_KHAMBENH = A.ICD_ID or BA.ICD_BENHCHINH = A.ICD_ID or BA.ICDRAVIEN_CHINH = A.ICD_ID          or A.MAICD in (select part from fnSplit(BA.ICD_BENHPHU, ';'))           or A.MAICD in (select part from fnSplit(BA.ICDRAVIEN_PHU, ';'))          or A.MAICD in (select part from fnSplit(BA.ICD_PHU_VAOKHOA, ';'))) and BA.BENHAN_ID = 24642          where C.DUOC_ID = 934          and A.TAMNGUNG = '0'          and A.BENHVIEN_ID = 'HLU01']
2020-02-26 16:19:57,335 [1] DEBUG - Statement Id: [DAO00013_GetTienSuBenh] PreparedStatement : [select TIENSUBENH, TIENSUDIUNG        from TT_BENHNHAN        where TT_BENHNHAN.BENHNHAN_ID  = '20633']
2020-02-26 16:19:57,359 [1] DEBUG - Statement Id: [DAO00095_GetTTDiUngThuoc] PreparedStatement : [select *              from TT_BENHNHAN_DIUNG_THUOC              where BENHNHAN_ID = '20633'              and BENHVIEN_ID = 'HLU01']
2020-02-26 16:19:57,385 [1] DEBUG - Statement Id: [DAO00096_GetList] PreparedStatement : [select *        from TM_DUOC_THANHPHANHOATCHAT        where BENHVIEN_ID = 'HLU01']
2020-02-26 16:19:57,416 [1] DEBUG - Statement Id: [DAO00013_GetTienSuBenh] PreparedStatement : [select TIENSUBENH, TIENSUDIUNG        from TT_BENHNHAN        where TT_BENHNHAN.BENHNHAN_ID  = '20633']
2020-02-26 16:19:57,439 [1] DEBUG - Statement Id: [DAO00095_GetTTDiUngThuoc] PreparedStatement : [select *              from TT_BENHNHAN_DIUNG_THUOC              where BENHNHAN_ID = '20633'              and BENHVIEN_ID = 'HLU01']
2020-02-26 16:19:57,464 [1] DEBUG - Statement Id: [DAO00016_GetTTDuocCanhBao] PreparedStatement : [select *        from TM_DUOC_CANHBAO         where                 DUOC_ID = '934'             and               BENHVIEN_ID = 'HLU01'                     order by DUOC_CANHBAO_ID]
2020-02-26 16:19:57,492 [1] DEBUG - Statement Id: [DAO00000_GetCHECK_DOITUONG_BHYT] PreparedStatement : [select count(*) as DOITUONG_BHYT FROM TM_DOITUONG A            WHERE A.DOITUONG_ID = '4' and A.BENHVIEN_ID = 'HLU01' and MADOITUONG like '%BHYT%']
2020-02-26 16:19:57,515 [1] DEBUG - Statement Id: [DAO00000_GetLOAIGIATHUOC_NOI_NGOAI_VIEN] PreparedStatement : [SELECT LOAIGIA_ID              FROM TM_LOAIGIA              WHERE MALOAIGIA = 'GiaThuoc_NoiVien' and BENHVIEN_ID = 'HLU01']
2020-02-26 16:19:58,984 [1] DEBUG - Statement Id: [DAO00000_GetDUOC_DONGIADOANHTHU_NOIVIEN] PreparedStatement : [declare @doanhthuKhongHT numeric(24,2);          declare @doanhthu numeric(24,2);          declare @hotro numeric(24,2);          declare @bhyt char(1);          declare @loaigia_id int, @loaigiakhonght_id int            select top 1 @doanhthuKhongHT = dg.DONGIA, @loaigiakhonght_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '934' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0 and GIAHOTRO != '1'          order by dtlg.DOUUTIEN asc          select top 1 @doanhthu = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '934' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0           order by dtlg.DOUUTIEN asc          select top 1 @hotro = dg.DONGIA, @loaigia_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '934' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0  and GIAHOTRO = '1'          order by dtlg.DOUUTIEN asc          select top 1 @bhyt = BHYT from TM_DUOC where DUOC_ID = 934          select ISNULL(@doanhthu,0.0) DONGIA_DOANHTHU, ISNULL(@hotro, 0.0) DONGIA_KHAC, ISNULL(@doanhthuKhongHT, 0.0) DONGIA_KHONGHT, isnull(@bhyt, '0') BHYT, ISNULL(@loaigia_id, 0) as LOAIGIA_ID, ISNULL(@loaigiakhonght_id, 0) as LOAIGIAKHONGHT_ID]
2020-02-26 16:20:00,439 [1] DEBUG - Statement Id: [DAO00000_GetDuocBHYT] PreparedStatement : [select count(*) BHYT FROM TM_DUOC A WHERE A.DUOC_ID = '934' and BHYT = '1']
2020-02-26 16:20:01,567 [1] DEBUG - Statement Id: [DAO00000_GetCHECK_DOITUONG_BHYT] PreparedStatement : [select count(*) as DOITUONG_BHYT FROM TM_DOITUONG A            WHERE A.DOITUONG_ID = '4' and A.BENHVIEN_ID = 'HLU01' and MADOITUONG like '%BHYT%']
2020-02-26 16:20:01,591 [1] DEBUG - Statement Id: [DAO00000_GetLOAIGIATHUOC_NOI_NGOAI_VIEN] PreparedStatement : [SELECT LOAIGIA_ID              FROM TM_LOAIGIA              WHERE MALOAIGIA = 'GiaThuoc_NoiVien' and BENHVIEN_ID = 'HLU01']
2020-02-26 16:20:02,738 [1] DEBUG - Statement Id: [DAO00000_GetDUOC_DONGIADOANHTHU_NOIVIEN] PreparedStatement : [declare @doanhthuKhongHT numeric(24,2);          declare @doanhthu numeric(24,2);          declare @hotro numeric(24,2);          declare @bhyt char(1);          declare @loaigia_id int, @loaigiakhonght_id int            select top 1 @doanhthuKhongHT = dg.DONGIA, @loaigiakhonght_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '934' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0 and GIAHOTRO != '1'          order by dtlg.DOUUTIEN asc          select top 1 @doanhthu = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '934' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0           order by dtlg.DOUUTIEN asc          select top 1 @hotro = dg.DONGIA, @loaigia_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '934' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0  and GIAHOTRO = '1'          order by dtlg.DOUUTIEN asc          select top 1 @bhyt = BHYT from TM_DUOC where DUOC_ID = 934          select ISNULL(@doanhthu,0.0) DONGIA_DOANHTHU, ISNULL(@hotro, 0.0) DONGIA_KHAC, ISNULL(@doanhthuKhongHT, 0.0) DONGIA_KHONGHT, isnull(@bhyt, '0') BHYT, ISNULL(@loaigia_id, 0) as LOAIGIA_ID, ISNULL(@loaigiakhonght_id, 0) as LOAIGIAKHONGHT_ID]
2020-02-26 16:20:03,919 [1] DEBUG - Statement Id: [DAO00000_GetDuocBHYT] PreparedStatement : [select count(*) BHYT FROM TM_DUOC A WHERE A.DUOC_ID = '934' and BHYT = '1']
2020-02-26 16:20:08,948 [1] DEBUG - Statement Id: [DAO00062_GetThongTinNhapVienCuaBenhNhan] PreparedStatement : [select top 1 ba.THOIGIANVAOKHOA THOIGIANVAO        from TT_NOITRU_BENHAN ba        where ba.BENHAN_ID =  @param0]
2020-02-26 16:20:08,948 [1] DEBUG - Statement Id: [DAO00062_GetThongTinNhapVienCuaBenhNhan] Parameters: [@param0=[BENHAN_ID,24642]]
2020-02-26 16:20:08,948 [1] DEBUG - Statement Id: [DAO00062_GetThongTinNhapVienCuaBenhNhan] Types: [@param0=[Int64, System.Int64]]
2020-02-26 16:20:09,089 [1] DEBUG - Statement Id: [DAO00014_GetInPatientStatus] PreparedStatement : [select TRANGTHAI, isnull(KHOACHUYENDEN_ID, KHOAVAO_ID) as KHOAHIENTAI from TT_NOITRU_BENHAN        where        TIEPNHAN_ID = '107181'        and BENHVIEN_ID = 'HLU01'         and           BENHAN_ID = '24642']
2020-02-26 16:20:11,878 [1] DEBUG - Statement Id: [DAO00000_GetCHECK_DOITUONG_BHYT] PreparedStatement : [select count(*) as DOITUONG_BHYT FROM TM_DOITUONG A            WHERE A.DOITUONG_ID = '4' and A.BENHVIEN_ID = 'HLU01' and MADOITUONG like '%BHYT%']
2020-02-26 16:20:11,902 [1] DEBUG - Statement Id: [DAO00000_GetLOAIGIATHUOC_NOI_NGOAI_VIEN] PreparedStatement : [SELECT LOAIGIA_ID              FROM TM_LOAIGIA              WHERE MALOAIGIA = 'GiaThuoc_NoiVien' and BENHVIEN_ID = 'HLU01']
2020-02-26 16:20:14,223 [1] DEBUG - Statement Id: [DAO00000_GetDUOC_DONGIADOANHTHU_NOIVIEN] PreparedStatement : [declare @doanhthuKhongHT numeric(24,2);          declare @doanhthu numeric(24,2);          declare @hotro numeric(24,2);          declare @bhyt char(1);          declare @loaigia_id int, @loaigiakhonght_id int            select top 1 @doanhthuKhongHT = dg.DONGIA, @loaigiakhonght_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0 and GIAHOTRO != '1'          order by dtlg.DOUUTIEN asc          select top 1 @doanhthu = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0           order by dtlg.DOUUTIEN asc          select top 1 @hotro = dg.DONGIA, @loaigia_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0  and GIAHOTRO = '1'          order by dtlg.DOUUTIEN asc          select top 1 @bhyt = BHYT from TM_DUOC where DUOC_ID = 1030          select ISNULL(@doanhthu,0.0) DONGIA_DOANHTHU, ISNULL(@hotro, 0.0) DONGIA_KHAC, ISNULL(@doanhthuKhongHT, 0.0) DONGIA_KHONGHT, isnull(@bhyt, '0') BHYT, ISNULL(@loaigia_id, 0) as LOAIGIA_ID, ISNULL(@loaigiakhonght_id, 0) as LOAIGIAKHONGHT_ID]
2020-02-26 16:20:16,182 [1] DEBUG - Statement Id: [DAO00000_GetDuocBHYT] PreparedStatement : [select count(*) BHYT FROM TM_DUOC A WHERE A.DUOC_ID = '1030' and BHYT = '1']
2020-02-26 16:20:19,087 [1] DEBUG - Statement Id: [DAO00000_GetCHECK_DOITUONG_BHYT] PreparedStatement : [select count(*) as DOITUONG_BHYT FROM TM_DOITUONG A            WHERE A.DOITUONG_ID = '4' and A.BENHVIEN_ID = 'HLU01' and MADOITUONG like '%BHYT%']
2020-02-26 16:20:19,213 [1] DEBUG - Statement Id: [DAO00000_GetLOAIGIATHUOC_NOI_NGOAI_VIEN] PreparedStatement : [SELECT LOAIGIA_ID              FROM TM_LOAIGIA              WHERE MALOAIGIA = 'GiaThuoc_NoiVien' and BENHVIEN_ID = 'HLU01']
2020-02-26 16:20:20,387 [1] DEBUG - Statement Id: [DAO00000_GetDUOC_DONGIADOANHTHU_NOIVIEN] PreparedStatement : [declare @doanhthuKhongHT numeric(24,2);          declare @doanhthu numeric(24,2);          declare @hotro numeric(24,2);          declare @bhyt char(1);          declare @loaigia_id int, @loaigiakhonght_id int            select top 1 @doanhthuKhongHT = dg.DONGIA, @loaigiakhonght_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0 and GIAHOTRO != '1'          order by dtlg.DOUUTIEN asc          select top 1 @doanhthu = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0           order by dtlg.DOUUTIEN asc          select top 1 @hotro = dg.DONGIA, @loaigia_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0  and GIAHOTRO = '1'          order by dtlg.DOUUTIEN asc          select top 1 @bhyt = BHYT from TM_DUOC where DUOC_ID = 1030          select ISNULL(@doanhthu,0.0) DONGIA_DOANHTHU, ISNULL(@hotro, 0.0) DONGIA_KHAC, ISNULL(@doanhthuKhongHT, 0.0) DONGIA_KHONGHT, isnull(@bhyt, '0') BHYT, ISNULL(@loaigia_id, 0) as LOAIGIA_ID, ISNULL(@loaigiakhonght_id, 0) as LOAIGIAKHONGHT_ID]
2020-02-26 16:20:21,480 [1] DEBUG - Statement Id: [DAO00000_GetDuocBHYT] PreparedStatement : [select count(*) BHYT FROM TM_DUOC A WHERE A.DUOC_ID = '1030' and BHYT = '1']
2020-02-26 16:20:23,661 [1] DEBUG - Statement Id: [DAO00000_GetCHECK_DOITUONG_BHYT] PreparedStatement : [select count(*) as DOITUONG_BHYT FROM TM_DOITUONG A            WHERE A.DOITUONG_ID = '4' and A.BENHVIEN_ID = 'HLU01' and MADOITUONG like '%BHYT%']
2020-02-26 16:20:23,744 [1] DEBUG - Statement Id: [DAO00000_GetLOAIGIATHUOC_NOI_NGOAI_VIEN] PreparedStatement : [SELECT LOAIGIA_ID              FROM TM_LOAIGIA              WHERE MALOAIGIA = 'GiaThuoc_NoiVien' and BENHVIEN_ID = 'HLU01']
2020-02-26 16:20:24,830 [1] DEBUG - Statement Id: [DAO00000_GetDUOC_DONGIADOANHTHU_NOIVIEN] PreparedStatement : [declare @doanhthuKhongHT numeric(24,2);          declare @doanhthu numeric(24,2);          declare @hotro numeric(24,2);          declare @bhyt char(1);          declare @loaigia_id int, @loaigiakhonght_id int            select top 1 @doanhthuKhongHT = dg.DONGIA, @loaigiakhonght_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '934' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0 and GIAHOTRO != '1'          order by dtlg.DOUUTIEN asc          select top 1 @doanhthu = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '934' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0           order by dtlg.DOUUTIEN asc          select top 1 @hotro = dg.DONGIA, @loaigia_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '934' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0  and GIAHOTRO = '1'          order by dtlg.DOUUTIEN asc          select top 1 @bhyt = BHYT from TM_DUOC where DUOC_ID = 934          select ISNULL(@doanhthu,0.0) DONGIA_DOANHTHU, ISNULL(@hotro, 0.0) DONGIA_KHAC, ISNULL(@doanhthuKhongHT, 0.0) DONGIA_KHONGHT, isnull(@bhyt, '0') BHYT, ISNULL(@loaigia_id, 0) as LOAIGIA_ID, ISNULL(@loaigiakhonght_id, 0) as LOAIGIAKHONGHT_ID]
2020-02-26 16:20:25,618 [1] DEBUG - Statement Id: [DAO00000_GetDuocBHYT] PreparedStatement : [select count(*) BHYT FROM TM_DUOC A WHERE A.DUOC_ID = '934' and BHYT = '1']
2020-02-26 16:20:26,967 [1] DEBUG - Statement Id: [DAO00030_GetKhoDuocByPhamVi] PreparedStatement : [SELECT DISTINCT mp.KHODUOC_ID, lk.DICTIONARY_CODE as LOAIKHO          FROM TM_DUOC_PHAMVISD_MAPPING mp          INNER JOIN TM_KHODUOC kd on kd.KHODUOC_ID = mp.KHODUOC_ID          INNER JOIN LST_DICTIONARY lk on lk.DICTIONARY_ID = kd.LOAIKHO_ID          WHERE          mp.PHAMVI_ID = 1027          AND mp.BENHVIEN_ID ='HLU01'          AND mp.TAMNGUNG = '0']
2020-02-26 16:20:27,064 [1] DEBUG - Statement Id: [DAO00063_KiemtraSoluongDuocXuat] PreparedStatement : [select A.TONKHO, isnull(B.BOOK_NGOAI,0) BOOK_NGOAI, isnull(D.BOOK_NOI,0) BOOK_NOI, isnull(C.BOOK_NOI_THUOC,0) BOOK_NOI_THUOC, (A.TONKHO - isnull(B.BOOK_NGOAI,0) - isnull(D.BOOK_NOI,0)) TONKHO_BOOK        from(        select SUM(tk.SOLUONG) TONKHO, tk.DUOC_ID, sd.PHAMVI_ID, tk.NGUONDUOC_ID from TT_DUOC_TONKHO tk        inner join TM_DUOC_PHAMVISD_MAPPING sd on sd.KHODUOC_ID = tk.KHODUOC_ID        where sd.PHAMVI_ID  = '1027' and tk.DUOC_ID = '1030' and tk.NGUONDUOC_ID = '1'        group by tk.DUOC_ID, sd.PHAMVI_ID, tk.NGUONDUOC_ID) A        left join (        select SUM(SOLUONG) BOOK_NGOAI,DUOC_ID, PHAMVI_ID, NGUONHANG_ID from TT_DUOC_TONKHO_BOOK_NGOAITRU        where PHAMVI_ID  = '1027' and DUOC_ID = '1030' and NGUONHANG_ID = '1' and TRANGTHAI = 'HIEULUC'  and SOLUONG > 0        group by DUOC_ID, PHAMVI_ID, NGUONHANG_ID) B on A.DUOC_ID = B.DUOC_ID and A.PHAMVI_ID = B.PHAMVI_ID and A.NGUONDUOC_ID = B.NGUONHANG_ID        left join (        select SUM(SOLUONG) BOOK_NOI_THUOC,DUOC_ID, PHAMVI_ID, NGUONHANG_ID from TT_DUOC_TONKHO_BOOK_NOITRU        where PHAMVI_ID  = '1027' and DUOC_ID = '1030' and NGUONHANG_ID = '1' and REF_ID = '' and REF_TABLE = 'TT_NOITRU_TOATHUOC' and TRANGTHAI = 'HIEULUC' and SOLUONG > 0        group by DUOC_ID, PHAMVI_ID, NGUONHANG_ID) C on A.DUOC_ID = C.DUOC_ID and A.PHAMVI_ID = C.PHAMVI_ID and A.NGUONDUOC_ID = C.NGUONHANG_ID        left join (        select SUM(SOLUONG) BOOK_NOI,DUOC_ID, PHAMVI_ID, NGUONHANG_ID from TT_DUOC_TONKHO_BOOK_NOITRU        where PHAMVI_ID  = '1027' and DUOC_ID = '1030' and NGUONHANG_ID = '1' and TRANGTHAI = 'HIEULUC'  and SOLUONG > 0        group by DUOC_ID, PHAMVI_ID, NGUONHANG_ID) D on A.DUOC_ID = D.DUOC_ID and A.PHAMVI_ID = D.PHAMVI_ID and A.NGUONDUOC_ID = D.NGUONHANG_ID]
2020-02-26 16:20:27,104 [1] DEBUG - Statement Id: [DAO00063_KiemtraSoluongDuocXuat] PreparedStatement : [select A.TONKHO, isnull(B.BOOK_NGOAI,0) BOOK_NGOAI, isnull(D.BOOK_NOI,0) BOOK_NOI, isnull(C.BOOK_NOI_THUOC,0) BOOK_NOI_THUOC, (A.TONKHO - isnull(B.BOOK_NGOAI,0) - isnull(D.BOOK_NOI,0)) TONKHO_BOOK        from(        select SUM(tk.SOLUONG) TONKHO, tk.DUOC_ID, sd.PHAMVI_ID, tk.NGUONDUOC_ID from TT_DUOC_TONKHO tk        inner join TM_DUOC_PHAMVISD_MAPPING sd on sd.KHODUOC_ID = tk.KHODUOC_ID        where sd.PHAMVI_ID  = '1027' and tk.DUOC_ID = '1030' and tk.NGUONDUOC_ID = '1'        group by tk.DUOC_ID, sd.PHAMVI_ID, tk.NGUONDUOC_ID) A        left join (        select SUM(SOLUONG) BOOK_NGOAI,DUOC_ID, PHAMVI_ID, NGUONHANG_ID from TT_DUOC_TONKHO_BOOK_NGOAITRU        where PHAMVI_ID  = '1027' and DUOC_ID = '1030' and NGUONHANG_ID = '1' and TRANGTHAI = 'HIEULUC'  and SOLUONG > 0        group by DUOC_ID, PHAMVI_ID, NGUONHANG_ID) B on A.DUOC_ID = B.DUOC_ID and A.PHAMVI_ID = B.PHAMVI_ID and A.NGUONDUOC_ID = B.NGUONHANG_ID        left join (        select SUM(SOLUONG) BOOK_NOI_THUOC,DUOC_ID, PHAMVI_ID, NGUONHANG_ID from TT_DUOC_TONKHO_BOOK_NOITRU        where PHAMVI_ID  = '1027' and DUOC_ID = '1030' and NGUONHANG_ID = '1' and REF_ID = '' and REF_TABLE = 'TT_NOITRU_TOATHUOC' and TRANGTHAI = 'HIEULUC' and SOLUONG > 0        group by DUOC_ID, PHAMVI_ID, NGUONHANG_ID) C on A.DUOC_ID = C.DUOC_ID and A.PHAMVI_ID = C.PHAMVI_ID and A.NGUONDUOC_ID = C.NGUONHANG_ID        left join (        select SUM(SOLUONG) BOOK_NOI,DUOC_ID, PHAMVI_ID, NGUONHANG_ID from TT_DUOC_TONKHO_BOOK_NOITRU        where PHAMVI_ID  = '1027' and DUOC_ID = '1030' and NGUONHANG_ID = '1' and TRANGTHAI = 'HIEULUC'  and SOLUONG > 0        group by DUOC_ID, PHAMVI_ID, NGUONHANG_ID) D on A.DUOC_ID = D.DUOC_ID and A.PHAMVI_ID = D.PHAMVI_ID and A.NGUONDUOC_ID = D.NGUONHANG_ID]
2020-02-26 16:20:27,131 [1] DEBUG - Statement Id: [DAO00063_KiemtraSoluongDuocXuat] PreparedStatement : [select A.TONKHO, isnull(B.BOOK_NGOAI,0) BOOK_NGOAI, isnull(D.BOOK_NOI,0) BOOK_NOI, isnull(C.BOOK_NOI_THUOC,0) BOOK_NOI_THUOC, (A.TONKHO - isnull(B.BOOK_NGOAI,0) - isnull(D.BOOK_NOI,0)) TONKHO_BOOK        from(        select SUM(tk.SOLUONG) TONKHO, tk.DUOC_ID, sd.PHAMVI_ID, tk.NGUONDUOC_ID from TT_DUOC_TONKHO tk        inner join TM_DUOC_PHAMVISD_MAPPING sd on sd.KHODUOC_ID = tk.KHODUOC_ID        where sd.PHAMVI_ID  = '1027' and tk.DUOC_ID = '934' and tk.NGUONDUOC_ID = '1'        group by tk.DUOC_ID, sd.PHAMVI_ID, tk.NGUONDUOC_ID) A        left join (        select SUM(SOLUONG) BOOK_NGOAI,DUOC_ID, PHAMVI_ID, NGUONHANG_ID from TT_DUOC_TONKHO_BOOK_NGOAITRU        where PHAMVI_ID  = '1027' and DUOC_ID = '934' and NGUONHANG_ID = '1' and TRANGTHAI = 'HIEULUC'  and SOLUONG > 0        group by DUOC_ID, PHAMVI_ID, NGUONHANG_ID) B on A.DUOC_ID = B.DUOC_ID and A.PHAMVI_ID = B.PHAMVI_ID and A.NGUONDUOC_ID = B.NGUONHANG_ID        left join (        select SUM(SOLUONG) BOOK_NOI_THUOC,DUOC_ID, PHAMVI_ID, NGUONHANG_ID from TT_DUOC_TONKHO_BOOK_NOITRU        where PHAMVI_ID  = '1027' and DUOC_ID = '934' and NGUONHANG_ID = '1' and REF_ID = '' and REF_TABLE = 'TT_NOITRU_TOATHUOC' and TRANGTHAI = 'HIEULUC' and SOLUONG > 0        group by DUOC_ID, PHAMVI_ID, NGUONHANG_ID) C on A.DUOC_ID = C.DUOC_ID and A.PHAMVI_ID = C.PHAMVI_ID and A.NGUONDUOC_ID = C.NGUONHANG_ID        left join (        select SUM(SOLUONG) BOOK_NOI,DUOC_ID, PHAMVI_ID, NGUONHANG_ID from TT_DUOC_TONKHO_BOOK_NOITRU        where PHAMVI_ID  = '1027' and DUOC_ID = '934' and NGUONHANG_ID = '1' and TRANGTHAI = 'HIEULUC'  and SOLUONG > 0        group by DUOC_ID, PHAMVI_ID, NGUONHANG_ID) D on A.DUOC_ID = D.DUOC_ID and A.PHAMVI_ID = D.PHAMVI_ID and A.NGUONDUOC_ID = D.NGUONHANG_ID]
2020-02-26 16:20:27,179 [1] DEBUG - Statement Id: [DAOLOG01_LockBegin] PreparedStatement : [INSERT into TT_LOG_UPDATE ( REF_TABLE , REF_ID , BENHVIEN_ID )         values ( @param0 ,  @param1 ,  @param2 );]
2020-02-26 16:20:27,179 [1] DEBUG - Statement Id: [DAOLOG01_LockBegin] Parameters: [@param0=[REF_TABLE,TT_NOITRU_KHAMBENH], @param1=[REF_ID,24642], @param2=[BENHVIEN_ID,HLU01]]
2020-02-26 16:20:27,179 [1] DEBUG - Statement Id: [DAOLOG01_LockBegin] Types: [@param0=[String, System.String], @param1=[Int64, System.Int64], @param2=[String, System.String]]
2020-02-26 16:20:27,382 [1] DEBUG - Statement Id: [DAO00026_GEN_EXAM_KEY] PreparedStatement : [select max(KEYVALUE) KEYVALUE              from LST_KEYDATA_TOATHUOC               where                             LST_KEYDATA_TOATHUOC.KEYTYPE = 'SOTHUTUTOA_NOITRU'                       and                           LST_KEYDATA_TOATHUOC.KEYYEAR = '2020'                       and                           LST_KEYDATA_TOATHUOC.KEYMONTH = '2'                       and                           LST_KEYDATA_TOATHUOC.KEYDAY = '26']
2020-02-26 16:20:27,437 [1] DEBUG - Statement Id: [DAO00026_Update] PreparedStatement : [IF EXISTS (select KEYTYPE from LST_KEYDATA_TOATHUOC where KEYTYPE = 'SOTHUTUTOA_NOITRU' AND KEYYEAR = '2020' AND KEYMONTH = '2' AND KEYDAY = '26')            BEGIN            update LST_KEYDATA_TOATHUOC set            KEYVALUE =  @param0             where            KEYTYPE = 'SOTHUTUTOA_NOITRU'            AND KEYYEAR = '2020'            AND KEYMONTH = '2'            AND KEYDAY = '26'            AND SEGMENT_1 = '0'            AND SEGMENT_2 = '0'            AND SEGMENT_3 = '0'            END            ELSE            BEGIN            insert into LST_KEYDATA_TOATHUOC (            KEYTYPE            , KEYYEAR            , KEYMONTH            , KEYDAY            , SEGMENT_1            , SEGMENT_2            , SEGMENT_3            , KEYVALUE            ) values (             @param1             ,  @param2             ,  @param3             ,  @param4             ,  @param5             ,  @param6             ,  @param7             ,  @param0             )            END]
2020-02-26 16:20:27,437 [1] DEBUG - Statement Id: [DAO00026_Update] Parameters: [@param0=[KEYVALUE,0004], @param1=[KEYTYPE,SOTHUTUTOA_NOITRU], @param2=[KEYYEAR,2020], @param3=[KEYMONTH,2], @param4=[KEYDAY,26], @param5=[SEGMENT_1,0], @param6=[SEGMENT_2,0], @param7=[SEGMENT_3,0]]
2020-02-26 16:20:27,437 [1] DEBUG - Statement Id: [DAO00026_Update] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[Int32, System.Int32], @param3=[Int32, System.Int32], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[String, System.String], @param7=[String, System.String]]
2020-02-26 16:20:27,508 [1] DEBUG - Statement Id: [DAO00062_Add] PreparedStatement : [insert into TT_NOITRU_KHAMBENH (        BENHAN_ID        , LUUTRU_ID        , LANKHAM        , NGAYKHAM        , THOIGIANKHAM        , BACSIKHAM_ID        , PHONGBAN_ID        , DIEUDUONG_ID        , CAPHOLY_ID        , DOITUONG_ID        , PHATDO_DIEUTRI_ID        , DINHBENH        , DIENBIEN        , LOIDAN        , CHEDOANUONG_ID        , CHEDOCHAMSOC_ID        , PHANCAPCHAMSOC_ID        , CHUNGTUPHATTHUOC_ID        , KHODUOC_ID        , NOINHANTHUOC_ID        , LOAITOATHUOC        , THUOCDACTRI        , NGAYTAIKHAM        , SONGAYHENTAIKHAM        , RAVIEN        , ISTHUOCBV              , ISYLENHVTYT        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYCAPNHAT        , NGUOICAPNHAT_ID         ,           GHICHU_KHAMBENH         ,           GHICHU         ,           CHEDODINHDUONG         ,           MATOAMAU                 ) values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31          ,            @param32          ,            @param33          ,           @param34          ,            @param35                  )]
2020-02-26 16:20:27,508 [1] DEBUG - Statement Id: [DAO00062_Add] Parameters: [@param0=[BENHAN_ID,24642], @param1=[LUUTRU_ID,39529], @param2=[LANKHAM,1], @param3=[NGAYKHAM,2/26/2020 12:00:00 AM], @param4=[THOIGIANKHAM,2/26/2020 4:18:47 PM], @param5=[BACSIKHAM_ID,1], @param6=[PHONGBAN_ID,25], @param7=[DIEUDUONG_ID,null], @param8=[CAPHOLY_ID,null], @param9=[DOITUONG_ID,4], @param10=[PHATDO_DIEUTRI_ID,null], @param11=[DINHBENH,Theo dõi thai bình thường(Z34)], @param12=[DIENBIEN,adsad], @param13=[LOIDAN,null], @param14=[CHEDOANUONG_ID,null], @param15=[CHEDOCHAMSOC_ID,null], @param16=[PHANCAPCHAMSOC_ID,8588], @param17=[CHUNGTUPHATTHUOC_ID,null], @param18=[KHODUOC_ID,null], @param19=[NOINHANTHUOC_ID,null], @param20=[LOAITOATHUOC,YL], @param21=[THUOCDACTRI,0], @param22=[NGAYTAIKHAM,null], @param23=[SONGAYHENTAIKHAM,null], @param24=[RAVIEN,0], @param25=[ISTHUOCBV,1], @param26=[ISYLENHVTYT,0], @param27=[BENHVIEN_ID,HLU01], @param28=[NGAYTAO,2/26/2020 4:20:27 PM], @param29=[NGUOITAO_ID,1], @param30=[NGAYCAPNHAT,2/26/2020 4:20:27 PM], @param31=[NGUOICAPNHAT_ID,1], @param32=[GHICHU_KHAMBENH,null], @param33=[GHICHU_DICHVU,null], @param34=[CHEDODINHDUONG,null], @param35=[MATOAMAU,null]]
2020-02-26 16:20:27,508 [1] DEBUG - Statement Id: [DAO00062_Add] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64], @param2=[Int64, System.Int64], @param3=[DateTime, System.DateTime], @param4=[DateTime, System.DateTime], @param5=[Int64, System.Int64], @param6=[String, System.String], @param7=[System.DBNull, null], @param8=[System.DBNull, null], @param9=[Int64, System.Int64], @param10=[System.DBNull, null], @param11=[String, System.String], @param12=[String, System.String], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[String, System.String], @param21=[String, System.String], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[String, System.String], @param28=[DateTime, System.DateTime], @param29=[Int64, System.Int64], @param30=[DateTime, System.DateTime], @param31=[Int64, System.Int64], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null]]
2020-02-26 16:20:27,556 [1] DEBUG - Statement Id: [DAO00062_Add.SelectKey] PreparedStatement : [SELECT @@IDENTITY as value]
2020-02-26 16:20:27,591 [1] DEBUG - Statement Id: [DAO00062_GetKhoThuocCosoKhongCoso] PreparedStatement : [select distinct kd.KHODUOC_ID, lst.DICTIONARY_CODE  LOAIKHO from TM_KHODUOC kd        left join TM_PHONGBAN_KHODUOC pbkd        on kd.KHODUOC_ID = pbkd.KHODUOC_ID        and kd.BENHVIEN_ID = pbkd.BENHVIEN_ID        left join LST_DICTIONARY lst on lst.DICTIONARY_ID = kd.LOAIKHO_ID        where lst.DICTIONARY_CODE = 'Coso']
2020-02-26 16:20:27,623 [1] DEBUG - Statement Id: [DAO00062_GetAllPhamviKhoDuoc] PreparedStatement : [select distinct dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        left join TM_DUOC_PHAMVISUDUNG dpv on dpv.PHAMVI_ID = dmap.PHAMVI_ID]
2020-02-26 16:20:27,648 [1] DEBUG - Statement Id: [DAO00023_GetSOBHYT_HUONG_ID] PreparedStatement : [select isnull(MAX(SOBHYT_HUONG_ID),0) SOBHYT_HUONG_ID        from TT_TIEPNHAN_SOTHEBHYT        where TIEPNHAN_ID = '107181']
2020-02-26 16:20:28,947 [1] DEBUG - Statement Id: [DAO00000_GetCHECK_DOITUONG_BHYT] PreparedStatement : [select count(*) as DOITUONG_BHYT FROM TM_DOITUONG A            WHERE A.DOITUONG_ID = '4' and A.BENHVIEN_ID = 'HLU01' and MADOITUONG like '%BHYT%']
2020-02-26 16:20:28,996 [1] DEBUG - Statement Id: [DAO00000_GetLOAIGIATHUOC_NOI_NGOAI_VIEN] PreparedStatement : [SELECT LOAIGIA_ID              FROM TM_LOAIGIA              WHERE MALOAIGIA = 'GiaThuoc_NoiVien' and BENHVIEN_ID = 'HLU01']
2020-02-26 16:20:31,681 [1] DEBUG - Statement Id: [DAO00000_GetDUOC_DONGIADOANHTHU_NOIVIEN] PreparedStatement : [declare @doanhthuKhongHT numeric(24,2);          declare @doanhthu numeric(24,2);          declare @hotro numeric(24,2);          declare @bhyt char(1);          declare @loaigia_id int, @loaigiakhonght_id int            select top 1 @doanhthuKhongHT = dg.DONGIA, @loaigiakhonght_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0 and GIAHOTRO != '1'          order by dtlg.DOUUTIEN asc          select top 1 @doanhthu = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0           order by dtlg.DOUUTIEN asc          select top 1 @hotro = dg.DONGIA, @loaigia_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0  and GIAHOTRO = '1'          order by dtlg.DOUUTIEN asc          select top 1 @bhyt = BHYT from TM_DUOC where DUOC_ID = 1030          select ISNULL(@doanhthu,0.0) DONGIA_DOANHTHU, ISNULL(@hotro, 0.0) DONGIA_KHAC, ISNULL(@doanhthuKhongHT, 0.0) DONGIA_KHONGHT, isnull(@bhyt, '0') BHYT, ISNULL(@loaigia_id, 0) as LOAIGIA_ID, ISNULL(@loaigiakhonght_id, 0) as LOAIGIAKHONGHT_ID]
2020-02-26 16:20:33,542 [1] DEBUG - Statement Id: [DAO00000_GetDuocBHYT] PreparedStatement : [select count(*) BHYT FROM TM_DUOC A WHERE A.DUOC_ID = '1030' and BHYT = '1']
2020-02-26 16:20:39,678 [1] DEBUG - Statement Id: [DAO00000_GetCHECK_DOITUONG_BHYT] PreparedStatement : [select count(*) as DOITUONG_BHYT FROM TM_DOITUONG A            WHERE A.DOITUONG_ID = '4' and A.BENHVIEN_ID = 'HLU01' and MADOITUONG like '%BHYT%']
2020-02-26 16:20:39,793 [1] DEBUG - Statement Id: [DAO00000_GetLOAIGIATHUOC_NOI_NGOAI_VIEN] PreparedStatement : [SELECT LOAIGIA_ID              FROM TM_LOAIGIA              WHERE MALOAIGIA = 'GiaThuoc_NoiVien' and BENHVIEN_ID = 'HLU01']
2020-02-26 16:20:41,004 [1] DEBUG - Statement Id: [DAO00000_GetDUOC_DONGIADOANHTHU_NOIVIEN] PreparedStatement : [declare @doanhthuKhongHT numeric(24,2);          declare @doanhthu numeric(24,2);          declare @hotro numeric(24,2);          declare @bhyt char(1);          declare @loaigia_id int, @loaigiakhonght_id int            select top 1 @doanhthuKhongHT = dg.DONGIA, @loaigiakhonght_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0 and GIAHOTRO != '1'          order by dtlg.DOUUTIEN asc          select top 1 @doanhthu = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0           order by dtlg.DOUUTIEN asc          select top 1 @hotro = dg.DONGIA, @loaigia_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0  and GIAHOTRO = '1'          order by dtlg.DOUUTIEN asc          select top 1 @bhyt = BHYT from TM_DUOC where DUOC_ID = 1030          select ISNULL(@doanhthu,0.0) DONGIA_DOANHTHU, ISNULL(@hotro, 0.0) DONGIA_KHAC, ISNULL(@doanhthuKhongHT, 0.0) DONGIA_KHONGHT, isnull(@bhyt, '0') BHYT, ISNULL(@loaigia_id, 0) as LOAIGIA_ID, ISNULL(@loaigiakhonght_id, 0) as LOAIGIAKHONGHT_ID]
2020-02-26 16:20:42,373 [1] DEBUG - Statement Id: [DAO00000_GetDuocBHYT] PreparedStatement : [select count(*) BHYT FROM TM_DUOC A WHERE A.DUOC_ID = '1030' and BHYT = '1']
2020-02-26 16:20:46,766 [1] DEBUG - Statement Id: [DAO00000_GetCHECK_DOITUONG_BHYT] PreparedStatement : [select count(*) as DOITUONG_BHYT FROM TM_DOITUONG A            WHERE A.DOITUONG_ID = '4' and A.BENHVIEN_ID = 'HLU01' and MADOITUONG like '%BHYT%']
2020-02-26 16:20:46,829 [1] DEBUG - Statement Id: [DAO00000_GetLOAIGIATHUOC_NOI_NGOAI_VIEN] PreparedStatement : [SELECT LOAIGIA_ID              FROM TM_LOAIGIA              WHERE MALOAIGIA = 'GiaThuoc_NoiVien' and BENHVIEN_ID = 'HLU01']
2020-02-26 16:20:47,939 [1] DEBUG - Statement Id: [DAO00000_GetDUOC_DONGIADOANHTHU_NOIVIEN] PreparedStatement : [declare @doanhthuKhongHT numeric(24,2);          declare @doanhthu numeric(24,2);          declare @hotro numeric(24,2);          declare @bhyt char(1);          declare @loaigia_id int, @loaigiakhonght_id int            select top 1 @doanhthuKhongHT = dg.DONGIA, @loaigiakhonght_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '934' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0 and GIAHOTRO != '1'          order by dtlg.DOUUTIEN asc          select top 1 @doanhthu = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '934' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0           order by dtlg.DOUUTIEN asc          select top 1 @hotro = dg.DONGIA, @loaigia_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '934' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0  and GIAHOTRO = '1'          order by dtlg.DOUUTIEN asc          select top 1 @bhyt = BHYT from TM_DUOC where DUOC_ID = 934          select ISNULL(@doanhthu,0.0) DONGIA_DOANHTHU, ISNULL(@hotro, 0.0) DONGIA_KHAC, ISNULL(@doanhthuKhongHT, 0.0) DONGIA_KHONGHT, isnull(@bhyt, '0') BHYT, ISNULL(@loaigia_id, 0) as LOAIGIA_ID, ISNULL(@loaigiakhonght_id, 0) as LOAIGIAKHONGHT_ID]
2020-02-26 16:20:49,060 [1] DEBUG - Statement Id: [DAO00000_GetDuocBHYT] PreparedStatement : [select count(*) BHYT FROM TM_DUOC A WHERE A.DUOC_ID = '934' and BHYT = '1']
2020-02-26 16:20:52,537 [1] DEBUG - Statement Id: [DAO00063_Add_YLenhThuoc] PreparedStatement : [declare @jsonVienPhi nvarchar(max);        set @jsonVienPhi = N'{        "DATA": [{"TRATHUOCCHITIET_ID":null,"DALAPPHIEULINH":false,"DAPHATSINHCHUNGTU":false,"DANHAPNOIBO":false,"DAXUATNOIBO":false,"UID":"0c37e0b4-745e-489c-92f4-d73ff4d2711a","TOATHUOC_ID":null,"CLSKETQUA_ID":null,"VTYT_ID":null,"SOTHUTUTOA":"2002260004","MACHUNGTU":null,"KHAMBENH_ID":320501,"TIEPNHAN_ID":107181,"BENHNHAN_ID":20633,"DUOC_ID":1030,"SOLUONG":1.0,"SONGAY":1.0,"SOLANTRENNGAY":null,"SOLUONGTRENLAN":null,"SOLUONG_BUOISANG":null,"SOLUONG_BUOITRUA":null,"SOLUONG_BUOICHIEU":null,"SOLUONG_BUOITOI":null,"DUONGDUNG_ID":911,"GHICHU":"","NGUONDUOC_ID":1,"KHOSUDUNG_ID":null,"NGUONDUOC":null,"NGUONHANG_ID":1,"PHIEULINH_ID":null,"CHUNGTU_ID":null,"CHUNGTUTONGHOP_ID":null,"PHONGBANRATOA_ID":"25","PHONGBAN_ID":null,"NGUONLAYTHUOC":"D","COSO":"0","KHOPHAT_ID":1,"PHAMVI_ID":1027,"PHATTHUOCTAIQUAY":"0","ISUPDATED":false,"THOIGIANSUDUNG":null,"NGAYSUDUNG":null,"THOIGIANKHAM":null,"SOLUONGTAMNGUNG":0.0,"MUANGOAI":"0","YEUCAU":null,"PHOIHOP":null,"PHACHE":null,"ISVTYT":false,"ISHOACHAT":false,"TINHTIEN":"0","MIENPHI":"0","TRANGTHAI":"CHUAXUAT","HUYTOATHUOC":"0","BENHVIEN_ID":"HLU01","NGAYTAO":null,"NGUOITAO_ID":1,"NGAYCAPNHAT":null,"NGUOICAPNHAT_ID":1,"BHYTDONGTIEN":"0","KHONGTHUTIEN":"0","SOCHUNGTU":null,"SOPHIEULINH":null,"MATOATHUOC":null,"LOAITOATHUOC":null,"LOAIVATTU_ID":"T","TENTOATHUOC":null,"DIENGIAI":null,"TAMNGUNG":false,"DUOC_BHYT":true,"VIENPHI":{"VIENPHI_ID":0,"TIEPNHAN_ID":107181,"BENHNHAN_ID":null,"BENHAN_ID":24642,"KHAMBENH_ID":null,"REF_ID":null,"REF_TABLE":"TT_NOITRU_TOATHUOC","DICHVU_ID":null,"DUOC_ID":1030,"LOAI_CHIPHI":"TT","LOAIGIA_ID":5,"SOLUONG":0.0,"DONGIA_DOANHTHU":600.00,"THANHTIEN_DOANHTHU":600.00,"BHYT_TL":null,"BHYT_DONGIA":600.00,"BHYT_THANHTIEN":600.00,"BHYT_DONGIA_CHITRA":600.00,"BHYT_THANHTIEN_CHITRA":600.00,"BENHNHAN_PHAITHANHTOAN":0.00,"GIATRI_HOADON":null,"GIATRI_HOADON_DATHANHTOAN":null,"GIATRI_BIENLAI":null,"GIATRI_BIENLAI_DATHANHTOAN":null,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"GIATRI_THATTHU":null,"MIENGIAM_TL":null,"MIENGIAM_GIATRI":null,"NGANSACH_TL":null,"NGANSACH_GIATRI":null,"TAITRO_TL":null,"TAITRO_GIATRI":null,"BHTN_TL":null,"BHTN_DONGIA":null,"BHTN_THANHTIEN":null,"BHTN_DONGIA_CHITRA":null,"BHTN_THANHTIEN_CHITRA":null,"DUOCPHEPTHUCHIEN":null,"HUY":false,"DATHANHTOAN":false,"DATHUCHIEN":false,"KHONGTHUTIEN":false,"BHYTDONGTIEN":false,"HOADON_ID":null,"ACTIVE":null,"BENHVIEN_ID":"HLU01","NGUOITAO_ID":null,"NGAYTAO":null,"NGUOICAPNHAT_ID":null,"NGAYCAPNHAT":null,"TREN3NAM":false,"TREN5NAM":false},"STT":1,"KHOTAO_ID":"29","DONVITINH":null,"DUONGDUNG":"Tiêm","DAXUAT":false,"DATHANHTOAN":false,"BENHAN_ID":24642,"DAHOANTRA":0,"SLDAXUAT":0.0,"SLDATAMNGUNG":0.0,"CHUNGTUTRA_ID":null,"CHUNGTUCHITIET_ID":null,"NGUOICAPNHAT":null,"BHYT_DONGIA":null,"BHYT_THANHTIEN":null,"BHYT_DONGIA_CHITRA":null,"BHYT_THANHTIEN_CHITRA":null,"DONGIA_DOANHTHU":600.0,"THANHTIEN_DOANHTHU":600.0,"BookedSoLuong":0.0,"KHODUOC_ID":1,"CHUYENKHOA_ID":"25","DOTDIEUTRI_ID":null,"DOITUONG_HUONG_ID":4,"SOBHYT_HUONG_ID":111518},{"TRATHUOCCHITIET_ID":null,"DALAPPHIEULINH":false,"DAPHATSINHCHUNGTU":false,"DANHAPNOIBO":false,"DAXUATNOIBO":false,"UID":"ebf599a2-1182-4d8a-8f7c-3ec3c9673c96","TOATHUOC_ID":null,"CLSKETQUA_ID":null,"VTYT_ID":null,"SOTHUTUTOA":"2002260004","MACHUNGTU":null,"KHAMBENH_ID":320501,"TIEPNHAN_ID":107181,"BENHNHAN_ID":20633,"DUOC_ID":1030,"SOLUONG":1.0,"SONGAY":1.0,"SOLANTRENNGAY":null,"SOLUONGTRENLAN":null,"SOLUONG_BUOISANG":null,"SOLUONG_BUOITRUA":null,"SOLUONG_BUOICHIEU":null,"SOLUONG_BUOITOI":null,"DUONGDUNG_ID":911,"GHICHU":"","NGUONDUOC_ID":1,"KHOSUDUNG_ID":null,"NGUONDUOC":null,"NGUONHANG_ID":1,"PHIEULINH_ID":null,"CHUNGTU_ID":null,"CHUNGTUTONGHOP_ID":null,"PHONGBANRATOA_ID":"25","PHONGBAN_ID":null,"NGUONLAYTHUOC":"D","COSO":"0","KHOPHAT_ID":1,"PHAMVI_ID":1027,"PHATTHUOCTAIQUAY":"0","ISUPDATED":false,"THOIGIANSUDUNG":null,"NGAYSUDUNG":null,"THOIGIANKHAM":null,"SOLUONGTAMNGUNG":0.0,"MUANGOAI":"0","YEUCAU":null,"PHOIHOP":null,"PHACHE":null,"ISVTYT":false,"ISHOACHAT":false,"TINHTIEN":"0","MIENPHI":"0","TRANGTHAI":"CHUAXUAT","HUYTOATHUOC":"0","BENHVIEN_ID":"HLU01","NGAYTAO":null,"NGUOITAO_ID":1,"NGAYCAPNHAT":null,"NGUOICAPNHAT_ID":1,"BHYTDONGTIEN":"1","KHONGTHUTIEN":"0","SOCHUNGTU":null,"SOPHIEULINH":null,"MATOATHUOC":null,"LOAITOATHUOC":null,"LOAIVATTU_ID":"T","TENTOATHUOC":null,"DIENGIAI":null,"TAMNGUNG":false,"DUOC_BHYT":true,"VIENPHI":{"VIENPHI_ID":0,"TIEPNHAN_ID":107181,"BENHNHAN_ID":null,"BENHAN_ID":24642,"KHAMBENH_ID":null,"REF_ID":null,"REF_TABLE":"TT_NOITRU_TOATHUOC","DICHVU_ID":null,"DUOC_ID":1030,"LOAI_CHIPHI":"TT","LOAIGIA_ID":7,"SOLUONG":0.0,"DONGIA_DOANHTHU":1000.00,"THANHTIEN_DOANHTHU":1000.00,"BHYT_TL":null,"BHYT_DONGIA":0,"BHYT_THANHTIEN":0,"BHYT_DONGIA_CHITRA":0,"BHYT_THANHTIEN_CHITRA":0,"BENHNHAN_PHAITHANHTOAN":1000.00,"GIATRI_HOADON":null,"GIATRI_HOADON_DATHANHTOAN":null,"GIATRI_BIENLAI":null,"GIATRI_BIENLAI_DATHANHTOAN":null,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"GIATRI_THATTHU":null,"MIENGIAM_TL":null,"MIENGIAM_GIATRI":null,"NGANSACH_TL":null,"NGANSACH_GIATRI":null,"TAITRO_TL":null,"TAITRO_GIATRI":null,"BHTN_TL":null,"BHTN_DONGIA":null,"BHTN_THANHTIEN":null,"BHTN_DONGIA_CHITRA":null,"BHTN_THANHTIEN_CHITRA":null,"DUOCPHEPTHUCHIEN":null,"HUY":false,"DATHANHTOAN":false,"DATHUCHIEN":false,"KHONGTHUTIEN":false,"BHYTDONGTIEN":true,"HOADON_ID":null,"ACTIVE":null,"BENHVIEN_ID":"HLU01","NGUOITAO_ID":null,"NGAYTAO":null,"NGUOICAPNHAT_ID":null,"NGAYCAPNHAT":null,"TREN3NAM":false,"TREN5NAM":false},"STT":2,"KHOTAO_ID":"29","DONVITINH":null,"DUONGDUNG":"Tiêm","DAXUAT":false,"DATHANHTOAN":false,"BENHAN_ID":24642,"DAHOANTRA":0,"SLDAXUAT":0.0,"SLDATAMNGUNG":0.0,"CHUNGTUTRA_ID":null,"CHUNGTUCHITIET_ID":null,"NGUOICAPNHAT":null,"BHYT_DONGIA":null,"BHYT_THANHTIEN":null,"BHYT_DONGIA_CHITRA":null,"BHYT_THANHTIEN_CHITRA":null,"DONGIA_DOANHTHU":600.0,"THANHTIEN_DOANHTHU":600.0,"BookedSoLuong":0.0,"KHODUOC_ID":1,"CHUYENKHOA_ID":"25","DOTDIEUTRI_ID":null,"DOITUONG_HUONG_ID":4,"SOBHYT_HUONG_ID":111518},{"TRATHUOCCHITIET_ID":null,"DALAPPHIEULINH":false,"DAPHATSINHCHUNGTU":false,"DANHAPNOIBO":false,"DAXUATNOIBO":false,"UID":"4d4ebc83-bf47-43e8-88a8-be48b11518d5","TOATHUOC_ID":null,"CLSKETQUA_ID":null,"VTYT_ID":null,"SOTHUTUTOA":"2002260004","MACHUNGTU":null,"KHAMBENH_ID":320501,"TIEPNHAN_ID":107181,"BENHNHAN_ID":20633,"DUOC_ID":934,"SOLUONG":1.0,"SONGAY":1.0,"SOLANTRENNGAY":null,"SOLUONGTRENLAN":null,"SOLUONG_BUOISANG":null,"SOLUONG_BUOITRUA":null,"SOLUONG_BUOICHIEU":null,"SOLUONG_BUOITOI":null,"DUONGDUNG_ID":8573,"GHICHU":"","NGUONDUOC_ID":1,"KHOSUDUNG_ID":null,"NGUONDUOC":null,"NGUONHANG_ID":1,"PHIEULINH_ID":null,"CHUNGTU_ID":null,"CHUNGTUTONGHOP_ID":null,"PHONGBANRATOA_ID":"25","PHONGBAN_ID":null,"NGUONLAYTHUOC":"D","COSO":"0","KHOPHAT_ID":1,"PHAMVI_ID":1027,"PHATTHUOCTAIQUAY":"0","ISUPDATED":false,"THOIGIANSUDUNG":null,"NGAYSUDUNG":null,"THOIGIANKHAM":null,"SOLUONGTAMNGUNG":0.0,"MUANGOAI":"0","YEUCAU":null,"PHOIHOP":null,"PHACHE":null,"ISVTYT":false,"ISHOACHAT":false,"TINHTIEN":"0","MIENPHI":"0","TRANGTHAI":"CHUAXUAT","HUYTOATHUOC":"0","BENHVIEN_ID":"HLU01","NGAYTAO":null,"NGUOITAO_ID":1,"NGAYCAPNHAT":null,"NGUOICAPNHAT_ID":1,"BHYTDONGTIEN":"0","KHONGTHUTIEN":"0","SOCHUNGTU":null,"SOPHIEULINH":null,"MATOATHUOC":null,"LOAITOATHUOC":null,"LOAIVATTU_ID":"T","TENTOATHUOC":null,"DIENGIAI":null,"TAMNGUNG":false,"DUOC_BHYT":false,"VIENPHI":{"VIENPHI_ID":0,"TIEPNHAN_ID":107181,"BENHNHAN_ID":null,"BENHAN_ID":24642,"KHAMBENH_ID":null,"REF_ID":null,"REF_TABLE":"TT_NOITRU_TOATHUOC","DICHVU_ID":null,"DUOC_ID":934,"LOAI_CHIPHI":"TT","LOAIGIA_ID":7,"SOLUONG":0.0,"DONGIA_DOANHTHU":12000.00,"THANHTIEN_DOANHTHU":12000.00,"BHYT_TL":null,"BHYT_DONGIA":0,"BHYT_THANHTIEN":0,"BHYT_DONGIA_CHITRA":0,"BHYT_THANHTIEN_CHITRA":0,"BENHNHAN_PHAITHANHTOAN":12000.00,"GIATRI_HOADON":null,"GIATRI_HOADON_DATHANHTOAN":null,"GIATRI_BIENLAI":null,"GIATRI_BIENLAI_DATHANHTOAN":null,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"GIATRI_THATTHU":null,"MIENGIAM_TL":null,"MIENGIAM_GIATRI":null,"NGANSACH_TL":null,"NGANSACH_GIATRI":null,"TAITRO_TL":null,"TAITRO_GIATRI":null,"BHTN_TL":null,"BHTN_DONGIA":null,"BHTN_THANHTIEN":null,"BHTN_DONGIA_CHITRA":null,"BHTN_THANHTIEN_CHITRA":null,"DUOCPHEPTHUCHIEN":null,"HUY":false,"DATHANHTOAN":false,"DATHUCHIEN":false,"KHONGTHUTIEN":false,"BHYTDONGTIEN":false,"HOADON_ID":null,"ACTIVE":null,"BENHVIEN_ID":"HLU01","NGUOITAO_ID":null,"NGAYTAO":null,"NGUOICAPNHAT_ID":null,"NGAYCAPNHAT":null,"TREN3NAM":false,"TREN5NAM":false},"STT":3,"KHOTAO_ID":"29","DONVITINH":null,"DUONGDUNG":"Tiêm truyền","DAXUAT":false,"DATHANHTOAN":false,"BENHAN_ID":24642,"DAHOANTRA":0,"SLDAXUAT":0.0,"SLDATAMNGUNG":0.0,"CHUNGTUTRA_ID":null,"CHUNGTUCHITIET_ID":null,"NGUOICAPNHAT":null,"BHYT_DONGIA":null,"BHYT_THANHTIEN":null,"BHYT_DONGIA_CHITRA":null,"BHYT_THANHTIEN_CHITRA":null,"DONGIA_DOANHTHU":12000.0,"THANHTIEN_DOANHTHU":12000.0,"BookedSoLuong":0.0,"KHODUOC_ID":1,"CHUYENKHOA_ID":"25","DOTDIEUTRI_ID":null,"DOITUONG_HUONG_ID":4,"SOBHYT_HUONG_ID":111518}]        }';          declare @TOATHUOC_ID int;        declare @SOTHUTUTOA varchar(10);        declare @KHAMBENH_ID int;        declare @TIEPNHAN_ID int;        declare @BENHNHAN_ID int;        declare @NGUONDUOC_ID int;        declare @DUOC_ID int;        declare @SOLUONG numeric(18, 4);        declare @SONGAY numeric(4, 2);        declare @SOLANTRENNGAY numeric(4, 2);        declare @SOLUONGTRENLAN numeric(18, 4);        declare @SOLUONG_BUOISANG numeric(18, 4);        declare @SOLUONG_BUOITRUA numeric(18, 4);        declare @SOLUONG_BUOICHIEU numeric(18, 4);        declare @SOLUONG_BUOITOI numeric(18, 4);        declare @DUONGDUNG_ID int;        declare @COSO char(1);        declare @KHOTAO_ID int;        declare @KHOPHAT_ID int;        declare @GHICHU nvarchar(max);        declare @PHIEULINH_ID int;        declare @CHUNGTU_ID int;        declare @PHONGBANRATOA_ID int;        declare @NGUONLAYTHUOC char(1);        declare @VTYT char(1);        declare @PHATTHUOCTAIQUAY char(1);        declare @MUANGOAI char(1);        declare @TINHTIEN char(1);        declare @MIENPHI char(1);        declare @BHYTDONGTIEN char(1);        declare @KHONGTHUTIEN char(1);        declare @HUYTOATHUOC char(1);        declare @TRANGTHAI varchar(20);        declare @BENHVIEN_ID varchar(10);        declare @NGAYTAO datetime;        declare @NGUOITAO_ID int;        declare @NGAYCAPNHAT datetime;        declare @NGUOICAPNHAT_ID int;        declare @PHAMVI_ID int;        declare @CHEDODINHDUONG nvarchar(max);          declare @VIENPHI nvarchar(max);        declare @BENHAN_ID int =  @param0 ;        declare @DOTDIEUTRI_ID int;        declare @DONGIA_DOANHTHU numeric(25, 4);        declare @THANHTIEN_DOANHTHU numeric(25, 4);        declare @BHYT_DONGIA numeric(25, 4);        declare @BHYT_THANHTIEN numeric(25, 4);        declare @BHYT_DONGIA_CHITRA numeric(25, 4);        declare @BHYT_THANHTIEN_CHITRA numeric(25, 4);        declare @BENHNHAN_PHAITHANHTOAN numeric(25, 4);        declare @DOITUONG_HUONG_ID numeric(25, 4);        declare @SOBHYT_HUONG_ID numeric(25, 4);          declare @iTotal int =  @param1 ;        declare @icnt int = 0;        WHILE @iTotal > @icnt        BEGIN        declare @dyn_sql nvarchar(1000) = 'select @data = json_query(@json_dyn, ''' + CHAR(36) +'.DATA[' + cast(@icnt as varchar(10)) + ']'');'        declare @jsondatamax nvarchar(max);          exec sp_executesql @dyn_sql        , N'@json_dyn nvarchar(max), @data nvarchar(max) OUTPUT'        , @json_dyn = @jsonVienPhi        , @data = @jsondatamax OUTPUT          select        @SOTHUTUTOA =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.SOTHUTUTOA'),        @KHAMBENH_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.KHAMBENH_ID'),        @TIEPNHAN_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.TIEPNHAN_ID'),        @BENHNHAN_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.BENHNHAN_ID'),        @NGUONDUOC_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.NGUONDUOC_ID'),        @DUOC_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.DUOC_ID'),        @SOLUONG =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.SOLUONG'),        @SONGAY =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.SONGAY'),        @SOLANTRENNGAY =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.SOLANTRENNGAY'),        @SOLUONGTRENLAN =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.SOLUONGTRENLAN'),        @SOLUONG_BUOISANG =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.SOLUONG_BUOISANG'),        @SOLUONG_BUOITRUA =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.SOLUONG_BUOITRUA'),        @SOLUONG_BUOICHIEU =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.SOLUONG_BUOICHIEU'),        @SOLUONG_BUOITOI =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.SOLUONG_BUOITOI'),        @DUONGDUNG_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.DUONGDUNG_ID'),        @COSO =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.COSO'),        @KHOTAO_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.KHOTAO_ID'),        @KHOPHAT_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.KHOPHAT_ID'),        @GHICHU =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.GHICHU'),        @PHIEULINH_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.PHIEULINH_ID'),        @CHUNGTU_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.CHUNGTU_ID'),        @PHONGBANRATOA_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.PHONGBANRATOA_ID'),        @NGUONLAYTHUOC =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.NGUONLAYTHUOC'),        @VTYT =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.VTYT'),        @PHATTHUOCTAIQUAY =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.PHATTHUOCTAIQUAY'),        @MUANGOAI =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.MUANGOAI'),        @TINHTIEN =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.TINHTIEN'),        @MIENPHI =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.MIENPHI'),        @BHYTDONGTIEN =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.BHYTDONGTIEN'),        @KHONGTHUTIEN =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.KHONGTHUTIEN'),        @HUYTOATHUOC =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.HUYTOATHUOC'),        @TRANGTHAI =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.TRANGTHAI'),        @BENHVIEN_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.BENHVIEN_ID'),        @NGAYTAO =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.NGAYTAO'),        @NGUOITAO_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.NGUOITAO_ID'),        @NGAYCAPNHAT =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.NGAYCAPNHAT'),        @NGUOICAPNHAT_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.NGUOICAPNHAT_ID'),        @PHAMVI_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.PHAMVI_ID'),        @CHEDODINHDUONG =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.CHEDODINHDUONG'),        @DOTDIEUTRI_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.DOTDIEUTRI_ID'),        @DOITUONG_HUONG_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.DOITUONG_HUONG_ID'),        @SOBHYT_HUONG_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.SOBHYT_HUONG_ID'),                  @DONGIA_DOANHTHU =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.VIENPHI.DONGIA_DOANHTHU'),        @THANHTIEN_DOANHTHU =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.VIENPHI.THANHTIEN_DOANHTHU'),        @BHYT_DONGIA =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.VIENPHI.BHYT_DONGIA'),        @BHYT_THANHTIEN =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.VIENPHI.BHYT_THANHTIEN'),        @BHYT_DONGIA_CHITRA =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.VIENPHI.BHYT_DONGIA_CHITRA'),        @BHYT_THANHTIEN_CHITRA =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.VIENPHI.BHYT_THANHTIEN_CHITRA'),        @BENHNHAN_PHAITHANHTOAN =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.VIENPHI.BENHNHAN_PHAITHANHTOAN')        @LOAIGIA_ID = JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.VIENPHI.LOAIGIA_ID')          insert into TT_NOITRU_TOATHUOC        ([SOTHUTUTOA],[KHAMBENH_ID],[TIEPNHAN_ID],[BENHNHAN_ID],[NGUONDUOC_ID]        ,[DUOC_ID],[SOLUONG],[SONGAY],[SOLANTRENNGAY],[SOLUONGTRENLAN],[SOLUONG_BUOISANG],[SOLUONG_BUOITRUA],[SOLUONG_BUOICHIEU]        ,[SOLUONG_BUOITOI],[DUONGDUNG_ID],[COSO],[KHOTAO_ID],[KHOPHAT_ID],[GHICHU],[PHIEULINH_ID],[CHUNGTU_ID],[PHONGBANRATOA_ID]        ,[NGUONLAYTHUOC],[VTYT],[PHATTHUOCTAIQUAY],[MUANGOAI],[TINHTIEN],[MIENPHI],[BHYTDONGTIEN],[KHONGTHUTIEN],[HUYTOATHUOC]        ,[TRANGTHAI],[BENHVIEN_ID],[NGAYTAO],[NGUOITAO_ID],[NGAYCAPNHAT],[NGUOICAPNHAT_ID],[PHAMVI_ID],[CHEDODINHDUONG])        VALUES        (@SOTHUTUTOA,@KHAMBENH_ID,@TIEPNHAN_ID,@BENHNHAN_ID,@NGUONDUOC_ID        ,@DUOC_ID,@SOLUONG,@SONGAY,@SOLANTRENNGAY,@SOLUONGTRENLAN,@SOLUONG_BUOISANG,@SOLUONG_BUOITRUA,@SOLUONG_BUOICHIEU        ,@SOLUONG_BUOITOI,@DUONGDUNG_ID,@COSO,@KHOTAO_ID,@KHOPHAT_ID,@GHICHU,@PHIEULINH_ID,@CHUNGTU_ID,@PHONGBANRATOA_ID        ,@NGUONLAYTHUOC,@VTYT,@PHATTHUOCTAIQUAY,@MUANGOAI,@TINHTIEN,@MIENPHI,@BHYTDONGTIEN,@KHONGTHUTIEN,@HUYTOATHUOC        ,@TRANGTHAI,@BENHVIEN_ID,GETDATE(),@NGUOITAO_ID,GETDATE(),@NGUOICAPNHAT_ID,@PHAMVI_ID,@CHEDODINHDUONG)                set @TOATHUOC_ID = SCOPE_IDENTITY()                  INSERT INTO TT_VIENPHI        ([TIEPNHAN_ID],[BENHAN_ID]        ,[DOTDIEUTRI_ID],[BENHNHAN_ID],[KHAMBENH_ID],[REF_ID],[REF_TABLE],[DICHVU_ID],[DUOC_ID],[LOAI_CHIPHI]        ,[SOLUONG],[DONGIA_DOANHTHU],[THANHTIEN_DOANHTHU],[BHYT_DONGIA],[BHYT_THANHTIEN],[HUY],[DATHANHTOAN]        ,[DATHUCHIEN],[KHONGTHUTIEN],[BHYTDONGTIEN],[BENHVIEN_ID],[NGUOITAO_ID],[NGAYTAO],[NGUOICAPNHAT_ID],        [NGAYCAPNHAT], [DOITUONG_HUONG_ID], [SOBHYT_HUONG_ID], [BHYT_DONGIA_CHITRA], [BHYT_THANHTIEN_CHITRA], [BENHNHAN_PHAITHANHTOAN], [LOAIGIA_ID])        VALUES        (@TIEPNHAN_ID,@BENHAN_ID        ,@DOTDIEUTRI_ID,@BENHNHAN_ID,@KHAMBENH_ID,@TOATHUOC_ID,'TT_NOITRU_TOATHUOC',null,@DUOC_ID,'TT'        ,@SOLUONG,@DONGIA_DOANHTHU,@THANHTIEN_DOANHTHU,@BHYT_DONGIA,@BHYT_THANHTIEN,'0','0'        ,'0',@KHONGTHUTIEN,@BHYTDONGTIEN,@BENHVIEN_ID,@NGUOITAO_ID,GETDATE(),@NGUOICAPNHAT_ID,GETDATE(), @DOITUONG_HUONG_ID, @SOBHYT_HUONG_ID        ,@BHYT_DONGIA_CHITRA, @BHYT_THANHTIEN_CHITRA, @BENHNHAN_PHAITHANHTOAN, @LOAIGIA_ID)                  insert into TT_DUOC_TONKHO_BOOK_NOITRU        ([REF_TABLE],[REF_ID],[PHAMVI_ID],[KHODUOC_ID],[DUOC_ID],[SOLUONG],[NGUONHANG_ID],[CHUYENKHOA_ID]        ,[GHICHU],[BENHVIEN_ID],[NGAYTAO],[NGUOITAO_ID],[NGAYCAPNHAT],[NGUOICAPNHAT_ID], [TRANGTHAI], [NGAYHIEULUC])        VALUES        ('TT_NOITRU_TOATHUOC',@TOATHUOC_ID,@PHAMVI_ID,@KHOPHAT_ID,@DUOC_ID,@SOLUONG,@NGUONDUOC_ID,@PHONGBANRATOA_ID        ,@GHICHU,@BENHVIEN_ID,GETDATE(),@NGUOITAO_ID,GETDATE(),@NGUOICAPNHAT_ID, 'HIEULUC', GETDATE())          set @icnt = @icnt + 1;        END        select @TOATHUOC_ID]
2020-02-26 16:20:52,537 [1] DEBUG - Statement Id: [DAO00063_Add_YLenhThuoc] Parameters: [@param0=[BENHAN_ID,24642], @param1=[TOTAL_RECORD,3]]
2020-02-26 16:20:52,537 [1] DEBUG - Statement Id: [DAO00063_Add_YLenhThuoc] Types: [@param0=[Int64, System.Int64], @param1=[Int32, System.Int32]]
2020-02-26 16:20:52,967 [1] DEBUG - Statement Id: [DAOLOG01_LockEnd] PreparedStatement : [DELETE TT_LOG_UPDATE        where REF_TABLE = 'TT_NOITRU_KHAMBENH' and REF_ID = '24642' and BENHVIEN_ID = 'HLU01']
2020-02-26 16:20:53,165 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM98'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
--------------------------------------------------------------------------------
2020-02-26 16:23:13,687 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2020-02-26 16:23:13,935 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2020-02-26 16:23:14,023 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2020-02-26 16:23:14,521 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 16:23:14,780 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2020-02-26 16:23:21,845 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2020-02-26 16:23:21,905 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2020-02-26 16:23:23,952 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2020-02-26 16:23:24,047 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2020-02-26 16:23:24,934 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2020-02-26 16:23:25,201 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2020-02-26 16:23:25,279 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2020-02-26 16:23:25,359 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2020-02-26 16:23:25,516 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2020-02-26 16:23:25,656 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2020-02-26 16:23:25,784 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2020-02-26 16:23:25,996 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2020-02-26 16:23:26,106 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2020-02-26 16:23:26,649 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2020-02-26 16:23:26,679 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2020-02-26 16:23:26,766 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2020-02-26 16:23:26,874 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2020-02-26 16:23:27,652 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2020-02-26 16:23:27,683 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @NGUONDUOC_MACDINH varchar(5) = '0';        declare @TOAMUANGOAI int = 0;        select @NGUONDUOC_MACDINH = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'PHA_NGUONDUOC'        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + @NGUONDUOC_MACDINH as DUOC_KEY, 0 as PHAMVI_ID, @NGUONDUOC_MACDINH as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end        else        begin                select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (        select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID)        B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (        select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID)        A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2020-02-26 16:23:29,012 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2020-02-26 16:23:29,194 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,        SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH        FROM TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID        WHERE TK.SOLUONG > 0        GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2020-02-26 16:23:29,359 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2020-02-26 16:23:29,465 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,        TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,        TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH        from TM_MAU M        JOIN        (        select        A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO        from        (        select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO        from TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'        where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0        ) A        )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2020-02-26 16:23:29,556 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2020-02-26 16:23:30,503 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 16:23:31,608 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2020-02-26 16:23:37,199 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2020-02-26 16:23:37,227 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2020-02-26 16:23:37,316 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 16:23:37,539 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 16:23:37,673 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2020-02-26 16:23:37,677 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2020-02-26 16:23:37,677 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2020-02-26 16:23:37,703 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2020-02-26 16:23:37,704 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2020-02-26 16:23:37,704 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2020-02-26 16:23:38,004 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 16:23:38,153 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 16:23:47,148 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 16:23:47,231 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2020-02-26 16:23:47,581 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2020-02-26 16:23:55,671 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'IPD02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 16:23:56,078 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'IPD40'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 16:23:56,247 [1] DEBUG - Statement Id: [DAO00069_GetCountDanhSachNoiTru] PreparedStatement : [select count(A.SOBENHAN) as TOTALROWS        from TT_NOITRU_BENHAN A        inner join TT_TIEPNHAN B on B.TIEPNHAN_ID = A.TIEPNHAN_ID and (B.TRANGTHAI = 'NOITRU' or B.TRANGTHAI = 'HOANTHANH')        inner join TT_BENHNHAN C on C.BENHNHAN_ID = B.BENHNHAN_ID        left join TT_NOITRU_LUUTRU D on D.BENHAN_ID = A.BENHAN_ID        and D.LUUTRU_ID = ( select top 1 LUUTRU_ID from TT_NOITRU_LUUTRU where BENHAN_ID = A.BENHAN_ID order by BENHAN_ID desc)        left join TT_NOITRU_XACNHAN E on E.BENHAN_ID = A.BENHAN_ID        left join TT_NOITRU_LUUTRUCHITIET F on D.LUUTRU_ID = F.LUUTRU_ID and F.LUUTRUCHITIET_CURRENT = '1'        and F.LUUTRUCHITIET_ID in (select top 1 LUUTRUCHITIET_ID from TT_NOITRU_LUUTRUCHITIET where LUUTRU_ID = D.LUUTRU_ID order by LUUTRUCHITIET_ID desc)        where        A.KHOACHUYENDEN_ID is not null  and        (E.TRANGTHAI = 'DAXACNHAN' OR E.TRANGTHAI = 'HUYXACNHAN')         and           cast(A.NGAYVAOKHOA as date) <= cast('2/26/2020 12:00:00 AM' as date)                 and B.BENHVIEN_ID = 'HLU01' and A.KHOACHUYENDEN_ID = '25'          AND             A.TRANGTHAI in ('DANGDIEUTRI')]
2020-02-26 16:23:56,365 [1] DEBUG - Statement Id: [DAO00069_GetDanhSachNoiTru] PreparedStatement : [select * from        (        SELECT ROW_NUMBER() OVER(order by B.SOTIEPNHAN) as ROWNUMBER,          A.SOBENHAN, A.BENHAN_ID, A.SOLUUTRU                 , E.NOILAP_ID as KHOAVAO_ID        , A.TRANGTHAI, IsNull(A.BACSIDIEUTRI_ID, E.BACSICHIDINH_ID) as BACSIDIEUTRI_ID,        B.TIEPNHAN_ID, B.SOTIEPNHAN, B.SOBHYT as SOTHE, B.DOITUONG_ID, A.NGAYVAOKHOA as NGAYCAPCUU, A.THOIGIANVAOKHOA as THOIGIANCAPCUU,        C.TENBENHNHAN, C.NGAYSINH, C.NAMSINH, C.BENHNHAN_ID, C.MAYTE, F.GIUONGBENH_ID, A.THOIGIANRAVIEN    , DIACHITHUONGTRU, DANTOC_ID        ,BENHVIEN_STT_ID                from TT_NOITRU_BENHAN A        inner join TT_TIEPNHAN B on B.TIEPNHAN_ID = A.TIEPNHAN_ID and (B.TRANGTHAI = 'NOITRU' or B.TRANGTHAI = 'HOANTHANH')        inner join TT_BENHNHAN C on C.BENHNHAN_ID = B.BENHNHAN_ID        left join TT_NOITRU_LUUTRU D on D.BENHAN_ID = A.BENHAN_ID        and D.LUUTRU_ID = ( select top 1 LUUTRU_ID from TT_NOITRU_LUUTRU where BENHAN_ID = A.BENHAN_ID order by LUUTRU_ID desc)        left join TT_NOITRU_XACNHAN E on E.BENHAN_ID = A.BENHAN_ID        left join TT_NOITRU_LUUTRUCHITIET F on D.LUUTRU_ID = F.LUUTRU_ID and F.LUUTRUCHITIET_CURRENT = '1'        and F.LUUTRUCHITIET_ID in (select top 1 LUUTRUCHITIET_ID from TT_NOITRU_LUUTRUCHITIET where LUUTRU_ID = D.LUUTRU_ID order by LUUTRUCHITIET_ID desc)        left join (select MABENHVIEN, BENHVIEN_STT_ID from TM_BENHVIEN) H on SUBSTRING(B.SOBHYT, 16, 5)=H.MABENHVIEN        where        A.KHOACHUYENDEN_ID is not null  and        (E.TRANGTHAI = 'DAXACNHAN' OR E.TRANGTHAI = 'HUYXACNHAN')         and           cast(A.NGAYVAOKHOA as date) <= cast('2/26/2020 12:00:00 AM' as date)                 and B.BENHVIEN_ID = 'HLU01' and A.KHOACHUYENDEN_ID = '25'          AND             A.TRANGTHAI in ('DANGDIEUTRI')                   ) lst        where        lst.ROWNUMBER between 1 and 20        order by lst.SOTIEPNHAN]
2020-02-26 16:23:57,640 [1] DEBUG - Statement Id: [DAO00069_GetCountDanhSachNoiTru] PreparedStatement : [select count(A.SOBENHAN) as TOTALROWS        from TT_NOITRU_BENHAN A        inner join TT_TIEPNHAN B on B.TIEPNHAN_ID = A.TIEPNHAN_ID and (B.TRANGTHAI = 'NOITRU' or B.TRANGTHAI = 'HOANTHANH')        inner join TT_BENHNHAN C on C.BENHNHAN_ID = B.BENHNHAN_ID        left join TT_NOITRU_LUUTRU D on D.BENHAN_ID = A.BENHAN_ID        and D.LUUTRU_ID = ( select top 1 LUUTRU_ID from TT_NOITRU_LUUTRU where BENHAN_ID = A.BENHAN_ID order by BENHAN_ID desc)        left join TT_NOITRU_XACNHAN E on E.BENHAN_ID = A.BENHAN_ID        left join TT_NOITRU_LUUTRUCHITIET F on D.LUUTRU_ID = F.LUUTRU_ID and F.LUUTRUCHITIET_CURRENT = '1'        and F.LUUTRUCHITIET_ID in (select top 1 LUUTRUCHITIET_ID from TT_NOITRU_LUUTRUCHITIET where LUUTRU_ID = D.LUUTRU_ID order by LUUTRUCHITIET_ID desc)        where        A.KHOACHUYENDEN_ID is not null  and        (E.TRANGTHAI = 'DAXACNHAN' OR E.TRANGTHAI = 'HUYXACNHAN')         and           cast(A.NGAYVAOKHOA as date) <= cast('2/26/2020 12:00:00 AM' as date)                 and B.BENHVIEN_ID = 'HLU01' and A.KHOACHUYENDEN_ID = '25'          AND             A.TRANGTHAI in ('DANGDIEUTRI')]
2020-02-26 16:23:57,769 [1] DEBUG - Statement Id: [DAO00069_GetDanhSachNoiTru] PreparedStatement : [select * from        (        SELECT ROW_NUMBER() OVER(order by B.SOTIEPNHAN) as ROWNUMBER,          A.SOBENHAN, A.BENHAN_ID, A.SOLUUTRU                 , E.NOILAP_ID as KHOAVAO_ID        , A.TRANGTHAI, IsNull(A.BACSIDIEUTRI_ID, E.BACSICHIDINH_ID) as BACSIDIEUTRI_ID,        B.TIEPNHAN_ID, B.SOTIEPNHAN, B.SOBHYT as SOTHE, B.DOITUONG_ID, A.NGAYVAOKHOA as NGAYCAPCUU, A.THOIGIANVAOKHOA as THOIGIANCAPCUU,        C.TENBENHNHAN, C.NGAYSINH, C.NAMSINH, C.BENHNHAN_ID, C.MAYTE, F.GIUONGBENH_ID, A.THOIGIANRAVIEN    , DIACHITHUONGTRU, DANTOC_ID        ,BENHVIEN_STT_ID                from TT_NOITRU_BENHAN A        inner join TT_TIEPNHAN B on B.TIEPNHAN_ID = A.TIEPNHAN_ID and (B.TRANGTHAI = 'NOITRU' or B.TRANGTHAI = 'HOANTHANH')        inner join TT_BENHNHAN C on C.BENHNHAN_ID = B.BENHNHAN_ID        left join TT_NOITRU_LUUTRU D on D.BENHAN_ID = A.BENHAN_ID        and D.LUUTRU_ID = ( select top 1 LUUTRU_ID from TT_NOITRU_LUUTRU where BENHAN_ID = A.BENHAN_ID order by LUUTRU_ID desc)        left join TT_NOITRU_XACNHAN E on E.BENHAN_ID = A.BENHAN_ID        left join TT_NOITRU_LUUTRUCHITIET F on D.LUUTRU_ID = F.LUUTRU_ID and F.LUUTRUCHITIET_CURRENT = '1'        and F.LUUTRUCHITIET_ID in (select top 1 LUUTRUCHITIET_ID from TT_NOITRU_LUUTRUCHITIET where LUUTRU_ID = D.LUUTRU_ID order by LUUTRUCHITIET_ID desc)        left join (select MABENHVIEN, BENHVIEN_STT_ID from TM_BENHVIEN) H on SUBSTRING(B.SOBHYT, 16, 5)=H.MABENHVIEN        where        A.KHOACHUYENDEN_ID is not null  and        (E.TRANGTHAI = 'DAXACNHAN' OR E.TRANGTHAI = 'HUYXACNHAN')         and           cast(A.NGAYVAOKHOA as date) <= cast('2/26/2020 12:00:00 AM' as date)                 and B.BENHVIEN_ID = 'HLU01' and A.KHOACHUYENDEN_ID = '25'          AND             A.TRANGTHAI in ('DANGDIEUTRI')                   ) lst        where        lst.ROWNUMBER between 1 and 20        order by lst.SOTIEPNHAN]
2020-02-26 16:24:00,923 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM31'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 16:24:01,094 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'IPD03'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 16:24:02,582 [1] DEBUG - Statement Id: [DAO00080_KiemtraBenhAnDaThanhToan] PreparedStatement : [select DAXACNHANDOANHTHU        from TT_NOITRU_BENHAN where        BENHAN_ID = '24642'        and BENHVIEN_ID = 'HLU01'        Order By BENHAN_ID Desc]
2020-02-26 16:24:02,816 [1] DEBUG - Statement Id: [DAO00061_GetBenhAnDetailByID] PreparedStatement : [select A.*, B.NOIGIOITHIEU_ID, C.KHOADIEUTRI_ID, A.ICD_BENHCHINH AS ICD_BENHCHINH_BAK, A.CDRAVIEN_CHINH AS CHANDOANRAVIEN1, B.THOIGIANTIEPNHAN        , A.CDRAVIEN_CHINH AS CHANDOANRAVIEN_BAK        from TT_NOITRU_BENHAN A        left join TT_TIEPNHAN B on B.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TT_NOITRU_NHAPVIEN C on C.TIEPNHAN_ID = B.TIEPNHAN_ID        where A.BENHAN_ID = '24642']
2020-02-26 16:24:02,875 [1] DEBUG - Statement Id: [DAO00087_GetServiceParams] PreparedStatement : [select CODE, VALUE              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01']
2020-02-26 16:24:02,941 [1] DEBUG - Statement Id: [DAO00080_GetNoiTruLuuTruBenhAn] PreparedStatement : [select *        from TT_NOITRU_LUUTRU where        BENHAN_ID = '24642'        and BENHVIEN_ID = 'HLU01'        Order By LUUTRU_ID ASC]
2020-02-26 16:24:02,986 [1] DEBUG - Statement Id: [DAO00080_GetGiuongBenhCuaBenhAn] PreparedStatement : [select *        from TT_NOITRU_GIUONGBENH where        BENHAN_ID =  @param0]
2020-02-26 16:24:02,986 [1] DEBUG - Statement Id: [DAO00080_GetGiuongBenhCuaBenhAn] Parameters: [@param0=[BENHAN_ID,24642]]
2020-02-26 16:24:02,986 [1] DEBUG - Statement Id: [DAO00080_GetGiuongBenhCuaBenhAn] Types: [@param0=[Int64, System.Int64]]
2020-02-26 16:24:03,063 [1] DEBUG - Statement Id: [DAO00013_GetDetailP] PreparedStatement : [select *        from TT_BENHNHAN         WHERE              TT_BENHNHAN.MAYTE  = '190040528']
2020-02-26 16:24:03,139 [1] DEBUG - Statement Id: [DAO00061_GetBenhAnDetailByID] PreparedStatement : [select A.*, B.NOIGIOITHIEU_ID, C.KHOADIEUTRI_ID, A.ICD_BENHCHINH AS ICD_BENHCHINH_BAK, A.CDRAVIEN_CHINH AS CHANDOANRAVIEN1, B.THOIGIANTIEPNHAN        , A.CDRAVIEN_CHINH AS CHANDOANRAVIEN_BAK        from TT_NOITRU_BENHAN A        left join TT_TIEPNHAN B on B.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TT_NOITRU_NHAPVIEN C on C.TIEPNHAN_ID = B.TIEPNHAN_ID        where A.BENHAN_ID = '24642']
2020-02-26 16:24:03,273 [1] DEBUG - Statement Id: [DAO00080_GetNoiTruBenhAnChiTiet] PreparedStatement : [select *        from TT_NOITRU_BENHAN_CHITIET where        BENHAN_ID = '24642'        and BENHVIEN_ID = 'HLU01'        Order By BENHANCHITIET_ID DESC]
2020-02-26 16:24:03,357 [1] DEBUG - Statement Id: [DAO00080_GetNoiTruLuuTruBenhAn] PreparedStatement : [select *        from TT_NOITRU_LUUTRU where        BENHAN_ID = '24642'        and BENHVIEN_ID = 'HLU01'        Order By LUUTRU_ID ASC]
2020-02-26 16:24:03,391 [1] DEBUG - Statement Id: [DAO00080_GetGiuongBenhCuaBenhAn] PreparedStatement : [select *        from TT_NOITRU_GIUONGBENH where        BENHAN_ID =  @param0]
2020-02-26 16:24:03,391 [1] DEBUG - Statement Id: [DAO00080_GetGiuongBenhCuaBenhAn] Parameters: [@param0=[BENHAN_ID,24642]]
2020-02-26 16:24:03,391 [1] DEBUG - Statement Id: [DAO00080_GetGiuongBenhCuaBenhAn] Types: [@param0=[Int64, System.Int64]]
2020-02-26 16:24:03,686 [1] DEBUG - Statement Id: [DAO00067_laytrangthaibenhannoitru] PreparedStatement : [select isnull(TRANGTHAI, '') TRANGTHAI from TT_NOITRU_BENHAN where BENHAN_ID =  @param0]
2020-02-26 16:24:03,686 [1] DEBUG - Statement Id: [DAO00067_laytrangthaibenhannoitru] Parameters: [@param0=[BENHAN_ID,24642]]
2020-02-26 16:24:03,686 [1] DEBUG - Statement Id: [DAO00067_laytrangthaibenhannoitru] Types: [@param0=[Int64, System.Int64]]
2020-02-26 16:24:03,710 [1] DEBUG - Statement Id: [DAO00067_DeleteVienPhi_Noref] PreparedStatement : [delete from TT_VIENPHI where TIEPNHAN_ID = 107181 and (REF_ID is null or REF_ID = 0)         and           BENHAN_ID = '24642'                 delete TT_DUOC_TONKHO_BOOK_NOITRU where REF_TABLE = 'TT_NOITRU_TOATHUOC' and (REF_ID is null or REF_ID = 0)        delete TT_DUOC_TONKHO_BOOK_NGOAITRU where REF_ID is null or REF_ID = 0]
2020-02-26 16:24:03,734 [1] DEBUG - Statement Id: [DAO00067_UpdateBenhanIdVienPhi] PreparedStatement : [update TT_VIENPHI          set BENHAN_ID =  @param0           from (select TOATHUOC_ID from TT_NOITRU_TOATHUOC where TIEPNHAN_ID =  @param1 ) nttt          where REF_TABLE = 'TT_NOITRU_TOATHUOC' and REF_ID = nttt.TOATHUOC_ID and isnull(BENHAN_ID, 0) = 0          and TIEPNHAN_ID =  @param1             update TT_VIENPHI          set TT_VIENPHI.BENHAN_ID =  @param0           from (select DVYEUCAU_ID, BENHAN_ID from TT_DVYEUCAU where TIEPNHAN_ID =  @param1 ) nttt          where TT_VIENPHI.REF_TABLE = 'TT_DVYEUCAU' and TT_VIENPHI.REF_ID = nttt.DVYEUCAU_ID          and isnull(TT_VIENPHI.BENHAN_ID, 0) = 0 and isnull(nttt.BENHAN_ID, 0) > 0          and TT_VIENPHI.TIEPNHAN_ID =  @param1]
2020-02-26 16:24:03,735 [1] DEBUG - Statement Id: [DAO00067_UpdateBenhanIdVienPhi] Parameters: [@param0=[BENHAN_ID,24642], @param1=[TIEPNHAN_ID,107181]]
2020-02-26 16:24:03,735 [1] DEBUG - Statement Id: [DAO00067_UpdateBenhanIdVienPhi] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64]]
2020-02-26 16:24:03,762 [1] DEBUG - Statement Id: [DAO00064_GetlistTT_TIEPNHAN_SOTHEBHYT] PreparedStatement : [select stbhyt.*, ba.SOBENHAN,        tn.SOTIEPNHAN, tn.LOAITHANHVIEN_ID, tn.THE_ID, tn.THANHVIEN_ID,        tn.SUDUNG_BHTN, tn.BAOLANH_VIENPHI, tn.VIP, tn.NGUOINUOCNGOAI        from TT_TIEPNHAN_SOTHEBHYT stbhyt        left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = stbhyt.TIEPNHAN_ID        left join TT_NOITRU_BENHAN ba on ba.TIEPNHAN_ID = stbhyt.TIEPNHAN_ID        where        stbhyt.TIEPNHAN_ID = '107181' and isnull(stbhyt.KHONGSUDUNG, '0') = '0'         and           ba.BENHAN_ID = '24642']
2020-02-26 16:24:03,808 [1] DEBUG - Statement Id: [DAO00064_GetListVienPhiByTiepNnan] PreparedStatement : [select distinct        B.DOITUONG_ID, B.NGAYMIENDONGCHITRA, B.BENHNHAN_ID as TIEPNHAN_BENHNHAN_ID, B.TRAITUYEN,        B.BHYTTREN3NAM as TREN3NAM, B.BHYTTREN5NAM as TREN5NAM, B.SOTIEPNHAN, B.SOBENHAN,        B.LOAITHANHVIEN_ID, B.SUDUNG_BHTN, B.THE_ID, B.THANHVIEN_ID, B.BAOLANH_VIENPHI, B.VIP, B.NGUOINUOCNGOAI,        C.GIATRIMIENGIAM as GIATRIMIENGIAM, D.GIATRIMIENGIAM as GIATRIMIENGIAM_BHTN, E.GIATRIMIENGIAM as GIATRIMIENGIAM_THANHVIEN,        F.GIATRIMIENGIAM as GIATRIMIENGIAM_CONGTY, DVYC.THE_ID as DVDUNGTHE, DVYC.TRANGTHAI as TRANGTHAIDICHVU, ndv.MANHOMDICHVU,        A.* from TT_VIENPHI A        left join        (select B.*, C.SOBENHAN, C.BENHAN_ID        from TT_TIEPNHAN B        left join TT_NOITRU_BENHAN C on B.TIEPNHAN_ID = C.TIEPNHAN_ID         and           C.BENHAN_ID = '24642'                 where B.TIEPNHAN_ID = '107181') B on B.TIEPNHAN_ID = A.TIEPNHAN_ID        left join (select sum(GIATRIMIENGIAM) as GIATRIMIENGIAM, VIENPHI_ID, REF_TABLE        from TT_MIENGIAM_CHITIET        where REF_TABLE = 'TT_MIENGIAM'        and exists (select MIENGIAM_ID from TT_MIENGIAM where TT_MIENGIAM_CHITIET.MIENGIAM_ID = MIENGIAM_ID and TINHTRANG = 1 and TIEPNHAN_ID = '107181')        group by VIENPHI_ID, REF_TABLE) C on C.REF_TABLE = 'TT_MIENGIAM' and C.VIENPHI_ID = A.VIENPHI_ID        left join (select sum(GIATRIMIENGIAM) as GIATRIMIENGIAM, VIENPHI_ID, REF_TABLE        from TT_MIENGIAM_CHITIET        where REF_TABLE = 'TT_MIENGIAM_BHTN'        and exists (select MIENGIAM_BHTN_ID from TT_MIENGIAM_BHTN where TT_MIENGIAM_CHITIET.MIENGIAM_ID = MIENGIAM_BHTN_ID and  TINHTRANG = 1 and TIEPNHAN_ID = '107181')        group by VIENPHI_ID, REF_TABLE) D on D.REF_TABLE = 'TT_MIENGIAM_BHTN' and D.VIENPHI_ID = A.VIENPHI_ID        left join (select sum(GIATRIMIENGIAM) as GIATRIMIENGIAM, VIENPHI_ID, REF_TABLE        from TT_MIENGIAM_CHITIET        where REF_TABLE = 'TT_MIENGIAM_THANHVIEN'        and exists (select MIENGIAM_THANHVIEN_ID from TT_MIENGIAM_THANHVIEN where TT_MIENGIAM_CHITIET.MIENGIAM_ID = MIENGIAM_THANHVIEN_ID and TINHTRANG = 1 and TIEPNHAN_ID = '107181')        group by VIENPHI_ID, REF_TABLE) E on E.REF_TABLE = 'TT_MIENGIAM_THANHVIEN' and E.VIENPHI_ID = A.VIENPHI_ID        left join (select sum(GIATRIMIENGIAM) as GIATRIMIENGIAM, VIENPHI_ID, REF_TABLE        from TT_MIENGIAM_CHITIET        where REF_TABLE = 'TT_MIENGIAM_CONGTY'        and exists (select MIENGIAM_CONGTY_ID from TT_MIENGIAM_CONGTY where TT_MIENGIAM_CHITIET.MIENGIAM_ID = MIENGIAM_CONGTY_ID and TINHTRANG = 1 and TIEPNHAN_ID = '107181')        group by VIENPHI_ID, REF_TABLE) F on F.REF_TABLE = 'TT_MIENGIAM_CONGTY' and F.VIENPHI_ID = A.VIENPHI_ID        left join TT_DVYEUCAU DVYC on DVYC.DVYEUCAU_ID = A.REF_ID and A.REF_TABLE = 'TT_DVYEUCAU'        left join TM_DICHVU DV on DVYC.DICHVU_ID = DV.DICHVU_ID and A.REF_TABLE = 'TT_DVYEUCAU'        left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = DV.NHOMDICHVU_ID and A.REF_TABLE = 'TT_DVYEUCAU'        where        A.TIEPNHAN_ID = '107181' and ((DVYC.HUYYEUCAU = '0' and A.DICHVU_ID is not null)        or A.DUOC_ID is not null or A.REF_TABLE = 'TT_NUT_XACNHANSUATAN_CHITIET')        and A.ACTIVE = '1'         and           A.BENHAN_ID = '24642'                 and A.BENHVIEN_ID = 'HLU01'        order by A.VIENPHI_ID]
2020-02-26 16:24:03,872 [1] DEBUG - Statement Id: [DAO00006_GetListDuocTyle] PreparedStatement : [select DUOC_ID, DOITUONG_ID, (TYLE/100) as TYLE, DONGIA MUCTRAN_THANHTOAN from TM_DOITUONG_GIADUOC_TYLE            where            BENHVIEN_ID = 'HLU01'            and DOITUONG_ID = '4']
2020-02-26 16:24:03,924 [1] DEBUG - Statement Id: [DAO00027_GetListTuongTrinhDichVuPhauThuatCuaTiepNhan] PreparedStatement : [declare @ManhomDSA varchar(10);        declare @PhanLoaiNhomDV varchar(20) = '05';        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        if (@ManhomDSA is not null) set @PhanLoaiNhomDV += ',' + @ManhomDSA        select distinct ptyc.*        from TT_PHAUTHUAT_YEUCAU ptyc        inner join TM_DICHVU dv on dv.DICHVU_ID = ptyc.DICHVU_ID        inner join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID        inner join TT_PHAUTHUAT pt on pt.PHAUTHUAT_ID = ptyc.PHAUTHUAT_ID        where        pt.TIEPNHAN_ID = 107181        and (left(ndv.MANHOMDICHVU, 2) in (select * from STRING_SPLIT(@PhanLoaiNhomDV,',')) or ndv.MANHOMDICHVU in (select * from STRING_SPLIT(@PhanLoaiNhomDV,',')))]
2020-02-26 16:24:04,017 [1] DEBUG - Statement Id: [DAO00027_GetListTuongTrinhVTYTPhauThuatCuaTiepNhan] PreparedStatement : [select distinct ptvt.*        from TT_PHAUTHUAT_VTYT ptvt        inner join TT_PHAUTHUAT pt on pt.PHAUTHUAT_ID = ptvt.PHAUTHUAT_ID        inner join TM_DUOC d on d.DUOC_ID = ptvt.DUOC_ID        inner join TM_LOAIDUOC ld on ld.LOAIVATTU_ID = 'V' and ld.LOAIDUOC_ID = d.LOAIDUOC_ID        where pt.TIEPNHAN_ID = 107181        order by ptvt.PHAUTHUAT_VTYT_ID asc]
2020-02-26 16:24:04,057 [1] DEBUG - Statement Id: [DAO00006_GetList] PreparedStatement : [select dv.*, loaiDV.MALOAIDICHVU, captren.NHOMDICHVU_ID as NHOMDICHVU_CAPTREN_ID, captren.TENNHOMDICHVU as NHOMDICHVU_CAPTREN,              nhom_dv.TENNHOMDICHVU as TENNHOMDICHVU, nhom_dv.MANHOMDICHVU,              case when dv.ATTRIBUTE5 is null then 'TT' else 'KTC' end as LOAI_CHIPHI              from TM_DICHVU as dv              left join TM_NHOMDICHVU as nhom_dv on nhom_dv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID and nhom_dv.BENHVIEN_ID = 'HLU01'              left join TM_NHOMDICHVU as captren on nhom_dv.CAPTREN_ID = captren.NHOMDICHVU_ID and captren.BENHVIEN_ID = 'HLU01'              left join TM_LOAIDICHVU loaiDV on nhom_dv.LOAIDICHVU_ID = loaiDV.LOAIDICHVU_ID and loaiDV.BENHVIEN_ID = 'HLU01'              where nhom_dv.TAMNGUNG = '0' and dv.BENHVIEN_ID = 'HLU01'              and dv.TAMNGUNG = '0'               AND                   loaiDV.MALOAIDICHVU = 'KhamBenh']
2020-02-26 16:24:04,437 [1] DEBUG - Statement Id: [DAO00027_GetDichvuYCBHYTTyle] PreparedStatement : [select DVYEUCAU_ID from TT_DVYEUCAU        where TIEPNHAN_ID = 107181 and isnull(BHYT_TYLETHANHTOAN_ID, 0) > 0]
2020-02-26 16:24:04,726 [1] DEBUG - Statement Id: [DAO00023_UpdateNhieuVP] PreparedStatement : [declare @jsonVienPhi nvarchar(max) = N'[{"VIENPHI_ID":3109614,"TIEPNHAN_ID":107181,"DICHVU_ID":5440,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":34500.0000,"THANHTIEN_DOANHTHU":34500.00,"BHYT_TL":0.8000,"BHYT_DONGIA":34500.0000,"BHYT_THANHTIEN":34500.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":27600.0,"BHYT_THANHTIEN_CHITRA":27600.00,"BENHNHAN_PHAITHANHTOAN":6900.00,"GIATRI_HOADON":6900.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3109615,"TIEPNHAN_ID":107181,"DICHVU_ID":5554,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":5000.0000,"THANHTIEN_DOANHTHU":5000.00,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":5000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110619,"TIEPNHAN_ID":107181,"DICHVU_ID":4022,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":43900.0000,"THANHTIEN_DOANHTHU":43900.00,"BHYT_TL":0.8000,"BHYT_DONGIA":43900.0000,"BHYT_THANHTIEN":43900.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":35120.0,"BHYT_THANHTIEN_CHITRA":35120.00,"BENHNHAN_PHAITHANHTOAN":8780.00,"GIATRI_HOADON":8780.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110620,"TIEPNHAN_ID":107181,"DICHVU_ID":4422,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":32800.0000,"THANHTIEN_DOANHTHU":32800.00,"BHYT_TL":0.8000,"BHYT_DONGIA":32800.0000,"BHYT_THANHTIEN":32800.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":26240.0,"BHYT_THANHTIEN_CHITRA":26240.00,"BENHNHAN_PHAITHANHTOAN":6560.00,"GIATRI_HOADON":6560.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110621,"TIEPNHAN_ID":107181,"DICHVU_ID":4451,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":63500.0000,"THANHTIEN_DOANHTHU":63500.00,"BHYT_TL":0.8000,"BHYT_DONGIA":63500.0000,"BHYT_THANHTIEN":63500.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":50800.0,"BHYT_THANHTIEN_CHITRA":50800.00,"BENHNHAN_PHAITHANHTOAN":12700.00,"GIATRI_HOADON":12700.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110622,"TIEPNHAN_ID":107181,"DICHVU_ID":4454,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":40400.0000,"THANHTIEN_DOANHTHU":40400.00,"BHYT_TL":0.8000,"BHYT_DONGIA":40400.0000,"BHYT_THANHTIEN":40400.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":32320.0,"BHYT_THANHTIEN_CHITRA":32320.00,"BENHNHAN_PHAITHANHTOAN":8080.00,"GIATRI_HOADON":8080.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110623,"TIEPNHAN_ID":107181,"DICHVU_ID":4523,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":40400.0000,"THANHTIEN_DOANHTHU":40400.00,"BHYT_TL":0.8000,"BHYT_DONGIA":40400.0000,"BHYT_THANHTIEN":40400.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":32320.0,"BHYT_THANHTIEN_CHITRA":32320.00,"BENHNHAN_PHAITHANHTOAN":8080.00,"GIATRI_HOADON":8080.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110624,"TIEPNHAN_ID":107181,"DICHVU_ID":4596,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":39100.0000,"THANHTIEN_DOANHTHU":39100.00,"BHYT_TL":0.8000,"BHYT_DONGIA":39100.0000,"BHYT_THANHTIEN":39100.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":31280.0,"BHYT_THANHTIEN_CHITRA":31280.00,"BENHNHAN_PHAITHANHTOAN":7820.00,"GIATRI_HOADON":7820.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110626,"TIEPNHAN_ID":107181,"DICHVU_ID":4642,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":21500.0000,"THANHTIEN_DOANHTHU":21500.00,"BHYT_TL":0.8000,"BHYT_DONGIA":21500.0000,"BHYT_THANHTIEN":21500.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":17200.0,"BHYT_THANHTIEN_CHITRA":17200.00,"BENHNHAN_PHAITHANHTOAN":4300.00,"GIATRI_HOADON":4300.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110628,"TIEPNHAN_ID":107181,"DICHVU_ID":4681,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":21500.0000,"THANHTIEN_DOANHTHU":21500.00,"BHYT_TL":0.8000,"BHYT_DONGIA":21500.0000,"BHYT_THANHTIEN":21500.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":17200.0,"BHYT_THANHTIEN_CHITRA":17200.00,"BENHNHAN_PHAITHANHTOAN":4300.00,"GIATRI_HOADON":4300.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110629,"TIEPNHAN_ID":107181,"DICHVU_ID":4722,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":21500.0000,"THANHTIEN_DOANHTHU":21500.00,"BHYT_TL":0.8000,"BHYT_DONGIA":21500.0000,"BHYT_THANHTIEN":21500.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":17200.0,"BHYT_THANHTIEN_CHITRA":17200.00,"BENHNHAN_PHAITHANHTOAN":4300.00,"GIATRI_HOADON":4300.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110630,"TIEPNHAN_ID":107181,"DICHVU_ID":4747,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":27400.0000,"THANHTIEN_DOANHTHU":27400.00,"BHYT_TL":0.8000,"BHYT_DONGIA":27400.0000,"BHYT_THANHTIEN":27400.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":21920.0,"BHYT_THANHTIEN_CHITRA":21920.00,"BENHNHAN_PHAITHANHTOAN":5480.00,"GIATRI_HOADON":5480.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110631,"TIEPNHAN_ID":107181,"DICHVU_ID":4832,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":70000.0000,"THANHTIEN_DOANHTHU":70000.00,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":70000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":70000.0000,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":70000.0000,"GIATRI_BENHNHAN_DATHANHTOAN":70000.0000,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110632,"TIEPNHAN_ID":107181,"DICHVU_ID":4873,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":70000.0000,"THANHTIEN_DOANHTHU":70000.00,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":70000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":70000.0000,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":70000.0000,"GIATRI_BENHNHAN_DATHANHTOAN":70000.0000,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119342,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":5.0000,"DONGIA_DOANHTHU":4000.0000,"THANHTIEN_DOANHTHU":20000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":20000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119500,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":2.0000,"DONGIA_DOANHTHU":8715.0000,"THANHTIEN_DOANHTHU":17430.00,"BHYT_TL":0.8000,"BHYT_DONGIA":8715.0000,"BHYT_THANHTIEN":17430.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":6972.0,"BHYT_THANHTIEN_CHITRA":13944.00,"BENHNHAN_PHAITHANHTOAN":3486.00,"GIATRI_HOADON":3486.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119501,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":8925.0000,"THANHTIEN_DOANHTHU":8925.00,"BHYT_TL":0.8000,"BHYT_DONGIA":8925.0000,"BHYT_THANHTIEN":8925.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":7140.0,"BHYT_THANHTIEN_CHITRA":7140.00,"BENHNHAN_PHAITHANHTOAN":1785.00,"GIATRI_HOADON":1785.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119502,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":2.0000,"DONGIA_DOANHTHU":27990.0000,"THANHTIEN_DOANHTHU":55980.00,"BHYT_TL":0.8000,"BHYT_DONGIA":27990.0000,"BHYT_THANHTIEN":55980.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":22392.0,"BHYT_THANHTIEN_CHITRA":44784.00,"BENHNHAN_PHAITHANHTOAN":11196.00,"GIATRI_HOADON":11196.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119503,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":8925.0000,"THANHTIEN_DOANHTHU":8925.00,"BHYT_TL":0.8000,"BHYT_DONGIA":8925.0000,"BHYT_THANHTIEN":8925.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":7140.0,"BHYT_THANHTIEN_CHITRA":7140.00,"BENHNHAN_PHAITHANHTOAN":1785.00,"GIATRI_HOADON":1785.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119504,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":2.0000,"DONGIA_DOANHTHU":8295.0000,"THANHTIEN_DOANHTHU":16590.00,"BHYT_TL":0.8000,"BHYT_DONGIA":8295.0000,"BHYT_THANHTIEN":16590.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":6636.0,"BHYT_THANHTIEN_CHITRA":13272.00,"BENHNHAN_PHAITHANHTOAN":3318.00,"GIATRI_HOADON":3318.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119505,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":458000.0000,"THANHTIEN_DOANHTHU":458000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":398036.0000,"BHYT_THANHTIEN":398036.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":318428.8,"BHYT_THANHTIEN_CHITRA":318428.80,"BENHNHAN_PHAITHANHTOAN":139571.20,"GIATRI_HOADON":79607.20,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119506,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":50400.0000,"THANHTIEN_DOANHTHU":50400.00,"BHYT_TL":0.8000,"BHYT_DONGIA":50400.0000,"BHYT_THANHTIEN":50400.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":40320.0,"BHYT_THANHTIEN_CHITRA":40320.00,"BENHNHAN_PHAITHANHTOAN":10080.00,"GIATRI_HOADON":10080.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119530,"TIEPNHAN_ID":107181,"DICHVU_ID":5363,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":10000.0000,"THANHTIEN_DOANHTHU":10000.00,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119531,"TIEPNHAN_ID":107181,"DICHVU_ID":5588,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":2400.0000,"THANHTIEN_DOANHTHU":2400.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119532,"TIEPNHAN_ID":107181,"DICHVU_ID":477,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":110000.0000,"THANHTIEN_DOANHTHU":110000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119533,"TIEPNHAN_ID":107181,"DICHVU_ID":5602,"BENHAN_ID":24642,"SOLUONG":0.5000,"DONGIA_DOANHTHU":200000.0000,"THANHTIEN_DOANHTHU":100000.00,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":100000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119535,"TIEPNHAN_ID":107181,"DICHVU_ID":3161,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":2945000.0000,"THANHTIEN_DOANHTHU":2945000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":2945000.0000,"BHYT_THANHTIEN":2945000.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":2356000.0,"BHYT_THANHTIEN_CHITRA":2356000.00,"BENHNHAN_PHAITHANHTOAN":589000.00,"GIATRI_HOADON":589000.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119536,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":0.2500,"DONGIA_DOANHTHU":25000.0000,"THANHTIEN_DOANHTHU":6250.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119537,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":2.0000,"DONGIA_DOANHTHU":1700.0000,"THANHTIEN_DOANHTHU":3400.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119538,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":3.0000,"DONGIA_DOANHTHU":1000.0000,"THANHTIEN_DOANHTHU":3000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119539,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":3.0000,"DONGIA_DOANHTHU":2000.0000,"THANHTIEN_DOANHTHU":6000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119540,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":4000.0000,"THANHTIEN_DOANHTHU":4000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119541,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":3000.0000,"THANHTIEN_DOANHTHU":3000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119542,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":100.0000,"DONGIA_DOANHTHU":50.0000,"THANHTIEN_DOANHTHU":5000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119543,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":150000.0000,"THANHTIEN_DOANHTHU":150000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119544,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":160000.0000,"THANHTIEN_DOANHTHU":160000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119545,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":20.0000,"DONGIA_DOANHTHU":3000.0000,"THANHTIEN_DOANHTHU":60000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119546,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":20.0000,"DONGIA_DOANHTHU":6000.0000,"THANHTIEN_DOANHTHU":120000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119547,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":5.0000,"DONGIA_DOANHTHU":4000.0000,"THANHTIEN_DOANHTHU":20000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119548,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":10.0000,"DONGIA_DOANHTHU":8000.0000,"THANHTIEN_DOANHTHU":80000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119549,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":2.0000,"DONGIA_DOANHTHU":500.0000,"THANHTIEN_DOANHTHU":1000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119550,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":10000.0000,"THANHTIEN_DOANHTHU":10000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119551,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":45000.0000,"THANHTIEN_DOANHTHU":45000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119552,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":35000.0000,"THANHTIEN_DOANHTHU":35000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119553,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":10000.0000,"THANHTIEN_DOANHTHU":10000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119554,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":20000.0000,"THANHTIEN_DOANHTHU":20000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119555,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":6500.0000,"THANHTIEN_DOANHTHU":6500.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119556,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":0.5000,"DONGIA_DOANHTHU":16000.0000,"THANHTIEN_DOANHTHU":8000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119557,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":0.2500,"DONGIA_DOANHTHU":100000.0000,"THANHTIEN_DOANHTHU":25000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119558,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":2.0000,"DONGIA_DOANHTHU":10000.0000,"THANHTIEN_DOANHTHU":20000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119559,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":60000.0000,"THANHTIEN_DOANHTHU":60000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119560,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":2.0000,"DONGIA_DOANHTHU":13500.0000,"THANHTIEN_DOANHTHU":27000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119561,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":6000.0000,"THANHTIEN_DOANHTHU":6000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119645,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":600.0000,"THANHTIEN_DOANHTHU":600.00,"BHYT_TL":0.8000,"BHYT_DONGIA":600.0000,"BHYT_THANHTIEN":600.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":480.0,"BHYT_THANHTIEN_CHITRA":480.00,"BENHNHAN_PHAITHANHTOAN":120.00,"GIATRI_HOADON":120.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":0.0,"DUOC_TYLE":0.0000},{"VIENPHI_ID":3119646,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":1000.0000,"THANHTIEN_DOANHTHU":1000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":1000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"1","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":0.0,"DUOC_TYLE":0.0000},{"VIENPHI_ID":3119647,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":600.0000,"THANHTIEN_DOANHTHU":600.00,"BHYT_TL":0.8000,"BHYT_DONGIA":600.0000,"BHYT_THANHTIEN":600.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":480.0,"BHYT_THANHTIEN_CHITRA":480.00,"BENHNHAN_PHAITHANHTOAN":120.00,"GIATRI_HOADON":120.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":0.0,"DUOC_TYLE":0.0000},{"VIENPHI_ID":3119648,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":1000.0000,"THANHTIEN_DOANHTHU":1000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":1000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"1","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":0.0,"DUOC_TYLE":0.0000}]';        begin        UPDATE TT_VIENPHI        SET        SOLUONG = json.SOLUONG,        DONGIA_DOANHTHU = json.DONGIA_DOANHTHU,        THANHTIEN_DOANHTHU = json.THANHTIEN_DOANHTHU,        BHYT_TL = json.BHYT_TL,        BHYT_DONGIA = json.BHYT_DONGIA,        BHYT_THANHTIEN = json.BHYT_THANHTIEN,        BHYT_DONGIA_CONGKHAM_DAU = json.BHYT_DONGIA_CONGKHAM_DAU,        BHYT_CONGKHAM_DAU_TYLE = json.BHYT_CONGKHAM_DAU_TYLE,        BHYT_DONGIA_CHITRA = json.BHYT_DONGIA_CHITRA,        BHYT_THANHTIEN_CHITRA = json.BHYT_THANHTIEN_CHITRA,        BENHNHAN_PHAITHANHTOAN = json.BENHNHAN_PHAITHANHTOAN,        GIATRI_HOADON = json.GIATRI_HOADON,        GIATRI_BIENLAI = json.GIATRI_BIENLAI,        DATHUCHIEN = json.DATHUCHIEN,        DICHVU_TL = json.DICHVU_TL,        BHYT_DONGIA_DONGCT_DAU = json.BHYT_DONGIA_DONGCT_DAU,        SOLONHAP_ID = json.SOLONHAP_ID,        DUOC_TYLE = json.DUOC_TYLE,        DUOC_MUCTRAN_THANHTOAN = json.DUOC_MUCTRAN_THANHTOAN,        NGAYCAPNHAT = GETDATE()        FROM OPENJSON (@jsonVienPhi)        WITH (        VIENPHI_ID int,        SOLUONG numeric(25, 4),        DONGIA_DOANHTHU numeric(25, 4),        THANHTIEN_DOANHTHU numeric(25, 4),        BHYT_TL numeric(25, 4),        BHYT_DONGIA numeric(25, 4),        BHYT_THANHTIEN numeric(25, 4),        BHYT_DONGIA_CONGKHAM_DAU numeric(25, 4),        BHYT_CONGKHAM_DAU_TYLE numeric(25, 4),        BHYT_DONGIA_CHITRA numeric(25, 4),        BHYT_THANHTIEN_CHITRA numeric(25, 4),        BENHNHAN_PHAITHANHTOAN numeric(25, 4),        GIATRI_HOADON numeric(25, 4),        GIATRI_BIENLAI numeric(25, 4),        DATHUCHIEN char(1),        KHONGTHUTIEN char(1),        BHYTDONGTIEN char(1),        DICHVU_TL numeric(25, 4),        BHYT_DONGIA_DONGCT_DAU numeric(25, 4),        SOLONHAP_ID int,        DUOC_TYLE numeric(25, 4),        DUOC_MUCTRAN_THANHTOAN numeric(25, 4))  json        WHERE TT_VIENPHI.VIENPHI_ID = json.VIENPHI_ID and json.DONGIA_DOANHTHU > 0                  insert into TT_TINH_VIENPHI_LOG        SELECT json.VIENPHI_ID, json.TIEPNHAN_ID, json.BENHAN_ID, json.SOLUONG, json.BHYT_TL, json.DONGIA_DOANHTHU,        json.THANHTIEN_DOANHTHU, json.BHYT_DONGIA, json.BHYT_THANHTIEN, json.BHYT_DONGIA_CHITRA, json.BHYT_THANHTIEN_CHITRA, json.BENHNHAN_PHAITHANHTOAN,        json.SOBHYT_HUONG_ID, json.SOBHYT, GETDATE(), -1, 'HLU01'        FROM OPENJSON(@jsonVienPhi)        WITH (        VIENPHI_ID int,        TIEPNHAN_ID int,        BENHAN_ID int,        SOLUONG numeric(25, 4),        DONGIA_DOANHTHU numeric(25, 4),        THANHTIEN_DOANHTHU numeric(25, 4),        BHYT_TL numeric(25, 4),        BHYT_DONGIA numeric(25, 4),        BHYT_THANHTIEN numeric(25, 4),        BHYT_DONGIA_CHITRA numeric(25, 4),        BHYT_THANHTIEN_CHITRA numeric(25, 4),        BENHNHAN_PHAITHANHTOAN numeric(25, 4),        SOBHYT_HUONG_ID int,        SOBHYT nvarchar(30)) json        end]
2020-02-26 16:24:05,064 [1] DEBUG - Statement Id: [DAO00067_UpdateDataVienPhiDongiaBHYT] PreparedStatement : [update TT_VIENPHI          set BHYT_DONGIA_CHITRA = 0, BHYT_THANHTIEN = 0, BHYT_THANHTIEN_CHITRA = 0          where          TIEPNHAN_ID = 107181 and BHYT_DONGIA = 0          and (BHYT_DONGIA_CHITRA > 0 or BHYT_THANHTIEN > 0 or BHYT_THANHTIEN_CHITRA > 0)]
2020-02-26 16:24:05,093 [1] DEBUG - Statement Id: [DAO00067_CapnhatDataVienphiKhiHuyThanhtoanHoadon] PreparedStatement : [update TT_VIENPHI        set TT_VIENPHI.HOADON_ID = hdct.HOADON_ID, TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN = TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN + hdct.GIATRI_BENHNHAN_DATHANHTOAN        from (select CT.HOADON_ID, CT.VIENPHI_ID, CT.GIATRI_BENHNHAN_DATHANHTOAN        from TT_HOADON_CHITIET_NGOAITRU CT        join TT_HOADON HD on HD.HOADON_ID = CT.HOADON_ID        join TT_VIENPHI vp on vp.VIENPHI_ID = ct.VIENPHI_ID        where HD.DATHANHTOAN = 1 and HD.HUYHOADON = 0 and HD.HOANTRA = 0 and vp.TIEPNHAN_ID =  @param0 ) hdct        where        TT_VIENPHI.VIENPHI_ID = hdct.VIENPHI_ID and TT_VIENPHI.HOADON_ID is null and isnull(TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN,0) = 0        and TT_VIENPHI.TIEPNHAN_ID =  @param0           update TT_VIENPHI        set TT_VIENPHI.HOADON_ID = null, TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN = TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN - hdct.GIATRI_BENHNHAN_DATHANHTOAN,        TT_VIENPHI.DATHANHTOAN = '0'        from (select CT.HOADON_ID, CT.VIENPHI_ID, CT.GIATRI_BENHNHAN_DATHANHTOAN        from TT_HOADON_CHITIET_NGOAITRU CT        join TT_HOADON HD on HD.HOADON_ID = CT.HOADON_ID        join TT_VIENPHI vp on vp.VIENPHI_ID = ct.VIENPHI_ID and vp.HOADON_ID = ct.HOADON_ID        where HD.DATHANHTOAN = 0 and (HD.HUYHOADON = 1 or HD.HOANTRA = 1) and vp.TIEPNHAN_ID =  @param0 ) hdct        where        TT_VIENPHI.VIENPHI_ID = hdct.VIENPHI_ID and TT_VIENPHI.HOADON_ID = hdct.HOADON_ID        and TT_VIENPHI.TIEPNHAN_ID =  @param0]
2020-02-26 16:24:05,093 [1] DEBUG - Statement Id: [DAO00067_CapnhatDataVienphiKhiHuyThanhtoanHoadon] Parameters: [@param0=[TIEPNHAN_ID,107181]]
2020-02-26 16:24:05,093 [1] DEBUG - Statement Id: [DAO00067_CapnhatDataVienphiKhiHuyThanhtoanHoadon] Types: [@param0=[Int64, System.Int64]]
2020-02-26 16:24:06,359 [1] DEBUG - Statement Id: [DAO00305_GetListLoaiBenhAn] PreparedStatement : [select        DICTIONARY_ID as LOAIBENHAN_ID        , DICTIONARY_NAME as TENLOAIBENHAN        , DICTIONARY_NAME_EN        , DICTIONARY_CODE        , DICTIONARY_NAME        from LST_DICTIONARY        where LST_DICTIONARY.Enabled = '1' and DICTIONARY_TYPE_CODE = 'LoaiBenhAn'        order by LST_DICTIONARY.IDX]
2020-02-26 16:24:21,157 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'IPD60'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 16:24:22,238 [1] DEBUG - Statement Id: [DAO00040_LayListToaMau] PreparedStatement : [select A.*, dc.TENDUOCDAYDU, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ld.MALOAIDUOC, dd.DICTIONARY_NAME DUONGDUNG, dc.TAMNGUNG            from TT_TOATHUOCMAU A            left join TM_DUOC dc on A.DUOC_ID = dc.DUOC_ID            left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID            left join (select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE like 'DuongDung') dd on dd.DICTIONARY_ID = dc.DUONGDUNG_ID            where (1=1)]
2020-02-26 16:24:24,837 [1] DEBUG - Statement Id: [DAO00040_LayListToaMau] PreparedStatement : [select A.*, dc.TENDUOCDAYDU, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ld.MALOAIDUOC, dd.DICTIONARY_NAME DUONGDUNG, dc.TAMNGUNG            from TT_TOATHUOCMAU A            left join TM_DUOC dc on A.DUOC_ID = dc.DUOC_ID            left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID            left join (select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE like 'DuongDung') dd on dd.DICTIONARY_ID = dc.DUONGDUNG_ID            where (1=1)]
2020-02-26 16:24:28,311 [1] DEBUG - Statement Id: [DAO00017_GetLoaiGiaByDoiTuongId] PreparedStatement : [select dtlg.DOUUTIEN, dtlg.DOITUONG_ID, lg.LOAIGIA_ID, lg.TENLOAIGIA, lg.MALOAIGIA              from TM_LOAIGIA lg              left join TM_DOITUONG_LOAIGIA dtlg              on lg.LOAIGIA_ID = dtlg.LOAIGIA_ID and dtlg.BENHVIEN_ID = 'HLU01'              where lg.TAMNGUNG = 0 and lg.BENHVIEN_ID = 'HLU01'                             order by dtlg.DOUUTIEN]
2020-02-26 16:24:28,362 [1] DEBUG - Statement Id: [DAO00063_GetListKhoThuocPhongBanPhamvi] PreparedStatement : [select distinct dpv.*        from TM_DUOC_PHAMVISD_MAPPING dmap        left join TM_DUOC_PHAMVISUDUNG dpv on dpv.PHAMVI_ID = dmap.PHAMVI_ID        where dmap.KHODUOC_ID in (select KHODUOC_ID from TM_PHONGBAN_KHODUOC where PHONGBAN_ID = '25')]
2020-02-26 16:24:28,392 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1027']
2020-02-26 16:24:28,417 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1030']
2020-02-26 16:24:28,445 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1032']
2020-02-26 16:24:28,471 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1057']
2020-02-26 16:24:28,716 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1027']
2020-02-26 16:24:28,740 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1030']
2020-02-26 16:24:28,774 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1032']
2020-02-26 16:24:28,820 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1057']
2020-02-26 16:24:28,845 [1] DEBUG - Statement Id: [DAO00063_GetListPhamviTuKhoThuocVaPhongBan] PreparedStatement : [select distinct dpv.*, dmap.KHODUOC_ID        from TM_DUOC_PHAMVISD_MAPPING dmap        left join TM_DUOC_PHAMVISUDUNG dpv on dpv.PHAMVI_ID = dmap.PHAMVI_ID and dpv.TAMNGUNG != '1'        where dmap.KHODUOC_ID in (select KHODUOC_ID from TM_PHONGBAN_KHODUOC where PHONGBAN_ID = '25')        and dmap.KHODUOC_ID = '29' and dpv.MAPHAMVI is not null]
2020-02-26 16:24:28,922 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 999999999 as SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        where  @param0  = 0        union all        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end        else        begin        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO        group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end]
2020-02-26 16:24:28,923 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Parameters: [@param0=[PHAMVI_ID,1027]]
2020-02-26 16:24:28,923 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Types: [@param0=[Int64, System.Int64]]
2020-02-26 16:24:29,166 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 999999999 as SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        where  @param0  = 0        union all        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end        else        begin        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO        group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end]
2020-02-26 16:24:29,166 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Parameters: [@param0=[PHAMVI_ID,1027]]
2020-02-26 16:24:29,166 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Types: [@param0=[Int64, System.Int64]]
2020-02-26 16:24:29,437 [1] DEBUG - Statement Id: [DAO00096_GetList] PreparedStatement : [select *        from TM_DUOC_THANHPHANHOATCHAT        where BENHVIEN_ID = 'HLU01']
2020-02-26 16:24:29,607 [1] DEBUG - Statement Id: [DAO00040_LayListToaMau] PreparedStatement : [select A.*, dc.TENDUOCDAYDU, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ld.MALOAIDUOC, dd.DICTIONARY_NAME DUONGDUNG, dc.TAMNGUNG            from TT_TOATHUOCMAU A            left join TM_DUOC dc on A.DUOC_ID = dc.DUOC_ID            left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID            left join (select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE like 'DuongDung') dd on dd.DICTIONARY_ID = dc.DUONGDUNG_ID            where (1=1)]
2020-02-26 16:24:32,391 [1] DEBUG - Statement Id: [DAO00063_GetListKhoThuocPhongBanPhamvi] PreparedStatement : [select distinct dpv.*        from TM_DUOC_PHAMVISD_MAPPING dmap        left join TM_DUOC_PHAMVISUDUNG dpv on dpv.PHAMVI_ID = dmap.PHAMVI_ID        where dmap.KHODUOC_ID in (select KHODUOC_ID from TM_PHONGBAN_KHODUOC where PHONGBAN_ID = '25')]
2020-02-26 16:24:32,416 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1027']
2020-02-26 16:24:32,441 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1030']
2020-02-26 16:24:32,467 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1032']
2020-02-26 16:24:32,493 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1057']
2020-02-26 16:24:32,525 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1027']
2020-02-26 16:24:32,714 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1030']
2020-02-26 16:24:32,738 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1032']
2020-02-26 16:24:32,761 [1] DEBUG - Statement Id: [DAO00063_GetKhoduocUuTienTuPhamvi] PreparedStatement : [select top 1 dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        where dmap.PHAMVI_ID = '1057']
2020-02-26 16:24:32,785 [1] DEBUG - Statement Id: [DAO00063_GetListPhamviTuKhoThuocVaPhongBan] PreparedStatement : [select distinct dpv.*, dmap.KHODUOC_ID        from TM_DUOC_PHAMVISD_MAPPING dmap        left join TM_DUOC_PHAMVISUDUNG dpv on dpv.PHAMVI_ID = dmap.PHAMVI_ID and dpv.TAMNGUNG != '1'        where dmap.KHODUOC_ID in (select KHODUOC_ID from TM_PHONGBAN_KHODUOC where PHONGBAN_ID = '25')        and dmap.KHODUOC_ID = '29' and dpv.MAPHAMVI is not null]
2020-02-26 16:24:32,824 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 999999999 as SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        where  @param0  = 0        union all        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end        else        begin        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO        group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end]
2020-02-26 16:24:32,824 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Parameters: [@param0=[PHAMVI_ID,1027]]
2020-02-26 16:24:32,824 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Types: [@param0=[Int64, System.Int64]]
2020-02-26 16:24:33,028 [1] DEBUG - Statement Id: [DAO00063_Getlist_Thuoc_Tamngung] PreparedStatement : [select DUOC_ID FROM TM_DUOC where TAMNGUNG = '1']
2020-02-26 16:24:33,073 [1] DEBUG - Statement Id: [DAO00061_GetLuuTruIDByBenhAnID] PreparedStatement : [select lt.LUUTRU_ID, ba.BACSIDIEUTRI_ID as BACSIDIEUTRICHINH_ID        from TT_NOITRU_LUUTRU lt        left join TT_NOITRU_BENHAN ba on lt.BENHAN_ID = ba.BENHAN_ID        where lt.BENHAN_ID = '24642']
2020-02-26 16:24:33,108 [1] DEBUG - Statement Id: [DAO00061_GetChanDoanBenhAnID] PreparedStatement : [DECLARE @ICDPHU NVARCHAR(2000)=''        DECLARE @LISTICDPHU NVARCHAR(200)        DECLARE @CHANDOANRAVIEN NVARCHAR(500)        DECLARE @LISTICDPHUVAOKHOA NVARCHAR(50)        DECLARE @ICDPHUVAOKHOA NVARCHAR(500)=''        DECLARE @ICDKHAMBENH NVARCHAR(500) = (SELECT ICD.TENICD + '('+ISNULL(ICD.MAICD,'')+')'        FROM TT_NOITRU_BENHAN BA INNER JOIN TM_ICD ICD        ON BA.ICD_KHAMBENH = ICD.ICD_ID WHERE BA.BENHAN_ID =  @param0 )        DECLARE @ICDCHINH NVARCHAR(500) = (SELECT ICD.TENICD + '('+ISNULL(ICD.MAICD,'')+')'        FROM TT_NOITRU_BENHAN BA INNER JOIN TM_ICD ICD        ON BA.ICD_BENHCHINH = ICD.ICD_ID WHERE BA.BENHAN_ID =  @param0 )        SELECT @CHANDOANRAVIEN = BA.CHANDOANRAVIEN, @LISTICDPHU = BA.ICD_BENHPHU, @LISTICDPHUVAOKHOA = BA.ICD_PHU_VAOKHOA        FROM TT_NOITRU_BENHAN BA WHERE BA.BENHAN_ID =  @param0         SELECT @ICDPHU = @ICDPHU + ISNULL(TENICD, '') +'(' +ISNULL(MAICD,'')+ '); ' FROM TM_ICD WHERE MAICD IN (SELECT S FROM SplitString(@LISTICDPHU,';'))        SELECT @ICDPHUVAOKHOA = @ICDPHUVAOKHOA + ISNULL(TENICD, '') +'(' +ISNULL(MAICD,'')+ '); ' FROM TM_ICD WHERE MAICD IN (SELECT S FROM SplitString(@LISTICDPHUVAOKHOA,';'))        SELECT ICD_KHAMBENH, CHANDOANKHAMBENH, CHANDOANVAOKHOA, CHANDOANRAVIEN, CHANDOANKHAC                , CASE        WHEN LEN(ISNULL(BA.CDRAVIEN_PHU,'')) > 0 AND LEN(ISNULL(BA.CDRAVIEN_CHINH,'')) > 0 THEN ISNULL(BA.CDRAVIEN_CHINH,'') + '; ' + ISNULL(BA.CDRAVIEN_PHU,'')        WHEN LEN(ISNULL(BA.CDRAVIEN_PHU,'')) > 0 AND LEN(ISNULL(BA.CDRAVIEN_CHINH,'')) <= 0  THEN BA.CDRAVIEN_PHU        WHEN LEN(ISNULL(BA.CDRAVIEN_PHU,'')) <= 0 AND LEN(ISNULL(BA.CDRAVIEN_CHINH,'')) > 0 THEN BA.CDRAVIEN_CHINH        ELSE NULL END AS CHANDOANNOITRU        ,CASE WHEN @ICDKHAMBENH IS NULL AND (@CHANDOANRAVIEN IS NULL OR @CHANDOANRAVIEN = '') THEN ''        ELSE ISNULL(@ICDKHAMBENH, '') + '; ' + ISNULL(@CHANDOANRAVIEN, '') END        AS CHANDOANCAPCUU        , @ICDPHUVAOKHOA AS CHANDOANPHUVAOKHOA        FROM TT_NOITRU_BENHAN BA LEFT JOIN TM_ICD ICD ON BA.ICD_KHAMBENH = ICD.ICD_ID        WHERE BENHAN_ID =  @param0]
2020-02-26 16:24:33,108 [1] DEBUG - Statement Id: [DAO00061_GetChanDoanBenhAnID] Parameters: [@param0=[BENHAN_ID,24642]]
2020-02-26 16:24:33,108 [1] DEBUG - Statement Id: [DAO00061_GetChanDoanBenhAnID] Types: [@param0=[Int64, System.Int64]]
2020-02-26 16:24:33,159 [1] DEBUG - Statement Id: [DAO00000_GetDoiTuongIsBHYT] PreparedStatement : [select * from TM_DOITUONG Where DOITUONG_ID = 4 and MADOITUONG like '%BHYT%']
2020-02-26 16:24:33,571 [1] DEBUG - Statement Id: [DAO00068_GetLastedSinhHieuInfo] PreparedStatement : [select top (1) *, CHISOBMI as BMI              from TT_NGOAITRU_KHAMBENH_SINHHIEU              where BENHNHAN_ID = '20633'              order by KHAMBENH_SINHHIEU_ID desc]
2020-02-26 16:24:33,595 [1] DEBUG - Statement Id: [DAO00013_GetTienSuBenh] PreparedStatement : [select TIENSUBENH, TIENSUDIUNG        from TT_BENHNHAN        where TT_BENHNHAN.BENHNHAN_ID  = '20633']
2020-02-26 16:24:33,714 [1] DEBUG - Statement Id: [DAO00095_GetTTDiUngThuoc] PreparedStatement : [select *              from TT_BENHNHAN_DIUNG_THUOC              where BENHNHAN_ID = '20633'              and BENHVIEN_ID = 'HLU01']
2020-02-26 16:24:33,814 [1] DEBUG - Statement Id: [DAO00062_GetKhamBenhByTiepNhanID] PreparedStatement : [select *        from TT_NOITRU_KHAMBENH        where BENHAN_ID in        (select BENHAN_ID from TT_NOITRU_BENHAN        where TIEPNHAN_ID = '107181')        and ISYLENHVTYT = '0'         and           BENHAN_ID = '24642'                 order by THOIGIANKHAM desc]
2020-02-26 16:24:33,840 [1] DEBUG - Statement Id: [DAO00063_GetTrangThaiYLenhTheoTiepnhanId] PreparedStatement : [select tt.CHUNGTU_ID, tt.PHIEULINH_ID, tt.TRANGTHAI, pl.DUYET as DUYETPHIEULINH,        ct.CHUNGTU_ID as CHUNGTUXUATNOIBO_ID, ct.LOAICHUNGTU, tt.KHAMBENH_ID, tt.DUOC_ID, tt.SOLUONG        from TT_NOITRU_TOATHUOC tt        left join TT_DUOC_PHIEULINH pl on tt.PHIEULINH_ID = pl.CHUNGTU_ID        left join TT_DUOC_CHUNGTU ct on pl.CHUNGTU_ID = ct.PHIEULINH_ID        where tt.TIEPNHAN_ID = '107181'        and (tt.PHIEULINH_ID is not null or tt.CHUNGTU_ID is not null or (tt.TRANGTHAI = 'DADUYET'))        order by tt.CHUNGTU_ID DESC]
2020-02-26 16:24:33,865 [1] DEBUG - Statement Id: [DAO00063_GetDanhsachTrathuocTheoBenhanId] PreparedStatement : [select A.KHAMBENH_ID, B.TOATHUOC_ID, B.DUOC_ID, SUM(B.SOLUONG) SOLUONG        from TT_NOITRU_TRATHUOC A        left join TT_NOITRU_TRATHUOC_CHITIET B on A.TRATHUOC_ID = B.TRATHUOC_ID        where A.BENHAN_ID = '24642'         group by A.KHAMBENH_ID, B.TOATHUOC_ID, B.DUOC_ID]
2020-02-26 16:24:33,917 [1] DEBUG - Statement Id: [DAO00014_GetInPatientStatus] PreparedStatement : [select TRANGTHAI, isnull(KHOACHUYENDEN_ID, KHOAVAO_ID) as KHOAHIENTAI from TT_NOITRU_BENHAN        where        TIEPNHAN_ID = '107181'        and BENHVIEN_ID = 'HLU01'         and           BENHAN_ID = '24642']
2020-02-26 16:24:45,150 [1] DEBUG - Statement Id: [DAO00030_Get_DuocCanhBaoICD_ByBenhAn_ID] PreparedStatement : [select A.*          from TM_DUOC_CANHBAO_ICD A          inner join TM_DUOC_HOATCHAT B on B.HOATCHAT_ID = A.HOATCHAT_ID          inner join TM_DUOC_THANHPHANHOATCHAT C on C.HOATCHAT_ID = B.HOATCHAT_ID          inner join TM_DUOC D on D.DUOC_ID = C.DUOC_ID          inner join TT_NOITRU_BENHAN BA on (BA.ICD_VAOKHOA = A.ICD_ID or BA.ICD_KHAMBENH = A.ICD_ID or BA.ICD_BENHCHINH = A.ICD_ID or BA.ICDRAVIEN_CHINH = A.ICD_ID          or A.MAICD in (select part from fnSplit(BA.ICD_BENHPHU, ';'))           or A.MAICD in (select part from fnSplit(BA.ICDRAVIEN_PHU, ';'))          or A.MAICD in (select part from fnSplit(BA.ICD_PHU_VAOKHOA, ';'))) and BA.BENHAN_ID = 24642          where C.DUOC_ID = 1030          and A.TAMNGUNG = '0'          and A.BENHVIEN_ID = 'HLU01']
2020-02-26 16:24:45,185 [1] DEBUG - Statement Id: [DAO00013_GetTienSuBenh] PreparedStatement : [select TIENSUBENH, TIENSUDIUNG        from TT_BENHNHAN        where TT_BENHNHAN.BENHNHAN_ID  = '20633']
2020-02-26 16:24:45,210 [1] DEBUG - Statement Id: [DAO00095_GetTTDiUngThuoc] PreparedStatement : [select *              from TT_BENHNHAN_DIUNG_THUOC              where BENHNHAN_ID = '20633'              and BENHVIEN_ID = 'HLU01']
2020-02-26 16:24:45,233 [1] DEBUG - Statement Id: [DAO00096_GetList] PreparedStatement : [select *        from TM_DUOC_THANHPHANHOATCHAT        where BENHVIEN_ID = 'HLU01']
2020-02-26 16:24:45,269 [1] DEBUG - Statement Id: [DAO00013_GetTienSuBenh] PreparedStatement : [select TIENSUBENH, TIENSUDIUNG        from TT_BENHNHAN        where TT_BENHNHAN.BENHNHAN_ID  = '20633']
2020-02-26 16:24:45,294 [1] DEBUG - Statement Id: [DAO00095_GetTTDiUngThuoc] PreparedStatement : [select *              from TT_BENHNHAN_DIUNG_THUOC              where BENHNHAN_ID = '20633'              and BENHVIEN_ID = 'HLU01']
2020-02-26 16:24:45,322 [1] DEBUG - Statement Id: [DAO00016_GetTTDuocCanhBao] PreparedStatement : [select *        from TM_DUOC_CANHBAO         where                 DUOC_ID = '1030'             and               BENHVIEN_ID = 'HLU01'                     order by DUOC_CANHBAO_ID]
2020-02-26 16:24:45,361 [1] DEBUG - Statement Id: [DAO00000_GetCHECK_DOITUONG_BHYT] PreparedStatement : [select count(*) as DOITUONG_BHYT FROM TM_DOITUONG A            WHERE A.DOITUONG_ID = '4' and A.BENHVIEN_ID = 'HLU01' and MADOITUONG like '%BHYT%']
2020-02-26 16:24:45,534 [1] DEBUG - Statement Id: [DAO00000_GetLOAIGIATHUOC_NOI_NGOAI_VIEN] PreparedStatement : [SELECT LOAIGIA_ID              FROM TM_LOAIGIA              WHERE MALOAIGIA = 'GiaThuoc_NoiVien' and BENHVIEN_ID = 'HLU01']
2020-02-26 16:24:47,236 [1] DEBUG - Statement Id: [DAO00000_GetDUOC_DONGIADOANHTHU_NOIVIEN] PreparedStatement : [declare @doanhthuKhongHT numeric(24,2);          declare @doanhthu numeric(24,2);          declare @hotro numeric(24,2);          declare @bhyt char(1);          declare @loaigia_id int, @loaigiakhonght_id int            select top 1 @doanhthuKhongHT = dg.DONGIA, @loaigiakhonght_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0 and GIAHOTRO != '1'          order by dtlg.DOUUTIEN asc          select top 1 @doanhthu = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0           order by dtlg.DOUUTIEN asc          select top 1 @hotro = dg.DONGIA, @loaigia_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0  and GIAHOTRO = '1'          order by dtlg.DOUUTIEN asc          select top 1 @bhyt = BHYT from TM_DUOC where DUOC_ID = 1030          select ISNULL(@doanhthu,0.0) DONGIA_DOANHTHU, ISNULL(@hotro, 0.0) DONGIA_KHAC, ISNULL(@doanhthuKhongHT, 0.0) DONGIA_KHONGHT, isnull(@bhyt, '0') BHYT, ISNULL(@loaigia_id, 0) as LOAIGIA_ID, ISNULL(@loaigiakhonght_id, 0) as LOAIGIAKHONGHT_ID]
2020-02-26 16:24:48,142 [1] DEBUG - Statement Id: [DAO00000_GetDuocBHYT] PreparedStatement : [select count(*) BHYT FROM TM_DUOC A WHERE A.DUOC_ID = '1030' and BHYT = '1']
2020-02-26 16:24:49,028 [1] DEBUG - Statement Id: [DAO00000_GetCHECK_DOITUONG_BHYT] PreparedStatement : [select count(*) as DOITUONG_BHYT FROM TM_DOITUONG A            WHERE A.DOITUONG_ID = '4' and A.BENHVIEN_ID = 'HLU01' and MADOITUONG like '%BHYT%']
2020-02-26 16:24:49,078 [1] DEBUG - Statement Id: [DAO00000_GetLOAIGIATHUOC_NOI_NGOAI_VIEN] PreparedStatement : [SELECT LOAIGIA_ID              FROM TM_LOAIGIA              WHERE MALOAIGIA = 'GiaThuoc_NoiVien' and BENHVIEN_ID = 'HLU01']
2020-02-26 16:24:50,476 [1] DEBUG - Statement Id: [DAO00000_GetDUOC_DONGIADOANHTHU_NOIVIEN] PreparedStatement : [declare @doanhthuKhongHT numeric(24,2);          declare @doanhthu numeric(24,2);          declare @hotro numeric(24,2);          declare @bhyt char(1);          declare @loaigia_id int, @loaigiakhonght_id int            select top 1 @doanhthuKhongHT = dg.DONGIA, @loaigiakhonght_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0 and GIAHOTRO != '1'          order by dtlg.DOUUTIEN asc          select top 1 @doanhthu = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0           order by dtlg.DOUUTIEN asc          select top 1 @hotro = dg.DONGIA, @loaigia_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0  and GIAHOTRO = '1'          order by dtlg.DOUUTIEN asc          select top 1 @bhyt = BHYT from TM_DUOC where DUOC_ID = 1030          select ISNULL(@doanhthu,0.0) DONGIA_DOANHTHU, ISNULL(@hotro, 0.0) DONGIA_KHAC, ISNULL(@doanhthuKhongHT, 0.0) DONGIA_KHONGHT, isnull(@bhyt, '0') BHYT, ISNULL(@loaigia_id, 0) as LOAIGIA_ID, ISNULL(@loaigiakhonght_id, 0) as LOAIGIAKHONGHT_ID]
2020-02-26 16:24:51,938 [1] DEBUG - Statement Id: [DAO00000_GetDuocBHYT] PreparedStatement : [select count(*) BHYT FROM TM_DUOC A WHERE A.DUOC_ID = '1030' and BHYT = '1']
2020-02-26 16:25:04,626 [1] DEBUG - Statement Id: [DAO00030_Get_DuocCanhBaoICD_ByBenhAn_ID] PreparedStatement : [select A.*          from TM_DUOC_CANHBAO_ICD A          inner join TM_DUOC_HOATCHAT B on B.HOATCHAT_ID = A.HOATCHAT_ID          inner join TM_DUOC_THANHPHANHOATCHAT C on C.HOATCHAT_ID = B.HOATCHAT_ID          inner join TM_DUOC D on D.DUOC_ID = C.DUOC_ID          inner join TT_NOITRU_BENHAN BA on (BA.ICD_VAOKHOA = A.ICD_ID or BA.ICD_KHAMBENH = A.ICD_ID or BA.ICD_BENHCHINH = A.ICD_ID or BA.ICDRAVIEN_CHINH = A.ICD_ID          or A.MAICD in (select part from fnSplit(BA.ICD_BENHPHU, ';'))           or A.MAICD in (select part from fnSplit(BA.ICDRAVIEN_PHU, ';'))          or A.MAICD in (select part from fnSplit(BA.ICD_PHU_VAOKHOA, ';'))) and BA.BENHAN_ID = 24642          where C.DUOC_ID = 1030          and A.TAMNGUNG = '0'          and A.BENHVIEN_ID = 'HLU01']
2020-02-26 16:25:04,656 [1] DEBUG - Statement Id: [DAO00013_GetTienSuBenh] PreparedStatement : [select TIENSUBENH, TIENSUDIUNG        from TT_BENHNHAN        where TT_BENHNHAN.BENHNHAN_ID  = '20633']
2020-02-26 16:25:04,680 [1] DEBUG - Statement Id: [DAO00095_GetTTDiUngThuoc] PreparedStatement : [select *              from TT_BENHNHAN_DIUNG_THUOC              where BENHNHAN_ID = '20633'              and BENHVIEN_ID = 'HLU01']
2020-02-26 16:25:04,704 [1] DEBUG - Statement Id: [DAO00096_GetList] PreparedStatement : [select *        from TM_DUOC_THANHPHANHOATCHAT        where BENHVIEN_ID = 'HLU01']
2020-02-26 16:25:04,735 [1] DEBUG - Statement Id: [DAO00013_GetTienSuBenh] PreparedStatement : [select TIENSUBENH, TIENSUDIUNG        from TT_BENHNHAN        where TT_BENHNHAN.BENHNHAN_ID  = '20633']
2020-02-26 16:25:04,760 [1] DEBUG - Statement Id: [DAO00095_GetTTDiUngThuoc] PreparedStatement : [select *              from TT_BENHNHAN_DIUNG_THUOC              where BENHNHAN_ID = '20633'              and BENHVIEN_ID = 'HLU01']
2020-02-26 16:25:04,784 [1] DEBUG - Statement Id: [DAO00016_GetTTDuocCanhBao] PreparedStatement : [select *        from TM_DUOC_CANHBAO         where                 DUOC_ID = '1030'             and               BENHVIEN_ID = 'HLU01'                     order by DUOC_CANHBAO_ID]
2020-02-26 16:25:04,809 [1] DEBUG - Statement Id: [DAO00000_GetCHECK_DOITUONG_BHYT] PreparedStatement : [select count(*) as DOITUONG_BHYT FROM TM_DOITUONG A            WHERE A.DOITUONG_ID = '4' and A.BENHVIEN_ID = 'HLU01' and MADOITUONG like '%BHYT%']
2020-02-26 16:25:04,833 [1] DEBUG - Statement Id: [DAO00000_GetLOAIGIATHUOC_NOI_NGOAI_VIEN] PreparedStatement : [SELECT LOAIGIA_ID              FROM TM_LOAIGIA              WHERE MALOAIGIA = 'GiaThuoc_NoiVien' and BENHVIEN_ID = 'HLU01']
2020-02-26 16:25:06,871 [1] DEBUG - Statement Id: [DAO00000_GetDUOC_DONGIADOANHTHU_NOIVIEN] PreparedStatement : [declare @doanhthuKhongHT numeric(24,2);          declare @doanhthu numeric(24,2);          declare @hotro numeric(24,2);          declare @bhyt char(1);          declare @loaigia_id int, @loaigiakhonght_id int            select top 1 @doanhthuKhongHT = dg.DONGIA, @loaigiakhonght_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0 and GIAHOTRO != '1'          order by dtlg.DOUUTIEN asc          select top 1 @doanhthu = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0           order by dtlg.DOUUTIEN asc          select top 1 @hotro = dg.DONGIA, @loaigia_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0  and GIAHOTRO = '1'          order by dtlg.DOUUTIEN asc          select top 1 @bhyt = BHYT from TM_DUOC where DUOC_ID = 1030          select ISNULL(@doanhthu,0.0) DONGIA_DOANHTHU, ISNULL(@hotro, 0.0) DONGIA_KHAC, ISNULL(@doanhthuKhongHT, 0.0) DONGIA_KHONGHT, isnull(@bhyt, '0') BHYT, ISNULL(@loaigia_id, 0) as LOAIGIA_ID, ISNULL(@loaigiakhonght_id, 0) as LOAIGIAKHONGHT_ID]
2020-02-26 16:25:09,061 [1] DEBUG - Statement Id: [DAO00000_GetDuocBHYT] PreparedStatement : [select count(*) BHYT FROM TM_DUOC A WHERE A.DUOC_ID = '1030' and BHYT = '1']
2020-02-26 16:25:11,512 [1] DEBUG - Statement Id: [DAO00000_GetCHECK_DOITUONG_BHYT] PreparedStatement : [select count(*) as DOITUONG_BHYT FROM TM_DOITUONG A            WHERE A.DOITUONG_ID = '4' and A.BENHVIEN_ID = 'HLU01' and MADOITUONG like '%BHYT%']
2020-02-26 16:25:11,536 [1] DEBUG - Statement Id: [DAO00000_GetLOAIGIATHUOC_NOI_NGOAI_VIEN] PreparedStatement : [SELECT LOAIGIA_ID              FROM TM_LOAIGIA              WHERE MALOAIGIA = 'GiaThuoc_NoiVien' and BENHVIEN_ID = 'HLU01']
2020-02-26 16:25:12,722 [1] DEBUG - Statement Id: [DAO00000_GetDUOC_DONGIADOANHTHU_NOIVIEN] PreparedStatement : [declare @doanhthuKhongHT numeric(24,2);          declare @doanhthu numeric(24,2);          declare @hotro numeric(24,2);          declare @bhyt char(1);          declare @loaigia_id int, @loaigiakhonght_id int            select top 1 @doanhthuKhongHT = dg.DONGIA, @loaigiakhonght_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0 and GIAHOTRO != '1'          order by dtlg.DOUUTIEN asc          select top 1 @doanhthu = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0           order by dtlg.DOUUTIEN asc          select top 1 @hotro = dg.DONGIA, @loaigia_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0  and GIAHOTRO = '1'          order by dtlg.DOUUTIEN asc          select top 1 @bhyt = BHYT from TM_DUOC where DUOC_ID = 1030          select ISNULL(@doanhthu,0.0) DONGIA_DOANHTHU, ISNULL(@hotro, 0.0) DONGIA_KHAC, ISNULL(@doanhthuKhongHT, 0.0) DONGIA_KHONGHT, isnull(@bhyt, '0') BHYT, ISNULL(@loaigia_id, 0) as LOAIGIA_ID, ISNULL(@loaigiakhonght_id, 0) as LOAIGIAKHONGHT_ID]
2020-02-26 16:25:13,863 [1] DEBUG - Statement Id: [DAO00000_GetDuocBHYT] PreparedStatement : [select count(*) BHYT FROM TM_DUOC A WHERE A.DUOC_ID = '1030' and BHYT = '1']
2020-02-26 16:25:24,803 [1] DEBUG - Statement Id: [DAO00030_Get_DuocCanhBaoICD_ByBenhAn_ID] PreparedStatement : [select A.*          from TM_DUOC_CANHBAO_ICD A          inner join TM_DUOC_HOATCHAT B on B.HOATCHAT_ID = A.HOATCHAT_ID          inner join TM_DUOC_THANHPHANHOATCHAT C on C.HOATCHAT_ID = B.HOATCHAT_ID          inner join TM_DUOC D on D.DUOC_ID = C.DUOC_ID          inner join TT_NOITRU_BENHAN BA on (BA.ICD_VAOKHOA = A.ICD_ID or BA.ICD_KHAMBENH = A.ICD_ID or BA.ICD_BENHCHINH = A.ICD_ID or BA.ICDRAVIEN_CHINH = A.ICD_ID          or A.MAICD in (select part from fnSplit(BA.ICD_BENHPHU, ';'))           or A.MAICD in (select part from fnSplit(BA.ICDRAVIEN_PHU, ';'))          or A.MAICD in (select part from fnSplit(BA.ICD_PHU_VAOKHOA, ';'))) and BA.BENHAN_ID = 24642          where C.DUOC_ID = 934          and A.TAMNGUNG = '0'          and A.BENHVIEN_ID = 'HLU01']
2020-02-26 16:25:24,837 [1] DEBUG - Statement Id: [DAO00013_GetTienSuBenh] PreparedStatement : [select TIENSUBENH, TIENSUDIUNG        from TT_BENHNHAN        where TT_BENHNHAN.BENHNHAN_ID  = '20633']
2020-02-26 16:25:24,861 [1] DEBUG - Statement Id: [DAO00095_GetTTDiUngThuoc] PreparedStatement : [select *              from TT_BENHNHAN_DIUNG_THUOC              where BENHNHAN_ID = '20633'              and BENHVIEN_ID = 'HLU01']
2020-02-26 16:25:24,885 [1] DEBUG - Statement Id: [DAO00096_GetList] PreparedStatement : [select *        from TM_DUOC_THANHPHANHOATCHAT        where BENHVIEN_ID = 'HLU01']
2020-02-26 16:25:24,915 [1] DEBUG - Statement Id: [DAO00013_GetTienSuBenh] PreparedStatement : [select TIENSUBENH, TIENSUDIUNG        from TT_BENHNHAN        where TT_BENHNHAN.BENHNHAN_ID  = '20633']
2020-02-26 16:25:24,938 [1] DEBUG - Statement Id: [DAO00095_GetTTDiUngThuoc] PreparedStatement : [select *              from TT_BENHNHAN_DIUNG_THUOC              where BENHNHAN_ID = '20633'              and BENHVIEN_ID = 'HLU01']
2020-02-26 16:25:24,963 [1] DEBUG - Statement Id: [DAO00016_GetTTDuocCanhBao] PreparedStatement : [select *        from TM_DUOC_CANHBAO         where                 DUOC_ID = '934'             and               BENHVIEN_ID = 'HLU01'                     order by DUOC_CANHBAO_ID]
2020-02-26 16:25:24,991 [1] DEBUG - Statement Id: [DAO00000_GetCHECK_DOITUONG_BHYT] PreparedStatement : [select count(*) as DOITUONG_BHYT FROM TM_DOITUONG A            WHERE A.DOITUONG_ID = '4' and A.BENHVIEN_ID = 'HLU01' and MADOITUONG like '%BHYT%']
2020-02-26 16:25:25,014 [1] DEBUG - Statement Id: [DAO00000_GetLOAIGIATHUOC_NOI_NGOAI_VIEN] PreparedStatement : [SELECT LOAIGIA_ID              FROM TM_LOAIGIA              WHERE MALOAIGIA = 'GiaThuoc_NoiVien' and BENHVIEN_ID = 'HLU01']
2020-02-26 16:25:26,349 [1] DEBUG - Statement Id: [DAO00000_GetDUOC_DONGIADOANHTHU_NOIVIEN] PreparedStatement : [declare @doanhthuKhongHT numeric(24,2);          declare @doanhthu numeric(24,2);          declare @hotro numeric(24,2);          declare @bhyt char(1);          declare @loaigia_id int, @loaigiakhonght_id int            select top 1 @doanhthuKhongHT = dg.DONGIA, @loaigiakhonght_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '934' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0 and GIAHOTRO != '1'          order by dtlg.DOUUTIEN asc          select top 1 @doanhthu = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '934' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0           order by dtlg.DOUUTIEN asc          select top 1 @hotro = dg.DONGIA, @loaigia_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '934' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0  and GIAHOTRO = '1'          order by dtlg.DOUUTIEN asc          select top 1 @bhyt = BHYT from TM_DUOC where DUOC_ID = 934          select ISNULL(@doanhthu,0.0) DONGIA_DOANHTHU, ISNULL(@hotro, 0.0) DONGIA_KHAC, ISNULL(@doanhthuKhongHT, 0.0) DONGIA_KHONGHT, isnull(@bhyt, '0') BHYT, ISNULL(@loaigia_id, 0) as LOAIGIA_ID, ISNULL(@loaigiakhonght_id, 0) as LOAIGIAKHONGHT_ID]
2020-02-26 16:25:27,382 [1] DEBUG - Statement Id: [DAO00000_GetDuocBHYT] PreparedStatement : [select count(*) BHYT FROM TM_DUOC A WHERE A.DUOC_ID = '934' and BHYT = '1']
2020-02-26 16:25:28,959 [1] DEBUG - Statement Id: [DAO00000_GetCHECK_DOITUONG_BHYT] PreparedStatement : [select count(*) as DOITUONG_BHYT FROM TM_DOITUONG A            WHERE A.DOITUONG_ID = '4' and A.BENHVIEN_ID = 'HLU01' and MADOITUONG like '%BHYT%']
2020-02-26 16:25:28,998 [1] DEBUG - Statement Id: [DAO00000_GetLOAIGIATHUOC_NOI_NGOAI_VIEN] PreparedStatement : [SELECT LOAIGIA_ID              FROM TM_LOAIGIA              WHERE MALOAIGIA = 'GiaThuoc_NoiVien' and BENHVIEN_ID = 'HLU01']
2020-02-26 16:25:30,301 [1] DEBUG - Statement Id: [DAO00000_GetDUOC_DONGIADOANHTHU_NOIVIEN] PreparedStatement : [declare @doanhthuKhongHT numeric(24,2);          declare @doanhthu numeric(24,2);          declare @hotro numeric(24,2);          declare @bhyt char(1);          declare @loaigia_id int, @loaigiakhonght_id int            select top 1 @doanhthuKhongHT = dg.DONGIA, @loaigiakhonght_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '934' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0 and GIAHOTRO != '1'          order by dtlg.DOUUTIEN asc          select top 1 @doanhthu = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '934' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0           order by dtlg.DOUUTIEN asc          select top 1 @hotro = dg.DONGIA, @loaigia_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '934' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0  and GIAHOTRO = '1'          order by dtlg.DOUUTIEN asc          select top 1 @bhyt = BHYT from TM_DUOC where DUOC_ID = 934          select ISNULL(@doanhthu,0.0) DONGIA_DOANHTHU, ISNULL(@hotro, 0.0) DONGIA_KHAC, ISNULL(@doanhthuKhongHT, 0.0) DONGIA_KHONGHT, isnull(@bhyt, '0') BHYT, ISNULL(@loaigia_id, 0) as LOAIGIA_ID, ISNULL(@loaigiakhonght_id, 0) as LOAIGIAKHONGHT_ID]
2020-02-26 16:25:31,682 [1] DEBUG - Statement Id: [DAO00000_GetDuocBHYT] PreparedStatement : [select count(*) BHYT FROM TM_DUOC A WHERE A.DUOC_ID = '934' and BHYT = '1']
2020-02-26 16:25:35,791 [1] DEBUG - Statement Id: [DAO00062_GetThongTinNhapVienCuaBenhNhan] PreparedStatement : [select top 1 ba.THOIGIANVAOKHOA THOIGIANVAO        from TT_NOITRU_BENHAN ba        where ba.BENHAN_ID =  @param0]
2020-02-26 16:25:35,791 [1] DEBUG - Statement Id: [DAO00062_GetThongTinNhapVienCuaBenhNhan] Parameters: [@param0=[BENHAN_ID,24642]]
2020-02-26 16:25:35,791 [1] DEBUG - Statement Id: [DAO00062_GetThongTinNhapVienCuaBenhNhan] Types: [@param0=[Int64, System.Int64]]
2020-02-26 16:25:35,866 [1] DEBUG - Statement Id: [DAO00014_GetInPatientStatus] PreparedStatement : [select TRANGTHAI, isnull(KHOACHUYENDEN_ID, KHOAVAO_ID) as KHOAHIENTAI from TT_NOITRU_BENHAN        where        TIEPNHAN_ID = '107181'        and BENHVIEN_ID = 'HLU01'         and           BENHAN_ID = '24642']
2020-02-26 16:25:37,504 [1] DEBUG - Statement Id: [DAO00000_GetCHECK_DOITUONG_BHYT] PreparedStatement : [select count(*) as DOITUONG_BHYT FROM TM_DOITUONG A            WHERE A.DOITUONG_ID = '4' and A.BENHVIEN_ID = 'HLU01' and MADOITUONG like '%BHYT%']
2020-02-26 16:25:37,527 [1] DEBUG - Statement Id: [DAO00000_GetLOAIGIATHUOC_NOI_NGOAI_VIEN] PreparedStatement : [SELECT LOAIGIA_ID              FROM TM_LOAIGIA              WHERE MALOAIGIA = 'GiaThuoc_NoiVien' and BENHVIEN_ID = 'HLU01']
2020-02-26 16:25:38,730 [1] DEBUG - Statement Id: [DAO00000_GetDUOC_DONGIADOANHTHU_NOIVIEN] PreparedStatement : [declare @doanhthuKhongHT numeric(24,2);          declare @doanhthu numeric(24,2);          declare @hotro numeric(24,2);          declare @bhyt char(1);          declare @loaigia_id int, @loaigiakhonght_id int            select top 1 @doanhthuKhongHT = dg.DONGIA, @loaigiakhonght_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0 and GIAHOTRO != '1'          order by dtlg.DOUUTIEN asc          select top 1 @doanhthu = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0           order by dtlg.DOUUTIEN asc          select top 1 @hotro = dg.DONGIA, @loaigia_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0  and GIAHOTRO = '1'          order by dtlg.DOUUTIEN asc          select top 1 @bhyt = BHYT from TM_DUOC where DUOC_ID = 1030          select ISNULL(@doanhthu,0.0) DONGIA_DOANHTHU, ISNULL(@hotro, 0.0) DONGIA_KHAC, ISNULL(@doanhthuKhongHT, 0.0) DONGIA_KHONGHT, isnull(@bhyt, '0') BHYT, ISNULL(@loaigia_id, 0) as LOAIGIA_ID, ISNULL(@loaigiakhonght_id, 0) as LOAIGIAKHONGHT_ID]
2020-02-26 16:25:40,890 [1] DEBUG - Statement Id: [DAO00000_GetDuocBHYT] PreparedStatement : [select count(*) BHYT FROM TM_DUOC A WHERE A.DUOC_ID = '1030' and BHYT = '1']
2020-02-26 16:25:43,484 [1] DEBUG - Statement Id: [DAO00000_GetCHECK_DOITUONG_BHYT] PreparedStatement : [select count(*) as DOITUONG_BHYT FROM TM_DOITUONG A            WHERE A.DOITUONG_ID = '4' and A.BENHVIEN_ID = 'HLU01' and MADOITUONG like '%BHYT%']
2020-02-26 16:25:43,547 [1] DEBUG - Statement Id: [DAO00000_GetLOAIGIATHUOC_NOI_NGOAI_VIEN] PreparedStatement : [SELECT LOAIGIA_ID              FROM TM_LOAIGIA              WHERE MALOAIGIA = 'GiaThuoc_NoiVien' and BENHVIEN_ID = 'HLU01']
2020-02-26 16:25:45,397 [1] DEBUG - Statement Id: [DAO00000_GetDUOC_DONGIADOANHTHU_NOIVIEN] PreparedStatement : [declare @doanhthuKhongHT numeric(24,2);          declare @doanhthu numeric(24,2);          declare @hotro numeric(24,2);          declare @bhyt char(1);          declare @loaigia_id int, @loaigiakhonght_id int            select top 1 @doanhthuKhongHT = dg.DONGIA, @loaigiakhonght_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0 and GIAHOTRO != '1'          order by dtlg.DOUUTIEN asc          select top 1 @doanhthu = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0           order by dtlg.DOUUTIEN asc          select top 1 @hotro = dg.DONGIA, @loaigia_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0  and GIAHOTRO = '1'          order by dtlg.DOUUTIEN asc          select top 1 @bhyt = BHYT from TM_DUOC where DUOC_ID = 1030          select ISNULL(@doanhthu,0.0) DONGIA_DOANHTHU, ISNULL(@hotro, 0.0) DONGIA_KHAC, ISNULL(@doanhthuKhongHT, 0.0) DONGIA_KHONGHT, isnull(@bhyt, '0') BHYT, ISNULL(@loaigia_id, 0) as LOAIGIA_ID, ISNULL(@loaigiakhonght_id, 0) as LOAIGIAKHONGHT_ID]
2020-02-26 16:25:47,597 [1] DEBUG - Statement Id: [DAO00000_GetDuocBHYT] PreparedStatement : [select count(*) BHYT FROM TM_DUOC A WHERE A.DUOC_ID = '1030' and BHYT = '1']
2020-02-26 16:25:50,129 [1] DEBUG - Statement Id: [DAO00000_GetCHECK_DOITUONG_BHYT] PreparedStatement : [select count(*) as DOITUONG_BHYT FROM TM_DOITUONG A            WHERE A.DOITUONG_ID = '4' and A.BENHVIEN_ID = 'HLU01' and MADOITUONG like '%BHYT%']
2020-02-26 16:25:50,203 [1] DEBUG - Statement Id: [DAO00000_GetLOAIGIATHUOC_NOI_NGOAI_VIEN] PreparedStatement : [SELECT LOAIGIA_ID              FROM TM_LOAIGIA              WHERE MALOAIGIA = 'GiaThuoc_NoiVien' and BENHVIEN_ID = 'HLU01']
2020-02-26 16:25:51,567 [1] DEBUG - Statement Id: [DAO00000_GetDUOC_DONGIADOANHTHU_NOIVIEN] PreparedStatement : [declare @doanhthuKhongHT numeric(24,2);          declare @doanhthu numeric(24,2);          declare @hotro numeric(24,2);          declare @bhyt char(1);          declare @loaigia_id int, @loaigiakhonght_id int            select top 1 @doanhthuKhongHT = dg.DONGIA, @loaigiakhonght_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '934' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0 and GIAHOTRO != '1'          order by dtlg.DOUUTIEN asc          select top 1 @doanhthu = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '934' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0           order by dtlg.DOUUTIEN asc          select top 1 @hotro = dg.DONGIA, @loaigia_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '934' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0  and GIAHOTRO = '1'          order by dtlg.DOUUTIEN asc          select top 1 @bhyt = BHYT from TM_DUOC where DUOC_ID = 934          select ISNULL(@doanhthu,0.0) DONGIA_DOANHTHU, ISNULL(@hotro, 0.0) DONGIA_KHAC, ISNULL(@doanhthuKhongHT, 0.0) DONGIA_KHONGHT, isnull(@bhyt, '0') BHYT, ISNULL(@loaigia_id, 0) as LOAIGIA_ID, ISNULL(@loaigiakhonght_id, 0) as LOAIGIAKHONGHT_ID]
2020-02-26 16:25:52,752 [1] DEBUG - Statement Id: [DAO00000_GetDuocBHYT] PreparedStatement : [select count(*) BHYT FROM TM_DUOC A WHERE A.DUOC_ID = '934' and BHYT = '1']
2020-02-26 16:25:54,161 [1] DEBUG - Statement Id: [DAO00030_GetKhoDuocByPhamVi] PreparedStatement : [SELECT DISTINCT mp.KHODUOC_ID, lk.DICTIONARY_CODE as LOAIKHO          FROM TM_DUOC_PHAMVISD_MAPPING mp          INNER JOIN TM_KHODUOC kd on kd.KHODUOC_ID = mp.KHODUOC_ID          INNER JOIN LST_DICTIONARY lk on lk.DICTIONARY_ID = kd.LOAIKHO_ID          WHERE          mp.PHAMVI_ID = 1027          AND mp.BENHVIEN_ID ='HLU01'          AND mp.TAMNGUNG = '0']
2020-02-26 16:25:54,281 [1] DEBUG - Statement Id: [DAO00063_KiemtraSoluongDuocXuat] PreparedStatement : [select A.TONKHO, isnull(B.BOOK_NGOAI,0) BOOK_NGOAI, isnull(D.BOOK_NOI,0) BOOK_NOI, isnull(C.BOOK_NOI_THUOC,0) BOOK_NOI_THUOC, (A.TONKHO - isnull(B.BOOK_NGOAI,0) - isnull(D.BOOK_NOI,0)) TONKHO_BOOK        from(        select SUM(tk.SOLUONG) TONKHO, tk.DUOC_ID, sd.PHAMVI_ID, tk.NGUONDUOC_ID from TT_DUOC_TONKHO tk        inner join TM_DUOC_PHAMVISD_MAPPING sd on sd.KHODUOC_ID = tk.KHODUOC_ID        where sd.PHAMVI_ID  = '1027' and tk.DUOC_ID = '1030' and tk.NGUONDUOC_ID = '1'        group by tk.DUOC_ID, sd.PHAMVI_ID, tk.NGUONDUOC_ID) A        left join (        select SUM(SOLUONG) BOOK_NGOAI,DUOC_ID, PHAMVI_ID, NGUONHANG_ID from TT_DUOC_TONKHO_BOOK_NGOAITRU        where PHAMVI_ID  = '1027' and DUOC_ID = '1030' and NGUONHANG_ID = '1' and TRANGTHAI = 'HIEULUC'  and SOLUONG > 0        group by DUOC_ID, PHAMVI_ID, NGUONHANG_ID) B on A.DUOC_ID = B.DUOC_ID and A.PHAMVI_ID = B.PHAMVI_ID and A.NGUONDUOC_ID = B.NGUONHANG_ID        left join (        select SUM(SOLUONG) BOOK_NOI_THUOC,DUOC_ID, PHAMVI_ID, NGUONHANG_ID from TT_DUOC_TONKHO_BOOK_NOITRU        where PHAMVI_ID  = '1027' and DUOC_ID = '1030' and NGUONHANG_ID = '1' and REF_ID = '' and REF_TABLE = 'TT_NOITRU_TOATHUOC' and TRANGTHAI = 'HIEULUC' and SOLUONG > 0        group by DUOC_ID, PHAMVI_ID, NGUONHANG_ID) C on A.DUOC_ID = C.DUOC_ID and A.PHAMVI_ID = C.PHAMVI_ID and A.NGUONDUOC_ID = C.NGUONHANG_ID        left join (        select SUM(SOLUONG) BOOK_NOI,DUOC_ID, PHAMVI_ID, NGUONHANG_ID from TT_DUOC_TONKHO_BOOK_NOITRU        where PHAMVI_ID  = '1027' and DUOC_ID = '1030' and NGUONHANG_ID = '1' and TRANGTHAI = 'HIEULUC'  and SOLUONG > 0        group by DUOC_ID, PHAMVI_ID, NGUONHANG_ID) D on A.DUOC_ID = D.DUOC_ID and A.PHAMVI_ID = D.PHAMVI_ID and A.NGUONDUOC_ID = D.NGUONHANG_ID]
2020-02-26 16:25:54,305 [1] DEBUG - Statement Id: [DAO00063_KiemtraSoluongDuocXuat] PreparedStatement : [select A.TONKHO, isnull(B.BOOK_NGOAI,0) BOOK_NGOAI, isnull(D.BOOK_NOI,0) BOOK_NOI, isnull(C.BOOK_NOI_THUOC,0) BOOK_NOI_THUOC, (A.TONKHO - isnull(B.BOOK_NGOAI,0) - isnull(D.BOOK_NOI,0)) TONKHO_BOOK        from(        select SUM(tk.SOLUONG) TONKHO, tk.DUOC_ID, sd.PHAMVI_ID, tk.NGUONDUOC_ID from TT_DUOC_TONKHO tk        inner join TM_DUOC_PHAMVISD_MAPPING sd on sd.KHODUOC_ID = tk.KHODUOC_ID        where sd.PHAMVI_ID  = '1027' and tk.DUOC_ID = '1030' and tk.NGUONDUOC_ID = '1'        group by tk.DUOC_ID, sd.PHAMVI_ID, tk.NGUONDUOC_ID) A        left join (        select SUM(SOLUONG) BOOK_NGOAI,DUOC_ID, PHAMVI_ID, NGUONHANG_ID from TT_DUOC_TONKHO_BOOK_NGOAITRU        where PHAMVI_ID  = '1027' and DUOC_ID = '1030' and NGUONHANG_ID = '1' and TRANGTHAI = 'HIEULUC'  and SOLUONG > 0        group by DUOC_ID, PHAMVI_ID, NGUONHANG_ID) B on A.DUOC_ID = B.DUOC_ID and A.PHAMVI_ID = B.PHAMVI_ID and A.NGUONDUOC_ID = B.NGUONHANG_ID        left join (        select SUM(SOLUONG) BOOK_NOI_THUOC,DUOC_ID, PHAMVI_ID, NGUONHANG_ID from TT_DUOC_TONKHO_BOOK_NOITRU        where PHAMVI_ID  = '1027' and DUOC_ID = '1030' and NGUONHANG_ID = '1' and REF_ID = '' and REF_TABLE = 'TT_NOITRU_TOATHUOC' and TRANGTHAI = 'HIEULUC' and SOLUONG > 0        group by DUOC_ID, PHAMVI_ID, NGUONHANG_ID) C on A.DUOC_ID = C.DUOC_ID and A.PHAMVI_ID = C.PHAMVI_ID and A.NGUONDUOC_ID = C.NGUONHANG_ID        left join (        select SUM(SOLUONG) BOOK_NOI,DUOC_ID, PHAMVI_ID, NGUONHANG_ID from TT_DUOC_TONKHO_BOOK_NOITRU        where PHAMVI_ID  = '1027' and DUOC_ID = '1030' and NGUONHANG_ID = '1' and TRANGTHAI = 'HIEULUC'  and SOLUONG > 0        group by DUOC_ID, PHAMVI_ID, NGUONHANG_ID) D on A.DUOC_ID = D.DUOC_ID and A.PHAMVI_ID = D.PHAMVI_ID and A.NGUONDUOC_ID = D.NGUONHANG_ID]
2020-02-26 16:25:54,330 [1] DEBUG - Statement Id: [DAO00063_KiemtraSoluongDuocXuat] PreparedStatement : [select A.TONKHO, isnull(B.BOOK_NGOAI,0) BOOK_NGOAI, isnull(D.BOOK_NOI,0) BOOK_NOI, isnull(C.BOOK_NOI_THUOC,0) BOOK_NOI_THUOC, (A.TONKHO - isnull(B.BOOK_NGOAI,0) - isnull(D.BOOK_NOI,0)) TONKHO_BOOK        from(        select SUM(tk.SOLUONG) TONKHO, tk.DUOC_ID, sd.PHAMVI_ID, tk.NGUONDUOC_ID from TT_DUOC_TONKHO tk        inner join TM_DUOC_PHAMVISD_MAPPING sd on sd.KHODUOC_ID = tk.KHODUOC_ID        where sd.PHAMVI_ID  = '1027' and tk.DUOC_ID = '934' and tk.NGUONDUOC_ID = '1'        group by tk.DUOC_ID, sd.PHAMVI_ID, tk.NGUONDUOC_ID) A        left join (        select SUM(SOLUONG) BOOK_NGOAI,DUOC_ID, PHAMVI_ID, NGUONHANG_ID from TT_DUOC_TONKHO_BOOK_NGOAITRU        where PHAMVI_ID  = '1027' and DUOC_ID = '934' and NGUONHANG_ID = '1' and TRANGTHAI = 'HIEULUC'  and SOLUONG > 0        group by DUOC_ID, PHAMVI_ID, NGUONHANG_ID) B on A.DUOC_ID = B.DUOC_ID and A.PHAMVI_ID = B.PHAMVI_ID and A.NGUONDUOC_ID = B.NGUONHANG_ID        left join (        select SUM(SOLUONG) BOOK_NOI_THUOC,DUOC_ID, PHAMVI_ID, NGUONHANG_ID from TT_DUOC_TONKHO_BOOK_NOITRU        where PHAMVI_ID  = '1027' and DUOC_ID = '934' and NGUONHANG_ID = '1' and REF_ID = '' and REF_TABLE = 'TT_NOITRU_TOATHUOC' and TRANGTHAI = 'HIEULUC' and SOLUONG > 0        group by DUOC_ID, PHAMVI_ID, NGUONHANG_ID) C on A.DUOC_ID = C.DUOC_ID and A.PHAMVI_ID = C.PHAMVI_ID and A.NGUONDUOC_ID = C.NGUONHANG_ID        left join (        select SUM(SOLUONG) BOOK_NOI,DUOC_ID, PHAMVI_ID, NGUONHANG_ID from TT_DUOC_TONKHO_BOOK_NOITRU        where PHAMVI_ID  = '1027' and DUOC_ID = '934' and NGUONHANG_ID = '1' and TRANGTHAI = 'HIEULUC'  and SOLUONG > 0        group by DUOC_ID, PHAMVI_ID, NGUONHANG_ID) D on A.DUOC_ID = D.DUOC_ID and A.PHAMVI_ID = D.PHAMVI_ID and A.NGUONDUOC_ID = D.NGUONHANG_ID]
2020-02-26 16:25:54,360 [1] DEBUG - Statement Id: [DAOLOG01_LockBegin] PreparedStatement : [INSERT into TT_LOG_UPDATE ( REF_TABLE , REF_ID , BENHVIEN_ID )         values ( @param0 ,  @param1 ,  @param2 );]
2020-02-26 16:25:54,360 [1] DEBUG - Statement Id: [DAOLOG01_LockBegin] Parameters: [@param0=[REF_TABLE,TT_NOITRU_KHAMBENH], @param1=[REF_ID,24642], @param2=[BENHVIEN_ID,HLU01]]
2020-02-26 16:25:54,360 [1] DEBUG - Statement Id: [DAOLOG01_LockBegin] Types: [@param0=[String, System.String], @param1=[Int64, System.Int64], @param2=[String, System.String]]
2020-02-26 16:25:54,567 [1] DEBUG - Statement Id: [DAO00026_GEN_EXAM_KEY] PreparedStatement : [select max(KEYVALUE) KEYVALUE              from LST_KEYDATA_TOATHUOC               where                             LST_KEYDATA_TOATHUOC.KEYTYPE = 'SOTHUTUTOA_NOITRU'                       and                           LST_KEYDATA_TOATHUOC.KEYYEAR = '2020'                       and                           LST_KEYDATA_TOATHUOC.KEYMONTH = '2'                       and                           LST_KEYDATA_TOATHUOC.KEYDAY = '26']
2020-02-26 16:25:54,746 [1] DEBUG - Statement Id: [DAO00026_Update] PreparedStatement : [IF EXISTS (select KEYTYPE from LST_KEYDATA_TOATHUOC where KEYTYPE = 'SOTHUTUTOA_NOITRU' AND KEYYEAR = '2020' AND KEYMONTH = '2' AND KEYDAY = '26')            BEGIN            update LST_KEYDATA_TOATHUOC set            KEYVALUE =  @param0             where            KEYTYPE = 'SOTHUTUTOA_NOITRU'            AND KEYYEAR = '2020'            AND KEYMONTH = '2'            AND KEYDAY = '26'            AND SEGMENT_1 = '0'            AND SEGMENT_2 = '0'            AND SEGMENT_3 = '0'            END            ELSE            BEGIN            insert into LST_KEYDATA_TOATHUOC (            KEYTYPE            , KEYYEAR            , KEYMONTH            , KEYDAY            , SEGMENT_1            , SEGMENT_2            , SEGMENT_3            , KEYVALUE            ) values (             @param1             ,  @param2             ,  @param3             ,  @param4             ,  @param5             ,  @param6             ,  @param7             ,  @param0             )            END]
2020-02-26 16:25:54,747 [1] DEBUG - Statement Id: [DAO00026_Update] Parameters: [@param0=[KEYVALUE,0005], @param1=[KEYTYPE,SOTHUTUTOA_NOITRU], @param2=[KEYYEAR,2020], @param3=[KEYMONTH,2], @param4=[KEYDAY,26], @param5=[SEGMENT_1,0], @param6=[SEGMENT_2,0], @param7=[SEGMENT_3,0]]
2020-02-26 16:25:54,747 [1] DEBUG - Statement Id: [DAO00026_Update] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[Int32, System.Int32], @param3=[Int32, System.Int32], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[String, System.String], @param7=[String, System.String]]
2020-02-26 16:25:54,800 [1] DEBUG - Statement Id: [DAO00062_Add] PreparedStatement : [insert into TT_NOITRU_KHAMBENH (        BENHAN_ID        , LUUTRU_ID        , LANKHAM        , NGAYKHAM        , THOIGIANKHAM        , BACSIKHAM_ID        , PHONGBAN_ID        , DIEUDUONG_ID        , CAPHOLY_ID        , DOITUONG_ID        , PHATDO_DIEUTRI_ID        , DINHBENH        , DIENBIEN        , LOIDAN        , CHEDOANUONG_ID        , CHEDOCHAMSOC_ID        , PHANCAPCHAMSOC_ID        , CHUNGTUPHATTHUOC_ID        , KHODUOC_ID        , NOINHANTHUOC_ID        , LOAITOATHUOC        , THUOCDACTRI        , NGAYTAIKHAM        , SONGAYHENTAIKHAM        , RAVIEN        , ISTHUOCBV              , ISYLENHVTYT        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYCAPNHAT        , NGUOICAPNHAT_ID         ,           GHICHU_KHAMBENH         ,           GHICHU         ,           CHEDODINHDUONG         ,           MATOAMAU                 ) values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31          ,            @param32          ,            @param33          ,           @param34          ,            @param35                  )]
2020-02-26 16:25:54,800 [1] DEBUG - Statement Id: [DAO00062_Add] Parameters: [@param0=[BENHAN_ID,24642], @param1=[LUUTRU_ID,39529], @param2=[LANKHAM,1], @param3=[NGAYKHAM,2/26/2020 12:00:00 AM], @param4=[THOIGIANKHAM,2/26/2020 4:24:29 PM], @param5=[BACSIKHAM_ID,1], @param6=[PHONGBAN_ID,25], @param7=[DIEUDUONG_ID,null], @param8=[CAPHOLY_ID,null], @param9=[DOITUONG_ID,4], @param10=[PHATDO_DIEUTRI_ID,null], @param11=[DINHBENH,Theo dõi thai bình thường(Z34)], @param12=[DIENBIEN,adasd], @param13=[LOIDAN,null], @param14=[CHEDOANUONG_ID,null], @param15=[CHEDOCHAMSOC_ID,null], @param16=[PHANCAPCHAMSOC_ID,8588], @param17=[CHUNGTUPHATTHUOC_ID,null], @param18=[KHODUOC_ID,null], @param19=[NOINHANTHUOC_ID,null], @param20=[LOAITOATHUOC,YL], @param21=[THUOCDACTRI,0], @param22=[NGAYTAIKHAM,null], @param23=[SONGAYHENTAIKHAM,null], @param24=[RAVIEN,0], @param25=[ISTHUOCBV,1], @param26=[ISYLENHVTYT,0], @param27=[BENHVIEN_ID,HLU01], @param28=[NGAYTAO,2/26/2020 4:25:54 PM], @param29=[NGUOITAO_ID,1], @param30=[NGAYCAPNHAT,2/26/2020 4:25:54 PM], @param31=[NGUOICAPNHAT_ID,1], @param32=[GHICHU_KHAMBENH,null], @param33=[GHICHU_DICHVU,null], @param34=[CHEDODINHDUONG,null], @param35=[MATOAMAU,null]]
2020-02-26 16:25:54,800 [1] DEBUG - Statement Id: [DAO00062_Add] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64], @param2=[Int64, System.Int64], @param3=[DateTime, System.DateTime], @param4=[DateTime, System.DateTime], @param5=[Int64, System.Int64], @param6=[String, System.String], @param7=[System.DBNull, null], @param8=[System.DBNull, null], @param9=[Int64, System.Int64], @param10=[System.DBNull, null], @param11=[String, System.String], @param12=[String, System.String], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[String, System.String], @param21=[String, System.String], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[String, System.String], @param28=[DateTime, System.DateTime], @param29=[Int64, System.Int64], @param30=[DateTime, System.DateTime], @param31=[Int64, System.Int64], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null]]
2020-02-26 16:25:54,847 [1] DEBUG - Statement Id: [DAO00062_Add.SelectKey] PreparedStatement : [SELECT @@IDENTITY as value]
2020-02-26 16:25:54,879 [1] DEBUG - Statement Id: [DAO00062_GetKhoThuocCosoKhongCoso] PreparedStatement : [select distinct kd.KHODUOC_ID, lst.DICTIONARY_CODE  LOAIKHO from TM_KHODUOC kd        left join TM_PHONGBAN_KHODUOC pbkd        on kd.KHODUOC_ID = pbkd.KHODUOC_ID        and kd.BENHVIEN_ID = pbkd.BENHVIEN_ID        left join LST_DICTIONARY lst on lst.DICTIONARY_ID = kd.LOAIKHO_ID        where lst.DICTIONARY_CODE = 'Coso']
2020-02-26 16:25:54,903 [1] DEBUG - Statement Id: [DAO00062_GetAllPhamviKhoDuoc] PreparedStatement : [select distinct dmap.*        from TM_DUOC_PHAMVISD_MAPPING dmap        left join TM_DUOC_PHAMVISUDUNG dpv on dpv.PHAMVI_ID = dmap.PHAMVI_ID]
2020-02-26 16:25:54,927 [1] DEBUG - Statement Id: [DAO00023_GetSOBHYT_HUONG_ID] PreparedStatement : [select isnull(MAX(SOBHYT_HUONG_ID),0) SOBHYT_HUONG_ID        from TT_TIEPNHAN_SOTHEBHYT        where TIEPNHAN_ID = '107181']
2020-02-26 16:25:58,260 [1] DEBUG - Statement Id: [DAO00000_GetCHECK_DOITUONG_BHYT] PreparedStatement : [select count(*) as DOITUONG_BHYT FROM TM_DOITUONG A            WHERE A.DOITUONG_ID = '4' and A.BENHVIEN_ID = 'HLU01' and MADOITUONG like '%BHYT%']
2020-02-26 16:25:58,284 [1] DEBUG - Statement Id: [DAO00000_GetLOAIGIATHUOC_NOI_NGOAI_VIEN] PreparedStatement : [SELECT LOAIGIA_ID              FROM TM_LOAIGIA              WHERE MALOAIGIA = 'GiaThuoc_NoiVien' and BENHVIEN_ID = 'HLU01']
2020-02-26 16:25:59,520 [1] DEBUG - Statement Id: [DAO00000_GetDUOC_DONGIADOANHTHU_NOIVIEN] PreparedStatement : [declare @doanhthuKhongHT numeric(24,2);          declare @doanhthu numeric(24,2);          declare @hotro numeric(24,2);          declare @bhyt char(1);          declare @loaigia_id int, @loaigiakhonght_id int            select top 1 @doanhthuKhongHT = dg.DONGIA, @loaigiakhonght_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0 and GIAHOTRO != '1'          order by dtlg.DOUUTIEN asc          select top 1 @doanhthu = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0           order by dtlg.DOUUTIEN asc          select top 1 @hotro = dg.DONGIA, @loaigia_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0  and GIAHOTRO = '1'          order by dtlg.DOUUTIEN asc          select top 1 @bhyt = BHYT from TM_DUOC where DUOC_ID = 1030          select ISNULL(@doanhthu,0.0) DONGIA_DOANHTHU, ISNULL(@hotro, 0.0) DONGIA_KHAC, ISNULL(@doanhthuKhongHT, 0.0) DONGIA_KHONGHT, isnull(@bhyt, '0') BHYT, ISNULL(@loaigia_id, 0) as LOAIGIA_ID, ISNULL(@loaigiakhonght_id, 0) as LOAIGIAKHONGHT_ID]
2020-02-26 16:26:00,681 [1] DEBUG - Statement Id: [DAO00000_GetDuocBHYT] PreparedStatement : [select count(*) BHYT FROM TM_DUOC A WHERE A.DUOC_ID = '1030' and BHYT = '1']
2020-02-26 16:26:05,490 [1] DEBUG - Statement Id: [DAO00000_GetCHECK_DOITUONG_BHYT] PreparedStatement : [select count(*) as DOITUONG_BHYT FROM TM_DOITUONG A            WHERE A.DOITUONG_ID = '4' and A.BENHVIEN_ID = 'HLU01' and MADOITUONG like '%BHYT%']
2020-02-26 16:26:05,514 [1] DEBUG - Statement Id: [DAO00000_GetLOAIGIATHUOC_NOI_NGOAI_VIEN] PreparedStatement : [SELECT LOAIGIA_ID              FROM TM_LOAIGIA              WHERE MALOAIGIA = 'GiaThuoc_NoiVien' and BENHVIEN_ID = 'HLU01']
2020-02-26 16:26:06,820 [1] DEBUG - Statement Id: [DAO00000_GetDUOC_DONGIADOANHTHU_NOIVIEN] PreparedStatement : [declare @doanhthuKhongHT numeric(24,2);          declare @doanhthu numeric(24,2);          declare @hotro numeric(24,2);          declare @bhyt char(1);          declare @loaigia_id int, @loaigiakhonght_id int            select top 1 @doanhthuKhongHT = dg.DONGIA, @loaigiakhonght_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0 and GIAHOTRO != '1'          order by dtlg.DOUUTIEN asc          select top 1 @doanhthu = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0           order by dtlg.DOUUTIEN asc          select top 1 @hotro = dg.DONGIA, @loaigia_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '1030' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0  and GIAHOTRO = '1'          order by dtlg.DOUUTIEN asc          select top 1 @bhyt = BHYT from TM_DUOC where DUOC_ID = 1030          select ISNULL(@doanhthu,0.0) DONGIA_DOANHTHU, ISNULL(@hotro, 0.0) DONGIA_KHAC, ISNULL(@doanhthuKhongHT, 0.0) DONGIA_KHONGHT, isnull(@bhyt, '0') BHYT, ISNULL(@loaigia_id, 0) as LOAIGIA_ID, ISNULL(@loaigiakhonght_id, 0) as LOAIGIAKHONGHT_ID]
2020-02-26 16:26:08,198 [1] DEBUG - Statement Id: [DAO00000_GetDuocBHYT] PreparedStatement : [select count(*) BHYT FROM TM_DUOC A WHERE A.DUOC_ID = '1030' and BHYT = '1']
2020-02-26 16:26:14,027 [1] DEBUG - Statement Id: [DAO00000_GetCHECK_DOITUONG_BHYT] PreparedStatement : [select count(*) as DOITUONG_BHYT FROM TM_DOITUONG A            WHERE A.DOITUONG_ID = '4' and A.BENHVIEN_ID = 'HLU01' and MADOITUONG like '%BHYT%']
2020-02-26 16:26:14,050 [1] DEBUG - Statement Id: [DAO00000_GetLOAIGIATHUOC_NOI_NGOAI_VIEN] PreparedStatement : [SELECT LOAIGIA_ID              FROM TM_LOAIGIA              WHERE MALOAIGIA = 'GiaThuoc_NoiVien' and BENHVIEN_ID = 'HLU01']
2020-02-26 16:26:15,362 [1] DEBUG - Statement Id: [DAO00000_GetDUOC_DONGIADOANHTHU_NOIVIEN] PreparedStatement : [declare @doanhthuKhongHT numeric(24,2);          declare @doanhthu numeric(24,2);          declare @hotro numeric(24,2);          declare @bhyt char(1);          declare @loaigia_id int, @loaigiakhonght_id int            select top 1 @doanhthuKhongHT = dg.DONGIA, @loaigiakhonght_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '934' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0 and GIAHOTRO != '1'          order by dtlg.DOUUTIEN asc          select top 1 @doanhthu = dg.DONGIA          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '934' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0           order by dtlg.DOUUTIEN asc          select top 1 @hotro = dg.DONGIA, @loaigia_id = dg.LOAIGIA_ID          from TM_DUOC_DONGIA dg          left join TM_DOITUONG_LOAIGIA dtlg on dtlg.LOAIGIA_ID = dg.LOAIGIA_ID          where dg.DUOC_ID = '934' and dtlg.DOITUONG_ID = '4' and dg.DONGIA is not null and dg.DONGIA > 0  and GIAHOTRO = '1'          order by dtlg.DOUUTIEN asc          select top 1 @bhyt = BHYT from TM_DUOC where DUOC_ID = 934          select ISNULL(@doanhthu,0.0) DONGIA_DOANHTHU, ISNULL(@hotro, 0.0) DONGIA_KHAC, ISNULL(@doanhthuKhongHT, 0.0) DONGIA_KHONGHT, isnull(@bhyt, '0') BHYT, ISNULL(@loaigia_id, 0) as LOAIGIA_ID, ISNULL(@loaigiakhonght_id, 0) as LOAIGIAKHONGHT_ID]
2020-02-26 16:26:16,562 [1] DEBUG - Statement Id: [DAO00000_GetDuocBHYT] PreparedStatement : [select count(*) BHYT FROM TM_DUOC A WHERE A.DUOC_ID = '934' and BHYT = '1']
2020-02-26 16:26:20,440 [1] DEBUG - Statement Id: [DAO00063_Add_YLenhThuoc] PreparedStatement : [declare @jsonVienPhi nvarchar(max);        set @jsonVienPhi = N'{        "DATA": [{"TRATHUOCCHITIET_ID":null,"DALAPPHIEULINH":false,"DAPHATSINHCHUNGTU":false,"DANHAPNOIBO":false,"DAXUATNOIBO":false,"UID":"77083030-ce33-4871-8b3a-0b695e95cda8","TOATHUOC_ID":null,"CLSKETQUA_ID":null,"VTYT_ID":null,"SOTHUTUTOA":"2002260005","MACHUNGTU":null,"KHAMBENH_ID":320502,"TIEPNHAN_ID":107181,"BENHNHAN_ID":20633,"DUOC_ID":1030,"SOLUONG":1.0,"SONGAY":1.0,"SOLANTRENNGAY":null,"SOLUONGTRENLAN":null,"SOLUONG_BUOISANG":null,"SOLUONG_BUOITRUA":null,"SOLUONG_BUOICHIEU":null,"SOLUONG_BUOITOI":null,"DUONGDUNG_ID":911,"GHICHU":"","NGUONDUOC_ID":1,"KHOSUDUNG_ID":null,"NGUONDUOC":null,"NGUONHANG_ID":1,"PHIEULINH_ID":null,"CHUNGTU_ID":null,"CHUNGTUTONGHOP_ID":null,"PHONGBANRATOA_ID":"25","PHONGBAN_ID":null,"NGUONLAYTHUOC":"D","COSO":"0","KHOPHAT_ID":1,"PHAMVI_ID":1027,"PHATTHUOCTAIQUAY":"0","ISUPDATED":false,"THOIGIANSUDUNG":null,"NGAYSUDUNG":null,"THOIGIANKHAM":null,"SOLUONGTAMNGUNG":0.0,"MUANGOAI":"0","YEUCAU":null,"PHOIHOP":null,"PHACHE":null,"ISVTYT":false,"ISHOACHAT":false,"TINHTIEN":"0","MIENPHI":"0","TRANGTHAI":"CHUAXUAT","HUYTOATHUOC":"0","BENHVIEN_ID":"HLU01","NGAYTAO":null,"NGUOITAO_ID":1,"NGAYCAPNHAT":null,"NGUOICAPNHAT_ID":1,"BHYTDONGTIEN":"0","KHONGTHUTIEN":"0","SOCHUNGTU":null,"SOPHIEULINH":null,"MATOATHUOC":null,"LOAITOATHUOC":null,"LOAIVATTU_ID":"T","TENTOATHUOC":null,"DIENGIAI":null,"TAMNGUNG":false,"DUOC_BHYT":true,"VIENPHI":{"VIENPHI_ID":0,"TIEPNHAN_ID":107181,"BENHNHAN_ID":null,"BENHAN_ID":24642,"KHAMBENH_ID":null,"REF_ID":null,"REF_TABLE":"TT_NOITRU_TOATHUOC","DICHVU_ID":null,"DUOC_ID":1030,"LOAI_CHIPHI":"TT","LOAIGIA_ID":5,"SOLUONG":0.0,"DONGIA_DOANHTHU":600.00,"THANHTIEN_DOANHTHU":600.00,"BHYT_TL":null,"BHYT_DONGIA":600.00,"BHYT_THANHTIEN":600.00,"BHYT_DONGIA_CHITRA":600.00,"BHYT_THANHTIEN_CHITRA":600.00,"BENHNHAN_PHAITHANHTOAN":0.00,"GIATRI_HOADON":null,"GIATRI_HOADON_DATHANHTOAN":null,"GIATRI_BIENLAI":null,"GIATRI_BIENLAI_DATHANHTOAN":null,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"GIATRI_THATTHU":null,"MIENGIAM_TL":null,"MIENGIAM_GIATRI":null,"NGANSACH_TL":null,"NGANSACH_GIATRI":null,"TAITRO_TL":null,"TAITRO_GIATRI":null,"BHTN_TL":null,"BHTN_DONGIA":null,"BHTN_THANHTIEN":null,"BHTN_DONGIA_CHITRA":null,"BHTN_THANHTIEN_CHITRA":null,"DUOCPHEPTHUCHIEN":null,"HUY":false,"DATHANHTOAN":false,"DATHUCHIEN":false,"KHONGTHUTIEN":false,"BHYTDONGTIEN":false,"HOADON_ID":null,"ACTIVE":null,"BENHVIEN_ID":"HLU01","NGUOITAO_ID":null,"NGAYTAO":null,"NGUOICAPNHAT_ID":null,"NGAYCAPNHAT":null,"TREN3NAM":false,"TREN5NAM":false},"STT":1,"KHOTAO_ID":"29","DONVITINH":null,"DUONGDUNG":"Tiêm","DAXUAT":false,"DATHANHTOAN":false,"BENHAN_ID":24642,"DAHOANTRA":0,"SLDAXUAT":0.0,"SLDATAMNGUNG":0.0,"CHUNGTUTRA_ID":null,"CHUNGTUCHITIET_ID":null,"NGUOICAPNHAT":null,"BHYT_DONGIA":null,"BHYT_THANHTIEN":null,"BHYT_DONGIA_CHITRA":null,"BHYT_THANHTIEN_CHITRA":null,"DONGIA_DOANHTHU":600.0,"THANHTIEN_DOANHTHU":600.0,"BookedSoLuong":0.0,"KHODUOC_ID":1,"CHUYENKHOA_ID":"25","DOTDIEUTRI_ID":null,"DOITUONG_HUONG_ID":4,"SOBHYT_HUONG_ID":111518},{"TRATHUOCCHITIET_ID":null,"DALAPPHIEULINH":false,"DAPHATSINHCHUNGTU":false,"DANHAPNOIBO":false,"DAXUATNOIBO":false,"UID":"fc22db0d-a689-466b-89e5-b686d4bbb0d3","TOATHUOC_ID":null,"CLSKETQUA_ID":null,"VTYT_ID":null,"SOTHUTUTOA":"2002260005","MACHUNGTU":null,"KHAMBENH_ID":320502,"TIEPNHAN_ID":107181,"BENHNHAN_ID":20633,"DUOC_ID":1030,"SOLUONG":1.0,"SONGAY":1.0,"SOLANTRENNGAY":null,"SOLUONGTRENLAN":null,"SOLUONG_BUOISANG":null,"SOLUONG_BUOITRUA":null,"SOLUONG_BUOICHIEU":null,"SOLUONG_BUOITOI":null,"DUONGDUNG_ID":911,"GHICHU":"","NGUONDUOC_ID":1,"KHOSUDUNG_ID":null,"NGUONDUOC":null,"NGUONHANG_ID":1,"PHIEULINH_ID":null,"CHUNGTU_ID":null,"CHUNGTUTONGHOP_ID":null,"PHONGBANRATOA_ID":"25","PHONGBAN_ID":null,"NGUONLAYTHUOC":"D","COSO":"0","KHOPHAT_ID":1,"PHAMVI_ID":1027,"PHATTHUOCTAIQUAY":"0","ISUPDATED":false,"THOIGIANSUDUNG":null,"NGAYSUDUNG":null,"THOIGIANKHAM":null,"SOLUONGTAMNGUNG":0.0,"MUANGOAI":"0","YEUCAU":null,"PHOIHOP":null,"PHACHE":null,"ISVTYT":false,"ISHOACHAT":false,"TINHTIEN":"0","MIENPHI":"0","TRANGTHAI":"CHUAXUAT","HUYTOATHUOC":"0","BENHVIEN_ID":"HLU01","NGAYTAO":null,"NGUOITAO_ID":1,"NGAYCAPNHAT":null,"NGUOICAPNHAT_ID":1,"BHYTDONGTIEN":"1","KHONGTHUTIEN":"0","SOCHUNGTU":null,"SOPHIEULINH":null,"MATOATHUOC":null,"LOAITOATHUOC":null,"LOAIVATTU_ID":"T","TENTOATHUOC":null,"DIENGIAI":null,"TAMNGUNG":false,"DUOC_BHYT":true,"VIENPHI":{"VIENPHI_ID":0,"TIEPNHAN_ID":107181,"BENHNHAN_ID":null,"BENHAN_ID":24642,"KHAMBENH_ID":null,"REF_ID":null,"REF_TABLE":"TT_NOITRU_TOATHUOC","DICHVU_ID":null,"DUOC_ID":1030,"LOAI_CHIPHI":"TT","LOAIGIA_ID":7,"SOLUONG":0.0,"DONGIA_DOANHTHU":1000.00,"THANHTIEN_DOANHTHU":1000.00,"BHYT_TL":null,"BHYT_DONGIA":0,"BHYT_THANHTIEN":0,"BHYT_DONGIA_CHITRA":0,"BHYT_THANHTIEN_CHITRA":0,"BENHNHAN_PHAITHANHTOAN":1000.00,"GIATRI_HOADON":null,"GIATRI_HOADON_DATHANHTOAN":null,"GIATRI_BIENLAI":null,"GIATRI_BIENLAI_DATHANHTOAN":null,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"GIATRI_THATTHU":null,"MIENGIAM_TL":null,"MIENGIAM_GIATRI":null,"NGANSACH_TL":null,"NGANSACH_GIATRI":null,"TAITRO_TL":null,"TAITRO_GIATRI":null,"BHTN_TL":null,"BHTN_DONGIA":null,"BHTN_THANHTIEN":null,"BHTN_DONGIA_CHITRA":null,"BHTN_THANHTIEN_CHITRA":null,"DUOCPHEPTHUCHIEN":null,"HUY":false,"DATHANHTOAN":false,"DATHUCHIEN":false,"KHONGTHUTIEN":false,"BHYTDONGTIEN":true,"HOADON_ID":null,"ACTIVE":null,"BENHVIEN_ID":"HLU01","NGUOITAO_ID":null,"NGAYTAO":null,"NGUOICAPNHAT_ID":null,"NGAYCAPNHAT":null,"TREN3NAM":false,"TREN5NAM":false},"STT":2,"KHOTAO_ID":"29","DONVITINH":null,"DUONGDUNG":"Tiêm","DAXUAT":false,"DATHANHTOAN":false,"BENHAN_ID":24642,"DAHOANTRA":0,"SLDAXUAT":0.0,"SLDATAMNGUNG":0.0,"CHUNGTUTRA_ID":null,"CHUNGTUCHITIET_ID":null,"NGUOICAPNHAT":null,"BHYT_DONGIA":null,"BHYT_THANHTIEN":null,"BHYT_DONGIA_CHITRA":null,"BHYT_THANHTIEN_CHITRA":null,"DONGIA_DOANHTHU":600.0,"THANHTIEN_DOANHTHU":600.0,"BookedSoLuong":0.0,"KHODUOC_ID":1,"CHUYENKHOA_ID":"25","DOTDIEUTRI_ID":null,"DOITUONG_HUONG_ID":4,"SOBHYT_HUONG_ID":111518},{"TRATHUOCCHITIET_ID":null,"DALAPPHIEULINH":false,"DAPHATSINHCHUNGTU":false,"DANHAPNOIBO":false,"DAXUATNOIBO":false,"UID":"d349b433-9b61-426f-a19d-ac338ecd1e1a","TOATHUOC_ID":null,"CLSKETQUA_ID":null,"VTYT_ID":null,"SOTHUTUTOA":"2002260005","MACHUNGTU":null,"KHAMBENH_ID":320502,"TIEPNHAN_ID":107181,"BENHNHAN_ID":20633,"DUOC_ID":934,"SOLUONG":1.0,"SONGAY":1.0,"SOLANTRENNGAY":null,"SOLUONGTRENLAN":null,"SOLUONG_BUOISANG":null,"SOLUONG_BUOITRUA":null,"SOLUONG_BUOICHIEU":null,"SOLUONG_BUOITOI":null,"DUONGDUNG_ID":8573,"GHICHU":"","NGUONDUOC_ID":1,"KHOSUDUNG_ID":null,"NGUONDUOC":null,"NGUONHANG_ID":1,"PHIEULINH_ID":null,"CHUNGTU_ID":null,"CHUNGTUTONGHOP_ID":null,"PHONGBANRATOA_ID":"25","PHONGBAN_ID":null,"NGUONLAYTHUOC":"D","COSO":"0","KHOPHAT_ID":1,"PHAMVI_ID":1027,"PHATTHUOCTAIQUAY":"0","ISUPDATED":false,"THOIGIANSUDUNG":null,"NGAYSUDUNG":null,"THOIGIANKHAM":null,"SOLUONGTAMNGUNG":0.0,"MUANGOAI":"0","YEUCAU":null,"PHOIHOP":null,"PHACHE":null,"ISVTYT":false,"ISHOACHAT":false,"TINHTIEN":"0","MIENPHI":"0","TRANGTHAI":"CHUAXUAT","HUYTOATHUOC":"0","BENHVIEN_ID":"HLU01","NGAYTAO":null,"NGUOITAO_ID":1,"NGAYCAPNHAT":null,"NGUOICAPNHAT_ID":1,"BHYTDONGTIEN":"0","KHONGTHUTIEN":"0","SOCHUNGTU":null,"SOPHIEULINH":null,"MATOATHUOC":null,"LOAITOATHUOC":null,"LOAIVATTU_ID":"T","TENTOATHUOC":null,"DIENGIAI":null,"TAMNGUNG":false,"DUOC_BHYT":false,"VIENPHI":{"VIENPHI_ID":0,"TIEPNHAN_ID":107181,"BENHNHAN_ID":null,"BENHAN_ID":24642,"KHAMBENH_ID":null,"REF_ID":null,"REF_TABLE":"TT_NOITRU_TOATHUOC","DICHVU_ID":null,"DUOC_ID":934,"LOAI_CHIPHI":"TT","LOAIGIA_ID":7,"SOLUONG":0.0,"DONGIA_DOANHTHU":12000.00,"THANHTIEN_DOANHTHU":12000.00,"BHYT_TL":null,"BHYT_DONGIA":0,"BHYT_THANHTIEN":0,"BHYT_DONGIA_CHITRA":0,"BHYT_THANHTIEN_CHITRA":0,"BENHNHAN_PHAITHANHTOAN":12000.00,"GIATRI_HOADON":null,"GIATRI_HOADON_DATHANHTOAN":null,"GIATRI_BIENLAI":null,"GIATRI_BIENLAI_DATHANHTOAN":null,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"GIATRI_THATTHU":null,"MIENGIAM_TL":null,"MIENGIAM_GIATRI":null,"NGANSACH_TL":null,"NGANSACH_GIATRI":null,"TAITRO_TL":null,"TAITRO_GIATRI":null,"BHTN_TL":null,"BHTN_DONGIA":null,"BHTN_THANHTIEN":null,"BHTN_DONGIA_CHITRA":null,"BHTN_THANHTIEN_CHITRA":null,"DUOCPHEPTHUCHIEN":null,"HUY":false,"DATHANHTOAN":false,"DATHUCHIEN":false,"KHONGTHUTIEN":false,"BHYTDONGTIEN":false,"HOADON_ID":null,"ACTIVE":null,"BENHVIEN_ID":"HLU01","NGUOITAO_ID":null,"NGAYTAO":null,"NGUOICAPNHAT_ID":null,"NGAYCAPNHAT":null,"TREN3NAM":false,"TREN5NAM":false},"STT":3,"KHOTAO_ID":"29","DONVITINH":null,"DUONGDUNG":"Tiêm truyền","DAXUAT":false,"DATHANHTOAN":false,"BENHAN_ID":24642,"DAHOANTRA":0,"SLDAXUAT":0.0,"SLDATAMNGUNG":0.0,"CHUNGTUTRA_ID":null,"CHUNGTUCHITIET_ID":null,"NGUOICAPNHAT":null,"BHYT_DONGIA":null,"BHYT_THANHTIEN":null,"BHYT_DONGIA_CHITRA":null,"BHYT_THANHTIEN_CHITRA":null,"DONGIA_DOANHTHU":12000.0,"THANHTIEN_DOANHTHU":12000.0,"BookedSoLuong":0.0,"KHODUOC_ID":1,"CHUYENKHOA_ID":"25","DOTDIEUTRI_ID":null,"DOITUONG_HUONG_ID":4,"SOBHYT_HUONG_ID":111518}]        }';          declare @TOATHUOC_ID int;        declare @SOTHUTUTOA varchar(10);        declare @KHAMBENH_ID int;        declare @TIEPNHAN_ID int;        declare @BENHNHAN_ID int;        declare @NGUONDUOC_ID int;        declare @DUOC_ID int;        declare @SOLUONG numeric(18, 4);        declare @SONGAY numeric(4, 2);        declare @SOLANTRENNGAY numeric(4, 2);        declare @SOLUONGTRENLAN numeric(18, 4);        declare @SOLUONG_BUOISANG numeric(18, 4);        declare @SOLUONG_BUOITRUA numeric(18, 4);        declare @SOLUONG_BUOICHIEU numeric(18, 4);        declare @SOLUONG_BUOITOI numeric(18, 4);        declare @DUONGDUNG_ID int;        declare @COSO char(1);        declare @KHOTAO_ID int;        declare @KHOPHAT_ID int;        declare @GHICHU nvarchar(max);        declare @PHIEULINH_ID int;        declare @CHUNGTU_ID int;        declare @PHONGBANRATOA_ID int;        declare @NGUONLAYTHUOC char(1);        declare @VTYT char(1);        declare @PHATTHUOCTAIQUAY char(1);        declare @MUANGOAI char(1);        declare @TINHTIEN char(1);        declare @MIENPHI char(1);        declare @BHYTDONGTIEN char(1);        declare @KHONGTHUTIEN char(1);        declare @HUYTOATHUOC char(1);        declare @TRANGTHAI varchar(20);        declare @BENHVIEN_ID varchar(10);        declare @NGAYTAO datetime;        declare @NGUOITAO_ID int;        declare @NGAYCAPNHAT datetime;        declare @NGUOICAPNHAT_ID int;        declare @PHAMVI_ID int;        declare @CHEDODINHDUONG nvarchar(max);          declare @VIENPHI nvarchar(max);        declare @BENHAN_ID int =  @param0 ;        declare @DOTDIEUTRI_ID int;        declare @DONGIA_DOANHTHU numeric(25, 4);        declare @THANHTIEN_DOANHTHU numeric(25, 4);        declare @BHYT_DONGIA numeric(25, 4);        declare @BHYT_THANHTIEN numeric(25, 4);        declare @BHYT_DONGIA_CHITRA numeric(25, 4);        declare @BHYT_THANHTIEN_CHITRA numeric(25, 4);        declare @BENHNHAN_PHAITHANHTOAN numeric(25, 4);        declare @DOITUONG_HUONG_ID numeric(25, 4);        declare @SOBHYT_HUONG_ID numeric(25, 4);        declare @LOAIGIA_ID int;          declare @iTotal int =  @param1 ;        declare @icnt int = 0;        WHILE @iTotal > @icnt        BEGIN        declare @dyn_sql nvarchar(1000) = 'select @data = json_query(@json_dyn, ''' + CHAR(36) +'.DATA[' + cast(@icnt as varchar(10)) + ']'');'        declare @jsondatamax nvarchar(max);          exec sp_executesql @dyn_sql        , N'@json_dyn nvarchar(max), @data nvarchar(max) OUTPUT'        , @json_dyn = @jsonVienPhi        , @data = @jsondatamax OUTPUT          select        @SOTHUTUTOA =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.SOTHUTUTOA'),        @KHAMBENH_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.KHAMBENH_ID'),        @TIEPNHAN_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.TIEPNHAN_ID'),        @BENHNHAN_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.BENHNHAN_ID'),        @NGUONDUOC_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.NGUONDUOC_ID'),        @DUOC_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.DUOC_ID'),        @SOLUONG =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.SOLUONG'),        @SONGAY =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.SONGAY'),        @SOLANTRENNGAY =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.SOLANTRENNGAY'),        @SOLUONGTRENLAN =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.SOLUONGTRENLAN'),        @SOLUONG_BUOISANG =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.SOLUONG_BUOISANG'),        @SOLUONG_BUOITRUA =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.SOLUONG_BUOITRUA'),        @SOLUONG_BUOICHIEU =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.SOLUONG_BUOICHIEU'),        @SOLUONG_BUOITOI =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.SOLUONG_BUOITOI'),        @DUONGDUNG_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.DUONGDUNG_ID'),        @COSO =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.COSO'),        @KHOTAO_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.KHOTAO_ID'),        @KHOPHAT_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.KHOPHAT_ID'),        @GHICHU =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.GHICHU'),        @PHIEULINH_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.PHIEULINH_ID'),        @CHUNGTU_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.CHUNGTU_ID'),        @PHONGBANRATOA_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.PHONGBANRATOA_ID'),        @NGUONLAYTHUOC =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.NGUONLAYTHUOC'),        @VTYT =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.VTYT'),        @PHATTHUOCTAIQUAY =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.PHATTHUOCTAIQUAY'),        @MUANGOAI =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.MUANGOAI'),        @TINHTIEN =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.TINHTIEN'),        @MIENPHI =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.MIENPHI'),        @BHYTDONGTIEN =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.BHYTDONGTIEN'),        @KHONGTHUTIEN =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.KHONGTHUTIEN'),        @HUYTOATHUOC =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.HUYTOATHUOC'),        @TRANGTHAI =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.TRANGTHAI'),        @BENHVIEN_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.BENHVIEN_ID'),        @NGAYTAO =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.NGAYTAO'),        @NGUOITAO_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.NGUOITAO_ID'),        @NGAYCAPNHAT =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.NGAYCAPNHAT'),        @NGUOICAPNHAT_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.NGUOICAPNHAT_ID'),        @PHAMVI_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.PHAMVI_ID'),        @CHEDODINHDUONG =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.CHEDODINHDUONG'),        @DOTDIEUTRI_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.DOTDIEUTRI_ID'),        @DOITUONG_HUONG_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.DOITUONG_HUONG_ID'),        @SOBHYT_HUONG_ID =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.SOBHYT_HUONG_ID'),                  @DONGIA_DOANHTHU =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.VIENPHI.DONGIA_DOANHTHU'),        @THANHTIEN_DOANHTHU =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.VIENPHI.THANHTIEN_DOANHTHU'),        @BHYT_DONGIA =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.VIENPHI.BHYT_DONGIA'),        @BHYT_THANHTIEN =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.VIENPHI.BHYT_THANHTIEN'),        @BHYT_DONGIA_CHITRA =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.VIENPHI.BHYT_DONGIA_CHITRA'),        @BHYT_THANHTIEN_CHITRA =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.VIENPHI.BHYT_THANHTIEN_CHITRA'),        @BENHNHAN_PHAITHANHTOAN =  JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.VIENPHI.BENHNHAN_PHAITHANHTOAN'),        @LOAIGIA_ID = JSON_VALUE(@jsondatamax, '' + CHAR(36) +'.VIENPHI.LOAIGIA_ID')          insert into TT_NOITRU_TOATHUOC        ([SOTHUTUTOA],[KHAMBENH_ID],[TIEPNHAN_ID],[BENHNHAN_ID],[NGUONDUOC_ID]        ,[DUOC_ID],[SOLUONG],[SONGAY],[SOLANTRENNGAY],[SOLUONGTRENLAN],[SOLUONG_BUOISANG],[SOLUONG_BUOITRUA],[SOLUONG_BUOICHIEU]        ,[SOLUONG_BUOITOI],[DUONGDUNG_ID],[COSO],[KHOTAO_ID],[KHOPHAT_ID],[GHICHU],[PHIEULINH_ID],[CHUNGTU_ID],[PHONGBANRATOA_ID]        ,[NGUONLAYTHUOC],[VTYT],[PHATTHUOCTAIQUAY],[MUANGOAI],[TINHTIEN],[MIENPHI],[BHYTDONGTIEN],[KHONGTHUTIEN],[HUYTOATHUOC]        ,[TRANGTHAI],[BENHVIEN_ID],[NGAYTAO],[NGUOITAO_ID],[NGAYCAPNHAT],[NGUOICAPNHAT_ID],[PHAMVI_ID],[CHEDODINHDUONG])        VALUES        (@SOTHUTUTOA,@KHAMBENH_ID,@TIEPNHAN_ID,@BENHNHAN_ID,@NGUONDUOC_ID        ,@DUOC_ID,@SOLUONG,@SONGAY,@SOLANTRENNGAY,@SOLUONGTRENLAN,@SOLUONG_BUOISANG,@SOLUONG_BUOITRUA,@SOLUONG_BUOICHIEU        ,@SOLUONG_BUOITOI,@DUONGDUNG_ID,@COSO,@KHOTAO_ID,@KHOPHAT_ID,@GHICHU,@PHIEULINH_ID,@CHUNGTU_ID,@PHONGBANRATOA_ID        ,@NGUONLAYTHUOC,@VTYT,@PHATTHUOCTAIQUAY,@MUANGOAI,@TINHTIEN,@MIENPHI,@BHYTDONGTIEN,@KHONGTHUTIEN,@HUYTOATHUOC        ,@TRANGTHAI,@BENHVIEN_ID,GETDATE(),@NGUOITAO_ID,GETDATE(),@NGUOICAPNHAT_ID,@PHAMVI_ID,@CHEDODINHDUONG)                set @TOATHUOC_ID = SCOPE_IDENTITY()                  INSERT INTO TT_VIENPHI        ([TIEPNHAN_ID],[BENHAN_ID]        ,[DOTDIEUTRI_ID],[BENHNHAN_ID],[KHAMBENH_ID],[REF_ID],[REF_TABLE],[DICHVU_ID],[DUOC_ID],[LOAI_CHIPHI]        ,[SOLUONG],[DONGIA_DOANHTHU],[THANHTIEN_DOANHTHU],[BHYT_DONGIA],[BHYT_THANHTIEN],[HUY],[DATHANHTOAN]        ,[DATHUCHIEN],[KHONGTHUTIEN],[BHYTDONGTIEN],[BENHVIEN_ID],[NGUOITAO_ID],[NGAYTAO],[NGUOICAPNHAT_ID],        [NGAYCAPNHAT], [DOITUONG_HUONG_ID], [SOBHYT_HUONG_ID], [BHYT_DONGIA_CHITRA], [BHYT_THANHTIEN_CHITRA], [BENHNHAN_PHAITHANHTOAN], [LOAIGIA_ID])        VALUES        (@TIEPNHAN_ID,@BENHAN_ID        ,@DOTDIEUTRI_ID,@BENHNHAN_ID,@KHAMBENH_ID,@TOATHUOC_ID,'TT_NOITRU_TOATHUOC',null,@DUOC_ID,'TT'        ,@SOLUONG,@DONGIA_DOANHTHU,@THANHTIEN_DOANHTHU,@BHYT_DONGIA,@BHYT_THANHTIEN,'0','0'        ,'0',@KHONGTHUTIEN,@BHYTDONGTIEN,@BENHVIEN_ID,@NGUOITAO_ID,GETDATE(),@NGUOICAPNHAT_ID,GETDATE(), @DOITUONG_HUONG_ID, @SOBHYT_HUONG_ID        ,@BHYT_DONGIA_CHITRA, @BHYT_THANHTIEN_CHITRA, @BENHNHAN_PHAITHANHTOAN, @LOAIGIA_ID)                  insert into TT_DUOC_TONKHO_BOOK_NOITRU        ([REF_TABLE],[REF_ID],[PHAMVI_ID],[KHODUOC_ID],[DUOC_ID],[SOLUONG],[NGUONHANG_ID],[CHUYENKHOA_ID]        ,[GHICHU],[BENHVIEN_ID],[NGAYTAO],[NGUOITAO_ID],[NGAYCAPNHAT],[NGUOICAPNHAT_ID], [TRANGTHAI], [NGAYHIEULUC])        VALUES        ('TT_NOITRU_TOATHUOC',@TOATHUOC_ID,@PHAMVI_ID,@KHOPHAT_ID,@DUOC_ID,@SOLUONG,@NGUONDUOC_ID,@PHONGBANRATOA_ID        ,@GHICHU,@BENHVIEN_ID,GETDATE(),@NGUOITAO_ID,GETDATE(),@NGUOICAPNHAT_ID, 'HIEULUC', GETDATE())          set @icnt = @icnt + 1;        END        select @TOATHUOC_ID]
2020-02-26 16:26:20,440 [1] DEBUG - Statement Id: [DAO00063_Add_YLenhThuoc] Parameters: [@param0=[BENHAN_ID,24642], @param1=[TOTAL_RECORD,3]]
2020-02-26 16:26:20,440 [1] DEBUG - Statement Id: [DAO00063_Add_YLenhThuoc] Types: [@param0=[Int64, System.Int64], @param1=[Int32, System.Int32]]
2020-02-26 16:26:20,561 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis] PreparedStatement : [declare @NGUONDUOC_MACDINH varchar(5) = '0';        declare @TOAMUANGOAI int = 0;        select @NGUONDUOC_MACDINH = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'PHA_NGUONDUOC'        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + @NGUONDUOC_MACDINH as DUOC_KEY, 0 as PHAMVI_ID, @NGUONDUOC_MACDINH as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        where d.DUOC_ID in (1030,1030,934)        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id        from TT_DUOC_TONKHO  where DUOC_ID in (1030,1030,934) group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY'  and DUOC_ID in (1030,1030,934)        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and DUOC_ID in (1030,1030,934)        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where  d.BENHVIEN_ID = 'HLU01' and d.DUOC_ID in (1030,1030,934)        end        else        begin        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (        select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id        from TT_DUOC_TONKHO  where DUOC_ID in (1030,1030,934)        group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (        select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID        from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY' and DUOC_ID in (1030,1030,934)        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (        select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID        from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY' and DUOC_ID in (1030,1030,934)        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where  d.BENHVIEN_ID = 'HLU01' and d.DUOC_ID in (1030,1030,934)        end]
2020-02-26 16:26:21,439 [1] DEBUG - Statement Id: [DAOLOG01_LockEnd] PreparedStatement : [DELETE TT_LOG_UPDATE        where REF_TABLE = 'TT_NOITRU_KHAMBENH' and REF_ID = '24642' and BENHVIEN_ID = 'HLU01']
2020-02-26 16:26:21,462 [1] DEBUG - Statement Id: [DAO00067_UpdateThuocNoiVienPhi_Noref] PreparedStatement : [update TT_VIENPHI          set SOLUONG = (TraThuoc.SOLUONG - TraThuoc.SOLUONG_NGUNG)          from (select distinct nttt.SOLUONG, ttct.TOATHUOC_ID, ttct.DUOC_ID , ttct.SOLUONG SOLUONG_NGUNG          from TT_NOITRU_TRATHUOC_CHITIET ttct          left join TT_NOITRU_TRATHUOC tt on tt.TRATHUOC_ID = ttct.TRATHUOC_ID          left join TT_NOITRU_TOATHUOC nttt on nttt.TOATHUOC_ID = ttct.TOATHUOC_ID          where tt.BENHAN_ID =  @param0 ) TraThuoc          where TT_VIENPHI.REF_ID = TraThuoc.TOATHUOC_ID and TT_VIENPHI.DUOC_ID = TraThuoc.DUOC_ID          and TT_VIENPHI.REF_TABLE = 'TT_NOITRU_TOATHUOC' and TT_VIENPHI.BENHAN_ID =  @param0           and TT_VIENPHI.SOLUONG > (TraThuoc.SOLUONG - TraThuoc.SOLUONG_NGUNG)                     update TT_VIENPHI set SOLUONG = 0, THANHTIEN_DOANHTHU = 0, BHYT_THANHTIEN = 0, BHYT_THANHTIEN_CHITRA = 0          , GIATRI_BENHNHAN_DATHANHTOAN = 0, BENHNHAN_PHAITHANHTOAN = 0          where REF_TABLE = 'TT_NOITRU_TOATHUOC'          and TIEPNHAN_ID =  @param1           and KHAMBENH_ID not in (select KHAMBENH_ID from TT_NOITRU_TOATHUOC where TIEPNHAN_ID =  @param1 )          and HOADON_ID is null and BENHAN_ID =  @param0]
2020-02-26 16:26:21,462 [1] DEBUG - Statement Id: [DAO00067_UpdateThuocNoiVienPhi_Noref] Parameters: [@param0=[BENHAN_ID,24642], @param1=[TIEPNHAN_ID,107181]]
2020-02-26 16:26:21,462 [1] DEBUG - Statement Id: [DAO00067_UpdateThuocNoiVienPhi_Noref] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64]]
2020-02-26 16:26:21,571 [1] DEBUG - Statement Id: [DAO00062_GetDetail] PreparedStatement : [select *        from TT_NOITRU_KHAMBENH        where KHAMBENH_ID  = '320502']
2020-02-26 16:26:21,596 [1] DEBUG - Statement Id: [DAO00063_GetToaThuocByKhamBenhID] PreparedStatement : [select distinct a.*, b.SOLUONG as SOLUONGTAMNGUNG,        pl.MACHUNGTU as SOPHIEULINH, ct.MACHUNGTU as SOCHUNGTU        ,vp.BHYT_DONGIA, vp.BHYT_THANHTIEN, vp.BHYT_DONGIA_CHITRA, vp.BHYT_THANHTIEN_CHITRA,        vp.THANHTIEN_DOANHTHU, vp.DONGIA_DOANHTHU, dc.TENDUOCDAYDU, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, dc.DONVITINH        , d.TAMNGUNG        from TT_NOITRU_TOATHUOC a        left join TT_NOITRU_TRATHUOC_CHITIET b on a.TOATHUOC_ID = b.TOATHUOC_ID        left join TT_DUOC_PHIEULINH pl on pl.CHUNGTU_ID = a.PHIEULINH_ID        left join TT_DUOC_CHUNGTU ct on ct.CHUNGTU_ID = a.CHUNGTU_ID        left join TM_DUOC dc on a.DUOC_ID = dc.DUOC_ID        left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID        inner join TM_DUOC d on d.DUOC_ID = a.DUOC_ID        left join (select max(BHYT_DONGIA) BHYT_DONGIA, Max(BHYT_THANHTIEN) BHYT_THANHTIEN, max(BHYT_DONGIA_CHITRA) BHYT_DONGIA_CHITRA,        max(BHYT_THANHTIEN_CHITRA) BHYT_THANHTIEN_CHITRA, max(THANHTIEN_DOANHTHU) THANHTIEN_DOANHTHU, max(DONGIA_DOANHTHU) DONGIA_DOANHTHU,        KHAMBENH_ID, REF_ID, REF_TABLE, DUOC_ID from TT_VIENPHI where KHAMBENH_ID = '320502' and REF_TABLE = 'TT_NOITRU_TOATHUOC'  group by KHAMBENH_ID, REF_ID, REF_TABLE, DUOC_ID)        vp on vp.REF_ID = a.TOATHUOC_ID and vp.REF_TABLE = 'TT_NOITRU_TOATHUOC' and vp.DUOC_ID = a.DUOC_ID        where a.KHAMBENH_ID  = '320502' and a.BENHVIEN_ID = 'HLU01']
2020-02-26 16:26:21,707 [1] DEBUG - Statement Id: [DAO00040_LayListToaMau] PreparedStatement : [select A.*, dc.TENDUOCDAYDU, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ld.MALOAIDUOC, dd.DICTIONARY_NAME DUONGDUNG, dc.TAMNGUNG            from TT_TOATHUOCMAU A            left join TM_DUOC dc on A.DUOC_ID = dc.DUOC_ID            left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID            left join (select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE like 'DuongDung') dd on dd.DICTIONARY_ID = dc.DUONGDUNG_ID            where (1=1)]
2020-02-26 16:26:23,948 [1] DEBUG - Statement Id: [DAO00020_GetDanhsachVPCuaToaThuoc] PreparedStatement : [select * from TT_VIENPHI where        BENHAN_ID = 24642 and REF_TABLE = 'TT_NOITRU_TOATHUOC']
2020-02-26 16:26:45,474 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'PHA07'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 16:26:46,141 [1] DEBUG - Statement Id: [DAO00030_GetPhamViByKhoDuoc] PreparedStatement : [SELECT DISTINCT pv.PHAMVI_ID          FROM TM_DUOC_PHAMVISD_MAPPING mp          INNER JOIN TM_DUOC_PHAMVISUDUNG pv ON mp.PHAMVI_ID = pv.PHAMVI_ID          WHERE          mp.KHODUOC_ID IN (1)          AND mp.BENHVIEN_ID ='HLU01'          AND mp.TAMNGUNG = '0'          AND pv.TAMNGUNG = '0']
2020-02-26 16:26:46,169 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 999999999 as SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        where  @param0  = 0        union all        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end        else        begin        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO        group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end]
2020-02-26 16:26:46,170 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Parameters: [@param0=[PHAMVI_ID,1027]]
2020-02-26 16:26:46,170 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Types: [@param0=[Int64, System.Int64]]
2020-02-26 16:26:46,499 [1] DEBUG - Statement Id: [DAO00030_GetPhamViByKhoDuoc] PreparedStatement : [SELECT DISTINCT pv.PHAMVI_ID          FROM TM_DUOC_PHAMVISD_MAPPING mp          INNER JOIN TM_DUOC_PHAMVISUDUNG pv ON mp.PHAMVI_ID = pv.PHAMVI_ID          WHERE          mp.KHODUOC_ID IN (1)          AND mp.BENHVIEN_ID ='HLU01'          AND mp.TAMNGUNG = '0'          AND pv.TAMNGUNG = '0']
2020-02-26 16:26:46,530 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 999999999 as SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        where  @param0  = 0        union all        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end        else        begin        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO        group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end]
2020-02-26 16:26:46,530 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Parameters: [@param0=[PHAMVI_ID,1027]]
2020-02-26 16:26:46,530 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Types: [@param0=[Int64, System.Int64]]
2020-02-26 16:26:46,602 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] PreparedStatement : [declare @TOAMUANGOAI int = 0;        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + '0' as DUOC_KEY, 999999999 as SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        where  @param0  = 0        union all        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end        else        begin        select distinct tk.DUOC_KEY, tk.SOLUONG        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO        group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU        where TRANGTHAI != 'HUY' and PHAMVI_ID =  @param0         group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01' and tk.PHAMVI_ID =  @param0         end]
2020-02-26 16:26:46,602 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Parameters: [@param0=[PHAMVI_ID,1027]]
2020-02-26 16:26:46,603 [1] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBookingCOM23UpdateRedis_TheoPhamvi] Types: [@param0=[Int64, System.Int64]]
2020-02-26 16:26:49,336 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'PHA51'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 16:26:49,479 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM98'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 16:26:49,959 [1] DEBUG - Statement Id: [DAO00030_GetPhamViByKhoDuoc] PreparedStatement : [SELECT DISTINCT pv.PHAMVI_ID          FROM TM_DUOC_PHAMVISD_MAPPING mp          INNER JOIN TM_DUOC_PHAMVISUDUNG pv ON mp.PHAMVI_ID = pv.PHAMVI_ID          WHERE          mp.KHODUOC_ID IN (1)          AND mp.BENHVIEN_ID ='HLU01'          AND mp.TAMNGUNG = '0'          AND pv.TAMNGUNG = '0']
2020-02-26 16:26:50,157 [1] DEBUG - Statement Id: [DAO00030_LAPPHIEULINH_TOA_NOITRU] PreparedStatement : [declare @TuNgay datetime = CONVERT(date, '2/26/2020 12:00:00 AM')            declare @DenNgay datetime = CONVERT(date, DATEADD(day, 1, '2/26/2020 12:00:00 AM'))              SELECT            TT.KHAMBENH_ID,            TT.TOATHUOC_ID as TOATHUOC_ID,            TT.SOTHUTUTOA as REF_ID,            N'Người bệnh: ' + BN.MAYTE + ' - ' + BN.TENBENHNHAN            + CASE WHEN BN.GIOITINH = 1 THEN N' - Nam ' WHEN BN.GIOITINH = 2 THEN N' - Nữ ' END            + CASE WHEN BN.NGAYSINH IS NOT NULL THEN ' - ' + CONVERT(VARCHAR(10), BN.NGAYSINH, 103) ELSE ' - ' + CONVERT(VARCHAR(10), BN.NAMSINH) END            + CASE WHEN BA.SOBENHAN IS NOT NULL THEN N' - Mã bệnh án: ' + BA.SOBENHAN  ELSE N'' END            + CASE WHEN dt.TENDOITUONG IS NOT NULL THEN N' - ' + dt.TENDOITUONG  ELSE '' END            as BENHNHAN,            N'Y lệnh: ' + TT.SOTHUTUTOA + ' - ' + CONVERT(VARCHAR(10), KB.THOIGIANKHAM, 103) + ' - ' + CONVERT(VARCHAR(5), KB.THOIGIANKHAM, 108)  + N' - Người lập: ' + NV.TENNHANVIEN  AS YLENH,            TT.DUOC_ID,            D.TENDUOCDAYDU,            D.DONVITINH,            TT.SOLUONG as SOLUONGYEUCAU,            NLD.TENNHOMLOAIDUOC,            TT.KHOPHAT_ID,            TT.NGAYTAO,            'KHAMBENH' as LOAIPHIEU            FROM            TT_NOITRU_TOATHUOC TT            left join TT_BENHNHAN BN on TT.BENHNHAN_ID = BN.BENHNHAN_ID            left join TT_NOITRU_KHAMBENH KB on KB.KHAMBENH_ID = TT.KHAMBENH_ID            left join TT_NOITRU_BENHAN BA on BA.BENHAN_ID = KB.BENHAN_ID            left join TM_DOITUONG dt on BA.DOITUONG_ID = dt.DOITUONG_ID            left join TM_DUOC D on D.DUOC_ID = TT.DUOC_ID            left join TM_LOAIDUOC LD on LD.LOAIDUOC_ID = D.LOAIDUOC_ID            left join TM_NHOMLOAIDUOC NLD on NLD.NHOMLOAIDUOC_ID = LD.NHOMLOAIDUOC_ID            left join TM_NHANVIEN NV on TT.NGUOITAO_ID = NV.NHANVIEN_ID            WHERE            KB.NGAYKHAM >= @TuNgay AND KB.NGAYKHAM < @DenNgay             and             TT.PHAMVI_ID =1027             and             TT.KHOTAO_ID =29                          AND TT.COSO = 0            AND TT.PHONGBANRATOA_ID = 25            AND TT.PHIEULINH_ID is NULL            AND TT.BENHVIEN_ID = 'HLU01'            AND (BN.TENBENHNHAN like N'%%' OR BN.MAYTE like N'%%' OR BA.SOBENHAN  like N'%%' or D.TENDUOCDAYDU like N'%%')             and                 LD.LOAIVATTU_ID = 'T'             and               BA.TRANGTHAI = 'DANGDIEUTRI'             and               KB.RAVIEN = '0'                           order by NGAYTAO DESC]
2020-02-26 16:26:50,713 [1] DEBUG - Statement Id: [DAO00030_LAPPHIEULINH_KHAMBENH_VTYT] PreparedStatement : [declare @TuNgay datetime = CONVERT(date, '2/26/2020 12:00:00 AM')          declare @DenNgay datetime = CONVERT(date, DATEADD(day, 1, '2/26/2020 12:00:00 AM'))            SELECT          TT.KHAMBENH_ID,          TT.KHAMBENH_VTYT_ID as TOATHUOC_ID,          TT.KHAMBENH_ID as REF_ID,          N'Người bệnh: ' + BN.MAYTE + ' - ' + BN.TENBENHNHAN          + CASE WHEN BN.GIOITINH = 1 THEN N' - Nam ' WHEN BN.GIOITINH = 2 THEN N' - Nữ ' END          + CASE WHEN BN.NGAYSINH IS NOT NULL THEN ' - ' + CONVERT(VARCHAR(10), BN.NGAYSINH, 103) ELSE ' - ' + CONVERT(VARCHAR(10), BN.NAMSINH) END          + CASE WHEN TN.SOTIEPNHAN IS NOT NULL THEN N' - Số tiếp nhận: ' + TN.SOTIEPNHAN  ELSE N'' END          + CASE WHEN dt.TENDOITUONG IS NOT NULL THEN N' - ' + dt.TENDOITUONG  ELSE '' END          as BENHNHAN,          N'Y lệnh: ' + CAST(TT.KHAMBENH_VTYT_ID as nvarchar(10)) + ' - ' + CONVERT(VARCHAR(10), KB.THOIGIANKHAM, 103) + ' - ' + CONVERT(VARCHAR(5), KB.THOIGIANKHAM, 108)  + N' - Người lập: ' + NV.TENNHANVIEN  AS YLENH,          TT.DUOC_ID,          D.TENDUOCDAYDU,          D.DONVITINH,          TT.SOLUONG as SOLUONGYEUCAU,          NLD.TENNHOMLOAIDUOC,          TT.KHOTAO_ID KHOPHAT_ID,          TT.KHOSUDUNG_ID,          TT.NGAYTAO,          'TT_NGOAITRU_KHAMBENH_VTYT' as LOAIPHIEU          FROM          TT_NGOAITRU_KHAMBENH_VTYT TT          left join TT_NGOAITRU_KHAMBENH KB on KB.KHAMBENH_ID = TT.KHAMBENH_ID          left join TT_BENHNHAN BN on KB.BENHNHAN_ID = BN.BENHNHAN_ID          left join TT_TIEPNHAN TN on TN.TIEPNHAN_ID = KB.TIEPNHAN_ID          left join TM_DOITUONG dt on TN.DOITUONG_ID = dt.DOITUONG_ID          left join TM_DUOC D on D.DUOC_ID = TT.DUOC_ID          left join TM_LOAIDUOC LD on LD.LOAIDUOC_ID = D.LOAIDUOC_ID          left join TM_NHOMLOAIDUOC NLD on NLD.NHOMLOAIDUOC_ID = LD.NHOMLOAIDUOC_ID          left join TM_NHANVIEN NV on TT.NGUOITAO_ID = NV.NHANVIEN_ID          WHERE                  TT.NGAYSUDUNG >= @TuNgay AND TT.NGAYSUDUNG < @DenNgay           and             TT.PHAMVI_ID =1027           and             TT.COSO =0                     AND KB.PHONGBAN_ID = 25          AND TT.PHIEULINH_ID is NULL          AND (TN.TRANGTHAI NOT IN ('HOANTHANH') OR (0 = 1 AND TN.TRANGTHAI = 'HOANTHANH'))          AND TT.BENHVIEN_ID = 'HLU01'          AND (BN.TENBENHNHAN like N'%%' OR BN.MAYTE like N'%%' OR D.TENDUOCDAYDU like N'%%')           and             LD.LOAIVATTU_ID = 'T'                     order by NGAYTAO DESC]
2020-02-26 16:26:50,745 [1] DEBUG - Statement Id: [DAO00030_DUOCTONKHO_GetSoTonTheoDuoc] PreparedStatement : [SELECT              DUOC_ID,              SUM(SOLUONG) AS TONGTON              FROM              TT_DUOC_TONKHO              WHERE              KHODUOC_ID = '1'              and BENHVIEN_ID = 'HLU01'              and DUOC_ID IN (934,1030,1030)              GROUP BY DUOC_ID]
2020-02-26 16:26:53,141 [1] DEBUG - Statement Id: [DAO00030_DUOC_KiemTraTamNgung] PreparedStatement : [SELECT DUOC_ID,TAMNGUNG          FROM          TM_DUOC          WHERE          DUOC_ID IN (934,1030,1030)]
2020-02-26 16:26:53,200 [1] DEBUG - Statement Id: [DAO00030_LAPPHIEULINH_TONGHOPTUYLENH] PreparedStatement : [SELECT DISTINCT            TT.TOATHUOC_ID,            KB.KHAMBENH_ID AS MASTER_ID,            TT.SOTHUTUTOA,            LTRIM(TT.PHAMVI_ID) + '_' + LTRIM(TT.DUOC_ID) + '_' + LTRIM(TT.NGUONDUOC_ID) as DUOC_KEY,            TT.DUOC_ID,            D.TENDUOCDAYDU,            D.DONVITINH_ID,            D.DONVITINH,            TT.SOLUONG as SOLUONGYEUCAU,            LD.MALOAIDUOC,            NLD.TENNHOMLOAIDUOC,            TT.NGUONDUOC_ID AS NGUONHANG_ID,            TN.SOTIEPNHAN,            BN.TENBENHNHAN,            N'Người bệnh: ' + BN.MAYTE + ' - ' + BN.TENBENHNHAN + ' - ' + N'Thời gian Y lệnh: ' + CONVERT(VARCHAR(10), KB.THOIGIANKHAM, 103) + ' - ' + CONVERT(VARCHAR(5), KB.THOIGIANKHAM, 108) as BENHNHAN,            TT.NGAYTAO,            'TT_NOITRU_TOATHUOC' as LOAIPHIEU,            TT.NGAYCAPNHAT as REF_NGAYCAPNHAT            FROM            TT_NOITRU_TOATHUOC TT            left join TT_NOITRU_KHAMBENH KB on TT.KHAMBENH_ID = KB.KHAMBENH_ID            left join TT_NOITRU_BENHAN BA on  KB.BENHAN_ID = BA.BENHAN_ID            left join TT_BENHNHAN BN on  TT.BENHNHAN_ID = BN.BENHNHAN_ID            left join TT_TIEPNHAN TN on TT.TIEPNHAN_ID = TN.TIEPNHAN_ID            left join TM_DUOC D on D.DUOC_ID = TT.DUOC_ID            left join TM_LOAIDUOC LD on LD.LOAIDUOC_ID = D.LOAIDUOC_ID            left join TM_NHOMLOAIDUOC NLD on NLD.NHOMLOAIDUOC_ID = LD.NHOMLOAIDUOC_ID            WHERE            TT.BENHVIEN_ID = 'HLU01'            AND TT.PHIEULINH_ID is NULL            AND TT.TOATHUOC_ID IN (1886262,1886260,1886261)            AND TT.SOTHUTUTOA IN (2002260005,2002260005,2002260005)              union all              SELECT DISTINCT            VT.PHAUTHUAT_VTYT_ID AS TOATHUOC_ID,            PT.PHAUTHUAT_ID AS MASTER_ID,            1 as SOTHUTUTOA,            LTRIM(VT.PHAMVI_ID) + '_' + LTRIM(VT.DUOC_ID) + '_' + LTRIM(VT.NGUONHANG_ID) as DUOC_KEY,            VT.DUOC_ID,            D.TENDUOCDAYDU,            D.DONVITINH_ID,            D.DONVITINH,            VT.SOLUONG as SOLUONGYEUCAU,            LD.MALOAIDUOC,            NLD.TENNHOMLOAIDUOC,            VT.NGUONHANG_ID,            TN.SOTIEPNHAN,            BN.TENBENHNHAN,            N'Người bệnh: ' + BN.MAYTE + ' - ' + BN.TENBENHNHAN + ' - '            + N'Thời gian ghi nhận: ' + CONVERT(VARCHAR(10), VT.NGAYTAO, 103) + ' - ' + CONVERT(VARCHAR(5), VT.NGAYTAO, 108) as BENHNHAN,            VT.NGAYTAO,            'TT_PHAUTHUAT_VTYT' as LOAIPHIEU,            VT.NGAYCAPNHAT as REF_NGAYCAPNHAT            FROM            TT_PHAUTHUAT_VTYT VT            left join TT_PHAUTHUAT PT on PT.PHAUTHUAT_ID = VT.PHAUTHUAT_ID            left join TT_PHAUTHUAT_EKIP EK on PT.PHAUTHUAT_ID = EK.PHAUTHUAT_ID            left join TT_TIEPNHAN TN on TN.TIEPNHAN_ID = PT.TIEPNHAN_ID            left join TT_BENHNHAN BN on BN.BENHNHAN_ID = TN.BENHNHAN_ID            left join TM_DUOC D on D.DUOC_ID = VT.DUOC_ID            left join TM_LOAIDUOC LD on LD.LOAIDUOC_ID = D.LOAIDUOC_ID            left join TM_NHOMLOAIDUOC NLD on NLD.NHOMLOAIDUOC_ID = LD.NHOMLOAIDUOC_ID            WHERE            VT.PHAUTHUAT_VTYT_ID IN (1886262,1886260,1886261)            AND PT.PHAUTHUAT_ID IN (2002260005,2002260005,2002260005)            AND VT.BENHVIEN_ID = 'HLU01'              union all              SELECT DISTINCT            CLS.CLSKETQUA_VTYT_ID AS TOATHUOC_ID,            DV.DVYEUCAU_ID AS MASTER_ID,            0 as SOTHUTUTOA,            LTRIM(CLS.PHAMVI_ID) + '_' + LTRIM(CLS.DUOC_ID) + '_' + LTRIM(CLS.NGUONHANG_ID) as DUOC_KEY,            CLS.DUOC_ID,            D.TENDUOCDAYDU,            D.DONVITINH_ID,            D.DONVITINH,            CLS.SOLUONG as SOLUONGYEUCAU,            LD.MALOAIDUOC,            NLD.TENNHOMLOAIDUOC,            CLS.NGUONHANG_ID,            TN.SOTIEPNHAN,            BN.TENBENHNHAN,            N'Người bệnh: ' + BN.MAYTE + ' - ' + BN.TENBENHNHAN + ' - ' +            N'Thời gian ghi nhận: ' +  CONVERT(VARCHAR(10), cls.NGAYTAO, 103) + ' - ' + CONVERT(VARCHAR(5), cls.NGAYTAO, 108) AS BENHNHAN,            CLS.NGAYTAO,            'TT_CLSKETQUA_VTYT' as LOAIPHIEU,            CLS.NGAYCAPNHAT as REF_NGAYCAPNHAT            FROM            TT_CLSKETQUA_VTYT CLS            left join TT_CLSKETQUA KQ on KQ.CLSKETQUA_ID = CLS.CLSKETQUA_ID            left join TT_DVYEUCAU DV on DV.DVYEUCAU_ID = CLS.DVYEUCAU_ID            left join TT_BENHNHAN BN on DV.BENHNHAN_ID = BN.BENHNHAN_ID            left join TT_TIEPNHAN TN on TN.TIEPNHAN_ID = DV.TIEPNHAN_ID            left join TM_DUOC D on D.DUOC_ID = CLS.DUOC_ID            left join TM_LOAIDUOC LD on LD.LOAIDUOC_ID = D.LOAIDUOC_ID            left join TM_NHOMLOAIDUOC NLD on NLD.NHOMLOAIDUOC_ID = LD.NHOMLOAIDUOC_ID            WHERE            CLS.BENHVIEN_ID = 'HLU01'            AND CLS.CLSKETQUA_VTYT_ID IN (1886262,1886260,1886261)            AND DV.DVYEUCAU_ID IN (2002260005,2002260005,2002260005)              UNION  ALL              SELECT DISTINCT            TT.KHAMBENH_VTYT_ID TOATHUOC_ID,            KB.KHAMBENH_ID AS MASTER_ID,            TT.KHAMBENH_VTYT_ID SOTHUTUTOA,            LTRIM(TT.PHAMVI_ID) + '_' + LTRIM(TT.DUOC_ID) + '_' + LTRIM(TT.NGUONHANG_ID) as DUOC_KEY,            TT.DUOC_ID,            D.TENDUOCDAYDU,            D.DONVITINH_ID,            D.DONVITINH,            TT.SOLUONG as SOLUONGYEUCAU,            LD.MALOAIDUOC,            NLD.TENNHOMLOAIDUOC,            TT.NGUONHANG_ID AS NGUONHANG_ID,            TN.SOTIEPNHAN,            BN.TENBENHNHAN,            N'Người bệnh: ' + BN.MAYTE + ' - ' + BN.TENBENHNHAN + ' - ' + N'Thời gian Y lệnh: ' + CONVERT(VARCHAR(10), KB.THOIGIANKHAM, 103) + ' - ' + CONVERT(VARCHAR(5), KB.THOIGIANKHAM, 108) as BENHNHAN,            TT.NGAYTAO,            'TT_NGOAITRU_KHAMBENH_VTYT' as LOAIPHIEU,            TT.NGAYCAPNHAT as REF_NGAYCAPNHAT            FROM            TT_NGOAITRU_KHAMBENH_VTYT TT            left join TT_NGOAITRU_KHAMBENH KB on KB.KHAMBENH_ID = TT.KHAMBENH_ID            left join TT_BENHNHAN BN on  KB.BENHNHAN_ID = BN.BENHNHAN_ID            left join TT_TIEPNHAN TN on KB.TIEPNHAN_ID = TN.TIEPNHAN_ID            left join TM_DUOC D on D.DUOC_ID = TT.DUOC_ID            left join TM_LOAIDUOC LD on LD.LOAIDUOC_ID = D.LOAIDUOC_ID            left join TM_NHOMLOAIDUOC NLD on NLD.NHOMLOAIDUOC_ID = LD.NHOMLOAIDUOC_ID              WHERE            TT.BENHVIEN_ID = 'HLU01'            AND TT.PHIEULINH_ID is NULL            AND TT.KHAMBENH_VTYT_ID IN (1886262,1886260,1886261)            AND KB.KHAMBENH_ID IN (2002260005,2002260005,2002260005)              UNION ALL              SELECT DISTINCT            ctct.CHUNGTUCHITIET_ID TOATHUOC_ID,            ct.CHUNGTU_ID AS MASTER_ID,            ctct.CHUNGTUCHITIET_ID SOTHUTUTOA,            '1027' + '_' + LTRIM(ctct.DUOC_ID) + '_' + LTRIM(ctct.NGUONHANG_ID) as DUOC_KEY,            ctct.DUOC_ID,            D.TENDUOCDAYDU,            D.DONVITINH_ID,            D.DONVITINH,            ctct.SOLUONGDAXUAT as SOLUONGYEUCAU,            LD.MALOAIDUOC,                      ct.MACHUNGTU + ' - ' + CONVERT(VARCHAR(10), CT.NGAYCHUNGTU, 103) + ' - ' + CONVERT(VARCHAR(5), CT.NGAYCHUNGTU, 108)            + CASE WHEN NV.TENNHANVIEN IS NOT NULL THEN + N' - Người lập: ' +  NV.TENNHANVIEN ELSE '' END TENNHOMLOAIDUOC,            ctct.NGUONHANG_ID AS NGUONHANG_ID,            null SOTIEPNHAN,            null TENBENHNHAN,                      CASE WHEN ct.LYDOXUATSUDUNG_ID = 8295 THEN N'Xuất tiêu hao khoa phòng' WHEN ct.LYDOXUATSUDUNG_ID = 8312 THEN N'Xuất từ thiện' END AS BENHNHAN,            ctct.NGAYTAO,            'TT_DUOC_CHUNGTU' as LOAIPHIEU,            ctct.NGAYCAPNHAT as REF_NGAYCAPNHAT            FROM            TT_DUOC_CHUNGTU ct            inner join TT_DUOC_CHUNGTU_CHITIET ctct on ct.CHUNGTU_ID = ctct.CHUNGTU_ID            left join TM_DUOC D on D.DUOC_ID = ctct.DUOC_ID            left join TM_LOAIDUOC LD on LD.LOAIDUOC_ID = D.LOAIDUOC_ID            left join TM_NHOMLOAIDUOC NLD on NLD.NHOMLOAIDUOC_ID = LD.NHOMLOAIDUOC_ID            left join TM_NHANVIEN NV on CT.NGUOITAO_ID = NV.NHANVIEN_ID            WHERE            ct.BENHVIEN_ID = 'HLU01'            AND ct.PHIEULINH_ID is NULL            AND ctct.CHUNGTUCHITIET_ID IN (1886262,1886260,1886261)            AND ct.CHUNGTU_ID IN (2002260005,2002260005,2002260005)]
2020-02-26 16:26:53,603 [1] DEBUG - Statement Id: [DAO00030_DUOCTONKHO_GetTonThucTe] PreparedStatement : [SELECT              SUM(SOLUONG) AS SOLUONG              FROM              TT_DUOC_TONKHO              WHERE              DUOC_ID = '1030'              AND KHODUOC_ID = '1'              and BENHVIEN_ID = 'HLU01']
2020-02-26 16:26:53,711 [1] DEBUG - Statement Id: [DAO00030_DUOCTONKHO_GetTonThucTe] PreparedStatement : [SELECT              SUM(SOLUONG) AS SOLUONG              FROM              TT_DUOC_TONKHO              WHERE              DUOC_ID = '1030'              AND KHODUOC_ID = '1'              and BENHVIEN_ID = 'HLU01']
2020-02-26 16:26:53,800 [1] DEBUG - Statement Id: [DAO00030_DUOCTONKHO_GetTonThucTe] PreparedStatement : [SELECT              SUM(SOLUONG) AS SOLUONG              FROM              TT_DUOC_TONKHO              WHERE              DUOC_ID = '934'              AND KHODUOC_ID = '1'              and BENHVIEN_ID = 'HLU01']
2020-02-26 16:26:54,533 [1] DEBUG - Statement Id: [DAO00030_YLENH_NOITRU_NGAYCAPNHAT] PreparedStatement : [SELECT              TT.NGAYCAPNHAT              FROM              TT_NOITRU_TOATHUOC TT              inner join TM_DUOC D on D.DUOC_ID = TT.DUOC_ID              inner join TM_LOAIDUOC LD on LD.LOAIDUOC_ID = D.LOAIDUOC_ID              WHERE              tt.KHAMBENH_ID IN (320502,320502,320502)              AND tt.BENHVIEN_ID = 'HLU01'                             order by NGAYCAPNHAT]
2020-02-26 16:26:56,130 [1] DEBUG - Statement Id: [DAO00030_DUOC_KiemTraTamNgung] PreparedStatement : [SELECT DUOC_ID,TAMNGUNG          FROM          TM_DUOC          WHERE          DUOC_ID IN (1030,1030,934)]
2020-02-26 16:26:56,158 [1] DEBUG - Statement Id: [DAO00030_YLENH_NOITRU_NGAYCAPNHAT] PreparedStatement : [SELECT              TT.NGAYCAPNHAT              FROM              TT_NOITRU_TOATHUOC TT              inner join TM_DUOC D on D.DUOC_ID = TT.DUOC_ID              inner join TM_LOAIDUOC LD on LD.LOAIDUOC_ID = D.LOAIDUOC_ID              WHERE              tt.KHAMBENH_ID IN (320502,320502,320502)              AND tt.BENHVIEN_ID = 'HLU01'                             order by NGAYCAPNHAT]
2020-02-26 16:26:56,218 [1] DEBUG - Statement Id: [DAO00036_GetDetail] PreparedStatement : [select KEYTYPE, KEYYEAR, KEYMONTH, KEYDAY, SEGMENT_1, SEGMENT_2, SEGMENT_3, KEYVALUE              from LST_KEYDATA_DUOCPHAM as kd               WHERE                        kd.KEYTYPE = 'PHIEULINH'                   AND                       kd.KEYYEAR = '2020'                   AND                       kd.KEYMONTH = '0'                   AND                       kd.KEYDAY = '0'                   AND                       kd.SEGMENT_1 = 'CS_GMHS'                   AND                       kd.SEGMENT_2 = 'PL'                   AND                       kd.SEGMENT_3 = ' ']
2020-02-26 16:26:56,244 [1] DEBUG - Statement Id: [DAO00036_Update] PreparedStatement : [update LST_KEYDATA_DUOCPHAM set              KEYVALUE =  @param0               where              KEYTYPE = 'PHIEULINH'              AND KEYYEAR = '2020'              AND KEYMONTH = '0'              AND KEYDAY = '0'              AND SEGMENT_1 = 'CS_GMHS'              AND SEGMENT_2 = 'PL'              AND SEGMENT_3 = ' ']
2020-02-26 16:26:56,244 [1] DEBUG - Statement Id: [DAO00036_Update] Parameters: [@param0=[KEYVALUE,000014]]
2020-02-26 16:26:56,244 [1] DEBUG - Statement Id: [DAO00036_Update] Types: [@param0=[String, System.String]]
2020-02-26 16:26:56,271 [1] DEBUG - Statement Id: [DAO00030_DUOCPHIEULINH_Add] PreparedStatement : [insert into TT_DUOC_PHIEULINH (            MACHUNGTU            , SOCHUNGTU            , NGAYCHUNGTU            , LOAICHUNGTU            , MUCDICHCHUNGTU_ID            , KHOXUAT_ID            , NGUOIGIAO_ID            , NGUOIGIAO            , KHONHAP_ID            , NGUOINHAN_ID            , NGUOINHAN            , NGUOIKIEMTRA            , NGUOIDUYET            , KETOANTRUONG            , THUKHO            , SOSERI            , SOHOADON            , DIENGIAI            , GIATRI            , GIATRITHANHTOAN            , TYLEVAT            , GIATRIVAT            , THUESUAT            , GIATRITHUE            , TYLECHIETKHAU            , GIATRICHIETKHAU            , TIENTE_ID            , TYGIA            , SOCHUNGTUGOC            , NGAYCHUNGTUGOC            , NHACUNGCAP_ID            , HINHTHUCTHANHTOAN_ID            , NGUONDUOC_ID            , CHUNGTULIENQUAN_ID            , TOATHUOC_ID            , TOATHUOCNOITRU_ID            , BENHAN_ID            , DANHANTHUOC            , NGUOINHAP_ID            , NGAYNHAP            , TRANGTHAI            , PHIEULINH_ID            , DIENGIAINGHIEPVUPHATSINH            , TONGHOP_TUNGAY            , TONGHOP_DENNGAY            , COSO            , TONGHOP            , PHANLOAIPHIEULINH            , DUYET            , NGAYDUYET            , THOIGIANDUYET            , NGUOIDUYET_ID            , LYDO            , BENHVIEN_ID            , NGAYTAO            , NGUOITAO_ID            , NGAYCAPNHAT            , NGUOICAPNHAT_ID            ) values (             @param0             ,  @param1             ,  @param2             ,  @param3             ,  @param4             ,  @param5             ,  @param6             ,  @param7             ,  @param8             ,  @param9             ,  @param10             ,  @param11             ,  @param12             ,  @param13             ,  @param14             ,  @param15             ,  @param16             ,  @param17             ,  @param18             ,  @param19             ,  @param20             ,  @param21             ,  @param22             ,  @param23             ,  @param24             ,  @param25             ,  @param26             ,  @param27             ,  @param28             ,  @param29             ,  @param30             ,  @param31             ,  @param32             ,  @param33             ,  @param34             ,  @param35             ,  @param36             ,  @param37             ,  @param38             ,  @param39             ,  @param40             ,  @param41             ,  @param42             ,  @param43             ,  @param44             ,  @param45             ,  @param46             ,  @param47             ,  @param48             ,  @param49             ,  @param50             ,  @param51             ,  @param52             ,  @param53             , GETDATE()            ,  @param54             ,  @param55             ,  @param56             )            select SCOPE_identity() as value]
2020-02-26 16:26:56,271 [1] DEBUG - Statement Id: [DAO00030_DUOCPHIEULINH_Add] Parameters: [@param0=[MACHUNGTU,CS_GMHSPL20000014], @param1=[SOCHUNGTU,000014], @param2=[NGAYCHUNGTU,2/26/2020 4:26:56 PM], @param3=[LOAICHUNGTU,N], @param4=[MUCDICHCHUNGTU_ID,null], @param5=[KHOXUAT_ID,1], @param6=[NGUOIGIAO_ID,null], @param7=[NGUOIGIAO,null], @param8=[KHONHAP_ID,29], @param9=[NGUOINHAN_ID,1], @param10=[NGUOINHAN,null], @param11=[NGUOIKIEMTRA,null], @param12=[NGUOIDUYET,null], @param13=[KETOANTRUONG,null], @param14=[THUKHO,null], @param15=[SOSERI,null], @param16=[SOHOADON,null], @param17=[DIENGIAI,null], @param18=[GIATRI,null], @param19=[GIATRITHANHTOAN,null], @param20=[TYLEVAT,null], @param21=[GIATRIVAT,null], @param22=[THUESUAT,null], @param23=[GIATRITHUE,null], @param24=[TYLECHIETKHAU,null], @param25=[GIATRICHIETKHAU,null], @param26=[TIENTE_ID,null], @param27=[TYGIA,null], @param28=[SOCHUNGTUGOC,null], @param29=[NGAYCHUNGTUGOC,null], @param30=[NHACUNGCAP_ID,null], @param31=[HINHTHUCTHANHTOAN_ID,null], @param32=[NGUONDUOC_ID,1], @param33=[CHUNGTULIENQUAN_ID,null], @param34=[TOATHUOC_ID,null], @param35=[TOATHUOCNOITRU_ID,null], @param36=[BENHAN_ID,null], @param37=[DANHANTHUOC,0], @param38=[NGUOINHAP_ID,null], @param39=[NGAYNHAP,null], @param40=[TRANGTHAI,CHUADUYET], @param41=[PHIEULINH_ID,null], @param42=[DIENGIAINGHIEPVUPHATSINH,Xuất cho: ], @param43=[TONGHOP_TUNGAY,2/26/2020 12:00:00 AM], @param44=[TONGHOP_DENNGAY,2/26/2020 12:00:00 AM], @param45=[COSO,0], @param46=[TONGHOP,1], @param47=[PHANLOAIPHIEULINH,T], @param48=[DUYET,0], @param49=[NGAYDUYET,null], @param50=[THOIGIANDUYET,null], @param51=[NGUOIDUYET_ID,null], @param52=[LYDO,null], @param53=[BENHVIEN_ID,HLU01], @param54=[NGUOITAO_ID,1], @param55=[NGAYCAPNHAT,2/26/2020 4:26:56 PM], @param56=[NGUOICAPNHAT_ID,1]]
2020-02-26 16:26:56,271 [1] DEBUG - Statement Id: [DAO00030_DUOCPHIEULINH_Add] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[DateTime, System.DateTime], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[System.DBNull, null], @param8=[Int64, System.Int64], @param9=[Int64, System.Int64], @param10=[System.DBNull, null], @param11=[System.DBNull, null], @param12=[System.DBNull, null], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[System.DBNull, null], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[Int64, System.Int64], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[String, System.String], @param38=[System.DBNull, null], @param39=[System.DBNull, null], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[String, System.String], @param43=[DateTime, System.DateTime], @param44=[DateTime, System.DateTime], @param45=[String, System.String], @param46=[String, System.String], @param47=[String, System.String], @param48=[Int64, System.Int64], @param49=[System.DBNull, null], @param50=[System.DBNull, null], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[String, System.String], @param54=[Int64, System.Int64], @param55=[DateTime, System.DateTime], @param56=[Int64, System.Int64]]
2020-02-26 16:26:56,376 [1] DEBUG - Statement Id: [DAO00030_DUOCPHIEULINHCT_AddMulti] PreparedStatement : [SET XACT_ABORT ON            BEGIN TRANSACTION            BEGIN TRY              declare @json nvarchar(max) =  N'[{"CHUNGTUCHITIET_ID":0,"CHUNGTU_ID":48586,"DUOC_ID":1030,"DUOC_KEY":"1027_1030_1","SOLONHAP_ID":null,"SOKIEMSOAT":null,"SOVISA":null,"DONVITINH_ID":2,"SOLUONGYEUCAU":1.0,"SOLUONGYEUCAU_PRE":null,"SOLUONGTHUCTE":null,"SOLUONGDAXUAT":null,"TIENTE_ID":null,"TYGIA":null,"DONGIAMUA":null,"DONGIABAN":null,"DONGIAVON":null,"SOQUYEN":null,"SOHOADONVAT":null,"TYLEVAT":null,"GIATRIVAT":null,"MIENPHI":"0","LYDOMIENPHI_ID":null,"SOCHUNGTUKETOAN":null,"SOCHUNGTUTIENMAT":null,"TRANGTHAI":null,"DAPHATSINHPHIEUXUAT":"0","DAPHATSINHPHIEUHOANTRA":"0","NGUONHANG_ID":1,"CHUNGTUHOANTRA_LE_ID":null,"SOLUONGTHUCNHAN":null,"SOLUONGTONGHOPTHUCTE":1.0,"BENHVIEN_ID":"HLU01","NGAYTAO":"26/Feb/2020 16:26:56","NGUOITAO_ID":1,"NGAYCAPNHAT":null,"NGUOICAPNHAT_ID":null,"MADUOC":null,"TENDUOCDAYDU":null,"DONVITINH":"Ống","SOLUONGTON":2255.0,"SOLUONGTON_PRE":null,"TONGYEUCAU":null,"SOLUONGTHIEU":null,"NGUOIDUYET":null,"THOIGIANDUYET":null,"LYDO":null,"MACHUNGTU":null,"LOAIPHIEU":"TT_NOITRU_TOATHUOC","KHONHAP_ID":null,"TENBENHNHAN":"Lê Thị Ngọc","BENHNHAN":"Người bệnh: 190040528 - Lê Thị Ngọc - Thời gian Y lệnh: 26/02/2020 - 16:24","YLENH":"1886262,1886260,1886261","DUYET":false,"TENKHONHAP":null,"TOATHUOC_ID":1886260,"MASTER_ID":320502,"KHOPHAT_ID":1,"REF_TABLE":"TT_NOITRU_TOATHUOC","REF_ID":null,"REF_NGAYCAPNHAT":"2020-02-26T16:23:12.51","TOATHUOCNOITRU_ID":1886260,"STT":null,"LOAIVATTU_ID":null,"LOAIVATTU":null,"MALOAIDUOC":"L016","TENNHOMLOAIDUOC":null,"HIGHLIGHT":null,"SOLUONGTONLO":null,"SUASOLUONGTONGHOP":null},{"CHUNGTUCHITIET_ID":0,"CHUNGTU_ID":48586,"DUOC_ID":1030,"DUOC_KEY":"1027_1030_1","SOLONHAP_ID":null,"SOKIEMSOAT":null,"SOVISA":null,"DONVITINH_ID":2,"SOLUONGYEUCAU":1.0,"SOLUONGYEUCAU_PRE":null,"SOLUONGTHUCTE":null,"SOLUONGDAXUAT":null,"TIENTE_ID":null,"TYGIA":null,"DONGIAMUA":null,"DONGIABAN":null,"DONGIAVON":null,"SOQUYEN":null,"SOHOADONVAT":null,"TYLEVAT":null,"GIATRIVAT":null,"MIENPHI":"0","LYDOMIENPHI_ID":null,"SOCHUNGTUKETOAN":null,"SOCHUNGTUTIENMAT":null,"TRANGTHAI":null,"DAPHATSINHPHIEUXUAT":"0","DAPHATSINHPHIEUHOANTRA":"0","NGUONHANG_ID":1,"CHUNGTUHOANTRA_LE_ID":null,"SOLUONGTHUCNHAN":null,"SOLUONGTONGHOPTHUCTE":1.0,"BENHVIEN_ID":"HLU01","NGAYTAO":"26/Feb/2020 16:26:56","NGUOITAO_ID":1,"NGAYCAPNHAT":null,"NGUOICAPNHAT_ID":null,"MADUOC":null,"TENDUOCDAYDU":null,"DONVITINH":"Ống","SOLUONGTON":2255.0,"SOLUONGTON_PRE":null,"TONGYEUCAU":null,"SOLUONGTHIEU":null,"NGUOIDUYET":null,"THOIGIANDUYET":null,"LYDO":null,"MACHUNGTU":null,"LOAIPHIEU":"TT_NOITRU_TOATHUOC","KHONHAP_ID":null,"TENBENHNHAN":"Lê Thị Ngọc","BENHNHAN":"Người bệnh: 190040528 - Lê Thị Ngọc - Thời gian Y lệnh: 26/02/2020 - 16:24","YLENH":"1886262,1886260,1886261","DUYET":false,"TENKHONHAP":null,"TOATHUOC_ID":1886261,"MASTER_ID":320502,"KHOPHAT_ID":1,"REF_TABLE":"TT_NOITRU_TOATHUOC","REF_ID":null,"REF_NGAYCAPNHAT":"2020-02-26T16:23:12.51","TOATHUOCNOITRU_ID":1886261,"STT":null,"LOAIVATTU_ID":null,"LOAIVATTU":null,"MALOAIDUOC":"L016","TENNHOMLOAIDUOC":null,"HIGHLIGHT":null,"SOLUONGTONLO":null,"SUASOLUONGTONGHOP":null},{"CHUNGTUCHITIET_ID":0,"CHUNGTU_ID":48586,"DUOC_ID":934,"DUOC_KEY":"1027_934_1","SOLONHAP_ID":null,"SOKIEMSOAT":null,"SOVISA":null,"DONVITINH_ID":1,"SOLUONGYEUCAU":1.0,"SOLUONGYEUCAU_PRE":null,"SOLUONGTHUCTE":null,"SOLUONGDAXUAT":null,"TIENTE_ID":null,"TYGIA":null,"DONGIAMUA":null,"DONGIABAN":null,"DONGIAVON":null,"SOQUYEN":null,"SOHOADONVAT":null,"TYLEVAT":null,"GIATRIVAT":null,"MIENPHI":"0","LYDOMIENPHI_ID":null,"SOCHUNGTUKETOAN":null,"SOCHUNGTUTIENMAT":null,"TRANGTHAI":null,"DAPHATSINHPHIEUXUAT":"0","DAPHATSINHPHIEUHOANTRA":"0","NGUONHANG_ID":1,"CHUNGTUHOANTRA_LE_ID":null,"SOLUONGTHUCNHAN":null,"SOLUONGTONGHOPTHUCTE":1.0,"BENHVIEN_ID":"HLU01","NGAYTAO":"26/Feb/2020 16:26:56","NGUOITAO_ID":1,"NGAYCAPNHAT":null,"NGUOICAPNHAT_ID":null,"MADUOC":null,"TENDUOCDAYDU":null,"DONVITINH":"Chai","SOLUONGTON":2054.0,"SOLUONGTON_PRE":null,"TONGYEUCAU":null,"SOLUONGTHIEU":null,"NGUOIDUYET":null,"THOIGIANDUYET":null,"LYDO":null,"MACHUNGTU":null,"LOAIPHIEU":"TT_NOITRU_TOATHUOC","KHONHAP_ID":null,"TENBENHNHAN":"Lê Thị Ngọc","BENHNHAN":"Người bệnh: 190040528 - Lê Thị Ngọc - Thời gian Y lệnh: 26/02/2020 - 16:24","YLENH":"1886262,1886260,1886261","DUYET":false,"TENKHONHAP":null,"TOATHUOC_ID":1886262,"MASTER_ID":320502,"KHOPHAT_ID":1,"REF_TABLE":"TT_NOITRU_TOATHUOC","REF_ID":null,"REF_NGAYCAPNHAT":"2020-02-26T16:23:12.523","TOATHUOCNOITRU_ID":1886262,"STT":null,"LOAIVATTU_ID":null,"LOAIVATTU":null,"MALOAIDUOC":"L048","TENNHOMLOAIDUOC":null,"HIGHLIGHT":null,"SOLUONGTONLO":null,"SUASOLUONGTONGHOP":null}]';              DELETE TT_DUOC_PHIEULINH_CHITIET WHERE CHUNGTU_ID =  @param0               INSERT INTO TT_DUOC_PHIEULINH_CHITIET            (            CHUNGTU_ID            , DUOC_ID            , DONVITINH_ID            , NGUONHANG_ID            , SOLUONGYEUCAU            , SOLUONGTONGHOPTHUCTE            , REF_TABLE            , TOATHUOCNOITRU_ID            , TENBENHNHAN            , BENHNHAN            , YLENH            , MASTER_ID            , DAPHATSINHPHIEUXUAT            , DAPHATSINHPHIEUHOANTRA            , MIENPHI            , BENHVIEN_ID            , NGAYTAO            , NGUOITAO_ID            )            SELECT * FROM OPENJSON(@json)            WITH (            CHUNGTU_ID int            , DUOC_ID int            , DONVITINH_ID int            , NGUONHANG_ID int            , SOLUONGYEUCAU numeric(25, 4)            , SOLUONGTONGHOPTHUCTE numeric(25, 4)            , REF_TABLE nvarchar(100)            , TOATHUOCNOITRU_ID int            , TENBENHNHAN nvarchar(100)            , BENHNHAN nvarchar(MAX)            , YLENH nvarchar(MAX)            , MASTER_ID int            , DAPHATSINHPHIEUXUAT char(1)            , DAPHATSINHPHIEUHOANTRA char(1)            , MIENPHI char(1)            , BENHVIEN_ID varchar(10)            , NGAYTAO datetime            , NGUOITAO_ID  int            )                                  UPDATE TT_NOITRU_TOATHUOC set PHIEULINH_ID = json.CHUNGTU_ID, NGAYCAPNHAT = getdate()                   FROM OPENJSON(@json)           WITH (CHUNGTU_ID int, TOATHUOCNOITRU_ID int, REF_TABLE nvarchar(100)) json           WHERE TT_NOITRU_TOATHUOC.TOATHUOC_ID = json.TOATHUOCNOITRU_ID and json.REF_TABLE = 'TT_NOITRU_TOATHUOC'                                           UPDATE  TT_PHAUTHUAT_VTYT set CHUNGTUTONGHOP_ID = json.CHUNGTU_ID, NGAYCAPNHAT = getdate()                   FROM OPENJSON(@json)           WITH (CHUNGTU_ID int, TOATHUOCNOITRU_ID int, REF_TABLE nvarchar(100)) json           WHERE TT_PHAUTHUAT_VTYT.PHAUTHUAT_VTYT_ID = json.TOATHUOCNOITRU_ID and json.REF_TABLE = 'TT_PHAUTHUAT_VTYT'                                                UPDATE TT_CLSKETQUA_VTYT set CHUNGTUTONGHOP_ID = json.CHUNGTU_ID, NGAYCAPNHAT = getdate()                   FROM OPENJSON(@json)           WITH (CHUNGTU_ID int, TOATHUOCNOITRU_ID int, REF_TABLE nvarchar(100)) json           WHERE TT_CLSKETQUA_VTYT.CLSKETQUA_VTYT_ID = json.TOATHUOCNOITRU_ID and json.REF_TABLE = 'TT_CLSKETQUA_VTYT'                                                UPDATE TT_NGOAITRU_KHAMBENH_VTYT set PHIEULINH_ID = json.CHUNGTU_ID, NGAYCAPNHAT = getdate()                   FROM OPENJSON(@json)           WITH (CHUNGTU_ID int, TOATHUOCNOITRU_ID int, REF_TABLE nvarchar(100)) json           WHERE TT_NGOAITRU_KHAMBENH_VTYT.KHAMBENH_VTYT_ID = json.TOATHUOCNOITRU_ID and json.REF_TABLE = 'TT_NGOAITRU_KHAMBENH_VTYT'                       COMMIT TRANSACTION          END TRY                    BEGIN CATCH          IF @@TRANCOUNT > 0          ROLLBACK TRANSACTION          END CATCH]
2020-02-26 16:26:56,376 [1] DEBUG - Statement Id: [DAO00030_DUOCPHIEULINHCT_AddMulti] Parameters: [@param0=[CHUNGTU_ID,null]]
2020-02-26 16:26:56,376 [1] DEBUG - Statement Id: [DAO00030_DUOCPHIEULINHCT_AddMulti] Types: [@param0=[System.DBNull, null]]
2020-02-26 16:26:56,827 [1] DEBUG - Statement Id: [DAO00030_DUOCPHIEULINH_GetList] PreparedStatement : [select *              from TT_DUOC_PHIEULINH               where                             TT_DUOC_PHIEULINH.CHUNGTU_ID = '48586'                                     order by CHUNGTU_ID]
2020-02-26 16:26:56,900 [1] DEBUG - Statement Id: [DAO00030_DUOCPHIEULINHCT_GetList] PreparedStatement : [select CT.*, NLD.TENNHOMLOAIDUOC, LD.MALOAIDUOC, D.TENDUOCDAYDU, D.DONVITINH, CT.TOATHUOCNOITRU_ID AS TOATHUOC_ID,            LTRIM(PL.KHOXUAT_ID) + '_' + LTRIM(ct.DUOC_ID) + '_' + LTRIM(ct.NGUONHANG_ID) as DUOC_KEY            from TT_DUOC_PHIEULINH_CHITIET CT            inner join TT_DUOC_PHIEULINH PL ON PL.CHUNGTU_ID = CT.CHUNGTU_ID            left join TM_DUOC D on D.DUOC_ID = CT.DUOC_ID            left join TM_LOAIDUOC LD on LD.LOAIDUOC_ID = D.LOAIDUOC_ID            left join TM_NHOMLOAIDUOC NLD on NLD.NHOMLOAIDUOC_ID = LD.NHOMLOAIDUOC_ID             where                             CT.CHUNGTU_ID = '48586'                                     order by CHUNGTUCHITIET_ID]
2020-02-26 16:26:56,958 [1] DEBUG - Statement Id: [DAO00030_YLENH_NOITRU_NGAYCAPNHAT] PreparedStatement : [SELECT              TT.NGAYCAPNHAT              FROM              TT_NOITRU_TOATHUOC TT              inner join TM_DUOC D on D.DUOC_ID = TT.DUOC_ID              inner join TM_LOAIDUOC LD on LD.LOAIDUOC_ID = D.LOAIDUOC_ID              WHERE              tt.KHAMBENH_ID IN (320502,320502,320502,320502,320502,320502)              AND tt.BENHVIEN_ID = 'HLU01'                             order by NGAYCAPNHAT]
2020-02-26 16:26:56,996 [1] DEBUG - Statement Id: [DAO00030_DUOCTONKHO_GetSoTonTheoDuoc] PreparedStatement : [SELECT              DUOC_ID,              SUM(SOLUONG) AS TONGTON              FROM              TT_DUOC_TONKHO              WHERE              KHODUOC_ID = '1'              and BENHVIEN_ID = 'HLU01'              and DUOC_ID IN (1030,934)              GROUP BY DUOC_ID]
2020-02-26 16:29:13,716 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'BIL11'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 16:29:14,531 [1] DEBUG - Statement Id: [DAO00012_GetList] PreparedStatement : [select        DICTIONARY_ID,        DICTIONARY_CODE,        DICTIONARY_NAME,        ATTRIBUTE1,        ATTRIBUTE2,        DICTIONARY_NAME_EN,        DICTIONARY_TYPE_CODE        from LST_DICTIONARY        where LST_DICTIONARY.Enabled = '1'         AND           LST_DICTIONARY.DICTIONARY_TYPE_CODE = 'NguonBN'                 order by LST_DICTIONARY.IDX]
2020-02-26 16:29:15,190 [1] DEBUG - Statement Id: [DAO00101_GetListSuatAn] PreparedStatement : [SELECT        kP.KHAUPHANAN_ID,        kP.MAKHAUPHANAN,        kP.TENKHAUPHANAN,        LKP.LOAIKHAUPHANAN_ID,        LKP.MALOAIKHAUPHANAN,        LKP.TENLOAIKHAUPHANAN,        DG.DONGIA,        kP.HANGMUC_ID        FROM TM_NUT_KHAUPHANAN kP        INNER JOIN TM_NUT_LOAIKHAUPHANAN LKP ON  kP.LOAIKHAUPHANAN_ID = LKP.LOAIKHAUPHANAN_ID        INNER JOIN TM_NUT_KHAUPHANAN_DONGIA DG ON DG.KHAUPHANAN_ID = kP.KHAUPHANAN_ID        WHERE DG.DONGIA IS NOT NULL]
2020-02-26 16:29:17,668 [1] DEBUG - Statement Id: [DAO00014_GetInPatientStatus] PreparedStatement : [select TRANGTHAI, isnull(KHOACHUYENDEN_ID, KHOAVAO_ID) as KHOAHIENTAI from TT_NOITRU_BENHAN        where        TIEPNHAN_ID = '107181'        and BENHVIEN_ID = 'HLU01'         and           BENHAN_ID = '24642']
2020-02-26 16:29:17,868 [1] DEBUG - Statement Id: [DAO00024_TT_VIENPHI_GetList_DSDichVuChuaThuTien] PreparedStatement : [SELECT TOP 1 VIENPHI_ID              FROM TT_VIENPHI              WHERE              DATHANHTOAN = 0]
2020-02-26 16:29:17,896 [1] DEBUG - Statement Id: [DAO00067_laytrangthaibenhannoitru] PreparedStatement : [select isnull(TRANGTHAI, '') TRANGTHAI from TT_NOITRU_BENHAN where BENHAN_ID =  @param0]
2020-02-26 16:29:17,896 [1] DEBUG - Statement Id: [DAO00067_laytrangthaibenhannoitru] Parameters: [@param0=[BENHAN_ID,24642]]
2020-02-26 16:29:17,896 [1] DEBUG - Statement Id: [DAO00067_laytrangthaibenhannoitru] Types: [@param0=[Int64, System.Int64]]
2020-02-26 16:29:17,922 [1] DEBUG - Statement Id: [DAO00067_DeleteVienPhi_Noref] PreparedStatement : [delete from TT_VIENPHI where TIEPNHAN_ID = 107181 and (REF_ID is null or REF_ID = 0)         and           BENHAN_ID = '24642'                 delete TT_DUOC_TONKHO_BOOK_NOITRU where REF_TABLE = 'TT_NOITRU_TOATHUOC' and (REF_ID is null or REF_ID = 0)        delete TT_DUOC_TONKHO_BOOK_NGOAITRU where REF_ID is null or REF_ID = 0]
2020-02-26 16:29:17,947 [1] DEBUG - Statement Id: [DAO00067_UpdateBenhanIdVienPhi] PreparedStatement : [update TT_VIENPHI          set BENHAN_ID =  @param0           from (select TOATHUOC_ID from TT_NOITRU_TOATHUOC where TIEPNHAN_ID =  @param1 ) nttt          where REF_TABLE = 'TT_NOITRU_TOATHUOC' and REF_ID = nttt.TOATHUOC_ID and isnull(BENHAN_ID, 0) = 0          and TIEPNHAN_ID =  @param1             update TT_VIENPHI          set TT_VIENPHI.BENHAN_ID =  @param0           from (select DVYEUCAU_ID, BENHAN_ID from TT_DVYEUCAU where TIEPNHAN_ID =  @param1 ) nttt          where TT_VIENPHI.REF_TABLE = 'TT_DVYEUCAU' and TT_VIENPHI.REF_ID = nttt.DVYEUCAU_ID          and isnull(TT_VIENPHI.BENHAN_ID, 0) = 0 and isnull(nttt.BENHAN_ID, 0) > 0          and TT_VIENPHI.TIEPNHAN_ID =  @param1]
2020-02-26 16:29:17,947 [1] DEBUG - Statement Id: [DAO00067_UpdateBenhanIdVienPhi] Parameters: [@param0=[BENHAN_ID,24642], @param1=[TIEPNHAN_ID,107181]]
2020-02-26 16:29:17,947 [1] DEBUG - Statement Id: [DAO00067_UpdateBenhanIdVienPhi] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64]]
2020-02-26 16:29:17,973 [1] DEBUG - Statement Id: [DAO00064_GetlistTT_TIEPNHAN_SOTHEBHYT] PreparedStatement : [select stbhyt.*, ba.SOBENHAN,        tn.SOTIEPNHAN, tn.LOAITHANHVIEN_ID, tn.THE_ID, tn.THANHVIEN_ID,        tn.SUDUNG_BHTN, tn.BAOLANH_VIENPHI, tn.VIP, tn.NGUOINUOCNGOAI        from TT_TIEPNHAN_SOTHEBHYT stbhyt        left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = stbhyt.TIEPNHAN_ID        left join TT_NOITRU_BENHAN ba on ba.TIEPNHAN_ID = stbhyt.TIEPNHAN_ID        where        stbhyt.TIEPNHAN_ID = '107181' and isnull(stbhyt.KHONGSUDUNG, '0') = '0'         and           ba.BENHAN_ID = '24642']
2020-02-26 16:29:18,021 [1] DEBUG - Statement Id: [DAO00064_GetListVienPhiByTiepNnan] PreparedStatement : [select distinct        B.DOITUONG_ID, B.NGAYMIENDONGCHITRA, B.BENHNHAN_ID as TIEPNHAN_BENHNHAN_ID, B.TRAITUYEN,        B.BHYTTREN3NAM as TREN3NAM, B.BHYTTREN5NAM as TREN5NAM, B.SOTIEPNHAN, B.SOBENHAN,        B.LOAITHANHVIEN_ID, B.SUDUNG_BHTN, B.THE_ID, B.THANHVIEN_ID, B.BAOLANH_VIENPHI, B.VIP, B.NGUOINUOCNGOAI,        C.GIATRIMIENGIAM as GIATRIMIENGIAM, D.GIATRIMIENGIAM as GIATRIMIENGIAM_BHTN, E.GIATRIMIENGIAM as GIATRIMIENGIAM_THANHVIEN,        F.GIATRIMIENGIAM as GIATRIMIENGIAM_CONGTY, DVYC.THE_ID as DVDUNGTHE, DVYC.TRANGTHAI as TRANGTHAIDICHVU, ndv.MANHOMDICHVU,        A.* from TT_VIENPHI A        left join        (select B.*, C.SOBENHAN, C.BENHAN_ID        from TT_TIEPNHAN B        left join TT_NOITRU_BENHAN C on B.TIEPNHAN_ID = C.TIEPNHAN_ID         and           C.BENHAN_ID = '24642'                 where B.TIEPNHAN_ID = '107181') B on B.TIEPNHAN_ID = A.TIEPNHAN_ID        left join (select sum(GIATRIMIENGIAM) as GIATRIMIENGIAM, VIENPHI_ID, REF_TABLE        from TT_MIENGIAM_CHITIET        where REF_TABLE = 'TT_MIENGIAM'        and exists (select MIENGIAM_ID from TT_MIENGIAM where TT_MIENGIAM_CHITIET.MIENGIAM_ID = MIENGIAM_ID and TINHTRANG = 1 and TIEPNHAN_ID = '107181')        group by VIENPHI_ID, REF_TABLE) C on C.REF_TABLE = 'TT_MIENGIAM' and C.VIENPHI_ID = A.VIENPHI_ID        left join (select sum(GIATRIMIENGIAM) as GIATRIMIENGIAM, VIENPHI_ID, REF_TABLE        from TT_MIENGIAM_CHITIET        where REF_TABLE = 'TT_MIENGIAM_BHTN'        and exists (select MIENGIAM_BHTN_ID from TT_MIENGIAM_BHTN where TT_MIENGIAM_CHITIET.MIENGIAM_ID = MIENGIAM_BHTN_ID and  TINHTRANG = 1 and TIEPNHAN_ID = '107181')        group by VIENPHI_ID, REF_TABLE) D on D.REF_TABLE = 'TT_MIENGIAM_BHTN' and D.VIENPHI_ID = A.VIENPHI_ID        left join (select sum(GIATRIMIENGIAM) as GIATRIMIENGIAM, VIENPHI_ID, REF_TABLE        from TT_MIENGIAM_CHITIET        where REF_TABLE = 'TT_MIENGIAM_THANHVIEN'        and exists (select MIENGIAM_THANHVIEN_ID from TT_MIENGIAM_THANHVIEN where TT_MIENGIAM_CHITIET.MIENGIAM_ID = MIENGIAM_THANHVIEN_ID and TINHTRANG = 1 and TIEPNHAN_ID = '107181')        group by VIENPHI_ID, REF_TABLE) E on E.REF_TABLE = 'TT_MIENGIAM_THANHVIEN' and E.VIENPHI_ID = A.VIENPHI_ID        left join (select sum(GIATRIMIENGIAM) as GIATRIMIENGIAM, VIENPHI_ID, REF_TABLE        from TT_MIENGIAM_CHITIET        where REF_TABLE = 'TT_MIENGIAM_CONGTY'        and exists (select MIENGIAM_CONGTY_ID from TT_MIENGIAM_CONGTY where TT_MIENGIAM_CHITIET.MIENGIAM_ID = MIENGIAM_CONGTY_ID and TINHTRANG = 1 and TIEPNHAN_ID = '107181')        group by VIENPHI_ID, REF_TABLE) F on F.REF_TABLE = 'TT_MIENGIAM_CONGTY' and F.VIENPHI_ID = A.VIENPHI_ID        left join TT_DVYEUCAU DVYC on DVYC.DVYEUCAU_ID = A.REF_ID and A.REF_TABLE = 'TT_DVYEUCAU'        left join TM_DICHVU DV on DVYC.DICHVU_ID = DV.DICHVU_ID and A.REF_TABLE = 'TT_DVYEUCAU'        left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = DV.NHOMDICHVU_ID and A.REF_TABLE = 'TT_DVYEUCAU'        where        A.TIEPNHAN_ID = '107181' and ((DVYC.HUYYEUCAU = '0' and A.DICHVU_ID is not null)        or A.DUOC_ID is not null or A.REF_TABLE = 'TT_NUT_XACNHANSUATAN_CHITIET')        and A.ACTIVE = '1'         and           A.BENHAN_ID = '24642'                 and A.BENHVIEN_ID = 'HLU01'        order by A.VIENPHI_ID]
2020-02-26 16:29:18,060 [1] DEBUG - Statement Id: [DAO00006_GetListDuocTyle] PreparedStatement : [select DUOC_ID, DOITUONG_ID, (TYLE/100) as TYLE, DONGIA MUCTRAN_THANHTOAN from TM_DOITUONG_GIADUOC_TYLE            where            BENHVIEN_ID = 'HLU01'            and DOITUONG_ID = '4']
2020-02-26 16:29:18,085 [1] DEBUG - Statement Id: [DAO00027_GetListTuongTrinhDichVuPhauThuatCuaTiepNhan] PreparedStatement : [declare @ManhomDSA varchar(10);        declare @PhanLoaiNhomDV varchar(20) = '05';        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        if (@ManhomDSA is not null) set @PhanLoaiNhomDV += ',' + @ManhomDSA        select distinct ptyc.*        from TT_PHAUTHUAT_YEUCAU ptyc        inner join TM_DICHVU dv on dv.DICHVU_ID = ptyc.DICHVU_ID        inner join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID        inner join TT_PHAUTHUAT pt on pt.PHAUTHUAT_ID = ptyc.PHAUTHUAT_ID        where        pt.TIEPNHAN_ID = 107181        and (left(ndv.MANHOMDICHVU, 2) in (select * from STRING_SPLIT(@PhanLoaiNhomDV,',')) or ndv.MANHOMDICHVU in (select * from STRING_SPLIT(@PhanLoaiNhomDV,',')))]
2020-02-26 16:29:18,148 [1] DEBUG - Statement Id: [DAO00027_GetListTuongTrinhVTYTPhauThuatCuaTiepNhan] PreparedStatement : [select distinct ptvt.*        from TT_PHAUTHUAT_VTYT ptvt        inner join TT_PHAUTHUAT pt on pt.PHAUTHUAT_ID = ptvt.PHAUTHUAT_ID        inner join TM_DUOC d on d.DUOC_ID = ptvt.DUOC_ID        inner join TM_LOAIDUOC ld on ld.LOAIVATTU_ID = 'V' and ld.LOAIDUOC_ID = d.LOAIDUOC_ID        where pt.TIEPNHAN_ID = 107181        order by ptvt.PHAUTHUAT_VTYT_ID asc]
2020-02-26 16:29:18,180 [1] DEBUG - Statement Id: [DAO00006_GetList] PreparedStatement : [select dv.*, loaiDV.MALOAIDICHVU, captren.NHOMDICHVU_ID as NHOMDICHVU_CAPTREN_ID, captren.TENNHOMDICHVU as NHOMDICHVU_CAPTREN,              nhom_dv.TENNHOMDICHVU as TENNHOMDICHVU, nhom_dv.MANHOMDICHVU,              case when dv.ATTRIBUTE5 is null then 'TT' else 'KTC' end as LOAI_CHIPHI              from TM_DICHVU as dv              left join TM_NHOMDICHVU as nhom_dv on nhom_dv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID and nhom_dv.BENHVIEN_ID = 'HLU01'              left join TM_NHOMDICHVU as captren on nhom_dv.CAPTREN_ID = captren.NHOMDICHVU_ID and captren.BENHVIEN_ID = 'HLU01'              left join TM_LOAIDICHVU loaiDV on nhom_dv.LOAIDICHVU_ID = loaiDV.LOAIDICHVU_ID and loaiDV.BENHVIEN_ID = 'HLU01'              where nhom_dv.TAMNGUNG = '0' and dv.BENHVIEN_ID = 'HLU01'              and dv.TAMNGUNG = '0'               AND                   loaiDV.MALOAIDICHVU = 'KhamBenh']
2020-02-26 16:29:18,224 [1] DEBUG - Statement Id: [DAO00027_GetDichvuYCBHYTTyle] PreparedStatement : [select DVYEUCAU_ID from TT_DVYEUCAU        where TIEPNHAN_ID = 107181 and isnull(BHYT_TYLETHANHTOAN_ID, 0) > 0]
2020-02-26 16:29:18,421 [1] DEBUG - Statement Id: [DAO00023_UpdateNhieuVP] PreparedStatement : [declare @jsonVienPhi nvarchar(max) = N'[{"VIENPHI_ID":3109614,"TIEPNHAN_ID":107181,"DICHVU_ID":5440,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":34500.0000,"THANHTIEN_DOANHTHU":34500.00,"BHYT_TL":0.8000,"BHYT_DONGIA":34500.0000,"BHYT_THANHTIEN":34500.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":27600.0,"BHYT_THANHTIEN_CHITRA":27600.00,"BENHNHAN_PHAITHANHTOAN":6900.00,"GIATRI_HOADON":6900.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3109615,"TIEPNHAN_ID":107181,"DICHVU_ID":5554,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":5000.0000,"THANHTIEN_DOANHTHU":5000.00,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":5000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110619,"TIEPNHAN_ID":107181,"DICHVU_ID":4022,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":43900.0000,"THANHTIEN_DOANHTHU":43900.00,"BHYT_TL":0.8000,"BHYT_DONGIA":43900.0000,"BHYT_THANHTIEN":43900.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":35120.0,"BHYT_THANHTIEN_CHITRA":35120.00,"BENHNHAN_PHAITHANHTOAN":8780.00,"GIATRI_HOADON":8780.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110620,"TIEPNHAN_ID":107181,"DICHVU_ID":4422,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":32800.0000,"THANHTIEN_DOANHTHU":32800.00,"BHYT_TL":0.8000,"BHYT_DONGIA":32800.0000,"BHYT_THANHTIEN":32800.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":26240.0,"BHYT_THANHTIEN_CHITRA":26240.00,"BENHNHAN_PHAITHANHTOAN":6560.00,"GIATRI_HOADON":6560.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110621,"TIEPNHAN_ID":107181,"DICHVU_ID":4451,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":63500.0000,"THANHTIEN_DOANHTHU":63500.00,"BHYT_TL":0.8000,"BHYT_DONGIA":63500.0000,"BHYT_THANHTIEN":63500.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":50800.0,"BHYT_THANHTIEN_CHITRA":50800.00,"BENHNHAN_PHAITHANHTOAN":12700.00,"GIATRI_HOADON":12700.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110622,"TIEPNHAN_ID":107181,"DICHVU_ID":4454,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":40400.0000,"THANHTIEN_DOANHTHU":40400.00,"BHYT_TL":0.8000,"BHYT_DONGIA":40400.0000,"BHYT_THANHTIEN":40400.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":32320.0,"BHYT_THANHTIEN_CHITRA":32320.00,"BENHNHAN_PHAITHANHTOAN":8080.00,"GIATRI_HOADON":8080.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110623,"TIEPNHAN_ID":107181,"DICHVU_ID":4523,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":40400.0000,"THANHTIEN_DOANHTHU":40400.00,"BHYT_TL":0.8000,"BHYT_DONGIA":40400.0000,"BHYT_THANHTIEN":40400.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":32320.0,"BHYT_THANHTIEN_CHITRA":32320.00,"BENHNHAN_PHAITHANHTOAN":8080.00,"GIATRI_HOADON":8080.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110624,"TIEPNHAN_ID":107181,"DICHVU_ID":4596,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":39100.0000,"THANHTIEN_DOANHTHU":39100.00,"BHYT_TL":0.8000,"BHYT_DONGIA":39100.0000,"BHYT_THANHTIEN":39100.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":31280.0,"BHYT_THANHTIEN_CHITRA":31280.00,"BENHNHAN_PHAITHANHTOAN":7820.00,"GIATRI_HOADON":7820.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110626,"TIEPNHAN_ID":107181,"DICHVU_ID":4642,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":21500.0000,"THANHTIEN_DOANHTHU":21500.00,"BHYT_TL":0.8000,"BHYT_DONGIA":21500.0000,"BHYT_THANHTIEN":21500.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":17200.0,"BHYT_THANHTIEN_CHITRA":17200.00,"BENHNHAN_PHAITHANHTOAN":4300.00,"GIATRI_HOADON":4300.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110628,"TIEPNHAN_ID":107181,"DICHVU_ID":4681,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":21500.0000,"THANHTIEN_DOANHTHU":21500.00,"BHYT_TL":0.8000,"BHYT_DONGIA":21500.0000,"BHYT_THANHTIEN":21500.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":17200.0,"BHYT_THANHTIEN_CHITRA":17200.00,"BENHNHAN_PHAITHANHTOAN":4300.00,"GIATRI_HOADON":4300.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110629,"TIEPNHAN_ID":107181,"DICHVU_ID":4722,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":21500.0000,"THANHTIEN_DOANHTHU":21500.00,"BHYT_TL":0.8000,"BHYT_DONGIA":21500.0000,"BHYT_THANHTIEN":21500.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":17200.0,"BHYT_THANHTIEN_CHITRA":17200.00,"BENHNHAN_PHAITHANHTOAN":4300.00,"GIATRI_HOADON":4300.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110630,"TIEPNHAN_ID":107181,"DICHVU_ID":4747,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":27400.0000,"THANHTIEN_DOANHTHU":27400.00,"BHYT_TL":0.8000,"BHYT_DONGIA":27400.0000,"BHYT_THANHTIEN":27400.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":21920.0,"BHYT_THANHTIEN_CHITRA":21920.00,"BENHNHAN_PHAITHANHTOAN":5480.00,"GIATRI_HOADON":5480.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110631,"TIEPNHAN_ID":107181,"DICHVU_ID":4832,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":70000.0000,"THANHTIEN_DOANHTHU":70000.00,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":70000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":70000.0000,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":70000.0000,"GIATRI_BENHNHAN_DATHANHTOAN":70000.0000,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3110632,"TIEPNHAN_ID":107181,"DICHVU_ID":4873,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":70000.0000,"THANHTIEN_DOANHTHU":70000.00,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":70000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":70000.0000,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":70000.0000,"GIATRI_BENHNHAN_DATHANHTOAN":70000.0000,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119342,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":5.0000,"DONGIA_DOANHTHU":4000.0000,"THANHTIEN_DOANHTHU":20000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":20000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119500,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":2.0000,"DONGIA_DOANHTHU":8715.0000,"THANHTIEN_DOANHTHU":17430.00,"BHYT_TL":0.8000,"BHYT_DONGIA":8715.0000,"BHYT_THANHTIEN":17430.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":6972.0,"BHYT_THANHTIEN_CHITRA":13944.00,"BENHNHAN_PHAITHANHTOAN":3486.00,"GIATRI_HOADON":3486.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119501,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":8925.0000,"THANHTIEN_DOANHTHU":8925.00,"BHYT_TL":0.8000,"BHYT_DONGIA":8925.0000,"BHYT_THANHTIEN":8925.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":7140.0,"BHYT_THANHTIEN_CHITRA":7140.00,"BENHNHAN_PHAITHANHTOAN":1785.00,"GIATRI_HOADON":1785.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119502,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":2.0000,"DONGIA_DOANHTHU":27990.0000,"THANHTIEN_DOANHTHU":55980.00,"BHYT_TL":0.8000,"BHYT_DONGIA":27990.0000,"BHYT_THANHTIEN":55980.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":22392.0,"BHYT_THANHTIEN_CHITRA":44784.00,"BENHNHAN_PHAITHANHTOAN":11196.00,"GIATRI_HOADON":11196.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119503,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":8925.0000,"THANHTIEN_DOANHTHU":8925.00,"BHYT_TL":0.8000,"BHYT_DONGIA":8925.0000,"BHYT_THANHTIEN":8925.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":7140.0,"BHYT_THANHTIEN_CHITRA":7140.00,"BENHNHAN_PHAITHANHTOAN":1785.00,"GIATRI_HOADON":1785.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119504,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":2.0000,"DONGIA_DOANHTHU":8295.0000,"THANHTIEN_DOANHTHU":16590.00,"BHYT_TL":0.8000,"BHYT_DONGIA":8295.0000,"BHYT_THANHTIEN":16590.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":6636.0,"BHYT_THANHTIEN_CHITRA":13272.00,"BENHNHAN_PHAITHANHTOAN":3318.00,"GIATRI_HOADON":3318.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119505,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":458000.0000,"THANHTIEN_DOANHTHU":458000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":398036.0000,"BHYT_THANHTIEN":398036.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":318428.8,"BHYT_THANHTIEN_CHITRA":318428.80,"BENHNHAN_PHAITHANHTOAN":139571.20,"GIATRI_HOADON":79607.20,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119506,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":50400.0000,"THANHTIEN_DOANHTHU":50400.00,"BHYT_TL":0.8000,"BHYT_DONGIA":50400.0000,"BHYT_THANHTIEN":50400.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":40320.0,"BHYT_THANHTIEN_CHITRA":40320.00,"BENHNHAN_PHAITHANHTOAN":10080.00,"GIATRI_HOADON":10080.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119530,"TIEPNHAN_ID":107181,"DICHVU_ID":5363,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":10000.0000,"THANHTIEN_DOANHTHU":10000.00,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119531,"TIEPNHAN_ID":107181,"DICHVU_ID":5588,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":2400.0000,"THANHTIEN_DOANHTHU":2400.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119532,"TIEPNHAN_ID":107181,"DICHVU_ID":477,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":110000.0000,"THANHTIEN_DOANHTHU":110000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119533,"TIEPNHAN_ID":107181,"DICHVU_ID":5602,"BENHAN_ID":24642,"SOLUONG":0.5000,"DONGIA_DOANHTHU":200000.0000,"THANHTIEN_DOANHTHU":100000.00,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":100000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119535,"TIEPNHAN_ID":107181,"DICHVU_ID":3161,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":2945000.0000,"THANHTIEN_DOANHTHU":2945000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":2945000.0000,"BHYT_THANHTIEN":2945000.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":2356000.0,"BHYT_THANHTIEN_CHITRA":2356000.00,"BENHNHAN_PHAITHANHTOAN":589000.00,"GIATRI_HOADON":589000.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119536,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":0.2500,"DONGIA_DOANHTHU":25000.0000,"THANHTIEN_DOANHTHU":6250.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119537,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":2.0000,"DONGIA_DOANHTHU":1700.0000,"THANHTIEN_DOANHTHU":3400.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119538,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":3.0000,"DONGIA_DOANHTHU":1000.0000,"THANHTIEN_DOANHTHU":3000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119539,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":3.0000,"DONGIA_DOANHTHU":2000.0000,"THANHTIEN_DOANHTHU":6000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119540,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":4000.0000,"THANHTIEN_DOANHTHU":4000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119541,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":3000.0000,"THANHTIEN_DOANHTHU":3000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119542,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":100.0000,"DONGIA_DOANHTHU":50.0000,"THANHTIEN_DOANHTHU":5000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119543,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":150000.0000,"THANHTIEN_DOANHTHU":150000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119544,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":160000.0000,"THANHTIEN_DOANHTHU":160000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119545,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":20.0000,"DONGIA_DOANHTHU":3000.0000,"THANHTIEN_DOANHTHU":60000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119546,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":20.0000,"DONGIA_DOANHTHU":6000.0000,"THANHTIEN_DOANHTHU":120000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119547,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":5.0000,"DONGIA_DOANHTHU":4000.0000,"THANHTIEN_DOANHTHU":20000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119548,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":10.0000,"DONGIA_DOANHTHU":8000.0000,"THANHTIEN_DOANHTHU":80000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119549,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":2.0000,"DONGIA_DOANHTHU":500.0000,"THANHTIEN_DOANHTHU":1000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119550,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":10000.0000,"THANHTIEN_DOANHTHU":10000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119551,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":45000.0000,"THANHTIEN_DOANHTHU":45000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119552,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":35000.0000,"THANHTIEN_DOANHTHU":35000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119553,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":10000.0000,"THANHTIEN_DOANHTHU":10000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119554,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":20000.0000,"THANHTIEN_DOANHTHU":20000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119555,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":6500.0000,"THANHTIEN_DOANHTHU":6500.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119556,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":0.5000,"DONGIA_DOANHTHU":16000.0000,"THANHTIEN_DOANHTHU":8000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119557,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":0.2500,"DONGIA_DOANHTHU":100000.0000,"THANHTIEN_DOANHTHU":25000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119558,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":2.0000,"DONGIA_DOANHTHU":10000.0000,"THANHTIEN_DOANHTHU":20000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119559,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":60000.0000,"THANHTIEN_DOANHTHU":60000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119560,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":2.0000,"DONGIA_DOANHTHU":13500.0000,"THANHTIEN_DOANHTHU":27000.00,"BHYT_TL":0.8000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119561,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":6000.0000,"THANHTIEN_DOANHTHU":6000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":0.0,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"1","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":null,"DUOC_TYLE":null},{"VIENPHI_ID":3119645,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":600.0000,"THANHTIEN_DOANHTHU":600.00,"BHYT_TL":0.8000,"BHYT_DONGIA":600.0000,"BHYT_THANHTIEN":600.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":480.0,"BHYT_THANHTIEN_CHITRA":480.00,"BENHNHAN_PHAITHANHTOAN":120.00,"GIATRI_HOADON":120.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":0.0,"DUOC_TYLE":0.0000},{"VIENPHI_ID":3119646,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":1000.0000,"THANHTIEN_DOANHTHU":1000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":1000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"1","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":0.0,"DUOC_TYLE":0.0000},{"VIENPHI_ID":3119647,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":600.0000,"THANHTIEN_DOANHTHU":600.00,"BHYT_TL":0.8000,"BHYT_DONGIA":600.0000,"BHYT_THANHTIEN":600.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":480.0,"BHYT_THANHTIEN_CHITRA":480.00,"BENHNHAN_PHAITHANHTOAN":120.00,"GIATRI_HOADON":120.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":0.0,"DUOC_TYLE":0.0000},{"VIENPHI_ID":3119648,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":1000.0000,"THANHTIEN_DOANHTHU":1000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":1000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"1","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":0.0,"DUOC_TYLE":0.0000},{"VIENPHI_ID":3119649,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":600.0000,"THANHTIEN_DOANHTHU":600.00,"BHYT_TL":0.8000,"BHYT_DONGIA":600.0000,"BHYT_THANHTIEN":600.00,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":480.0,"BHYT_THANHTIEN_CHITRA":480.00,"BENHNHAN_PHAITHANHTOAN":120.00,"GIATRI_HOADON":120.00,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":0.0,"DUOC_TYLE":0.0000},{"VIENPHI_ID":3119650,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":1000.0000,"THANHTIEN_DOANHTHU":1000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":1000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"1","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":0.0,"DUOC_TYLE":0.0000},{"VIENPHI_ID":3119651,"TIEPNHAN_ID":107181,"DICHVU_ID":null,"BENHAN_ID":24642,"SOLUONG":1.0000,"DONGIA_DOANHTHU":12000.0000,"THANHTIEN_DOANHTHU":12000.00,"BHYT_TL":1.0000,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":34500.0000,"BHYT_CONGKHAM_DAU_TYLE":1.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":12000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"1","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":0.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":"DN438381400387938289","SOBHYT_HUONG_ID":111518,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":0.0,"DUOC_TYLE":0.0000}]';        begin        UPDATE TT_VIENPHI        SET        SOLUONG = json.SOLUONG,        DONGIA_DOANHTHU = json.DONGIA_DOANHTHU,        THANHTIEN_DOANHTHU = json.THANHTIEN_DOANHTHU,        BHYT_TL = json.BHYT_TL,        BHYT_DONGIA = json.BHYT_DONGIA,        BHYT_THANHTIEN = json.BHYT_THANHTIEN,        BHYT_DONGIA_CONGKHAM_DAU = json.BHYT_DONGIA_CONGKHAM_DAU,        BHYT_CONGKHAM_DAU_TYLE = json.BHYT_CONGKHAM_DAU_TYLE,        BHYT_DONGIA_CHITRA = json.BHYT_DONGIA_CHITRA,        BHYT_THANHTIEN_CHITRA = json.BHYT_THANHTIEN_CHITRA,        BENHNHAN_PHAITHANHTOAN = json.BENHNHAN_PHAITHANHTOAN,        GIATRI_HOADON = json.GIATRI_HOADON,        GIATRI_BIENLAI = json.GIATRI_BIENLAI,        DATHUCHIEN = json.DATHUCHIEN,        DICHVU_TL = json.DICHVU_TL,        BHYT_DONGIA_DONGCT_DAU = json.BHYT_DONGIA_DONGCT_DAU,        SOLONHAP_ID = json.SOLONHAP_ID,        DUOC_TYLE = json.DUOC_TYLE,        DUOC_MUCTRAN_THANHTOAN = json.DUOC_MUCTRAN_THANHTOAN,        NGAYCAPNHAT = GETDATE()        FROM OPENJSON (@jsonVienPhi)        WITH (        VIENPHI_ID int,        SOLUONG numeric(25, 4),        DONGIA_DOANHTHU numeric(25, 4),        THANHTIEN_DOANHTHU numeric(25, 4),        BHYT_TL numeric(25, 4),        BHYT_DONGIA numeric(25, 4),        BHYT_THANHTIEN numeric(25, 4),        BHYT_DONGIA_CONGKHAM_DAU numeric(25, 4),        BHYT_CONGKHAM_DAU_TYLE numeric(25, 4),        BHYT_DONGIA_CHITRA numeric(25, 4),        BHYT_THANHTIEN_CHITRA numeric(25, 4),        BENHNHAN_PHAITHANHTOAN numeric(25, 4),        GIATRI_HOADON numeric(25, 4),        GIATRI_BIENLAI numeric(25, 4),        DATHUCHIEN char(1),        KHONGTHUTIEN char(1),        BHYTDONGTIEN char(1),        DICHVU_TL numeric(25, 4),        BHYT_DONGIA_DONGCT_DAU numeric(25, 4),        SOLONHAP_ID int,        DUOC_TYLE numeric(25, 4),        DUOC_MUCTRAN_THANHTOAN numeric(25, 4))  json        WHERE TT_VIENPHI.VIENPHI_ID = json.VIENPHI_ID and json.DONGIA_DOANHTHU > 0                  insert into TT_TINH_VIENPHI_LOG        SELECT json.VIENPHI_ID, json.TIEPNHAN_ID, json.BENHAN_ID, json.SOLUONG, json.BHYT_TL, json.DONGIA_DOANHTHU,        json.THANHTIEN_DOANHTHU, json.BHYT_DONGIA, json.BHYT_THANHTIEN, json.BHYT_DONGIA_CHITRA, json.BHYT_THANHTIEN_CHITRA, json.BENHNHAN_PHAITHANHTOAN,        json.SOBHYT_HUONG_ID, json.SOBHYT, GETDATE(), -1, 'HLU01'        FROM OPENJSON(@jsonVienPhi)        WITH (        VIENPHI_ID int,        TIEPNHAN_ID int,        BENHAN_ID int,        SOLUONG numeric(25, 4),        DONGIA_DOANHTHU numeric(25, 4),        THANHTIEN_DOANHTHU numeric(25, 4),        BHYT_TL numeric(25, 4),        BHYT_DONGIA numeric(25, 4),        BHYT_THANHTIEN numeric(25, 4),        BHYT_DONGIA_CHITRA numeric(25, 4),        BHYT_THANHTIEN_CHITRA numeric(25, 4),        BENHNHAN_PHAITHANHTOAN numeric(25, 4),        SOBHYT_HUONG_ID int,        SOBHYT nvarchar(30)) json        end]
2020-02-26 16:29:18,794 [1] DEBUG - Statement Id: [DAO00067_UpdateDataVienPhiDongiaBHYT] PreparedStatement : [update TT_VIENPHI          set BHYT_DONGIA_CHITRA = 0, BHYT_THANHTIEN = 0, BHYT_THANHTIEN_CHITRA = 0          where          TIEPNHAN_ID = 107181 and BHYT_DONGIA = 0          and (BHYT_DONGIA_CHITRA > 0 or BHYT_THANHTIEN > 0 or BHYT_THANHTIEN_CHITRA > 0)]
2020-02-26 16:29:18,824 [1] DEBUG - Statement Id: [DAO00067_CapnhatDataVienphiKhiHuyThanhtoanHoadon] PreparedStatement : [update TT_VIENPHI        set TT_VIENPHI.HOADON_ID = hdct.HOADON_ID, TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN = TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN + hdct.GIATRI_BENHNHAN_DATHANHTOAN        from (select CT.HOADON_ID, CT.VIENPHI_ID, CT.GIATRI_BENHNHAN_DATHANHTOAN        from TT_HOADON_CHITIET_NGOAITRU CT        join TT_HOADON HD on HD.HOADON_ID = CT.HOADON_ID        join TT_VIENPHI vp on vp.VIENPHI_ID = ct.VIENPHI_ID        where HD.DATHANHTOAN = 1 and HD.HUYHOADON = 0 and HD.HOANTRA = 0 and vp.TIEPNHAN_ID =  @param0 ) hdct        where        TT_VIENPHI.VIENPHI_ID = hdct.VIENPHI_ID and TT_VIENPHI.HOADON_ID is null and isnull(TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN,0) = 0        and TT_VIENPHI.TIEPNHAN_ID =  @param0           update TT_VIENPHI        set TT_VIENPHI.HOADON_ID = null, TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN = TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN - hdct.GIATRI_BENHNHAN_DATHANHTOAN,        TT_VIENPHI.DATHANHTOAN = '0'        from (select CT.HOADON_ID, CT.VIENPHI_ID, CT.GIATRI_BENHNHAN_DATHANHTOAN        from TT_HOADON_CHITIET_NGOAITRU CT        join TT_HOADON HD on HD.HOADON_ID = CT.HOADON_ID        join TT_VIENPHI vp on vp.VIENPHI_ID = ct.VIENPHI_ID and vp.HOADON_ID = ct.HOADON_ID        where HD.DATHANHTOAN = 0 and (HD.HUYHOADON = 1 or HD.HOANTRA = 1) and vp.TIEPNHAN_ID =  @param0 ) hdct        where        TT_VIENPHI.VIENPHI_ID = hdct.VIENPHI_ID and TT_VIENPHI.HOADON_ID = hdct.HOADON_ID        and TT_VIENPHI.TIEPNHAN_ID =  @param0]
2020-02-26 16:29:18,824 [1] DEBUG - Statement Id: [DAO00067_CapnhatDataVienphiKhiHuyThanhtoanHoadon] Parameters: [@param0=[TIEPNHAN_ID,107181]]
2020-02-26 16:29:18,824 [1] DEBUG - Statement Id: [DAO00067_CapnhatDataVienphiKhiHuyThanhtoanHoadon] Types: [@param0=[Int64, System.Int64]]
2020-02-26 16:29:18,874 [1] DEBUG - Statement Id: [DAO00000_GetDoiTuongIsBHYT] PreparedStatement : [select * from TM_DOITUONG Where DOITUONG_ID = 4 and MADOITUONG like '%BHYT%']
2020-02-26 16:29:18,946 [1] DEBUG - Statement Id: [DAO00064_GetDOITUONG] PreparedStatement : [SELECT TOP 1        DT.TENDOITUONG,        BHYT.SOTHE,        BHYT.NGAYHIEULUC,        BHYT.NGAYHETHIEULUC,        BHYT.BENHVIEN_KCB_ID AS MABENHVIEN,        BV.TENBENHVIEN,        BHYT.NGAYMIENDONGCHITRA,        BHYT.TREN5NAM          FROM TT_BENHNHAN_BHYT BHYT, TM_DOITUONG DT, TM_BENHVIEN BV        WHERE        DT.NHOMTHE LIKE '%' + LEFT(BHYT.SOTHE,3) + '%'        AND BHYT.BENHNHAN_ID = '20633'        AND BHYT.BENHVIEN_KCB_ID = BV.MABENHVIEN        ORDER BY BHYT.NGAYTAO DESC]
2020-02-26 16:29:19,224 [1] DEBUG - Statement Id: [DAO00064_GetNgayDangKyDichVu] PreparedStatement : [SELECT        DISTINCT CONVERT(date, NGAYTAO) as NGAYCHIPHI        FROM TT_VIENPHI        WHERE        TIEPNHAN_ID = '107181'         and           BENHAN_ID = '24642'                 ORDER BY NGAYCHIPHI]
2020-02-26 16:29:19,248 [1] DEBUG - Statement Id: [DAO00064_GetAllNgayYeucauDV] PreparedStatement : [SELECT        DISTINCT DVYEUCAU_ID, DICHVU_ID, CONVERT(date, NGAYYEUCAU) NGAYYEUCAU        FROM TT_DVYEUCAU        WHERE        TIEPNHAN_ID = '107181'         and           BENHAN_ID = '24642']
2020-02-26 16:29:19,275 [1] DEBUG - Statement Id: [DAO00064_GetAllNgayYeucauYlenh] PreparedStatement : [SELECT        DISTINCT A.TOATHUOC_ID, A.KHAMBENH_ID, A.DUOC_ID, CONVERT(date, B.THOIGIANKHAM) NGAYYEUCAU        FROM TT_NOITRU_TOATHUOC A        inner join TT_NOITRU_KHAMBENH B on B.KHAMBENH_ID = A.KHAMBENH_ID        WHERE        B.BENHAN_ID = '24642']
2020-02-26 16:29:19,315 [1] DEBUG - Statement Id: [DAO00063_AllGetTrangThaiThuocbyBenan_Id] PreparedStatement : [select A.CHUNGTU_ID, A.PHIEULINH_ID, A.HUYTOATHUOC, A.NGUOITAO_ID, A.TOATHUOC_ID        from TT_NOITRU_TOATHUOC A        inner join TT_NOITRU_KHAMBENH B on B.KHAMBENH_ID = A.KHAMBENH_ID        where B.BENHAN_ID  = '24642']
2020-02-26 16:29:19,343 [1] DEBUG - Statement Id: [DAO00064_TT_VIENPHI_GetList] PreparedStatement : [select distinct a.*, b.TINHTRANG AS TINHTRANG_MG, d.TINHTRANG_BHTN, e.TINHTRANG_MGCT        , b.MIENGIAMCHITIET_ID, b.GIATRIMIENGIAM, d.GIATRIMIENGIAM_BHTN, e.GIATRIMIENGIAM_CONGTY, e.GIATRIMIENGIAM_CONGTY as GIATRIMIENGIAM_CTCT, f.GIATRIMIENGIAM_THANHVIEN        , c.DVKEMTHEO, c.DVKEMTHEO_KHACEKIP, isnull(ttnt.PHONGBANRATOA_ID,c.NOIYEUCAU_ID) NOIYEUCAU_ID, c.NOITHUCHIEN_ID, c.DVYEUCAU_ID, c.HUYYEUCAU, c.DANGKY_ID,        isnull(dv.TENDICHVU, dc.TENDUOCDAYDU) NOIDUNG, isnull(dv.MADICHVU, dc.MADUOC) MADICHVU, dv.NORESULT, dc.DONVITINH, ld.MALOAIDUOC, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ndv.MANHOMDICHVU,        dv.BHYT DV_BHYT        from        (select VP.*, sbh.SOBHYT as SOBHYT_HUONG        from TT_VIENPHI VP        left join TT_TIEPNHAN_SOTHEBHYT sbh on sbh.SOBHYT_HUONG_ID = VP.SOBHYT_HUONG_ID        where        ((isnull(VP.GIATRI_BENHNHAN_DATHANHTOAN, 0) = 0 and isnull(VP.DATHANHTOAN, 0) = 0)        and VP.REF_TABLE != 'TT_MAU_CHUNGTU_CHITIET'                 )         and           VP.TIEPNHAN_ID = '107181'         and           VP.BENHAN_ID = '24642'         and           VP.BENHVIEN_ID = 'HLU01'                 )a left join                   (        select VIENPHI_ID, MG.TINHTRANG, MGCT.MIENGIAMCHITIET_ID, Sum(MGCT.GIATRIMIENGIAM) as GIATRIMIENGIAM        from TT_MIENGIAM MG INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_ID = MGCT.MIENGIAM_ID        where MG.TIEPNHAN_ID= '107181' and MGCT.REF_TABLE = 'TT_MIENGIAM'        group by VIENPHI_ID, MG.TINHTRANG, MGCT.MIENGIAMCHITIET_ID        )b        on a.VIENPHI_ID = b.VIENPHI_ID          left join(        select VIENPHI_ID, MG.TINHTRANG AS TINHTRANG_BHTN, SUM(MGCT.GIATRIMIENGIAM) as GIATRIMIENGIAM_BHTN        from TT_MIENGIAM_BHTN MG INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_BHTN_ID = MGCT.MIENGIAM_ID        where MG.TIEPNHAN_ID= '107181' and MGCT.REF_TABLE = 'TT_MIENGIAM_BHTN'        group by VIENPHI_ID, MG.TINHTRANG        )d        on a.VIENPHI_ID = d.VIENPHI_ID          left join(        select VIENPHI_ID, MG.TINHTRANG AS TINHTRANG_MGCT, Sum(MGCT.GIATRIMIENGIAM) as GIATRIMIENGIAM_CONGTY        from TT_MIENGIAM_CONGTY MG INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_CONGTY_ID = MGCT.MIENGIAM_ID        where MG.TIEPNHAN_ID= '107181' and MGCT.REF_TABLE = 'TT_MIENGIAM_CONGTY'        group by VIENPHI_ID, MG.TINHTRANG        )e        on a.VIENPHI_ID = e.VIENPHI_ID          left join(        select VIENPHI_ID, MG.TINHTRANG AS TINHTRANG_MGCT, Sum(MGCT.GIATRIMIENGIAM) as GIATRIMIENGIAM_THANHVIEN        from TT_MIENGIAM_THANHVIEN MG INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_THANHVIEN_ID = MGCT.MIENGIAM_ID        where MG.TIEPNHAN_ID= '107181' and MGCT.REF_TABLE = 'TT_MIENGIAM_THANHVIEN'        group by VIENPHI_ID, MG.TINHTRANG        )f        on a.VIENPHI_ID = f.VIENPHI_ID          left join        (        select DVYEUCAU_ID, TRANGTHAI, BHYTDONGTIEN, HUYYEUCAU, DVKEMTHEO, DVKEMTHEO_KHACEKIP, NOIYEUCAU_ID, NOITHUCHIEN_ID, DANGKY_ID from TT_DVYEUCAU        where TIEPNHAN_ID = '107181'        )c on c.DVYEUCAU_ID = a.REF_ID and a.REF_TABLE = 'TT_DVYEUCAU'        left join        (        select PHONGBANRATOA_ID, TOATHUOC_ID, 'TT_NOITRU_TOATHUOC' REF_TABLE  from TT_NOITRU_TOATHUOC where TIEPNHAN_ID  = '107181'        union        select PHONGBAN_ID as PHONGBANRATOA_ID, CLSKETQUA_VTYT_ID as TOATHUOC_ID, 'TT_CLSKETQUA_VTYT' REF_TABLE        from TT_CLSKETQUA_VTYT where exists (select DVYEUCAU_ID from TT_DVYEUCAU where TT_CLSKETQUA_VTYT.DVYEUCAU_ID = DVYEUCAU_ID and TIEPNHAN_ID  = '107181')        union        select PHONGBAN_ID as PHONGBANRATOA_ID, KHAMBENH_VTYT_ID as TOATHUOC_ID, 'TT_NGOAITRU_KHAMBENH_VTYT' REF_TABLE        from TT_NGOAITRU_KHAMBENH_VTYT where exists (select DVYEUCAU_ID from TT_DVYEUCAU where TT_NGOAITRU_KHAMBENH_VTYT.DVYEUCAU_ID = DVYEUCAU_ID and  TIEPNHAN_ID  = '107181')        union        select B.PHONGBANTHUCHIEN_ID as PHONGBANRATOA_ID, PHAUTHUAT_VTYT_ID as TOATHUOC_ID, 'TT_PHAUTHUAT_VTYT' REF_TABLE        from TT_PHAUTHUAT_VTYT A        left join TT_PHAUTHUAT B on A.PHAUTHUAT_ID = B.PHAUTHUAT_ID        where B.TIEPNHAN_ID  = '107181'        union        select B.PHONGBAN_ID as PHONGBANRATOA_ID, TOATHUOC_ID, 'TT_NGOAITRU_TOATHUOC' REF_TABLE        from TT_NGOAITRU_TOATHUOC A        left join TT_NGOAITRU_KHAMBENH B on A.KHAMBENH_ID = B.KHAMBENH_ID        where B.TIEPNHAN_ID  = '107181'        ) ttnt on ttnt.TOATHUOC_ID = a.REF_ID and a.REF_TABLE = ttnt.REF_TABLE        left join TM_DUOC dc on A.DUOC_ID = dc.DUOC_ID        left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID        left join TM_DICHVU dv on A.DICHVU_ID = dv.DICHVU_ID and A.REF_TABLE = 'TT_DVYEUCAU'        left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID        where        c.HUYYEUCAU = '0' or c.HUYYEUCAU is null]
2020-02-26 16:29:19,475 [1] DEBUG - Statement Id: [DAO00330_TT_VIENPHI_GetList] PreparedStatement : [select distinct a.*, b.TINHTRANG AS TINHTRANG_MG, d.TINHTRANG_BHTN, e.TINHTRANG_MGCT      , b.MIENGIAMCHITIET_ID, b.GIATRIMIENGIAM, d.GIATRIMIENGIAM_BHTN, e.GIATRIMIENGIAM_CONGTY, e.GIATRIMIENGIAM_CONGTY as GIATRIMIENGIAM_CTCT, f.GIATRIMIENGIAM_THANHVIEN      , NULL AS DVKEMTHEO, NULL AS DVKEMTHEO_KHACEKIP, ttnt.PHONGBANRATOA_ID NOIYEUCAU_ID, NULL AS NOITHUCHIEN_ID, NULL AS DVYEUCAU_ID, 0 AS HUYYEUCAU, NULL AS DANGKY_ID,      dc.TENMAU NOIDUNG, dc.MAMAU MADICHVU, NULL AS NORESULT, DVT.TENDONVITINH AS DONVITINH, ld.MALOAIMAU AS MALOAIDUOC, DC.BHYT AS DUOC_BHYT, 'M' AS LOAIVATTU_ID,NM.TENNHOMMAU AS MANHOMDICHVU      from      (select VP.*, sbh.SOBHYT as SOBHYT_HUONG      from TT_VIENPHI VP      left join TT_TIEPNHAN_SOTHEBHYT sbh on sbh.SOBHYT_HUONG_ID = VP.SOBHYT_HUONG_ID      where (VP.GIATRI_BENHNHAN_DATHANHTOAN = 0 or VP.GIATRI_BENHNHAN_DATHANHTOAN is null)       and             VP.TIEPNHAN_ID = '107181'           and           VP.BENHAN_ID = '24642'         and             VP.BENHVIEN_ID = 'HLU01'                   )a left join                       (      select VIENPHI_ID, MG.TINHTRANG, MGCT.MIENGIAMCHITIET_ID, MGCT.GIATRIMIENGIAM      from TT_MIENGIAM MG INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_ID = MGCT.MIENGIAM_ID      where      MG.TIEPNHAN_ID= '107181' and MGCT.REF_TABLE = 'TT_MIENGIAM'      )b      on a.VIENPHI_ID = b.VIENPHI_ID        left join(      select VIENPHI_ID, MG.TINHTRANG AS TINHTRANG_BHTN, MGCT.GIATRIMIENGIAM as GIATRIMIENGIAM_BHTN      from TT_MIENGIAM_BHTN MG INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_BHTN_ID = MGCT.MIENGIAM_ID      where      MG.TIEPNHAN_ID= '107181' and MGCT.REF_TABLE = 'TT_MIENGIAM_BHTN'      )d      on a.VIENPHI_ID = d.VIENPHI_ID        left join(      select VIENPHI_ID, MG.TINHTRANG AS TINHTRANG_MGCT, MGCT.GIATRIMIENGIAM as GIATRIMIENGIAM_CONGTY      from TT_MIENGIAM_CONGTY MG INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_CONGTY_ID = MGCT.MIENGIAM_ID      where      MG.TIEPNHAN_ID= '107181' and MGCT.REF_TABLE = 'TT_MIENGIAM_CONGTY'      )e      on a.VIENPHI_ID = e.VIENPHI_ID        left join(      select VIENPHI_ID, MG.TINHTRANG AS TINHTRANG_MGCT, MGCT.GIATRIMIENGIAM as GIATRIMIENGIAM_THANHVIEN      from TT_MIENGIAM_THANHVIEN MG INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_THANHVIEN_ID = MGCT.MIENGIAM_ID      where      MG.TIEPNHAN_ID= '107181' and MGCT.REF_TABLE = 'TT_MIENGIAM_THANHVIEN'      )f      on a.VIENPHI_ID = f.VIENPHI_ID      inner join      (      select DK.NOICHIDINH_ID as PHONGBANRATOA_ID, CT.CHUNGTUCHITIET_ID, 'TT_MAU_CHUNGTU_CHITIET' REF_TABLE      from TT_MAU_DANGKYMAU DK JOIN TT_MAU_DANGKYMAU_CHITIET DKCT ON DK.DANGKYMAU_ID = DKCT.DANGKYMAU_ID AND DK.TIEPNHAN_ID  = '107181'      INNER JOIN TT_MAU_CHUNGTU CTU ON DKCT.CHUNGTU_ID = CTU.CHUNGTU_ID AND CTU.CHUNGTULIENQUAN_ID IS NULL      JOIN TT_MAU_CHUNGTU_CHITIET CT ON CT.CHUNGTU_ID=CTU.CHUNGTU_ID      ) ttnt on ttnt.CHUNGTUCHITIET_ID = a.REF_ID and a.REF_TABLE = ttnt.REF_TABLE      left join TM_MAU dc on A.DUOC_ID = dc.MAU_ID      LEFT JOIN TM_MAU_DONVITINH DVT ON DC.DONVITINH_ID = DVT.DONVITINH_ID      left join TM_MAU_LOAIMAU ld on dc.LOAIMAU_ID = ld.LOAIMAU_ID      LEFT JOIN TM_MAU_NHOMMAU NM ON NM.NHOMMAU_ID = LD.NHOMMAU_ID]
2020-02-26 16:29:19,716 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN200102.0000252']
2020-02-26 16:29:19,789 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"5440","DVYEUCAU_ID":"988882"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"5440","DVYEUCAU_ID":"988882"}' order by ID desc)        order by A.ID desc]
2020-02-26 16:29:19,973 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN200102.0000252']
2020-02-26 16:29:19,996 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"5554","DVYEUCAU_ID":"988883"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"5554","DVYEUCAU_ID":"988883"}' order by ID desc)        order by A.ID desc]
2020-02-26 16:29:20,029 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN200102.0000252']
2020-02-26 16:29:20,053 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"4022","DVYEUCAU_ID":"989243"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"4022","DVYEUCAU_ID":"989243"}' order by ID desc)        order by A.ID desc]
2020-02-26 16:29:20,371 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN200102.0000252']
2020-02-26 16:29:20,437 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"4422","DVYEUCAU_ID":"989244"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"4422","DVYEUCAU_ID":"989244"}' order by ID desc)        order by A.ID desc]
2020-02-26 16:29:20,675 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN200102.0000252']
2020-02-26 16:29:20,704 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"4451","DVYEUCAU_ID":"989245"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"4451","DVYEUCAU_ID":"989245"}' order by ID desc)        order by A.ID desc]
2020-02-26 16:29:20,927 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN200102.0000252']
2020-02-26 16:29:20,953 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"4454","DVYEUCAU_ID":"989246"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"4454","DVYEUCAU_ID":"989246"}' order by ID desc)        order by A.ID desc]
2020-02-26 16:29:21,163 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN200102.0000252']
2020-02-26 16:29:21,216 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"4523","DVYEUCAU_ID":"989247"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"4523","DVYEUCAU_ID":"989247"}' order by ID desc)        order by A.ID desc]
2020-02-26 16:29:21,434 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN200102.0000252']
2020-02-26 16:29:21,457 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"4596","DVYEUCAU_ID":"989248"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"4596","DVYEUCAU_ID":"989248"}' order by ID desc)        order by A.ID desc]
2020-02-26 16:29:21,638 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN200102.0000252']
2020-02-26 16:29:21,796 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"4642","DVYEUCAU_ID":"989250"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"4642","DVYEUCAU_ID":"989250"}' order by ID desc)        order by A.ID desc]
2020-02-26 16:29:21,975 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN200102.0000252']
2020-02-26 16:29:22,092 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"4681","DVYEUCAU_ID":"989252"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"4681","DVYEUCAU_ID":"989252"}' order by ID desc)        order by A.ID desc]
2020-02-26 16:29:22,234 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN200102.0000252']
2020-02-26 16:29:22,258 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"4722","DVYEUCAU_ID":"989253"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"4722","DVYEUCAU_ID":"989253"}' order by ID desc)        order by A.ID desc]
2020-02-26 16:29:22,401 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN200102.0000252']
2020-02-26 16:29:22,425 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"4747","DVYEUCAU_ID":"989254"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"4747","DVYEUCAU_ID":"989254"}' order by ID desc)        order by A.ID desc]
2020-02-26 16:29:22,607 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN200102.0000252']
2020-02-26 16:29:22,654 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"5363","DVYEUCAU_ID":"992248"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"5363","DVYEUCAU_ID":"992248"}' order by ID desc)        order by A.ID desc]
2020-02-26 16:29:22,795 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN200102.0000252']
2020-02-26 16:29:22,819 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"5588","DVYEUCAU_ID":"992249"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"5588","DVYEUCAU_ID":"992249"}' order by ID desc)        order by A.ID desc]
2020-02-26 16:29:22,961 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN200102.0000252']
2020-02-26 16:29:22,986 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"477","DVYEUCAU_ID":"992250"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"477","DVYEUCAU_ID":"992250"}' order by ID desc)        order by A.ID desc]
2020-02-26 16:29:23,126 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN200102.0000252']
2020-02-26 16:29:23,149 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"5602","DVYEUCAU_ID":"992251"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"5602","DVYEUCAU_ID":"992251"}' order by ID desc)        order by A.ID desc]
2020-02-26 16:29:23,425 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN200102.0000252']
2020-02-26 16:29:23,448 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"3161","DVYEUCAU_ID":"992253"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"3161","DVYEUCAU_ID":"992253"}' order by ID desc)        order by A.ID desc]
2020-02-26 16:29:23,759 [1] DEBUG - Statement Id: [DAO00017_GetLoaiGiaDoiTuongDichVu] PreparedStatement : [select a.LOAIGIA_ID, a.TENLOAIGIA, a.MALOAIGIA, a.CAPTREN_ID, MIN(a.UUTIEN_NGUON) AS UUTIEN_NGUON          , MAX(a.DOUUTIEN) AS DOUUTIEN, MIN(ISNULL(a.GIAHOTRO,0)) AS GIAHOTRO          from(                        select distinct A.LOAIGIA_ID, C.TENLOAIGIA, C.MALOAIGIA, 0 as UUTIEN_NGUON, isnull(B.DOUUTIEN,0) as DOUUTIEN, B.GIAHOTRO, C.CAPTREN_ID            from TM_DOITUONG_GIADICHVU A            left join TM_DOITUONG_LOAIGIA B on A.LOAIGIA_ID = B.LOAIGIA_ID and A.DOITUONG_ID = B.DOITUONG_ID and B.BENHVIEN_ID = 'HLU01'            inner join TM_LOAIGIA C on A.LOAIGIA_ID = C.LOAIGIA_ID and C.BENHVIEN_ID = 'HLU01'            where A.DOITUONG_ID = '4'                            and C.CAPTREN_ID = (select LOAIGIA_ID from TM_LOAIGIA              where MALOAIGIA = 'GiaDichVu'              and BENHVIEN_ID = 'HLU01')                         and A.BENHVIEN_ID = 'HLU01'                     ) a          where a.DOUUTIEN != 0 and a.DOUUTIEN is not null          group by a.LOAIGIA_ID, a.TENLOAIGIA, a.MALOAIGIA, a.CAPTREN_ID          order by MAX(a.UUTIEN_NGUON) desc ,MAX(a.DOUUTIEN) asc]
2020-02-26 16:29:23,923 [1] DEBUG - Statement Id: [DAO00019_Get_TiepNhan_ThongtinChuyenVien] PreparedStatement : [select CHANDOANNGT, ICDNOIGIOITHIEU_ID, LYDOCHUYENVIEN_ID, NOIGIOITHIEU_ID, HINHTHUCCHUYENVIEN_ID, THOIGIANCHUYENTUYEN, SOCHUYENVIEN        from TT_TIEPNHAN        where TIEPNHAN_ID = '107181']
2020-02-26 16:29:23,970 [1] DEBUG - Statement Id: [DAO00019_GetBenhNhanThanhVien] PreparedStatement : [select A.*, B.TENTHETHANHVIEN, convert(varchar, A.NGAYHIEULUC, 103) as NGAYHIEULUCTHE, B.SOTIEN        from TT_CSKH_THANHVIEN_CAPTHE A        left join TM_CSKH_THETHANHVIEN B on B.THETHANHVIEN_ID = A.THETHANHVIEN_ID        where   THANHVIEN_ID in (        select THANHVIEN_ID from TT_CSKH_THANHVIEN        where (BENHNHAN_ID = '20633' and TAMNGUNG is null or TAMNGUNG = '0')        and (DAXOA is null or DAXOA = '0'))        and A.KICHHOAT = '1' and (A.TAMNGUNG = '0' or A.TAMNGUNG is null)                 and A.BENHVIEN_ID = 'HLU01'        order by THE_ID desc]
2020-02-26 16:29:23,993 [1] DEBUG - Statement Id: [DAO00019_GetBenhNhanThanhVien] PreparedStatement : [select A.*, B.TENTHETHANHVIEN, convert(varchar, A.NGAYHIEULUC, 103) as NGAYHIEULUCTHE, B.SOTIEN        from TT_CSKH_THANHVIEN_CAPTHE A        left join TM_CSKH_THETHANHVIEN B on B.THETHANHVIEN_ID = A.THETHANHVIEN_ID        where   THANHVIEN_ID in (        select THANHVIEN_ID from TT_CSKH_THANHVIEN        where (BENHNHAN_ID = '20633' and TAMNGUNG is null or TAMNGUNG = '0')        and (DAXOA is null or DAXOA = '0'))        and A.KICHHOAT = '1' and (A.TAMNGUNG = '0' or A.TAMNGUNG is null)                 and A.BENHVIEN_ID = 'HLU01'        order by THE_ID desc]
2020-02-26 16:29:30,328 [1] DEBUG - Statement Id: [DAO00017_GetLoaiGiaDoiTuongDichVu] PreparedStatement : [select a.LOAIGIA_ID, a.TENLOAIGIA, a.MALOAIGIA, a.CAPTREN_ID, MIN(a.UUTIEN_NGUON) AS UUTIEN_NGUON          , MAX(a.DOUUTIEN) AS DOUUTIEN, MIN(ISNULL(a.GIAHOTRO,0)) AS GIAHOTRO          from(                        select distinct A.LOAIGIA_ID, C.TENLOAIGIA, C.MALOAIGIA, 0 as UUTIEN_NGUON, isnull(B.DOUUTIEN,0) as DOUUTIEN, B.GIAHOTRO, C.CAPTREN_ID            from TM_DOITUONG_GIADICHVU A            left join TM_DOITUONG_LOAIGIA B on A.LOAIGIA_ID = B.LOAIGIA_ID and A.DOITUONG_ID = B.DOITUONG_ID and B.BENHVIEN_ID = 'HLU01'            inner join TM_LOAIGIA C on A.LOAIGIA_ID = C.LOAIGIA_ID and C.BENHVIEN_ID = 'HLU01'            where A.DOITUONG_ID = '4'                            and C.CAPTREN_ID = (select LOAIGIA_ID from TM_LOAIGIA              where MALOAIGIA = 'GiaDichVu'              and BENHVIEN_ID = 'HLU01')                         and A.BENHVIEN_ID = 'HLU01'                     ) a          where a.DOUUTIEN != 0 and a.DOUUTIEN is not null          group by a.LOAIGIA_ID, a.TENLOAIGIA, a.MALOAIGIA, a.CAPTREN_ID          order by MAX(a.UUTIEN_NGUON) desc ,MAX(a.DOUUTIEN) asc]
2020-02-26 16:29:30,624 [1] DEBUG - Statement Id: [DAO00017_GetLoaiGiaDuocByDoiTuongId] PreparedStatement : [select A.LOAIGIA_ID, C.TENLOAIGIA from TM_DOITUONG_LOAIGIA A          inner join TM_LOAIGIA C on A.LOAIGIA_ID = C.LOAIGIA_ID          where A.DOITUONG_ID = '4'          and C.CAPTREN_ID = (select LOAIGIA_ID from TM_LOAIGIA where MALOAIGIA = 'Giathuoc' and BENHVIEN_ID = 'HLU01')]
2020-02-26 16:29:32,986 [1] DEBUG - Statement Id: [DAO00017_GetLoaiGiaDoiTuongDichVu] PreparedStatement : [select a.LOAIGIA_ID, a.TENLOAIGIA, a.MALOAIGIA, a.CAPTREN_ID, MIN(a.UUTIEN_NGUON) AS UUTIEN_NGUON          , MAX(a.DOUUTIEN) AS DOUUTIEN, MIN(ISNULL(a.GIAHOTRO,0)) AS GIAHOTRO          from(                        select distinct A.LOAIGIA_ID, C.TENLOAIGIA, C.MALOAIGIA, 0 as UUTIEN_NGUON, isnull(B.DOUUTIEN,0) as DOUUTIEN, B.GIAHOTRO, C.CAPTREN_ID            from TM_DOITUONG_GIADICHVU A            left join TM_DOITUONG_LOAIGIA B on A.LOAIGIA_ID = B.LOAIGIA_ID and A.DOITUONG_ID = B.DOITUONG_ID and B.BENHVIEN_ID = 'HLU01'            inner join TM_LOAIGIA C on A.LOAIGIA_ID = C.LOAIGIA_ID and C.BENHVIEN_ID = 'HLU01'            where A.DOITUONG_ID = '4'                            and C.CAPTREN_ID = (select LOAIGIA_ID from TM_LOAIGIA              where MALOAIGIA = 'GiaDichVu'              and BENHVIEN_ID = 'HLU01')                         and A.BENHVIEN_ID = 'HLU01'                     ) a          where a.DOUUTIEN != 0 and a.DOUUTIEN is not null          group by a.LOAIGIA_ID, a.TENLOAIGIA, a.MALOAIGIA, a.CAPTREN_ID          order by MAX(a.UUTIEN_NGUON) desc ,MAX(a.DOUUTIEN) asc]
2020-02-26 16:29:33,116 [1] DEBUG - Statement Id: [DAO00017_GetLoaiGiaDuocByDoiTuongId] PreparedStatement : [select A.LOAIGIA_ID, C.TENLOAIGIA from TM_DOITUONG_LOAIGIA A          inner join TM_LOAIGIA C on A.LOAIGIA_ID = C.LOAIGIA_ID          where A.DOITUONG_ID = '4'          and C.CAPTREN_ID = (select LOAIGIA_ID from TM_LOAIGIA where MALOAIGIA = 'Giathuoc' and BENHVIEN_ID = 'HLU01')]
2020-02-26 16:29:39,887 [1] DEBUG - Statement Id: [DAO00017_GetLoaiGiaDoiTuongDichVu] PreparedStatement : [select a.LOAIGIA_ID, a.TENLOAIGIA, a.MALOAIGIA, a.CAPTREN_ID, MIN(a.UUTIEN_NGUON) AS UUTIEN_NGUON          , MAX(a.DOUUTIEN) AS DOUUTIEN, MIN(ISNULL(a.GIAHOTRO,0)) AS GIAHOTRO          from(                        select distinct A.LOAIGIA_ID, C.TENLOAIGIA, C.MALOAIGIA, 0 as UUTIEN_NGUON, isnull(B.DOUUTIEN,0) as DOUUTIEN, B.GIAHOTRO, C.CAPTREN_ID            from TM_DOITUONG_GIADICHVU A            left join TM_DOITUONG_LOAIGIA B on A.LOAIGIA_ID = B.LOAIGIA_ID and A.DOITUONG_ID = B.DOITUONG_ID and B.BENHVIEN_ID = 'HLU01'            inner join TM_LOAIGIA C on A.LOAIGIA_ID = C.LOAIGIA_ID and C.BENHVIEN_ID = 'HLU01'            where A.DOITUONG_ID = '4'                            and C.CAPTREN_ID = (select LOAIGIA_ID from TM_LOAIGIA              where MALOAIGIA = 'GiaDichVu'              and BENHVIEN_ID = 'HLU01')                         and A.BENHVIEN_ID = 'HLU01'                     ) a          where a.DOUUTIEN != 0 and a.DOUUTIEN is not null          group by a.LOAIGIA_ID, a.TENLOAIGIA, a.MALOAIGIA, a.CAPTREN_ID          order by MAX(a.UUTIEN_NGUON) desc ,MAX(a.DOUUTIEN) asc]
2020-02-26 16:29:43,466 [1] DEBUG - Statement Id: [DAO00017_GetLoaiGiaDoiTuongDichVu] PreparedStatement : [select a.LOAIGIA_ID, a.TENLOAIGIA, a.MALOAIGIA, a.CAPTREN_ID, MIN(a.UUTIEN_NGUON) AS UUTIEN_NGUON          , MAX(a.DOUUTIEN) AS DOUUTIEN, MIN(ISNULL(a.GIAHOTRO,0)) AS GIAHOTRO          from(                        select distinct A.LOAIGIA_ID, C.TENLOAIGIA, C.MALOAIGIA, 0 as UUTIEN_NGUON, isnull(B.DOUUTIEN,0) as DOUUTIEN, B.GIAHOTRO, C.CAPTREN_ID            from TM_DOITUONG_GIADICHVU A            left join TM_DOITUONG_LOAIGIA B on A.LOAIGIA_ID = B.LOAIGIA_ID and A.DOITUONG_ID = B.DOITUONG_ID and B.BENHVIEN_ID = 'HLU01'            inner join TM_LOAIGIA C on A.LOAIGIA_ID = C.LOAIGIA_ID and C.BENHVIEN_ID = 'HLU01'            where A.DOITUONG_ID = '4'                            and C.CAPTREN_ID = (select LOAIGIA_ID from TM_LOAIGIA              where MALOAIGIA = 'GiaDichVu'              and BENHVIEN_ID = 'HLU01')                         and A.BENHVIEN_ID = 'HLU01'                     ) a          where a.DOUUTIEN != 0 and a.DOUUTIEN is not null          group by a.LOAIGIA_ID, a.TENLOAIGIA, a.MALOAIGIA, a.CAPTREN_ID          order by MAX(a.UUTIEN_NGUON) desc ,MAX(a.DOUUTIEN) asc]
2020-02-26 17:05:08,330 [1] DEBUG - Statement Id: [DAO00020_ListKhoDuocOfPhongBan] PreparedStatement : [select B.* from TM_PHONGBAN_KHODUOC A        inner join TM_KHODUOC B on B.KHODUOC_ID = A.KHODUOC_ID        where        A.PHONGBAN_ID = '25'        and A.BENHVIEN_ID = 'HLU01']
2020-02-26 17:05:13,273 [1] DEBUG - Statement Id: [DAO00020_ListKhoDuocOfPhongBan] PreparedStatement : [select B.* from TM_PHONGBAN_KHODUOC A        inner join TM_KHODUOC B on B.KHODUOC_ID = A.KHODUOC_ID        where        A.PHONGBAN_ID = '62'        and A.BENHVIEN_ID = 'HLU01']
2020-02-26 17:05:14,521 [1] DEBUG - Statement Id: [DAO00008_UpdateUserIdPhongBanKhoDuoc] PreparedStatement : [IF EXISTS            (SELECT ACCOUNT_ID FROM TM_SYS_USERS WHERE ACCOUNT_ID =  @param0  and HOSPITAL_ID =  @param1 )            BEGIN            update TM_SYS_USERS set INVENTORY_ID =  @param2 , WORKING_DEPT_ID =  @param3             WHERE ACCOUNT_ID =  @param0  and HOSPITAL_ID =  @param1             END            ELSE            BEGIN            insert into TM_SYS_USERS ([ACCOUNT_ID], [ACCOUNT_NAME], [INVENTORY_ID], [WORKING_DEPT_ID], [HOSPITAL_ID])            values ( @param0 ,  @param4 ,  @param2 ,  @param3 ,  @param1 )            END]
2020-02-26 17:05:14,521 [1] DEBUG - Statement Id: [DAO00008_UpdateUserIdPhongBanKhoDuoc] Parameters: [@param0=[ACCOUNT_ID,113], @param1=[HOSPITAL_ID,HLU01], @param2=[INVENTORY_ID,32], @param3=[WORKING_DEPT_ID,62], @param4=[ACCOUNT_NAME,admin]]
2020-02-26 17:05:14,521 [1] DEBUG - Statement Id: [DAO00008_UpdateUserIdPhongBanKhoDuoc] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[String, System.String], @param3=[String, System.String], @param4=[String, System.String]]
2020-02-26 17:12:01,956 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'REG14'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 17:12:06,138 [1] DEBUG - Statement Id: [DAO00012_GetList] PreparedStatement : [select        DICTIONARY_ID,        DICTIONARY_CODE,        DICTIONARY_NAME,        ATTRIBUTE1,        ATTRIBUTE2,        DICTIONARY_NAME_EN,        DICTIONARY_TYPE_CODE        from LST_DICTIONARY        where LST_DICTIONARY.Enabled = '1'         AND           LST_DICTIONARY.DICTIONARY_TYPE_CODE = 'PhanLoaiTiepNhan'                 order by LST_DICTIONARY.IDX]
2020-02-26 17:12:06,169 [1] DEBUG - Statement Id: [DAO00012_GetList] PreparedStatement : [select        DICTIONARY_ID,        DICTIONARY_CODE,        DICTIONARY_NAME,        ATTRIBUTE1,        ATTRIBUTE2,        DICTIONARY_NAME_EN,        DICTIONARY_TYPE_CODE        from LST_DICTIONARY        where LST_DICTIONARY.Enabled = '1'         AND           LST_DICTIONARY.DICTIONARY_TYPE_CODE = 'NguonBN'                 order by LST_DICTIONARY.IDX]
2020-02-26 17:12:06,200 [1] DEBUG - Statement Id: [DAO00019_GetListCongTyChiTra] PreparedStatement : [select *        from TM_CONGTYCHITRA        where        BENHVIEN_ID = 'HLU01' AND TAMNGUNG = '0']
2020-02-26 17:12:06,491 [1] DEBUG - Statement Id: [DAO00017_GetListPhongKham] PreparedStatement : [select pb.PHONGBAN_ID, pb.TENPHONGBAN, case when dv.ATTRIBUTE5 is null then 'TT' else 'KTC' end as LOAI_CHIPHI              from [TM_PHONGBAN_DICHVU] as pb_dv              inner join [TM_PHONGBAN] as pb on pb.PHONGBAN_ID = pb_dv.PHONGBAN_ID and pb.BENHVIEN_ID = 'HLU01'              inner join [TM_DICHVU] dv on dv.DICHVU_ID = pb_dv.DICHVU_ID and dv.MADICHVU = '' and dv.BENHVIEN_ID = 'HLU01'              where pb_dv.BENHVIEN_ID = 'HLU01']
2020-02-26 17:12:06,532 [1] DEBUG - Statement Id: [DAO00019_GetListPhongKham_REG13] PreparedStatement : [select pb.PHONGBAN_ID, pb.TENPHONGBAN, case when dv.ATTRIBUTE5 is null then 'TT' else 'KTC' end as LOAI_CHIPHI        from TM_PHONGBAN pb        left join TM_PHONGBAN_DICHVU pb_dv on pb_dv.PHONGBAN_ID = pb.PHONGBAN_ID and pb_dv.BENHVIEN_ID = pb.BENHVIEN_ID        left join TM_DICHVU dv on dv.DICHVU_ID = pb_dv.DICHVU_ID and dv.BENHVIEN_ID = pb_dv.BENHVIEN_ID        left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID and ndv.BENHVIEN_ID = dv.BENHVIEN_ID        where pb.BENHVIEN_ID = 'HLU01' and ndv.MANHOMDICHVU = '04' and dv.DICHVU_ID IS NOT NULL]
2020-02-26 17:12:06,883 [1] DEBUG - Statement Id: [DAO00019_LayThongTinSoluongDichVuPhongKham_REG13] PreparedStatement : [select PHONGBAN_ID, TENPHONGBAN, NOITHUCHIEN_ID, SUM(CHUAKETQUA) AS CHUAKETQUA, SUM(HOANTAT) AS HOANTAT, SUM(DANGTHUCHIEN) AS DANGTHUCHIEN        from (        select B.PHONGBAN_ID, B.TENPHONGBAN, A.NOITHUCHIEN_ID,        case when A.TRANGTHAI = 'CHUAKETQUA' then 1 else 0 end AS CHUAKETQUA,        case when A.TRANGTHAI = 'HOANTAT' then 1 else 0 end AS HOANTAT,        case when A.TRANGTHAI = 'DANGTHUCHIEN' then 1 else 0 end AS DANGTHUCHIEN        from TM_PHONGBAN B        left join TT_DVYEUCAU A on A.NOITHUCHIEN_ID = B.PHONGBAN_ID and A.BENHVIEN_ID = B.BENHVIEN_ID and A.NGAYYEUCAU = CONVERT(date, getdate())        left join TM_DICHVU dv on A.DICHVU_ID = dv.DICHVU_ID        left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID        where B.BENHVIEN_ID ='HLU01' and Left(ndv.MANHOMDICHVU,2) = '04'        and B.PHONGBAN_ID in (65,71,72,41,177,55,57,57,69,69,70,70,58,58,59,59,60,60,61,61,63,63,81,62,62,67,68,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64)        ) tmp        group by tmp.NOITHUCHIEN_ID, tmp.TENPHONGBAN, tmp.PHONGBAN_ID]
2020-02-26 17:13:38,820 [1] DEBUG - Statement Id: [DAO00095_GetDetailTrungBN] PreparedStatement : [select  TT_TIEPNHAN.NGAYTIEPNHAN AS NGAYTIEPNHAN ,TT_TIEPNHAN.SOBHYT AS SOTHE, TT_BENHNHAN.*, ISNULL(TT_BENHNHAN.NGAYSINH,TT_BENHNHAN.NAMSINH) AS NGAYNAMSINH          from TT_BENHNHAN          left join TT_TIEPNHAN  ON          TT_TIEPNHAN.TIEPNHAN_ID = (SELECT TOP 1 TIEPNHAN_ID FROM TT_TIEPNHAN WHERE BENHNHAN_ID = TT_BENHNHAN.BENHNHAN_ID ORDER BY THOIGIANTIEPNHAN DESC)           WHERE                TT_BENHNHAN.TENBENHNHAN = N'Test Vp1'             AND               convert(varchar(10),TT_BENHNHAN.NGAYSINH, 103) = convert(varchar(10),'12/10/1998', 103)               AND               TT_BENHNHAN.GIOITINH = '2']
2020-02-26 17:14:29,875 [1] DEBUG - Statement Id: [DAO00019_GetLoaiGiaLoaiKhachHang] PreparedStatement : [select A.*, B.DICTIONARY_CODE MAKHACHHANG, C.TENLOAIGIA        from TM_NGUONKHACHHANG_LOAIGIA A        left join LST_DICTIONARY B on A.NGUONKHACHHANG_BENHNHAN_ID = B.DICTIONARY_ID        inner join TM_LOAIGIA C on C.LOAIGIA_ID = A.LOAIGIA_ID and CAPTREN_ID  = (select LOAIGIA_ID from TM_LOAIGIA where MALOAIGIA = 'GiaDichVu')        left join TM_DICHVU_DONGIA dvdg on dvdg.LOAIGIA_ID = A.LOAIGIA_ID        where B.DICTIONARY_TYPE_CODE = 'NguonKhachHang' and dvdg.DICHVU_ID  =  @param0]
2020-02-26 17:14:29,875 [1] DEBUG - Statement Id: [DAO00019_GetLoaiGiaLoaiKhachHang] Parameters: [@param0=[DICHVU_ID,5492]]
2020-02-26 17:14:29,875 [1] DEBUG - Statement Id: [DAO00019_GetLoaiGiaLoaiKhachHang] Types: [@param0=[Int64, System.Int64]]
2020-02-26 17:14:30,200 [1] DEBUG - Statement Id: [DAO00017_GetLoaiGiaDoiTuongDichVu] PreparedStatement : [select a.LOAIGIA_ID, a.TENLOAIGIA, a.MALOAIGIA, a.CAPTREN_ID, MIN(a.UUTIEN_NGUON) AS UUTIEN_NGUON          , MAX(a.DOUUTIEN) AS DOUUTIEN, MIN(ISNULL(a.GIAHOTRO,0)) AS GIAHOTRO          from(                        select distinct A.LOAIGIA_ID, C.TENLOAIGIA, C.MALOAIGIA, 0 as UUTIEN_NGUON, isnull(B.DOUUTIEN,0) as DOUUTIEN, B.GIAHOTRO, C.CAPTREN_ID            from TM_DOITUONG_GIADICHVU A            left join TM_DOITUONG_LOAIGIA B on A.LOAIGIA_ID = B.LOAIGIA_ID and A.DOITUONG_ID = B.DOITUONG_ID and B.BENHVIEN_ID = 'HLU01'            inner join TM_LOAIGIA C on A.LOAIGIA_ID = C.LOAIGIA_ID and C.BENHVIEN_ID = 'HLU01'            where A.DOITUONG_ID = '1'                            and A.DICHVU_ID = '5492'                         and A.BENHVIEN_ID = 'HLU01'                     ) a          where a.DOUUTIEN != 0 and a.DOUUTIEN is not null          group by a.LOAIGIA_ID, a.TENLOAIGIA, a.MALOAIGIA, a.CAPTREN_ID          order by MAX(a.UUTIEN_NGUON) desc ,MAX(a.DOUUTIEN) asc]
2020-02-26 17:14:30,499 [1] DEBUG - Statement Id: [DAO00017_GetListPhongKham] PreparedStatement : [select pb.PHONGBAN_ID, pb.TENPHONGBAN, case when dv.ATTRIBUTE5 is null then 'TT' else 'KTC' end as LOAI_CHIPHI              from [TM_PHONGBAN_DICHVU] as pb_dv              inner join [TM_PHONGBAN] as pb on pb.PHONGBAN_ID = pb_dv.PHONGBAN_ID and pb.BENHVIEN_ID = 'HLU01'              inner join [TM_DICHVU] dv on dv.DICHVU_ID = pb_dv.DICHVU_ID and dv.MADICHVU = '5492' and dv.BENHVIEN_ID = 'HLU01'              where pb_dv.BENHVIEN_ID = 'HLU01']
2020-02-26 17:14:30,673 [1] DEBUG - Statement Id: [DAO00019_GetListPhongKham_REG13] PreparedStatement : [select pb.PHONGBAN_ID, pb.TENPHONGBAN, case when dv.ATTRIBUTE5 is null then 'TT' else 'KTC' end as LOAI_CHIPHI        from TM_PHONGBAN pb        left join TM_PHONGBAN_DICHVU pb_dv on pb_dv.PHONGBAN_ID = pb.PHONGBAN_ID and pb_dv.BENHVIEN_ID = pb.BENHVIEN_ID        left join TM_DICHVU dv on dv.DICHVU_ID = pb_dv.DICHVU_ID and dv.BENHVIEN_ID = pb_dv.BENHVIEN_ID        left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID and ndv.BENHVIEN_ID = dv.BENHVIEN_ID        where pb.BENHVIEN_ID = 'HLU01' and ndv.MANHOMDICHVU = '04' and dv.DICHVU_ID IS NOT NULL]
2020-02-26 17:14:30,800 [1] DEBUG - Statement Id: [DAO00019_LayThongTinSoluongDichVuPhongKham_REG13] PreparedStatement : [select PHONGBAN_ID, TENPHONGBAN, NOITHUCHIEN_ID, SUM(CHUAKETQUA) AS CHUAKETQUA, SUM(HOANTAT) AS HOANTAT, SUM(DANGTHUCHIEN) AS DANGTHUCHIEN        from (        select B.PHONGBAN_ID, B.TENPHONGBAN, A.NOITHUCHIEN_ID,        case when A.TRANGTHAI = 'CHUAKETQUA' then 1 else 0 end AS CHUAKETQUA,        case when A.TRANGTHAI = 'HOANTAT' then 1 else 0 end AS HOANTAT,        case when A.TRANGTHAI = 'DANGTHUCHIEN' then 1 else 0 end AS DANGTHUCHIEN        from TM_PHONGBAN B        left join TT_DVYEUCAU A on A.NOITHUCHIEN_ID = B.PHONGBAN_ID and A.BENHVIEN_ID = B.BENHVIEN_ID and A.NGAYYEUCAU = CONVERT(date, getdate())        left join TM_DICHVU dv on A.DICHVU_ID = dv.DICHVU_ID        left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID        where B.BENHVIEN_ID ='HLU01' and Left(ndv.MANHOMDICHVU,2) = '04'        and B.PHONGBAN_ID in (65,71,72,41,177,55,57,57,69,69,70,70,58,58,59,59,60,60,61,61,63,63,81,62,62,67,68,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64)        ) tmp        group by tmp.NOITHUCHIEN_ID, tmp.TENPHONGBAN, tmp.PHONGBAN_ID]
2020-02-26 17:14:31,224 [1] DEBUG - Statement Id: [DAO00000_GetDICHVU_DONGIA_LOAIGIA] PreparedStatement : [select A.LOAIGIA_ID, A.BANGGIA_ID, A.GIAVON, A.TYLEVAT  as TYLE_VAT, A.TYLE_LOINHUAN,            A.DONGIA as DONGIA_DOANHTHU, NULL as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DICHVU_DONGIA A            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '5492' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.LOAIGIA_ID = '3' and A.DICHVU_ID = '5492'            union            select A.LOAIGIA_ID, null as BANGGIA_ID, null as GIAVON, null as TYLE_VAT, null as TYLE_LOINHUAN,            null as DONGIA_DOANHTHU, C.DONGIA as DONGIA_KHAC, isnull(D.MAPHANNHOMDICHVU, 'TT') as LOAI_CHIPHI            from TM_DOITUONG_GIADICHVU A            left join TM_DICHVU dv on dv.DICHVU_ID = A.DICHVU_ID            inner join TM_BANGGIA B on B.LOAIGIA_ID = A.LOAIGIA_ID AND B.BENHVIEN_ID = 'HLU01'            left join TM_DICHVU_DONGIA C on C.LOAIGIA_ID = A.LOAIGIA_ID AND C.BENHVIEN_ID = 'HLU01'            and C.BANGGIA_ID = B.BANGGIA_ID and C.DICHVU_ID = A.DICHVU_ID            left join (select B.MAPHANNHOMDICHVU, A.* from TM_DICHVU_PHANNHOMDICHVU A            inner join TM_PHANNHOMDICHVU B on  B.PHANNHOMDICHVU_ID = A.PHANNHOMDICHVU_ID            where A.DICHVU_ID = '5492' AND A.BENHVIEN_ID = 'HLU01') D on A.DICHVU_ID = D.DICHVU_ID            where A.DOITUONG_ID = '1'  and A.DICHVU_ID = '5492' and A.LOAIGIA_ID            in (select top 1 LOAIGIA_ID from TM_DOITUONG_LOAIGIA            where DOITUONG_ID = '1' and GIAHOTRO = '1'  AND BENHVIEN_ID = 'HLU01'            and LOAIGIA_ID            in (select LOAIGIA_ID from TM_BANGGIA            where LOAIBANGGIA in            (select LOAIBANGGIA from TM_BANGGIA where LOAIGIA_ID = '3'  AND BENHVIEN_ID = 'HLU01')            and TAMNGUNG = '0')  AND BENHVIEN_ID = 'HLU01'            and isnull(dv.TAMNGUNG, '0') = '0' and isnull(dv.BHYT, '0') = '1'            )]
2020-02-26 17:14:31,482 [1] DEBUG - Statement Id: [DAO00024_TM_TIEPNHAN_BANGGIA_DICHVU_getlist] PreparedStatement : [select * from TM_TIEPNHAN_BANGGIA_DICHVU where TAMNGUNG != '1' and BENHVIEN_ID = 'HLU01']
2020-02-26 17:14:31,545 [1] DEBUG - Statement Id: [DAO00024_LISTGIA_TT_TIEPNHAN_getngaytiepnhan] PreparedStatement : [select tndv.BANGGIA_ID, lg.MALOAIGIA, tndv.LOAIGIA_ID          from TM_TIEPNHAN_BANGGIA_DICHVU tndv          left join TM_LOAIGIA lg on lg.LOAIGIA_ID = tndv.LOAIGIA_ID          where cast(tndv.NGAYTIEPNHAN as date) >= (select top 1 cast(NGAYTIEPNHAN as date) from TT_TIEPNHAN where TIEPNHAN_ID = '0' and BENHVIEN_ID = 'HLU01')          and tndv.TAMNGUNG != '1' and tndv.BENHVIEN_ID = 'HLU01']
2020-02-26 17:14:41,204 [1] DEBUG - Statement Id: [DAO00013_Add_BenhNhan] PreparedStatement : [declare @keyValue int, @BenhVienId varchar(10), @yearNow int, @Mayte varchar(20), @SoVaoVien varchar(20), @fid varchar(20),        @Bnid int, @Manoisinh varchar(10), @Namsinh int, @Ngaysinh smalldatetime, @Gioitinh int, @Thangsinh int, @Daysinh int, @beginpatient int        declare @InsertedRows TABLE (BENHNHAN_ID INT, MAYTE varchar(20), MANOISINH varchar(10), NAMSINH int, NGAYSINH smalldatetime, GIOITINH int )        set @keyValue = 0;        set @Thangsinh = 0;        set @Daysinh = 0;        set @beginpatient = 0;        set @fid = 'F';        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())                select @beginpatient = isnull(VALUE, 0) from TM_SYS_APPSETTINGS where CODE = 'COM_FIRST_NUMBER_PATIENTCODE_INTHEYEAR'          select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'MAYTE' and KEYYEAR = @yearNow                if @keyValue = 0        Insert into LST_KEYDATA values ('MAYTE', @yearNow, '0', '0', '0', '0', '0', @beginpatient, @BenhVienId);        Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'MAYTE' and KEYYEAR = @yearNow                set @SoVaoVien = right('0000000'+convert(varchar(7), @keyValue), 7)        set @Mayte = RIGHT(@yearNow, 2) + @SoVaoVien                insert into TT_BENHNHAN (        MAYTE        , SOVAOVIEN        , TENBENHNHAN        , HO        , TEN        , GIOITINH        , NGAYSINH        , NAMSINH        , MANOISINH        , SONHA        , DIACHI        , SODIENTHOAI        , XAPHUONG_ID        , QUANHUYEN_ID        , TINHTHANH_ID        , DANTOC_ID        , QUOCTICH_ID        , SOLUUTRUNOITRU        , SOLUUTRUNGOAITRU        , NGHENGHIEP_ID        , CMND        , HOCHIEU        , VIETKIEU        , NGUOINUOCNGOAI        , DIACHITHUONGTRU        , DIACHILIENLAC        , DIACHICOQUAN        , EMAIL        , NHOMMAU_ID        , YEUTORH_ID        , TIENSUDIUNG        , TIENSUBENH        , TIENSUHUTTHUOCLA        , TUVONG        , NGAYTUVONG        , THOIGIANTUVONG        , NGUYENNHANTUVONG_ID        , NGUOIGHINHANTUVONG_ID        , THOIGIANGHINHANTUVONG        , NHANVIEN_ID        , DONVICONGTAC_ID        , DIENTHOAIBAN        , TINHTRANGHONNHAN_ID        , NGUOILIENHE_ID        , MOIQUANHE_ID        , NGUOILIENHE        , THONGTIN_NLH        , GHICHU        , HINHANH_DAIDIEN        , SITE_ID        , PID        , ACTIVE        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYGIOSINH        , TRINHDOVANHOA_ID        )                values (        @Mayte        , @SoVaoVien        ,  @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         , '1'        ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         );        set @Bnid = SCOPE_IDENTITY()                select @Manoisinh = MANOISINH, @Namsinh = NAMSINH, @Ngaysinh = NGAYSINH, @Gioitinh = GIOITINH from @InsertedRows;        IF (@Ngaysinh is not Null)        BEGIN        set @Thangsinh = MONTH(@Ngaysinh);        set @Daysinh = DAY(@Ngaysinh);        END        IF (@Manoisinh is Null) set @Manoisinh = '0'        set @fid = right('000'+convert(varchar(3), @Manoisinh), 3) + convert(varchar(1), @Gioitinh) + RIGHT(@Namsinh, 2) + right('00'+convert(varchar(2), @Thangsinh), 2) + right('00'+convert(varchar(2), @Daysinh), 2) + right('000000000'+convert(varchar(9), @Bnid), 9) + convert(varchar(1), 'F');                update TT_BENHNHAN set FID = @fid where BENHNHAN_ID = @Bnid;                select @Bnid]
2020-02-26 17:14:41,204 [1] DEBUG - Statement Id: [DAO00013_Add_BenhNhan] Parameters: [@param0=[TENBENHNHAN,Test Vp1], @param1=[HO,Test], @param2=[TEN,Vp1], @param3=[GIOITINH,2], @param4=[NGAYSINH,10/12/1998 12:00:00 AM], @param5=[NAMSINH,1998], @param6=[MANOISINH,null], @param7=[SONHA,null], @param8=[DIACHI,null], @param9=[SODIENTHOAI,null], @param10=[XAPHUONG_ID,16435], @param11=[QUANHUYEN_ID,null], @param12=[TINHTHANH_ID,null], @param13=[DANTOC_ID,332], @param14=[QUOCTICH_ID,291], @param15=[SOLUUTRUNOITRU,null], @param16=[SOLUUTRUNGOAITRU,null], @param17=[NGHENGHIEP_ID,null], @param18=[CMND,null], @param19=[HOCHIEU,null], @param20=[VIETKIEU,null], @param21=[NGUOINUOCNGOAI,null], @param22=[DIACHITHUONGTRU,Xã Đông Hưng, Thành phố Thanh Hóa, Tỉnh Thanh Hóa], @param23=[DIACHILIENLAC,Xã Đông Hưng, Thành phố Thanh Hóa, Tỉnh Thanh Hóa], @param24=[DIACHICOQUAN,null], @param25=[EMAIL,null], @param26=[NHOMMAU_ID,null], @param27=[YEUTORH_ID,null], @param28=[TIENSUDIUNG,null], @param29=[TIENSUBENH,null], @param30=[TIENSUHUTTHUOCLA,null], @param31=[TUVONG,null], @param32=[NGAYTUVONG,null], @param33=[THOIGIANTUVONG,null], @param34=[NGUYENNHANTUVONG_ID,null], @param35=[NGUOIGHINHANTUVONG_ID,null], @param36=[THOIGIANGHINHANTUVONG,null], @param37=[NHANVIEN_ID,null], @param38=[DONVICONGTAC_ID,null], @param39=[DIENTHOAIBAN,null], @param40=[TINHTRANGHONNHAN_ID,null], @param41=[NGUOILIENHE_ID,null], @param42=[MOIQUANHE_ID,null], @param43=[NGUOILIENHE,null], @param44=[THONGTIN_NLH,null], @param45=[GHICHU,null], @param46=[HINHANH_DAIDIEN,imgFemale.png], @param47=[SITE_ID,HLU01], @param48=[PID,null], @param49=[BENHVIEN_ID,HLU01], @param50=[NGAYTAO,2/26/2020 5:14:41 PM], @param51=[NGUOITAO_ID,1], @param52=[NGAYGIOSINH,null], @param53=[TRINHDOVANHOA_ID,null]]
2020-02-26 17:14:41,204 [1] DEBUG - Statement Id: [DAO00013_Add_BenhNhan] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[String, System.String], @param3=[Int64, System.Int64], @param4=[DateTime, System.DateTime], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[System.DBNull, null], @param8=[System.DBNull, null], @param9=[System.DBNull, null], @param10=[String, System.String], @param11=[System.DBNull, null], @param12=[System.DBNull, null], @param13=[Int64, System.Int64], @param14=[Int64, System.Int64], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[System.DBNull, null], @param22=[String, System.String], @param23=[String, System.String], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[System.DBNull, null], @param39=[System.DBNull, null], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[String, System.String], @param47=[String, System.String], @param48=[System.DBNull, null], @param49=[String, System.String], @param50=[DateTime, System.DateTime], @param51=[String, System.String], @param52=[System.DBNull, null], @param53=[System.DBNull, null]]
2020-02-26 17:14:42,032 [1] DEBUG - Statement Id: [DAO00013_GetTTBenhNhan_byBenhNhanId] PreparedStatement : [select *        from TT_BENHNHAN        where BENHNHAN_ID = '74322'        order by BENHNHAN_ID]
2020-02-26 17:14:42,064 [1] DEBUG - Statement Id: [DAO00013_GetBenhNhanToDB] PreparedStatement : [select ROW_NUMBER() OVER(order by a.MAYTE) as ROWNUMBER, *,        CASE        WHEN A.GIOITINH = 1 THEN 'Nam'        WHEN A.GIOITINH = 2 THEN N'Nữ'        END as TENGIOITINH        from TT_BENHNHAN A        where  ACTIVE = '1' and MAYTE = '200000439']
2020-02-26 17:14:43,054 [1] DEBUG - Statement Id: [DAO00118_Add_BenhNhan] PreparedStatement : [if not exists (select 1 from TT_BENHNHAN where BENHNHAN_ID = '74322')              insert into TT_BENHNHAN (              BENHNHAN_ID              , MAYTE              , SOVAOVIEN              , TENBENHNHAN              , HO              , TEN              , GIOITINH              , NGAYSINH              , NAMSINH              , SONHA              , DIACHI              , SODIENTHOAI              , XAPHUONG_ID              , QUANHUYEN_ID              , TINHTHANH_ID              , DANTOC_ID              , QUOCTICH_ID              , SOLUUTRUNOITRU              , SOLUUTRUNGOAITRU              , NGHENGHIEP_ID              , CMND              , HOCHIEU              , VIETKIEU              , NGUOINUOCNGOAI              , DIACHITHUONGTRU              , DIACHILIENLAC              , DIACHICOQUAN              , EMAIL              , NHOMMAU_ID              , YEUTORH_ID              , TIENSUDIUNG              , TIENSUBENH              , TIENSUHUTTHUOCLA              , TUVONG              , NGAYTUVONG              , THOIGIANTUVONG              , NGUYENNHANTUVONG_ID              , NGUOIGHINHANTUVONG_ID              , THOIGIANGHINHANTUVONG              , NHANVIEN_ID              , DONVICONGTAC_ID              , DIENTHOAIBAN              , TINHTRANGHONNHAN_ID              , NGUOILIENHE_ID              , MOIQUANHE_ID              , NGUOILIENHE              , THONGTIN_NLH              , GHICHU              , HINHANH_DAIDIEN              , BENHVIEN_ID              , NGAYTAO              , NGUOITAO_ID              , NGAYGIOSINH              ) values (               @param0               ,  @param1               ,  @param2               ,  @param3               ,  @param4               ,  @param5               ,  @param6               ,  @param7               ,  @param8               ,  @param9               ,  @param10               ,  @param11               ,  @param12               ,  @param13               ,  @param14               ,  @param15               ,  @param16               ,  @param17               ,  @param18               ,  @param19               ,  @param20               ,  @param21               ,  @param22               ,  @param23               ,  @param24               ,  @param25               ,  @param26               ,  @param27               ,  @param28               ,  @param29               ,  @param30               ,  @param31               ,  @param32               ,  @param33               ,  @param34               ,  @param35               ,  @param36               ,  @param37               ,  @param38               ,  @param39               ,  @param40               ,  @param41               ,  @param42               ,  @param43               ,  @param44               ,  @param45               ,  @param46               ,  @param47               ,  @param48               ,  @param49               ,  @param50               ,  @param51               ,  @param52               )              else              update TT_BENHNHAN set              MAYTE =  @param1                ,                   SOVAOVIEN =  @param2                ,                   TENBENHNHAN =  @param3                ,                   HO =  @param4                ,                   TEN =  @param5                ,                   GIOITINH =  @param6                ,                   NGAYSINH =  @param7                ,                   NAMSINH =  @param8                ,                   SONHA =  @param9                ,                   SODIENTHOAI =  @param11                ,                   XAPHUONG_ID =  @param12                ,                   DANTOC_ID =  @param15                ,                   QUOCTICH_ID =  @param16                ,                   NGHENGHIEP_ID =  @param19                ,                   NGUOINUOCNGOAI =  @param23                ,                   DIACHITHUONGTRU =  @param24                ,                   DIACHILIENLAC =  @param25                ,                   NGUOILIENHE_ID =  @param43                ,                   MOIQUANHE_ID =  @param44                ,                   NGUOILIENHE =  @param45                ,                   THONGTIN_NLH =  @param46                ,                   GHICHU =  @param47                ,                   BENHVIEN_ID =  @param49                ,                   NGUOICAPNHAT_ID =  @param53                              where              BENHNHAN_ID = '74322']
2020-02-26 17:14:43,054 [1] DEBUG - Statement Id: [DAO00118_Add_BenhNhan] Parameters: [@param0=[BENHNHAN_ID,74322], @param1=[MAYTE,200000439], @param2=[SOVAOVIEN,0000439], @param3=[TENBENHNHAN,Test Vp1], @param4=[HO,Test], @param5=[TEN,Vp1], @param6=[GIOITINH,2], @param7=[NGAYSINH,10/12/1998 12:00:00 AM], @param8=[NAMSINH,1998], @param9=[SONHA,null], @param10=[DIACHI,null], @param11=[SODIENTHOAI,null], @param12=[XAPHUONG_ID,16435], @param13=[QUANHUYEN_ID,null], @param14=[TINHTHANH_ID,null], @param15=[DANTOC_ID,332], @param16=[QUOCTICH_ID,291], @param17=[SOLUUTRUNOITRU,null], @param18=[SOLUUTRUNGOAITRU,null], @param19=[NGHENGHIEP_ID,null], @param20=[CMND,null], @param21=[HOCHIEU,null], @param22=[VIETKIEU,null], @param23=[NGUOINUOCNGOAI,null], @param24=[DIACHITHUONGTRU,Xã Đông Hưng, Thành phố Thanh Hóa, Tỉnh Thanh Hóa], @param25=[DIACHILIENLAC,Xã Đông Hưng, Thành phố Thanh Hóa, Tỉnh Thanh Hóa], @param26=[DIACHICOQUAN,null], @param27=[EMAIL,null], @param28=[NHOMMAU_ID,null], @param29=[YEUTORH_ID,null], @param30=[TIENSUDIUNG,null], @param31=[TIENSUBENH,null], @param32=[TIENSUHUTTHUOCLA,null], @param33=[TUVONG,null], @param34=[NGAYTUVONG,null], @param35=[THOIGIANTUVONG,null], @param36=[NGUYENNHANTUVONG_ID,null], @param37=[NGUOIGHINHANTUVONG_ID,null], @param38=[THOIGIANGHINHANTUVONG,null], @param39=[NHANVIEN_ID,null], @param40=[DONVICONGTAC_ID,null], @param41=[DIENTHOAIBAN,null], @param42=[TINHTRANGHONNHAN_ID,null], @param43=[NGUOILIENHE_ID,null], @param44=[MOIQUANHE_ID,null], @param45=[NGUOILIENHE,null], @param46=[THONGTIN_NLH,null], @param47=[GHICHU,null], @param48=[HINHANH_DAIDIEN,imgFemale.png], @param49=[BENHVIEN_ID,HLU01], @param50=[NGAYTAO,null], @param51=[NGUOITAO_ID,1], @param52=[NGAYGIOSINH,null], @param53=[NGUOICAPNHAT_ID,1]]
2020-02-26 17:14:43,054 [1] DEBUG - Statement Id: [DAO00118_Add_BenhNhan] Types: [@param0=[Int32, System.Int32], @param1=[String, System.String], @param2=[String, System.String], @param3=[String, System.String], @param4=[String, System.String], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[DateTime, System.DateTime], @param8=[Int64, System.Int64], @param9=[System.DBNull, null], @param10=[System.DBNull, null], @param11=[System.DBNull, null], @param12=[String, System.String], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[Int64, System.Int64], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[System.DBNull, null], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[System.DBNull, null], @param39=[System.DBNull, null], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[String, System.String], @param49=[String, System.String], @param50=[System.DBNull, null], @param51=[String, System.String], @param52=[System.DBNull, null], @param53=[String, System.String]]
2020-02-26 17:14:43,353 [1] DEBUG - Statement Id: [DAOWF001_Laythongtingateways] PreparedStatement : [select * from TM_PROCESS_GATEWAYS]
2020-02-26 17:14:43,671 [1] DEBUG - Statement Id: [DAO00019_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10),        @yearNow int, @monthNow varchar(2), @dayNow varchar(2),        @Sotiepnhan varchar(20), @SoThuTu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @monthNow = RIGHT('00' + convert(varchar(2), MONTH(getdate())),2)        set @dayNow = RIGHT('00' + convert(varchar(2), DAY(getdate())),2)        BEGIN        select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOTIEPNHAN' and KEYYEAR = @yearNow and KEYMONTH = @monthNow and KEYDAY = @dayNow        and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOTIEPNHAN', @yearNow, @monthNow, @dayNow, '0', '0', '0', 0, @BenhVienId);        Update LST_KEYDATA set KEYVALUE = (KEYVALUE + 1), @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOTIEPNHAN' and KEYYEAR = @yearNow and KEYMONTH = @monthNow and KEYDAY = @dayNow and BENHVIEN_ID = @BenhVienId        set @SoThuTu = right('0000000'+convert(varchar(7), @keyValue), 7)        set @Sotiepnhan = 'TN' + RIGHT(@yearNow, 2) + @monthNow  + @dayNow + '.' + @SoThuTu                   insert into TT_TIEPNHAN (        SOTIEPNHAN        , UUTIEN        , BENHNHAN_ID        , BENHVIEN_ID        , TUYENKHAMBENH_ID        , NOITIEPNHAN_ID        , NGAYTIEPNHAN        , THOIGIANTIEPNHAN        , NAMTIEPNHAN        , THANGTIEPNHAN        , DOITUONG_ID        , LYDOTIEPNHAN_ID        , HINHTHUCDENKHAM_ID        , TINHTRANGHEN        , XACNHANCHIPHI_ID        , THUTIENTRUOC        , TAIKHAM        , SOBHYT        , BHYTTUNGAY        , BHYTDENNGAY        , BHYTNGAYCAP        , BHYTTREN3NAM        , BHYTTREN5NAM        , NGAYMIENDONGCHITRA        , LOAIBHYT        , NGAYBHYT2        , SOCHUYENVIEN        , HINHTHUCCHUYENVIEN_ID        , NOIGIOITHIEU_ID        , NGUOIGIOITHIEU_ID        , THOIGIANCHUYENTUYEN        , LYDOCHUYENVIEN_ID        , ICDNOIGIOITHIEU_ID        , CHANDOANNGT        , TRAITUYEN        , DIACHILIENHE        , XAPHUONG_ID        , QUANHUYEN_ID        , TINHTHANH_ID        , PROCESS_ID        , TRANGTHAI        , KHUVUCSONG_ID        , THANHVIEN_ID        , THE_ID        , LOAITHANHVIEN_ID        , SUDUNG_BHTN        , VIP        , GHICHU_TIEPNHAN        , BAOLANH_VIENPHI        , CONGTY_CHITRA_ID        , NGUON_BENHNHAN_ID        , LOAITIEPNHAN_ID        , THONGTIN_KCB_BHYT        , NGAYTAO        , NGUOITAO_ID        , LYDODENKHAM         ,           NGUOINUOCNGOAI         ,           ISTHONGTUYEN                 , TENNGUOIGIOITHIEU        , GIOITHIEUBENNGOAI                 )        OUTPUT INSERTED.TIEPNHAN_ID, INSERTED.SOTIEPNHAN        values (        @Sotiepnhan        ,  @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54          ,            @param55          ,            @param56                  ,  @param57         ,  @param58                  )        end]
2020-02-26 17:14:43,671 [1] DEBUG - Statement Id: [DAO00019_Add] Parameters: [@param0=[UUTIEN,0], @param1=[BENHNHAN_ID,74322], @param2=[BENHVIEN_ID,HLU01], @param3=[TUYENKHAMBENH_ID,null], @param4=[NOITIEPNHAN_ID,62], @param5=[NGAYTIEPNHAN,2/26/2020 12:00:00 AM], @param6=[THOIGIANTIEPNHAN,2/26/2020 5:12:06 PM], @param7=[NAMTIEPNHAN,2020], @param8=[THANGTIEPNHAN,2], @param9=[DOITUONG_ID,1], @param10=[LYDOTIEPNHAN_ID,null], @param11=[HINHTHUCDENKHAM_ID,461], @param12=[TINHTRANGHEN,null], @param13=[XACNHANCHIPHI_ID,null], @param14=[THUTIENTRUOC,null], @param15=[TAIKHAM,0], @param16=[SOBHYT,null], @param17=[BHYTTUNGAY,null], @param18=[BHYTDENNGAY,null], @param19=[BHYTNGAYCAP,null], @param20=[BHYTTREN3NAM,0], @param21=[BHYTTREN5NAM,0], @param22=[NGAYMIENDONGCHITRA,null], @param23=[LOAIBHYT,null], @param24=[NGAYBHYT2,null], @param25=[SOCHUYENVIEN,], @param26=[HINHTHUCCHUYENVIEN_ID,null], @param27=[NOIGIOITHIEU_ID,null], @param28=[NGUOIGIOITHIEU_ID,null], @param29=[THOIGIANCHUYENTUYEN,null], @param30=[LYDOCHUYENVIEN_ID,null], @param31=[ICDNOIGIOITHIEU_ID,null], @param32=[CHANDOANNGT,], @param33=[TRAITUYEN,0], @param34=[DIACHILIENHE,null], @param35=[XAPHUONG_ID,16435], @param36=[QUANHUYEN_ID,null], @param37=[TINHTHANH_ID,null], @param38=[PROCESS_ID,P01], @param39=[TRANGTHAI,DATIEPNHAN], @param40=[KHUVUCSONG_ID,null], @param41=[THANHVIEN_ID,null], @param42=[THE_ID,null], @param43=[LOAITHANHVIEN_ID,null], @param44=[SUDUNG_BHTN,0], @param45=[VIP,0], @param46=[GHICHU_TIEPNHAN,null], @param47=[BAOLANH_VIENPHI,0], @param48=[CONGTY_CHITRA_ID,null], @param49=[NGUON_BENHNHAN_ID,null], @param50=[LOAITIEPNHAN_ID,8351], @param51=[THONGTIN_KCB_BHYT,null], @param52=[NGAYTAO,2/26/2020 5:14:43 PM], @param53=[NGUOITAO_ID,1], @param54=[LYDODENKHAM,null], @param55=[NGUOINUOCNGOAI,null], @param56=[ISTHONGTUYEN,0], @param57=[TENNGUOIGIOITHIEU,null], @param58=[GIOITHIEUBENNGOAI,null]]
2020-02-26 17:14:43,671 [1] DEBUG - Statement Id: [DAO00019_Add] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[String, System.String], @param3=[System.DBNull, null], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[DateTime, System.DateTime], @param7=[Int32, System.Int32], @param8=[Int32, System.Int32], @param9=[Int64, System.Int64], @param10=[System.DBNull, null], @param11=[Int64, System.Int64], @param12=[System.DBNull, null], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[String, System.String], @param21=[String, System.String], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[String, System.String], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[String, System.String], @param33=[String, System.String], @param34=[System.DBNull, null], @param35=[String, System.String], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[String, System.String], @param45=[String, System.String], @param46=[System.DBNull, null], @param47=[String, System.String], @param48=[System.DBNull, null], @param49=[System.DBNull, null], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[DateTime, System.DateTime], @param53=[String, System.String], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[String, System.String], @param57=[System.DBNull, null], @param58=[System.DBNull, null]]
2020-02-26 17:14:45,197 [1] DEBUG - Statement Id: [DAO00019_GetTTTiepNhan_byTiepNhanId] PreparedStatement : [select *        from TT_TIEPNHAN        where TIEPNHAN_ID = '107438'        order by TIEPNHAN_ID]
2020-02-26 17:14:45,225 [1] DEBUG - Statement Id: [DAO00080_Add_KhamBenh_CapCuu] PreparedStatement : [insert into TT_KHAMBENH_VAOVIEN (        SOPHIEU        , TIEPNHAN_ID        , KHAMBENH_ID        , BENHNHAN_ID        , NGUOILIENHE        , DIENTHOAILIENHE        , NOILAMVIEC        , CHANDOANNOIGIOITHIEU        , NGAYKHAM        , THOIGIANKHAM        , LYDOVAOVIEN        , QUATRINHBENHLY        , TIENSUBANTHAN        , TIENSUGIADINH        , KHAMXETTOANTHAN        , KHAMXETCACBOPHAN        , KHAMXETKQLS        , CHANDOANVAO        , ICDKHAMXET_ID        , DAXULY        , NGAYRA        , THOIGIANRA        , NHAPKHOA_ID        , CHUYENVIEN_ID        , CHUY        , MACH        , NHIETDO        , HUYETAPCAO        , HUYETAPTHAP        , NHIPTHO        , CANNANG        , CHIEUCAO        , BACSI_ID        , XUTRUKHAMBENH_ID        , CAPCUU        , NGAYTAINAN        , THOIGIANTAINAN        , NOITAINAN_TINHTHANH_ID        , NOITAINAN_QUANHUYEN_ID        , NOITAINAN_PHUONGXA_ID        , NOITAINAN_DIACHI        , DIADIEMTAINAN_ID        , BOPHANBITHUONG_ID        , MUCDO_ID        , DIENBIENSAUTN_ID        , XUTRISAUTN_ID        , NGUYENNHAN_ID        , NGUYENNHANCHITIET_ID        , ICD_NGUYENNHAN        , NGAYTAO        , NGUOITAO_ID        , NGAYCAPNHAT        , NGUOICAPNHAT_ID        , BENHANCHUYENKHOA        , CHANDOANVAOVIEN        , CHANDOANRAVIEN        , DIEUTRITUNGAY        , DIEUTRIDENNGAY        , DIENBIENLS        , KQXETNGHIEM        , PHAUTHUAT        , THUTHUAT        , TINHTRANGNGUOIBENH        , HUONGDIEUTRI        , NGUOIGIAO_ID        , NGUOINHAN_ID        , XQUANG        , CTSCANNER        , SIEUAM        , XETNGHIEM        , KHAC        , TOANBOHS        , LOAICHUYENKHOA        , CONGANCANTHIEP        , CDRR_BENHCHINH        , CDRR_BENHKEM        , ICD_BENHCHINH        , ICD_BENHKEMTHEO        , PHUONGPHAPDIEUTRI        , FIELD_1        , FIELD_2        , FIELD_3        , FIELD_4        , FIELD_5        , FIELD_6        , FIELD_7        , FIELD_8        , FIELD_9        , FIELD_10        , FIELD_11        , FIELD_12        , FIELD_13        , FIELD_14        , FIELD_15        , FIELD_27        , FIELD_28        , FIELD_29        , FIELD_30        , FIELD_31        , FIELD_32        , FIELD_33        , FIELD_34        , FIELD_35        , FIELD_36        , FIELD_37        , FIELD_38        , FIELD_39        , FIELD_40        , FIELD_41        , FIELD_42        , FIELD_43        , FIELD_44        , FIELD_45        , FIELD_46        , FIELD_47        , FIELD_48        , FIELD_49        , FIELD_50        , FIELD_51        , FIELD_52        , FIELD_53        , FIELD_54        , FIELD_55        , FIELD_56        , BENHVIEN_ID        ) values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77         ,  @param78         ,  @param79         ,  @param80         ,  @param81         ,  @param82         ,  @param83         ,  @param84         ,  @param85         ,  @param86         ,  @param87         ,  @param88         ,  @param89         ,  @param90         ,  @param91         ,  @param92         ,  @param93         ,  @param94         ,  @param95         ,  @param96         ,  @param97         ,  @param98         ,  @param99         ,  @param100         ,  @param101         ,  @param102         ,  @param103         ,  @param104         ,  @param105         ,  @param106         ,  @param107         ,  @param108         ,  @param109         ,  @param110         ,  @param111         ,  @param112         ,  @param113         ,  @param114         ,  @param115         ,  @param116         ,  @param117         ,  @param118         ,  @param119         ,  @param120         ,  @param121         ,  @param122         ,  @param123         ,  @param124         )]
2020-02-26 17:14:45,226 [1] DEBUG - Statement Id: [DAO00080_Add_KhamBenh_CapCuu] Parameters: [@param0=[SOPHIEU,null], @param1=[TIEPNHAN_ID,107438], @param2=[KHAMBENH_ID,null], @param3=[BENHNHAN_ID,74322], @param4=[NGUOILIENHE,null], @param5=[DIENTHOAILIENHE,null], @param6=[NOILAMVIEC,null], @param7=[CHANDOANNOIGIOITHIEU,null], @param8=[NGAYKHAM,2/26/2020 12:00:00 AM], @param9=[THOIGIANKHAM,2/26/2020 5:12:06 PM], @param10=[LYDOVAOVIEN,null], @param11=[QUATRINHBENHLY,null], @param12=[TIENSUBANTHAN,null], @param13=[TIENSUGIADINH,null], @param14=[KHAMXETTOANTHAN,null], @param15=[KHAMXETCACBOPHAN,null], @param16=[KHAMXETKQLS,null], @param17=[CHANDOANVAO,null], @param18=[ICDKHAMXET_ID,null], @param19=[DAXULY,null], @param20=[NGAYRA,null], @param21=[THOIGIANRA,null], @param22=[NHAPKHOA_ID,62], @param23=[CHUYENVIEN_ID,null], @param24=[CHUY,null], @param25=[MACH,null], @param26=[NHIETDO,null], @param27=[HUYETAPCAO,null], @param28=[HUYETAPTHAP,null], @param29=[NHIPTHO,null], @param30=[CANNANG,null], @param31=[CHIEUCAO,null], @param32=[BACSI_ID,null], @param33=[XUTRUKHAMBENH_ID,null], @param34=[CAPCUU,null], @param35=[NGAYTAINAN,null], @param36=[THOIGIANTAINAN,null], @param37=[NOITAINAN_TINHTHANH_ID,null], @param38=[NOITAINAN_QUANHUYEN_ID,null], @param39=[NOITAINAN_PHUONGXA_ID,null], @param40=[NOITAINAN_DIACHI,null], @param41=[DIADIEMTAINAN_ID,null], @param42=[BOPHANBITHUONG_ID,null], @param43=[MUCDO_ID,null], @param44=[DIENBIENSAUTN_ID,null], @param45=[XUTRISAUTN_ID,null], @param46=[NGUYENNHAN_ID,null], @param47=[NGUYENNHANCHITIET_ID,null], @param48=[ICD_NGUYENNHAN,null], @param49=[NGAYTAO,2/26/2020 5:14:45 PM], @param50=[NGUOITAO_ID,1], @param51=[NGAYCAPNHAT,2/26/2020 5:14:45 PM], @param52=[NGUOICAPNHAT_ID,1], @param53=[BENHANCHUYENKHOA,null], @param54=[CHANDOANVAOVIEN,null], @param55=[CHANDOANRAVIEN,null], @param56=[DIEUTRITUNGAY,null], @param57=[DIEUTRIDENNGAY,null], @param58=[DIENBIENLS,null], @param59=[KQXETNGHIEM,null], @param60=[PHAUTHUAT,null], @param61=[THUTHUAT,null], @param62=[TINHTRANGNGUOIBENH,null], @param63=[HUONGDIEUTRI,null], @param64=[NGUOIGIAO_ID,null], @param65=[NGUOINHAN_ID,null], @param66=[XQUANG,null], @param67=[CTSCANNER,null], @param68=[SIEUAM,null], @param69=[XETNGHIEM,null], @param70=[KHAC,null], @param71=[TOANBOHS,null], @param72=[LOAICHUYENKHOA,null], @param73=[CONGANCANTHIEP,null], @param74=[CDRR_BENHCHINH,null], @param75=[CDRR_BENHKEM,null], @param76=[ICD_BENHCHINH,null], @param77=[ICD_BENHKEMTHEO,null], @param78=[PHUONGPHAPDIEUTRI,null], @param79=[FIELD_1,null], @param80=[FIELD_2,null], @param81=[FIELD_3,null], @param82=[FIELD_4,null], @param83=[FIELD_5,null], @param84=[FIELD_6,null], @param85=[FIELD_7,null], @param86=[FIELD_8,null], @param87=[FIELD_9,null], @param88=[FIELD_10,null], @param89=[FIELD_11,null], @param90=[FIELD_12,null], @param91=[FIELD_13,null], @param92=[FIELD_14,null], @param93=[FIELD_15,null], @param94=[FIELD_27,null], @param95=[FIELD_28,null], @param96=[FIELD_29,null], @param97=[FIELD_30,null], @param98=[FIELD_31,null], @param99=[FIELD_32,null], @param100=[FIELD_33,null], @param101=[FIELD_34,null], @param102=[FIELD_35,null], @param103=[FIELD_36,null], @param104=[FIELD_37,null], @param105=[FIELD_38,null], @param106=[FIELD_39,null], @param107=[FIELD_40,null], @param108=[FIELD_41,null], @param109=[FIELD_42,null], @param110=[FIELD_43,null], @param111=[FIELD_44,null], @param112=[FIELD_45,null], @param113=[FIELD_46,null], @param114=[FIELD_47,null], @param115=[FIELD_48,null], @param116=[FIELD_49,null], @param117=[FIELD_50,null], @param118=[FIELD_51,null], @param119=[FIELD_52,null], @param120=[FIELD_53,null], @param121=[FIELD_54,null], @param122=[FIELD_55,null], @param123=[FIELD_56,null], @param124=[BENHVIEN_ID,HLU01]]
2020-02-26 17:14:45,226 [1] DEBUG - Statement Id: [DAO00080_Add_KhamBenh_CapCuu] Types: [@param0=[System.DBNull, null], @param1=[Int32, System.Int32], @param2=[System.DBNull, null], @param3=[Int32, System.Int32], @param4=[System.DBNull, null], @param5=[System.DBNull, null], @param6=[System.DBNull, null], @param7=[System.DBNull, null], @param8=[DateTime, System.DateTime], @param9=[DateTime, System.DateTime], @param10=[System.DBNull, null], @param11=[System.DBNull, null], @param12=[System.DBNull, null], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[System.DBNull, null], @param22=[String, System.String], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[System.DBNull, null], @param39=[System.DBNull, null], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[DateTime, System.DateTime], @param50=[String, System.String], @param51=[DateTime, System.DateTime], @param52=[String, System.String], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[System.DBNull, null], @param59=[System.DBNull, null], @param60=[System.DBNull, null], @param61=[System.DBNull, null], @param62=[System.DBNull, null], @param63=[System.DBNull, null], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[System.DBNull, null], @param71=[System.DBNull, null], @param72=[System.DBNull, null], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null], @param81=[System.DBNull, null], @param82=[System.DBNull, null], @param83=[System.DBNull, null], @param84=[System.DBNull, null], @param85=[System.DBNull, null], @param86=[System.DBNull, null], @param87=[System.DBNull, null], @param88=[System.DBNull, null], @param89=[System.DBNull, null], @param90=[System.DBNull, null], @param91=[System.DBNull, null], @param92=[System.DBNull, null], @param93=[System.DBNull, null], @param94=[System.DBNull, null], @param95=[System.DBNull, null], @param96=[System.DBNull, null], @param97=[System.DBNull, null], @param98=[System.DBNull, null], @param99=[System.DBNull, null], @param100=[System.DBNull, null], @param101=[System.DBNull, null], @param102=[System.DBNull, null], @param103=[System.DBNull, null], @param104=[System.DBNull, null], @param105=[System.DBNull, null], @param106=[System.DBNull, null], @param107=[System.DBNull, null], @param108=[System.DBNull, null], @param109=[System.DBNull, null], @param110=[System.DBNull, null], @param111=[System.DBNull, null], @param112=[System.DBNull, null], @param113=[System.DBNull, null], @param114=[System.DBNull, null], @param115=[System.DBNull, null], @param116=[System.DBNull, null], @param117=[System.DBNull, null], @param118=[System.DBNull, null], @param119=[System.DBNull, null], @param120=[System.DBNull, null], @param121=[System.DBNull, null], @param122=[System.DBNull, null], @param123=[System.DBNull, null], @param124=[String, System.String]]
2020-02-26 17:14:45,475 [1] DEBUG - Statement Id: [DAO00019_Add_TT_TIEPNHAN_SOTHEBHYT] PreparedStatement : [INSERT INTO TT_TIEPNHAN_SOTHEBHYT        (TIEPNHAN_ID        ,BENHNHAN_ID        ,BENHAN_ID        ,DOITUONG_ID        ,SOBHYT        ,BHYTTUNGAY        ,BHYTDENNGAY        ,BHYTNGAYCAP        ,BHYTTREN3NAM        ,BHYTTREN5NAM        ,NGAYMIENDONGCHITRA        ,TRAITUYEN        ,BENHVIEN_ID        ,NOITAO_ID        ,NGAYTAO        ,NGUOITAO_ID        ,NGAYCAPNHAT        ,NGUOICAPNHAT_ID        ,TYLE_VUOT_LCB        ,TYLE_TRAITUYEN        ,GIOIHAN_VUOT_LCB        ,LUONG_COSO        ,TYLE_THUOC_UT        ,MADOITUONG)        VALUES        ( @param0         , @param1         , @param2         , @param3         , @param4         , @param5         , @param6         , @param7         , @param8         , @param9         , @param10         , @param11         , @param12         , @param13         , @param14         , @param15         , @param16         , @param17         , @param18         , @param19         , @param20         , @param21         , @param22         , @param23 )]
2020-02-26 17:14:45,476 [1] DEBUG - Statement Id: [DAO00019_Add_TT_TIEPNHAN_SOTHEBHYT] Parameters: [@param0=[TIEPNHAN_ID,107438], @param1=[BENHNHAN_ID,74322], @param2=[BENHAN_ID,null], @param3=[DOITUONG_ID,1], @param4=[SOBHYT,null], @param5=[BHYTTUNGAY,null], @param6=[BHYTDENNGAY,null], @param7=[BHYTNGAYCAP,null], @param8=[BHYTTREN3NAM,0], @param9=[BHYTTREN5NAM,0], @param10=[NGAYMIENDONGCHITRA,null], @param11=[TRAITUYEN,0], @param12=[BENHVIEN_ID,HLU01], @param13=[NOITAO_ID,62], @param14=[NGAYTAO,2/26/2020 5:14:45 PM], @param15=[NGUOITAO_ID,1], @param16=[NGAYCAPNHAT,2/26/2020 5:14:45 PM], @param17=[NGUOICAPNHAT_ID,1], @param18=[TYLE_VUOT_LCB,null], @param19=[TYLE_TRAITUYEN,null], @param20=[GIOIHAN_VUOT_LCB,null], @param21=[LUONG_COSO,null], @param22=[TYLE_THUOC_UT,null], @param23=[MADOITUONG,VP]]
2020-02-26 17:14:45,476 [1] DEBUG - Statement Id: [DAO00019_Add_TT_TIEPNHAN_SOTHEBHYT] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[System.DBNull, null], @param3=[Int64, System.Int64], @param4=[System.DBNull, null], @param5=[System.DBNull, null], @param6=[System.DBNull, null], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[String, System.String], @param10=[System.DBNull, null], @param11=[String, System.String], @param12=[String, System.String], @param13=[String, System.String], @param14=[DateTime, System.DateTime], @param15=[String, System.String], @param16=[DateTime, System.DateTime], @param17=[String, System.String], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[System.DBNull, null], @param22=[System.DBNull, null], @param23=[String, System.String]]
2020-02-26 17:14:45,925 [1] DEBUG - Statement Id: [DAO00027_GetListTiepNhanAllCOM30] PreparedStatement : [select distinct A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, isnull(C.SOBENHAN,NULL) as SOBENHAN,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI, A.SOBHYT, CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYTIEPNHAN,        B.*        , A.UUTIEN        from TT_TIEPNHAN A        inner join (select * from TT_BENHNHAN where MAYTE = '200000439' and ACTIVE = '1') B on B.BENHNHAN_ID = A.BENHNHAN_ID  and B.ACTIVE = '1'        left join TT_NOITRU_BENHAN C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        where A.TIEPNHAN_ID = '107438' and A.BENHVIEN_ID = 'HLU01' and (A.TRANGTHAI not in ('HUY','CAPCUU', 'NOITRU', 'NGOAITRU'))]
2020-02-26 17:14:46,805 [1] DEBUG - Statement Id: [DAOWF001_LaythongtinProcess] PreparedStatement : [select * from TM_PROCESS        where        PROCESS_CODE = 'P01']
2020-02-26 17:14:46,868 [1] DEBUG - Statement Id: [DAOWF001_Kiemtrathongtindayeucau] PreparedStatement : [select * from TT_REQUEST        where        PROCESS_CODE = 'P01'        AND PARA = '{"HOSPITAL_ID":"HLU01","SOTIEPNHAN":"TN200226.0000001"}'        AND CURR_STATE_CODE = '6'        AND ISACTIVE = '1']
2020-02-26 17:14:49,637 [1] DEBUG - Statement Id: [DAOWF002_Add] PreparedStatement : [DECLARE @IDRequestOld int        DECLARE @IDRequestNew int        select top 1 @IDRequestOld = ID from TT_REQUEST where PARA =  @param0  order by ID desc          insert into TT_REQUEST (        PROCESS_CODE        , PARA        , CURR_STATE_CODE        ) values (         @param1         ,  @param0         ,  @param2         )        SELECT @IDRequestNew = SCOPE_IDENTITY()        if (@IDRequestOld is not null)        begin        update TT_REQUEST_SERVICE set REQUEST_ID = @IDRequestNew, PROCESS_CODE =  @param1  where REQUEST_ID = @IDRequestOld        update TT_REQUEST set ISACTIVE = '0' where ID = @IDRequestOld        update TT_REQUEST_SERVICE_DETAIL set REQUEST_ID = @IDRequestNew where REQUEST_ID = @IDRequestOld        end          select @IDRequestNew]
2020-02-26 17:14:49,637 [1] DEBUG - Statement Id: [DAOWF002_Add] Parameters: [@param0=[PARA,{"HOSPITAL_ID":"HLU01","SOTIEPNHAN":"TN200226.0000001"}], @param1=[PROCESS_CODE,P01], @param2=[CURR_STATE_CODE,6]]
2020-02-26 17:14:49,637 [1] DEBUG - Statement Id: [DAOWF002_Add] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[String, System.String]]
2020-02-26 17:14:49,938 [1] DEBUG - Statement Id: [DAO00020_GetNhomdichvuIDByManhom] PreparedStatement : [select NHOMDICHVU_ID from TM_NHOMDICHVU where MANHOMDICHVU = '04']
2020-02-26 17:14:49,963 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = '5'                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID         ,           NGUOICHIDINH_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7          ,            @param8                  ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44         ,  @param45                  ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77         ,  @param78                  ,  @param79         ,  @param80         ,  @param81                  );]
2020-02-26 17:14:49,963 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,107438], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,1], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,74322], @param6=[DOITUONG_ID,1], @param7=[DICHVU_ID,5492], @param8=[NGUOICHIDINH_ID,1], @param9=[BACSICHIDINH_ID,1], @param10=[GIOYEUCAU,17], @param11=[NGAYYEUCAU,2/26/2020 12:00:00 AM], @param12=[THANGYEUCAU,2], @param13=[NAMYEUCAU,2020], @param14=[NGAYGIOYEUCAU,2/26/2020 5:12:06 PM], @param15=[THUTUYEUCAU,1], @param16=[NOIYEUCAU_ID,62], @param17=[NOITHUCHIEN_ID,62], @param18=[TRANGTHAI_HANGDOI,null], @param19=[NOIDUNGCHITIET,null], @param20=[CHANDOAN,null], @param21=[LUUTRU_ID,null], @param22=[SODICHVUDONGTIEN,0], @param23=[DICHVU_KHAMBENH_ID,null], @param24=[DALAYMAU,null], @param25=[SINHTHIET,0], @param26=[CLOTEST,0], @param27=[TIEMCANQUANG,0], @param28=[TRIEUCHUNG,null], @param29=[DAITHE,null], @param30=[VITHE,null], @param31=[BENHPHAM,null], @param32=[DANHANBENHPHAM,0], @param33=[NGAYNHANBENHPHAM,null], @param34=[THOIGIANNHANBENHPHAM,null], @param35=[NGUOINHANBENHPHAM_ID,null], @param36=[MANGUOINHAPBENHPHAM,null], @param37=[TENNGUOINHAPBENHPHAM,null], @param38=[KETQUAXNKHAC,null], @param39=[YEUCAUBENNGOAI,0], @param40=[THUCHIENBENNGOAI,0], @param41=[DONVIBENNGOAI_ID,null], @param42=[BACSIBENNGOAI_ID,null], @param43=[TENBACSIBENNGOAI,null], @param44=[KHOABENNGOAI_ID,null], @param45=[KHOABENNGOAI,null], @param46=[NOITHUCHIENTHAYDOI_ID,null], @param47=[LOAIKHACHHANG_ID,null], @param48=[THE_ID,null], @param49=[BARCODEID,null], @param50=[HOPDONG_ID,null], @param51=[HOPDONG_BENHNHAN_ID,null], @param52=[HINHTHUCTHANHTOAN_ID,null], @param53=[DANGKY_ID,null], @param54=[DANGKY_CHITIET_ID,null], @param55=[LICHHEN_ID,null], @param56=[THOIGIANLICHHEN,null], @param57=[BNKHONGDENBV,null], @param58=[GHICHU,null], @param59=[THANHTOANTRUOC,1], @param60=[KHAN,0], @param61=[DUOCPHEPTHUCHIEN,0], @param62=[HUYYEUCAU,0], @param63=[LYDOHUY,null], @param64=[TRANGTHAI,CHUAKETQUA], @param65=[KHOADULIEU,null], @param66=[NGAYKHOADULIEU,null], @param67=[THOIGIANKHOADULIEU,null], @param68=[NGUOIKHOA_ID,null], @param69=[MANGUOIKHOA,null], @param70=[TENNGUOIKHOA,null], @param71=[BENHVIEN_ID,HLU01], @param72=[NGAYTAO,2/26/2020 5:14:49 PM], @param73=[NGUOITAO_ID,1], @param74=[NGAYHENCLS,null], @param75=[CREATININEMAU,null], @param76=[VUNGCANKHAOSAT,null], @param77=[BHYTDONGTIEN,null], @param78=[THUTIENSAU,1], @param79=[DVKEMTHEO,0], @param80=[DVKEMTHEO_KHACEKIP,null], @param81=[LIENCHUYENKHOA,null]]
2020-02-26 17:14:49,963 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[String, System.String], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[Int32, System.Int32], @param4=[System.DBNull, null], @param5=[Int32, System.Int32], @param6=[Int64, System.Int64], @param7=[Int64, System.Int64], @param8=[Int64, System.Int64], @param9=[Int64, System.Int64], @param10=[Int32, System.Int32], @param11=[DateTime, System.DateTime], @param12=[Int32, System.Int32], @param13=[Int32, System.Int32], @param14=[DateTime, System.DateTime], @param15=[Int32, System.Int32], @param16=[String, System.String], @param17=[Int64, System.Int64], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[System.DBNull, null], @param22=[Int32, System.Int32], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[Int32, System.Int32], @param26=[Int32, System.Int32], @param27=[Int32, System.Int32], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[Int32, System.Int32], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[System.DBNull, null], @param39=[Int32, System.Int32], @param40=[Int32, System.Int32], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[System.DBNull, null], @param50=[System.DBNull, null], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[System.DBNull, null], @param59=[Int32, System.Int32], @param60=[Int32, System.Int32], @param61=[Int32, System.Int32], @param62=[Int32, System.Int32], @param63=[System.DBNull, null], @param64=[String, System.String], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[System.DBNull, null], @param71=[String, System.String], @param72=[DateTime, System.DateTime], @param73=[String, System.String], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[String, System.String], @param79=[Int32, System.Int32], @param80=[System.DBNull, null], @param81=[System.DBNull, null]]
2020-02-26 17:14:52,302 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '107438' and C.DICHVU_ID = '5492' and A.BENHVIEN_ID = 'HLU01'         and           C.DVYEUCAU_ID = '992278']
2020-02-26 17:14:52,888 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '107438' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2020-02-26 17:14:53,751 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN200226.0000001']
2020-02-26 17:14:54,260 [1] DEBUG - Statement Id: [DAOWF001_Kiemtrathongtindayeucaudacochua] PreparedStatement : [select * from TT_REQUEST        where        PARA = '{"HOSPITAL_ID":"HLU01","SOTIEPNHAN":"TN200226.0000001"}'        AND ISACTIVE = '1']
2020-02-26 17:14:54,509 [1] DEBUG - Statement Id: [DAOWF001_Kiemtrathongtindichvudayeucau] PreparedStatement : [select top 1 * from TT_REQUEST_SERVICE        where        PARA = '{"DICHVU_ID":"5492","DVYEUCAU_ID":"992278"}'                AND ISACTIVE = '1' order by ID desc]
2020-02-26 17:14:55,435 [1] DEBUG - Statement Id: [DAOWF001_KiemtrathongtinchitietDichvuYeucau] PreparedStatement : [select * from TT_REQUEST_SERVICE_DETAIL        where        REQUEST_SERVICE_ID = '']
2020-02-26 17:14:55,512 [1] DEBUG - Statement Id: [DAOWF001_GetStartStateOfProcess] PreparedStatement : [select STATE_CODE from TM_STATE where TYPE_CODE = 'S' and PROCESS_CODE = 'P01']
2020-02-26 17:14:55,542 [1] DEBUG - Statement Id: [DAOWF001_Laythongtinwithstatecode] PreparedStatement : [select A.*, B.STATUS_CODE from        TM_STATE_ACTION A        left join TM_STATE B on B.STATE_CODE = A.NEXT_STATE_CODE and A.PROCESS_CODE = B.PROCESS_CODE        where        A.CURR_STATE_CODE = '6'        AND A.PROCESS_CODE = 'P01'        Order By ORDER_ID ASC]
2020-02-26 17:14:55,672 [1] DEBUG - Statement Id: [DAOWF003_Add] PreparedStatement : [insert into TT_REQUEST_SERVICE (        REQUEST_ID        , PARA        , CURR_STATE_CODE        , PROCESS_CODE        ) values (         @param0         ,  @param1         ,  @param2         ,  @param3         )        SELECT SCOPE_IDENTITY()]
2020-02-26 17:14:55,672 [1] DEBUG - Statement Id: [DAOWF003_Add] Parameters: [@param0=[REQUEST_ID,112235], @param1=[SERVICEPARA,{"DICHVU_ID":"5492","DVYEUCAU_ID":"992278"}], @param2=[CURR_STATE_CODE,3], @param3=[PROCESS_CODE,P01]]
2020-02-26 17:14:55,672 [1] DEBUG - Statement Id: [DAOWF003_Add] Types: [@param0=[Int32, System.Int32], @param1=[String, System.String], @param2=[String, System.String], @param3=[String, System.String]]
2020-02-26 17:14:55,729 [1] DEBUG - Statement Id: [DAOWF005_Add] PreparedStatement : [insert into TT_REQUEST_SERVICE_DETAIL (        REQUEST_ID        ,REQUEST_SERVICE_ID        , OLD_STATE_CODE        , CURR_STATE_CODE        ) values (         @param0         , @param1         ,  @param2         ,  @param3         )        SELECT SCOPE_IDENTITY()]
2020-02-26 17:14:55,729 [1] DEBUG - Statement Id: [DAOWF005_Add] Parameters: [@param0=[REQUEST_ID,112235], @param1=[REQUEST_SERVICE_ID,557015], @param2=[OLD_STATE_CODE,null], @param3=[CURR_STATE_CODE,3]]
2020-02-26 17:14:55,729 [1] DEBUG - Statement Id: [DAOWF005_Add] Types: [@param0=[String, System.String], @param1=[Int64, System.Int64], @param2=[System.DBNull, null], @param3=[String, System.String]]
2020-02-26 17:14:55,932 [1] DEBUG - Statement Id: [DAOWF005_Add_History] PreparedStatement : [insert into TT_REQUEST_SERVICE_HISTORY (        REQUEST_ID        ,REQUEST_SERVICE_ID        , OLD_STATE_CODE        , CURR_STATE_CODE        ) values (         @param0         , @param1         ,  @param2         ,  @param3         )]
2020-02-26 17:14:55,932 [1] DEBUG - Statement Id: [DAOWF005_Add_History] Parameters: [@param0=[REQUEST_ID,112235], @param1=[REQUEST_SERVICE_ID,557015], @param2=[OLD_STATE_CODE,null], @param3=[CURR_STATE_CODE,3]]
2020-02-26 17:14:55,932 [1] DEBUG - Statement Id: [DAOWF005_Add_History] Types: [@param0=[String, System.String], @param1=[Int64, System.Int64], @param2=[System.DBNull, null], @param3=[String, System.String]]
2020-02-26 17:14:56,005 [1] DEBUG - Statement Id: [DAO00009_TT_DVYEUCAU_Update] PreparedStatement : [Update TT_DVYEUCAU set TRANGTHAI_WFL = 'CHUAKETQUA' where DVYEUCAU_ID = '992278']
2020-02-26 17:14:56,031 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '107438']
2020-02-26 17:14:57,511 [1] DEBUG - Statement Id: [DAO00023_GetSOBHYT_HUONG_ID] PreparedStatement : [select isnull(MAX(SOBHYT_HUONG_ID),0) SOBHYT_HUONG_ID        from TT_TIEPNHAN_SOTHEBHYT        where TIEPNHAN_ID = '107438']
2020-02-26 17:14:57,595 [1] DEBUG - Statement Id: [DAO00064_GetTopTT_TIEPNHAN_SOTHEBHYT] PreparedStatement : [select top 1 stbhyt.*, ba.SOBENHAN,        tn.SOTIEPNHAN, tn.LOAITHANHVIEN_ID, tn.THE_ID, tn.THANHVIEN_ID,        tn.SUDUNG_BHTN, tn.BAOLANH_VIENPHI, tn.VIP, tn.NGUOINUOCNGOAI        from TT_TIEPNHAN_SOTHEBHYT stbhyt        left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = stbhyt.TIEPNHAN_ID        left join TT_NOITRU_BENHAN ba on ba.TIEPNHAN_ID = stbhyt.TIEPNHAN_ID        where        stbhyt.TIEPNHAN_ID = '107438' and isnull(stbhyt.KHONGSUDUNG, '0') = '0'        order by SOBHYT_HUONG_ID desc]
2020-02-26 17:14:57,717 [1] DEBUG - Statement Id: [DAO00006_GetListDuocTyle] PreparedStatement : [select DUOC_ID, DOITUONG_ID, (TYLE/100) as TYLE, DONGIA MUCTRAN_THANHTOAN from TM_DOITUONG_GIADUOC_TYLE            where            BENHVIEN_ID = 'HLU01'            and DOITUONG_ID = '0']
2020-02-26 17:14:57,780 [1] DEBUG - Statement Id: [DAO00027_GetListTuongTrinhDichVuPhauThuatCuaTiepNhan] PreparedStatement : [declare @ManhomDSA varchar(10);        declare @PhanLoaiNhomDV varchar(20) = '05';        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        if (@ManhomDSA is not null) set @PhanLoaiNhomDV += ',' + @ManhomDSA        select distinct ptyc.*        from TT_PHAUTHUAT_YEUCAU ptyc        inner join TM_DICHVU dv on dv.DICHVU_ID = ptyc.DICHVU_ID        inner join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID        inner join TT_PHAUTHUAT pt on pt.PHAUTHUAT_ID = ptyc.PHAUTHUAT_ID        where        pt.TIEPNHAN_ID = 107438        and (left(ndv.MANHOMDICHVU, 2) in (select * from STRING_SPLIT(@PhanLoaiNhomDV,',')) or ndv.MANHOMDICHVU in (select * from STRING_SPLIT(@PhanLoaiNhomDV,',')))]
2020-02-26 17:14:58,019 [1] DEBUG - Statement Id: [DAO00006_GetList] PreparedStatement : [select dv.*, loaiDV.MALOAIDICHVU, captren.NHOMDICHVU_ID as NHOMDICHVU_CAPTREN_ID, captren.TENNHOMDICHVU as NHOMDICHVU_CAPTREN,              nhom_dv.TENNHOMDICHVU as TENNHOMDICHVU, nhom_dv.MANHOMDICHVU,              case when dv.ATTRIBUTE5 is null then 'TT' else 'KTC' end as LOAI_CHIPHI              from TM_DICHVU as dv              left join TM_NHOMDICHVU as nhom_dv on nhom_dv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID and nhom_dv.BENHVIEN_ID = 'HLU01'              left join TM_NHOMDICHVU as captren on nhom_dv.CAPTREN_ID = captren.NHOMDICHVU_ID and captren.BENHVIEN_ID = 'HLU01'              left join TM_LOAIDICHVU loaiDV on nhom_dv.LOAIDICHVU_ID = loaiDV.LOAIDICHVU_ID and loaiDV.BENHVIEN_ID = 'HLU01'              where nhom_dv.TAMNGUNG = '0' and dv.BENHVIEN_ID = 'HLU01'              and dv.TAMNGUNG = '0'               AND                   loaiDV.MALOAIDICHVU = 'KhamBenh']
2020-02-26 17:15:00,675 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID         ,           DOTDIEUTRI_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN         ,           BHYTDONGTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE         ,           TYLE_VAT         ,           GIAVON         ,           BANGGIA_ID                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU         ,           YEUCAUVP         ,           DOITUONG_HUONG_ID         ,           SOBHYT_HUONG_ID         ,           DICHVU_TL                 ) values (         @param0         ,  @param1          ,            @param2          ,            @param3                  ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40          ,            @param41          ,            @param42                  ,  @param43         ,  @param44          ,            @param45          ,            @param46          ,            @param47          ,            @param48                  ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55          ,            @param56          ,            @param57          ,            @param58          ,            @param59                  )        SELECT SCOPE_IDENTITY()]
2020-02-26 17:15:00,676 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,107438], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,74322], @param3=[DOTDIEUTRI_ID,0], @param4=[KHAMBENH_ID,null], @param5=[REF_ID,992278], @param6=[REF_TABLE,TT_DVYEUCAU], @param7=[DICHVU_ID,5492], @param8=[DUOC_ID,null], @param9=[LOAI_CHIPHI,TT], @param10=[LOAIGIA_ID,3], @param11=[SOLUONG,1], @param12=[DONGIA_DOANHTHU,80000], @param13=[THANHTIEN_DOANHTHU,80000], @param14=[BHYT_TL,0], @param15=[BHYT_DONGIA,0], @param16=[BHYT_THANHTIEN,0], @param17=[BHYT_DONGIA_CHITRA,0], @param18=[BHYT_THANHTIEN_CHITRA,0], @param19=[BENHNHAN_PHAITHANHTOAN,80000], @param20=[GIATRI_HOADON,0], @param21=[GIATRI_HOADON_DATHANHTOAN,0], @param22=[GIATRI_BIENLAI,0], @param23=[GIATRI_BIENLAI_DATHANHTOAN,0], @param24=[GIATRI_BENHNHAN_DATHANHTOAN,0], @param25=[GIATRI_THATTHU,0], @param26=[MIENGIAM_TL,0], @param27=[MIENGIAM_GIATRI,0], @param28=[NGANSACH_TL,0], @param29=[NGANSACH_GIATRI,0], @param30=[TAITRO_TL,0], @param31=[TAITRO_GIATRI,0], @param32=[BHTN_TL,0], @param33=[BHTN_DONGIA,0], @param34=[BHTN_THANHTIEN,0], @param35=[BHTN_DONGIA_CHITRA,0], @param36=[BHTN_THANHTIEN_CHITRA,0], @param37=[DUOCPHEPTHUCHIEN,0], @param38=[HUY,0], @param39=[DATHANHTOAN,0], @param40=[DATHUCHIEN,0], @param41=[KHONGTHUTIEN,0], @param42=[BHYTDONGTIEN,0], @param43=[DUYET,null], @param44=[HOADON_ID,null], @param45=[ACTIVE,1], @param46=[TYLE_VAT,0], @param47=[GIAVON,0], @param48=[BANGGIA_ID,1657], @param49=[BENHVIEN_ID,HLU01], @param50=[NGUOITAO_ID,1], @param51=[NGAYTAO,2/26/2020 5:15:00 PM], @param52=[NGUOICAPNHAT_ID,1], @param53=[NGAYCAPNHAT,2/26/2020 5:15:00 PM], @param54=[DONGIA_BHYT_BANDAU,0], @param55=[DONGIADOANHTHU_BANDAU,80000], @param56=[YEUCAUVP,0], @param57=[DOITUONG_HUONG_ID,1], @param58=[SOBHYT_HUONG_ID,111790], @param59=[DICHVU_TL,1]]
2020-02-26 17:15:00,676 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int32, System.Int32], @param3=[Int32, System.Int32], @param4=[System.DBNull, null], @param5=[Int32, System.Int32], @param6=[String, System.String], @param7=[Int32, System.Int32], @param8=[System.DBNull, null], @param9=[String, System.String], @param10=[Int32, System.Int32], @param11=[Decimal, System.Decimal], @param12=[Decimal, System.Decimal], @param13=[Decimal, System.Decimal], @param14=[Decimal, System.Decimal], @param15=[Decimal, System.Decimal], @param16=[Decimal, System.Decimal], @param17=[Decimal, System.Decimal], @param18=[Decimal, System.Decimal], @param19=[Decimal, System.Decimal], @param20=[Decimal, System.Decimal], @param21=[Decimal, System.Decimal], @param22=[Decimal, System.Decimal], @param23=[Decimal, System.Decimal], @param24=[Decimal, System.Decimal], @param25=[Decimal, System.Decimal], @param26=[Decimal, System.Decimal], @param27=[Decimal, System.Decimal], @param28=[Decimal, System.Decimal], @param29=[Decimal, System.Decimal], @param30=[Decimal, System.Decimal], @param31=[Decimal, System.Decimal], @param32=[Decimal, System.Decimal], @param33=[Decimal, System.Decimal], @param34=[Decimal, System.Decimal], @param35=[Decimal, System.Decimal], @param36=[Decimal, System.Decimal], @param37=[Int32, System.Int32], @param38=[Int32, System.Int32], @param39=[Int32, System.Int32], @param40=[Int32, System.Int32], @param41=[String, System.String], @param42=[String, System.String], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[Int32, System.Int32], @param46=[Int32, System.Int32], @param47=[Decimal, System.Decimal], @param48=[Int32, System.Int32], @param49=[String, System.String], @param50=[String, System.String], @param51=[DateTime, System.DateTime], @param52=[String, System.String], @param53=[DateTime, System.DateTime], @param54=[Decimal, System.Decimal], @param55=[Decimal, System.Decimal], @param56=[String, System.String], @param57=[Int32, System.Int32], @param58=[Int32, System.Int32], @param59=[Decimal, System.Decimal]]
2020-02-26 17:15:03,953 [1] DEBUG - Statement Id: [DAO00064_GetREGListVienphiTiepNhan] PreparedStatement : [select A.*, B.THUTIENSAU        from TT_VIENPHI A        left join TT_DVYEUCAU B on A.REF_ID =  B.DVYEUCAU_ID and A.REF_TABLE = 'TT_DVYEUCAU' and B.HUYYEUCAU = '0'        where        A.TIEPNHAN_ID = '107438' and A.BENHVIEN_ID = 'HLU01' and (A.BENHAN_ID is NULL or A.BENHAN_ID = '')        and A.HUY = '0'        ORDER BY A.VIENPHI_ID]
2020-02-26 17:15:12,745 [1] DEBUG - Statement Id: [DAO00064_GetTopTT_TIEPNHAN_SOTHEBHYT] PreparedStatement : [select top 1 stbhyt.*, ba.SOBENHAN,        tn.SOTIEPNHAN, tn.LOAITHANHVIEN_ID, tn.THE_ID, tn.THANHVIEN_ID,        tn.SUDUNG_BHTN, tn.BAOLANH_VIENPHI, tn.VIP, tn.NGUOINUOCNGOAI        from TT_TIEPNHAN_SOTHEBHYT stbhyt        left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = stbhyt.TIEPNHAN_ID        left join TT_NOITRU_BENHAN ba on ba.TIEPNHAN_ID = stbhyt.TIEPNHAN_ID        where        stbhyt.TIEPNHAN_ID = '107438' and isnull(stbhyt.KHONGSUDUNG, '0') = '0'        order by SOBHYT_HUONG_ID desc]
2020-02-26 17:15:13,695 [1] DEBUG - Statement Id: [DAO00006_GetListDuocTyle] PreparedStatement : [select DUOC_ID, DOITUONG_ID, (TYLE/100) as TYLE, DONGIA MUCTRAN_THANHTOAN from TM_DOITUONG_GIADUOC_TYLE            where            BENHVIEN_ID = 'HLU01'            and DOITUONG_ID = '0']
2020-02-26 17:15:13,852 [1] DEBUG - Statement Id: [DAO00027_GetListTuongTrinhDichVuPhauThuatCuaTiepNhan] PreparedStatement : [declare @ManhomDSA varchar(10);        declare @PhanLoaiNhomDV varchar(20) = '05';        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        if (@ManhomDSA is not null) set @PhanLoaiNhomDV += ',' + @ManhomDSA        select distinct ptyc.*        from TT_PHAUTHUAT_YEUCAU ptyc        inner join TM_DICHVU dv on dv.DICHVU_ID = ptyc.DICHVU_ID        inner join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID        inner join TT_PHAUTHUAT pt on pt.PHAUTHUAT_ID = ptyc.PHAUTHUAT_ID        where        pt.TIEPNHAN_ID = 107438        and (left(ndv.MANHOMDICHVU, 2) in (select * from STRING_SPLIT(@PhanLoaiNhomDV,',')) or ndv.MANHOMDICHVU in (select * from STRING_SPLIT(@PhanLoaiNhomDV,',')))]
2020-02-26 17:15:15,272 [1] DEBUG - Statement Id: [DAO00006_GetList] PreparedStatement : [select dv.*, loaiDV.MALOAIDICHVU, captren.NHOMDICHVU_ID as NHOMDICHVU_CAPTREN_ID, captren.TENNHOMDICHVU as NHOMDICHVU_CAPTREN,              nhom_dv.TENNHOMDICHVU as TENNHOMDICHVU, nhom_dv.MANHOMDICHVU,              case when dv.ATTRIBUTE5 is null then 'TT' else 'KTC' end as LOAI_CHIPHI              from TM_DICHVU as dv              left join TM_NHOMDICHVU as nhom_dv on nhom_dv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID and nhom_dv.BENHVIEN_ID = 'HLU01'              left join TM_NHOMDICHVU as captren on nhom_dv.CAPTREN_ID = captren.NHOMDICHVU_ID and captren.BENHVIEN_ID = 'HLU01'              left join TM_LOAIDICHVU loaiDV on nhom_dv.LOAIDICHVU_ID = loaiDV.LOAIDICHVU_ID and loaiDV.BENHVIEN_ID = 'HLU01'              where nhom_dv.TAMNGUNG = '0' and dv.BENHVIEN_ID = 'HLU01'              and dv.TAMNGUNG = '0'               AND                   loaiDV.MALOAIDICHVU = 'KhamBenh']
2020-02-26 17:15:18,649 [1] DEBUG - Statement Id: [DAO00023_Update_VPTiepnhan] PreparedStatement : [update TT_VIENPHI set        TIEPNHAN_ID =  @param0                ,           BENHNHAN_ID =  @param1          ,           REF_ID =  @param2                  , REF_TABLE =  @param3         , DICHVU_ID =  @param4         , DUOC_ID =  @param5         , LOAI_CHIPHI =  @param6         , LOAIGIA_ID =  @param7         , SOLUONG =  @param8         , DONGIA_DOANHTHU =  @param9         , THANHTIEN_DOANHTHU =  @param10         , BHYT_TL =  @param11         , BHYT_DONGIA =  @param12         , BHYT_THANHTIEN =  @param13         , BHYT_DONGIA_CHITRA =  @param14         , BHYT_THANHTIEN_CHITRA =  @param15         , BENHNHAN_PHAITHANHTOAN =  @param16         , GIATRI_HOADON =  @param17         , GIATRI_HOADON_DATHANHTOAN =  @param18         , GIATRI_BIENLAI =  @param19         , GIATRI_BIENLAI_DATHANHTOAN =  @param20         , GIATRI_BENHNHAN_DATHANHTOAN =  @param21         , GIATRI_THATTHU =  @param22         , MIENGIAM_TL =  @param23         , NGANSACH_TL =  @param24         , NGANSACH_GIATRI =  @param25         , TAITRO_TL =  @param26         , TAITRO_GIATRI =  @param27         , BHTN_TL =  @param28         , BHTN_DONGIA =  @param29         , BHTN_THANHTIEN =  @param30         , BHTN_DONGIA_CHITRA =  @param31         , BHTN_THANHTIEN_CHITRA =  @param32          ,           TYLE_VAT =  @param33          ,           GIAVON =  @param34          ,           BANGGIA_ID =  @param35          ,           BHYTDONGTIEN =  @param36          ,           BHYT_DONGIA_CONGKHAM_DAU =  @param37          ,           BHYT_CONGKHAM_DAU_TYLE =  @param38                  , BENHVIEN_ID =  @param39         , NGUOICAPNHAT_ID =  @param40         , NGAYCAPNHAT =  @param41          ,           DONGIA_BHYT_BANDAU =  @param42          ,           YEUCAUVP =  @param43                        where                    VIENPHI_ID = '3119652' and DATHANHTOAN = '0']
2020-02-26 17:15:18,649 [1] DEBUG - Statement Id: [DAO00023_Update_VPTiepnhan] Parameters: [@param0=[TIEPNHAN_ID,107438], @param1=[BENHNHAN_ID,74322], @param2=[REF_ID,992278], @param3=[REF_TABLE,TT_DVYEUCAU], @param4=[DICHVU_ID,5492], @param5=[DUOC_ID,null], @param6=[LOAI_CHIPHI,TT], @param7=[LOAIGIA_ID,3], @param8=[SOLUONG,1.0000], @param9=[DONGIA_DOANHTHU,80000.0000], @param10=[THANHTIEN_DOANHTHU,80000.00], @param11=[BHYT_TL,0], @param12=[BHYT_DONGIA,0], @param13=[BHYT_THANHTIEN,0], @param14=[BHYT_DONGIA_CHITRA,0], @param15=[BHYT_THANHTIEN_CHITRA,0], @param16=[BENHNHAN_PHAITHANHTOAN,80000.00], @param17=[GIATRI_HOADON,0], @param18=[GIATRI_HOADON_DATHANHTOAN,0], @param19=[GIATRI_BIENLAI,0], @param20=[GIATRI_BIENLAI_DATHANHTOAN,0], @param21=[GIATRI_BENHNHAN_DATHANHTOAN,0], @param22=[GIATRI_THATTHU,0], @param23=[MIENGIAM_TL,0], @param24=[NGANSACH_TL,0], @param25=[NGANSACH_GIATRI,0], @param26=[TAITRO_TL,0], @param27=[TAITRO_GIATRI,0], @param28=[BHTN_TL,0], @param29=[BHTN_DONGIA,0], @param30=[BHTN_THANHTIEN,0], @param31=[BHTN_DONGIA_CHITRA,0], @param32=[BHTN_THANHTIEN_CHITRA,0], @param33=[TYLE_VAT,0], @param34=[GIAVON,0.0000], @param35=[BANGGIA_ID,1657], @param36=[BHYTDONGTIEN,0], @param37=[BHYT_DONGIA_CONGKHAM_DAU,0], @param38=[BHYT_CONGKHAM_DAU_TYLE,0], @param39=[BENHVIEN_ID,HLU01], @param40=[NGUOICAPNHAT_ID,1], @param41=[NGAYCAPNHAT,2/26/2020 5:15:18 PM], @param42=[DONGIA_BHYT_BANDAU,0.00], @param43=[YEUCAUVP,0]]
2020-02-26 17:15:18,649 [1] DEBUG - Statement Id: [DAO00023_Update_VPTiepnhan] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[Int32, System.Int32], @param5=[System.DBNull, null], @param6=[String, System.String], @param7=[Int32, System.Int32], @param8=[Decimal, System.Decimal], @param9=[Decimal, System.Decimal], @param10=[Decimal, System.Decimal], @param11=[Decimal, System.Decimal], @param12=[Decimal, System.Decimal], @param13=[Decimal, System.Decimal], @param14=[Decimal, System.Decimal], @param15=[Decimal, System.Decimal], @param16=[Decimal, System.Decimal], @param17=[Decimal, System.Decimal], @param18=[Decimal, System.Decimal], @param19=[Decimal, System.Decimal], @param20=[Decimal, System.Decimal], @param21=[Decimal, System.Decimal], @param22=[Decimal, System.Decimal], @param23=[Decimal, System.Decimal], @param24=[Decimal, System.Decimal], @param25=[Decimal, System.Decimal], @param26=[Decimal, System.Decimal], @param27=[Decimal, System.Decimal], @param28=[Decimal, System.Decimal], @param29=[Decimal, System.Decimal], @param30=[Decimal, System.Decimal], @param31=[Decimal, System.Decimal], @param32=[Decimal, System.Decimal], @param33=[Int32, System.Int32], @param34=[Decimal, System.Decimal], @param35=[Int32, System.Int32], @param36=[String, System.String], @param37=[Decimal, System.Decimal], @param38=[Decimal, System.Decimal], @param39=[String, System.String], @param40=[Int32, System.Int32], @param41=[DateTime, System.DateTime], @param42=[Decimal, System.Decimal], @param43=[String, System.String]]
2020-02-26 17:15:24,261 [1] DEBUG - Statement Id: [DAO00403_QMS002_GetThongTinClient] PreparedStatement : [SELECT B.ID as QUEUE_ID, B.NAME AS QUEUE_NAME,A.ID AS CLIENT_ID , A.NAME AS CLIENT_NAME, A.STATE,(CASE C.NAME WHEN 'UT' THEN 1 ELSE 0 END) AS QUEUETYPE        , B.DEPARTMENT_ID,ISNULL(B.SECTION_ID,-1) AS SECTION_ID,A.IPSERVER,A.NAMEAUDIO,C.QUEUE_TYPE_CODE,S.[NAME] AS SECTIONNAME        FROM QMS_CLIENT A INNER JOIN QMS_QUEUE B ON A.QUEUE_ID = B.ID        LEFT JOIN QMS_QUEUE_TYPE C ON B.QUEUETYPE_ID = C.ID        LEFT JOIN QMS_SECTION S ON B.SECTION_ID=S.ID        WHERE (A.COMPUTERNAME = 'GMC-HAIPN6' OR A.IPADDRESS = '192.168.56.1') AND A.STATE = 1 AND B.BENHVIEN_ID = 'HLU01']
2020-02-26 17:15:25,694 [1] DEBUG - Statement Id: [DAO00019_GetDetails_TiepNhan] PreparedStatement : [select tn.TIEPNHAN_ID, tn.SOTIEPNHAN, tn.SOBHYT as SOTHE, tn.BHYTTUNGAY as NGAYHIEULUC,        tn.BHYTDENNGAY as NGAYHETHIEULUC, tn.BHYTNGAYCAP as NGAYCAP, tn.BHYTTREN3NAM as TREN3NAM, tn.KHUVUCSONG_ID,        tn.BHYTTREN5NAM as TREN5NAM,tn.NGAYMIENDONGCHITRA,tn.NOIGIOITHIEU_ID, tn.NGUOIGIOITHIEU_ID, tn.CHANDOANNGT,        tn.NOITIEPNHAN_ID, tn.DOITUONG_ID, tn.TRAITUYEN, tn.HINHTHUCDENKHAM_ID, tn.THOIGIANTIEPNHAN,        dv.DVYEUCAU_ID, dv.DICHVU_ID, dv.NOITHUCHIEN_ID as PHONGBAN_ID,        dv.NGUOITAO_ID as DV_NGUOITAO_ID, dv.NGAYTAO as DV_NGAYTAO, dv.THUTIENSAU, dv.BACSICHIDINH_ID, dv.NGUOICHIDINH_ID,        dv.NGUOICAPNHAT_ID as DV_NGUOICAPNHAT_ID, dv.NGAYCAPNHAT as DV_NGAYCAPNHAT,        vp.VIENPHI_ID, vp.KHONGTHUTIEN, vp.LOAI_CHIPHI, vp.LOAIGIA_ID as LOAIGIA,        vp.DATHUCHIEN, vp.DATHANHTOAN, vp.DONGIA_DOANHTHU,        dv.NOITHUCHIEN_ID, dv.TRANGTHAI,        vp.NGUOITAO_ID as VP_NGUOITAO_ID, vp.BHYT_DONGIA, vp.TYLE_VAT, vp.BANGGIA_ID, vp.GIAVON,        tn.NGAYTAO as TN_NGAYTAO,        vp.NGAYTAO as VP_NGAYTAO, vp.NGUOICAPNHAT_ID as VP_NGUOICAPNHAT_ID, vp.NGAYCAPNHAT as VP_NGAYCAPNHAT,        tn.SOCHUYENVIEN, tn.THOIGIANCHUYENTUYEN, tn.HINHTHUCCHUYENVIEN_ID, tn.LYDOCHUYENVIEN_ID, tn.ICDNOIGIOITHIEU_ID,        tn.SUDUNG_BHTN, tn.THE_ID, tn.LOAITHANHVIEN_ID, tn.THANHVIEN_ID, tn.VIP, tn.GHICHU_TIEPNHAN, tn.BAOLANH_VIENPHI        , tn.CONGTY_CHITRA_ID, tn.TRANGTHAI as TRANGTHAI_TIEPNHAN, tn.NGUOITAO_ID as TN_NGUOITAO_ID, tn.TINHTRANGHEN        , tn.NGUON_BENHNHAN_ID, tn.THONGTIN_KCB_BHYT, tn.LOAITIEPNHAN_ID, tn.LYDODENKHAM, vp.YEUCAUVP        , tn.TENNGUOIGIOITHIEU, tn.GIOITHIEUBENNGOAI, tn.UUTIEN, tn.KHOAHENTK        from (        select top 1 *        from TT_TIEPNHAN        where BENHVIEN_ID = 'HLU01'                 order by                 SOTIEPNHAN desc        ) as tn        left join TT_DVYEUCAU dv on dv.TIEPNHAN_ID = tn.TIEPNHAN_ID and dv.HUYYEUCAU = '0'        left join TT_VIENPHI vp on vp.TIEPNHAN_ID = tn.TIEPNHAN_ID and vp.DICHVU_ID = dv.DICHVU_ID  and dv.DVYEUCAU_ID = vp.REF_ID]
2020-02-26 17:15:27,152 [1] DEBUG - Statement Id: [DAO00403_QMS002_GetThongTinClient] PreparedStatement : [SELECT B.ID as QUEUE_ID, B.NAME AS QUEUE_NAME,A.ID AS CLIENT_ID , A.NAME AS CLIENT_NAME, A.STATE,(CASE C.NAME WHEN 'UT' THEN 1 ELSE 0 END) AS QUEUETYPE        , B.DEPARTMENT_ID,ISNULL(B.SECTION_ID,-1) AS SECTION_ID,A.IPSERVER,A.NAMEAUDIO,C.QUEUE_TYPE_CODE,S.[NAME] AS SECTIONNAME        FROM QMS_CLIENT A INNER JOIN QMS_QUEUE B ON A.QUEUE_ID = B.ID        LEFT JOIN QMS_QUEUE_TYPE C ON B.QUEUETYPE_ID = C.ID        LEFT JOIN QMS_SECTION S ON B.SECTION_ID=S.ID        WHERE (A.COMPUTERNAME = 'GMC-HAIPN6' OR A.IPADDRESS = '192.168.56.1') AND A.STATE = 1 AND B.BENHVIEN_ID = 'HLU01']
2020-02-26 17:15:28,217 [1] DEBUG - Statement Id: [DAO00403_QMS002_GetThongTinClient] PreparedStatement : [SELECT B.ID as QUEUE_ID, B.NAME AS QUEUE_NAME,A.ID AS CLIENT_ID , A.NAME AS CLIENT_NAME, A.STATE,(CASE C.NAME WHEN 'UT' THEN 1 ELSE 0 END) AS QUEUETYPE        , B.DEPARTMENT_ID,ISNULL(B.SECTION_ID,-1) AS SECTION_ID,A.IPSERVER,A.NAMEAUDIO,C.QUEUE_TYPE_CODE,S.[NAME] AS SECTIONNAME        FROM QMS_CLIENT A INNER JOIN QMS_QUEUE B ON A.QUEUE_ID = B.ID        LEFT JOIN QMS_QUEUE_TYPE C ON B.QUEUETYPE_ID = C.ID        LEFT JOIN QMS_SECTION S ON B.SECTION_ID=S.ID        WHERE (A.COMPUTERNAME = 'GMC-HAIPN6' OR A.IPADDRESS = '192.168.56.1') AND A.STATE = 1 AND B.BENHVIEN_ID = 'HLU01']
2020-02-26 17:15:45,106 [1] DEBUG - Statement Id: [DAO00404_UpdDVYeuCauSTT] PreparedStatement : [UPDATE TT_DVYEUCAU SET SOTHUTU='0001' WHERE        EXISTS(        SELECT YC.DVYEUCAU_ID FROM TT_DVYEUCAU YC JOIN TT_BENHNHAN BN ON YC.BENHNHAN_ID=BN.BENHNHAN_ID AND YC.SOTHUTU IS NULL        AND YC.TRANGTHAI_WFL IN('CHOLAYMAU','CHUAKETQUA') AND yc.NOITHUCHIEN_ID=62 AND BN.MAYTE='200000439'        WHERE TT_DVYEUCAU.DVYEUCAU_ID=YC.DVYEUCAU_ID        )]
2020-02-26 17:15:46,095 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RPT02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 17:15:47,539 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RPT01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 17:15:48,839 [1] DEBUG - Statement Id: [DAO00200_GetDetail] PreparedStatement : [select *              from TM_REPORT              where TM_REPORT.REPORT_CODE  = 'QMS21' AND TM_REPORT.BENHVIEN_ID = 'HLU01']
2020-02-26 17:15:49,069 [1] DEBUG - Statement Id: [DAO00201_GetList] PreparedStatement : [select *              from TM_REPORT_DETAIL               where                             TM_REPORT_DETAIL.REPORT_CODE = 'QMS21'                       and                           TM_REPORT_DETAIL.BENHVIEN_ID = 'HLU01'                                     order by PARAMETER_INDEX]
2020-02-26 17:15:49,208 [1] DEBUG - Statement Id: [DAO00203_GetList] PreparedStatement : [select *              from TM_REPORT_SUB_DEFINITION               where                             TM_REPORT_SUB_DEFINITION.REPORT_CODE = 'QMS21'                       and                           TM_REPORT_SUB_DEFINITION.BENHVIEN_ID = 'HLU01'                                     order by REPORT_SUB_DEFINITION_ID]
2020-02-26 17:15:49,238 [1] DEBUG - Statement Id: [DAO00201_GetListByParentReportID] PreparedStatement : [select RD.*              from TM_REPORT AS R              INNER JOIN TM_REPORT_SUB_DEFINITION AS RS ON R.REPORT_CODE = RS.REPORT_CODE AND R.BENHVIEN_ID = RS.BENHVIEN_ID              INNER JOIN TM_REPORT_DETAIL AS RD ON RD.REPORT_CODE = RS.SUB_REPORT_CODE AND RD.BENHVIEN_ID = RS.BENHVIEN_ID              where R.REPORT_CODE  = 'QMS21' AND R.BENHVIEN_ID = 'HLU01']
2020-02-26 17:15:49,336 [1] DEBUG - Statement Id: [DAO00203_GetListReportSubFileByReportID] PreparedStatement : [select R.*              from TM_REPORT_SUB_DEFINITION AS RS              inner join TM_REPORT AS R ON RS.SUB_REPORT_CODE = R.REPORT_CODE AND R.BENHVIEN_ID = RS.BENHVIEN_ID              where RS.REPORT_CODE = 'QMS21' AND RS.BENHVIEN_ID = 'HLU01']
2020-02-26 17:15:49,461 [1] DEBUG - Statement Id: [DAO00204_GetListParameter] PreparedStatement : [SELECT SUBSTRING(p.name, 2, LEN(p.name) - 1) AS PARAMETER, p.parameter_id AS Idx, CONVERT(varchar(1),p.is_nullable) as Allow_Null              FROM sys.procedures sp              INNER JOIN sys.parameters p ON sp.object_id = p.object_id              WHERE sp.name = 'QMS21P00201_CSTTKB'              ORDER BY p.parameter_id]
2020-02-26 17:15:49,715 [1] DEBUG - Statement Id: [DAO00204_GetReportData] PreparedStatement : [QMS21P00201_CSTTKB]
2020-02-26 17:15:49,715 [1] DEBUG - Statement Id: [DAO00204_GetReportData] Parameters: [@strSTT=[PARAMETERS.strSTT,0001], @departmentName=[PARAMETERS.departmentName,Thu ngân], @gender=[PARAMETERS.gender,Nữ], @priorityStr=[PARAMETERS.priorityStr, ], @patientCode=[PARAMETERS.patientCode,200000439], @patientName=[PARAMETERS.patientName,Test Vp1], @patientYOB=[PARAMETERS.patientYOB,1998], @fromTime=[PARAMETERS.fromTime,17:15], @toTime=[PARAMETERS.toTime,17:16], @createTime=[PARAMETERS.createTime,2/26/2020 5:15:43 PM], @MABENHVIEN=[PARAMETERS.MABENHVIEN,HLU01]]
2020-02-26 17:15:49,715 [1] DEBUG - Statement Id: [DAO00204_GetReportData] Types: [@strSTT=[String, System.String], @departmentName=[String, System.String], @gender=[String, System.String], @priorityStr=[String, System.String], @patientCode=[String, System.String], @patientName=[String, System.String], @patientYOB=[Int64, System.Int64], @fromTime=[String, System.String], @toTime=[String, System.String], @createTime=[DateTime, System.DateTime], @MABENHVIEN=[String, System.String]]
2020-02-26 17:15:49,826 [1] DEBUG - Statement Id: [DAO00200_GetSettingReportPrinting] PreparedStatement : [SELECT DICTIONARY_CODE AS REPORT_CODE, DICTIONARY_NAME AS COMPUTER_NAME, DICTIONARY_NAME_EN AS NAME_PRINTER          FROM LST_DICTIONARY          WHERE BENHVIEN_ID = 'HLU01' AND ENABLED = '1' AND DICTIONARY_TYPE_CODE = 'Report_Printer_Setting'          AND DICTIONARY_CODE = 'QMS21' AND DICTIONARY_NAME = 'GMC-HAIPN6']
2020-02-26 17:19:14,289 [1] DEBUG - Statement Id: [DAO00012_GetList] PreparedStatement : [select        DICTIONARY_ID,        DICTIONARY_CODE,        DICTIONARY_NAME,        ATTRIBUTE1,        ATTRIBUTE2,        DICTIONARY_NAME_EN,        DICTIONARY_TYPE_CODE        from LST_DICTIONARY        where LST_DICTIONARY.Enabled = '1'         AND           LST_DICTIONARY.DICTIONARY_TYPE_CODE = 'NguonBN'                 order by LST_DICTIONARY.IDX]
2020-02-26 17:19:15,044 [1] DEBUG - Statement Id: [DAO00101_GetListSuatAn] PreparedStatement : [SELECT        kP.KHAUPHANAN_ID,        kP.MAKHAUPHANAN,        kP.TENKHAUPHANAN,        LKP.LOAIKHAUPHANAN_ID,        LKP.MALOAIKHAUPHANAN,        LKP.TENLOAIKHAUPHANAN,        DG.DONGIA,        kP.HANGMUC_ID        FROM TM_NUT_KHAUPHANAN kP        INNER JOIN TM_NUT_LOAIKHAUPHANAN LKP ON  kP.LOAIKHAUPHANAN_ID = LKP.LOAIKHAUPHANAN_ID        INNER JOIN TM_NUT_KHAUPHANAN_DONGIA DG ON DG.KHAUPHANAN_ID = kP.KHAUPHANAN_ID        WHERE DG.DONGIA IS NOT NULL]
2020-02-26 17:19:21,042 [1] DEBUG - Statement Id: [DAO00014_GetPatientStatus] PreparedStatement : [select        CASE        when tn.TRANGTHAI = 'HOANTHANH' Then tn.TRANGTHAI        WHEN xncp.XACNHANCHIPHI_ID is not null THEN 'XACNHANCHIPHI'        WHEN (tn.KHOADULIEU = '1') THEN 'KHOADULIEU'        ELSE tn.TRANGTHAI        END        as TRANGTHAI        from TT_TIEPNHAN tn        left join TT_XACNHANCHIPHI xncp on tn.TIEPNHAN_ID = xncp.TIEPNHAN_ID        where tn.TIEPNHAN_ID = '107438'        and tn.BENHVIEN_ID = 'HLU01']
2020-02-26 17:19:21,297 [1] DEBUG - Statement Id: [DAO00024_TT_VIENPHI_GetList_DSDichVuChuaThuTien] PreparedStatement : [SELECT TOP 1 VIENPHI_ID              FROM TT_VIENPHI              WHERE              DATHANHTOAN = 0]
2020-02-26 17:19:21,320 [1] DEBUG - Statement Id: [DAO00064_GetlistTT_TIEPNHAN_SOTHEBHYT] PreparedStatement : [select stbhyt.*, ba.SOBENHAN,        tn.SOTIEPNHAN, tn.LOAITHANHVIEN_ID, tn.THE_ID, tn.THANHVIEN_ID,        tn.SUDUNG_BHTN, tn.BAOLANH_VIENPHI, tn.VIP, tn.NGUOINUOCNGOAI        from TT_TIEPNHAN_SOTHEBHYT stbhyt        left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = stbhyt.TIEPNHAN_ID        left join TT_NOITRU_BENHAN ba on ba.TIEPNHAN_ID = stbhyt.TIEPNHAN_ID        where        stbhyt.TIEPNHAN_ID = '107438' and isnull(stbhyt.KHONGSUDUNG, '0') = '0']
2020-02-26 17:19:21,375 [1] DEBUG - Statement Id: [DAO00064_GetListVienPhiByTiepNnan] PreparedStatement : [select distinct        B.DOITUONG_ID, B.NGAYMIENDONGCHITRA, B.BENHNHAN_ID as TIEPNHAN_BENHNHAN_ID, B.TRAITUYEN,        B.BHYTTREN3NAM as TREN3NAM, B.BHYTTREN5NAM as TREN5NAM, B.SOTIEPNHAN, B.SOBENHAN,        B.LOAITHANHVIEN_ID, B.SUDUNG_BHTN, B.THE_ID, B.THANHVIEN_ID, B.BAOLANH_VIENPHI, B.VIP, B.NGUOINUOCNGOAI,        C.GIATRIMIENGIAM as GIATRIMIENGIAM, D.GIATRIMIENGIAM as GIATRIMIENGIAM_BHTN, E.GIATRIMIENGIAM as GIATRIMIENGIAM_THANHVIEN,        F.GIATRIMIENGIAM as GIATRIMIENGIAM_CONGTY, DVYC.THE_ID as DVDUNGTHE, DVYC.TRANGTHAI as TRANGTHAIDICHVU, ndv.MANHOMDICHVU,        A.* from TT_VIENPHI A        left join        (select B.*, C.SOBENHAN, C.BENHAN_ID        from TT_TIEPNHAN B        left join TT_NOITRU_BENHAN C on B.TIEPNHAN_ID = C.TIEPNHAN_ID                 where B.TIEPNHAN_ID = '107438') B on B.TIEPNHAN_ID = A.TIEPNHAN_ID        left join (select sum(GIATRIMIENGIAM) as GIATRIMIENGIAM, VIENPHI_ID, REF_TABLE        from TT_MIENGIAM_CHITIET        where REF_TABLE = 'TT_MIENGIAM'        and exists (select MIENGIAM_ID from TT_MIENGIAM where TT_MIENGIAM_CHITIET.MIENGIAM_ID = MIENGIAM_ID and TINHTRANG = 1 and TIEPNHAN_ID = '107438')        group by VIENPHI_ID, REF_TABLE) C on C.REF_TABLE = 'TT_MIENGIAM' and C.VIENPHI_ID = A.VIENPHI_ID        left join (select sum(GIATRIMIENGIAM) as GIATRIMIENGIAM, VIENPHI_ID, REF_TABLE        from TT_MIENGIAM_CHITIET        where REF_TABLE = 'TT_MIENGIAM_BHTN'        and exists (select MIENGIAM_BHTN_ID from TT_MIENGIAM_BHTN where TT_MIENGIAM_CHITIET.MIENGIAM_ID = MIENGIAM_BHTN_ID and  TINHTRANG = 1 and TIEPNHAN_ID = '107438')        group by VIENPHI_ID, REF_TABLE) D on D.REF_TABLE = 'TT_MIENGIAM_BHTN' and D.VIENPHI_ID = A.VIENPHI_ID        left join (select sum(GIATRIMIENGIAM) as GIATRIMIENGIAM, VIENPHI_ID, REF_TABLE        from TT_MIENGIAM_CHITIET        where REF_TABLE = 'TT_MIENGIAM_THANHVIEN'        and exists (select MIENGIAM_THANHVIEN_ID from TT_MIENGIAM_THANHVIEN where TT_MIENGIAM_CHITIET.MIENGIAM_ID = MIENGIAM_THANHVIEN_ID and TINHTRANG = 1 and TIEPNHAN_ID = '107438')        group by VIENPHI_ID, REF_TABLE) E on E.REF_TABLE = 'TT_MIENGIAM_THANHVIEN' and E.VIENPHI_ID = A.VIENPHI_ID        left join (select sum(GIATRIMIENGIAM) as GIATRIMIENGIAM, VIENPHI_ID, REF_TABLE        from TT_MIENGIAM_CHITIET        where REF_TABLE = 'TT_MIENGIAM_CONGTY'        and exists (select MIENGIAM_CONGTY_ID from TT_MIENGIAM_CONGTY where TT_MIENGIAM_CHITIET.MIENGIAM_ID = MIENGIAM_CONGTY_ID and TINHTRANG = 1 and TIEPNHAN_ID = '107438')        group by VIENPHI_ID, REF_TABLE) F on F.REF_TABLE = 'TT_MIENGIAM_CONGTY' and F.VIENPHI_ID = A.VIENPHI_ID        left join TT_DVYEUCAU DVYC on DVYC.DVYEUCAU_ID = A.REF_ID and A.REF_TABLE = 'TT_DVYEUCAU'        left join TM_DICHVU DV on DVYC.DICHVU_ID = DV.DICHVU_ID and A.REF_TABLE = 'TT_DVYEUCAU'        left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = DV.NHOMDICHVU_ID and A.REF_TABLE = 'TT_DVYEUCAU'        where        A.TIEPNHAN_ID = '107438' and ((DVYC.HUYYEUCAU = '0' and A.DICHVU_ID is not null)        or A.DUOC_ID is not null or A.REF_TABLE = 'TT_NUT_XACNHANSUATAN_CHITIET')        and A.ACTIVE = '1'                 and A.BENHVIEN_ID = 'HLU01'        order by A.VIENPHI_ID]
2020-02-26 17:19:23,098 [1] DEBUG - Statement Id: [DAO00006_GetListDuocTyle] PreparedStatement : [select DUOC_ID, DOITUONG_ID, (TYLE/100) as TYLE, DONGIA MUCTRAN_THANHTOAN from TM_DOITUONG_GIADUOC_TYLE            where            BENHVIEN_ID = 'HLU01'            and DOITUONG_ID = '0']
2020-02-26 17:19:23,120 [1] DEBUG - Statement Id: [DAO00027_GetListTuongTrinhDichVuPhauThuatCuaTiepNhan] PreparedStatement : [declare @ManhomDSA varchar(10);        declare @PhanLoaiNhomDV varchar(20) = '05';        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        if (@ManhomDSA is not null) set @PhanLoaiNhomDV += ',' + @ManhomDSA        select distinct ptyc.*        from TT_PHAUTHUAT_YEUCAU ptyc        inner join TM_DICHVU dv on dv.DICHVU_ID = ptyc.DICHVU_ID        inner join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID        inner join TT_PHAUTHUAT pt on pt.PHAUTHUAT_ID = ptyc.PHAUTHUAT_ID        where        pt.TIEPNHAN_ID = 107438        and (left(ndv.MANHOMDICHVU, 2) in (select * from STRING_SPLIT(@PhanLoaiNhomDV,',')) or ndv.MANHOMDICHVU in (select * from STRING_SPLIT(@PhanLoaiNhomDV,',')))]
2020-02-26 17:19:23,176 [1] DEBUG - Statement Id: [DAO00006_GetList] PreparedStatement : [select dv.*, loaiDV.MALOAIDICHVU, captren.NHOMDICHVU_ID as NHOMDICHVU_CAPTREN_ID, captren.TENNHOMDICHVU as NHOMDICHVU_CAPTREN,              nhom_dv.TENNHOMDICHVU as TENNHOMDICHVU, nhom_dv.MANHOMDICHVU,              case when dv.ATTRIBUTE5 is null then 'TT' else 'KTC' end as LOAI_CHIPHI              from TM_DICHVU as dv              left join TM_NHOMDICHVU as nhom_dv on nhom_dv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID and nhom_dv.BENHVIEN_ID = 'HLU01'              left join TM_NHOMDICHVU as captren on nhom_dv.CAPTREN_ID = captren.NHOMDICHVU_ID and captren.BENHVIEN_ID = 'HLU01'              left join TM_LOAIDICHVU loaiDV on nhom_dv.LOAIDICHVU_ID = loaiDV.LOAIDICHVU_ID and loaiDV.BENHVIEN_ID = 'HLU01'              where nhom_dv.TAMNGUNG = '0' and dv.BENHVIEN_ID = 'HLU01'              and dv.TAMNGUNG = '0'               AND                   loaiDV.MALOAIDICHVU = 'KhamBenh']
2020-02-26 17:19:23,248 [1] DEBUG - Statement Id: [DAO00023_UpdateNhieuVP] PreparedStatement : [declare @jsonVienPhi nvarchar(max) = N'[{"VIENPHI_ID":3119652,"TIEPNHAN_ID":107438,"DICHVU_ID":5492,"BENHAN_ID":0,"SOLUONG":1.0000,"DONGIA_DOANHTHU":80000.0000,"THANHTIEN_DOANHTHU":80000.00,"BHYT_TL":0.0,"BHYT_DONGIA":0.0,"BHYT_THANHTIEN":0.0,"BHYT_DONGIA_CONGKHAM_DAU":0.0,"BHYT_CONGKHAM_DAU_TYLE":0.0,"BHYT_DONGIA_CHITRA":0.0,"BHYT_THANHTIEN_CHITRA":0.0,"BENHNHAN_PHAITHANHTOAN":80000.00,"GIATRI_HOADON":0.0,"GIATRI_HOADON_DATHANHTOAN":0.0,"GIATRI_BIENLAI":0.0,"GIATRI_BIENLAI_DATHANHTOAN":0.0,"GIATRI_BENHNHAN_DATHANHTOAN":0.0,"DATHUCHIEN":"0","KHONGTHUTIEN":"0","BHYTDONGTIEN":"0","DICHVU_TL":1.0,"BHYT_DONGIA_DONGCT_DAU":0.0,"SOBHYT":null,"SOBHYT_HUONG_ID":111790,"GIATRIMIENGIAM":0.0,"GIATRIMIENGIAM_BHTN":0.0,"GIATRIMIENGIAM_THANHVIEN":0.0,"GIATRIMIENGIAM_CONGTY":0.0,"BHYT_CK2_KHONGTHANHTOAN":false,"SOLONHAP_ID":null,"DUOC_MUCTRAN_THANHTOAN":0.0,"DUOC_TYLE":0.0000}]';        begin        UPDATE TT_VIENPHI        SET        SOLUONG = json.SOLUONG,        DONGIA_DOANHTHU = json.DONGIA_DOANHTHU,        THANHTIEN_DOANHTHU = json.THANHTIEN_DOANHTHU,        BHYT_TL = json.BHYT_TL,        BHYT_DONGIA = json.BHYT_DONGIA,        BHYT_THANHTIEN = json.BHYT_THANHTIEN,        BHYT_DONGIA_CONGKHAM_DAU = json.BHYT_DONGIA_CONGKHAM_DAU,        BHYT_CONGKHAM_DAU_TYLE = json.BHYT_CONGKHAM_DAU_TYLE,        BHYT_DONGIA_CHITRA = json.BHYT_DONGIA_CHITRA,        BHYT_THANHTIEN_CHITRA = json.BHYT_THANHTIEN_CHITRA,        BENHNHAN_PHAITHANHTOAN = json.BENHNHAN_PHAITHANHTOAN,        GIATRI_HOADON = json.GIATRI_HOADON,        GIATRI_BIENLAI = json.GIATRI_BIENLAI,        DATHUCHIEN = json.DATHUCHIEN,        DICHVU_TL = json.DICHVU_TL,        BHYT_DONGIA_DONGCT_DAU = json.BHYT_DONGIA_DONGCT_DAU,        SOLONHAP_ID = json.SOLONHAP_ID,        DUOC_TYLE = json.DUOC_TYLE,        DUOC_MUCTRAN_THANHTOAN = json.DUOC_MUCTRAN_THANHTOAN,        NGAYCAPNHAT = GETDATE()        FROM OPENJSON (@jsonVienPhi)        WITH (        VIENPHI_ID int,        SOLUONG numeric(25, 4),        DONGIA_DOANHTHU numeric(25, 4),        THANHTIEN_DOANHTHU numeric(25, 4),        BHYT_TL numeric(25, 4),        BHYT_DONGIA numeric(25, 4),        BHYT_THANHTIEN numeric(25, 4),        BHYT_DONGIA_CONGKHAM_DAU numeric(25, 4),        BHYT_CONGKHAM_DAU_TYLE numeric(25, 4),        BHYT_DONGIA_CHITRA numeric(25, 4),        BHYT_THANHTIEN_CHITRA numeric(25, 4),        BENHNHAN_PHAITHANHTOAN numeric(25, 4),        GIATRI_HOADON numeric(25, 4),        GIATRI_BIENLAI numeric(25, 4),        DATHUCHIEN char(1),        KHONGTHUTIEN char(1),        BHYTDONGTIEN char(1),        DICHVU_TL numeric(25, 4),        BHYT_DONGIA_DONGCT_DAU numeric(25, 4),        SOLONHAP_ID int,        DUOC_TYLE numeric(25, 4),        DUOC_MUCTRAN_THANHTOAN numeric(25, 4))  json        WHERE TT_VIENPHI.VIENPHI_ID = json.VIENPHI_ID and json.DONGIA_DOANHTHU > 0                  insert into TT_TINH_VIENPHI_LOG        SELECT json.VIENPHI_ID, json.TIEPNHAN_ID, json.BENHAN_ID, json.SOLUONG, json.BHYT_TL, json.DONGIA_DOANHTHU,        json.THANHTIEN_DOANHTHU, json.BHYT_DONGIA, json.BHYT_THANHTIEN, json.BHYT_DONGIA_CHITRA, json.BHYT_THANHTIEN_CHITRA, json.BENHNHAN_PHAITHANHTOAN,        json.SOBHYT_HUONG_ID, json.SOBHYT, GETDATE(), -1, 'HLU01'        FROM OPENJSON(@jsonVienPhi)        WITH (        VIENPHI_ID int,        TIEPNHAN_ID int,        BENHAN_ID int,        SOLUONG numeric(25, 4),        DONGIA_DOANHTHU numeric(25, 4),        THANHTIEN_DOANHTHU numeric(25, 4),        BHYT_TL numeric(25, 4),        BHYT_DONGIA numeric(25, 4),        BHYT_THANHTIEN numeric(25, 4),        BHYT_DONGIA_CHITRA numeric(25, 4),        BHYT_THANHTIEN_CHITRA numeric(25, 4),        BENHNHAN_PHAITHANHTOAN numeric(25, 4),        SOBHYT_HUONG_ID int,        SOBHYT nvarchar(30)) json        end]
2020-02-26 17:19:23,523 [1] DEBUG - Statement Id: [DAO00067_UpdateDataVienPhiDongiaBHYT] PreparedStatement : [update TT_VIENPHI          set BHYT_DONGIA_CHITRA = 0, BHYT_THANHTIEN = 0, BHYT_THANHTIEN_CHITRA = 0          where          TIEPNHAN_ID = 107438 and BHYT_DONGIA = 0          and (BHYT_DONGIA_CHITRA > 0 or BHYT_THANHTIEN > 0 or BHYT_THANHTIEN_CHITRA > 0)]
2020-02-26 17:19:23,555 [1] DEBUG - Statement Id: [DAO00067_CapnhatDataVienphiKhiHuyThanhtoanHoadon] PreparedStatement : [update TT_VIENPHI        set TT_VIENPHI.HOADON_ID = hdct.HOADON_ID, TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN = TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN + hdct.GIATRI_BENHNHAN_DATHANHTOAN        from (select CT.HOADON_ID, CT.VIENPHI_ID, CT.GIATRI_BENHNHAN_DATHANHTOAN        from TT_HOADON_CHITIET_NGOAITRU CT        join TT_HOADON HD on HD.HOADON_ID = CT.HOADON_ID        join TT_VIENPHI vp on vp.VIENPHI_ID = ct.VIENPHI_ID        where HD.DATHANHTOAN = 1 and HD.HUYHOADON = 0 and HD.HOANTRA = 0 and vp.TIEPNHAN_ID =  @param0 ) hdct        where        TT_VIENPHI.VIENPHI_ID = hdct.VIENPHI_ID and TT_VIENPHI.HOADON_ID is null and isnull(TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN,0) = 0        and TT_VIENPHI.TIEPNHAN_ID =  @param0           update TT_VIENPHI        set TT_VIENPHI.HOADON_ID = null, TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN = TT_VIENPHI.GIATRI_BENHNHAN_DATHANHTOAN - hdct.GIATRI_BENHNHAN_DATHANHTOAN,        TT_VIENPHI.DATHANHTOAN = '0'        from (select CT.HOADON_ID, CT.VIENPHI_ID, CT.GIATRI_BENHNHAN_DATHANHTOAN        from TT_HOADON_CHITIET_NGOAITRU CT        join TT_HOADON HD on HD.HOADON_ID = CT.HOADON_ID        join TT_VIENPHI vp on vp.VIENPHI_ID = ct.VIENPHI_ID and vp.HOADON_ID = ct.HOADON_ID        where HD.DATHANHTOAN = 0 and (HD.HUYHOADON = 1 or HD.HOANTRA = 1) and vp.TIEPNHAN_ID =  @param0 ) hdct        where        TT_VIENPHI.VIENPHI_ID = hdct.VIENPHI_ID and TT_VIENPHI.HOADON_ID = hdct.HOADON_ID        and TT_VIENPHI.TIEPNHAN_ID =  @param0]
2020-02-26 17:19:23,555 [1] DEBUG - Statement Id: [DAO00067_CapnhatDataVienphiKhiHuyThanhtoanHoadon] Parameters: [@param0=[TIEPNHAN_ID,107438]]
2020-02-26 17:19:23,555 [1] DEBUG - Statement Id: [DAO00067_CapnhatDataVienphiKhiHuyThanhtoanHoadon] Types: [@param0=[Int64, System.Int64]]
2020-02-26 17:19:23,587 [1] DEBUG - Statement Id: [DAO00000_GetDoiTuongIsBHYT] PreparedStatement : [select * from TM_DOITUONG Where DOITUONG_ID = 1 and MADOITUONG like '%BHYT%']
2020-02-26 17:19:23,664 [1] DEBUG - Statement Id: [DAO00064_GetNgayDangKyDichVu] PreparedStatement : [SELECT        DISTINCT CONVERT(date, NGAYTAO) as NGAYCHIPHI        FROM TT_VIENPHI        WHERE        TIEPNHAN_ID = '107438'                 ORDER BY NGAYCHIPHI]
2020-02-26 17:19:23,758 [1] DEBUG - Statement Id: [DAO00064_GetAllNgayYeucauDV] PreparedStatement : [SELECT        DISTINCT DVYEUCAU_ID, DICHVU_ID, CONVERT(date, NGAYYEUCAU) NGAYYEUCAU        FROM TT_DVYEUCAU        WHERE        TIEPNHAN_ID = '107438']
2020-02-26 17:19:23,785 [1] DEBUG - Statement Id: [DAO00064_TT_VIENPHI_GetList] PreparedStatement : [select distinct a.*, b.TINHTRANG AS TINHTRANG_MG, d.TINHTRANG_BHTN, e.TINHTRANG_MGCT        , b.MIENGIAMCHITIET_ID, b.GIATRIMIENGIAM, d.GIATRIMIENGIAM_BHTN, e.GIATRIMIENGIAM_CONGTY, e.GIATRIMIENGIAM_CONGTY as GIATRIMIENGIAM_CTCT, f.GIATRIMIENGIAM_THANHVIEN        , c.DVKEMTHEO, c.DVKEMTHEO_KHACEKIP, isnull(ttnt.PHONGBANRATOA_ID,c.NOIYEUCAU_ID) NOIYEUCAU_ID, c.NOITHUCHIEN_ID, c.DVYEUCAU_ID, c.HUYYEUCAU, c.DANGKY_ID,        isnull(dv.TENDICHVU, dc.TENDUOCDAYDU) NOIDUNG, isnull(dv.MADICHVU, dc.MADUOC) MADICHVU, dv.NORESULT, dc.DONVITINH, ld.MALOAIDUOC, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ndv.MANHOMDICHVU,        dv.BHYT DV_BHYT        from        (select VP.*, sbh.SOBHYT as SOBHYT_HUONG        from TT_VIENPHI VP        left join TT_TIEPNHAN_SOTHEBHYT sbh on sbh.SOBHYT_HUONG_ID = VP.SOBHYT_HUONG_ID        where        ((isnull(VP.GIATRI_BENHNHAN_DATHANHTOAN, 0) = 0 and isnull(VP.DATHANHTOAN, 0) = 0)        and VP.REF_TABLE != 'TT_MAU_CHUNGTU_CHITIET'                 )         and           VP.TIEPNHAN_ID = '107438'         and           VP.BENHVIEN_ID = 'HLU01'                 )a left join                   (        select VIENPHI_ID, MG.TINHTRANG, MGCT.MIENGIAMCHITIET_ID, Sum(MGCT.GIATRIMIENGIAM) as GIATRIMIENGIAM        from TT_MIENGIAM MG INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_ID = MGCT.MIENGIAM_ID        where MG.TIEPNHAN_ID= '107438' and MGCT.REF_TABLE = 'TT_MIENGIAM'        group by VIENPHI_ID, MG.TINHTRANG, MGCT.MIENGIAMCHITIET_ID        )b        on a.VIENPHI_ID = b.VIENPHI_ID          left join(        select VIENPHI_ID, MG.TINHTRANG AS TINHTRANG_BHTN, SUM(MGCT.GIATRIMIENGIAM) as GIATRIMIENGIAM_BHTN        from TT_MIENGIAM_BHTN MG INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_BHTN_ID = MGCT.MIENGIAM_ID        where MG.TIEPNHAN_ID= '107438' and MGCT.REF_TABLE = 'TT_MIENGIAM_BHTN'        group by VIENPHI_ID, MG.TINHTRANG        )d        on a.VIENPHI_ID = d.VIENPHI_ID          left join(        select VIENPHI_ID, MG.TINHTRANG AS TINHTRANG_MGCT, Sum(MGCT.GIATRIMIENGIAM) as GIATRIMIENGIAM_CONGTY        from TT_MIENGIAM_CONGTY MG INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_CONGTY_ID = MGCT.MIENGIAM_ID        where MG.TIEPNHAN_ID= '107438' and MGCT.REF_TABLE = 'TT_MIENGIAM_CONGTY'        group by VIENPHI_ID, MG.TINHTRANG        )e        on a.VIENPHI_ID = e.VIENPHI_ID          left join(        select VIENPHI_ID, MG.TINHTRANG AS TINHTRANG_MGCT, Sum(MGCT.GIATRIMIENGIAM) as GIATRIMIENGIAM_THANHVIEN        from TT_MIENGIAM_THANHVIEN MG INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_THANHVIEN_ID = MGCT.MIENGIAM_ID        where MG.TIEPNHAN_ID= '107438' and MGCT.REF_TABLE = 'TT_MIENGIAM_THANHVIEN'        group by VIENPHI_ID, MG.TINHTRANG        )f        on a.VIENPHI_ID = f.VIENPHI_ID          left join        (        select DVYEUCAU_ID, TRANGTHAI, BHYTDONGTIEN, HUYYEUCAU, DVKEMTHEO, DVKEMTHEO_KHACEKIP, NOIYEUCAU_ID, NOITHUCHIEN_ID, DANGKY_ID from TT_DVYEUCAU        where TIEPNHAN_ID = '107438'        )c on c.DVYEUCAU_ID = a.REF_ID and a.REF_TABLE = 'TT_DVYEUCAU'        left join        (        select PHONGBANRATOA_ID, TOATHUOC_ID, 'TT_NOITRU_TOATHUOC' REF_TABLE  from TT_NOITRU_TOATHUOC where TIEPNHAN_ID  = '107438'        union        select PHONGBAN_ID as PHONGBANRATOA_ID, CLSKETQUA_VTYT_ID as TOATHUOC_ID, 'TT_CLSKETQUA_VTYT' REF_TABLE        from TT_CLSKETQUA_VTYT where exists (select DVYEUCAU_ID from TT_DVYEUCAU where TT_CLSKETQUA_VTYT.DVYEUCAU_ID = DVYEUCAU_ID and TIEPNHAN_ID  = '107438')        union        select PHONGBAN_ID as PHONGBANRATOA_ID, KHAMBENH_VTYT_ID as TOATHUOC_ID, 'TT_NGOAITRU_KHAMBENH_VTYT' REF_TABLE        from TT_NGOAITRU_KHAMBENH_VTYT where exists (select DVYEUCAU_ID from TT_DVYEUCAU where TT_NGOAITRU_KHAMBENH_VTYT.DVYEUCAU_ID = DVYEUCAU_ID and  TIEPNHAN_ID  = '107438')        union        select B.PHONGBANTHUCHIEN_ID as PHONGBANRATOA_ID, PHAUTHUAT_VTYT_ID as TOATHUOC_ID, 'TT_PHAUTHUAT_VTYT' REF_TABLE        from TT_PHAUTHUAT_VTYT A        left join TT_PHAUTHUAT B on A.PHAUTHUAT_ID = B.PHAUTHUAT_ID        where B.TIEPNHAN_ID  = '107438'        union        select B.PHONGBAN_ID as PHONGBANRATOA_ID, TOATHUOC_ID, 'TT_NGOAITRU_TOATHUOC' REF_TABLE        from TT_NGOAITRU_TOATHUOC A        left join TT_NGOAITRU_KHAMBENH B on A.KHAMBENH_ID = B.KHAMBENH_ID        where B.TIEPNHAN_ID  = '107438'        ) ttnt on ttnt.TOATHUOC_ID = a.REF_ID and a.REF_TABLE = ttnt.REF_TABLE        left join TM_DUOC dc on A.DUOC_ID = dc.DUOC_ID        left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID        left join TM_DICHVU dv on A.DICHVU_ID = dv.DICHVU_ID and A.REF_TABLE = 'TT_DVYEUCAU'        left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID        where        c.HUYYEUCAU = '0' or c.HUYYEUCAU is null]
2020-02-26 17:19:24,718 [1] DEBUG - Statement Id: [DAO00330_TT_VIENPHI_GetList] PreparedStatement : [select distinct a.*, b.TINHTRANG AS TINHTRANG_MG, d.TINHTRANG_BHTN, e.TINHTRANG_MGCT      , b.MIENGIAMCHITIET_ID, b.GIATRIMIENGIAM, d.GIATRIMIENGIAM_BHTN, e.GIATRIMIENGIAM_CONGTY, e.GIATRIMIENGIAM_CONGTY as GIATRIMIENGIAM_CTCT, f.GIATRIMIENGIAM_THANHVIEN      , NULL AS DVKEMTHEO, NULL AS DVKEMTHEO_KHACEKIP, ttnt.PHONGBANRATOA_ID NOIYEUCAU_ID, NULL AS NOITHUCHIEN_ID, NULL AS DVYEUCAU_ID, 0 AS HUYYEUCAU, NULL AS DANGKY_ID,      dc.TENMAU NOIDUNG, dc.MAMAU MADICHVU, NULL AS NORESULT, DVT.TENDONVITINH AS DONVITINH, ld.MALOAIMAU AS MALOAIDUOC, DC.BHYT AS DUOC_BHYT, 'M' AS LOAIVATTU_ID,NM.TENNHOMMAU AS MANHOMDICHVU      from      (select VP.*, sbh.SOBHYT as SOBHYT_HUONG      from TT_VIENPHI VP      left join TT_TIEPNHAN_SOTHEBHYT sbh on sbh.SOBHYT_HUONG_ID = VP.SOBHYT_HUONG_ID      where (VP.GIATRI_BENHNHAN_DATHANHTOAN = 0 or VP.GIATRI_BENHNHAN_DATHANHTOAN is null)       and             VP.TIEPNHAN_ID = '107438'           and             VP.BENHVIEN_ID = 'HLU01'                   )a left join                       (      select VIENPHI_ID, MG.TINHTRANG, MGCT.MIENGIAMCHITIET_ID, MGCT.GIATRIMIENGIAM      from TT_MIENGIAM MG INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_ID = MGCT.MIENGIAM_ID      where      MG.TIEPNHAN_ID= '107438' and MGCT.REF_TABLE = 'TT_MIENGIAM'      )b      on a.VIENPHI_ID = b.VIENPHI_ID        left join(      select VIENPHI_ID, MG.TINHTRANG AS TINHTRANG_BHTN, MGCT.GIATRIMIENGIAM as GIATRIMIENGIAM_BHTN      from TT_MIENGIAM_BHTN MG INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_BHTN_ID = MGCT.MIENGIAM_ID      where      MG.TIEPNHAN_ID= '107438' and MGCT.REF_TABLE = 'TT_MIENGIAM_BHTN'      )d      on a.VIENPHI_ID = d.VIENPHI_ID        left join(      select VIENPHI_ID, MG.TINHTRANG AS TINHTRANG_MGCT, MGCT.GIATRIMIENGIAM as GIATRIMIENGIAM_CONGTY      from TT_MIENGIAM_CONGTY MG INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_CONGTY_ID = MGCT.MIENGIAM_ID      where      MG.TIEPNHAN_ID= '107438' and MGCT.REF_TABLE = 'TT_MIENGIAM_CONGTY'      )e      on a.VIENPHI_ID = e.VIENPHI_ID        left join(      select VIENPHI_ID, MG.TINHTRANG AS TINHTRANG_MGCT, MGCT.GIATRIMIENGIAM as GIATRIMIENGIAM_THANHVIEN      from TT_MIENGIAM_THANHVIEN MG INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_THANHVIEN_ID = MGCT.MIENGIAM_ID      where      MG.TIEPNHAN_ID= '107438' and MGCT.REF_TABLE = 'TT_MIENGIAM_THANHVIEN'      )f      on a.VIENPHI_ID = f.VIENPHI_ID      inner join      (      select DK.NOICHIDINH_ID as PHONGBANRATOA_ID, CT.CHUNGTUCHITIET_ID, 'TT_MAU_CHUNGTU_CHITIET' REF_TABLE      from TT_MAU_DANGKYMAU DK JOIN TT_MAU_DANGKYMAU_CHITIET DKCT ON DK.DANGKYMAU_ID = DKCT.DANGKYMAU_ID AND DK.TIEPNHAN_ID  = '107438'      INNER JOIN TT_MAU_CHUNGTU CTU ON DKCT.CHUNGTU_ID = CTU.CHUNGTU_ID AND CTU.CHUNGTULIENQUAN_ID IS NULL      JOIN TT_MAU_CHUNGTU_CHITIET CT ON CT.CHUNGTU_ID=CTU.CHUNGTU_ID      ) ttnt on ttnt.CHUNGTUCHITIET_ID = a.REF_ID and a.REF_TABLE = ttnt.REF_TABLE      left join TM_MAU dc on A.DUOC_ID = dc.MAU_ID      LEFT JOIN TM_MAU_DONVITINH DVT ON DC.DONVITINH_ID = DVT.DONVITINH_ID      left join TM_MAU_LOAIMAU ld on dc.LOAIMAU_ID = ld.LOAIMAU_ID      LEFT JOIN TM_MAU_NHOMMAU NM ON NM.NHOMMAU_ID = LD.NHOMMAU_ID]
2020-02-26 17:19:25,357 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN200226.0000001']
2020-02-26 17:19:25,380 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"5492","DVYEUCAU_ID":"992278"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"5492","DVYEUCAU_ID":"992278"}' order by ID desc)        order by A.ID desc]
2020-02-26 17:19:25,633 [1] DEBUG - Statement Id: [DAO00017_GetLoaiGiaDoiTuongDichVu] PreparedStatement : [select a.LOAIGIA_ID, a.TENLOAIGIA, a.MALOAIGIA, a.CAPTREN_ID, MIN(a.UUTIEN_NGUON) AS UUTIEN_NGUON          , MAX(a.DOUUTIEN) AS DOUUTIEN, MIN(ISNULL(a.GIAHOTRO,0)) AS GIAHOTRO          from(                        select distinct A.LOAIGIA_ID, C.TENLOAIGIA, C.MALOAIGIA, 0 as UUTIEN_NGUON, isnull(B.DOUUTIEN,0) as DOUUTIEN, B.GIAHOTRO, C.CAPTREN_ID            from TM_DOITUONG_GIADICHVU A            left join TM_DOITUONG_LOAIGIA B on A.LOAIGIA_ID = B.LOAIGIA_ID and A.DOITUONG_ID = B.DOITUONG_ID and B.BENHVIEN_ID = 'HLU01'            inner join TM_LOAIGIA C on A.LOAIGIA_ID = C.LOAIGIA_ID and C.BENHVIEN_ID = 'HLU01'            where A.DOITUONG_ID = '1'                            and C.CAPTREN_ID = (select LOAIGIA_ID from TM_LOAIGIA              where MALOAIGIA = 'GiaDichVu'              and BENHVIEN_ID = 'HLU01')                         and A.BENHVIEN_ID = 'HLU01'                     ) a          where a.DOUUTIEN != 0 and a.DOUUTIEN is not null          group by a.LOAIGIA_ID, a.TENLOAIGIA, a.MALOAIGIA, a.CAPTREN_ID          order by MAX(a.UUTIEN_NGUON) desc ,MAX(a.DOUUTIEN) asc]
2020-02-26 17:19:25,863 [1] DEBUG - Statement Id: [DAO00019_Get_TiepNhan_ThongtinChuyenVien] PreparedStatement : [select CHANDOANNGT, ICDNOIGIOITHIEU_ID, LYDOCHUYENVIEN_ID, NOIGIOITHIEU_ID, HINHTHUCCHUYENVIEN_ID, THOIGIANCHUYENTUYEN, SOCHUYENVIEN        from TT_TIEPNHAN        where TIEPNHAN_ID = '107438']
2020-02-26 17:19:25,935 [1] DEBUG - Statement Id: [DAO00019_GetBenhNhanThanhVien] PreparedStatement : [select A.*, B.TENTHETHANHVIEN, convert(varchar, A.NGAYHIEULUC, 103) as NGAYHIEULUCTHE, B.SOTIEN        from TT_CSKH_THANHVIEN_CAPTHE A        left join TM_CSKH_THETHANHVIEN B on B.THETHANHVIEN_ID = A.THETHANHVIEN_ID        where   THANHVIEN_ID in (        select THANHVIEN_ID from TT_CSKH_THANHVIEN        where (BENHNHAN_ID = '74322' and TAMNGUNG is null or TAMNGUNG = '0')        and (DAXOA is null or DAXOA = '0'))        and A.KICHHOAT = '1' and (A.TAMNGUNG = '0' or A.TAMNGUNG is null)                 and A.BENHVIEN_ID = 'HLU01'        order by THE_ID desc]
2020-02-26 17:19:25,979 [1] DEBUG - Statement Id: [DAO00019_GetBenhNhanThanhVien] PreparedStatement : [select A.*, B.TENTHETHANHVIEN, convert(varchar, A.NGAYHIEULUC, 103) as NGAYHIEULUCTHE, B.SOTIEN        from TT_CSKH_THANHVIEN_CAPTHE A        left join TM_CSKH_THETHANHVIEN B on B.THETHANHVIEN_ID = A.THETHANHVIEN_ID        where   THANHVIEN_ID in (        select THANHVIEN_ID from TT_CSKH_THANHVIEN        where (BENHNHAN_ID = '74322' and TAMNGUNG is null or TAMNGUNG = '0')        and (DAXOA is null or DAXOA = '0'))        and A.KICHHOAT = '1' and (A.TAMNGUNG = '0' or A.TAMNGUNG is null)                 and A.BENHVIEN_ID = 'HLU01'        order by THE_ID desc]
2020-02-26 17:19:40,395 [1] DEBUG - Statement Id: [DAO00000_GetKyHieuBHYT] PreparedStatement : [select * from TM_DOITUONG where NHOMTHE LIKE '%' +  @param0  + '%']
2020-02-26 17:19:40,395 [1] DEBUG - Statement Id: [DAO00000_GetKyHieuBHYT] Parameters: [@param0=[MATHEBHYT,DN4]]
2020-02-26 17:19:40,395 [1] DEBUG - Statement Id: [DAO00000_GetKyHieuBHYT] Types: [@param0=[String, System.String]]
2020-02-26 17:19:49,313 [1] DEBUG - Statement Id: [DAO00064_GetNgayDangKyDichVu] PreparedStatement : [SELECT        DISTINCT CONVERT(date, NGAYTAO) as NGAYCHIPHI        FROM TT_VIENPHI        WHERE        TIEPNHAN_ID = '107438'                 ORDER BY NGAYCHIPHI]
2020-02-26 17:19:49,334 [1] DEBUG - Statement Id: [DAO00064_GetAllNgayYeucauDV] PreparedStatement : [SELECT        DISTINCT DVYEUCAU_ID, DICHVU_ID, CONVERT(date, NGAYYEUCAU) NGAYYEUCAU        FROM TT_DVYEUCAU        WHERE        TIEPNHAN_ID = '107438']
2020-02-26 17:19:49,359 [1] DEBUG - Statement Id: [DAO00064_TT_VIENPHI_GetList] PreparedStatement : [select distinct a.*, b.TINHTRANG AS TINHTRANG_MG, d.TINHTRANG_BHTN, e.TINHTRANG_MGCT        , b.MIENGIAMCHITIET_ID, b.GIATRIMIENGIAM, d.GIATRIMIENGIAM_BHTN, e.GIATRIMIENGIAM_CONGTY, e.GIATRIMIENGIAM_CONGTY as GIATRIMIENGIAM_CTCT, f.GIATRIMIENGIAM_THANHVIEN        , c.DVKEMTHEO, c.DVKEMTHEO_KHACEKIP, isnull(ttnt.PHONGBANRATOA_ID,c.NOIYEUCAU_ID) NOIYEUCAU_ID, c.NOITHUCHIEN_ID, c.DVYEUCAU_ID, c.HUYYEUCAU, c.DANGKY_ID,        isnull(dv.TENDICHVU, dc.TENDUOCDAYDU) NOIDUNG, isnull(dv.MADICHVU, dc.MADUOC) MADICHVU, dv.NORESULT, dc.DONVITINH, ld.MALOAIDUOC, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ndv.MANHOMDICHVU,        dv.BHYT DV_BHYT        from        (select VP.*, sbh.SOBHYT as SOBHYT_HUONG        from TT_VIENPHI VP        left join TT_TIEPNHAN_SOTHEBHYT sbh on sbh.SOBHYT_HUONG_ID = VP.SOBHYT_HUONG_ID        where        ((isnull(VP.GIATRI_BENHNHAN_DATHANHTOAN, 0) = 0 and isnull(VP.DATHANHTOAN, 0) = 0)        and VP.REF_TABLE != 'TT_MAU_CHUNGTU_CHITIET'                 )         and           VP.TIEPNHAN_ID = '107438'         and           VP.BENHVIEN_ID = 'HLU01'                 )a left join                   (        select VIENPHI_ID, MG.TINHTRANG, MGCT.MIENGIAMCHITIET_ID, Sum(MGCT.GIATRIMIENGIAM) as GIATRIMIENGIAM        from TT_MIENGIAM MG INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_ID = MGCT.MIENGIAM_ID        where MG.TIEPNHAN_ID= '107438' and MGCT.REF_TABLE = 'TT_MIENGIAM'        group by VIENPHI_ID, MG.TINHTRANG, MGCT.MIENGIAMCHITIET_ID        )b        on a.VIENPHI_ID = b.VIENPHI_ID          left join(        select VIENPHI_ID, MG.TINHTRANG AS TINHTRANG_BHTN, SUM(MGCT.GIATRIMIENGIAM) as GIATRIMIENGIAM_BHTN        from TT_MIENGIAM_BHTN MG INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_BHTN_ID = MGCT.MIENGIAM_ID        where MG.TIEPNHAN_ID= '107438' and MGCT.REF_TABLE = 'TT_MIENGIAM_BHTN'        group by VIENPHI_ID, MG.TINHTRANG        )d        on a.VIENPHI_ID = d.VIENPHI_ID          left join(        select VIENPHI_ID, MG.TINHTRANG AS TINHTRANG_MGCT, Sum(MGCT.GIATRIMIENGIAM) as GIATRIMIENGIAM_CONGTY        from TT_MIENGIAM_CONGTY MG INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_CONGTY_ID = MGCT.MIENGIAM_ID        where MG.TIEPNHAN_ID= '107438' and MGCT.REF_TABLE = 'TT_MIENGIAM_CONGTY'        group by VIENPHI_ID, MG.TINHTRANG        )e        on a.VIENPHI_ID = e.VIENPHI_ID          left join(        select VIENPHI_ID, MG.TINHTRANG AS TINHTRANG_MGCT, Sum(MGCT.GIATRIMIENGIAM) as GIATRIMIENGIAM_THANHVIEN        from TT_MIENGIAM_THANHVIEN MG INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_THANHVIEN_ID = MGCT.MIENGIAM_ID        where MG.TIEPNHAN_ID= '107438' and MGCT.REF_TABLE = 'TT_MIENGIAM_THANHVIEN'        group by VIENPHI_ID, MG.TINHTRANG        )f        on a.VIENPHI_ID = f.VIENPHI_ID          left join        (        select DVYEUCAU_ID, TRANGTHAI, BHYTDONGTIEN, HUYYEUCAU, DVKEMTHEO, DVKEMTHEO_KHACEKIP, NOIYEUCAU_ID, NOITHUCHIEN_ID, DANGKY_ID from TT_DVYEUCAU        where TIEPNHAN_ID = '107438'        )c on c.DVYEUCAU_ID = a.REF_ID and a.REF_TABLE = 'TT_DVYEUCAU'        left join        (        select PHONGBANRATOA_ID, TOATHUOC_ID, 'TT_NOITRU_TOATHUOC' REF_TABLE  from TT_NOITRU_TOATHUOC where TIEPNHAN_ID  = '107438'        union        select PHONGBAN_ID as PHONGBANRATOA_ID, CLSKETQUA_VTYT_ID as TOATHUOC_ID, 'TT_CLSKETQUA_VTYT' REF_TABLE        from TT_CLSKETQUA_VTYT where exists (select DVYEUCAU_ID from TT_DVYEUCAU where TT_CLSKETQUA_VTYT.DVYEUCAU_ID = DVYEUCAU_ID and TIEPNHAN_ID  = '107438')        union        select PHONGBAN_ID as PHONGBANRATOA_ID, KHAMBENH_VTYT_ID as TOATHUOC_ID, 'TT_NGOAITRU_KHAMBENH_VTYT' REF_TABLE        from TT_NGOAITRU_KHAMBENH_VTYT where exists (select DVYEUCAU_ID from TT_DVYEUCAU where TT_NGOAITRU_KHAMBENH_VTYT.DVYEUCAU_ID = DVYEUCAU_ID and  TIEPNHAN_ID  = '107438')        union        select B.PHONGBANTHUCHIEN_ID as PHONGBANRATOA_ID, PHAUTHUAT_VTYT_ID as TOATHUOC_ID, 'TT_PHAUTHUAT_VTYT' REF_TABLE        from TT_PHAUTHUAT_VTYT A        left join TT_PHAUTHUAT B on A.PHAUTHUAT_ID = B.PHAUTHUAT_ID        where B.TIEPNHAN_ID  = '107438'        union        select B.PHONGBAN_ID as PHONGBANRATOA_ID, TOATHUOC_ID, 'TT_NGOAITRU_TOATHUOC' REF_TABLE        from TT_NGOAITRU_TOATHUOC A        left join TT_NGOAITRU_KHAMBENH B on A.KHAMBENH_ID = B.KHAMBENH_ID        where B.TIEPNHAN_ID  = '107438'        ) ttnt on ttnt.TOATHUOC_ID = a.REF_ID and a.REF_TABLE = ttnt.REF_TABLE        left join TM_DUOC dc on A.DUOC_ID = dc.DUOC_ID        left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID        left join TM_DICHVU dv on A.DICHVU_ID = dv.DICHVU_ID and A.REF_TABLE = 'TT_DVYEUCAU'        left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID        where        c.HUYYEUCAU = '0' or c.HUYYEUCAU is null]
2020-02-26 17:19:49,520 [1] DEBUG - Statement Id: [DAO00330_TT_VIENPHI_GetList] PreparedStatement : [select distinct a.*, b.TINHTRANG AS TINHTRANG_MG, d.TINHTRANG_BHTN, e.TINHTRANG_MGCT      , b.MIENGIAMCHITIET_ID, b.GIATRIMIENGIAM, d.GIATRIMIENGIAM_BHTN, e.GIATRIMIENGIAM_CONGTY, e.GIATRIMIENGIAM_CONGTY as GIATRIMIENGIAM_CTCT, f.GIATRIMIENGIAM_THANHVIEN      , NULL AS DVKEMTHEO, NULL AS DVKEMTHEO_KHACEKIP, ttnt.PHONGBANRATOA_ID NOIYEUCAU_ID, NULL AS NOITHUCHIEN_ID, NULL AS DVYEUCAU_ID, 0 AS HUYYEUCAU, NULL AS DANGKY_ID,      dc.TENMAU NOIDUNG, dc.MAMAU MADICHVU, NULL AS NORESULT, DVT.TENDONVITINH AS DONVITINH, ld.MALOAIMAU AS MALOAIDUOC, DC.BHYT AS DUOC_BHYT, 'M' AS LOAIVATTU_ID,NM.TENNHOMMAU AS MANHOMDICHVU      from      (select VP.*, sbh.SOBHYT as SOBHYT_HUONG      from TT_VIENPHI VP      left join TT_TIEPNHAN_SOTHEBHYT sbh on sbh.SOBHYT_HUONG_ID = VP.SOBHYT_HUONG_ID      where (VP.GIATRI_BENHNHAN_DATHANHTOAN = 0 or VP.GIATRI_BENHNHAN_DATHANHTOAN is null)       and             VP.TIEPNHAN_ID = '107438'           and             VP.BENHVIEN_ID = 'HLU01'                   )a left join                       (      select VIENPHI_ID, MG.TINHTRANG, MGCT.MIENGIAMCHITIET_ID, MGCT.GIATRIMIENGIAM      from TT_MIENGIAM MG INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_ID = MGCT.MIENGIAM_ID      where      MG.TIEPNHAN_ID= '107438' and MGCT.REF_TABLE = 'TT_MIENGIAM'      )b      on a.VIENPHI_ID = b.VIENPHI_ID        left join(      select VIENPHI_ID, MG.TINHTRANG AS TINHTRANG_BHTN, MGCT.GIATRIMIENGIAM as GIATRIMIENGIAM_BHTN      from TT_MIENGIAM_BHTN MG INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_BHTN_ID = MGCT.MIENGIAM_ID      where      MG.TIEPNHAN_ID= '107438' and MGCT.REF_TABLE = 'TT_MIENGIAM_BHTN'      )d      on a.VIENPHI_ID = d.VIENPHI_ID        left join(      select VIENPHI_ID, MG.TINHTRANG AS TINHTRANG_MGCT, MGCT.GIATRIMIENGIAM as GIATRIMIENGIAM_CONGTY      from TT_MIENGIAM_CONGTY MG INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_CONGTY_ID = MGCT.MIENGIAM_ID      where      MG.TIEPNHAN_ID= '107438' and MGCT.REF_TABLE = 'TT_MIENGIAM_CONGTY'      )e      on a.VIENPHI_ID = e.VIENPHI_ID        left join(      select VIENPHI_ID, MG.TINHTRANG AS TINHTRANG_MGCT, MGCT.GIATRIMIENGIAM as GIATRIMIENGIAM_THANHVIEN      from TT_MIENGIAM_THANHVIEN MG INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_THANHVIEN_ID = MGCT.MIENGIAM_ID      where      MG.TIEPNHAN_ID= '107438' and MGCT.REF_TABLE = 'TT_MIENGIAM_THANHVIEN'      )f      on a.VIENPHI_ID = f.VIENPHI_ID      inner join      (      select DK.NOICHIDINH_ID as PHONGBANRATOA_ID, CT.CHUNGTUCHITIET_ID, 'TT_MAU_CHUNGTU_CHITIET' REF_TABLE      from TT_MAU_DANGKYMAU DK JOIN TT_MAU_DANGKYMAU_CHITIET DKCT ON DK.DANGKYMAU_ID = DKCT.DANGKYMAU_ID AND DK.TIEPNHAN_ID  = '107438'      INNER JOIN TT_MAU_CHUNGTU CTU ON DKCT.CHUNGTU_ID = CTU.CHUNGTU_ID AND CTU.CHUNGTULIENQUAN_ID IS NULL      JOIN TT_MAU_CHUNGTU_CHITIET CT ON CT.CHUNGTU_ID=CTU.CHUNGTU_ID      ) ttnt on ttnt.CHUNGTUCHITIET_ID = a.REF_ID and a.REF_TABLE = ttnt.REF_TABLE      left join TM_MAU dc on A.DUOC_ID = dc.MAU_ID      LEFT JOIN TM_MAU_DONVITINH DVT ON DC.DONVITINH_ID = DVT.DONVITINH_ID      left join TM_MAU_LOAIMAU ld on dc.LOAIMAU_ID = ld.LOAIMAU_ID      LEFT JOIN TM_MAU_NHOMMAU NM ON NM.NHOMMAU_ID = LD.NHOMMAU_ID]
2020-02-26 17:19:49,556 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN200226.0000001']
2020-02-26 17:19:49,578 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"5492","DVYEUCAU_ID":"992278"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"5492","DVYEUCAU_ID":"992278"}' order by ID desc)        order by A.ID desc]
2020-02-26 17:19:49,617 [1] DEBUG - Statement Id: [DAO00017_GetLoaiGiaDoiTuongDichVu] PreparedStatement : [select a.LOAIGIA_ID, a.TENLOAIGIA, a.MALOAIGIA, a.CAPTREN_ID, MIN(a.UUTIEN_NGUON) AS UUTIEN_NGUON          , MAX(a.DOUUTIEN) AS DOUUTIEN, MIN(ISNULL(a.GIAHOTRO,0)) AS GIAHOTRO          from(                        select distinct A.LOAIGIA_ID, C.TENLOAIGIA, C.MALOAIGIA, 0 as UUTIEN_NGUON, isnull(B.DOUUTIEN,0) as DOUUTIEN, B.GIAHOTRO, C.CAPTREN_ID            from TM_DOITUONG_GIADICHVU A            left join TM_DOITUONG_LOAIGIA B on A.LOAIGIA_ID = B.LOAIGIA_ID and A.DOITUONG_ID = B.DOITUONG_ID and B.BENHVIEN_ID = 'HLU01'            inner join TM_LOAIGIA C on A.LOAIGIA_ID = C.LOAIGIA_ID and C.BENHVIEN_ID = 'HLU01'            where A.DOITUONG_ID = '1'                            and C.CAPTREN_ID = (select LOAIGIA_ID from TM_LOAIGIA              where MALOAIGIA = 'GiaDichVu'              and BENHVIEN_ID = 'HLU01')                         and A.BENHVIEN_ID = 'HLU01'                     ) a          where a.DOUUTIEN != 0 and a.DOUUTIEN is not null          group by a.LOAIGIA_ID, a.TENLOAIGIA, a.MALOAIGIA, a.CAPTREN_ID          order by MAX(a.UUTIEN_NGUON) desc ,MAX(a.DOUUTIEN) asc]
2020-02-26 17:19:49,787 [1] DEBUG - Statement Id: [DAO00064_TT_TIEPNHAN_GetHoanThanh] PreparedStatement : [select *        from TT_TIEPNHAN        where        TIEPNHAN_ID = '107438'        and TRANGTHAI  = 'HOANTHANH']
2020-02-26 17:19:49,855 [1] DEBUG - Statement Id: [DAO00064_CheckBenhNhanDaXacNhanBHYT] PreparedStatement : [IF EXISTS (SELECT XACNHANCHIPHI_ID FROM TT_XACNHANCHIPHI WHERE TIEPNHAN_ID = 107438)        BEGIN        SELECT 1 AS RESULT        END        ELSE        BEGIN        SELECT 0 AS RESULT        END]
2020-02-26 17:19:49,933 [1] DEBUG - Statement Id: [DAO00095_GetDetail] PreparedStatement : [select distinct TT_BENHNHAN.*, ISNULL(TT_BENHNHAN.NGAYSINH, TT_BENHNHAN.NAMSINH) AS NGAYNAMSINH, TN1.SOBHYT AS SOTHE, TN1.NGAYTIEPNHAN          from TT_BENHNHAN          left join (          select MAX(TIEPNHAN_ID) AS TIEPNHAN_ID, BENHNHAN_ID from TT_TIEPNHAN GROUP BY BENHNHAN_ID) TN ON TN.BENHNHAN_ID = TT_BENHNHAN.BENHNHAN_ID          left join TT_TIEPNHAN TN1 ON TN1.TIEPNHAN_ID = TN.TIEPNHAN_ID           WHERE                TN1.SOBHYT = 'DN452223445533438289']
2020-02-26 17:20:18,322 [1] DEBUG - Statement Id: [DAO00064_TT_TIEPNHAN_GetHoanThanh] PreparedStatement : [select *        from TT_TIEPNHAN        where        TIEPNHAN_ID = '107438'        and TRANGTHAI  = 'HOANTHANH']
2020-02-26 17:20:18,508 [1] DEBUG - Statement Id: [DAO00064_CheckBenhNhanDaXacNhanBHYT] PreparedStatement : [IF EXISTS (SELECT XACNHANCHIPHI_ID FROM TT_XACNHANCHIPHI WHERE TIEPNHAN_ID = 107438)        BEGIN        SELECT 1 AS RESULT        END        ELSE        BEGIN        SELECT 0 AS RESULT        END]
2020-02-26 17:20:19,817 [1] DEBUG - Statement Id: [DAO00014_GetPatientStatus] PreparedStatement : [select        CASE        when tn.TRANGTHAI = 'HOANTHANH' Then tn.TRANGTHAI        WHEN xncp.XACNHANCHIPHI_ID is not null THEN 'XACNHANCHIPHI'        WHEN (tn.KHOADULIEU = '1') THEN 'KHOADULIEU'        ELSE tn.TRANGTHAI        END        as TRANGTHAI        from TT_TIEPNHAN tn        left join TT_XACNHANCHIPHI xncp on tn.TIEPNHAN_ID = xncp.TIEPNHAN_ID        where tn.TIEPNHAN_ID = '107438'        and tn.BENHVIEN_ID = 'HLU01']
2020-02-26 17:20:19,914 [1] DEBUG - Statement Id: [DAO00064_TT_BENHNHAN_BHYT_Add] PreparedStatement : [insert into TT_BENHNHAN_BHYT (        BENHNHAN_ID        , LOAIBHYT        , SOTHE        , NGAYCAP        , NGAYHIEULUC        , NGAYHETHIEULUC        , TINHTHANH_CAPTHE_ID        , BENHVIEN_ID        , BENHVIEN_KCB_ID        , TREN3NAM        , TREN5NAM        , NGAYMIENDONGCHITRA        , TREN6THANG        , KHUVUCSONG_ID        , TAMNGUNG        , NGAYTAO        , NGUOITAO_ID        , NGAYCAPNHAT        , NGUOICAPNHAT_ID        ) values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         )]
2020-02-26 17:20:19,915 [1] DEBUG - Statement Id: [DAO00064_TT_BENHNHAN_BHYT_Add] Parameters: [@param0=[BENHNHAN_ID,74322], @param1=[LOAIBHYT,4], @param2=[SOTHE,DN452223445533438289], @param3=[NGAYCAP,1/1/2020 12:00:00 AM], @param4=[NGAYHIEULUC,1/1/2020 12:00:00 AM], @param5=[NGAYHETHIEULUC,6/30/2020 12:00:00 AM], @param6=[TINHTHANH_CAPTHE_ID,null], @param7=[BENHVIEN_ID,HLU01], @param8=[BENHVIEN_KCB_ID,38289], @param9=[TREN3NAM,0], @param10=[TREN5NAM,0], @param11=[NGAYMIENDONGCHITRA,null], @param12=[TREN6THANG,null], @param13=[KHUVUCSONG_ID,null], @param14=[TAMNGUNG,null], @param15=[NGAYTAO,2/26/2020 5:20:19 PM], @param16=[NGUOITAO_ID,1], @param17=[NGAYCAPNHAT,2/26/2020 5:20:19 PM], @param18=[NGUOICAPNHAT_ID,1]]
2020-02-26 17:20:19,915 [1] DEBUG - Statement Id: [DAO00064_TT_BENHNHAN_BHYT_Add] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64], @param2=[String, System.String], @param3=[DateTime, System.DateTime], @param4=[DateTime, System.DateTime], @param5=[DateTime, System.DateTime], @param6=[System.DBNull, null], @param7=[String, System.String], @param8=[String, System.String], @param9=[String, System.String], @param10=[String, System.String], @param11=[System.DBNull, null], @param12=[System.DBNull, null], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[DateTime, System.DateTime], @param16=[Int64, System.Int64], @param17=[DateTime, System.DateTime], @param18=[Int64, System.Int64]]
2020-02-26 17:20:19,964 [1] DEBUG - Statement Id: [DAO00020_TT_TIEPNHAN_GetTTTiepNhan] PreparedStatement : [select *        from TT_TIEPNHAN        where TIEPNHAN_ID = 107438]
2020-02-26 17:20:19,990 [1] DEBUG - Statement Id: [DAOWF001_Laythongtingateways] PreparedStatement : [select * from TM_PROCESS_GATEWAYS]
2020-02-26 17:20:20,014 [1] DEBUG - Statement Id: [DAOWF001_LaythongtinProcess] PreparedStatement : [select * from TM_PROCESS        where        PROCESS_CODE = 'P02']
2020-02-26 17:20:20,036 [1] DEBUG - Statement Id: [DAOWF001_Kiemtrathongtindayeucau] PreparedStatement : [select * from TT_REQUEST        where        PROCESS_CODE = 'P02'        AND PARA = '{"HOSPITAL_ID":"HLU01","SOTIEPNHAN":"TN200226.0000001"}'        AND CURR_STATE_CODE = '6'        AND ISACTIVE = '1']
2020-02-26 17:20:20,117 [1] DEBUG - Statement Id: [DAOWF002_Add] PreparedStatement : [DECLARE @IDRequestOld int        DECLARE @IDRequestNew int        select top 1 @IDRequestOld = ID from TT_REQUEST where PARA =  @param0  order by ID desc          insert into TT_REQUEST (        PROCESS_CODE        , PARA        , CURR_STATE_CODE        ) values (         @param1         ,  @param0         ,  @param2         )        SELECT @IDRequestNew = SCOPE_IDENTITY()        if (@IDRequestOld is not null)        begin        update TT_REQUEST_SERVICE set REQUEST_ID = @IDRequestNew, PROCESS_CODE =  @param1  where REQUEST_ID = @IDRequestOld        update TT_REQUEST set ISACTIVE = '0' where ID = @IDRequestOld        update TT_REQUEST_SERVICE_DETAIL set REQUEST_ID = @IDRequestNew where REQUEST_ID = @IDRequestOld        end          select @IDRequestNew]
2020-02-26 17:20:20,117 [1] DEBUG - Statement Id: [DAOWF002_Add] Parameters: [@param0=[PARA,{"HOSPITAL_ID":"HLU01","SOTIEPNHAN":"TN200226.0000001"}], @param1=[PROCESS_CODE,P02], @param2=[CURR_STATE_CODE,6]]
2020-02-26 17:20:20,117 [1] DEBUG - Statement Id: [DAOWF002_Add] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[String, System.String]]
2020-02-26 17:20:31,257 [1] DEBUG - Statement Id: [DAO00000_GetMucHuongDOITUONGBHYT] PreparedStatement : [select * from TM_DOITUONG          where BENHVIEN_ID = 'HLU01'           and             NHOMTHE like '%' +  @param0  +'%']
2020-02-26 17:20:31,257 [1] DEBUG - Statement Id: [DAO00000_GetMucHuongDOITUONGBHYT] Parameters: [@param0=[NHOMTHE,DN4]]
2020-02-26 17:20:31,257 [1] DEBUG - Statement Id: [DAO00000_GetMucHuongDOITUONGBHYT] Types: [@param0=[String, System.String]]
2020-02-26 17:20:31,331 [1] DEBUG - Statement Id: [DAO00019_Check_TT_TIEPNHAN_SOTHEBHYT_WithSoBHYT] PreparedStatement : [select * from TT_TIEPNHAN_SOTHEBHYT where SOBHYT = 'DN452223445533438289' and TIEPNHAN_ID = 107438        and SOBHYT_HUONG_ID = (select top 1 SOBHYT_HUONG_ID from TT_TIEPNHAN_SOTHEBHYT where TIEPNHAN_ID = 107438 order by SOBHYT_HUONG_ID desc)]
2020-02-26 17:20:31,674 [1] DEBUG - Statement Id: [DAO00019_Add_TT_TIEPNHAN_SOTHEBHYT] PreparedStatement : [INSERT INTO TT_TIEPNHAN_SOTHEBHYT        (TIEPNHAN_ID        ,BENHNHAN_ID        ,BENHAN_ID        ,DOITUONG_ID        ,SOBHYT        ,BHYTTUNGAY        ,BHYTDENNGAY        ,BHYTNGAYCAP        ,BHYTTREN3NAM        ,BHYTTREN5NAM        ,NGAYMIENDONGCHITRA        ,TRAITUYEN        ,BENHVIEN_ID        ,NOITAO_ID        ,NGAYTAO        ,NGUOITAO_ID        ,NGAYCAPNHAT        ,NGUOICAPNHAT_ID        ,TYLE_VUOT_LCB        ,TYLE_TRAITUYEN        ,GIOIHAN_VUOT_LCB        ,LUONG_COSO        ,TYLE_THUOC_UT        ,MADOITUONG)        VALUES        ( @param0         , @param1         , @param2         , @param3         , @param4         , @param5         , @param6         , @param7         , @param8         , @param9         , @param10         , @param11         , @param12         , @param13         , @param14         , @param15         , @param16         , @param17         , @param18         , @param19         , @param20         , @param21         , @param22         , @param23 )]
2020-02-26 17:20:31,674 [1] DEBUG - Statement Id: [DAO00019_Add_TT_TIEPNHAN_SOTHEBHYT] Parameters: [@param0=[TIEPNHAN_ID,107438], @param1=[BENHNHAN_ID,74322], @param2=[BENHAN_ID,0], @param3=[DOITUONG_ID,4], @param4=[SOBHYT,DN452223445533438289], @param5=[BHYTTUNGAY,1/1/2020 12:00:00 AM], @param6=[BHYTDENNGAY,6/30/2020 12:00:00 AM], @param7=[BHYTNGAYCAP,1/1/2020 12:00:00 AM], @param8=[BHYTTREN3NAM,null], @param9=[BHYTTREN5NAM,0], @param10=[NGAYMIENDONGCHITRA,null], @param11=[TRAITUYEN,0], @param12=[BENHVIEN_ID,HLU01], @param13=[NOITAO_ID,null], @param14=[NGAYTAO,2/26/2020 5:20:19 PM], @param15=[NGUOITAO_ID,1], @param16=[NGAYCAPNHAT,2/26/2020 5:20:19 PM], @param17=[NGUOICAPNHAT_ID,1], @param18=[TYLE_VUOT_LCB,0.80], @param19=[TYLE_TRAITUYEN,0.60], @param20=[GIOIHAN_VUOT_LCB,223500.00], @param21=[LUONG_COSO,1490000.00], @param22=[TYLE_THUOC_UT,0.50], @param23=[MADOITUONG,BHYT4]]
2020-02-26 17:20:31,674 [1] DEBUG - Statement Id: [DAO00019_Add_TT_TIEPNHAN_SOTHEBHYT] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64], @param2=[Int64, System.Int64], @param3=[Int32, System.Int32], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[DateTime, System.DateTime], @param7=[DateTime, System.DateTime], @param8=[System.DBNull, null], @param9=[String, System.String], @param10=[System.DBNull, null], @param11=[Int64, System.Int64], @param12=[String, System.String], @param13=[System.DBNull, null], @param14=[DateTime, System.DateTime], @param15=[Int64, System.Int64], @param16=[DateTime, System.DateTime], @param17=[Int64, System.Int64], @param18=[Decimal, System.Decimal], @param19=[Decimal, System.Decimal], @param20=[Decimal, System.Decimal], @param21=[Decimal, System.Decimal], @param22=[Decimal, System.Decimal], @param23=[String, System.String]]
2020-02-26 17:20:31,938 [1] DEBUG - Statement Id: [DAO00027_UpdateDoiTuongTiepNhan] PreparedStatement : [update TT_TIEPNHAN set        BENHNHAN_ID = '74322'         ,           DOITUONG_ID =  @param0           , SOBHYT =  @param1           , BHYTTUNGAY =  @param2           , BHYTDENNGAY =  @param3           , BHYTNGAYCAP =  @param4           , TRAITUYEN =  @param5           , NGUON_BENHNHAN_ID =  @param6           , NGAYCAPNHAT =  @param7           , NGUOICAPNHAT_ID =  @param8          ,           SUDUNG_BHTN =  @param9          ,           BAOLANH_VIENPHI =  @param10          ,           BHYTTREN5NAM =  @param11          ,           VIP =  @param12          ,           PROCESS_ID =  @param13                  where        TIEPNHAN_ID = '107438']
2020-02-26 17:20:31,938 [1] DEBUG - Statement Id: [DAO00027_UpdateDoiTuongTiepNhan] Parameters: [@param0=[DOITUONG_ID,4], @param1=[SOBHYT,DN452223445533438289], @param2=[BHYTTUNGAY,1/1/2020 12:00:00 AM], @param3=[BHYTDENNGAY,6/30/2020 12:00:00 AM], @param4=[BHYTNGAYCAP,1/1/2020 12:00:00 AM], @param5=[TRAITUYEN,0], @param6=[NGUON_BENHNHAN_ID,-1], @param7=[NGAYCAPNHAT,2/26/2020 5:20:31 PM], @param8=[NGUOICAPNHAT_ID,1], @param9=[SUDUNG_BHTN,False], @param10=[BAOLANH_VIENPHI,False], @param11=[BHYTTREN5NAM,0], @param12=[VIP,False], @param13=[PROCESS_ID,P02]]
2020-02-26 17:20:31,938 [1] DEBUG - Statement Id: [DAO00027_UpdateDoiTuongTiepNhan] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String], @param2=[DateTime, System.DateTime], @param3=[DateTime, System.DateTime], @param4=[DateTime, System.DateTime], @param5=[Int64, System.Int64], @param6=[Int64, System.Int64], @param7=[DateTime, System.DateTime], @param8=[Int64, System.Int64], @param9=[Boolean, System.Boolean], @param10=[Boolean, System.Boolean], @param11=[String, System.String], @param12=[Boolean, System.Boolean], @param13=[String, System.String]]
2020-02-26 17:20:31,978 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2020-02-26 17:20:32,425 [1] DEBUG - Statement Id: [DAO00027_GetListTiepNhanAllCOM30] PreparedStatement : [select distinct A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, isnull(C.SOBENHAN,NULL) as SOBENHAN,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI, A.SOBHYT, CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYTIEPNHAN,        B.*        , A.UUTIEN        from TT_TIEPNHAN A        inner join (select * from TT_BENHNHAN where MAYTE = '200000439' and ACTIVE = '1') B on B.BENHNHAN_ID = A.BENHNHAN_ID  and B.ACTIVE = '1'        left join TT_NOITRU_BENHAN C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        where A.TIEPNHAN_ID = '107438' and A.BENHVIEN_ID = 'HLU01' and (A.TRANGTHAI not in ('HUY','CAPCUU', 'NOITRU', 'NGOAITRU'))]
2020-02-26 17:20:33,314 [1] DEBUG - Statement Id: [DAO00020_GetDVYCByTiepNhanID] PreparedStatement : [select DVYEUCAU_ID, DICHVU_ID        from TT_DVYEUCAU        where TIEPNHAN_ID = 107438]
2020-02-26 17:20:33,341 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '107438' and C.DICHVU_ID = '5492' and A.BENHVIEN_ID = 'HLU01'         and           C.DVYEUCAU_ID = '992278']
2020-02-26 17:20:33,835 [1] DEBUG - Statement Id: [DAO00023_GetSOBHYT_HUONG_ID] PreparedStatement : [select isnull(MAX(SOBHYT_HUONG_ID),0) SOBHYT_HUONG_ID        from TT_TIEPNHAN_SOTHEBHYT        where TIEPNHAN_ID = '107438']
2020-02-26 17:20:34,047 [1] DEBUG - Statement Id: [DAO00023_GetSOBHYT_HUONG] PreparedStatement : [select top 1 SOBHYT        from TT_TIEPNHAN_SOTHEBHYT        where TIEPNHAN_ID = '107438'                order by SOBHYT_HUONG_ID desc]
2020-02-26 17:20:34,071 [1] DEBUG - Statement Id: [DAO00064_GetListVienphiDaThanhtoan] PreparedStatement : [select VIENPHI_ID, DATHANHTOAN from TT_VIENPHI        where VIENPHI_ID in (3119652) and DATHANHTOAN = '1']
2020-02-26 17:20:34,096 [1] DEBUG - Statement Id: [DAO00024_TT_VIENPHI_Update] PreparedStatement : [update TT_VIENPHI set            TIEPNHAN_ID =  @param0                          , REF_ID =  @param1             , REF_TABLE =  @param2             , DICHVU_ID =  @param3             , DUOC_ID =  @param4             , LOAI_CHIPHI =  @param5             , LOAIGIA_ID =  @param6             , SOLUONG =  @param7             , DONGIA_DOANHTHU =  @param8             , THANHTIEN_DOANHTHU =  @param9             , BHYT_TL =  @param10             , BHYT_DONGIA =  @param11             , BHYT_THANHTIEN =  @param12             , BHYT_DONGIA_CHITRA =  @param13             , BHYT_THANHTIEN_CHITRA =  @param14             , BENHNHAN_PHAITHANHTOAN =  @param15             , GIATRI_HOADON =  @param16             , GIATRI_HOADON_DATHANHTOAN =  @param17             , GIATRI_BIENLAI =  @param18             , GIATRI_BIENLAI_DATHANHTOAN =  @param19             , GIATRI_BENHNHAN_DATHANHTOAN =  @param20             , GIATRI_THATTHU =  @param21             , MIENGIAM_TL =  @param22             , MIENGIAM_GIATRI =  @param23             , NGANSACH_TL =  @param24             , NGANSACH_GIATRI =  @param25             , TAITRO_TL =  @param26             , TAITRO_GIATRI =  @param27             , BHTN_TL =  @param28             , BHTN_DONGIA =  @param29             , BHTN_THANHTIEN =  @param30             , BHTN_DONGIA_CHITRA =  @param31             , BHTN_THANHTIEN_CHITRA =  @param32                           , DUOCPHEPTHUCHIEN =  @param33                             , HUY =  @param34                             , DATHANHTOAN =  @param35                             , DATHUCHIEN =  @param36                             , KHONGTHUTIEN =  @param37                          , HOADON_ID =  @param38                           , ACTIVE =  @param39                           , YEUCAUVP =  @param40                             , BHYTDONGTIEN =  @param41                             , DOITUONG_HUONG_ID =  @param42                             , SOBHYT_HUONG_ID =  @param43                             , BHYT_DONGIA_DONGCT_DAU =  @param44                             , DONGIADOANHTHU_BANDAU =  @param45                             , DONGIA_BHYT_BANDAU =  @param46                             , DICHVU_TL =  @param47                            , NGUOICAPNHAT_ID =  @param48               , NGAYCAPNHAT =  @param49               where              VIENPHI_ID = '3119652']
2020-02-26 17:20:34,097 [1] DEBUG - Statement Id: [DAO00024_TT_VIENPHI_Update] Parameters: [@param0=[TIEPNHAN_ID,107438], @param1=[REF_ID,992278], @param2=[REF_TABLE,TT_DVYEUCAU], @param3=[DICHVU_ID,5492], @param4=[DUOC_ID,null], @param5=[LOAI_CHIPHI,TT], @param6=[LOAIGIA_ID,3], @param7=[SOLUONG,1], @param8=[DONGIA_DOANHTHU,80000], @param9=[THANHTIEN_DOANHTHU,80000], @param10=[BHYT_TL,0], @param11=[BHYT_DONGIA,0], @param12=[BHYT_THANHTIEN,0], @param13=[BHYT_DONGIA_CHITRA,0], @param14=[BHYT_THANHTIEN_CHITRA,0], @param15=[BENHNHAN_PHAITHANHTOAN,80000], @param16=[GIATRI_HOADON,0], @param17=[GIATRI_HOADON_DATHANHTOAN,0], @param18=[GIATRI_BIENLAI,0], @param19=[GIATRI_BIENLAI_DATHANHTOAN,0], @param20=[GIATRI_BENHNHAN_DATHANHTOAN,0], @param21=[GIATRI_THATTHU,0], @param22=[MIENGIAM_TL,0], @param23=[MIENGIAM_GIATRI,0], @param24=[NGANSACH_TL,0], @param25=[NGANSACH_GIATRI,0], @param26=[TAITRO_TL,0], @param27=[TAITRO_GIATRI,0], @param28=[BHTN_TL,0], @param29=[BHTN_DONGIA,0], @param30=[BHTN_THANHTIEN,0], @param31=[BHTN_DONGIA_CHITRA,0], @param32=[BHTN_THANHTIEN_CHITRA,0], @param33=[DUOCPHEPTHUCHIEN,0], @param34=[HUY,0], @param35=[DATHANHTOAN,0], @param36=[DATHUCHIEN,0], @param37=[KHONGTHUTIEN,0], @param38=[HOADON_ID,null], @param39=[ACTIVE,1], @param40=[YEUCAUVP,0], @param41=[BHYTDONGTIEN,0], @param42=[DOITUONG_HUONG_ID,1], @param43=[SOBHYT_HUONG_ID,111790], @param44=[BHYT_DONGIA_DONGCT_DAU,0], @param45=[DONGIADOANHTHU_BANDAU,80000], @param46=[DONGIA_BHYT_BANDAU,0], @param47=[DICHVU_TL,1], @param48=[NGUOICAPNHAT_ID,1], @param49=[NGAYCAPNHAT,2/26/2020 5:20:34 PM]]
2020-02-26 17:20:34,097 [1] DEBUG - Statement Id: [DAO00024_TT_VIENPHI_Update] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64], @param2=[String, System.String], @param3=[Int64, System.Int64], @param4=[System.DBNull, null], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[Double, System.Double], @param8=[Double, System.Double], @param9=[Double, System.Double], @param10=[Double, System.Double], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[Double, System.Double], @param14=[Double, System.Double], @param15=[Double, System.Double], @param16=[Double, System.Double], @param17=[Double, System.Double], @param18=[Double, System.Double], @param19=[Double, System.Double], @param20=[Double, System.Double], @param21=[Double, System.Double], @param22=[Double, System.Double], @param23=[Double, System.Double], @param24=[Double, System.Double], @param25=[Double, System.Double], @param26=[Double, System.Double], @param27=[Double, System.Double], @param28=[Double, System.Double], @param29=[Double, System.Double], @param30=[Double, System.Double], @param31=[Double, System.Double], @param32=[Double, System.Double], @param33=[String, System.String], @param34=[String, System.String], @param35=[Int64, System.Int64], @param36=[String, System.String], @param37=[Int64, System.Int64], @param38=[System.DBNull, null], @param39=[String, System.String], @param40=[Int64, System.Int64], @param41=[Int64, System.Int64], @param42=[Int64, System.Int64], @param43=[Int64, System.Int64], @param44=[Double, System.Double], @param45=[Double, System.Double], @param46=[Double, System.Double], @param47=[Double, System.Double], @param48=[Int64, System.Int64], @param49=[DateTime, System.DateTime]]
2020-02-26 17:20:34,144 [1] DEBUG - Statement Id: [DAO00024_Insert_TT_VIENPHI_CAPNHAT] PreparedStatement : [insert into TT_VIENPHI_CAPNHAT          (TIEPNHAN_ID                     ,VIENPHI_ID          ,DONGIA_DOANHTHU          ,BHYT_DONGIA          ,NGAYCAPNHAT          ,NGUOICAPNHAT_ID          ,BENHVIEN_ID)          values          ( @param0                      , @param1           , @param2           , @param3           ,GETDATE()          , @param4           , @param5 )]
2020-02-26 17:20:34,144 [1] DEBUG - Statement Id: [DAO00024_Insert_TT_VIENPHI_CAPNHAT] Parameters: [@param0=[TIEPNHAN_ID,107438], @param1=[VIENPHI_ID,3119652], @param2=[DONGIA_DOANHTHU,80000], @param3=[BHYT_DONGIA,0], @param4=[NGUOICAPNHAT_ID,1], @param5=[BENHVIEN_ID,HLU01]]
2020-02-26 17:20:34,144 [1] DEBUG - Statement Id: [DAO00024_Insert_TT_VIENPHI_CAPNHAT] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64], @param2=[Double, System.Double], @param3=[Double, System.Double], @param4=[Int64, System.Int64], @param5=[String, System.String]]
2020-02-26 17:20:34,389 [1] DEBUG - Statement Id: [DAO00064_GetNgayDangKyDichVu] PreparedStatement : [SELECT        DISTINCT CONVERT(date, NGAYTAO) as NGAYCHIPHI        FROM TT_VIENPHI        WHERE        TIEPNHAN_ID = '107438'                 ORDER BY NGAYCHIPHI]
2020-02-26 17:20:34,411 [1] DEBUG - Statement Id: [DAO00064_GetAllNgayYeucauDV] PreparedStatement : [SELECT        DISTINCT DVYEUCAU_ID, DICHVU_ID, CONVERT(date, NGAYYEUCAU) NGAYYEUCAU        FROM TT_DVYEUCAU        WHERE        TIEPNHAN_ID = '107438']
2020-02-26 17:20:34,437 [1] DEBUG - Statement Id: [DAO00064_TT_VIENPHI_GetList] PreparedStatement : [select distinct a.*, b.TINHTRANG AS TINHTRANG_MG, d.TINHTRANG_BHTN, e.TINHTRANG_MGCT        , b.MIENGIAMCHITIET_ID, b.GIATRIMIENGIAM, d.GIATRIMIENGIAM_BHTN, e.GIATRIMIENGIAM_CONGTY, e.GIATRIMIENGIAM_CONGTY as GIATRIMIENGIAM_CTCT, f.GIATRIMIENGIAM_THANHVIEN        , c.DVKEMTHEO, c.DVKEMTHEO_KHACEKIP, isnull(ttnt.PHONGBANRATOA_ID,c.NOIYEUCAU_ID) NOIYEUCAU_ID, c.NOITHUCHIEN_ID, c.DVYEUCAU_ID, c.HUYYEUCAU, c.DANGKY_ID,        isnull(dv.TENDICHVU, dc.TENDUOCDAYDU) NOIDUNG, isnull(dv.MADICHVU, dc.MADUOC) MADICHVU, dv.NORESULT, dc.DONVITINH, ld.MALOAIDUOC, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ndv.MANHOMDICHVU,        dv.BHYT DV_BHYT        from        (select VP.*, sbh.SOBHYT as SOBHYT_HUONG        from TT_VIENPHI VP        left join TT_TIEPNHAN_SOTHEBHYT sbh on sbh.SOBHYT_HUONG_ID = VP.SOBHYT_HUONG_ID        where        ((isnull(VP.GIATRI_BENHNHAN_DATHANHTOAN, 0) = 0 and isnull(VP.DATHANHTOAN, 0) = 0)        and VP.REF_TABLE != 'TT_MAU_CHUNGTU_CHITIET'                 )         and           VP.TIEPNHAN_ID = '107438'         and           VP.BENHVIEN_ID = 'HLU01'                 )a left join                   (        select VIENPHI_ID, MG.TINHTRANG, MGCT.MIENGIAMCHITIET_ID, Sum(MGCT.GIATRIMIENGIAM) as GIATRIMIENGIAM        from TT_MIENGIAM MG INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_ID = MGCT.MIENGIAM_ID        where MG.TIEPNHAN_ID= '107438' and MGCT.REF_TABLE = 'TT_MIENGIAM'        group by VIENPHI_ID, MG.TINHTRANG, MGCT.MIENGIAMCHITIET_ID        )b        on a.VIENPHI_ID = b.VIENPHI_ID          left join(        select VIENPHI_ID, MG.TINHTRANG AS TINHTRANG_BHTN, SUM(MGCT.GIATRIMIENGIAM) as GIATRIMIENGIAM_BHTN        from TT_MIENGIAM_BHTN MG INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_BHTN_ID = MGCT.MIENGIAM_ID        where MG.TIEPNHAN_ID= '107438' and MGCT.REF_TABLE = 'TT_MIENGIAM_BHTN'        group by VIENPHI_ID, MG.TINHTRANG        )d        on a.VIENPHI_ID = d.VIENPHI_ID          left join(        select VIENPHI_ID, MG.TINHTRANG AS TINHTRANG_MGCT, Sum(MGCT.GIATRIMIENGIAM) as GIATRIMIENGIAM_CONGTY        from TT_MIENGIAM_CONGTY MG INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_CONGTY_ID = MGCT.MIENGIAM_ID        where MG.TIEPNHAN_ID= '107438' and MGCT.REF_TABLE = 'TT_MIENGIAM_CONGTY'        group by VIENPHI_ID, MG.TINHTRANG        )e        on a.VIENPHI_ID = e.VIENPHI_ID          left join(        select VIENPHI_ID, MG.TINHTRANG AS TINHTRANG_MGCT, Sum(MGCT.GIATRIMIENGIAM) as GIATRIMIENGIAM_THANHVIEN        from TT_MIENGIAM_THANHVIEN MG INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_THANHVIEN_ID = MGCT.MIENGIAM_ID        where MG.TIEPNHAN_ID= '107438' and MGCT.REF_TABLE = 'TT_MIENGIAM_THANHVIEN'        group by VIENPHI_ID, MG.TINHTRANG        )f        on a.VIENPHI_ID = f.VIENPHI_ID          left join        (        select DVYEUCAU_ID, TRANGTHAI, BHYTDONGTIEN, HUYYEUCAU, DVKEMTHEO, DVKEMTHEO_KHACEKIP, NOIYEUCAU_ID, NOITHUCHIEN_ID, DANGKY_ID from TT_DVYEUCAU        where TIEPNHAN_ID = '107438'        )c on c.DVYEUCAU_ID = a.REF_ID and a.REF_TABLE = 'TT_DVYEUCAU'        left join        (        select PHONGBANRATOA_ID, TOATHUOC_ID, 'TT_NOITRU_TOATHUOC' REF_TABLE  from TT_NOITRU_TOATHUOC where TIEPNHAN_ID  = '107438'        union        select PHONGBAN_ID as PHONGBANRATOA_ID, CLSKETQUA_VTYT_ID as TOATHUOC_ID, 'TT_CLSKETQUA_VTYT' REF_TABLE        from TT_CLSKETQUA_VTYT where exists (select DVYEUCAU_ID from TT_DVYEUCAU where TT_CLSKETQUA_VTYT.DVYEUCAU_ID = DVYEUCAU_ID and TIEPNHAN_ID  = '107438')        union        select PHONGBAN_ID as PHONGBANRATOA_ID, KHAMBENH_VTYT_ID as TOATHUOC_ID, 'TT_NGOAITRU_KHAMBENH_VTYT' REF_TABLE        from TT_NGOAITRU_KHAMBENH_VTYT where exists (select DVYEUCAU_ID from TT_DVYEUCAU where TT_NGOAITRU_KHAMBENH_VTYT.DVYEUCAU_ID = DVYEUCAU_ID and  TIEPNHAN_ID  = '107438')        union        select B.PHONGBANTHUCHIEN_ID as PHONGBANRATOA_ID, PHAUTHUAT_VTYT_ID as TOATHUOC_ID, 'TT_PHAUTHUAT_VTYT' REF_TABLE        from TT_PHAUTHUAT_VTYT A        left join TT_PHAUTHUAT B on A.PHAUTHUAT_ID = B.PHAUTHUAT_ID        where B.TIEPNHAN_ID  = '107438'        union        select B.PHONGBAN_ID as PHONGBANRATOA_ID, TOATHUOC_ID, 'TT_NGOAITRU_TOATHUOC' REF_TABLE        from TT_NGOAITRU_TOATHUOC A        left join TT_NGOAITRU_KHAMBENH B on A.KHAMBENH_ID = B.KHAMBENH_ID        where B.TIEPNHAN_ID  = '107438'        ) ttnt on ttnt.TOATHUOC_ID = a.REF_ID and a.REF_TABLE = ttnt.REF_TABLE        left join TM_DUOC dc on A.DUOC_ID = dc.DUOC_ID        left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID        left join TM_DICHVU dv on A.DICHVU_ID = dv.DICHVU_ID and A.REF_TABLE = 'TT_DVYEUCAU'        left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID        where        c.HUYYEUCAU = '0' or c.HUYYEUCAU is null]
2020-02-26 17:20:34,553 [1] DEBUG - Statement Id: [DAO00330_TT_VIENPHI_GetList] PreparedStatement : [select distinct a.*, b.TINHTRANG AS TINHTRANG_MG, d.TINHTRANG_BHTN, e.TINHTRANG_MGCT      , b.MIENGIAMCHITIET_ID, b.GIATRIMIENGIAM, d.GIATRIMIENGIAM_BHTN, e.GIATRIMIENGIAM_CONGTY, e.GIATRIMIENGIAM_CONGTY as GIATRIMIENGIAM_CTCT, f.GIATRIMIENGIAM_THANHVIEN      , NULL AS DVKEMTHEO, NULL AS DVKEMTHEO_KHACEKIP, ttnt.PHONGBANRATOA_ID NOIYEUCAU_ID, NULL AS NOITHUCHIEN_ID, NULL AS DVYEUCAU_ID, 0 AS HUYYEUCAU, NULL AS DANGKY_ID,      dc.TENMAU NOIDUNG, dc.MAMAU MADICHVU, NULL AS NORESULT, DVT.TENDONVITINH AS DONVITINH, ld.MALOAIMAU AS MALOAIDUOC, DC.BHYT AS DUOC_BHYT, 'M' AS LOAIVATTU_ID,NM.TENNHOMMAU AS MANHOMDICHVU      from      (select VP.*, sbh.SOBHYT as SOBHYT_HUONG      from TT_VIENPHI VP      left join TT_TIEPNHAN_SOTHEBHYT sbh on sbh.SOBHYT_HUONG_ID = VP.SOBHYT_HUONG_ID      where (VP.GIATRI_BENHNHAN_DATHANHTOAN = 0 or VP.GIATRI_BENHNHAN_DATHANHTOAN is null)       and             VP.TIEPNHAN_ID = '107438'           and             VP.BENHVIEN_ID = 'HLU01'                   )a left join                       (      select VIENPHI_ID, MG.TINHTRANG, MGCT.MIENGIAMCHITIET_ID, MGCT.GIATRIMIENGIAM      from TT_MIENGIAM MG INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_ID = MGCT.MIENGIAM_ID      where      MG.TIEPNHAN_ID= '107438' and MGCT.REF_TABLE = 'TT_MIENGIAM'      )b      on a.VIENPHI_ID = b.VIENPHI_ID        left join(      select VIENPHI_ID, MG.TINHTRANG AS TINHTRANG_BHTN, MGCT.GIATRIMIENGIAM as GIATRIMIENGIAM_BHTN      from TT_MIENGIAM_BHTN MG INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_BHTN_ID = MGCT.MIENGIAM_ID      where      MG.TIEPNHAN_ID= '107438' and MGCT.REF_TABLE = 'TT_MIENGIAM_BHTN'      )d      on a.VIENPHI_ID = d.VIENPHI_ID        left join(      select VIENPHI_ID, MG.TINHTRANG AS TINHTRANG_MGCT, MGCT.GIATRIMIENGIAM as GIATRIMIENGIAM_CONGTY      from TT_MIENGIAM_CONGTY MG INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_CONGTY_ID = MGCT.MIENGIAM_ID      where      MG.TIEPNHAN_ID= '107438' and MGCT.REF_TABLE = 'TT_MIENGIAM_CONGTY'      )e      on a.VIENPHI_ID = e.VIENPHI_ID        left join(      select VIENPHI_ID, MG.TINHTRANG AS TINHTRANG_MGCT, MGCT.GIATRIMIENGIAM as GIATRIMIENGIAM_THANHVIEN      from TT_MIENGIAM_THANHVIEN MG INNER JOIN TT_MIENGIAM_CHITIET MGCT ON MG.MIENGIAM_THANHVIEN_ID = MGCT.MIENGIAM_ID      where      MG.TIEPNHAN_ID= '107438' and MGCT.REF_TABLE = 'TT_MIENGIAM_THANHVIEN'      )f      on a.VIENPHI_ID = f.VIENPHI_ID      inner join      (      select DK.NOICHIDINH_ID as PHONGBANRATOA_ID, CT.CHUNGTUCHITIET_ID, 'TT_MAU_CHUNGTU_CHITIET' REF_TABLE      from TT_MAU_DANGKYMAU DK JOIN TT_MAU_DANGKYMAU_CHITIET DKCT ON DK.DANGKYMAU_ID = DKCT.DANGKYMAU_ID AND DK.TIEPNHAN_ID  = '107438'      INNER JOIN TT_MAU_CHUNGTU CTU ON DKCT.CHUNGTU_ID = CTU.CHUNGTU_ID AND CTU.CHUNGTULIENQUAN_ID IS NULL      JOIN TT_MAU_CHUNGTU_CHITIET CT ON CT.CHUNGTU_ID=CTU.CHUNGTU_ID      ) ttnt on ttnt.CHUNGTUCHITIET_ID = a.REF_ID and a.REF_TABLE = ttnt.REF_TABLE      left join TM_MAU dc on A.DUOC_ID = dc.MAU_ID      LEFT JOIN TM_MAU_DONVITINH DVT ON DC.DONVITINH_ID = DVT.DONVITINH_ID      left join TM_MAU_LOAIMAU ld on dc.LOAIMAU_ID = ld.LOAIMAU_ID      LEFT JOIN TM_MAU_NHOMMAU NM ON NM.NHOMMAU_ID = LD.NHOMMAU_ID]
2020-02-26 17:20:34,640 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN200226.0000001']
2020-02-26 17:20:34,663 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"5492","DVYEUCAU_ID":"992278"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"5492","DVYEUCAU_ID":"992278"}' order by ID desc)        order by A.ID desc]
2020-02-26 17:20:34,709 [1] DEBUG - Statement Id: [DAO00017_GetLoaiGiaDoiTuongDichVu] PreparedStatement : [select a.LOAIGIA_ID, a.TENLOAIGIA, a.MALOAIGIA, a.CAPTREN_ID, MIN(a.UUTIEN_NGUON) AS UUTIEN_NGUON          , MAX(a.DOUUTIEN) AS DOUUTIEN, MIN(ISNULL(a.GIAHOTRO,0)) AS GIAHOTRO          from(                        select distinct A.LOAIGIA_ID, C.TENLOAIGIA, C.MALOAIGIA, 0 as UUTIEN_NGUON, isnull(B.DOUUTIEN,0) as DOUUTIEN, B.GIAHOTRO, C.CAPTREN_ID            from TM_DOITUONG_GIADICHVU A            left join TM_DOITUONG_LOAIGIA B on A.LOAIGIA_ID = B.LOAIGIA_ID and A.DOITUONG_ID = B.DOITUONG_ID and B.BENHVIEN_ID = 'HLU01'            inner join TM_LOAIGIA C on A.LOAIGIA_ID = C.LOAIGIA_ID and C.BENHVIEN_ID = 'HLU01'            where A.DOITUONG_ID = '4'                            and C.CAPTREN_ID = (select LOAIGIA_ID from TM_LOAIGIA              where MALOAIGIA = 'GiaDichVu'              and BENHVIEN_ID = 'HLU01')                         and A.BENHVIEN_ID = 'HLU01'                     ) a          where a.DOUUTIEN != 0 and a.DOUUTIEN is not null          group by a.LOAIGIA_ID, a.TENLOAIGIA, a.MALOAIGIA, a.CAPTREN_ID          order by MAX(a.UUTIEN_NGUON) desc ,MAX(a.DOUUTIEN) asc]
2020-02-26 17:20:34,994 [1] DEBUG - Statement Id: [DAO00064_GetListVienphiNgoaitru_updatewfl] PreparedStatement : [select VIENPHI_ID, DATHANHTOAN, DATHUCHIEN from TT_VIENPHI        where VIENPHI_ID in (3119652) and (DATHANHTOAN = '1' or DATHUCHIEN = '1')]
2020-02-26 17:20:35,024 [1] DEBUG - Statement Id: [DAO00049_KiemtraloaiDV] PreparedStatement : [select DICHVU_ID AS HA, '' AS XN, '' as TDCN, '' as TT, '' as KB from TM_DICHVU            left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = TM_DICHVU.NHOMDICHVU_ID            where DICHVU_ID = '5492' and left(ndv.MANHOMDICHVU, 2) = '02'            union            select  '' as HA, DICHVU_ID AS XN, '' as TDCN, '' as TT, '' as KB from TM_DICHVU            left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = TM_DICHVU.NHOMDICHVU_ID            where DICHVU_ID = '5492' and left(ndv.MANHOMDICHVU, 2) = '01'            union            select  '' as HA, '' AS XN, DICHVU_ID as TDCN, '' as TT, '' as KB from TM_DICHVU            left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = TM_DICHVU.NHOMDICHVU_ID            where DICHVU_ID = '5492' and left(ndv.MANHOMDICHVU, 2) = '03'            union            select  '' as HA, '' AS XN, '' as TDCN, DICHVU_ID as TT, '' as KB from TM_DICHVU            left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = TM_DICHVU.NHOMDICHVU_ID            where DICHVU_ID = '5492' and left(ndv.MANHOMDICHVU, 2) = '05'            union            select  '' as HA, '' AS XN, '' as TDCN, DICHVU_ID as TT, '' as KB from TM_DICHVU            left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = TM_DICHVU.NHOMDICHVU_ID            where DICHVU_ID = '5492' and left(ndv.MANHOMDICHVU, 2) = '06'            union            select  '' as HA, '' AS XN, '' as TDCN, '' as TT, DICHVU_ID as KB from TM_DICHVU            left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = TM_DICHVU.NHOMDICHVU_ID            where DICHVU_ID = '5492' and left(ndv.MANHOMDICHVU, 2) = '04']
2020-02-26 17:20:35,074 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN200226.0000001']
2020-02-26 17:20:35,123 [1] DEBUG - Statement Id: [DAOWF001_Kiemtrathongtindayeucaureturn] PreparedStatement : [select * from TT_REQUEST        where        PARA = '{"HOSPITAL_ID":"HLU01","SOTIEPNHAN":"TN200226.0000001"}']
2020-02-26 17:20:35,301 [1] DEBUG - Statement Id: [DAOWF001_Kiemtrathongtindichvudayeucaureturn] PreparedStatement : [select top 1 * from TT_REQUEST_SERVICE        where        PARA = '{"DICHVU_ID":"5492","DVYEUCAU_ID":"992278"}'  order by ID desc]
2020-02-26 17:20:35,327 [1] DEBUG - Statement Id: [DAOWF005_ReturnStateCuaDichVuYeuCau] PreparedStatement : [declare        @Detail_Id int,        @CurentState char(8),        @OldState char(8)          select top 1 @Detail_Id = ID, @CurentState = OLD_STATE_CODE, @OldState = CURR_STATE_CODE from TT_REQUEST_SERVICE_DETAIL        where        REQUEST_ID = '112236'        AND REQUEST_SERVICE_ID = '557015'        order by ID desc;          update TT_REQUEST_SERVICE set CURR_STATE_CODE = @CurentState, ISACTIVE = 1, ISCOMPLETE = 0 where ID = '557015';        delete from TT_REQUEST_SERVICE_DETAIL where ID = @Detail_Id;        insert into TT_REQUEST_SERVICE_HISTORY        (REQUEST_ID,REQUEST_SERVICE_ID, OLD_STATE_CODE, CURR_STATE_CODE) values ('112236','557015',@OldState, @CurentState);        select top 1 A.*, B.STATUS_CODE from TT_REQUEST_SERVICE A        left join TM_STATE B on A.CURR_STATE_CODE = B.STATE_CODE and A.PROCESS_CODE = B.PROCESS_CODE        where A.ID = '557015';]
2020-02-26 17:20:35,444 [1] DEBUG - Statement Id: [DAO00049_KiemtraloaiDV] PreparedStatement : [select DICHVU_ID AS HA, '' AS XN, '' as TDCN, '' as TT, '' as KB from TM_DICHVU            left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = TM_DICHVU.NHOMDICHVU_ID            where DICHVU_ID = '5492' and left(ndv.MANHOMDICHVU, 2) = '02'            union            select  '' as HA, DICHVU_ID AS XN, '' as TDCN, '' as TT, '' as KB from TM_DICHVU            left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = TM_DICHVU.NHOMDICHVU_ID            where DICHVU_ID = '5492' and left(ndv.MANHOMDICHVU, 2) = '01'            union            select  '' as HA, '' AS XN, DICHVU_ID as TDCN, '' as TT, '' as KB from TM_DICHVU            left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = TM_DICHVU.NHOMDICHVU_ID            where DICHVU_ID = '5492' and left(ndv.MANHOMDICHVU, 2) = '03'            union            select  '' as HA, '' AS XN, '' as TDCN, DICHVU_ID as TT, '' as KB from TM_DICHVU            left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = TM_DICHVU.NHOMDICHVU_ID            where DICHVU_ID = '5492' and left(ndv.MANHOMDICHVU, 2) = '05'            union            select  '' as HA, '' AS XN, '' as TDCN, DICHVU_ID as TT, '' as KB from TM_DICHVU            left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = TM_DICHVU.NHOMDICHVU_ID            where DICHVU_ID = '5492' and left(ndv.MANHOMDICHVU, 2) = '06'            union            select  '' as HA, '' AS XN, '' as TDCN, '' as TT, DICHVU_ID as KB from TM_DICHVU            left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = TM_DICHVU.NHOMDICHVU_ID            where DICHVU_ID = '5492' and left(ndv.MANHOMDICHVU, 2) = '04']
2020-02-26 17:20:35,468 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN200226.0000001']
2020-02-26 17:20:35,491 [1] DEBUG - Statement Id: [DAOWF001_Kiemtrathongtindayeucaudacochua] PreparedStatement : [select * from TT_REQUEST        where        PARA = '{"HOSPITAL_ID":"HLU01","SOTIEPNHAN":"TN200226.0000001"}'        AND ISACTIVE = '1']
2020-02-26 17:20:35,574 [1] DEBUG - Statement Id: [DAOWF001_Kiemtrathongtindichvudayeucau] PreparedStatement : [select top 1 * from TT_REQUEST_SERVICE        where        PARA = '{"DICHVU_ID":"5492","DVYEUCAU_ID":"992278"}'                AND ISACTIVE = '1' order by ID desc]
2020-02-26 17:20:35,597 [1] DEBUG - Statement Id: [DAOWF001_KiemtrathongtinchitietDichvuYeucau] PreparedStatement : [select * from TT_REQUEST_SERVICE_DETAIL        where        REQUEST_SERVICE_ID = '557015']
2020-02-26 17:20:35,635 [1] DEBUG - Statement Id: [DAOWF001_GetStartStateOfProcess] PreparedStatement : [select STATE_CODE from TM_STATE where TYPE_CODE = 'S' and PROCESS_CODE = 'P02']
2020-02-26 17:20:35,684 [1] DEBUG - Statement Id: [DAOWF001_Laythongtinwithstatecode] PreparedStatement : [select A.*, B.STATUS_CODE from        TM_STATE_ACTION A        left join TM_STATE B on B.STATE_CODE = A.NEXT_STATE_CODE and A.PROCESS_CODE = B.PROCESS_CODE        where        A.CURR_STATE_CODE = '6'        AND A.PROCESS_CODE = 'P02'        Order By ORDER_ID ASC]
2020-02-26 17:20:35,707 [1] DEBUG - Statement Id: [DAOWF003_Add] PreparedStatement : [insert into TT_REQUEST_SERVICE (        REQUEST_ID        , PARA        , CURR_STATE_CODE        , PROCESS_CODE        ) values (         @param0         ,  @param1         ,  @param2         ,  @param3         )        SELECT SCOPE_IDENTITY()]
2020-02-26 17:20:35,707 [1] DEBUG - Statement Id: [DAOWF003_Add] Parameters: [@param0=[REQUEST_ID,112236], @param1=[SERVICEPARA,{"DICHVU_ID":"5492","DVYEUCAU_ID":"992278"}], @param2=[CURR_STATE_CODE,9], @param3=[PROCESS_CODE,P02]]
2020-02-26 17:20:35,707 [1] DEBUG - Statement Id: [DAOWF003_Add] Types: [@param0=[Int32, System.Int32], @param1=[String, System.String], @param2=[String, System.String], @param3=[String, System.String]]
2020-02-26 17:20:35,731 [1] DEBUG - Statement Id: [DAOWF005_Add] PreparedStatement : [insert into TT_REQUEST_SERVICE_DETAIL (        REQUEST_ID        ,REQUEST_SERVICE_ID        , OLD_STATE_CODE        , CURR_STATE_CODE        ) values (         @param0         , @param1         ,  @param2         ,  @param3         )        SELECT SCOPE_IDENTITY()]
2020-02-26 17:20:35,731 [1] DEBUG - Statement Id: [DAOWF005_Add] Parameters: [@param0=[REQUEST_ID,112236], @param1=[REQUEST_SERVICE_ID,557016], @param2=[OLD_STATE_CODE,null], @param3=[CURR_STATE_CODE,9]]
2020-02-26 17:20:35,731 [1] DEBUG - Statement Id: [DAOWF005_Add] Types: [@param0=[String, System.String], @param1=[Int64, System.Int64], @param2=[System.DBNull, null], @param3=[String, System.String]]
2020-02-26 17:20:35,896 [1] DEBUG - Statement Id: [DAOWF005_Add_History] PreparedStatement : [insert into TT_REQUEST_SERVICE_HISTORY (        REQUEST_ID        ,REQUEST_SERVICE_ID        , OLD_STATE_CODE        , CURR_STATE_CODE        ) values (         @param0         , @param1         ,  @param2         ,  @param3         )]
2020-02-26 17:20:35,896 [1] DEBUG - Statement Id: [DAOWF005_Add_History] Parameters: [@param0=[REQUEST_ID,112236], @param1=[REQUEST_SERVICE_ID,557016], @param2=[OLD_STATE_CODE,null], @param3=[CURR_STATE_CODE,9]]
2020-02-26 17:20:35,896 [1] DEBUG - Statement Id: [DAOWF005_Add_History] Types: [@param0=[String, System.String], @param1=[Int64, System.Int64], @param2=[System.DBNull, null], @param3=[String, System.String]]
2020-02-26 17:20:35,920 [1] DEBUG - Statement Id: [DAO00009_TT_DVYEUCAU_Update] PreparedStatement : [Update TT_DVYEUCAU set TRANGTHAI_WFL = 'CHODONGTIEN' where DVYEUCAU_ID = '992278']
2020-02-26 17:20:48,459 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'OPD02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2020-02-26 17:20:49,753 [1] DEBUG - Statement Id: [DAO00017_GetLoaiGiaByDoiTuongId] PreparedStatement : [select dtlg.DOUUTIEN, dtlg.DOITUONG_ID, lg.LOAIGIA_ID, lg.TENLOAIGIA, lg.MALOAIGIA              from TM_LOAIGIA lg              left join TM_DOITUONG_LOAIGIA dtlg              on lg.LOAIGIA_ID = dtlg.LOAIGIA_ID and dtlg.BENHVIEN_ID = 'HLU01'              where lg.TAMNGUNG = 0 and lg.BENHVIEN_ID = 'HLU01'                             order by dtlg.DOUUTIEN]
2020-02-26 17:20:49,900 [1] DEBUG - Statement Id: [DAO00092_GetList_ToathuocNgoaitru] PreparedStatement : [select A.*, B.PHAMVI_ID, C.KHODUOC_ID from TM_TOATHUOC_NGOAITRU A        left join TM_DUOC_PHAMVISUDUNG B on B.MAPHAMVI = A.MAPHAMVI        left join (select distinct PHAMVI_ID, KHODUOC_ID from TM_DUOC_PHAMVISD_MAPPING) C on C.PHAMVI_ID = B.PHAMVI_ID        where A.TAMNGUNG != '1' and A.BENHVIEN_ID = 'HLU01'        ORDER BY A.SAPXEP ASC]
2020-02-26 17:20:50,092 [1] DEBUG - Statement Id: [DAO00012_GetLoaiTCLS] PreparedStatement : [select DICTIONARY_ID, DICTIONARY_CODE, DICTIONARY_NAME, cast('0' as Bit) CHON        from LST_DICTIONARY              where DICTIONARY_TYPE_CODE = 'KHAMBENH_LOAI_TRIEUCHUNGLS'        order by LST_DICTIONARY.IDX]
2020-02-26 17:20:50,204 [1] DEBUG - Statement Id: [DAO00012_GetAllTCLS] PreparedStatement : [select MALOAITRIEUCHUNG DICTIONARY_TYPE_CODE, MALOAITRIEUCHUNG DICTIONARY_CODE,        TENTRIEUCHUNG DICTIONARY_NAME from TM_TRIEUCHUNGLS]
2020-02-26 17:20:50,637 [1] DEBUG - Statement Id: [DAO00305_GetListPhongBanKhoaNgoai] PreparedStatement : [select A.*, B.DICTIONARY_CODE from TM_PHONGBAN A        inner join LST_DICTIONARY B on A.LOAIPHONGBAN_ID = B.DICTIONARY_ID        and B.DICTIONARY_TYPE_CODE = 'LoaiPhongBan'        where A.TAMNGUNG = '0'        and B.DICTIONARY_CODE = 'KhoaNgoai'        order by A.TENPHONGBAN asc]
2020-02-26 17:20:54,936 [1] DEBUG - Statement Id: [DAO00009_TT_TIEPNHAN_GetProcess] PreparedStatement : [select PROCESS_ID from TT_TIEPNHAN where SOTIEPNHAN = 'TN200226.0000001']
2020-02-26 17:20:54,959 [1] DEBUG - Statement Id: [DAOWF004_laytrangthaiDV] PreparedStatement : [select top 1 A.CURR_STATE_CODE as STATE_CODE, isNull(C.SHORT_NAME,C.NAME) as TRANGTHAI, C.NAME as TRANGTHAI_CHITIET, C.STATUS_CODE, D.ISACTIVE as ACTIVE, E.STATUS_CODE  as OLD_STATUSCODE        from TT_REQUEST_SERVICE_DETAIL A                left join (select * from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"5492","DVYEUCAU_ID":"992278"}') D on D.ID = A.REQUEST_SERVICE_ID        left join TM_STATE C on A.CURR_STATE_CODE = C.STATE_CODE and C.PROCESS_CODE = D.PROCESS_CODE        left join TM_STATE E on A.OLD_STATE_CODE = E.STATE_CODE and E.PROCESS_CODE = D.PROCESS_CODE        where        A.REQUEST_SERVICE_ID = (select top 1 ID from TT_REQUEST_SERVICE where PARA = '{"DICHVU_ID":"5492","DVYEUCAU_ID":"992278"}' order by ID desc)        order by A.ID desc]
2020-02-26 17:20:55,042 [1] DEBUG - Statement Id: [DAO00017_GetLoaiGiaByDoiTuongId] PreparedStatement : [select dtlg.DOUUTIEN, dtlg.DOITUONG_ID, lg.LOAIGIA_ID, lg.TENLOAIGIA, lg.MALOAIGIA              from TM_LOAIGIA lg              left join TM_DOITUONG_LOAIGIA dtlg              on lg.LOAIGIA_ID = dtlg.LOAIGIA_ID and dtlg.BENHVIEN_ID = 'HLU01'              where lg.TAMNGUNG = 0 and lg.BENHVIEN_ID = 'HLU01'                             order by dtlg.DOUUTIEN]
