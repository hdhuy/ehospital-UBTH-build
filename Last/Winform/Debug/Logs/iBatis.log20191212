--------------------------------------------------------------------------------
2019-12-12 09:40:17,336 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2019-12-12 09:40:18,150 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-12-12 09:40:18,208 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-12-12 09:40:19,568 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 09:40:21,943 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-12-12 09:40:40,637 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2019-12-12 09:40:40,668 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-12-12 09:40:49,567 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-12-12 09:40:49,811 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-12-12 09:40:51,871 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2019-12-12 09:40:56,156 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2019-12-12 09:40:56,362 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2019-12-12 09:40:56,639 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2019-12-12 09:40:56,772 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2019-12-12 09:40:56,864 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2019-12-12 09:40:57,153 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2019-12-12 09:40:57,326 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2019-12-12 09:40:57,462 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2019-12-12 09:40:58,178 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2019-12-12 09:40:58,251 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2019-12-12 09:40:58,349 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2019-12-12 09:40:58,391 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2019-12-12 09:41:02,976 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2019-12-12 09:41:03,039 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @NGUONDUOC_MACDINH varchar(5) = '0';        declare @TOAMUANGOAI int = 0;        select @NGUONDUOC_MACDINH = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'PHA_NGUONDUOC'        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + @NGUONDUOC_MACDINH as DUOC_KEY, 0 as PHAMVI_ID, @NGUONDUOC_MACDINH as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end        else        begin                  select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2019-12-12 09:41:05,991 [5] DEBUG - Statement Id: [DAO00320_GetList] PreparedStatement : [select M.*            from TM_MAU M            LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID            where            M.TAMNGUNG = '0'            and M.BENHVIEN_ID = 'HLU01'            order by M.TENMAU]
2019-12-12 09:41:06,075 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2019-12-12 09:41:06,158 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,        SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH        FROM TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID        WHERE TK.SOLUONG > 0        GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2019-12-12 09:41:06,326 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2019-12-12 09:41:06,359 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,        TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,        TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH        from TM_MAU M        JOIN        (        select        A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO        from        (        select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO        from TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'        where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0        ) A        )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2019-12-12 09:41:06,453 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2019-12-12 09:41:07,525 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 09:41:13,525 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2019-12-12 09:41:29,227 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2019-12-12 09:41:29,644 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2019-12-12 09:41:29,730 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 09:41:29,896 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 09:41:30,545 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2019-12-12 09:41:30,563 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-12-12 09:41:30,563 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-12-12 09:41:30,600 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2019-12-12 09:41:30,600 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-12-12 09:41:30,600 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-12-12 09:41:30,925 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 09:41:32,892 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 09:42:05,773 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 09:42:05,973 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2019-12-12 09:42:06,835 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2019-12-12 09:42:33,131 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM31'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 09:42:33,302 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'BIL18'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 09:42:35,660 [1] DEBUG - Statement Id: [DAO00012_GetList] PreparedStatement : [select        DICTIONARY_ID,        DICTIONARY_CODE,        DICTIONARY_NAME,        ATTRIBUTE1,        ATTRIBUTE2,        DICTIONARY_NAME_EN        from LST_DICTIONARY        where LST_DICTIONARY.Enabled = '1'         AND           LST_DICTIONARY.DICTIONARY_TYPE_CODE = 'LoaiHoaDon'                 order by LST_DICTIONARY.IDX]
2019-12-12 09:42:36,686 [1] DEBUG - Statement Id: [DAO00119_GetDanhsachHTTT] PreparedStatement : [select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE = 'HinhThucThanhToan' and ENABLED = '1' and BENHVIEN_ID = 'HLU01']
2019-12-12 09:42:44,335 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM56'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 09:42:45,076 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM98'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 09:43:00,029 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NOITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = a.BENHAN_ID                 where(                             A.DATHANHTOAN = 0                                             )                       and                           convert(date,A.NGAYHOADON) between convert(date, '4/1/2019 12:00:00 AM') and convert(date, '12/12/2019 12:00:00 AM')                       and                           A.BENHVIEN_ID = 'HLU01'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is not null                order by A.NGAYHOADON]
2019-12-12 10:21:26,666 [1] DEBUG - Statement Id: [DAO00019_ThongTinBenhNhanBenhAn] PreparedStatement : [select distinct C.SOBENHAN, C.BENHAN_ID, A.SOTIEPNHAN, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI, A.SOBHYT,        B.*        from TT_NOITRU_BENHAN C        inner join TT_TIEPNHAN A on C.TIEPNHAN_ID = A.TIEPNHAN_ID        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'        where                    C.SOBENHAN = '19.021995'                 and A.BENHVIEN_ID = 'HLU01']
2019-12-12 10:21:28,294 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_HINHTHUCTHANHTOAN_GetList] PreparedStatement : [select TT_HOADON_HINHTHUCTHANHTOAN.*, htttCode.DICTIONARY_CODE HINHTHUCTHANHTOAN_CODE            from TT_HOADON_HINHTHUCTHANHTOAN TT_HOADON_HINHTHUCTHANHTOAN            left join (select DICTIONARY_ID, DICTIONARY_CODE from LST_DICTIONARY where DICTIONARY_TYPE_CODE like 'HinhThucThanhToan') htttCode on htttCode.DICTIONARY_ID = TT_HOADON_HINHTHUCTHANHTOAN.HINHTHUCTHANHTOAN_ID             where                             TT_HOADON_HINHTHUCTHANHTOAN.HOADON_ID = '22181'                       and                           TT_HOADON_HINHTHUCTHANHTOAN.BENHVIEN_ID = 'HLU01'                                     order by HOADON_HTTT_ID]
2019-12-12 10:21:31,540 [1] DEBUG - Statement Id: [DAO00119_TT_VIENPHI_GetList_BenhAnByHoadon] PreparedStatement : [select  a.*, a.MIENGIAM_GIATRI as GIATRIMIENGIAM_BH, a.BHTN_GIATRI as GIATRIMIENGIAM_BHTN,        a.HOIVIEN_GIATRI as GIATRIMIENGIAM_THANHVIEN, a.CONGTYCHITRA_GIATRI as GIATRIMIENGIAM_CTCT,        isnull(dv.TENDICHVU, dc.TENDUOCDAYDU) NOIDUNG, isnull(dv.MADICHVU, dc.MADUOC) MADICHVU, dv.NORESULT, dc.DONVITINH, ld.MALOAIDUOC, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ndv.MANHOMDICHVU        from        (        select * from (        select vp.*, c.NOITHUCHIEN_ID, c.NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_DVYEUCAU c on c.DVYEUCAU_ID = VP.REF_ID and vpp.REF_TABLE = 'TT_DVYEUCAU'        union        select vp.*, C.PHONGBANRATOA_ID as NOITHUCHIEN_ID, D.PHONGBAN_ID NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_NOITRU_TOATHUOC c on c.TOATHUOC_ID = VP.REF_ID and vpp.REF_TABLE = 'TT_NOITRU_TOATHUOC'        inner join TT_NOITRU_KHAMBENH D on D.KHAMBENH_ID = C.KHAMBENH_ID        union        select vp.*, C.PHONGBAN_ID as NOITHUCHIEN_ID, C.PHONGBAN_ID as NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_CLSKETQUA_VTYT c on c.CLSKETQUA_VTYT_ID = VP.REF_ID and vpp.REF_TABLE = 'TT_CLSKETQUA_VTYT'        union        select vp.*, ISNULL(D.PHONGBANTHUCHIEN_ID,d.PHONGBANCHIDINH_ID) as NOITHUCHIEN_ID, ISNULL(D.PHONGBANCHIDINH_ID,D.PHONGBANTHUCHIEN_ID) as NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_PHAUTHUAT_VTYT c on c.PHAUTHUAT_VTYT_ID = VP.REF_ID and vpp.REF_TABLE = 'TT_PHAUTHUAT_VTYT'        inner join TT_PHAUTHUAT D on D.PHAUTHUAT_ID = C.PHAUTHUAT_ID        union        select vp.*, c.PHONGBAN_ID as NOITHUCHIEN_ID, c.PHONGBAN_ID as NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_NGOAITRU_KHAMBENH_VTYT c on c.KHAMBENH_VTYT_ID = VP.REF_ID and vpp.REF_TABLE = 'TT_NGOAITRU_KHAMBENH_VTYT'        union        select vp.*, E.PHONGBAN_ID as NOITHUCHIEN_ID, E.PHONGBAN_ID as NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_NUT_XACNHANSUATAN_CHITIET XNC on XNC.XACNHANSUATANCHITIET_ID = vp.REF_ID and vpp.REF_TABLE = 'TT_NUT_XACNHANSUATAN_CHITIET'        inner join TT_NUT_CHIDINHKHAUPHAN_CHITIET D on D.CHIDINHKHAUPHANCHITIET_ID = XNC.CHIDINHKHAUPHANCHITIET_ID        inner join TM_NUT_KHAUPHANAN c on C.KHAUPHANAN_ID = D.KHAUPHANAN_ID        inner join TT_NUT_CHIDINHKHAUPHAN E on E.CHIDINHKHAUPHAN_ID = D.CHIDINHKHAUPHAN_ID        ) B        where B.HOADON_ID = '22181'        ) a        left join TM_DUOC dc on a.DUOC_ID = dc.DUOC_ID        left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID        left join TM_DICHVU dv on a.DICHVU_ID = dv.DICHVU_ID and a.REF_TABLE = 'TT_DVYEUCAU'        left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID]
2019-12-12 10:21:36,129 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2019-12-12 10:21:36,129 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,HLU01]]
2019-12-12 10:21:36,129 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2019-12-12 10:21:36,544 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1              and               BLCT.BIENLAICHITIET_ID = '2'                         order by BLCT.THOIGIANSUDUNG DESC]
2019-12-12 10:21:36,544 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,HLU01]]
2019-12-12 10:21:36,544 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2019-12-12 10:21:53,735 [1] DEBUG - Statement Id: [DAO00014_GetInPatientStatus] PreparedStatement : [select TRANGTHAI, isnull(KHOACHUYENDEN_ID, KHOAVAO_ID) as KHOAHIENTAI from TT_NOITRU_BENHAN        where        TIEPNHAN_ID = '9238'        and BENHVIEN_ID = 'HLU01'         and           BENHAN_ID = '2013']
2019-12-12 10:21:54,200 [1] DEBUG - Statement Id: [DAO00119_GetDanhsachHTTT] PreparedStatement : [select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE = 'HinhThucThanhToan' and ENABLED = '1' and BENHVIEN_ID = 'HLU01']
2019-12-12 10:21:54,258 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2019-12-12 10:21:54,258 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,HLU01]]
2019-12-12 10:21:54,258 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2019-12-12 10:21:54,301 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2019-12-12 10:21:54,301 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,HLU01]]
2019-12-12 10:21:54,301 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2019-12-12 10:21:54,371 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1              and               BLCT.BIENLAICHITIET_ID = '2'                         order by BLCT.THOIGIANSUDUNG DESC]
2019-12-12 10:21:54,371 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,HLU01]]
2019-12-12 10:21:54,371 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2019-12-12 10:21:54,612 [1] DEBUG - Statement Id: [DAO00119_GetDanhsachHTTT] PreparedStatement : [select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE = 'HinhThucThanhToan' and ENABLED = '1' and BENHVIEN_ID = 'HLU01']
2019-12-12 10:21:59,002 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2019-12-12 10:21:59,002 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,HLU01]]
2019-12-12 10:21:59,002 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2019-12-12 10:21:59,118 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2019-12-12 10:21:59,118 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,HLU01]]
2019-12-12 10:21:59,118 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2019-12-12 10:21:59,162 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1              and               BLCT.BIENLAICHITIET_ID = '2'                         order by BLCT.THOIGIANSUDUNG DESC]
2019-12-12 10:21:59,162 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,HLU01]]
2019-12-12 10:21:59,162 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2019-12-12 10:21:59,318 [1] DEBUG - Statement Id: [DAO00014_GetInPatientStatus] PreparedStatement : [select TRANGTHAI, isnull(KHOACHUYENDEN_ID, KHOAVAO_ID) as KHOAHIENTAI from TT_NOITRU_BENHAN        where        TIEPNHAN_ID = '27396'        and BENHVIEN_ID = 'HLU01'         and           BENHAN_ID = '5861']
2019-12-12 10:21:59,413 [1] DEBUG - Statement Id: [DAO00119_GetDanhsachHTTT] PreparedStatement : [select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE = 'HinhThucThanhToan' and ENABLED = '1' and BENHVIEN_ID = 'HLU01']
2019-12-12 10:21:59,473 [1] DEBUG - Statement Id: [DAO00119_GetDanhsachHTTT] PreparedStatement : [select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE = 'HinhThucThanhToan' and ENABLED = '1' and BENHVIEN_ID = 'HLU01']
2019-12-12 10:22:02,741 [1] DEBUG - Statement Id: [DAO00119_GetDanhsachHTTT] PreparedStatement : [select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE = 'HinhThucThanhToan' and ENABLED = '1' and BENHVIEN_ID = 'HLU01']
2019-12-12 10:22:05,286 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2019-12-12 10:22:05,286 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,HLU01]]
2019-12-12 10:22:05,286 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2019-12-12 10:22:05,329 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2019-12-12 10:22:05,329 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,HLU01]]
2019-12-12 10:22:05,329 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2019-12-12 10:22:05,429 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1              and               BLCT.BIENLAICHITIET_ID = '2'                         order by BLCT.THOIGIANSUDUNG DESC]
2019-12-12 10:22:05,429 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,HLU01]]
2019-12-12 10:22:05,429 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2019-12-12 10:22:05,518 [1] DEBUG - Statement Id: [DAO00014_GetInPatientStatus] PreparedStatement : [select TRANGTHAI, isnull(KHOACHUYENDEN_ID, KHOAVAO_ID) as KHOAHIENTAI from TT_NOITRU_BENHAN        where        TIEPNHAN_ID = '27126'        and BENHVIEN_ID = 'HLU01'         and           BENHAN_ID = '5838']
2019-12-12 10:22:05,634 [1] DEBUG - Statement Id: [DAO00119_GetDanhsachHTTT] PreparedStatement : [select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE = 'HinhThucThanhToan' and ENABLED = '1' and BENHVIEN_ID = 'HLU01']
2019-12-12 10:22:05,698 [1] DEBUG - Statement Id: [DAO00119_GetDanhsachHTTT] PreparedStatement : [select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE = 'HinhThucThanhToan' and ENABLED = '1' and BENHVIEN_ID = 'HLU01']
2019-12-12 10:22:08,657 [1] DEBUG - Statement Id: [DAO00119_GetDanhsachHTTT] PreparedStatement : [select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE = 'HinhThucThanhToan' and ENABLED = '1' and BENHVIEN_ID = 'HLU01']
2019-12-12 10:22:23,240 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2019-12-12 10:22:23,240 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,HLU01]]
2019-12-12 10:22:23,240 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2019-12-12 10:22:23,291 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2019-12-12 10:22:23,291 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,HLU01]]
2019-12-12 10:22:23,291 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2019-12-12 10:22:23,379 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1              and               BLCT.BIENLAICHITIET_ID = '2'                         order by BLCT.THOIGIANSUDUNG DESC]
2019-12-12 10:22:23,379 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,HLU01]]
2019-12-12 10:22:23,379 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2019-12-12 10:22:23,464 [1] DEBUG - Statement Id: [DAO00014_GetInPatientStatus] PreparedStatement : [select TRANGTHAI, isnull(KHOACHUYENDEN_ID, KHOAVAO_ID) as KHOAHIENTAI from TT_NOITRU_BENHAN        where        TIEPNHAN_ID = '23256'        and BENHVIEN_ID = 'HLU01'         and           BENHAN_ID = '4975']
2019-12-12 10:22:23,555 [1] DEBUG - Statement Id: [DAO00119_GetDanhsachHTTT] PreparedStatement : [select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE = 'HinhThucThanhToan' and ENABLED = '1' and BENHVIEN_ID = 'HLU01']
2019-12-12 10:22:23,614 [1] DEBUG - Statement Id: [DAO00119_GetDanhsachHTTT] PreparedStatement : [select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE = 'HinhThucThanhToan' and ENABLED = '1' and BENHVIEN_ID = 'HLU01']
2019-12-12 10:22:38,962 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1              and               BLCT.BIENLAICHITIET_ID = '2'                         order by BLCT.THOIGIANSUDUNG DESC]
2019-12-12 10:22:38,963 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,HLU01]]
2019-12-12 10:22:38,963 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2019-12-12 10:22:39,026 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1              and               BLCT.BIENLAICHITIET_ID = '2'                         order by BLCT.THOIGIANSUDUNG DESC]
2019-12-12 10:22:39,026 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,HLU01]]
2019-12-12 10:22:39,026 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2019-12-12 10:22:48,318 [1] DEBUG - Statement Id: [DAO00014_GetInPatientStatus] PreparedStatement : [select TRANGTHAI, isnull(KHOACHUYENDEN_ID, KHOAVAO_ID) as KHOAHIENTAI from TT_NOITRU_BENHAN        where        TIEPNHAN_ID = '23256'        and BENHVIEN_ID = 'HLU01'         and           BENHAN_ID = '4975']
2019-12-12 10:22:48,401 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2019-12-12 10:22:48,401 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,HLU01]]
2019-12-12 10:22:48,402 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2019-12-12 10:22:48,453 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2019-12-12 10:22:48,453 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,HLU01]]
2019-12-12 10:22:48,453 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2019-12-12 10:22:48,491 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1              and               BLCT.BIENLAICHITIET_ID = '2'                         order by BLCT.THOIGIANSUDUNG DESC]
2019-12-12 10:22:48,491 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,HLU01]]
2019-12-12 10:22:48,491 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2019-12-12 10:22:51,841 [1] DEBUG - Statement Id: [DAO00119_TT_VIENPHI_XoaBienLaiTamNoiTru] PreparedStatement : [delete from TT_HOADON_HINHTHUCTHANHTOAN        where HOADON_ID = ''          delete from TT_HOADON_CHITIET_NOITRU        where HOADON_ID = ''          delete from TT_HOADON        where HOADON_ID = '' and TRANGTHAI in ('CHUATHUTIEN', 'CHODUYETCONGNO', 'CHOXACNHANTTVIDT')          update TT_VIENPHI set HOADON_ID = null where HOADON_ID = '']
2019-12-12 10:22:53,235 [1] DEBUG - Statement Id: [DAO00087_GetServiceParams] PreparedStatement : [select CODE, VALUE              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01']
2019-12-12 10:22:53,487 [1] DEBUG - Statement Id: [DAO00055_GetDetail] PreparedStatement : [select *              from LST_KEYDATA_VIENPHI               where                             LST_KEYDATA_VIENPHI.KEYTYPE = 'TU'                       and                           LST_KEYDATA_VIENPHI.KEYYEAR = '2019'                       and                           LST_KEYDATA_VIENPHI.KEYMONTH = '12'                       and                           LST_KEYDATA_VIENPHI.KEYDAY = '0'                       and                           LST_KEYDATA_VIENPHI.SEGMENT_1 = '0'                       and                           LST_KEYDATA_VIENPHI.SEGMENT_2 = '0'                       and                           LST_KEYDATA_VIENPHI.SEGMENT_3 = '0'                                     order by KEYTYPE]
2019-12-12 10:22:54,200 [1] DEBUG - Statement Id: [DAO00055_Add] PreparedStatement : [insert into LST_KEYDATA_VIENPHI (            KEYTYPE            , KEYYEAR            , KEYMONTH            , KEYDAY            , SEGMENT_1            , SEGMENT_2            , SEGMENT_3            , KEYVALUE            , BENHVIEN_ID            ) values (             @param0             ,  @param1             ,  @param2             ,  @param3             ,  @param4             ,  @param5             ,  @param6             ,  @param7             ,  @param8             )]
2019-12-12 10:22:54,200 [1] DEBUG - Statement Id: [DAO00055_Add] Parameters: [@param0=[KEYTYPE,TU], @param1=[KEYYEAR,2019], @param2=[KEYMONTH,12], @param3=[KEYDAY,0], @param4=[SEGMENT_1,0], @param5=[SEGMENT_2,0], @param6=[SEGMENT_3,0], @param7=[KEYVALUE,000001], @param8=[BENHVIEN_ID,HLU01]]
2019-12-12 10:22:54,200 [1] DEBUG - Statement Id: [DAO00055_Add] Types: [@param0=[String, System.String], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[Int32, System.Int32], @param4=[String, System.String], @param5=[String, System.String], @param6=[String, System.String], @param7=[String, System.String], @param8=[String, System.String]]
2019-12-12 10:22:54,235 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Add] PreparedStatement : [insert into TT_HOADON (              SOHOADON              , LOAIHOADON              , TIEPNHAN_ID              , BENHNHAN_ID              , BENHAN_ID              , DOITUONG_ID              , BENHAN_NGOAITRU_ID              , NGAYPHATSINH              , NGAYHOADON              , NOIPHATSINH_ID              , NGUOILAP_ID              , NOITHUTIEN_ID              , NGUOITHUTIEN_ID              , NOITRA_ID              , NGUOITRA_ID              , NGAYTRA              , GIATRIHOADON              , GIATRITHUCTHU              , TIENTE_ID              , TYGIA              , GIATRIVND              , DANGKYHOADON_ID              , SOSERIEVAT              , SOHOADONVAT              , GIATRIVAT              , NGOAIGIO              , THUHD_BL              , GHICHU              , TRANGTHAI              , DATHANHTOAN              , HUYHOADON              , LYDOHUY_ID              , HOANTRA              , IDCHUYEN              , IDCHUYENHUY              , IDCHUYENHOAN              , HOADONLIENQUAN_ID              , TRANSFER_VIENPHI_ID              , NGAYKHOAGOI              , NHOMTHANHTOAN_ID              , HOADONDOIUNG              , CHUYENCHUNGTUID              , CHUYENCHUNGTUHOANID              , CHUYENCHUNGTUHUYID              , CHUYENDOANHTHUID              , CHUYENDOANHTHUHOANID              , CHUYENDOANHTHUHUYID              , KH_TENCONGTY              , KH_MASOTHUE              , KH_DIACHI              , KH_NGUOIDAIDIEN              , INLAI              , INLAI_USER_ID                           , BENHVIEN_ID            , NGAYTAO            , NGUOITAO_ID            , NGAYCAPNHAT            , NGUOICAPNHAT_ID                            , YEUCAUVP                            , TRANGTHAIBENHAN                            , MACHINENAME                           ) values (               @param0               ,  @param1               ,  @param2               ,  @param3               ,  @param4               ,  @param5               ,  @param6               ,  @param7               ,  @param8               ,  @param9               ,  @param10               ,  @param11               ,  @param12               ,  @param13               ,  @param14               ,  @param15               ,  @param16               ,  @param17               ,  @param18               ,  @param19               ,  @param20               ,  @param21               ,  @param22               ,  @param23               ,  @param24               ,  @param25               ,  @param26               ,  @param27               ,  @param28               ,  @param29               ,  @param30               ,  @param31               ,  @param32               ,  @param33               ,  @param34               ,  @param35               ,  @param36               ,  @param37               ,  @param38               ,  @param39               ,  @param40               ,  @param41               ,  @param42               ,  @param43               ,  @param44               ,  @param45               ,  @param46               ,  @param47               ,  @param48               ,  @param49               ,  @param50               ,  @param51               ,  @param52                            ,  @param53             ,  @param54             ,  @param55             ,  @param56             ,  @param57                             , @param58                             ,  @param59                             ,  @param60                            )              SELECT SCOPE_IDENTITY()]
2019-12-12 10:22:54,235 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Add] Parameters: [@param0=[SOHOADON,TU.1912000001], @param1=[LOAIHOADON,TU], @param2=[TIEPNHAN_ID,23256], @param3=[BENHNHAN_ID,20205], @param4=[BENHAN_ID,4975], @param5=[DOITUONG_ID,6], @param6=[BENHAN_NGOAITRU_ID,null], @param7=[NGAYPHATSINH,12/12/2019 10:22:54 AM], @param8=[NGAYHOADON,12/12/2019 10:22:54 AM], @param9=[NOIPHATSINH_ID,68], @param10=[NGUOILAP_ID,1], @param11=[NOITHUTIEN_ID,68], @param12=[NGUOITHUTIEN_ID,1], @param13=[NOITRA_ID,null], @param14=[NGUOITRA_ID,null], @param15=[NGAYTRA,null], @param16=[GIATRIHOADON,1000000], @param17=[GIATRITHUCTHU,1000000], @param18=[TIENTE_ID,VND], @param19=[TYGIA,1], @param20=[GIATRIVND,1000000], @param21=[DANGKYHOADON_ID,null], @param22=[SOSERIEVAT,null], @param23=[SOHOADONVAT,null], @param24=[GIATRIVAT,null], @param25=[NGOAIGIO,null], @param26=[THUHD_BL,HD], @param27=[GHICHU,null], @param28=[TRANGTHAI,CHUATHUTIEN], @param29=[DATHANHTOAN,0], @param30=[HUYHOADON,0], @param31=[LYDOHUY_ID,null], @param32=[HOANTRA,0], @param33=[IDCHUYEN,null], @param34=[IDCHUYENHUY,null], @param35=[IDCHUYENHOAN,null], @param36=[HOADONLIENQUAN_ID,null], @param37=[TRANSFER_VIENPHI_ID,null], @param38=[NGAYKHOAGOI,null], @param39=[NHOMTHANHTOAN_ID,null], @param40=[HOADONDOIUNG,null], @param41=[CHUYENCHUNGTUID,null], @param42=[CHUYENCHUNGTUHOANID,null], @param43=[CHUYENCHUNGTUHUYID,null], @param44=[CHUYENDOANHTHUID,null], @param45=[CHUYENDOANHTHUHOANID,null], @param46=[CHUYENDOANHTHUHUYID,null], @param47=[KH_TENCONGTY,null], @param48=[KH_MASOTHUE,null], @param49=[KH_DIACHI,null], @param50=[KH_NGUOIDAIDIEN,null], @param51=[INLAI,null], @param52=[INLAI_USER_ID,null], @param53=[BENHVIEN_ID,HLU01], @param54=[NGAYTAO,12/12/2019 10:22:54 AM], @param55=[NGUOITAO_ID,1], @param56=[NGAYCAPNHAT,12/12/2019 10:22:54 AM], @param57=[NGUOICAPNHAT_ID,1], @param58=[YEUCAUVP,False], @param59=[TRANGTHAIBENHAN,DANGDIEUTRI], @param60=[MACHINENAME,GMC-HAIPN6]]
2019-12-12 10:22:54,235 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Add] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[Int64, System.Int64], @param3=[Int64, System.Int64], @param4=[Int64, System.Int64], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[DateTime, System.DateTime], @param8=[DateTime, System.DateTime], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Int64, System.Int64], @param12=[Int64, System.Int64], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[Double, System.Double], @param17=[Double, System.Double], @param18=[String, System.String], @param19=[Double, System.Double], @param20=[Double, System.Double], @param21=[System.DBNull, null], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[String, System.String], @param29=[String, System.String], @param30=[String, System.String], @param31=[System.DBNull, null], @param32=[String, System.String], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[System.DBNull, null], @param39=[System.DBNull, null], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[System.DBNull, null], @param50=[System.DBNull, null], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[String, System.String], @param54=[DateTime, System.DateTime], @param55=[Int64, System.Int64], @param56=[DateTime, System.DateTime], @param57=[Int64, System.Int64], @param58=[Boolean, System.Boolean], @param59=[String, System.String], @param60=[String, System.String]]
2019-12-12 10:22:55,377 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_HINHTHUCTHANHTOAN_Add] PreparedStatement : [insert into TT_HOADON_HINHTHUCTHANHTOAN (              HOADON_ID              , HINHTHUCTHANHTOAN_ID              , TENHINHTHUCTHANHTOAN              , GIATRITHUCTHU              , TIENTE              , TIENTE_ID              , TYGIA              , GIATRIVND              , BENHVIEN_ID              ) values (               @param0               ,  @param1               ,  @param2               ,  @param3               ,  @param4               ,  @param5               ,  @param6               ,  @param7               ,  @param8               )]
2019-12-12 10:22:55,377 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_HINHTHUCTHANHTOAN_Add] Parameters: [@param0=[HOADON_ID,43923], @param1=[HINHTHUCTHANHTOAN_ID,443], @param2=[TENHINHTHUCTHANHTOAN,Tiền mặt], @param3=[GIATRITHUCTHU,1000000], @param4=[TIENTE,VND], @param5=[TIENTE_ID,8047], @param6=[TYGIA,1], @param7=[GIATRIVND,1000000], @param8=[BENHVIEN_ID,HLU01]]
2019-12-12 10:22:55,377 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_HINHTHUCTHANHTOAN_Add] Types: [@param0=[Int64, System.Int64], @param1=[Int64, System.Int64], @param2=[String, System.String], @param3=[Double, System.Double], @param4=[String, System.String], @param5=[String, System.String], @param6=[Double, System.Double], @param7=[Double, System.Double], @param8=[String, System.String]]
2019-12-12 10:23:03,036 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NOITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = a.BENHAN_ID                 where(                           (A.DATHANHTOAN = '1'                         and                           A.TRANGTHAI != 'DADUYETCONGNO'                         )                          and (A.HUYHOADON is null or A.HUYHOADON = '0')                          and (A.HOANTRA is null or A.HOANTRA = '0')                                             )                       and                           A.TIEPNHAN_ID = '23256'                       and                           A.BENHAN_ID = '4975'                       and                         (bn.TENBENHNHAN like '%' +  @param0  + '%' or bn.MAYTE like '%' +  @param0  + '%')                       and                           convert(date,A.NGAYHOADON) between convert(date, '12/12/2019 12:00:00 AM') and convert(date, '12/12/2019 12:00:00 AM')                       and                           A.BENHVIEN_ID = 'HLU01'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is not null  and                           ntba.BENHAN_ID = '4975'                                       order by A.NGAYHOADON]
2019-12-12 10:23:03,036 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] Parameters: [@param0=[TENBENHNHAN,190040103]]
2019-12-12 10:23:03,036 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] Types: [@param0=[String, System.String]]
2019-12-12 10:23:09,231 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NOITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = a.BENHAN_ID                 where(                           (A.DATHANHTOAN = '1'                         and                           A.TRANGTHAI != 'DADUYETCONGNO'                         )                          and (A.HUYHOADON is null or A.HUYHOADON = '0')                          and (A.HOANTRA is null or A.HOANTRA = '0')                       or                           A.HUYHOADON = '1'                       or                           A.HOANTRA = '1'                       or                           A.DATHANHTOAN = 0                                             )                       and                           A.TIEPNHAN_ID = '23256'                       and                           A.BENHAN_ID = '4975'                       and                         (bn.TENBENHNHAN like '%' +  @param0  + '%' or bn.MAYTE like '%' +  @param0  + '%')                       and                           convert(date,A.NGAYHOADON) between convert(date, '12/12/2019 12:00:00 AM') and convert(date, '12/12/2019 12:00:00 AM')                       and                           A.BENHVIEN_ID = 'HLU01'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is not null  and                           ntba.BENHAN_ID = '4975'                                       order by A.NGAYHOADON]
2019-12-12 10:23:09,232 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] Parameters: [@param0=[TENBENHNHAN,190040103]]
2019-12-12 10:23:09,232 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] Types: [@param0=[String, System.String]]
2019-12-12 10:23:17,024 [1] DEBUG - Statement Id: [DAO00119_GetDanhsachHTTT] PreparedStatement : [select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE = 'HinhThucThanhToan' and ENABLED = '1' and BENHVIEN_ID = 'HLU01']
2019-12-12 10:23:18,592 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2019-12-12 10:23:18,592 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,HLU01]]
2019-12-12 10:23:18,592 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2019-12-12 10:23:18,700 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2019-12-12 10:23:18,700 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,HLU01]]
2019-12-12 10:23:18,700 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2019-12-12 10:23:18,764 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1              and               BLCT.BIENLAICHITIET_ID = '2'                         order by BLCT.THOIGIANSUDUNG DESC]
2019-12-12 10:23:18,764 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,HLU01]]
2019-12-12 10:23:18,764 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2019-12-12 10:23:18,880 [1] DEBUG - Statement Id: [DAO00014_GetInPatientStatus] PreparedStatement : [select TRANGTHAI, isnull(KHOACHUYENDEN_ID, KHOAVAO_ID) as KHOAHIENTAI from TT_NOITRU_BENHAN        where        TIEPNHAN_ID = '23256'        and BENHVIEN_ID = 'HLU01'         and           BENHAN_ID = '4975']
2019-12-12 10:23:19,069 [1] DEBUG - Statement Id: [DAO00119_GetDanhsachHTTT] PreparedStatement : [select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE = 'HinhThucThanhToan' and ENABLED = '1' and BENHVIEN_ID = 'HLU01']
2019-12-12 10:23:19,153 [1] DEBUG - Statement Id: [DAO00119_GetDanhsachHTTT] PreparedStatement : [select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE = 'HinhThucThanhToan' and ENABLED = '1' and BENHVIEN_ID = 'HLU01']
2019-12-12 10:23:23,091 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NOITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = a.BENHAN_ID                 where(                           (A.DATHANHTOAN = '1'                         and                           A.TRANGTHAI != 'DADUYETCONGNO'                         )                          and (A.HUYHOADON is null or A.HUYHOADON = '0')                          and (A.HOANTRA is null or A.HOANTRA = '0')                                             )                       and                           A.TIEPNHAN_ID = '23256'                       and                           A.BENHAN_ID = '4975'                       and                         (bn.TENBENHNHAN like '%' +  @param0  + '%' or bn.MAYTE like '%' +  @param0  + '%')                       and                           convert(date,A.NGAYHOADON) between convert(date, '12/12/2019 12:00:00 AM') and convert(date, '12/12/2019 12:00:00 AM')                       and                           A.BENHVIEN_ID = 'HLU01'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is not null  and                           ntba.BENHAN_ID = '4975'                                       order by A.NGAYHOADON]
2019-12-12 10:23:23,091 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] Parameters: [@param0=[TENBENHNHAN,190040103]]
2019-12-12 10:23:23,091 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] Types: [@param0=[String, System.String]]
2019-12-12 10:23:26,844 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NOITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = a.BENHAN_ID                 where(                           (A.DATHANHTOAN = '1'                         and                           A.TRANGTHAI != 'DADUYETCONGNO'                         )                          and (A.HUYHOADON is null or A.HUYHOADON = '0')                          and (A.HOANTRA is null or A.HOANTRA = '0')                       or                           A.HUYHOADON = '1'                       or                           A.HOANTRA = '1'                       or                           A.DATHANHTOAN = 0                                             )                       and                           A.TIEPNHAN_ID = '23256'                       and                           A.BENHAN_ID = '4975'                       and                         (bn.TENBENHNHAN like '%' +  @param0  + '%' or bn.MAYTE like '%' +  @param0  + '%')                       and                           convert(date,A.NGAYHOADON) between convert(date, '12/12/2019 12:00:00 AM') and convert(date, '12/12/2019 12:00:00 AM')                       and                           A.BENHVIEN_ID = 'HLU01'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is not null  and                           ntba.BENHAN_ID = '4975'                                       order by A.NGAYHOADON]
2019-12-12 10:23:26,844 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] Parameters: [@param0=[TENBENHNHAN,190040103]]
2019-12-12 10:23:26,844 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] Types: [@param0=[String, System.String]]
2019-12-12 10:23:28,688 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_HINHTHUCTHANHTOAN_GetList] PreparedStatement : [select TT_HOADON_HINHTHUCTHANHTOAN.*, htttCode.DICTIONARY_CODE HINHTHUCTHANHTOAN_CODE            from TT_HOADON_HINHTHUCTHANHTOAN TT_HOADON_HINHTHUCTHANHTOAN            left join (select DICTIONARY_ID, DICTIONARY_CODE from LST_DICTIONARY where DICTIONARY_TYPE_CODE like 'HinhThucThanhToan') htttCode on htttCode.DICTIONARY_ID = TT_HOADON_HINHTHUCTHANHTOAN.HINHTHUCTHANHTOAN_ID             where                             TT_HOADON_HINHTHUCTHANHTOAN.HOADON_ID = '43923'                       and                           TT_HOADON_HINHTHUCTHANHTOAN.BENHVIEN_ID = 'HLU01'                                     order by HOADON_HTTT_ID]
2019-12-12 10:23:28,747 [1] DEBUG - Statement Id: [DAO00119_TT_VIENPHI_GetList_BenhAnByHoadon] PreparedStatement : [select  a.*, a.MIENGIAM_GIATRI as GIATRIMIENGIAM_BH, a.BHTN_GIATRI as GIATRIMIENGIAM_BHTN,        a.HOIVIEN_GIATRI as GIATRIMIENGIAM_THANHVIEN, a.CONGTYCHITRA_GIATRI as GIATRIMIENGIAM_CTCT,        isnull(dv.TENDICHVU, dc.TENDUOCDAYDU) NOIDUNG, isnull(dv.MADICHVU, dc.MADUOC) MADICHVU, dv.NORESULT, dc.DONVITINH, ld.MALOAIDUOC, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ndv.MANHOMDICHVU        from        (        select * from (        select vp.*, c.NOITHUCHIEN_ID, c.NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_DVYEUCAU c on c.DVYEUCAU_ID = VP.REF_ID and vpp.REF_TABLE = 'TT_DVYEUCAU'        union        select vp.*, C.PHONGBANRATOA_ID as NOITHUCHIEN_ID, D.PHONGBAN_ID NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_NOITRU_TOATHUOC c on c.TOATHUOC_ID = VP.REF_ID and vpp.REF_TABLE = 'TT_NOITRU_TOATHUOC'        inner join TT_NOITRU_KHAMBENH D on D.KHAMBENH_ID = C.KHAMBENH_ID        union        select vp.*, C.PHONGBAN_ID as NOITHUCHIEN_ID, C.PHONGBAN_ID as NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_CLSKETQUA_VTYT c on c.CLSKETQUA_VTYT_ID = VP.REF_ID and vpp.REF_TABLE = 'TT_CLSKETQUA_VTYT'        union        select vp.*, ISNULL(D.PHONGBANTHUCHIEN_ID,d.PHONGBANCHIDINH_ID) as NOITHUCHIEN_ID, ISNULL(D.PHONGBANCHIDINH_ID,D.PHONGBANTHUCHIEN_ID) as NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_PHAUTHUAT_VTYT c on c.PHAUTHUAT_VTYT_ID = VP.REF_ID and vpp.REF_TABLE = 'TT_PHAUTHUAT_VTYT'        inner join TT_PHAUTHUAT D on D.PHAUTHUAT_ID = C.PHAUTHUAT_ID        union        select vp.*, c.PHONGBAN_ID as NOITHUCHIEN_ID, c.PHONGBAN_ID as NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_NGOAITRU_KHAMBENH_VTYT c on c.KHAMBENH_VTYT_ID = VP.REF_ID and vpp.REF_TABLE = 'TT_NGOAITRU_KHAMBENH_VTYT'        union        select vp.*, E.PHONGBAN_ID as NOITHUCHIEN_ID, E.PHONGBAN_ID as NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_NUT_XACNHANSUATAN_CHITIET XNC on XNC.XACNHANSUATANCHITIET_ID = vp.REF_ID and vpp.REF_TABLE = 'TT_NUT_XACNHANSUATAN_CHITIET'        inner join TT_NUT_CHIDINHKHAUPHAN_CHITIET D on D.CHIDINHKHAUPHANCHITIET_ID = XNC.CHIDINHKHAUPHANCHITIET_ID        inner join TM_NUT_KHAUPHANAN c on C.KHAUPHANAN_ID = D.KHAUPHANAN_ID        inner join TT_NUT_CHIDINHKHAUPHAN E on E.CHIDINHKHAUPHAN_ID = D.CHIDINHKHAUPHAN_ID        ) B        where B.HOADON_ID = '43923'        ) a        left join TM_DUOC dc on a.DUOC_ID = dc.DUOC_ID        left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID        left join TM_DICHVU dv on a.DICHVU_ID = dv.DICHVU_ID and a.REF_TABLE = 'TT_DVYEUCAU'        left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID]
2019-12-12 10:23:29,009 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2019-12-12 10:23:29,009 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,HLU01]]
2019-12-12 10:23:29,009 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2019-12-12 10:23:29,052 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2019-12-12 10:23:29,053 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,HLU01]]
2019-12-12 10:23:29,053 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2019-12-12 10:23:29,133 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1              and               BLCT.BIENLAICHITIET_ID = '2'                         order by BLCT.THOIGIANSUDUNG DESC]
2019-12-12 10:23:29,133 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,HLU01]]
2019-12-12 10:23:29,133 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2019-12-12 10:23:48,146 [1] DEBUG - Statement Id: [DAO00119_TT_VIENPHI_XoaBienLaiTamNgoaiTru] PreparedStatement : [delete from TT_HOADON_HINHTHUCTHANHTOAN        where HOADON_ID = '43923'          delete from TT_HOADON_CHITIET_NGOAITRU        where HOADON_ID = '43923'          delete from TT_HOADON        where HOADON_ID = '43923' and TRANGTHAI in ('CHUATHUTIEN', 'CHODUYETCONGNO', 'CHOXACNHANTTVIDT')          update TT_VIENPHI set HOADON_ID = null where HOADON_ID = '43923']
2019-12-12 10:23:53,863 [1] DEBUG - Statement Id: [DAO00014_GetInPatientStatus] PreparedStatement : [select TRANGTHAI, isnull(KHOACHUYENDEN_ID, KHOAVAO_ID) as KHOAHIENTAI from TT_NOITRU_BENHAN        where        TIEPNHAN_ID = '23256'        and BENHVIEN_ID = 'HLU01'         and           BENHAN_ID = '4975']
2019-12-12 10:23:54,094 [1] DEBUG - Statement Id: [DAO00119_GetDanhsachHTTT] PreparedStatement : [select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE = 'HinhThucThanhToan' and ENABLED = '1' and BENHVIEN_ID = 'HLU01']
2019-12-12 10:23:54,196 [1] DEBUG - Statement Id: [DAO00119_GetDanhsachHTTT] PreparedStatement : [select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE = 'HinhThucThanhToan' and ENABLED = '1' and BENHVIEN_ID = 'HLU01']
2019-12-12 10:23:54,276 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2019-12-12 10:23:54,276 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,HLU01]]
2019-12-12 10:23:54,276 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2019-12-12 10:23:54,431 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2019-12-12 10:23:54,431 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,HLU01]]
2019-12-12 10:23:54,431 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2019-12-12 10:23:54,539 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1              and               BLCT.BIENLAICHITIET_ID = '2'                         order by BLCT.THOIGIANSUDUNG DESC]
2019-12-12 10:23:54,539 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,HLU01]]
2019-12-12 10:23:54,539 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2019-12-12 10:29:29,987 [1] DEBUG - Statement Id: [DAO00119_GetDanhsachHTTT] PreparedStatement : [select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE = 'HinhThucThanhToan' and ENABLED = '1' and BENHVIEN_ID = 'HLU01']
2019-12-12 10:29:41,828 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NOITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = a.BENHAN_ID                 where(                           (A.DATHANHTOAN = '1'                         and                           A.TRANGTHAI != 'DADUYETCONGNO'                         )                          and (A.HUYHOADON is null or A.HUYHOADON = '0')                          and (A.HOANTRA is null or A.HOANTRA = '0')                       or                           A.HUYHOADON = '1'                       or                           A.HOANTRA = '1'                       or                           A.DATHANHTOAN = 0                                             )                       and                         A.SOHOADON like '%' +  @param0  + '%'                       and                           convert(date,A.NGAYHOADON) between convert(date, '4/1/2019 12:00:00 AM') and convert(date, '12/12/2019 12:00:00 AM')                       and                           A.BENHVIEN_ID = 'HLU01'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is not null                order by A.NGAYHOADON]
2019-12-12 10:29:41,829 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] Parameters: [@param0=[TUKHOA,BL.1905000021]]
2019-12-12 10:29:41,829 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] Types: [@param0=[String, System.String]]
2019-12-12 10:29:44,070 [1] DEBUG - Statement Id: [DAO00019_ThongTinBenhNhanBenhAn] PreparedStatement : [select distinct C.SOBENHAN, C.BENHAN_ID, A.SOTIEPNHAN, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI, A.SOBHYT,        B.*        from TT_NOITRU_BENHAN C        inner join TT_TIEPNHAN A on C.TIEPNHAN_ID = A.TIEPNHAN_ID        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'        where                    C.SOBENHAN = '19.022516'                 and A.BENHVIEN_ID = 'HLU01']
2019-12-12 10:29:46,981 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_HINHTHUCTHANHTOAN_GetList] PreparedStatement : [select TT_HOADON_HINHTHUCTHANHTOAN.*, htttCode.DICTIONARY_CODE HINHTHUCTHANHTOAN_CODE            from TT_HOADON_HINHTHUCTHANHTOAN TT_HOADON_HINHTHUCTHANHTOAN            left join (select DICTIONARY_ID, DICTIONARY_CODE from LST_DICTIONARY where DICTIONARY_TYPE_CODE like 'HinhThucThanhToan') htttCode on htttCode.DICTIONARY_ID = TT_HOADON_HINHTHUCTHANHTOAN.HINHTHUCTHANHTOAN_ID             where                             TT_HOADON_HINHTHUCTHANHTOAN.HOADON_ID = '33016'                       and                           TT_HOADON_HINHTHUCTHANHTOAN.BENHVIEN_ID = 'HLU01'                                     order by HOADON_HTTT_ID]
2019-12-12 10:29:47,054 [1] DEBUG - Statement Id: [DAO00119_TT_VIENPHI_GetList_BenhAnByHoadon] PreparedStatement : [select  a.*, a.MIENGIAM_GIATRI as GIATRIMIENGIAM_BH, a.BHTN_GIATRI as GIATRIMIENGIAM_BHTN,        a.HOIVIEN_GIATRI as GIATRIMIENGIAM_THANHVIEN, a.CONGTYCHITRA_GIATRI as GIATRIMIENGIAM_CTCT,        isnull(dv.TENDICHVU, dc.TENDUOCDAYDU) NOIDUNG, isnull(dv.MADICHVU, dc.MADUOC) MADICHVU, dv.NORESULT, dc.DONVITINH, ld.MALOAIDUOC, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ndv.MANHOMDICHVU        from        (        select * from (        select vp.*, c.NOITHUCHIEN_ID, c.NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_DVYEUCAU c on c.DVYEUCAU_ID = VP.REF_ID and vpp.REF_TABLE = 'TT_DVYEUCAU'        union        select vp.*, C.PHONGBANRATOA_ID as NOITHUCHIEN_ID, D.PHONGBAN_ID NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_NOITRU_TOATHUOC c on c.TOATHUOC_ID = VP.REF_ID and vpp.REF_TABLE = 'TT_NOITRU_TOATHUOC'        inner join TT_NOITRU_KHAMBENH D on D.KHAMBENH_ID = C.KHAMBENH_ID        union        select vp.*, C.PHONGBAN_ID as NOITHUCHIEN_ID, C.PHONGBAN_ID as NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_CLSKETQUA_VTYT c on c.CLSKETQUA_VTYT_ID = VP.REF_ID and vpp.REF_TABLE = 'TT_CLSKETQUA_VTYT'        union        select vp.*, ISNULL(D.PHONGBANTHUCHIEN_ID,d.PHONGBANCHIDINH_ID) as NOITHUCHIEN_ID, ISNULL(D.PHONGBANCHIDINH_ID,D.PHONGBANTHUCHIEN_ID) as NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_PHAUTHUAT_VTYT c on c.PHAUTHUAT_VTYT_ID = VP.REF_ID and vpp.REF_TABLE = 'TT_PHAUTHUAT_VTYT'        inner join TT_PHAUTHUAT D on D.PHAUTHUAT_ID = C.PHAUTHUAT_ID        union        select vp.*, c.PHONGBAN_ID as NOITHUCHIEN_ID, c.PHONGBAN_ID as NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_NGOAITRU_KHAMBENH_VTYT c on c.KHAMBENH_VTYT_ID = VP.REF_ID and vpp.REF_TABLE = 'TT_NGOAITRU_KHAMBENH_VTYT'        union        select vp.*, E.PHONGBAN_ID as NOITHUCHIEN_ID, E.PHONGBAN_ID as NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_NUT_XACNHANSUATAN_CHITIET XNC on XNC.XACNHANSUATANCHITIET_ID = vp.REF_ID and vpp.REF_TABLE = 'TT_NUT_XACNHANSUATAN_CHITIET'        inner join TT_NUT_CHIDINHKHAUPHAN_CHITIET D on D.CHIDINHKHAUPHANCHITIET_ID = XNC.CHIDINHKHAUPHANCHITIET_ID        inner join TM_NUT_KHAUPHANAN c on C.KHAUPHANAN_ID = D.KHAUPHANAN_ID        inner join TT_NUT_CHIDINHKHAUPHAN E on E.CHIDINHKHAUPHAN_ID = D.CHIDINHKHAUPHAN_ID        ) B        where B.HOADON_ID = '33016'        ) a        left join TM_DUOC dc on a.DUOC_ID = dc.DUOC_ID        left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID        left join TM_DICHVU dv on a.DICHVU_ID = dv.DICHVU_ID and a.REF_TABLE = 'TT_DVYEUCAU'        left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID]
2019-12-12 10:29:51,524 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2019-12-12 10:29:51,524 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,HLU01]]
2019-12-12 10:29:51,524 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2019-12-12 10:29:51,618 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2019-12-12 10:29:51,618 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,HLU01]]
2019-12-12 10:29:51,618 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2019-12-12 10:29:51,692 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1              and               BLCT.BIENLAICHITIET_ID = '2'                         order by BLCT.THOIGIANSUDUNG DESC]
2019-12-12 10:29:51,692 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,HLU01]]
2019-12-12 10:29:51,692 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2019-12-12 10:30:32,862 [1] DEBUG - Statement Id: [DAO00119_TT_VIENPHI_XoaBienLaiTamNgoaiTru] PreparedStatement : [delete from TT_HOADON_HINHTHUCTHANHTOAN        where HOADON_ID = '33016'          delete from TT_HOADON_CHITIET_NGOAITRU        where HOADON_ID = '33016'          delete from TT_HOADON        where HOADON_ID = '33016' and TRANGTHAI in ('CHUATHUTIEN', 'CHODUYETCONGNO', 'CHOXACNHANTTVIDT')          update TT_VIENPHI set HOADON_ID = null where HOADON_ID = '33016']
2019-12-12 10:31:35,245 [1] DEBUG - Statement Id: [DAO00119_TT_VIENPHI_XoaBienLaiTamNgoaiTru] PreparedStatement : [delete from TT_HOADON_HINHTHUCTHANHTOAN        where HOADON_ID = '33016'          delete from TT_HOADON_CHITIET_NGOAITRU        where HOADON_ID = '33016'          delete from TT_HOADON        where HOADON_ID = '33016' and TRANGTHAI in ('CHUATHUTIEN', 'CHODUYETCONGNO', 'CHOXACNHANTTVIDT')          update TT_VIENPHI set HOADON_ID = null where HOADON_ID = '33016']
--------------------------------------------------------------------------------
2019-12-12 10:42:28,288 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2019-12-12 10:42:28,629 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-12-12 10:42:28,896 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-12-12 10:42:29,352 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 10:42:29,669 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-12-12 10:42:47,955 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2019-12-12 10:42:47,983 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-12-12 10:42:49,877 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-12-12 10:42:49,977 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-12-12 10:42:50,844 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2019-12-12 10:42:51,052 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2019-12-12 10:42:51,162 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2019-12-12 10:42:51,296 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2019-12-12 10:42:51,395 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2019-12-12 10:42:51,470 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2019-12-12 10:42:51,555 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2019-12-12 10:42:51,640 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2019-12-12 10:42:51,725 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2019-12-12 10:42:52,254 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2019-12-12 10:42:52,288 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2019-12-12 10:42:52,370 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2019-12-12 10:42:52,405 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2019-12-12 10:42:53,710 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2019-12-12 10:42:53,748 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @NGUONDUOC_MACDINH varchar(5) = '0';        declare @TOAMUANGOAI int = 0;        select @NGUONDUOC_MACDINH = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'PHA_NGUONDUOC'        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + @NGUONDUOC_MACDINH as DUOC_KEY, 0 as PHAMVI_ID, @NGUONDUOC_MACDINH as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end        else        begin                  select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2019-12-12 10:42:56,160 [5] DEBUG - Statement Id: [DAO00320_GetList] PreparedStatement : [select M.*            from TM_MAU M            LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID            where            M.TAMNGUNG = '0'            and M.BENHVIEN_ID = 'HLU01'            order by M.TENMAU]
2019-12-12 10:42:56,237 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2019-12-12 10:42:56,274 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,        SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH        FROM TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID        WHERE TK.SOLUONG > 0        GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2019-12-12 10:42:56,371 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2019-12-12 10:42:56,411 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,        TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,        TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH        from TM_MAU M        JOIN        (        select        A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO        from        (        select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO        from TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'        where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0        ) A        )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2019-12-12 10:42:56,550 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2019-12-12 10:42:57,500 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 10:42:58,377 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2019-12-12 10:43:04,567 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2019-12-12 10:43:04,596 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2019-12-12 10:43:04,682 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 10:43:04,834 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 10:43:05,024 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2019-12-12 10:43:05,025 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-12-12 10:43:05,025 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-12-12 10:43:05,055 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2019-12-12 10:43:05,055 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-12-12 10:43:05,055 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-12-12 10:43:05,254 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 10:43:05,631 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 10:43:22,626 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 10:43:22,755 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2019-12-12 10:43:23,048 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2019-12-12 10:43:30,967 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM31'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 10:43:31,175 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'BIL18'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 10:43:33,127 [1] DEBUG - Statement Id: [DAO00119_GetDanhsachHTTT] PreparedStatement : [select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE = 'HinhThucThanhToan' and ENABLED = '1' and BENHVIEN_ID = 'HLU01']
2019-12-12 10:44:02,885 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM56'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 10:44:03,067 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM98'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 10:44:22,272 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] PreparedStatement : [select distinct A.*, B.SOHOADON AS HOADONLIENQUAN, bn.MAYTE            , CASE ISNULL(BN.NGAYSINH,'')            WHEN '' THEN CONVERT(VARCHAR(10), BN.NAMSINH)            ELSE CONVERT(VARCHAR(10), BN.NGAYSINH, 103)            END AS NAMSINH, ntba.SOBENHAN, bn.TENBENHNHAN, '' as TENBENHNHAN2,            ntba.TRANGTHAI as TRANGTHAINOITRU, tn.TRANGTHAI as TRANGTHAINGOAITRU, ntba.LOAIBENHAN                         from TT_HOADON A             LEFT JOIN  TT_HOADON B ON A.HOADONLIENQUAN_ID = B.HOADON_ID            left join TT_TIEPNHAN tn on tn.TIEPNHAN_ID = a.TIEPNHAN_ID            left join TT_BENHNHAN bn on bn.BENHNHAN_ID = A.BENHNHAN_ID                                 left join TT_HOADON_CHITIET_NOITRU VP on VP.HOADON_ID = A.HOADON_ID                  left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = a.BENHAN_ID                 where(                           (A.DATHANHTOAN = '1'                         and                           A.TRANGTHAI != 'DADUYETCONGNO'                         )                          and (A.HUYHOADON is null or A.HUYHOADON = '0')                          and (A.HOANTRA is null or A.HOANTRA = '0')                       or                           A.HUYHOADON = '1'                       or                           A.HOANTRA = '1'                       or                           A.DATHANHTOAN = 0                                             )                       and                         A.SOHOADON like '%' +  @param0  + '%'                       and                           convert(date,A.NGAYHOADON) between convert(date, '4/1/2019 12:00:00 AM') and convert(date, '12/12/2019 12:00:00 AM')                       and                           A.BENHVIEN_ID = 'HLU01'                       and                           (VP.REF_TABLE IS NULL OR VP.REF_TABLE not in ('TT_CSKH_GOI_DANGKY', 'TT_CSKH_THANHVIEN_CAPTHE', 'TT_DUOC_CHUNGTU_CHITIET'))                        and                           A.BENHAN_ID is not null                order by A.NGAYHOADON]
2019-12-12 10:44:22,272 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] Parameters: [@param0=[TUKHOA,BL.1905000021]]
2019-12-12 10:44:22,272 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_Search] Types: [@param0=[String, System.String]]
2019-12-12 10:44:24,671 [1] DEBUG - Statement Id: [DAO00019_ThongTinBenhNhanBenhAn] PreparedStatement : [select distinct C.SOBENHAN, C.BENHAN_ID, A.SOTIEPNHAN, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI, A.SOBHYT,        B.*        from TT_NOITRU_BENHAN C        inner join TT_TIEPNHAN A on C.TIEPNHAN_ID = A.TIEPNHAN_ID        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'        where                    C.SOBENHAN = '19.022516'                 and A.BENHVIEN_ID = 'HLU01']
2019-12-12 10:44:25,470 [1] DEBUG - Statement Id: [DAO00024_TT_HOADON_HINHTHUCTHANHTOAN_GetList] PreparedStatement : [select TT_HOADON_HINHTHUCTHANHTOAN.*, htttCode.DICTIONARY_CODE HINHTHUCTHANHTOAN_CODE            from TT_HOADON_HINHTHUCTHANHTOAN TT_HOADON_HINHTHUCTHANHTOAN            left join (select DICTIONARY_ID, DICTIONARY_CODE from LST_DICTIONARY where DICTIONARY_TYPE_CODE like 'HinhThucThanhToan') htttCode on htttCode.DICTIONARY_ID = TT_HOADON_HINHTHUCTHANHTOAN.HINHTHUCTHANHTOAN_ID             where                             TT_HOADON_HINHTHUCTHANHTOAN.HOADON_ID = '33016'                       and                           TT_HOADON_HINHTHUCTHANHTOAN.BENHVIEN_ID = 'HLU01'                                     order by HOADON_HTTT_ID]
2019-12-12 10:44:25,504 [1] DEBUG - Statement Id: [DAO00119_TT_VIENPHI_GetList_BenhAnByHoadon] PreparedStatement : [select  a.*, a.MIENGIAM_GIATRI as GIATRIMIENGIAM_BH, a.BHTN_GIATRI as GIATRIMIENGIAM_BHTN,        a.HOIVIEN_GIATRI as GIATRIMIENGIAM_THANHVIEN, a.CONGTYCHITRA_GIATRI as GIATRIMIENGIAM_CTCT,        isnull(dv.TENDICHVU, dc.TENDUOCDAYDU) NOIDUNG, isnull(dv.MADICHVU, dc.MADUOC) MADICHVU, dv.NORESULT, dc.DONVITINH, ld.MALOAIDUOC, dc.BHYT DUOC_BHYT, ld.LOAIVATTU_ID, ndv.MANHOMDICHVU        from        (        select * from (        select vp.*, c.NOITHUCHIEN_ID, c.NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_DVYEUCAU c on c.DVYEUCAU_ID = VP.REF_ID and vpp.REF_TABLE = 'TT_DVYEUCAU'        union        select vp.*, C.PHONGBANRATOA_ID as NOITHUCHIEN_ID, D.PHONGBAN_ID NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_NOITRU_TOATHUOC c on c.TOATHUOC_ID = VP.REF_ID and vpp.REF_TABLE = 'TT_NOITRU_TOATHUOC'        inner join TT_NOITRU_KHAMBENH D on D.KHAMBENH_ID = C.KHAMBENH_ID        union        select vp.*, C.PHONGBAN_ID as NOITHUCHIEN_ID, C.PHONGBAN_ID as NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_CLSKETQUA_VTYT c on c.CLSKETQUA_VTYT_ID = VP.REF_ID and vpp.REF_TABLE = 'TT_CLSKETQUA_VTYT'        union        select vp.*, ISNULL(D.PHONGBANTHUCHIEN_ID,d.PHONGBANCHIDINH_ID) as NOITHUCHIEN_ID, ISNULL(D.PHONGBANCHIDINH_ID,D.PHONGBANTHUCHIEN_ID) as NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_PHAUTHUAT_VTYT c on c.PHAUTHUAT_VTYT_ID = VP.REF_ID and vpp.REF_TABLE = 'TT_PHAUTHUAT_VTYT'        inner join TT_PHAUTHUAT D on D.PHAUTHUAT_ID = C.PHAUTHUAT_ID        union        select vp.*, c.PHONGBAN_ID as NOITHUCHIEN_ID, c.PHONGBAN_ID as NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_NGOAITRU_KHAMBENH_VTYT c on c.KHAMBENH_VTYT_ID = VP.REF_ID and vpp.REF_TABLE = 'TT_NGOAITRU_KHAMBENH_VTYT'        union        select vp.*, E.PHONGBAN_ID as NOITHUCHIEN_ID, E.PHONGBAN_ID as NOIYEUCAU_ID, vpp.DATHUCHIEN, vpp.TIEPNHAN_ID, vpp.BENHAN_ID        from TT_HOADON_CHITIET_NOITRU VP        left join TT_VIENPHI vpp on vpp.VIENPHI_ID = VP.VIENPHI_ID        inner join TT_NUT_XACNHANSUATAN_CHITIET XNC on XNC.XACNHANSUATANCHITIET_ID = vp.REF_ID and vpp.REF_TABLE = 'TT_NUT_XACNHANSUATAN_CHITIET'        inner join TT_NUT_CHIDINHKHAUPHAN_CHITIET D on D.CHIDINHKHAUPHANCHITIET_ID = XNC.CHIDINHKHAUPHANCHITIET_ID        inner join TM_NUT_KHAUPHANAN c on C.KHAUPHANAN_ID = D.KHAUPHANAN_ID        inner join TT_NUT_CHIDINHKHAUPHAN E on E.CHIDINHKHAUPHAN_ID = D.CHIDINHKHAUPHAN_ID        ) B        where B.HOADON_ID = '33016'        ) a        left join TM_DUOC dc on a.DUOC_ID = dc.DUOC_ID        left join TM_LOAIDUOC ld on dc.LOAIDUOC_ID = ld.LOAIDUOC_ID        left join TM_DICHVU dv on a.DICHVU_ID = dv.DICHVU_ID and a.REF_TABLE = 'TT_DVYEUCAU'        left join TM_NHOMDICHVU ndv on ndv.NHOMDICHVU_ID = dv.NHOMDICHVU_ID]
2019-12-12 10:44:27,401 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2019-12-12 10:44:27,401 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,HLU01]]
2019-12-12 10:44:27,401 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2019-12-12 10:44:27,445 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1              and               BLCT.BIENLAICHITIET_ID = '2'                         order by BLCT.THOIGIANSUDUNG DESC]
2019-12-12 10:44:27,445 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,HLU01]]
2019-12-12 10:44:27,445 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2019-12-12 10:44:42,983 [1] DEBUG - Statement Id: [DAO00119_TT_VIENPHI_XoaBienLaiTamNoiTru] PreparedStatement : [delete from TT_HOADON_HINHTHUCTHANHTOAN        where HOADON_ID = '33016'          delete from TT_HOADON_CHITIET_NOITRU        where HOADON_ID = '33016'          delete from TT_HOADON        where HOADON_ID = '33016' and TRANGTHAI in ('CHUATHUTIEN', 'CHODUYETCONGNO', 'CHOXACNHANTTVIDT')          update TT_VIENPHI set HOADON_ID = null where HOADON_ID = '33016']
2019-12-12 10:44:43,096 [1] DEBUG - Statement Id: [DAO00087_GetServiceParams] PreparedStatement : [select CODE, VALUE              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01']
2019-12-12 10:44:43,496 [1] DEBUG - Statement Id: [DAO00014_GetInPatientStatus] PreparedStatement : [select TRANGTHAI, isnull(KHOACHUYENDEN_ID, KHOAVAO_ID) as KHOAHIENTAI from TT_NOITRU_BENHAN        where        TIEPNHAN_ID = '10072'        and BENHVIEN_ID = 'HLU01'         and           BENHAN_ID = '2147']
2019-12-12 10:44:43,582 [1] DEBUG - Statement Id: [DAO00119_GetDanhsachHTTT] PreparedStatement : [select * from LST_DICTIONARY where DICTIONARY_TYPE_CODE = 'HinhThucThanhToan' and ENABLED = '1' and BENHVIEN_ID = 'HLU01']
2019-12-12 10:44:43,654 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2019-12-12 10:44:43,654 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,HLU01]]
2019-12-12 10:44:43,654 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2019-12-12 10:44:43,689 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1                          order by BLCT.THOIGIANSUDUNG DESC]
2019-12-12 10:44:43,689 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,HLU01]]
2019-12-12 10:44:43,689 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
2019-12-12 10:44:43,726 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] PreparedStatement : [select            BLCT.BIENLAICHITIET_ID            ,BL.BIENLAI_ID            ,BL.LOAIBIENLAI_ID            ,BL.LOAIBIENLAI            ,BL.NGAYPHATHANH            ,BL.THOIGIANPHATHANH            ,BL.KYHIEU            ,BL.SERIES            ,BL.KYHIEU + '/' + SERIES AS 'KYHIEU_SOQUYEN'            ,BL.MIN_NUMBER            ,BL.MAX_NUMBER            ,BLCT.START_NUMBER            ,BLCT.CURRENT_NUMBER            ,BLCT.HIEULUC            ,BLCT.NGUOISUDUNG_ID            from TT_BIENLAICHITIET BLCT            left join TT_BIENLAI BL on BL.BIENLAI_ID = BLCT.BIENLAI_ID            where            (bl.MAX_NUMBER > (select MAX(CURRENT_NUMBER) from TT_BIENLAICHITIET where BIENLAI_ID = BLCT.BIENLAI_ID) or BLCT.CURRENT_NUMBER is null)            and BLCT.HIEULUC = 1            and BLCT.NGUOISUDUNG_ID =   @param0             and BL.BENHVIEN_ID =  @param1              and               BLCT.BIENLAICHITIET_ID = '2'                         order by BLCT.THOIGIANSUDUNG DESC]
2019-12-12 10:44:43,726 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Parameters: [@param0=[NGUOISUDUNG_ID,1], @param1=[BENHVIEN_ID,HLU01]]
2019-12-12 10:44:43,726 [1] DEBUG - Statement Id: [DAO00021_GetListSoBienLai] Types: [@param0=[Int64, System.Int64], @param1=[String, System.String]]
--------------------------------------------------------------------------------
2019-12-12 15:05:51,838 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2019-12-12 15:05:52,217 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-12-12 15:05:52,257 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-12-12 15:05:53,124 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 15:05:53,706 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-12-12 15:06:01,493 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2019-12-12 15:06:01,590 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-12-12 15:06:05,820 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-12-12 15:06:05,947 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-12-12 15:06:07,253 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2019-12-12 15:06:07,865 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2019-12-12 15:06:07,950 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2019-12-12 15:06:08,046 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2019-12-12 15:06:08,127 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2019-12-12 15:06:08,239 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2019-12-12 15:06:08,325 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2019-12-12 15:06:08,429 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2019-12-12 15:06:08,502 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2019-12-12 15:06:09,131 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2019-12-12 15:06:09,167 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2019-12-12 15:06:09,246 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2019-12-12 15:06:10,292 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2019-12-12 15:06:12,525 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2019-12-12 15:06:12,561 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @NGUONDUOC_MACDINH varchar(5) = '0';        declare @TOAMUANGOAI int = 0;        select @NGUONDUOC_MACDINH = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'PHA_NGUONDUOC'        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + @NGUONDUOC_MACDINH as DUOC_KEY, 0 as PHAMVI_ID, @NGUONDUOC_MACDINH as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end        else        begin                  select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2019-12-12 15:06:15,331 [5] DEBUG - Statement Id: [DAO00320_GetList] PreparedStatement : [select M.*            from TM_MAU M            LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID            where            M.TAMNGUNG = '0'            and M.BENHVIEN_ID = 'HLU01'            order by M.TENMAU]
2019-12-12 15:06:15,446 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2019-12-12 15:06:15,483 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,        SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH        FROM TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID        WHERE TK.SOLUONG > 0        GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2019-12-12 15:06:15,562 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2019-12-12 15:06:15,595 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,        TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,        TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH        from TM_MAU M        JOIN        (        select        A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO        from        (        select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO        from TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'        where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0        ) A        )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2019-12-12 15:06:15,668 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2019-12-12 15:06:16,606 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 15:06:20,547 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2019-12-12 15:06:28,453 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2019-12-12 15:06:28,483 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2019-12-12 15:06:28,557 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 15:06:28,681 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 15:06:28,968 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2019-12-12 15:06:28,970 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-12-12 15:06:28,970 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-12-12 15:06:28,999 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2019-12-12 15:06:28,999 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-12-12 15:06:28,999 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-12-12 15:06:29,148 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 15:06:29,420 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 15:06:42,336 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 15:06:42,545 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2019-12-12 15:06:43,843 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2019-12-12 15:06:52,928 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'HSM05'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 15:06:55,171 [1] DEBUG - Statement Id: [DAO00307_GetContractWithDate] PreparedStatement : [SELECT HD.*, HD.SO_HD + ' - ' + CT.TENCONGTY AS HOPDONG, CT.TENCONGTY        FROM TT_KSK_HOPDONG HD JOIN TT_KSK_CONGTY CT ON CT.CONGTY_ID = HD.CONGTY_ID         where                 HD.BENHVIEN_ID = 'HLU01']
2019-12-12 15:06:55,973 [1] DEBUG - Statement Id: [DAO00307_GetContractWithDate] PreparedStatement : [SELECT HD.*, HD.SO_HD + ' - ' + CT.TENCONGTY AS HOPDONG, CT.TENCONGTY        FROM TT_KSK_HOPDONG HD JOIN TT_KSK_CONGTY CT ON CT.CONGTY_ID = HD.CONGTY_ID         where                 HD.BENHVIEN_ID = 'HLU01']
2019-12-12 15:07:29,634 [1] DEBUG - Statement Id: [DAO00307_GetContractPatient] PreparedStatement : [SELECT HD_BN.*, LST.DICTIONARY_NAME AS HONNHAN        , CASE WHEN HD_BN.GIOITINH = '1' THEN N'Nam' ELSE N'Nữ' END AS GENDER        , CASE WHEN HD_BN.HOPDONG_BENHNHAN_ID IN (SELECT HOPDONG_BENHNHAN_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU) THEN 1 ELSE 0 END BENHNHAN_DANGKYKSK_DICHVU        , GOI.TENGOI        FROM TT_KSK_HOPDONG_BENHNHAN HD_BN        INNER JOIN TT_KSK_HOPDONG HD ON HD.HOPDONG_ID = HD_BN.HOPDONG_ID        LEFT JOIN LST_DICTIONARY LST ON LST.DICTIONARY_ID = HD_BN.TINHTRANGHONNHAN_ID AND LST.DICTIONARY_TYPE_CODE = 'TinhTrangGiaDinh'        LEFT JOIN TM_CSKH_GOI GOI ON GOI.GOI_ID = HD_BN.GOI_ID        WHERE HD.HOPDONG_ID = 4           AND               HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-12 15:07:30,333 [1] DEBUG - Statement Id: [DAO00308_StatusContract] PreparedStatement : [SELECT * FROM TT_KSK_HOPDONG        WHERE HOPDONG_ID = 4]
2019-12-12 15:07:41,017 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhanDichVu] PreparedStatement : [SELECT distinct HD_BN.HOPDONG_ID, DV.TENDICHVU, ISNULL(NTH.TENPHONGBAN, PB.TENPHONGBAN) AS NOITHUCHIEN, NDV.TENNHOMDICHVU, ISNULL(GOI_CT.NOITHUCHIEN_ID, PB.PHONGBAN_ID) AS PHONGBAN_ID, DV.DICHVU_ID        , ISNULL(GOI_CT.DONGIATRONGGOI,0) AS DONGIA, ISNULL(GOI_CT.SOLAN,0) AS SOLUONG, GOI_CT.THANHTIENTRONGGOI AS THANHTIEN, BS.NHANVIEN_ID AS BACSICHIDINH_ID, BS.TENNHANVIEN AS TENBACSICHIDINH        , CASE WHEN DV.DICHVU_ID IN (SELECT DICHVU_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU WHERE HOPDONG_ID = '4' AND HOPDONG_BENHNHAN_ID = '313') THEN 1 ELSE 0 END AS DANGKY        FROM TT_KSK_HOPDONG HD                inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        INNER JOIN TM_CSKH_GOI_CHITIET GOI_CT ON GOI_CT.GOI_ID = HD_BN.GOI_ID        INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = GOI_CT.DICHVU_ID        LEFT JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        INNER JOIN TM_PHONGBAN_DICHVU PB_DV ON PB_DV.DICHVU_ID = DV.DICHVU_ID        LEFT JOIN TM_PHONGBAN PB ON PB.PHONGBAN_ID = PB_DV.PHONGBAN_ID        LEFT JOIN TM_PHONGBAN NTH ON NTH.PHONGBAN_ID = GOI_CT.NOITHUCHIEN_ID        LEFT JOIN TM_NHANVIEN BS ON BS.NHANVIEN_ID = GOI_CT.BACSICHIDINH_ID        WHERE GOI_CT.GOI_ID = 4 and HD_BN.HOPDONG_BENHNHAN_ID = 313        and PB_DV.PHONGBAN_ID =(select top 1 PHONGBAN_ID from TM_PHONGBAN_DICHVU where DICHVU_ID = DV.DICHVU_ID)]
2019-12-12 15:07:53,791 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhanDichVu] PreparedStatement : [SELECT distinct HD_BN.HOPDONG_ID, DV.TENDICHVU, ISNULL(NTH.TENPHONGBAN, PB.TENPHONGBAN) AS NOITHUCHIEN, NDV.TENNHOMDICHVU, ISNULL(GOI_CT.NOITHUCHIEN_ID, PB.PHONGBAN_ID) AS PHONGBAN_ID, DV.DICHVU_ID        , ISNULL(GOI_CT.DONGIATRONGGOI,0) AS DONGIA, ISNULL(GOI_CT.SOLAN,0) AS SOLUONG, GOI_CT.THANHTIENTRONGGOI AS THANHTIEN, BS.NHANVIEN_ID AS BACSICHIDINH_ID, BS.TENNHANVIEN AS TENBACSICHIDINH        , CASE WHEN DV.DICHVU_ID IN (SELECT DICHVU_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU WHERE HOPDONG_ID = '4' AND HOPDONG_BENHNHAN_ID = '314') THEN 1 ELSE 0 END AS DANGKY        FROM TT_KSK_HOPDONG HD                inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        INNER JOIN TM_CSKH_GOI_CHITIET GOI_CT ON GOI_CT.GOI_ID = HD_BN.GOI_ID        INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = GOI_CT.DICHVU_ID        LEFT JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        INNER JOIN TM_PHONGBAN_DICHVU PB_DV ON PB_DV.DICHVU_ID = DV.DICHVU_ID        LEFT JOIN TM_PHONGBAN PB ON PB.PHONGBAN_ID = PB_DV.PHONGBAN_ID        LEFT JOIN TM_PHONGBAN NTH ON NTH.PHONGBAN_ID = GOI_CT.NOITHUCHIEN_ID        LEFT JOIN TM_NHANVIEN BS ON BS.NHANVIEN_ID = GOI_CT.BACSICHIDINH_ID        WHERE GOI_CT.GOI_ID = 4 and HD_BN.HOPDONG_BENHNHAN_ID = 314        and PB_DV.PHONGBAN_ID =(select top 1 PHONGBAN_ID from TM_PHONGBAN_DICHVU where DICHVU_ID = DV.DICHVU_ID)]
2019-12-12 15:08:00,315 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhanDichVu] PreparedStatement : [SELECT distinct HD_BN.HOPDONG_ID, DV.TENDICHVU, ISNULL(NTH.TENPHONGBAN, PB.TENPHONGBAN) AS NOITHUCHIEN, NDV.TENNHOMDICHVU, ISNULL(GOI_CT.NOITHUCHIEN_ID, PB.PHONGBAN_ID) AS PHONGBAN_ID, DV.DICHVU_ID        , ISNULL(GOI_CT.DONGIATRONGGOI,0) AS DONGIA, ISNULL(GOI_CT.SOLAN,0) AS SOLUONG, GOI_CT.THANHTIENTRONGGOI AS THANHTIEN, BS.NHANVIEN_ID AS BACSICHIDINH_ID, BS.TENNHANVIEN AS TENBACSICHIDINH        , CASE WHEN DV.DICHVU_ID IN (SELECT DICHVU_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU WHERE HOPDONG_ID = '4' AND HOPDONG_BENHNHAN_ID = '315') THEN 1 ELSE 0 END AS DANGKY        FROM TT_KSK_HOPDONG HD                inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        INNER JOIN TM_CSKH_GOI_CHITIET GOI_CT ON GOI_CT.GOI_ID = HD_BN.GOI_ID        INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = GOI_CT.DICHVU_ID        LEFT JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        INNER JOIN TM_PHONGBAN_DICHVU PB_DV ON PB_DV.DICHVU_ID = DV.DICHVU_ID        LEFT JOIN TM_PHONGBAN PB ON PB.PHONGBAN_ID = PB_DV.PHONGBAN_ID        LEFT JOIN TM_PHONGBAN NTH ON NTH.PHONGBAN_ID = GOI_CT.NOITHUCHIEN_ID        LEFT JOIN TM_NHANVIEN BS ON BS.NHANVIEN_ID = GOI_CT.BACSICHIDINH_ID        WHERE GOI_CT.GOI_ID = 4 and HD_BN.HOPDONG_BENHNHAN_ID = 315        and PB_DV.PHONGBAN_ID =(select top 1 PHONGBAN_ID from TM_PHONGBAN_DICHVU where DICHVU_ID = DV.DICHVU_ID)]
2019-12-12 15:08:54,087 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhanDichVu] PreparedStatement : [SELECT distinct HD_BN.HOPDONG_ID, DV.TENDICHVU, ISNULL(NTH.TENPHONGBAN, PB.TENPHONGBAN) AS NOITHUCHIEN, NDV.TENNHOMDICHVU, ISNULL(GOI_CT.NOITHUCHIEN_ID, PB.PHONGBAN_ID) AS PHONGBAN_ID, DV.DICHVU_ID        , ISNULL(GOI_CT.DONGIATRONGGOI,0) AS DONGIA, ISNULL(GOI_CT.SOLAN,0) AS SOLUONG, GOI_CT.THANHTIENTRONGGOI AS THANHTIEN, BS.NHANVIEN_ID AS BACSICHIDINH_ID, BS.TENNHANVIEN AS TENBACSICHIDINH        , CASE WHEN DV.DICHVU_ID IN (SELECT DICHVU_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU WHERE HOPDONG_ID = '4' AND HOPDONG_BENHNHAN_ID = '315') THEN 1 ELSE 0 END AS DANGKY        FROM TT_KSK_HOPDONG HD                inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        INNER JOIN TM_CSKH_GOI_CHITIET GOI_CT ON GOI_CT.GOI_ID = HD_BN.GOI_ID        INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = GOI_CT.DICHVU_ID        LEFT JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        INNER JOIN TM_PHONGBAN_DICHVU PB_DV ON PB_DV.DICHVU_ID = DV.DICHVU_ID        LEFT JOIN TM_PHONGBAN PB ON PB.PHONGBAN_ID = PB_DV.PHONGBAN_ID        LEFT JOIN TM_PHONGBAN NTH ON NTH.PHONGBAN_ID = GOI_CT.NOITHUCHIEN_ID        LEFT JOIN TM_NHANVIEN BS ON BS.NHANVIEN_ID = GOI_CT.BACSICHIDINH_ID        WHERE GOI_CT.GOI_ID = 4 and HD_BN.HOPDONG_BENHNHAN_ID = 315        and PB_DV.PHONGBAN_ID =(select top 1 PHONGBAN_ID from TM_PHONGBAN_DICHVU where DICHVU_ID = DV.DICHVU_ID)]
2019-12-12 15:09:57,913 [1] DEBUG - Statement Id: [DAO00308_AddByJson] PreparedStatement : [declare @jsonData nvarchar(max) = N'[{"HOPDONG_ID":4,"TENDICHVU":"Khám Nội tổng hợp (D232)","NOITHUCHIEN":"P. khám nội TH- Khám SK (D.232)","TENNHOMDICHVU":"Khám bệnh","PHONGBAN_ID":64,"DICHVU_ID":5438,"DONGIA":188500.00,"SOLUONG":1,"THANHTIEN":188500.00,"BACSICHIDINH_ID":32,"TENBACSICHIDINH":"Lê Quốc Huy","DANGKY":0,"HOPDONG_BENHNHAN_ID":314,"NGAYCAPNHAT":"12/12/2019 3:08:43 PM","NGAYTAO":"12/12/2019 3:08:43 PM","NGUOITAO_ID":1,"NGUOICAPNHAT_ID":1,"BENHVIEN_ID":"HLU01"},{"HOPDONG_ID":4,"TENDICHVU":"Chụp Xquang ngực thẳng - số hóa 1 phim","NOITHUCHIEN":"Phòng chụp XQ KTS (D.101)","TENNHOMDICHVU":"Chụp Xquang số hóa","PHONGBAN_ID":79,"DICHVU_ID":4129,"DONGIA":263900.00,"SOLUONG":1,"THANHTIEN":263900.00,"BACSICHIDINH_ID":32,"TENBACSICHIDINH":"Lê Quốc Huy","DANGKY":0,"HOPDONG_BENHNHAN_ID":314,"NGAYCAPNHAT":"12/12/2019 3:08:43 PM","NGAYTAO":"12/12/2019 3:08:43 PM","NGUOITAO_ID":1,"NGUOICAPNHAT_ID":1,"BENHVIEN_ID":"HLU01"},{"HOPDONG_ID":4,"TENDICHVU":"Khám Mắt (E102)","NOITHUCHIEN":"Phòng khám mắt (E.102)","TENNHOMDICHVU":"Khám bệnh","PHONGBAN_ID":177,"DICHVU_ID":5435,"DONGIA":188500.00,"SOLUONG":1,"THANHTIEN":188500.00,"BACSICHIDINH_ID":32,"TENBACSICHIDINH":"Lê Quốc Huy","DANGKY":0,"HOPDONG_BENHNHAN_ID":314,"NGAYCAPNHAT":"12/12/2019 3:08:43 PM","NGAYTAO":"12/12/2019 3:08:43 PM","NGUOITAO_ID":1,"NGUOICAPNHAT_ID":1,"BENHVIEN_ID":"HLU01"},{"HOPDONG_ID":4,"TENDICHVU":"Siêu âm ổ bụng (gan mật, tụy, lách, thận, bàng quang)","NOITHUCHIEN":"Phòng siêu âm D.214","TENNHOMDICHVU":"Siêu âm","PHONGBAN_ID":91,"DICHVU_ID":4017,"DONGIA":188500.00,"SOLUONG":1,"THANHTIEN":188500.00,"BACSICHIDINH_ID":32,"TENBACSICHIDINH":"Lê Quốc Huy","DANGKY":0,"HOPDONG_BENHNHAN_ID":314,"NGAYCAPNHAT":"12/12/2019 3:08:43 PM","NGAYTAO":"12/12/2019 3:08:43 PM","NGUOITAO_ID":1,"NGUOICAPNHAT_ID":1,"BENHVIEN_ID":"HLU01"},{"HOPDONG_ID":4,"TENDICHVU":"Tổng phân tích tế bào máu ngoại vi (bằng máy đếm tổng trở)","NOITHUCHIEN":"Phòng XN Huyết học- Sinh hóa-Miễn dịch(D.230)","TENNHOMDICHVU":"Huyết học","PHONGBAN_ID":104,"DICHVU_ID":4523,"DONGIA":170600.00,"SOLUONG":1,"THANHTIEN":170600.00,"BACSICHIDINH_ID":32,"TENBACSICHIDINH":"Lê Quốc Huy","DANGKY":0,"HOPDONG_BENHNHAN_ID":314,"NGAYCAPNHAT":"12/12/2019 3:08:43 PM","NGAYTAO":"12/12/2019 3:08:43 PM","NGUOITAO_ID":1,"NGUOICAPNHAT_ID":1,"BENHVIEN_ID":"HLU01"}]';        INSERT INTO TT_KSK_HOPDONG_BENHNHAN_DICHVU        (        HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , DICHVU_ID        , PHONGBAN_ID        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYCAPNHAT        , NGUOICAPNHAT_ID)        SELECT        HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , DICHVU_ID        , PHONGBAN_ID        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYCAPNHAT        , NGUOICAPNHAT_ID        FROM OPENJSON(@jsonData)        WITH        (        HOPDONG_ID int        , HOPDONG_BENHNHAN_ID int        , DICHVU_ID int        , PHONGBAN_ID int        , BENHVIEN_ID varchar(10)        , NGAYTAO datetime        , NGUOITAO_ID int        , NGAYCAPNHAT datetime        , NGUOICAPNHAT_ID int)]
2019-12-12 15:10:04,294 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhanDichVu] PreparedStatement : [SELECT distinct HD_BN.HOPDONG_ID, DV.TENDICHVU, ISNULL(NTH.TENPHONGBAN, PB.TENPHONGBAN) AS NOITHUCHIEN, NDV.TENNHOMDICHVU, ISNULL(GOI_CT.NOITHUCHIEN_ID, PB.PHONGBAN_ID) AS PHONGBAN_ID, DV.DICHVU_ID        , ISNULL(GOI_CT.DONGIATRONGGOI,0) AS DONGIA, ISNULL(GOI_CT.SOLAN,0) AS SOLUONG, GOI_CT.THANHTIENTRONGGOI AS THANHTIEN, BS.NHANVIEN_ID AS BACSICHIDINH_ID, BS.TENNHANVIEN AS TENBACSICHIDINH        , CASE WHEN DV.DICHVU_ID IN (SELECT DICHVU_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU WHERE HOPDONG_ID = '4' AND HOPDONG_BENHNHAN_ID = '315') THEN 1 ELSE 0 END AS DANGKY        FROM TT_KSK_HOPDONG HD                inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        INNER JOIN TM_CSKH_GOI_CHITIET GOI_CT ON GOI_CT.GOI_ID = HD_BN.GOI_ID        INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = GOI_CT.DICHVU_ID        LEFT JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        INNER JOIN TM_PHONGBAN_DICHVU PB_DV ON PB_DV.DICHVU_ID = DV.DICHVU_ID        LEFT JOIN TM_PHONGBAN PB ON PB.PHONGBAN_ID = PB_DV.PHONGBAN_ID        LEFT JOIN TM_PHONGBAN NTH ON NTH.PHONGBAN_ID = GOI_CT.NOITHUCHIEN_ID        LEFT JOIN TM_NHANVIEN BS ON BS.NHANVIEN_ID = GOI_CT.BACSICHIDINH_ID        WHERE GOI_CT.GOI_ID = 4 and HD_BN.HOPDONG_BENHNHAN_ID = 315        and PB_DV.PHONGBAN_ID =(select top 1 PHONGBAN_ID from TM_PHONGBAN_DICHVU where DICHVU_ID = DV.DICHVU_ID)]
2019-12-12 15:10:08,156 [1] DEBUG - Statement Id: [DAO00308_AddByJson] PreparedStatement : [declare @jsonData nvarchar(max) = N'[{"HOPDONG_ID":4,"TENDICHVU":"Khám Nội tổng hợp (D232)","NOITHUCHIEN":"P. khám nội TH- Khám SK (D.232)","TENNHOMDICHVU":"Khám bệnh","PHONGBAN_ID":64,"DICHVU_ID":5438,"DONGIA":188500.00,"SOLUONG":1,"THANHTIEN":188500.00,"BACSICHIDINH_ID":32,"TENBACSICHIDINH":"Lê Quốc Huy","DANGKY":0,"HOPDONG_BENHNHAN_ID":315,"NGAYCAPNHAT":"12/12/2019 3:10:01 PM","NGAYTAO":"12/12/2019 3:10:01 PM","NGUOITAO_ID":1,"NGUOICAPNHAT_ID":1,"BENHVIEN_ID":"HLU01"},{"HOPDONG_ID":4,"TENDICHVU":"Chụp Xquang ngực thẳng - số hóa 1 phim","NOITHUCHIEN":"Phòng chụp XQ KTS (D.101)","TENNHOMDICHVU":"Chụp Xquang số hóa","PHONGBAN_ID":79,"DICHVU_ID":4129,"DONGIA":263900.00,"SOLUONG":1,"THANHTIEN":263900.00,"BACSICHIDINH_ID":32,"TENBACSICHIDINH":"Lê Quốc Huy","DANGKY":0,"HOPDONG_BENHNHAN_ID":315,"NGAYCAPNHAT":"12/12/2019 3:10:01 PM","NGAYTAO":"12/12/2019 3:10:01 PM","NGUOITAO_ID":1,"NGUOICAPNHAT_ID":1,"BENHVIEN_ID":"HLU01"},{"HOPDONG_ID":4,"TENDICHVU":"Khám Mắt (E102)","NOITHUCHIEN":"Phòng khám mắt (E.102)","TENNHOMDICHVU":"Khám bệnh","PHONGBAN_ID":177,"DICHVU_ID":5435,"DONGIA":188500.00,"SOLUONG":1,"THANHTIEN":188500.00,"BACSICHIDINH_ID":32,"TENBACSICHIDINH":"Lê Quốc Huy","DANGKY":0,"HOPDONG_BENHNHAN_ID":315,"NGAYCAPNHAT":"12/12/2019 3:10:01 PM","NGAYTAO":"12/12/2019 3:10:01 PM","NGUOITAO_ID":1,"NGUOICAPNHAT_ID":1,"BENHVIEN_ID":"HLU01"},{"HOPDONG_ID":4,"TENDICHVU":"Siêu âm ổ bụng (gan mật, tụy, lách, thận, bàng quang)","NOITHUCHIEN":"Phòng siêu âm D.214","TENNHOMDICHVU":"Siêu âm","PHONGBAN_ID":91,"DICHVU_ID":4017,"DONGIA":188500.00,"SOLUONG":1,"THANHTIEN":188500.00,"BACSICHIDINH_ID":32,"TENBACSICHIDINH":"Lê Quốc Huy","DANGKY":0,"HOPDONG_BENHNHAN_ID":315,"NGAYCAPNHAT":"12/12/2019 3:10:01 PM","NGAYTAO":"12/12/2019 3:10:01 PM","NGUOITAO_ID":1,"NGUOICAPNHAT_ID":1,"BENHVIEN_ID":"HLU01"},{"HOPDONG_ID":4,"TENDICHVU":"Tổng phân tích tế bào máu ngoại vi (bằng máy đếm tổng trở)","NOITHUCHIEN":"Phòng XN Huyết học- Sinh hóa-Miễn dịch(D.230)","TENNHOMDICHVU":"Huyết học","PHONGBAN_ID":104,"DICHVU_ID":4523,"DONGIA":170600.00,"SOLUONG":1,"THANHTIEN":170600.00,"BACSICHIDINH_ID":32,"TENBACSICHIDINH":"Lê Quốc Huy","DANGKY":0,"HOPDONG_BENHNHAN_ID":315,"NGAYCAPNHAT":"12/12/2019 3:10:01 PM","NGAYTAO":"12/12/2019 3:10:01 PM","NGUOITAO_ID":1,"NGUOICAPNHAT_ID":1,"BENHVIEN_ID":"HLU01"}]';        INSERT INTO TT_KSK_HOPDONG_BENHNHAN_DICHVU        (        HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , DICHVU_ID        , PHONGBAN_ID        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYCAPNHAT        , NGUOICAPNHAT_ID)        SELECT        HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , DICHVU_ID        , PHONGBAN_ID        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYCAPNHAT        , NGUOICAPNHAT_ID        FROM OPENJSON(@jsonData)        WITH        (        HOPDONG_ID int        , HOPDONG_BENHNHAN_ID int        , DICHVU_ID int        , PHONGBAN_ID int        , BENHVIEN_ID varchar(10)        , NGAYTAO datetime        , NGUOITAO_ID int        , NGAYCAPNHAT datetime        , NGUOICAPNHAT_ID int)]
2019-12-12 15:10:11,361 [1] DEBUG - Statement Id: [DAO00307_GetContractPatient] PreparedStatement : [SELECT HD_BN.*, LST.DICTIONARY_NAME AS HONNHAN        , CASE WHEN HD_BN.GIOITINH = '1' THEN N'Nam' ELSE N'Nữ' END AS GENDER        , CASE WHEN HD_BN.HOPDONG_BENHNHAN_ID IN (SELECT HOPDONG_BENHNHAN_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU) THEN 1 ELSE 0 END BENHNHAN_DANGKYKSK_DICHVU        , GOI.TENGOI        FROM TT_KSK_HOPDONG_BENHNHAN HD_BN        INNER JOIN TT_KSK_HOPDONG HD ON HD.HOPDONG_ID = HD_BN.HOPDONG_ID        LEFT JOIN LST_DICTIONARY LST ON LST.DICTIONARY_ID = HD_BN.TINHTRANGHONNHAN_ID AND LST.DICTIONARY_TYPE_CODE = 'TinhTrangGiaDinh'        LEFT JOIN TM_CSKH_GOI GOI ON GOI.GOI_ID = HD_BN.GOI_ID        WHERE HD.HOPDONG_ID = 4           AND               HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-12 15:10:11,453 [1] DEBUG - Statement Id: [DAO00308_StatusContract] PreparedStatement : [SELECT * FROM TT_KSK_HOPDONG        WHERE HOPDONG_ID = 4]
2019-12-12 15:10:11,545 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhanDichVu] PreparedStatement : [SELECT distinct HD_BN.HOPDONG_ID, DV.TENDICHVU, ISNULL(NTH.TENPHONGBAN, PB.TENPHONGBAN) AS NOITHUCHIEN, NDV.TENNHOMDICHVU, ISNULL(GOI_CT.NOITHUCHIEN_ID, PB.PHONGBAN_ID) AS PHONGBAN_ID, DV.DICHVU_ID        , ISNULL(GOI_CT.DONGIATRONGGOI,0) AS DONGIA, ISNULL(GOI_CT.SOLAN,0) AS SOLUONG, GOI_CT.THANHTIENTRONGGOI AS THANHTIEN, BS.NHANVIEN_ID AS BACSICHIDINH_ID, BS.TENNHANVIEN AS TENBACSICHIDINH        , CASE WHEN DV.DICHVU_ID IN (SELECT DICHVU_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU WHERE HOPDONG_ID = '4' AND HOPDONG_BENHNHAN_ID = '315') THEN 1 ELSE 0 END AS DANGKY        FROM TT_KSK_HOPDONG HD                inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        INNER JOIN TM_CSKH_GOI_CHITIET GOI_CT ON GOI_CT.GOI_ID = HD_BN.GOI_ID        INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = GOI_CT.DICHVU_ID        LEFT JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        INNER JOIN TM_PHONGBAN_DICHVU PB_DV ON PB_DV.DICHVU_ID = DV.DICHVU_ID        LEFT JOIN TM_PHONGBAN PB ON PB.PHONGBAN_ID = PB_DV.PHONGBAN_ID        LEFT JOIN TM_PHONGBAN NTH ON NTH.PHONGBAN_ID = GOI_CT.NOITHUCHIEN_ID        LEFT JOIN TM_NHANVIEN BS ON BS.NHANVIEN_ID = GOI_CT.BACSICHIDINH_ID        WHERE GOI_CT.GOI_ID = 4 and HD_BN.HOPDONG_BENHNHAN_ID = 315        and PB_DV.PHONGBAN_ID =(select top 1 PHONGBAN_ID from TM_PHONGBAN_DICHVU where DICHVU_ID = DV.DICHVU_ID)]
2019-12-12 15:10:14,965 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhanDichVu] PreparedStatement : [SELECT distinct HD_BN.HOPDONG_ID, DV.TENDICHVU, ISNULL(NTH.TENPHONGBAN, PB.TENPHONGBAN) AS NOITHUCHIEN, NDV.TENNHOMDICHVU, ISNULL(GOI_CT.NOITHUCHIEN_ID, PB.PHONGBAN_ID) AS PHONGBAN_ID, DV.DICHVU_ID        , ISNULL(GOI_CT.DONGIATRONGGOI,0) AS DONGIA, ISNULL(GOI_CT.SOLAN,0) AS SOLUONG, GOI_CT.THANHTIENTRONGGOI AS THANHTIEN, BS.NHANVIEN_ID AS BACSICHIDINH_ID, BS.TENNHANVIEN AS TENBACSICHIDINH        , CASE WHEN DV.DICHVU_ID IN (SELECT DICHVU_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU WHERE HOPDONG_ID = '4' AND HOPDONG_BENHNHAN_ID = '313') THEN 1 ELSE 0 END AS DANGKY        FROM TT_KSK_HOPDONG HD                inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        INNER JOIN TM_CSKH_GOI_CHITIET GOI_CT ON GOI_CT.GOI_ID = HD_BN.GOI_ID        INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = GOI_CT.DICHVU_ID        LEFT JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        INNER JOIN TM_PHONGBAN_DICHVU PB_DV ON PB_DV.DICHVU_ID = DV.DICHVU_ID        LEFT JOIN TM_PHONGBAN PB ON PB.PHONGBAN_ID = PB_DV.PHONGBAN_ID        LEFT JOIN TM_PHONGBAN NTH ON NTH.PHONGBAN_ID = GOI_CT.NOITHUCHIEN_ID        LEFT JOIN TM_NHANVIEN BS ON BS.NHANVIEN_ID = GOI_CT.BACSICHIDINH_ID        WHERE GOI_CT.GOI_ID = 4 and HD_BN.HOPDONG_BENHNHAN_ID = 313        and PB_DV.PHONGBAN_ID =(select top 1 PHONGBAN_ID from TM_PHONGBAN_DICHVU where DICHVU_ID = DV.DICHVU_ID)]
2019-12-12 15:10:16,463 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhanDichVu] PreparedStatement : [SELECT distinct HD_BN.HOPDONG_ID, DV.TENDICHVU, ISNULL(NTH.TENPHONGBAN, PB.TENPHONGBAN) AS NOITHUCHIEN, NDV.TENNHOMDICHVU, ISNULL(GOI_CT.NOITHUCHIEN_ID, PB.PHONGBAN_ID) AS PHONGBAN_ID, DV.DICHVU_ID        , ISNULL(GOI_CT.DONGIATRONGGOI,0) AS DONGIA, ISNULL(GOI_CT.SOLAN,0) AS SOLUONG, GOI_CT.THANHTIENTRONGGOI AS THANHTIEN, BS.NHANVIEN_ID AS BACSICHIDINH_ID, BS.TENNHANVIEN AS TENBACSICHIDINH        , CASE WHEN DV.DICHVU_ID IN (SELECT DICHVU_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU WHERE HOPDONG_ID = '4' AND HOPDONG_BENHNHAN_ID = '314') THEN 1 ELSE 0 END AS DANGKY        FROM TT_KSK_HOPDONG HD                inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        INNER JOIN TM_CSKH_GOI_CHITIET GOI_CT ON GOI_CT.GOI_ID = HD_BN.GOI_ID        INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = GOI_CT.DICHVU_ID        LEFT JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        INNER JOIN TM_PHONGBAN_DICHVU PB_DV ON PB_DV.DICHVU_ID = DV.DICHVU_ID        LEFT JOIN TM_PHONGBAN PB ON PB.PHONGBAN_ID = PB_DV.PHONGBAN_ID        LEFT JOIN TM_PHONGBAN NTH ON NTH.PHONGBAN_ID = GOI_CT.NOITHUCHIEN_ID        LEFT JOIN TM_NHANVIEN BS ON BS.NHANVIEN_ID = GOI_CT.BACSICHIDINH_ID        WHERE GOI_CT.GOI_ID = 4 and HD_BN.HOPDONG_BENHNHAN_ID = 314        and PB_DV.PHONGBAN_ID =(select top 1 PHONGBAN_ID from TM_PHONGBAN_DICHVU where DICHVU_ID = DV.DICHVU_ID)]
2019-12-12 15:10:17,487 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhanDichVu] PreparedStatement : [SELECT distinct HD_BN.HOPDONG_ID, DV.TENDICHVU, ISNULL(NTH.TENPHONGBAN, PB.TENPHONGBAN) AS NOITHUCHIEN, NDV.TENNHOMDICHVU, ISNULL(GOI_CT.NOITHUCHIEN_ID, PB.PHONGBAN_ID) AS PHONGBAN_ID, DV.DICHVU_ID        , ISNULL(GOI_CT.DONGIATRONGGOI,0) AS DONGIA, ISNULL(GOI_CT.SOLAN,0) AS SOLUONG, GOI_CT.THANHTIENTRONGGOI AS THANHTIEN, BS.NHANVIEN_ID AS BACSICHIDINH_ID, BS.TENNHANVIEN AS TENBACSICHIDINH        , CASE WHEN DV.DICHVU_ID IN (SELECT DICHVU_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU WHERE HOPDONG_ID = '4' AND HOPDONG_BENHNHAN_ID = '315') THEN 1 ELSE 0 END AS DANGKY        FROM TT_KSK_HOPDONG HD                inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        INNER JOIN TM_CSKH_GOI_CHITIET GOI_CT ON GOI_CT.GOI_ID = HD_BN.GOI_ID        INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = GOI_CT.DICHVU_ID        LEFT JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        INNER JOIN TM_PHONGBAN_DICHVU PB_DV ON PB_DV.DICHVU_ID = DV.DICHVU_ID        LEFT JOIN TM_PHONGBAN PB ON PB.PHONGBAN_ID = PB_DV.PHONGBAN_ID        LEFT JOIN TM_PHONGBAN NTH ON NTH.PHONGBAN_ID = GOI_CT.NOITHUCHIEN_ID        LEFT JOIN TM_NHANVIEN BS ON BS.NHANVIEN_ID = GOI_CT.BACSICHIDINH_ID        WHERE GOI_CT.GOI_ID = 4 and HD_BN.HOPDONG_BENHNHAN_ID = 315        and PB_DV.PHONGBAN_ID =(select top 1 PHONGBAN_ID from TM_PHONGBAN_DICHVU where DICHVU_ID = DV.DICHVU_ID)]
2019-12-12 15:10:18,135 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhanDichVu] PreparedStatement : [SELECT distinct HD_BN.HOPDONG_ID, DV.TENDICHVU, ISNULL(NTH.TENPHONGBAN, PB.TENPHONGBAN) AS NOITHUCHIEN, NDV.TENNHOMDICHVU, ISNULL(GOI_CT.NOITHUCHIEN_ID, PB.PHONGBAN_ID) AS PHONGBAN_ID, DV.DICHVU_ID        , ISNULL(GOI_CT.DONGIATRONGGOI,0) AS DONGIA, ISNULL(GOI_CT.SOLAN,0) AS SOLUONG, GOI_CT.THANHTIENTRONGGOI AS THANHTIEN, BS.NHANVIEN_ID AS BACSICHIDINH_ID, BS.TENNHANVIEN AS TENBACSICHIDINH        , CASE WHEN DV.DICHVU_ID IN (SELECT DICHVU_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU WHERE HOPDONG_ID = '4' AND HOPDONG_BENHNHAN_ID = '317') THEN 1 ELSE 0 END AS DANGKY        FROM TT_KSK_HOPDONG HD                inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        INNER JOIN TM_CSKH_GOI_CHITIET GOI_CT ON GOI_CT.GOI_ID = HD_BN.GOI_ID        INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = GOI_CT.DICHVU_ID        LEFT JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        INNER JOIN TM_PHONGBAN_DICHVU PB_DV ON PB_DV.DICHVU_ID = DV.DICHVU_ID        LEFT JOIN TM_PHONGBAN PB ON PB.PHONGBAN_ID = PB_DV.PHONGBAN_ID        LEFT JOIN TM_PHONGBAN NTH ON NTH.PHONGBAN_ID = GOI_CT.NOITHUCHIEN_ID        LEFT JOIN TM_NHANVIEN BS ON BS.NHANVIEN_ID = GOI_CT.BACSICHIDINH_ID        WHERE GOI_CT.GOI_ID = 4 and HD_BN.HOPDONG_BENHNHAN_ID = 317        and PB_DV.PHONGBAN_ID =(select top 1 PHONGBAN_ID from TM_PHONGBAN_DICHVU where DICHVU_ID = DV.DICHVU_ID)]
2019-12-12 15:10:37,091 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhanDichVu] PreparedStatement : [SELECT distinct HD_BN.HOPDONG_ID, DV.TENDICHVU, ISNULL(NTH.TENPHONGBAN, PB.TENPHONGBAN) AS NOITHUCHIEN, NDV.TENNHOMDICHVU, ISNULL(GOI_CT.NOITHUCHIEN_ID, PB.PHONGBAN_ID) AS PHONGBAN_ID, DV.DICHVU_ID        , ISNULL(GOI_CT.DONGIATRONGGOI,0) AS DONGIA, ISNULL(GOI_CT.SOLAN,0) AS SOLUONG, GOI_CT.THANHTIENTRONGGOI AS THANHTIEN, BS.NHANVIEN_ID AS BACSICHIDINH_ID, BS.TENNHANVIEN AS TENBACSICHIDINH        , CASE WHEN DV.DICHVU_ID IN (SELECT DICHVU_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU WHERE HOPDONG_ID = '4' AND HOPDONG_BENHNHAN_ID = '315') THEN 1 ELSE 0 END AS DANGKY        FROM TT_KSK_HOPDONG HD                inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        INNER JOIN TM_CSKH_GOI_CHITIET GOI_CT ON GOI_CT.GOI_ID = HD_BN.GOI_ID        INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = GOI_CT.DICHVU_ID        LEFT JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        INNER JOIN TM_PHONGBAN_DICHVU PB_DV ON PB_DV.DICHVU_ID = DV.DICHVU_ID        LEFT JOIN TM_PHONGBAN PB ON PB.PHONGBAN_ID = PB_DV.PHONGBAN_ID        LEFT JOIN TM_PHONGBAN NTH ON NTH.PHONGBAN_ID = GOI_CT.NOITHUCHIEN_ID        LEFT JOIN TM_NHANVIEN BS ON BS.NHANVIEN_ID = GOI_CT.BACSICHIDINH_ID        WHERE GOI_CT.GOI_ID = 4 and HD_BN.HOPDONG_BENHNHAN_ID = 315        and PB_DV.PHONGBAN_ID =(select top 1 PHONGBAN_ID from TM_PHONGBAN_DICHVU where DICHVU_ID = DV.DICHVU_ID)]
2019-12-12 15:10:38,249 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhanDichVu] PreparedStatement : [SELECT distinct HD_BN.HOPDONG_ID, DV.TENDICHVU, ISNULL(NTH.TENPHONGBAN, PB.TENPHONGBAN) AS NOITHUCHIEN, NDV.TENNHOMDICHVU, ISNULL(GOI_CT.NOITHUCHIEN_ID, PB.PHONGBAN_ID) AS PHONGBAN_ID, DV.DICHVU_ID        , ISNULL(GOI_CT.DONGIATRONGGOI,0) AS DONGIA, ISNULL(GOI_CT.SOLAN,0) AS SOLUONG, GOI_CT.THANHTIENTRONGGOI AS THANHTIEN, BS.NHANVIEN_ID AS BACSICHIDINH_ID, BS.TENNHANVIEN AS TENBACSICHIDINH        , CASE WHEN DV.DICHVU_ID IN (SELECT DICHVU_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU WHERE HOPDONG_ID = '4' AND HOPDONG_BENHNHAN_ID = '316') THEN 1 ELSE 0 END AS DANGKY        FROM TT_KSK_HOPDONG HD                inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        INNER JOIN TM_CSKH_GOI_CHITIET GOI_CT ON GOI_CT.GOI_ID = HD_BN.GOI_ID        INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = GOI_CT.DICHVU_ID        LEFT JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        INNER JOIN TM_PHONGBAN_DICHVU PB_DV ON PB_DV.DICHVU_ID = DV.DICHVU_ID        LEFT JOIN TM_PHONGBAN PB ON PB.PHONGBAN_ID = PB_DV.PHONGBAN_ID        LEFT JOIN TM_PHONGBAN NTH ON NTH.PHONGBAN_ID = GOI_CT.NOITHUCHIEN_ID        LEFT JOIN TM_NHANVIEN BS ON BS.NHANVIEN_ID = GOI_CT.BACSICHIDINH_ID        WHERE GOI_CT.GOI_ID = 4 and HD_BN.HOPDONG_BENHNHAN_ID = 316        and PB_DV.PHONGBAN_ID =(select top 1 PHONGBAN_ID from TM_PHONGBAN_DICHVU where DICHVU_ID = DV.DICHVU_ID)]
2019-12-12 15:10:38,883 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhanDichVu] PreparedStatement : [SELECT distinct HD_BN.HOPDONG_ID, DV.TENDICHVU, ISNULL(NTH.TENPHONGBAN, PB.TENPHONGBAN) AS NOITHUCHIEN, NDV.TENNHOMDICHVU, ISNULL(GOI_CT.NOITHUCHIEN_ID, PB.PHONGBAN_ID) AS PHONGBAN_ID, DV.DICHVU_ID        , ISNULL(GOI_CT.DONGIATRONGGOI,0) AS DONGIA, ISNULL(GOI_CT.SOLAN,0) AS SOLUONG, GOI_CT.THANHTIENTRONGGOI AS THANHTIEN, BS.NHANVIEN_ID AS BACSICHIDINH_ID, BS.TENNHANVIEN AS TENBACSICHIDINH        , CASE WHEN DV.DICHVU_ID IN (SELECT DICHVU_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU WHERE HOPDONG_ID = '4' AND HOPDONG_BENHNHAN_ID = '315') THEN 1 ELSE 0 END AS DANGKY        FROM TT_KSK_HOPDONG HD                inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        INNER JOIN TM_CSKH_GOI_CHITIET GOI_CT ON GOI_CT.GOI_ID = HD_BN.GOI_ID        INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = GOI_CT.DICHVU_ID        LEFT JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        INNER JOIN TM_PHONGBAN_DICHVU PB_DV ON PB_DV.DICHVU_ID = DV.DICHVU_ID        LEFT JOIN TM_PHONGBAN PB ON PB.PHONGBAN_ID = PB_DV.PHONGBAN_ID        LEFT JOIN TM_PHONGBAN NTH ON NTH.PHONGBAN_ID = GOI_CT.NOITHUCHIEN_ID        LEFT JOIN TM_NHANVIEN BS ON BS.NHANVIEN_ID = GOI_CT.BACSICHIDINH_ID        WHERE GOI_CT.GOI_ID = 4 and HD_BN.HOPDONG_BENHNHAN_ID = 315        and PB_DV.PHONGBAN_ID =(select top 1 PHONGBAN_ID from TM_PHONGBAN_DICHVU where DICHVU_ID = DV.DICHVU_ID)]
2019-12-12 15:10:39,925 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhanDichVu] PreparedStatement : [SELECT distinct HD_BN.HOPDONG_ID, DV.TENDICHVU, ISNULL(NTH.TENPHONGBAN, PB.TENPHONGBAN) AS NOITHUCHIEN, NDV.TENNHOMDICHVU, ISNULL(GOI_CT.NOITHUCHIEN_ID, PB.PHONGBAN_ID) AS PHONGBAN_ID, DV.DICHVU_ID        , ISNULL(GOI_CT.DONGIATRONGGOI,0) AS DONGIA, ISNULL(GOI_CT.SOLAN,0) AS SOLUONG, GOI_CT.THANHTIENTRONGGOI AS THANHTIEN, BS.NHANVIEN_ID AS BACSICHIDINH_ID, BS.TENNHANVIEN AS TENBACSICHIDINH        , CASE WHEN DV.DICHVU_ID IN (SELECT DICHVU_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU WHERE HOPDONG_ID = '4' AND HOPDONG_BENHNHAN_ID = '316') THEN 1 ELSE 0 END AS DANGKY        FROM TT_KSK_HOPDONG HD                inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        INNER JOIN TM_CSKH_GOI_CHITIET GOI_CT ON GOI_CT.GOI_ID = HD_BN.GOI_ID        INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = GOI_CT.DICHVU_ID        LEFT JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        INNER JOIN TM_PHONGBAN_DICHVU PB_DV ON PB_DV.DICHVU_ID = DV.DICHVU_ID        LEFT JOIN TM_PHONGBAN PB ON PB.PHONGBAN_ID = PB_DV.PHONGBAN_ID        LEFT JOIN TM_PHONGBAN NTH ON NTH.PHONGBAN_ID = GOI_CT.NOITHUCHIEN_ID        LEFT JOIN TM_NHANVIEN BS ON BS.NHANVIEN_ID = GOI_CT.BACSICHIDINH_ID        WHERE GOI_CT.GOI_ID = 4 and HD_BN.HOPDONG_BENHNHAN_ID = 316        and PB_DV.PHONGBAN_ID =(select top 1 PHONGBAN_ID from TM_PHONGBAN_DICHVU where DICHVU_ID = DV.DICHVU_ID)]
2019-12-12 15:10:40,962 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhanDichVu] PreparedStatement : [SELECT distinct HD_BN.HOPDONG_ID, DV.TENDICHVU, ISNULL(NTH.TENPHONGBAN, PB.TENPHONGBAN) AS NOITHUCHIEN, NDV.TENNHOMDICHVU, ISNULL(GOI_CT.NOITHUCHIEN_ID, PB.PHONGBAN_ID) AS PHONGBAN_ID, DV.DICHVU_ID        , ISNULL(GOI_CT.DONGIATRONGGOI,0) AS DONGIA, ISNULL(GOI_CT.SOLAN,0) AS SOLUONG, GOI_CT.THANHTIENTRONGGOI AS THANHTIEN, BS.NHANVIEN_ID AS BACSICHIDINH_ID, BS.TENNHANVIEN AS TENBACSICHIDINH        , CASE WHEN DV.DICHVU_ID IN (SELECT DICHVU_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU WHERE HOPDONG_ID = '4' AND HOPDONG_BENHNHAN_ID = '315') THEN 1 ELSE 0 END AS DANGKY        FROM TT_KSK_HOPDONG HD                inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        INNER JOIN TM_CSKH_GOI_CHITIET GOI_CT ON GOI_CT.GOI_ID = HD_BN.GOI_ID        INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = GOI_CT.DICHVU_ID        LEFT JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        INNER JOIN TM_PHONGBAN_DICHVU PB_DV ON PB_DV.DICHVU_ID = DV.DICHVU_ID        LEFT JOIN TM_PHONGBAN PB ON PB.PHONGBAN_ID = PB_DV.PHONGBAN_ID        LEFT JOIN TM_PHONGBAN NTH ON NTH.PHONGBAN_ID = GOI_CT.NOITHUCHIEN_ID        LEFT JOIN TM_NHANVIEN BS ON BS.NHANVIEN_ID = GOI_CT.BACSICHIDINH_ID        WHERE GOI_CT.GOI_ID = 4 and HD_BN.HOPDONG_BENHNHAN_ID = 315        and PB_DV.PHONGBAN_ID =(select top 1 PHONGBAN_ID from TM_PHONGBAN_DICHVU where DICHVU_ID = DV.DICHVU_ID)]
2019-12-12 15:10:41,613 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhanDichVu] PreparedStatement : [SELECT distinct HD_BN.HOPDONG_ID, DV.TENDICHVU, ISNULL(NTH.TENPHONGBAN, PB.TENPHONGBAN) AS NOITHUCHIEN, NDV.TENNHOMDICHVU, ISNULL(GOI_CT.NOITHUCHIEN_ID, PB.PHONGBAN_ID) AS PHONGBAN_ID, DV.DICHVU_ID        , ISNULL(GOI_CT.DONGIATRONGGOI,0) AS DONGIA, ISNULL(GOI_CT.SOLAN,0) AS SOLUONG, GOI_CT.THANHTIENTRONGGOI AS THANHTIEN, BS.NHANVIEN_ID AS BACSICHIDINH_ID, BS.TENNHANVIEN AS TENBACSICHIDINH        , CASE WHEN DV.DICHVU_ID IN (SELECT DICHVU_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU WHERE HOPDONG_ID = '4' AND HOPDONG_BENHNHAN_ID = '314') THEN 1 ELSE 0 END AS DANGKY        FROM TT_KSK_HOPDONG HD                inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        INNER JOIN TM_CSKH_GOI_CHITIET GOI_CT ON GOI_CT.GOI_ID = HD_BN.GOI_ID        INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = GOI_CT.DICHVU_ID        LEFT JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        INNER JOIN TM_PHONGBAN_DICHVU PB_DV ON PB_DV.DICHVU_ID = DV.DICHVU_ID        LEFT JOIN TM_PHONGBAN PB ON PB.PHONGBAN_ID = PB_DV.PHONGBAN_ID        LEFT JOIN TM_PHONGBAN NTH ON NTH.PHONGBAN_ID = GOI_CT.NOITHUCHIEN_ID        LEFT JOIN TM_NHANVIEN BS ON BS.NHANVIEN_ID = GOI_CT.BACSICHIDINH_ID        WHERE GOI_CT.GOI_ID = 4 and HD_BN.HOPDONG_BENHNHAN_ID = 314        and PB_DV.PHONGBAN_ID =(select top 1 PHONGBAN_ID from TM_PHONGBAN_DICHVU where DICHVU_ID = DV.DICHVU_ID)]
2019-12-12 15:11:11,689 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhanDichVu] PreparedStatement : [SELECT distinct HD_BN.HOPDONG_ID, DV.TENDICHVU, ISNULL(NTH.TENPHONGBAN, PB.TENPHONGBAN) AS NOITHUCHIEN, NDV.TENNHOMDICHVU, ISNULL(GOI_CT.NOITHUCHIEN_ID, PB.PHONGBAN_ID) AS PHONGBAN_ID, DV.DICHVU_ID        , ISNULL(GOI_CT.DONGIATRONGGOI,0) AS DONGIA, ISNULL(GOI_CT.SOLAN,0) AS SOLUONG, GOI_CT.THANHTIENTRONGGOI AS THANHTIEN, BS.NHANVIEN_ID AS BACSICHIDINH_ID, BS.TENNHANVIEN AS TENBACSICHIDINH        , CASE WHEN DV.DICHVU_ID IN (SELECT DICHVU_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU WHERE HOPDONG_ID = '4' AND HOPDONG_BENHNHAN_ID = '318') THEN 1 ELSE 0 END AS DANGKY        FROM TT_KSK_HOPDONG HD                inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        INNER JOIN TM_CSKH_GOI_CHITIET GOI_CT ON GOI_CT.GOI_ID = HD_BN.GOI_ID        INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = GOI_CT.DICHVU_ID        LEFT JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        INNER JOIN TM_PHONGBAN_DICHVU PB_DV ON PB_DV.DICHVU_ID = DV.DICHVU_ID        LEFT JOIN TM_PHONGBAN PB ON PB.PHONGBAN_ID = PB_DV.PHONGBAN_ID        LEFT JOIN TM_PHONGBAN NTH ON NTH.PHONGBAN_ID = GOI_CT.NOITHUCHIEN_ID        LEFT JOIN TM_NHANVIEN BS ON BS.NHANVIEN_ID = GOI_CT.BACSICHIDINH_ID        WHERE GOI_CT.GOI_ID = 4 and HD_BN.HOPDONG_BENHNHAN_ID = 318        and PB_DV.PHONGBAN_ID =(select top 1 PHONGBAN_ID from TM_PHONGBAN_DICHVU where DICHVU_ID = DV.DICHVU_ID)]
2019-12-12 15:11:12,862 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhanDichVu] PreparedStatement : [SELECT distinct HD_BN.HOPDONG_ID, DV.TENDICHVU, ISNULL(NTH.TENPHONGBAN, PB.TENPHONGBAN) AS NOITHUCHIEN, NDV.TENNHOMDICHVU, ISNULL(GOI_CT.NOITHUCHIEN_ID, PB.PHONGBAN_ID) AS PHONGBAN_ID, DV.DICHVU_ID        , ISNULL(GOI_CT.DONGIATRONGGOI,0) AS DONGIA, ISNULL(GOI_CT.SOLAN,0) AS SOLUONG, GOI_CT.THANHTIENTRONGGOI AS THANHTIEN, BS.NHANVIEN_ID AS BACSICHIDINH_ID, BS.TENNHANVIEN AS TENBACSICHIDINH        , CASE WHEN DV.DICHVU_ID IN (SELECT DICHVU_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU WHERE HOPDONG_ID = '4' AND HOPDONG_BENHNHAN_ID = '317') THEN 1 ELSE 0 END AS DANGKY        FROM TT_KSK_HOPDONG HD                inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        INNER JOIN TM_CSKH_GOI_CHITIET GOI_CT ON GOI_CT.GOI_ID = HD_BN.GOI_ID        INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = GOI_CT.DICHVU_ID        LEFT JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        INNER JOIN TM_PHONGBAN_DICHVU PB_DV ON PB_DV.DICHVU_ID = DV.DICHVU_ID        LEFT JOIN TM_PHONGBAN PB ON PB.PHONGBAN_ID = PB_DV.PHONGBAN_ID        LEFT JOIN TM_PHONGBAN NTH ON NTH.PHONGBAN_ID = GOI_CT.NOITHUCHIEN_ID        LEFT JOIN TM_NHANVIEN BS ON BS.NHANVIEN_ID = GOI_CT.BACSICHIDINH_ID        WHERE GOI_CT.GOI_ID = 4 and HD_BN.HOPDONG_BENHNHAN_ID = 317        and PB_DV.PHONGBAN_ID =(select top 1 PHONGBAN_ID from TM_PHONGBAN_DICHVU where DICHVU_ID = DV.DICHVU_ID)]
2019-12-12 15:11:13,622 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhanDichVu] PreparedStatement : [SELECT distinct HD_BN.HOPDONG_ID, DV.TENDICHVU, ISNULL(NTH.TENPHONGBAN, PB.TENPHONGBAN) AS NOITHUCHIEN, NDV.TENNHOMDICHVU, ISNULL(GOI_CT.NOITHUCHIEN_ID, PB.PHONGBAN_ID) AS PHONGBAN_ID, DV.DICHVU_ID        , ISNULL(GOI_CT.DONGIATRONGGOI,0) AS DONGIA, ISNULL(GOI_CT.SOLAN,0) AS SOLUONG, GOI_CT.THANHTIENTRONGGOI AS THANHTIEN, BS.NHANVIEN_ID AS BACSICHIDINH_ID, BS.TENNHANVIEN AS TENBACSICHIDINH        , CASE WHEN DV.DICHVU_ID IN (SELECT DICHVU_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU WHERE HOPDONG_ID = '4' AND HOPDONG_BENHNHAN_ID = '318') THEN 1 ELSE 0 END AS DANGKY        FROM TT_KSK_HOPDONG HD                inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        INNER JOIN TM_CSKH_GOI_CHITIET GOI_CT ON GOI_CT.GOI_ID = HD_BN.GOI_ID        INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = GOI_CT.DICHVU_ID        LEFT JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        INNER JOIN TM_PHONGBAN_DICHVU PB_DV ON PB_DV.DICHVU_ID = DV.DICHVU_ID        LEFT JOIN TM_PHONGBAN PB ON PB.PHONGBAN_ID = PB_DV.PHONGBAN_ID        LEFT JOIN TM_PHONGBAN NTH ON NTH.PHONGBAN_ID = GOI_CT.NOITHUCHIEN_ID        LEFT JOIN TM_NHANVIEN BS ON BS.NHANVIEN_ID = GOI_CT.BACSICHIDINH_ID        WHERE GOI_CT.GOI_ID = 4 and HD_BN.HOPDONG_BENHNHAN_ID = 318        and PB_DV.PHONGBAN_ID =(select top 1 PHONGBAN_ID from TM_PHONGBAN_DICHVU where DICHVU_ID = DV.DICHVU_ID)]
2019-12-12 15:11:19,818 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'HSM08'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 15:11:20,123 [1] DEBUG - Statement Id: [DAO00307_GetContractWithDate] PreparedStatement : [SELECT HD.*, HD.SO_HD + ' - ' + CT.TENCONGTY AS HOPDONG, CT.TENCONGTY        FROM TT_KSK_HOPDONG HD JOIN TT_KSK_CONGTY CT ON CT.CONGTY_ID = HD.CONGTY_ID         where                 HD.BENHVIEN_ID = 'HLU01']
2019-12-12 15:11:20,328 [1] DEBUG - Statement Id: [DAO00307_GetContractWithDate] PreparedStatement : [SELECT HD.*, HD.SO_HD + ' - ' + CT.TENCONGTY AS HOPDONG, CT.TENCONGTY        FROM TT_KSK_HOPDONG HD JOIN TT_KSK_CONGTY CT ON CT.CONGTY_ID = HD.CONGTY_ID         where                 HD.BENHVIEN_ID = 'HLU01']
2019-12-12 15:11:23,102 [1] DEBUG - Statement Id: [DAO00307_GetPatientConfirms] PreparedStatement : [select distinct HD_BN.*        , CASE WHEN HD_BN.GIOITINH = '1' THEN N'Nam' ELSE N'Nữ' END AS GENDER        , CASE WHEN HD_DV.ACTIVE IS NULL THEN 0 ELSE 1 END BENHNHAN_DANGKYKSK_DICHVU        , case when HD_BN.GOI_ID is null then N'Hợp đồng:' + ' ' + HD.SO_HD else N'Gói khám:' + ' ' + G.TENGOI end as DOITUONG        , LST.DICTIONARY_NAME as HONNHAN        from TT_KSK_HOPDONG HD        inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        left join LST_DICTIONARY LST ON LST.DICTIONARY_ID = HD_BN.TINHTRANGHONNHAN_ID AND LST.DICTIONARY_TYPE_CODE = 'TinhTrangGiaDinh'        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        left join TT_TIEPNHAN TN on TN.TIEPNHAN_ID = HD_DV.TIEPNHAN_ID        left join TM_CSKH_GOI G ON G.GOI_ID = HD_BN.GOI_ID        where HD.HOPDONG_ID = '4'         AND           HD.BENHVIEN_ID = 'HLU01'                 order by HD_BN.STT]
2019-12-12 15:11:25,465 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , ISNULL(NTH.TENPHONGBAN, PB.TENPHONGBAN) as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , ISNULL(NTH.PHONGBAN_ID, PB.PHONGBAN_ID) as NOITHUCHIEN_ID        , BS.NHANVIEN_ID AS BACSICHIDINH_ID, BS.TENNHANVIEN AS TENBACSICHIDINH        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        LEFT JOIN TM_PHONGBAN NTH ON NTH.PHONGBAN_ID = G_CT.NOITHUCHIEN_ID        LEFT JOIN TM_NHANVIEN BS ON BS.NHANVIEN_ID = G_CT.BACSICHIDINH_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '314'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-12 15:11:48,284 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , ISNULL(NTH.TENPHONGBAN, PB.TENPHONGBAN) as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , ISNULL(NTH.PHONGBAN_ID, PB.PHONGBAN_ID) as NOITHUCHIEN_ID        , BS.NHANVIEN_ID AS BACSICHIDINH_ID, BS.TENNHANVIEN AS TENBACSICHIDINH        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        LEFT JOIN TM_PHONGBAN NTH ON NTH.PHONGBAN_ID = G_CT.NOITHUCHIEN_ID        LEFT JOIN TM_NHANVIEN BS ON BS.NHANVIEN_ID = G_CT.BACSICHIDINH_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '314'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-12 15:11:50,567 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , ISNULL(NTH.TENPHONGBAN, PB.TENPHONGBAN) as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , ISNULL(NTH.PHONGBAN_ID, PB.PHONGBAN_ID) as NOITHUCHIEN_ID        , BS.NHANVIEN_ID AS BACSICHIDINH_ID, BS.TENNHANVIEN AS TENBACSICHIDINH        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        LEFT JOIN TM_PHONGBAN NTH ON NTH.PHONGBAN_ID = G_CT.NOITHUCHIEN_ID        LEFT JOIN TM_NHANVIEN BS ON BS.NHANVIEN_ID = G_CT.BACSICHIDINH_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '315'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-12 15:11:50,726 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , ISNULL(NTH.TENPHONGBAN, PB.TENPHONGBAN) as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , ISNULL(NTH.PHONGBAN_ID, PB.PHONGBAN_ID) as NOITHUCHIEN_ID        , BS.NHANVIEN_ID AS BACSICHIDINH_ID, BS.TENNHANVIEN AS TENBACSICHIDINH        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        LEFT JOIN TM_PHONGBAN NTH ON NTH.PHONGBAN_ID = G_CT.NOITHUCHIEN_ID        LEFT JOIN TM_NHANVIEN BS ON BS.NHANVIEN_ID = G_CT.BACSICHIDINH_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '314'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-12 15:11:50,771 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , ISNULL(NTH.TENPHONGBAN, PB.TENPHONGBAN) as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , ISNULL(NTH.PHONGBAN_ID, PB.PHONGBAN_ID) as NOITHUCHIEN_ID        , BS.NHANVIEN_ID AS BACSICHIDINH_ID, BS.TENNHANVIEN AS TENBACSICHIDINH        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        LEFT JOIN TM_PHONGBAN NTH ON NTH.PHONGBAN_ID = G_CT.NOITHUCHIEN_ID        LEFT JOIN TM_NHANVIEN BS ON BS.NHANVIEN_ID = G_CT.BACSICHIDINH_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '314'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-12 15:11:50,813 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , ISNULL(NTH.TENPHONGBAN, PB.TENPHONGBAN) as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , ISNULL(NTH.PHONGBAN_ID, PB.PHONGBAN_ID) as NOITHUCHIEN_ID        , BS.NHANVIEN_ID AS BACSICHIDINH_ID, BS.TENNHANVIEN AS TENBACSICHIDINH        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        LEFT JOIN TM_PHONGBAN NTH ON NTH.PHONGBAN_ID = G_CT.NOITHUCHIEN_ID        LEFT JOIN TM_NHANVIEN BS ON BS.NHANVIEN_ID = G_CT.BACSICHIDINH_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '315'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-12 15:11:50,858 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , ISNULL(NTH.TENPHONGBAN, PB.TENPHONGBAN) as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , ISNULL(NTH.PHONGBAN_ID, PB.PHONGBAN_ID) as NOITHUCHIEN_ID        , BS.NHANVIEN_ID AS BACSICHIDINH_ID, BS.TENNHANVIEN AS TENBACSICHIDINH        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        LEFT JOIN TM_PHONGBAN NTH ON NTH.PHONGBAN_ID = G_CT.NOITHUCHIEN_ID        LEFT JOIN TM_NHANVIEN BS ON BS.NHANVIEN_ID = G_CT.BACSICHIDINH_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '315'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-12 15:14:06,680 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , ISNULL(NTH.TENPHONGBAN, PB.TENPHONGBAN) as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , ISNULL(NTH.PHONGBAN_ID, PB.PHONGBAN_ID) as NOITHUCHIEN_ID        , BS.NHANVIEN_ID AS BACSICHIDINH_ID, BS.TENNHANVIEN AS TENBACSICHIDINH        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        LEFT JOIN TM_PHONGBAN NTH ON NTH.PHONGBAN_ID = G_CT.NOITHUCHIEN_ID        LEFT JOIN TM_NHANVIEN BS ON BS.NHANVIEN_ID = G_CT.BACSICHIDINH_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '313'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-12 15:14:07,786 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , ISNULL(NTH.TENPHONGBAN, PB.TENPHONGBAN) as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , ISNULL(NTH.PHONGBAN_ID, PB.PHONGBAN_ID) as NOITHUCHIEN_ID        , BS.NHANVIEN_ID AS BACSICHIDINH_ID, BS.TENNHANVIEN AS TENBACSICHIDINH        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        LEFT JOIN TM_PHONGBAN NTH ON NTH.PHONGBAN_ID = G_CT.NOITHUCHIEN_ID        LEFT JOIN TM_NHANVIEN BS ON BS.NHANVIEN_ID = G_CT.BACSICHIDINH_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '314'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-12 15:14:07,904 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , ISNULL(NTH.TENPHONGBAN, PB.TENPHONGBAN) as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , ISNULL(NTH.PHONGBAN_ID, PB.PHONGBAN_ID) as NOITHUCHIEN_ID        , BS.NHANVIEN_ID AS BACSICHIDINH_ID, BS.TENNHANVIEN AS TENBACSICHIDINH        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        LEFT JOIN TM_PHONGBAN NTH ON NTH.PHONGBAN_ID = G_CT.NOITHUCHIEN_ID        LEFT JOIN TM_NHANVIEN BS ON BS.NHANVIEN_ID = G_CT.BACSICHIDINH_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '315'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-12 15:14:07,945 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , ISNULL(NTH.TENPHONGBAN, PB.TENPHONGBAN) as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , ISNULL(NTH.PHONGBAN_ID, PB.PHONGBAN_ID) as NOITHUCHIEN_ID        , BS.NHANVIEN_ID AS BACSICHIDINH_ID, BS.TENNHANVIEN AS TENBACSICHIDINH        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        LEFT JOIN TM_PHONGBAN NTH ON NTH.PHONGBAN_ID = G_CT.NOITHUCHIEN_ID        LEFT JOIN TM_NHANVIEN BS ON BS.NHANVIEN_ID = G_CT.BACSICHIDINH_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '315'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-12 15:14:11,706 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , ISNULL(NTH.TENPHONGBAN, PB.TENPHONGBAN) as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , ISNULL(NTH.PHONGBAN_ID, PB.PHONGBAN_ID) as NOITHUCHIEN_ID        , BS.NHANVIEN_ID AS BACSICHIDINH_ID, BS.TENNHANVIEN AS TENBACSICHIDINH        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        LEFT JOIN TM_PHONGBAN NTH ON NTH.PHONGBAN_ID = G_CT.NOITHUCHIEN_ID        LEFT JOIN TM_NHANVIEN BS ON BS.NHANVIEN_ID = G_CT.BACSICHIDINH_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '314'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-12 15:14:15,401 [1] DEBUG - Statement Id: [DAO00307_CheckSingin] PreparedStatement : [select *        from TT_KSK_HOPDONG_BENHNHAN_DICHVU         where                 HOPDONG_ID = 4             and               HOPDONG_BENHNHAN_ID = 314             and               BENHVIEN_ID = 'HLU01']
2019-12-12 15:14:15,562 [1] DEBUG - Statement Id: [DAOLOG01_LockBegin] PreparedStatement : [INSERT into TT_LOG_UPDATE ( REF_TABLE , REF_ID , BENHVIEN_ID )         values ( @param0 ,  @param1 ,  @param2 );]
2019-12-12 15:14:15,562 [1] DEBUG - Statement Id: [DAOLOG01_LockBegin] Parameters: [@param0=[REF_TABLE,TT_TIEPNHAN_BENHAN], @param1=[REF_ID,24429], @param2=[BENHVIEN_ID,HLU01]]
2019-12-12 15:14:15,562 [1] DEBUG - Statement Id: [DAOLOG01_LockBegin] Types: [@param0=[String, System.String], @param1=[Int64, System.Int64], @param2=[String, System.String]]
2019-12-12 15:14:15,681 [1] DEBUG - Statement Id: [DAO00087_GetServiceParams] PreparedStatement : [select CODE, VALUE              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01']
2019-12-12 15:14:15,717 [1] DEBUG - Statement Id: [DAO00013_GetPatientInfo] PreparedStatement : [select *        from TT_BENHNHAN        where MAYTE  = '190043309']
2019-12-12 15:14:15,753 [1] DEBUG - Statement Id: [DAO00095_GetListNguoiLienHe] PreparedStatement : [SELECT BNN.*, D.DICTIONARY_NAME AS TENQUANHE          FROM TT_BENHNHAN AS BN          INNER JOIN TT_BENHNHAN_NGUOILIENHE AS BNN ON BNN.BENHNHAN_ID = BN.BENHNHAN_ID          LEFT JOIN LST_DICTIONARY AS D ON D.DICTIONARY_ID = BNN.QUANHE_ID AND D.DICTIONARY_TYPE_CODE = 'QuanHeGiaDinh'          WHERE BN.MAYTE = '190043309' AND BN.ACTIVE = '1' AND BN.BENHVIEN_ID = 'HLU01']
2019-12-12 15:14:15,818 [1] DEBUG - Statement Id: [DAO00013_GetBenhNhanToDB] PreparedStatement : [select ROW_NUMBER() OVER(order by a.MAYTE) as ROWNUMBER, *,        CASE        WHEN A.GIOITINH = 1 THEN 'Nam'        WHEN A.GIOITINH = 2 THEN N'Nữ'        END as TENGIOITINH        from TT_BENHNHAN A        where  ACTIVE = '1' and MAYTE = '190043309']
2019-12-12 15:14:17,275 [1] DEBUG - Statement Id: [DAO00095_GetListTiepNhanWithBenhNhanId] PreparedStatement : [SELECT A.SOTIEPNHAN, A.TIEPNHAN_ID, B.BENHAN_ID, B.SOBENHAN, bn.MAYTE          from TT_TIEPNHAN A          left join TT_NOITRU_BENHAN B on A.TIEPNHAN_ID = B.TIEPNHAN_ID          left join (select MAYTE, BENHNHAN_ID from TT_BENHNHAN where BENHNHAN_ID = '24429') bn on bn.BENHNHAN_ID = A.BENHNHAN_ID          WHERE A.BENHVIEN_ID = 'HLU01' and A.BENHNHAN_ID = '24429'          and A.TRANGTHAI in ('DATIEPNHAN','CAPCUU','NOITRU')]
2019-12-12 15:14:17,320 [1] DEBUG - Statement Id: [DAO00095_GetListDVYeucauWithBenhNhanId] PreparedStatement : [SELECT A.SOTIEPNHAN, A.TIEPNHAN_ID, C.DICHVU_ID, C.DVYEUCAU_ID          from TT_TIEPNHAN A          left join (select * from TT_DVYEUCAU where BENHNHAN_ID = '24429') C on C.TIEPNHAN_ID = A.TIEPNHAN_ID          WHERE A.BENHVIEN_ID = 'HLU01' and A.BENHNHAN_ID = '24429'          and A.TRANGTHAI in ('DATIEPNHAN','CAPCUU','NOITRU')]
2019-12-12 15:14:17,366 [1] DEBUG - Statement Id: [DAO00095_GetListToaThuocNoiTruWithBenhNhanId] PreparedStatement : [SELECT B.KHAMBENH_ID as KHAMBENH_TOATHUOC_ID, 'NOITRU' as LOAITOA          from TT_TIEPNHAN A          left join TT_NOITRU_TOATHUOC B on A.TIEPNHAN_ID = B.TIEPNHAN_ID          WHERE A.BENHVIEN_ID = 'HLU01' and A.BENHNHAN_ID = '24429'          and A.TRANGTHAI in ('DATIEPNHAN','CAPCUU','NOITRU')]
2019-12-12 15:14:17,400 [1] DEBUG - Statement Id: [DAO00095_GetLisToaThuocNgoaiWithBenhNhanId] PreparedStatement : [SELECT B.KHAMBENH_TOATHUOC_ID, B.LOAITOATHUOC as LOAITOA          from TT_TIEPNHAN A          left join TT_NGOAITRU_KHAMBENH C on C.TIEPNHAN_ID = A.TIEPNHAN_ID          left join TT_NGOAITRU_KHAMBENH_TOATHUOC B on C.KHAMBENH_ID = B.KHAMBENH_ID          WHERE A.BENHVIEN_ID = 'HLU01' and A.BENHNHAN_ID = '24429'          and A.TRANGTHAI in ('DATIEPNHAN','CAPCUU','NOITRU')]
2019-12-12 15:14:17,438 [1] DEBUG - Statement Id: [DAO00307_UpdatePatientKSK] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN set        MAYTE =  @param0         , TENBENHNHAN =  @param1         , GIOITINH =  @param2         , NGAYSINH =  @param3         , NAMSINH =  @param4         , DIACHI =  @param5         , QUOCTICH_ID =  @param6         , TINHTHANH_ID =  @param7         , QUANHUYEN_ID =  @param8         , XAPHUONG_ID =  @param9         , DIACHITHUONGTRU =  @param10         , DANTOC_ID =  @param11         , SODIENTHOAI =  @param12         , NGHENGHIEP_ID =  @param13         , CMND =  @param14         , NGAYCAPNHAT =  @param15         , NGUOICAPNHAT_ID =  @param16         where        BENHNHAN_ID = '24429']
2019-12-12 15:14:17,439 [1] DEBUG - Statement Id: [DAO00307_UpdatePatientKSK] Parameters: [@param0=[MAYTE,190043309], @param1=[TENBENHNHAN,Nguyễn Hữu Dương], @param2=[GIOITINH,1], @param3=[NGAYSINH,2/18/1990 12:00:00 AM], @param4=[NAMSINH,1990], @param5=[DIACHI,null], @param6=[QUOCTICH_ID,null], @param7=[TINHTHANH_ID,null], @param8=[QUANHUYEN_ID,null], @param9=[XAPHUONG_ID,null], @param10=[DIACHITHUONGTRU,null], @param11=[DANTOC_ID,null], @param12=[SODIENTHOAI,null], @param13=[NGHENGHIEP_ID,null], @param14=[CMND,null], @param15=[NGAYCAPNHAT,12/12/2019 12:00:00 AM], @param16=[NGUOICAPNHAT_ID,1]]
2019-12-12 15:14:17,439 [1] DEBUG - Statement Id: [DAO00307_UpdatePatientKSK] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[Int64, System.Int64], @param3=[DateTime, System.DateTime], @param4=[Int64, System.Int64], @param5=[System.DBNull, null], @param6=[System.DBNull, null], @param7=[System.DBNull, null], @param8=[System.DBNull, null], @param9=[System.DBNull, null], @param10=[System.DBNull, null], @param11=[System.DBNull, null], @param12=[System.DBNull, null], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[DateTime, System.DateTime], @param16=[Int64, System.Int64]]
2019-12-12 15:14:17,477 [1] DEBUG - Statement Id: [DAO00118_Add_BenhNhan] PreparedStatement : [if not exists (select 1 from TT_BENHNHAN where BENHNHAN_ID = '24429')              insert into TT_BENHNHAN (              BENHNHAN_ID              , MAYTE              , SOVAOVIEN              , TENBENHNHAN              , HO              , TEN              , GIOITINH              , NGAYSINH              , NAMSINH              , SONHA              , DIACHI              , SODIENTHOAI              , XAPHUONG_ID              , QUANHUYEN_ID              , TINHTHANH_ID              , DANTOC_ID              , QUOCTICH_ID              , SOLUUTRUNOITRU              , SOLUUTRUNGOAITRU              , NGHENGHIEP_ID              , CMND              , HOCHIEU              , VIETKIEU              , NGUOINUOCNGOAI              , DIACHITHUONGTRU              , DIACHILIENLAC              , DIACHICOQUAN              , EMAIL              , NHOMMAU_ID              , YEUTORH_ID              , TIENSUDIUNG              , TIENSUBENH              , TIENSUHUTTHUOCLA              , TUVONG              , NGAYTUVONG              , THOIGIANTUVONG              , NGUYENNHANTUVONG_ID              , NGUOIGHINHANTUVONG_ID              , THOIGIANGHINHANTUVONG              , NHANVIEN_ID              , DONVICONGTAC_ID              , DIENTHOAIBAN              , TINHTRANGHONNHAN_ID              , NGUOILIENHE_ID              , MOIQUANHE_ID              , NGUOILIENHE              , THONGTIN_NLH              , GHICHU              , HINHANH_DAIDIEN              , BENHVIEN_ID              , NGAYTAO              , NGUOITAO_ID              , NGAYGIOSINH              ) values (               @param0               ,  @param1               ,  @param2               ,  @param3               ,  @param4               ,  @param5               ,  @param6               ,  @param7               ,  @param8               ,  @param9               ,  @param10               ,  @param11               ,  @param12               ,  @param13               ,  @param14               ,  @param15               ,  @param16               ,  @param17               ,  @param18               ,  @param19               ,  @param20               ,  @param21               ,  @param22               ,  @param23               ,  @param24               ,  @param25               ,  @param26               ,  @param27               ,  @param28               ,  @param29               ,  @param30               ,  @param31               ,  @param32               ,  @param33               ,  @param34               ,  @param35               ,  @param36               ,  @param37               ,  @param38               ,  @param39               ,  @param40               ,  @param41               ,  @param42               ,  @param43               ,  @param44               ,  @param45               ,  @param46               ,  @param47               ,  @param48               ,  @param49               ,  @param50               ,  @param51               ,  @param52               )              else              update TT_BENHNHAN set              MAYTE =  @param1                ,                   SOVAOVIEN =  @param2                ,                   TENBENHNHAN =  @param3                ,                   HO =  @param4                ,                   TEN =  @param5                ,                   GIOITINH =  @param6                ,                   NGAYSINH =  @param7                ,                   NAMSINH =  @param8                ,                   SONHA =  @param9                ,                   SODIENTHOAI =  @param11                ,                   XAPHUONG_ID =  @param12                ,                   DANTOC_ID =  @param15                ,                   QUOCTICH_ID =  @param16                ,                   NGHENGHIEP_ID =  @param19                ,                   CMND =  @param20                ,                   HOCHIEU =  @param21                ,                   DIACHITHUONGTRU =  @param24                ,                   DIACHILIENLAC =  @param25                ,                   NGUOILIENHE_ID =  @param43                ,                   MOIQUANHE_ID =  @param44                ,                   NGUOILIENHE =  @param45                ,                   THONGTIN_NLH =  @param46                ,                   GHICHU =  @param47                ,                   BENHVIEN_ID =  @param49                ,                   NGAYCAPNHAT =  @param53                ,                   NGUOICAPNHAT_ID =  @param54                              where              BENHNHAN_ID = '24429']
2019-12-12 15:14:17,477 [1] DEBUG - Statement Id: [DAO00118_Add_BenhNhan] Parameters: [@param0=[BENHNHAN_ID,24429], @param1=[MAYTE,190043309], @param2=[SOVAOVIEN,0043309], @param3=[TENBENHNHAN,Nguyễn Hữu Dương], @param4=[HO,Nguyễn], @param5=[TEN,Hữu Dương], @param6=[GIOITINH,1], @param7=[NGAYSINH,2/18/1990 12:00:00 AM], @param8=[NAMSINH,1990], @param9=[SONHA,null], @param10=[DIACHI,null], @param11=[SODIENTHOAI,null], @param12=[XAPHUONG_ID,null], @param13=[QUANHUYEN_ID,null], @param14=[TINHTHANH_ID,null], @param15=[DANTOC_ID,null], @param16=[QUOCTICH_ID,null], @param17=[SOLUUTRUNOITRU,null], @param18=[SOLUUTRUNGOAITRU,null], @param19=[NGHENGHIEP_ID,null], @param20=[CMND,null], @param21=[HOCHIEU,null], @param22=[VIETKIEU,null], @param23=[NGUOINUOCNGOAI,null], @param24=[DIACHITHUONGTRU,null], @param25=[DIACHILIENLAC,null], @param26=[DIACHICOQUAN,null], @param27=[EMAIL,null], @param28=[NHOMMAU_ID,null], @param29=[YEUTORH_ID,null], @param30=[TIENSUDIUNG,null], @param31=[TIENSUBENH,null], @param32=[TIENSUHUTTHUOCLA,null], @param33=[TUVONG,null], @param34=[NGAYTUVONG,null], @param35=[THOIGIANTUVONG,null], @param36=[NGUYENNHANTUVONG_ID,null], @param37=[NGUOIGHINHANTUVONG_ID,null], @param38=[THOIGIANGHINHANTUVONG,null], @param39=[NHANVIEN_ID,null], @param40=[DONVICONGTAC_ID,null], @param41=[DIENTHOAIBAN,null], @param42=[TINHTRANGHONNHAN_ID,null], @param43=[NGUOILIENHE_ID,null], @param44=[MOIQUANHE_ID,null], @param45=[NGUOILIENHE,null], @param46=[THONGTIN_NLH,null], @param47=[GHICHU,null], @param48=[HINHANH_DAIDIEN,null], @param49=[BENHVIEN_ID,HLU01], @param50=[NGAYTAO,12/11/2019 10:53:31 AM], @param51=[NGUOITAO_ID,0], @param52=[NGAYGIOSINH,null], @param53=[NGAYCAPNHAT,12/12/2019 12:00:00 AM], @param54=[NGUOICAPNHAT_ID,1]]
2019-12-12 15:14:17,477 [1] DEBUG - Statement Id: [DAO00118_Add_BenhNhan] Types: [@param0=[Int32, System.Int32], @param1=[String, System.String], @param2=[String, System.String], @param3=[String, System.String], @param4=[String, System.String], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[DateTime, System.DateTime], @param8=[Int64, System.Int64], @param9=[System.DBNull, null], @param10=[System.DBNull, null], @param11=[System.DBNull, null], @param12=[System.DBNull, null], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[System.DBNull, null], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[System.DBNull, null], @param39=[System.DBNull, null], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[String, System.String], @param50=[DateTime, System.DateTime], @param51=[Int64, System.Int64], @param52=[System.DBNull, null], @param53=[DateTime, System.DateTime], @param54=[Int64, System.Int64]]
2019-12-12 15:14:17,744 [1] DEBUG - Statement Id: [DAOWF001_Laythongtingateways] PreparedStatement : [select * from TM_PROCESS_GATEWAYS]
2019-12-12 15:14:18,068 [1] DEBUG - Statement Id: [DAO00019_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10),        @yearNow int, @monthNow varchar(2), @dayNow varchar(2),        @Sotiepnhan varchar(20), @SoThuTu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @monthNow = RIGHT('00' + convert(varchar(2), MONTH(getdate())),2)        set @dayNow = RIGHT('00' + convert(varchar(2), DAY(getdate())),2)        BEGIN        select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOTIEPNHAN' and KEYYEAR = @yearNow and KEYMONTH = @monthNow and KEYDAY = @dayNow        and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOTIEPNHAN', @yearNow, @monthNow, @dayNow, '0', '0', '0', 0, @BenhVienId);        Update LST_KEYDATA set KEYVALUE = (KEYVALUE + 1), @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOTIEPNHAN' and KEYYEAR = @yearNow and KEYMONTH = @monthNow and KEYDAY = @dayNow and BENHVIEN_ID = @BenhVienId        set @SoThuTu = right('0000000'+convert(varchar(7), @keyValue), 7)        set @Sotiepnhan = 'TN' + RIGHT(@yearNow, 2) + @monthNow  + @dayNow + '.' + @SoThuTu                   insert into TT_TIEPNHAN (        SOTIEPNHAN        , UUTIEN        , BENHNHAN_ID        , BENHVIEN_ID        , TUYENKHAMBENH_ID        , NOITIEPNHAN_ID        , NGAYTIEPNHAN        , THOIGIANTIEPNHAN        , NAMTIEPNHAN        , THANGTIEPNHAN        , DOITUONG_ID        , LYDOTIEPNHAN_ID        , HINHTHUCDENKHAM_ID        , TINHTRANGHEN        , XACNHANCHIPHI_ID        , THUTIENTRUOC        , TAIKHAM        , SOBHYT        , BHYTTUNGAY        , BHYTDENNGAY        , BHYTNGAYCAP        , BHYTTREN3NAM        , BHYTTREN5NAM        , NGAYMIENDONGCHITRA        , LOAIBHYT        , NGAYBHYT2        , SOCHUYENVIEN        , HINHTHUCCHUYENVIEN_ID        , NOIGIOITHIEU_ID        , NGUOIGIOITHIEU_ID        , THOIGIANCHUYENTUYEN        , LYDOCHUYENVIEN_ID        , ICDNOIGIOITHIEU_ID        , CHANDOANNGT        , TRAITUYEN        , DIACHILIENHE        , XAPHUONG_ID        , QUANHUYEN_ID        , TINHTHANH_ID        , PROCESS_ID        , TRANGTHAI        , KHUVUCSONG_ID        , THANHVIEN_ID        , THE_ID        , LOAITHANHVIEN_ID        , SUDUNG_BHTN        , VIP        , GHICHU_TIEPNHAN        , BAOLANH_VIENPHI        , CONGTY_CHITRA_ID        , NGUON_BENHNHAN_ID        , LOAITIEPNHAN_ID        , THONGTIN_KCB_BHYT        , NGAYTAO        , NGUOITAO_ID        , LYDODENKHAM         ,           ISTHONGTUYEN                 )        OUTPUT INSERTED.TIEPNHAN_ID, INSERTED.SOTIEPNHAN        values (        @Sotiepnhan        ,  @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54          ,            @param55                  )        end]
2019-12-12 15:14:18,068 [1] DEBUG - Statement Id: [DAO00019_Add] Parameters: [@param0=[UUTIEN,0], @param1=[BENHNHAN_ID,24429], @param2=[BENHVIEN_ID,HLU01], @param3=[TUYENKHAMBENH_ID,null], @param4=[NOITIEPNHAN_ID,68], @param5=[NGAYTIEPNHAN,12/12/2019 12:00:00 AM], @param6=[THOIGIANTIEPNHAN,12/12/2019 12:00:00 AM], @param7=[NAMTIEPNHAN,2019], @param8=[THANGTIEPNHAN,12], @param9=[DOITUONG_ID,1], @param10=[LYDOTIEPNHAN_ID,null], @param11=[HINHTHUCDENKHAM_ID,461], @param12=[TINHTRANGHEN,null], @param13=[XACNHANCHIPHI_ID,null], @param14=[THUTIENTRUOC,null], @param15=[TAIKHAM,0], @param16=[SOBHYT,null], @param17=[BHYTTUNGAY,null], @param18=[BHYTDENNGAY,null], @param19=[BHYTNGAYCAP,null], @param20=[BHYTTREN3NAM,0], @param21=[BHYTTREN5NAM,0], @param22=[NGAYMIENDONGCHITRA,null], @param23=[LOAIBHYT,null], @param24=[NGAYBHYT2,null], @param25=[SOCHUYENVIEN,null], @param26=[HINHTHUCCHUYENVIEN_ID,null], @param27=[NOIGIOITHIEU_ID,null], @param28=[NGUOIGIOITHIEU_ID,null], @param29=[THOIGIANCHUYENTUYEN,null], @param30=[LYDOCHUYENVIEN_ID,null], @param31=[ICDNOIGIOITHIEU_ID,null], @param32=[CHANDOANNGT,null], @param33=[TRAITUYEN,0], @param34=[DIACHILIENHE,null], @param35=[XAPHUONG_ID,null], @param36=[QUANHUYEN_ID,null], @param37=[TINHTHANH_ID,null], @param38=[PROCESS_ID,P01], @param39=[TRANGTHAI,DATIEPNHAN], @param40=[KHUVUCSONG_ID,null], @param41=[THANHVIEN_ID,null], @param42=[THE_ID,null], @param43=[LOAITHANHVIEN_ID,null], @param44=[SUDUNG_BHTN,0], @param45=[VIP,0], @param46=[GHICHU_TIEPNHAN,null], @param47=[BAOLANH_VIENPHI,0], @param48=[CONGTY_CHITRA_ID,null], @param49=[NGUON_BENHNHAN_ID,null], @param50=[LOAITIEPNHAN_ID,null], @param51=[THONGTIN_KCB_BHYT,null], @param52=[NGAYTAO,12/12/2019 3:14:18 PM], @param53=[NGUOITAO_ID,0], @param54=[LYDODENKHAM,null], @param55=[ISTHONGTUYEN,0]]
2019-12-12 15:14:18,068 [1] DEBUG - Statement Id: [DAO00019_Add] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[String, System.String], @param3=[System.DBNull, null], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[DateTime, System.DateTime], @param7=[Int32, System.Int32], @param8=[Int32, System.Int32], @param9=[Int64, System.Int64], @param10=[System.DBNull, null], @param11=[Int64, System.Int64], @param12=[System.DBNull, null], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[String, System.String], @param21=[String, System.String], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[String, System.String], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[String, System.String], @param45=[String, System.String], @param46=[System.DBNull, null], @param47=[String, System.String], @param48=[System.DBNull, null], @param49=[System.DBNull, null], @param50=[System.DBNull, null], @param51=[System.DBNull, null], @param52=[DateTime, System.DateTime], @param53=[Int64, System.Int64], @param54=[System.DBNull, null], @param55=[String, System.String]]
2019-12-12 15:14:18,544 [1] DEBUG - Statement Id: [DAO00019_GetTTTiepNhan_byTiepNhanId] PreparedStatement : [select *        from TT_TIEPNHAN        where TIEPNHAN_ID = '28491'        order by TIEPNHAN_ID]
2019-12-12 15:14:18,607 [1] DEBUG - Statement Id: [DAO00080_Add_KhamBenh_CapCuu] PreparedStatement : [insert into TT_KHAMBENH_VAOVIEN (        SOPHIEU        , TIEPNHAN_ID        , KHAMBENH_ID        , BENHNHAN_ID        , NGUOILIENHE        , DIENTHOAILIENHE        , NOILAMVIEC        , CHANDOANNOIGIOITHIEU        , NGAYKHAM        , THOIGIANKHAM        , LYDOVAOVIEN        , QUATRINHBENHLY        , TIENSUBANTHAN        , TIENSUGIADINH        , KHAMXETTOANTHAN        , KHAMXETCACBOPHAN        , KHAMXETKQLS        , CHANDOANVAO        , ICDKHAMXET_ID        , DAXULY        , NGAYRA        , THOIGIANRA        , NHAPKHOA_ID        , CHUYENVIEN_ID        , CHUY        , MACH        , NHIETDO        , HUYETAPCAO        , HUYETAPTHAP        , NHIPTHO        , CANNANG        , CHIEUCAO        , BACSI_ID        , XUTRUKHAMBENH_ID        , CAPCUU        , NGAYTAINAN        , THOIGIANTAINAN        , NOITAINAN_TINHTHANH_ID        , NOITAINAN_QUANHUYEN_ID        , NOITAINAN_PHUONGXA_ID        , NOITAINAN_DIACHI        , DIADIEMTAINAN_ID        , BOPHANBITHUONG_ID        , MUCDO_ID        , DIENBIENSAUTN_ID        , XUTRISAUTN_ID        , NGUYENNHAN_ID        , NGUYENNHANCHITIET_ID        , ICD_NGUYENNHAN        , NGAYTAO        , NGUOITAO_ID        , NGAYCAPNHAT        , NGUOICAPNHAT_ID        , BENHANCHUYENKHOA        , CHANDOANVAOVIEN        , CHANDOANRAVIEN        , DIEUTRITUNGAY        , DIEUTRIDENNGAY        , DIENBIENLS        , KQXETNGHIEM        , PHAUTHUAT        , THUTHUAT        , TINHTRANGNGUOIBENH        , HUONGDIEUTRI        , NGUOIGIAO_ID        , NGUOINHAN_ID        , XQUANG        , CTSCANNER        , SIEUAM        , XETNGHIEM        , KHAC        , TOANBOHS        , LOAICHUYENKHOA        , CONGANCANTHIEP        , CDRR_BENHCHINH        , CDRR_BENHKEM        , ICD_BENHCHINH        , ICD_BENHKEMTHEO        , PHUONGPHAPDIEUTRI        , FIELD_1        , FIELD_2        , FIELD_3        , FIELD_4        , FIELD_5        , FIELD_6        , FIELD_7        , FIELD_8        , FIELD_9        , FIELD_10        , FIELD_11        , FIELD_12        , FIELD_13        , FIELD_14        , FIELD_15        , FIELD_27        , FIELD_28        , FIELD_29        , FIELD_30        , FIELD_31        , FIELD_32        , FIELD_33        , FIELD_34        , FIELD_35        , FIELD_36        , FIELD_37        , FIELD_38        , FIELD_39        , FIELD_40        , FIELD_41        , FIELD_42        , FIELD_43        , FIELD_44        , FIELD_45        , FIELD_46        , FIELD_47        , FIELD_48        , FIELD_49        , FIELD_50        , FIELD_51        , FIELD_52        , FIELD_53        , FIELD_54        , FIELD_55        , FIELD_56        , BENHVIEN_ID        ) values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77         ,  @param78         ,  @param79         ,  @param80         ,  @param81         ,  @param82         ,  @param83         ,  @param84         ,  @param85         ,  @param86         ,  @param87         ,  @param88         ,  @param89         ,  @param90         ,  @param91         ,  @param92         ,  @param93         ,  @param94         ,  @param95         ,  @param96         ,  @param97         ,  @param98         ,  @param99         ,  @param100         ,  @param101         ,  @param102         ,  @param103         ,  @param104         ,  @param105         ,  @param106         ,  @param107         ,  @param108         ,  @param109         ,  @param110         ,  @param111         ,  @param112         ,  @param113         ,  @param114         ,  @param115         ,  @param116         ,  @param117         ,  @param118         ,  @param119         ,  @param120         ,  @param121         ,  @param122         ,  @param123         ,  @param124         )]
2019-12-12 15:14:18,608 [1] DEBUG - Statement Id: [DAO00080_Add_KhamBenh_CapCuu] Parameters: [@param0=[SOPHIEU,null], @param1=[TIEPNHAN_ID,28491], @param2=[KHAMBENH_ID,null], @param3=[BENHNHAN_ID,24429], @param4=[NGUOILIENHE,null], @param5=[DIENTHOAILIENHE,null], @param6=[NOILAMVIEC,null], @param7=[CHANDOANNOIGIOITHIEU,null], @param8=[NGAYKHAM,12/12/2019 12:00:00 AM], @param9=[THOIGIANKHAM,12/12/2019 12:00:00 AM], @param10=[LYDOVAOVIEN,null], @param11=[QUATRINHBENHLY,null], @param12=[TIENSUBANTHAN,null], @param13=[TIENSUGIADINH,null], @param14=[KHAMXETTOANTHAN,null], @param15=[KHAMXETCACBOPHAN,null], @param16=[KHAMXETKQLS,null], @param17=[CHANDOANVAO,null], @param18=[ICDKHAMXET_ID,null], @param19=[DAXULY,null], @param20=[NGAYRA,null], @param21=[THOIGIANRA,null], @param22=[NHAPKHOA_ID,68], @param23=[CHUYENVIEN_ID,null], @param24=[CHUY,null], @param25=[MACH,null], @param26=[NHIETDO,null], @param27=[HUYETAPCAO,null], @param28=[HUYETAPTHAP,null], @param29=[NHIPTHO,null], @param30=[CANNANG,null], @param31=[CHIEUCAO,null], @param32=[BACSI_ID,null], @param33=[XUTRUKHAMBENH_ID,null], @param34=[CAPCUU,null], @param35=[NGAYTAINAN,null], @param36=[THOIGIANTAINAN,null], @param37=[NOITAINAN_TINHTHANH_ID,null], @param38=[NOITAINAN_QUANHUYEN_ID,null], @param39=[NOITAINAN_PHUONGXA_ID,null], @param40=[NOITAINAN_DIACHI,null], @param41=[DIADIEMTAINAN_ID,null], @param42=[BOPHANBITHUONG_ID,null], @param43=[MUCDO_ID,null], @param44=[DIENBIENSAUTN_ID,null], @param45=[XUTRISAUTN_ID,null], @param46=[NGUYENNHAN_ID,null], @param47=[NGUYENNHANCHITIET_ID,null], @param48=[ICD_NGUYENNHAN,null], @param49=[NGAYTAO,12/12/2019 3:14:18 PM], @param50=[NGUOITAO_ID,0], @param51=[NGAYCAPNHAT,12/12/2019 3:14:18 PM], @param52=[NGUOICAPNHAT_ID,0], @param53=[BENHANCHUYENKHOA,null], @param54=[CHANDOANVAOVIEN,null], @param55=[CHANDOANRAVIEN,null], @param56=[DIEUTRITUNGAY,null], @param57=[DIEUTRIDENNGAY,null], @param58=[DIENBIENLS,null], @param59=[KQXETNGHIEM,null], @param60=[PHAUTHUAT,null], @param61=[THUTHUAT,null], @param62=[TINHTRANGNGUOIBENH,null], @param63=[HUONGDIEUTRI,null], @param64=[NGUOIGIAO_ID,null], @param65=[NGUOINHAN_ID,null], @param66=[XQUANG,null], @param67=[CTSCANNER,null], @param68=[SIEUAM,null], @param69=[XETNGHIEM,null], @param70=[KHAC,null], @param71=[TOANBOHS,null], @param72=[LOAICHUYENKHOA,null], @param73=[CONGANCANTHIEP,null], @param74=[CDRR_BENHCHINH,null], @param75=[CDRR_BENHKEM,null], @param76=[ICD_BENHCHINH,null], @param77=[ICD_BENHKEMTHEO,null], @param78=[PHUONGPHAPDIEUTRI,null], @param79=[FIELD_1,null], @param80=[FIELD_2,null], @param81=[FIELD_3,null], @param82=[FIELD_4,null], @param83=[FIELD_5,null], @param84=[FIELD_6,null], @param85=[FIELD_7,null], @param86=[FIELD_8,null], @param87=[FIELD_9,null], @param88=[FIELD_10,null], @param89=[FIELD_11,null], @param90=[FIELD_12,null], @param91=[FIELD_13,null], @param92=[FIELD_14,null], @param93=[FIELD_15,null], @param94=[FIELD_27,null], @param95=[FIELD_28,null], @param96=[FIELD_29,null], @param97=[FIELD_30,null], @param98=[FIELD_31,null], @param99=[FIELD_32,null], @param100=[FIELD_33,null], @param101=[FIELD_34,null], @param102=[FIELD_35,null], @param103=[FIELD_36,null], @param104=[FIELD_37,null], @param105=[FIELD_38,null], @param106=[FIELD_39,null], @param107=[FIELD_40,null], @param108=[FIELD_41,null], @param109=[FIELD_42,null], @param110=[FIELD_43,null], @param111=[FIELD_44,null], @param112=[FIELD_45,null], @param113=[FIELD_46,null], @param114=[FIELD_47,null], @param115=[FIELD_48,null], @param116=[FIELD_49,null], @param117=[FIELD_50,null], @param118=[FIELD_51,null], @param119=[FIELD_52,null], @param120=[FIELD_53,null], @param121=[FIELD_54,null], @param122=[FIELD_55,null], @param123=[FIELD_56,null], @param124=[BENHVIEN_ID,HLU01]]
2019-12-12 15:14:18,608 [1] DEBUG - Statement Id: [DAO00080_Add_KhamBenh_CapCuu] Types: [@param0=[System.DBNull, null], @param1=[Int32, System.Int32], @param2=[System.DBNull, null], @param3=[Int32, System.Int32], @param4=[System.DBNull, null], @param5=[System.DBNull, null], @param6=[System.DBNull, null], @param7=[System.DBNull, null], @param8=[DateTime, System.DateTime], @param9=[DateTime, System.DateTime], @param10=[System.DBNull, null], @param11=[System.DBNull, null], @param12=[System.DBNull, null], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[System.DBNull, null], @param22=[String, System.String], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[System.DBNull, null], @param39=[System.DBNull, null], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[DateTime, System.DateTime], @param50=[Int64, System.Int64], @param51=[DateTime, System.DateTime], @param52=[Int64, System.Int64], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[System.DBNull, null], @param59=[System.DBNull, null], @param60=[System.DBNull, null], @param61=[System.DBNull, null], @param62=[System.DBNull, null], @param63=[System.DBNull, null], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[System.DBNull, null], @param71=[System.DBNull, null], @param72=[System.DBNull, null], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null], @param81=[System.DBNull, null], @param82=[System.DBNull, null], @param83=[System.DBNull, null], @param84=[System.DBNull, null], @param85=[System.DBNull, null], @param86=[System.DBNull, null], @param87=[System.DBNull, null], @param88=[System.DBNull, null], @param89=[System.DBNull, null], @param90=[System.DBNull, null], @param91=[System.DBNull, null], @param92=[System.DBNull, null], @param93=[System.DBNull, null], @param94=[System.DBNull, null], @param95=[System.DBNull, null], @param96=[System.DBNull, null], @param97=[System.DBNull, null], @param98=[System.DBNull, null], @param99=[System.DBNull, null], @param100=[System.DBNull, null], @param101=[System.DBNull, null], @param102=[System.DBNull, null], @param103=[System.DBNull, null], @param104=[System.DBNull, null], @param105=[System.DBNull, null], @param106=[System.DBNull, null], @param107=[System.DBNull, null], @param108=[System.DBNull, null], @param109=[System.DBNull, null], @param110=[System.DBNull, null], @param111=[System.DBNull, null], @param112=[System.DBNull, null], @param113=[System.DBNull, null], @param114=[System.DBNull, null], @param115=[System.DBNull, null], @param116=[System.DBNull, null], @param117=[System.DBNull, null], @param118=[System.DBNull, null], @param119=[System.DBNull, null], @param120=[System.DBNull, null], @param121=[System.DBNull, null], @param122=[System.DBNull, null], @param123=[System.DBNull, null], @param124=[String, System.String]]
2019-12-12 15:14:18,702 [1] DEBUG - Statement Id: [DAO00019_Add_TT_TIEPNHAN_SOTHEBHYT] PreparedStatement : [INSERT INTO TT_TIEPNHAN_SOTHEBHYT        (TIEPNHAN_ID        ,BENHNHAN_ID        ,BENHAN_ID        ,DOITUONG_ID        ,SOBHYT        ,BHYTTUNGAY        ,BHYTDENNGAY        ,BHYTNGAYCAP        ,BHYTTREN3NAM        ,BHYTTREN5NAM        ,NGAYMIENDONGCHITRA        ,TRAITUYEN        ,BENHVIEN_ID        ,NOITAO_ID        ,NGAYTAO        ,NGUOITAO_ID        ,NGAYCAPNHAT        ,NGUOICAPNHAT_ID        ,TYLE_VUOT_LCB        ,TYLE_TRAITUYEN        ,GIOIHAN_VUOT_LCB        ,LUONG_COSO        ,TYLE_THUOC_UT        ,MADOITUONG)        VALUES        ( @param0         , @param1         , @param2         , @param3         , @param4         , @param5         , @param6         , @param7         , @param8         , @param9         , @param10         , @param11         , @param12         , @param13         , @param14         , @param15         , @param16         , @param17         , @param18         , @param19         , @param20         , @param21         , @param22         , @param23 )]
2019-12-12 15:14:18,702 [1] DEBUG - Statement Id: [DAO00019_Add_TT_TIEPNHAN_SOTHEBHYT] Parameters: [@param0=[TIEPNHAN_ID,28491], @param1=[BENHNHAN_ID,24429], @param2=[BENHAN_ID,null], @param3=[DOITUONG_ID,1], @param4=[SOBHYT,null], @param5=[BHYTTUNGAY,null], @param6=[BHYTDENNGAY,null], @param7=[BHYTNGAYCAP,null], @param8=[BHYTTREN3NAM,0], @param9=[BHYTTREN5NAM,0], @param10=[NGAYMIENDONGCHITRA,null], @param11=[TRAITUYEN,0], @param12=[BENHVIEN_ID,HLU01], @param13=[NOITAO_ID,68], @param14=[NGAYTAO,12/12/2019 3:14:18 PM], @param15=[NGUOITAO_ID,0], @param16=[NGAYCAPNHAT,12/12/2019 3:14:18 PM], @param17=[NGUOICAPNHAT_ID,0], @param18=[TYLE_VUOT_LCB,null], @param19=[TYLE_TRAITUYEN,null], @param20=[GIOIHAN_VUOT_LCB,null], @param21=[LUONG_COSO,null], @param22=[TYLE_THUOC_UT,null], @param23=[MADOITUONG,null]]
2019-12-12 15:14:18,703 [1] DEBUG - Statement Id: [DAO00019_Add_TT_TIEPNHAN_SOTHEBHYT] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[System.DBNull, null], @param3=[Int64, System.Int64], @param4=[System.DBNull, null], @param5=[System.DBNull, null], @param6=[System.DBNull, null], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[String, System.String], @param10=[System.DBNull, null], @param11=[String, System.String], @param12=[String, System.String], @param13=[String, System.String], @param14=[DateTime, System.DateTime], @param15=[Int64, System.Int64], @param16=[DateTime, System.DateTime], @param17=[Int64, System.Int64], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[System.DBNull, null], @param22=[System.DBNull, null], @param23=[System.DBNull, null]]
2019-12-12 15:14:18,746 [1] DEBUG - Statement Id: [DAO00027_GetListTiepNhanAllCOM30] PreparedStatement : [select distinct A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, isnull(C.SOBENHAN,NULL) as SOBENHAN,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI, A.SOBHYT, CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYTIEPNHAN,        B.*        , A.UUTIEN        from TT_TIEPNHAN A        inner join (select * from TT_BENHNHAN where MAYTE = '190043309' and ACTIVE = '1') B on B.BENHNHAN_ID = A.BENHNHAN_ID  and B.ACTIVE = '1'        left join TT_NOITRU_BENHAN C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        where A.TIEPNHAN_ID = '28491' and A.BENHVIEN_ID = 'HLU01' and (A.TRANGTHAI not in ('HUY','CAPCUU', 'NOITRU', 'NGOAITRU'))]
2019-12-12 15:14:19,345 [1] DEBUG - Statement Id: [DAOWF001_LaythongtinProcess] PreparedStatement : [select * from TM_PROCESS        where        PROCESS_CODE = 'P01']
2019-12-12 15:14:19,505 [1] DEBUG - Statement Id: [DAOWF001_Kiemtrathongtindayeucau] PreparedStatement : [select * from TT_REQUEST        where        PROCESS_CODE = 'P01'        AND PARA = '{"HOSPITAL_ID":"HLU01","SOTIEPNHAN":"TN191212.0000001"}'        AND CURR_STATE_CODE = '6'        AND ISACTIVE = '1']
2019-12-12 15:14:19,597 [1] DEBUG - Statement Id: [DAOWF002_Add] PreparedStatement : [DECLARE @IDRequestOld int        DECLARE @IDRequestNew int        select top 1 @IDRequestOld = ID from TT_REQUEST where PARA =  @param0  order by ID desc          insert into TT_REQUEST (        PROCESS_CODE        , PARA        , CURR_STATE_CODE        ) values (         @param1         ,  @param0         ,  @param2         )        SELECT @IDRequestNew = SCOPE_IDENTITY()        if (@IDRequestOld is not null)        begin        update TT_REQUEST_SERVICE set REQUEST_ID = @IDRequestNew, PROCESS_CODE =  @param1  where REQUEST_ID = @IDRequestOld        update TT_REQUEST set ISACTIVE = '0' where ID = @IDRequestOld        update TT_REQUEST_SERVICE_DETAIL set REQUEST_ID = @IDRequestNew where REQUEST_ID = @IDRequestOld        end          select @IDRequestNew]
2019-12-12 15:14:19,597 [1] DEBUG - Statement Id: [DAOWF002_Add] Parameters: [@param0=[PARA,{"HOSPITAL_ID":"HLU01","SOTIEPNHAN":"TN191212.0000001"}], @param1=[PROCESS_CODE,P01], @param2=[CURR_STATE_CODE,6]]
2019-12-12 15:14:19,597 [1] DEBUG - Statement Id: [DAOWF002_Add] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[String, System.String]]
2019-12-12 15:14:20,052 [1] DEBUG - Statement Id: [DAO00064_GetREGListVienphiTiepNhan] PreparedStatement : [select A.*, B.THUTIENSAU        from TT_VIENPHI A        left join TT_DVYEUCAU B on A.REF_ID =  B.DVYEUCAU_ID and A.REF_TABLE = 'TT_DVYEUCAU' and B.HUYYEUCAU = '0'        where        A.TIEPNHAN_ID = '28491' and A.BENHVIEN_ID = 'HLU01' and (A.BENHAN_ID is NULL or A.BENHAN_ID = '')        and A.HUY = '0'        ORDER BY A.VIENPHI_ID]
2019-12-12 15:14:20,111 [1] DEBUG - Statement Id: [DAOLOG01_LockEnd] PreparedStatement : [DELETE TT_LOG_UPDATE        where REF_TABLE = 'TT_TIEPNHAN_BENHAN' and REF_ID = '24429' and BENHVIEN_ID = 'HLU01']
2019-12-12 15:14:20,138 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-12-12 15:14:20,138 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,28491], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,24430], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,5438], @param8=[BACSICHIDINH_ID,32], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,12/12/2019 12:00:00 AM], @param11=[THANGYEUCAU,12], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,12/12/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,68], @param16=[NOITHUCHIEN_ID,64], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,4], @param50=[HOPDONG_BENHNHAN_ID,315], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,12/12/2019 3:10:01 PM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-12-12 15:14:20,138 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[Int64, System.Int64], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-12-12 15:14:20,211 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28491' and C.DICHVU_ID = '5438' and A.BENHVIEN_ID = 'HLU01']
2019-12-12 15:14:20,882 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28491' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-12-12 15:14:21,455 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '28491']
2019-12-12 15:14:21,871 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-12-12 15:14:21,871 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,28491], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,24430], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,206508], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,5438], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,3], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,188500], @param12=[THANHTIEN_DOANHTHU,188500], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,188500], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,188500], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,12/12/2019 3:10:01 PM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,12/12/2019 3:10:01 PM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-12-12 15:14:21,871 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-12-12 15:14:21,918 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 118          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 315]
2019-12-12 15:14:21,918 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,28491], @param1=[DVYEUCAU_ID,206508], @param2=[VIENPHI_ID,675796], @param3=[SOPHIEUYEUCAU,19..045254], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,12/12/2019 3:14:21 PM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-12-12 15:14:21,918 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-12-12 15:14:21,953 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-12-12 15:14:21,953 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,28491], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,24430], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,4129], @param8=[BACSICHIDINH_ID,32], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,12/12/2019 12:00:00 AM], @param11=[THANGYEUCAU,12], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,12/12/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,68], @param16=[NOITHUCHIEN_ID,79], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,4], @param50=[HOPDONG_BENHNHAN_ID,315], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,12/12/2019 3:10:01 PM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-12-12 15:14:21,953 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[Int64, System.Int64], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-12-12 15:14:22,021 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28491' and C.DICHVU_ID = '4129' and A.BENHVIEN_ID = 'HLU01']
2019-12-12 15:14:22,562 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28491' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-12-12 15:14:23,817 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '28491']
2019-12-12 15:14:25,293 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-12-12 15:14:25,293 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,28491], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,24430], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,206509], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,4129], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,3], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,263900], @param12=[THANHTIEN_DOANHTHU,263900], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,263900], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,263900], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,12/12/2019 3:10:01 PM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,12/12/2019 3:10:01 PM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-12-12 15:14:25,293 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-12-12 15:14:25,332 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 119          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 315]
2019-12-12 15:14:25,332 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,28491], @param1=[DVYEUCAU_ID,206509], @param2=[VIENPHI_ID,675797], @param3=[SOPHIEUYEUCAU,19..045255], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,12/12/2019 3:14:25 PM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-12-12 15:14:25,332 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-12-12 15:14:25,373 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-12-12 15:14:25,373 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,28491], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,24430], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,5435], @param8=[BACSICHIDINH_ID,32], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,12/12/2019 12:00:00 AM], @param11=[THANGYEUCAU,12], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,12/12/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,68], @param16=[NOITHUCHIEN_ID,177], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,4], @param50=[HOPDONG_BENHNHAN_ID,315], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,12/12/2019 3:10:01 PM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-12-12 15:14:25,374 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[Int64, System.Int64], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-12-12 15:14:25,446 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28491' and C.DICHVU_ID = '5435' and A.BENHVIEN_ID = 'HLU01']
2019-12-12 15:14:25,740 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28491' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-12-12 15:14:26,638 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '28491']
2019-12-12 15:14:27,715 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-12-12 15:14:27,716 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,28491], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,24430], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,206510], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,5435], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,3], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,188500], @param12=[THANHTIEN_DOANHTHU,188500], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,188500], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,188500], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,12/12/2019 3:10:01 PM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,12/12/2019 3:10:01 PM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-12-12 15:14:27,716 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-12-12 15:14:27,747 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 120          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 315]
2019-12-12 15:14:27,747 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,28491], @param1=[DVYEUCAU_ID,206510], @param2=[VIENPHI_ID,675798], @param3=[SOPHIEUYEUCAU,19..045256], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,12/12/2019 3:14:27 PM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-12-12 15:14:27,747 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-12-12 15:14:27,782 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-12-12 15:14:27,783 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,28491], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,24430], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,4017], @param8=[BACSICHIDINH_ID,32], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,12/12/2019 12:00:00 AM], @param11=[THANGYEUCAU,12], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,12/12/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,68], @param16=[NOITHUCHIEN_ID,91], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,4], @param50=[HOPDONG_BENHNHAN_ID,315], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,12/12/2019 3:10:01 PM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-12-12 15:14:27,783 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[Int64, System.Int64], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-12-12 15:14:27,826 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28491' and C.DICHVU_ID = '4017' and A.BENHVIEN_ID = 'HLU01']
2019-12-12 15:14:28,304 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28491' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-12-12 15:14:31,165 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '28491']
2019-12-12 15:14:32,647 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-12-12 15:14:32,647 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,28491], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,24430], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,206511], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,4017], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,3], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,188500], @param12=[THANHTIEN_DOANHTHU,188500], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,188500], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,188500], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,12/12/2019 3:10:01 PM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,12/12/2019 3:10:01 PM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-12-12 15:14:32,647 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-12-12 15:14:32,713 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 121          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 315]
2019-12-12 15:14:32,713 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,28491], @param1=[DVYEUCAU_ID,206511], @param2=[VIENPHI_ID,675799], @param3=[SOPHIEUYEUCAU,19..045257], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,12/12/2019 3:14:32 PM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-12-12 15:14:32,714 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-12-12 15:14:32,876 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-12-12 15:14:32,876 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,28491], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,24430], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,4523], @param8=[BACSICHIDINH_ID,32], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,12/12/2019 12:00:00 AM], @param11=[THANGYEUCAU,12], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,12/12/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,68], @param16=[NOITHUCHIEN_ID,104], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,4], @param50=[HOPDONG_BENHNHAN_ID,315], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,12/12/2019 3:10:01 PM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-12-12 15:14:32,876 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[Int64, System.Int64], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-12-12 15:14:33,036 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28491' and C.DICHVU_ID = '4523' and A.BENHVIEN_ID = 'HLU01']
2019-12-12 15:14:33,506 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28491' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-12-12 15:14:35,566 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '28491']
2019-12-12 15:14:37,426 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-12-12 15:14:37,426 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,28491], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,24430], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,206512], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,4523], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,3], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,170600], @param12=[THANHTIEN_DOANHTHU,170600], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,170600], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,170600], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,12/12/2019 3:10:01 PM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,12/12/2019 3:10:01 PM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-12-12 15:14:37,426 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-12-12 15:14:37,461 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 122          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 315]
2019-12-12 15:14:37,461 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,28491], @param1=[DVYEUCAU_ID,206512], @param2=[VIENPHI_ID,675800], @param3=[SOPHIEUYEUCAU,19..045258], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,12/12/2019 3:14:37 PM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-12-12 15:14:37,461 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-12-12 15:14:37,561 [1] DEBUG - Statement Id: [DAO00307_GetPatientConfirms] PreparedStatement : [select distinct HD_BN.*        , CASE WHEN HD_BN.GIOITINH = '1' THEN N'Nam' ELSE N'Nữ' END AS GENDER        , CASE WHEN HD_DV.ACTIVE IS NULL THEN 0 ELSE 1 END BENHNHAN_DANGKYKSK_DICHVU        , case when HD_BN.GOI_ID is null then N'Hợp đồng:' + ' ' + HD.SO_HD else N'Gói khám:' + ' ' + G.TENGOI end as DOITUONG        , LST.DICTIONARY_NAME as HONNHAN        from TT_KSK_HOPDONG HD        inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        left join LST_DICTIONARY LST ON LST.DICTIONARY_ID = HD_BN.TINHTRANGHONNHAN_ID AND LST.DICTIONARY_TYPE_CODE = 'TinhTrangGiaDinh'        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        left join TT_TIEPNHAN TN on TN.TIEPNHAN_ID = HD_DV.TIEPNHAN_ID        left join TM_CSKH_GOI G ON G.GOI_ID = HD_BN.GOI_ID        where HD.HOPDONG_ID = '4'         AND           HD.BENHVIEN_ID = 'HLU01'                 order by HD_BN.STT]
2019-12-12 15:14:37,623 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , ISNULL(NTH.TENPHONGBAN, PB.TENPHONGBAN) as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , ISNULL(NTH.PHONGBAN_ID, PB.PHONGBAN_ID) as NOITHUCHIEN_ID        , BS.NHANVIEN_ID AS BACSICHIDINH_ID, BS.TENNHANVIEN AS TENBACSICHIDINH        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        LEFT JOIN TM_PHONGBAN NTH ON NTH.PHONGBAN_ID = G_CT.NOITHUCHIEN_ID        LEFT JOIN TM_NHANVIEN BS ON BS.NHANVIEN_ID = G_CT.BACSICHIDINH_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '314'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-12 15:14:37,941 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , ISNULL(NTH.TENPHONGBAN, PB.TENPHONGBAN) as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , ISNULL(NTH.PHONGBAN_ID, PB.PHONGBAN_ID) as NOITHUCHIEN_ID        , BS.NHANVIEN_ID AS BACSICHIDINH_ID, BS.TENNHANVIEN AS TENBACSICHIDINH        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        LEFT JOIN TM_PHONGBAN NTH ON NTH.PHONGBAN_ID = G_CT.NOITHUCHIEN_ID        LEFT JOIN TM_NHANVIEN BS ON BS.NHANVIEN_ID = G_CT.BACSICHIDINH_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '313'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-12 15:14:41,238 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , ISNULL(NTH.TENPHONGBAN, PB.TENPHONGBAN) as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , ISNULL(NTH.PHONGBAN_ID, PB.PHONGBAN_ID) as NOITHUCHIEN_ID        , BS.NHANVIEN_ID AS BACSICHIDINH_ID, BS.TENNHANVIEN AS TENBACSICHIDINH        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        LEFT JOIN TM_PHONGBAN NTH ON NTH.PHONGBAN_ID = G_CT.NOITHUCHIEN_ID        LEFT JOIN TM_NHANVIEN BS ON BS.NHANVIEN_ID = G_CT.BACSICHIDINH_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '314'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-12 15:14:42,878 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , ISNULL(NTH.TENPHONGBAN, PB.TENPHONGBAN) as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , ISNULL(NTH.PHONGBAN_ID, PB.PHONGBAN_ID) as NOITHUCHIEN_ID        , BS.NHANVIEN_ID AS BACSICHIDINH_ID, BS.TENNHANVIEN AS TENBACSICHIDINH        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        LEFT JOIN TM_PHONGBAN NTH ON NTH.PHONGBAN_ID = G_CT.NOITHUCHIEN_ID        LEFT JOIN TM_NHANVIEN BS ON BS.NHANVIEN_ID = G_CT.BACSICHIDINH_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '316'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-12 15:14:45,457 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , ISNULL(NTH.TENPHONGBAN, PB.TENPHONGBAN) as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , ISNULL(NTH.PHONGBAN_ID, PB.PHONGBAN_ID) as NOITHUCHIEN_ID        , BS.NHANVIEN_ID AS BACSICHIDINH_ID, BS.TENNHANVIEN AS TENBACSICHIDINH        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        LEFT JOIN TM_PHONGBAN NTH ON NTH.PHONGBAN_ID = G_CT.NOITHUCHIEN_ID        LEFT JOIN TM_NHANVIEN BS ON BS.NHANVIEN_ID = G_CT.BACSICHIDINH_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '314'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-12 15:14:47,534 [1] DEBUG - Statement Id: [DAO00308_GetTiepNhanID] PreparedStatement : [select top 1 TN.TIEPNHAN_ID, TN.SOTIEPNHAN        from TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV        inner join TT_TIEPNHAN TN on TN.TIEPNHAN_ID = HD_DV.TIEPNHAN_ID        where HD_DV.HOPDONG_BENHNHAN_ID = 315 and HD_DV.HOPDONG_ID = 4]
2019-12-12 15:14:47,643 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , ISNULL(NTH.TENPHONGBAN, PB.TENPHONGBAN) as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , ISNULL(NTH.PHONGBAN_ID, PB.PHONGBAN_ID) as NOITHUCHIEN_ID        , BS.NHANVIEN_ID AS BACSICHIDINH_ID, BS.TENNHANVIEN AS TENBACSICHIDINH        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        LEFT JOIN TM_PHONGBAN NTH ON NTH.PHONGBAN_ID = G_CT.NOITHUCHIEN_ID        LEFT JOIN TM_NHANVIEN BS ON BS.NHANVIEN_ID = G_CT.BACSICHIDINH_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '315'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-12 15:14:48,444 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , ISNULL(NTH.TENPHONGBAN, PB.TENPHONGBAN) as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , ISNULL(NTH.PHONGBAN_ID, PB.PHONGBAN_ID) as NOITHUCHIEN_ID        , BS.NHANVIEN_ID AS BACSICHIDINH_ID, BS.TENNHANVIEN AS TENBACSICHIDINH        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        LEFT JOIN TM_PHONGBAN NTH ON NTH.PHONGBAN_ID = G_CT.NOITHUCHIEN_ID        LEFT JOIN TM_NHANVIEN BS ON BS.NHANVIEN_ID = G_CT.BACSICHIDINH_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '314'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-12 15:15:57,425 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , ISNULL(NTH.TENPHONGBAN, PB.TENPHONGBAN) as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , ISNULL(NTH.PHONGBAN_ID, PB.PHONGBAN_ID) as NOITHUCHIEN_ID        , BS.NHANVIEN_ID AS BACSICHIDINH_ID, BS.TENNHANVIEN AS TENBACSICHIDINH        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        LEFT JOIN TM_PHONGBAN NTH ON NTH.PHONGBAN_ID = G_CT.NOITHUCHIEN_ID        LEFT JOIN TM_NHANVIEN BS ON BS.NHANVIEN_ID = G_CT.BACSICHIDINH_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '313'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-12 15:15:58,566 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , ISNULL(NTH.TENPHONGBAN, PB.TENPHONGBAN) as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , ISNULL(NTH.PHONGBAN_ID, PB.PHONGBAN_ID) as NOITHUCHIEN_ID        , BS.NHANVIEN_ID AS BACSICHIDINH_ID, BS.TENNHANVIEN AS TENBACSICHIDINH        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        LEFT JOIN TM_PHONGBAN NTH ON NTH.PHONGBAN_ID = G_CT.NOITHUCHIEN_ID        LEFT JOIN TM_NHANVIEN BS ON BS.NHANVIEN_ID = G_CT.BACSICHIDINH_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '314'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-12 15:16:23,263 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , ISNULL(NTH.TENPHONGBAN, PB.TENPHONGBAN) as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , ISNULL(NTH.PHONGBAN_ID, PB.PHONGBAN_ID) as NOITHUCHIEN_ID        , BS.NHANVIEN_ID AS BACSICHIDINH_ID, BS.TENNHANVIEN AS TENBACSICHIDINH        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        LEFT JOIN TM_PHONGBAN NTH ON NTH.PHONGBAN_ID = G_CT.NOITHUCHIEN_ID        LEFT JOIN TM_NHANVIEN BS ON BS.NHANVIEN_ID = G_CT.BACSICHIDINH_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '313'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-12 15:16:44,023 [1] DEBUG - Statement Id: [DAO00307_CheckSingin] PreparedStatement : [select *        from TT_KSK_HOPDONG_BENHNHAN_DICHVU         where                 HOPDONG_ID = 4             and               HOPDONG_BENHNHAN_ID = 313             and               BENHVIEN_ID = 'HLU01']
2019-12-12 15:16:48,915 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhanDichVu] PreparedStatement : [SELECT distinct HD_BN.HOPDONG_ID, DV.TENDICHVU, ISNULL(NTH.TENPHONGBAN, PB.TENPHONGBAN) AS NOITHUCHIEN, NDV.TENNHOMDICHVU, ISNULL(GOI_CT.NOITHUCHIEN_ID, PB.PHONGBAN_ID) AS PHONGBAN_ID, DV.DICHVU_ID        , ISNULL(GOI_CT.DONGIATRONGGOI,0) AS DONGIA, ISNULL(GOI_CT.SOLAN,0) AS SOLUONG, GOI_CT.THANHTIENTRONGGOI AS THANHTIEN, BS.NHANVIEN_ID AS BACSICHIDINH_ID, BS.TENNHANVIEN AS TENBACSICHIDINH        , CASE WHEN DV.DICHVU_ID IN (SELECT DICHVU_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU WHERE HOPDONG_ID = '4' AND HOPDONG_BENHNHAN_ID = '317') THEN 1 ELSE 0 END AS DANGKY        FROM TT_KSK_HOPDONG HD                inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        INNER JOIN TM_CSKH_GOI_CHITIET GOI_CT ON GOI_CT.GOI_ID = HD_BN.GOI_ID        INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = GOI_CT.DICHVU_ID        LEFT JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        INNER JOIN TM_PHONGBAN_DICHVU PB_DV ON PB_DV.DICHVU_ID = DV.DICHVU_ID        LEFT JOIN TM_PHONGBAN PB ON PB.PHONGBAN_ID = PB_DV.PHONGBAN_ID        LEFT JOIN TM_PHONGBAN NTH ON NTH.PHONGBAN_ID = GOI_CT.NOITHUCHIEN_ID        LEFT JOIN TM_NHANVIEN BS ON BS.NHANVIEN_ID = GOI_CT.BACSICHIDINH_ID        WHERE GOI_CT.GOI_ID = 4 and HD_BN.HOPDONG_BENHNHAN_ID = 317        and PB_DV.PHONGBAN_ID =(select top 1 PHONGBAN_ID from TM_PHONGBAN_DICHVU where DICHVU_ID = DV.DICHVU_ID)]
2019-12-12 15:16:50,819 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhanDichVu] PreparedStatement : [SELECT distinct HD_BN.HOPDONG_ID, DV.TENDICHVU, ISNULL(NTH.TENPHONGBAN, PB.TENPHONGBAN) AS NOITHUCHIEN, NDV.TENNHOMDICHVU, ISNULL(GOI_CT.NOITHUCHIEN_ID, PB.PHONGBAN_ID) AS PHONGBAN_ID, DV.DICHVU_ID        , ISNULL(GOI_CT.DONGIATRONGGOI,0) AS DONGIA, ISNULL(GOI_CT.SOLAN,0) AS SOLUONG, GOI_CT.THANHTIENTRONGGOI AS THANHTIEN, BS.NHANVIEN_ID AS BACSICHIDINH_ID, BS.TENNHANVIEN AS TENBACSICHIDINH        , CASE WHEN DV.DICHVU_ID IN (SELECT DICHVU_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU WHERE HOPDONG_ID = '4' AND HOPDONG_BENHNHAN_ID = '318') THEN 1 ELSE 0 END AS DANGKY        FROM TT_KSK_HOPDONG HD                inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        INNER JOIN TM_CSKH_GOI_CHITIET GOI_CT ON GOI_CT.GOI_ID = HD_BN.GOI_ID        INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = GOI_CT.DICHVU_ID        LEFT JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        INNER JOIN TM_PHONGBAN_DICHVU PB_DV ON PB_DV.DICHVU_ID = DV.DICHVU_ID        LEFT JOIN TM_PHONGBAN PB ON PB.PHONGBAN_ID = PB_DV.PHONGBAN_ID        LEFT JOIN TM_PHONGBAN NTH ON NTH.PHONGBAN_ID = GOI_CT.NOITHUCHIEN_ID        LEFT JOIN TM_NHANVIEN BS ON BS.NHANVIEN_ID = GOI_CT.BACSICHIDINH_ID        WHERE GOI_CT.GOI_ID = 4 and HD_BN.HOPDONG_BENHNHAN_ID = 318        and PB_DV.PHONGBAN_ID =(select top 1 PHONGBAN_ID from TM_PHONGBAN_DICHVU where DICHVU_ID = DV.DICHVU_ID)]
2019-12-12 15:16:54,274 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhanDichVu] PreparedStatement : [SELECT distinct HD_BN.HOPDONG_ID, DV.TENDICHVU, ISNULL(NTH.TENPHONGBAN, PB.TENPHONGBAN) AS NOITHUCHIEN, NDV.TENNHOMDICHVU, ISNULL(GOI_CT.NOITHUCHIEN_ID, PB.PHONGBAN_ID) AS PHONGBAN_ID, DV.DICHVU_ID        , ISNULL(GOI_CT.DONGIATRONGGOI,0) AS DONGIA, ISNULL(GOI_CT.SOLAN,0) AS SOLUONG, GOI_CT.THANHTIENTRONGGOI AS THANHTIEN, BS.NHANVIEN_ID AS BACSICHIDINH_ID, BS.TENNHANVIEN AS TENBACSICHIDINH        , CASE WHEN DV.DICHVU_ID IN (SELECT DICHVU_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU WHERE HOPDONG_ID = '4' AND HOPDONG_BENHNHAN_ID = '317') THEN 1 ELSE 0 END AS DANGKY        FROM TT_KSK_HOPDONG HD                inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        INNER JOIN TM_CSKH_GOI_CHITIET GOI_CT ON GOI_CT.GOI_ID = HD_BN.GOI_ID        INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = GOI_CT.DICHVU_ID        LEFT JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        INNER JOIN TM_PHONGBAN_DICHVU PB_DV ON PB_DV.DICHVU_ID = DV.DICHVU_ID        LEFT JOIN TM_PHONGBAN PB ON PB.PHONGBAN_ID = PB_DV.PHONGBAN_ID        LEFT JOIN TM_PHONGBAN NTH ON NTH.PHONGBAN_ID = GOI_CT.NOITHUCHIEN_ID        LEFT JOIN TM_NHANVIEN BS ON BS.NHANVIEN_ID = GOI_CT.BACSICHIDINH_ID        WHERE GOI_CT.GOI_ID = 4 and HD_BN.HOPDONG_BENHNHAN_ID = 317        and PB_DV.PHONGBAN_ID =(select top 1 PHONGBAN_ID from TM_PHONGBAN_DICHVU where DICHVU_ID = DV.DICHVU_ID)]
2019-12-12 15:16:58,389 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhanDichVu] PreparedStatement : [SELECT distinct HD_BN.HOPDONG_ID, DV.TENDICHVU, ISNULL(NTH.TENPHONGBAN, PB.TENPHONGBAN) AS NOITHUCHIEN, NDV.TENNHOMDICHVU, ISNULL(GOI_CT.NOITHUCHIEN_ID, PB.PHONGBAN_ID) AS PHONGBAN_ID, DV.DICHVU_ID        , ISNULL(GOI_CT.DONGIATRONGGOI,0) AS DONGIA, ISNULL(GOI_CT.SOLAN,0) AS SOLUONG, GOI_CT.THANHTIENTRONGGOI AS THANHTIEN, BS.NHANVIEN_ID AS BACSICHIDINH_ID, BS.TENNHANVIEN AS TENBACSICHIDINH        , CASE WHEN DV.DICHVU_ID IN (SELECT DICHVU_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU WHERE HOPDONG_ID = '4' AND HOPDONG_BENHNHAN_ID = '318') THEN 1 ELSE 0 END AS DANGKY        FROM TT_KSK_HOPDONG HD                inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        INNER JOIN TM_CSKH_GOI_CHITIET GOI_CT ON GOI_CT.GOI_ID = HD_BN.GOI_ID        INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = GOI_CT.DICHVU_ID        LEFT JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        INNER JOIN TM_PHONGBAN_DICHVU PB_DV ON PB_DV.DICHVU_ID = DV.DICHVU_ID        LEFT JOIN TM_PHONGBAN PB ON PB.PHONGBAN_ID = PB_DV.PHONGBAN_ID        LEFT JOIN TM_PHONGBAN NTH ON NTH.PHONGBAN_ID = GOI_CT.NOITHUCHIEN_ID        LEFT JOIN TM_NHANVIEN BS ON BS.NHANVIEN_ID = GOI_CT.BACSICHIDINH_ID        WHERE GOI_CT.GOI_ID = 4 and HD_BN.HOPDONG_BENHNHAN_ID = 318        and PB_DV.PHONGBAN_ID =(select top 1 PHONGBAN_ID from TM_PHONGBAN_DICHVU where DICHVU_ID = DV.DICHVU_ID)]
2019-12-12 15:17:07,443 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhanDichVu] PreparedStatement : [SELECT distinct HD_BN.HOPDONG_ID, DV.TENDICHVU, ISNULL(NTH.TENPHONGBAN, PB.TENPHONGBAN) AS NOITHUCHIEN, NDV.TENNHOMDICHVU, ISNULL(GOI_CT.NOITHUCHIEN_ID, PB.PHONGBAN_ID) AS PHONGBAN_ID, DV.DICHVU_ID        , ISNULL(GOI_CT.DONGIATRONGGOI,0) AS DONGIA, ISNULL(GOI_CT.SOLAN,0) AS SOLUONG, GOI_CT.THANHTIENTRONGGOI AS THANHTIEN, BS.NHANVIEN_ID AS BACSICHIDINH_ID, BS.TENNHANVIEN AS TENBACSICHIDINH        , CASE WHEN DV.DICHVU_ID IN (SELECT DICHVU_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU WHERE HOPDONG_ID = '4' AND HOPDONG_BENHNHAN_ID = '317') THEN 1 ELSE 0 END AS DANGKY        FROM TT_KSK_HOPDONG HD                inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        INNER JOIN TM_CSKH_GOI_CHITIET GOI_CT ON GOI_CT.GOI_ID = HD_BN.GOI_ID        INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = GOI_CT.DICHVU_ID        LEFT JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        INNER JOIN TM_PHONGBAN_DICHVU PB_DV ON PB_DV.DICHVU_ID = DV.DICHVU_ID        LEFT JOIN TM_PHONGBAN PB ON PB.PHONGBAN_ID = PB_DV.PHONGBAN_ID        LEFT JOIN TM_PHONGBAN NTH ON NTH.PHONGBAN_ID = GOI_CT.NOITHUCHIEN_ID        LEFT JOIN TM_NHANVIEN BS ON BS.NHANVIEN_ID = GOI_CT.BACSICHIDINH_ID        WHERE GOI_CT.GOI_ID = 4 and HD_BN.HOPDONG_BENHNHAN_ID = 317        and PB_DV.PHONGBAN_ID =(select top 1 PHONGBAN_ID from TM_PHONGBAN_DICHVU where DICHVU_ID = DV.DICHVU_ID)]
2019-12-12 15:17:34,544 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhanDichVu] PreparedStatement : [SELECT distinct HD_BN.HOPDONG_ID, DV.TENDICHVU, ISNULL(NTH.TENPHONGBAN, PB.TENPHONGBAN) AS NOITHUCHIEN, NDV.TENNHOMDICHVU, ISNULL(GOI_CT.NOITHUCHIEN_ID, PB.PHONGBAN_ID) AS PHONGBAN_ID, DV.DICHVU_ID        , ISNULL(GOI_CT.DONGIATRONGGOI,0) AS DONGIA, ISNULL(GOI_CT.SOLAN,0) AS SOLUONG, GOI_CT.THANHTIENTRONGGOI AS THANHTIEN, BS.NHANVIEN_ID AS BACSICHIDINH_ID, BS.TENNHANVIEN AS TENBACSICHIDINH        , CASE WHEN DV.DICHVU_ID IN (SELECT DICHVU_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU WHERE HOPDONG_ID = '4' AND HOPDONG_BENHNHAN_ID = '320') THEN 1 ELSE 0 END AS DANGKY        FROM TT_KSK_HOPDONG HD                inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        INNER JOIN TM_CSKH_GOI_CHITIET GOI_CT ON GOI_CT.GOI_ID = HD_BN.GOI_ID        INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = GOI_CT.DICHVU_ID        LEFT JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        INNER JOIN TM_PHONGBAN_DICHVU PB_DV ON PB_DV.DICHVU_ID = DV.DICHVU_ID        LEFT JOIN TM_PHONGBAN PB ON PB.PHONGBAN_ID = PB_DV.PHONGBAN_ID        LEFT JOIN TM_PHONGBAN NTH ON NTH.PHONGBAN_ID = GOI_CT.NOITHUCHIEN_ID        LEFT JOIN TM_NHANVIEN BS ON BS.NHANVIEN_ID = GOI_CT.BACSICHIDINH_ID        WHERE GOI_CT.GOI_ID = 4 and HD_BN.HOPDONG_BENHNHAN_ID = 320        and PB_DV.PHONGBAN_ID =(select top 1 PHONGBAN_ID from TM_PHONGBAN_DICHVU where DICHVU_ID = DV.DICHVU_ID)]
--------------------------------------------------------------------------------
2019-12-12 15:21:57,128 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2019-12-12 15:21:57,409 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-12-12 15:21:57,449 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-12-12 15:21:57,830 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 15:21:58,647 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-12-12 15:22:03,705 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2019-12-12 15:22:03,736 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-12-12 15:22:05,443 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-12-12 15:22:05,573 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-12-12 15:22:06,365 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2019-12-12 15:22:06,509 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2019-12-12 15:22:06,592 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2019-12-12 15:22:06,671 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2019-12-12 15:22:06,749 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2019-12-12 15:22:06,827 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2019-12-12 15:22:06,901 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2019-12-12 15:22:06,982 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2019-12-12 15:22:07,067 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2019-12-12 15:22:07,572 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2019-12-12 15:22:07,612 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2019-12-12 15:22:07,680 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2019-12-12 15:22:07,714 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2019-12-12 15:22:08,791 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2019-12-12 15:22:08,825 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @NGUONDUOC_MACDINH varchar(5) = '0';        declare @TOAMUANGOAI int = 0;        select @NGUONDUOC_MACDINH = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'PHA_NGUONDUOC'        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + @NGUONDUOC_MACDINH as DUOC_KEY, 0 as PHAMVI_ID, @NGUONDUOC_MACDINH as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end        else        begin                  select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2019-12-12 15:22:10,810 [5] DEBUG - Statement Id: [DAO00320_GetList] PreparedStatement : [select M.*            from TM_MAU M            LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID            where            M.TAMNGUNG = '0'            and M.BENHVIEN_ID = 'HLU01'            order by M.TENMAU]
2019-12-12 15:22:10,873 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2019-12-12 15:22:10,906 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,        SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH        FROM TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID        WHERE TK.SOLUONG > 0        GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2019-12-12 15:22:10,979 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2019-12-12 15:22:11,014 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,        TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,        TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH        from TM_MAU M        JOIN        (        select        A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO        from        (        select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO        from TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'        where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0        ) A        )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2019-12-12 15:22:11,080 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2019-12-12 15:22:12,001 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 15:22:12,886 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2019-12-12 15:22:17,838 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2019-12-12 15:22:17,868 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2019-12-12 15:22:17,945 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 15:22:18,069 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 15:22:18,219 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2019-12-12 15:22:18,222 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-12-12 15:22:18,222 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-12-12 15:22:18,250 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2019-12-12 15:22:18,251 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-12-12 15:22:18,251 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-12-12 15:22:18,393 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 15:22:18,550 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 15:22:25,859 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 15:22:25,950 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2019-12-12 15:22:26,199 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2019-12-12 15:22:31,287 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'HSM08'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 15:22:32,386 [1] DEBUG - Statement Id: [DAO00307_GetContractWithDate] PreparedStatement : [SELECT HD.*, HD.SO_HD + ' - ' + CT.TENCONGTY AS HOPDONG, CT.TENCONGTY        FROM TT_KSK_HOPDONG HD JOIN TT_KSK_CONGTY CT ON CT.CONGTY_ID = HD.CONGTY_ID         where                 HD.BENHVIEN_ID = 'HLU01']
2019-12-12 15:22:33,081 [1] DEBUG - Statement Id: [DAO00307_GetContractWithDate] PreparedStatement : [SELECT HD.*, HD.SO_HD + ' - ' + CT.TENCONGTY AS HOPDONG, CT.TENCONGTY        FROM TT_KSK_HOPDONG HD JOIN TT_KSK_CONGTY CT ON CT.CONGTY_ID = HD.CONGTY_ID         where                 HD.BENHVIEN_ID = 'HLU01']
2019-12-12 15:22:36,905 [1] DEBUG - Statement Id: [DAO00307_GetPatientConfirms] PreparedStatement : [select distinct HD_BN.*        , CASE WHEN HD_BN.GIOITINH = '1' THEN N'Nam' ELSE N'Nữ' END AS GENDER        , CASE WHEN HD_DV.ACTIVE IS NULL THEN 0 ELSE 1 END BENHNHAN_DANGKYKSK_DICHVU        , case when HD_BN.GOI_ID is null then N'Hợp đồng:' + ' ' + HD.SO_HD else N'Gói khám:' + ' ' + G.TENGOI end as DOITUONG        , LST.DICTIONARY_NAME as HONNHAN        from TT_KSK_HOPDONG HD        inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        left join LST_DICTIONARY LST ON LST.DICTIONARY_ID = HD_BN.TINHTRANGHONNHAN_ID AND LST.DICTIONARY_TYPE_CODE = 'TinhTrangGiaDinh'        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        left join TT_TIEPNHAN TN on TN.TIEPNHAN_ID = HD_DV.TIEPNHAN_ID        left join TM_CSKH_GOI G ON G.GOI_ID = HD_BN.GOI_ID        where HD.HOPDONG_ID = '4'         AND           HD.BENHVIEN_ID = 'HLU01'                 order by HD_BN.STT]
2019-12-12 15:22:43,497 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , ISNULL(NTH.TENPHONGBAN, PB.TENPHONGBAN) as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , ISNULL(NTH.PHONGBAN_ID, PB.PHONGBAN_ID) as NOITHUCHIEN_ID        , BS.NHANVIEN_ID AS BACSICHIDINH_ID, BS.TENNHANVIEN AS TENBACSICHIDINH        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        LEFT JOIN TM_PHONGBAN NTH ON NTH.PHONGBAN_ID = G_CT.NOITHUCHIEN_ID        LEFT JOIN TM_NHANVIEN BS ON BS.NHANVIEN_ID = G_CT.BACSICHIDINH_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '310'         and           HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-12 15:22:54,418 [1] DEBUG - Statement Id: [DAO00307_CheckSingin] PreparedStatement : [select *        from TT_KSK_HOPDONG_BENHNHAN_DICHVU         where                 HOPDONG_ID = 4             and               HOPDONG_BENHNHAN_ID = 310             and               BENHVIEN_ID = 'HLU01']
2019-12-12 15:23:02,304 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'HSM05'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 15:23:02,435 [1] DEBUG - Statement Id: [DAO00307_GetContractWithDate] PreparedStatement : [SELECT HD.*, HD.SO_HD + ' - ' + CT.TENCONGTY AS HOPDONG, CT.TENCONGTY        FROM TT_KSK_HOPDONG HD JOIN TT_KSK_CONGTY CT ON CT.CONGTY_ID = HD.CONGTY_ID         where                 HD.BENHVIEN_ID = 'HLU01']
2019-12-12 15:23:02,657 [1] DEBUG - Statement Id: [DAO00307_GetContractWithDate] PreparedStatement : [SELECT HD.*, HD.SO_HD + ' - ' + CT.TENCONGTY AS HOPDONG, CT.TENCONGTY        FROM TT_KSK_HOPDONG HD JOIN TT_KSK_CONGTY CT ON CT.CONGTY_ID = HD.CONGTY_ID         where                 HD.BENHVIEN_ID = 'HLU01']
2019-12-12 15:23:05,622 [1] DEBUG - Statement Id: [DAO00307_GetContractPatient] PreparedStatement : [SELECT HD_BN.*, LST.DICTIONARY_NAME AS HONNHAN        , CASE WHEN HD_BN.GIOITINH = '1' THEN N'Nam' ELSE N'Nữ' END AS GENDER        , CASE WHEN HD_BN.HOPDONG_BENHNHAN_ID IN (SELECT HOPDONG_BENHNHAN_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU) THEN 1 ELSE 0 END BENHNHAN_DANGKYKSK_DICHVU        , GOI.TENGOI        FROM TT_KSK_HOPDONG_BENHNHAN HD_BN        INNER JOIN TT_KSK_HOPDONG HD ON HD.HOPDONG_ID = HD_BN.HOPDONG_ID        LEFT JOIN LST_DICTIONARY LST ON LST.DICTIONARY_ID = HD_BN.TINHTRANGHONNHAN_ID AND LST.DICTIONARY_TYPE_CODE = 'TinhTrangGiaDinh'        LEFT JOIN TM_CSKH_GOI GOI ON GOI.GOI_ID = HD_BN.GOI_ID        WHERE HD.HOPDONG_ID = 4           AND               HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-12 15:23:05,670 [1] DEBUG - Statement Id: [DAO00308_StatusContract] PreparedStatement : [SELECT * FROM TT_KSK_HOPDONG        WHERE HOPDONG_ID = 4]
2019-12-12 15:23:07,100 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhanDichVu] PreparedStatement : [SELECT distinct HD_BN.HOPDONG_ID, DV.TENDICHVU, ISNULL(NTH.TENPHONGBAN, PB.TENPHONGBAN) AS NOITHUCHIEN, NDV.TENNHOMDICHVU, ISNULL(GOI_CT.NOITHUCHIEN_ID, PB.PHONGBAN_ID) AS PHONGBAN_ID, DV.DICHVU_ID        , ISNULL(GOI_CT.DONGIATRONGGOI,0) AS DONGIA, ISNULL(GOI_CT.SOLAN,0) AS SOLUONG, GOI_CT.THANHTIENTRONGGOI AS THANHTIEN, BS.NHANVIEN_ID AS BACSICHIDINH_ID, BS.TENNHANVIEN AS TENBACSICHIDINH        , CASE WHEN DV.DICHVU_ID IN (SELECT DICHVU_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU WHERE HOPDONG_ID = '4' AND HOPDONG_BENHNHAN_ID = '317') THEN 1 ELSE 0 END AS DANGKY        FROM TT_KSK_HOPDONG HD                inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        INNER JOIN TM_CSKH_GOI_CHITIET GOI_CT ON GOI_CT.GOI_ID = HD_BN.GOI_ID        INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = GOI_CT.DICHVU_ID        LEFT JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        INNER JOIN TM_PHONGBAN_DICHVU PB_DV ON PB_DV.DICHVU_ID = DV.DICHVU_ID        LEFT JOIN TM_PHONGBAN PB ON PB.PHONGBAN_ID = PB_DV.PHONGBAN_ID        LEFT JOIN TM_PHONGBAN NTH ON NTH.PHONGBAN_ID = GOI_CT.NOITHUCHIEN_ID        LEFT JOIN TM_NHANVIEN BS ON BS.NHANVIEN_ID = GOI_CT.BACSICHIDINH_ID        WHERE GOI_CT.GOI_ID = 4 and HD_BN.HOPDONG_BENHNHAN_ID = 317        and PB_DV.PHONGBAN_ID =(select top 1 PHONGBAN_ID from TM_PHONGBAN_DICHVU where DICHVU_ID = DV.DICHVU_ID)]
2019-12-12 15:24:07,492 [1] DEBUG - Statement Id: [DAO00308_AddByJson] PreparedStatement : [declare @jsonData nvarchar(max) = N'[{"HOPDONG_ID":4,"TENDICHVU":"Chụp Xquang ngực thẳng - số hóa 1 phim","NOITHUCHIEN":"Phòng chụp XQ KTS (D.101)","TENNHOMDICHVU":"Chụp Xquang số hóa","PHONGBAN_ID":79,"DICHVU_ID":4129,"DONGIA":263900.0,"SOLUONG":1,"THANHTIEN":263900.0,"BACSICHIDINH_ID":32,"TENBACSICHIDINH":"Lê Quốc Huy","DANGKY":0,"STT":"2","CHECKSERVICE":true,"HOPDONG_BENHNHAN_ID":317,"NGAYCAPNHAT":"12/12/2019 3:24:07 PM","NGAYTAO":"12/12/2019 3:24:07 PM","NGUOITAO_ID":1,"NGUOICAPNHAT_ID":1,"BENHVIEN_ID":"HLU01"},{"HOPDONG_ID":4,"TENDICHVU":"Tổng phân tích tế bào máu ngoại vi (bằng máy đếm tổng trở)","NOITHUCHIEN":"Phòng XN Huyết học- Sinh hóa-Miễn dịch(D.230)","TENNHOMDICHVU":"Huyết học","PHONGBAN_ID":104,"DICHVU_ID":4523,"DONGIA":170600.0,"SOLUONG":1,"THANHTIEN":170600.0,"BACSICHIDINH_ID":32,"TENBACSICHIDINH":"Lê Quốc Huy","DANGKY":0,"STT":"5","CHECKSERVICE":true,"HOPDONG_BENHNHAN_ID":317,"NGAYCAPNHAT":"12/12/2019 3:24:07 PM","NGAYTAO":"12/12/2019 3:24:07 PM","NGUOITAO_ID":1,"NGUOICAPNHAT_ID":1,"BENHVIEN_ID":"HLU01"},{"HOPDONG_ID":4,"TENDICHVU":"Khám Mắt (E102)","NOITHUCHIEN":"Phòng khám mắt (E.102)","TENNHOMDICHVU":"Khám bệnh","PHONGBAN_ID":177,"DICHVU_ID":5435,"DONGIA":188500.0,"SOLUONG":1,"THANHTIEN":188500.0,"BACSICHIDINH_ID":32,"TENBACSICHIDINH":"Lê Quốc Huy","DANGKY":0,"STT":"3","CHECKSERVICE":true,"HOPDONG_BENHNHAN_ID":317,"NGAYCAPNHAT":"12/12/2019 3:24:07 PM","NGAYTAO":"12/12/2019 3:24:07 PM","NGUOITAO_ID":1,"NGUOICAPNHAT_ID":1,"BENHVIEN_ID":"HLU01"},{"HOPDONG_ID":4,"TENDICHVU":"Khám Nội tổng hợp (D232)","NOITHUCHIEN":"P. khám nội TH- Khám SK (D.232)","TENNHOMDICHVU":"Khám bệnh","PHONGBAN_ID":64,"DICHVU_ID":5438,"DONGIA":188500.0,"SOLUONG":1,"THANHTIEN":188500.0,"BACSICHIDINH_ID":32,"TENBACSICHIDINH":"Lê Quốc Huy","DANGKY":0,"STT":"1","CHECKSERVICE":true,"HOPDONG_BENHNHAN_ID":317,"NGAYCAPNHAT":"12/12/2019 3:24:07 PM","NGAYTAO":"12/12/2019 3:24:07 PM","NGUOITAO_ID":1,"NGUOICAPNHAT_ID":1,"BENHVIEN_ID":"HLU01"},{"HOPDONG_ID":4,"TENDICHVU":"Siêu âm ổ bụng (gan mật, tụy, lách, thận, bàng quang)","NOITHUCHIEN":"Phòng siêu âm D.214","TENNHOMDICHVU":"Siêu âm","PHONGBAN_ID":91,"DICHVU_ID":4017,"DONGIA":188500.0,"SOLUONG":1,"THANHTIEN":188500.0,"BACSICHIDINH_ID":32,"TENBACSICHIDINH":"Lê Quốc Huy","DANGKY":0,"STT":"4","CHECKSERVICE":true,"HOPDONG_BENHNHAN_ID":317,"NGAYCAPNHAT":"12/12/2019 3:24:07 PM","NGAYTAO":"12/12/2019 3:24:07 PM","NGUOITAO_ID":1,"NGUOICAPNHAT_ID":1,"BENHVIEN_ID":"HLU01"}]';        INSERT INTO TT_KSK_HOPDONG_BENHNHAN_DICHVU        (        HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , DICHVU_ID        , PHONGBAN_ID        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYCAPNHAT        , NGUOICAPNHAT_ID)        SELECT        HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , DICHVU_ID        , PHONGBAN_ID        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYCAPNHAT        , NGUOICAPNHAT_ID        FROM OPENJSON(@jsonData)        WITH        (        HOPDONG_ID int        , HOPDONG_BENHNHAN_ID int        , DICHVU_ID int        , PHONGBAN_ID int        , BENHVIEN_ID varchar(10)        , NGAYTAO datetime        , NGUOITAO_ID int        , NGAYCAPNHAT datetime        , NGUOICAPNHAT_ID int)]
2019-12-12 15:24:07,693 [1] DEBUG - Statement Id: [DAO00307_GetContractPatient] PreparedStatement : [SELECT HD_BN.*, LST.DICTIONARY_NAME AS HONNHAN        , CASE WHEN HD_BN.GIOITINH = '1' THEN N'Nam' ELSE N'Nữ' END AS GENDER        , CASE WHEN HD_BN.HOPDONG_BENHNHAN_ID IN (SELECT HOPDONG_BENHNHAN_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU) THEN 1 ELSE 0 END BENHNHAN_DANGKYKSK_DICHVU        , GOI.TENGOI        FROM TT_KSK_HOPDONG_BENHNHAN HD_BN        INNER JOIN TT_KSK_HOPDONG HD ON HD.HOPDONG_ID = HD_BN.HOPDONG_ID        LEFT JOIN LST_DICTIONARY LST ON LST.DICTIONARY_ID = HD_BN.TINHTRANGHONNHAN_ID AND LST.DICTIONARY_TYPE_CODE = 'TinhTrangGiaDinh'        LEFT JOIN TM_CSKH_GOI GOI ON GOI.GOI_ID = HD_BN.GOI_ID        WHERE HD.HOPDONG_ID = 4           AND               HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-12 15:24:07,743 [1] DEBUG - Statement Id: [DAO00308_StatusContract] PreparedStatement : [SELECT * FROM TT_KSK_HOPDONG        WHERE HOPDONG_ID = 4]
2019-12-12 15:24:07,846 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhanDichVu] PreparedStatement : [SELECT distinct HD_BN.HOPDONG_ID, DV.TENDICHVU, ISNULL(NTH.TENPHONGBAN, PB.TENPHONGBAN) AS NOITHUCHIEN, NDV.TENNHOMDICHVU, ISNULL(GOI_CT.NOITHUCHIEN_ID, PB.PHONGBAN_ID) AS PHONGBAN_ID, DV.DICHVU_ID        , ISNULL(GOI_CT.DONGIATRONGGOI,0) AS DONGIA, ISNULL(GOI_CT.SOLAN,0) AS SOLUONG, GOI_CT.THANHTIENTRONGGOI AS THANHTIEN, BS.NHANVIEN_ID AS BACSICHIDINH_ID, BS.TENNHANVIEN AS TENBACSICHIDINH        , CASE WHEN DV.DICHVU_ID IN (SELECT DICHVU_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU WHERE HOPDONG_ID = '4' AND HOPDONG_BENHNHAN_ID = '317') THEN 1 ELSE 0 END AS DANGKY        FROM TT_KSK_HOPDONG HD                inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        INNER JOIN TM_CSKH_GOI_CHITIET GOI_CT ON GOI_CT.GOI_ID = HD_BN.GOI_ID        INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = GOI_CT.DICHVU_ID        LEFT JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        INNER JOIN TM_PHONGBAN_DICHVU PB_DV ON PB_DV.DICHVU_ID = DV.DICHVU_ID        LEFT JOIN TM_PHONGBAN PB ON PB.PHONGBAN_ID = PB_DV.PHONGBAN_ID        LEFT JOIN TM_PHONGBAN NTH ON NTH.PHONGBAN_ID = GOI_CT.NOITHUCHIEN_ID        LEFT JOIN TM_NHANVIEN BS ON BS.NHANVIEN_ID = GOI_CT.BACSICHIDINH_ID        WHERE GOI_CT.GOI_ID = 4 and HD_BN.HOPDONG_BENHNHAN_ID = 317        and PB_DV.PHONGBAN_ID =(select top 1 PHONGBAN_ID from TM_PHONGBAN_DICHVU where DICHVU_ID = DV.DICHVU_ID)]
2019-12-12 15:24:37,748 [1] DEBUG - Statement Id: [DAO00307_CheckSingin] PreparedStatement : [select *        from TT_KSK_HOPDONG_BENHNHAN_DICHVU         where                 HOPDONG_ID = 4             and               HOPDONG_BENHNHAN_ID = 310             and               BENHVIEN_ID = 'HLU01']
2019-12-12 15:24:37,842 [1] DEBUG - Statement Id: [DAOLOG01_LockBegin] PreparedStatement : [INSERT into TT_LOG_UPDATE ( REF_TABLE , REF_ID , BENHVIEN_ID )         values ( @param0 ,  @param1 ,  @param2 );]
2019-12-12 15:24:37,843 [1] DEBUG - Statement Id: [DAOLOG01_LockBegin] Parameters: [@param0=[REF_TABLE,TT_TIEPNHAN_BENHAN], @param1=[REF_ID,23396], @param2=[BENHVIEN_ID,HLU01]]
2019-12-12 15:24:37,843 [1] DEBUG - Statement Id: [DAOLOG01_LockBegin] Types: [@param0=[String, System.String], @param1=[Int64, System.Int64], @param2=[String, System.String]]
2019-12-12 15:24:37,962 [1] DEBUG - Statement Id: [DAO00087_GetServiceParams] PreparedStatement : [select CODE, VALUE              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01']
2019-12-12 15:24:38,001 [1] DEBUG - Statement Id: [DAO00013_GetPatientInfo] PreparedStatement : [select *        from TT_BENHNHAN        where MAYTE  = '190043278']
2019-12-12 15:24:38,035 [1] DEBUG - Statement Id: [DAO00095_GetListNguoiLienHe] PreparedStatement : [SELECT BNN.*, D.DICTIONARY_NAME AS TENQUANHE          FROM TT_BENHNHAN AS BN          INNER JOIN TT_BENHNHAN_NGUOILIENHE AS BNN ON BNN.BENHNHAN_ID = BN.BENHNHAN_ID          LEFT JOIN LST_DICTIONARY AS D ON D.DICTIONARY_ID = BNN.QUANHE_ID AND D.DICTIONARY_TYPE_CODE = 'QuanHeGiaDinh'          WHERE BN.MAYTE = '190043278' AND BN.ACTIVE = '1' AND BN.BENHVIEN_ID = 'HLU01']
2019-12-12 15:24:38,081 [1] DEBUG - Statement Id: [DAO00013_GetBenhNhanToDB] PreparedStatement : [select ROW_NUMBER() OVER(order by a.MAYTE) as ROWNUMBER, *,        CASE        WHEN A.GIOITINH = 1 THEN 'Nam'        WHEN A.GIOITINH = 2 THEN N'Nữ'        END as TENGIOITINH        from TT_BENHNHAN A        where  ACTIVE = '1' and MAYTE = '190043278']
2019-12-12 15:24:38,494 [1] DEBUG - Statement Id: [DAO00095_GetListTiepNhanWithBenhNhanId] PreparedStatement : [SELECT A.SOTIEPNHAN, A.TIEPNHAN_ID, B.BENHAN_ID, B.SOBENHAN, bn.MAYTE          from TT_TIEPNHAN A          left join TT_NOITRU_BENHAN B on A.TIEPNHAN_ID = B.TIEPNHAN_ID          left join (select MAYTE, BENHNHAN_ID from TT_BENHNHAN where BENHNHAN_ID = '23396') bn on bn.BENHNHAN_ID = A.BENHNHAN_ID          WHERE A.BENHVIEN_ID = 'HLU01' and A.BENHNHAN_ID = '23396'          and A.TRANGTHAI in ('DATIEPNHAN','CAPCUU','NOITRU')]
2019-12-12 15:24:38,537 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '27465' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-12-12 15:24:39,815 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '27465']
2019-12-12 15:24:40,918 [1] DEBUG - Statement Id: [DAO00027_GetListTiepNhanAllCOM30] PreparedStatement : [select distinct A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, isnull(C.SOBENHAN,NULL) as SOBENHAN,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI, A.SOBHYT, CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYTIEPNHAN,        B.*        , A.UUTIEN        from TT_TIEPNHAN A        inner join (select * from TT_BENHNHAN where MAYTE = '190043278' and ACTIVE = '1') B on B.BENHNHAN_ID = A.BENHNHAN_ID  and B.ACTIVE = '1'        left join TT_NOITRU_BENHAN C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        where A.TIEPNHAN_ID = '27465' and A.BENHVIEN_ID = 'HLU01' and (A.TRANGTHAI not in ('HUY','CAPCUU', 'NOITRU', 'NGOAITRU'))]
2019-12-12 15:24:41,477 [1] DEBUG - Statement Id: [DAO00095_GetListDVYeucauWithBenhNhanId] PreparedStatement : [SELECT A.SOTIEPNHAN, A.TIEPNHAN_ID, C.DICHVU_ID, C.DVYEUCAU_ID          from TT_TIEPNHAN A          left join (select * from TT_DVYEUCAU where BENHNHAN_ID = '23396') C on C.TIEPNHAN_ID = A.TIEPNHAN_ID          WHERE A.BENHVIEN_ID = 'HLU01' and A.BENHNHAN_ID = '23396'          and A.TRANGTHAI in ('DATIEPNHAN','CAPCUU','NOITRU')]
2019-12-12 15:24:41,523 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '27465' and C.DICHVU_ID = '4061' and A.BENHVIEN_ID = 'HLU01'         and           C.DVYEUCAU_ID = '205389']
2019-12-12 15:24:42,130 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '27465' and C.DICHVU_ID = '5435' and A.BENHVIEN_ID = 'HLU01'         and           C.DVYEUCAU_ID = '205390']
2019-12-12 15:24:42,648 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '27465' and C.DICHVU_ID = '203' and A.BENHVIEN_ID = 'HLU01'         and           C.DVYEUCAU_ID = '205391']
2019-12-12 15:24:43,754 [1] DEBUG - Statement Id: [DAO00095_GetListToaThuocNoiTruWithBenhNhanId] PreparedStatement : [SELECT B.KHAMBENH_ID as KHAMBENH_TOATHUOC_ID, 'NOITRU' as LOAITOA          from TT_TIEPNHAN A          left join TT_NOITRU_TOATHUOC B on A.TIEPNHAN_ID = B.TIEPNHAN_ID          WHERE A.BENHVIEN_ID = 'HLU01' and A.BENHNHAN_ID = '23396'          and A.TRANGTHAI in ('DATIEPNHAN','CAPCUU','NOITRU')]
2019-12-12 15:24:43,792 [1] DEBUG - Statement Id: [DAO00027_GetListDuyetToaThuocBHYTCOM24_Noi] PreparedStatement : [select distinct A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        B.*, 'NOITRU' as LOAITOA, C.PHAMVI_ID as PHAMVI_ID        from TT_NOITRU_TOATHUOC C        inner join TT_TIEPNHAN A on C.TIEPNHAN_ID = A.TIEPNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID        where (C.TRANGTHAI = 'DADUYET' or C.TRANGTHAI = 'CHUAXUAT' or C.TRANGTHAI = 'DAXUAT') and C.BENHVIEN_ID = 'HLU01' and C.KHAMBENH_ID = '' and (A.SOBHYT is not null or A.SOBHYT != '')]
2019-12-12 15:24:43,825 [1] DEBUG - Statement Id: [DAO00027_GetListDuyetToaThuocBHYTCOM24_Noi] PreparedStatement : [select distinct A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        B.*, 'NOITRU' as LOAITOA, C.PHAMVI_ID as PHAMVI_ID        from TT_NOITRU_TOATHUOC C        inner join TT_TIEPNHAN A on C.TIEPNHAN_ID = A.TIEPNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID        where (C.TRANGTHAI = 'DADUYET' or C.TRANGTHAI = 'CHUAXUAT' or C.TRANGTHAI = 'DAXUAT') and C.BENHVIEN_ID = 'HLU01' and C.KHAMBENH_ID = '' and (A.SOBHYT is not null or A.SOBHYT != '')]
2019-12-12 15:24:43,854 [1] DEBUG - Statement Id: [DAO00095_GetLisToaThuocNgoaiWithBenhNhanId] PreparedStatement : [SELECT B.KHAMBENH_TOATHUOC_ID, B.LOAITOATHUOC as LOAITOA          from TT_TIEPNHAN A          left join TT_NGOAITRU_KHAMBENH C on C.TIEPNHAN_ID = A.TIEPNHAN_ID          left join TT_NGOAITRU_KHAMBENH_TOATHUOC B on C.KHAMBENH_ID = B.KHAMBENH_ID          WHERE A.BENHVIEN_ID = 'HLU01' and A.BENHNHAN_ID = '23396'          and A.TRANGTHAI in ('DATIEPNHAN','CAPCUU','NOITRU')]
2019-12-12 15:24:43,894 [1] DEBUG - Statement Id: [DAO00027_GetListDuyetToaThuocBHYTCOM24_Ngoai_ForDelete] PreparedStatement : [select distinct A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        B.*, 'NGOAITRU' as LOAITOA, C.PHAMVI_ID as PHAMVI_ID        from TT_NGOAITRU_KHAMBENH_TOATHUOC C        inner join TT_NGOAITRU_KHAMBENH D on C.KHAMBENH_ID = D.KHAMBENH_ID        inner join TT_TIEPNHAN A on D.TIEPNHAN_ID = A.TIEPNHAN_ID              inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID        where C.KHAMBENH_TOATHUOC_ID = '']
2019-12-12 15:24:43,922 [1] DEBUG - Statement Id: [DAO00027_GetListDuyetToaThuocBHYTCOM24_Ngoai] PreparedStatement : [select distinct A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        B.*, 'NGOAITRU' as LOAITOA, C.PHAMVI_ID as PHAMVI_ID        from TT_NGOAITRU_KHAMBENH_TOATHUOC C        inner join TT_NGOAITRU_KHAMBENH D on C.KHAMBENH_ID = D.KHAMBENH_ID        inner join TT_TIEPNHAN A on D.TIEPNHAN_ID = A.TIEPNHAN_ID                inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID        where C.DUYET = '1' and C.TRANGTHAI = 'CHUAXUAT' and C.BENHVIEN_ID = 'HLU01' and C.KHAMBENH_TOATHUOC_ID = '' and (C.LOAITOATHUOC = 'BV' or C.LOAITOATHUOC = 'MP' or C.LOAITOATHUOC = 'KTBV')]
2019-12-12 15:24:43,937 [1] DEBUG - Statement Id: [DAO00307_UpdatePatientKSK] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN set        MAYTE =  @param0         , TENBENHNHAN =  @param1         , GIOITINH =  @param2         , NGAYSINH =  @param3         , NAMSINH =  @param4         , DIACHI =  @param5         , QUOCTICH_ID =  @param6         , TINHTHANH_ID =  @param7         , QUANHUYEN_ID =  @param8         , XAPHUONG_ID =  @param9         , DIACHITHUONGTRU =  @param10         , DANTOC_ID =  @param11         , SODIENTHOAI =  @param12         , NGHENGHIEP_ID =  @param13         , CMND =  @param14         , NGAYCAPNHAT =  @param15         , NGUOICAPNHAT_ID =  @param16         where        BENHNHAN_ID = '23396']
2019-12-12 15:24:43,953 [1] DEBUG - Statement Id: [DAO00307_UpdatePatientKSK] Parameters: [@param0=[MAYTE,190043278], @param1=[TENBENHNHAN,Cao Văn Lâm], @param2=[GIOITINH,1], @param3=[NGAYSINH,2/14/1990 12:00:00 AM], @param4=[NAMSINH,1990], @param5=[DIACHI,null], @param6=[QUOCTICH_ID,null], @param7=[TINHTHANH_ID,null], @param8=[QUANHUYEN_ID,null], @param9=[XAPHUONG_ID,null], @param10=[DIACHITHUONGTRU,null], @param11=[DANTOC_ID,null], @param12=[SODIENTHOAI,null], @param13=[NGHENGHIEP_ID,null], @param14=[CMND,null], @param15=[NGAYCAPNHAT,12/12/2019 12:00:00 AM], @param16=[NGUOICAPNHAT_ID,1]]
2019-12-12 15:24:43,953 [1] DEBUG - Statement Id: [DAO00307_UpdatePatientKSK] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[Int64, System.Int64], @param3=[DateTime, System.DateTime], @param4=[Int64, System.Int64], @param5=[System.DBNull, null], @param6=[System.DBNull, null], @param7=[System.DBNull, null], @param8=[System.DBNull, null], @param9=[System.DBNull, null], @param10=[System.DBNull, null], @param11=[System.DBNull, null], @param12=[System.DBNull, null], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[DateTime, System.DateTime], @param16=[Int64, System.Int64]]
2019-12-12 15:24:43,983 [1] DEBUG - Statement Id: [DAO00118_Add_BenhNhan] PreparedStatement : [if not exists (select 1 from TT_BENHNHAN where BENHNHAN_ID = '23396')              insert into TT_BENHNHAN (              BENHNHAN_ID              , MAYTE              , SOVAOVIEN              , TENBENHNHAN              , HO              , TEN              , GIOITINH              , NGAYSINH              , NAMSINH              , SONHA              , DIACHI              , SODIENTHOAI              , XAPHUONG_ID              , QUANHUYEN_ID              , TINHTHANH_ID              , DANTOC_ID              , QUOCTICH_ID              , SOLUUTRUNOITRU              , SOLUUTRUNGOAITRU              , NGHENGHIEP_ID              , CMND              , HOCHIEU              , VIETKIEU              , NGUOINUOCNGOAI              , DIACHITHUONGTRU              , DIACHILIENLAC              , DIACHICOQUAN              , EMAIL              , NHOMMAU_ID              , YEUTORH_ID              , TIENSUDIUNG              , TIENSUBENH              , TIENSUHUTTHUOCLA              , TUVONG              , NGAYTUVONG              , THOIGIANTUVONG              , NGUYENNHANTUVONG_ID              , NGUOIGHINHANTUVONG_ID              , THOIGIANGHINHANTUVONG              , NHANVIEN_ID              , DONVICONGTAC_ID              , DIENTHOAIBAN              , TINHTRANGHONNHAN_ID              , NGUOILIENHE_ID              , MOIQUANHE_ID              , NGUOILIENHE              , THONGTIN_NLH              , GHICHU              , HINHANH_DAIDIEN              , BENHVIEN_ID              , NGAYTAO              , NGUOITAO_ID              , NGAYGIOSINH              ) values (               @param0               ,  @param1               ,  @param2               ,  @param3               ,  @param4               ,  @param5               ,  @param6               ,  @param7               ,  @param8               ,  @param9               ,  @param10               ,  @param11               ,  @param12               ,  @param13               ,  @param14               ,  @param15               ,  @param16               ,  @param17               ,  @param18               ,  @param19               ,  @param20               ,  @param21               ,  @param22               ,  @param23               ,  @param24               ,  @param25               ,  @param26               ,  @param27               ,  @param28               ,  @param29               ,  @param30               ,  @param31               ,  @param32               ,  @param33               ,  @param34               ,  @param35               ,  @param36               ,  @param37               ,  @param38               ,  @param39               ,  @param40               ,  @param41               ,  @param42               ,  @param43               ,  @param44               ,  @param45               ,  @param46               ,  @param47               ,  @param48               ,  @param49               ,  @param50               ,  @param51               ,  @param52               )              else              update TT_BENHNHAN set              MAYTE =  @param1                ,                   SOVAOVIEN =  @param2                ,                   TENBENHNHAN =  @param3                ,                   HO =  @param4                ,                   TEN =  @param5                ,                   GIOITINH =  @param6                ,                   NGAYSINH =  @param7                ,                   NAMSINH =  @param8                ,                   SONHA =  @param9                ,                   SODIENTHOAI =  @param11                ,                   XAPHUONG_ID =  @param12                ,                   DANTOC_ID =  @param15                ,                   QUOCTICH_ID =  @param16                ,                   NGHENGHIEP_ID =  @param19                ,                   CMND =  @param20                ,                   HOCHIEU =  @param21                ,                   DIACHITHUONGTRU =  @param24                ,                   DIACHILIENLAC =  @param25                ,                   NGUOILIENHE_ID =  @param43                ,                   MOIQUANHE_ID =  @param44                ,                   NGUOILIENHE =  @param45                ,                   THONGTIN_NLH =  @param46                ,                   GHICHU =  @param47                ,                   BENHVIEN_ID =  @param49                ,                   NGAYCAPNHAT =  @param53                ,                   NGUOICAPNHAT_ID =  @param54                              where              BENHNHAN_ID = '23396']
2019-12-12 15:24:43,983 [1] DEBUG - Statement Id: [DAO00118_Add_BenhNhan] Parameters: [@param0=[BENHNHAN_ID,23396], @param1=[MAYTE,190043278], @param2=[SOVAOVIEN,0043278], @param3=[TENBENHNHAN,Cao Văn Lâm], @param4=[HO,Cao], @param5=[TEN,Văn Lâm], @param6=[GIOITINH,1], @param7=[NGAYSINH,2/14/1990 12:00:00 AM], @param8=[NAMSINH,1990], @param9=[SONHA,null], @param10=[DIACHI,null], @param11=[SODIENTHOAI,null], @param12=[XAPHUONG_ID,null], @param13=[QUANHUYEN_ID,null], @param14=[TINHTHANH_ID,null], @param15=[DANTOC_ID,null], @param16=[QUOCTICH_ID,null], @param17=[SOLUUTRUNOITRU,null], @param18=[SOLUUTRUNGOAITRU,null], @param19=[NGHENGHIEP_ID,null], @param20=[CMND,null], @param21=[HOCHIEU,null], @param22=[VIETKIEU,null], @param23=[NGUOINUOCNGOAI,null], @param24=[DIACHITHUONGTRU,null], @param25=[DIACHILIENLAC,null], @param26=[DIACHICOQUAN,null], @param27=[EMAIL,null], @param28=[NHOMMAU_ID,null], @param29=[YEUTORH_ID,null], @param30=[TIENSUDIUNG,null], @param31=[TIENSUBENH,null], @param32=[TIENSUHUTTHUOCLA,null], @param33=[TUVONG,null], @param34=[NGAYTUVONG,null], @param35=[THOIGIANTUVONG,null], @param36=[NGUYENNHANTUVONG_ID,null], @param37=[NGUOIGHINHANTUVONG_ID,null], @param38=[THOIGIANGHINHANTUVONG,null], @param39=[NHANVIEN_ID,null], @param40=[DONVICONGTAC_ID,null], @param41=[DIENTHOAIBAN,null], @param42=[TINHTRANGHONNHAN_ID,null], @param43=[NGUOILIENHE_ID,null], @param44=[MOIQUANHE_ID,null], @param45=[NGUOILIENHE,null], @param46=[THONGTIN_NLH,null], @param47=[GHICHU,null], @param48=[HINHANH_DAIDIEN,null], @param49=[BENHVIEN_ID,HLU01], @param50=[NGAYTAO,12/11/2019 10:53:31 AM], @param51=[NGUOITAO_ID,0], @param52=[NGAYGIOSINH,null], @param53=[NGAYCAPNHAT,12/12/2019 12:00:00 AM], @param54=[NGUOICAPNHAT_ID,1]]
2019-12-12 15:24:43,983 [1] DEBUG - Statement Id: [DAO00118_Add_BenhNhan] Types: [@param0=[Int32, System.Int32], @param1=[String, System.String], @param2=[String, System.String], @param3=[String, System.String], @param4=[String, System.String], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[DateTime, System.DateTime], @param8=[Int64, System.Int64], @param9=[System.DBNull, null], @param10=[System.DBNull, null], @param11=[System.DBNull, null], @param12=[System.DBNull, null], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[System.DBNull, null], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[System.DBNull, null], @param39=[System.DBNull, null], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[String, System.String], @param50=[DateTime, System.DateTime], @param51=[Int64, System.Int64], @param52=[System.DBNull, null], @param53=[DateTime, System.DateTime], @param54=[Int64, System.Int64]]
2019-12-12 15:24:44,138 [1] DEBUG - Statement Id: [DAOWF001_Laythongtingateways] PreparedStatement : [select * from TM_PROCESS_GATEWAYS]
2019-12-12 15:24:44,462 [1] DEBUG - Statement Id: [DAO00019_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10),        @yearNow int, @monthNow varchar(2), @dayNow varchar(2),        @Sotiepnhan varchar(20), @SoThuTu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @monthNow = RIGHT('00' + convert(varchar(2), MONTH(getdate())),2)        set @dayNow = RIGHT('00' + convert(varchar(2), DAY(getdate())),2)        BEGIN        select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOTIEPNHAN' and KEYYEAR = @yearNow and KEYMONTH = @monthNow and KEYDAY = @dayNow        and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOTIEPNHAN', @yearNow, @monthNow, @dayNow, '0', '0', '0', 0, @BenhVienId);        Update LST_KEYDATA set KEYVALUE = (KEYVALUE + 1), @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOTIEPNHAN' and KEYYEAR = @yearNow and KEYMONTH = @monthNow and KEYDAY = @dayNow and BENHVIEN_ID = @BenhVienId        set @SoThuTu = right('0000000'+convert(varchar(7), @keyValue), 7)        set @Sotiepnhan = 'TN' + RIGHT(@yearNow, 2) + @monthNow  + @dayNow + '.' + @SoThuTu                   insert into TT_TIEPNHAN (        SOTIEPNHAN        , UUTIEN        , BENHNHAN_ID        , BENHVIEN_ID        , TUYENKHAMBENH_ID        , NOITIEPNHAN_ID        , NGAYTIEPNHAN        , THOIGIANTIEPNHAN        , NAMTIEPNHAN        , THANGTIEPNHAN        , DOITUONG_ID        , LYDOTIEPNHAN_ID        , HINHTHUCDENKHAM_ID        , TINHTRANGHEN        , XACNHANCHIPHI_ID        , THUTIENTRUOC        , TAIKHAM        , SOBHYT        , BHYTTUNGAY        , BHYTDENNGAY        , BHYTNGAYCAP        , BHYTTREN3NAM        , BHYTTREN5NAM        , NGAYMIENDONGCHITRA        , LOAIBHYT        , NGAYBHYT2        , SOCHUYENVIEN        , HINHTHUCCHUYENVIEN_ID        , NOIGIOITHIEU_ID        , NGUOIGIOITHIEU_ID        , THOIGIANCHUYENTUYEN        , LYDOCHUYENVIEN_ID        , ICDNOIGIOITHIEU_ID        , CHANDOANNGT        , TRAITUYEN        , DIACHILIENHE        , XAPHUONG_ID        , QUANHUYEN_ID        , TINHTHANH_ID        , PROCESS_ID        , TRANGTHAI        , KHUVUCSONG_ID        , THANHVIEN_ID        , THE_ID        , LOAITHANHVIEN_ID        , SUDUNG_BHTN        , VIP        , GHICHU_TIEPNHAN        , BAOLANH_VIENPHI        , CONGTY_CHITRA_ID        , NGUON_BENHNHAN_ID        , LOAITIEPNHAN_ID        , THONGTIN_KCB_BHYT        , NGAYTAO        , NGUOITAO_ID        , LYDODENKHAM         ,           ISTHONGTUYEN                 )        OUTPUT INSERTED.TIEPNHAN_ID, INSERTED.SOTIEPNHAN        values (        @Sotiepnhan        ,  @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54          ,            @param55                  )        end]
2019-12-12 15:24:44,463 [1] DEBUG - Statement Id: [DAO00019_Add] Parameters: [@param0=[UUTIEN,0], @param1=[BENHNHAN_ID,23396], @param2=[BENHVIEN_ID,HLU01], @param3=[TUYENKHAMBENH_ID,null], @param4=[NOITIEPNHAN_ID,68], @param5=[NGAYTIEPNHAN,12/12/2019 12:00:00 AM], @param6=[THOIGIANTIEPNHAN,12/12/2019 12:00:00 AM], @param7=[NAMTIEPNHAN,2019], @param8=[THANGTIEPNHAN,12], @param9=[DOITUONG_ID,1], @param10=[LYDOTIEPNHAN_ID,null], @param11=[HINHTHUCDENKHAM_ID,461], @param12=[TINHTRANGHEN,null], @param13=[XACNHANCHIPHI_ID,null], @param14=[THUTIENTRUOC,null], @param15=[TAIKHAM,0], @param16=[SOBHYT,null], @param17=[BHYTTUNGAY,null], @param18=[BHYTDENNGAY,null], @param19=[BHYTNGAYCAP,null], @param20=[BHYTTREN3NAM,0], @param21=[BHYTTREN5NAM,0], @param22=[NGAYMIENDONGCHITRA,null], @param23=[LOAIBHYT,null], @param24=[NGAYBHYT2,null], @param25=[SOCHUYENVIEN,null], @param26=[HINHTHUCCHUYENVIEN_ID,null], @param27=[NOIGIOITHIEU_ID,null], @param28=[NGUOIGIOITHIEU_ID,null], @param29=[THOIGIANCHUYENTUYEN,null], @param30=[LYDOCHUYENVIEN_ID,null], @param31=[ICDNOIGIOITHIEU_ID,null], @param32=[CHANDOANNGT,null], @param33=[TRAITUYEN,0], @param34=[DIACHILIENHE,null], @param35=[XAPHUONG_ID,null], @param36=[QUANHUYEN_ID,null], @param37=[TINHTHANH_ID,null], @param38=[PROCESS_ID,P01], @param39=[TRANGTHAI,DATIEPNHAN], @param40=[KHUVUCSONG_ID,null], @param41=[THANHVIEN_ID,null], @param42=[THE_ID,null], @param43=[LOAITHANHVIEN_ID,null], @param44=[SUDUNG_BHTN,0], @param45=[VIP,0], @param46=[GHICHU_TIEPNHAN,null], @param47=[BAOLANH_VIENPHI,0], @param48=[CONGTY_CHITRA_ID,null], @param49=[NGUON_BENHNHAN_ID,null], @param50=[LOAITIEPNHAN_ID,null], @param51=[THONGTIN_KCB_BHYT,null], @param52=[NGAYTAO,12/12/2019 3:24:44 PM], @param53=[NGUOITAO_ID,0], @param54=[LYDODENKHAM,null], @param55=[ISTHONGTUYEN,0]]
2019-12-12 15:24:44,463 [1] DEBUG - Statement Id: [DAO00019_Add] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[String, System.String], @param3=[System.DBNull, null], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[DateTime, System.DateTime], @param7=[Int32, System.Int32], @param8=[Int32, System.Int32], @param9=[Int64, System.Int64], @param10=[System.DBNull, null], @param11=[Int64, System.Int64], @param12=[System.DBNull, null], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[String, System.String], @param21=[String, System.String], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[String, System.String], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[String, System.String], @param45=[String, System.String], @param46=[System.DBNull, null], @param47=[String, System.String], @param48=[System.DBNull, null], @param49=[System.DBNull, null], @param50=[System.DBNull, null], @param51=[System.DBNull, null], @param52=[DateTime, System.DateTime], @param53=[Int64, System.Int64], @param54=[System.DBNull, null], @param55=[String, System.String]]
2019-12-12 15:24:44,492 [1] DEBUG - Statement Id: [DAO00019_GetTTTiepNhan_byTiepNhanId] PreparedStatement : [select *        from TT_TIEPNHAN        where TIEPNHAN_ID = '28492'        order by TIEPNHAN_ID]
2019-12-12 15:24:44,520 [1] DEBUG - Statement Id: [DAO00080_Add_KhamBenh_CapCuu] PreparedStatement : [insert into TT_KHAMBENH_VAOVIEN (        SOPHIEU        , TIEPNHAN_ID        , KHAMBENH_ID        , BENHNHAN_ID        , NGUOILIENHE        , DIENTHOAILIENHE        , NOILAMVIEC        , CHANDOANNOIGIOITHIEU        , NGAYKHAM        , THOIGIANKHAM        , LYDOVAOVIEN        , QUATRINHBENHLY        , TIENSUBANTHAN        , TIENSUGIADINH        , KHAMXETTOANTHAN        , KHAMXETCACBOPHAN        , KHAMXETKQLS        , CHANDOANVAO        , ICDKHAMXET_ID        , DAXULY        , NGAYRA        , THOIGIANRA        , NHAPKHOA_ID        , CHUYENVIEN_ID        , CHUY        , MACH        , NHIETDO        , HUYETAPCAO        , HUYETAPTHAP        , NHIPTHO        , CANNANG        , CHIEUCAO        , BACSI_ID        , XUTRUKHAMBENH_ID        , CAPCUU        , NGAYTAINAN        , THOIGIANTAINAN        , NOITAINAN_TINHTHANH_ID        , NOITAINAN_QUANHUYEN_ID        , NOITAINAN_PHUONGXA_ID        , NOITAINAN_DIACHI        , DIADIEMTAINAN_ID        , BOPHANBITHUONG_ID        , MUCDO_ID        , DIENBIENSAUTN_ID        , XUTRISAUTN_ID        , NGUYENNHAN_ID        , NGUYENNHANCHITIET_ID        , ICD_NGUYENNHAN        , NGAYTAO        , NGUOITAO_ID        , NGAYCAPNHAT        , NGUOICAPNHAT_ID        , BENHANCHUYENKHOA        , CHANDOANVAOVIEN        , CHANDOANRAVIEN        , DIEUTRITUNGAY        , DIEUTRIDENNGAY        , DIENBIENLS        , KQXETNGHIEM        , PHAUTHUAT        , THUTHUAT        , TINHTRANGNGUOIBENH        , HUONGDIEUTRI        , NGUOIGIAO_ID        , NGUOINHAN_ID        , XQUANG        , CTSCANNER        , SIEUAM        , XETNGHIEM        , KHAC        , TOANBOHS        , LOAICHUYENKHOA        , CONGANCANTHIEP        , CDRR_BENHCHINH        , CDRR_BENHKEM        , ICD_BENHCHINH        , ICD_BENHKEMTHEO        , PHUONGPHAPDIEUTRI        , FIELD_1        , FIELD_2        , FIELD_3        , FIELD_4        , FIELD_5        , FIELD_6        , FIELD_7        , FIELD_8        , FIELD_9        , FIELD_10        , FIELD_11        , FIELD_12        , FIELD_13        , FIELD_14        , FIELD_15        , FIELD_27        , FIELD_28        , FIELD_29        , FIELD_30        , FIELD_31        , FIELD_32        , FIELD_33        , FIELD_34        , FIELD_35        , FIELD_36        , FIELD_37        , FIELD_38        , FIELD_39        , FIELD_40        , FIELD_41        , FIELD_42        , FIELD_43        , FIELD_44        , FIELD_45        , FIELD_46        , FIELD_47        , FIELD_48        , FIELD_49        , FIELD_50        , FIELD_51        , FIELD_52        , FIELD_53        , FIELD_54        , FIELD_55        , FIELD_56        , BENHVIEN_ID        ) values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77         ,  @param78         ,  @param79         ,  @param80         ,  @param81         ,  @param82         ,  @param83         ,  @param84         ,  @param85         ,  @param86         ,  @param87         ,  @param88         ,  @param89         ,  @param90         ,  @param91         ,  @param92         ,  @param93         ,  @param94         ,  @param95         ,  @param96         ,  @param97         ,  @param98         ,  @param99         ,  @param100         ,  @param101         ,  @param102         ,  @param103         ,  @param104         ,  @param105         ,  @param106         ,  @param107         ,  @param108         ,  @param109         ,  @param110         ,  @param111         ,  @param112         ,  @param113         ,  @param114         ,  @param115         ,  @param116         ,  @param117         ,  @param118         ,  @param119         ,  @param120         ,  @param121         ,  @param122         ,  @param123         ,  @param124         )]
2019-12-12 15:24:44,520 [1] DEBUG - Statement Id: [DAO00080_Add_KhamBenh_CapCuu] Parameters: [@param0=[SOPHIEU,null], @param1=[TIEPNHAN_ID,28492], @param2=[KHAMBENH_ID,null], @param3=[BENHNHAN_ID,23396], @param4=[NGUOILIENHE,null], @param5=[DIENTHOAILIENHE,null], @param6=[NOILAMVIEC,null], @param7=[CHANDOANNOIGIOITHIEU,null], @param8=[NGAYKHAM,12/12/2019 12:00:00 AM], @param9=[THOIGIANKHAM,12/12/2019 12:00:00 AM], @param10=[LYDOVAOVIEN,null], @param11=[QUATRINHBENHLY,null], @param12=[TIENSUBANTHAN,null], @param13=[TIENSUGIADINH,null], @param14=[KHAMXETTOANTHAN,null], @param15=[KHAMXETCACBOPHAN,null], @param16=[KHAMXETKQLS,null], @param17=[CHANDOANVAO,null], @param18=[ICDKHAMXET_ID,null], @param19=[DAXULY,null], @param20=[NGAYRA,null], @param21=[THOIGIANRA,null], @param22=[NHAPKHOA_ID,68], @param23=[CHUYENVIEN_ID,null], @param24=[CHUY,null], @param25=[MACH,null], @param26=[NHIETDO,null], @param27=[HUYETAPCAO,null], @param28=[HUYETAPTHAP,null], @param29=[NHIPTHO,null], @param30=[CANNANG,null], @param31=[CHIEUCAO,null], @param32=[BACSI_ID,null], @param33=[XUTRUKHAMBENH_ID,null], @param34=[CAPCUU,null], @param35=[NGAYTAINAN,null], @param36=[THOIGIANTAINAN,null], @param37=[NOITAINAN_TINHTHANH_ID,null], @param38=[NOITAINAN_QUANHUYEN_ID,null], @param39=[NOITAINAN_PHUONGXA_ID,null], @param40=[NOITAINAN_DIACHI,null], @param41=[DIADIEMTAINAN_ID,null], @param42=[BOPHANBITHUONG_ID,null], @param43=[MUCDO_ID,null], @param44=[DIENBIENSAUTN_ID,null], @param45=[XUTRISAUTN_ID,null], @param46=[NGUYENNHAN_ID,null], @param47=[NGUYENNHANCHITIET_ID,null], @param48=[ICD_NGUYENNHAN,null], @param49=[NGAYTAO,12/12/2019 3:24:44 PM], @param50=[NGUOITAO_ID,0], @param51=[NGAYCAPNHAT,12/12/2019 3:24:44 PM], @param52=[NGUOICAPNHAT_ID,0], @param53=[BENHANCHUYENKHOA,null], @param54=[CHANDOANVAOVIEN,null], @param55=[CHANDOANRAVIEN,null], @param56=[DIEUTRITUNGAY,null], @param57=[DIEUTRIDENNGAY,null], @param58=[DIENBIENLS,null], @param59=[KQXETNGHIEM,null], @param60=[PHAUTHUAT,null], @param61=[THUTHUAT,null], @param62=[TINHTRANGNGUOIBENH,null], @param63=[HUONGDIEUTRI,null], @param64=[NGUOIGIAO_ID,null], @param65=[NGUOINHAN_ID,null], @param66=[XQUANG,null], @param67=[CTSCANNER,null], @param68=[SIEUAM,null], @param69=[XETNGHIEM,null], @param70=[KHAC,null], @param71=[TOANBOHS,null], @param72=[LOAICHUYENKHOA,null], @param73=[CONGANCANTHIEP,null], @param74=[CDRR_BENHCHINH,null], @param75=[CDRR_BENHKEM,null], @param76=[ICD_BENHCHINH,null], @param77=[ICD_BENHKEMTHEO,null], @param78=[PHUONGPHAPDIEUTRI,null], @param79=[FIELD_1,null], @param80=[FIELD_2,null], @param81=[FIELD_3,null], @param82=[FIELD_4,null], @param83=[FIELD_5,null], @param84=[FIELD_6,null], @param85=[FIELD_7,null], @param86=[FIELD_8,null], @param87=[FIELD_9,null], @param88=[FIELD_10,null], @param89=[FIELD_11,null], @param90=[FIELD_12,null], @param91=[FIELD_13,null], @param92=[FIELD_14,null], @param93=[FIELD_15,null], @param94=[FIELD_27,null], @param95=[FIELD_28,null], @param96=[FIELD_29,null], @param97=[FIELD_30,null], @param98=[FIELD_31,null], @param99=[FIELD_32,null], @param100=[FIELD_33,null], @param101=[FIELD_34,null], @param102=[FIELD_35,null], @param103=[FIELD_36,null], @param104=[FIELD_37,null], @param105=[FIELD_38,null], @param106=[FIELD_39,null], @param107=[FIELD_40,null], @param108=[FIELD_41,null], @param109=[FIELD_42,null], @param110=[FIELD_43,null], @param111=[FIELD_44,null], @param112=[FIELD_45,null], @param113=[FIELD_46,null], @param114=[FIELD_47,null], @param115=[FIELD_48,null], @param116=[FIELD_49,null], @param117=[FIELD_50,null], @param118=[FIELD_51,null], @param119=[FIELD_52,null], @param120=[FIELD_53,null], @param121=[FIELD_54,null], @param122=[FIELD_55,null], @param123=[FIELD_56,null], @param124=[BENHVIEN_ID,HLU01]]
2019-12-12 15:24:44,520 [1] DEBUG - Statement Id: [DAO00080_Add_KhamBenh_CapCuu] Types: [@param0=[System.DBNull, null], @param1=[Int32, System.Int32], @param2=[System.DBNull, null], @param3=[Int32, System.Int32], @param4=[System.DBNull, null], @param5=[System.DBNull, null], @param6=[System.DBNull, null], @param7=[System.DBNull, null], @param8=[DateTime, System.DateTime], @param9=[DateTime, System.DateTime], @param10=[System.DBNull, null], @param11=[System.DBNull, null], @param12=[System.DBNull, null], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[System.DBNull, null], @param22=[String, System.String], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[System.DBNull, null], @param39=[System.DBNull, null], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[DateTime, System.DateTime], @param50=[Int64, System.Int64], @param51=[DateTime, System.DateTime], @param52=[Int64, System.Int64], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[System.DBNull, null], @param59=[System.DBNull, null], @param60=[System.DBNull, null], @param61=[System.DBNull, null], @param62=[System.DBNull, null], @param63=[System.DBNull, null], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[System.DBNull, null], @param71=[System.DBNull, null], @param72=[System.DBNull, null], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null], @param81=[System.DBNull, null], @param82=[System.DBNull, null], @param83=[System.DBNull, null], @param84=[System.DBNull, null], @param85=[System.DBNull, null], @param86=[System.DBNull, null], @param87=[System.DBNull, null], @param88=[System.DBNull, null], @param89=[System.DBNull, null], @param90=[System.DBNull, null], @param91=[System.DBNull, null], @param92=[System.DBNull, null], @param93=[System.DBNull, null], @param94=[System.DBNull, null], @param95=[System.DBNull, null], @param96=[System.DBNull, null], @param97=[System.DBNull, null], @param98=[System.DBNull, null], @param99=[System.DBNull, null], @param100=[System.DBNull, null], @param101=[System.DBNull, null], @param102=[System.DBNull, null], @param103=[System.DBNull, null], @param104=[System.DBNull, null], @param105=[System.DBNull, null], @param106=[System.DBNull, null], @param107=[System.DBNull, null], @param108=[System.DBNull, null], @param109=[System.DBNull, null], @param110=[System.DBNull, null], @param111=[System.DBNull, null], @param112=[System.DBNull, null], @param113=[System.DBNull, null], @param114=[System.DBNull, null], @param115=[System.DBNull, null], @param116=[System.DBNull, null], @param117=[System.DBNull, null], @param118=[System.DBNull, null], @param119=[System.DBNull, null], @param120=[System.DBNull, null], @param121=[System.DBNull, null], @param122=[System.DBNull, null], @param123=[System.DBNull, null], @param124=[String, System.String]]
2019-12-12 15:24:44,562 [1] DEBUG - Statement Id: [DAO00019_Add_TT_TIEPNHAN_SOTHEBHYT] PreparedStatement : [INSERT INTO TT_TIEPNHAN_SOTHEBHYT        (TIEPNHAN_ID        ,BENHNHAN_ID        ,BENHAN_ID        ,DOITUONG_ID        ,SOBHYT        ,BHYTTUNGAY        ,BHYTDENNGAY        ,BHYTNGAYCAP        ,BHYTTREN3NAM        ,BHYTTREN5NAM        ,NGAYMIENDONGCHITRA        ,TRAITUYEN        ,BENHVIEN_ID        ,NOITAO_ID        ,NGAYTAO        ,NGUOITAO_ID        ,NGAYCAPNHAT        ,NGUOICAPNHAT_ID        ,TYLE_VUOT_LCB        ,TYLE_TRAITUYEN        ,GIOIHAN_VUOT_LCB        ,LUONG_COSO        ,TYLE_THUOC_UT        ,MADOITUONG)        VALUES        ( @param0         , @param1         , @param2         , @param3         , @param4         , @param5         , @param6         , @param7         , @param8         , @param9         , @param10         , @param11         , @param12         , @param13         , @param14         , @param15         , @param16         , @param17         , @param18         , @param19         , @param20         , @param21         , @param22         , @param23 )]
2019-12-12 15:24:44,562 [1] DEBUG - Statement Id: [DAO00019_Add_TT_TIEPNHAN_SOTHEBHYT] Parameters: [@param0=[TIEPNHAN_ID,28492], @param1=[BENHNHAN_ID,23396], @param2=[BENHAN_ID,null], @param3=[DOITUONG_ID,1], @param4=[SOBHYT,null], @param5=[BHYTTUNGAY,null], @param6=[BHYTDENNGAY,null], @param7=[BHYTNGAYCAP,null], @param8=[BHYTTREN3NAM,0], @param9=[BHYTTREN5NAM,0], @param10=[NGAYMIENDONGCHITRA,null], @param11=[TRAITUYEN,0], @param12=[BENHVIEN_ID,HLU01], @param13=[NOITAO_ID,68], @param14=[NGAYTAO,12/12/2019 3:24:44 PM], @param15=[NGUOITAO_ID,0], @param16=[NGAYCAPNHAT,12/12/2019 3:24:44 PM], @param17=[NGUOICAPNHAT_ID,0], @param18=[TYLE_VUOT_LCB,null], @param19=[TYLE_TRAITUYEN,null], @param20=[GIOIHAN_VUOT_LCB,null], @param21=[LUONG_COSO,null], @param22=[TYLE_THUOC_UT,null], @param23=[MADOITUONG,null]]
2019-12-12 15:24:44,562 [1] DEBUG - Statement Id: [DAO00019_Add_TT_TIEPNHAN_SOTHEBHYT] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[System.DBNull, null], @param3=[Int64, System.Int64], @param4=[System.DBNull, null], @param5=[System.DBNull, null], @param6=[System.DBNull, null], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[String, System.String], @param10=[System.DBNull, null], @param11=[String, System.String], @param12=[String, System.String], @param13=[String, System.String], @param14=[DateTime, System.DateTime], @param15=[Int64, System.Int64], @param16=[DateTime, System.DateTime], @param17=[Int64, System.Int64], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[System.DBNull, null], @param22=[System.DBNull, null], @param23=[System.DBNull, null]]
2019-12-12 15:24:44,602 [1] DEBUG - Statement Id: [DAO00027_GetListTiepNhanAllCOM30] PreparedStatement : [select distinct A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, isnull(C.SOBENHAN,NULL) as SOBENHAN,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI, A.SOBHYT, CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYTIEPNHAN,        B.*        , A.UUTIEN        from TT_TIEPNHAN A        inner join (select * from TT_BENHNHAN where MAYTE = '190043278' and ACTIVE = '1') B on B.BENHNHAN_ID = A.BENHNHAN_ID  and B.ACTIVE = '1'        left join TT_NOITRU_BENHAN C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        where A.TIEPNHAN_ID = '28492' and A.BENHVIEN_ID = 'HLU01' and (A.TRANGTHAI not in ('HUY','CAPCUU', 'NOITRU', 'NGOAITRU'))]
2019-12-12 15:24:45,014 [1] DEBUG - Statement Id: [DAOWF001_LaythongtinProcess] PreparedStatement : [select * from TM_PROCESS        where        PROCESS_CODE = 'P01']
2019-12-12 15:24:45,067 [1] DEBUG - Statement Id: [DAOWF001_Kiemtrathongtindayeucau] PreparedStatement : [select * from TT_REQUEST        where        PROCESS_CODE = 'P01'        AND PARA = '{"HOSPITAL_ID":"HLU01","SOTIEPNHAN":"TN191212.0000002"}'        AND CURR_STATE_CODE = '6'        AND ISACTIVE = '1']
2019-12-12 15:24:45,118 [1] DEBUG - Statement Id: [DAOWF002_Add] PreparedStatement : [DECLARE @IDRequestOld int        DECLARE @IDRequestNew int        select top 1 @IDRequestOld = ID from TT_REQUEST where PARA =  @param0  order by ID desc          insert into TT_REQUEST (        PROCESS_CODE        , PARA        , CURR_STATE_CODE        ) values (         @param1         ,  @param0         ,  @param2         )        SELECT @IDRequestNew = SCOPE_IDENTITY()        if (@IDRequestOld is not null)        begin        update TT_REQUEST_SERVICE set REQUEST_ID = @IDRequestNew, PROCESS_CODE =  @param1  where REQUEST_ID = @IDRequestOld        update TT_REQUEST set ISACTIVE = '0' where ID = @IDRequestOld        update TT_REQUEST_SERVICE_DETAIL set REQUEST_ID = @IDRequestNew where REQUEST_ID = @IDRequestOld        end          select @IDRequestNew]
2019-12-12 15:24:45,118 [1] DEBUG - Statement Id: [DAOWF002_Add] Parameters: [@param0=[PARA,{"HOSPITAL_ID":"HLU01","SOTIEPNHAN":"TN191212.0000002"}], @param1=[PROCESS_CODE,P01], @param2=[CURR_STATE_CODE,6]]
2019-12-12 15:24:45,118 [1] DEBUG - Statement Id: [DAOWF002_Add] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[String, System.String]]
2019-12-12 15:24:45,291 [1] DEBUG - Statement Id: [DAO00064_GetREGListVienphiTiepNhan] PreparedStatement : [select A.*, B.THUTIENSAU        from TT_VIENPHI A        left join TT_DVYEUCAU B on A.REF_ID =  B.DVYEUCAU_ID and A.REF_TABLE = 'TT_DVYEUCAU' and B.HUYYEUCAU = '0'        where        A.TIEPNHAN_ID = '28492' and A.BENHVIEN_ID = 'HLU01' and (A.BENHAN_ID is NULL or A.BENHAN_ID = '')        and A.HUY = '0'        ORDER BY A.VIENPHI_ID]
2019-12-12 15:24:45,349 [1] DEBUG - Statement Id: [DAOLOG01_LockEnd] PreparedStatement : [DELETE TT_LOG_UPDATE        where REF_TABLE = 'TT_TIEPNHAN_BENHAN' and REF_ID = '23396' and BENHVIEN_ID = 'HLU01']
2019-12-12 15:24:45,381 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-12-12 15:24:45,383 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,28492], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,23396], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,5438], @param8=[BACSICHIDINH_ID,32], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,12/12/2019 12:00:00 AM], @param11=[THANGYEUCAU,12], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,12/12/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,68], @param16=[NOITHUCHIEN_ID,64], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,4], @param50=[HOPDONG_BENHNHAN_ID,310], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,12/11/2019 11:14:22 AM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-12-12 15:24:45,384 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[Int64, System.Int64], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-12-12 15:24:45,424 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28492' and C.DICHVU_ID = '5438' and A.BENHVIEN_ID = 'HLU01']
2019-12-12 15:24:45,905 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28492' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-12-12 15:24:46,285 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '28492']
2019-12-12 15:24:46,682 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-12-12 15:24:46,682 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,28492], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,23396], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,206513], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,5438], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,3], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,188500], @param12=[THANHTIEN_DOANHTHU,188500], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,188500], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,188500], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,12/11/2019 11:14:22 AM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,12/11/2019 11:14:22 AM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-12-12 15:24:46,682 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-12-12 15:24:46,730 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 88          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 310]
2019-12-12 15:24:46,730 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,28492], @param1=[DVYEUCAU_ID,206513], @param2=[VIENPHI_ID,675801], @param3=[SOPHIEUYEUCAU,19..045259], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,12/12/2019 3:24:46 PM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-12-12 15:24:46,730 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-12-12 15:24:46,768 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-12-12 15:24:46,769 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,28492], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,23396], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,4129], @param8=[BACSICHIDINH_ID,32], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,12/12/2019 12:00:00 AM], @param11=[THANGYEUCAU,12], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,12/12/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,68], @param16=[NOITHUCHIEN_ID,79], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,4], @param50=[HOPDONG_BENHNHAN_ID,310], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,12/11/2019 11:14:22 AM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-12-12 15:24:46,769 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[Int64, System.Int64], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-12-12 15:24:46,811 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28492' and C.DICHVU_ID = '4129' and A.BENHVIEN_ID = 'HLU01']
2019-12-12 15:24:47,327 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28492' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-12-12 15:24:48,100 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '28492']
2019-12-12 15:24:48,725 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-12-12 15:24:48,726 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,28492], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,23396], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,206514], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,4129], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,3], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,263900], @param12=[THANHTIEN_DOANHTHU,263900], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,263900], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,263900], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,12/11/2019 11:14:22 AM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,12/11/2019 11:14:22 AM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-12-12 15:24:48,726 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-12-12 15:24:48,762 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 89          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 310]
2019-12-12 15:24:48,763 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,28492], @param1=[DVYEUCAU_ID,206514], @param2=[VIENPHI_ID,675802], @param3=[SOPHIEUYEUCAU,19..045260], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,12/12/2019 3:24:48 PM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-12-12 15:24:48,763 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-12-12 15:24:48,801 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-12-12 15:24:48,801 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,28492], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,23396], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,5435], @param8=[BACSICHIDINH_ID,32], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,12/12/2019 12:00:00 AM], @param11=[THANGYEUCAU,12], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,12/12/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,68], @param16=[NOITHUCHIEN_ID,177], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,4], @param50=[HOPDONG_BENHNHAN_ID,310], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,12/11/2019 11:14:22 AM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-12-12 15:24:48,801 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[Int64, System.Int64], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-12-12 15:24:48,847 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28492' and C.DICHVU_ID = '5435' and A.BENHVIEN_ID = 'HLU01']
2019-12-12 15:24:49,230 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28492' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-12-12 15:24:50,332 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '28492']
2019-12-12 15:24:51,934 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-12-12 15:24:51,934 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,28492], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,23396], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,206515], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,5435], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,3], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,188500], @param12=[THANHTIEN_DOANHTHU,188500], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,188500], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,188500], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,12/11/2019 11:14:22 AM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,12/11/2019 11:14:22 AM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-12-12 15:24:51,934 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-12-12 15:24:51,963 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 90          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 310]
2019-12-12 15:24:51,963 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,28492], @param1=[DVYEUCAU_ID,206515], @param2=[VIENPHI_ID,675803], @param3=[SOPHIEUYEUCAU,19..045261], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,12/12/2019 3:24:51 PM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-12-12 15:24:51,963 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-12-12 15:24:52,000 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-12-12 15:24:52,000 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,28492], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,23396], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,4017], @param8=[BACSICHIDINH_ID,32], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,12/12/2019 12:00:00 AM], @param11=[THANGYEUCAU,12], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,12/12/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,68], @param16=[NOITHUCHIEN_ID,91], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,4], @param50=[HOPDONG_BENHNHAN_ID,310], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,12/11/2019 11:14:22 AM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-12-12 15:24:52,000 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[Int64, System.Int64], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-12-12 15:24:52,036 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28492' and C.DICHVU_ID = '4017' and A.BENHVIEN_ID = 'HLU01']
2019-12-12 15:24:52,519 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28492' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-12-12 15:24:54,497 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '28492']
2019-12-12 15:24:55,883 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-12-12 15:24:55,883 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,28492], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,23396], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,206516], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,4017], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,3], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,188500], @param12=[THANHTIEN_DOANHTHU,188500], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,188500], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,188500], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,12/11/2019 11:14:22 AM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,12/11/2019 11:14:22 AM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-12-12 15:24:55,883 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-12-12 15:24:55,911 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 91          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 310]
2019-12-12 15:24:55,911 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,28492], @param1=[DVYEUCAU_ID,206516], @param2=[VIENPHI_ID,675804], @param3=[SOPHIEUYEUCAU,19..045262], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,12/12/2019 3:24:55 PM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-12-12 15:24:55,911 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-12-12 15:24:55,950 [1] DEBUG - Statement Id: [DAO00020_Add] PreparedStatement : [declare        @keyValue int, @BenhVienId varchar(10), @yearNow int, @SoPhieuYeu varchar(20), @SoRender varchar(20), @MaNhomDichVu varchar(20)        set @keyValue = 0;        set @BenhVienId = 'HLU01'        set @yearNow = YEAR(getdate())        set @MaNhomDichVu = ''                 select @keyValue = KEYVALUE from LST_KEYDATA        where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        if @keyValue = 0        Insert into LST_KEYDATA values ('SOPHIEUYEUCAU', @yearNow, '0', '0', @MaNhomDichVu, '0', '0', 0, @BenhVienId);          Update LST_KEYDATA set KEYVALUE = KEYVALUE + 1, @keyValue = (KEYVALUE + 1) where KEYTYPE = 'SOPHIEUYEUCAU' and KEYYEAR = @yearNow and SEGMENT_1 = @MaNhomDichVu and BENHVIEN_ID = @BenhVienId        set @SoRender = right('000000'+convert(varchar(6), @keyValue), 6)        set @SoPhieuYeu = RIGHT(@yearNow, 2) + '.' + @MaNhomDichVu + '.' + @SoRender                 insert into TT_DVYEUCAU (        TIEPNHAN_ID        , BENHAN_ID        , KHAMBENH_ID        , SODICHVUYEUCAU        , KHAMBENH_NGOAITRU_ID        , SOPHIEUYEUCAU        , BENHNHAN_ID        , DOITUONG_ID        , DICHVU_ID                 , BACSICHIDINH_ID        , GIOYEUCAU        , NGAYYEUCAU        , THANGYEUCAU        , NAMYEUCAU        , NGAYGIOYEUCAU        , THUTUYEUCAU        , NOIYEUCAU_ID        , NOITHUCHIEN_ID        , TRANGTHAI_HANGDOI        , NOIDUNGCHITIET        , CHANDOAN        , LUUTRU_ID        , SODICHVUDONGTIEN        , DICHVU_KHAMBENH_ID        , DALAYMAU        , SINHTHIET        , CLOTEST        , TIEMCANQUANG        , TRIEUCHUNG        , DAITHE        , VITHE        , BENHPHAM        , DANHANBENHPHAM        , NGAYNHANBENHPHAM        , THOIGIANNHANBENHPHAM        , NGUOINHANBENHPHAM_ID        , MANGUOINHAPBENHPHAM        , TENNGUOINHAPBENHPHAM        , KETQUAXNKHAC        , YEUCAUBENNGOAI        , THUCHIENBENNGOAI        , DONVIBENNGOAI_ID        , BACSIBENNGOAI_ID        , TENBACSIBENNGOAI        , KHOABENNGOAI_ID        , KHOABENNGOAI                 , NOITHUCHIENTHAYDOI_ID        , LOAIKHACHHANG_ID        , THE_ID        , BARCODEID        , HOPDONG_ID        , HOPDONG_BENHNHAN_ID        , HINHTHUCTHANHTOAN_ID        , DANGKY_ID        , DANGKY_CHITIET_ID        , LICHHEN_ID        , THOIGIANLICHHEN        , BNKHONGDENBV        , GHICHU        , THANHTOANTRUOC        , KHAN        , DUOCPHEPTHUCHIEN        , HUYYEUCAU        , LYDOHUY        , TRANGTHAI        , KHOADULIEU        , NGAYKHOADULIEU        , THOIGIANKHOADULIEU        , NGUOIKHOA_ID        , MANGUOIKHOA        , TENNGUOIKHOA        , BENHVIEN_ID        , NGAYTAO        , NGUOITAO_ID        , NGAYHENCLS        , CREATININEMAU        , VUNGCANKHAOSAT        , BHYTDONGTIEN        , THUTIENSAU                 , DVKEMTHEO        , DVKEMTHEO_KHACEKIP        , LIENCHUYENKHOA                 )        OUTPUT INSERTED.DVYEUCAU_ID, INSERTED.SOPHIEUYEUCAU        values (         @param0         ,  @param1         ,  @param2         ,  @param3         ,  @param4         , @SoPhieuYeu        ,  @param5         ,  @param6         ,  @param7                  ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35         ,  @param36         ,  @param37         ,  @param38         ,  @param39         ,  @param40         ,  @param41         ,  @param42         ,  @param43         ,  @param44                  ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50         ,  @param51         ,  @param52         ,  @param53         ,  @param54         ,  @param55         ,  @param56         ,  @param57         ,  @param58         ,  @param59         ,  @param60         ,  @param61         ,  @param62         ,  @param63         ,  @param64         ,  @param65         ,  @param66         ,  @param67         ,  @param68         ,  @param69         ,  @param70         ,  @param71         ,  @param72         ,  @param73         ,  @param74         ,  @param75         ,  @param76         ,  @param77                  ,  @param78         ,  @param79         ,  @param80                  );]
2019-12-12 15:24:55,951 [1] DEBUG - Statement Id: [DAO00020_Add] Parameters: [@param0=[TIEPNHAN_ID,28492], @param1=[BENHAN_ID,null], @param2=[KHAMBENH_ID,null], @param3=[SODICHVUYEUCAU,0], @param4=[KHAMBENH_NGOAITRU_ID,null], @param5=[BENHNHAN_ID,23396], @param6=[DOITUONG_ID,null], @param7=[DICHVU_ID,4523], @param8=[BACSICHIDINH_ID,32], @param9=[GIOYEUCAU,0], @param10=[NGAYYEUCAU,12/12/2019 12:00:00 AM], @param11=[THANGYEUCAU,12], @param12=[NAMYEUCAU,2019], @param13=[NGAYGIOYEUCAU,12/12/2019 12:00:00 AM], @param14=[THUTUYEUCAU,null], @param15=[NOIYEUCAU_ID,68], @param16=[NOITHUCHIEN_ID,104], @param17=[TRANGTHAI_HANGDOI,null], @param18=[NOIDUNGCHITIET,null], @param19=[CHANDOAN,null], @param20=[LUUTRU_ID,null], @param21=[SODICHVUDONGTIEN,1], @param22=[DICHVU_KHAMBENH_ID,null], @param23=[DALAYMAU,null], @param24=[SINHTHIET,0], @param25=[CLOTEST,0], @param26=[TIEMCANQUANG,0], @param27=[TRIEUCHUNG,null], @param28=[DAITHE,null], @param29=[VITHE,null], @param30=[BENHPHAM,null], @param31=[DANHANBENHPHAM,0], @param32=[NGAYNHANBENHPHAM,null], @param33=[THOIGIANNHANBENHPHAM,null], @param34=[NGUOINHANBENHPHAM_ID,null], @param35=[MANGUOINHAPBENHPHAM,null], @param36=[TENNGUOINHAPBENHPHAM,null], @param37=[KETQUAXNKHAC,null], @param38=[YEUCAUBENNGOAI,0], @param39=[THUCHIENBENNGOAI,0], @param40=[DONVIBENNGOAI_ID,null], @param41=[BACSIBENNGOAI_ID,null], @param42=[TENBACSIBENNGOAI,null], @param43=[KHOABENNGOAI_ID,null], @param44=[KHOABENNGOAI,null], @param45=[NOITHUCHIENTHAYDOI_ID,null], @param46=[LOAIKHACHHANG_ID,null], @param47=[THE_ID,null], @param48=[BARCODEID,null], @param49=[HOPDONG_ID,4], @param50=[HOPDONG_BENHNHAN_ID,310], @param51=[HINHTHUCTHANHTOAN_ID,null], @param52=[DANGKY_ID,null], @param53=[DANGKY_CHITIET_ID,null], @param54=[LICHHEN_ID,null], @param55=[THOIGIANLICHHEN,null], @param56=[BNKHONGDENBV,null], @param57=[GHICHU,null], @param58=[THANHTOANTRUOC,0], @param59=[KHAN,0], @param60=[DUOCPHEPTHUCHIEN,0], @param61=[HUYYEUCAU,0], @param62=[LYDOHUY,null], @param63=[TRANGTHAI,CHUAKETQUA], @param64=[KHOADULIEU,null], @param65=[NGAYKHOADULIEU,null], @param66=[THOIGIANKHOADULIEU,null], @param67=[NGUOIKHOA_ID,null], @param68=[MANGUOIKHOA,null], @param69=[TENNGUOIKHOA,null], @param70=[BENHVIEN_ID,HLU01], @param71=[NGAYTAO,12/11/2019 11:14:22 AM], @param72=[NGUOITAO_ID,1], @param73=[NGAYHENCLS,null], @param74=[CREATININEMAU,null], @param75=[VUNGCANKHAOSAT,null], @param76=[BHYTDONGTIEN,null], @param77=[THUTIENSAU,null], @param78=[DVKEMTHEO,null], @param79=[DVKEMTHEO_KHACEKIP,null], @param80=[LIENCHUYENKHOA,null]]
2019-12-12 15:24:55,951 [1] DEBUG - Statement Id: [DAO00020_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[System.DBNull, null], @param3=[String, System.String], @param4=[System.DBNull, null], @param5=[Int64, System.Int64], @param6=[System.DBNull, null], @param7=[Int64, System.Int64], @param8=[Int64, System.Int64], @param9=[Int32, System.Int32], @param10=[DateTime, System.DateTime], @param11=[Int32, System.Int32], @param12=[Int32, System.Int32], @param13=[DateTime, System.DateTime], @param14=[System.DBNull, null], @param15=[Int32, System.Int32], @param16=[Int64, System.Int64], @param17=[System.DBNull, null], @param18=[System.DBNull, null], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Int32, System.Int32], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[String, System.String], @param25=[String, System.String], @param26=[String, System.String], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[String, System.String], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[System.DBNull, null], @param37=[System.DBNull, null], @param38=[String, System.String], @param39=[String, System.String], @param40=[System.DBNull, null], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[System.DBNull, null], @param44=[System.DBNull, null], @param45=[System.DBNull, null], @param46=[System.DBNull, null], @param47=[System.DBNull, null], @param48=[System.DBNull, null], @param49=[Int64, System.Int64], @param50=[Int64, System.Int64], @param51=[System.DBNull, null], @param52=[System.DBNull, null], @param53=[System.DBNull, null], @param54=[System.DBNull, null], @param55=[System.DBNull, null], @param56=[System.DBNull, null], @param57=[System.DBNull, null], @param58=[String, System.String], @param59=[String, System.String], @param60=[String, System.String], @param61=[String, System.String], @param62=[System.DBNull, null], @param63=[String, System.String], @param64=[System.DBNull, null], @param65=[System.DBNull, null], @param66=[System.DBNull, null], @param67=[System.DBNull, null], @param68=[System.DBNull, null], @param69=[System.DBNull, null], @param70=[String, System.String], @param71=[DateTime, System.DateTime], @param72=[Int64, System.Int64], @param73=[System.DBNull, null], @param74=[System.DBNull, null], @param75=[System.DBNull, null], @param76=[System.DBNull, null], @param77=[System.DBNull, null], @param78=[System.DBNull, null], @param79=[System.DBNull, null], @param80=[System.DBNull, null]]
2019-12-12 15:24:55,995 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM006] PreparedStatement : [select distinct CONVERT(VARCHAR(11),A.NGAYTIEPNHAN,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID,        A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU'   or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*,        CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU'  or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28492' and C.DICHVU_ID = '4523' and A.BENHVIEN_ID = 'HLU01']
2019-12-12 15:24:56,500 [1] DEBUG - Statement Id: [DAO00027_ThongTinTiepNhanCOM015] PreparedStatement : [declare @ManhomDSA varchar(10);        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        SELECT * FROM        (        SELECT        (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)) AS acss_lookupID,        ROW_NUMBER() OVER        (PARTITION BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID))        ORDER BY (A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID)))        as num,        A.SOTIEPNHAN + (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END) + LTRIM(C.NOITHUCHIEN_ID) as KEYCOM15,        C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,        CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,        CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU, A.SOBHYT,        B.*, F.TRANGTHAI as TRANGTHAI_BENHAN_NOITRU,        A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,        CASE        WHEN @ManhomDSA is not null and E.MANHOMDICHVU in (@ManhomDSA) THEN E.MANHOMDICHVU        WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU        , A.UUTIEN        from TT_TIEPNHAN A        inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU') and B.ACTIVE = '1'        inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID        left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID        left join TT_NOITRU_BENHAN F on F.TIEPNHAN_ID = A.TIEPNHAN_ID        where C.NGAYHENCLS is NULL and A.TIEPNHAN_ID = '28492' and A.BENHVIEN_ID = 'HLU01'        ) a where a.num = 1]
2019-12-12 15:24:58,288 [1] DEBUG - Statement Id: [DAO00026_GetListDanhSachDichVuGhiNhanVTYT_COM25_WithTN] PreparedStatement : [select distinct CONVERT(VARCHAR(11),C.NGAYYEUCAU,103) as NGAYYEUCAU, C.DICHVU_ID, C.DVYEUCAU_ID, D.TENDICHVU, C.NOITHUCHIEN_ID, A.SOTIEPNHAN, A.TRAITUYEN, A.NGAYMIENDONGCHITRA, A.TIEPNHAN_ID, A.DOITUONG_ID, A.TRANGTHAI,            A.LOAITHANHVIEN_ID, A.SUDUNG_BHTN, A.THE_ID, A.THANHVIEN_ID, A.VIP, A.NGUON_BENHNHAN_ID, A.BAOLANH_VIENPHI,            CASE WHEN (A.TRANGTHAI = 'NOITRU' OR A.TRANGTHAI = 'CAPCUU') THEN 'IN' ELSE 'OUT' END AS LOAIBENHAN,            CASE WHEN (C.TRANGTHAI = 'CHUAKETQUA') THEN 'CHUAKETQUA' ELSE 'HOANTAT' END AS TRANGTHAIDICHVU,            B.*, isnull(ntba.SOBENHAN, '') SOBENHAN, isnull(ntba.BENHAN_ID, 0) BENHAN_ID,            CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END AS MANHOMDICHVU            from TT_TIEPNHAN A            inner join TT_BENHNHAN B on B.BENHNHAN_ID = A.BENHNHAN_ID and B.ACTIVE = '1'            inner join TT_DVYEUCAU C on C.TIEPNHAN_ID = A.TIEPNHAN_ID                        left join TM_DICHVU D on D.DICHVU_ID = C.DICHVU_ID            left join TM_NHOMDICHVU E on E.NHOMDICHVU_ID = D.NHOMDICHVU_ID            left join TT_NOITRU_BENHAN ntba on ntba.BENHAN_ID = C.BENHAN_ID              where            C.NGAYHENCLS is NULL and A.BENHVIEN_ID = 'HLU01'            and (A.TRANGTHAI = 'DATIEPNHAN' or A.TRANGTHAI = 'NOITRU' or A.TRANGTHAI = 'CAPCUU' or A.TRANGTHAI = 'NGOAITRU')            and (CASE WHEN Left(E.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(E.MANHOMDICHVU,2) END in ('02', '04'))            and A.TIEPNHAN_ID = '28492']
2019-12-12 15:24:59,874 [1] DEBUG - Statement Id: [DAO00023_Add] PreparedStatement : [insert into TT_VIENPHI (        TIEPNHAN_ID        , BENHAN_ID         ,           BENHNHAN_ID                 , KHAMBENH_ID        , REF_ID        , REF_TABLE        , DICHVU_ID        , DUOC_ID        , LOAI_CHIPHI        , LOAIGIA_ID        , SOLUONG        , DONGIA_DOANHTHU        , THANHTIEN_DOANHTHU        , BHYT_TL        , BHYT_DONGIA        , BHYT_THANHTIEN        , BHYT_DONGIA_CHITRA        , BHYT_THANHTIEN_CHITRA        , BENHNHAN_PHAITHANHTOAN        , GIATRI_HOADON        , GIATRI_HOADON_DATHANHTOAN        , GIATRI_BIENLAI        , GIATRI_BIENLAI_DATHANHTOAN        , GIATRI_BENHNHAN_DATHANHTOAN        , GIATRI_THATTHU        , MIENGIAM_TL        , MIENGIAM_GIATRI        , NGANSACH_TL        , NGANSACH_GIATRI        , TAITRO_TL        , TAITRO_GIATRI        , BHTN_TL        , BHTN_DONGIA        , BHTN_THANHTIEN        , BHTN_DONGIA_CHITRA        , BHTN_THANHTIEN_CHITRA         ,           DUOCPHEPTHUCHIEN         ,           HUY         ,           DATHANHTOAN         ,           DATHUCHIEN         ,           KHONGTHUTIEN                 , DUYET        , HOADON_ID         ,           ACTIVE                 , BENHVIEN_ID        , NGUOITAO_ID        , NGAYTAO        , NGUOICAPNHAT_ID        , NGAYCAPNHAT        , DONGIA_BHYT_BANDAU        , DONGIADOANHTHU_BANDAU                 ) values (         @param0         ,  @param1          ,            @param2                  ,  @param3         ,  @param4         ,  @param5         ,  @param6         ,  @param7         ,  @param8         ,  @param9         ,  @param10         ,  @param11         ,  @param12         ,  @param13         ,  @param14         ,  @param15         ,  @param16         ,  @param17         ,  @param18         ,  @param19         ,  @param20         ,  @param21         ,  @param22         ,  @param23         ,  @param24         ,  @param25         ,  @param26         ,  @param27         ,  @param28         ,  @param29         ,  @param30         ,  @param31         ,  @param32         ,  @param33         ,  @param34         ,  @param35          ,            @param36          ,            @param37          ,            @param38          ,            @param39          ,            @param40                  ,  @param41         ,  @param42          ,            @param43                  ,  @param44         ,  @param45         ,  @param46         ,  @param47         ,  @param48         ,  @param49         ,  @param50                  )        SELECT SCOPE_IDENTITY()]
2019-12-12 15:24:59,874 [1] DEBUG - Statement Id: [DAO00023_Add] Parameters: [@param0=[TIEPNHAN_ID,28492], @param1=[BENHAN_ID,null], @param2=[BENHNHAN_ID,23396], @param3=[KHAMBENH_ID,null], @param4=[REF_ID,206517], @param5=[REF_TABLE,TT_DVYEUCAU], @param6=[DICHVU_ID,4523], @param7=[DUOC_ID,null], @param8=[LOAI_CHIPHI,TT], @param9=[LOAIGIA_ID,3], @param10=[SOLUONG,1], @param11=[DONGIA_DOANHTHU,170600], @param12=[THANHTIEN_DOANHTHU,170600], @param13=[BHYT_TL,null], @param14=[BHYT_DONGIA,null], @param15=[BHYT_THANHTIEN,null], @param16=[BHYT_DONGIA_CHITRA,null], @param17=[BHYT_THANHTIEN_CHITRA,null], @param18=[BENHNHAN_PHAITHANHTOAN,170600], @param19=[GIATRI_HOADON,null], @param20=[GIATRI_HOADON_DATHANHTOAN,null], @param21=[GIATRI_BIENLAI,170600], @param22=[GIATRI_BIENLAI_DATHANHTOAN,null], @param23=[GIATRI_BENHNHAN_DATHANHTOAN,null], @param24=[GIATRI_THATTHU,null], @param25=[MIENGIAM_TL,null], @param26=[MIENGIAM_GIATRI,null], @param27=[NGANSACH_TL,null], @param28=[NGANSACH_GIATRI,null], @param29=[TAITRO_TL,null], @param30=[TAITRO_GIATRI,null], @param31=[BHTN_TL,null], @param32=[BHTN_DONGIA,null], @param33=[BHTN_THANHTIEN,null], @param34=[BHTN_DONGIA_CHITRA,null], @param35=[BHTN_THANHTIEN_CHITRA,null], @param36=[DUOCPHEPTHUCHIEN,0], @param37=[HUY,0], @param38=[DATHANHTOAN,0], @param39=[DATHUCHIEN,0], @param40=[KHONGTHUTIEN,1], @param41=[DUYET,null], @param42=[HOADON_ID,null], @param43=[ACTIVE,1], @param44=[BENHVIEN_ID,HLU01], @param45=[NGUOITAO_ID,1], @param46=[NGAYTAO,12/11/2019 11:14:22 AM], @param47=[NGUOICAPNHAT_ID,1], @param48=[NGAYCAPNHAT,12/11/2019 11:14:22 AM], @param49=[DONGIA_BHYT_BANDAU,null], @param50=[DONGIADOANHTHU_BANDAU,null]]
2019-12-12 15:24:59,874 [1] DEBUG - Statement Id: [DAO00023_Add] Types: [@param0=[Int32, System.Int32], @param1=[System.DBNull, null], @param2=[Int64, System.Int64], @param3=[System.DBNull, null], @param4=[Int32, System.Int32], @param5=[String, System.String], @param6=[Int64, System.Int64], @param7=[System.DBNull, null], @param8=[String, System.String], @param9=[Int64, System.Int64], @param10=[Int64, System.Int64], @param11=[Double, System.Double], @param12=[Double, System.Double], @param13=[System.DBNull, null], @param14=[System.DBNull, null], @param15=[System.DBNull, null], @param16=[System.DBNull, null], @param17=[System.DBNull, null], @param18=[Double, System.Double], @param19=[System.DBNull, null], @param20=[System.DBNull, null], @param21=[Double, System.Double], @param22=[System.DBNull, null], @param23=[System.DBNull, null], @param24=[System.DBNull, null], @param25=[System.DBNull, null], @param26=[System.DBNull, null], @param27=[System.DBNull, null], @param28=[System.DBNull, null], @param29=[System.DBNull, null], @param30=[System.DBNull, null], @param31=[System.DBNull, null], @param32=[System.DBNull, null], @param33=[System.DBNull, null], @param34=[System.DBNull, null], @param35=[System.DBNull, null], @param36=[String, System.String], @param37=[String, System.String], @param38=[String, System.String], @param39=[String, System.String], @param40=[String, System.String], @param41=[System.DBNull, null], @param42=[System.DBNull, null], @param43=[String, System.String], @param44=[String, System.String], @param45=[Int64, System.Int64], @param46=[DateTime, System.DateTime], @param47=[Int64, System.Int64], @param48=[DateTime, System.DateTime], @param49=[System.DBNull, null], @param50=[System.DBNull, null]]
2019-12-12 15:24:59,904 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] PreparedStatement : [update TT_KSK_HOPDONG_BENHNHAN_DICHVU set        TIEPNHAN_ID =  @param0         , DVYEUCAU_ID =  @param1         , VIENPHI_ID =  @param2         , SOPHIEUYEUCAU =  @param3         , TRANGTHAI =  @param4         , NGAYCAPNHAT =  @param5         , NGUOICAPNHAT_ID =  @param6         where        HOPDONG_DICHVU_BENHNHAN_ID = 92          update TT_KSK_HOPDONG_BENHNHAN_DICHVU set ACTIVE =  @param7  where HOPDONG_BENHNHAN_ID = 310]
2019-12-12 15:24:59,904 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Parameters: [@param0=[TIEPNHAN_ID,28492], @param1=[DVYEUCAU_ID,206517], @param2=[VIENPHI_ID,675805], @param3=[SOPHIEUYEUCAU,19..045263], @param4=[TRANGTHAI,DAXACNHAN], @param5=[NGAYCAPNHAT,12/12/2019 3:24:59 PM], @param6=[NGUOICAPNHAT_ID,1], @param7=[ACTIVE,1]]
2019-12-12 15:24:59,904 [1] DEBUG - Statement Id: [DAO00308_UpdateContractPatientServices] Types: [@param0=[Int32, System.Int32], @param1=[Int32, System.Int32], @param2=[Int32, System.Int32], @param3=[String, System.String], @param4=[String, System.String], @param5=[DateTime, System.DateTime], @param6=[Int64, System.Int64], @param7=[String, System.String]]
2019-12-12 15:25:00,185 [1] DEBUG - Statement Id: [DAO00307_GetPatientConfirms] PreparedStatement : [select distinct HD_BN.*        , CASE WHEN HD_BN.GIOITINH = '1' THEN N'Nam' ELSE N'Nữ' END AS GENDER        , CASE WHEN HD_DV.ACTIVE IS NULL THEN 0 ELSE 1 END BENHNHAN_DANGKYKSK_DICHVU        , case when HD_BN.GOI_ID is null then N'Hợp đồng:' + ' ' + HD.SO_HD else N'Gói khám:' + ' ' + G.TENGOI end as DOITUONG        , LST.DICTIONARY_NAME as HONNHAN        from TT_KSK_HOPDONG HD        inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        left join LST_DICTIONARY LST ON LST.DICTIONARY_ID = HD_BN.TINHTRANGHONNHAN_ID AND LST.DICTIONARY_TYPE_CODE = 'TinhTrangGiaDinh'        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        left join TT_TIEPNHAN TN on TN.TIEPNHAN_ID = HD_DV.TIEPNHAN_ID        left join TM_CSKH_GOI G ON G.GOI_ID = HD_BN.GOI_ID        where HD.HOPDONG_ID = '4'         AND           HD.BENHVIEN_ID = 'HLU01'                 order by HD_BN.STT]
2019-12-12 15:25:00,241 [1] DEBUG - Statement Id: [DAO00308_GetTiepNhanID] PreparedStatement : [select top 1 TN.TIEPNHAN_ID, TN.SOTIEPNHAN        from TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV        inner join TT_TIEPNHAN TN on TN.TIEPNHAN_ID = HD_DV.TIEPNHAN_ID        where HD_DV.HOPDONG_BENHNHAN_ID = 310 and HD_DV.HOPDONG_ID = 4]
2019-12-12 15:25:00,386 [1] DEBUG - Statement Id: [DAO00307_GetServiceWithPatient] PreparedStatement : [select distinct HD_DV.*, DV.TENDICHVU        , ISNULL(G_CT.DONGIATRONGGOI,0) as DONGIA_DOANHTHU        , ISNULL(G_CT.THANHTIENTRONGGOI,0) as BENHNHANTRA, HD_BN.BENHNHAN_ID        , ISNULL(NTH.TENPHONGBAN, PB.TENPHONGBAN) as NOITHUCHIEN        , case when HD_DV.TRANGTHAI = 'DAXACNHAN' then 1 else 0 end as DANGKY        , NDV.TENNHOMDICHVU, isnull(G_CT.SOLAN,0) as SOLUONG, G_CT.LOAIGIA_ID        , ISNULL(NTH.PHONGBAN_ID, PB.PHONGBAN_ID) as NOITHUCHIEN_ID        , BS.NHANVIEN_ID AS BACSICHIDINH_ID, BS.TENNHANVIEN AS TENBACSICHIDINH        from TT_KSK_HOPDONG_BENHNHAN HD_BN        inner join TT_KSK_HOPDONG_GOIDICHVU G on G.HOPDONG_ID = HD_BN.HOPDONG_ID        left join TM_CSKH_GOI_CHITIET G_CT on G_CT.GOI_ID = G.GOIDICHVU_ID        inner join TT_KSK_HOPDONG_BENHNHAN_DICHVU HD_DV on HD_DV.HOPDONG_BENHNHAN_ID = HD_BN.HOPDONG_BENHNHAN_ID        inner join TM_DICHVU DV on DV.DICHVU_ID = HD_DV.DICHVU_ID and G_CT.DICHVU_ID = DV.DICHVU_ID        left join TM_PHONGBAN PB on PB.PHONGBAN_ID = HD_DV.PHONGBAN_ID        left join TM_NHOMDICHVU NDV on NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        LEFT JOIN TM_PHONGBAN NTH ON NTH.PHONGBAN_ID = G_CT.NOITHUCHIEN_ID        LEFT JOIN TM_NHANVIEN BS ON BS.NHANVIEN_ID = G_CT.BACSICHIDINH_ID        where HD_DV.HOPDONG_BENHNHAN_ID = '310'         and           HD_BN.BENHVIEN_ID = 'HLU01']
--------------------------------------------------------------------------------
2019-12-12 15:28:37,554 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2019-12-12 15:28:37,909 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-12-12 15:28:37,957 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-12-12 15:28:38,330 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 15:28:38,541 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-12-12 15:28:44,439 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2019-12-12 15:28:44,495 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-12-12 15:28:46,179 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-12-12 15:28:46,254 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-12-12 15:28:47,142 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2019-12-12 15:28:47,361 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2019-12-12 15:28:47,436 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2019-12-12 15:28:47,517 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2019-12-12 15:28:47,597 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2019-12-12 15:28:47,750 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2019-12-12 15:28:47,837 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2019-12-12 15:28:48,032 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2019-12-12 15:28:48,159 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2019-12-12 15:28:48,688 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2019-12-12 15:28:48,727 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2019-12-12 15:28:48,813 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2019-12-12 15:28:48,848 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2019-12-12 15:28:51,558 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2019-12-12 15:28:51,589 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @NGUONDUOC_MACDINH varchar(5) = '0';        declare @TOAMUANGOAI int = 0;        select @NGUONDUOC_MACDINH = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'PHA_NGUONDUOC'        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + @NGUONDUOC_MACDINH as DUOC_KEY, 0 as PHAMVI_ID, @NGUONDUOC_MACDINH as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end        else        begin                  select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2019-12-12 15:28:53,937 [5] DEBUG - Statement Id: [DAO00320_GetList] PreparedStatement : [select M.*            from TM_MAU M            LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID            where            M.TAMNGUNG = '0'            and M.BENHVIEN_ID = 'HLU01'            order by M.TENMAU]
2019-12-12 15:28:54,251 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2019-12-12 15:28:54,287 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,        SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH        FROM TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID        WHERE TK.SOLUONG > 0        GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2019-12-12 15:28:54,374 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2019-12-12 15:28:54,423 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,        TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,        TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH        from TM_MAU M        JOIN        (        select        A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO        from        (        select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO        from TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'        where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0        ) A        )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2019-12-12 15:28:54,488 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2019-12-12 15:28:55,403 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 15:28:56,130 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2019-12-12 15:29:00,157 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2019-12-12 15:29:00,191 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2019-12-12 15:29:00,319 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 15:29:00,451 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 15:29:00,585 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2019-12-12 15:29:00,588 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-12-12 15:29:00,588 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-12-12 15:29:00,920 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2019-12-12 15:29:00,920 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-12-12 15:29:00,920 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-12-12 15:29:01,050 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 15:29:01,303 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 15:29:08,828 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 15:29:08,911 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2019-12-12 15:29:09,145 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2019-12-12 15:29:22,695 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'HSM05'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 15:29:23,951 [1] DEBUG - Statement Id: [DAO00307_GetContractWithDate] PreparedStatement : [SELECT HD.*, HD.SO_HD + ' - ' + CT.TENCONGTY AS HOPDONG, CT.TENCONGTY        FROM TT_KSK_HOPDONG HD JOIN TT_KSK_CONGTY CT ON CT.CONGTY_ID = HD.CONGTY_ID         where                 HD.BENHVIEN_ID = 'HLU01']
2019-12-12 15:29:24,753 [1] DEBUG - Statement Id: [DAO00307_GetContractWithDate] PreparedStatement : [SELECT HD.*, HD.SO_HD + ' - ' + CT.TENCONGTY AS HOPDONG, CT.TENCONGTY        FROM TT_KSK_HOPDONG HD JOIN TT_KSK_CONGTY CT ON CT.CONGTY_ID = HD.CONGTY_ID         where                 HD.BENHVIEN_ID = 'HLU01']
2019-12-12 15:29:28,587 [1] DEBUG - Statement Id: [DAO00307_GetContractPatient] PreparedStatement : [SELECT HD_BN.*, LST.DICTIONARY_NAME AS HONNHAN        , CASE WHEN HD_BN.GIOITINH = '1' THEN N'Nam' ELSE N'Nữ' END AS GENDER        , CASE WHEN HD_BN.HOPDONG_BENHNHAN_ID IN (SELECT HOPDONG_BENHNHAN_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU) THEN 1 ELSE 0 END BENHNHAN_DANGKYKSK_DICHVU        , GOI.TENGOI        FROM TT_KSK_HOPDONG_BENHNHAN HD_BN        INNER JOIN TT_KSK_HOPDONG HD ON HD.HOPDONG_ID = HD_BN.HOPDONG_ID        LEFT JOIN LST_DICTIONARY LST ON LST.DICTIONARY_ID = HD_BN.TINHTRANGHONNHAN_ID AND LST.DICTIONARY_TYPE_CODE = 'TinhTrangGiaDinh'        LEFT JOIN TM_CSKH_GOI GOI ON GOI.GOI_ID = HD_BN.GOI_ID        WHERE HD.HOPDONG_ID = 4           AND               HD_BN.BENHVIEN_ID = 'HLU01']
2019-12-12 15:29:28,784 [1] DEBUG - Statement Id: [DAO00308_StatusContract] PreparedStatement : [SELECT * FROM TT_KSK_HOPDONG        WHERE HOPDONG_ID = 4]
2019-12-12 15:29:30,474 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhanDichVu] PreparedStatement : [SELECT distinct HD_BN.HOPDONG_ID, DV.TENDICHVU, ISNULL(NTH.TENPHONGBAN, PB.TENPHONGBAN) AS NOITHUCHIEN, NDV.TENNHOMDICHVU, ISNULL(GOI_CT.NOITHUCHIEN_ID, PB.PHONGBAN_ID) AS PHONGBAN_ID, DV.DICHVU_ID        , ISNULL(GOI_CT.DONGIATRONGGOI,0) AS DONGIA, ISNULL(GOI_CT.SOLAN,0) AS SOLUONG, GOI_CT.THANHTIENTRONGGOI AS THANHTIEN, BS.NHANVIEN_ID AS BACSICHIDINH_ID, BS.TENNHANVIEN AS TENBACSICHIDINH        , CASE WHEN DV.DICHVU_ID IN (SELECT DICHVU_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU WHERE HOPDONG_ID = '4' AND HOPDONG_BENHNHAN_ID = '318') THEN 1 ELSE 0 END AS DANGKY        FROM TT_KSK_HOPDONG HD                inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        INNER JOIN TM_CSKH_GOI_CHITIET GOI_CT ON GOI_CT.GOI_ID = HD_BN.GOI_ID        INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = GOI_CT.DICHVU_ID        LEFT JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        INNER JOIN TM_PHONGBAN_DICHVU PB_DV ON PB_DV.DICHVU_ID = DV.DICHVU_ID        LEFT JOIN TM_PHONGBAN PB ON PB.PHONGBAN_ID = PB_DV.PHONGBAN_ID        LEFT JOIN TM_PHONGBAN NTH ON NTH.PHONGBAN_ID = GOI_CT.NOITHUCHIEN_ID        LEFT JOIN TM_NHANVIEN BS ON BS.NHANVIEN_ID = GOI_CT.BACSICHIDINH_ID        WHERE GOI_CT.GOI_ID = 4 and HD_BN.HOPDONG_BENHNHAN_ID = 318]
2019-12-12 15:29:34,171 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhanDichVu] PreparedStatement : [SELECT distinct HD_BN.HOPDONG_ID, DV.TENDICHVU, ISNULL(NTH.TENPHONGBAN, PB.TENPHONGBAN) AS NOITHUCHIEN, NDV.TENNHOMDICHVU, ISNULL(GOI_CT.NOITHUCHIEN_ID, PB.PHONGBAN_ID) AS PHONGBAN_ID, DV.DICHVU_ID        , ISNULL(GOI_CT.DONGIATRONGGOI,0) AS DONGIA, ISNULL(GOI_CT.SOLAN,0) AS SOLUONG, GOI_CT.THANHTIENTRONGGOI AS THANHTIEN, BS.NHANVIEN_ID AS BACSICHIDINH_ID, BS.TENNHANVIEN AS TENBACSICHIDINH        , CASE WHEN DV.DICHVU_ID IN (SELECT DICHVU_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU WHERE HOPDONG_ID = '4' AND HOPDONG_BENHNHAN_ID = '319') THEN 1 ELSE 0 END AS DANGKY        FROM TT_KSK_HOPDONG HD                inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        INNER JOIN TM_CSKH_GOI_CHITIET GOI_CT ON GOI_CT.GOI_ID = HD_BN.GOI_ID        INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = GOI_CT.DICHVU_ID        LEFT JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        INNER JOIN TM_PHONGBAN_DICHVU PB_DV ON PB_DV.DICHVU_ID = DV.DICHVU_ID        LEFT JOIN TM_PHONGBAN PB ON PB.PHONGBAN_ID = PB_DV.PHONGBAN_ID        LEFT JOIN TM_PHONGBAN NTH ON NTH.PHONGBAN_ID = GOI_CT.NOITHUCHIEN_ID        LEFT JOIN TM_NHANVIEN BS ON BS.NHANVIEN_ID = GOI_CT.BACSICHIDINH_ID        WHERE GOI_CT.GOI_ID = 4 and HD_BN.HOPDONG_BENHNHAN_ID = 319]
2019-12-12 15:30:04,759 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhanDichVu] PreparedStatement : [SELECT distinct HD_BN.HOPDONG_ID, DV.TENDICHVU, ISNULL(NTH.TENPHONGBAN, PB.TENPHONGBAN) AS NOITHUCHIEN, NDV.TENNHOMDICHVU, ISNULL(GOI_CT.NOITHUCHIEN_ID, PB.PHONGBAN_ID) AS PHONGBAN_ID, DV.DICHVU_ID        , ISNULL(GOI_CT.DONGIATRONGGOI,0) AS DONGIA, ISNULL(GOI_CT.SOLAN,0) AS SOLUONG, GOI_CT.THANHTIENTRONGGOI AS THANHTIEN, BS.NHANVIEN_ID AS BACSICHIDINH_ID, BS.TENNHANVIEN AS TENBACSICHIDINH        , CASE WHEN DV.DICHVU_ID IN (SELECT DICHVU_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU WHERE HOPDONG_ID = '4' AND HOPDONG_BENHNHAN_ID = '319') THEN 1 ELSE 0 END AS DANGKY        FROM TT_KSK_HOPDONG HD                inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        INNER JOIN TM_CSKH_GOI_CHITIET GOI_CT ON GOI_CT.GOI_ID = HD_BN.GOI_ID        INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = GOI_CT.DICHVU_ID        LEFT JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        INNER JOIN TM_PHONGBAN_DICHVU PB_DV ON PB_DV.DICHVU_ID = DV.DICHVU_ID        LEFT JOIN TM_PHONGBAN PB ON PB.PHONGBAN_ID = PB_DV.PHONGBAN_ID        LEFT JOIN TM_PHONGBAN NTH ON NTH.PHONGBAN_ID = GOI_CT.NOITHUCHIEN_ID        LEFT JOIN TM_NHANVIEN BS ON BS.NHANVIEN_ID = GOI_CT.BACSICHIDINH_ID        WHERE GOI_CT.GOI_ID = 4 and HD_BN.HOPDONG_BENHNHAN_ID = 319]
2019-12-12 15:30:40,347 [1] DEBUG - Statement Id: [DAO00307_GetHopDongBenhNhanDichVu] PreparedStatement : [SELECT distinct HD_BN.HOPDONG_ID, DV.TENDICHVU, ISNULL(NTH.TENPHONGBAN, PB.TENPHONGBAN) AS NOITHUCHIEN, NDV.TENNHOMDICHVU, ISNULL(GOI_CT.NOITHUCHIEN_ID, PB.PHONGBAN_ID) AS PHONGBAN_ID, DV.DICHVU_ID        , ISNULL(GOI_CT.DONGIATRONGGOI,0) AS DONGIA, ISNULL(GOI_CT.SOLAN,0) AS SOLUONG, GOI_CT.THANHTIENTRONGGOI AS THANHTIEN, BS.NHANVIEN_ID AS BACSICHIDINH_ID, BS.TENNHANVIEN AS TENBACSICHIDINH        , CASE WHEN DV.DICHVU_ID IN (SELECT DICHVU_ID FROM TT_KSK_HOPDONG_BENHNHAN_DICHVU WHERE HOPDONG_ID = '4' AND HOPDONG_BENHNHAN_ID = '319') THEN 1 ELSE 0 END AS DANGKY        FROM TT_KSK_HOPDONG HD                inner join TT_KSK_HOPDONG_BENHNHAN HD_BN on HD_BN.HOPDONG_ID = HD.HOPDONG_ID        INNER JOIN TM_CSKH_GOI_CHITIET GOI_CT ON GOI_CT.GOI_ID = HD_BN.GOI_ID        INNER JOIN TM_DICHVU DV ON DV.DICHVU_ID = GOI_CT.DICHVU_ID        LEFT JOIN TM_NHOMDICHVU NDV ON NDV.NHOMDICHVU_ID = DV.NHOMDICHVU_ID        INNER JOIN TM_PHONGBAN_DICHVU PB_DV ON PB_DV.DICHVU_ID = DV.DICHVU_ID        LEFT JOIN TM_PHONGBAN PB ON PB.PHONGBAN_ID = PB_DV.PHONGBAN_ID        LEFT JOIN TM_PHONGBAN NTH ON NTH.PHONGBAN_ID = GOI_CT.NOITHUCHIEN_ID        LEFT JOIN TM_NHANVIEN BS ON BS.NHANVIEN_ID = GOI_CT.BACSICHIDINH_ID        WHERE GOI_CT.GOI_ID = 4 and HD_BN.HOPDONG_BENHNHAN_ID = 319]
--------------------------------------------------------------------------------
2019-12-12 15:35:38,633 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2019-12-12 15:35:38,913 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-12-12 15:35:38,954 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-12-12 15:35:39,384 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 15:35:39,606 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-12-12 15:35:45,741 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2019-12-12 15:35:45,769 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-12-12 15:35:47,238 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-12-12 15:35:47,312 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-12-12 15:35:48,232 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2019-12-12 15:35:48,375 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2019-12-12 15:35:48,450 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2019-12-12 15:35:48,521 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2019-12-12 15:35:48,593 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2019-12-12 15:35:48,683 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2019-12-12 15:35:48,763 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2019-12-12 15:35:49,337 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2019-12-12 15:35:49,452 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2019-12-12 15:35:49,968 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2019-12-12 15:35:50,004 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2019-12-12 15:35:50,077 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2019-12-12 15:35:50,110 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2019-12-12 15:35:51,691 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2019-12-12 15:35:51,723 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @NGUONDUOC_MACDINH varchar(5) = '0';        declare @TOAMUANGOAI int = 0;        select @NGUONDUOC_MACDINH = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'PHA_NGUONDUOC'        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + @NGUONDUOC_MACDINH as DUOC_KEY, 0 as PHAMVI_ID, @NGUONDUOC_MACDINH as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end        else        begin                  select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2019-12-12 15:35:53,820 [5] DEBUG - Statement Id: [DAO00320_GetList] PreparedStatement : [select M.*            from TM_MAU M            LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID            where            M.TAMNGUNG = '0'            and M.BENHVIEN_ID = 'HLU01'            order by M.TENMAU]
2019-12-12 15:35:54,187 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2019-12-12 15:35:54,228 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,        SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH        FROM TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID        WHERE TK.SOLUONG > 0        GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2019-12-12 15:35:54,302 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2019-12-12 15:35:54,362 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,        TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,        TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH        from TM_MAU M        JOIN        (        select        A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO        from        (        select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO        from TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'        where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0        ) A        )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2019-12-12 15:35:54,460 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2019-12-12 15:35:55,370 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 15:35:56,182 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2019-12-12 15:36:02,708 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2019-12-12 15:36:02,743 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2019-12-12 15:36:02,817 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 15:36:02,961 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 15:36:03,117 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2019-12-12 15:36:03,119 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-12-12 15:36:03,119 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-12-12 15:36:03,171 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2019-12-12 15:36:03,171 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-12-12 15:36:03,171 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-12-12 15:36:03,344 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 15:36:03,535 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 15:36:12,649 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 15:36:12,746 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2019-12-12 15:36:13,136 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
--------------------------------------------------------------------------------
2019-12-12 17:29:54,088 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = '_SYSTEM_' and TYPE = 'D']
2019-12-12 17:29:54,368 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = '_SYSTEM_' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-12-12 17:29:54,408 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = '_SYSTEM_')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = '_SYSTEM_' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-12-12 17:29:54,941 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_SCREEN.PAGE = 'LOGIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 17:29:55,190 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = '_SYSTEM_'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-12-12 17:30:02,846 [1] DEBUG - Statement Id: [DAO00001_DBList] PreparedStatement : [select *              from TM_SYS_SERVER              where HOSPITAL_ID = 'HLU01' and TYPE = 'D']
2019-12-12 17:30:02,884 [1] DEBUG - Statement Id: [DAO00001_DaoList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC              on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              where HOSPITAL_ID = 'HLU01' AND TYPE = 'D' AND ACTIVE = '1'              order by DB_NAME]
2019-12-12 17:30:05,709 [1] DEBUG - Statement Id: [DAO00001_ServiceList] PreparedStatement : [select              TM_SYS_SERVICEMAP.ID,              TM_SYS_SERVICEMAP.HOSPITAL_ID,              TM_SYS_SERVICEMAP.DB_NAME,              TM_SYS_SERVICEMAP.TYPE,              TM_SYS_SERVICEMAP.NAME,              TM_SYS_SERVICEMAP.CLASS,              (TM_SYS_DIC.VALUE + '.' + TM_SYS_SERVICEMAP.CLASS) as CLASSFULL,              TM_SYS_SERVICEMAP.ASSEMBLY,              TM_SYS_SERVER.URL              from TM_SYS_SERVICEMAP              inner join TM_SYS_DIC on TM_SYS_SERVICEMAP.NAMESPACE = TM_SYS_DIC.ID              inner join TM_SYS_SERVER on (TM_SYS_SERVICEMAP.DB_NAME = TM_SYS_SERVER.NAME) and (TM_SYS_SERVER.HOSPITAL_ID = 'HLU01')              where TM_SYS_SERVICEMAP.HOSPITAL_ID = 'HLU01' AND TM_SYS_SERVICEMAP.TYPE = 'S'  AND ACTIVE = '1'              order by URL]
2019-12-12 17:30:05,790 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1']
2019-12-12 17:30:06,755 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM005']
2019-12-12 17:30:07,025 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM015']
2019-12-12 17:30:07,117 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM067']
2019-12-12 17:30:07,194 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM008']
2019-12-12 17:30:07,263 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM068']
2019-12-12 17:30:07,339 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM006']
2019-12-12 17:30:07,497 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM030']
2019-12-12 17:30:07,567 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM025']
2019-12-12 17:30:07,651 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM024']
2019-12-12 17:30:08,160 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM033']
2019-12-12 17:30:08,195 [5] DEBUG - Statement Id: [DAO00027_GetListDuocKyGuiTonKho] PreparedStatement : [select  distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,TM_DUOC.PHAMVI,        TM_DUOC.TENHOATCHAT, TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,TT_TONKHO.SOLUONG, TT_TONKHO.NGUONDUOC_ID, NH.TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID,A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_KYGUI_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(A.NGUONDUOC_ID), A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID)        TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' AND TT_TONKHO.SOLUONG >= 0]
2019-12-12 17:30:08,291 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM018']
2019-12-12 17:30:08,766 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKho] PreparedStatement : [select distinct TT_TONKHO.DUOC_KEY, LTRIM(TT_TONKHO.KHODUOC_ID) as KHODUOC_ID, TM_DUOC.DUOC_ID, TM_LOAIDUOC.MALOAIDUOC,TM_DUOC.SOVISA,TM_DUOC.TYLE_VAT,TM_DUOC.COTOA,        TM_DUOC.MADUOC, TM_DUOC.TENHANG, TM_DUOC.TENDUOCDAYDU, dvt.TENDONVITINH as DONVITINH,  TM_DUOC.DONVITINH_ID,TM_DUOC.BHYT,                TM_DUOC.TENHOATCHAT,          TM_DUOC.HAMLUONG, TM_DUOC.HANGSANXUAT, TM_DUOC.QUOCGIA, TM_DUOC.LOAIDUOC_ID, TM_DUOC.DUONGDUNG_ID,        TM_TENDUOC.TENDUOC, TM_TENDUOC.TENDUOC_EN, TM_TENDUOC.MAQUOCTE, TM_TENDUOC.MAQUOCTEBT,        TM_LOAIDUOC.LOAIVATTU_ID, TM_DUOC.BENHVIEN_ID,        TT_TONKHO.SOLUONG, TM_DUOC.VTYT_PHANLOAI, TM_DUOC.PHAMVI, TT_TONKHO.NGUONDUOC_ID, NG.TENNGUONDUOC AS TENNGUONDUOC        , TAMNGUNG = CASE WHEN TM_DUOC.TAMNGUNG = '1' OR NG.TAMNGUNG = '1' OR KD.TAMNGUNG = '1' THEN '1' ELSE '0' END        , TM_DUOC.DANGTRINHBAY        from TM_DUOC        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = TM_DUOC.DONVITINH_ID        left join TM_TENDUOC on TM_DUOC.TENDUOC_ID = TM_TENDUOC.TENDUOC_ID and TM_DUOC.BENHVIEN_ID = 'HLU01' and TM_DUOC.TAMNGUNG = '0'        left join TM_LOAIDUOC on TM_LOAIDUOC.LOAIDUOC_ID = TM_DUOC.LOAIDUOC_ID and TM_LOAIDUOC.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG on (TM_LOAIDUOC.LOAIVATTU_ID = TM_DUOC_HANDUNG.LOAIDUOC and TM_DUOC_HANDUNG.BENHVIEN_ID = 'HLU01')        inner join        (select LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')) as DUOC_KEY, A.KHODUOC_ID, A.DUOC_ID, A.NGUONDUOC_ID,        SUM(isnull(A.SOLUONG,0)) as SOLUONG        from        (select SUM(SOLUONG) as SOLUONG, KHODUOC_ID, DUOC_ID, NGUONDUOC_ID from TT_DUOC_TONKHO        where BENHVIEN_ID = 'HLU01' group by KHODUOC_ID, DUOC_ID, NGUONDUOC_ID) A        group by LTRIM(A.KHODUOC_ID) + '_' + LTRIM(A.DUOC_ID) + '_' + LTRIM(ISNULL(A.NGUONDUOC_ID,'')), A.KHODUOC_ID, A.DUOC_ID, NGUONDUOC_ID        ) TT_TONKHO on TT_TONKHO.DUOC_ID = TM_DUOC.DUOC_ID        LEFT JOIN TM_NGUONHANG NG ON NG.NGUONDUOC_ID = TT_TONKHO.NGUONDUOC_ID        LEFT JOIN TM_KHODUOC KD ON KD.KHODUOC_ID = TT_TONKHO.KHODUOC_ID        where TM_DUOC.BENHVIEN_ID = 'HLU01' and TT_TONKHO.SOLUONG >= 0]
2019-12-12 17:30:10,923 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM023']
2019-12-12 17:30:10,993 [5] DEBUG - Statement Id: [DAO00027_GetListDuocTonKhoVaBooking] PreparedStatement : [declare @NGUONDUOC_MACDINH varchar(5) = '0';        declare @TOAMUANGOAI int = 0;        select @NGUONDUOC_MACDINH = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'PHA_NGUONDUOC'        select @TOAMUANGOAI = isnull(VALUE,0) from TM_SYS_APPSETTINGS where CODE = 'OPD_TOAMUANGOAI_DUNGDANHMUC_DUOC'                if @TOAMUANGOAI = 1        begin        select  distinct '0' + '_' + LTRIM(d.DUOC_ID) + '_' + @NGUONDUOC_MACDINH as DUOC_KEY, 0 as PHAMVI_ID, @NGUONDUOC_MACDINH as NGUONDUOC_ID, null as TENNGUONDUOC, null as TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        '' as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        999999999 as SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        union all        select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end        else        begin                  select  distinct tk.DUOC_KEY, LTRIM(tk.PHAMVI_ID) as PHAMVI_ID, tk.NGUONDUOC_ID, nh.TENNGUONDUOC, nh.TINHTIEN, d.DUOC_ID, ld.MALOAIDUOC,        d.SOVISA,d.TYLE_VAT,d.COTOA, d.MADUOC, d.TENHANG, d.TENDUOCDAYDU, d.DONVITINH as DONVITINH, d.BHYT,        d.TENHOATCHAT, d.HAMLUONG, d.HANGSANXUAT, d.QUOCGIA, d.LOAIDUOC_ID, d.DUONGDUNG_ID, d.TINHTIEN_PTTT,        ten.TENDUOC, ten.TENDUOC_EN, ten.MAQUOCTE, ten.MAQUOCTEBT,d.CONGDUNG,        CASE WHEN d.BHYT = '1' THEN 'BHYT' ELSE '' END as BHYT_TEXT        , ld.LOAIVATTU_ID        , d.BENHVIEN_ID,        tk.SOLUONG, d.VTYT_PHANLOAI, d.PHAMVI, d.SUASOLUONGTONGHOP, d.MADUOCBV, d.DANGTRINHBAY        , TAMNGUNG = CASE WHEN d.TAMNGUNG = '1' OR nh.TAMNGUNG = '1' OR kd.TAMNGUNG = '1' THEN '1' ELSE '0' END        from TM_DUOC d        left join TM_DONVITINH dvt on dvt.DONVITINH_ID = d.DONVITINH_ID        left join TM_TENDUOC ten on d.TENDUOC_ID = ten.TENDUOC_ID        left join TM_LOAIDUOC ld on ld.LOAIDUOC_ID = d.LOAIDUOC_ID and ld.BENHVIEN_ID = 'HLU01'        left join TM_DUOC_HANDUNG hd on (ld.LOAIVATTU_ID = hd.LOAIDUOC  and hd.BENHVIEN_ID = 'HLU01')        inner join        (        select  LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')) DUOC_KEY, (SUM(dtk.SOLUONG) - isnull(sum(A.SOLUONG),0) - isnull(sum(B.SOLUONG),0)) SOLUONG, pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        from (select sum(soluong) soluong,duoc_id,nguonduoc_id,khoduoc_id,benhvien_id from TT_DUOC_TONKHO  group by duoc_id,nguonduoc_id,khoduoc_id,benhvien_id) dtk        inner join TM_DUOC_PHAMVISD_MAPPING pvsd on dtk.KHODUOC_ID = pvsd.KHODUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NOITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) B on B.DUOC_ID = dtk.DUOC_ID and B.SOLUONG > 0 and B.PHAMVI_ID = pvsd.PHAMVI_ID and B.NGUONHANG_ID = dtk.NGUONDUOC_ID        left join (select sum(SOLUONG) SOLUONG, PHAMVI_ID, DUOC_ID, NGUONHANG_ID from  TT_DUOC_TONKHO_BOOK_NGOAITRU where TRANGTHAI != 'HUY'        group by  PHAMVI_ID, DUOC_ID, NGUONHANG_ID) A on A.DUOC_ID = dtk.DUOC_ID and A.SOLUONG > 0 and A.PHAMVI_ID = pvsd.PHAMVI_ID and A.NGUONHANG_ID = dtk.NGUONDUOC_ID        where dtk.SOLUONG > 0 and dtk.BENHVIEN_ID = 'HLU01'        group by LTRIM(pvsd.PHAMVI_ID)  + '_' + LTRIM(dtk.DUOC_ID) + '_' + LTRIM(ISNULL(dtk.NGUONDUOC_ID,'')), pvsd.PHAMVI_ID, dtk.NGUONDUOC_ID, dtk.DUOC_ID        ) tk on tk.DUOC_ID = d.DUOC_ID        left join TM_DUOC_PHAMVISUDUNG kd on kd.PHAMVI_ID = tk.PHAMVI_ID and kd.BENHVIEN_ID = 'HLU01'        left join TM_NGUONHANG nh on nh.NGUONDUOC_ID = tk.NGUONDUOC_ID and nh.BENHVIEN_ID = 'HLU01'        where d.BENHVIEN_ID = 'HLU01'  and tk.SOLUONG >= 0        end]
2019-12-12 17:30:13,571 [5] DEBUG - Statement Id: [DAO00320_GetList] PreparedStatement : [select M.*            from TM_MAU M            LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID            where            M.TAMNGUNG = '0'            and M.BENHVIEN_ID = 'HLU01'            order by M.TENMAU]
2019-12-12 17:30:14,331 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM071']
2019-12-12 17:30:14,366 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoForCreateCached] PreparedStatement : [SELECT DISTINCT        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,        SUM(tk.SOLUONG) AS SOLUONG,K.TENKHO,DVT.TENDONVITINH        FROM TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        JOIN TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        JOIN TM_MAU M on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID        WHERE TK.SOLUONG > 0        GROUP BY TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID,        TK.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT,TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID, M.DONVITINH_ID,K.TENKHO,DVT.TENDONVITINH]
2019-12-12 17:30:14,487 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM073']
2019-12-12 17:30:14,519 [5] DEBUG - Statement Id: [DAO00322_GetListMauTonKhoTruBooking] PreparedStatement : [select distinct        TK.MAU_KEY, TK.KHOMAU_ID, M.MAU_ID, M.MAMAU, M.TENMAU, M.NHOM_ABO, M.NHOM_RH, M.LOAIMAU_ID, M.DONVITINH_ID,        TK.SOLONHAP_ID, TK.SOLONHAP, TK.SOKIEMSOAT,M.PHAMVI, TK.NGUONHANG_ID, NG.TENNGUONMAU, M.BENHVIEN_ID,        TK.SOLUONG,TK.TENKHO,DVT.TENDONVITINH        from TM_MAU M        JOIN        (        select        A.MAU_KEY, A.KHOMAU_ID, A.MAU_ID ,a.NGUONHANG_ID, A.SOLONHAP_ID, A.SOLONHAP, A.SOKIEMSOAT, A.SOLUONG,A.TENKHO        from        (        select KHOMAU_ID, TK.MAU_ID, TK.NGUONHANG_ID, TK.MAU_KEY, SLN.SOLONHAP_ID, SLN.SOLONHAP, SLN.SOKIEMSOAT, ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) as SOLUONG,K.TENKHO        from TT_MAU_TONKHO TK        JOIN TM_KHO K ON TK.KHOMAU_ID = K.KHO_ID        inner join TT_MAU_CHUNGTU_SOLONHAP SLN ON TK.SOLONHAP_ID = SLN.SOLONHAP_ID        left join dbo.TT_MAU_TONKHO_BOOK book ON book.MAU_KEY = TK.MAU_KEY AND book.TRANGTHAI = 'HIEULUC'        where ISNULL(TK.SOLUONG,0) - ISNULL(book.SOLUONG,0) > 0        ) A        )TK on TK.MAU_ID = M.MAU_ID and M.TAMNGUNG = '0'        LEFT JOIN TM_MAU_DONVITINH DVT on M.DONVITINH_ID=DVT.DONVITINH_ID        LEFT JOIN TM_NGUONMAU NG ON NG.NGUONMAU_ID = TK.NGUONHANG_ID]
2019-12-12 17:30:14,588 [5] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_CACHE.ACTIVE = '1'               AND                   TM_SYS_CACHE.DAO_ID = 'COM072']
2019-12-12 17:30:15,506 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MAIN'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 17:30:16,902 [1] DEBUG - Statement Id: [DAO00002_FormList] PreparedStatement : [select              TM_SYS_FORM.HOSPITAL_ID,              TM_SYS_FORM.NAME,              TM_SYS_FORM.CLASS,              TM_SYS_FORM.ASSEMBLY,              TM_SYS_FORM.TITLE_VI as TITLE              from TM_SYS_FORM              where HOSPITAL_ID = 'HLU01']
2019-12-12 17:30:22,846 [1] DEBUG - Statement Id: [DAO00300_GetShortcutListByUserID] PreparedStatement : [SELECT S.SHORTCUT_CODE, S.SHORTCUT_VALUE              FROM TM_SHORTCUT AS S              WHERE S.BENHVIEN_ID = 'HLU01' AND S.USER_ID = '1' AND TAMNGUNG = '0']
2019-12-12 17:30:22,876 [1] DEBUG - Statement Id: [DAO00087_GetList] PreparedStatement : [select CODE, VALUE, BENHVIEN_ID              from TM_SYS_APPSETTINGS              where LOCKED = '0' and BENHVIEN_ID = 'HLU01'              order by SETTING_ID]
2019-12-12 17:30:22,954 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG01'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 17:30:23,083 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MSG02'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 17:30:23,341 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] PreparedStatement : [select A.*, B.TENKHO , C.TENPHONGBAN, B.MAKHO, C.MAPHONGBAN          from TM_SYS_USERS A          left join TM_KHODUOC B on B.KHODUOC_ID = A.INVENTORY_ID          left join TM_PHONGBAN C on (C.PHONGBAN_ID = A.WORKING_DEPT_ID and C.BENHVIEN_ID =  @param0 )          left join TM_SYS_USERKHO D on (D.ACCOUNT_ID = A.ACCOUNT_ID and D.HOSPITAL_ID =  @param0 )          where          A.HOSPITAL_ID =  @param0            and                 A.ACCOUNT_ID =  @param1]
2019-12-12 17:30:23,347 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-12-12 17:30:23,347 [1] DEBUG - Statement Id: [DAO00008_GetUserSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-12-12 17:30:24,165 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] PreparedStatement : [select A.*, B.TENKHO, B.MAKHO, B.LOAIKHO_ID, B.KHOQUANLY_ID          from TM_SYS_USERKHO A          left join TM_KHO B on B.MODULE_ID = A.MODULE_ID and B.KHO_ID = A.KHO_ID          where A.HOSPITAL_ID =  @param0  and A.ACCOUNT_ID =  @param1           order by B.TENKHO]
2019-12-12 17:30:24,165 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Parameters: [@param0=[HOSPITAL_ID,HLU01], @param1=[ACCOUNT_ID,113]]
2019-12-12 17:30:24,165 [1] DEBUG - Statement Id: [DAO00008_GetUserInvSettings] Types: [@param0=[String, System.String], @param1=[String, System.String]]
2019-12-12 17:30:24,304 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 17:30:24,550 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS04'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 17:30:35,805 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'MENU1'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 17:30:35,912 [1] DEBUG - Statement Id: [DAO00011_GetList] PreparedStatement : [select              TM_SYS_MENU.ID,              TM_SYS_MENU.PARENTID,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.DESCRIPTION,              TM_SYS_MENU.TYPE,              TM_SYS_MENU.TITLE_VI as TITLE              from TM_SYS_MENU              where TM_SYS_MENU.HOSPITAL_ID = 'HLU01' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             order by TM_SYS_MENU.ORDERNUM]
2019-12-12 17:30:36,286 [1] DEBUG - Statement Id: [DAO00011_usermenu_list] PreparedStatement : [select              TM_SYS_HOMEMENU.MENUID as ID,              TM_SYS_MENU.TITLE_VI as TITLE,              TM_SYS_MENU.SCREEN,              TM_SYS_MENU.SMALLIMAGE,              TM_SYS_MENU.LARGEIMAGE,              TM_SYS_MENU.TYPE              from TM_SYS_HOMEMENU              left join TM_SYS_MENU on TM_SYS_MENU.ID = TM_SYS_HOMEMENU.MENUID and TM_SYS_MENU.HOSPITAL_ID = TM_SYS_HOMEMENU.HOSPITAL_ID              where TM_SYS_HOMEMENU.HOSPITAL_ID = 'HLU01' and TM_SYS_HOMEMENU.USERID = '113' and TM_SYS_MENU.ACTIVE = '1'               AND                   (TM_SYS_MENU.TYPE & '8' = '8')                             ORDER BY TM_SYS_HOMEMENU.ORDERNUM]
2019-12-12 17:30:54,388 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM98'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 17:30:55,128 [1] DEBUG - Statement Id: [DAO00020_ListKhoDuocOfPhongBan] PreparedStatement : [select B.* from TM_PHONGBAN_KHODUOC A        inner join TM_KHODUOC B on B.KHODUOC_ID = A.KHODUOC_ID        where        A.PHONGBAN_ID = '68'        and A.BENHVIEN_ID = 'HLU01']
2019-12-12 17:31:00,115 [1] DEBUG - Statement Id: [DAO00020_ListKhoDuocOfPhongBan] PreparedStatement : [select B.* from TM_PHONGBAN_KHODUOC A        inner join TM_KHODUOC B on B.KHODUOC_ID = A.KHODUOC_ID        where        A.PHONGBAN_ID = '34'        and A.BENHVIEN_ID = 'HLU01']
2019-12-12 17:31:00,312 [1] DEBUG - Statement Id: [DAO00008_UpdateUserIdPhongBanKhoDuoc] PreparedStatement : [IF EXISTS            (SELECT ACCOUNT_ID FROM TM_SYS_USERS WHERE ACCOUNT_ID =  @param0  and HOSPITAL_ID =  @param1 )            BEGIN            update TM_SYS_USERS set INVENTORY_ID =  @param2 , WORKING_DEPT_ID =  @param3             WHERE ACCOUNT_ID =  @param0  and HOSPITAL_ID =  @param1             END            ELSE            BEGIN            insert into TM_SYS_USERS ([ACCOUNT_ID], [ACCOUNT_NAME], [INVENTORY_ID], [WORKING_DEPT_ID], [HOSPITAL_ID])            values ( @param0 ,  @param4 ,  @param2 ,  @param3 ,  @param1 )            END]
2019-12-12 17:31:00,312 [1] DEBUG - Statement Id: [DAO00008_UpdateUserIdPhongBanKhoDuoc] Parameters: [@param0=[ACCOUNT_ID,113], @param1=[HOSPITAL_ID,HLU01], @param2=[INVENTORY_ID,11], @param3=[WORKING_DEPT_ID,34], @param4=[ACCOUNT_NAME,admin]]
2019-12-12 17:31:00,312 [1] DEBUG - Statement Id: [DAO00008_UpdateUserIdPhongBanKhoDuoc] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[String, System.String], @param3=[String, System.String], @param4=[String, System.String]]
2019-12-12 17:31:04,121 [1] DEBUG - Statement Id: [DAO00020_ListKhoDuocOfPhongBan] PreparedStatement : [select B.* from TM_PHONGBAN_KHODUOC A        inner join TM_KHODUOC B on B.KHODUOC_ID = A.KHODUOC_ID        where        A.PHONGBAN_ID = ''        and A.BENHVIEN_ID = 'HLU01']
2019-12-12 17:31:04,419 [1] DEBUG - Statement Id: [DAO00020_ListKhoDuocOfPhongBan] PreparedStatement : [select B.* from TM_PHONGBAN_KHODUOC A        inner join TM_KHODUOC B on B.KHODUOC_ID = A.KHODUOC_ID        where        A.PHONGBAN_ID = '34'        and A.BENHVIEN_ID = 'HLU01']
2019-12-12 17:31:12,183 [1] DEBUG - Statement Id: [DAO00020_ListKhoDuocOfPhongBan] PreparedStatement : [select B.* from TM_PHONGBAN_KHODUOC A        inner join TM_KHODUOC B on B.KHODUOC_ID = A.KHODUOC_ID        where        A.PHONGBAN_ID = '77'        and A.BENHVIEN_ID = 'HLU01']
2019-12-12 17:31:12,359 [1] DEBUG - Statement Id: [DAO00008_UpdateUserIdPhongBanKhoDuoc] PreparedStatement : [IF EXISTS            (SELECT ACCOUNT_ID FROM TM_SYS_USERS WHERE ACCOUNT_ID =  @param0  and HOSPITAL_ID =  @param1 )            BEGIN            update TM_SYS_USERS set INVENTORY_ID =  @param2 , WORKING_DEPT_ID =  @param3             WHERE ACCOUNT_ID =  @param0  and HOSPITAL_ID =  @param1             END            ELSE            BEGIN            insert into TM_SYS_USERS ([ACCOUNT_ID], [ACCOUNT_NAME], [INVENTORY_ID], [WORKING_DEPT_ID], [HOSPITAL_ID])            values ( @param0 ,  @param4 ,  @param2 ,  @param3 ,  @param1 )            END]
2019-12-12 17:31:12,359 [1] DEBUG - Statement Id: [DAO00008_UpdateUserIdPhongBanKhoDuoc] Parameters: [@param0=[ACCOUNT_ID,113], @param1=[HOSPITAL_ID,HLU01], @param2=[INVENTORY_ID,11], @param3=[WORKING_DEPT_ID,77], @param4=[ACCOUNT_NAME,admin]]
2019-12-12 17:31:12,359 [1] DEBUG - Statement Id: [DAO00008_UpdateUserIdPhongBanKhoDuoc] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[String, System.String], @param3=[String, System.String], @param4=[String, System.String]]
2019-12-12 17:31:16,152 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS03'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 17:31:18,943 [1] DEBUG - Statement Id: [DAO00006_GetDSNhomDichVu] PreparedStatement : [select * from TM_NHOMDICHVU              where captren_id =              (select top (1) NHOMDICHVU_ID from TM_NHOMDICHVU where MANHOMDICHVU = '02')              and BENHVIEN_ID = 'HLU01']
2019-12-12 17:31:18,977 [1] DEBUG - Statement Id: [DAO00006_GetDSNhomDichVu] PreparedStatement : [select * from TM_NHOMDICHVU              where captren_id =              (select top (1) NHOMDICHVU_ID from TM_NHOMDICHVU where MANHOMDICHVU = '03')              and BENHVIEN_ID = 'HLU01']
2019-12-12 17:31:19,416 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS30'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 17:31:19,821 [1] DEBUG - Statement Id: [DAO00019_DanhSachCDHA] PreparedStatement : [declare @TenBenhVien nvarchar(500)        declare @ManhomDSA varchar(10);        set @TenBenhVien = (select VALUE from TM_SYS_APPSETTINGS where CODE = 'APP_BENHVIEN_TEN')        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        select * from(        select ROW_NUMBER() OVER(order by NGAYGIOYEUCAU) as ROWNUMBER, *        from        (SELECT distinct        COUNT(*) OVER() as TOTALROWS,        N'Mã người bệnh: ' + bn.MAYTE + ' - ' + N'Tên người bệnh: ' + bn.TENBENHNHAN + ' - ' + N'Số bệnh án: ' + ISNULL(BA.SOBENHAN,'') + ' - ' + N'Sinh ngày: ' + isnull(Convert(varchar(10),bn.NGAYSINH,103),bn.NAMSINH) + ' - ' + N'Giới tính: ' + GD.DESCRIPTION as GROUPNAME,        bn.MAYTE, bn.TENBENHNHAN, bn.NAMSINH, bn.NGAYSINH as TUOI, ISNULL(CONVERT(VARCHAR(10), bn.NGAYSINH, 103),CAST(bn.NAMSINH AS varchar)) as NGAYSINH, bn.DIACHILIENLAC as DIACHI, bn.GIOITINH, GD.DESCRIPTION as TENGIOITINH,        tn.DOITUONG_ID, tn.THOIGIANTIEPNHAN, tn.BENHNHAN_ID, tn.TIEPNHAN_ID, tn.TRAITUYEN, tn.SOTIEPNHAN,        dv.DICHVU_ID, dv.NOITHUCHIEN_ID, isnull(dv.NGAYTAO, dv.NGAYCAPNHAT) as THOIGIANDKDICHVU,        dv.KHAN, dv.NOIYEUCAU_ID, dv.NGAYGIOYEUCAU, dv.BACSICHIDINH_ID, dv.DONVIGIOITHIEU_ID, dv.NGUOIGIOITHIEU_ID, dv.TRANGTHAI_WFL,        tn.NOIGIOITHIEU_ID, kbnt.HUONGGIAIQUYET_ID,        dv.DVYEUCAU_ID, dv.MARIS, dv.TRANGTHAI as TRANGTHAICODE, B.TENNHOMDICHVU, dv.SOPHIEUYEUCAU, dv.KHAMBENH_NGOAITRU_ID, dv.NGUOICAPNHAT_ID, dv.NGAYCAPNHAT,        CASE        WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU        WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2) END AS MANHOMDICHVU, B.MANHOMDICHVU as MANHOMDICHVUCHITIET, tn.TRANGTHAI as TRANGTHAI_TIEPNHAN,        'False' as DAKHAM,        vp.DATHANHTOAN, vp.DONGIA_DOANHTHU, BA.SOBENHAN, dv.CHANDOAN        , a.TENDICHVU, nth.TENPHONGBAN as TENPHONGKHAM, nyc.TENPHONGBAN as TENKHOACHIDINH        , case when (dv.DONVIGIOITHIEU_ID is not null and dv.DONVIGIOITHIEU_ID != '') then ngt.TENBENHVIEN else @TenBenhVien end as TENBENHVIENCHIDINH        , case when (dv.BACSICHIDINH_ID is not null and dv.BACSICHIDINH_ID != '') then bscd.TENNHANVIEN else ngtt.TENNHANVIEN end as TENBACSICHIDINH          ,             0 as GUINGOAI, 0 as VTYT, 0 as CLSKETQUA_ID                   FROM TT_DVYEUCAU (NOLOCK) dv        inner join TT_TIEPNHAN (NOLOCK) tn on dv.TIEPNHAN_ID = tn.TIEPNHAN_ID        inner join TT_BENHNHAN (NOLOCK) bn on tn.BENHNHAN_ID = bn.BENHNHAN_ID        inner join TM_DICHVU A on A.DICHVU_ID = dv.DICHVU_ID        inner join TM_PHONGBAN nth on nth.PHONGBAN_ID = dv.NOITHUCHIEN_ID        left join TM_BENHVIEN ngt on ngt.BENHVIEN_STT_ID = dv.DONVIGIOITHIEU_ID        left join TM_NHANVIEN bscd on bscd.NHANVIEN_ID = dv.BACSICHIDINH_ID        left join TM_NHANVIEN ngtt on ngtt.NHANVIEN_ID = dv.NGUOIGIOITHIEU_ID        inner join TM_PHONGBAN nyc on nyc.PHONGBAN_ID = dv.NOIYEUCAU_ID        inner join TM_NHOMDICHVU B on B.NHOMDICHVU_ID = A.NHOMDICHVU_ID        inner join TT_VIENPHI (NOLOCK) VP on VP.TIEPNHAN_ID = tn.TIEPNHAN_ID and VP.DICHVU_ID = dv.DICHVU_ID and VP.REF_ID = dv.DVYEUCAU_ID        left join TT_NOITRU_BENHAN (NOLOCK) BA on BA.TIEPNHAN_ID = tn.TIEPNHAN_ID AND dv.BENHAN_ID = BA.BENHAN_ID        inner join TM_GENDER GD on GD.ID = bn.GIOITINH        left join TT_NGOAITRU_KHAMBENH (NOLOCK) kbnt on kbnt.KHAMBENH_ID = dv.KHAMBENH_NGOAITRU_ID                 where        dv.DICHVU_ID IS NOT NULL        and tn.BENHVIEN_ID = 'HLU01'        and HUYYEUCAU = 0        and dv.NGAYHENCLS is NULL                       and dv.TRANGTHAI = 'CHUAKETQUA'           and           dv.NGAYYEUCAU >= '12/12/2019 12:00:00 AM'         and           dv.NGAYYEUCAU <= '12/12/2019 12:00:00 AM'         and           dv.NOITHUCHIEN_ID = 77         and           (vp.DATHANHTOAN = '1'  or vp.DONGIA_DOANHTHU = '0' OR TN.SUDUNG_BHTN='1' OR TN.BAOLANH_VIENPHI='1'  OR tn.TRANGTHAI IN ('NOITRU','CAPCUU','NGOAITRU') or dv.HOPDONG_BENHNHAN_ID is not null or vp.BENHNHAN_PHAITHANHTOAN >= 0)         and           (CASE          WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU          WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2) END) in (02)         and           tn.TRANGTHAI IN ('DATIEPNHAN','NOITRU','CAPCUU','NGOAITRU', 'HOANTHANH')                 ) data1) lst                    where          lst.ROWNUMBER between 1 and 5                 order by NGAYGIOYEUCAU asc]
2019-12-12 17:31:21,363 [1] DEBUG - Statement Id: [DAO00019_DanhSachCDHA] PreparedStatement : [declare @TenBenhVien nvarchar(500)        declare @ManhomDSA varchar(10);        set @TenBenhVien = (select VALUE from TM_SYS_APPSETTINGS where CODE = 'APP_BENHVIEN_TEN')        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        select * from(        select ROW_NUMBER() OVER(order by NGAYGIOYEUCAU) as ROWNUMBER, *        from        (SELECT distinct        COUNT(*) OVER() as TOTALROWS,        N'Mã người bệnh: ' + bn.MAYTE + ' - ' + N'Tên người bệnh: ' + bn.TENBENHNHAN + ' - ' + N'Số bệnh án: ' + ISNULL(BA.SOBENHAN,'') + ' - ' + N'Sinh ngày: ' + isnull(Convert(varchar(10),bn.NGAYSINH,103),bn.NAMSINH) + ' - ' + N'Giới tính: ' + GD.DESCRIPTION as GROUPNAME,        bn.MAYTE, bn.TENBENHNHAN, bn.NAMSINH, bn.NGAYSINH as TUOI, ISNULL(CONVERT(VARCHAR(10), bn.NGAYSINH, 103),CAST(bn.NAMSINH AS varchar)) as NGAYSINH, bn.DIACHILIENLAC as DIACHI, bn.GIOITINH, GD.DESCRIPTION as TENGIOITINH,        tn.DOITUONG_ID, tn.THOIGIANTIEPNHAN, tn.BENHNHAN_ID, tn.TIEPNHAN_ID, tn.TRAITUYEN, tn.SOTIEPNHAN,        dv.DICHVU_ID, dv.NOITHUCHIEN_ID, isnull(dv.NGAYTAO, dv.NGAYCAPNHAT) as THOIGIANDKDICHVU,        dv.KHAN, dv.NOIYEUCAU_ID, dv.NGAYGIOYEUCAU, dv.BACSICHIDINH_ID, dv.DONVIGIOITHIEU_ID, dv.NGUOIGIOITHIEU_ID, dv.TRANGTHAI_WFL,        tn.NOIGIOITHIEU_ID, kbnt.HUONGGIAIQUYET_ID,        dv.DVYEUCAU_ID, dv.MARIS, dv.TRANGTHAI as TRANGTHAICODE, B.TENNHOMDICHVU, dv.SOPHIEUYEUCAU, dv.KHAMBENH_NGOAITRU_ID, dv.NGUOICAPNHAT_ID, dv.NGAYCAPNHAT,        CASE        WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU        WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2) END AS MANHOMDICHVU, B.MANHOMDICHVU as MANHOMDICHVUCHITIET, tn.TRANGTHAI as TRANGTHAI_TIEPNHAN,        'False' as DAKHAM,        vp.DATHANHTOAN, vp.DONGIA_DOANHTHU, BA.SOBENHAN, dv.CHANDOAN        , a.TENDICHVU, nth.TENPHONGBAN as TENPHONGKHAM, nyc.TENPHONGBAN as TENKHOACHIDINH        , case when (dv.DONVIGIOITHIEU_ID is not null and dv.DONVIGIOITHIEU_ID != '') then ngt.TENBENHVIEN else @TenBenhVien end as TENBENHVIENCHIDINH        , case when (dv.BACSICHIDINH_ID is not null and dv.BACSICHIDINH_ID != '') then bscd.TENNHANVIEN else ngtt.TENNHANVIEN end as TENBACSICHIDINH          ,             0 as GUINGOAI, 0 as VTYT, 0 as CLSKETQUA_ID                   FROM TT_DVYEUCAU (NOLOCK) dv        inner join TT_TIEPNHAN (NOLOCK) tn on dv.TIEPNHAN_ID = tn.TIEPNHAN_ID        inner join TT_BENHNHAN (NOLOCK) bn on tn.BENHNHAN_ID = bn.BENHNHAN_ID        inner join TM_DICHVU A on A.DICHVU_ID = dv.DICHVU_ID        inner join TM_PHONGBAN nth on nth.PHONGBAN_ID = dv.NOITHUCHIEN_ID        left join TM_BENHVIEN ngt on ngt.BENHVIEN_STT_ID = dv.DONVIGIOITHIEU_ID        left join TM_NHANVIEN bscd on bscd.NHANVIEN_ID = dv.BACSICHIDINH_ID        left join TM_NHANVIEN ngtt on ngtt.NHANVIEN_ID = dv.NGUOIGIOITHIEU_ID        inner join TM_PHONGBAN nyc on nyc.PHONGBAN_ID = dv.NOIYEUCAU_ID        inner join TM_NHOMDICHVU B on B.NHOMDICHVU_ID = A.NHOMDICHVU_ID        inner join TT_VIENPHI (NOLOCK) VP on VP.TIEPNHAN_ID = tn.TIEPNHAN_ID and VP.DICHVU_ID = dv.DICHVU_ID and VP.REF_ID = dv.DVYEUCAU_ID        left join TT_NOITRU_BENHAN (NOLOCK) BA on BA.TIEPNHAN_ID = tn.TIEPNHAN_ID AND dv.BENHAN_ID = BA.BENHAN_ID        inner join TM_GENDER GD on GD.ID = bn.GIOITINH        left join TT_NGOAITRU_KHAMBENH (NOLOCK) kbnt on kbnt.KHAMBENH_ID = dv.KHAMBENH_NGOAITRU_ID                 where        dv.DICHVU_ID IS NOT NULL        and tn.BENHVIEN_ID = 'HLU01'        and HUYYEUCAU = 0        and dv.NGAYHENCLS is NULL                       and dv.TRANGTHAI = 'CHUAKETQUA'           and           dv.NGAYYEUCAU >= '12/12/2019 12:00:00 AM'         and           dv.NGAYYEUCAU <= '12/12/2019 12:00:00 AM'         and           dv.NOITHUCHIEN_ID = 77         and           (vp.DATHANHTOAN = '1'  or vp.DONGIA_DOANHTHU = '0' OR TN.SUDUNG_BHTN='1' OR TN.BAOLANH_VIENPHI='1'  OR tn.TRANGTHAI IN ('NOITRU','CAPCUU','NGOAITRU') or dv.HOPDONG_BENHNHAN_ID is not null or vp.BENHNHAN_PHAITHANHTOAN >= 0)         and           (CASE          WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU          WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2) END) in (02)         and           tn.TRANGTHAI IN ('DATIEPNHAN','NOITRU','CAPCUU','NGOAITRU', 'HOANTHANH')                 ) data1) lst                    where          lst.ROWNUMBER between 1 and 5                 order by NGAYGIOYEUCAU asc]
2019-12-12 17:31:34,220 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'RIS31'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 17:31:34,320 [1] DEBUG - Statement Id: [DAO00019_DanhSachCDHA] PreparedStatement : [declare @TenBenhVien nvarchar(500)        declare @ManhomDSA varchar(10);        set @TenBenhVien = (select VALUE from TM_SYS_APPSETTINGS where CODE = 'APP_BENHVIEN_TEN')        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        select * from(        select ROW_NUMBER() OVER(order by NGAYGIOYEUCAU) as ROWNUMBER, *        from        (SELECT distinct        COUNT(*) OVER() as TOTALROWS,        N'Mã người bệnh: ' + bn.MAYTE + ' - ' + N'Tên người bệnh: ' + bn.TENBENHNHAN + ' - ' + N'Số bệnh án: ' + ISNULL(BA.SOBENHAN,'') + ' - ' + N'Sinh ngày: ' + isnull(Convert(varchar(10),bn.NGAYSINH,103),bn.NAMSINH) + ' - ' + N'Giới tính: ' + GD.DESCRIPTION as GROUPNAME,        bn.MAYTE, bn.TENBENHNHAN, bn.NAMSINH, bn.NGAYSINH as TUOI, ISNULL(CONVERT(VARCHAR(10), bn.NGAYSINH, 103),CAST(bn.NAMSINH AS varchar)) as NGAYSINH, bn.DIACHILIENLAC as DIACHI, bn.GIOITINH, GD.DESCRIPTION as TENGIOITINH,        tn.DOITUONG_ID, tn.THOIGIANTIEPNHAN, tn.BENHNHAN_ID, tn.TIEPNHAN_ID, tn.TRAITUYEN, tn.SOTIEPNHAN,        dv.DICHVU_ID, dv.NOITHUCHIEN_ID, isnull(dv.NGAYTAO, dv.NGAYCAPNHAT) as THOIGIANDKDICHVU,        dv.KHAN, dv.NOIYEUCAU_ID, dv.NGAYGIOYEUCAU, dv.BACSICHIDINH_ID, dv.DONVIGIOITHIEU_ID, dv.NGUOIGIOITHIEU_ID, dv.TRANGTHAI_WFL,        tn.NOIGIOITHIEU_ID, kbnt.HUONGGIAIQUYET_ID,        dv.DVYEUCAU_ID, dv.MARIS, dv.TRANGTHAI as TRANGTHAICODE, B.TENNHOMDICHVU, dv.SOPHIEUYEUCAU, dv.KHAMBENH_NGOAITRU_ID, dv.NGUOICAPNHAT_ID, dv.NGAYCAPNHAT,        CASE        WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU        WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2) END AS MANHOMDICHVU, B.MANHOMDICHVU as MANHOMDICHVUCHITIET, tn.TRANGTHAI as TRANGTHAI_TIEPNHAN,        'True' as DAKHAM,        vp.DATHANHTOAN, vp.DONGIA_DOANHTHU, BA.SOBENHAN, dv.CHANDOAN        , a.TENDICHVU, nth.TENPHONGBAN as TENPHONGKHAM, nyc.TENPHONGBAN as TENKHOACHIDINH        , case when (dv.DONVIGIOITHIEU_ID is not null and dv.DONVIGIOITHIEU_ID != '') then ngt.TENBENHVIEN else @TenBenhVien end as TENBENHVIENCHIDINH        , case when (dv.BACSICHIDINH_ID is not null and dv.BACSICHIDINH_ID != '') then bscd.TENNHANVIEN else ngtt.TENNHANVIEN end as TENBACSICHIDINH          ,             cls.CLSKETQUA_ID, cls.NGAYGIOTHUCHIEN , cls.THOIGIANKHOADULIEU, cls.NGUOIKHOA_ID, cls_vtyt.CLSKETQUA_ID as VTYT            , cls.GUINGOAI, cls.NOIGUIDEN_ID, dv.TENNGUOIKHOA, TB.MATHIETBI, TB.TENTHIETBI                   FROM TT_DVYEUCAU (NOLOCK) dv        inner join TT_TIEPNHAN (NOLOCK) tn on dv.TIEPNHAN_ID = tn.TIEPNHAN_ID        inner join TT_BENHNHAN (NOLOCK) bn on tn.BENHNHAN_ID = bn.BENHNHAN_ID        inner join TM_DICHVU A on A.DICHVU_ID = dv.DICHVU_ID        inner join TM_PHONGBAN nth on nth.PHONGBAN_ID = dv.NOITHUCHIEN_ID        left join TM_BENHVIEN ngt on ngt.BENHVIEN_STT_ID = dv.DONVIGIOITHIEU_ID        left join TM_NHANVIEN bscd on bscd.NHANVIEN_ID = dv.BACSICHIDINH_ID        left join TM_NHANVIEN ngtt on ngtt.NHANVIEN_ID = dv.NGUOIGIOITHIEU_ID        inner join TM_PHONGBAN nyc on nyc.PHONGBAN_ID = dv.NOIYEUCAU_ID        inner join TM_NHOMDICHVU B on B.NHOMDICHVU_ID = A.NHOMDICHVU_ID        inner join TT_VIENPHI (NOLOCK) VP on VP.TIEPNHAN_ID = tn.TIEPNHAN_ID and VP.DICHVU_ID = dv.DICHVU_ID and VP.REF_ID = dv.DVYEUCAU_ID        left join TT_NOITRU_BENHAN (NOLOCK) BA on BA.TIEPNHAN_ID = tn.TIEPNHAN_ID AND dv.BENHAN_ID = BA.BENHAN_ID        inner join TM_GENDER GD on GD.ID = bn.GIOITINH        left join TT_NGOAITRU_KHAMBENH (NOLOCK) kbnt on kbnt.KHAMBENH_ID = dv.KHAMBENH_NGOAITRU_ID                       left join TT_CLSKETQUA (NOLOCK) cls on dv.DVYEUCAU_ID = cls.DVYEUCAU_ID            left join TT_CLSKETQUA_VTYT (NOLOCK) cls_vtyt on cls_vtyt.DVYEUCAU_ID = dv.DVYEUCAU_ID            LEFT JOIN TM_THIETBI (NOLOCK) TB ON TB.THIETBI_ID = cls.THIETBI_ID                   where        dv.DICHVU_ID IS NOT NULL        and tn.BENHVIEN_ID = 'HLU01'        and HUYYEUCAU = 0        and dv.NGAYHENCLS is NULL                       and dv.TRANGTHAI IN ('CHOXACNHAN','HOANTAT')           and           dv.NGAYYEUCAU >= '5/1/2019 12:00:00 AM'         and           dv.NGAYYEUCAU <= '12/12/2019 12:00:00 AM'         and           dv.NOITHUCHIEN_ID = 77         and           (vp.DATHANHTOAN = '1'  or vp.DONGIA_DOANHTHU = '0' OR TN.SUDUNG_BHTN='1' OR TN.BAOLANH_VIENPHI='1'  OR tn.TRANGTHAI IN ('NOITRU','CAPCUU','NGOAITRU') or dv.HOPDONG_BENHNHAN_ID is not null or vp.BENHNHAN_PHAITHANHTOAN >= 0)         and           (CASE          WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU          WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2) END) in (02)                 ) data1) lst                    where          lst.ROWNUMBER between 1 and 5                 order by NGAYGIOYEUCAU asc]
2019-12-12 17:31:44,144 [1] DEBUG - Statement Id: [DAO00000_GetNhomDoiTuong] PreparedStatement : [SELECT DOITUONG_ID              ,[TENDOITUONG]              ,[NHOMDICHVU]              ,[TYLE_VUOT_LCB]              ,[GIOIHAN_VUOT_LCB]              ,[GIOIHAN_VUOT_DVKTC]              ,[TYLE_THUOC_UT]              ,[CPVC]              ,[CHIPHINGOAI_BHYT]              ,[NGANSACH_TL]              ,[MIENGIAM_TL]              ,[TAITRO_TL]              ,[BHTN_TL]              FROM [dbo].[TM_DOITUONG]]
2019-12-12 17:31:51,822 [1] DEBUG - Statement Id: [DAO00019_DanhSachCDHA] PreparedStatement : [declare @TenBenhVien nvarchar(500)        declare @ManhomDSA varchar(10);        set @TenBenhVien = (select VALUE from TM_SYS_APPSETTINGS where CODE = 'APP_BENHVIEN_TEN')        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        select * from(        select ROW_NUMBER() OVER(order by NGAYGIOYEUCAU) as ROWNUMBER, *        from        (SELECT distinct        COUNT(*) OVER() as TOTALROWS,        N'Mã người bệnh: ' + bn.MAYTE + ' - ' + N'Tên người bệnh: ' + bn.TENBENHNHAN + ' - ' + N'Số bệnh án: ' + ISNULL(BA.SOBENHAN,'') + ' - ' + N'Sinh ngày: ' + isnull(Convert(varchar(10),bn.NGAYSINH,103),bn.NAMSINH) + ' - ' + N'Giới tính: ' + GD.DESCRIPTION as GROUPNAME,        bn.MAYTE, bn.TENBENHNHAN, bn.NAMSINH, bn.NGAYSINH as TUOI, ISNULL(CONVERT(VARCHAR(10), bn.NGAYSINH, 103),CAST(bn.NAMSINH AS varchar)) as NGAYSINH, bn.DIACHILIENLAC as DIACHI, bn.GIOITINH, GD.DESCRIPTION as TENGIOITINH,        tn.DOITUONG_ID, tn.THOIGIANTIEPNHAN, tn.BENHNHAN_ID, tn.TIEPNHAN_ID, tn.TRAITUYEN, tn.SOTIEPNHAN,        dv.DICHVU_ID, dv.NOITHUCHIEN_ID, isnull(dv.NGAYTAO, dv.NGAYCAPNHAT) as THOIGIANDKDICHVU,        dv.KHAN, dv.NOIYEUCAU_ID, dv.NGAYGIOYEUCAU, dv.BACSICHIDINH_ID, dv.DONVIGIOITHIEU_ID, dv.NGUOIGIOITHIEU_ID, dv.TRANGTHAI_WFL,        tn.NOIGIOITHIEU_ID, kbnt.HUONGGIAIQUYET_ID,        dv.DVYEUCAU_ID, dv.MARIS, dv.TRANGTHAI as TRANGTHAICODE, B.TENNHOMDICHVU, dv.SOPHIEUYEUCAU, dv.KHAMBENH_NGOAITRU_ID, dv.NGUOICAPNHAT_ID, dv.NGAYCAPNHAT,        CASE        WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU        WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2) END AS MANHOMDICHVU, B.MANHOMDICHVU as MANHOMDICHVUCHITIET, tn.TRANGTHAI as TRANGTHAI_TIEPNHAN,        'True' as DAKHAM,        vp.DATHANHTOAN, vp.DONGIA_DOANHTHU, BA.SOBENHAN, dv.CHANDOAN        , a.TENDICHVU, nth.TENPHONGBAN as TENPHONGKHAM, nyc.TENPHONGBAN as TENKHOACHIDINH        , case when (dv.DONVIGIOITHIEU_ID is not null and dv.DONVIGIOITHIEU_ID != '') then ngt.TENBENHVIEN else @TenBenhVien end as TENBENHVIENCHIDINH        , case when (dv.BACSICHIDINH_ID is not null and dv.BACSICHIDINH_ID != '') then bscd.TENNHANVIEN else ngtt.TENNHANVIEN end as TENBACSICHIDINH          ,             cls.CLSKETQUA_ID, cls.NGAYGIOTHUCHIEN , cls.THOIGIANKHOADULIEU, cls.NGUOIKHOA_ID, cls_vtyt.CLSKETQUA_ID as VTYT            , cls.GUINGOAI, cls.NOIGUIDEN_ID, dv.TENNGUOIKHOA, TB.MATHIETBI, TB.TENTHIETBI                   FROM TT_DVYEUCAU (NOLOCK) dv        inner join TT_TIEPNHAN (NOLOCK) tn on dv.TIEPNHAN_ID = tn.TIEPNHAN_ID        inner join TT_BENHNHAN (NOLOCK) bn on tn.BENHNHAN_ID = bn.BENHNHAN_ID        inner join TM_DICHVU A on A.DICHVU_ID = dv.DICHVU_ID        inner join TM_PHONGBAN nth on nth.PHONGBAN_ID = dv.NOITHUCHIEN_ID        left join TM_BENHVIEN ngt on ngt.BENHVIEN_STT_ID = dv.DONVIGIOITHIEU_ID        left join TM_NHANVIEN bscd on bscd.NHANVIEN_ID = dv.BACSICHIDINH_ID        left join TM_NHANVIEN ngtt on ngtt.NHANVIEN_ID = dv.NGUOIGIOITHIEU_ID        inner join TM_PHONGBAN nyc on nyc.PHONGBAN_ID = dv.NOIYEUCAU_ID        inner join TM_NHOMDICHVU B on B.NHOMDICHVU_ID = A.NHOMDICHVU_ID        inner join TT_VIENPHI (NOLOCK) VP on VP.TIEPNHAN_ID = tn.TIEPNHAN_ID and VP.DICHVU_ID = dv.DICHVU_ID and VP.REF_ID = dv.DVYEUCAU_ID        left join TT_NOITRU_BENHAN (NOLOCK) BA on BA.TIEPNHAN_ID = tn.TIEPNHAN_ID AND dv.BENHAN_ID = BA.BENHAN_ID        inner join TM_GENDER GD on GD.ID = bn.GIOITINH        left join TT_NGOAITRU_KHAMBENH (NOLOCK) kbnt on kbnt.KHAMBENH_ID = dv.KHAMBENH_NGOAITRU_ID                       left join TT_CLSKETQUA (NOLOCK) cls on dv.DVYEUCAU_ID = cls.DVYEUCAU_ID            left join TT_CLSKETQUA_VTYT (NOLOCK) cls_vtyt on cls_vtyt.DVYEUCAU_ID = dv.DVYEUCAU_ID            LEFT JOIN TM_THIETBI (NOLOCK) TB ON TB.THIETBI_ID = cls.THIETBI_ID                   where        dv.DICHVU_ID IS NOT NULL        and tn.BENHVIEN_ID = 'HLU01'        and HUYYEUCAU = 0        and dv.NGAYHENCLS is NULL                       and dv.TRANGTHAI IN ('CHOXACNHAN','HOANTAT')           and           dv.NGAYYEUCAU >= '5/1/2019 12:00:00 AM'         and           dv.NGAYYEUCAU <= '12/12/2019 12:00:00 AM'         and           dv.NOITHUCHIEN_ID = 77         and           (vp.DATHANHTOAN = '1'  or vp.DONGIA_DOANHTHU = '0' OR TN.SUDUNG_BHTN='1' OR TN.BAOLANH_VIENPHI='1'  OR tn.TRANGTHAI IN ('NOITRU','CAPCUU','NGOAITRU') or dv.HOPDONG_BENHNHAN_ID is not null or vp.BENHNHAN_PHAITHANHTOAN >= 0)         and           (CASE          WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU          WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2) END) in (02)                 ) data1) lst                    where          lst.ROWNUMBER between 6 and 10                 order by NGAYGIOYEUCAU asc]
2019-12-12 17:31:56,582 [1] DEBUG - Statement Id: [DAO00019_DanhSachCDHA] PreparedStatement : [declare @TenBenhVien nvarchar(500)        declare @ManhomDSA varchar(10);        set @TenBenhVien = (select VALUE from TM_SYS_APPSETTINGS where CODE = 'APP_BENHVIEN_TEN')        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        select * from(        select ROW_NUMBER() OVER(order by NGAYGIOYEUCAU) as ROWNUMBER, *        from        (SELECT distinct        COUNT(*) OVER() as TOTALROWS,        N'Mã người bệnh: ' + bn.MAYTE + ' - ' + N'Tên người bệnh: ' + bn.TENBENHNHAN + ' - ' + N'Số bệnh án: ' + ISNULL(BA.SOBENHAN,'') + ' - ' + N'Sinh ngày: ' + isnull(Convert(varchar(10),bn.NGAYSINH,103),bn.NAMSINH) + ' - ' + N'Giới tính: ' + GD.DESCRIPTION as GROUPNAME,        bn.MAYTE, bn.TENBENHNHAN, bn.NAMSINH, bn.NGAYSINH as TUOI, ISNULL(CONVERT(VARCHAR(10), bn.NGAYSINH, 103),CAST(bn.NAMSINH AS varchar)) as NGAYSINH, bn.DIACHILIENLAC as DIACHI, bn.GIOITINH, GD.DESCRIPTION as TENGIOITINH,        tn.DOITUONG_ID, tn.THOIGIANTIEPNHAN, tn.BENHNHAN_ID, tn.TIEPNHAN_ID, tn.TRAITUYEN, tn.SOTIEPNHAN,        dv.DICHVU_ID, dv.NOITHUCHIEN_ID, isnull(dv.NGAYTAO, dv.NGAYCAPNHAT) as THOIGIANDKDICHVU,        dv.KHAN, dv.NOIYEUCAU_ID, dv.NGAYGIOYEUCAU, dv.BACSICHIDINH_ID, dv.DONVIGIOITHIEU_ID, dv.NGUOIGIOITHIEU_ID, dv.TRANGTHAI_WFL,        tn.NOIGIOITHIEU_ID, kbnt.HUONGGIAIQUYET_ID,        dv.DVYEUCAU_ID, dv.MARIS, dv.TRANGTHAI as TRANGTHAICODE, B.TENNHOMDICHVU, dv.SOPHIEUYEUCAU, dv.KHAMBENH_NGOAITRU_ID, dv.NGUOICAPNHAT_ID, dv.NGAYCAPNHAT,        CASE        WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU        WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2) END AS MANHOMDICHVU, B.MANHOMDICHVU as MANHOMDICHVUCHITIET, tn.TRANGTHAI as TRANGTHAI_TIEPNHAN,        'True' as DAKHAM,        vp.DATHANHTOAN, vp.DONGIA_DOANHTHU, BA.SOBENHAN, dv.CHANDOAN        , a.TENDICHVU, nth.TENPHONGBAN as TENPHONGKHAM, nyc.TENPHONGBAN as TENKHOACHIDINH        , case when (dv.DONVIGIOITHIEU_ID is not null and dv.DONVIGIOITHIEU_ID != '') then ngt.TENBENHVIEN else @TenBenhVien end as TENBENHVIENCHIDINH        , case when (dv.BACSICHIDINH_ID is not null and dv.BACSICHIDINH_ID != '') then bscd.TENNHANVIEN else ngtt.TENNHANVIEN end as TENBACSICHIDINH          ,             cls.CLSKETQUA_ID, cls.NGAYGIOTHUCHIEN , cls.THOIGIANKHOADULIEU, cls.NGUOIKHOA_ID, cls_vtyt.CLSKETQUA_ID as VTYT            , cls.GUINGOAI, cls.NOIGUIDEN_ID, dv.TENNGUOIKHOA, TB.MATHIETBI, TB.TENTHIETBI                   FROM TT_DVYEUCAU (NOLOCK) dv        inner join TT_TIEPNHAN (NOLOCK) tn on dv.TIEPNHAN_ID = tn.TIEPNHAN_ID        inner join TT_BENHNHAN (NOLOCK) bn on tn.BENHNHAN_ID = bn.BENHNHAN_ID        inner join TM_DICHVU A on A.DICHVU_ID = dv.DICHVU_ID        inner join TM_PHONGBAN nth on nth.PHONGBAN_ID = dv.NOITHUCHIEN_ID        left join TM_BENHVIEN ngt on ngt.BENHVIEN_STT_ID = dv.DONVIGIOITHIEU_ID        left join TM_NHANVIEN bscd on bscd.NHANVIEN_ID = dv.BACSICHIDINH_ID        left join TM_NHANVIEN ngtt on ngtt.NHANVIEN_ID = dv.NGUOIGIOITHIEU_ID        inner join TM_PHONGBAN nyc on nyc.PHONGBAN_ID = dv.NOIYEUCAU_ID        inner join TM_NHOMDICHVU B on B.NHOMDICHVU_ID = A.NHOMDICHVU_ID        inner join TT_VIENPHI (NOLOCK) VP on VP.TIEPNHAN_ID = tn.TIEPNHAN_ID and VP.DICHVU_ID = dv.DICHVU_ID and VP.REF_ID = dv.DVYEUCAU_ID        left join TT_NOITRU_BENHAN (NOLOCK) BA on BA.TIEPNHAN_ID = tn.TIEPNHAN_ID AND dv.BENHAN_ID = BA.BENHAN_ID        inner join TM_GENDER GD on GD.ID = bn.GIOITINH        left join TT_NGOAITRU_KHAMBENH (NOLOCK) kbnt on kbnt.KHAMBENH_ID = dv.KHAMBENH_NGOAITRU_ID                       left join TT_CLSKETQUA (NOLOCK) cls on dv.DVYEUCAU_ID = cls.DVYEUCAU_ID            left join TT_CLSKETQUA_VTYT (NOLOCK) cls_vtyt on cls_vtyt.DVYEUCAU_ID = dv.DVYEUCAU_ID            LEFT JOIN TM_THIETBI (NOLOCK) TB ON TB.THIETBI_ID = cls.THIETBI_ID                   where        dv.DICHVU_ID IS NOT NULL        and tn.BENHVIEN_ID = 'HLU01'        and HUYYEUCAU = 0        and dv.NGAYHENCLS is NULL                       and dv.TRANGTHAI IN ('CHOXACNHAN','HOANTAT')           and           dv.NGAYYEUCAU >= '5/1/2019 12:00:00 AM'         and           dv.NGAYYEUCAU <= '12/12/2019 12:00:00 AM'         and           dv.NOITHUCHIEN_ID = 77         and           (vp.DATHANHTOAN = '1'  or vp.DONGIA_DOANHTHU = '0' OR TN.SUDUNG_BHTN='1' OR TN.BAOLANH_VIENPHI='1'  OR tn.TRANGTHAI IN ('NOITRU','CAPCUU','NGOAITRU') or dv.HOPDONG_BENHNHAN_ID is not null or vp.BENHNHAN_PHAITHANHTOAN >= 0)         and           (CASE          WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU          WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2) END) in (02)                 ) data1) lst                    where          lst.ROWNUMBER between 11 and 15                 order by NGAYGIOYEUCAU asc]
2019-12-12 17:31:59,309 [1] DEBUG - Statement Id: [DAO00019_DanhSachCDHA] PreparedStatement : [declare @TenBenhVien nvarchar(500)        declare @ManhomDSA varchar(10);        set @TenBenhVien = (select VALUE from TM_SYS_APPSETTINGS where CODE = 'APP_BENHVIEN_TEN')        select top 1  @ManhomDSA = VALUE from TM_SYS_APPSETTINGS where CODE = 'MANHOM_DICHVU_DSA'        select * from(        select ROW_NUMBER() OVER(order by NGAYGIOYEUCAU) as ROWNUMBER, *        from        (SELECT distinct        COUNT(*) OVER() as TOTALROWS,        N'Mã người bệnh: ' + bn.MAYTE + ' - ' + N'Tên người bệnh: ' + bn.TENBENHNHAN + ' - ' + N'Số bệnh án: ' + ISNULL(BA.SOBENHAN,'') + ' - ' + N'Sinh ngày: ' + isnull(Convert(varchar(10),bn.NGAYSINH,103),bn.NAMSINH) + ' - ' + N'Giới tính: ' + GD.DESCRIPTION as GROUPNAME,        bn.MAYTE, bn.TENBENHNHAN, bn.NAMSINH, bn.NGAYSINH as TUOI, ISNULL(CONVERT(VARCHAR(10), bn.NGAYSINH, 103),CAST(bn.NAMSINH AS varchar)) as NGAYSINH, bn.DIACHILIENLAC as DIACHI, bn.GIOITINH, GD.DESCRIPTION as TENGIOITINH,        tn.DOITUONG_ID, tn.THOIGIANTIEPNHAN, tn.BENHNHAN_ID, tn.TIEPNHAN_ID, tn.TRAITUYEN, tn.SOTIEPNHAN,        dv.DICHVU_ID, dv.NOITHUCHIEN_ID, isnull(dv.NGAYTAO, dv.NGAYCAPNHAT) as THOIGIANDKDICHVU,        dv.KHAN, dv.NOIYEUCAU_ID, dv.NGAYGIOYEUCAU, dv.BACSICHIDINH_ID, dv.DONVIGIOITHIEU_ID, dv.NGUOIGIOITHIEU_ID, dv.TRANGTHAI_WFL,        tn.NOIGIOITHIEU_ID, kbnt.HUONGGIAIQUYET_ID,        dv.DVYEUCAU_ID, dv.MARIS, dv.TRANGTHAI as TRANGTHAICODE, B.TENNHOMDICHVU, dv.SOPHIEUYEUCAU, dv.KHAMBENH_NGOAITRU_ID, dv.NGUOICAPNHAT_ID, dv.NGAYCAPNHAT,        CASE        WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU        WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2) END AS MANHOMDICHVU, B.MANHOMDICHVU as MANHOMDICHVUCHITIET, tn.TRANGTHAI as TRANGTHAI_TIEPNHAN,        'True' as DAKHAM,        vp.DATHANHTOAN, vp.DONGIA_DOANHTHU, BA.SOBENHAN, dv.CHANDOAN        , a.TENDICHVU, nth.TENPHONGBAN as TENPHONGKHAM, nyc.TENPHONGBAN as TENKHOACHIDINH        , case when (dv.DONVIGIOITHIEU_ID is not null and dv.DONVIGIOITHIEU_ID != '') then ngt.TENBENHVIEN else @TenBenhVien end as TENBENHVIENCHIDINH        , case when (dv.BACSICHIDINH_ID is not null and dv.BACSICHIDINH_ID != '') then bscd.TENNHANVIEN else ngtt.TENNHANVIEN end as TENBACSICHIDINH          ,             cls.CLSKETQUA_ID, cls.NGAYGIOTHUCHIEN , cls.THOIGIANKHOADULIEU, cls.NGUOIKHOA_ID, cls_vtyt.CLSKETQUA_ID as VTYT            , cls.GUINGOAI, cls.NOIGUIDEN_ID, dv.TENNGUOIKHOA, TB.MATHIETBI, TB.TENTHIETBI                   FROM TT_DVYEUCAU (NOLOCK) dv        inner join TT_TIEPNHAN (NOLOCK) tn on dv.TIEPNHAN_ID = tn.TIEPNHAN_ID        inner join TT_BENHNHAN (NOLOCK) bn on tn.BENHNHAN_ID = bn.BENHNHAN_ID        inner join TM_DICHVU A on A.DICHVU_ID = dv.DICHVU_ID        inner join TM_PHONGBAN nth on nth.PHONGBAN_ID = dv.NOITHUCHIEN_ID        left join TM_BENHVIEN ngt on ngt.BENHVIEN_STT_ID = dv.DONVIGIOITHIEU_ID        left join TM_NHANVIEN bscd on bscd.NHANVIEN_ID = dv.BACSICHIDINH_ID        left join TM_NHANVIEN ngtt on ngtt.NHANVIEN_ID = dv.NGUOIGIOITHIEU_ID        inner join TM_PHONGBAN nyc on nyc.PHONGBAN_ID = dv.NOIYEUCAU_ID        inner join TM_NHOMDICHVU B on B.NHOMDICHVU_ID = A.NHOMDICHVU_ID        inner join TT_VIENPHI (NOLOCK) VP on VP.TIEPNHAN_ID = tn.TIEPNHAN_ID and VP.DICHVU_ID = dv.DICHVU_ID and VP.REF_ID = dv.DVYEUCAU_ID        left join TT_NOITRU_BENHAN (NOLOCK) BA on BA.TIEPNHAN_ID = tn.TIEPNHAN_ID AND dv.BENHAN_ID = BA.BENHAN_ID        inner join TM_GENDER GD on GD.ID = bn.GIOITINH        left join TT_NGOAITRU_KHAMBENH (NOLOCK) kbnt on kbnt.KHAMBENH_ID = dv.KHAMBENH_NGOAITRU_ID                       left join TT_CLSKETQUA (NOLOCK) cls on dv.DVYEUCAU_ID = cls.DVYEUCAU_ID            left join TT_CLSKETQUA_VTYT (NOLOCK) cls_vtyt on cls_vtyt.DVYEUCAU_ID = dv.DVYEUCAU_ID            LEFT JOIN TM_THIETBI (NOLOCK) TB ON TB.THIETBI_ID = cls.THIETBI_ID                   where        dv.DICHVU_ID IS NOT NULL        and tn.BENHVIEN_ID = 'HLU01'        and HUYYEUCAU = 0        and dv.NGAYHENCLS is NULL                       and dv.TRANGTHAI IN ('CHOXACNHAN','HOANTAT')           and           dv.NGAYYEUCAU >= '5/1/2019 12:00:00 AM'         and           dv.NGAYYEUCAU <= '12/12/2019 12:00:00 AM'         and           dv.NOITHUCHIEN_ID = 77         and           (vp.DATHANHTOAN = '1'  or vp.DONGIA_DOANHTHU = '0' OR TN.SUDUNG_BHTN='1' OR TN.BAOLANH_VIENPHI='1'  OR tn.TRANGTHAI IN ('NOITRU','CAPCUU','NGOAITRU') or dv.HOPDONG_BENHNHAN_ID is not null or vp.BENHNHAN_PHAITHANHTOAN >= 0)         and           (CASE          WHEN @ManhomDSA is not null and B.MANHOMDICHVU in (@ManhomDSA) THEN B.MANHOMDICHVU          WHEN Left(B.MANHOMDICHVU,2) = '03' THEN '02' ELSE Left(B.MANHOMDICHVU,2) END) in (02)                 ) data1) lst                    where          lst.ROWNUMBER between 456 and 460                 order by NGAYGIOYEUCAU asc]
2019-12-12 17:33:32,066 [1] DEBUG - Statement Id: [DAO00020_ListKhoDuocOfPhongBan] PreparedStatement : [select B.* from TM_PHONGBAN_KHODUOC A        inner join TM_KHODUOC B on B.KHODUOC_ID = A.KHODUOC_ID        where        A.PHONGBAN_ID = ''        and A.BENHVIEN_ID = 'HLU01']
2019-12-12 17:33:32,358 [1] DEBUG - Statement Id: [DAO00020_ListKhoDuocOfPhongBan] PreparedStatement : [select B.* from TM_PHONGBAN_KHODUOC A        inner join TM_KHODUOC B on B.KHODUOC_ID = A.KHODUOC_ID        where        A.PHONGBAN_ID = '77'        and A.BENHVIEN_ID = 'HLU01']
2019-12-12 17:33:49,874 [1] DEBUG - Statement Id: [DAO00020_ListKhoDuocOfPhongBan] PreparedStatement : [select B.* from TM_PHONGBAN_KHODUOC A        inner join TM_KHODUOC B on B.KHODUOC_ID = A.KHODUOC_ID        where        A.PHONGBAN_ID = '62'        and A.BENHVIEN_ID = 'HLU01']
2019-12-12 17:33:50,015 [1] DEBUG - Statement Id: [DAO00008_UpdateUserIdPhongBanKhoDuoc] PreparedStatement : [IF EXISTS            (SELECT ACCOUNT_ID FROM TM_SYS_USERS WHERE ACCOUNT_ID =  @param0  and HOSPITAL_ID =  @param1 )            BEGIN            update TM_SYS_USERS set INVENTORY_ID =  @param2 , WORKING_DEPT_ID =  @param3             WHERE ACCOUNT_ID =  @param0  and HOSPITAL_ID =  @param1             END            ELSE            BEGIN            insert into TM_SYS_USERS ([ACCOUNT_ID], [ACCOUNT_NAME], [INVENTORY_ID], [WORKING_DEPT_ID], [HOSPITAL_ID])            values ( @param0 ,  @param4 ,  @param2 ,  @param3 ,  @param1 )            END]
2019-12-12 17:33:50,016 [1] DEBUG - Statement Id: [DAO00008_UpdateUserIdPhongBanKhoDuoc] Parameters: [@param0=[ACCOUNT_ID,113], @param1=[HOSPITAL_ID,HLU01], @param2=[INVENTORY_ID,32], @param3=[WORKING_DEPT_ID,62], @param4=[ACCOUNT_NAME,admin]]
2019-12-12 17:33:50,016 [1] DEBUG - Statement Id: [DAO00008_UpdateUserIdPhongBanKhoDuoc] Types: [@param0=[String, System.String], @param1=[String, System.String], @param2=[String, System.String], @param3=[String, System.String], @param4=[String, System.String]]
2019-12-12 17:34:20,755 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'BBM06'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 17:34:20,920 [1] DEBUG - Statement Id: [DAO00317_GetList] PreparedStatement : [select * from TM_MAU_LOAIMAU where TAMNGUNG='0']
2019-12-12 17:34:21,073 [1] DEBUG - Statement Id: [DAO00316_GetList] PreparedStatement : [select * from TM_MAU_DONVITINH where TAMNGUNG='0']
2019-12-12 17:34:21,272 [1] DEBUG - Statement Id: [DAO00315_GetList] PreparedStatement : [select * from TM_NHOM_ABO]
2019-12-12 17:34:21,353 [1] DEBUG - Statement Id: [DAO00318_GetList] PreparedStatement : [select * from TM_NHOM_RH]
2019-12-12 17:34:21,601 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'COM33'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 17:36:26,054 [1] DEBUG - Statement Id: [DAO00315_GetGiamDinhMuoi] PreparedStatement : [select * from TM_MAU_GIAMDINHMUOI]
2019-12-12 17:36:26,552 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'BBM07'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 17:36:26,912 [1] DEBUG - Statement Id: [DAO00324_GetList] PreparedStatement : [SELECT *,KHO_ID KHONHAP_ID,KHO_ID AS KHOXUAT_ID,KHO_ID AS KHOMAU_ID FROM TM_KHO WHERE KHOQUANLY_ID=1 AND TAMNGUNG = '0'            and BENHVIEN_ID = 'HLU01'            order by TENKHO]
2019-12-12 17:39:37,145 [1] DEBUG - Statement Id: [DAO00002_ScreenList] PreparedStatement : [select TM_SYS_SCREEN.*                             from TM_SYS_SCREEN                             where TM_SYS_SCREEN.HOSPITAL_ID = 'HLU01'               AND                   TM_SYS_SCREEN.PAGE = 'ADM05'                             order by TM_SYS_SCREEN.ID, TM_SYS_SCREEN.PARENTNAME, TM_SYS_SCREEN.TABINDEX]
2019-12-12 17:39:39,026 [1] DEBUG - Statement Id: [DAO00205_GetAllWithoutDeactive] PreparedStatement : [SELECT DISTINCT C.CATEGORY_ID AS CATEGORY_ID            , ISNULL(C.PARENT_ID,0) AS PARENT_ID            , C.CATEGORY_CODE AS CATEGORY_CODE            , C.CATEGORY_NAME AS CATEGORY_NAME            , C.FOLDER_LEVEL            , C.IS_FOLDER            , C.FOLDER_CODE            , CASE WHEN (C.FOLDER_CODE IS NULL OR C.FOLDER_CODE = 'ROOT' OR C.FOLDER_CODE = '' )            THEN NULL ELSE C.FOLDER_CODE END AS PARENT_CODE            , C.CATEGORY_TYPE            FROM TM_CATEGORY AS C            WHERE C.ENABLED = '1'            AND C.BENHVIEN_ID = 'HLU01' AND C.CATEGORY_ID != 0            ORDER BY C.CATEGORY_ID]
2019-12-12 17:39:45,731 [1] DEBUG - Statement Id: [DAO00205_GetDetail] PreparedStatement : [select *              from TM_CATEGORY              where TM_CATEGORY.CATEGORY_ID  = '33'              order by CATEGORY_ID]
2019-12-12 17:39:45,787 [1] DEBUG - Statement Id: [DAO00206_GetList] PreparedStatement : [select *              from TM_CATEGORY_DETAIL               where                             TM_CATEGORY_DETAIL.CATEGORY_ID = '33'                       and                           TM_CATEGORY_DETAIL.BENHVIEN_ID = 'HLU01'                                     order by FIELD_INDEX]
2019-12-12 17:39:47,492 [1] DEBUG - Statement Id: [DAO00205_GetTableColumns] PreparedStatement : [SELECT c.name AS COLUMN_NAME, t.name AS TABLE_NAME, d.definition AS COLUMN_DEFAULT, CAST(c.is_nullable AS char(1)) AS IS_NULLABLE              , dt.name AS DATA_TYPE, c.max_length AS CHARACTER_MAXIMUM_LENGTH, CAST(c.is_identity AS char(1)) AS IS_IDENTITY              , CHARACTER_SET_NAME = (case dt.name when 'nvarchar' then 'UNICODE' else NULL end), t2.name as PRIMARY_TABLE, c2.name as PRIMARY_COLUMN              , IS_PRIMARY = CASE WHEN i.column_id IS NULL THEN 0 ELSE 1 END              FROM sys.columns as c              inner join sys.tables as t on c.object_id = t.object_id              left join sys.default_constraints as d on d.object_id = c.default_object_id              inner join sys.types as dt on c.system_type_id = dt.system_type_id and c.user_type_id = dt.user_type_id              left join sys.foreign_key_columns as fk on fk.parent_object_id = c.object_id and c.column_id = fk.parent_column_id              left join sys.tables as t2 on t2.object_id = fk.referenced_object_id              left join sys.columns as c2 on c2.object_id = t2.object_id and c2.column_id = fk.referenced_column_id              left join sys.key_constraints as k on k.parent_object_id = t.object_id and k.type = 'PK'              left join sys.index_columns as i on i.object_id = t.object_id and i.index_id = k.unique_index_id and i.column_id = c.column_id              WHERE t.name = 'TM_SYS_CACHE'              ORDER BY c.column_id]
2019-12-12 17:39:47,892 [1] DEBUG - Statement Id: [DAO00012_GetList] PreparedStatement : [select        DICTIONARY_ID,        DICTIONARY_CODE,        DICTIONARY_NAME,        ATTRIBUTE1,        ATTRIBUTE2,        DICTIONARY_NAME_EN        from LST_DICTIONARY        where LST_DICTIONARY.Enabled = '1'         AND           LST_DICTIONARY.DICTIONARY_TYPE_CODE = 'DM_Columns_Properties'                 order by LST_DICTIONARY.IDX]
2019-12-12 17:39:47,927 [1] DEBUG - Statement Id: [DAO00208_GetDataByCategory] PreparedStatement : [SELECT ROW_NUMBER() OVER(ORDER BY(SELECT 1)) AS PRIMARY_ID, ID, DAO_ID, RESULT_VALUE, RESULT_TEXT, SELECT_TEXT, INDEX_FIELDS, CONDITIONS, ACTIVE, TYPE, UPDATE_TIME, TABLE_AFFECT              FROM TM_SYS_CACHE               WHERE HOSPITAL_ID = 'HLU01']
2019-12-12 17:42:31,034 [1] DEBUG - Statement Id: [DAO00205_GetTableColumns] PreparedStatement : [SELECT c.name AS COLUMN_NAME, t.name AS TABLE_NAME, d.definition AS COLUMN_DEFAULT, CAST(c.is_nullable AS char(1)) AS IS_NULLABLE              , dt.name AS DATA_TYPE, c.max_length AS CHARACTER_MAXIMUM_LENGTH, CAST(c.is_identity AS char(1)) AS IS_IDENTITY              , CHARACTER_SET_NAME = (case dt.name when 'nvarchar' then 'UNICODE' else NULL end), t2.name as PRIMARY_TABLE, c2.name as PRIMARY_COLUMN              , IS_PRIMARY = CASE WHEN i.column_id IS NULL THEN 0 ELSE 1 END              FROM sys.columns as c              inner join sys.tables as t on c.object_id = t.object_id              left join sys.default_constraints as d on d.object_id = c.default_object_id              inner join sys.types as dt on c.system_type_id = dt.system_type_id and c.user_type_id = dt.user_type_id              left join sys.foreign_key_columns as fk on fk.parent_object_id = c.object_id and c.column_id = fk.parent_column_id              left join sys.tables as t2 on t2.object_id = fk.referenced_object_id              left join sys.columns as c2 on c2.object_id = t2.object_id and c2.column_id = fk.referenced_column_id              left join sys.key_constraints as k on k.parent_object_id = t.object_id and k.type = 'PK'              left join sys.index_columns as i on i.object_id = t.object_id and i.index_id = k.unique_index_id and i.column_id = c.column_id              WHERE t.name = 'TM_SYS_CACHE'              ORDER BY c.column_id]
2019-12-12 17:42:31,128 [1] DEBUG - Statement Id: [DAO00012_GetList] PreparedStatement : [select        DICTIONARY_ID,        DICTIONARY_CODE,        DICTIONARY_NAME,        ATTRIBUTE1,        ATTRIBUTE2,        DICTIONARY_NAME_EN        from LST_DICTIONARY        where LST_DICTIONARY.Enabled = '1'         AND           LST_DICTIONARY.DICTIONARY_TYPE_CODE = 'DM_Columns_Update_Date'                 order by LST_DICTIONARY.IDX]
2019-12-12 17:42:31,162 [1] DEBUG - Statement Id: [DAO00012_GetList] PreparedStatement : [select        DICTIONARY_ID,        DICTIONARY_CODE,        DICTIONARY_NAME,        ATTRIBUTE1,        ATTRIBUTE2,        DICTIONARY_NAME_EN        from LST_DICTIONARY        where LST_DICTIONARY.Enabled = '1'         AND           LST_DICTIONARY.DICTIONARY_TYPE_CODE = 'DM_Columns_Update_By'                 order by LST_DICTIONARY.IDX]
2019-12-12 17:42:31,210 [1] DEBUG - Statement Id: [DAO00205_UpdateDM_iBatis] PreparedStatement : [UPDATE TM_SYS_CACHE              SET                                  DAO_ID='COM071  '              ,                    RESULT_VALUE='MAU_KEY'              ,                    RESULT_TEXT=N'{TENKHO:Kho:100} - {SOKIEMSOAT:Mã số:100} - {SOLONHAP:Số lô:100} - {MAMAU:Mã máu:120} - {TENMAU:Tên máu:300} - {TENDONVITINH:ĐVT:80} - {NHOM_ABO:Nhóm ABO:100} - {NHOM_RH:Nhóm RH:100} - {TENNGUONMAU:Nguồn hàng:100}'              ,                    SELECT_TEXT=N'{TENMAU}'              ,                    INDEX_FIELDS='MAU_KEY, KHOMAU_ID, MAU_ID, SOKIEMSOAT,SOLONHAP,MAMAU,TENMAU,TENDONVITINH, NHOM_ABO, NHOM_RH'              ,                    CONDITIONS=''              ,                    ACTIVE='1'              ,                    TYPE='2'              ,                    UPDATE_TIME='7/11/2019 10:01:54 AM'              ,                    TABLE_AFFECT=N''                             WHERE                                  ID='REFMAU_TONKHO']
2019-12-12 17:42:31,372 [1] DEBUG - Statement Id: [DAO00205_GetTableColumns] PreparedStatement : [SELECT c.name AS COLUMN_NAME, t.name AS TABLE_NAME, d.definition AS COLUMN_DEFAULT, CAST(c.is_nullable AS char(1)) AS IS_NULLABLE              , dt.name AS DATA_TYPE, c.max_length AS CHARACTER_MAXIMUM_LENGTH, CAST(c.is_identity AS char(1)) AS IS_IDENTITY              , CHARACTER_SET_NAME = (case dt.name when 'nvarchar' then 'UNICODE' else NULL end), t2.name as PRIMARY_TABLE, c2.name as PRIMARY_COLUMN              , IS_PRIMARY = CASE WHEN i.column_id IS NULL THEN 0 ELSE 1 END              FROM sys.columns as c              inner join sys.tables as t on c.object_id = t.object_id              left join sys.default_constraints as d on d.object_id = c.default_object_id              inner join sys.types as dt on c.system_type_id = dt.system_type_id and c.user_type_id = dt.user_type_id              left join sys.foreign_key_columns as fk on fk.parent_object_id = c.object_id and c.column_id = fk.parent_column_id              left join sys.tables as t2 on t2.object_id = fk.referenced_object_id              left join sys.columns as c2 on c2.object_id = t2.object_id and c2.column_id = fk.referenced_column_id              left join sys.key_constraints as k on k.parent_object_id = t.object_id and k.type = 'PK'              left join sys.index_columns as i on i.object_id = t.object_id and i.index_id = k.unique_index_id and i.column_id = c.column_id              WHERE t.name = 'TM_SYS_CACHE'              ORDER BY c.column_id]
2019-12-12 17:42:31,466 [1] DEBUG - Statement Id: [DAO00012_GetList] PreparedStatement : [select        DICTIONARY_ID,        DICTIONARY_CODE,        DICTIONARY_NAME,        ATTRIBUTE1,        ATTRIBUTE2,        DICTIONARY_NAME_EN        from LST_DICTIONARY        where LST_DICTIONARY.Enabled = '1'         AND           LST_DICTIONARY.DICTIONARY_TYPE_CODE = 'DM_Columns_Properties'                 order by LST_DICTIONARY.IDX]
2019-12-12 17:42:31,497 [1] DEBUG - Statement Id: [DAO00208_GetDataByCategory] PreparedStatement : [SELECT ROW_NUMBER() OVER(ORDER BY(SELECT 1)) AS PRIMARY_ID, ID, DAO_ID, RESULT_VALUE, RESULT_TEXT, SELECT_TEXT, INDEX_FIELDS, CONDITIONS, ACTIVE, TYPE, UPDATE_TIME, TABLE_AFFECT              FROM TM_SYS_CACHE               WHERE HOSPITAL_ID = 'HLU01' AND HOSPITAL_ID = 'HLU01']
2019-12-12 17:42:31,624 [1] DEBUG - Statement Id: [DAO00003_CacheList] PreparedStatement : [select *              from TM_SYS_CACHE              where HOSPITAL_ID = 'HLU01']
--------------------------------------------------------------------------------
